===2023-08-17 06:22:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 8
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 8
============ Train epoch 0 ============
cnt=[1, 2, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (4) | Train Loss: 1.9144 | Train Acc: 0.4586
 Site-Clipart                   (4) | Train Loss: 1.8981 | Train Acc: 0.4703
 Site-Real                      (7) | Train Loss: 1.8207 | Train Acc: 0.5669
 Site-Real                      (5) | Train Loss: 1.7587 | Train Acc: 0.6271
 Site-Painting                  (6) | Train Loss: 1.8565 | Train Acc: 0.5605
 Site-Painting                  (0) | Train Loss: 1.8258 | Train Acc: 0.5678
 Site-Sketch                    (1) | Train Loss: 1.8497 | Train Acc: 0.5478
 Site-Sketch                    (1) | Train Loss: 1.8690 | Train Acc: 0.4979
 Site-QuickDraw                 (2) | Train Loss: 2.2278 | Train Acc: 0.2038
 Site-QuickDraw                 (2) | Train Loss: 2.2161 | Train Acc: 0.2203
 Site-Infograph                 (3) | Train Loss: 2.1557 | Train Acc: 0.2675
 Site-Infograph                 (3) | Train Loss: 2.0861 | Train Acc: 0.3305
Average Train Accuracy: 0.4433
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4586
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4703
 Best site-Real                      | Epoch:0 | Val Acc: 0.5669
 Best site-Real                      | Epoch:0 | Val Acc: 0.6271
 Best site-Painting                  | Epoch:0 | Val Acc: 0.5605
 Best site-Painting                  | Epoch:0 | Val Acc: 0.5678
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.5478
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4979
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2038
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.2203
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2675
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.3305
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (3) | Train Loss: 1.4997 | Train Acc: 0.6497
 Site-Clipart                   (6) | Train Loss: 1.4767 | Train Acc: 0.6822
 Site-Real                      (4) | Train Loss: 1.3062 | Train Acc: 0.8025
 Site-Real                      (4) | Train Loss: 1.2020 | Train Acc: 0.8284
 Site-Painting                  (2) | Train Loss: 1.3752 | Train Acc: 0.7197
 Site-Painting                  (2) | Train Loss: 1.3339 | Train Acc: 0.7394
 Site-Sketch                    (5) | Train Loss: 1.3577 | Train Acc: 0.7006
 Site-Sketch                    (7) | Train Loss: 1.4344 | Train Acc: 0.6441
 Site-QuickDraw                 (1) | Train Loss: 2.0483 | Train Acc: 0.2803
 Site-QuickDraw                 (1) | Train Loss: 2.0572 | Train Acc: 0.2903
 Site-Infograph                 (0) | Train Loss: 1.9829 | Train Acc: 0.3885
 Site-Infograph                 (0) | Train Loss: 1.8728 | Train Acc: 0.4153
Average Train Accuracy: 0.5951
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6497
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6822
 Best site-Real                      | Epoch:1 | Val Acc: 0.8025
 Best site-Real                      | Epoch:1 | Val Acc: 0.8284
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7197
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7394
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7006
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6441
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2803
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2903
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3885
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4153
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (5) | Train Loss: 1.1716 | Train Acc: 0.7261
 Site-Clipart                   (5) | Train Loss: 1.1386 | Train Acc: 0.7436
 Site-Real                      (0) | Train Loss: 0.9544 | Train Acc: 0.8408
 Site-Real                      (0) | Train Loss: 0.8815 | Train Acc: 0.8792
 Site-Painting                  (4) | Train Loss: 1.0363 | Train Acc: 0.7962
 Site-Painting                  (4) | Train Loss: 1.0344 | Train Acc: 0.7903
 Site-Sketch                    (2) | Train Loss: 1.0410 | Train Acc: 0.7643
 Site-Sketch                    (6) | Train Loss: 1.0735 | Train Acc: 0.7479
 Site-QuickDraw                 (1) | Train Loss: 1.8500 | Train Acc: 0.4140
 Site-QuickDraw                 (7) | Train Loss: 1.8393 | Train Acc: 0.4301
 Site-Infograph                 (3) | Train Loss: 1.7633 | Train Acc: 0.4459
 Site-Infograph                 (3) | Train Loss: 1.6479 | Train Acc: 0.5233
Average Train Accuracy: 0.6751
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7261
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7436
 Best site-Real                      | Epoch:2 | Val Acc: 0.8408
 Best site-Real                      | Epoch:2 | Val Acc: 0.8792
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7962
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7903
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7643
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7479
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4140
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4301
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4459
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5233
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 0.9880 | Train Acc: 0.7771
 Site-Clipart                   (0) | Train Loss: 0.9474 | Train Acc: 0.8072
 Site-Real                      (2) | Train Loss: 0.7728 | Train Acc: 0.8599
 Site-Real                      (7) | Train Loss: 0.6725 | Train Acc: 0.9068
 Site-Painting                  (5) | Train Loss: 0.8585 | Train Acc: 0.8025
 Site-Painting                  (5) | Train Loss: 0.8202 | Train Acc: 0.8369
 Site-Sketch                    (3) | Train Loss: 0.8903 | Train Acc: 0.7771
 Site-Sketch                    (3) | Train Loss: 0.9253 | Train Acc: 0.7775
 Site-QuickDraw                 (1) | Train Loss: 1.6663 | Train Acc: 0.5096
 Site-QuickDraw                 (6) | Train Loss: 1.6553 | Train Acc: 0.5148
 Site-Infograph                 (4) | Train Loss: 1.6583 | Train Acc: 0.4586
 Site-Infograph                 (4) | Train Loss: 1.5243 | Train Acc: 0.5297
Average Train Accuracy: 0.7131
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7771
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8072
 Best site-Real                      | Epoch:3 | Val Acc: 0.8599
 Best site-Real                      | Epoch:3 | Val Acc: 0.9068
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8025
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8369
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7771
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7775
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5096
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5148
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4586
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5297
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 2, 2, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (2) | Train Loss: 0.9116 | Train Acc: 0.7452
 Site-Clipart                   (2) | Train Loss: 0.8899 | Train Acc: 0.7691
 Site-Real                      (3) | Train Loss: 0.7136 | Train Acc: 0.8662
 Site-Real                      (3) | Train Loss: 0.6060 | Train Acc: 0.9047
 Site-Painting                  (4) | Train Loss: 0.7787 | Train Acc: 0.8153
 Site-Painting                  (6) | Train Loss: 0.7441 | Train Acc: 0.8263
 Site-Sketch                    (7) | Train Loss: 0.8244 | Train Acc: 0.7771
 Site-Sketch                    (7) | Train Loss: 0.8379 | Train Acc: 0.7818
 Site-QuickDraw                 (1) | Train Loss: 1.5086 | Train Acc: 0.5350
 Site-QuickDraw                 (1) | Train Loss: 1.5236 | Train Acc: 0.5297
 Site-Infograph                 (5) | Train Loss: 1.5503 | Train Acc: 0.5223
 Site-Infograph                 (0) | Train Loss: 1.4195 | Train Acc: 0.5890
Average Train Accuracy: 0.7218
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7452
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7691
 Best site-Real                      | Epoch:4 | Val Acc: 0.8662
 Best site-Real                      | Epoch:4 | Val Acc: 0.9047
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8153
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8263
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7771
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7818
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5350
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5297
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5223
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 0.7630 | Train Acc: 0.8089
 Site-Clipart                   (3) | Train Loss: 0.7539 | Train Acc: 0.8284
 Site-Real                      (2) | Train Loss: 0.5890 | Train Acc: 0.8726
 Site-Real                      (6) | Train Loss: 0.5059 | Train Acc: 0.9280
 Site-Painting                  (5) | Train Loss: 0.6976 | Train Acc: 0.8471
 Site-Painting                  (7) | Train Loss: 0.6650 | Train Acc: 0.8517
 Site-Sketch                    (4) | Train Loss: 0.7329 | Train Acc: 0.8089
 Site-Sketch                    (4) | Train Loss: 0.7446 | Train Acc: 0.8136
 Site-QuickDraw                 (1) | Train Loss: 1.3498 | Train Acc: 0.6178
 Site-QuickDraw                 (1) | Train Loss: 1.3148 | Train Acc: 0.6165
 Site-Infograph                 (0) | Train Loss: 1.5274 | Train Acc: 0.5032
 Site-Infograph                 (0) | Train Loss: 1.3720 | Train Acc: 0.5805
Average Train Accuracy: 0.7564
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8089
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8284
 Best site-Real                      | Epoch:5 | Val Acc: 0.8726
 Best site-Real                      | Epoch:5 | Val Acc: 0.9280
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8471
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8517
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8089
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8136
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6178
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6165
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5032
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5805
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (5) | Train Loss: 0.7480 | Train Acc: 0.8153
 Site-Clipart                   (2) | Train Loss: 0.7054 | Train Acc: 0.8369
 Site-Real                      (0) | Train Loss: 0.5464 | Train Acc: 0.8854
 Site-Real                      (0) | Train Loss: 0.4511 | Train Acc: 0.9301
 Site-Painting                  (3) | Train Loss: 0.6667 | Train Acc: 0.8089
 Site-Painting                  (3) | Train Loss: 0.6068 | Train Acc: 0.8623
 Site-Sketch                    (2) | Train Loss: 0.6291 | Train Acc: 0.8535
 Site-Sketch                    (7) | Train Loss: 0.6970 | Train Acc: 0.7987
 Site-QuickDraw                 (1) | Train Loss: 1.2439 | Train Acc: 0.6306
 Site-QuickDraw                 (1) | Train Loss: 1.2464 | Train Acc: 0.6271
 Site-Infograph                 (6) | Train Loss: 1.4474 | Train Acc: 0.5605
 Site-Infograph                 (4) | Train Loss: 1.3122 | Train Acc: 0.5996
Average Train Accuracy: 0.7674
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8153
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8369
 Best site-Real                      | Epoch:6 | Val Acc: 0.8854
 Best site-Real                      | Epoch:6 | Val Acc: 0.9301
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8089
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8623
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8535
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7987
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6306
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6271
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5605
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5996
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 0.6780 | Train Acc: 0.8408
 Site-Clipart                   (1) | Train Loss: 0.6735 | Train Acc: 0.8136
 Site-Real                      (2) | Train Loss: 0.5129 | Train Acc: 0.9045
 Site-Real                      (2) | Train Loss: 0.4116 | Train Acc: 0.9237
 Site-Painting                  (6) | Train Loss: 0.6117 | Train Acc: 0.8280
 Site-Painting                  (4) | Train Loss: 0.5525 | Train Acc: 0.8729
 Site-Sketch                    (5) | Train Loss: 0.5951 | Train Acc: 0.8408
 Site-Sketch                    (7) | Train Loss: 0.6626 | Train Acc: 0.8136
 Site-QuickDraw                 (0) | Train Loss: 1.1113 | Train Acc: 0.6688
 Site-QuickDraw                 (0) | Train Loss: 1.1445 | Train Acc: 0.6907
 Site-Infograph                 (3) | Train Loss: 1.4142 | Train Acc: 0.5414
 Site-Infograph                 (3) | Train Loss: 1.2222 | Train Acc: 0.6377
Average Train Accuracy: 0.7814
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8408
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8136
 Best site-Real                      | Epoch:7 | Val Acc: 0.9045
 Best site-Real                      | Epoch:7 | Val Acc: 0.9237
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8280
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8729
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8408
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8136
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6688
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6907
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5414
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.6377
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (5) | Train Loss: 0.6667 | Train Acc: 0.8217
 Site-Clipart                   (5) | Train Loss: 0.6388 | Train Acc: 0.8305
 Site-Real                      (6) | Train Loss: 0.4757 | Train Acc: 0.9045
 Site-Real                      (2) | Train Loss: 0.3955 | Train Acc: 0.9216
 Site-Painting                  (7) | Train Loss: 0.5932 | Train Acc: 0.8344
 Site-Painting                  (4) | Train Loss: 0.5275 | Train Acc: 0.8771
 Site-Sketch                    (0) | Train Loss: 0.6406 | Train Acc: 0.8217
 Site-Sketch                    (0) | Train Loss: 0.6304 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 1.0896 | Train Acc: 0.6815
 Site-QuickDraw                 (1) | Train Loss: 1.0738 | Train Acc: 0.7097
 Site-Infograph                 (3) | Train Loss: 1.3435 | Train Acc: 0.6051
 Site-Infograph                 (3) | Train Loss: 1.2015 | Train Acc: 0.6314
Average Train Accuracy: 0.7881
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8217
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8305
 Best site-Real                      | Epoch:8 | Val Acc: 0.9045
 Best site-Real                      | Epoch:8 | Val Acc: 0.9216
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8344
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8771
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8217
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8178
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6815
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.7097
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.6051
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.6314
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (5) | Train Loss: 0.6112 | Train Acc: 0.8408
 Site-Clipart                   (5) | Train Loss: 0.6127 | Train Acc: 0.8114
 Site-Real                      (4) | Train Loss: 0.4531 | Train Acc: 0.9045
 Site-Real                      (4) | Train Loss: 0.3614 | Train Acc: 0.9195
 Site-Painting                  (2) | Train Loss: 0.5864 | Train Acc: 0.8471
 Site-Painting                  (2) | Train Loss: 0.5150 | Train Acc: 0.8729
 Site-Sketch                    (7) | Train Loss: 0.5439 | Train Acc: 0.8535
 Site-Sketch                    (1) | Train Loss: 0.6067 | Train Acc: 0.8093
 Site-QuickDraw                 (0) | Train Loss: 0.9895 | Train Acc: 0.7197
 Site-QuickDraw                 (0) | Train Loss: 0.9862 | Train Acc: 0.7203
 Site-Infograph                 (3) | Train Loss: 1.3563 | Train Acc: 0.5732
 Site-Infograph                 (6) | Train Loss: 1.1872 | Train Acc: 0.6271
Average Train Accuracy: 0.7916
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8408
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8114
 Best site-Real                      | Epoch:9 | Val Acc: 0.9045
 Best site-Real                      | Epoch:9 | Val Acc: 0.9195
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8471
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8729
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8535
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8093
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.7197
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.7203
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5732
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.6271
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 2, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 0.6163 | Train Acc: 0.8280
 Site-Clipart                   (2) | Train Loss: 0.5752 | Train Acc: 0.8475
 Site-Real                      (4) | Train Loss: 0.4251 | Train Acc: 0.9045
 Site-Real                      (4) | Train Loss: 0.3325 | Train Acc: 0.9407
 Site-Painting                  (0) | Train Loss: 0.5480 | Train Acc: 0.8535
 Site-Painting                  (0) | Train Loss: 0.5029 | Train Acc: 0.8814
 Site-Sketch                    (7) | Train Loss: 0.5338 | Train Acc: 0.8408
 Site-Sketch                    (5) | Train Loss: 0.5820 | Train Acc: 0.8263
 Site-QuickDraw                 (1) | Train Loss: 0.9742 | Train Acc: 0.7134
 Site-QuickDraw                 (1) | Train Loss: 0.9696 | Train Acc: 0.7267
 Site-Infograph                 (6) | Train Loss: 1.3209 | Train Acc: 0.5924
 Site-Infograph                 (3) | Train Loss: 1.1482 | Train Acc: 0.6377
Average Train Accuracy: 0.7994
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8280
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8475
 Best site-Real                      | Epoch:10 | Val Acc: 0.9045
 Best site-Real                      | Epoch:10 | Val Acc: 0.9407
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8535
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8408
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8263
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.7134
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.7267
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5924
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.6377
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 1, 2, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (0) | Train Loss: 0.5815 | Train Acc: 0.8408
 Site-Clipart                   (7) | Train Loss: 0.5714 | Train Acc: 0.8305
 Site-Real                      (3) | Train Loss: 0.4084 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.3280 | Train Acc: 0.9322
 Site-Painting                  (4) | Train Loss: 0.5046 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.4536 | Train Acc: 0.8856
 Site-Sketch                    (6) | Train Loss: 0.5257 | Train Acc: 0.8344
 Site-Sketch                    (6) | Train Loss: 0.5876 | Train Acc: 0.8242
 Site-QuickDraw                 (1) | Train Loss: 0.9406 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.9223 | Train Acc: 0.7415
 Site-Infograph                 (2) | Train Loss: 1.3111 | Train Acc: 0.6178
 Site-Infograph                 (5) | Train Loss: 1.0926 | Train Acc: 0.6356
Average Train Accuracy: 0.8054
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8408
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8305
 Best site-Real                      | Epoch:11 | Val Acc: 0.9108
 Best site-Real                      | Epoch:11 | Val Acc: 0.9322
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8856
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8344
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8242
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.7325
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.7415
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.6178
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.6356
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 12 ============
cnt=[1, 2, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (7) | Train Loss: 0.5645 | Train Acc: 0.8599
 Site-Clipart                   (5) | Train Loss: 0.5378 | Train Acc: 0.8475
 Site-Real                      (4) | Train Loss: 0.3959 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.3185 | Train Acc: 0.9280
 Site-Painting                  (2) | Train Loss: 0.4849 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.4631 | Train Acc: 0.8814
 Site-Sketch                    (0) | Train Loss: 0.4871 | Train Acc: 0.8408
 Site-Sketch                    (5) | Train Loss: 0.5382 | Train Acc: 0.8284
 Site-QuickDraw                 (1) | Train Loss: 0.9333 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.8533 | Train Acc: 0.7479
 Site-Infograph                 (3) | Train Loss: 1.2738 | Train Acc: 0.6178
 Site-Infograph                 (6) | Train Loss: 1.0824 | Train Acc: 0.6504
Average Train Accuracy: 0.8109
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8599
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8475
 Best site-Real                      | Epoch:12 | Val Acc: 0.9172
 Best site-Real                      | Epoch:12 | Val Acc: 0.9280
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8814
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8408
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8284
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.7325
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.7479
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.6178
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.6504
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 2, 1, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (0) | Train Loss: 0.5286 | Train Acc: 0.8662
 Site-Clipart                   (6) | Train Loss: 0.5339 | Train Acc: 0.8517
 Site-Real                      (3) | Train Loss: 0.4147 | Train Acc: 0.8917
 Site-Real                      (7) | Train Loss: 0.3213 | Train Acc: 0.9301
 Site-Painting                  (4) | Train Loss: 0.4784 | Train Acc: 0.8471
 Site-Painting                  (4) | Train Loss: 0.4473 | Train Acc: 0.8792
 Site-Sketch                    (0) | Train Loss: 0.5278 | Train Acc: 0.8408
 Site-Sketch                    (0) | Train Loss: 0.5582 | Train Acc: 0.8284
 Site-QuickDraw                 (1) | Train Loss: 0.8295 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.8579 | Train Acc: 0.7500
 Site-Infograph                 (5) | Train Loss: 1.2664 | Train Acc: 0.6115
 Site-Infograph                 (2) | Train Loss: 1.0378 | Train Acc: 0.6758
Average Train Accuracy: 0.8114
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8662
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8517
 Best site-Real                      | Epoch:13 | Val Acc: 0.8917
 Best site-Real                      | Epoch:13 | Val Acc: 0.9301
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8471
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8792
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8408
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8284
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.7643
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.7500
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6115
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6758
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (5) | Train Loss: 0.5477 | Train Acc: 0.8471
 Site-Clipart                   (5) | Train Loss: 0.5057 | Train Acc: 0.8559
 Site-Real                      (6) | Train Loss: 0.3717 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2888 | Train Acc: 0.9407
 Site-Painting                  (4) | Train Loss: 0.4926 | Train Acc: 0.8599
 Site-Painting                  (0) | Train Loss: 0.4237 | Train Acc: 0.8983
 Site-Sketch                    (2) | Train Loss: 0.5085 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.5302 | Train Acc: 0.8199
 Site-QuickDraw                 (7) | Train Loss: 0.8591 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.8315 | Train Acc: 0.7754
 Site-Infograph                 (3) | Train Loss: 1.2368 | Train Acc: 0.6178
 Site-Infograph                 (3) | Train Loss: 1.0354 | Train Acc: 0.6801
Average Train Accuracy: 0.8176
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8471
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8559
 Best site-Real                      | Epoch:14 | Val Acc: 0.9172
 Best site-Real                      | Epoch:14 | Val Acc: 0.9407
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8599
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8344
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8199
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.7643
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.7754
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.6178
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.6801
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.5470 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.5016 | Train Acc: 0.8538
 Site-Real                      (4) | Train Loss: 0.3635 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.2804 | Train Acc: 0.9407
 Site-Painting                  (3) | Train Loss: 0.4941 | Train Acc: 0.8662
 Site-Painting                  (3) | Train Loss: 0.4301 | Train Acc: 0.8856
 Site-Sketch                    (6) | Train Loss: 0.4860 | Train Acc: 0.8790
 Site-Sketch                    (5) | Train Loss: 0.5314 | Train Acc: 0.8347
 Site-QuickDraw                 (1) | Train Loss: 0.8333 | Train Acc: 0.7261
 Site-QuickDraw                 (1) | Train Loss: 0.7947 | Train Acc: 0.7669
 Site-Infograph                 (7) | Train Loss: 1.2175 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.9917 | Train Acc: 0.6949
Average Train Accuracy: 0.8187
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8280
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8538
 Best site-Real                      | Epoch:15 | Val Acc: 0.9299
 Best site-Real                      | Epoch:15 | Val Acc: 0.9407
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8662
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8856
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8790
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8347
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.7261
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.7669
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6178
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.6949
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 2, 2, 2, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (3) | Train Loss: 0.5393 | Train Acc: 0.8471
 Site-Clipart                   (3) | Train Loss: 0.5004 | Train Acc: 0.8581
 Site-Real                      (0) | Train Loss: 0.3844 | Train Acc: 0.9108
 Site-Real                      (6) | Train Loss: 0.2701 | Train Acc: 0.9492
 Site-Painting                  (4) | Train Loss: 0.4611 | Train Acc: 0.8854
 Site-Painting                  (6) | Train Loss: 0.4032 | Train Acc: 0.8941
 Site-Sketch                    (7) | Train Loss: 0.4420 | Train Acc: 0.8726
 Site-Sketch                    (5) | Train Loss: 0.5113 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.8306 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.7852 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.2307 | Train Acc: 0.6115
 Site-Infograph                 (2) | Train Loss: 0.9876 | Train Acc: 0.6737
Average Train Accuracy: 0.8218
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8471
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8581
 Best site-Real                      | Epoch:16 | Val Acc: 0.9108
 Best site-Real                      | Epoch:16 | Val Acc: 0.9492
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8941
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8726
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8390
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7325
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7881
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6115
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6737
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (4) | Train Loss: 0.5270 | Train Acc: 0.8599
 Site-Clipart                   (7) | Train Loss: 0.5000 | Train Acc: 0.8581
 Site-Real                      (0) | Train Loss: 0.3789 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2816 | Train Acc: 0.9343
 Site-Painting                  (5) | Train Loss: 0.4147 | Train Acc: 0.8854
 Site-Painting                  (5) | Train Loss: 0.3710 | Train Acc: 0.8919
 Site-Sketch                    (2) | Train Loss: 0.4525 | Train Acc: 0.8599
 Site-Sketch                    (6) | Train Loss: 0.5201 | Train Acc: 0.8263
 Site-QuickDraw                 (1) | Train Loss: 0.8075 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.7708 | Train Acc: 0.8030
 Site-Infograph                 (3) | Train Loss: 1.2087 | Train Acc: 0.6306
 Site-Infograph                 (3) | Train Loss: 0.9504 | Train Acc: 0.6907
Average Train Accuracy: 0.8252
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8599
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.8581
 Best site-Real                      | Epoch:17 | Val Acc: 0.9236
 Best site-Real                      | Epoch:17 | Val Acc: 0.9343
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:17 | Val Acc: 0.8919
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8599
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8263
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.7389
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.8030
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6306
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6907
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 1, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (5) | Train Loss: 0.5056 | Train Acc: 0.8471
 Site-Clipart                   (5) | Train Loss: 0.4687 | Train Acc: 0.8623
 Site-Real                      (4) | Train Loss: 0.3726 | Train Acc: 0.8917
 Site-Real                      (4) | Train Loss: 0.2661 | Train Acc: 0.9386
 Site-Painting                  (2) | Train Loss: 0.4245 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3809 | Train Acc: 0.9025
 Site-Sketch                    (7) | Train Loss: 0.4624 | Train Acc: 0.8408
 Site-Sketch                    (0) | Train Loss: 0.4858 | Train Acc: 0.8326
 Site-QuickDraw                 (1) | Train Loss: 0.8037 | Train Acc: 0.7070
 Site-QuickDraw                 (6) | Train Loss: 0.7305 | Train Acc: 0.7881
 Site-Infograph                 (3) | Train Loss: 1.2100 | Train Acc: 0.6242
 Site-Infograph                 (3) | Train Loss: 0.9589 | Train Acc: 0.6864
Average Train Accuracy: 0.8183
============ Train epoch 19 ============
cnt=[2, 1, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (5) | Train Loss: 0.5226 | Train Acc: 0.8599
 Site-Clipart                   (5) | Train Loss: 0.4492 | Train Acc: 0.8559
 Site-Real                      (7) | Train Loss: 0.3691 | Train Acc: 0.9045
 Site-Real                      (1) | Train Loss: 0.2609 | Train Acc: 0.9386
 Site-Painting                  (4) | Train Loss: 0.4625 | Train Acc: 0.8854
 Site-Painting                  (4) | Train Loss: 0.3838 | Train Acc: 0.8983
 Site-Sketch                    (6) | Train Loss: 0.4312 | Train Acc: 0.8854
 Site-Sketch                    (3) | Train Loss: 0.5021 | Train Acc: 0.8432
 Site-QuickDraw                 (0) | Train Loss: 0.7661 | Train Acc: 0.7580
 Site-QuickDraw                 (0) | Train Loss: 0.7312 | Train Acc: 0.8051
 Site-Infograph                 (2) | Train Loss: 1.2080 | Train Acc: 0.5987
 Site-Infograph                 (2) | Train Loss: 0.9355 | Train Acc: 0.7076
Average Train Accuracy: 0.8284
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8599
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8559
 Best site-Real                      | Epoch:19 | Val Acc: 0.9045
 Best site-Real                      | Epoch:19 | Val Acc: 0.9386
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8432
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.7580
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.8051
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5987
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.7076
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 2, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (2) | Train Loss: 0.4824 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.4590 | Train Acc: 0.8623
 Site-Real                      (5) | Train Loss: 0.3365 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2628 | Train Acc: 0.9322
 Site-Painting                  (7) | Train Loss: 0.4461 | Train Acc: 0.8471
 Site-Painting                  (0) | Train Loss: 0.3628 | Train Acc: 0.9025
 Site-Sketch                    (6) | Train Loss: 0.4713 | Train Acc: 0.8599
 Site-Sketch                    (4) | Train Loss: 0.4842 | Train Acc: 0.8517
 Site-QuickDraw                 (1) | Train Loss: 0.7680 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.7235 | Train Acc: 0.8030
 Site-Infograph                 (3) | Train Loss: 1.1932 | Train Acc: 0.6369
 Site-Infograph                 (3) | Train Loss: 0.9181 | Train Acc: 0.6992
Average Train Accuracy: 0.8312
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8790
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.8623
 Best site-Real                      | Epoch:20 | Val Acc: 0.9236
 Best site-Real                      | Epoch:20 | Val Acc: 0.9322
 Best site-Painting                  | Epoch:20 | Val Acc: 0.8471
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9025
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8599
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8517
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.7771
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.8030
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6369
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6992
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 2, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (7) | Train Loss: 0.4460 | Train Acc: 0.8854
 Site-Clipart                   (0) | Train Loss: 0.4456 | Train Acc: 0.8708
 Site-Real                      (3) | Train Loss: 0.3514 | Train Acc: 0.9108
 Site-Real                      (3) | Train Loss: 0.2494 | Train Acc: 0.9364
 Site-Painting                  (5) | Train Loss: 0.4422 | Train Acc: 0.8726
 Site-Painting                  (6) | Train Loss: 0.3494 | Train Acc: 0.9131
 Site-Sketch                    (4) | Train Loss: 0.4306 | Train Acc: 0.8662
 Site-Sketch                    (4) | Train Loss: 0.4634 | Train Acc: 0.8559
 Site-QuickDraw                 (1) | Train Loss: 0.7303 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.6867 | Train Acc: 0.8051
 Site-Infograph                 (2) | Train Loss: 1.1626 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 0.8872 | Train Acc: 0.7097
Average Train Accuracy: 0.8393
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8854
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8708
 Best site-Real                      | Epoch:21 | Val Acc: 0.9108
 Best site-Real                      | Epoch:21 | Val Acc: 0.9364
 Best site-Painting                  | Epoch:21 | Val Acc: 0.8726
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9131
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8662
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8559
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.8089
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.8051
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.6369
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.7097
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (5) | Train Loss: 0.5014 | Train Acc: 0.8726
 Site-Clipart                   (7) | Train Loss: 0.4397 | Train Acc: 0.8644
 Site-Real                      (0) | Train Loss: 0.3386 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2273 | Train Acc: 0.9470
 Site-Painting                  (4) | Train Loss: 0.3922 | Train Acc: 0.8981
 Site-Painting                  (4) | Train Loss: 0.3488 | Train Acc: 0.9153
 Site-Sketch                    (3) | Train Loss: 0.4932 | Train Acc: 0.8408
 Site-Sketch                    (3) | Train Loss: 0.4684 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.7255 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.6585 | Train Acc: 0.8114
 Site-Infograph                 (6) | Train Loss: 1.1621 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.8793 | Train Acc: 0.7182
Average Train Accuracy: 0.8347
============ Train epoch 23 ============
cnt=[2, 2, 1, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (6) | Train Loss: 0.4385 | Train Acc: 0.8726
 Site-Clipart                   (2) | Train Loss: 0.4238 | Train Acc: 0.8750
 Site-Real                      (4) | Train Loss: 0.3432 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2397 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.3845 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.3461 | Train Acc: 0.9004
 Site-Sketch                    (5) | Train Loss: 0.4187 | Train Acc: 0.8726
 Site-Sketch                    (7) | Train Loss: 0.4617 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.6989 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.6602 | Train Acc: 0.8284
 Site-Infograph                 (3) | Train Loss: 1.1543 | Train Acc: 0.6433
 Site-Infograph                 (3) | Train Loss: 0.8555 | Train Acc: 0.7331
Average Train Accuracy: 0.8436
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8750
 Best site-Real                      | Epoch:23 | Val Acc: 0.9236
 Best site-Real                      | Epoch:23 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8917
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9004
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8726
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8581
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.7771
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.8284
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.6433
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.7331
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (1) | Train Loss: 0.4467 | Train Acc: 0.8917
 Site-Clipart                   (1) | Train Loss: 0.4253 | Train Acc: 0.8792
 Site-Real                      (7) | Train Loss: 0.3200 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.2254 | Train Acc: 0.9576
 Site-Painting                  (2) | Train Loss: 0.3872 | Train Acc: 0.8854
 Site-Painting                  (6) | Train Loss: 0.3634 | Train Acc: 0.8898
 Site-Sketch                    (5) | Train Loss: 0.3951 | Train Acc: 0.8790
 Site-Sketch                    (5) | Train Loss: 0.4321 | Train Acc: 0.8644
 Site-QuickDraw                 (0) | Train Loss: 0.7302 | Train Acc: 0.7771
 Site-QuickDraw                 (0) | Train Loss: 0.6828 | Train Acc: 0.8263
 Site-Infograph                 (3) | Train Loss: 1.1543 | Train Acc: 0.6306
 Site-Infograph                 (3) | Train Loss: 0.8572 | Train Acc: 0.7267
Average Train Accuracy: 0.8448
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8792
 Best site-Real                      | Epoch:24 | Val Acc: 0.9299
 Best site-Real                      | Epoch:24 | Val Acc: 0.9576
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8898
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8790
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8644
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7771
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.8263
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6306
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.7267
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 2, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (6) | Train Loss: 0.4401 | Train Acc: 0.8662
 Site-Clipart                   (4) | Train Loss: 0.4293 | Train Acc: 0.8665
 Site-Real                      (5) | Train Loss: 0.3537 | Train Acc: 0.9172
 Site-Real                      (5) | Train Loss: 0.2461 | Train Acc: 0.9513
 Site-Painting                  (2) | Train Loss: 0.4034 | Train Acc: 0.9045
 Site-Painting                  (2) | Train Loss: 0.3478 | Train Acc: 0.9004
 Site-Sketch                    (7) | Train Loss: 0.3657 | Train Acc: 0.8854
 Site-Sketch                    (3) | Train Loss: 0.4455 | Train Acc: 0.8559
 Site-QuickDraw                 (1) | Train Loss: 0.7367 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6568 | Train Acc: 0.8157
 Site-Infograph                 (0) | Train Loss: 1.1659 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 0.8416 | Train Acc: 0.7288
Average Train Accuracy: 0.8411
============ Train epoch 26 ============
cnt=[1, 2, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (5) | Train Loss: 0.4413 | Train Acc: 0.8726
 Site-Clipart                   (5) | Train Loss: 0.4107 | Train Acc: 0.8623
 Site-Real                      (4) | Train Loss: 0.3242 | Train Acc: 0.9299
 Site-Real                      (6) | Train Loss: 0.2403 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3846 | Train Acc: 0.9045
 Site-Painting                  (2) | Train Loss: 0.3554 | Train Acc: 0.8983
 Site-Sketch                    (7) | Train Loss: 0.4373 | Train Acc: 0.8662
 Site-Sketch                    (0) | Train Loss: 0.4400 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.6984 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6571 | Train Acc: 0.8263
 Site-Infograph                 (3) | Train Loss: 1.0985 | Train Acc: 0.6561
 Site-Infograph                 (3) | Train Loss: 0.7864 | Train Acc: 0.7691
Average Train Accuracy: 0.8468
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.8623
 Best site-Real                      | Epoch:26 | Val Acc: 0.9299
 Best site-Real                      | Epoch:26 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:26 | Val Acc: 0.9045
 Best site-Painting                  | Epoch:26 | Val Acc: 0.8983
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.8662
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.8581
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.7707
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.8263
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.6561
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.7691
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 27 ============
cnt=[1, 2, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (3) | Train Loss: 0.4825 | Train Acc: 0.8471
 Site-Clipart                   (3) | Train Loss: 0.3959 | Train Acc: 0.8835
 Site-Real                      (4) | Train Loss: 0.3096 | Train Acc: 0.9172
 Site-Real                      (4) | Train Loss: 0.2261 | Train Acc: 0.9364
 Site-Painting                  (6) | Train Loss: 0.3633 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.3152 | Train Acc: 0.9004
 Site-Sketch                    (7) | Train Loss: 0.4104 | Train Acc: 0.8599
 Site-Sketch                    (5) | Train Loss: 0.4089 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.7115 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6342 | Train Acc: 0.8369
 Site-Infograph                 (2) | Train Loss: 1.1787 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.8145 | Train Acc: 0.7352
Average Train Accuracy: 0.8393
============ Train epoch 28 ============
cnt=[1, 2, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (2) | Train Loss: 0.4046 | Train Acc: 0.8535
 Site-Clipart                   (2) | Train Loss: 0.3950 | Train Acc: 0.8686
 Site-Real                      (4) | Train Loss: 0.3121 | Train Acc: 0.9236
 Site-Real                      (7) | Train Loss: 0.2234 | Train Acc: 0.9386
 Site-Painting                  (1) | Train Loss: 0.3574 | Train Acc: 0.9108
 Site-Painting                  (1) | Train Loss: 0.3519 | Train Acc: 0.9068
 Site-Sketch                    (5) | Train Loss: 0.3810 | Train Acc: 0.8790
 Site-Sketch                    (5) | Train Loss: 0.4125 | Train Acc: 0.8686
 Site-QuickDraw                 (0) | Train Loss: 0.6954 | Train Acc: 0.7834
 Site-QuickDraw                 (6) | Train Loss: 0.6134 | Train Acc: 0.8220
 Site-Infograph                 (3) | Train Loss: 1.1080 | Train Acc: 0.6688
 Site-Infograph                 (3) | Train Loss: 0.7892 | Train Acc: 0.7606
Average Train Accuracy: 0.8487
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8535
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.8686
 Best site-Real                      | Epoch:28 | Val Acc: 0.9236
 Best site-Real                      | Epoch:28 | Val Acc: 0.9386
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9108
 Best site-Painting                  | Epoch:28 | Val Acc: 0.9068
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8790
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8686
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.7834
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.8220
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.6688
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.7606
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (4) | Train Loss: 0.4107 | Train Acc: 0.8726
 Site-Clipart                   (4) | Train Loss: 0.3752 | Train Acc: 0.9025
 Site-Real                      (5) | Train Loss: 0.3009 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2215 | Train Acc: 0.9407
 Site-Painting                  (6) | Train Loss: 0.4050 | Train Acc: 0.8854
 Site-Painting                  (1) | Train Loss: 0.3302 | Train Acc: 0.9025
 Site-Sketch                    (3) | Train Loss: 0.4230 | Train Acc: 0.8535
 Site-Sketch                    (3) | Train Loss: 0.3833 | Train Acc: 0.8729
 Site-QuickDraw                 (0) | Train Loss: 0.6719 | Train Acc: 0.7771
 Site-QuickDraw                 (0) | Train Loss: 0.6029 | Train Acc: 0.8347
 Site-Infograph                 (2) | Train Loss: 1.0957 | Train Acc: 0.6497
 Site-Infograph                 (7) | Train Loss: 0.7616 | Train Acc: 0.7669
Average Train Accuracy: 0.8485
============ Train epoch 30 ============
cnt=[1, 2, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (5) | Train Loss: 0.4380 | Train Acc: 0.8790
 Site-Clipart                   (5) | Train Loss: 0.3639 | Train Acc: 0.8898
 Site-Real                      (2) | Train Loss: 0.3226 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2074 | Train Acc: 0.9513
 Site-Painting                  (4) | Train Loss: 0.3812 | Train Acc: 0.8790
 Site-Painting                  (4) | Train Loss: 0.3196 | Train Acc: 0.9025
 Site-Sketch                    (7) | Train Loss: 0.3911 | Train Acc: 0.8917
 Site-Sketch                    (3) | Train Loss: 0.4126 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.6565 | Train Acc: 0.8217
 Site-QuickDraw                 (1) | Train Loss: 0.5877 | Train Acc: 0.8453
 Site-Infograph                 (0) | Train Loss: 1.0490 | Train Acc: 0.6815
 Site-Infograph                 (6) | Train Loss: 0.7760 | Train Acc: 0.7479
Average Train Accuracy: 0.8568
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8790
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.8898
 Best site-Real                      | Epoch:30 | Val Acc: 0.9299
 Best site-Real                      | Epoch:30 | Val Acc: 0.9513
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8790
 Best site-Painting                  | Epoch:30 | Val Acc: 0.9025
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8623
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.8217
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.8453
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.6815
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.7479
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 31 ============
cnt=[1, 1, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (4) | Train Loss: 0.4223 | Train Acc: 0.8662
 Site-Clipart                   (4) | Train Loss: 0.3936 | Train Acc: 0.8792
 Site-Real                      (5) | Train Loss: 0.3152 | Train Acc: 0.9108
 Site-Real                      (5) | Train Loss: 0.2233 | Train Acc: 0.9513
 Site-Painting                  (2) | Train Loss: 0.3469 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3156 | Train Acc: 0.9195
 Site-Sketch                    (0) | Train Loss: 0.4126 | Train Acc: 0.8790
 Site-Sketch                    (6) | Train Loss: 0.4187 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.6869 | Train Acc: 0.7643
 Site-QuickDraw                 (7) | Train Loss: 0.6116 | Train Acc: 0.8411
 Site-Infograph                 (3) | Train Loss: 1.0420 | Train Acc: 0.6497
 Site-Infograph                 (3) | Train Loss: 0.7570 | Train Acc: 0.7606
Average Train Accuracy: 0.8492
============ Train epoch 32 ============
cnt=[1, 2, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (7) | Train Loss: 0.3860 | Train Acc: 0.8854
 Site-Clipart                   (4) | Train Loss: 0.3670 | Train Acc: 0.8877
 Site-Real                      (5) | Train Loss: 0.3224 | Train Acc: 0.9172
 Site-Real                      (5) | Train Loss: 0.2165 | Train Acc: 0.9428
 Site-Painting                  (3) | Train Loss: 0.3738 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.3248 | Train Acc: 0.9068
 Site-Sketch                    (6) | Train Loss: 0.3323 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.3816 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.6484 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5804 | Train Acc: 0.8432
 Site-Infograph                 (2) | Train Loss: 1.0526 | Train Acc: 0.6752
 Site-Infograph                 (2) | Train Loss: 0.7532 | Train Acc: 0.7818
Average Train Accuracy: 0.8568
============ Train epoch 33 ============
cnt=[2, 2, 1, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (3) | Train Loss: 0.4235 | Train Acc: 0.8854
 Site-Clipart                   (3) | Train Loss: 0.3531 | Train Acc: 0.9004
 Site-Real                      (0) | Train Loss: 0.3167 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2148 | Train Acc: 0.9492
 Site-Painting                  (5) | Train Loss: 0.3795 | Train Acc: 0.8854
 Site-Painting                  (5) | Train Loss: 0.3244 | Train Acc: 0.9110
 Site-Sketch                    (4) | Train Loss: 0.3590 | Train Acc: 0.8854
 Site-Sketch                    (6) | Train Loss: 0.3752 | Train Acc: 0.8771
 Site-QuickDraw                 (1) | Train Loss: 0.6813 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.5546 | Train Acc: 0.8559
 Site-Infograph                 (2) | Train Loss: 1.0331 | Train Acc: 0.6624
 Site-Infograph                 (7) | Train Loss: 0.7399 | Train Acc: 0.7542
Average Train Accuracy: 0.8582
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.8854
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9004
 Best site-Real                      | Epoch:33 | Val Acc: 0.9299
 Best site-Real                      | Epoch:33 | Val Acc: 0.9492
 Best site-Painting                  | Epoch:33 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9110
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8854
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8771
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.8025
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.8559
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6624
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.7542
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 34 ============
cnt=[1, 2, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (0) | Train Loss: 0.4284 | Train Acc: 0.8726
 Site-Clipart                   (6) | Train Loss: 0.3639 | Train Acc: 0.8919
 Site-Real                      (3) | Train Loss: 0.2898 | Train Acc: 0.9236
 Site-Real                      (3) | Train Loss: 0.2105 | Train Acc: 0.9555
 Site-Painting                  (5) | Train Loss: 0.3287 | Train Acc: 0.9045
 Site-Painting                  (7) | Train Loss: 0.2755 | Train Acc: 0.9322
 Site-Sketch                    (4) | Train Loss: 0.4095 | Train Acc: 0.8917
 Site-Sketch                    (4) | Train Loss: 0.3815 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.6809 | Train Acc: 0.7580
 Site-QuickDraw                 (1) | Train Loss: 0.6066 | Train Acc: 0.8178
 Site-Infograph                 (2) | Train Loss: 1.0515 | Train Acc: 0.6561
 Site-Infograph                 (2) | Train Loss: 0.7471 | Train Acc: 0.7712
Average Train Accuracy: 0.8538
============ Train epoch 35 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (4) | Train Loss: 0.4229 | Train Acc: 0.8662
 Site-Clipart                   (4) | Train Loss: 0.3611 | Train Acc: 0.8750
 Site-Real                      (0) | Train Loss: 0.3282 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2195 | Train Acc: 0.9428
 Site-Painting                  (5) | Train Loss: 0.3347 | Train Acc: 0.9108
 Site-Painting                  (5) | Train Loss: 0.3230 | Train Acc: 0.9068
 Site-Sketch                    (3) | Train Loss: 0.3581 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.3882 | Train Acc: 0.8771
 Site-QuickDraw                 (6) | Train Loss: 0.6065 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.5669 | Train Acc: 0.8475
 Site-Infograph                 (2) | Train Loss: 0.9926 | Train Acc: 0.7006
 Site-Infograph                 (7) | Train Loss: 0.7316 | Train Acc: 0.7775
Average Train Accuracy: 0.8591
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.8662
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.8750
 Best site-Real                      | Epoch:35 | Val Acc: 0.9172
 Best site-Real                      | Epoch:35 | Val Acc: 0.9428
 Best site-Painting                  | Epoch:35 | Val Acc: 0.9108
 Best site-Painting                  | Epoch:35 | Val Acc: 0.9068
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.8790
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.8771
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.8089
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.8475
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.7006
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.7775
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 36 ============
cnt=[1, 2, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (7) | Train Loss: 0.4318 | Train Acc: 0.8662
 Site-Clipart                   (4) | Train Loss: 0.3489 | Train Acc: 0.8962
 Site-Real                      (5) | Train Loss: 0.3062 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.2121 | Train Acc: 0.9386
 Site-Painting                  (1) | Train Loss: 0.3261 | Train Acc: 0.9045
 Site-Painting                  (1) | Train Loss: 0.3210 | Train Acc: 0.8962
 Site-Sketch                    (3) | Train Loss: 0.3697 | Train Acc: 0.8917
 Site-Sketch                    (3) | Train Loss: 0.4020 | Train Acc: 0.8729
 Site-QuickDraw                 (6) | Train Loss: 0.6616 | Train Acc: 0.7643
 Site-QuickDraw                 (0) | Train Loss: 0.5581 | Train Acc: 0.8559
 Site-Infograph                 (2) | Train Loss: 1.0641 | Train Acc: 0.6433
 Site-Infograph                 (2) | Train Loss: 0.7194 | Train Acc: 0.7754
Average Train Accuracy: 0.8524
============ Train epoch 37 ============
cnt=[2, 2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (4) | Train Loss: 0.4428 | Train Acc: 0.8726
 Site-Clipart                   (4) | Train Loss: 0.3326 | Train Acc: 0.9110
 Site-Real                      (5) | Train Loss: 0.2897 | Train Acc: 0.9363
 Site-Real                      (5) | Train Loss: 0.2158 | Train Acc: 0.9449
 Site-Painting                  (1) | Train Loss: 0.3180 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.2891 | Train Acc: 0.9195
 Site-Sketch                    (3) | Train Loss: 0.3530 | Train Acc: 0.8917
 Site-Sketch                    (7) | Train Loss: 0.3777 | Train Acc: 0.8877
 Site-QuickDraw                 (0) | Train Loss: 0.6139 | Train Acc: 0.8280
 Site-QuickDraw                 (0) | Train Loss: 0.5652 | Train Acc: 0.8538
 Site-Infograph                 (6) | Train Loss: 1.0443 | Train Acc: 0.6879
 Site-Infograph                 (2) | Train Loss: 0.7068 | Train Acc: 0.7966
Average Train Accuracy: 0.8690
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.9110
 Best site-Real                      | Epoch:37 | Val Acc: 0.9363
 Best site-Real                      | Epoch:37 | Val Acc: 0.9449
 Best site-Painting                  | Epoch:37 | Val Acc: 0.8981
 Best site-Painting                  | Epoch:37 | Val Acc: 0.9195
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.8877
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.8280
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.8538
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.6879
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.7966
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (4) | Train Loss: 0.4053 | Train Acc: 0.8535
 Site-Clipart                   (4) | Train Loss: 0.3327 | Train Acc: 0.9089
 Site-Real                      (0) | Train Loss: 0.3157 | Train Acc: 0.9045
 Site-Real                      (0) | Train Loss: 0.1764 | Train Acc: 0.9513
 Site-Painting                  (5) | Train Loss: 0.3059 | Train Acc: 0.9236
 Site-Painting                  (5) | Train Loss: 0.3094 | Train Acc: 0.9110
 Site-Sketch                    (7) | Train Loss: 0.3491 | Train Acc: 0.8981
 Site-Sketch                    (3) | Train Loss: 0.3877 | Train Acc: 0.8602
 Site-QuickDraw                 (1) | Train Loss: 0.7192 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.5565 | Train Acc: 0.8475
 Site-Infograph                 (2) | Train Loss: 1.0814 | Train Acc: 0.6306
 Site-Infograph                 (6) | Train Loss: 0.6697 | Train Acc: 0.8051
Average Train Accuracy: 0.8538
============ Train epoch 39 ============
cnt=[2, 1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (3) | Train Loss: 0.4109 | Train Acc: 0.8917
 Site-Clipart                   (3) | Train Loss: 0.3321 | Train Acc: 0.8983
 Site-Real                      (5) | Train Loss: 0.2966 | Train Acc: 0.9299
 Site-Real                      (5) | Train Loss: 0.1995 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3160 | Train Acc: 0.9236
 Site-Painting                  (0) | Train Loss: 0.2873 | Train Acc: 0.9110
 Site-Sketch                    (4) | Train Loss: 0.3431 | Train Acc: 0.9045
 Site-Sketch                    (7) | Train Loss: 0.3788 | Train Acc: 0.8792
 Site-QuickDraw                 (6) | Train Loss: 0.6083 | Train Acc: 0.8153
 Site-QuickDraw                 (1) | Train Loss: 0.5584 | Train Acc: 0.8369
 Site-Infograph                 (2) | Train Loss: 0.9714 | Train Acc: 0.7261
 Site-Infograph                 (2) | Train Loss: 0.7073 | Train Acc: 0.7987
Average Train Accuracy: 0.8720
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.8983
 Best site-Real                      | Epoch:39 | Val Acc: 0.9299
 Best site-Real                      | Epoch:39 | Val Acc: 0.9492
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9236
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9110
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.9045
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8792
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.8153
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.8369
 Best site-Infograph                 | Epoch:39 | Val Acc: 0.7261
 Best site-Infograph                 | Epoch:39 | Val Acc: 0.7987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 40 ============
cnt=[1, 2, 2, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (4) | Train Loss: 0.3836 | Train Acc: 0.8726
 Site-Clipart                   (4) | Train Loss: 0.3417 | Train Acc: 0.8983
 Site-Real                      (1) | Train Loss: 0.3192 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.1931 | Train Acc: 0.9513
 Site-Painting                  (5) | Train Loss: 0.3355 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.2787 | Train Acc: 0.9258
 Site-Sketch                    (7) | Train Loss: 0.3385 | Train Acc: 0.8854
 Site-Sketch                    (3) | Train Loss: 0.3635 | Train Acc: 0.8750
 Site-QuickDraw                 (0) | Train Loss: 0.6064 | Train Acc: 0.8217
 Site-QuickDraw                 (6) | Train Loss: 0.5210 | Train Acc: 0.8623
 Site-Infograph                 (2) | Train Loss: 0.9733 | Train Acc: 0.7261
 Site-Infograph                 (2) | Train Loss: 0.6503 | Train Acc: 0.8051
Average Train Accuracy: 0.8699
============ Train epoch 41 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (6) | Train Loss: 0.3627 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.3361 | Train Acc: 0.9047
 Site-Real                      (4) | Train Loss: 0.2860 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.2019 | Train Acc: 0.9428
 Site-Painting                  (3) | Train Loss: 0.3432 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.3140 | Train Acc: 0.9216
 Site-Sketch                    (5) | Train Loss: 0.3268 | Train Acc: 0.9108
 Site-Sketch                    (5) | Train Loss: 0.3433 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.6660 | Train Acc: 0.7834
 Site-QuickDraw                 (7) | Train Loss: 0.5296 | Train Acc: 0.8602
 Site-Infograph                 (0) | Train Loss: 0.9120 | Train Acc: 0.7261
 Site-Infograph                 (0) | Train Loss: 0.6826 | Train Acc: 0.7966
Average Train Accuracy: 0.8695
============ Train epoch 42 ============
cnt=[1, 1, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                   (4) | Train Loss: 0.4021 | Train Acc: 0.8662
 Site-Clipart                   (4) | Train Loss: 0.3395 | Train Acc: 0.9004
 Site-Real                      (5) | Train Loss: 0.3247 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.1944 | Train Acc: 0.9534
 Site-Painting                  (0) | Train Loss: 0.3057 | Train Acc: 0.9172
 Site-Painting                  (7) | Train Loss: 0.3053 | Train Acc: 0.9216
 Site-Sketch                    (3) | Train Loss: 0.3566 | Train Acc: 0.8917
 Site-Sketch                    (3) | Train Loss: 0.3766 | Train Acc: 0.8708
 Site-QuickDraw                 (1) | Train Loss: 0.5651 | Train Acc: 0.8217
 Site-QuickDraw                 (6) | Train Loss: 0.5388 | Train Acc: 0.8242
 Site-Infograph                 (2) | Train Loss: 0.9535 | Train Acc: 0.6879
 Site-Infograph                 (2) | Train Loss: 0.6388 | Train Acc: 0.8136
Average Train Accuracy: 0.8660
============ Train epoch 43 ============
cnt=[2, 1, 2, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (7) | Train Loss: 0.4164 | Train Acc: 0.8535
 Site-Clipart                   (4) | Train Loss: 0.3162 | Train Acc: 0.9131
 Site-Real                      (5) | Train Loss: 0.2787 | Train Acc: 0.9363
 Site-Real                      (5) | Train Loss: 0.1884 | Train Acc: 0.9555
 Site-Painting                  (3) | Train Loss: 0.3442 | Train Acc: 0.8917
 Site-Painting                  (3) | Train Loss: 0.3066 | Train Acc: 0.9131
 Site-Sketch                    (0) | Train Loss: 0.3462 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.3411 | Train Acc: 0.8877
 Site-QuickDraw                 (1) | Train Loss: 0.5851 | Train Acc: 0.7962
 Site-QuickDraw                 (6) | Train Loss: 0.5225 | Train Acc: 0.8602
 Site-Infograph                 (2) | Train Loss: 1.0271 | Train Acc: 0.6943
 Site-Infograph                 (2) | Train Loss: 0.6452 | Train Acc: 0.8178
Average Train Accuracy: 0.8676
============ Train epoch 44 ============
cnt=[1, 1, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (7) | Train Loss: 0.3998 | Train Acc: 0.8726
 Site-Clipart                   (0) | Train Loss: 0.3066 | Train Acc: 0.9131
 Site-Real                      (5) | Train Loss: 0.3181 | Train Acc: 0.9236
 Site-Real                      (5) | Train Loss: 0.1878 | Train Acc: 0.9470
 Site-Painting                  (3) | Train Loss: 0.3472 | Train Acc: 0.8854
 Site-Painting                  (3) | Train Loss: 0.2751 | Train Acc: 0.9216
 Site-Sketch                    (4) | Train Loss: 0.3838 | Train Acc: 0.8917
 Site-Sketch                    (4) | Train Loss: 0.3537 | Train Acc: 0.8919
 Site-QuickDraw                 (6) | Train Loss: 0.5652 | Train Acc: 0.8280
 Site-QuickDraw                 (1) | Train Loss: 0.5078 | Train Acc: 0.8623
 Site-Infograph                 (2) | Train Loss: 0.9796 | Train Acc: 0.7261
 Site-Infograph                 (2) | Train Loss: 0.6521 | Train Acc: 0.8030
Average Train Accuracy: 0.8722
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:44 | Val Acc: 0.9131
 Best site-Real                      | Epoch:44 | Val Acc: 0.9236
 Best site-Real                      | Epoch:44 | Val Acc: 0.9470
 Best site-Painting                  | Epoch:44 | Val Acc: 0.8854
 Best site-Painting                  | Epoch:44 | Val Acc: 0.9216
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.8917
 Best site-Sketch                    | Epoch:44 | Val Acc: 0.8919
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.8280
 Best site-QuickDraw                 | Epoch:44 | Val Acc: 0.8623
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.7261
 Best site-Infograph                 | Epoch:44 | Val Acc: 0.8030
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 45 ============
cnt=[2, 2, 1, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (4) | Train Loss: 0.3658 | Train Acc: 0.8917
 Site-Clipart                   (4) | Train Loss: 0.3192 | Train Acc: 0.9153
 Site-Real                      (0) | Train Loss: 0.2879 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.1761 | Train Acc: 0.9576
 Site-Painting                  (5) | Train Loss: 0.3598 | Train Acc: 0.8981
 Site-Painting                  (5) | Train Loss: 0.3089 | Train Acc: 0.9089
 Site-Sketch                    (6) | Train Loss: 0.3479 | Train Acc: 0.8726
 Site-Sketch                    (3) | Train Loss: 0.3619 | Train Acc: 0.8877
 Site-QuickDraw                 (1) | Train Loss: 0.5777 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.5181 | Train Acc: 0.8623
 Site-Infograph                 (2) | Train Loss: 0.9878 | Train Acc: 0.7325
 Site-Infograph                 (7) | Train Loss: 0.6463 | Train Acc: 0.8114
Average Train Accuracy: 0.8726
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.8917
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9153
 Best site-Real                      | Epoch:45 | Val Acc: 0.9299
 Best site-Real                      | Epoch:45 | Val Acc: 0.9576
 Best site-Painting                  | Epoch:45 | Val Acc: 0.8981
 Best site-Painting                  | Epoch:45 | Val Acc: 0.9089
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.8726
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.8877
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.8025
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.8623
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.7325
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.8114
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 1, 2, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (5) | Train Loss: 0.4064 | Train Acc: 0.8662
 Site-Clipart                   (5) | Train Loss: 0.3186 | Train Acc: 0.9131
 Site-Real                      (3) | Train Loss: 0.2916 | Train Acc: 0.9299
 Site-Real                      (3) | Train Loss: 0.1878 | Train Acc: 0.9449
 Site-Painting                  (4) | Train Loss: 0.3475 | Train Acc: 0.9045
 Site-Painting                  (4) | Train Loss: 0.2709 | Train Acc: 0.9301
 Site-Sketch                    (7) | Train Loss: 0.3760 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.3507 | Train Acc: 0.8814
 Site-QuickDraw                 (6) | Train Loss: 0.5934 | Train Acc: 0.8344
 Site-QuickDraw                 (1) | Train Loss: 0.5083 | Train Acc: 0.8665
 Site-Infograph                 (2) | Train Loss: 1.0007 | Train Acc: 0.6688
 Site-Infograph                 (2) | Train Loss: 0.6299 | Train Acc: 0.8157
Average Train Accuracy: 0.8706
============ Train epoch 47 ============
cnt=[2, 1, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (4) | Train Loss: 0.4020 | Train Acc: 0.8726
 Site-Clipart                   (4) | Train Loss: 0.3155 | Train Acc: 0.9237
 Site-Real                      (5) | Train Loss: 0.2779 | Train Acc: 0.9363
 Site-Real                      (5) | Train Loss: 0.1902 | Train Acc: 0.9449
 Site-Painting                  (3) | Train Loss: 0.3212 | Train Acc: 0.9045
 Site-Painting                  (3) | Train Loss: 0.2909 | Train Acc: 0.9110
 Site-Sketch                    (0) | Train Loss: 0.3415 | Train Acc: 0.9108
 Site-Sketch                    (0) | Train Loss: 0.3098 | Train Acc: 0.9004
 Site-QuickDraw                 (1) | Train Loss: 0.5736 | Train Acc: 0.8025
 Site-QuickDraw                 (6) | Train Loss: 0.4825 | Train Acc: 0.8665
 Site-Infograph                 (7) | Train Loss: 0.8918 | Train Acc: 0.7325
 Site-Infograph                 (2) | Train Loss: 0.6164 | Train Acc: 0.8305
Average Train Accuracy: 0.8780
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.8726
 Best site-Clipart                   | Epoch:47 | Val Acc: 0.9237
 Best site-Real                      | Epoch:47 | Val Acc: 0.9363
 Best site-Real                      | Epoch:47 | Val Acc: 0.9449
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9045
 Best site-Painting                  | Epoch:47 | Val Acc: 0.9110
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.9108
 Best site-Sketch                    | Epoch:47 | Val Acc: 0.9004
 Best site-QuickDraw                 | Epoch:47 | Val Acc: 0.8025
 Best site-QuickDraw                 | Epoch:47 | Val Acc: 0.8665
 Best site-Infograph                 | Epoch:47 | Val Acc: 0.7325
 Best site-Infograph                 | Epoch:47 | Val Acc: 0.8305
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_8/ccop_q=1...
============ Train epoch 48 ============
cnt=[1, 2, 1, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (5) | Train Loss: 0.3850 | Train Acc: 0.8662
 Site-Clipart                   (5) | Train Loss: 0.3150 | Train Acc: 0.8962
 Site-Real                      (4) | Train Loss: 0.3033 | Train Acc: 0.9236
 Site-Real                      (4) | Train Loss: 0.1906 | Train Acc: 0.9597
 Site-Painting                  (0) | Train Loss: 0.3344 | Train Acc: 0.9045
 Site-Painting                  (7) | Train Loss: 0.2758 | Train Acc: 0.9216
 Site-Sketch                    (3) | Train Loss: 0.3432 | Train Acc: 0.8790
 Site-Sketch                    (3) | Train Loss: 0.3515 | Train Acc: 0.8877
 Site-QuickDraw                 (1) | Train Loss: 0.5772 | Train Acc: 0.8280
 Site-QuickDraw                 (1) | Train Loss: 0.4766 | Train Acc: 0.8708
 Site-Infograph                 (2) | Train Loss: 0.9590 | Train Acc: 0.6879
 Site-Infograph                 (6) | Train Loss: 0.6313 | Train Acc: 0.8263
Average Train Accuracy: 0.8710
============ Train epoch 49 ============
cnt=[2, 1, 2, 2, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (3) | Train Loss: 0.3969 | Train Acc: 0.8917
 Site-Clipart                   (3) | Train Loss: 0.2868 | Train Acc: 0.9237
 Site-Real                      (4) | Train Loss: 0.3051 | Train Acc: 0.9299
 Site-Real                      (4) | Train Loss: 0.1916 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.2940 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.2614 | Train Acc: 0.9280
 Site-Sketch                    (5) | Train Loss: 0.3600 | Train Acc: 0.8854
 Site-Sketch                    (6) | Train Loss: 0.3467 | Train Acc: 0.8792
 Site-QuickDraw                 (7) | Train Loss: 0.6150 | Train Acc: 0.8280
 Site-QuickDraw                 (1) | Train Loss: 0.5023 | Train Acc: 0.8623
 Site-Infograph                 (2) | Train Loss: 0.9744 | Train Acc: 0.7134
 Site-Infograph                 (2) | Train Loss: 0.6034 | Train Acc: 0.8157
Average Train Accuracy: 0.8768
 Test site-Clipart                   (3)| Epoch:47 | Test Acc: 0.8669
 Test site-Real                      (4)| Epoch:47 | Test Acc: 0.9425
 Test site-Painting                  (0)| Epoch:47 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:47 | Test Acc: 0.8773
 Test site-QuickDraw                 (7)| Epoch:47 | Test Acc: 0.8100
 Test site-Infograph                 (2)| Epoch:47 | Test Acc: 0.6210
Clipart: 0.8669, Real: 0.9425, Painting: 0.9241, Sketch: 0.8773, QuickDraw: 0.8100, Infograph: 0.6210, 
Average Test Accuracy(group): 0.8403, Average Test Accuracy(individual): 0.8403,
domain std=0.1069, cluster std=0.0941, individual std=0.1069, 
===2023-08-17 09:03:57===
===2023-08-17 09:04:13===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    domain_num: 8
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 8
Loading snapshots...
 Test site-Clipart                   (4)| Epoch:47 | Test Acc: 0.8669
 Test site-Real                      (5)| Epoch:47 | Test Acc: 0.9425
 Test site-Painting                  (3)| Epoch:47 | Test Acc: 0.9192
 Test site-Sketch                    (0)| Epoch:47 | Test Acc: 0.8791
 Test site-QuickDraw                 (1)| Epoch:47 | Test Acc: 0.8100
 Test site-Infograph                 (7)| Epoch:47 | Test Acc: 0.6271
Clipart: 0.8669, Real: 0.9425, Painting: 0.9192, Sketch: 0.8791, QuickDraw: 0.8100, Infograph: 0.6271, 
Average Test Accuracy(group): 0.8408, Average Test Accuracy(individual): 0.8408,
domain std=0.1043, cluster std=0.1142, individual std=0.1043, 
