===2023-08-10 19:51:26===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 8
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 8
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[9, 1, 1, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (5) | Train Loss: 1.8995 | Train Acc: 0.1429
 Site-photo                     (0) | Train Loss: 1.7820 | Train Acc: 0.3889
 Site-photo                     (0) | Train Loss: 1.7170 | Train Acc: 0.2917
 Site-photo                     (0) | Train Loss: 1.6573 | Train Acc: 0.5161
 Site-photo                     (0) | Train Loss: 1.7674 | Train Acc: 0.3000
 Site-photo                     (0) | Train Loss: 1.7652 | Train Acc: 0.3269
 Site-photo                     (0) | Train Loss: 1.5944 | Train Acc: 0.5294
 Site-photo                     (0) | Train Loss: 1.6861 | Train Acc: 0.4205
 Site-photo                     (0) | Train Loss: 1.6968 | Train Acc: 0.4248
 Site-photo                     (0) | Train Loss: 1.7747 | Train Acc: 0.3425
 Site-art_painting              (7) | Train Loss: 1.8106 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7839 | Train Acc: 0.3182
 Site-art_painting              (3) | Train Loss: 1.9499 | Train Acc: 0.2250
 Site-art_painting              (3) | Train Loss: 2.0031 | Train Acc: 0.1528
 Site-art_painting              (3) | Train Loss: 1.8656 | Train Acc: 0.2812
 Site-cartoon                   (4) | Train Loss: 1.8688 | Train Acc: 0.2727
 Site-cartoon                   (6) | Train Loss: 1.8914 | Train Acc: 0.2087
 Site-sketch                    (1) | Train Loss: 1.9540 | Train Acc: 0.2069
Average Train Accuracy: 0.3203
 Site-photo                     (5) | Val  Loss: 1.7900 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7503 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7375 | Val  Acc: 0.3125
 Site-photo                     (0) | Val  Loss: 1.7571 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7398 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7356 | Val  Acc: 0.4000
 Site-photo                     (0) | Val  Loss: 1.6118 | Val  Acc: 0.4222
 Site-photo                     (0) | Val  Loss: 1.6694 | Val  Acc: 0.4310
 Site-photo                     (0) | Val  Loss: 1.7507 | Val  Acc: 0.4533
 Site-photo                     (0) | Val  Loss: 1.7079 | Val  Acc: 0.3918
 Site-art_painting              (7) | Val  Loss: 2.0499 | Val  Acc: 0.1250
 Site-art_painting              (2) | Val  Loss: 1.8044 | Val  Acc: 0.3333
 Site-art_painting              (3) | Val  Loss: 1.6685 | Val  Acc: 0.3462
 Site-art_painting              (3) | Val  Loss: 1.9233 | Val  Acc: 0.1915
 Site-art_painting              (3) | Val  Loss: 1.9554 | Val  Acc: 0.2000
 Site-cartoon                   (4) | Val  Loss: 1.9725 | Val  Acc: 0.1429
 Site-cartoon                   (6) | Val  Loss: 1.8865 | Val  Acc: 0.1948
 Site-sketch                    (1) | Val  Loss: 1.9095 | Val  Acc: 0.2308
Average Valid Accuracy: 0.3060
 Best site-photo                    (5)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3125
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4222
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4310
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4533
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3918
 Best site-art_painting             (7)  | Epoch:0 | Val Acc: 0.1250
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.3462
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.1915
 Best site-art_painting             (3)  | Epoch:0 | Val Acc: 0.2000
 Best site-cartoon                  (4)  | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                  (6)  | Epoch:0 | Val Acc: 0.1948
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 1, 1, 9, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (4) | Train Loss: 1.7897 | Train Acc: 0.3571
 Site-photo                     (4) | Train Loss: 1.6001 | Train Acc: 0.6111
 Site-photo                     (4) | Train Loss: 1.6276 | Train Acc: 0.3333
 Site-photo                     (4) | Train Loss: 1.5473 | Train Acc: 0.5806
 Site-photo                     (0) | Train Loss: 1.5921 | Train Acc: 0.4000
 Site-photo                     (4) | Train Loss: 1.5914 | Train Acc: 0.4615
 Site-photo                     (4) | Train Loss: 1.3751 | Train Acc: 0.5000
 Site-photo                     (4) | Train Loss: 1.5727 | Train Acc: 0.4659
 Site-photo                     (4) | Train Loss: 1.5821 | Train Acc: 0.4867
 Site-photo                     (4) | Train Loss: 1.6639 | Train Acc: 0.4315
 Site-art_painting              (5) | Train Loss: 1.6601 | Train Acc: 0.4167
 Site-art_painting              (1) | Train Loss: 1.7064 | Train Acc: 0.3182
 Site-art_painting              (6) | Train Loss: 1.9719 | Train Acc: 0.1750
 Site-art_painting              (6) | Train Loss: 1.7010 | Train Acc: 0.2500
 Site-art_painting              (6) | Train Loss: 1.7619 | Train Acc: 0.2969
 Site-cartoon                   (7) | Train Loss: 1.8202 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8865 | Train Acc: 0.2174
 Site-sketch                    (2) | Train Loss: 1.9487 | Train Acc: 0.1724
Average Train Accuracy: 0.3748
 Site-photo                     (4) | Val  Loss: 1.6914 | Val  Acc: 0.3333
 Site-photo                     (4) | Val  Loss: 1.6677 | Val  Acc: 0.4167
 Site-photo                     (4) | Val  Loss: 1.6044 | Val  Acc: 0.5625
 Site-photo                     (4) | Val  Loss: 1.6037 | Val  Acc: 0.5238
 Site-photo                     (0) | Val  Loss: 1.5646 | Val  Acc: 0.4074
 Site-photo                     (4) | Val  Loss: 1.6552 | Val  Acc: 0.4571
 Site-photo                     (4) | Val  Loss: 1.4936 | Val  Acc: 0.5333
 Site-photo                     (4) | Val  Loss: 1.5388 | Val  Acc: 0.5172
 Site-photo                     (4) | Val  Loss: 1.6044 | Val  Acc: 0.5333
 Site-photo                     (4) | Val  Loss: 1.5521 | Val  Acc: 0.4948
 Site-art_painting              (5) | Val  Loss: 1.9411 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.6785 | Val  Acc: 0.3333
 Site-art_painting              (6) | Val  Loss: 1.6493 | Val  Acc: 0.3077
 Site-art_painting              (6) | Val  Loss: 1.7730 | Val  Acc: 0.2766
 Site-art_painting              (6) | Val  Loss: 1.8158 | Val  Acc: 0.2353
 Site-cartoon                   (7) | Val  Loss: 1.8954 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.9076 | Val  Acc: 0.2338
 Site-sketch                    (2) | Val  Loss: 1.9185 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3744
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.3333
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.4167
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.5625
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.5238
 Best site-photo                    (0)  | Epoch:1 | Val Acc: 0.4074
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.4571
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.5172
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (4)  | Epoch:1 | Val Acc: 0.4948
 Best site-art_painting             (5)  | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting             (6)  | Epoch:1 | Val Acc: 0.3077
 Best site-art_painting             (6)  | Epoch:1 | Val Acc: 0.2766
 Best site-art_painting             (6)  | Epoch:1 | Val Acc: 0.2353
 Best site-cartoon                  (7)  | Epoch:1 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:1 | Val Acc: 0.2338
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 2 ============
cnt=[8, 3, 1, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.7183 | Train Acc: 0.4286
 Site-photo                     (6) | Train Loss: 1.4651 | Train Acc: 0.6111
 Site-photo                     (3) | Train Loss: 1.5134 | Train Acc: 0.4583
 Site-photo                     (0) | Train Loss: 1.4297 | Train Acc: 0.5806
 Site-photo                     (0) | Train Loss: 1.4655 | Train Acc: 0.5500
 Site-photo                     (0) | Train Loss: 1.4925 | Train Acc: 0.6346
 Site-photo                     (0) | Train Loss: 1.4734 | Train Acc: 0.6618
 Site-photo                     (0) | Train Loss: 1.4835 | Train Acc: 0.6364
 Site-photo                     (0) | Train Loss: 1.4411 | Train Acc: 0.6106
 Site-photo                     (0) | Train Loss: 1.5149 | Train Acc: 0.5616
 Site-art_painting              (4) | Train Loss: 1.6685 | Train Acc: 0.4167
 Site-art_painting              (1) | Train Loss: 1.7242 | Train Acc: 0.5000
 Site-art_painting              (7) | Train Loss: 1.8372 | Train Acc: 0.3000
 Site-art_painting              (1) | Train Loss: 1.6673 | Train Acc: 0.3333
 Site-art_painting              (1) | Train Loss: 1.7009 | Train Acc: 0.3750
 Site-cartoon                   (5) | Train Loss: 1.6851 | Train Acc: 0.2727
 Site-cartoon                   (5) | Train Loss: 1.8201 | Train Acc: 0.2435
 Site-sketch                    (2) | Train Loss: 1.9141 | Train Acc: 0.2759
Average Train Accuracy: 0.4695
 Site-photo                     (0) | Val  Loss: 1.5272 | Val  Acc: 0.5556
 Site-photo                     (6) | Val  Loss: 1.5251 | Val  Acc: 0.4167
 Site-photo                     (3) | Val  Loss: 1.4605 | Val  Acc: 0.5625
 Site-photo                     (0) | Val  Loss: 1.4895 | Val  Acc: 0.7143
 Site-photo                     (0) | Val  Loss: 1.4604 | Val  Acc: 0.4815
 Site-photo                     (0) | Val  Loss: 1.5275 | Val  Acc: 0.5143
 Site-photo                     (0) | Val  Loss: 1.3851 | Val  Acc: 0.6444
 Site-photo                     (0) | Val  Loss: 1.4234 | Val  Acc: 0.6379
 Site-photo                     (0) | Val  Loss: 1.5108 | Val  Acc: 0.6400
 Site-photo                     (0) | Val  Loss: 1.4120 | Val  Acc: 0.6598
 Site-art_painting              (4) | Val  Loss: 1.8671 | Val  Acc: 0.1250
 Site-art_painting              (1) | Val  Loss: 1.6872 | Val  Acc: 0.2667
 Site-art_painting              (7) | Val  Loss: 1.6019 | Val  Acc: 0.3846
 Site-art_painting              (1) | Val  Loss: 1.6904 | Val  Acc: 0.3617
 Site-art_painting              (1) | Val  Loss: 1.7545 | Val  Acc: 0.3176
 Site-cartoon                   (5) | Val  Loss: 1.7927 | Val  Acc: 0.2857
 Site-cartoon                   (5) | Val  Loss: 1.8081 | Val  Acc: 0.2468
 Site-sketch                    (2) | Val  Loss: 1.9120 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4441
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5556
 Best site-photo                    (6)  | Epoch:2 | Val Acc: 0.4167
 Best site-photo                    (3)  | Epoch:2 | Val Acc: 0.5625
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7143
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.4815
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5143
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6444
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6379
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6400
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6598
 Best site-art_painting             (4)  | Epoch:2 | Val Acc: 0.1250
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2667
 Best site-art_painting             (7)  | Epoch:2 | Val Acc: 0.3846
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3617
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3176
 Best site-cartoon                  (5)  | Epoch:2 | Val Acc: 0.2857
 Best site-cartoon                  (5)  | Epoch:2 | Val Acc: 0.2468
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 3 ============
cnt=[8, 4, 1, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (7) | Train Loss: 1.5557 | Train Acc: 0.4286
 Site-photo                     (4) | Train Loss: 1.3695 | Train Acc: 0.7222
 Site-photo                     (0) | Train Loss: 1.3649 | Train Acc: 0.6250
 Site-photo                     (0) | Train Loss: 1.2729 | Train Acc: 0.8065
 Site-photo                     (0) | Train Loss: 1.3217 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 1.3295 | Train Acc: 0.6538
 Site-photo                     (0) | Train Loss: 1.2375 | Train Acc: 0.7794
 Site-photo                     (0) | Train Loss: 1.3045 | Train Acc: 0.7273
 Site-photo                     (0) | Train Loss: 1.3183 | Train Acc: 0.7699
 Site-photo                     (0) | Train Loss: 1.3757 | Train Acc: 0.6712
 Site-art_painting              (5) | Train Loss: 1.6015 | Train Acc: 0.5833
 Site-art_painting              (1) | Train Loss: 1.6567 | Train Acc: 0.5909
 Site-art_painting              (1) | Train Loss: 1.7456 | Train Acc: 0.3000
 Site-art_painting              (1) | Train Loss: 1.5800 | Train Acc: 0.4028
 Site-art_painting              (1) | Train Loss: 1.6450 | Train Acc: 0.4141
 Site-cartoon                   (6) | Train Loss: 1.5873 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 1.7349 | Train Acc: 0.3739
 Site-sketch                    (3) | Train Loss: 1.8560 | Train Acc: 0.2931
Average Train Accuracy: 0.5799
 Site-photo                     (7) | Val  Loss: 1.3400 | Val  Acc: 0.6667
 Site-photo                     (4) | Val  Loss: 1.3793 | Val  Acc: 0.5833
 Site-photo                     (0) | Val  Loss: 1.3942 | Val  Acc: 0.6875
 Site-photo                     (0) | Val  Loss: 1.3326 | Val  Acc: 0.7619
 Site-photo                     (0) | Val  Loss: 1.4077 | Val  Acc: 0.6667
 Site-photo                     (0) | Val  Loss: 1.3639 | Val  Acc: 0.6571
 Site-photo                     (0) | Val  Loss: 1.2673 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.2863 | Val  Acc: 0.7414
 Site-photo                     (0) | Val  Loss: 1.3138 | Val  Acc: 0.7600
 Site-photo                     (0) | Val  Loss: 1.2397 | Val  Acc: 0.7835
 Site-art_painting              (5) | Val  Loss: 1.8280 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.6849 | Val  Acc: 0.3333
 Site-art_painting              (1) | Val  Loss: 1.5736 | Val  Acc: 0.3462
 Site-art_painting              (1) | Val  Loss: 1.6427 | Val  Acc: 0.5319
 Site-art_painting              (1) | Val  Loss: 1.6885 | Val  Acc: 0.4235
 Site-cartoon                   (6) | Val  Loss: 1.7931 | Val  Acc: 0.0000
 Site-cartoon                   (2) | Val  Loss: 1.7519 | Val  Acc: 0.2857
 Site-sketch                    (3) | Val  Loss: 1.8996 | Val  Acc: 0.1795
Average Valid Accuracy: 0.5218
 Best site-photo                    (7)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (4)  | Epoch:3 | Val Acc: 0.5833
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6875
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7619
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6571
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7414
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7600
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7835
 Best site-art_painting             (5)  | Epoch:3 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3462
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5319
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.4235
 Best site-cartoon                  (6)  | Epoch:3 | Val Acc: 0.0000
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.2857
 Best site-sketch                   (3)  | Epoch:3 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 4 ============
cnt=[1, 8, 1, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (7) | Train Loss: 1.3945 | Train Acc: 0.7857
 Site-photo                     (5) | Train Loss: 1.2257 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 1.2314 | Train Acc: 0.7917
 Site-photo                     (1) | Train Loss: 1.1310 | Train Acc: 0.9032
 Site-photo                     (1) | Train Loss: 1.2039 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 1.1599 | Train Acc: 0.8846
 Site-photo                     (1) | Train Loss: 1.1111 | Train Acc: 0.8676
 Site-photo                     (1) | Train Loss: 1.1610 | Train Acc: 0.8636
 Site-photo                     (1) | Train Loss: 1.1952 | Train Acc: 0.8584
 Site-photo                     (1) | Train Loss: 1.1609 | Train Acc: 0.8562
 Site-art_painting              (6) | Train Loss: 1.6557 | Train Acc: 0.4167
 Site-art_painting              (0) | Train Loss: 1.5572 | Train Acc: 0.6364
 Site-art_painting              (4) | Train Loss: 1.6701 | Train Acc: 0.3500
 Site-art_painting              (4) | Train Loss: 1.5905 | Train Acc: 0.5139
 Site-art_painting              (4) | Train Loss: 1.5353 | Train Acc: 0.5000
 Site-cartoon                   (3) | Train Loss: 1.5341 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 1.6955 | Train Acc: 0.3478
 Site-sketch                    (2) | Train Loss: 1.8503 | Train Acc: 0.2069
Average Train Accuracy: 0.6737
 Site-photo                     (7) | Val  Loss: 1.2619 | Val  Acc: 0.7778
 Site-photo                     (5) | Val  Loss: 1.2341 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.2092 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2470 | Val  Acc: 0.8095
 Site-photo                     (1) | Val  Loss: 1.2588 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 1.2275 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 1.1164 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1422 | Val  Acc: 0.8966
 Site-photo                     (1) | Val  Loss: 1.1941 | Val  Acc: 0.8667
 Site-photo                     (1) | Val  Loss: 1.1213 | Val  Acc: 0.9072
 Site-art_painting              (6) | Val  Loss: 1.5646 | Val  Acc: 0.5000
 Site-art_painting              (0) | Val  Loss: 1.6177 | Val  Acc: 0.4667
 Site-art_painting              (4) | Val  Loss: 1.4623 | Val  Acc: 0.5769
 Site-art_painting              (4) | Val  Loss: 1.5423 | Val  Acc: 0.5106
 Site-art_painting              (4) | Val  Loss: 1.5718 | Val  Acc: 0.4353
 Site-cartoon                   (3) | Val  Loss: 1.6960 | Val  Acc: 0.1429
 Site-cartoon                   (3) | Val  Loss: 1.7170 | Val  Acc: 0.4156
 Site-sketch                    (2) | Val  Loss: 1.8723 | Val  Acc: 0.1795
Average Valid Accuracy: 0.6579
 Best site-photo                    (7)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (5)  | Epoch:4 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8095
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8966
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.8667
 Best site-photo                    (1)  | Epoch:4 | Val Acc: 0.9072
 Best site-art_painting             (6)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (0)  | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting             (4)  | Epoch:4 | Val Acc: 0.5769
 Best site-art_painting             (4)  | Epoch:4 | Val Acc: 0.5106
 Best site-art_painting             (4)  | Epoch:4 | Val Acc: 0.4353
 Best site-cartoon                  (3)  | Epoch:4 | Val Acc: 0.1429
 Best site-cartoon                  (3)  | Epoch:4 | Val Acc: 0.4156
 Best site-sketch                   (2)  | Epoch:4 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 8, 4, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (0) | Train Loss: 1.2747 | Train Acc: 0.7857
 Site-photo                     (1) | Train Loss: 1.0331 | Train Acc: 0.8889
 Site-photo                     (7) | Train Loss: 1.1812 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 0.9743 | Train Acc: 0.9032
 Site-photo                     (1) | Train Loss: 1.0497 | Train Acc: 0.9000
 Site-photo                     (1) | Train Loss: 1.0793 | Train Acc: 0.8462
 Site-photo                     (1) | Train Loss: 1.0713 | Train Acc: 0.8824
 Site-photo                     (1) | Train Loss: 1.0453 | Train Acc: 0.9091
 Site-photo                     (1) | Train Loss: 1.0384 | Train Acc: 0.9381
 Site-photo                     (1) | Train Loss: 1.0751 | Train Acc: 0.8836
 Site-art_painting              (4) | Train Loss: 1.4761 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.5277 | Train Acc: 0.5909
 Site-art_painting              (2) | Train Loss: 1.6062 | Train Acc: 0.4250
 Site-art_painting              (2) | Train Loss: 1.4764 | Train Acc: 0.5278
 Site-art_painting              (2) | Train Loss: 1.4506 | Train Acc: 0.5859
 Site-cartoon                   (5) | Train Loss: 1.4874 | Train Acc: 0.5455
 Site-cartoon                   (6) | Train Loss: 1.6575 | Train Acc: 0.3826
 Site-sketch                    (3) | Train Loss: 1.7953 | Train Acc: 0.2586
Average Train Accuracy: 0.6946
 Site-photo                     (0) | Val  Loss: 1.1221 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1157 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 1.0670 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.1011 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 1.1156 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.0900 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 0.9617 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 1.0056 | Val  Acc: 0.9310
 Site-photo                     (1) | Val  Loss: 1.0406 | Val  Acc: 0.9200
 Site-photo                     (1) | Val  Loss: 0.9914 | Val  Acc: 0.9381
 Site-art_painting              (4) | Val  Loss: 1.6944 | Val  Acc: 0.2500
 Site-art_painting              (2) | Val  Loss: 1.5239 | Val  Acc: 0.4667
 Site-art_painting              (2) | Val  Loss: 1.3559 | Val  Acc: 0.6923
 Site-art_painting              (2) | Val  Loss: 1.4402 | Val  Acc: 0.5745
 Site-art_painting              (2) | Val  Loss: 1.5014 | Val  Acc: 0.5294
 Site-cartoon                   (5) | Val  Loss: 1.5183 | Val  Acc: 0.4286
 Site-cartoon                   (6) | Val  Loss: 1.6269 | Val  Acc: 0.3896
 Site-sketch                    (3) | Val  Loss: 1.8226 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7107
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9167
 Best site-photo                    (7)  | Epoch:5 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9310
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9200
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9381
 Best site-art_painting             (4)  | Epoch:5 | Val Acc: 0.2500
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.4667
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6923
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.5745
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.5294
 Best site-cartoon                  (5)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (6)  | Epoch:5 | Val Acc: 0.3896
 Best site-sketch                   (3)  | Epoch:5 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 4, 1, 8, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (3) | Train Loss: 1.1085 | Train Acc: 0.9286
 Site-photo                     (6) | Train Loss: 0.9426 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 1.0135 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.8840 | Train Acc: 0.9677
 Site-photo                     (3) | Train Loss: 0.9036 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.9512 | Train Acc: 0.9038
 Site-photo                     (3) | Train Loss: 0.8629 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.8863 | Train Acc: 0.9432
 Site-photo                     (3) | Train Loss: 0.9219 | Train Acc: 0.9292
 Site-photo                     (3) | Train Loss: 0.9563 | Train Acc: 0.9178
 Site-art_painting              (5) | Train Loss: 1.4359 | Train Acc: 0.5833
 Site-art_painting              (1) | Train Loss: 1.4891 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.5122 | Train Acc: 0.4500
 Site-art_painting              (1) | Train Loss: 1.4123 | Train Acc: 0.6250
 Site-art_painting              (1) | Train Loss: 1.3772 | Train Acc: 0.6328
 Site-cartoon                   (7) | Train Loss: 1.4579 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 1.5905 | Train Acc: 0.4261
 Site-sketch                    (4) | Train Loss: 1.7965 | Train Acc: 0.3276
Average Train Accuracy: 0.7557
 Site-photo                     (3) | Val  Loss: 0.9761 | Val  Acc: 0.7778
 Site-photo                     (6) | Val  Loss: 0.9587 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.9498 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.9514 | Val  Acc: 0.9048
 Site-photo                     (3) | Val  Loss: 0.9282 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 1.0110 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.8444 | Val  Acc: 0.9333
 Site-photo                     (3) | Val  Loss: 0.8797 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.9422 | Val  Acc: 0.9733
 Site-photo                     (3) | Val  Loss: 0.8683 | Val  Acc: 0.9381
 Site-art_painting              (5) | Val  Loss: 1.6250 | Val  Acc: 0.3750
 Site-art_painting              (1) | Val  Loss: 1.3743 | Val  Acc: 0.6000
 Site-art_painting              (1) | Val  Loss: 1.3047 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.4129 | Val  Acc: 0.6170
 Site-art_painting              (1) | Val  Loss: 1.3672 | Val  Acc: 0.6588
 Site-cartoon                   (7) | Val  Loss: 1.6063 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.5797 | Val  Acc: 0.4416
 Site-sketch                    (4) | Val  Loss: 1.8123 | Val  Acc: 0.2821
Average Valid Accuracy: 0.7325
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.7778
 Best site-photo                    (6)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9429
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9333
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9655
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9733
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9381
 Best site-art_painting             (5)  | Epoch:6 | Val Acc: 0.3750
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6000
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6170
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6588
 Best site-cartoon                  (7)  | Epoch:6 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.4416
 Best site-sketch                   (4)  | Epoch:6 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 4, 1, 1, 1, 1, 6, 3, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (6) | Train Loss: 1.0500 | Train Acc: 0.7857
 Site-photo                     (1) | Train Loss: 0.8613 | Train Acc: 0.8889
 Site-photo                     (6) | Train Loss: 0.9648 | Train Acc: 0.7500
 Site-photo                     (6) | Train Loss: 0.7716 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.8081 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.8357 | Train Acc: 0.9231
 Site-photo                     (6) | Train Loss: 0.6628 | Train Acc: 0.9853
 Site-photo                     (6) | Train Loss: 0.8142 | Train Acc: 0.9318
 Site-photo                     (6) | Train Loss: 0.8094 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.8287 | Train Acc: 0.9247
 Site-art_painting              (0) | Train Loss: 1.3410 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.3875 | Train Acc: 0.6818
 Site-art_painting              (7) | Train Loss: 1.4095 | Train Acc: 0.5750
 Site-art_painting              (7) | Train Loss: 1.3081 | Train Acc: 0.6528
 Site-art_painting              (7) | Train Loss: 1.2885 | Train Acc: 0.6641
 Site-cartoon                   (5) | Train Loss: 1.2884 | Train Acc: 0.6364
 Site-cartoon                   (4) | Train Loss: 1.5105 | Train Acc: 0.5043
 Site-sketch                    (3) | Train Loss: 1.7680 | Train Acc: 0.2931
Average Train Accuracy: 0.7697
 Site-photo                     (6) | Val  Loss: 0.9210 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.9217 | Val  Acc: 0.8333
 Site-photo                     (6) | Val  Loss: 0.8557 | Val  Acc: 0.9375
 Site-photo                     (6) | Val  Loss: 0.8671 | Val  Acc: 0.9048
 Site-photo                     (1) | Val  Loss: 0.8550 | Val  Acc: 0.9259
 Site-photo                     (1) | Val  Loss: 0.8745 | Val  Acc: 0.9429
 Site-photo                     (6) | Val  Loss: 0.7492 | Val  Acc: 0.9778
 Site-photo                     (6) | Val  Loss: 0.7998 | Val  Acc: 0.9655
 Site-photo                     (6) | Val  Loss: 0.8447 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.7807 | Val  Acc: 0.9381
 Site-art_painting              (0) | Val  Loss: 1.4786 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.3128 | Val  Acc: 0.7333
 Site-art_painting              (7) | Val  Loss: 1.2482 | Val  Acc: 0.7308
 Site-art_painting              (7) | Val  Loss: 1.2698 | Val  Acc: 0.6596
 Site-art_painting              (7) | Val  Loss: 1.2937 | Val  Acc: 0.6118
 Site-cartoon                   (5) | Val  Loss: 1.4334 | Val  Acc: 0.4286
 Site-cartoon                   (4) | Val  Loss: 1.5379 | Val  Acc: 0.4935
 Site-sketch                    (3) | Val  Loss: 1.8160 | Val  Acc: 0.1282
Average Valid Accuracy: 0.7479
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.9375
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.9048
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9259
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9429
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.9778
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.9655
 Best site-photo                    (6)  | Epoch:7 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9381
 Best site-art_painting             (0)  | Epoch:7 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.7333
 Best site-art_painting             (7)  | Epoch:7 | Val Acc: 0.7308
 Best site-art_painting             (7)  | Epoch:7 | Val Acc: 0.6596
 Best site-art_painting             (7)  | Epoch:7 | Val Acc: 0.6118
 Best site-cartoon                  (5)  | Epoch:7 | Val Acc: 0.4286
 Best site-cartoon                  (4)  | Epoch:7 | Val Acc: 0.4935
 Best site-sketch                   (3)  | Epoch:7 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 5, 1, 1, 5, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (4) | Train Loss: 0.8770 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.7183 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.8880 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.7098 | Train Acc: 0.9355
 Site-photo                     (4) | Train Loss: 0.7030 | Train Acc: 0.9250
 Site-photo                     (4) | Train Loss: 0.7501 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.6185 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.7661 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.7138 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.7737 | Train Acc: 0.9521
 Site-art_painting              (5) | Train Loss: 1.2790 | Train Acc: 0.6667
 Site-art_painting              (3) | Train Loss: 1.3309 | Train Acc: 0.7273
 Site-art_painting              (6) | Train Loss: 1.3944 | Train Acc: 0.5500
 Site-art_painting              (6) | Train Loss: 1.1437 | Train Acc: 0.7500
 Site-art_painting              (6) | Train Loss: 1.2104 | Train Acc: 0.7422
 Site-cartoon                   (0) | Train Loss: 1.3264 | Train Acc: 0.4545
 Site-cartoon                   (7) | Train Loss: 1.4668 | Train Acc: 0.5391
 Site-sketch                    (2) | Train Loss: 1.7681 | Train Acc: 0.3103
Average Train Accuracy: 0.7900
 Site-photo                     (4) | Val  Loss: 0.7771 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.8261 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.7046 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7389 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.7594 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.7942 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.6730 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.6908 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.7315 | Val  Acc: 0.9733
 Site-photo                     (4) | Val  Loss: 0.6849 | Val  Acc: 0.9588
 Site-art_painting              (5) | Val  Loss: 1.2119 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 1.2433 | Val  Acc: 0.7333
 Site-art_painting              (6) | Val  Loss: 1.1534 | Val  Acc: 0.8462
 Site-art_painting              (6) | Val  Loss: 1.2772 | Val  Acc: 0.7447
 Site-art_painting              (6) | Val  Loss: 1.2322 | Val  Acc: 0.6706
 Site-cartoon                   (0) | Val  Loss: 1.5217 | Val  Acc: 0.1429
 Site-cartoon                   (7) | Val  Loss: 1.4438 | Val  Acc: 0.5195
 Site-sketch                    (2) | Val  Loss: 1.7891 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7919
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9524
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9483
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (4)  | Epoch:8 | Val Acc: 0.9588
 Best site-art_painting             (5)  | Epoch:8 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.7333
 Best site-art_painting             (6)  | Epoch:8 | Val Acc: 0.8462
 Best site-art_painting             (6)  | Epoch:8 | Val Acc: 0.7447
 Best site-art_painting             (6)  | Epoch:8 | Val Acc: 0.6706
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.1429
 Best site-cartoon                  (7)  | Epoch:8 | Val Acc: 0.5195
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 7, 2, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (5) | Train Loss: 0.8497 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.7341 | Train Acc: 0.8889
 Site-photo                     (6) | Train Loss: 0.7910 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.6262 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 0.6271 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6652 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.6470 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6958 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.6446 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6784 | Train Acc: 0.9452
 Site-art_painting              (3) | Train Loss: 1.2197 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.2495 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 1.3494 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.2133 | Train Acc: 0.6806
 Site-art_painting              (3) | Train Loss: 1.1491 | Train Acc: 0.7344
 Site-cartoon                   (2) | Train Loss: 1.2324 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.4190 | Train Acc: 0.6174
 Site-sketch                    (4) | Train Loss: 1.7365 | Train Acc: 0.3276
Average Train Accuracy: 0.8152
 Site-photo                     (5) | Val  Loss: 0.6631 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.7907 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.6659 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.6579 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6919 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7310 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.5895 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.6329 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6166 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.6385 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 1.2254 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.1493 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 1.1395 | Val  Acc: 0.8077
 Site-art_painting              (3) | Val  Loss: 1.1253 | Val  Acc: 0.8298
 Site-art_painting              (3) | Val  Loss: 1.1495 | Val  Acc: 0.7176
 Site-cartoon                   (2) | Val  Loss: 1.4699 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.4232 | Val  Acc: 0.5714
 Site-sketch                    (4) | Val  Loss: 1.7632 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8239
 Best site-photo                    (5)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (7)  | Epoch:9 | Val Acc: 0.9167
 Best site-photo                    (6)  | Epoch:9 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9588
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8077
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.8298
 Best site-art_painting             (3)  | Epoch:9 | Val Acc: 0.7176
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.5714
 Best site-sketch                   (4)  | Epoch:9 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 1, 3, 1, 1, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (5) | Train Loss: 0.7698 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.6043 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.7157 | Train Acc: 0.9167
 Site-photo                     (2) | Train Loss: 0.5792 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.6039 | Train Acc: 0.9750
 Site-photo                     (5) | Train Loss: 0.6352 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.4058 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.5533 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.5911 | Train Acc: 0.9646
 Site-photo                     (5) | Train Loss: 0.6306 | Train Acc: 0.9589
 Site-art_painting              (6) | Train Loss: 1.2079 | Train Acc: 0.5833
 Site-art_painting              (0) | Train Loss: 1.2240 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.1926 | Train Acc: 0.6500
 Site-art_painting              (0) | Train Loss: 1.1584 | Train Acc: 0.7222
 Site-art_painting              (0) | Train Loss: 1.0222 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 1.0986 | Train Acc: 0.7273
 Site-cartoon                   (7) | Train Loss: 1.3383 | Train Acc: 0.6435
 Site-sketch                    (1) | Train Loss: 1.6541 | Train Acc: 0.3103
Average Train Accuracy: 0.8283
 Site-photo                     (5) | Val  Loss: 0.6470 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.7533 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.5750 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5967 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.6302 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.6488 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.5593 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.5799 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.6040 | Val  Acc: 0.9733
 Site-photo                     (5) | Val  Loss: 0.6091 | Val  Acc: 0.9588
 Site-art_painting              (6) | Val  Loss: 1.0419 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.0431 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 1.0251 | Val  Acc: 0.7692
 Site-art_painting              (0) | Val  Loss: 1.0440 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 1.0905 | Val  Acc: 0.7294
 Site-cartoon                   (3) | Val  Loss: 1.4155 | Val  Acc: 0.4286
 Site-cartoon                   (7) | Val  Loss: 1.3170 | Val  Acc: 0.5974
 Site-sketch                    (1) | Val  Loss: 1.6520 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8350
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:10 | Val Acc: 0.9524
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:10 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 0.9733
 Best site-photo                    (5)  | Epoch:10 | Val Acc: 0.9588
 Best site-art_painting             (6)  | Epoch:10 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.7692
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.8511
 Best site-art_painting             (0)  | Epoch:10 | Val Acc: 0.7294
 Best site-cartoon                  (3)  | Epoch:10 | Val Acc: 0.4286
 Best site-cartoon                  (7)  | Epoch:10 | Val Acc: 0.5974
 Best site-sketch                   (1)  | Epoch:10 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 6, 1, 1, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (5) | Train Loss: 0.6508 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5786 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.6563 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.5298 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5755 | Train Acc: 0.9750
 Site-photo                     (5) | Train Loss: 0.5645 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.4921 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5158 | Train Acc: 0.9318
 Site-photo                     (1) | Train Loss: 0.5512 | Train Acc: 0.9558
 Site-photo                     (5) | Train Loss: 0.5683 | Train Acc: 0.9658
 Site-art_painting              (7) | Train Loss: 1.0241 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 1.1184 | Train Acc: 0.7727
 Site-art_painting              (4) | Train Loss: 1.2049 | Train Acc: 0.5750
 Site-art_painting              (4) | Train Loss: 1.1502 | Train Acc: 0.7778
 Site-art_painting              (4) | Train Loss: 1.0295 | Train Acc: 0.8281
 Site-cartoon                   (6) | Train Loss: 1.0523 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.2310 | Train Acc: 0.7130
 Site-sketch                    (3) | Train Loss: 1.6016 | Train Acc: 0.3793
Average Train Accuracy: 0.8539
 Site-photo                     (5) | Val  Loss: 0.5749 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6894 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.5548 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.5603 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5663 | Val  Acc: 0.9630
 Site-photo                     (5) | Val  Loss: 0.6215 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.5121 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.5131 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.5551 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.5240 | Val  Acc: 0.9691
 Site-art_painting              (7) | Val  Loss: 0.9535 | Val  Acc: 0.8750
 Site-art_painting              (4) | Val  Loss: 1.1297 | Val  Acc: 0.8000
 Site-art_painting              (4) | Val  Loss: 0.8934 | Val  Acc: 0.8462
 Site-art_painting              (4) | Val  Loss: 0.9948 | Val  Acc: 0.7872
 Site-art_painting              (4) | Val  Loss: 0.9988 | Val  Acc: 0.8000
 Site-cartoon                   (6) | Val  Loss: 1.5589 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.3069 | Val  Acc: 0.6494
 Site-sketch                    (3) | Val  Loss: 1.6831 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8175
============ Train epoch 12 ============
cnt=[1, 2, 1, 4, 1, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (5) | Train Loss: 0.6317 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.6148 | Train Acc: 0.8889
 Site-photo                     (5) | Train Loss: 0.6569 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 0.5065 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.5188 | Train Acc: 0.9750
 Site-photo                     (5) | Train Loss: 0.5384 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.3731 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.5240 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.5133 | Train Acc: 0.9646
 Site-photo                     (5) | Train Loss: 0.5444 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.9971 | Train Acc: 0.5833
 Site-art_painting              (3) | Train Loss: 1.1455 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.0520 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 0.8843 | Train Acc: 0.7917
 Site-art_painting              (3) | Train Loss: 0.8940 | Train Acc: 0.8516
 Site-cartoon                   (4) | Train Loss: 0.9838 | Train Acc: 0.9091
 Site-cartoon                   (7) | Train Loss: 1.2208 | Train Acc: 0.6522
 Site-sketch                    (2) | Train Loss: 1.5779 | Train Acc: 0.3621
Average Train Accuracy: 0.8440
 Site-photo                     (5) | Val  Loss: 0.5845 | Val  Acc: 0.8889
 Site-photo                     (6) | Val  Loss: 0.6264 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.4945 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4552 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.5389 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.5920 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.4556 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.4846 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.4770 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.5049 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.9504 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 1.0261 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 0.8293 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.9394 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.9841 | Val  Acc: 0.8118
 Site-cartoon                   (4) | Val  Loss: 1.4046 | Val  Acc: 0.5714
 Site-cartoon                   (7) | Val  Loss: 1.2082 | Val  Acc: 0.6883
 Site-sketch                    (2) | Val  Loss: 1.6142 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8556
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.8889
 Best site-photo                    (6)  | Epoch:12 | Val Acc: 0.9167
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9524
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:12 | Val Acc: 0.9556
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.9867
 Best site-photo                    (5)  | Epoch:12 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:12 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.9149
 Best site-art_painting             (3)  | Epoch:12 | Val Acc: 0.8118
 Best site-cartoon                  (4)  | Epoch:12 | Val Acc: 0.5714
 Best site-cartoon                  (7)  | Epoch:12 | Val Acc: 0.6883
 Best site-sketch                   (2)  | Epoch:12 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 4, 5, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (3) | Train Loss: 0.6171 | Train Acc: 0.9286
 Site-photo                     (7) | Train Loss: 0.5447 | Train Acc: 0.8889
 Site-photo                     (6) | Train Loss: 0.5300 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4841 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4694 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.4783 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.3590 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.4785 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.4788 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.5064 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 1.0109 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.1710 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.0312 | Train Acc: 0.7000
 Site-art_painting              (2) | Train Loss: 0.9486 | Train Acc: 0.8056
 Site-art_painting              (2) | Train Loss: 0.8729 | Train Acc: 0.8047
 Site-cartoon                   (5) | Train Loss: 0.8721 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 1.1076 | Train Acc: 0.7391
 Site-sketch                    (4) | Train Loss: 1.4872 | Train Acc: 0.5172
Average Train Accuracy: 0.8673
 Site-photo                     (3) | Val  Loss: 0.5686 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.5252 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.4720 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.4563 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5255 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5401 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.4547 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.4687 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.4644 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.4806 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.9365 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.8080 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.8440 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.8922 | Val  Acc: 0.8085
 Site-art_painting              (2) | Val  Loss: 0.9163 | Val  Acc: 0.7529
 Site-cartoon                   (5) | Val  Loss: 1.1581 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.1725 | Val  Acc: 0.7403
 Site-sketch                    (4) | Val  Loss: 1.5641 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8670
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.8889
 Best site-photo                    (7)  | Epoch:13 | Val Acc: 0.9167
 Best site-photo                    (6)  | Epoch:13 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9429
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:13 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:13 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8462
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8085
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.7529
 Best site-cartoon                  (5)  | Epoch:13 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:13 | Val Acc: 0.7403
 Best site-sketch                   (4)  | Epoch:13 | Val Acc: 0.4103
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 1, 4, 2, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (2) | Train Loss: 0.5774 | Train Acc: 0.8571
 Site-photo                     (6) | Train Loss: 0.4507 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.5657 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4286 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4362 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4187 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3161 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.4341 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.4335 | Train Acc: 0.9646
 Site-photo                     (2) | Train Loss: 0.4506 | Train Acc: 0.9589
 Site-art_painting              (4) | Train Loss: 0.9961 | Train Acc: 0.7500
 Site-art_painting              (5) | Train Loss: 1.0587 | Train Acc: 0.6818
 Site-art_painting              (7) | Train Loss: 0.9528 | Train Acc: 0.8000
 Site-art_painting              (5) | Train Loss: 0.8838 | Train Acc: 0.8750
 Site-art_painting              (5) | Train Loss: 0.8193 | Train Acc: 0.8203
 Site-cartoon                   (3) | Train Loss: 0.8282 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 1.0811 | Train Acc: 0.7478
 Site-sketch                    (1) | Train Loss: 1.4677 | Train Acc: 0.5000
Average Train Accuracy: 0.8749
 Site-photo                     (2) | Val  Loss: 0.5142 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.5623 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.4225 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.4456 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.4616 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5187 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.4187 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.4532 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.4305 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4340 | Val  Acc: 0.9794
 Site-art_painting              (4) | Val  Loss: 0.7023 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.8486 | Val  Acc: 0.8667
 Site-art_painting              (7) | Val  Loss: 0.7880 | Val  Acc: 0.8462
 Site-art_painting              (5) | Val  Loss: 0.9038 | Val  Acc: 0.7660
 Site-art_painting              (5) | Val  Loss: 0.8878 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.2322 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.0992 | Val  Acc: 0.7532
 Site-sketch                    (1) | Val  Loss: 1.4661 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8736
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (6)  | Epoch:14 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9483
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9794
 Best site-art_painting             (4)  | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting             (7)  | Epoch:14 | Val Acc: 0.8462
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.7660
 Best site-art_painting             (5)  | Epoch:14 | Val Acc: 0.8235
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:14 | Val Acc: 0.7532
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 15 ============
cnt=[1, 3, 1, 1, 4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (5) | Train Loss: 0.5535 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.4347 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.5186 | Train Acc: 0.9583
 Site-photo                     (5) | Train Loss: 0.3981 | Train Acc: 0.9677
 Site-photo                     (6) | Train Loss: 0.4276 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3979 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2574 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.4234 | Train Acc: 0.9318
 Site-photo                     (1) | Train Loss: 0.4182 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.4421 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 0.8546 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.8846 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.9405 | Train Acc: 0.7750
 Site-art_painting              (4) | Train Loss: 0.6076 | Train Acc: 0.8194
 Site-art_painting              (4) | Train Loss: 0.7895 | Train Acc: 0.8438
 Site-cartoon                   (7) | Train Loss: 0.8319 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 1.0254 | Train Acc: 0.7304
 Site-sketch                    (3) | Train Loss: 1.4288 | Train Acc: 0.5345
Average Train Accuracy: 0.8848
 Site-photo                     (5) | Val  Loss: 0.4369 | Val  Acc: 0.8889
 Site-photo                     (6) | Val  Loss: 0.4884 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.4080 | Val  Acc: 0.9375
 Site-photo                     (5) | Val  Loss: 0.3999 | Val  Acc: 0.9524
 Site-photo                     (6) | Val  Loss: 0.4108 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5010 | Val  Acc: 0.9429
 Site-photo                     (5) | Val  Loss: 0.3821 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.4121 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.4053 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.3782 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.7460 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.8084 | Val  Acc: 0.8000
 Site-art_painting              (4) | Val  Loss: 0.7324 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.8233 | Val  Acc: 0.8298
 Site-art_painting              (4) | Val  Loss: 0.8468 | Val  Acc: 0.7765
 Site-cartoon                   (7) | Val  Loss: 1.3226 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.0957 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.4387 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8705
============ Train epoch 16 ============
cnt=[1, 2, 5, 3, 1, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (3) | Train Loss: 0.4780 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.4205 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.4954 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.3859 | Train Acc: 0.9677
 Site-photo                     (2) | Train Loss: 0.3773 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3693 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.3890 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3933 | Train Acc: 0.9432
 Site-photo                     (3) | Train Loss: 0.3922 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.3648 | Train Acc: 0.9795
 Site-art_painting              (5) | Train Loss: 0.6787 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.9402 | Train Acc: 0.8182
 Site-art_painting              (7) | Train Loss: 0.9458 | Train Acc: 0.7500
 Site-art_painting              (7) | Train Loss: 0.6744 | Train Acc: 0.8333
 Site-art_painting              (7) | Train Loss: 0.7217 | Train Acc: 0.8906
 Site-cartoon                   (1) | Train Loss: 0.7904 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.9816 | Train Acc: 0.7739
 Site-sketch                    (4) | Train Loss: 1.3498 | Train Acc: 0.5517
Average Train Accuracy: 0.8930
 Site-photo                     (3) | Val  Loss: 0.3712 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.4404 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.3354 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3523 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3640 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4611 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.3759 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.3766 | Val  Acc: 0.9483
 Site-photo                     (3) | Val  Loss: 0.3895 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.3464 | Val  Acc: 0.9794
 Site-art_painting              (5) | Val  Loss: 0.6786 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.7346 | Val  Acc: 0.7333
 Site-art_painting              (7) | Val  Loss: 0.7158 | Val  Acc: 0.7692
 Site-art_painting              (7) | Val  Loss: 0.7876 | Val  Acc: 0.7872
 Site-art_painting              (7) | Val  Loss: 0.8005 | Val  Acc: 0.8353
 Site-cartoon                   (1) | Val  Loss: 1.1117 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.0605 | Val  Acc: 0.7662
 Site-sketch                    (4) | Val  Loss: 1.4037 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8669
============ Train epoch 17 ============
cnt=[6, 1, 5, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (6) | Train Loss: 0.4647 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.3433 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4578 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3425 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3784 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.3558 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2568 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.3779 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.3464 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.3440 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.6409 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.8891 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.8979 | Train Acc: 0.7000
 Site-art_painting              (2) | Train Loss: 0.8312 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.6861 | Train Acc: 0.8281
 Site-cartoon                   (5) | Train Loss: 0.7439 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.9498 | Train Acc: 0.7652
 Site-sketch                    (3) | Train Loss: 1.2919 | Train Acc: 0.5862
Average Train Accuracy: 0.8989
 Site-photo                     (6) | Val  Loss: 0.5086 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4762 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.3032 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3625 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.3490 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4257 | Val  Acc: 0.9429
 Site-photo                     (7) | Val  Loss: 0.3399 | Val  Acc: 0.9556
 Site-photo                     (7) | Val  Loss: 0.3924 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.3507 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3359 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.4796 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.8570 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.5932 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.6859 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.7565 | Val  Acc: 0.8353
 Site-cartoon                   (5) | Val  Loss: 1.0978 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.0668 | Val  Acc: 0.7662
 Site-sketch                    (3) | Val  Loss: 1.2185 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8966
 Best site-photo                    (6)  | Epoch:17 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (4)  | Epoch:17 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9429
 Best site-photo                    (7)  | Epoch:17 | Val Acc: 0.9556
 Best site-photo                    (7)  | Epoch:17 | Val Acc: 0.9483
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:17 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8723
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8353
 Best site-cartoon                  (5)  | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:17 | Val Acc: 0.7662
 Best site-sketch                   (3)  | Epoch:17 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 18 ============
cnt=[3, 2, 1, 2, 2, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (7) | Train Loss: 0.4389 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.3532 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.4059 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.3230 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.3658 | Train Acc: 0.9500
 Site-photo                     (7) | Train Loss: 0.3475 | Train Acc: 0.9615
 Site-photo                     (4) | Train Loss: 0.3073 | Train Acc: 0.9853
 Site-photo                     (7) | Train Loss: 0.3381 | Train Acc: 0.9318
 Site-photo                     (7) | Train Loss: 0.3198 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.3482 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.7798 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.7946 | Train Acc: 0.7727
 Site-art_painting              (5) | Train Loss: 0.7713 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.7186 | Train Acc: 0.8472
 Site-art_painting              (0) | Train Loss: 0.6183 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 0.8371 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.9396 | Train Acc: 0.7739
 Site-sketch                    (2) | Train Loss: 1.2035 | Train Acc: 0.6552
Average Train Accuracy: 0.8969
 Site-photo                     (7) | Val  Loss: 0.3244 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.3520 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.3058 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.3306 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.3175 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.3907 | Val  Acc: 0.9714
 Site-photo                     (4) | Val  Loss: 0.3354 | Val  Acc: 0.9556
 Site-photo                     (7) | Val  Loss: 0.3552 | Val  Acc: 0.9483
 Site-photo                     (7) | Val  Loss: 0.3381 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3080 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.4585 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.6766 | Val  Acc: 0.8000
 Site-art_painting              (5) | Val  Loss: 0.6002 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6536 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.6416 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 0.9731 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.9632 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.3073 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8960
============ Train epoch 19 ============
cnt=[4, 1, 1, 1, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (0) | Train Loss: 0.4302 | Train Acc: 0.9286
 Site-photo                     (5) | Train Loss: 0.3046 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.4143 | Train Acc: 0.9167
 Site-photo                     (7) | Train Loss: 0.2980 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.3140 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.3156 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3010 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3177 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2943 | Train Acc: 0.9823
 Site-photo                     (7) | Train Loss: 0.3074 | Train Acc: 0.9795
 Site-art_painting              (4) | Train Loss: 0.8816 | Train Acc: 0.7500
 Site-art_painting              (4) | Train Loss: 0.7389 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.7218 | Train Acc: 0.7750
 Site-art_painting              (4) | Train Loss: 0.5394 | Train Acc: 0.8750
 Site-art_painting              (4) | Train Loss: 0.6236 | Train Acc: 0.8750
 Site-cartoon                   (1) | Train Loss: 0.8210 | Train Acc: 0.7273
 Site-cartoon                   (6) | Train Loss: 0.8748 | Train Acc: 0.7652
 Site-sketch                    (2) | Train Loss: 1.1213 | Train Acc: 0.6379
Average Train Accuracy: 0.8858
 Site-photo                     (0) | Val  Loss: 0.4797 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.3819 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.3090 | Val  Acc: 0.9375
 Site-photo                     (7) | Val  Loss: 0.3157 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.3000 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.3537 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2907 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3087 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.3021 | Val  Acc: 0.9733
 Site-photo                     (7) | Val  Loss: 0.2889 | Val  Acc: 0.9897
 Site-art_painting              (4) | Val  Loss: 0.6024 | Val  Acc: 0.8750
 Site-art_painting              (4) | Val  Loss: 0.5716 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.5716 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.6601 | Val  Acc: 0.8723
 Site-art_painting              (4) | Val  Loss: 0.6250 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 0.8877 | Val  Acc: 0.8571
 Site-cartoon                   (6) | Val  Loss: 0.9189 | Val  Acc: 0.7792
 Site-sketch                    (2) | Val  Loss: 1.1854 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8992
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:19 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9375
 Best site-photo                    (7)  | Epoch:19 | Val Acc: 0.9524
 Best site-photo                    (7)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (7)  | Epoch:19 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9733
 Best site-photo                    (7)  | Epoch:19 | Val Acc: 0.9897
 Best site-art_painting             (4)  | Epoch:19 | Val Acc: 0.8750
 Best site-art_painting             (4)  | Epoch:19 | Val Acc: 0.9333
 Best site-art_painting             (4)  | Epoch:19 | Val Acc: 0.9231
 Best site-art_painting             (4)  | Epoch:19 | Val Acc: 0.8723
 Best site-art_painting             (4)  | Epoch:19 | Val Acc: 0.8588
 Best site-cartoon                  (1)  | Epoch:19 | Val Acc: 0.8571
 Best site-cartoon                  (6)  | Epoch:19 | Val Acc: 0.7792
 Best site-sketch                   (2)  | Epoch:19 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 5, 1, 1, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.3504 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3283 | Train Acc: 0.9444
 Site-photo                     (6) | Train Loss: 0.3768 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2685 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2953 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.2767 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3515 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.3338 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2633 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.2918 | Train Acc: 0.9726
 Site-art_painting              (7) | Train Loss: 0.6258 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.7625 | Train Acc: 0.8636
 Site-art_painting              (7) | Train Loss: 0.7013 | Train Acc: 0.8250
 Site-art_painting              (7) | Train Loss: 0.5567 | Train Acc: 0.8889
 Site-art_painting              (7) | Train Loss: 0.6131 | Train Acc: 0.8750
 Site-cartoon                   (3) | Train Loss: 0.6744 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.8389 | Train Acc: 0.7652
 Site-sketch                    (2) | Train Loss: 1.0875 | Train Acc: 0.7069
Average Train Accuracy: 0.9102
 Site-photo                     (0) | Val  Loss: 0.4699 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.4509 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.2523 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3057 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2992 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3394 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2944 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2803 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2574 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2927 | Val  Acc: 0.9794
 Site-art_painting              (7) | Val  Loss: 0.4751 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.6793 | Val  Acc: 0.7333
 Site-art_painting              (7) | Val  Loss: 0.4905 | Val  Acc: 0.9615
 Site-art_painting              (7) | Val  Loss: 0.5732 | Val  Acc: 0.8723
 Site-art_painting              (7) | Val  Loss: 0.5993 | Val  Acc: 0.8941
 Site-cartoon                   (3) | Val  Loss: 0.9329 | Val  Acc: 0.8571
 Site-cartoon                   (5) | Val  Loss: 0.9169 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 1.0391 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9156
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:20 | Val Acc: 0.9167
 Best site-photo                    (6)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:20 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:20 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:20 | Val Acc: 0.9794
 Best site-art_painting             (7)  | Epoch:20 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:20 | Val Acc: 0.7333
 Best site-art_painting             (7)  | Epoch:20 | Val Acc: 0.9615
 Best site-art_painting             (7)  | Epoch:20 | Val Acc: 0.8723
 Best site-art_painting             (7)  | Epoch:20 | Val Acc: 0.8941
 Best site-cartoon                  (3)  | Epoch:20 | Val Acc: 0.8571
 Best site-cartoon                  (5)  | Epoch:20 | Val Acc: 0.8182
 Best site-sketch                   (2)  | Epoch:20 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 2, 4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (0) | Train Loss: 0.3830 | Train Acc: 0.9286
 Site-photo                     (5) | Train Loss: 0.2770 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3891 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 0.2537 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3057 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.2885 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.2238 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.2909 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2668 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.3078 | Train Acc: 0.9795
 Site-art_painting              (7) | Train Loss: 0.5535 | Train Acc: 0.9167
 Site-art_painting              (6) | Train Loss: 0.7412 | Train Acc: 0.8182
 Site-art_painting              (4) | Train Loss: 0.7343 | Train Acc: 0.7500
 Site-art_painting              (4) | Train Loss: 0.5797 | Train Acc: 0.8889
 Site-art_painting              (4) | Train Loss: 0.5414 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.7023 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7554 | Train Acc: 0.8435
 Site-sketch                    (3) | Train Loss: 1.1011 | Train Acc: 0.6552
Average Train Accuracy: 0.9037
 Site-photo                     (0) | Val  Loss: 0.2730 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.4024 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2058 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2880 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2442 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3079 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2686 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2816 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2497 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2576 | Val  Acc: 0.9588
 Site-art_painting              (7) | Val  Loss: 0.4008 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.4425 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.4579 | Val  Acc: 0.9615
 Site-art_painting              (4) | Val  Loss: 0.5222 | Val  Acc: 0.9149
 Site-art_painting              (4) | Val  Loss: 0.6328 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 1.0602 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.8248 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.1797 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9173
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:21 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9588
 Best site-art_painting             (7)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (6)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:21 | Val Acc: 0.9615
 Best site-art_painting             (4)  | Epoch:21 | Val Acc: 0.9149
 Best site-art_painting             (4)  | Epoch:21 | Val Acc: 0.8824
 Best site-cartoon                  (1)  | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:21 | Val Acc: 0.7532
 Best site-sketch                   (3)  | Epoch:21 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 22 ============
cnt=[8, 1, 1, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.3294 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.4161 | Train Acc: 0.8889
 Site-photo                     (7) | Train Loss: 0.3474 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2672 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3029 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.2556 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1894 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3417 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2519 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2946 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.5685 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.7181 | Train Acc: 0.8636
 Site-art_painting              (5) | Train Loss: 0.7294 | Train Acc: 0.7750
 Site-art_painting              (5) | Train Loss: 0.5799 | Train Acc: 0.9028
 Site-art_painting              (5) | Train Loss: 0.5381 | Train Acc: 0.9141
 Site-cartoon                   (6) | Train Loss: 0.6709 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 0.7202 | Train Acc: 0.8261
 Site-sketch                    (1) | Train Loss: 1.0862 | Train Acc: 0.6379
Average Train Accuracy: 0.9115
 Site-photo                     (0) | Val  Loss: 0.4191 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.3882 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.2363 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2928 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2220 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3208 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2353 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2605 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2473 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2461 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.4483 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.4636 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.5199 | Val  Acc: 0.9231
 Site-art_painting              (5) | Val  Loss: 0.4875 | Val  Acc: 0.9362
 Site-art_painting              (5) | Val  Loss: 0.5483 | Val  Acc: 0.8471
 Site-cartoon                   (6) | Val  Loss: 1.0042 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 0.7933 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 1.0389 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9150
============ Train epoch 23 ============
cnt=[3, 1, 8, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (2) | Train Loss: 0.3789 | Train Acc: 0.9286
 Site-photo                     (4) | Train Loss: 0.2691 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.3356 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.2181 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2786 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.2765 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.1438 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2775 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.2520 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.2421 | Train Acc: 0.9795
 Site-art_painting              (6) | Train Loss: 0.5163 | Train Acc: 0.9167
 Site-art_painting              (7) | Train Loss: 0.6923 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.6818 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.4456 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5422 | Train Acc: 0.8672
 Site-cartoon                   (5) | Train Loss: 0.5676 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7135 | Train Acc: 0.8000
 Site-sketch                    (3) | Train Loss: 1.0235 | Train Acc: 0.7414
Average Train Accuracy: 0.9075
 Site-photo                     (2) | Val  Loss: 0.2125 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.4000 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2243 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.3132 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2232 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2931 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2712 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2439 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2322 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2213 | Val  Acc: 0.9897
 Site-art_painting              (6) | Val  Loss: 0.4009 | Val  Acc: 1.0000
 Site-art_painting              (7) | Val  Loss: 0.5403 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4914 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.5071 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.5336 | Val  Acc: 0.8706
 Site-cartoon                   (5) | Val  Loss: 0.8983 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.8046 | Val  Acc: 0.8312
 Site-sketch                    (3) | Val  Loss: 1.0229 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9229
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:23 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:23 | Val Acc: 0.9897
 Best site-art_painting             (6)  | Epoch:23 | Val Acc: 1.0000
 Best site-art_painting             (7)  | Epoch:23 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.9362
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.8706
 Best site-cartoon                  (5)  | Epoch:23 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.8312
 Best site-sketch                   (3)  | Epoch:23 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 24 ============
cnt=[3, 2, 5, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (7) | Train Loss: 0.2749 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2247 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2864 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2215 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2576 | Train Acc: 0.9500
 Site-photo                     (5) | Train Loss: 0.2207 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1385 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2564 | Train Acc: 0.9432
 Site-photo                     (5) | Train Loss: 0.2308 | Train Acc: 0.9735
 Site-photo                     (5) | Train Loss: 0.2476 | Train Acc: 0.9863
 Site-art_painting              (4) | Train Loss: 0.5958 | Train Acc: 0.8333
 Site-art_painting              (6) | Train Loss: 0.6353 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.6532 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.4262 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.5190 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.5867 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7146 | Train Acc: 0.7913
 Site-sketch                    (3) | Train Loss: 1.0243 | Train Acc: 0.6724
Average Train Accuracy: 0.9191
 Site-photo                     (7) | Val  Loss: 0.2658 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2784 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2309 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.2518 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2282 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2753 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2194 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2425 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.2227 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.2160 | Val  Acc: 0.9691
 Site-art_painting              (4) | Val  Loss: 0.2611 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.4661 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3501 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.4873 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.5068 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 0.8159 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.7643 | Val  Acc: 0.8312
 Site-sketch                    (3) | Val  Loss: 0.9444 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9333
 Best site-photo                    (7)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:24 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:24 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 0.9655
 Best site-photo                    (5)  | Epoch:24 | Val Acc: 0.9867
 Best site-photo                    (5)  | Epoch:24 | Val Acc: 0.9691
 Best site-art_painting             (4)  | Epoch:24 | Val Acc: 1.0000
 Best site-art_painting             (6)  | Epoch:24 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.9615
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.9362
 Best site-art_painting             (0)  | Epoch:24 | Val Acc: 0.8824
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8312
 Best site-sketch                   (3)  | Epoch:24 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 1, 7, 1, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (2) | Train Loss: 0.2786 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2521 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.3264 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2235 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2567 | Train Acc: 0.9500
 Site-photo                     (5) | Train Loss: 0.1860 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1640 | Train Acc: 0.9853
 Site-photo                     (5) | Train Loss: 0.2365 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2312 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.2575 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.5716 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.6592 | Train Acc: 0.9091
 Site-art_painting              (7) | Train Loss: 0.6070 | Train Acc: 0.8500
 Site-art_painting              (7) | Train Loss: 0.4873 | Train Acc: 0.9028
 Site-art_painting              (7) | Train Loss: 0.4557 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 0.5539 | Train Acc: 0.9091
 Site-cartoon                   (6) | Train Loss: 0.6428 | Train Acc: 0.8348
 Site-sketch                    (3) | Train Loss: 0.8982 | Train Acc: 0.7931
Average Train Accuracy: 0.9324
 Site-photo                     (2) | Val  Loss: 0.3712 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2669 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.1704 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2503 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1791 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2701 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2197 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.2204 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1971 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2052 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.3417 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.5548 | Val  Acc: 0.8667
 Site-art_painting              (7) | Val  Loss: 0.4879 | Val  Acc: 0.9231
 Site-art_painting              (7) | Val  Loss: 0.4829 | Val  Acc: 0.9574
 Site-art_painting              (7) | Val  Loss: 0.4687 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.9006 | Val  Acc: 0.7143
 Site-cartoon                   (6) | Val  Loss: 0.7649 | Val  Acc: 0.8182
 Site-sketch                    (3) | Val  Loss: 0.8748 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9218
============ Train epoch 26 ============
cnt=[8, 1, 1, 2, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.2162 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2593 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.2897 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1864 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2287 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2203 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1706 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2882 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.2007 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2264 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.4670 | Train Acc: 1.0000
 Site-art_painting              (6) | Train Loss: 0.7596 | Train Acc: 0.8182
 Site-art_painting              (6) | Train Loss: 0.6118 | Train Acc: 0.8750
 Site-art_painting              (6) | Train Loss: 0.5005 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4575 | Train Acc: 0.9062
 Site-cartoon                   (4) | Train Loss: 0.4753 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6709 | Train Acc: 0.8435
 Site-sketch                    (2) | Train Loss: 0.8197 | Train Acc: 0.7759
Average Train Accuracy: 0.9333
 Site-photo                     (0) | Val  Loss: 0.2920 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.2387 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.1731 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2605 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1682 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2825 | Val  Acc: 0.9143
 Site-photo                     (0) | Val  Loss: 0.2028 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2385 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.1834 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.2093 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.2451 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.4312 | Val  Acc: 0.9333
 Site-art_painting              (6) | Val  Loss: 0.4500 | Val  Acc: 0.8846
 Site-art_painting              (6) | Val  Loss: 0.4515 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.4835 | Val  Acc: 0.8588
 Site-cartoon                   (4) | Val  Loss: 0.9178 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7801 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 0.9484 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9120
============ Train epoch 27 ============
cnt=[2, 6, 2, 1, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (7) | Train Loss: 0.2444 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.3254 | Train Acc: 0.8889
 Site-photo                     (6) | Train Loss: 0.2622 | Train Acc: 0.9583
 Site-photo                     (5) | Train Loss: 0.1962 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2153 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.1829 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2359 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2209 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1892 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.2078 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.4903 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.6046 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.6051 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.4820 | Train Acc: 0.8889
 Site-art_painting              (4) | Train Loss: 0.3935 | Train Acc: 0.9297
 Site-cartoon                   (0) | Train Loss: 0.6923 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.6326 | Train Acc: 0.8348
 Site-sketch                    (3) | Train Loss: 0.8192 | Train Acc: 0.7586
Average Train Accuracy: 0.9108
 Site-photo                     (7) | Val  Loss: 0.3739 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.2340 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.1791 | Val  Acc: 0.9375
 Site-photo                     (5) | Val  Loss: 0.2603 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1650 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2161 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2114 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2144 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2199 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1858 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.2813 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.4131 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.3899 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.3981 | Val  Acc: 0.9787
 Site-art_painting              (4) | Val  Loss: 0.4435 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 0.8973 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 0.6444 | Val  Acc: 0.8701
 Site-sketch                    (3) | Val  Loss: 0.9228 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9056
============ Train epoch 28 ============
cnt=[3, 1, 5, 1, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (0) | Train Loss: 0.2445 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2187 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.2614 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1623 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2237 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.2419 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1141 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1848 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.1880 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.2060 | Train Acc: 0.9726
 Site-art_painting              (6) | Train Loss: 0.4102 | Train Acc: 0.9167
 Site-art_painting              (6) | Train Loss: 0.7204 | Train Acc: 0.8636
 Site-art_painting              (6) | Train Loss: 0.6009 | Train Acc: 0.8500
 Site-art_painting              (6) | Train Loss: 0.4681 | Train Acc: 0.9306
 Site-art_painting              (6) | Train Loss: 0.4478 | Train Acc: 0.9141
 Site-cartoon                   (7) | Train Loss: 0.6348 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6118 | Train Acc: 0.8522
 Site-sketch                    (3) | Train Loss: 0.8580 | Train Acc: 0.7586
Average Train Accuracy: 0.9306
 Site-photo                     (0) | Val  Loss: 0.4068 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1864 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1399 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2333 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1548 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2381 | Val  Acc: 0.9143
 Site-photo                     (0) | Val  Loss: 0.2214 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.1836 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1822 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.2017 | Val  Acc: 0.9588
 Site-art_painting              (6) | Val  Loss: 0.2379 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.3260 | Val  Acc: 0.9333
 Site-art_painting              (6) | Val  Loss: 0.4221 | Val  Acc: 0.9231
 Site-art_painting              (6) | Val  Loss: 0.4147 | Val  Acc: 0.9149
 Site-art_painting              (6) | Val  Loss: 0.4244 | Val  Acc: 0.9059
 Site-cartoon                   (7) | Val  Loss: 0.7723 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.7072 | Val  Acc: 0.8831
 Site-sketch                    (3) | Val  Loss: 0.8517 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9340
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9143
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9588
 Best site-art_painting             (6)  | Epoch:28 | Val Acc: 1.0000
 Best site-art_painting             (6)  | Epoch:28 | Val Acc: 0.9333
 Best site-art_painting             (6)  | Epoch:28 | Val Acc: 0.9231
 Best site-art_painting             (6)  | Epoch:28 | Val Acc: 0.9149
 Best site-art_painting             (6)  | Epoch:28 | Val Acc: 0.9059
 Best site-cartoon                  (7)  | Epoch:28 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:28 | Val Acc: 0.8831
 Best site-sketch                   (3)  | Epoch:28 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 29 ============
cnt=[6, 1, 3, 1, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (6) | Train Loss: 0.2316 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.1995 | Train Acc: 0.9444
 Site-photo                     (5) | Train Loss: 0.2151 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1644 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2281 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1906 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1002 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1846 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1739 | Train Acc: 0.9823
 Site-photo                     (6) | Train Loss: 0.1858 | Train Acc: 0.9795
 Site-art_painting              (7) | Train Loss: 0.4425 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.4924 | Train Acc: 0.9091
 Site-art_painting              (7) | Train Loss: 0.5318 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.4809 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.4236 | Train Acc: 0.9219
 Site-cartoon                   (4) | Train Loss: 0.5926 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6027 | Train Acc: 0.8348
 Site-sketch                    (3) | Train Loss: 0.8056 | Train Acc: 0.7069
Average Train Accuracy: 0.9279
 Site-photo                     (6) | Val  Loss: 0.1889 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.2094 | Val  Acc: 0.9167
 Site-photo                     (5) | Val  Loss: 0.1239 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2684 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1414 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2560 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2169 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1924 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1688 | Val  Acc: 0.9733
 Site-photo                     (6) | Val  Loss: 0.1780 | Val  Acc: 1.0000
 Site-art_painting              (7) | Val  Loss: 0.2397 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.3557 | Val  Acc: 0.9333
 Site-art_painting              (7) | Val  Loss: 0.4138 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 0.3610 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.4251 | Val  Acc: 0.8941
 Site-cartoon                   (4) | Val  Loss: 0.8673 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.7707 | Val  Acc: 0.8442
 Site-sketch                    (3) | Val  Loss: 0.8591 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9122
============ Train epoch 30 ============
cnt=[7, 1, 1, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.2236 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2237 | Train Acc: 0.9444
 Site-photo                     (7) | Train Loss: 0.2164 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1545 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2161 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.2081 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.0961 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2239 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1691 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.1789 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.4809 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 0.5578 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.4609 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.5014 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3528 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.5828 | Train Acc: 0.9091
 Site-cartoon                   (6) | Train Loss: 0.5644 | Train Acc: 0.8609
 Site-sketch                    (1) | Train Loss: 0.7568 | Train Acc: 0.8103
Average Train Accuracy: 0.9372
 Site-photo                     (0) | Val  Loss: 0.1819 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2882 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.1333 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1814 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1412 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2336 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1954 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1874 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1500 | Val  Acc: 0.9867
 Site-photo                     (4) | Val  Loss: 0.1781 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.2406 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.6230 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3062 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.3366 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.3984 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.7546 | Val  Acc: 0.8571
 Site-cartoon                   (6) | Val  Loss: 0.6157 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8792 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9279
============ Train epoch 31 ============
cnt=[1, 2, 2, 1, 5, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (4) | Train Loss: 0.1903 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.2192 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2161 | Train Acc: 0.9583
 Site-photo                     (4) | Train Loss: 0.1526 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.2046 | Train Acc: 0.9500
 Site-photo                     (6) | Train Loss: 0.1561 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1401 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.1926 | Train Acc: 0.9432
 Site-photo                     (6) | Train Loss: 0.1718 | Train Acc: 0.9735
 Site-photo                     (6) | Train Loss: 0.1743 | Train Acc: 0.9863
 Site-art_painting              (7) | Train Loss: 0.4011 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.4901 | Train Acc: 0.8182
 Site-art_painting              (5) | Train Loss: 0.5229 | Train Acc: 0.9000
 Site-art_painting              (1) | Train Loss: 0.4285 | Train Acc: 0.9306
 Site-art_painting              (5) | Train Loss: 0.3736 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.4154 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.5170 | Train Acc: 0.8870
 Site-sketch                    (3) | Train Loss: 0.7530 | Train Acc: 0.7759
Average Train Accuracy: 0.9380
 Site-photo                     (4) | Val  Loss: 0.4517 | Val  Acc: 0.8889
 Site-photo                     (6) | Val  Loss: 0.1804 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1119 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.2274 | Val  Acc: 0.9524
 Site-photo                     (4) | Val  Loss: 0.1586 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.2277 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1924 | Val  Acc: 0.9333
 Site-photo                     (4) | Val  Loss: 0.1913 | Val  Acc: 0.9655
 Site-photo                     (6) | Val  Loss: 0.1641 | Val  Acc: 0.9867
 Site-photo                     (6) | Val  Loss: 0.1819 | Val  Acc: 0.9691
 Site-art_painting              (7) | Val  Loss: 0.3612 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.3525 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.3446 | Val  Acc: 0.8846
 Site-art_painting              (1) | Val  Loss: 0.4008 | Val  Acc: 0.9149
 Site-art_painting              (5) | Val  Loss: 0.3494 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6248 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5590 | Val  Acc: 0.9221
 Site-sketch                    (3) | Val  Loss: 0.8435 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9331
============ Train epoch 32 ============
cnt=[1, 1, 1, 4, 3, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (3) | Train Loss: 0.2307 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1633 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2237 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1342 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2020 | Train Acc: 0.9250
 Site-photo                     (5) | Train Loss: 0.1211 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1478 | Train Acc: 0.9853
 Site-photo                     (7) | Train Loss: 0.1643 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1668 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.1607 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.4915 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.5576 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.4681 | Train Acc: 0.9000
 Site-art_painting              (4) | Train Loss: 0.3710 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3559 | Train Acc: 0.9297
 Site-cartoon                   (6) | Train Loss: 0.5703 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5534 | Train Acc: 0.8522
 Site-sketch                    (2) | Train Loss: 0.7746 | Train Acc: 0.7414
Average Train Accuracy: 0.9300
 Site-photo                     (3) | Val  Loss: 0.3644 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.1315 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.1090 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2742 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2345 | Val  Acc: 0.9429
 Site-photo                     (7) | Val  Loss: 0.1919 | Val  Acc: 0.9556
 Site-photo                     (7) | Val  Loss: 0.1818 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.1338 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1477 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.1485 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3735 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.4212 | Val  Acc: 0.8846
 Site-art_painting              (4) | Val  Loss: 0.3465 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.4247 | Val  Acc: 0.8471
 Site-cartoon                   (6) | Val  Loss: 0.7852 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.6423 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 0.8431 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9242
============ Train epoch 33 ============
cnt=[2, 1, 1, 4, 1, 4, 1, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (3) | Train Loss: 0.1882 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1884 | Train Acc: 0.9444
 Site-photo                     (7) | Train Loss: 0.2059 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.1598 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2101 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1447 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.1014 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2177 | Train Acc: 0.9432
 Site-photo                     (7) | Train Loss: 0.1751 | Train Acc: 0.9646
 Site-photo                     (7) | Train Loss: 0.1543 | Train Acc: 0.9863
 Site-art_painting              (6) | Train Loss: 0.4224 | Train Acc: 1.0000
 Site-art_painting              (5) | Train Loss: 0.4703 | Train Acc: 0.8636
 Site-art_painting              (5) | Train Loss: 0.5281 | Train Acc: 0.8000
 Site-art_painting              (5) | Train Loss: 0.3339 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.3849 | Train Acc: 0.8984
 Site-cartoon                   (4) | Train Loss: 0.5608 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5151 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7369 | Train Acc: 0.7586
Average Train Accuracy: 0.9312
 Site-photo                     (3) | Val  Loss: 0.2235 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2702 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2451 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.1228 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1935 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.2017 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1909 | Val  Acc: 0.9655
 Site-photo                     (7) | Val  Loss: 0.1632 | Val  Acc: 0.9867
 Site-photo                     (7) | Val  Loss: 0.1494 | Val  Acc: 0.9897
 Site-art_painting              (6) | Val  Loss: 0.1834 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.2702 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.4183 | Val  Acc: 0.8846
 Site-art_painting              (5) | Val  Loss: 0.3351 | Val  Acc: 0.9362
 Site-art_painting              (5) | Val  Loss: 0.3676 | Val  Acc: 0.9294
 Site-cartoon                   (4) | Val  Loss: 0.6508 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.7266 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.8524 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9352
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9167
 Best site-photo                    (7)  | Epoch:33 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9524
 Best site-photo                    (7)  | Epoch:33 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:33 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:33 | Val Acc: 0.9655
 Best site-photo                    (7)  | Epoch:33 | Val Acc: 0.9867
 Best site-photo                    (7)  | Epoch:33 | Val Acc: 0.9897
 Best site-art_painting             (6)  | Epoch:33 | Val Acc: 1.0000
 Best site-art_painting             (5)  | Epoch:33 | Val Acc: 0.9333
 Best site-art_painting             (5)  | Epoch:33 | Val Acc: 0.8846
 Best site-art_painting             (5)  | Epoch:33 | Val Acc: 0.9362
 Best site-art_painting             (5)  | Epoch:33 | Val Acc: 0.9294
 Best site-cartoon                  (4)  | Epoch:33 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:33 | Val Acc: 0.8571
 Best site-sketch                   (2)  | Epoch:33 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 2, 1, 3, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (4) | Train Loss: 0.1904 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2497 | Train Acc: 0.9444
 Site-photo                     (6) | Train Loss: 0.2178 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1440 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2041 | Train Acc: 0.9500
 Site-photo                     (5) | Train Loss: 0.1652 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2114 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1780 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1483 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.1354 | Train Acc: 0.9932
 Site-art_painting              (7) | Train Loss: 0.3941 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.5373 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.4092 | Train Acc: 0.9500
 Site-art_painting              (3) | Train Loss: 0.4536 | Train Acc: 0.9028
 Site-art_painting              (4) | Train Loss: 0.3353 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.4314 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4985 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7761 | Train Acc: 0.7414
Average Train Accuracy: 0.9445
 Site-photo                     (4) | Val  Loss: 0.3692 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.1849 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.1298 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2280 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1012 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2073 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1596 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1542 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1472 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.1522 | Val  Acc: 0.9897
 Site-art_painting              (7) | Val  Loss: 0.2733 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4838 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3264 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.3061 | Val  Acc: 0.9574
 Site-art_painting              (4) | Val  Loss: 0.3064 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.6732 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.6238 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.7315 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9414
 Best site-photo                    (4)  | Epoch:34 | Val Acc: 0.8889
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9167
 Best site-photo                    (6)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:34 | Val Acc: 0.9867
 Best site-photo                    (5)  | Epoch:34 | Val Acc: 0.9897
 Best site-art_painting             (7)  | Epoch:34 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.8667
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.8846
 Best site-art_painting             (3)  | Epoch:34 | Val Acc: 0.9574
 Best site-art_painting             (4)  | Epoch:34 | Val Acc: 0.9412
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 1.0000
 Best site-cartoon                  (1)  | Epoch:34 | Val Acc: 0.8571
 Best site-sketch                   (2)  | Epoch:34 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 2, 3, 1, 3, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (2) | Train Loss: 0.1845 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3434 | Train Acc: 0.8889
 Site-photo                     (6) | Train Loss: 0.1833 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1154 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1774 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1227 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2421 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1675 | Train Acc: 0.9318
 Site-photo                     (7) | Train Loss: 0.1539 | Train Acc: 0.9823
 Site-photo                     (7) | Train Loss: 0.1728 | Train Acc: 0.9726
 Site-art_painting              (5) | Train Loss: 0.3946 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.5334 | Train Acc: 0.8182
 Site-art_painting              (4) | Train Loss: 0.5484 | Train Acc: 0.8250
 Site-art_painting              (4) | Train Loss: 0.4752 | Train Acc: 0.9028
 Site-art_painting              (4) | Train Loss: 0.3691 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.4860 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4959 | Train Acc: 0.8870
 Site-sketch                    (3) | Train Loss: 0.7743 | Train Acc: 0.6897
Average Train Accuracy: 0.9202
 Site-photo                     (2) | Val  Loss: 0.2349 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2011 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2384 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.1170 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.2248 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.1803 | Val  Acc: 0.9556
 Site-photo                     (7) | Val  Loss: 0.1613 | Val  Acc: 0.9655
 Site-photo                     (7) | Val  Loss: 0.1192 | Val  Acc: 0.9867
 Site-photo                     (7) | Val  Loss: 0.1366 | Val  Acc: 0.9794
 Site-art_painting              (5) | Val  Loss: 0.1736 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.4724 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.2804 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.3233 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.3362 | Val  Acc: 0.9176
 Site-cartoon                   (1) | Val  Loss: 0.7872 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.6241 | Val  Acc: 0.8442
 Site-sketch                    (3) | Val  Loss: 0.8071 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9143
============ Train epoch 36 ============
cnt=[3, 1, 1, 2, 4, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (5) | Train Loss: 0.1607 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1488 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1740 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1287 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1951 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1736 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.0747 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1513 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.1722 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1555 | Train Acc: 0.9795
 Site-art_painting              (6) | Train Loss: 0.3420 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.5066 | Train Acc: 0.8636
 Site-art_painting              (4) | Train Loss: 0.4564 | Train Acc: 0.8750
 Site-art_painting              (4) | Train Loss: 0.2954 | Train Acc: 0.9028
 Site-art_painting              (4) | Train Loss: 0.3104 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.4579 | Train Acc: 0.8182
 Site-cartoon                   (7) | Train Loss: 0.4502 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.7151 | Train Acc: 0.7931
Average Train Accuracy: 0.9352
 Site-photo                     (5) | Val  Loss: 0.1009 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1885 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.1051 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.2536 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.0994 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2025 | Val  Acc: 0.9429
 Site-photo                     (3) | Val  Loss: 0.1752 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1464 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.1093 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1470 | Val  Acc: 0.9691
 Site-art_painting              (6) | Val  Loss: 0.2203 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.1877 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.2429 | Val  Acc: 0.9231
 Site-art_painting              (4) | Val  Loss: 0.3453 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.3263 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.7064 | Val  Acc: 0.8571
 Site-cartoon                   (7) | Val  Loss: 0.6406 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.6861 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9379
============ Train epoch 37 ============
cnt=[1, 5, 1, 4, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (7) | Train Loss: 0.1539 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1707 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1554 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.1058 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1864 | Train Acc: 0.9250
 Site-photo                     (4) | Train Loss: 0.1488 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.1298 | Train Acc: 0.9853
 Site-photo                     (4) | Train Loss: 0.1557 | Train Acc: 0.9432
 Site-photo                     (4) | Train Loss: 0.1815 | Train Acc: 0.9646
 Site-photo                     (4) | Train Loss: 0.1888 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 0.3862 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4103 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.5031 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4474 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.3702 | Train Acc: 0.8906
 Site-cartoon                   (6) | Train Loss: 0.3028 | Train Acc: 1.0000
 Site-cartoon                   (0) | Train Loss: 0.4860 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.6202 | Train Acc: 0.8276
Average Train Accuracy: 0.9402
 Site-photo                     (7) | Val  Loss: 0.1177 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1123 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1603 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1147 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1587 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1909 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1224 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1146 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1136 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.1766 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.4955 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.3495 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2908 | Val  Acc: 0.9787
 Site-art_painting              (3) | Val  Loss: 0.3487 | Val  Acc: 0.9059
 Site-cartoon                   (6) | Val  Loss: 0.4929 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.5582 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.7269 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9459
 Best site-photo                    (7)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (5)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9655
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (4)  | Epoch:37 | Val Acc: 0.9897
 Best site-art_painting             (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.8000
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9231
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9787
 Best site-art_painting             (3)  | Epoch:37 | Val Acc: 0.9059
 Best site-cartoon                  (6)  | Epoch:37 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:37 | Val Acc: 0.9351
 Best site-sketch                   (2)  | Epoch:37 | Val Acc: 0.8205
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 4, 1, 1, 4, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.1542 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1466 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2378 | Train Acc: 0.9167
 Site-photo                     (7) | Train Loss: 0.1030 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1832 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1388 | Train Acc: 0.9808
 Site-photo                     (7) | Train Loss: 0.0982 | Train Acc: 0.9853
 Site-photo                     (5) | Train Loss: 0.1505 | Train Acc: 0.9545
 Site-photo                     (5) | Train Loss: 0.1298 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.1272 | Train Acc: 0.9795
 Site-art_painting              (4) | Train Loss: 0.4658 | Train Acc: 0.8333
 Site-art_painting              (6) | Train Loss: 0.4375 | Train Acc: 0.9091
 Site-art_painting              (4) | Train Loss: 0.4102 | Train Acc: 0.9000
 Site-art_painting              (4) | Train Loss: 0.3691 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.3382 | Train Acc: 0.9297
 Site-cartoon                   (0) | Train Loss: 0.5995 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 0.4676 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.6506 | Train Acc: 0.7759
Average Train Accuracy: 0.9298
 Site-photo                     (3) | Val  Loss: 0.3165 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.2127 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.1072 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.1948 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1204 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1542 | Val  Acc: 0.9714
 Site-photo                     (7) | Val  Loss: 0.1833 | Val  Acc: 0.9556
 Site-photo                     (5) | Val  Loss: 0.1426 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.1159 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1476 | Val  Acc: 0.9897
 Site-art_painting              (4) | Val  Loss: 0.2344 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.2154 | Val  Acc: 0.9333
 Site-art_painting              (4) | Val  Loss: 0.2000 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.2758 | Val  Acc: 0.9362
 Site-art_painting              (4) | Val  Loss: 0.2936 | Val  Acc: 0.9294
 Site-cartoon                   (0) | Val  Loss: 0.7567 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.5811 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6947 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9330
============ Train epoch 39 ============
cnt=[7, 1, 1, 3, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (4) | Train Loss: 0.1381 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1602 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1953 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1221 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.1947 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1217 | Train Acc: 0.9808
 Site-photo                     (4) | Train Loss: 0.0944 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1987 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1156 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1722 | Train Acc: 0.9795
 Site-art_painting              (5) | Train Loss: 0.3193 | Train Acc: 0.9167
 Site-art_painting              (6) | Train Loss: 0.5791 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 0.4767 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.3474 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.2945 | Train Acc: 0.9453
 Site-cartoon                   (1) | Train Loss: 0.4717 | Train Acc: 0.7273
 Site-cartoon                   (7) | Train Loss: 0.4626 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.6706 | Train Acc: 0.7931
Average Train Accuracy: 0.9181
 Site-photo                     (4) | Val  Loss: 0.1153 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3317 | Val  Acc: 0.9167
 Site-photo                     (4) | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2313 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1828 | Val  Acc: 0.9429
 Site-photo                     (4) | Val  Loss: 0.1590 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1299 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1054 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1376 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.1639 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.3020 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3162 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2819 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2910 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.6120 | Val  Acc: 0.8571
 Site-cartoon                   (7) | Val  Loss: 0.5338 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.6631 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9428
============ Train epoch 40 ============
cnt=[1, 4, 1, 3, 1, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.1373 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.2297 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1729 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.1051 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1623 | Train Acc: 0.9750
 Site-photo                     (7) | Train Loss: 0.1305 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.1181 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1243 | Train Acc: 0.9773
 Site-photo                     (1) | Train Loss: 0.1522 | Train Acc: 0.9735
 Site-photo                     (7) | Train Loss: 0.1543 | Train Acc: 0.9658
 Site-art_painting              (5) | Train Loss: 0.3485 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.4186 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.3942 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.2430 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.3008 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.4074 | Train Acc: 0.9091
 Site-cartoon                   (6) | Train Loss: 0.4082 | Train Acc: 0.9217
 Site-sketch                    (0) | Train Loss: 0.7089 | Train Acc: 0.7241
Average Train Accuracy: 0.9398
 Site-photo                     (1) | Val  Loss: 0.1703 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2209 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.1069 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.1618 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1682 | Val  Acc: 0.9556
 Site-photo                     (7) | Val  Loss: 0.1513 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1062 | Val  Acc: 0.9867
 Site-photo                     (7) | Val  Loss: 0.1059 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.0952 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.5661 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.4012 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.3458 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.2932 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.6984 | Val  Acc: 0.8571
 Site-cartoon                   (6) | Val  Loss: 0.5223 | Val  Acc: 0.8831
 Site-sketch                    (0) | Val  Loss: 0.6335 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9318
 Test site-photo                     (1)| Epoch:37 | Test Acc: 0.9896
 Test site-art_painting              (5)| Epoch:37 | Test Acc: 0.8794
 Test site-cartoon                   (2)| Epoch:37 | Test Acc: 0.8447
 Test site-sketch                    (0)| Epoch:37 | Test Acc: 0.7217
photo: 0.9896, art_painting: 0.8794, cartoon: 0.8447, sketch: 0.7217, 
Average Test Accuracy(group): 0.8588, Average Test Accuracy(individual): 0.9280,
domain std=0.0955, cluster std=0.0883, individual std=0.0768, 
Average Test Accuracy: 0.8588
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 41 ============
cnt=[1, 1, 1, 5, 4, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (3) | Train Loss: 0.1489 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1195 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1945 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1078 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1443 | Train Acc: 0.9750
 Site-photo                     (4) | Train Loss: 0.0988 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2051 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1625 | Train Acc: 0.9659
 Site-photo                     (4) | Train Loss: 0.1146 | Train Acc: 0.9823
 Site-photo                     (4) | Train Loss: 0.1525 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.3756 | Train Acc: 0.8333
 Site-art_painting              (5) | Train Loss: 0.4128 | Train Acc: 0.9091
 Site-art_painting              (5) | Train Loss: 0.4725 | Train Acc: 0.8750
 Site-art_painting              (5) | Train Loss: 0.3508 | Train Acc: 0.8889
 Site-art_painting              (5) | Train Loss: 0.2664 | Train Acc: 0.9609
 Site-cartoon                   (6) | Train Loss: 0.4113 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4152 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.5960 | Train Acc: 0.8103
Average Train Accuracy: 0.9387
 Site-photo                     (3) | Val  Loss: 0.1637 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.2867 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.0665 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1615 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.1020 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1595 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1537 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1385 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.1192 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1346 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.3998 | Val  Acc: 0.8750
 Site-art_painting              (5) | Val  Loss: 0.2279 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.2358 | Val  Acc: 0.9615
 Site-art_painting              (5) | Val  Loss: 0.2309 | Val  Acc: 0.9787
 Site-art_painting              (5) | Val  Loss: 0.3137 | Val  Acc: 0.8941
 Site-cartoon                   (6) | Val  Loss: 0.5467 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.5359 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 0.5998 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9431
 Test site-photo                     (3)| Epoch:40 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:40 | Test Acc: 0.8794
 Test site-cartoon                   (6)| Epoch:40 | Test Acc: 0.8436
 Test site-sketch                    (2)| Epoch:40 | Test Acc: 0.7306
photo: 0.9896, art_painting: 0.8794, cartoon: 0.8436, sketch: 0.7306, 
Average Test Accuracy(group): 0.8608, Average Test Accuracy(individual): 0.9284,
domain std=0.0924, cluster std=0.0863, individual std=0.0756, 
Average Test Accuracy: 0.8608
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 42 ============
cnt=[7, 1, 1, 2, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.1039 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1681 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1526 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0993 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2079 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 0.1055 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0887 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1485 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1473 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1190 | Train Acc: 0.9863
 Site-art_painting              (7) | Train Loss: 0.3714 | Train Acc: 0.9167
 Site-art_painting              (6) | Train Loss: 0.4161 | Train Acc: 0.9091
 Site-art_painting              (4) | Train Loss: 0.4515 | Train Acc: 0.8250
 Site-art_painting              (4) | Train Loss: 0.3315 | Train Acc: 0.8889
 Site-art_painting              (4) | Train Loss: 0.2546 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.3051 | Train Acc: 1.0000
 Site-cartoon                   (5) | Train Loss: 0.4286 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.5797 | Train Acc: 0.8448
Average Train Accuracy: 0.9473
 Site-photo                     (0) | Val  Loss: 0.2879 | Val  Acc: 0.8889
 Site-photo                     (4) | Val  Loss: 0.1594 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1807 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.0842 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1512 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1792 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1419 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0956 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1295 | Val  Acc: 0.9794
 Site-art_painting              (7) | Val  Loss: 0.1615 | Val  Acc: 1.0000
 Site-art_painting              (6) | Val  Loss: 0.3957 | Val  Acc: 0.8667
 Site-art_painting              (4) | Val  Loss: 0.2022 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.2407 | Val  Acc: 0.9787
 Site-art_painting              (4) | Val  Loss: 0.2853 | Val  Acc: 0.9529
 Site-cartoon                   (1) | Val  Loss: 0.5372 | Val  Acc: 1.0000
 Site-cartoon                   (5) | Val  Loss: 0.5468 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6765 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9499
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.8889
 Best site-photo                    (4)  | Epoch:42 | Val Acc: 0.9167
 Best site-photo                    (3)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:42 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:42 | Val Acc: 0.9794
 Best site-art_painting             (7)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (6)  | Epoch:42 | Val Acc: 0.8667
 Best site-art_painting             (4)  | Epoch:42 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:42 | Val Acc: 0.9787
 Best site-art_painting             (4)  | Epoch:42 | Val Acc: 0.9529
 Best site-cartoon                  (1)  | Epoch:42 | Val Acc: 1.0000
 Best site-cartoon                  (5)  | Epoch:42 | Val Acc: 0.9221
 Best site-sketch                   (2)  | Epoch:42 | Val Acc: 0.7949
 Test site-photo                     (0)| Epoch:42 | Test Acc: 0.9896
 Test site-art_painting              (7)| Epoch:42 | Test Acc: 0.8782
 Test site-cartoon                   (1)| Epoch:42 | Test Acc: 0.8415
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.7306
photo: 0.9896, art_painting: 0.8782, cartoon: 0.8415, sketch: 0.7306, 
Average Test Accuracy(group): 0.8600, Average Test Accuracy(individual): 0.9278,
domain std=0.0925, cluster std=0.0790, individual std=0.0761, 
Average Test Accuracy: 0.8600
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 1, 1, 3, 1, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (6) | Train Loss: 0.0951 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1829 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1549 | Train Acc: 0.9583
 Site-photo                     (6) | Train Loss: 0.0974 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1449 | Train Acc: 0.9750
 Site-photo                     (6) | Train Loss: 0.1035 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.1162 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.1385 | Train Acc: 0.9545
 Site-photo                     (7) | Train Loss: 0.1228 | Train Acc: 0.9823
 Site-photo                     (7) | Train Loss: 0.1667 | Train Acc: 0.9726
 Site-art_painting              (5) | Train Loss: 0.4255 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.6024 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 0.3953 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.3227 | Train Acc: 0.9583
 Site-art_painting              (3) | Train Loss: 0.2898 | Train Acc: 0.9453
 Site-cartoon                   (0) | Train Loss: 0.4046 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.3772 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.5822 | Train Acc: 0.8448
Average Train Accuracy: 0.9455
 Site-photo                     (6) | Val  Loss: 0.2455 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.0992 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.0757 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.2386 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0777 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.1684 | Val  Acc: 0.9714
 Site-photo                     (6) | Val  Loss: 0.1750 | Val  Acc: 0.9556
 Site-photo                     (6) | Val  Loss: 0.1438 | Val  Acc: 0.9828
 Site-photo                     (7) | Val  Loss: 0.1025 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.1293 | Val  Acc: 0.9691
 Site-art_painting              (5) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.2713 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2384 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.2951 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2801 | Val  Acc: 0.9647
 Site-cartoon                   (0) | Val  Loss: 0.7604 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.4817 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.6457 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9478
 Test site-photo                     (6)| Epoch:42 | Test Acc: 0.9881
 Test site-art_painting              (5)| Epoch:42 | Test Acc: 0.8733
 Test site-cartoon                   (0)| Epoch:42 | Test Acc: 0.8511
 Test site-sketch                    (2)| Epoch:42 | Test Acc: 0.7319
photo: 0.9881, art_painting: 0.8733, cartoon: 0.8511, sketch: 0.7319, 
Average Test Accuracy(group): 0.8611, Average Test Accuracy(individual): 0.9267,
domain std=0.0909, cluster std=0.0882, individual std=0.0750, 
Average Test Accuracy: 0.8611
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 44 ============
cnt=[3, 1, 1, 6, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.1116 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1712 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.2025 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.0892 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1776 | Train Acc: 0.9750
 Site-photo                     (6) | Train Loss: 0.1082 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.2002 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1426 | Train Acc: 0.9432
 Site-photo                     (6) | Train Loss: 0.1111 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1203 | Train Acc: 0.9795
 Site-art_painting              (7) | Train Loss: 0.3330 | Train Acc: 0.9167
 Site-art_painting              (4) | Train Loss: 0.3182 | Train Acc: 0.9091
 Site-art_painting              (7) | Train Loss: 0.4928 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.3362 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.2352 | Train Acc: 0.9766
 Site-cartoon                   (1) | Train Loss: 0.3850 | Train Acc: 0.9091
 Site-cartoon                   (5) | Train Loss: 0.4019 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.5243 | Train Acc: 0.8793
Average Train Accuracy: 0.9478
 Site-photo                     (3) | Val  Loss: 0.2032 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1848 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.0621 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1332 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0914 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.1828 | Val  Acc: 0.9429
 Site-photo                     (6) | Val  Loss: 0.1668 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1174 | Val  Acc: 0.9655
 Site-photo                     (6) | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1095 | Val  Acc: 0.9897
 Site-art_painting              (7) | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.1816 | Val  Acc: 1.0000
 Site-art_painting              (7) | Val  Loss: 0.2143 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.2014 | Val  Acc: 0.9787
 Site-art_painting              (0) | Val  Loss: 0.3027 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.8892 | Val  Acc: 0.7143
 Site-cartoon                   (5) | Val  Loss: 0.4426 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 0.5643 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9374
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9881
 Test site-art_painting              (7)| Epoch:43 | Test Acc: 0.8733
 Test site-cartoon                   (1)| Epoch:43 | Test Acc: 0.8372
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.7389
photo: 0.9881, art_painting: 0.8733, cartoon: 0.8372, sketch: 0.7389, 
Average Test Accuracy(group): 0.8594, Average Test Accuracy(individual): 0.9256,
domain std=0.0891, cluster std=0.0775, individual std=0.0757, 
Average Test Accuracy: 0.8594
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 45 ============
cnt=[1, 3, 2, 2, 1, 2, 6, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (6) | Train Loss: 0.0945 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1836 | Train Acc: 0.9444
 Site-photo                     (6) | Train Loss: 0.1695 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.0821 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.1831 | Train Acc: 0.9250
 Site-photo                     (6) | Train Loss: 0.0868 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.0886 | Train Acc: 1.0000
 Site-photo                     (6) | Train Loss: 0.1802 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.1219 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.1596 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3288 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.3809 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.3528 | Train Acc: 0.9500
 Site-art_painting              (5) | Train Loss: 0.2115 | Train Acc: 0.9444
 Site-art_painting              (5) | Train Loss: 0.2803 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.3033 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.3802 | Train Acc: 0.9391
 Site-sketch                    (0) | Train Loss: 0.6190 | Train Acc: 0.7759
Average Train Accuracy: 0.9434
 Site-photo                     (6) | Val  Loss: 0.3152 | Val  Acc: 0.8889
 Site-photo                     (7) | Val  Loss: 0.1351 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.0599 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2373 | Val  Acc: 0.9524
 Site-photo                     (6) | Val  Loss: 0.0960 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.1792 | Val  Acc: 0.9429
 Site-photo                     (6) | Val  Loss: 0.1442 | Val  Acc: 0.9556
 Site-photo                     (6) | Val  Loss: 0.1408 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.0927 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1497 | Val  Acc: 0.9485
 Site-art_painting              (3) | Val  Loss: 0.1182 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3298 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.1873 | Val  Acc: 0.9615
 Site-art_painting              (5) | Val  Loss: 0.2377 | Val  Acc: 0.9574
 Site-art_painting              (5) | Val  Loss: 0.2685 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.5537 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5391 | Val  Acc: 0.8961
 Site-sketch                    (0) | Val  Loss: 0.6195 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9330
 Test site-photo                     (6)| Epoch:44 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.8806
 Test site-cartoon                   (2)| Epoch:44 | Test Acc: 0.8362
 Test site-sketch                    (0)| Epoch:44 | Test Acc: 0.7402
photo: 0.9881, art_painting: 0.8806, cartoon: 0.8362, sketch: 0.7402, 
Average Test Accuracy(group): 0.8613, Average Test Accuracy(individual): 0.9276,
domain std=0.0891, cluster std=0.0821, individual std=0.0743, 
Average Test Accuracy: 0.8613
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 1, 1, 1, 5, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (4) | Train Loss: 0.1229 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2207 | Train Acc: 0.8889
 Site-photo                     (7) | Train Loss: 0.1530 | Train Acc: 0.9583
 Site-photo                     (7) | Train Loss: 0.0887 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1694 | Train Acc: 0.9500
 Site-photo                     (4) | Train Loss: 0.0802 | Train Acc: 1.0000
 Site-photo                     (7) | Train Loss: 0.1084 | Train Acc: 1.0000
 Site-photo                     (4) | Train Loss: 0.1311 | Train Acc: 0.9545
 Site-photo                     (4) | Train Loss: 0.1168 | Train Acc: 0.9735
 Site-photo                     (4) | Train Loss: 0.1131 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4158 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.2698 | Train Acc: 0.9545
 Site-art_painting              (5) | Train Loss: 0.4200 | Train Acc: 0.8750
 Site-art_painting              (5) | Train Loss: 0.2745 | Train Acc: 0.9583
 Site-art_painting              (5) | Train Loss: 0.2713 | Train Acc: 0.9609
 Site-cartoon                   (6) | Train Loss: 0.3941 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.3694 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.5801 | Train Acc: 0.8276
Average Train Accuracy: 0.9367
 Site-photo                     (4) | Val  Loss: 0.3243 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.2101 | Val  Acc: 0.9167
 Site-photo                     (7) | Val  Loss: 0.0607 | Val  Acc: 1.0000
 Site-photo                     (7) | Val  Loss: 0.1275 | Val  Acc: 0.9524
 Site-photo                     (7) | Val  Loss: 0.0912 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1255 | Val  Acc: 0.9714
 Site-photo                     (7) | Val  Loss: 0.1544 | Val  Acc: 0.9556
 Site-photo                     (4) | Val  Loss: 0.1321 | Val  Acc: 0.9655
 Site-photo                     (4) | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.1053 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.1855 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.3299 | Val  Acc: 0.9333
 Site-art_painting              (5) | Val  Loss: 0.3739 | Val  Acc: 0.9231
 Site-art_painting              (5) | Val  Loss: 0.3001 | Val  Acc: 0.9574
 Site-art_painting              (5) | Val  Loss: 0.2080 | Val  Acc: 0.9529
 Site-cartoon                   (6) | Val  Loss: 0.6888 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4785 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.7238 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9306
 Test site-photo                     (4)| Epoch:45 | Test Acc: 0.9881
 Test site-art_painting              (0)| Epoch:45 | Test Acc: 0.8843
 Test site-cartoon                   (6)| Epoch:45 | Test Acc: 0.8372
 Test site-sketch                    (2)| Epoch:45 | Test Acc: 0.7490
photo: 0.9881, art_painting: 0.8843, cartoon: 0.8372, sketch: 0.7490, 
Average Test Accuracy(group): 0.8647, Average Test Accuracy(individual): 0.9292,
domain std=0.0862, cluster std=0.0823, individual std=0.0723, 
Average Test Accuracy: 0.8647
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 47 ============
cnt=[3, 2, 1, 4, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (3) | Train Loss: 0.0882 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.2616 | Train Acc: 0.9444
 Site-photo                     (6) | Train Loss: 0.1587 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.0758 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1432 | Train Acc: 0.9750
 Site-photo                     (5) | Train Loss: 0.1028 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0786 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.1441 | Train Acc: 0.9659
 Site-photo                     (5) | Train Loss: 0.0974 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.1028 | Train Acc: 0.9795
 Site-art_painting              (7) | Train Loss: 0.3897 | Train Acc: 0.8333
 Site-art_painting              (4) | Train Loss: 0.5590 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.4075 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.3532 | Train Acc: 0.9583
 Site-art_painting              (0) | Train Loss: 0.2256 | Train Acc: 0.9688
 Site-cartoon                   (1) | Train Loss: 0.4773 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.3949 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.5566 | Train Acc: 0.8103
Average Train Accuracy: 0.9312
 Site-photo                     (3) | Val  Loss: 0.1133 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1054 | Val  Acc: 1.0000
 Site-photo                     (6) | Val  Loss: 0.0928 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.0983 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0875 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.1226 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1453 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1365 | Val  Acc: 0.9655
 Site-photo                     (5) | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-photo                     (5) | Val  Loss: 0.0998 | Val  Acc: 0.9794
 Site-art_painting              (7) | Val  Loss: 0.2232 | Val  Acc: 0.8750
 Site-art_painting              (4) | Val  Loss: 0.3530 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.1841 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.2113 | Val  Acc: 0.9787
 Site-art_painting              (0) | Val  Loss: 0.2438 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.5430 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.4564 | Val  Acc: 0.9351
 Site-sketch                    (2) | Val  Loss: 0.5947 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9464
 Test site-photo                     (3)| Epoch:46 | Test Acc: 0.9881
 Test site-art_painting              (7)| Epoch:46 | Test Acc: 0.8879
 Test site-cartoon                   (1)| Epoch:46 | Test Acc: 0.8489
 Test site-sketch                    (2)| Epoch:46 | Test Acc: 0.7459
photo: 0.9881, art_painting: 0.8879, cartoon: 0.8489, sketch: 0.7459, 
Average Test Accuracy(group): 0.8677, Average Test Accuracy(individual): 0.9313,
domain std=0.0867, cluster std=0.0791, individual std=0.0705, 
Average Test Accuracy: 0.8677
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 1, 1, 7, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (3) | Train Loss: 0.0934 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1481 | Train Acc: 0.9444
 Site-photo                     (6) | Train Loss: 0.1415 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0783 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1634 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1178 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.1097 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1260 | Train Acc: 0.9545
 Site-photo                     (3) | Train Loss: 0.1152 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.1240 | Train Acc: 0.9795
 Site-art_painting              (4) | Train Loss: 0.3202 | Train Acc: 0.9167
 Site-art_painting              (5) | Train Loss: 0.3188 | Train Acc: 0.9545
 Site-art_painting              (4) | Train Loss: 0.4482 | Train Acc: 0.8750
 Site-art_painting              (4) | Train Loss: 0.2401 | Train Acc: 0.9444
 Site-art_painting              (4) | Train Loss: 0.2444 | Train Acc: 0.9531
 Site-cartoon                   (7) | Train Loss: 0.3263 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.3784 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.5638 | Train Acc: 0.8103
Average Train Accuracy: 0.9449
 Site-photo                     (3) | Val  Loss: 0.2391 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2884 | Val  Acc: 0.9167
 Site-photo                     (6) | Val  Loss: 0.0728 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1234 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.0883 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1522 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1504 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1357 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.0751 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1045 | Val  Acc: 0.9897
 Site-art_painting              (4) | Val  Loss: 0.0996 | Val  Acc: 1.0000
 Site-art_painting              (5) | Val  Loss: 0.1619 | Val  Acc: 1.0000
 Site-art_painting              (4) | Val  Loss: 0.3404 | Val  Acc: 0.8846
 Site-art_painting              (4) | Val  Loss: 0.2055 | Val  Acc: 0.9574
 Site-art_painting              (4) | Val  Loss: 0.2472 | Val  Acc: 0.9294
 Site-cartoon                   (7) | Val  Loss: 0.4556 | Val  Acc: 1.0000
 Site-cartoon                   (2) | Val  Loss: 0.5251 | Val  Acc: 0.9091
 Site-sketch                    (1) | Val  Loss: 0.6207 | Val  Acc: 0.8462
Average Valid Accuracy: 0.9537
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 0.9167
 Best site-photo                    (6)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:48 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.9556
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.9655
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:48 | Val Acc: 0.9897
 Best site-art_painting             (4)  | Epoch:48 | Val Acc: 1.0000
 Best site-art_painting             (5)  | Epoch:48 | Val Acc: 1.0000
 Best site-art_painting             (4)  | Epoch:48 | Val Acc: 0.8846
 Best site-art_painting             (4)  | Epoch:48 | Val Acc: 0.9574
 Best site-art_painting             (4)  | Epoch:48 | Val Acc: 0.9294
 Best site-cartoon                  (7)  | Epoch:48 | Val Acc: 1.0000
 Best site-cartoon                  (2)  | Epoch:48 | Val Acc: 0.9091
 Best site-sketch                   (1)  | Epoch:48 | Val Acc: 0.8462
 Test site-photo                     (3)| Epoch:48 | Test Acc: 0.9881
 Test site-art_painting              (4)| Epoch:48 | Test Acc: 0.8904
 Test site-cartoon                   (7)| Epoch:48 | Test Acc: 0.8489
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.7427
photo: 0.9881, art_painting: 0.8904, cartoon: 0.8489, sketch: 0.7427, 
Average Test Accuracy(group): 0.8675, Average Test Accuracy(individual): 0.9318,
domain std=0.0880, cluster std=0.0817, individual std=0.0706, 
Average Test Accuracy: 0.8675
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
============ Train epoch 49 ============
cnt=[4, 1, 1, 6, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (3) | Train Loss: 0.1103 | Train Acc: 1.0000
 Site-photo                     (5) | Train Loss: 0.1541 | Train Acc: 0.9444
 Site-photo                     (4) | Train Loss: 0.1412 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1002 | Train Acc: 0.9677
 Site-photo                     (5) | Train Loss: 0.1405 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.1143 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.0511 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1286 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.1016 | Train Acc: 0.9823
 Site-photo                     (5) | Train Loss: 0.0972 | Train Acc: 0.9795
 Site-art_painting              (7) | Train Loss: 0.2976 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.3747 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.3537 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.4568 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.2311 | Train Acc: 0.9688
 Site-cartoon                   (6) | Train Loss: 0.2954 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.3542 | Train Acc: 0.9130
 Site-sketch                    (2) | Train Loss: 0.5249 | Train Acc: 0.8103
Average Train Accuracy: 0.9490
 Site-photo                     (3) | Val  Loss: 0.1378 | Val  Acc: 0.8889
 Site-photo                     (5) | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-photo                     (4) | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1316 | Val  Acc: 0.9524
 Site-photo                     (5) | Val  Loss: 0.0942 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1347 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1829 | Val  Acc: 0.9556
 Site-photo                     (3) | Val  Loss: 0.1343 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.0888 | Val  Acc: 0.9867
 Site-photo                     (5) | Val  Loss: 0.1128 | Val  Acc: 0.9794
 Site-art_painting              (7) | Val  Loss: 0.1925 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.0939 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3157 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.2609 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.2468 | Val  Acc: 0.9176
 Site-cartoon                   (6) | Val  Loss: 0.3536 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.4523 | Val  Acc: 0.9091
 Site-sketch                    (2) | Val  Loss: 0.6183 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9516
 Test site-photo                     (3)| Epoch:48 | Test Acc: 0.9896
 Test site-art_painting              (7)| Epoch:48 | Test Acc: 0.8904
 Test site-cartoon                   (6)| Epoch:48 | Test Acc: 0.8447
 Test site-sketch                    (2)| Epoch:48 | Test Acc: 0.7408
photo: 0.9896, art_painting: 0.8904, cartoon: 0.8447, sketch: 0.7408, 
Average Test Accuracy(group): 0.8663, Average Test Accuracy(individual): 0.9321,
domain std=0.0894, cluster std=0.0834, individual std=0.0721, 
Average Test Accuracy: 0.8663
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_8/ccop_q=1...
===2023-08-10 21:05:56===
===2023-08-10 21:06:12===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 8
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 8
Loading snapshots...
 Test site-photo                     (3)| Epoch:49 | Test Acc: 0.9896
 Test site-art_painting              (7)| Epoch:49 | Test Acc: 0.8904
 Test site-cartoon                   (6)| Epoch:49 | Test Acc: 0.8447
 Test site-sketch                    (2)| Epoch:49 | Test Acc: 0.7408
photo: 0.9896, art_painting: 0.8904, cartoon: 0.8447, sketch: 0.7408, 
Average Test Accuracy(group): 0.8663, Average Test Accuracy(individual): 0.9321,
domain std=0.0894, cluster std=0.0834, individual std=0.0721, 
