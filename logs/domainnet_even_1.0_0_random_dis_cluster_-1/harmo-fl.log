===2023-07-29 08:45:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.3326 | Train Acc: 0.7643
 Site-Clipart                       | Train Loss: 1.2938 | Train Acc: 0.7669
 Site-Real                          | Train Loss: 1.0602 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.9710 | Train Acc: 0.9449
 Site-Painting                      | Train Loss: 1.2008 | Train Acc: 0.7962
 Site-Painting                      | Train Loss: 1.1913 | Train Acc: 0.8432
 Site-Sketch                        | Train Loss: 1.3191 | Train Acc: 0.6752
 Site-Sketch                        | Train Loss: 1.2868 | Train Acc: 0.7097
 Site-QuickDraw                     | Train Loss: 1.9582 | Train Acc: 0.4076
 Site-QuickDraw                     | Train Loss: 1.9728 | Train Acc: 0.3941
 Site-Infograph                     | Train Loss: 1.9149 | Train Acc: 0.4586
 Site-Infograph                     | Train Loss: 1.8179 | Train Acc: 0.5233
Average Train Accuracy: 0.6829
 Site-Clipart                       | Val  Loss: 1.3192 | Val  Acc: 0.7714
 Site-Clipart                       | Val  Loss: 1.3313 | Val  Acc: 0.7651
 Site-Real                          | Val  Loss: 1.0066 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.9935 | Val  Acc: 0.9365
 Site-Painting                      | Val  Loss: 1.0532 | Val  Acc: 0.8571
 Site-Painting                      | Val  Loss: 1.1610 | Val  Acc: 0.8222
 Site-Sketch                        | Val  Loss: 1.2519 | Val  Acc: 0.7714
 Site-Sketch                        | Val  Loss: 1.2647 | Val  Acc: 0.7587
 Site-QuickDraw                     | Val  Loss: 1.9506 | Val  Acc: 0.3619
 Site-QuickDraw                     | Val  Loss: 1.9648 | Val  Acc: 0.3683
 Site-Infograph                     | Val  Loss: 1.8962 | Val  Acc: 0.3905
 Site-Infograph                     | Val  Loss: 1.8516 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6841
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7714
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7651
 Best site-Real                      | Epoch:0 | Val Acc: 0.9333
 Best site-Real                      | Epoch:0 | Val Acc: 0.9365
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8571
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8222
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7714
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7587
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.3619
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.3683
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.3905
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.9589 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 0.8962 | Train Acc: 0.8369
 Site-Real                          | Train Loss: 0.5921 | Train Acc: 0.8981
 Site-Real                          | Train Loss: 0.4889 | Train Acc: 0.9534
 Site-Painting                      | Train Loss: 0.7806 | Train Acc: 0.8471
 Site-Painting                      | Train Loss: 0.7674 | Train Acc: 0.8369
 Site-Sketch                        | Train Loss: 0.9182 | Train Acc: 0.7134
 Site-Sketch                        | Train Loss: 0.8342 | Train Acc: 0.7797
 Site-QuickDraw                     | Train Loss: 1.7463 | Train Acc: 0.4777
 Site-QuickDraw                     | Train Loss: 1.7178 | Train Acc: 0.5021
 Site-Infograph                     | Train Loss: 1.6859 | Train Acc: 0.4713
 Site-Infograph                     | Train Loss: 1.5993 | Train Acc: 0.5381
Average Train Accuracy: 0.7246
 Site-Clipart                       | Val  Loss: 0.8664 | Val  Acc: 0.8381
 Site-Clipart                       | Val  Loss: 0.8812 | Val  Acc: 0.8349
 Site-Real                          | Val  Loss: 0.4849 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.5031 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.6054 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.7188 | Val  Acc: 0.8730
 Site-Sketch                        | Val  Loss: 0.8078 | Val  Acc: 0.7905
 Site-Sketch                        | Val  Loss: 0.8546 | Val  Acc: 0.7683
 Site-QuickDraw                     | Val  Loss: 1.7361 | Val  Acc: 0.4571
 Site-QuickDraw                     | Val  Loss: 1.7010 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.7163 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.6478 | Val  Acc: 0.4952
Average Valid Accuracy: 0.7415
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8381
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8349
 Best site-Real                      | Epoch:1 | Val Acc: 0.9619
 Best site-Real                      | Epoch:1 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:1 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8730
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7905
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7683
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.4571
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6906 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.6660 | Train Acc: 0.8559
 Site-Real                          | Train Loss: 0.3785 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.3197 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.6038 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.5782 | Train Acc: 0.8729
 Site-Sketch                        | Train Loss: 0.7614 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.6405 | Train Acc: 0.8199
 Site-QuickDraw                     | Train Loss: 1.5612 | Train Acc: 0.5350
 Site-QuickDraw                     | Train Loss: 1.6042 | Train Acc: 0.5191
 Site-Infograph                     | Train Loss: 1.5523 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.5273 | Train Acc: 0.5318
Average Train Accuracy: 0.7545
 Site-Clipart                       | Val  Loss: 0.6555 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.7246 | Val  Acc: 0.8508
 Site-Real                          | Val  Loss: 0.3418 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.3421 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.4359 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.5995 | Val  Acc: 0.8603
 Site-Sketch                        | Val  Loss: 0.6533 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 0.6607 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.6724 | Val  Acc: 0.4571
 Site-QuickDraw                     | Val  Loss: 1.5902 | Val  Acc: 0.5048
 Site-Infograph                     | Val  Loss: 1.6614 | Val  Acc: 0.4476
 Site-Infograph                     | Val  Loss: 1.5819 | Val  Acc: 0.5016
Average Valid Accuracy: 0.7516
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8857
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8508
 Best site-Real                      | Epoch:2 | Val Acc: 0.9714
 Best site-Real                      | Epoch:2 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:2 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8603
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8381
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8254
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.4571
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.5048
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4476
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.6539 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.6016 | Train Acc: 0.8792
 Site-Real                          | Train Loss: 0.3003 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.2256 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.5466 | Train Acc: 0.8344
 Site-Painting                      | Train Loss: 0.4968 | Train Acc: 0.8835
 Site-Sketch                        | Train Loss: 0.7259 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.5797 | Train Acc: 0.8496
 Site-QuickDraw                     | Train Loss: 1.5338 | Train Acc: 0.5287
 Site-QuickDraw                     | Train Loss: 1.4854 | Train Acc: 0.5805
 Site-Infograph                     | Train Loss: 1.6171 | Train Acc: 0.4713
 Site-Infograph                     | Train Loss: 1.4437 | Train Acc: 0.5318
Average Train Accuracy: 0.7610
 Site-Clipart                       | Val  Loss: 0.5145 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.6051 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.2313 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.2495 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.3722 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.5235 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.5535 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5772 | Val  Acc: 0.8381
 Site-QuickDraw                     | Val  Loss: 1.5121 | Val  Acc: 0.4571
 Site-QuickDraw                     | Val  Loss: 1.5067 | Val  Acc: 0.5302
 Site-Infograph                     | Val  Loss: 1.5958 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.5065 | Val  Acc: 0.5079
Average Valid Accuracy: 0.7651
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8794
 Best site-Real                      | Epoch:3 | Val Acc: 0.9810
 Best site-Real                      | Epoch:3 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:3 | Val Acc: 0.9143
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8698
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8381
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.4571
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.5302
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5079
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.5626 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.5219 | Train Acc: 0.8941
 Site-Real                          | Train Loss: 0.2621 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.1948 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4420 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.4809 | Train Acc: 0.8792
 Site-Sketch                        | Train Loss: 0.5991 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5245 | Train Acc: 0.8411
 Site-QuickDraw                     | Train Loss: 1.4010 | Train Acc: 0.5796
 Site-QuickDraw                     | Train Loss: 1.3730 | Train Acc: 0.6102
 Site-Infograph                     | Train Loss: 1.5406 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.3755 | Train Acc: 0.5593
Average Train Accuracy: 0.7798
 Site-Clipart                       | Val  Loss: 0.5250 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5569 | Val  Acc: 0.8730
 Site-Real                          | Val  Loss: 0.2104 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.2124 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.3121 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.4618 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.4832 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.5419 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.4232 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.3686 | Val  Acc: 0.5841
 Site-Infograph                     | Val  Loss: 1.6488 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.4611 | Val  Acc: 0.5302
Average Valid Accuracy: 0.7862
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8730
 Best site-Real                      | Epoch:4 | Val Acc: 0.9810
 Best site-Real                      | Epoch:4 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:4 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8667
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5619
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.5841
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5302
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.5123 | Train Acc: 0.8471
 Site-Clipart                       | Train Loss: 0.4717 | Train Acc: 0.8962
 Site-Real                          | Train Loss: 0.2350 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1664 | Train Acc: 0.9809
 Site-Painting                      | Train Loss: 0.4749 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.4052 | Train Acc: 0.9047
 Site-Sketch                        | Train Loss: 0.5394 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.5114 | Train Acc: 0.8390
 Site-QuickDraw                     | Train Loss: 1.3350 | Train Acc: 0.6051
 Site-QuickDraw                     | Train Loss: 1.3396 | Train Acc: 0.6081
 Site-Infograph                     | Train Loss: 1.5494 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.3845 | Train Acc: 0.5763
Average Train Accuracy: 0.7852
 Site-Clipart                       | Val  Loss: 0.4226 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.4878 | Val  Acc: 0.8698
 Site-Real                          | Val  Loss: 0.1578 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1799 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.2669 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.4193 | Val  Acc: 0.8794
 Site-Sketch                        | Val  Loss: 0.4256 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.4702 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.3674 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.2869 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.5763 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4283 | Val  Acc: 0.5365
Average Valid Accuracy: 0.7989
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8698
 Best site-Real                      | Epoch:5 | Val Acc: 0.9810
 Best site-Real                      | Epoch:5 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8794
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.5905
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6286
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5365
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.4312 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.4153 | Train Acc: 0.9131
 Site-Real                          | Train Loss: 0.2555 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1480 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.4035 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.3749 | Train Acc: 0.9131
 Site-Sketch                        | Train Loss: 0.5556 | Train Acc: 0.8280
 Site-Sketch                        | Train Loss: 0.4651 | Train Acc: 0.8538
 Site-QuickDraw                     | Train Loss: 1.2877 | Train Acc: 0.5987
 Site-QuickDraw                     | Train Loss: 1.2536 | Train Acc: 0.6165
 Site-Infograph                     | Train Loss: 1.4969 | Train Acc: 0.4968
 Site-Infograph                     | Train Loss: 1.3722 | Train Acc: 0.5551
Average Train Accuracy: 0.7904
 Site-Clipart                       | Val  Loss: 0.4223 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.4499 | Val  Acc: 0.8825
 Site-Real                          | Val  Loss: 0.1436 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1748 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2640 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3990 | Val  Acc: 0.9016
 Site-Sketch                        | Val  Loss: 0.3860 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.4296 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.3070 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.3065 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.5139 | Val  Acc: 0.4857
 Site-Infograph                     | Val  Loss: 1.3976 | Val  Acc: 0.5333
Average Valid Accuracy: 0.7987
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.4877 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.3937 | Train Acc: 0.8856
 Site-Real                          | Train Loss: 0.1799 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.1473 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.3254 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.3320 | Train Acc: 0.9258
 Site-Sketch                        | Train Loss: 0.4983 | Train Acc: 0.8280
 Site-Sketch                        | Train Loss: 0.4436 | Train Acc: 0.8750
 Site-QuickDraw                     | Train Loss: 1.2106 | Train Acc: 0.6051
 Site-QuickDraw                     | Train Loss: 1.2109 | Train Acc: 0.6165
 Site-Infograph                     | Train Loss: 1.4105 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.2965 | Train Acc: 0.5699
Average Train Accuracy: 0.7957
 Site-Clipart                       | Val  Loss: 0.3731 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.4417 | Val  Acc: 0.8984
 Site-Real                          | Val  Loss: 0.1301 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1590 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.2443 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3845 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.3808 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.4339 | Val  Acc: 0.8667
 Site-QuickDraw                     | Val  Loss: 1.2981 | Val  Acc: 0.5810
 Site-QuickDraw                     | Val  Loss: 1.1913 | Val  Acc: 0.6508
 Site-Infograph                     | Val  Loss: 1.4974 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.3836 | Val  Acc: 0.5492
Average Valid Accuracy: 0.8048
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.8984
 Best site-Real                      | Epoch:7 | Val Acc: 0.9905
 Best site-Real                      | Epoch:7 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8667
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.5810
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6508
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5492
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.3887 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.3762 | Train Acc: 0.9068
 Site-Real                          | Train Loss: 0.1797 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1252 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3634 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.3207 | Train Acc: 0.9174
 Site-Sketch                        | Train Loss: 0.4894 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.4523 | Train Acc: 0.8644
 Site-QuickDraw                     | Train Loss: 1.1855 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.1748 | Train Acc: 0.6589
 Site-Infograph                     | Train Loss: 1.5070 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.2924 | Train Acc: 0.5742
Average Train Accuracy: 0.8063
 Site-Clipart                       | Val  Loss: 0.4878 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 0.4316 | Val  Acc: 0.8921
 Site-Real                          | Val  Loss: 0.1116 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1341 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.2221 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.3521 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.3940 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.4549 | Val  Acc: 0.8603
 Site-QuickDraw                     | Val  Loss: 1.2001 | Val  Acc: 0.6095
 Site-QuickDraw                     | Val  Loss: 1.1439 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.4849 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.3403 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7997
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.4114 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.3669 | Train Acc: 0.9195
 Site-Real                          | Train Loss: 0.2250 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1185 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.2834 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.2928 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.4530 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.4381 | Train Acc: 0.8581
 Site-QuickDraw                     | Train Loss: 1.1304 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.1347 | Train Acc: 0.6589
 Site-Infograph                     | Train Loss: 1.3945 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.2883 | Train Acc: 0.5826
Average Train Accuracy: 0.8137
 Site-Clipart                       | Val  Loss: 0.3271 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3968 | Val  Acc: 0.9016
 Site-Real                          | Val  Loss: 0.1077 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1312 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.2445 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.2766 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3470 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.4156 | Val  Acc: 0.8762
 Site-QuickDraw                     | Val  Loss: 1.1342 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.1204 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.4413 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.3090 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8167
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9016
 Best site-Real                      | Epoch:9 | Val Acc: 0.9810
 Best site-Real                      | Epoch:9 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8762
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6476
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5778
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.3859 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.3274 | Train Acc: 0.9216
 Site-Real                          | Train Loss: 0.1818 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1071 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3285 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2696 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.3932 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.3990 | Train Acc: 0.8771
 Site-QuickDraw                     | Train Loss: 1.0726 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.0951 | Train Acc: 0.6631
 Site-Infograph                     | Train Loss: 1.3836 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.2527 | Train Acc: 0.6038
Average Train Accuracy: 0.8224
 Site-Clipart                       | Val  Loss: 0.3839 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.3788 | Val  Acc: 0.9016
 Site-Real                          | Val  Loss: 0.1005 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1195 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1790 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.3026 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3849 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.3795 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.1121 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.0677 | Val  Acc: 0.6984
 Site-Infograph                     | Val  Loss: 1.3533 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.3059 | Val  Acc: 0.5397
Average Valid Accuracy: 0.8214
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.9016
 Best site-Real                      | Epoch:10 | Val Acc: 0.9905
 Best site-Real                      | Epoch:10 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:10 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.6984
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5397
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.3893 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3117 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.1807 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1036 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3216 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.2945 | Train Acc: 0.9301
 Site-Sketch                        | Train Loss: 0.4436 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3765 | Train Acc: 0.8835
 Site-QuickDraw                     | Train Loss: 1.0348 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 1.0863 | Train Acc: 0.6780
 Site-Infograph                     | Train Loss: 1.4074 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.1944 | Train Acc: 0.6186
Average Train Accuracy: 0.8215
 Site-Clipart                       | Val  Loss: 0.3125 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3624 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.0880 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1191 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.1818 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2858 | Val  Acc: 0.9302
 Site-Sketch                        | Val  Loss: 0.3502 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.4099 | Val  Acc: 0.8762
 Site-QuickDraw                     | Val  Loss: 1.0315 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 1.0549 | Val  Acc: 0.6698
 Site-Infograph                     | Val  Loss: 1.3720 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.2577 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8286
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9111
 Best site-Real                      | Epoch:11 | Val Acc: 0.9905
 Best site-Real                      | Epoch:11 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:11 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:11 | Val Acc: 0.9302
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8762
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.6571
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.6698
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.4302 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3135 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1870 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0983 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3656 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.2547 | Train Acc: 0.9301
 Site-Sketch                        | Train Loss: 0.3630 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.3723 | Train Acc: 0.8750
 Site-QuickDraw                     | Train Loss: 1.0615 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 1.0486 | Train Acc: 0.6780
 Site-Infograph                     | Train Loss: 1.3954 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.2151 | Train Acc: 0.5805
Average Train Accuracy: 0.8162
 Site-Clipart                       | Val  Loss: 0.3239 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3252 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.1064 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1054 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1822 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2639 | Val  Acc: 0.9175
 Site-Sketch                        | Val  Loss: 0.3142 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3582 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 0.9885 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 1.0057 | Val  Acc: 0.6857
 Site-Infograph                     | Val  Loss: 1.3542 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.2642 | Val  Acc: 0.5841
Average Valid Accuracy: 0.8360
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9048
 Best site-Real                      | Epoch:12 | Val Acc: 0.9905
 Best site-Real                      | Epoch:12 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9175
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.9016
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6857
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5841
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.3778 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3149 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.1579 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0852 | Train Acc: 0.9809
 Site-Painting                      | Train Loss: 0.3409 | Train Acc: 0.9045
 Site-Painting                      | Train Loss: 0.2524 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.5021 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3916 | Train Acc: 0.8814
 Site-QuickDraw                     | Train Loss: 1.0013 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.0067 | Train Acc: 0.6970
 Site-Infograph                     | Train Loss: 1.3923 | Train Acc: 0.4968
 Site-Infograph                     | Train Loss: 1.2710 | Train Acc: 0.5911
Average Train Accuracy: 0.8165
 Site-Clipart                       | Val  Loss: 0.2944 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3212 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0857 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0993 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1859 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2830 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2957 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.3603 | Val  Acc: 0.8952
 Site-QuickDraw                     | Val  Loss: 1.0485 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 0.9817 | Val  Acc: 0.7111
 Site-Infograph                     | Val  Loss: 1.2701 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.2690 | Val  Acc: 0.5556
Average Valid Accuracy: 0.8384
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9175
 Best site-Real                      | Epoch:13 | Val Acc: 0.9905
 Best site-Real                      | Epoch:13 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8952
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.7111
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.3429 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2956 | Train Acc: 0.9195
 Site-Real                          | Train Loss: 0.1736 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0815 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.2809 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2413 | Train Acc: 0.9428
 Site-Sketch                        | Train Loss: 0.4026 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.3253 | Train Acc: 0.9047
 Site-QuickDraw                     | Train Loss: 0.9779 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 1.0119 | Train Acc: 0.6822
 Site-Infograph                     | Train Loss: 1.4036 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.1995 | Train Acc: 0.6165
Average Train Accuracy: 0.8275
 Site-Clipart                       | Val  Loss: 0.2582 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3021 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0887 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0994 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.1896 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2611 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2538 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3262 | Val  Acc: 0.8921
 Site-QuickDraw                     | Val  Loss: 1.0691 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.9666 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 1.3636 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.2175 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8360
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.3146 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2803 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.1755 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.0760 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2855 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.2152 | Train Acc: 0.9386
 Site-Sketch                        | Train Loss: 0.4080 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.3460 | Train Acc: 0.8962
 Site-QuickDraw                     | Train Loss: 1.0452 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.9937 | Train Acc: 0.6970
 Site-Infograph                     | Train Loss: 1.3228 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.1877 | Train Acc: 0.6038
Average Train Accuracy: 0.8238
 Site-Clipart                       | Val  Loss: 0.2276 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3100 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.0971 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.0857 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1785 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2762 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2503 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3254 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 1.0077 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 1.0110 | Val  Acc: 0.7079
 Site-Infograph                     | Val  Loss: 1.3377 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.2388 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8399
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.9143
 Best site-Real                      | Epoch:15 | Val Acc: 0.9714
 Best site-Real                      | Epoch:15 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.9079
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6857
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.7079
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5873
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.3590 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2891 | Train Acc: 0.9258
 Site-Real                          | Train Loss: 0.1646 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0832 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.2896 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2280 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.3760 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3484 | Train Acc: 0.8898
 Site-QuickDraw                     | Train Loss: 0.9828 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.9801 | Train Acc: 0.7119
 Site-Infograph                     | Train Loss: 1.4425 | Train Acc: 0.5541
 Site-Infograph                     | Train Loss: 1.1595 | Train Acc: 0.6335
Average Train Accuracy: 0.8268
 Site-Clipart                       | Val  Loss: 0.2713 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.3152 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.0923 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0775 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1395 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2488 | Val  Acc: 0.9365
 Site-Sketch                        | Val  Loss: 0.2971 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.2945 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.9995 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.9570 | Val  Acc: 0.6921
 Site-Infograph                     | Val  Loss: 1.3336 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.2061 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8373
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.3656 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2718 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1767 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0819 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2521 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.2211 | Train Acc: 0.9492
 Site-Sketch                        | Train Loss: 0.4105 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3143 | Train Acc: 0.9004
 Site-QuickDraw                     | Train Loss: 0.9823 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.9274 | Train Acc: 0.7246
 Site-Infograph                     | Train Loss: 1.2963 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.1341 | Train Acc: 0.6441
Average Train Accuracy: 0.8354
 Site-Clipart                       | Val  Loss: 0.2849 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.3197 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0966 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.1746 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2115 | Val  Acc: 0.9365
 Site-Sketch                        | Val  Loss: 0.2656 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3393 | Val  Acc: 0.8825
 Site-QuickDraw                     | Val  Loss: 1.0115 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 0.8915 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.3149 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.1737 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8452
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9238
 Best site-Real                      | Epoch:17 | Val Acc: 1.0000
 Best site-Real                      | Epoch:17 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9365
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8825
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.7302
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.5619
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6254
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.3247 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2320 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1793 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0720 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2715 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2171 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.4218 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.3655 | Train Acc: 0.8792
 Site-QuickDraw                     | Train Loss: 0.9379 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9444 | Train Acc: 0.7097
 Site-Infograph                     | Train Loss: 1.3159 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.1274 | Train Acc: 0.6271
Average Train Accuracy: 0.8296
 Site-Clipart                       | Val  Loss: 0.2784 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.2875 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0904 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0649 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1715 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2048 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2527 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3125 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 0.9622 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 0.9022 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.2987 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.1697 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8450
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.3734 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.2342 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1446 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0739 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.3122 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1964 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3673 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.3166 | Train Acc: 0.9025
 Site-QuickDraw                     | Train Loss: 0.9135 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8870 | Train Acc: 0.7542
 Site-Infograph                     | Train Loss: 1.3587 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0714 | Train Acc: 0.6568
Average Train Accuracy: 0.8464
 Site-Clipart                       | Val  Loss: 0.3083 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2812 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0885 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0707 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1204 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2319 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2883 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3113 | Val  Acc: 0.9111
 Site-QuickDraw                     | Val  Loss: 0.9768 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 0.9214 | Val  Acc: 0.7365
 Site-Infograph                     | Val  Loss: 1.2976 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.1561 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8489
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9175
 Best site-Real                      | Epoch:19 | Val Acc: 0.9905
 Best site-Real                      | Epoch:19 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.9111
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.6857
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.7365
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.6286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.2844 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2537 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1708 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0777 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.2482 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1756 | Train Acc: 0.9640
 Site-Sketch                        | Train Loss: 0.3160 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2933 | Train Acc: 0.9131
 Site-QuickDraw                     | Train Loss: 0.9343 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.9370 | Train Acc: 0.7225
 Site-Infograph                     | Train Loss: 1.4117 | Train Acc: 0.5350
 Site-Infograph                     | Train Loss: 1.1243 | Train Acc: 0.6483
Average Train Accuracy: 0.8384
 Site-Clipart                       | Val  Loss: 0.2637 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2756 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0652 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0703 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1457 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2136 | Val  Acc: 0.9270
 Site-Sketch                        | Val  Loss: 0.2338 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.3058 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 1.0185 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 0.9009 | Val  Acc: 0.7238
 Site-Infograph                     | Val  Loss: 1.2853 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.1668 | Val  Acc: 0.6127
Average Valid Accuracy: 0.8466
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.2929 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2478 | Train Acc: 0.9301
 Site-Real                          | Train Loss: 0.1690 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0694 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.3249 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.2194 | Train Acc: 0.9492
 Site-Sketch                        | Train Loss: 0.3532 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2611 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.9403 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.8540 | Train Acc: 0.7542
 Site-Infograph                     | Train Loss: 1.3996 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.1232 | Train Acc: 0.6271
Average Train Accuracy: 0.8383
 Site-Clipart                       | Val  Loss: 0.2252 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.3155 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0871 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0844 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1680 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2182 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2643 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.3059 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 0.9781 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.8955 | Val  Acc: 0.7365
 Site-Infograph                     | Val  Loss: 1.2392 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.1509 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8516
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9175
 Best site-Real                      | Epoch:21 | Val Acc: 0.9810
 Best site-Real                      | Epoch:21 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.7143
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.7365
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.6413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.3078 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2279 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1403 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0524 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2714 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1791 | Train Acc: 0.9619
 Site-Sketch                        | Train Loss: 0.3331 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2865 | Train Acc: 0.9131
 Site-QuickDraw                     | Train Loss: 0.9177 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.8533 | Train Acc: 0.7394
 Site-Infograph                     | Train Loss: 1.3234 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.1094 | Train Acc: 0.6568
Average Train Accuracy: 0.8467
 Site-Clipart                       | Val  Loss: 0.2182 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2409 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0515 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0594 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0978 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.2036 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.1992 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2956 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.8696 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8841 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.2426 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0943 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8632
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9238
 Best site-Real                      | Epoch:22 | Val Acc: 1.0000
 Best site-Real                      | Epoch:22 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.9079
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.7302
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.6508
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.2891 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2291 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1403 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0594 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2504 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1873 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3297 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2540 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9537 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.8755 | Train Acc: 0.7394
 Site-Infograph                     | Train Loss: 1.3133 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.1036 | Train Acc: 0.6335
Average Train Accuracy: 0.8437
 Site-Clipart                       | Val  Loss: 0.2010 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2496 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.0424 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0536 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0762 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1884 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2514 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2569 | Val  Acc: 0.9302
 Site-QuickDraw                     | Val  Loss: 0.8932 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.8352 | Val  Acc: 0.7365
 Site-Infograph                     | Val  Loss: 1.2019 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1408 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8619
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.3063 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.2223 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1927 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0715 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.2611 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1675 | Train Acc: 0.9576
 Site-Sketch                        | Train Loss: 0.3398 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2950 | Train Acc: 0.9025
 Site-QuickDraw                     | Train Loss: 0.9054 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8493 | Train Acc: 0.7648
 Site-Infograph                     | Train Loss: 1.3323 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0601 | Train Acc: 0.6610
Average Train Accuracy: 0.8446
 Site-Clipart                       | Val  Loss: 0.2242 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2543 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0818 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0597 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1765 | Val  Acc: 0.9556
 Site-Sketch                        | Val  Loss: 0.2176 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2686 | Val  Acc: 0.9111
 Site-QuickDraw                     | Val  Loss: 0.8873 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.8388 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.1180 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 1.1060 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8725
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9302
 Best site-Real                      | Epoch:24 | Val Acc: 0.9810
 Best site-Real                      | Epoch:24 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:24 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9556
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9111
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7746
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6667
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.3349 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2120 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1320 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0614 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2275 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1706 | Train Acc: 0.9534
 Site-Sketch                        | Train Loss: 0.3545 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.2801 | Train Acc: 0.9025
 Site-QuickDraw                     | Train Loss: 0.8751 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.8298 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.2601 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0821 | Train Acc: 0.6695
Average Train Accuracy: 0.8453
 Site-Clipart                       | Val  Loss: 0.2261 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2536 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0525 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0632 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1518 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.1722 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2038 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2519 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.8768 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.8054 | Val  Acc: 0.7619
 Site-Infograph                     | Val  Loss: 1.1532 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.0700 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8706
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.3362 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2544 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1777 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0636 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2341 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1788 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.4482 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.2485 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.8432 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.8105 | Train Acc: 0.7606
 Site-Infograph                     | Train Loss: 1.3460 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0600 | Train Acc: 0.6610
Average Train Accuracy: 0.8467
 Site-Clipart                       | Val  Loss: 0.1841 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2310 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0560 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0722 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1394 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.1746 | Val  Acc: 0.9460
 Site-Sketch                        | Val  Loss: 0.2206 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2807 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.8968 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.8275 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.1430 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0673 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8685
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2890 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2361 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1563 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0454 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2745 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1714 | Train Acc: 0.9640
 Site-Sketch                        | Train Loss: 0.3584 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2705 | Train Acc: 0.9047
 Site-QuickDraw                     | Train Loss: 0.9240 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.7758 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.1938 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9958 | Train Acc: 0.6737
Average Train Accuracy: 0.8483
 Site-Clipart                       | Val  Loss: 0.2052 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2283 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0896 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0517 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1084 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1717 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2176 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2694 | Val  Acc: 0.9111
 Site-QuickDraw                     | Val  Loss: 0.8835 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.8428 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 1.1354 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0462 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8685
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.3081 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2067 | Train Acc: 0.9364
 Site-Real                          | Train Loss: 0.1315 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0592 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2432 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.1420 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3445 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2476 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.8208 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7962 | Train Acc: 0.7691
 Site-Infograph                     | Train Loss: 1.2994 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.0317 | Train Acc: 0.6568
Average Train Accuracy: 0.8485
 Site-Clipart                       | Val  Loss: 0.1763 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2234 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0433 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1200 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1692 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.2520 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.2814 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 0.9106 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.7840 | Val  Acc: 0.7587
 Site-Infograph                     | Val  Loss: 1.1630 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0688 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8632
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.3167 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2200 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1569 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0495 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2225 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1579 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3507 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2766 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.8677 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8036 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.3041 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.0014 | Train Acc: 0.6970
Average Train Accuracy: 0.8538
 Site-Clipart                       | Val  Loss: 0.1625 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2439 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0589 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1012 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1608 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2005 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2717 | Val  Acc: 0.9048
 Site-QuickDraw                     | Val  Loss: 0.9184 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.8554 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.0979 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.0790 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8675
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.3286 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1988 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1299 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0600 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.2229 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1235 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.3455 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2733 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.8552 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.7932 | Train Acc: 0.7521
 Site-Infograph                     | Train Loss: 1.3100 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0421 | Train Acc: 0.6737
Average Train Accuracy: 0.8485
 Site-Clipart                       | Val  Loss: 0.1798 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2354 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0678 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0588 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1096 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1505 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1591 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2503 | Val  Acc: 0.9111
 Site-QuickDraw                     | Val  Loss: 0.7513 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.8024 | Val  Acc: 0.7365
 Site-Infograph                     | Val  Loss: 1.1940 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.1011 | Val  Acc: 0.6444
Average Valid Accuracy: 0.8698
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.2792 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1998 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1204 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0494 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2349 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.1362 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.4786 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.2535 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.8557 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.8095 | Train Acc: 0.7479
 Site-Infograph                     | Train Loss: 1.2443 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 1.0516 | Train Acc: 0.6864
Average Train Accuracy: 0.8513
 Site-Clipart                       | Val  Loss: 0.2175 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2332 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0677 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0470 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0987 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1630 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.1947 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2626 | Val  Acc: 0.9111
 Site-QuickDraw                     | Val  Loss: 0.8176 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.8314 | Val  Acc: 0.7460
 Site-Infograph                     | Val  Loss: 1.1686 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0638 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8712
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.2808 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1843 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1471 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.0457 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.2319 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1546 | Train Acc: 0.9640
 Site-Sketch                        | Train Loss: 0.2975 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.2390 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.8748 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.8075 | Train Acc: 0.7585
 Site-Infograph                     | Train Loss: 1.3151 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0448 | Train Acc: 0.6970
Average Train Accuracy: 0.8536
 Site-Clipart                       | Val  Loss: 0.1601 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2214 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0619 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.1073 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1314 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2060 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2101 | Val  Acc: 0.9492
 Site-QuickDraw                     | Val  Loss: 0.7817 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7883 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.1588 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0571 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8820
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9460
 Best site-Real                      | Epoch:32 | Val Acc: 1.0000
 Best site-Real                      | Epoch:32 | Val Acc: 0.9841
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.9492
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7619
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.7429
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.6762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.3115 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1896 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1133 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0452 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2582 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1471 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3256 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2425 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.8410 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.7748 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.3085 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.0612 | Train Acc: 0.6949
Average Train Accuracy: 0.8538
 Site-Clipart                       | Val  Loss: 0.2020 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2317 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0406 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0483 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0913 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1222 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.2503 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.2392 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8858 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7708 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1342 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0668 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8733
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.2557 | Train Acc: 0.9299
 Site-Clipart                       | Train Loss: 0.2070 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1116 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0470 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2108 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1244 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3113 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2359 | Train Acc: 0.9237
 Site-QuickDraw                     | Train Loss: 0.7667 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7971 | Train Acc: 0.7585
 Site-Infograph                     | Train Loss: 1.2760 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0215 | Train Acc: 0.6695
Average Train Accuracy: 0.8556
 Site-Clipart                       | Val  Loss: 0.1792 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2178 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.1027 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0494 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1049 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1214 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2025 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2400 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7129 | Val  Acc: 0.8095
 Site-QuickDraw                     | Val  Loss: 0.7635 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.0908 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.0247 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8778
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.3109 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2017 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1531 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0523 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2066 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1436 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3059 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2211 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.7422 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.7538 | Train Acc: 0.7775
 Site-Infograph                     | Train Loss: 1.2443 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.0261 | Train Acc: 0.6737
Average Train Accuracy: 0.8575
 Site-Clipart                       | Val  Loss: 0.2096 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2068 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0694 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0458 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1110 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1252 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2319 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2666 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.7892 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.7747 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1110 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0355 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8730
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.4253 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1966 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1638 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0403 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1927 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1133 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.2854 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.2609 | Train Acc: 0.9153
 Site-QuickDraw                     | Train Loss: 0.7376 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7542 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.3122 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0541 | Train Acc: 0.6928
Average Train Accuracy: 0.8547
 Site-Clipart                       | Val  Loss: 0.1473 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.1850 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0845 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0411 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1096 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1126 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1607 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2288 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7565 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7253 | Val  Acc: 0.7937
 Site-Infograph                     | Val  Loss: 1.0669 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0507 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8860
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9810
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9556
 Best site-Real                      | Epoch:36 | Val Acc: 0.9810
 Best site-Real                      | Epoch:36 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.9397
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.7714
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.7937
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.2967 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.1659 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1390 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0367 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2506 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1427 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.2935 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2158 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 0.8045 | Train Acc: 0.7452
 Site-QuickDraw                     | Train Loss: 0.7825 | Train Acc: 0.7564
 Site-Infograph                     | Train Loss: 1.1842 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9908 | Train Acc: 0.6780
Average Train Accuracy: 0.8584
 Site-Clipart                       | Val  Loss: 0.2050 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1847 | Val  Acc: 0.9587
 Site-Real                          | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0416 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1146 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1188 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.2072 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2378 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.7814 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7419 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1353 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0315 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8815
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3008 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2129 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1415 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0349 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2636 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1077 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3076 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2348 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.8048 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.7593 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.2806 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9450 | Train Acc: 0.7055
Average Train Accuracy: 0.8591
 Site-Clipart                       | Val  Loss: 0.1809 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2284 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0418 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0720 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1173 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1691 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2170 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.8821 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.7576 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.1182 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0042 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8791
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.2529 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1855 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1425 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0396 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2535 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1255 | Train Acc: 0.9640
 Site-Sketch                        | Train Loss: 0.3632 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2240 | Train Acc: 0.9449
 Site-QuickDraw                     | Train Loss: 0.7778 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7274 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.3715 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0025 | Train Acc: 0.6780
Average Train Accuracy: 0.8572
 Site-Clipart                       | Val  Loss: 0.1994 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2056 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0353 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0432 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0783 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1210 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.1707 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2076 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.7606 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7535 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1227 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0655 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8794
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3177 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1835 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1070 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0364 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2161 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1389 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3837 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2349 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.8002 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7036 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.3352 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9829 | Train Acc: 0.7055
Average Train Accuracy: 0.8580
 Site-Clipart                       | Val  Loss: 0.1807 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1938 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0425 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0407 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0836 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1200 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2067 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2082 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7487 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7368 | Val  Acc: 0.7968
 Site-Infograph                     | Val  Loss: 1.0216 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 0.9817 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8799
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.2881 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1692 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1166 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0454 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.1979 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1280 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.3000 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2062 | Train Acc: 0.9386
 Site-QuickDraw                     | Train Loss: 0.7841 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.7425 | Train Acc: 0.7775
 Site-Infograph                     | Train Loss: 1.3363 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0052 | Train Acc: 0.6801
Average Train Accuracy: 0.8588
 Site-Clipart                       | Val  Loss: 0.1875 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2111 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0369 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0913 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1356 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1503 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2324 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.7333 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.6992 | Val  Acc: 0.8095
 Site-Infograph                     | Val  Loss: 1.0416 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0111 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8870
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9524
 Best site-Real                      | Epoch:41 | Val Acc: 1.0000
 Best site-Real                      | Epoch:41 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:41 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:41 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.9619
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.9270
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.7714
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.8095
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.6286
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.6762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.2531 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1717 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1090 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0355 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2354 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1239 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.2942 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2052 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.8142 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7432 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.2657 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.9764 | Train Acc: 0.6907
Average Train Accuracy: 0.8591
 Site-Clipart                       | Val  Loss: 0.1514 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.1909 | Val  Acc: 0.9587
 Site-Real                          | Val  Loss: 0.0237 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0495 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0691 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1107 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2218 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2480 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 0.7701 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7087 | Val  Acc: 0.8032
 Site-Infograph                     | Val  Loss: 1.0565 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 0.9881 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8860
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.2675 | Train Acc: 0.9363
 Site-Clipart                       | Train Loss: 0.1703 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1257 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0323 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2193 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1086 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3247 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2087 | Train Acc: 0.9237
 Site-QuickDraw                     | Train Loss: 0.7344 | Train Acc: 0.7771
 Site-QuickDraw                     | Train Loss: 0.7303 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.2195 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 0.9638 | Train Acc: 0.7076
Average Train Accuracy: 0.8644
 Site-Clipart                       | Val  Loss: 0.1538 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2173 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0201 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0370 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0816 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1107 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.2066 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2498 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 0.7209 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7292 | Val  Acc: 0.7587
 Site-Infograph                     | Val  Loss: 1.1064 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9871 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8794
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.2913 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1734 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1208 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0321 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2112 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.0986 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.2344 | Train Acc: 0.9299
 Site-Sketch                        | Train Loss: 0.2185 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 0.7395 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.6999 | Train Acc: 0.7818
 Site-Infograph                     | Train Loss: 1.2501 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 0.9423 | Train Acc: 0.7161
Average Train Accuracy: 0.8672
 Site-Clipart                       | Val  Loss: 0.1660 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2205 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0396 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0940 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1012 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1693 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2044 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7945 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.6792 | Val  Acc: 0.7905
 Site-Infograph                     | Val  Loss: 1.0295 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9690 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8860
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.3109 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1543 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1120 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0386 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2329 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1116 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.3243 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.2102 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.8131 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.6979 | Train Acc: 0.7903
 Site-Infograph                     | Train Loss: 1.2833 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9737 | Train Acc: 0.6928
Average Train Accuracy: 0.8642
 Site-Clipart                       | Val  Loss: 0.1725 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1852 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0228 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0457 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1427 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1203 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1518 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2496 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.6722 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6786 | Val  Acc: 0.7905
 Site-Infograph                     | Val  Loss: 1.0909 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9768 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8857
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.2400 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1696 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1061 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0307 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1769 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0961 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.2844 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.1870 | Train Acc: 0.9407
 Site-QuickDraw                     | Train Loss: 0.7888 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.7077 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.3201 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9662 | Train Acc: 0.6886
Average Train Accuracy: 0.8635
 Site-Clipart                       | Val  Loss: 0.1829 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2103 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0304 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0317 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0640 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1213 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1583 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2159 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.7273 | Val  Acc: 0.7905
 Site-QuickDraw                     | Val  Loss: 0.7280 | Val  Acc: 0.7810
 Site-Infograph                     | Val  Loss: 1.0210 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 0.9665 | Val  Acc: 0.7238
Average Valid Accuracy: 0.8979
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.9397
 Best site-Real                      | Epoch:46 | Val Acc: 1.0000
 Best site-Real                      | Epoch:46 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:46 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:46 | Val Acc: 0.9778
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.9619
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.9365
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.7905
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.7810
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.7143
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.7238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/harmo-fl...
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.3273 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.1676 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1041 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0449 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2337 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1084 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.3428 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2079 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.7352 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6755 | Train Acc: 0.7987
 Site-Infograph                     | Train Loss: 1.3117 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 0.9439 | Train Acc: 0.6992
Average Train Accuracy: 0.8637
 Site-Clipart                       | Val  Loss: 0.1756 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1993 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0329 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0819 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1099 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1937 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.1930 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.7134 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 0.6945 | Val  Acc: 0.7873
 Site-Infograph                     | Val  Loss: 1.0107 | Val  Acc: 0.7048
 Site-Infograph                     | Val  Loss: 0.9965 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8894
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3102 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1956 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1177 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0486 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.1758 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1064 | Train Acc: 0.9809
 Site-Sketch                        | Train Loss: 0.2965 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2225 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 0.7129 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.7396 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.2863 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9665 | Train Acc: 0.7140
Average Train Accuracy: 0.8635
 Site-Clipart                       | Val  Loss: 0.1845 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1922 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0360 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0848 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1081 | Val  Acc: 0.9778
 Site-Sketch                        | Val  Loss: 0.1758 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2093 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7398 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.6811 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0687 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9843 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8868
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.4033 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1761 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.1385 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0282 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2713 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.1114 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.2824 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2104 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 0.7674 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6838 | Train Acc: 0.7924
 Site-Infograph                     | Train Loss: 1.3071 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9291 | Train Acc: 0.7055
Average Train Accuracy: 0.8635
 Site-Clipart                       | Val  Loss: 0.1880 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.2142 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0188 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0353 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0845 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1872 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2149 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.7047 | Val  Acc: 0.7905
 Site-QuickDraw                     | Val  Loss: 0.7034 | Val  Acc: 0.8000
 Site-Infograph                     | Val  Loss: 1.1012 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 0.9302 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8831
===2023-07-29 12:52:45===
===2023-07-29 12:53:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:46 | Test Acc: 0.9297
 Test site-Real                      | Epoch:46 | Test Acc: 0.9523
 Test site-Painting                  | Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    | Epoch:46 | Test Acc: 0.8881
 Test site-QuickDraw                 | Epoch:46 | Test Acc: 0.7280
 Test site-Infograph                 | Epoch:46 | Test Acc: 0.5556
Clipart: 0.9297, Real: 0.9523, Painting: 0.9305, Sketch: 0.8881, QuickDraw: 0.7280, Infograph: 0.5556, 
Average Test Accuracy(group): 0.8307, Average Test Accuracy(individual): 0.8307,
domain std=0.1438, cluster std=-1.0000, individual std=0.1438, 
