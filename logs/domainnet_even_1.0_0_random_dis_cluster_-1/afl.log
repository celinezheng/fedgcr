===2023-07-29 04:14:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.1543 | Train Acc: 0.5032
 Site-Clipart                       | Train Loss: 2.1696 | Train Acc: 0.4449
 Site-Real                          | Train Loss: 2.1512 | Train Acc: 0.6306
 Site-Real                          | Train Loss: 2.1323 | Train Acc: 0.6801
 Site-Painting                      | Train Loss: 2.1570 | Train Acc: 0.5605
 Site-Painting                      | Train Loss: 2.1538 | Train Acc: 0.5148
 Site-Sketch                        | Train Loss: 2.1756 | Train Acc: 0.4713
 Site-Sketch                        | Train Loss: 2.1768 | Train Acc: 0.4407
 Site-QuickDraw                     | Train Loss: 2.2473 | Train Acc: 0.1592
 Site-QuickDraw                     | Train Loss: 2.2631 | Train Acc: 0.1822
 Site-Infograph                     | Train Loss: 2.2649 | Train Acc: 0.2548
 Site-Infograph                     | Train Loss: 2.2398 | Train Acc: 0.2733
Average Train Accuracy: 0.4263
 Site-Clipart                       | Val  Loss: 2.1849 | Val  Acc: 0.4000
 Site-Clipart                       | Val  Loss: 2.1808 | Val  Acc: 0.4444
 Site-Real                          | Val  Loss: 2.1304 | Val  Acc: 0.6095
 Site-Real                          | Val  Loss: 2.1295 | Val  Acc: 0.6921
 Site-Painting                      | Val  Loss: 2.1218 | Val  Acc: 0.6190
 Site-Painting                      | Val  Loss: 2.1409 | Val  Acc: 0.5238
 Site-Sketch                        | Val  Loss: 2.1853 | Val  Acc: 0.4095
 Site-Sketch                        | Val  Loss: 2.1764 | Val  Acc: 0.4476
 Site-QuickDraw                     | Val  Loss: 2.2572 | Val  Acc: 0.1810
 Site-QuickDraw                     | Val  Loss: 2.2590 | Val  Acc: 0.1778
 Site-Infograph                     | Val  Loss: 2.2605 | Val  Acc: 0.2381
 Site-Infograph                     | Val  Loss: 2.2432 | Val  Acc: 0.2698
Average Valid Accuracy: 0.4177
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.4444
 Best site-Real                      | Epoch:0 | Val Acc: 0.6095
 Best site-Real                      | Epoch:0 | Val Acc: 0.6921
 Best site-Painting                  | Epoch:0 | Val Acc: 0.6190
 Best site-Painting                  | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4095
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4476
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1810
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1778
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2698
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 2.0524 | Train Acc: 0.6879
 Site-Clipart                       | Train Loss: 2.0598 | Train Acc: 0.6314
 Site-Real                          | Train Loss: 2.0076 | Train Acc: 0.7707
 Site-Real                          | Train Loss: 1.9687 | Train Acc: 0.8326
 Site-Painting                      | Train Loss: 2.0181 | Train Acc: 0.7070
 Site-Painting                      | Train Loss: 2.0154 | Train Acc: 0.7119
 Site-Sketch                        | Train Loss: 2.0489 | Train Acc: 0.5924
 Site-Sketch                        | Train Loss: 2.0384 | Train Acc: 0.6271
 Site-QuickDraw                     | Train Loss: 2.2054 | Train Acc: 0.3057
 Site-QuickDraw                     | Train Loss: 2.2075 | Train Acc: 0.3220
 Site-Infograph                     | Train Loss: 2.2039 | Train Acc: 0.3503
 Site-Infograph                     | Train Loss: 2.1783 | Train Acc: 0.3708
Average Train Accuracy: 0.5758
 Site-Clipart                       | Val  Loss: 2.0627 | Val  Acc: 0.6571
 Site-Clipart                       | Val  Loss: 2.0575 | Val  Acc: 0.6222
 Site-Real                          | Val  Loss: 1.9647 | Val  Acc: 0.8190
 Site-Real                          | Val  Loss: 1.9777 | Val  Acc: 0.8190
 Site-Painting                      | Val  Loss: 1.9681 | Val  Acc: 0.7810
 Site-Painting                      | Val  Loss: 2.0098 | Val  Acc: 0.7206
 Site-Sketch                        | Val  Loss: 2.0412 | Val  Acc: 0.6381
 Site-Sketch                        | Val  Loss: 2.0391 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 2.2135 | Val  Acc: 0.2381
 Site-QuickDraw                     | Val  Loss: 2.2047 | Val  Acc: 0.3079
 Site-Infograph                     | Val  Loss: 2.2123 | Val  Acc: 0.2571
 Site-Infograph                     | Val  Loss: 2.1884 | Val  Acc: 0.3556
Average Valid Accuracy: 0.5704
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6571
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.6222
 Best site-Real                      | Epoch:1 | Val Acc: 0.8190
 Best site-Real                      | Epoch:1 | Val Acc: 0.8190
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7810
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7206
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6381
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6286
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2381
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.3079
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.2571
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3556
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.9188 | Train Acc: 0.7707
 Site-Clipart                       | Train Loss: 1.9282 | Train Acc: 0.7013
 Site-Real                          | Train Loss: 1.8685 | Train Acc: 0.8153
 Site-Real                          | Train Loss: 1.8179 | Train Acc: 0.8814
 Site-Painting                      | Train Loss: 1.8879 | Train Acc: 0.7580
 Site-Painting                      | Train Loss: 1.8825 | Train Acc: 0.7691
 Site-Sketch                        | Train Loss: 1.9341 | Train Acc: 0.6369
 Site-Sketch                        | Train Loss: 1.9118 | Train Acc: 0.6928
 Site-QuickDraw                     | Train Loss: 2.1439 | Train Acc: 0.3949
 Site-QuickDraw                     | Train Loss: 2.1654 | Train Acc: 0.3771
 Site-Infograph                     | Train Loss: 2.1351 | Train Acc: 0.4586
 Site-Infograph                     | Train Loss: 2.1290 | Train Acc: 0.4068
Average Train Accuracy: 0.6386
 Site-Clipart                       | Val  Loss: 1.9473 | Val  Acc: 0.6857
 Site-Clipart                       | Val  Loss: 1.9586 | Val  Acc: 0.6762
 Site-Real                          | Val  Loss: 1.8328 | Val  Acc: 0.8571
 Site-Real                          | Val  Loss: 1.8298 | Val  Acc: 0.8603
 Site-Painting                      | Val  Loss: 1.8213 | Val  Acc: 0.8381
 Site-Painting                      | Val  Loss: 1.8877 | Val  Acc: 0.7651
 Site-Sketch                        | Val  Loss: 1.9413 | Val  Acc: 0.6762
 Site-Sketch                        | Val  Loss: 1.9306 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 2.1831 | Val  Acc: 0.2762
 Site-QuickDraw                     | Val  Loss: 2.1636 | Val  Acc: 0.3905
 Site-Infograph                     | Val  Loss: 2.1633 | Val  Acc: 0.3524
 Site-Infograph                     | Val  Loss: 2.1351 | Val  Acc: 0.3810
Average Valid Accuracy: 0.6212
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6857
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.6762
 Best site-Real                      | Epoch:2 | Val Acc: 0.8571
 Best site-Real                      | Epoch:2 | Val Acc: 0.8603
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8381
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7651
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6762
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6952
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2762
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.3905
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3524
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.8217 | Train Acc: 0.7643
 Site-Clipart                       | Train Loss: 1.8358 | Train Acc: 0.7203
 Site-Real                          | Train Loss: 1.7219 | Train Acc: 0.8726
 Site-Real                          | Train Loss: 1.6700 | Train Acc: 0.9089
 Site-Painting                      | Train Loss: 1.7634 | Train Acc: 0.8025
 Site-Painting                      | Train Loss: 1.7695 | Train Acc: 0.7987
 Site-Sketch                        | Train Loss: 1.8412 | Train Acc: 0.6369
 Site-Sketch                        | Train Loss: 1.8003 | Train Acc: 0.7161
 Site-QuickDraw                     | Train Loss: 2.1078 | Train Acc: 0.4140
 Site-QuickDraw                     | Train Loss: 2.1148 | Train Acc: 0.4322
 Site-Infograph                     | Train Loss: 2.1182 | Train Acc: 0.4076
 Site-Infograph                     | Train Loss: 2.0605 | Train Acc: 0.4343
Average Train Accuracy: 0.6591
 Site-Clipart                       | Val  Loss: 1.8450 | Val  Acc: 0.7238
 Site-Clipart                       | Val  Loss: 1.8522 | Val  Acc: 0.6952
 Site-Real                          | Val  Loss: 1.6787 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 1.6835 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 1.6953 | Val  Acc: 0.8095
 Site-Painting                      | Val  Loss: 1.7671 | Val  Acc: 0.8000
 Site-Sketch                        | Val  Loss: 1.8107 | Val  Acc: 0.7238
 Site-Sketch                        | Val  Loss: 1.8012 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 2.1134 | Val  Acc: 0.4190
 Site-QuickDraw                     | Val  Loss: 2.1223 | Val  Acc: 0.3968
 Site-Infograph                     | Val  Loss: 2.1158 | Val  Acc: 0.3429
 Site-Infograph                     | Val  Loss: 2.0860 | Val  Acc: 0.4095
Average Valid Accuracy: 0.6537
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7238
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.6952
 Best site-Real                      | Epoch:3 | Val Acc: 0.9048
 Best site-Real                      | Epoch:3 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8095
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7238
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.4190
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3968
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3429
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.7263 | Train Acc: 0.7834
 Site-Clipart                       | Train Loss: 1.7335 | Train Acc: 0.7542
 Site-Real                          | Train Loss: 1.5962 | Train Acc: 0.8790
 Site-Real                          | Train Loss: 1.5368 | Train Acc: 0.9301
 Site-Painting                      | Train Loss: 1.6414 | Train Acc: 0.7516
 Site-Painting                      | Train Loss: 1.6668 | Train Acc: 0.7924
 Site-Sketch                        | Train Loss: 1.7266 | Train Acc: 0.6624
 Site-Sketch                        | Train Loss: 1.6914 | Train Acc: 0.7267
 Site-QuickDraw                     | Train Loss: 2.0450 | Train Acc: 0.4968
 Site-QuickDraw                     | Train Loss: 2.0714 | Train Acc: 0.4915
 Site-Infograph                     | Train Loss: 2.0422 | Train Acc: 0.4395
 Site-Infograph                     | Train Loss: 2.0032 | Train Acc: 0.4576
Average Train Accuracy: 0.6804
 Site-Clipart                       | Val  Loss: 1.7496 | Val  Acc: 0.7524
 Site-Clipart                       | Val  Loss: 1.7511 | Val  Acc: 0.7079
 Site-Real                          | Val  Loss: 1.5566 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 1.5518 | Val  Acc: 0.9079
 Site-Painting                      | Val  Loss: 1.5809 | Val  Acc: 0.8381
 Site-Painting                      | Val  Loss: 1.6559 | Val  Acc: 0.8095
 Site-Sketch                        | Val  Loss: 1.7219 | Val  Acc: 0.7238
 Site-Sketch                        | Val  Loss: 1.6994 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 2.0755 | Val  Acc: 0.4381
 Site-QuickDraw                     | Val  Loss: 2.0663 | Val  Acc: 0.4635
 Site-Infograph                     | Val  Loss: 2.0940 | Val  Acc: 0.3333
 Site-Infograph                     | Val  Loss: 2.0351 | Val  Acc: 0.4159
Average Valid Accuracy: 0.6675
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7524
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.7079
 Best site-Real                      | Epoch:4 | Val Acc: 0.9143
 Best site-Real                      | Epoch:4 | Val Acc: 0.9079
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8381
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7238
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.4381
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.4635
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.3333
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4159
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.6095 | Train Acc: 0.7898
 Site-Clipart                       | Train Loss: 1.6360 | Train Acc: 0.7648
 Site-Real                          | Train Loss: 1.4668 | Train Acc: 0.8854
 Site-Real                          | Train Loss: 1.4242 | Train Acc: 0.9322
 Site-Painting                      | Train Loss: 1.5521 | Train Acc: 0.8089
 Site-Painting                      | Train Loss: 1.5529 | Train Acc: 0.8157
 Site-Sketch                        | Train Loss: 1.6089 | Train Acc: 0.7006
 Site-Sketch                        | Train Loss: 1.6149 | Train Acc: 0.7182
 Site-QuickDraw                     | Train Loss: 2.0121 | Train Acc: 0.4713
 Site-QuickDraw                     | Train Loss: 2.0284 | Train Acc: 0.5233
 Site-Infograph                     | Train Loss: 2.0337 | Train Acc: 0.4713
 Site-Infograph                     | Train Loss: 1.9763 | Train Acc: 0.4513
Average Train Accuracy: 0.6944
 Site-Clipart                       | Val  Loss: 1.6476 | Val  Acc: 0.7619
 Site-Clipart                       | Val  Loss: 1.6547 | Val  Acc: 0.7587
 Site-Real                          | Val  Loss: 1.4285 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 1.4410 | Val  Acc: 0.9302
 Site-Painting                      | Val  Loss: 1.4646 | Val  Acc: 0.8667
 Site-Painting                      | Val  Loss: 1.5455 | Val  Acc: 0.8127
 Site-Sketch                        | Val  Loss: 1.6092 | Val  Acc: 0.7905
 Site-Sketch                        | Val  Loss: 1.6169 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 2.0368 | Val  Acc: 0.5238
 Site-QuickDraw                     | Val  Loss: 2.0230 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 2.0467 | Val  Acc: 0.3810
 Site-Infograph                     | Val  Loss: 1.9946 | Val  Acc: 0.4413
Average Valid Accuracy: 0.7056
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7587
 Best site-Real                      | Epoch:5 | Val Acc: 0.9429
 Best site-Real                      | Epoch:5 | Val Acc: 0.9302
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8667
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8127
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7905
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7238
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.5238
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.3810
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.5084 | Train Acc: 0.8280
 Site-Clipart                       | Train Loss: 1.5352 | Train Acc: 0.7818
 Site-Real                          | Train Loss: 1.4046 | Train Acc: 0.8790
 Site-Real                          | Train Loss: 1.2970 | Train Acc: 0.9449
 Site-Painting                      | Train Loss: 1.4450 | Train Acc: 0.8344
 Site-Painting                      | Train Loss: 1.4523 | Train Acc: 0.8178
 Site-Sketch                        | Train Loss: 1.5434 | Train Acc: 0.6688
 Site-Sketch                        | Train Loss: 1.5014 | Train Acc: 0.7267
 Site-QuickDraw                     | Train Loss: 1.9575 | Train Acc: 0.5350
 Site-QuickDraw                     | Train Loss: 1.9796 | Train Acc: 0.5487
 Site-Infograph                     | Train Loss: 1.9802 | Train Acc: 0.4650
 Site-Infograph                     | Train Loss: 1.8988 | Train Acc: 0.4767
Average Train Accuracy: 0.7089
 Site-Clipart                       | Val  Loss: 1.5637 | Val  Acc: 0.7810
 Site-Clipart                       | Val  Loss: 1.5640 | Val  Acc: 0.7587
 Site-Real                          | Val  Loss: 1.3258 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 1.3314 | Val  Acc: 0.9270
 Site-Painting                      | Val  Loss: 1.3461 | Val  Acc: 0.8857
 Site-Painting                      | Val  Loss: 1.4529 | Val  Acc: 0.8190
 Site-Sketch                        | Val  Loss: 1.5091 | Val  Acc: 0.7143
 Site-Sketch                        | Val  Loss: 1.5181 | Val  Acc: 0.7302
 Site-QuickDraw                     | Val  Loss: 1.9654 | Val  Acc: 0.5333
 Site-QuickDraw                     | Val  Loss: 1.9898 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.9809 | Val  Acc: 0.4000
 Site-Infograph                     | Val  Loss: 1.9378 | Val  Acc: 0.4476
Average Valid Accuracy: 0.7053
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.4830 | Train Acc: 0.8217
 Site-Clipart                       | Train Loss: 1.4546 | Train Acc: 0.7966
 Site-Real                          | Train Loss: 1.2807 | Train Acc: 0.8917
 Site-Real                          | Train Loss: 1.2162 | Train Acc: 0.9301
 Site-Painting                      | Train Loss: 1.3521 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 1.3539 | Train Acc: 0.8220
 Site-Sketch                        | Train Loss: 1.4434 | Train Acc: 0.7325
 Site-Sketch                        | Train Loss: 1.4254 | Train Acc: 0.7479
 Site-QuickDraw                     | Train Loss: 1.9062 | Train Acc: 0.5860
 Site-QuickDraw                     | Train Loss: 1.9244 | Train Acc: 0.5805
 Site-Infograph                     | Train Loss: 1.9169 | Train Acc: 0.4713
 Site-Infograph                     | Train Loss: 1.8517 | Train Acc: 0.4958
Average Train Accuracy: 0.7264
 Site-Clipart                       | Val  Loss: 1.4823 | Val  Acc: 0.7905
 Site-Clipart                       | Val  Loss: 1.4839 | Val  Acc: 0.7683
 Site-Real                          | Val  Loss: 1.2215 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 1.2347 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 1.2782 | Val  Acc: 0.8667
 Site-Painting                      | Val  Loss: 1.3678 | Val  Acc: 0.8317
 Site-Sketch                        | Val  Loss: 1.4389 | Val  Acc: 0.7524
 Site-Sketch                        | Val  Loss: 1.4194 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.9597 | Val  Acc: 0.5048
 Site-QuickDraw                     | Val  Loss: 1.9185 | Val  Acc: 0.5683
 Site-Infograph                     | Val  Loss: 1.9621 | Val  Acc: 0.4095
 Site-Infograph                     | Val  Loss: 1.8992 | Val  Acc: 0.4667
Average Valid Accuracy: 0.7177
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7905
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7683
 Best site-Real                      | Epoch:7 | Val Acc: 0.9429
 Best site-Real                      | Epoch:7 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8667
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8317
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7524
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.7778
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.5048
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.5683
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4095
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.4667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.3379 | Train Acc: 0.8344
 Site-Clipart                       | Train Loss: 1.3852 | Train Acc: 0.8072
 Site-Real                          | Train Loss: 1.1924 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 1.1132 | Train Acc: 0.9470
 Site-Painting                      | Train Loss: 1.2835 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 1.2940 | Train Acc: 0.8453
 Site-Sketch                        | Train Loss: 1.3868 | Train Acc: 0.7197
 Site-Sketch                        | Train Loss: 1.3675 | Train Acc: 0.7436
 Site-QuickDraw                     | Train Loss: 1.8768 | Train Acc: 0.5924
 Site-QuickDraw                     | Train Loss: 1.8941 | Train Acc: 0.6038
 Site-Infograph                     | Train Loss: 1.9128 | Train Acc: 0.4777
 Site-Infograph                     | Train Loss: 1.8190 | Train Acc: 0.4979
Average Train Accuracy: 0.7351
 Site-Clipart                       | Val  Loss: 1.4499 | Val  Acc: 0.7524
 Site-Clipart                       | Val  Loss: 1.4288 | Val  Acc: 0.7778
 Site-Real                          | Val  Loss: 1.1467 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 1.1378 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 1.1763 | Val  Acc: 0.8952
 Site-Painting                      | Val  Loss: 1.2925 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 1.3719 | Val  Acc: 0.7714
 Site-Sketch                        | Val  Loss: 1.3590 | Val  Acc: 0.7397
 Site-QuickDraw                     | Val  Loss: 1.8917 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.8834 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.9224 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.8581 | Val  Acc: 0.4730
Average Valid Accuracy: 0.7278
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7524
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7778
 Best site-Real                      | Epoch:8 | Val Acc: 0.9238
 Best site-Real                      | Epoch:8 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8952
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8381
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7714
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7397
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.5619
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.2958 | Train Acc: 0.8089
 Site-Clipart                       | Train Loss: 1.3275 | Train Acc: 0.8242
 Site-Real                          | Train Loss: 1.1423 | Train Acc: 0.8981
 Site-Real                          | Train Loss: 1.0276 | Train Acc: 0.9492
 Site-Painting                      | Train Loss: 1.1518 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 1.2140 | Train Acc: 0.8517
 Site-Sketch                        | Train Loss: 1.2929 | Train Acc: 0.7261
 Site-Sketch                        | Train Loss: 1.2841 | Train Acc: 0.7669
 Site-QuickDraw                     | Train Loss: 1.8203 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.8564 | Train Acc: 0.5890
 Site-Infograph                     | Train Loss: 1.8690 | Train Acc: 0.5096
 Site-Infograph                     | Train Loss: 1.7861 | Train Acc: 0.5212
Average Train Accuracy: 0.7425
 Site-Clipart                       | Val  Loss: 1.3259 | Val  Acc: 0.8190
 Site-Clipart                       | Val  Loss: 1.3581 | Val  Acc: 0.8000
 Site-Real                          | Val  Loss: 1.0641 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 1.0536 | Val  Acc: 0.9302
 Site-Painting                      | Val  Loss: 1.0899 | Val  Acc: 0.8571
 Site-Painting                      | Val  Loss: 1.2029 | Val  Acc: 0.8444
 Site-Sketch                        | Val  Loss: 1.2884 | Val  Acc: 0.7810
 Site-Sketch                        | Val  Loss: 1.2774 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 1.8684 | Val  Acc: 0.5333
 Site-QuickDraw                     | Val  Loss: 1.8506 | Val  Acc: 0.5937
 Site-Infograph                     | Val  Loss: 1.8988 | Val  Acc: 0.4286
 Site-Infograph                     | Val  Loss: 1.8172 | Val  Acc: 0.4730
Average Valid Accuracy: 0.7288
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8190
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8000
 Best site-Real                      | Epoch:9 | Val Acc: 0.9238
 Best site-Real                      | Epoch:9 | Val Acc: 0.9302
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8444
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7810
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.7619
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.5333
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.5937
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4286
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 1.2418 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 1.2475 | Train Acc: 0.8199
 Site-Real                          | Train Loss: 1.0475 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.9612 | Train Acc: 0.9470
 Site-Painting                      | Train Loss: 1.1360 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 1.1704 | Train Acc: 0.8538
 Site-Sketch                        | Train Loss: 1.2178 | Train Acc: 0.7452
 Site-Sketch                        | Train Loss: 1.2050 | Train Acc: 0.7627
 Site-QuickDraw                     | Train Loss: 1.8041 | Train Acc: 0.5669
 Site-QuickDraw                     | Train Loss: 1.8054 | Train Acc: 0.5614
 Site-Infograph                     | Train Loss: 1.8222 | Train Acc: 0.5159
 Site-Infograph                     | Train Loss: 1.7441 | Train Acc: 0.5191
Average Train Accuracy: 0.7425
 Site-Clipart                       | Val  Loss: 1.2733 | Val  Acc: 0.7810
 Site-Clipart                       | Val  Loss: 1.2731 | Val  Acc: 0.7937
 Site-Real                          | Val  Loss: 0.9751 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.9856 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 1.0315 | Val  Acc: 0.8762
 Site-Painting                      | Val  Loss: 1.1502 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 1.2141 | Val  Acc: 0.7905
 Site-Sketch                        | Val  Loss: 1.2090 | Val  Acc: 0.7683
 Site-QuickDraw                     | Val  Loss: 1.7973 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.8017 | Val  Acc: 0.5937
 Site-Infograph                     | Val  Loss: 1.8271 | Val  Acc: 0.4762
 Site-Infograph                     | Val  Loss: 1.7896 | Val  Acc: 0.4635
Average Valid Accuracy: 0.7365
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7810
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7937
 Best site-Real                      | Epoch:10 | Val Acc: 0.9524
 Best site-Real                      | Epoch:10 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8762
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8381
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7905
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7683
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.5524
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.5937
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.4762
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.4635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 1.1611 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 1.1857 | Train Acc: 0.8284
 Site-Real                          | Train Loss: 0.9764 | Train Acc: 0.8981
 Site-Real                          | Train Loss: 0.8882 | Train Acc: 0.9513
 Site-Painting                      | Train Loss: 1.0761 | Train Acc: 0.8344
 Site-Painting                      | Train Loss: 1.0732 | Train Acc: 0.8581
 Site-Sketch                        | Train Loss: 1.2009 | Train Acc: 0.7197
 Site-Sketch                        | Train Loss: 1.1572 | Train Acc: 0.7818
 Site-QuickDraw                     | Train Loss: 1.7506 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.7764 | Train Acc: 0.5911
 Site-Infograph                     | Train Loss: 1.8108 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.7031 | Train Acc: 0.5233
Average Train Accuracy: 0.7441
 Site-Clipart                       | Val  Loss: 1.2235 | Val  Acc: 0.7810
 Site-Clipart                       | Val  Loss: 1.2217 | Val  Acc: 0.8000
 Site-Real                          | Val  Loss: 0.8975 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.9278 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.9383 | Val  Acc: 0.8952
 Site-Painting                      | Val  Loss: 1.0853 | Val  Acc: 0.8444
 Site-Sketch                        | Val  Loss: 1.1885 | Val  Acc: 0.7619
 Site-Sketch                        | Val  Loss: 1.1626 | Val  Acc: 0.7873
 Site-QuickDraw                     | Val  Loss: 1.7715 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.7761 | Val  Acc: 0.5937
 Site-Infograph                     | Val  Loss: 1.8134 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.7599 | Val  Acc: 0.4857
Average Valid Accuracy: 0.7386
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.7810
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8000
 Best site-Real                      | Epoch:11 | Val Acc: 0.9524
 Best site-Real                      | Epoch:11 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8952
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8444
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7619
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7873
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.5524
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.5937
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 1.1909 | Train Acc: 0.8153
 Site-Clipart                       | Train Loss: 1.1490 | Train Acc: 0.8263
 Site-Real                          | Train Loss: 0.9419 | Train Acc: 0.9045
 Site-Real                          | Train Loss: 0.8342 | Train Acc: 0.9597
 Site-Painting                      | Train Loss: 1.0617 | Train Acc: 0.8089
 Site-Painting                      | Train Loss: 1.0370 | Train Acc: 0.8432
 Site-Sketch                        | Train Loss: 1.1534 | Train Acc: 0.7962
 Site-Sketch                        | Train Loss: 1.0954 | Train Acc: 0.7775
 Site-QuickDraw                     | Train Loss: 1.7053 | Train Acc: 0.5924
 Site-QuickDraw                     | Train Loss: 1.7259 | Train Acc: 0.5996
 Site-Infograph                     | Train Loss: 1.7480 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.6903 | Train Acc: 0.5212
Average Train Accuracy: 0.7446
 Site-Clipart                       | Val  Loss: 1.1797 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.1806 | Val  Acc: 0.8032
 Site-Real                          | Val  Loss: 0.8647 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.8584 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.9137 | Val  Acc: 0.8667
 Site-Painting                      | Val  Loss: 1.0145 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 1.1330 | Val  Acc: 0.7714
 Site-Sketch                        | Val  Loss: 1.1131 | Val  Acc: 0.7873
 Site-QuickDraw                     | Val  Loss: 1.7229 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.7293 | Val  Acc: 0.6032
 Site-Infograph                     | Val  Loss: 1.8014 | Val  Acc: 0.4381
 Site-Infograph                     | Val  Loss: 1.7323 | Val  Acc: 0.4857
Average Valid Accuracy: 0.7431
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.8032
 Best site-Real                      | Epoch:12 | Val Acc: 0.9333
 Best site-Real                      | Epoch:12 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8667
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.7714
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.7873
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6032
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.4381
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.4857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 1.1107 | Train Acc: 0.8217
 Site-Clipart                       | Train Loss: 1.1182 | Train Acc: 0.8347
 Site-Real                          | Train Loss: 0.8841 | Train Acc: 0.8981
 Site-Real                          | Train Loss: 0.7599 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.9899 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.9941 | Train Acc: 0.8623
 Site-Sketch                        | Train Loss: 1.1559 | Train Acc: 0.7643
 Site-Sketch                        | Train Loss: 1.0769 | Train Acc: 0.7945
 Site-QuickDraw                     | Train Loss: 1.6960 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.6837 | Train Acc: 0.6208
 Site-Infograph                     | Train Loss: 1.7296 | Train Acc: 0.5032
 Site-Infograph                     | Train Loss: 1.6842 | Train Acc: 0.5042
Average Train Accuracy: 0.7522
 Site-Clipart                       | Val  Loss: 1.1065 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 1.1319 | Val  Acc: 0.8159
 Site-Real                          | Val  Loss: 0.8010 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.8050 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.9076 | Val  Acc: 0.8667
 Site-Painting                      | Val  Loss: 0.9901 | Val  Acc: 0.8540
 Site-Sketch                        | Val  Loss: 1.0712 | Val  Acc: 0.7524
 Site-Sketch                        | Val  Loss: 1.0607 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 1.7163 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.6751 | Val  Acc: 0.6032
 Site-Infograph                     | Val  Loss: 1.7609 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.7045 | Val  Acc: 0.4889
Average Valid Accuracy: 0.7439
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8476
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.8159
 Best site-Real                      | Epoch:13 | Val Acc: 0.9524
 Best site-Real                      | Epoch:13 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8667
 Best site-Painting                  | Epoch:13 | Val Acc: 0.8540
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7524
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.5524
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6032
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.4889
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 1.0756 | Train Acc: 0.8153
 Site-Clipart                       | Train Loss: 1.0677 | Train Acc: 0.8326
 Site-Real                          | Train Loss: 0.8354 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.7173 | Train Acc: 0.9597
 Site-Painting                      | Train Loss: 0.9070 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.9576 | Train Acc: 0.8411
 Site-Sketch                        | Train Loss: 1.0866 | Train Acc: 0.7389
 Site-Sketch                        | Train Loss: 0.9900 | Train Acc: 0.8093
 Site-QuickDraw                     | Train Loss: 1.6272 | Train Acc: 0.5987
 Site-QuickDraw                     | Train Loss: 1.6557 | Train Acc: 0.6229
 Site-Infograph                     | Train Loss: 1.6997 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.6395 | Train Acc: 0.5191
Average Train Accuracy: 0.7510
 Site-Clipart                       | Val  Loss: 1.0804 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.0649 | Val  Acc: 0.8095
 Site-Real                          | Val  Loss: 0.7242 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.7607 | Val  Acc: 0.9492
 Site-Painting                      | Val  Loss: 0.8513 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.9221 | Val  Acc: 0.8730
 Site-Sketch                        | Val  Loss: 0.9995 | Val  Acc: 0.8000
 Site-Sketch                        | Val  Loss: 1.0128 | Val  Acc: 0.8063
 Site-QuickDraw                     | Val  Loss: 1.7073 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.6498 | Val  Acc: 0.6254
 Site-Infograph                     | Val  Loss: 1.7688 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.6782 | Val  Acc: 0.5048
Average Valid Accuracy: 0.7553
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.8095
 Best site-Real                      | Epoch:14 | Val Acc: 0.9429
 Best site-Real                      | Epoch:14 | Val Acc: 0.9492
 Best site-Painting                  | Epoch:14 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:14 | Val Acc: 0.8730
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8000
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.8063
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.5905
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.6254
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.4571
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.5048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 1.0063 | Train Acc: 0.8153
 Site-Clipart                       | Train Loss: 1.0131 | Train Acc: 0.8263
 Site-Real                          | Train Loss: 0.7847 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.6938 | Train Acc: 0.9513
 Site-Painting                      | Train Loss: 0.8736 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.9019 | Train Acc: 0.8665
 Site-Sketch                        | Train Loss: 1.0218 | Train Acc: 0.7707
 Site-Sketch                        | Train Loss: 0.9875 | Train Acc: 0.8093
 Site-QuickDraw                     | Train Loss: 1.6312 | Train Acc: 0.6051
 Site-QuickDraw                     | Train Loss: 1.6134 | Train Acc: 0.6208
 Site-Infograph                     | Train Loss: 1.7048 | Train Acc: 0.5032
 Site-Infograph                     | Train Loss: 1.6345 | Train Acc: 0.5466
Average Train Accuracy: 0.7556
 Site-Clipart                       | Val  Loss: 1.0321 | Val  Acc: 0.8286
 Site-Clipart                       | Val  Loss: 1.0631 | Val  Acc: 0.8159
 Site-Real                          | Val  Loss: 0.7055 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.7024 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.7879 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.9237 | Val  Acc: 0.8444
 Site-Sketch                        | Val  Loss: 0.9170 | Val  Acc: 0.8095
 Site-Sketch                        | Val  Loss: 0.9633 | Val  Acc: 0.8063
 Site-QuickDraw                     | Val  Loss: 1.6592 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.6139 | Val  Acc: 0.6317
 Site-Infograph                     | Val  Loss: 1.7416 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.6623 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7579
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8286
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8159
 Best site-Real                      | Epoch:15 | Val Acc: 0.9524
 Best site-Real                      | Epoch:15 | Val Acc: 0.9556
 Best site-Painting                  | Epoch:15 | Val Acc: 0.9048
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8444
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8095
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.8063
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.5524
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.6317
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.4667
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.9393 | Train Acc: 0.8344
 Site-Clipart                       | Train Loss: 0.9854 | Train Acc: 0.8369
 Site-Real                          | Train Loss: 0.7600 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.6538 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.8903 | Train Acc: 0.8344
 Site-Painting                      | Train Loss: 0.8656 | Train Acc: 0.8517
 Site-Sketch                        | Train Loss: 0.9870 | Train Acc: 0.7643
 Site-Sketch                        | Train Loss: 0.9600 | Train Acc: 0.7987
 Site-QuickDraw                     | Train Loss: 1.5373 | Train Acc: 0.5987
 Site-QuickDraw                     | Train Loss: 1.6048 | Train Acc: 0.6165
 Site-Infograph                     | Train Loss: 1.7179 | Train Acc: 0.4841
 Site-Infograph                     | Train Loss: 1.5892 | Train Acc: 0.5381
Average Train Accuracy: 0.7533
 Site-Clipart                       | Val  Loss: 0.9524 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 1.0228 | Val  Acc: 0.8444
 Site-Real                          | Val  Loss: 0.6695 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.6743 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.7613 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.8494 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.9443 | Val  Acc: 0.7905
 Site-Sketch                        | Val  Loss: 0.9463 | Val  Acc: 0.8063
 Site-QuickDraw                     | Val  Loss: 1.6451 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.5807 | Val  Acc: 0.6317
 Site-Infograph                     | Val  Loss: 1.7072 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.6587 | Val  Acc: 0.5016
Average Valid Accuracy: 0.7669
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8667
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8444
 Best site-Real                      | Epoch:16 | Val Acc: 0.9429
 Best site-Real                      | Epoch:16 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.7905
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8063
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.5714
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.6317
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.9700 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.9447 | Train Acc: 0.8559
 Site-Real                          | Train Loss: 0.7204 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.6046 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.8465 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.8527 | Train Acc: 0.8602
 Site-Sketch                        | Train Loss: 0.9813 | Train Acc: 0.7771
 Site-Sketch                        | Train Loss: 0.8919 | Train Acc: 0.8157
 Site-QuickDraw                     | Train Loss: 1.5650 | Train Acc: 0.5924
 Site-QuickDraw                     | Train Loss: 1.5609 | Train Acc: 0.6271
 Site-Infograph                     | Train Loss: 1.6372 | Train Acc: 0.5096
 Site-Infograph                     | Train Loss: 1.5686 | Train Acc: 0.5424
Average Train Accuracy: 0.7651
 Site-Clipart                       | Val  Loss: 0.9554 | Val  Acc: 0.7810
 Site-Clipart                       | Val  Loss: 0.9642 | Val  Acc: 0.8476
 Site-Real                          | Val  Loss: 0.6432 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.6416 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.7547 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.8340 | Val  Acc: 0.8794
 Site-Sketch                        | Val  Loss: 0.9418 | Val  Acc: 0.8000
 Site-Sketch                        | Val  Loss: 0.9559 | Val  Acc: 0.7905
 Site-QuickDraw                     | Val  Loss: 1.6269 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.5646 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.7198 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.6144 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7593
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.9263 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.8938 | Train Acc: 0.8559
 Site-Real                          | Train Loss: 0.6979 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.5831 | Train Acc: 0.9597
 Site-Painting                      | Train Loss: 0.8026 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.8193 | Train Acc: 0.8644
 Site-Sketch                        | Train Loss: 0.9625 | Train Acc: 0.7516
 Site-Sketch                        | Train Loss: 0.8890 | Train Acc: 0.7945
 Site-QuickDraw                     | Train Loss: 1.5186 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.5497 | Train Acc: 0.6123
 Site-Infograph                     | Train Loss: 1.6523 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.5539 | Train Acc: 0.5572
Average Train Accuracy: 0.7665
 Site-Clipart                       | Val  Loss: 0.9244 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.9620 | Val  Acc: 0.8317
 Site-Real                          | Val  Loss: 0.6292 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.5823 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.6962 | Val  Acc: 0.8952
 Site-Painting                      | Val  Loss: 0.7871 | Val  Acc: 0.8794
 Site-Sketch                        | Val  Loss: 0.8578 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.9007 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.5568 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.5380 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.6745 | Val  Acc: 0.4476
 Site-Infograph                     | Val  Loss: 1.5924 | Val  Acc: 0.5206
Average Valid Accuracy: 0.7646
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.8739 | Train Acc: 0.8471
 Site-Clipart                       | Train Loss: 0.8785 | Train Acc: 0.8644
 Site-Real                          | Train Loss: 0.6495 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.5698 | Train Acc: 0.9555
 Site-Painting                      | Train Loss: 0.8576 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.7697 | Train Acc: 0.8686
 Site-Sketch                        | Train Loss: 0.9280 | Train Acc: 0.7707
 Site-Sketch                        | Train Loss: 0.8511 | Train Acc: 0.8178
 Site-QuickDraw                     | Train Loss: 1.4594 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.4982 | Train Acc: 0.6335
 Site-Infograph                     | Train Loss: 1.6348 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.5061 | Train Acc: 0.5720
Average Train Accuracy: 0.7769
 Site-Clipart                       | Val  Loss: 0.9076 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.9271 | Val  Acc: 0.8444
 Site-Real                          | Val  Loss: 0.5963 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.5814 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.6339 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.7876 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.8526 | Val  Acc: 0.8095
 Site-Sketch                        | Val  Loss: 0.8629 | Val  Acc: 0.7841
 Site-QuickDraw                     | Val  Loss: 1.5708 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.5371 | Val  Acc: 0.6222
 Site-Infograph                     | Val  Loss: 1.6985 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.5870 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7696
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8857
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8444
 Best site-Real                      | Epoch:19 | Val Acc: 0.9429
 Best site-Real                      | Epoch:19 | Val Acc: 0.9651
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8095
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.7841
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.5619
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.6222
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.7882 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.8995 | Train Acc: 0.8644
 Site-Real                          | Train Loss: 0.6386 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.5343 | Train Acc: 0.9703
 Site-Painting                      | Train Loss: 0.7445 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.7709 | Train Acc: 0.8623
 Site-Sketch                        | Train Loss: 0.8891 | Train Acc: 0.7771
 Site-Sketch                        | Train Loss: 0.8528 | Train Acc: 0.8051
 Site-QuickDraw                     | Train Loss: 1.4517 | Train Acc: 0.6369
 Site-QuickDraw                     | Train Loss: 1.5019 | Train Acc: 0.6292
 Site-Infograph                     | Train Loss: 1.6532 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.5339 | Train Acc: 0.5487
Average Train Accuracy: 0.7700
 Site-Clipart                       | Val  Loss: 0.8594 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 0.8737 | Val  Acc: 0.8540
 Site-Real                          | Val  Loss: 0.5528 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.5540 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.6636 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.7711 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.7820 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.8392 | Val  Acc: 0.8127
 Site-QuickDraw                     | Val  Loss: 1.5340 | Val  Acc: 0.5524
 Site-QuickDraw                     | Val  Loss: 1.4970 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.7059 | Val  Acc: 0.4571
 Site-Infograph                     | Val  Loss: 1.5791 | Val  Acc: 0.5079
Average Valid Accuracy: 0.7640
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.8404 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.8391 | Train Acc: 0.8453
 Site-Real                          | Train Loss: 0.6041 | Train Acc: 0.9108
 Site-Real                          | Train Loss: 0.5151 | Train Acc: 0.9576
 Site-Painting                      | Train Loss: 0.7767 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.7554 | Train Acc: 0.8538
 Site-Sketch                        | Train Loss: 0.8634 | Train Acc: 0.8025
 Site-Sketch                        | Train Loss: 0.7999 | Train Acc: 0.8178
 Site-QuickDraw                     | Train Loss: 1.4570 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.4576 | Train Acc: 0.6483
 Site-Infograph                     | Train Loss: 1.6369 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.5225 | Train Acc: 0.5614
Average Train Accuracy: 0.7762
 Site-Clipart                       | Val  Loss: 0.8088 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 0.8945 | Val  Acc: 0.8286
 Site-Real                          | Val  Loss: 0.5360 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.5516 | Val  Acc: 0.9365
 Site-Painting                      | Val  Loss: 0.6235 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.7293 | Val  Acc: 0.8635
 Site-Sketch                        | Val  Loss: 0.8139 | Val  Acc: 0.7810
 Site-Sketch                        | Val  Loss: 0.8168 | Val  Acc: 0.8063
 Site-QuickDraw                     | Val  Loss: 1.4857 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.4715 | Val  Acc: 0.6508
 Site-Infograph                     | Val  Loss: 1.6112 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.5541 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7653
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.8573 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 0.8068 | Train Acc: 0.8475
 Site-Real                          | Train Loss: 0.5788 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.4787 | Train Acc: 0.9661
 Site-Painting                      | Train Loss: 0.7205 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.7196 | Train Acc: 0.8750
 Site-Sketch                        | Train Loss: 0.8408 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.8007 | Train Acc: 0.8072
 Site-QuickDraw                     | Train Loss: 1.3964 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 1.4323 | Train Acc: 0.6631
 Site-Infograph                     | Train Loss: 1.5775 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.5012 | Train Acc: 0.5487
Average Train Accuracy: 0.7792
 Site-Clipart                       | Val  Loss: 0.7736 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.8403 | Val  Acc: 0.8317
 Site-Real                          | Val  Loss: 0.4796 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.5110 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.5698 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.7246 | Val  Acc: 0.8444
 Site-Sketch                        | Val  Loss: 0.7243 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.8208 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.4575 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 1.4576 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.6181 | Val  Acc: 0.4667
 Site-Infograph                     | Val  Loss: 1.5334 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7852
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8317
 Best site-Real                      | Epoch:22 | Val Acc: 0.9619
 Best site-Real                      | Epoch:22 | Val Acc: 0.9651
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:22 | Val Acc: 0.8444
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8476
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8254
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.6571
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.4667
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.5556
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.7595 | Train Acc: 0.8662
 Site-Clipart                       | Train Loss: 0.7842 | Train Acc: 0.8538
 Site-Real                          | Train Loss: 0.5713 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4629 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.7416 | Train Acc: 0.8471
 Site-Painting                      | Train Loss: 0.7037 | Train Acc: 0.8665
 Site-Sketch                        | Train Loss: 0.8591 | Train Acc: 0.7771
 Site-Sketch                        | Train Loss: 0.7364 | Train Acc: 0.8136
 Site-QuickDraw                     | Train Loss: 1.4549 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.4296 | Train Acc: 0.6525
 Site-Infograph                     | Train Loss: 1.5116 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.4944 | Train Acc: 0.5699
Average Train Accuracy: 0.7771
 Site-Clipart                       | Val  Loss: 0.7788 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.8147 | Val  Acc: 0.8540
 Site-Real                          | Val  Loss: 0.4684 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.4856 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.5171 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.6967 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.7655 | Val  Acc: 0.8190
 Site-Sketch                        | Val  Loss: 0.7981 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 1.4690 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.4153 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.5917 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.5425 | Val  Acc: 0.5333
Average Valid Accuracy: 0.7881
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.8540
 Best site-Real                      | Epoch:23 | Val Acc: 0.9524
 Best site-Real                      | Epoch:23 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:23 | Val Acc: 0.8698
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8190
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.8000
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.6635
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.7622 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.7845 | Train Acc: 0.8517
 Site-Real                          | Train Loss: 0.5500 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4511 | Train Acc: 0.9619
 Site-Painting                      | Train Loss: 0.6476 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.6876 | Train Acc: 0.8729
 Site-Sketch                        | Train Loss: 0.8166 | Train Acc: 0.7962
 Site-Sketch                        | Train Loss: 0.7689 | Train Acc: 0.8093
 Site-QuickDraw                     | Train Loss: 1.3903 | Train Acc: 0.6242
 Site-QuickDraw                     | Train Loss: 1.3884 | Train Acc: 0.6589
 Site-Infograph                     | Train Loss: 1.5382 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.4830 | Train Acc: 0.5466
Average Train Accuracy: 0.7787
 Site-Clipart                       | Val  Loss: 0.7928 | Val  Acc: 0.8476
 Site-Clipart                       | Val  Loss: 0.8047 | Val  Acc: 0.8508
 Site-Real                          | Val  Loss: 0.4735 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.4695 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.5513 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.6770 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.6814 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.7509 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.4615 | Val  Acc: 0.6095
 Site-QuickDraw                     | Val  Loss: 1.3770 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.5686 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.5332 | Val  Acc: 0.5619
Average Valid Accuracy: 0.7897
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8476
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.8508
 Best site-Real                      | Epoch:24 | Val Acc: 0.9524
 Best site-Real                      | Epoch:24 | Val Acc: 0.9683
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9429
 Best site-Painting                  | Epoch:24 | Val Acc: 0.8698
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.8254
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.6095
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.6476
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.5619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.7900 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.7515 | Train Acc: 0.8623
 Site-Real                          | Train Loss: 0.5078 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.4336 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.6618 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.6781 | Train Acc: 0.8708
 Site-Sketch                        | Train Loss: 0.8034 | Train Acc: 0.7898
 Site-Sketch                        | Train Loss: 0.7323 | Train Acc: 0.8051
 Site-QuickDraw                     | Train Loss: 1.3898 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.3922 | Train Acc: 0.6631
 Site-Infograph                     | Train Loss: 1.5066 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.4570 | Train Acc: 0.5742
Average Train Accuracy: 0.7815
 Site-Clipart                       | Val  Loss: 0.7684 | Val  Acc: 0.8381
 Site-Clipart                       | Val  Loss: 0.7982 | Val  Acc: 0.8698
 Site-Real                          | Val  Loss: 0.4800 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.4559 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.5596 | Val  Acc: 0.8952
 Site-Painting                      | Val  Loss: 0.6597 | Val  Acc: 0.8698
 Site-Sketch                        | Val  Loss: 0.7243 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.7487 | Val  Acc: 0.8159
 Site-QuickDraw                     | Val  Loss: 1.4549 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.3625 | Val  Acc: 0.6603
 Site-Infograph                     | Val  Loss: 1.5749 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.4715 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7804
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.7656 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.7826 | Train Acc: 0.8665
 Site-Real                          | Train Loss: 0.5350 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4253 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.6852 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.6656 | Train Acc: 0.8602
 Site-Sketch                        | Train Loss: 0.8670 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.7110 | Train Acc: 0.8242
 Site-QuickDraw                     | Train Loss: 1.3192 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.3451 | Train Acc: 0.6780
 Site-Infograph                     | Train Loss: 1.5243 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.4574 | Train Acc: 0.5657
Average Train Accuracy: 0.7844
 Site-Clipart                       | Val  Loss: 0.7396 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.7417 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.4439 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.4543 | Val  Acc: 0.9587
 Site-Painting                      | Val  Loss: 0.5493 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.6669 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.6879 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.7391 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.4165 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.3512 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.5877 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4757 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7857
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.7234 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.7403 | Train Acc: 0.8708
 Site-Real                          | Train Loss: 0.5209 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.4006 | Train Acc: 0.9661
 Site-Painting                      | Train Loss: 0.6482 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.6407 | Train Acc: 0.8792
 Site-Sketch                        | Train Loss: 0.8310 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.6986 | Train Acc: 0.8199
 Site-QuickDraw                     | Train Loss: 1.3390 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.3393 | Train Acc: 0.6589
 Site-Infograph                     | Train Loss: 1.4307 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 1.3949 | Train Acc: 0.5911
Average Train Accuracy: 0.7863
 Site-Clipart                       | Val  Loss: 0.6892 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.7426 | Val  Acc: 0.8508
 Site-Real                          | Val  Loss: 0.4254 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.4164 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.5443 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.6316 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.6880 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.7089 | Val  Acc: 0.8317
 Site-QuickDraw                     | Val  Loss: 1.3795 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.3384 | Val  Acc: 0.6698
 Site-Infograph                     | Val  Loss: 1.5343 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.4652 | Val  Acc: 0.5810
Average Valid Accuracy: 0.7976
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8508
 Best site-Real                      | Epoch:27 | Val Acc: 0.9333
 Best site-Real                      | Epoch:27 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8317
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.6190
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.6698
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5619
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.6995 | Train Acc: 0.8535
 Site-Clipart                       | Train Loss: 0.6808 | Train Acc: 0.8708
 Site-Real                          | Train Loss: 0.4774 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.4034 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.6194 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.6151 | Train Acc: 0.8792
 Site-Sketch                        | Train Loss: 0.7898 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.6860 | Train Acc: 0.8178
 Site-QuickDraw                     | Train Loss: 1.2341 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.3235 | Train Acc: 0.6568
 Site-Infograph                     | Train Loss: 1.5092 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.3876 | Train Acc: 0.5996
Average Train Accuracy: 0.7916
 Site-Clipart                       | Val  Loss: 0.7174 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.7200 | Val  Acc: 0.8635
 Site-Real                          | Val  Loss: 0.4039 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.4026 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.4942 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.6122 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.6866 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.7061 | Val  Acc: 0.8286
 Site-QuickDraw                     | Val  Loss: 1.3961 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.3205 | Val  Acc: 0.6603
 Site-Infograph                     | Val  Loss: 1.5877 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4605 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7884
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.7391 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.7049 | Train Acc: 0.8771
 Site-Real                          | Train Loss: 0.4609 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.3958 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.5984 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.6162 | Train Acc: 0.8919
 Site-Sketch                        | Train Loss: 0.7801 | Train Acc: 0.7898
 Site-Sketch                        | Train Loss: 0.6782 | Train Acc: 0.8347
 Site-QuickDraw                     | Train Loss: 1.3046 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.3050 | Train Acc: 0.6864
 Site-Infograph                     | Train Loss: 1.5274 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.4141 | Train Acc: 0.5869
Average Train Accuracy: 0.7890
 Site-Clipart                       | Val  Loss: 0.6563 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.7251 | Val  Acc: 0.8603
 Site-Real                          | Val  Loss: 0.4034 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.4029 | Val  Acc: 0.9587
 Site-Painting                      | Val  Loss: 0.4922 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.5996 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.6111 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.6837 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.4030 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.3476 | Val  Acc: 0.6317
 Site-Infograph                     | Val  Loss: 1.5284 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.5007 | Val  Acc: 0.5619
Average Valid Accuracy: 0.7921
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.7192 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 0.6898 | Train Acc: 0.8708
 Site-Real                          | Train Loss: 0.4701 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.3733 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.5570 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.5772 | Train Acc: 0.8792
 Site-Sketch                        | Train Loss: 0.7563 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.6936 | Train Acc: 0.8220
 Site-QuickDraw                     | Train Loss: 1.2443 | Train Acc: 0.6497
 Site-QuickDraw                     | Train Loss: 1.2740 | Train Acc: 0.6631
 Site-Infograph                     | Train Loss: 1.5007 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.4065 | Train Acc: 0.5678
Average Train Accuracy: 0.7837
 Site-Clipart                       | Val  Loss: 0.6943 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 0.7190 | Val  Acc: 0.8508
 Site-Real                          | Val  Loss: 0.3815 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.3997 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.4673 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.6152 | Val  Acc: 0.8889
 Site-Sketch                        | Val  Loss: 0.6269 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.6750 | Val  Acc: 0.8190
 Site-QuickDraw                     | Val  Loss: 1.3199 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 1.2992 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.5649 | Val  Acc: 0.5048
 Site-Infograph                     | Val  Loss: 1.4525 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7939
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.6805 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.6723 | Train Acc: 0.8644
 Site-Real                          | Train Loss: 0.4629 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.3451 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.5693 | Train Acc: 0.8471
 Site-Painting                      | Train Loss: 0.5935 | Train Acc: 0.8814
 Site-Sketch                        | Train Loss: 0.8150 | Train Acc: 0.7898
 Site-Sketch                        | Train Loss: 0.6845 | Train Acc: 0.8263
 Site-QuickDraw                     | Train Loss: 1.2569 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.2871 | Train Acc: 0.6547
 Site-Infograph                     | Train Loss: 1.4475 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.4318 | Train Acc: 0.5784
Average Train Accuracy: 0.7895
 Site-Clipart                       | Val  Loss: 0.6862 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.7112 | Val  Acc: 0.8635
 Site-Real                          | Val  Loss: 0.3738 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.3654 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.4693 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.5853 | Val  Acc: 0.8889
 Site-Sketch                        | Val  Loss: 0.6455 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.6869 | Val  Acc: 0.8286
 Site-QuickDraw                     | Val  Loss: 1.3318 | Val  Acc: 0.6000
 Site-QuickDraw                     | Val  Loss: 1.2925 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 1.5489 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4347 | Val  Acc: 0.5460
Average Valid Accuracy: 0.7913
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.6405 | Train Acc: 0.8471
 Site-Clipart                       | Train Loss: 0.6500 | Train Acc: 0.8771
 Site-Real                          | Train Loss: 0.4404 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.3513 | Train Acc: 0.9661
 Site-Painting                      | Train Loss: 0.5975 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.5878 | Train Acc: 0.8877
 Site-Sketch                        | Train Loss: 0.7308 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.6364 | Train Acc: 0.8326
 Site-QuickDraw                     | Train Loss: 1.2643 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.2587 | Train Acc: 0.6674
 Site-Infograph                     | Train Loss: 1.5061 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.4136 | Train Acc: 0.6102
Average Train Accuracy: 0.7957
 Site-Clipart                       | Val  Loss: 0.6190 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.6666 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.3691 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.3805 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.4805 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.5595 | Val  Acc: 0.8889
 Site-Sketch                        | Val  Loss: 0.6116 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.6158 | Val  Acc: 0.8508
 Site-QuickDraw                     | Val  Loss: 1.3064 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 1.2543 | Val  Acc: 0.6603
 Site-Infograph                     | Val  Loss: 1.5304 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.4432 | Val  Acc: 0.5587
Average Valid Accuracy: 0.8008
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8857
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.8762
 Best site-Real                      | Epoch:32 | Val Acc: 0.9619
 Best site-Real                      | Epoch:32 | Val Acc: 0.9651
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:32 | Val Acc: 0.8889
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8508
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.6286
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.6603
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.5587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.6340 | Train Acc: 0.8471
 Site-Clipart                       | Train Loss: 0.6271 | Train Acc: 0.8792
 Site-Real                          | Train Loss: 0.4280 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.3359 | Train Acc: 0.9640
 Site-Painting                      | Train Loss: 0.6531 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.5751 | Train Acc: 0.8877
 Site-Sketch                        | Train Loss: 0.7111 | Train Acc: 0.8153
 Site-Sketch                        | Train Loss: 0.6282 | Train Acc: 0.8242
 Site-QuickDraw                     | Train Loss: 1.2221 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.2584 | Train Acc: 0.6653
 Site-Infograph                     | Train Loss: 1.4627 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.3967 | Train Acc: 0.5890
Average Train Accuracy: 0.7893
 Site-Clipart                       | Val  Loss: 0.6556 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6530 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.3482 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.3442 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.4348 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.5557 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.6527 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 0.6616 | Val  Acc: 0.8254
 Site-QuickDraw                     | Val  Loss: 1.3218 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.2562 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.5100 | Val  Acc: 0.5048
 Site-Infograph                     | Val  Loss: 1.4371 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7910
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.6252 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.6399 | Train Acc: 0.8708
 Site-Real                          | Train Loss: 0.3876 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.3233 | Train Acc: 0.9703
 Site-Painting                      | Train Loss: 0.5600 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.5631 | Train Acc: 0.8644
 Site-Sketch                        | Train Loss: 0.6907 | Train Acc: 0.7771
 Site-Sketch                        | Train Loss: 0.6441 | Train Acc: 0.8305
 Site-QuickDraw                     | Train Loss: 1.1839 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.2612 | Train Acc: 0.6695
 Site-Infograph                     | Train Loss: 1.4691 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.3845 | Train Acc: 0.5953
Average Train Accuracy: 0.7923
 Site-Clipart                       | Val  Loss: 0.6085 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.6551 | Val  Acc: 0.8603
 Site-Real                          | Val  Loss: 0.3688 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.3475 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.4388 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.5414 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.6221 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.6383 | Val  Acc: 0.8413
 Site-QuickDraw                     | Val  Loss: 1.2534 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 1.2253 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 1.5361 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4055 | Val  Acc: 0.5714
Average Valid Accuracy: 0.7960
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.6605 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.6294 | Train Acc: 0.8729
 Site-Real                          | Train Loss: 0.4521 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.3185 | Train Acc: 0.9619
 Site-Painting                      | Train Loss: 0.4889 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.5642 | Train Acc: 0.8792
 Site-Sketch                        | Train Loss: 0.6969 | Train Acc: 0.7834
 Site-Sketch                        | Train Loss: 0.6134 | Train Acc: 0.8263
 Site-QuickDraw                     | Train Loss: 1.2139 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.2098 | Train Acc: 0.6928
 Site-Infograph                     | Train Loss: 1.4371 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 1.3552 | Train Acc: 0.5953
Average Train Accuracy: 0.7973
 Site-Clipart                       | Val  Loss: 0.6259 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.6564 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.3461 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.3566 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.4443 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.5400 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.6231 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.6359 | Val  Acc: 0.8381
 Site-QuickDraw                     | Val  Loss: 1.2987 | Val  Acc: 0.5619
 Site-QuickDraw                     | Val  Loss: 1.2034 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.4924 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.4263 | Val  Acc: 0.5492
Average Valid Accuracy: 0.7894
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.7386 | Train Acc: 0.8408
 Site-Clipart                       | Train Loss: 0.6406 | Train Acc: 0.8686
 Site-Real                          | Train Loss: 0.3906 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.3066 | Train Acc: 0.9661
 Site-Painting                      | Train Loss: 0.5387 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.5253 | Train Acc: 0.8856
 Site-Sketch                        | Train Loss: 0.6449 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.6336 | Train Acc: 0.8305
 Site-QuickDraw                     | Train Loss: 1.1195 | Train Acc: 0.6369
 Site-QuickDraw                     | Train Loss: 1.1943 | Train Acc: 0.6864
 Site-Infograph                     | Train Loss: 1.4704 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.3930 | Train Acc: 0.5805
Average Train Accuracy: 0.7921
 Site-Clipart                       | Val  Loss: 0.5860 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.6381 | Val  Acc: 0.8730
 Site-Real                          | Val  Loss: 0.3499 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.3272 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.4446 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.5178 | Val  Acc: 0.8984
 Site-Sketch                        | Val  Loss: 0.5373 | Val  Acc: 0.8571
 Site-Sketch                        | Val  Loss: 0.6270 | Val  Acc: 0.8381
 Site-QuickDraw                     | Val  Loss: 1.2504 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 1.1881 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 1.4751 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.4206 | Val  Acc: 0.5746
Average Valid Accuracy: 0.8066
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8952
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.8730
 Best site-Real                      | Epoch:36 | Val Acc: 0.9524
 Best site-Real                      | Epoch:36 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9333
 Best site-Painting                  | Epoch:36 | Val Acc: 0.8984
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8571
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8381
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.6381
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.6952
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.5619
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.5746
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.5916 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5731 | Train Acc: 0.8898
 Site-Real                          | Train Loss: 0.3700 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.3023 | Train Acc: 0.9576
 Site-Painting                      | Train Loss: 0.6054 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.5407 | Train Acc: 0.8729
 Site-Sketch                        | Train Loss: 0.6461 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5940 | Train Acc: 0.8453
 Site-QuickDraw                     | Train Loss: 1.1976 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.2207 | Train Acc: 0.6822
 Site-Infograph                     | Train Loss: 1.4009 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.3338 | Train Acc: 0.5826
Average Train Accuracy: 0.7932
 Site-Clipart                       | Val  Loss: 0.6140 | Val  Acc: 0.8667
 Site-Clipart                       | Val  Loss: 0.6193 | Val  Acc: 0.8730
 Site-Real                          | Val  Loss: 0.3076 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.3274 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.4401 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 0.5191 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.5814 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.6132 | Val  Acc: 0.8540
 Site-QuickDraw                     | Val  Loss: 1.2580 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.1870 | Val  Acc: 0.6794
 Site-Infograph                     | Val  Loss: 1.5069 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.4098 | Val  Acc: 0.5651
Average Valid Accuracy: 0.8024
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.6014 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.6013 | Train Acc: 0.8623
 Site-Real                          | Train Loss: 0.3829 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.2815 | Train Acc: 0.9703
 Site-Painting                      | Train Loss: 0.5311 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.4960 | Train Acc: 0.8898
 Site-Sketch                        | Train Loss: 0.6424 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.6001 | Train Acc: 0.8432
 Site-QuickDraw                     | Train Loss: 1.1625 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 1.1697 | Train Acc: 0.7034
 Site-Infograph                     | Train Loss: 1.4341 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 1.3335 | Train Acc: 0.5890
Average Train Accuracy: 0.8040
 Site-Clipart                       | Val  Loss: 0.5522 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6352 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.2834 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.3223 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3987 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.4936 | Val  Acc: 0.9016
 Site-Sketch                        | Val  Loss: 0.5568 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.6095 | Val  Acc: 0.8508
 Site-QuickDraw                     | Val  Loss: 1.2803 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 1.1827 | Val  Acc: 0.6730
 Site-Infograph                     | Val  Loss: 1.4821 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.4147 | Val  Acc: 0.5524
Average Valid Accuracy: 0.8061
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.5652 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5934 | Train Acc: 0.8835
 Site-Real                          | Train Loss: 0.3798 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.2982 | Train Acc: 0.9703
 Site-Painting                      | Train Loss: 0.5403 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.5050 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.7021 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.6056 | Train Acc: 0.8369
 Site-QuickDraw                     | Train Loss: 1.1522 | Train Acc: 0.6497
 Site-QuickDraw                     | Train Loss: 1.1728 | Train Acc: 0.7034
 Site-Infograph                     | Train Loss: 1.4327 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.3496 | Train Acc: 0.5826
Average Train Accuracy: 0.7987
 Site-Clipart                       | Val  Loss: 0.5382 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.6066 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.3065 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.3274 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3833 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.5306 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5348 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.5633 | Val  Acc: 0.8540
 Site-QuickDraw                     | Val  Loss: 1.2091 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 1.1781 | Val  Acc: 0.6921
 Site-Infograph                     | Val  Loss: 1.4716 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.4156 | Val  Acc: 0.5429
Average Valid Accuracy: 0.8061
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.6197 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5701 | Train Acc: 0.8856
 Site-Real                          | Train Loss: 0.3372 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2882 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.5555 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.5395 | Train Acc: 0.8898
 Site-Sketch                        | Train Loss: 0.6922 | Train Acc: 0.8025
 Site-Sketch                        | Train Loss: 0.5750 | Train Acc: 0.8347
 Site-QuickDraw                     | Train Loss: 1.1285 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 1.1432 | Train Acc: 0.6674
 Site-Infograph                     | Train Loss: 1.4293 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.3328 | Train Acc: 0.5911
Average Train Accuracy: 0.7962
 Site-Clipart                       | Val  Loss: 0.5421 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.5811 | Val  Acc: 0.8730
 Site-Real                          | Val  Loss: 0.2891 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2949 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.4059 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4872 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.5478 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5935 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.2105 | Val  Acc: 0.6000
 Site-QuickDraw                     | Val  Loss: 1.1561 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 1.4106 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3777 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8011
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.6295 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.5799 | Train Acc: 0.8814
 Site-Real                          | Train Loss: 0.3417 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.2818 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.4950 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.4981 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.6360 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5899 | Train Acc: 0.8475
 Site-QuickDraw                     | Train Loss: 1.1201 | Train Acc: 0.6433
 Site-QuickDraw                     | Train Loss: 1.1628 | Train Acc: 0.6758
 Site-Infograph                     | Train Loss: 1.4693 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.3350 | Train Acc: 0.5869
Average Train Accuracy: 0.7960
 Site-Clipart                       | Val  Loss: 0.5525 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.5788 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.2843 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.2987 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.3815 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.4979 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.5391 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.6060 | Val  Acc: 0.8635
 Site-QuickDraw                     | Val  Loss: 1.2195 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 1.1440 | Val  Acc: 0.7206
 Site-Infograph                     | Val  Loss: 1.4770 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.4048 | Val  Acc: 0.5587
Average Valid Accuracy: 0.8130
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.9143
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.8667
 Best site-Real                      | Epoch:41 | Val Acc: 0.9619
 Best site-Real                      | Epoch:41 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:41 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:41 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:41 | Val Acc: 0.8635
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.6571
 Best site-QuickDraw                 | Epoch:41 | Val Acc: 0.7206
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:41 | Val Acc: 0.5587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.5387 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.5594 | Train Acc: 0.8771
 Site-Real                          | Train Loss: 0.3623 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2642 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.5143 | Train Acc: 0.8790
 Site-Painting                      | Train Loss: 0.4910 | Train Acc: 0.8983
 Site-Sketch                        | Train Loss: 0.6081 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.5762 | Train Acc: 0.8686
 Site-QuickDraw                     | Train Loss: 1.1341 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 1.1583 | Train Acc: 0.6822
 Site-Infograph                     | Train Loss: 1.4094 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.3065 | Train Acc: 0.6165
Average Train Accuracy: 0.8116
 Site-Clipart                       | Val  Loss: 0.5353 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.5740 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.2716 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.3036 | Val  Acc: 0.9556
 Site-Painting                      | Val  Loss: 0.3823 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.5085 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.5734 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.5944 | Val  Acc: 0.8413
 Site-QuickDraw                     | Val  Loss: 1.2509 | Val  Acc: 0.5810
 Site-QuickDraw                     | Val  Loss: 1.1224 | Val  Acc: 0.7143
 Site-Infograph                     | Val  Loss: 1.4413 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3647 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8069
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.5663 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.5464 | Train Acc: 0.8877
 Site-Real                          | Train Loss: 0.3232 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2556 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4981 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.4810 | Train Acc: 0.8814
 Site-Sketch                        | Train Loss: 0.6434 | Train Acc: 0.8280
 Site-Sketch                        | Train Loss: 0.5564 | Train Acc: 0.8347
 Site-QuickDraw                     | Train Loss: 1.0821 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 1.1630 | Train Acc: 0.6886
 Site-Infograph                     | Train Loss: 1.3759 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.3113 | Train Acc: 0.5953
Average Train Accuracy: 0.8017
 Site-Clipart                       | Val  Loss: 0.5395 | Val  Acc: 0.9143
 Site-Clipart                       | Val  Loss: 0.6180 | Val  Acc: 0.8698
 Site-Real                          | Val  Loss: 0.2660 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2890 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.3856 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4973 | Val  Acc: 0.8984
 Site-Sketch                        | Val  Loss: 0.4937 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5766 | Val  Acc: 0.8381
 Site-QuickDraw                     | Val  Loss: 1.1916 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.1442 | Val  Acc: 0.6984
 Site-Infograph                     | Val  Loss: 1.4474 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.3564 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8108
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.5805 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.5396 | Train Acc: 0.8941
 Site-Real                          | Train Loss: 0.3565 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2557 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.4762 | Train Acc: 0.8408
 Site-Painting                      | Train Loss: 0.4563 | Train Acc: 0.9025
 Site-Sketch                        | Train Loss: 0.5596 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5630 | Train Acc: 0.8390
 Site-QuickDraw                     | Train Loss: 1.1153 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.1457 | Train Acc: 0.6992
 Site-Infograph                     | Train Loss: 1.4039 | Train Acc: 0.6242
 Site-Infograph                     | Train Loss: 1.2964 | Train Acc: 0.6144
Average Train Accuracy: 0.8080
 Site-Clipart                       | Val  Loss: 0.5246 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.5764 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.2876 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2763 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.3641 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.4604 | Val  Acc: 0.8889
 Site-Sketch                        | Val  Loss: 0.5199 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 0.5523 | Val  Acc: 0.8762
 Site-QuickDraw                     | Val  Loss: 1.2062 | Val  Acc: 0.5714
 Site-QuickDraw                     | Val  Loss: 1.1066 | Val  Acc: 0.7079
 Site-Infograph                     | Val  Loss: 1.3992 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.3453 | Val  Acc: 0.5810
Average Valid Accuracy: 0.8074
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.6093 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.5201 | Train Acc: 0.8941
 Site-Real                          | Train Loss: 0.3282 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2575 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.4892 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.4556 | Train Acc: 0.9068
 Site-Sketch                        | Train Loss: 0.6969 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.5655 | Train Acc: 0.8453
 Site-QuickDraw                     | Train Loss: 1.0993 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.1032 | Train Acc: 0.6949
 Site-Infograph                     | Train Loss: 1.3534 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.2721 | Train Acc: 0.5932
Average Train Accuracy: 0.8050
 Site-Clipart                       | Val  Loss: 0.5450 | Val  Acc: 0.8857
 Site-Clipart                       | Val  Loss: 0.5572 | Val  Acc: 0.8825
 Site-Real                          | Val  Loss: 0.2730 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.2772 | Val  Acc: 0.9683
 Site-Painting                      | Val  Loss: 0.4047 | Val  Acc: 0.9048
 Site-Painting                      | Val  Loss: 0.4976 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.5318 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5886 | Val  Acc: 0.8349
 Site-QuickDraw                     | Val  Loss: 1.1277 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 1.0920 | Val  Acc: 0.7016
 Site-Infograph                     | Val  Loss: 1.4560 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3182 | Val  Acc: 0.6127
Average Valid Accuracy: 0.8111
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.5145 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.5275 | Train Acc: 0.8877
 Site-Real                          | Train Loss: 0.3210 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.2486 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.4824 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.4594 | Train Acc: 0.9025
 Site-Sketch                        | Train Loss: 0.6231 | Train Acc: 0.7962
 Site-Sketch                        | Train Loss: 0.5139 | Train Acc: 0.8496
 Site-QuickDraw                     | Train Loss: 1.1314 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 1.1240 | Train Acc: 0.7013
 Site-Infograph                     | Train Loss: 1.3902 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 1.2952 | Train Acc: 0.6186
Average Train Accuracy: 0.8079
 Site-Clipart                       | Val  Loss: 0.5357 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.5702 | Val  Acc: 0.8730
 Site-Real                          | Val  Loss: 0.2625 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2634 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.3438 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4625 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.4737 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.5697 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.1955 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 1.1311 | Val  Acc: 0.6825
 Site-Infograph                     | Val  Loss: 1.4244 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.3341 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8177
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.8730
 Best site-Real                      | Epoch:46 | Val Acc: 0.9714
 Best site-Real                      | Epoch:46 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:46 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:46 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.8952
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.8444
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.6762
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.6825
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.5873
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.5405 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.5260 | Train Acc: 0.8792
 Site-Real                          | Train Loss: 0.3438 | Train Acc: 0.9236
 Site-Real                          | Train Loss: 0.2410 | Train Acc: 0.9725
 Site-Painting                      | Train Loss: 0.5170 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.4449 | Train Acc: 0.9047
 Site-Sketch                        | Train Loss: 0.6681 | Train Acc: 0.8280
 Site-Sketch                        | Train Loss: 0.5516 | Train Acc: 0.8475
 Site-QuickDraw                     | Train Loss: 1.0665 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 1.0906 | Train Acc: 0.6992
 Site-Infograph                     | Train Loss: 1.4107 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 1.3180 | Train Acc: 0.6038
Average Train Accuracy: 0.8054
 Site-Clipart                       | Val  Loss: 0.4936 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5688 | Val  Acc: 0.8698
 Site-Real                          | Val  Loss: 0.2583 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2657 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.3569 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.4640 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.5105 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.5444 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.1619 | Val  Acc: 0.6190
 Site-QuickDraw                     | Val  Loss: 1.0927 | Val  Acc: 0.7016
 Site-Infograph                     | Val  Loss: 1.4251 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.3423 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8095
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.5416 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.5484 | Train Acc: 0.8771
 Site-Real                          | Train Loss: 0.3443 | Train Acc: 0.9172
 Site-Real                          | Train Loss: 0.2396 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.4491 | Train Acc: 0.8726
 Site-Painting                      | Train Loss: 0.4442 | Train Acc: 0.8983
 Site-Sketch                        | Train Loss: 0.5904 | Train Acc: 0.8153
 Site-Sketch                        | Train Loss: 0.5529 | Train Acc: 0.8538
 Site-QuickDraw                     | Train Loss: 1.0685 | Train Acc: 0.6242
 Site-QuickDraw                     | Train Loss: 1.0986 | Train Acc: 0.7097
 Site-Infograph                     | Train Loss: 1.4052 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 1.2870 | Train Acc: 0.6081
Average Train Accuracy: 0.8042
 Site-Clipart                       | Val  Loss: 0.4821 | Val  Acc: 0.9238
 Site-Clipart                       | Val  Loss: 0.5652 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.2483 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2687 | Val  Acc: 0.9651
 Site-Painting                      | Val  Loss: 0.3523 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.4682 | Val  Acc: 0.9016
 Site-Sketch                        | Val  Loss: 0.5091 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.5307 | Val  Acc: 0.8730
 Site-QuickDraw                     | Val  Loss: 1.1560 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 1.0860 | Val  Acc: 0.7111
 Site-Infograph                     | Val  Loss: 1.4464 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.3314 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8204
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9238
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.8794
 Best site-Real                      | Epoch:48 | Val Acc: 0.9714
 Best site-Real                      | Epoch:48 | Val Acc: 0.9651
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9016
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8286
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8730
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.6571
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.7111
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_0/afl...
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.6087 | Train Acc: 0.8599
 Site-Clipart                       | Train Loss: 0.5294 | Train Acc: 0.8835
 Site-Real                          | Train Loss: 0.3437 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.2385 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.5205 | Train Acc: 0.8599
 Site-Painting                      | Train Loss: 0.4603 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.5847 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.5240 | Train Acc: 0.8665
 Site-QuickDraw                     | Train Loss: 1.0916 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 1.0755 | Train Acc: 0.7161
 Site-Infograph                     | Train Loss: 1.3811 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 1.2661 | Train Acc: 0.6038
Average Train Accuracy: 0.8077
 Site-Clipart                       | Val  Loss: 0.5205 | Val  Acc: 0.8952
 Site-Clipart                       | Val  Loss: 0.5534 | Val  Acc: 0.8635
 Site-Real                          | Val  Loss: 0.2410 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.2584 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3652 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.4320 | Val  Acc: 0.9111
 Site-Sketch                        | Val  Loss: 0.5142 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5422 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.1546 | Val  Acc: 0.6762
 Site-QuickDraw                     | Val  Loss: 1.0766 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.4747 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3077 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8169
===2023-07-29 05:42:03===
===2023-07-29 05:42:18===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:48 | Test Acc: 0.8973
 Test site-Real                      | Epoch:48 | Test Acc: 0.9523
 Test site-Painting                  | Epoch:48 | Test Acc: 0.9128
 Test site-Sketch                    | Epoch:48 | Test Acc: 0.8917
 Test site-QuickDraw                 | Epoch:48 | Test Acc: 0.7020
 Test site-Infograph                 | Epoch:48 | Test Acc: 0.5571
Clipart: 0.8973, Real: 0.9523, Painting: 0.9128, Sketch: 0.8917, QuickDraw: 0.7020, Infograph: 0.5571, 
Average Test Accuracy(group): 0.8189, Average Test Accuracy(individual): 0.8189,
domain std=0.1416, cluster std=-1.0000, individual std=0.1416, 
