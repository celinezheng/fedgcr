===2023-03-27 14:47:47===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0069 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9822 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 2.1933 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.1689 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.9373 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.9727 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 2.2601 | Train Acc: 0.1429
 Site-QuickDraw | Train Loss: 2.1812 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.7842 | Train Acc: 0.5397
 Site-Real      | Train Loss: 1.8761 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8810 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9267 | Train Acc: 0.3968
 Site-Clipart   | Val  Loss: 1.9639 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9964 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1239 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1613 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.8367 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 2.0349 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.1891 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2312 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.8421 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 1.8130 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9256 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 1.9901 | Val  Acc: 0.4286
Average Valid Accuracy: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Painting   | Epoch:0 | Val Acc: 0.4524
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.5892 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.6380 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 2.0401 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.9572 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.4382 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 1.4227 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1199 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 2.0094 | Train Acc: 0.4603
 Site-Real      | Train Loss: 1.2246 | Train Acc: 0.8413
 Site-Real      | Train Loss: 1.2834 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.3992 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.5155 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.6851 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.6322 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8533 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 2.0857 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.2692 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 1.5725 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.9720 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.0051 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 1.2631 | Val  Acc: 0.8333
 Site-Real      | Val  Loss: 1.3223 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.5306 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.5026 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.7381
 Best site-Painting   | Epoch:1 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-Real       | Epoch:1 | Val Acc: 0.8333
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2466 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.2273 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.8783 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.7403 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.0955 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 1.0078 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9395 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 1.8765 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.7879 | Train Acc: 0.8730
 Site-Real      | Train Loss: 0.8610 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 1.1345 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.1820 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2937 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3008 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6861 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8936 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9289 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.1623 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7643 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.9470 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.8310 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.8617 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1947 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.1982 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6825
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Painting   | Epoch:2 | Val Acc: 0.8571
 Best site-Painting   | Epoch:2 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3571
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.9766 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0234 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7949 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5659 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7641 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.8364 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.7662 | Train Acc: 0.4603
 Site-QuickDraw | Train Loss: 1.5918 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.5519 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.6159 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8373 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 0.9840 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0045 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0823 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4903 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7591 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6499 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 1.0132 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.4809 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.7343 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.5747 | Val  Acc: 0.9048
 Site-Real      | Val  Loss: 0.6097 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9041 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9623 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7282
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Painting   | Epoch:3 | Val Acc: 0.9048
 Best site-Painting   | Epoch:3 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7805 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8560 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6673 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.4477 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.6346 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5717 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.5527 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.4264 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.3437 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.3810 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6431 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.7062 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.8472 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8236 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3380 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7396 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 0.5185 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5978 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.2719 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.6280 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3735 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.3574 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6878 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7680 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7579
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3571
 Best site-Painting   | Epoch:4 | Val Acc: 0.9286
 Best site-Painting   | Epoch:4 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6523 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6518 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4763 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.2895 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.4780 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.5149 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.3425 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.3013 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2802 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2446 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5235 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5141 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7000 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6359 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0780 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5177 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.3117 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5610 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.1307 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.5262 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.2365 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2688 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5776 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.5946 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7976
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4524
 Best site-Painting   | Epoch:5 | Val Acc: 0.9524
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5413 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5433 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.3607 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0980 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.3243 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3458 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.2700 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.0407 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2036 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1784 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4972 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5133 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.6981 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.5140 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0587 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4200 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.2655 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4606 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 0.8369 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.2387 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.1657 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2269 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4314 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5653 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8234
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9762
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6190
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4042 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4992 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2991 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 0.9478 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.2590 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2863 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0083 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 0.9974 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1625 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.1529 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3071 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4155 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4549 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4079 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9962 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2922 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.1366 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2804 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.7396 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.1957 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1260 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2085 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3766 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.2915 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Painting   | Epoch:7 | Val Acc: 1.0000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5476
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3652 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3583 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0838 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8805 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2158 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2194 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.0226 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 0.8824 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1403 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0966 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3166 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3876 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4060 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2911 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8972 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2490 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.1231 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2873 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 0.6726 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.0188 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.0867 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1555 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3197 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3687 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8750
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6667
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2342 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3036 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0920 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8388 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.1812 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1537 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9405 | Train Acc: 0.7143
 Site-QuickDraw | Train Loss: 0.8776 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1028 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0851 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2962 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3305 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5183 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.2805 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7407 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1167 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.0896 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1846 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 0.7127 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 0.9981 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.0869 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1770 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3794 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.2908 | Val  Acc: 0.9524
Average Valid Accuracy: 0.8651
===2023-03-27 15:20:57===
===2023-03-27 15:20:58===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:8 | Test Acc: 0.8365
 Test site-Infograph | Epoch:8 | Test Acc: 0.4368
 Test site-Painting  | Epoch:8 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:8 | Test Acc: 0.5540
 Test site-Real      | Epoch:8 | Test Acc: 0.9359
 Test site-Sketch    | Epoch:8 | Test Acc: 0.8105
Average Test Accuracy: 0.7407
