===2023-03-25 15:10:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6551 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.6793 | Train Acc: 0.5946
 Site-MNIST     | Train Loss: 1.5803 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6276 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 2.2116 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2168 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1111 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.6914 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.0967 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.1983 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 1.5633 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.5775 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6786 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6046 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.0930 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 2.2770 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1619 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7255 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1133 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.2297 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4324
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
===2023-03-25 15:14:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
===2023-03-25 16:23:29===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6551 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.6793 | Train Acc: 0.5946
 Site-MNIST     | Train Loss: 1.5803 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6276 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 2.2116 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2168 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1111 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.6914 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.0967 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.1983 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 1.5633 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.5775 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6786 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6046 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.0930 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 2.2770 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1619 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7255 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1133 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.2297 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4324
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
===2023-03-25 16:33:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6551 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.6793 | Train Acc: 0.5946
 Site-MNIST     | Train Loss: 1.5803 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6276 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 2.2116 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2168 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1111 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.6914 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.0967 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.1983 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 1.5633 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.5775 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6786 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6046 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.0930 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 2.2770 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.1619 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7255 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1133 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.2297 | Val  Acc: 0.1757
Average Valid Accuracy: 0.4324
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2223 | Train Acc: 0.7117
 Site-MNIST     | Train Loss: 1.2763 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.1594 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 1.1992 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 2.1272 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1341 | Train Acc: 0.2523
 Site-SVHN      | Train Loss: 1.9812 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 1.3132 | Train Acc: 0.7117
 Site-SynthDigits| Train Loss: 1.9071 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.0548 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.1186 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.1627 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 1.2855 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.1767 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 1.9626 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 2.2227 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.0434 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.3502 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 1.9402 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 2.1088 | Val  Acc: 0.1892
Average Valid Accuracy: 0.5230
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8457 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 0.9227 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.7643 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.8231 | Train Acc: 0.8018
 Site-SVHN      | Train Loss: 2.0412 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.0296 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8408 | Train Acc: 0.4505
 Site-USPS      | Train Loss: 1.0012 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.7339 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.8962 | Train Acc: 0.2793
 Site-MNIST     | Val  Loss: 0.7332 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.7757 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.9319 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.8130 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 1.8314 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 2.1684 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 1.8567 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 1.0445 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.7270 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.9812 | Val  Acc: 0.2838
Average Valid Accuracy: 0.5703
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3108
 Best site-USPS       | Epoch:2 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6391 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.7364 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 0.5859 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.6052 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.9593 | Train Acc: 0.2613
 Site-SVHN      | Train Loss: 1.9502 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 1.7440 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 0.7536 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.5355 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.7771 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.5503 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5867 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7553 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.6381 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.7251 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 2.0985 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.7520 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.8061 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.6068 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.9106 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6135
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3243
 Best site-USPS       | Epoch:3 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4476 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5188 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.4060 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.4353 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.8573 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.8824 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 1.6678 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.6350 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.4345 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.6317 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.3792 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4088 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5127 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.6607 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.9961 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.7253 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.6938 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.5255 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.8019 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6581
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3784
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4086 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.5017 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.3735 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.3624 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.7230 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7329 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.5267 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 0.5296 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.2455 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.4085 | Train Acc: 0.5856
 Site-MNIST     | Val  Loss: 0.3330 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3722 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5047 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4482 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.5353 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.8607 | Val  Acc: 0.3243
 Site-SVHN      | Val  Loss: 1.5593 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 0.5938 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3924 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.6727 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3243
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4189
 Best site-USPS       | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2318 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.2589 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1925 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.2139 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.5525 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.6043 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 1.3507 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3929 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.0933 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.2143 | Train Acc: 0.6667
 Site-MNIST     | Val  Loss: 0.1811 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1908 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2430 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2488 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.3599 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.7209 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.4372 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.4689 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.2957 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.5764 | Val  Acc: 0.5135
Average Valid Accuracy: 0.7243
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4459
 Best site-USPS       | Epoch:6 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2082 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2513 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.1779 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1588 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 1.3147 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.3719 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.0552 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 0.3091 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.8342 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.9695 | Train Acc: 0.7207
 Site-MNIST     | Val  Loss: 0.1439 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1826 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2412 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2504 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.1006 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 1.5151 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.1681 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.3978 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1601 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 1.4444 | Val  Acc: 0.5811
Average Valid Accuracy: 0.7865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6892
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1421 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1448 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0976 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1057 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.0741 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.1993 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 0.8824 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 0.2383 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.7073 | Train Acc: 0.8018
 Site-MNIST-M   | Train Loss: 0.7621 | Train Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.0857 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1018 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1310 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1557 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.9464 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.3464 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 0.9505 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.3631 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0695 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 1.3886 | Val  Acc: 0.6081
Average Valid Accuracy: 0.8095
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7297
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1265 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1596 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.1049 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0796 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.8729 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 1.0250 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 0.7205 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 0.1951 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.5448 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.5828 | Train Acc: 0.8559
 Site-MNIST     | Val  Loss: 0.0674 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1134 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1494 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.1587 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 0.7666 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 1.1516 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 0.7739 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.3334 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0185 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 1.2231 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8297
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7568
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
===2023-03-25 17:16:53===
===2023-03-25 17:16:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8943
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3612
 Test site-USPS      | Epoch:9 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6015
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4043
Average Test Accuracy: 0.6254
===2023-03-28 23:40:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7756 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.7365 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.7432 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.6354 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 2.2230 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1817 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1845 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.7924 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 2.1485 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2149 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.6501 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7171 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.7599 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7078 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.2240 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1668 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2259 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.7855 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1186 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.2487 | Val  Acc: 0.1356
Average Valid Accuracy: 0.3949
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2970 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.1957 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.2477 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1447 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.1000 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0768 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0602 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.3272 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9259 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0981 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.1756 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.2753 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2754 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.1769 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1123 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0825 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.1149 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.3589 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.8809 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.1533 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4847
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8888 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 0.7770 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.7813 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7268 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0394 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8981 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.9390 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.8736 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.7269 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9842 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 0.7328 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8284 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8401 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.7608 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0050 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9439 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9856 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.9272 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.7592 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0463 | Val  Acc: 0.2373
Average Valid Accuracy: 0.5695
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2712
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5614 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.5056 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.5523 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4443 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.8510 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7764 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7289 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.5888 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4538 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.8113 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.4541 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5476 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.5142 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4942 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8209 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.8122 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8300 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6568 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.5247 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9106 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3861 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3319 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3565 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2927 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8661 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.6675 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6527 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4746 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.4079 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7861 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 0.2788 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3637 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.3508 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3649 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7215 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7424 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7509 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.5038 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.6085 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9426 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3421 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2665 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3249 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2524 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5456 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.3114 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2300 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3828 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9350 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.3575 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.2580 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3345 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2810 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2963 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.3881 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3942 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.4164 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.3490 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.2997 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.6829 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7458
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1788 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1476 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1800 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1291 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.3574 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.1525 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.1308 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3003 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9384 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.0884 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.1462 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1579 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1567 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1694 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.2490 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.2443 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.1767 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3164 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.3243 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5538 | Val  Acc: 0.4576
Average Valid Accuracy: 0.7610
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1340 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1046 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1317 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0839 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.1321 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 0.9513 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.8692 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.2089 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.5690 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.7514 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.0934 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1273 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0989 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1181 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.9605 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 0.9814 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.9678 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.2285 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0915 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.3255 | Val  Acc: 0.5254
Average Valid Accuracy: 0.8051
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0932 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0561 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0920 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9015 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 0.7702 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.7100 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.1447 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4998 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.6189 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.0652 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0606 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0830 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.7554 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.8311 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 0.7958 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 0.1902 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.0745 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2937 | Val  Acc: 0.5424
Average Valid Accuracy: 0.8288
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7288
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0690 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0465 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0679 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7115 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.5756 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 0.5309 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.1316 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.3648 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4234 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0522 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0587 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.5757 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.6173 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.6058 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.1757 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0002 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1912 | Val  Acc: 0.6441
Average Valid Accuracy: 0.8763
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/FedPrompt...
===2023-03-29 00:14:48===
===2023-03-29 00:14:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8850
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3330
 Test site-USPS      | Epoch:9 | Test Acc: 0.8710
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5643
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3593
Average Test Accuracy: 0.6025
