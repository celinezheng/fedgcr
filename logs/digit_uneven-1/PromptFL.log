===2023-03-25 17:20:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2182 | Train Acc: 0.3964
 Site-MNIST     | Train Loss: 2.2306 | Train Acc: 0.2973
 Site-MNIST     | Train Loss: 2.2279 | Train Acc: 0.3153
 Site-MNIST     | Train Loss: 2.2301 | Train Acc: 0.3063
 Site-SVHN      | Train Loss: 2.2740 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2820 | Train Acc: 0.1261
 Site-SVHN      | Train Loss: 2.2517 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 2.2277 | Train Acc: 0.3964
 Site-SynthDigits| Train Loss: 2.2965 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.2951 | Train Acc: 0.1532
 Site-MNIST     | Val  Loss: 2.2208 | Val  Acc: 0.3649
 Site-MNIST     | Val  Loss: 2.2350 | Val  Acc: 0.2973
 Site-MNIST     | Val  Loss: 2.2391 | Val  Acc: 0.2568
 Site-MNIST     | Val  Loss: 2.2033 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 2.2586 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.2862 | Val  Acc: 0.0676
 Site-SVHN      | Val  Loss: 2.2750 | Val  Acc: 0.2432
 Site-USPS      | Val  Loss: 2.2388 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 2.2984 | Val  Acc: 0.1486
 Site-MNIST-M   | Val  Loss: 2.3135 | Val  Acc: 0.1486
Average Valid Accuracy: 0.2581
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3649
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2973
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0676
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2432
 Best site-USPS       | Epoch:0 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1486
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1469 | Train Acc: 0.4775
 Site-MNIST     | Train Loss: 2.1612 | Train Acc: 0.3694
 Site-MNIST     | Train Loss: 2.1477 | Train Acc: 0.4505
 Site-MNIST     | Train Loss: 2.1643 | Train Acc: 0.4505
 Site-SVHN      | Train Loss: 2.2574 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2628 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2245 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 2.1584 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 2.2851 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.2820 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 2.1384 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 2.1554 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 2.1720 | Val  Acc: 0.3378
 Site-MNIST     | Val  Loss: 2.1214 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 2.2332 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2735 | Val  Acc: 0.1081
 Site-SVHN      | Val  Loss: 2.2531 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 2.1715 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 2.2922 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.2985 | Val  Acc: 0.1757
Average Valid Accuracy: 0.3189
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3378
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1081
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-USPS       | Epoch:1 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0780 | Train Acc: 0.4595
 Site-MNIST     | Train Loss: 2.0959 | Train Acc: 0.4054
 Site-MNIST     | Train Loss: 2.0732 | Train Acc: 0.4775
 Site-MNIST     | Train Loss: 2.1004 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 2.2440 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.2477 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2022 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 2.0920 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 2.2725 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.2694 | Train Acc: 0.2072
 Site-MNIST     | Val  Loss: 2.0614 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 2.0814 | Val  Acc: 0.4730
 Site-MNIST     | Val  Loss: 2.1083 | Val  Acc: 0.3784
 Site-MNIST     | Val  Loss: 2.0442 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 2.2136 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.2624 | Val  Acc: 0.1081
 Site-SVHN      | Val  Loss: 2.2373 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 2.1091 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 2.2832 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2851 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3324
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4730
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3784
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1081
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2703
 Best site-USPS       | Epoch:2 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0130 | Train Acc: 0.4685
 Site-MNIST     | Train Loss: 2.0335 | Train Acc: 0.4505
 Site-MNIST     | Train Loss: 2.0042 | Train Acc: 0.4775
 Site-MNIST     | Train Loss: 2.0401 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 2.2328 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2339 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1817 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 2.0296 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 2.2593 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2569 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.9898 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 2.0136 | Val  Acc: 0.4730
 Site-MNIST     | Val  Loss: 2.0483 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 1.9724 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 2.1964 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2525 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2236 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 2.0498 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 2.2731 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2728 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4730
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2838
 Best site-USPS       | Epoch:3 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9514 | Train Acc: 0.4955
 Site-MNIST     | Train Loss: 1.9744 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.9394 | Train Acc: 0.4955
 Site-MNIST     | Train Loss: 1.9833 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 2.2232 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2238 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1652 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 1.9700 | Train Acc: 0.5315
 Site-SynthDigits| Train Loss: 2.2447 | Train Acc: 0.2432
 Site-MNIST-M   | Train Loss: 2.2443 | Train Acc: 0.2703
 Site-MNIST     | Val  Loss: 1.9225 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.9502 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 1.9909 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.9046 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 2.1820 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2438 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2126 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.9938 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 2.2624 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2601 | Val  Acc: 0.2703
Average Valid Accuracy: 0.3662
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2838
 Best site-USPS       | Epoch:4 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.8920 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.9175 | Train Acc: 0.5225
 Site-MNIST     | Train Loss: 1.8774 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.9280 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 2.2144 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2133 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1513 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 1.9147 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 2.2312 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2337 | Train Acc: 0.2613
 Site-MNIST     | Val  Loss: 1.8575 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.8883 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.9347 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.8399 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 2.1690 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2363 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2032 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.9412 | Val  Acc: 0.4459
 Site-SynthDigits| Val  Loss: 2.2516 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.2479 | Val  Acc: 0.2703
Average Valid Accuracy: 0.3838
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2838
 Best site-USPS       | Epoch:5 | Val Acc: 0.4459
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8357 | Train Acc: 0.5676
 Site-MNIST     | Train Loss: 1.8650 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.8203 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.8749 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 2.2073 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.2058 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1377 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.8620 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 2.2177 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2223 | Train Acc: 0.2703
 Site-MNIST     | Val  Loss: 1.7985 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.8316 | Val  Acc: 0.6486
 Site-MNIST     | Val  Loss: 1.8832 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.7813 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 2.1571 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2298 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.1946 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.8915 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2398 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.2369 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4027
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6486
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2838
 Best site-USPS       | Epoch:6 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.7799 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.8104 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.7653 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.8202 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 2.1997 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1974 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1246 | Train Acc: 0.2793
 Site-USPS      | Train Loss: 1.8127 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.2028 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2116 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.7395 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.7744 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.8310 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.7223 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.1460 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2236 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.1868 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.8451 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2278 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2257 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4203
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2838
 Best site-USPS       | Epoch:7 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7258 | Train Acc: 0.6577
 Site-MNIST     | Train Loss: 1.7581 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.7063 | Train Acc: 0.7027
 Site-MNIST     | Train Loss: 1.7678 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.1915 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1897 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1141 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.7607 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 2.1891 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1995 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.6806 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.7176 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.7790 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6650 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.1351 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2183 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.1796 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.7960 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 2.2161 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.2139 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4405
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2838
 Best site-USPS       | Epoch:8 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.6753 | Train Acc: 0.6937
 Site-MNIST     | Train Loss: 1.7125 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.6565 | Train Acc: 0.7297
 Site-MNIST     | Train Loss: 1.7192 | Train Acc: 0.6216
 Site-SVHN      | Train Loss: 2.1850 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1834 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1024 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.7140 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 2.1754 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.1881 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.6284 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.6673 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 1.7328 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6156 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 2.1252 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.2130 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.1733 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.7508 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.2049 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2031 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4500
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2838
 Best site-USPS       | Epoch:9 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/PromptFL...
===2023-03-25 17:39:11===
===2023-03-25 17:39:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.5400
 Test site-SVHN      | Epoch:9 | Test Acc: 0.1980
 Test site-USPS      | Epoch:9 | Test Acc: 0.6452
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.2929
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2143
Average Test Accuracy: 0.3781
