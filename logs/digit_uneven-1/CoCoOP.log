===2023-03-28 19:57:34===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8214 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.7425 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.7335 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.6723 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 2.1987 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1768 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1974 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.8100 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.1369 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2291 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.6838 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7371 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.7797 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7382 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.2329 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1629 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2294 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.8208 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.1431 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2418 | Val  Acc: 0.1356
Average Valid Accuracy: 0.3746
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4132 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3207 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.3513 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2375 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1248 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0866 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0863 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.4397 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.9669 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1270 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.2849 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.3470 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3849 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.2988 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.1506 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0661 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1391 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4810 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.9710 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1393 | Val  Acc: 0.2203
Average Valid Accuracy: 0.4797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1241 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.0218 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0802 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.9713 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 2.1047 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.0109 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0013 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.2001 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8172 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.9947 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 0.9979 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 1.0720 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1011 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0133 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0700 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0096 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0686 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.2310 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 1.8316 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0470 | Val  Acc: 0.3051
Average Valid Accuracy: 0.5525
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1525
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8733 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.8298 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.8645 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7870 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 2.0345 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 1.9429 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9196 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 1.0184 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.7341 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.9020 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.7916 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8675 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8985 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8189 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0082 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9670 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9940 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 1.0476 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.7242 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9610 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5949
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2542
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7495 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7101 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7125 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6504 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.9680 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8841 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8635 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8914 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.6303 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8384 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.6562 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7308 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7597 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6929 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9400 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9246 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9241 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.9177 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.6384 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8923 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2881
 Best site-USPS       | Epoch:4 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6488 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6078 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.6259 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5288 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.9539 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8357 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7822 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.7757 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.5439 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.7702 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.5491 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.6303 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6487 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5962 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8893 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8868 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8730 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8115 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5681 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8279 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6356
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5586 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5042 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.5328 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4841 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9198 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.7862 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7169 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.6871 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.4458 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.6717 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.4728 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5600 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5643 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5261 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8530 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8534 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8224 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7204 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.4985 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7699 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2712
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5115 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5037 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4842 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3964 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8790 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.7811 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6829 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.6154 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3991 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.5964 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 0.4221 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5036 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4954 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4744 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8233 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8383 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7755 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.6511 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4447 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7094 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6627
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3559
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4459 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4470 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4585 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3611 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8823 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7491 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6828 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.5932 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.3235 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.5330 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.3798 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4590 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4413 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4403 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.7934 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.8112 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7141 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.6044 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.3899 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6587 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3729
 Best site-USPS       | Epoch:8 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3985 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3696 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4182 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3156 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7695 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6809 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.5985 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.5495 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.2564 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.4615 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.3434 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4120 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3919 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4048 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.7569 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.7658 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6441 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.5628 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3462 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6222 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6915
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-USPS       | Epoch:9 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/CoCoOP...
===2023-03-28 20:30:14===
===2023-03-28 20:30:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8436
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3375
 Test site-USPS      | Epoch:9 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5196
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4243
Average Test Accuracy: 0.5917
