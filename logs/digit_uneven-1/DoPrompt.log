===2023-03-28 21:48:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8195 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7045 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7000 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.6577 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 2.2308 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1847 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1917 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.7998 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.1271 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2237 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.6607 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7273 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7614 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7189 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.2338 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1718 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2253 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7907 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.1352 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2219 | Val  Acc: 0.1525
Average Valid Accuracy: 0.3898
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4235 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.3666 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3695 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.2568 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.1280 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0834 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0824 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.4612 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.9721 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1162 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.2950 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.3722 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.4021 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.3216 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.1612 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.0846 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.1481 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.4660 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.9610 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1226 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4814
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1695
 Best site-USPS       | Epoch:1 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1618 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1000 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.1503 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 1.0340 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0808 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0300 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0093 | Train Acc: 0.3409
 Site-USPS      | Train Loss: 1.2325 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8628 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 2.0296 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.0582 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.1363 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1651 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0706 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.1060 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0370 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0889 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.2460 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.8410 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0431 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1695
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9465 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.9019 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9252 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.8209 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 2.0706 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9821 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9850 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.0999 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7325 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9343 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.8531 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.9324 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.9673 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8668 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0599 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9969 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0410 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0842 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7468 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9715 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5763
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2034
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7703 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7587 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.7677 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.6721 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 2.0111 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9613 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9236 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.9106 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.6616 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.8595 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.6874 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.7628 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7961 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6979 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 2.0187 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9594 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9998 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.9576 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6639 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9148 | Val  Acc: 0.2881
Average Valid Accuracy: 0.6169
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6573 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5896 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.6643 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5473 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.9941 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8927 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.9099 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8902 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.5813 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.7795 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.5466 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6272 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6549 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5659 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.9793 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9241 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.9541 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.8736 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.6083 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8570 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6305
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-USPS       | Epoch:5 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5465 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4931 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.5339 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4586 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9481 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8771 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.8465 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8121 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.5344 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7042 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.4573 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5295 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5432 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4688 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.9491 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8937 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.9221 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.8034 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.5453 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7996 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6407
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2373
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4924 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4427 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.5016 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3669 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9280 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8303 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8013 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.7486 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.4493 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.6636 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.3999 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4858 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4885 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4285 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.9088 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8660 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8852 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7548 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.4785 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7624 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2712
 Best site-USPS       | Epoch:7 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4319 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3676 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.4138 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3395 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8838 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8104 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7857 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.6978 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3949 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.6042 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.3431 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4074 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4158 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3694 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8907 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8379 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8610 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 0.7137 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4425 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7130 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2373
 Best site-USPS       | Epoch:8 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3981 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3438 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3943 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2692 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.8626 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7874 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7617 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.6448 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.2955 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.5886 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.3056 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3835 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3790 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3428 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8736 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8227 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8334 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.6679 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.3993 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6872 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6627
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2712
 Best site-USPS       | Epoch:9 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1/DoPrompt...
===2023-03-28 22:21:49===
===2023-03-28 22:21:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8421
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2771
 Test site-USPS      | Epoch:9 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4742
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3607
Average Test Accuracy: 0.5575
