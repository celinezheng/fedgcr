===2023-07-29 17:41:29===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST                         | Train Loss: 1.1739 | Train Acc: 0.6667
 Site-MNIST                         | Train Loss: 1.1754 | Train Acc: 0.7500
 Site-MNIST                         | Train Loss: 0.9473 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.9802 | Train Acc: 0.8684
 Site-MNIST                         | Train Loss: 1.0828 | Train Acc: 0.8143
 Site-MNIST                         | Train Loss: 1.1095 | Train Acc: 0.7778
 Site-MNIST                         | Train Loss: 1.0953 | Train Acc: 0.8326
 Site-MNIST                         | Train Loss: 1.1743 | Train Acc: 0.7433
 Site-MNIST                         | Train Loss: 1.1116 | Train Acc: 0.7962
 Site-MNIST                         | Train Loss: 1.0782 | Train Acc: 0.8106
 Site-USPS                          | Train Loss: 1.1163 | Train Acc: 0.8250
 Site-USPS                          | Train Loss: 1.1614 | Train Acc: 0.7778
 Site-USPS                          | Train Loss: 0.8167 | Train Acc: 0.8450
 Site-USPS                          | Train Loss: 1.0911 | Train Acc: 0.7811
 Site-USPS                          | Train Loss: 1.0455 | Train Acc: 0.7952
 Site-USPS                          | Train Loss: 1.0683 | Train Acc: 0.7831
 Site-SynthDigits                   | Train Loss: 1.8838 | Train Acc: 0.3974
 Site-SynthDigits                   | Train Loss: 1.9014 | Train Acc: 0.3773
 Site-SynthDigits                   | Train Loss: 1.8576 | Train Acc: 0.3951
 Site-MNIST_M                       | Train Loss: 2.0615 | Train Acc: 0.2818
 Site-MNIST_M                       | Train Loss: 2.0044 | Train Acc: 0.3609
 Site-SVHN                          | Train Loss: 2.2160 | Train Acc: 0.2021
Average Train Accuracy: 0.6743
 Site-MNIST                         | Val  Loss: 0.7637 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.9939 | Val  Acc: 0.6667
 Site-MNIST                         | Val  Loss: 1.0629 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 1.2011 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 1.0804 | Val  Acc: 0.7647
 Site-MNIST                         | Val  Loss: 1.1261 | Val  Acc: 0.8065
 Site-MNIST                         | Val  Loss: 1.0914 | Val  Acc: 0.8214
 Site-MNIST                         | Val  Loss: 1.0791 | Val  Acc: 0.8137
 Site-MNIST                         | Val  Loss: 1.1220 | Val  Acc: 0.7650
 Site-MNIST                         | Val  Loss: 1.1261 | Val  Acc: 0.7704
 Site-USPS                          | Val  Loss: 0.8335 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 1.2415 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 1.2331 | Val  Acc: 0.6562
 Site-USPS                          | Val  Loss: 1.2082 | Val  Acc: 0.7241
 Site-USPS                          | Val  Loss: 1.1276 | Val  Acc: 0.7714
 Site-USPS                          | Val  Loss: 1.0367 | Val  Acc: 0.8042
 Site-SynthDigits                   | Val  Loss: 1.9358 | Val  Acc: 0.4054
 Site-SynthDigits                   | Val  Loss: 2.0906 | Val  Acc: 0.4265
 Site-SynthDigits                   | Val  Loss: 1.9053 | Val  Acc: 0.4180
 Site-MNIST_M                       | Val  Loss: 2.0504 | Val  Acc: 0.3111
 Site-MNIST_M                       | Val  Loss: 1.9987 | Val  Acc: 0.3457
 Site-SVHN                          | Val  Loss: 2.3165 | Val  Acc: 0.1429
Average Valid Accuracy: 0.6617
 Best site-MNIST                     | Epoch:0 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7647
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8065
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8214
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.8137
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7650
 Best site-MNIST                     | Epoch:0 | Val Acc: 0.7704
 Best site-USPS                      | Epoch:0 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:0 | Val Acc: 0.6562
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7241
 Best site-USPS                      | Epoch:0 | Val Acc: 0.7714
 Best site-USPS                      | Epoch:0 | Val Acc: 0.8042
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4054
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4265
 Best site-SynthDigits               | Epoch:0 | Val Acc: 0.4180
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3111
 Best site-MNIST_M                   | Epoch:0 | Val Acc: 0.3457
 Best site-SVHN                      | Epoch:0 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 1 ============
 Site-MNIST                         | Train Loss: 0.7295 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.9307 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.5047 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.5877 | Train Acc: 0.8947
 Site-MNIST                         | Train Loss: 0.6459 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.7058 | Train Acc: 0.8492
 Site-MNIST                         | Train Loss: 0.6940 | Train Acc: 0.8722
 Site-MNIST                         | Train Loss: 0.7830 | Train Acc: 0.8117
 Site-MNIST                         | Train Loss: 0.7208 | Train Acc: 0.8573
 Site-MNIST                         | Train Loss: 0.6880 | Train Acc: 0.8574
 Site-USPS                          | Train Loss: 0.6929 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.7669 | Train Acc: 0.8472
 Site-USPS                          | Train Loss: 0.6563 | Train Acc: 0.8295
 Site-USPS                          | Train Loss: 0.6774 | Train Acc: 0.8069
 Site-USPS                          | Train Loss: 0.6216 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.6265 | Train Acc: 0.8611
 Site-SynthDigits                   | Train Loss: 1.8472 | Train Acc: 0.3709
 Site-SynthDigits                   | Train Loss: 1.8251 | Train Acc: 0.3626
 Site-SynthDigits                   | Train Loss: 1.7129 | Train Acc: 0.4134
 Site-MNIST_M                       | Train Loss: 1.9356 | Train Acc: 0.3315
 Site-MNIST_M                       | Train Loss: 1.9116 | Train Acc: 0.3823
 Site-SVHN                          | Train Loss: 2.2037 | Train Acc: 0.1915
Average Train Accuracy: 0.7176
 Site-MNIST                         | Val  Loss: 0.5311 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5898 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.6761 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.7131 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.6286 | Val  Acc: 0.7647
 Site-MNIST                         | Val  Loss: 0.6857 | Val  Acc: 0.8387
 Site-MNIST                         | Val  Loss: 0.7041 | Val  Acc: 0.8750
 Site-MNIST                         | Val  Loss: 0.6900 | Val  Acc: 0.8725
 Site-MNIST                         | Val  Loss: 0.7251 | Val  Acc: 0.8415
 Site-MNIST                         | Val  Loss: 0.7361 | Val  Acc: 0.8459
 Site-USPS                          | Val  Loss: 0.3841 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.9139 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.9119 | Val  Acc: 0.7188
 Site-USPS                          | Val  Loss: 0.8933 | Val  Acc: 0.7241
 Site-USPS                          | Val  Loss: 0.7598 | Val  Acc: 0.7905
 Site-USPS                          | Val  Loss: 0.6137 | Val  Acc: 0.8466
 Site-SynthDigits                   | Val  Loss: 1.8199 | Val  Acc: 0.3784
 Site-SynthDigits                   | Val  Loss: 2.0901 | Val  Acc: 0.4118
 Site-SynthDigits                   | Val  Loss: 1.8169 | Val  Acc: 0.4098
 Site-MNIST_M                       | Val  Loss: 1.9349 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.8466 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 2.3197 | Val  Acc: 0.1571
Average Valid Accuracy: 0.7035
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.7647
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8387
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8750
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8725
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8415
 Best site-MNIST                     | Epoch:1 | Val Acc: 0.8459
 Best site-USPS                      | Epoch:1 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7188
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7241
 Best site-USPS                      | Epoch:1 | Val Acc: 0.7905
 Best site-USPS                      | Epoch:1 | Val Acc: 0.8466
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.3784
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4118
 Best site-SynthDigits               | Epoch:1 | Val Acc: 0.4098
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:1 | Val Acc: 0.4568
 Best site-SVHN                      | Epoch:1 | Val Acc: 0.1571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 2 ============
 Site-MNIST                         | Train Loss: 0.5383 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.7085 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.3315 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4026 | Train Acc: 0.8947
 Site-MNIST                         | Train Loss: 0.6469 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.5461 | Train Acc: 0.8651
 Site-MNIST                         | Train Loss: 0.5260 | Train Acc: 0.8811
 Site-MNIST                         | Train Loss: 0.6211 | Train Acc: 0.8240
 Site-MNIST                         | Train Loss: 0.5236 | Train Acc: 0.8614
 Site-MNIST                         | Train Loss: 0.5102 | Train Acc: 0.8770
 Site-USPS                          | Train Loss: 0.5854 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.6708 | Train Acc: 0.8333
 Site-USPS                          | Train Loss: 0.3560 | Train Acc: 0.8760
 Site-USPS                          | Train Loss: 0.5623 | Train Acc: 0.8369
 Site-USPS                          | Train Loss: 0.4899 | Train Acc: 0.8738
 Site-USPS                          | Train Loss: 0.4904 | Train Acc: 0.8730
 Site-SynthDigits                   | Train Loss: 1.6376 | Train Acc: 0.4437
 Site-SynthDigits                   | Train Loss: 1.6620 | Train Acc: 0.4579
 Site-SynthDigits                   | Train Loss: 1.5344 | Train Acc: 0.5031
 Site-MNIST_M                       | Train Loss: 1.8039 | Train Acc: 0.3757
 Site-MNIST_M                       | Train Loss: 1.6974 | Train Acc: 0.4281
 Site-SVHN                          | Train Loss: 2.1604 | Train Acc: 0.2021
Average Train Accuracy: 0.7423
 Site-MNIST                         | Val  Loss: 0.1310 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3003 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5476 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.5760 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.5110 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.5680 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.5443 | Val  Acc: 0.8571
 Site-MNIST                         | Val  Loss: 0.5026 | Val  Acc: 0.8627
 Site-MNIST                         | Val  Loss: 0.5597 | Val  Acc: 0.8306
 Site-MNIST                         | Val  Loss: 0.5590 | Val  Acc: 0.8459
 Site-USPS                          | Val  Loss: 0.3051 | Val  Acc: 0.9000
 Site-USPS                          | Val  Loss: 0.7197 | Val  Acc: 0.6667
 Site-USPS                          | Val  Loss: 0.7973 | Val  Acc: 0.7188
 Site-USPS                          | Val  Loss: 0.7663 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.6382 | Val  Acc: 0.8286
 Site-USPS                          | Val  Loss: 0.4946 | Val  Acc: 0.8677
 Site-SynthDigits                   | Val  Loss: 1.6194 | Val  Acc: 0.4324
 Site-SynthDigits                   | Val  Loss: 1.8136 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.6440 | Val  Acc: 0.4754
 Site-MNIST_M                       | Val  Loss: 1.7746 | Val  Acc: 0.4000
 Site-MNIST_M                       | Val  Loss: 1.6696 | Val  Acc: 0.4568
 Site-SVHN                          | Val  Loss: 2.1664 | Val  Acc: 0.2143
Average Valid Accuracy: 0.7307
 Best site-MNIST                     | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8710
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8571
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8627
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8306
 Best site-MNIST                     | Epoch:2 | Val Acc: 0.8459
 Best site-USPS                      | Epoch:2 | Val Acc: 0.9000
 Best site-USPS                      | Epoch:2 | Val Acc: 0.6667
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7188
 Best site-USPS                      | Epoch:2 | Val Acc: 0.7759
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8286
 Best site-USPS                      | Epoch:2 | Val Acc: 0.8677
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4324
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:2 | Val Acc: 0.4754
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4000
 Best site-MNIST_M                   | Epoch:2 | Val Acc: 0.4568
 Best site-SVHN                      | Epoch:2 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 3 ============
 Site-MNIST                         | Train Loss: 0.4080 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.5751 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.2458 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.2687 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3582 | Train Acc: 0.8571
 Site-MNIST                         | Train Loss: 0.4033 | Train Acc: 0.8810
 Site-MNIST                         | Train Loss: 0.3969 | Train Acc: 0.9031
 Site-MNIST                         | Train Loss: 0.4612 | Train Acc: 0.8606
 Site-MNIST                         | Train Loss: 0.4084 | Train Acc: 0.8899
 Site-MNIST                         | Train Loss: 0.3784 | Train Acc: 0.9208
 Site-USPS                          | Train Loss: 0.5494 | Train Acc: 0.8500
 Site-USPS                          | Train Loss: 0.6182 | Train Acc: 0.8611
 Site-USPS                          | Train Loss: 0.4537 | Train Acc: 0.8605
 Site-USPS                          | Train Loss: 0.5356 | Train Acc: 0.8369
 Site-USPS                          | Train Loss: 0.4158 | Train Acc: 0.8619
 Site-USPS                          | Train Loss: 0.4303 | Train Acc: 0.8638
 Site-SynthDigits                   | Train Loss: 1.6463 | Train Acc: 0.4238
 Site-SynthDigits                   | Train Loss: 1.6413 | Train Acc: 0.4396
 Site-SynthDigits                   | Train Loss: 1.4902 | Train Acc: 0.4888
 Site-MNIST_M                       | Train Loss: 1.7009 | Train Acc: 0.4365
 Site-MNIST_M                       | Train Loss: 1.6762 | Train Acc: 0.4312
 Site-SVHN                          | Train Loss: 2.1437 | Train Acc: 0.2234
Average Train Accuracy: 0.7542
 Site-MNIST                         | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2816 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5230 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.5647 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.4373 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.4033 | Val  Acc: 0.9032
 Site-MNIST                         | Val  Loss: 0.3784 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.3561 | Val  Acc: 0.9216
 Site-MNIST                         | Val  Loss: 0.4245 | Val  Acc: 0.8852
 Site-MNIST                         | Val  Loss: 0.4381 | Val  Acc: 0.8882
 Site-USPS                          | Val  Loss: 0.1800 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.7031 | Val  Acc: 0.7222
 Site-USPS                          | Val  Loss: 0.7482 | Val  Acc: 0.6875
 Site-USPS                          | Val  Loss: 0.7298 | Val  Acc: 0.7241
 Site-USPS                          | Val  Loss: 0.5859 | Val  Acc: 0.8286
 Site-USPS                          | Val  Loss: 0.4583 | Val  Acc: 0.8730
 Site-SynthDigits                   | Val  Loss: 1.5773 | Val  Acc: 0.4054
 Site-SynthDigits                   | Val  Loss: 1.7737 | Val  Acc: 0.4118
 Site-SynthDigits                   | Val  Loss: 1.6374 | Val  Acc: 0.4508
 Site-MNIST_M                       | Val  Loss: 1.6737 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.5788 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 2.1157 | Val  Acc: 0.2286
Average Valid Accuracy: 0.7455
 Best site-MNIST                     | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9032
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.9216
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8852
 Best site-MNIST                     | Epoch:3 | Val Acc: 0.8882
 Best site-USPS                      | Epoch:3 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7222
 Best site-USPS                      | Epoch:3 | Val Acc: 0.6875
 Best site-USPS                      | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8286
 Best site-USPS                      | Epoch:3 | Val Acc: 0.8730
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4054
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4118
 Best site-SynthDigits               | Epoch:3 | Val Acc: 0.4508
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.4889
 Best site-MNIST_M                   | Epoch:3 | Val Acc: 0.5185
 Best site-SVHN                      | Epoch:3 | Val Acc: 0.2286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 4 ============
 Site-MNIST                         | Train Loss: 0.2979 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.5002 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.2092 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 0.2162 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2345 | Train Acc: 0.8857
 Site-MNIST                         | Train Loss: 0.3527 | Train Acc: 0.8968
 Site-MNIST                         | Train Loss: 0.3191 | Train Acc: 0.9119
 Site-MNIST                         | Train Loss: 0.3957 | Train Acc: 0.8753
 Site-MNIST                         | Train Loss: 0.3367 | Train Acc: 0.9103
 Site-MNIST                         | Train Loss: 0.3132 | Train Acc: 0.9275
 Site-USPS                          | Train Loss: 0.4742 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.3340 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2841 | Train Acc: 0.9070
 Site-USPS                          | Train Loss: 0.4779 | Train Acc: 0.8498
 Site-USPS                          | Train Loss: 0.3677 | Train Acc: 0.8881
 Site-USPS                          | Train Loss: 0.3708 | Train Acc: 0.8929
 Site-SynthDigits                   | Train Loss: 1.5356 | Train Acc: 0.4901
 Site-SynthDigits                   | Train Loss: 1.5886 | Train Acc: 0.4799
 Site-SynthDigits                   | Train Loss: 1.3925 | Train Acc: 0.5336
 Site-MNIST_M                       | Train Loss: 1.6919 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.6476 | Train Acc: 0.4251
 Site-SVHN                          | Train Loss: 2.1411 | Train Acc: 0.2270
Average Train Accuracy: 0.7703
 Site-MNIST                         | Val  Loss: 0.0849 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1843 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4471 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4758 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3529 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.3060 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.3059 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.2937 | Val  Acc: 0.9216
 Site-MNIST                         | Val  Loss: 0.3741 | Val  Acc: 0.8852
 Site-MNIST                         | Val  Loss: 0.3724 | Val  Acc: 0.9003
 Site-USPS                          | Val  Loss: 0.1312 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.5878 | Val  Acc: 0.7222
 Site-USPS                          | Val  Loss: 0.6722 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.6595 | Val  Acc: 0.7586
 Site-USPS                          | Val  Loss: 0.5376 | Val  Acc: 0.8476
 Site-USPS                          | Val  Loss: 0.3980 | Val  Acc: 0.8836
 Site-SynthDigits                   | Val  Loss: 1.4941 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.7182 | Val  Acc: 0.5147
 Site-SynthDigits                   | Val  Loss: 1.5433 | Val  Acc: 0.5000
 Site-MNIST_M                       | Val  Loss: 1.6752 | Val  Acc: 0.4667
 Site-MNIST_M                       | Val  Loss: 1.5674 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 2.0370 | Val  Acc: 0.2286
Average Valid Accuracy: 0.7529
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8235
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9216
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.8852
 Best site-MNIST                     | Epoch:4 | Val Acc: 0.9003
 Best site-USPS                      | Epoch:4 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7222
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:4 | Val Acc: 0.7586
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8476
 Best site-USPS                      | Epoch:4 | Val Acc: 0.8836
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5147
 Best site-SynthDigits               | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.4667
 Best site-MNIST_M                   | Epoch:4 | Val Acc: 0.5062
 Best site-SVHN                      | Epoch:4 | Val Acc: 0.2286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 5 ============
 Site-MNIST                         | Train Loss: 0.2545 | Train Acc: 0.8333
 Site-MNIST                         | Train Loss: 0.4606 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.2113 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1798 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2576 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.3091 | Train Acc: 0.8968
 Site-MNIST                         | Train Loss: 0.2702 | Train Acc: 0.9207
 Site-MNIST                         | Train Loss: 0.3361 | Train Acc: 0.8826
 Site-MNIST                         | Train Loss: 0.2880 | Train Acc: 0.9171
 Site-MNIST                         | Train Loss: 0.2666 | Train Acc: 0.9328
 Site-USPS                          | Train Loss: 0.4258 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.5034 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2369 | Train Acc: 0.9225
 Site-USPS                          | Train Loss: 0.4205 | Train Acc: 0.8712
 Site-USPS                          | Train Loss: 0.3102 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.3261 | Train Acc: 0.9061
 Site-SynthDigits                   | Train Loss: 1.4800 | Train Acc: 0.4834
 Site-SynthDigits                   | Train Loss: 1.4601 | Train Acc: 0.5128
 Site-SynthDigits                   | Train Loss: 1.3364 | Train Acc: 0.5601
 Site-MNIST_M                       | Train Loss: 1.6740 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.6064 | Train Acc: 0.4312
 Site-SVHN                          | Train Loss: 2.1037 | Train Acc: 0.2376
Average Train Accuracy: 0.7818
 Site-MNIST                         | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1088 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4811 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4715 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3400 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.2557 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.2637 | Val  Acc: 0.8929
 Site-MNIST                         | Val  Loss: 0.2559 | Val  Acc: 0.9118
 Site-MNIST                         | Val  Loss: 0.3361 | Val  Acc: 0.8852
 Site-MNIST                         | Val  Loss: 0.3345 | Val  Acc: 0.9033
 Site-USPS                          | Val  Loss: 0.0897 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4715 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.6073 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.6199 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.5071 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.3562 | Val  Acc: 0.8995
 Site-SynthDigits                   | Val  Loss: 1.4509 | Val  Acc: 0.4865
 Site-SynthDigits                   | Val  Loss: 1.6768 | Val  Acc: 0.5000
 Site-SynthDigits                   | Val  Loss: 1.4686 | Val  Acc: 0.5082
 Site-MNIST_M                       | Val  Loss: 1.6855 | Val  Acc: 0.4889
 Site-MNIST_M                       | Val  Loss: 1.5506 | Val  Acc: 0.5185
 Site-SVHN                          | Val  Loss: 1.9465 | Val  Acc: 0.2571
Average Valid Accuracy: 0.7628
 Best site-MNIST                     | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8235
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8710
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8929
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9118
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.8852
 Best site-MNIST                     | Epoch:5 | Val Acc: 0.9033
 Best site-USPS                      | Epoch:5 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7812
 Best site-USPS                      | Epoch:5 | Val Acc: 0.7759
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:5 | Val Acc: 0.8995
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.4865
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5000
 Best site-SynthDigits               | Epoch:5 | Val Acc: 0.5082
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.4889
 Best site-MNIST_M                   | Epoch:5 | Val Acc: 0.5185
 Best site-SVHN                      | Epoch:5 | Val Acc: 0.2571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 6 ============
 Site-MNIST                         | Train Loss: 0.2032 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.4455 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1806 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1785 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2727 | Train Acc: 0.9000
 Site-MNIST                         | Train Loss: 0.2824 | Train Acc: 0.9048
 Site-MNIST                         | Train Loss: 0.2644 | Train Acc: 0.9251
 Site-MNIST                         | Train Loss: 0.3179 | Train Acc: 0.8924
 Site-MNIST                         | Train Loss: 0.2562 | Train Acc: 0.9226
 Site-MNIST                         | Train Loss: 0.2404 | Train Acc: 0.9381
 Site-USPS                          | Train Loss: 0.3937 | Train Acc: 0.9250
 Site-USPS                          | Train Loss: 0.2100 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.2132 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.3930 | Train Acc: 0.8798
 Site-USPS                          | Train Loss: 0.2605 | Train Acc: 0.9310
 Site-USPS                          | Train Loss: 0.2902 | Train Acc: 0.9127
 Site-SynthDigits                   | Train Loss: 1.4422 | Train Acc: 0.4967
 Site-SynthDigits                   | Train Loss: 1.3590 | Train Acc: 0.5238
 Site-SynthDigits                   | Train Loss: 1.2695 | Train Acc: 0.5804
 Site-MNIST_M                       | Train Loss: 1.6178 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.4927 | Train Acc: 0.4495
 Site-SVHN                          | Train Loss: 2.0688 | Train Acc: 0.2376
Average Train Accuracy: 0.7962
 Site-MNIST                         | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0889 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4293 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4309 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3044 | Val  Acc: 0.8235
 Site-MNIST                         | Val  Loss: 0.2270 | Val  Acc: 0.8710
 Site-MNIST                         | Val  Loss: 0.2493 | Val  Acc: 0.9107
 Site-MNIST                         | Val  Loss: 0.2347 | Val  Acc: 0.9314
 Site-MNIST                         | Val  Loss: 0.3041 | Val  Acc: 0.9071
 Site-MNIST                         | Val  Loss: 0.2999 | Val  Acc: 0.9154
 Site-USPS                          | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4447 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.5799 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.5803 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.4655 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.3162 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.3919 | Val  Acc: 0.5135
 Site-SynthDigits                   | Val  Loss: 1.6012 | Val  Acc: 0.5147
 Site-SynthDigits                   | Val  Loss: 1.4127 | Val  Acc: 0.5082
 Site-MNIST_M                       | Val  Loss: 1.6279 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.4953 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.8706 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7764
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8235
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9107
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9314
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9071
 Best site-MNIST                     | Epoch:6 | Val Acc: 0.9154
 Best site-USPS                      | Epoch:6 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:6 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:6 | Val Acc: 0.8857
 Best site-USPS                      | Epoch:6 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5135
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5147
 Best site-SynthDigits               | Epoch:6 | Val Acc: 0.5082
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:6 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:6 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 7 ============
 Site-MNIST                         | Train Loss: 0.1824 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3553 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1554 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1411 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1870 | Train Acc: 0.8857
 Site-MNIST                         | Train Loss: 0.2239 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.2280 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.2586 | Train Acc: 0.9120
 Site-MNIST                         | Train Loss: 0.2273 | Train Acc: 0.9375
 Site-MNIST                         | Train Loss: 0.2015 | Train Acc: 0.9472
 Site-USPS                          | Train Loss: 0.4079 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.2621 | Train Acc: 0.8611
 Site-USPS                          | Train Loss: 0.5272 | Train Acc: 0.8992
 Site-USPS                          | Train Loss: 0.3843 | Train Acc: 0.8627
 Site-USPS                          | Train Loss: 0.2676 | Train Acc: 0.9190
 Site-USPS                          | Train Loss: 0.2910 | Train Acc: 0.9021
 Site-SynthDigits                   | Train Loss: 1.3775 | Train Acc: 0.4768
 Site-SynthDigits                   | Train Loss: 1.4156 | Train Acc: 0.5495
 Site-SynthDigits                   | Train Loss: 1.2362 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.6427 | Train Acc: 0.4420
 Site-MNIST_M                       | Train Loss: 1.5247 | Train Acc: 0.4618
 Site-SVHN                          | Train Loss: 2.0545 | Train Acc: 0.2482
Average Train Accuracy: 0.7940
 Site-MNIST                         | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4252 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4326 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3015 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1998 | Val  Acc: 0.9355
 Site-MNIST                         | Val  Loss: 0.2065 | Val  Acc: 0.9464
 Site-MNIST                         | Val  Loss: 0.1967 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.2696 | Val  Acc: 0.9180
 Site-MNIST                         | Val  Loss: 0.2631 | Val  Acc: 0.9305
 Site-USPS                          | Val  Loss: 0.0663 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4650 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.6040 | Val  Acc: 0.7500
 Site-USPS                          | Val  Loss: 0.6036 | Val  Acc: 0.7586
 Site-USPS                          | Val  Loss: 0.4707 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.3213 | Val  Acc: 0.8942
 Site-SynthDigits                   | Val  Loss: 1.3743 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.5818 | Val  Acc: 0.5588
 Site-SynthDigits                   | Val  Loss: 1.3714 | Val  Acc: 0.5246
 Site-MNIST_M                       | Val  Loss: 1.6958 | Val  Acc: 0.4667
 Site-MNIST_M                       | Val  Loss: 1.5240 | Val  Acc: 0.5062
 Site-SVHN                          | Val  Loss: 1.8207 | Val  Acc: 0.3143
Average Valid Accuracy: 0.7768
 Best site-MNIST                     | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9355
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9464
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9180
 Best site-MNIST                     | Epoch:7 | Val Acc: 0.9305
 Best site-USPS                      | Epoch:7 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7778
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7500
 Best site-USPS                      | Epoch:7 | Val Acc: 0.7586
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:7 | Val Acc: 0.8942
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5588
 Best site-SynthDigits               | Epoch:7 | Val Acc: 0.5246
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.4667
 Best site-MNIST_M                   | Epoch:7 | Val Acc: 0.5062
 Best site-SVHN                      | Epoch:7 | Val Acc: 0.3143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 8 ============
 Site-MNIST                         | Train Loss: 0.1754 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3639 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1480 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1260 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1579 | Train Acc: 0.8857
 Site-MNIST                         | Train Loss: 0.2164 | Train Acc: 0.9206
 Site-MNIST                         | Train Loss: 0.1867 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.2612 | Train Acc: 0.9169
 Site-MNIST                         | Train Loss: 0.2044 | Train Acc: 0.9375
 Site-MNIST                         | Train Loss: 0.1860 | Train Acc: 0.9547
 Site-USPS                          | Train Loss: 0.3860 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.3321 | Train Acc: 0.8611
 Site-USPS                          | Train Loss: 0.1960 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.3566 | Train Acc: 0.8755
 Site-USPS                          | Train Loss: 0.2434 | Train Acc: 0.9262
 Site-USPS                          | Train Loss: 0.2786 | Train Acc: 0.9114
 Site-SynthDigits                   | Train Loss: 1.3278 | Train Acc: 0.5033
 Site-SynthDigits                   | Train Loss: 1.3095 | Train Acc: 0.5751
 Site-SynthDigits                   | Train Loss: 1.2184 | Train Acc: 0.5723
 Site-MNIST_M                       | Train Loss: 1.6052 | Train Acc: 0.4475
 Site-MNIST_M                       | Train Loss: 1.5117 | Train Acc: 0.4771
 Site-SVHN                          | Train Loss: 2.1061 | Train Acc: 0.2695
Average Train Accuracy: 0.8032
 Site-MNIST                         | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0710 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4689 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4795 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.3131 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1754 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1826 | Val  Acc: 0.9643
 Site-MNIST                         | Val  Loss: 0.1812 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.2586 | Val  Acc: 0.9235
 Site-MNIST                         | Val  Loss: 0.2446 | Val  Acc: 0.9366
 Site-USPS                          | Val  Loss: 0.0444 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3921 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.5581 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.5521 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.4357 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2975 | Val  Acc: 0.9101
 Site-SynthDigits                   | Val  Loss: 1.3762 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.6091 | Val  Acc: 0.6176
 Site-SynthDigits                   | Val  Loss: 1.3445 | Val  Acc: 0.5492
 Site-MNIST_M                       | Val  Loss: 1.6272 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4485 | Val  Acc: 0.5309
 Site-SVHN                          | Val  Loss: 1.7797 | Val  Acc: 0.3286
Average Valid Accuracy: 0.7940
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9643
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9608
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9235
 Best site-MNIST                     | Epoch:8 | Val Acc: 0.9366
 Best site-USPS                      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8333
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7812
 Best site-USPS                      | Epoch:8 | Val Acc: 0.7759
 Best site-USPS                      | Epoch:8 | Val Acc: 0.8762
 Best site-USPS                      | Epoch:8 | Val Acc: 0.9101
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.6176
 Best site-SynthDigits               | Epoch:8 | Val Acc: 0.5492
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5111
 Best site-MNIST_M                   | Epoch:8 | Val Acc: 0.5309
 Best site-SVHN                      | Epoch:8 | Val Acc: 0.3286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 9 ============
 Site-MNIST                         | Train Loss: 0.1576 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3596 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1706 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1256 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1840 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1997 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1645 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.2575 | Train Acc: 0.9267
 Site-MNIST                         | Train Loss: 0.1882 | Train Acc: 0.9416
 Site-MNIST                         | Train Loss: 0.1687 | Train Acc: 0.9638
 Site-USPS                          | Train Loss: 0.3630 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.3573 | Train Acc: 0.8889
 Site-USPS                          | Train Loss: 0.3554 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.3765 | Train Acc: 0.8670
 Site-USPS                          | Train Loss: 0.2284 | Train Acc: 0.9357
 Site-USPS                          | Train Loss: 0.2628 | Train Acc: 0.9127
 Site-SynthDigits                   | Train Loss: 1.3469 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2810 | Train Acc: 0.5678
 Site-SynthDigits                   | Train Loss: 1.1862 | Train Acc: 0.5601
 Site-MNIST_M                       | Train Loss: 1.5537 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.5134 | Train Acc: 0.4985
 Site-SVHN                          | Train Loss: 2.0844 | Train Acc: 0.2447
Average Train Accuracy: 0.8091
 Site-MNIST                         | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4345 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4186 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2695 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1440 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1659 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1662 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.2429 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.2284 | Val  Acc: 0.9366
 Site-USPS                          | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3724 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.5365 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.5304 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.4225 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2939 | Val  Acc: 0.9048
 Site-SynthDigits                   | Val  Loss: 1.3409 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.5373 | Val  Acc: 0.5882
 Site-SynthDigits                   | Val  Loss: 1.3197 | Val  Acc: 0.5246
 Site-MNIST_M                       | Val  Loss: 1.5853 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.4152 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.7001 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7936
============ Train epoch 10 ============
 Site-MNIST                         | Train Loss: 0.1471 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3191 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1245 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1176 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.1330 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1717 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.1816 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.2304 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1687 | Train Acc: 0.9538
 Site-MNIST                         | Train Loss: 0.1457 | Train Acc: 0.9668
 Site-USPS                          | Train Loss: 0.3705 | Train Acc: 0.9000
 Site-USPS                          | Train Loss: 0.2162 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.1789 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.3516 | Train Acc: 0.8755
 Site-USPS                          | Train Loss: 0.2207 | Train Acc: 0.9333
 Site-USPS                          | Train Loss: 0.2543 | Train Acc: 0.9180
 Site-SynthDigits                   | Train Loss: 1.3717 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 1.2989 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.1426 | Train Acc: 0.5825
 Site-MNIST_M                       | Train Loss: 1.5691 | Train Acc: 0.4696
 Site-MNIST_M                       | Train Loss: 1.4543 | Train Acc: 0.4954
 Site-SVHN                          | Train Loss: 2.0434 | Train Acc: 0.2624
Average Train Accuracy: 0.8111
 Site-MNIST                         | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4610 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4459 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2912 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1376 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1512 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1423 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.2237 | Val  Acc: 0.9399
 Site-MNIST                         | Val  Loss: 0.2094 | Val  Acc: 0.9426
 Site-USPS                          | Val  Loss: 0.0275 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3774 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.5666 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.5386 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.4083 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2718 | Val  Acc: 0.9048
 Site-SynthDigits                   | Val  Loss: 1.3332 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.5212 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.2763 | Val  Acc: 0.5574
 Site-MNIST_M                       | Val  Loss: 1.6238 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.4327 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6516 | Val  Acc: 0.3000
Average Valid Accuracy: 0.8020
 Best site-MNIST                     | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9399
 Best site-MNIST                     | Epoch:10 | Val Acc: 0.9426
 Best site-USPS                      | Epoch:10 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:10 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:10 | Val Acc: 0.8667
 Best site-USPS                      | Epoch:10 | Val Acc: 0.9048
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.6029
 Best site-SynthDigits               | Epoch:10 | Val Acc: 0.5574
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:10 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:10 | Val Acc: 0.3000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 11 ============
 Site-MNIST                         | Train Loss: 0.1251 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3270 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1701 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1262 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2055 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1792 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1493 | Train Acc: 0.9427
 Site-MNIST                         | Train Loss: 0.2204 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1642 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1467 | Train Acc: 0.9691
 Site-USPS                          | Train Loss: 0.3062 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2889 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.2968 | Train Acc: 0.9380
 Site-USPS                          | Train Loss: 0.3128 | Train Acc: 0.9056
 Site-USPS                          | Train Loss: 0.1840 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2200 | Train Acc: 0.9272
 Site-SynthDigits                   | Train Loss: 1.3255 | Train Acc: 0.5232
 Site-SynthDigits                   | Train Loss: 1.2475 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.1357 | Train Acc: 0.6008
 Site-MNIST_M                       | Train Loss: 1.5524 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 1.5877 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0682 | Train Acc: 0.2730
Average Train Accuracy: 0.8214
 Site-MNIST                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0460 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3739 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3515 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2320 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1215 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1457 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1436 | Val  Acc: 0.9608
 Site-MNIST                         | Val  Loss: 0.2165 | Val  Acc: 0.9344
 Site-MNIST                         | Val  Loss: 0.2031 | Val  Acc: 0.9396
 Site-USPS                          | Val  Loss: 0.0220 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2920 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4728 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4833 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3858 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2497 | Val  Acc: 0.9259
 Site-SynthDigits                   | Val  Loss: 1.2670 | Val  Acc: 0.5405
 Site-SynthDigits                   | Val  Loss: 1.4391 | Val  Acc: 0.6029
 Site-SynthDigits                   | Val  Loss: 1.2397 | Val  Acc: 0.5738
 Site-MNIST_M                       | Val  Loss: 1.6023 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.4090 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.6548 | Val  Acc: 0.3143
Average Valid Accuracy: 0.8100
 Best site-MNIST                     | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9608
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9344
 Best site-MNIST                     | Epoch:11 | Val Acc: 0.9396
 Best site-USPS                      | Epoch:11 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8103
 Best site-USPS                      | Epoch:11 | Val Acc: 0.8857
 Best site-USPS                      | Epoch:11 | Val Acc: 0.9259
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5405
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.6029
 Best site-SynthDigits               | Epoch:11 | Val Acc: 0.5738
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5778
 Best site-MNIST_M                   | Epoch:11 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:11 | Val Acc: 0.3143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 12 ============
 Site-MNIST                         | Train Loss: 0.1278 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2828 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1172 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1092 | Train Acc: 0.9474
 Site-MNIST                         | Train Loss: 0.2510 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1671 | Train Acc: 0.9365
 Site-MNIST                         | Train Loss: 0.1565 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.2091 | Train Acc: 0.9413
 Site-MNIST                         | Train Loss: 0.1471 | Train Acc: 0.9592
 Site-MNIST                         | Train Loss: 0.1304 | Train Acc: 0.9721
 Site-USPS                          | Train Loss: 0.2970 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1812 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.1791 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2944 | Train Acc: 0.8841
 Site-USPS                          | Train Loss: 0.1780 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.2137 | Train Acc: 0.9312
 Site-SynthDigits                   | Train Loss: 1.2813 | Train Acc: 0.5166
 Site-SynthDigits                   | Train Loss: 1.2429 | Train Acc: 0.5897
 Site-SynthDigits                   | Train Loss: 1.1165 | Train Acc: 0.6191
 Site-MNIST_M                       | Train Loss: 1.5857 | Train Acc: 0.4530
 Site-MNIST_M                       | Train Loss: 1.5225 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 2.0709 | Train Acc: 0.2518
Average Train Accuracy: 0.8182
 Site-MNIST                         | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0358 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4353 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4135 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2628 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1209 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1320 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1294 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.2067 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1976 | Val  Acc: 0.9426
 Site-USPS                          | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3127 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4922 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4895 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.3852 | Val  Acc: 0.8667
 Site-USPS                          | Val  Loss: 0.2425 | Val  Acc: 0.9153
 Site-SynthDigits                   | Val  Loss: 1.2805 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.4709 | Val  Acc: 0.6176
 Site-SynthDigits                   | Val  Loss: 1.2214 | Val  Acc: 0.5738
 Site-MNIST_M                       | Val  Loss: 1.6347 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4349 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.6464 | Val  Acc: 0.3429
Average Valid Accuracy: 0.8076
============ Train epoch 13 ============
 Site-MNIST                         | Train Loss: 0.1584 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.3179 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1080 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0949 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1390 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1540 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1456 | Train Acc: 0.9383
 Site-MNIST                         | Train Loss: 0.1951 | Train Acc: 0.9315
 Site-MNIST                         | Train Loss: 0.1459 | Train Acc: 0.9592
 Site-MNIST                         | Train Loss: 0.1194 | Train Acc: 0.9728
 Site-USPS                          | Train Loss: 0.3124 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.3086 | Train Acc: 0.8750
 Site-USPS                          | Train Loss: 0.1622 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2821 | Train Acc: 0.8970
 Site-USPS                          | Train Loss: 0.1752 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.2048 | Train Acc: 0.9365
 Site-SynthDigits                   | Train Loss: 1.2885 | Train Acc: 0.5364
 Site-SynthDigits                   | Train Loss: 1.3190 | Train Acc: 0.6044
 Site-SynthDigits                   | Train Loss: 1.0970 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.5506 | Train Acc: 0.4586
 Site-MNIST_M                       | Train Loss: 1.5986 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0020 | Train Acc: 0.2730
Average Train Accuracy: 0.8230
 Site-MNIST                         | Val  Loss: 0.0102 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0662 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5071 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4687 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2856 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1277 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1364 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1313 | Val  Acc: 0.9706
 Site-MNIST                         | Val  Loss: 0.2026 | Val  Acc: 0.9290
 Site-MNIST                         | Val  Loss: 0.1894 | Val  Acc: 0.9335
 Site-USPS                          | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2680 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4605 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.4565 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3704 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.2376 | Val  Acc: 0.9206
 Site-SynthDigits                   | Val  Loss: 1.2472 | Val  Acc: 0.5946
 Site-SynthDigits                   | Val  Loss: 1.4262 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.2050 | Val  Acc: 0.5984
 Site-MNIST_M                       | Val  Loss: 1.6068 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.4097 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5976 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8157
 Best site-MNIST                     | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9706
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9290
 Best site-MNIST                     | Epoch:13 | Val Acc: 0.9335
 Best site-USPS                      | Epoch:13 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8103
 Best site-USPS                      | Epoch:13 | Val Acc: 0.8762
 Best site-USPS                      | Epoch:13 | Val Acc: 0.9206
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5946
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.6912
 Best site-SynthDigits               | Epoch:13 | Val Acc: 0.5984
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5111
 Best site-MNIST_M                   | Epoch:13 | Val Acc: 0.5556
 Best site-SVHN                      | Epoch:13 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 14 ============
 Site-MNIST                         | Train Loss: 0.1503 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2797 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1079 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0907 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3426 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1449 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1392 | Train Acc: 0.9339
 Site-MNIST                         | Train Loss: 0.1928 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.1323 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.1093 | Train Acc: 0.9721
 Site-USPS                          | Train Loss: 0.2782 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2346 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.1764 | Train Acc: 0.9457
 Site-USPS                          | Train Loss: 0.2876 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1694 | Train Acc: 0.9571
 Site-USPS                          | Train Loss: 0.1963 | Train Acc: 0.9352
 Site-SynthDigits                   | Train Loss: 1.4346 | Train Acc: 0.5298
 Site-SynthDigits                   | Train Loss: 1.1883 | Train Acc: 0.6227
 Site-SynthDigits                   | Train Loss: 1.0786 | Train Acc: 0.6191
 Site-MNIST_M                       | Train Loss: 1.5359 | Train Acc: 0.4751
 Site-MNIST_M                       | Train Loss: 1.4289 | Train Acc: 0.5076
 Site-SVHN                          | Train Loss: 2.0292 | Train Acc: 0.2872
Average Train Accuracy: 0.8267
 Site-MNIST                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0242 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4599 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4275 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2532 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.1032 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1189 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1171 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1884 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1764 | Val  Acc: 0.9456
 Site-USPS                          | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3263 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.4927 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4656 | Val  Acc: 0.7931
 Site-USPS                          | Val  Loss: 0.3746 | Val  Acc: 0.8571
 Site-USPS                          | Val  Loss: 0.2357 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.2493 | Val  Acc: 0.5676
 Site-SynthDigits                   | Val  Loss: 1.3957 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 1.1823 | Val  Acc: 0.6148
 Site-MNIST_M                       | Val  Loss: 1.5968 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.3686 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5600 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8171
 Best site-MNIST                     | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:14 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.7778
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.8824
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9677
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9508
 Best site-MNIST                     | Epoch:14 | Val Acc: 0.9456
 Best site-USPS                      | Epoch:14 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:14 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:14 | Val Acc: 0.7931
 Best site-USPS                      | Epoch:14 | Val Acc: 0.8571
 Best site-USPS                      | Epoch:14 | Val Acc: 0.9312
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.5676
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6765
 Best site-SynthDigits               | Epoch:14 | Val Acc: 0.6148
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5111
 Best site-MNIST_M                   | Epoch:14 | Val Acc: 0.5679
 Best site-SVHN                      | Epoch:14 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 15 ============
 Site-MNIST                         | Train Loss: 0.1041 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2733 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1279 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0984 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1689 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.1336 | Train Acc: 0.9444
 Site-MNIST                         | Train Loss: 0.1442 | Train Acc: 0.9383
 Site-MNIST                         | Train Loss: 0.1959 | Train Acc: 0.9462
 Site-MNIST                         | Train Loss: 0.1247 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.1052 | Train Acc: 0.9766
 Site-USPS                          | Train Loss: 0.2778 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1305 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1532 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2567 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1499 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1894 | Train Acc: 0.9378
 Site-SynthDigits                   | Train Loss: 1.2421 | Train Acc: 0.5629
 Site-SynthDigits                   | Train Loss: 1.1875 | Train Acc: 0.6081
 Site-SynthDigits                   | Train Loss: 1.0453 | Train Acc: 0.6212
 Site-MNIST_M                       | Train Loss: 1.5085 | Train Acc: 0.4862
 Site-MNIST_M                       | Train Loss: 1.5602 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.0034 | Train Acc: 0.3014
Average Train Accuracy: 0.8307
 Site-MNIST                         | Val  Loss: 0.0065 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0134 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4521 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3783 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2373 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0856 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1209 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1125 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1868 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1676 | Val  Acc: 0.9456
 Site-USPS                          | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2963 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4864 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4590 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3560 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.2081 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.2108 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 1.4049 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 1.1430 | Val  Acc: 0.5902
 Site-MNIST_M                       | Val  Loss: 1.5861 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.3813 | Val  Acc: 0.5432
 Site-SVHN                          | Val  Loss: 1.5444 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8264
 Best site-MNIST                     | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:15 | Val Acc: 0.9456
 Best site-USPS                      | Epoch:15 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8103
 Best site-USPS                      | Epoch:15 | Val Acc: 0.8952
 Best site-USPS                      | Epoch:15 | Val Acc: 0.9418
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.6618
 Best site-SynthDigits               | Epoch:15 | Val Acc: 0.5902
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:15 | Val Acc: 0.5432
 Best site-SVHN                      | Epoch:15 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 16 ============
 Site-MNIST                         | Train Loss: 0.1275 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2805 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1104 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0936 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1122 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1311 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1397 | Train Acc: 0.9427
 Site-MNIST                         | Train Loss: 0.1735 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.1165 | Train Acc: 0.9688
 Site-MNIST                         | Train Loss: 0.0947 | Train Acc: 0.9774
 Site-USPS                          | Train Loss: 0.2591 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1446 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.2317 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.2592 | Train Acc: 0.9056
 Site-USPS                          | Train Loss: 0.1461 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1766 | Train Acc: 0.9431
 Site-SynthDigits                   | Train Loss: 1.1403 | Train Acc: 0.5828
 Site-SynthDigits                   | Train Loss: 1.1325 | Train Acc: 0.6190
 Site-SynthDigits                   | Train Loss: 1.0160 | Train Acc: 0.6477
 Site-MNIST_M                       | Train Loss: 1.5066 | Train Acc: 0.5138
 Site-MNIST_M                       | Train Loss: 1.4114 | Train Acc: 0.5015
 Site-SVHN                          | Train Loss: 2.0245 | Train Acc: 0.2943
Average Train Accuracy: 0.8358
 Site-MNIST                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3689 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3190 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2076 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1256 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.1108 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1886 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1643 | Val  Acc: 0.9456
 Site-USPS                          | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2635 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4555 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4334 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3420 | Val  Acc: 0.8762
 Site-USPS                          | Val  Loss: 0.1992 | Val  Acc: 0.9312
 Site-SynthDigits                   | Val  Loss: 1.1848 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3798 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.1335 | Val  Acc: 0.6148
 Site-MNIST_M                       | Val  Loss: 1.5675 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.3654 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.5496 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8372
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:16 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:16 | Val Acc: 0.9456
 Best site-USPS                      | Epoch:16 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8103
 Best site-USPS                      | Epoch:16 | Val Acc: 0.8762
 Best site-USPS                      | Epoch:16 | Val Acc: 0.9312
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:16 | Val Acc: 0.6148
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:16 | Val Acc: 0.5802
 Best site-SVHN                      | Epoch:16 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 17 ============
 Site-MNIST                         | Train Loss: 0.1087 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2685 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0951 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0860 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0983 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1283 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1151 | Train Acc: 0.9471
 Site-MNIST                         | Train Loss: 0.1579 | Train Acc: 0.9487
 Site-MNIST                         | Train Loss: 0.1062 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0840 | Train Acc: 0.9811
 Site-USPS                          | Train Loss: 0.2385 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.3276 | Train Acc: 0.9028
 Site-USPS                          | Train Loss: 0.2068 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2617 | Train Acc: 0.9056
 Site-USPS                          | Train Loss: 0.1500 | Train Acc: 0.9595
 Site-USPS                          | Train Loss: 0.1742 | Train Acc: 0.9444
 Site-SynthDigits                   | Train Loss: 1.2689 | Train Acc: 0.5695
 Site-SynthDigits                   | Train Loss: 1.1433 | Train Acc: 0.6154
 Site-SynthDigits                   | Train Loss: 1.0051 | Train Acc: 0.6619
 Site-MNIST_M                       | Train Loss: 1.4962 | Train Acc: 0.4807
 Site-MNIST_M                       | Train Loss: 1.3868 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 2.0089 | Train Acc: 0.3050
Average Train Accuracy: 0.8346
 Site-MNIST                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4564 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3961 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2340 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0805 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1055 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0956 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1723 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1489 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2946 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4735 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.4356 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3488 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.2024 | Val  Acc: 0.9365
 Site-SynthDigits                   | Val  Loss: 1.1992 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.3672 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.1032 | Val  Acc: 0.6230
 Site-MNIST_M                       | Val  Loss: 1.5903 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.3407 | Val  Acc: 0.5556
 Site-SVHN                          | Val  Loss: 1.5437 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8252
============ Train epoch 18 ============
 Site-MNIST                         | Train Loss: 0.1232 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2489 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1263 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0938 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1399 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1291 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1180 | Train Acc: 0.9559
 Site-MNIST                         | Train Loss: 0.1702 | Train Acc: 0.9535
 Site-MNIST                         | Train Loss: 0.1074 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0859 | Train Acc: 0.9789
 Site-USPS                          | Train Loss: 0.2524 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1890 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1983 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2526 | Train Acc: 0.9099
 Site-USPS                          | Train Loss: 0.1332 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1730 | Train Acc: 0.9418
 Site-SynthDigits                   | Train Loss: 1.1613 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 1.1904 | Train Acc: 0.6300
 Site-SynthDigits                   | Train Loss: 1.0006 | Train Acc: 0.6640
 Site-MNIST_M                       | Train Loss: 1.4817 | Train Acc: 0.4917
 Site-MNIST_M                       | Train Loss: 1.4556 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0191 | Train Acc: 0.3014
Average Train Accuracy: 0.8391
 Site-MNIST                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4700 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.4138 | Val  Acc: 0.7778
 Site-MNIST                         | Val  Loss: 0.2438 | Val  Acc: 0.8824
 Site-MNIST                         | Val  Loss: 0.0835 | Val  Acc: 0.9677
 Site-MNIST                         | Val  Loss: 0.1034 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0964 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1761 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1526 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2628 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4595 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.4067 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3272 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1980 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1909 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.3264 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 1.1021 | Val  Acc: 0.6393
 Site-MNIST_M                       | Val  Loss: 1.5240 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.2902 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.5214 | Val  Acc: 0.3571
Average Valid Accuracy: 0.8241
============ Train epoch 19 ============
 Site-MNIST                         | Train Loss: 0.1318 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2549 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.1117 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0885 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1718 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.1239 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1353 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1547 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.1040 | Train Acc: 0.9701
 Site-MNIST                         | Train Loss: 0.0795 | Train Acc: 0.9819
 Site-USPS                          | Train Loss: 0.2446 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1459 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1233 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2296 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.1226 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1558 | Train Acc: 0.9458
 Site-SynthDigits                   | Train Loss: 1.3327 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0692 | Train Acc: 0.6190
 Site-SynthDigits                   | Train Loss: 0.9651 | Train Acc: 0.6701
 Site-MNIST_M                       | Train Loss: 1.4789 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.4402 | Train Acc: 0.5229
 Site-SVHN                          | Train Loss: 1.9853 | Train Acc: 0.3085
Average Train Accuracy: 0.8401
 Site-MNIST                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3977 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3497 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2084 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0786 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1078 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0979 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1781 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1538 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0090 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2660 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4428 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3912 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.3139 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1878 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1798 | Val  Acc: 0.6486
 Site-SynthDigits                   | Val  Loss: 1.3460 | Val  Acc: 0.6765
 Site-SynthDigits                   | Val  Loss: 1.0758 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.5507 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.3019 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.4926 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8396
 Best site-MNIST                     | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9563
 Best site-MNIST                     | Epoch:19 | Val Acc: 0.9607
 Best site-USPS                      | Epoch:19 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:19 | Val Acc: 0.8448
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:19 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6486
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6765
 Best site-SynthDigits               | Epoch:19 | Val Acc: 0.6311
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:19 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:19 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 20 ============
 Site-MNIST                         | Train Loss: 0.0947 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2781 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0971 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0841 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0895 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1112 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1259 | Train Acc: 0.9515
 Site-MNIST                         | Train Loss: 0.1509 | Train Acc: 0.9560
 Site-MNIST                         | Train Loss: 0.0957 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0721 | Train Acc: 0.9842
 Site-USPS                          | Train Loss: 0.2271 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1623 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1275 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.2454 | Train Acc: 0.9013
 Site-USPS                          | Train Loss: 0.1217 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1539 | Train Acc: 0.9497
 Site-SynthDigits                   | Train Loss: 1.2565 | Train Acc: 0.5762
 Site-SynthDigits                   | Train Loss: 1.0543 | Train Acc: 0.6300
 Site-SynthDigits                   | Train Loss: 0.9747 | Train Acc: 0.6599
 Site-MNIST_M                       | Train Loss: 1.4776 | Train Acc: 0.5138
 Site-MNIST_M                       | Train Loss: 1.5058 | Train Acc: 0.5199
 Site-SVHN                          | Train Loss: 2.0222 | Train Acc: 0.3191
Average Train Accuracy: 0.8399
 Site-MNIST                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4539 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3738 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2265 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0707 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1079 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0937 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1690 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1425 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.3082 | Val  Acc: 0.7778
 Site-USPS                          | Val  Loss: 0.4802 | Val  Acc: 0.7188
 Site-USPS                          | Val  Loss: 0.4163 | Val  Acc: 0.7759
 Site-USPS                          | Val  Loss: 0.3239 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1806 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1648 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3737 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 1.0749 | Val  Acc: 0.6311
 Site-MNIST_M                       | Val  Loss: 1.5696 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.3169 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5158 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8253
============ Train epoch 21 ============
 Site-MNIST                         | Train Loss: 0.1049 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2578 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0905 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0745 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3977 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1103 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1276 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1645 | Train Acc: 0.9511
 Site-MNIST                         | Train Loss: 0.0882 | Train Acc: 0.9755
 Site-MNIST                         | Train Loss: 0.0671 | Train Acc: 0.9864
 Site-USPS                          | Train Loss: 0.2320 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2340 | Train Acc: 0.9167
 Site-USPS                          | Train Loss: 0.1186 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.2258 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1242 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1515 | Train Acc: 0.9471
 Site-SynthDigits                   | Train Loss: 1.1532 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.0800 | Train Acc: 0.6593
 Site-SynthDigits                   | Train Loss: 0.9461 | Train Acc: 0.6884
 Site-MNIST_M                       | Train Loss: 1.4798 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3998 | Train Acc: 0.5321
 Site-SVHN                          | Train Loss: 1.9907 | Train Acc: 0.3050
Average Train Accuracy: 0.8443
 Site-MNIST                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4181 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3736 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2156 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0687 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1018 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0892 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1659 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1433 | Val  Acc: 0.9517
 Site-USPS                          | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2780 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4567 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3991 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.3115 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1756 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1499 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3515 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.0563 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5806 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.3082 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5191 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8388
============ Train epoch 22 ============
 Site-MNIST                         | Train Loss: 0.0884 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2664 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0735 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0898 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.3981 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1081 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1134 | Train Acc: 0.9559
 Site-MNIST                         | Train Loss: 0.1448 | Train Acc: 0.9535
 Site-MNIST                         | Train Loss: 0.0867 | Train Acc: 0.9783
 Site-MNIST                         | Train Loss: 0.0607 | Train Acc: 0.9894
 Site-USPS                          | Train Loss: 0.2232 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1055 | Train Acc: 0.9306
 Site-USPS                          | Train Loss: 0.1238 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2307 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1286 | Train Acc: 0.9619
 Site-USPS                          | Train Loss: 0.1477 | Train Acc: 0.9497
 Site-SynthDigits                   | Train Loss: 1.2260 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 1.1071 | Train Acc: 0.6557
 Site-SynthDigits                   | Train Loss: 0.9503 | Train Acc: 0.6802
 Site-MNIST_M                       | Train Loss: 1.4636 | Train Acc: 0.5193
 Site-MNIST_M                       | Train Loss: 1.4527 | Train Acc: 0.5291
 Site-SVHN                          | Train Loss: 2.0272 | Train Acc: 0.3014
Average Train Accuracy: 0.8451
 Site-MNIST                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3587 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3126 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1817 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1047 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0880 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1626 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1349 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2691 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4366 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3961 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3169 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1773 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1728 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.4049 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.0577 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5904 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.3049 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5460 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8421
 Best site-MNIST                     | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:22 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9563
 Best site-MNIST                     | Epoch:22 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:22 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8276
 Best site-USPS                      | Epoch:22 | Val Acc: 0.8952
 Best site-USPS                      | Epoch:22 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:22 | Val Acc: 0.6721
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:22 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:22 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 23 ============
 Site-MNIST                         | Train Loss: 0.0911 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2496 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0846 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0790 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2709 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.1096 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1074 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1392 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0828 | Train Acc: 0.9742
 Site-MNIST                         | Train Loss: 0.0610 | Train Acc: 0.9887
 Site-USPS                          | Train Loss: 0.2026 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1491 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1115 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.2375 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1104 | Train Acc: 0.9643
 Site-USPS                          | Train Loss: 0.1330 | Train Acc: 0.9550
 Site-SynthDigits                   | Train Loss: 1.2210 | Train Acc: 0.5960
 Site-SynthDigits                   | Train Loss: 1.1262 | Train Acc: 0.6520
 Site-SynthDigits                   | Train Loss: 0.9432 | Train Acc: 0.6884
 Site-MNIST_M                       | Train Loss: 1.4553 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3990 | Train Acc: 0.5107
 Site-SVHN                          | Train Loss: 2.0459 | Train Acc: 0.3156
Average Train Accuracy: 0.8465
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3484 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2885 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1720 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1008 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0852 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1565 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1309 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2750 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4350 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3814 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.3071 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1667 | Val  Acc: 0.9418
 Site-SynthDigits                   | Val  Loss: 1.1649 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3923 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 1.0558 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.5277 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2697 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5455 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8424
 Best site-MNIST                     | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9508
 Best site-MNIST                     | Epoch:23 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:23 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8276
 Best site-USPS                      | Epoch:23 | Val Acc: 0.8952
 Best site-USPS                      | Epoch:23 | Val Acc: 0.9418
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:23 | Val Acc: 0.6639
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:23 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:23 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 24 ============
 Site-MNIST                         | Train Loss: 0.0742 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2484 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0866 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0767 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0933 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.1062 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1017 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1355 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0799 | Train Acc: 0.9769
 Site-MNIST                         | Train Loss: 0.0588 | Train Acc: 0.9894
 Site-USPS                          | Train Loss: 0.2167 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1838 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1665 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2099 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1075 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.1332 | Train Acc: 0.9603
 Site-SynthDigits                   | Train Loss: 1.2056 | Train Acc: 0.6093
 Site-SynthDigits                   | Train Loss: 1.1250 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.9238 | Train Acc: 0.6843
 Site-MNIST_M                       | Train Loss: 1.4788 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.4076 | Train Acc: 0.5260
 Site-SVHN                          | Train Loss: 1.9994 | Train Acc: 0.3121
Average Train Accuracy: 0.8479
 Site-MNIST                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3667 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3122 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1903 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0589 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0956 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0802 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1555 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1288 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2635 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4399 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3836 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.2996 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1608 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.1316 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3269 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.0465 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5443 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2827 | Val  Acc: 0.5802
 Site-SVHN                          | Val  Loss: 1.5316 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8375
============ Train epoch 25 ============
 Site-MNIST                         | Train Loss: 0.0668 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2420 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0750 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0662 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1293 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0990 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.1063 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1325 | Train Acc: 0.9560
 Site-MNIST                         | Train Loss: 0.0773 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0546 | Train Acc: 0.9917
 Site-USPS                          | Train Loss: 0.2241 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2794 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1158 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.2036 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1094 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1342 | Train Acc: 0.9550
 Site-SynthDigits                   | Train Loss: 1.2786 | Train Acc: 0.5894
 Site-SynthDigits                   | Train Loss: 1.0083 | Train Acc: 0.6703
 Site-SynthDigits                   | Train Loss: 0.9128 | Train Acc: 0.6904
 Site-MNIST_M                       | Train Loss: 1.4331 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3855 | Train Acc: 0.5352
 Site-SVHN                          | Train Loss: 1.9945 | Train Acc: 0.3191
Average Train Accuracy: 0.8472
 Site-MNIST                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3306 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2626 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1545 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0995 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0819 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1609 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1296 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2475 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.4149 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3606 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.2922 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1651 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1349 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3301 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 1.0341 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.4981 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.2364 | Val  Acc: 0.5679
 Site-SVHN                          | Val  Loss: 1.5304 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8417
============ Train epoch 26 ============
 Site-MNIST                         | Train Loss: 0.0734 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2127 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0863 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0666 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1009 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0937 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.0979 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1366 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0741 | Train Acc: 0.9796
 Site-MNIST                         | Train Loss: 0.0516 | Train Acc: 0.9902
 Site-USPS                          | Train Loss: 0.2074 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2664 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1139 | Train Acc: 0.9535
 Site-USPS                          | Train Loss: 0.2011 | Train Acc: 0.9142
 Site-USPS                          | Train Loss: 0.1038 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1259 | Train Acc: 0.9577
 Site-SynthDigits                   | Train Loss: 1.1599 | Train Acc: 0.6026
 Site-SynthDigits                   | Train Loss: 0.9542 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8920 | Train Acc: 0.7067
 Site-MNIST_M                       | Train Loss: 1.4386 | Train Acc: 0.5083
 Site-MNIST_M                       | Train Loss: 1.3602 | Train Acc: 0.5321
 Site-SVHN                          | Train Loss: 2.0327 | Train Acc: 0.3369
Average Train Accuracy: 0.8490
 Site-MNIST                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2969 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2608 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1528 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0940 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0815 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1619 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1341 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2775 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4337 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3650 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.2941 | Val  Acc: 0.8857
 Site-USPS                          | Val  Loss: 0.1654 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1342 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3208 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.0171 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5258 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.2808 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5030 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8383
============ Train epoch 27 ============
 Site-MNIST                         | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2203 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0670 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0678 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1064 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.0964 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1006 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1369 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0737 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.0491 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.1956 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1222 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1178 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1975 | Train Acc: 0.9099
 Site-USPS                          | Train Loss: 0.1020 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1189 | Train Acc: 0.9656
 Site-SynthDigits                   | Train Loss: 1.1001 | Train Acc: 0.6026
 Site-SynthDigits                   | Train Loss: 1.0940 | Train Acc: 0.6630
 Site-SynthDigits                   | Train Loss: 0.8831 | Train Acc: 0.7026
 Site-MNIST_M                       | Train Loss: 1.4344 | Train Acc: 0.5249
 Site-MNIST_M                       | Train Loss: 1.3283 | Train Acc: 0.5382
 Site-SVHN                          | Train Loss: 2.0079 | Train Acc: 0.3156
Average Train Accuracy: 0.8497
 Site-MNIST                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3494 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2810 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1616 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0919 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0772 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1544 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1221 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2819 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4286 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3584 | Val  Acc: 0.8103
 Site-USPS                          | Val  Loss: 0.2866 | Val  Acc: 0.8952
 Site-USPS                          | Val  Loss: 0.1579 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.1261 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.3243 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 1.0200 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5369 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2559 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5154 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8391
============ Train epoch 28 ============
 Site-MNIST                         | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2335 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0529 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0626 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1358 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0873 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0955 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1290 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0712 | Train Acc: 0.9783
 Site-MNIST                         | Train Loss: 0.0444 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.2082 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1508 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1116 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1944 | Train Acc: 0.9185
 Site-USPS                          | Train Loss: 0.1069 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.1197 | Train Acc: 0.9643
 Site-SynthDigits                   | Train Loss: 1.1785 | Train Acc: 0.6159
 Site-SynthDigits                   | Train Loss: 0.9881 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.8708 | Train Acc: 0.7128
 Site-MNIST_M                       | Train Loss: 1.4000 | Train Acc: 0.5470
 Site-MNIST_M                       | Train Loss: 1.3979 | Train Acc: 0.5413
 Site-SVHN                          | Train Loss: 1.9919 | Train Acc: 0.3156
Average Train Accuracy: 0.8563
 Site-MNIST                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3134 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2700 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1552 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0465 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1002 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0797 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1586 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1192 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2621 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.4021 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3532 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.2753 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1523 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0817 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2731 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9814 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.5019 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.2327 | Val  Acc: 0.6173
 Site-SVHN                          | Val  Loss: 1.5413 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8405
============ Train epoch 29 ============
 Site-MNIST                         | Train Loss: 0.0469 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2544 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0629 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0697 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0945 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0890 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.1097 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1229 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0668 | Train Acc: 0.9851
 Site-MNIST                         | Train Loss: 0.0452 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.1935 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0777 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1098 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1868 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.0975 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.1105 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.2527 | Train Acc: 0.6159
 Site-SynthDigits                   | Train Loss: 1.0152 | Train Acc: 0.6740
 Site-SynthDigits                   | Train Loss: 0.8571 | Train Acc: 0.7271
 Site-MNIST_M                       | Train Loss: 1.4420 | Train Acc: 0.5249
 Site-MNIST_M                       | Train Loss: 1.3833 | Train Acc: 0.5505
 Site-SVHN                          | Train Loss: 1.9838 | Train Acc: 0.3121
Average Train Accuracy: 0.8550
 Site-MNIST                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3889 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2713 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1635 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0412 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1111 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0825 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1476 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.1142 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2814 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.4219 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3733 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2880 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1421 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0454 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2633 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9804 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.5318 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2675 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5265 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8440
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9617
 Best site-MNIST                     | Epoch:29 | Val Acc: 0.9637
 Best site-USPS                      | Epoch:29 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8125
 Best site-USPS                      | Epoch:29 | Val Acc: 0.8448
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:29 | Val Acc: 0.9524
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:29 | Val Acc: 0.6721
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:29 | Val Acc: 0.6049
 Best site-SVHN                      | Epoch:29 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 30 ============
 Site-MNIST                         | Train Loss: 0.0463 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2184 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0786 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0630 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1400 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0845 | Train Acc: 0.9603
 Site-MNIST                         | Train Loss: 0.1054 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1269 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0645 | Train Acc: 0.9823
 Site-MNIST                         | Train Loss: 0.0410 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.2012 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0700 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1102 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1929 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.0997 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.1101 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.1380 | Train Acc: 0.6291
 Site-SynthDigits                   | Train Loss: 0.9661 | Train Acc: 0.6850
 Site-SynthDigits                   | Train Loss: 0.8445 | Train Acc: 0.7210
 Site-MNIST_M                       | Train Loss: 1.4491 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.4080 | Train Acc: 0.5474
 Site-SVHN                          | Train Loss: 2.0199 | Train Acc: 0.3227
Average Train Accuracy: 0.8560
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2760 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2382 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1459 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1050 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0809 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1544 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1175 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2186 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3632 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3476 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2708 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1426 | Val  Acc: 0.9471
 Site-SynthDigits                   | Val  Loss: 1.0425 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2021 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9672 | Val  Acc: 0.6967
 Site-MNIST_M                       | Val  Loss: 1.5103 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2591 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5491 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8491
 Best site-MNIST                     | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9454
 Best site-MNIST                     | Epoch:30 | Val Acc: 0.9547
 Best site-USPS                      | Epoch:30 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:30 | Val Acc: 0.8448
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:30 | Val Acc: 0.9471
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.7500
 Best site-SynthDigits               | Epoch:30 | Val Acc: 0.6967
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:30 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:30 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 31 ============
 Site-MNIST                         | Train Loss: 0.0397 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2174 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0778 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0663 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2878 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0810 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0935 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1361 | Train Acc: 0.9584
 Site-MNIST                         | Train Loss: 0.0624 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0406 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.1984 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1432 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1217 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1768 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.0870 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.1063 | Train Acc: 0.9656
 Site-SynthDigits                   | Train Loss: 1.1471 | Train Acc: 0.6159
 Site-SynthDigits                   | Train Loss: 1.0205 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.8522 | Train Acc: 0.7169
 Site-MNIST_M                       | Train Loss: 1.4084 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.4117 | Train Acc: 0.5321
 Site-SVHN                          | Train Loss: 1.9475 | Train Acc: 0.3227
Average Train Accuracy: 0.8540
 Site-MNIST                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3638 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2593 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1508 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1010 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0766 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1499 | Val  Acc: 0.9454
 Site-MNIST                         | Val  Loss: 0.1116 | Val  Acc: 0.9547
 Site-USPS                          | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2321 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3767 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3312 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.2599 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1445 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0852 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.2841 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9867 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.4788 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2177 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5596 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8436
============ Train epoch 32 ============
 Site-MNIST                         | Train Loss: 0.0503 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2248 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0741 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0533 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1017 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0783 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0991 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1212 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0607 | Train Acc: 0.9851
 Site-MNIST                         | Train Loss: 0.0364 | Train Acc: 0.9925
 Site-USPS                          | Train Loss: 0.2032 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1772 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1031 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1950 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.1083 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.1977 | Train Acc: 0.6556
 Site-SynthDigits                   | Train Loss: 0.9413 | Train Acc: 0.6923
 Site-SynthDigits                   | Train Loss: 0.8259 | Train Acc: 0.7271
 Site-MNIST_M                       | Train Loss: 1.4282 | Train Acc: 0.5193
 Site-MNIST_M                       | Train Loss: 1.4083 | Train Acc: 0.5382
 Site-SVHN                          | Train Loss: 1.9770 | Train Acc: 0.3014
Average Train Accuracy: 0.8560
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4434 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3084 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1823 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1000 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0769 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1486 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1169 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2728 | Val  Acc: 0.8333
 Site-USPS                          | Val  Loss: 0.4169 | Val  Acc: 0.7812
 Site-USPS                          | Val  Loss: 0.3451 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.2670 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1418 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0570 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2209 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9643 | Val  Acc: 0.6967
 Site-MNIST_M                       | Val  Loss: 1.5119 | Val  Acc: 0.5111
 Site-MNIST_M                       | Val  Loss: 1.2587 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5314 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8393
============ Train epoch 33 ============
 Site-MNIST                         | Train Loss: 0.0565 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.1835 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0731 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0632 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0883 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0803 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0915 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1190 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0634 | Train Acc: 0.9810
 Site-MNIST                         | Train Loss: 0.0354 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.1939 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1482 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.1143 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1800 | Train Acc: 0.9227
 Site-USPS                          | Train Loss: 0.0928 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.1064 | Train Acc: 0.9669
 Site-SynthDigits                   | Train Loss: 1.0939 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9536 | Train Acc: 0.6703
 Site-SynthDigits                   | Train Loss: 0.8202 | Train Acc: 0.7291
 Site-MNIST_M                       | Train Loss: 1.4195 | Train Acc: 0.5414
 Site-MNIST_M                       | Train Loss: 1.2656 | Train Acc: 0.5443
 Site-SVHN                          | Train Loss: 2.0099 | Train Acc: 0.3156
Average Train Accuracy: 0.8549
 Site-MNIST                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3180 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2448 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1401 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0995 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0768 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1504 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1158 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2221 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3592 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3167 | Val  Acc: 0.8276
 Site-USPS                          | Val  Loss: 0.2600 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1525 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0489 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2602 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9671 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.5352 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2568 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5194 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8458
============ Train epoch 34 ============
 Site-MNIST                         | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2436 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0570 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0617 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0988 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0812 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.1067 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1256 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0586 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0339 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.1900 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.2281 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0947 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1774 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.0919 | Train Acc: 0.9667
 Site-USPS                          | Train Loss: 0.0973 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.0615 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9081 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.8200 | Train Acc: 0.7352
 Site-MNIST_M                       | Train Loss: 1.4029 | Train Acc: 0.5359
 Site-MNIST_M                       | Train Loss: 1.2786 | Train Acc: 0.5566
 Site-SVHN                          | Train Loss: 2.0013 | Train Acc: 0.3050
Average Train Accuracy: 0.8567
 Site-MNIST                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4167 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2814 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1604 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0986 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0736 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1407 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.1071 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2279 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3872 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3324 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2643 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1361 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0404 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.2739 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 0.9730 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.4925 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2148 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5315 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8443
============ Train epoch 35 ============
 Site-MNIST                         | Train Loss: 0.0426 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2283 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0498 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0608 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.4506 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0831 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0943 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1186 | Train Acc: 0.9633
 Site-MNIST                         | Train Loss: 0.0581 | Train Acc: 0.9864
 Site-MNIST                         | Train Loss: 0.0323 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.2005 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1528 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.0979 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1834 | Train Acc: 0.9270
 Site-USPS                          | Train Loss: 0.0906 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.1005 | Train Acc: 0.9683
 Site-SynthDigits                   | Train Loss: 1.1067 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.9114 | Train Acc: 0.6923
 Site-SynthDigits                   | Train Loss: 0.8010 | Train Acc: 0.7352
 Site-MNIST_M                       | Train Loss: 1.3700 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.3929 | Train Acc: 0.5535
 Site-SVHN                          | Train Loss: 1.9818 | Train Acc: 0.2908
Average Train Accuracy: 0.8590
 Site-MNIST                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4386 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3161 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1800 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0958 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0707 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1391 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1059 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2190 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3971 | Val  Acc: 0.8125
 Site-USPS                          | Val  Loss: 0.3407 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2669 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1372 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0121 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2372 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9485 | Val  Acc: 0.7049
 Site-MNIST_M                       | Val  Loss: 1.4907 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2280 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5642 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8458
============ Train epoch 36 ============
 Site-MNIST                         | Train Loss: 0.0509 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2712 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0486 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0478 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0933 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0820 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0956 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1251 | Train Acc: 0.9609
 Site-MNIST                         | Train Loss: 0.0547 | Train Acc: 0.9851
 Site-MNIST                         | Train Loss: 0.0318 | Train Acc: 0.9940
 Site-USPS                          | Train Loss: 0.1865 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0841 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.0859 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1748 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.0833 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0928 | Train Acc: 0.9722
 Site-SynthDigits                   | Train Loss: 1.1415 | Train Acc: 0.6291
 Site-SynthDigits                   | Train Loss: 0.9332 | Train Acc: 0.7033
 Site-SynthDigits                   | Train Loss: 0.8424 | Train Acc: 0.7352
 Site-MNIST_M                       | Train Loss: 1.4058 | Train Acc: 0.5304
 Site-MNIST_M                       | Train Loss: 1.2877 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 2.0229 | Train Acc: 0.3085
Average Train Accuracy: 0.8602
 Site-MNIST                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4193 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2918 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1712 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.1095 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0765 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1347 | Val  Acc: 0.9508
 Site-MNIST                         | Val  Loss: 0.1017 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2430 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3852 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3433 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2622 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1259 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0276 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.2451 | Val  Acc: 0.7647
 Site-SynthDigits                   | Val  Loss: 0.9569 | Val  Acc: 0.7049
 Site-MNIST_M                       | Val  Loss: 1.4696 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.2190 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.5574 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8511
 Best site-MNIST                     | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9804
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9508
 Best site-MNIST                     | Epoch:36 | Val Acc: 0.9577
 Best site-USPS                      | Epoch:36 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8889
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8438
 Best site-USPS                      | Epoch:36 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:36 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.7647
 Best site-SynthDigits               | Epoch:36 | Val Acc: 0.7049
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:36 | Val Acc: 0.5926
 Best site-SVHN                      | Epoch:36 | Val Acc: 0.3714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 37 ============
 Site-MNIST                         | Train Loss: 0.0485 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2242 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0644 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0552 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0939 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0801 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0879 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1107 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0507 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0308 | Train Acc: 0.9947
 Site-USPS                          | Train Loss: 0.1980 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0678 | Train Acc: 0.9444
 Site-USPS                          | Train Loss: 0.0959 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1725 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.0810 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.0913 | Train Acc: 0.9709
 Site-SynthDigits                   | Train Loss: 1.1668 | Train Acc: 0.6291
 Site-SynthDigits                   | Train Loss: 1.0402 | Train Acc: 0.6667
 Site-SynthDigits                   | Train Loss: 0.7970 | Train Acc: 0.7352
 Site-MNIST_M                       | Train Loss: 1.3977 | Train Acc: 0.5414
 Site-MNIST_M                       | Train Loss: 1.3331 | Train Acc: 0.5596
 Site-SVHN                          | Train Loss: 1.9924 | Train Acc: 0.3014
Average Train Accuracy: 0.8565
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4273 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3131 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1746 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0898 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0678 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1350 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1054 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1833 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3387 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3114 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2562 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1381 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0074 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.2133 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 0.9576 | Val  Acc: 0.6639
 Site-MNIST_M                       | Val  Loss: 1.4996 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.2175 | Val  Acc: 0.6173
 Site-SVHN                          | Val  Loss: 1.5880 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8460
============ Train epoch 38 ============
 Site-MNIST                         | Train Loss: 0.0447 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2165 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0594 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0583 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.4352 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0795 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0790 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1050 | Train Acc: 0.9707
 Site-MNIST                         | Train Loss: 0.0525 | Train Acc: 0.9918
 Site-MNIST                         | Train Loss: 0.0292 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.1762 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0990 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1098 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1888 | Train Acc: 0.9313
 Site-USPS                          | Train Loss: 0.0802 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0922 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 1.0857 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9192 | Train Acc: 0.6813
 Site-SynthDigits                   | Train Loss: 0.8030 | Train Acc: 0.7312
 Site-MNIST_M                       | Train Loss: 1.3819 | Train Acc: 0.5470
 Site-MNIST_M                       | Train Loss: 1.1705 | Train Acc: 0.5688
 Site-SVHN                          | Train Loss: 1.9857 | Train Acc: 0.3156
Average Train Accuracy: 0.8593
 Site-MNIST                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5482 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3632 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2004 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0875 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0674 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1262 | Val  Acc: 0.9672
 Site-MNIST                         | Val  Loss: 0.0990 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.2030 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3696 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3236 | Val  Acc: 0.8448
 Site-USPS                          | Val  Loss: 0.2661 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1373 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 1.0249 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.2449 | Val  Acc: 0.6912
 Site-SynthDigits                   | Val  Loss: 0.9610 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.4682 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1967 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5597 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8487
============ Train epoch 39 ============
 Site-MNIST                         | Train Loss: 0.0412 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2323 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0487 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.2276 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0763 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0837 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1209 | Train Acc: 0.9756
 Site-MNIST                         | Train Loss: 0.0484 | Train Acc: 0.9918
 Site-MNIST                         | Train Loss: 0.0266 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1831 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1492 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1401 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1570 | Train Acc: 0.9485
 Site-USPS                          | Train Loss: 0.0733 | Train Acc: 0.9786
 Site-USPS                          | Train Loss: 0.0847 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 1.1070 | Train Acc: 0.6225
 Site-SynthDigits                   | Train Loss: 0.9513 | Train Acc: 0.6886
 Site-SynthDigits                   | Train Loss: 0.7921 | Train Acc: 0.7454
 Site-MNIST_M                       | Train Loss: 1.3577 | Train Acc: 0.5414
 Site-MNIST_M                       | Train Loss: 1.3059 | Train Acc: 0.5719
 Site-SVHN                          | Train Loss: 1.9617 | Train Acc: 0.3050
Average Train Accuracy: 0.8636
 Site-MNIST                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3760 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2698 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1511 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0929 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0675 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1303 | Val  Acc: 0.9727
 Site-MNIST                         | Val  Loss: 0.0954 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1926 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3350 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3123 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2546 | Val  Acc: 0.9238
 Site-USPS                          | Val  Loss: 0.1263 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 1.0063 | Val  Acc: 0.7027
 Site-SynthDigits                   | Val  Loss: 1.1938 | Val  Acc: 0.7059
 Site-SynthDigits                   | Val  Loss: 0.9543 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.4489 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.1783 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.6119 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8552
 Best site-MNIST                     | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9727
 Best site-MNIST                     | Epoch:39 | Val Acc: 0.9698
 Best site-USPS                      | Epoch:39 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:39 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9238
 Best site-USPS                      | Epoch:39 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.7027
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.7059
 Best site-SynthDigits               | Epoch:39 | Val Acc: 0.6885
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.5333
 Best site-MNIST_M                   | Epoch:39 | Val Acc: 0.6049
 Best site-SVHN                      | Epoch:39 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 40 ============
 Site-MNIST                         | Train Loss: 0.0396 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2592 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0329 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0472 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0986 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0818 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0913 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1153 | Train Acc: 0.9682
 Site-MNIST                         | Train Loss: 0.0470 | Train Acc: 0.9878
 Site-MNIST                         | Train Loss: 0.0267 | Train Acc: 0.9955
 Site-USPS                          | Train Loss: 0.1669 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1154 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1117 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1620 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0801 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0791 | Train Acc: 0.9749
 Site-SynthDigits                   | Train Loss: 1.1391 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.9140 | Train Acc: 0.6850
 Site-SynthDigits                   | Train Loss: 0.7913 | Train Acc: 0.7556
 Site-MNIST_M                       | Train Loss: 1.3984 | Train Acc: 0.5193
 Site-MNIST_M                       | Train Loss: 1.2316 | Train Acc: 0.5657
 Site-SVHN                          | Train Loss: 1.9730 | Train Acc: 0.3050
Average Train Accuracy: 0.8618
 Site-MNIST                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.2615 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.1858 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1076 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0966 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0703 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1333 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.1011 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1500 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3265 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3339 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2724 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1151 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 1.0082 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2512 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9747 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.4640 | Val  Acc: 0.5333
 Site-MNIST_M                       | Val  Loss: 1.1868 | Val  Acc: 0.5926
 Site-SVHN                          | Val  Loss: 1.6101 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8485
============ Train epoch 41 ============
 Site-MNIST                         | Train Loss: 0.0476 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2246 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0465 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0506 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0822 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0707 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0825 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.1110 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0459 | Train Acc: 0.9891
 Site-MNIST                         | Train Loss: 0.0239 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1765 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0810 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0916 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1597 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0833 | Train Acc: 0.9690
 Site-USPS                          | Train Loss: 0.0850 | Train Acc: 0.9775
 Site-SynthDigits                   | Train Loss: 1.0211 | Train Acc: 0.6490
 Site-SynthDigits                   | Train Loss: 0.9226 | Train Acc: 0.6886
 Site-SynthDigits                   | Train Loss: 0.7824 | Train Acc: 0.7556
 Site-MNIST_M                       | Train Loss: 1.3946 | Train Acc: 0.5249
 Site-MNIST_M                       | Train Loss: 1.1814 | Train Acc: 0.5780
 Site-SVHN                          | Train Loss: 2.0171 | Train Acc: 0.3085
Average Train Accuracy: 0.8628
 Site-MNIST                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3796 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2873 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1601 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0857 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0691 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1369 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.1126 | Val  Acc: 0.9577
 Site-USPS                          | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1574 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3388 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3075 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2603 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1274 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 1.0039 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2565 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 0.9520 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.4872 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1947 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.5693 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8534
============ Train epoch 42 ============
 Site-MNIST                         | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2074 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0610 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0558 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0783 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0735 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0859 | Train Acc: 0.9604
 Site-MNIST                         | Train Loss: 0.0998 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0433 | Train Acc: 0.9905
 Site-MNIST                         | Train Loss: 0.0248 | Train Acc: 0.9932
 Site-USPS                          | Train Loss: 0.1806 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1438 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0909 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1782 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0735 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.0810 | Train Acc: 0.9762
 Site-SynthDigits                   | Train Loss: 1.1791 | Train Acc: 0.6755
 Site-SynthDigits                   | Train Loss: 0.9766 | Train Acc: 0.6777
 Site-SynthDigits                   | Train Loss: 0.7814 | Train Acc: 0.7536
 Site-MNIST_M                       | Train Loss: 1.4055 | Train Acc: 0.5359
 Site-MNIST_M                       | Train Loss: 1.2240 | Train Acc: 0.5627
 Site-SVHN                          | Train Loss: 2.0406 | Train Acc: 0.3050
Average Train Accuracy: 0.8617
 Site-MNIST                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3359 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2494 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1400 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0873 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0664 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1303 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.1055 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1837 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3503 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.3281 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2744 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1293 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9732 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2482 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9383 | Val  Acc: 0.7049
 Site-MNIST_M                       | Val  Loss: 1.5028 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.2131 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.6192 | Val  Acc: 0.3714
Average Valid Accuracy: 0.8547
============ Train epoch 43 ============
 Site-MNIST                         | Train Loss: 0.0323 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2123 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0421 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0461 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1038 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.0725 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0844 | Train Acc: 0.9692
 Site-MNIST                         | Train Loss: 0.0999 | Train Acc: 0.9707
 Site-MNIST                         | Train Loss: 0.0423 | Train Acc: 0.9946
 Site-MNIST                         | Train Loss: 0.0221 | Train Acc: 0.9962
 Site-USPS                          | Train Loss: 0.1854 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1433 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0948 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1605 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0770 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0842 | Train Acc: 0.9802
 Site-SynthDigits                   | Train Loss: 1.1570 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.9548 | Train Acc: 0.6850
 Site-SynthDigits                   | Train Loss: 0.7703 | Train Acc: 0.7536
 Site-MNIST_M                       | Train Loss: 1.3381 | Train Acc: 0.5635
 Site-MNIST_M                       | Train Loss: 1.1973 | Train Acc: 0.5872
 Site-SVHN                          | Train Loss: 1.9609 | Train Acc: 0.2979
Average Train Accuracy: 0.8664
 Site-MNIST                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3523 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2504 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1382 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0954 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0663 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1301 | Val  Acc: 0.9672
 Site-MNIST                         | Val  Loss: 0.0934 | Val  Acc: 0.9698
 Site-USPS                          | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1821 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3549 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3225 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2634 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1246 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9765 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2286 | Val  Acc: 0.7206
 Site-SynthDigits                   | Val  Loss: 0.9368 | Val  Acc: 0.6803
 Site-MNIST_M                       | Val  Loss: 1.4669 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1654 | Val  Acc: 0.6420
 Site-SVHN                          | Val  Loss: 1.5862 | Val  Acc: 0.3857
Average Valid Accuracy: 0.8554
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9672
 Best site-MNIST                     | Epoch:43 | Val Acc: 0.9698
 Best site-USPS                      | Epoch:43 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:43 | Val Acc: 0.8621
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9048
 Best site-USPS                      | Epoch:43 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.7206
 Best site-SynthDigits               | Epoch:43 | Val Acc: 0.6803
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.5778
 Best site-MNIST_M                   | Epoch:43 | Val Acc: 0.6420
 Best site-SVHN                      | Epoch:43 | Val Acc: 0.3857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 44 ============
 Site-MNIST                         | Train Loss: 0.0334 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2303 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0294 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0452 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0788 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.0728 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0851 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1016 | Train Acc: 0.9707
 Site-MNIST                         | Train Loss: 0.0439 | Train Acc: 0.9932
 Site-MNIST                         | Train Loss: 0.0205 | Train Acc: 0.9985
 Site-USPS                          | Train Loss: 0.1776 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0635 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.1050 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1579 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0724 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0732 | Train Acc: 0.9841
 Site-SynthDigits                   | Train Loss: 1.0586 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.9378 | Train Acc: 0.6996
 Site-SynthDigits                   | Train Loss: 0.7729 | Train Acc: 0.7576
 Site-MNIST_M                       | Train Loss: 1.3860 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.3195 | Train Acc: 0.5780
 Site-SVHN                          | Train Loss: 2.0090 | Train Acc: 0.3050
Average Train Accuracy: 0.8677
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3106 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2444 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1376 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0312 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0960 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0647 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1252 | Val  Acc: 0.9672
 Site-MNIST                         | Val  Loss: 0.0904 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1865 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3486 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3307 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2648 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1125 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9452 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.2232 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9334 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.4501 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1744 | Val  Acc: 0.6420
 Site-SVHN                          | Val  Loss: 1.5600 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8597
 Best site-MNIST                     | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9672
 Best site-MNIST                     | Epoch:44 | Val Acc: 0.9668
 Best site-USPS                      | Epoch:44 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8750
 Best site-USPS                      | Epoch:44 | Val Acc: 0.8793
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9143
 Best site-USPS                      | Epoch:44 | Val Acc: 0.9630
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7568
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:44 | Val Acc: 0.6885
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.5778
 Best site-MNIST_M                   | Epoch:44 | Val Acc: 0.6420
 Best site-SVHN                      | Epoch:44 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 45 ============
 Site-MNIST                         | Train Loss: 0.0326 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2427 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0355 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0374 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0821 | Train Acc: 0.9714
 Site-MNIST                         | Train Loss: 0.0679 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0786 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.0974 | Train Acc: 0.9682
 Site-MNIST                         | Train Loss: 0.0435 | Train Acc: 0.9918
 Site-MNIST                         | Train Loss: 0.0194 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.1729 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1247 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0851 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1534 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0722 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0714 | Train Acc: 0.9762
 Site-SynthDigits                   | Train Loss: 1.0947 | Train Acc: 0.6490
 Site-SynthDigits                   | Train Loss: 0.9076 | Train Acc: 0.7033
 Site-SynthDigits                   | Train Loss: 0.7544 | Train Acc: 0.7658
 Site-MNIST_M                       | Train Loss: 1.3808 | Train Acc: 0.5414
 Site-MNIST_M                       | Train Loss: 1.1266 | Train Acc: 0.5657
 Site-SVHN                          | Train Loss: 1.9848 | Train Acc: 0.3191
Average Train Accuracy: 0.8680
 Site-MNIST                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3265 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2636 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1464 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0902 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0636 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1247 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0926 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1865 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3323 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.3096 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2493 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1102 | Val  Acc: 0.9630
 Site-SynthDigits                   | Val  Loss: 0.9395 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.1920 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9226 | Val  Acc: 0.7049
 Site-MNIST_M                       | Val  Loss: 1.4580 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1737 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.6255 | Val  Acc: 0.4429
Average Valid Accuracy: 0.8595
============ Train epoch 46 ============
 Site-MNIST                         | Train Loss: 0.0348 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2181 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0431 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0459 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1972 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.0648 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0764 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1027 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0415 | Train Acc: 0.9918
 Site-MNIST                         | Train Loss: 0.0192 | Train Acc: 0.9985
 Site-USPS                          | Train Loss: 0.1741 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1035 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0887 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1536 | Train Acc: 0.9399
 Site-USPS                          | Train Loss: 0.0730 | Train Acc: 0.9714
 Site-USPS                          | Train Loss: 0.0763 | Train Acc: 0.9788
 Site-SynthDigits                   | Train Loss: 1.0747 | Train Acc: 0.6623
 Site-SynthDigits                   | Train Loss: 0.9799 | Train Acc: 0.7106
 Site-SynthDigits                   | Train Loss: 0.7610 | Train Acc: 0.7495
 Site-MNIST_M                       | Train Loss: 1.3559 | Train Acc: 0.5580
 Site-MNIST_M                       | Train Loss: 1.2139 | Train Acc: 0.5749
 Site-SVHN                          | Train Loss: 2.0259 | Train Acc: 0.2979
Average Train Accuracy: 0.8650
 Site-MNIST                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3768 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2713 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1495 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0849 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0620 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1315 | Val  Acc: 0.9563
 Site-MNIST                         | Val  Loss: 0.0971 | Val  Acc: 0.9607
 Site-USPS                          | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1960 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3561 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2928 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2377 | Val  Acc: 0.9048
 Site-USPS                          | Val  Loss: 0.1139 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9923 | Val  Acc: 0.7568
 Site-SynthDigits                   | Val  Loss: 1.2546 | Val  Acc: 0.7647
 Site-SynthDigits                   | Val  Loss: 0.9332 | Val  Acc: 0.7213
 Site-MNIST_M                       | Val  Loss: 1.4209 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1500 | Val  Acc: 0.6296
 Site-SVHN                          | Val  Loss: 1.6024 | Val  Acc: 0.4000
Average Valid Accuracy: 0.8590
============ Train epoch 47 ============
 Site-MNIST                         | Train Loss: 0.0286 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2643 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0283 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0354 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0879 | Train Acc: 0.9429
 Site-MNIST                         | Train Loss: 0.0745 | Train Acc: 0.9683
 Site-MNIST                         | Train Loss: 0.0779 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1036 | Train Acc: 0.9682
 Site-MNIST                         | Train Loss: 0.0404 | Train Acc: 0.9918
 Site-MNIST                         | Train Loss: 0.0194 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.1694 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.1193 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0755 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1460 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0737 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.0682 | Train Acc: 0.9775
 Site-SynthDigits                   | Train Loss: 1.0856 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.8552 | Train Acc: 0.6960
 Site-SynthDigits                   | Train Loss: 0.7636 | Train Acc: 0.7597
 Site-MNIST_M                       | Train Loss: 1.3533 | Train Acc: 0.5525
 Site-MNIST_M                       | Train Loss: 1.2392 | Train Acc: 0.5780
 Site-SVHN                          | Train Loss: 1.9714 | Train Acc: 0.3014
Average Train Accuracy: 0.8658
 Site-MNIST                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.3426 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2477 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1370 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0237 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0991 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0678 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1278 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0891 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1729 | Val  Acc: 0.8889
 Site-USPS                          | Val  Loss: 0.3372 | Val  Acc: 0.8438
 Site-USPS                          | Val  Loss: 0.3139 | Val  Acc: 0.8621
 Site-USPS                          | Val  Loss: 0.2535 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.0986 | Val  Acc: 0.9683
 Site-SynthDigits                   | Val  Loss: 0.9492 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2518 | Val  Acc: 0.7500
 Site-SynthDigits                   | Val  Loss: 0.9357 | Val  Acc: 0.6885
 Site-MNIST_M                       | Val  Loss: 1.4660 | Val  Acc: 0.5778
 Site-MNIST_M                       | Val  Loss: 1.1589 | Val  Acc: 0.6296
 Site-SVHN                          | Val  Loss: 1.5849 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8543
============ Train epoch 48 ============
 Site-MNIST                         | Train Loss: 0.0365 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2071 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0537 | Train Acc: 0.9524
 Site-MNIST                         | Train Loss: 0.0400 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.0904 | Train Acc: 0.9286
 Site-MNIST                         | Train Loss: 0.0711 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0838 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.1056 | Train Acc: 0.9682
 Site-MNIST                         | Train Loss: 0.0369 | Train Acc: 0.9932
 Site-MNIST                         | Train Loss: 0.0187 | Train Acc: 0.9970
 Site-USPS                          | Train Loss: 0.1748 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0923 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0810 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1508 | Train Acc: 0.9442
 Site-USPS                          | Train Loss: 0.0682 | Train Acc: 0.9762
 Site-USPS                          | Train Loss: 0.0690 | Train Acc: 0.9815
 Site-SynthDigits                   | Train Loss: 1.0611 | Train Acc: 0.6424
 Site-SynthDigits                   | Train Loss: 0.9202 | Train Acc: 0.7106
 Site-SynthDigits                   | Train Loss: 0.7461 | Train Acc: 0.7597
 Site-MNIST_M                       | Train Loss: 1.3576 | Train Acc: 0.5691
 Site-MNIST_M                       | Train Loss: 1.2690 | Train Acc: 0.5841
 Site-SVHN                          | Train Loss: 2.0122 | Train Acc: 0.3121
Average Train Accuracy: 0.8645
 Site-MNIST                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.4314 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.2824 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.1558 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0938 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0621 | Val  Acc: 0.9902
 Site-MNIST                         | Val  Loss: 0.1334 | Val  Acc: 0.9672
 Site-MNIST                         | Val  Loss: 0.0972 | Val  Acc: 0.9668
 Site-USPS                          | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1719 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3389 | Val  Acc: 0.9062
 Site-USPS                          | Val  Loss: 0.2979 | Val  Acc: 0.8966
 Site-USPS                          | Val  Loss: 0.2385 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1053 | Val  Acc: 0.9577
 Site-SynthDigits                   | Val  Loss: 0.9640 | Val  Acc: 0.7297
 Site-SynthDigits                   | Val  Loss: 1.2735 | Val  Acc: 0.7353
 Site-SynthDigits                   | Val  Loss: 0.9223 | Val  Acc: 0.7049
 Site-MNIST_M                       | Val  Loss: 1.4625 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1774 | Val  Acc: 0.6296
 Site-SVHN                          | Val  Loss: 1.5576 | Val  Acc: 0.4143
Average Valid Accuracy: 0.8602
 Best site-MNIST                     | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8000
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.8889
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9412
 Best site-MNIST                     | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9902
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9672
 Best site-MNIST                     | Epoch:48 | Val Acc: 0.9668
 Best site-USPS                      | Epoch:48 | Val Acc: 1.0000
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9444
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9062
 Best site-USPS                      | Epoch:48 | Val Acc: 0.8966
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9143
 Best site-USPS                      | Epoch:48 | Val Acc: 0.9577
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7297
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7353
 Best site-SynthDigits               | Epoch:48 | Val Acc: 0.7049
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.5556
 Best site-MNIST_M                   | Epoch:48 | Val Acc: 0.6296
 Best site-SVHN                      | Epoch:48 | Val Acc: 0.4143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_2/fedsam...
============ Train epoch 49 ============
 Site-MNIST                         | Train Loss: 0.0455 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.2053 | Train Acc: 0.9167
 Site-MNIST                         | Train Loss: 0.0362 | Train Acc: 1.0000
 Site-MNIST                         | Train Loss: 0.0381 | Train Acc: 0.9737
 Site-MNIST                         | Train Loss: 0.1181 | Train Acc: 0.9571
 Site-MNIST                         | Train Loss: 0.0708 | Train Acc: 0.9762
 Site-MNIST                         | Train Loss: 0.0758 | Train Acc: 0.9648
 Site-MNIST                         | Train Loss: 0.0986 | Train Acc: 0.9658
 Site-MNIST                         | Train Loss: 0.0361 | Train Acc: 0.9932
 Site-MNIST                         | Train Loss: 0.0160 | Train Acc: 0.9977
 Site-USPS                          | Train Loss: 0.1772 | Train Acc: 0.9500
 Site-USPS                          | Train Loss: 0.0607 | Train Acc: 0.9583
 Site-USPS                          | Train Loss: 0.0879 | Train Acc: 0.9612
 Site-USPS                          | Train Loss: 0.1522 | Train Acc: 0.9356
 Site-USPS                          | Train Loss: 0.0676 | Train Acc: 0.9738
 Site-USPS                          | Train Loss: 0.0690 | Train Acc: 0.9828
 Site-SynthDigits                   | Train Loss: 1.0493 | Train Acc: 0.6556
 Site-SynthDigits                   | Train Loss: 0.9035 | Train Acc: 0.6960
 Site-SynthDigits                   | Train Loss: 0.7380 | Train Acc: 0.7699
 Site-MNIST_M                       | Train Loss: 1.3726 | Train Acc: 0.5359
 Site-MNIST_M                       | Train Loss: 1.4250 | Train Acc: 0.5719
 Site-SVHN                          | Train Loss: 1.9884 | Train Acc: 0.3121
Average Train Accuracy: 0.8658
 Site-MNIST                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.5612 | Val  Acc: 0.8000
 Site-MNIST                         | Val  Loss: 0.3911 | Val  Acc: 0.8889
 Site-MNIST                         | Val  Loss: 0.2135 | Val  Acc: 0.9412
 Site-MNIST                         | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-MNIST                         | Val  Loss: 0.0877 | Val  Acc: 0.9821
 Site-MNIST                         | Val  Loss: 0.0643 | Val  Acc: 0.9804
 Site-MNIST                         | Val  Loss: 0.1262 | Val  Acc: 0.9617
 Site-MNIST                         | Val  Loss: 0.0976 | Val  Acc: 0.9637
 Site-USPS                          | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-USPS                          | Val  Loss: 0.1885 | Val  Acc: 0.9444
 Site-USPS                          | Val  Loss: 0.3207 | Val  Acc: 0.8750
 Site-USPS                          | Val  Loss: 0.2822 | Val  Acc: 0.8793
 Site-USPS                          | Val  Loss: 0.2295 | Val  Acc: 0.9143
 Site-USPS                          | Val  Loss: 0.1088 | Val  Acc: 0.9524
 Site-SynthDigits                   | Val  Loss: 0.9663 | Val  Acc: 0.6757
 Site-SynthDigits                   | Val  Loss: 1.2113 | Val  Acc: 0.6618
 Site-SynthDigits                   | Val  Loss: 0.9297 | Val  Acc: 0.6721
 Site-MNIST_M                       | Val  Loss: 1.4359 | Val  Acc: 0.5556
 Site-MNIST_M                       | Val  Loss: 1.1758 | Val  Acc: 0.6049
 Site-SVHN                          | Val  Loss: 1.6174 | Val  Acc: 0.4286
Average Valid Accuracy: 0.8492
===2023-07-29 19:37:08===
===2023-07-29 19:37:15===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     | Epoch:48 | Test Acc: 0.9573
 Test site-USPS                      | Epoch:48 | Test Acc: 0.9484
 Test site-SynthDigits               | Epoch:48 | Test Acc: 0.6536
 Test site-MNIST_M                   | Epoch:48 | Test Acc: 0.4444
 Test site-SVHN                      | Epoch:48 | Test Acc: 0.2796
MNIST: 0.9573, USPS: 0.9484, SynthDigits: 0.6536, MNIST_M: 0.4444, SVHN: 0.2796, 
Average Test Accuracy(group): 0.6567, Average Test Accuracy(individual): 0.8360,
domain std=0.2693, cluster std=-1.0000, individual std=0.2066, 
