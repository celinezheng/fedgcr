===2023-08-13 06:20:15===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[6, 4, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (1) | Train Loss: 2.0542 | Train Acc: 0.3185
 Site-Clipart                   (1) | Train Loss: 2.0516 | Train Acc: 0.2775
 Site-Real                      (0) | Train Loss: 1.9957 | Train Acc: 0.3885
 Site-Real                      (0) | Train Loss: 1.9982 | Train Acc: 0.3941
 Site-Painting                  (0) | Train Loss: 2.0162 | Train Acc: 0.3185
 Site-Painting                  (0) | Train Loss: 2.0399 | Train Acc: 0.3856
 Site-Sketch                    (1) | Train Loss: 1.9681 | Train Acc: 0.4076
 Site-Sketch                    (1) | Train Loss: 2.0061 | Train Acc: 0.3559
 Site-QuickDraw                 (2) | Train Loss: 2.2606 | Train Acc: 0.1465
 Site-QuickDraw                 (2) | Train Loss: 2.2423 | Train Acc: 0.1441
 Site-Infograph                 (0) | Train Loss: 2.2306 | Train Acc: 0.2102
 Site-Infograph                 (0) | Train Loss: 2.2058 | Train Acc: 0.2288
Average Train Accuracy: 0.2980
 Site-Clipart                   (1) | Val  Loss: 2.1665 | Val  Acc: 0.2286
 Site-Clipart                   (1) | Val  Loss: 2.0631 | Val  Acc: 0.2825
 Site-Real                      (0) | Val  Loss: 2.0213 | Val  Acc: 0.3619
 Site-Real                      (0) | Val  Loss: 1.9868 | Val  Acc: 0.3746
 Site-Painting                  (0) | Val  Loss: 2.0079 | Val  Acc: 0.4095
 Site-Painting                  (0) | Val  Loss: 2.0102 | Val  Acc: 0.3778
 Site-Sketch                    (1) | Val  Loss: 2.0760 | Val  Acc: 0.3333
 Site-Sketch                    (1) | Val  Loss: 2.0120 | Val  Acc: 0.3587
 Site-QuickDraw                 (2) | Val  Loss: 2.2398 | Val  Acc: 0.1810
 Site-QuickDraw                 (2) | Val  Loss: 2.2479 | Val  Acc: 0.1683
 Site-Infograph                 (0) | Val  Loss: 2.1920 | Val  Acc: 0.2476
 Site-Infograph                 (0) | Val  Loss: 2.1849 | Val  Acc: 0.2349
Average Valid Accuracy: 0.2966
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2286
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2825
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3619
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3746
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4095
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.3778
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.3587
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1810
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1683
 Best site-Infograph                (0)  | Epoch:0 | Val Acc: 0.2476
 Best site-Infograph                (0)  | Epoch:0 | Val Acc: 0.2349
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.7615 | Train Acc: 0.5414
 Site-Clipart                   (0) | Train Loss: 1.7324 | Train Acc: 0.5318
 Site-Real                      (2) | Train Loss: 1.6557 | Train Acc: 0.6815
 Site-Real                      (2) | Train Loss: 1.5300 | Train Acc: 0.7140
 Site-Painting                  (2) | Train Loss: 1.6230 | Train Acc: 0.6242
 Site-Painting                  (2) | Train Loss: 1.6356 | Train Acc: 0.6631
 Site-Sketch                    (0) | Train Loss: 1.6424 | Train Acc: 0.6624
 Site-Sketch                    (0) | Train Loss: 1.6853 | Train Acc: 0.5720
 Site-QuickDraw                 (1) | Train Loss: 2.1723 | Train Acc: 0.3631
 Site-QuickDraw                 (1) | Train Loss: 2.1661 | Train Acc: 0.3305
 Site-Infograph                 (0) | Train Loss: 2.0514 | Train Acc: 0.3949
 Site-Infograph                 (0) | Train Loss: 1.9724 | Train Acc: 0.3792
Average Train Accuracy: 0.5382
 Site-Clipart                   (0) | Val  Loss: 1.8323 | Val  Acc: 0.4667
 Site-Clipart                   (0) | Val  Loss: 1.7534 | Val  Acc: 0.5429
 Site-Real                      (2) | Val  Loss: 1.5448 | Val  Acc: 0.7238
 Site-Real                      (2) | Val  Loss: 1.5596 | Val  Acc: 0.7048
 Site-Painting                  (2) | Val  Loss: 1.5693 | Val  Acc: 0.6762
 Site-Painting                  (2) | Val  Loss: 1.6067 | Val  Acc: 0.6603
 Site-Sketch                    (0) | Val  Loss: 1.6733 | Val  Acc: 0.6381
 Site-Sketch                    (0) | Val  Loss: 1.6875 | Val  Acc: 0.5905
 Site-QuickDraw                 (1) | Val  Loss: 2.1861 | Val  Acc: 0.2286
 Site-QuickDraw                 (1) | Val  Loss: 2.1488 | Val  Acc: 0.3397
 Site-Infograph                 (0) | Val  Loss: 2.0677 | Val  Acc: 0.3143
 Site-Infograph                 (0) | Val  Loss: 2.0153 | Val  Acc: 0.3492
Average Valid Accuracy: 0.5196
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4667
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5429
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.7238
 Best site-Real                     (2)  | Epoch:1 | Val Acc: 0.7048
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.6762
 Best site-Painting                 (2)  | Epoch:1 | Val Acc: 0.6603
 Best site-Sketch                   (0)  | Epoch:1 | Val Acc: 0.6381
 Best site-Sketch                   (0)  | Epoch:1 | Val Acc: 0.5905
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2286
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.3397
 Best site-Infograph                (0)  | Epoch:1 | Val Acc: 0.3143
 Best site-Infograph                (0)  | Epoch:1 | Val Acc: 0.3492
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.5321 | Train Acc: 0.5987
 Site-Clipart                   (0) | Train Loss: 1.5026 | Train Acc: 0.6504
 Site-Real                      (2) | Train Loss: 1.3114 | Train Acc: 0.7898
 Site-Real                      (2) | Train Loss: 1.2105 | Train Acc: 0.8157
 Site-Painting                  (2) | Train Loss: 1.3310 | Train Acc: 0.7070
 Site-Painting                  (2) | Train Loss: 1.3361 | Train Acc: 0.7669
 Site-Sketch                    (0) | Train Loss: 1.4163 | Train Acc: 0.6561
 Site-Sketch                    (0) | Train Loss: 1.4218 | Train Acc: 0.6695
 Site-QuickDraw                 (1) | Train Loss: 2.0558 | Train Acc: 0.4204
 Site-QuickDraw                 (1) | Train Loss: 2.0367 | Train Acc: 0.3750
 Site-Infograph                 (0) | Train Loss: 1.9766 | Train Acc: 0.3503
 Site-Infograph                 (0) | Train Loss: 1.8355 | Train Acc: 0.4153
Average Train Accuracy: 0.6013
 Site-Clipart                   (0) | Val  Loss: 1.5626 | Val  Acc: 0.6381
 Site-Clipart                   (0) | Val  Loss: 1.5171 | Val  Acc: 0.6508
 Site-Real                      (2) | Val  Loss: 1.2281 | Val  Acc: 0.8095
 Site-Real                      (2) | Val  Loss: 1.2316 | Val  Acc: 0.8032
 Site-Painting                  (2) | Val  Loss: 1.2124 | Val  Acc: 0.8381
 Site-Painting                  (2) | Val  Loss: 1.2921 | Val  Acc: 0.7524
 Site-Sketch                    (0) | Val  Loss: 1.4182 | Val  Acc: 0.6190
 Site-Sketch                    (0) | Val  Loss: 1.4164 | Val  Acc: 0.6444
 Site-QuickDraw                 (1) | Val  Loss: 2.0743 | Val  Acc: 0.3429
 Site-QuickDraw                 (1) | Val  Loss: 2.0574 | Val  Acc: 0.3714
 Site-Infograph                 (0) | Val  Loss: 1.8733 | Val  Acc: 0.4095
 Site-Infograph                 (0) | Val  Loss: 1.8372 | Val  Acc: 0.4381
Average Valid Accuracy: 0.6098
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6381
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6508
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8095
 Best site-Real                     (2)  | Epoch:2 | Val Acc: 0.8032
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.8381
 Best site-Painting                 (2)  | Epoch:2 | Val Acc: 0.7524
 Best site-Sketch                   (0)  | Epoch:2 | Val Acc: 0.6190
 Best site-Sketch                   (0)  | Epoch:2 | Val Acc: 0.6444
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3429
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.3714
 Best site-Infograph                (0)  | Epoch:2 | Val Acc: 0.4095
 Best site-Infograph                (0)  | Epoch:2 | Val Acc: 0.4381
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.3135 | Train Acc: 0.6815
 Site-Clipart                   (0) | Train Loss: 1.2729 | Train Acc: 0.7203
 Site-Real                      (2) | Train Loss: 1.0865 | Train Acc: 0.8153
 Site-Real                      (2) | Train Loss: 0.9670 | Train Acc: 0.8517
 Site-Painting                  (2) | Train Loss: 1.1341 | Train Acc: 0.8025
 Site-Painting                  (2) | Train Loss: 1.1133 | Train Acc: 0.7966
 Site-Sketch                    (0) | Train Loss: 1.1637 | Train Acc: 0.7898
 Site-Sketch                    (0) | Train Loss: 1.1996 | Train Acc: 0.7288
 Site-QuickDraw                 (1) | Train Loss: 1.9414 | Train Acc: 0.4331
 Site-QuickDraw                 (1) | Train Loss: 1.9519 | Train Acc: 0.3792
 Site-Infograph                 (0) | Train Loss: 1.8210 | Train Acc: 0.4331
 Site-Infograph                 (0) | Train Loss: 1.7108 | Train Acc: 0.4767
Average Train Accuracy: 0.6591
 Site-Clipart                   (0) | Val  Loss: 1.3610 | Val  Acc: 0.7429
 Site-Clipart                   (0) | Val  Loss: 1.3062 | Val  Acc: 0.7111
 Site-Real                      (2) | Val  Loss: 0.9924 | Val  Acc: 0.8095
 Site-Real                      (2) | Val  Loss: 0.9814 | Val  Acc: 0.8540
 Site-Painting                  (2) | Val  Loss: 1.0081 | Val  Acc: 0.8381
 Site-Painting                  (2) | Val  Loss: 1.0570 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 1.2357 | Val  Acc: 0.7048
 Site-Sketch                    (0) | Val  Loss: 1.1905 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 1.9449 | Val  Acc: 0.3238
 Site-QuickDraw                 (1) | Val  Loss: 1.9179 | Val  Acc: 0.4095
 Site-Infograph                 (0) | Val  Loss: 1.7924 | Val  Acc: 0.4476
 Site-Infograph                 (0) | Val  Loss: 1.7270 | Val  Acc: 0.4571
Average Valid Accuracy: 0.6550
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7429
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.7111
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8095
 Best site-Real                     (2)  | Epoch:3 | Val Acc: 0.8540
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.8381
 Best site-Painting                 (2)  | Epoch:3 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:3 | Val Acc: 0.7048
 Best site-Sketch                   (0)  | Epoch:3 | Val Acc: 0.7333
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.3238
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.4095
 Best site-Infograph                (0)  | Epoch:3 | Val Acc: 0.4476
 Best site-Infograph                (0)  | Epoch:3 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (1) | Train Loss: 1.1146 | Train Acc: 0.7325
 Site-Clipart                   (1) | Train Loss: 1.0995 | Train Acc: 0.7712
 Site-Real                      (2) | Train Loss: 0.9047 | Train Acc: 0.8217
 Site-Real                      (2) | Train Loss: 0.8139 | Train Acc: 0.8750
 Site-Painting                  (2) | Train Loss: 1.0141 | Train Acc: 0.7771
 Site-Painting                  (2) | Train Loss: 0.9459 | Train Acc: 0.8051
 Site-Sketch                    (1) | Train Loss: 1.0010 | Train Acc: 0.7580
 Site-Sketch                    (1) | Train Loss: 1.0825 | Train Acc: 0.7352
 Site-QuickDraw                 (0) | Train Loss: 1.7918 | Train Acc: 0.5223
 Site-QuickDraw                 (0) | Train Loss: 1.7537 | Train Acc: 0.5169
 Site-Infograph                 (1) | Train Loss: 1.7463 | Train Acc: 0.4713
 Site-Infograph                 (1) | Train Loss: 1.5910 | Train Acc: 0.5106
Average Train Accuracy: 0.6914
 Site-Clipart                   (1) | Val  Loss: 1.2022 | Val  Acc: 0.7619
 Site-Clipart                   (1) | Val  Loss: 1.1430 | Val  Acc: 0.7651
 Site-Real                      (2) | Val  Loss: 0.8845 | Val  Acc: 0.8190
 Site-Real                      (2) | Val  Loss: 0.8106 | Val  Acc: 0.8794
 Site-Painting                  (2) | Val  Loss: 0.8474 | Val  Acc: 0.8571
 Site-Painting                  (2) | Val  Loss: 0.9076 | Val  Acc: 0.8349
 Site-Sketch                    (1) | Val  Loss: 1.0620 | Val  Acc: 0.7429
 Site-Sketch                    (1) | Val  Loss: 1.0283 | Val  Acc: 0.7556
 Site-QuickDraw                 (0) | Val  Loss: 1.8297 | Val  Acc: 0.4000
 Site-QuickDraw                 (0) | Val  Loss: 1.7520 | Val  Acc: 0.5206
 Site-Infograph                 (1) | Val  Loss: 1.6798 | Val  Acc: 0.4857
 Site-Infograph                 (1) | Val  Loss: 1.6366 | Val  Acc: 0.5111
Average Valid Accuracy: 0.6944
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.7619
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.7651
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8190
 Best site-Real                     (2)  | Epoch:4 | Val Acc: 0.8794
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8571
 Best site-Painting                 (2)  | Epoch:4 | Val Acc: 0.8349
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.7429
 Best site-Sketch                   (1)  | Epoch:4 | Val Acc: 0.7556
 Best site-QuickDraw                (0)  | Epoch:4 | Val Acc: 0.4000
 Best site-QuickDraw                (0)  | Epoch:4 | Val Acc: 0.5206
 Best site-Infograph                (1)  | Epoch:4 | Val Acc: 0.4857
 Best site-Infograph                (1)  | Epoch:4 | Val Acc: 0.5111
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[8, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (0) | Train Loss: 1.0243 | Train Acc: 0.7452
 Site-Clipart                   (0) | Train Loss: 0.9661 | Train Acc: 0.7860
 Site-Real                      (2) | Train Loss: 0.7823 | Train Acc: 0.8535
 Site-Real                      (2) | Train Loss: 0.6903 | Train Acc: 0.9110
 Site-Painting                  (0) | Train Loss: 0.8484 | Train Acc: 0.8280
 Site-Painting                  (0) | Train Loss: 0.8389 | Train Acc: 0.8242
 Site-Sketch                    (0) | Train Loss: 0.8475 | Train Acc: 0.8025
 Site-Sketch                    (0) | Train Loss: 0.8676 | Train Acc: 0.7669
 Site-QuickDraw                 (1) | Train Loss: 1.6337 | Train Acc: 0.5414
 Site-QuickDraw                 (1) | Train Loss: 1.6010 | Train Acc: 0.5614
 Site-Infograph                 (0) | Train Loss: 1.6577 | Train Acc: 0.4586
 Site-Infograph                 (0) | Train Loss: 1.5526 | Train Acc: 0.5339
Average Train Accuracy: 0.7177
 Site-Clipart                   (0) | Val  Loss: 1.0571 | Val  Acc: 0.7810
 Site-Clipart                   (0) | Val  Loss: 1.0106 | Val  Acc: 0.7619
 Site-Real                      (2) | Val  Loss: 0.7251 | Val  Acc: 0.8857
 Site-Real                      (2) | Val  Loss: 0.7066 | Val  Acc: 0.8889
 Site-Painting                  (0) | Val  Loss: 0.7354 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.8065 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.9377 | Val  Acc: 0.7714
 Site-Sketch                    (0) | Val  Loss: 0.9017 | Val  Acc: 0.7714
 Site-QuickDraw                 (1) | Val  Loss: 1.6308 | Val  Acc: 0.5429
 Site-QuickDraw                 (1) | Val  Loss: 1.5775 | Val  Acc: 0.5556
 Site-Infograph                 (0) | Val  Loss: 1.6103 | Val  Acc: 0.4571
 Site-Infograph                 (0) | Val  Loss: 1.5580 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7228
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7810
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.7619
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8857
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8889
 Best site-Painting                 (0)  | Epoch:5 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:5 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7714
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7714
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.5429
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.5556
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.4571
 Best site-Infograph                (0)  | Epoch:5 | Val Acc: 0.5238
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (2) | Train Loss: 0.9197 | Train Acc: 0.7898
 Site-Clipart                   (2) | Train Loss: 0.8909 | Train Acc: 0.7987
 Site-Real                      (1) | Train Loss: 0.6965 | Train Acc: 0.8790
 Site-Real                      (1) | Train Loss: 0.5800 | Train Acc: 0.9195
 Site-Painting                  (1) | Train Loss: 0.7885 | Train Acc: 0.8408
 Site-Painting                  (1) | Train Loss: 0.7467 | Train Acc: 0.8475
 Site-Sketch                    (2) | Train Loss: 0.7785 | Train Acc: 0.8025
 Site-Sketch                    (2) | Train Loss: 0.8044 | Train Acc: 0.7903
 Site-QuickDraw                 (0) | Train Loss: 1.4211 | Train Acc: 0.5669
 Site-QuickDraw                 (0) | Train Loss: 1.4831 | Train Acc: 0.5805
 Site-Infograph                 (2) | Train Loss: 1.5598 | Train Acc: 0.4841
 Site-Infograph                 (2) | Train Loss: 1.4456 | Train Acc: 0.5381
Average Train Accuracy: 0.7365
 Site-Clipart                   (2) | Val  Loss: 0.9859 | Val  Acc: 0.7333
 Site-Clipart                   (2) | Val  Loss: 0.9241 | Val  Acc: 0.7651
 Site-Real                      (1) | Val  Loss: 0.6741 | Val  Acc: 0.8667
 Site-Real                      (1) | Val  Loss: 0.6230 | Val  Acc: 0.8984
 Site-Painting                  (1) | Val  Loss: 0.6197 | Val  Acc: 0.8952
 Site-Painting                  (1) | Val  Loss: 0.7264 | Val  Acc: 0.8444
 Site-Sketch                    (2) | Val  Loss: 0.7806 | Val  Acc: 0.8190
 Site-Sketch                    (2) | Val  Loss: 0.8264 | Val  Acc: 0.7778
 Site-QuickDraw                 (0) | Val  Loss: 1.5290 | Val  Acc: 0.5143
 Site-QuickDraw                 (0) | Val  Loss: 1.4556 | Val  Acc: 0.5937
 Site-Infograph                 (2) | Val  Loss: 1.5195 | Val  Acc: 0.5333
 Site-Infograph                 (2) | Val  Loss: 1.4802 | Val  Acc: 0.5206
Average Valid Accuracy: 0.7302
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7333
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.7651
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.8667
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.8984
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8952
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8444
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.8190
 Best site-Sketch                   (2)  | Epoch:6 | Val Acc: 0.7778
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5143
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5937
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.5333
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.5206
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (2) | Train Loss: 0.7772 | Train Acc: 0.8217
 Site-Clipart                   (2) | Train Loss: 0.8168 | Train Acc: 0.8114
 Site-Real                      (2) | Train Loss: 0.5892 | Train Acc: 0.8854
 Site-Real                      (2) | Train Loss: 0.5411 | Train Acc: 0.9258
 Site-Painting                  (2) | Train Loss: 0.7666 | Train Acc: 0.7834
 Site-Painting                  (2) | Train Loss: 0.6996 | Train Acc: 0.8517
 Site-Sketch                    (0) | Train Loss: 0.6929 | Train Acc: 0.8535
 Site-Sketch                    (0) | Train Loss: 0.7597 | Train Acc: 0.8051
 Site-QuickDraw                 (1) | Train Loss: 1.2780 | Train Acc: 0.6242
 Site-QuickDraw                 (1) | Train Loss: 1.3478 | Train Acc: 0.6250
 Site-Infograph                 (0) | Train Loss: 1.5922 | Train Acc: 0.5223
 Site-Infograph                 (0) | Train Loss: 1.4153 | Train Acc: 0.5508
Average Train Accuracy: 0.7550
 Site-Clipart                   (2) | Val  Loss: 0.8500 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.8504 | Val  Acc: 0.7778
 Site-Real                      (2) | Val  Loss: 0.5925 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.5488 | Val  Acc: 0.9111
 Site-Painting                  (2) | Val  Loss: 0.5936 | Val  Acc: 0.8667
 Site-Painting                  (2) | Val  Loss: 0.6603 | Val  Acc: 0.8603
 Site-Sketch                    (0) | Val  Loss: 0.7925 | Val  Acc: 0.7619
 Site-Sketch                    (0) | Val  Loss: 0.7595 | Val  Acc: 0.8222
 Site-QuickDraw                 (1) | Val  Loss: 1.3735 | Val  Acc: 0.5714
 Site-QuickDraw                 (1) | Val  Loss: 1.3488 | Val  Acc: 0.6413
 Site-Infograph                 (0) | Val  Loss: 1.4494 | Val  Acc: 0.5238
 Site-Infograph                 (0) | Val  Loss: 1.4538 | Val  Acc: 0.5333
Average Valid Accuracy: 0.7495
 Best site-Clipart                  (2)  | Epoch:7 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:7 | Val Acc: 0.7778
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:7 | Val Acc: 0.9111
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8667
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8603
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7619
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.8222
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5714
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.6413
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph                (0)  | Epoch:7 | Val Acc: 0.5333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 6, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (2) | Train Loss: 0.7785 | Train Acc: 0.8153
 Site-Clipart                   (2) | Train Loss: 0.6983 | Train Acc: 0.8453
 Site-Real                      (1) | Train Loss: 0.5752 | Train Acc: 0.8917
 Site-Real                      (1) | Train Loss: 0.4866 | Train Acc: 0.9237
 Site-Painting                  (1) | Train Loss: 0.6517 | Train Acc: 0.8408
 Site-Painting                  (1) | Train Loss: 0.6087 | Train Acc: 0.8581
 Site-Sketch                    (2) | Train Loss: 0.6332 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.7021 | Train Acc: 0.8008
 Site-QuickDraw                 (0) | Train Loss: 1.3648 | Train Acc: 0.5796
 Site-QuickDraw                 (0) | Train Loss: 1.2783 | Train Acc: 0.6314
 Site-Infograph                 (2) | Train Loss: 1.4793 | Train Acc: 0.5414
 Site-Infograph                 (2) | Train Loss: 1.3715 | Train Acc: 0.5678
Average Train Accuracy: 0.7635
 Site-Clipart                   (2) | Val  Loss: 0.7776 | Val  Acc: 0.8000
 Site-Clipart                   (2) | Val  Loss: 0.7624 | Val  Acc: 0.7873
 Site-Real                      (1) | Val  Loss: 0.5247 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.5001 | Val  Acc: 0.9333
 Site-Painting                  (1) | Val  Loss: 0.5057 | Val  Acc: 0.8857
 Site-Painting                  (1) | Val  Loss: 0.6369 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.6943 | Val  Acc: 0.8476
 Site-Sketch                    (2) | Val  Loss: 0.7288 | Val  Acc: 0.8095
 Site-QuickDraw                 (0) | Val  Loss: 1.3361 | Val  Acc: 0.6095
 Site-QuickDraw                 (0) | Val  Loss: 1.2505 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.4659 | Val  Acc: 0.5238
 Site-Infograph                 (2) | Val  Loss: 1.3966 | Val  Acc: 0.5492
Average Valid Accuracy: 0.7630
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.8000
 Best site-Clipart                  (2)  | Epoch:8 | Val Acc: 0.7873
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:8 | Val Acc: 0.9333
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8857
 Best site-Painting                 (1)  | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.8476
 Best site-Sketch                   (2)  | Epoch:8 | Val Acc: 0.8095
 Best site-QuickDraw                (0)  | Epoch:8 | Val Acc: 0.6095
 Best site-QuickDraw                (0)  | Epoch:8 | Val Acc: 0.6476
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.5238
 Best site-Infograph                (2)  | Epoch:8 | Val Acc: 0.5492
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (0) | Train Loss: 0.7652 | Train Acc: 0.8089
 Site-Clipart                   (0) | Train Loss: 0.7514 | Train Acc: 0.8030
 Site-Real                      (0) | Train Loss: 0.5159 | Train Acc: 0.8854
 Site-Real                      (0) | Train Loss: 0.4283 | Train Acc: 0.9386
 Site-Painting                  (0) | Train Loss: 0.6695 | Train Acc: 0.8535
 Site-Painting                  (0) | Train Loss: 0.5927 | Train Acc: 0.8602
 Site-Sketch                    (2) | Train Loss: 0.6685 | Train Acc: 0.8089
 Site-Sketch                    (2) | Train Loss: 0.6423 | Train Acc: 0.8072
 Site-QuickDraw                 (1) | Train Loss: 1.2189 | Train Acc: 0.6369
 Site-QuickDraw                 (1) | Train Loss: 1.1879 | Train Acc: 0.6483
 Site-Infograph                 (2) | Train Loss: 1.4054 | Train Acc: 0.5414
 Site-Infograph                 (2) | Train Loss: 1.3115 | Train Acc: 0.5657
Average Train Accuracy: 0.7632
 Site-Clipart                   (0) | Val  Loss: 0.7384 | Val  Acc: 0.7905
 Site-Clipart                   (0) | Val  Loss: 0.7557 | Val  Acc: 0.7937
 Site-Real                      (0) | Val  Loss: 0.4881 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.4490 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.4915 | Val  Acc: 0.8952
 Site-Painting                  (0) | Val  Loss: 0.5776 | Val  Acc: 0.8825
 Site-Sketch                    (2) | Val  Loss: 0.7041 | Val  Acc: 0.8000
 Site-Sketch                    (2) | Val  Loss: 0.6463 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 1.2407 | Val  Acc: 0.6667
 Site-QuickDraw                 (1) | Val  Loss: 1.1632 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 1.3696 | Val  Acc: 0.5810
 Site-Infograph                 (2) | Val  Loss: 1.3899 | Val  Acc: 0.5333
Average Valid Accuracy: 0.7730
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.7905
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.7937
 Best site-Real                     (0)  | Epoch:9 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:9 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8952
 Best site-Painting                 (0)  | Epoch:9 | Val Acc: 0.8825
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.8000
 Best site-Sketch                   (2)  | Epoch:9 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6667
 Best site-QuickDraw                (1)  | Epoch:9 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:9 | Val Acc: 0.5810
 Best site-Infograph                (2)  | Epoch:9 | Val Acc: 0.5333
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (2) | Train Loss: 0.7208 | Train Acc: 0.8344
 Site-Clipart                   (2) | Train Loss: 0.6532 | Train Acc: 0.8284
 Site-Real                      (0) | Train Loss: 0.4926 | Train Acc: 0.9045
 Site-Real                      (0) | Train Loss: 0.3834 | Train Acc: 0.9386
 Site-Painting                  (0) | Train Loss: 0.5958 | Train Acc: 0.8726
 Site-Painting                  (0) | Train Loss: 0.5444 | Train Acc: 0.8729
 Site-Sketch                    (2) | Train Loss: 0.5632 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.6359 | Train Acc: 0.8263
 Site-QuickDraw                 (1) | Train Loss: 1.1118 | Train Acc: 0.6561
 Site-QuickDraw                 (1) | Train Loss: 1.1131 | Train Acc: 0.6864
 Site-Infograph                 (0) | Train Loss: 1.4962 | Train Acc: 0.5223
 Site-Infograph                 (0) | Train Loss: 1.3003 | Train Acc: 0.5911
Average Train Accuracy: 0.7838
 Site-Clipart                   (2) | Val  Loss: 0.7130 | Val  Acc: 0.8286
 Site-Clipart                   (2) | Val  Loss: 0.7302 | Val  Acc: 0.7683
 Site-Real                      (0) | Val  Loss: 0.4555 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.4072 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.4519 | Val  Acc: 0.8952
 Site-Painting                  (0) | Val  Loss: 0.5332 | Val  Acc: 0.8794
 Site-Sketch                    (2) | Val  Loss: 0.6395 | Val  Acc: 0.8000
 Site-Sketch                    (2) | Val  Loss: 0.6345 | Val  Acc: 0.8317
 Site-QuickDraw                 (1) | Val  Loss: 1.1122 | Val  Acc: 0.6762
 Site-QuickDraw                 (1) | Val  Loss: 1.1122 | Val  Acc: 0.6889
 Site-Infograph                 (0) | Val  Loss: 1.3636 | Val  Acc: 0.5619
 Site-Infograph                 (0) | Val  Loss: 1.3381 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7791
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.8286
 Best site-Clipart                  (2)  | Epoch:10 | Val Acc: 0.7683
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9238
 Best site-Real                     (0)  | Epoch:10 | Val Acc: 0.9397
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8952
 Best site-Painting                 (0)  | Epoch:10 | Val Acc: 0.8794
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8000
 Best site-Sketch                   (2)  | Epoch:10 | Val Acc: 0.8317
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6762
 Best site-QuickDraw                (1)  | Epoch:10 | Val Acc: 0.6889
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.5619
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (2) | Train Loss: 0.6824 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.6185 | Train Acc: 0.8390
 Site-Real                      (2) | Train Loss: 0.4719 | Train Acc: 0.9045
 Site-Real                      (2) | Train Loss: 0.3715 | Train Acc: 0.9343
 Site-Painting                  (2) | Train Loss: 0.5458 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.5331 | Train Acc: 0.8602
 Site-Sketch                    (0) | Train Loss: 0.5359 | Train Acc: 0.8280
 Site-Sketch                    (0) | Train Loss: 0.6278 | Train Acc: 0.8178
 Site-QuickDraw                 (1) | Train Loss: 1.0749 | Train Acc: 0.7006
 Site-QuickDraw                 (1) | Train Loss: 1.0414 | Train Acc: 0.7034
 Site-Infograph                 (0) | Train Loss: 1.4779 | Train Acc: 0.5478
 Site-Infograph                 (0) | Train Loss: 1.2737 | Train Acc: 0.6144
Average Train Accuracy: 0.7907
 Site-Clipart                   (2) | Val  Loss: 0.6403 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.6798 | Val  Acc: 0.8063
 Site-Real                      (2) | Val  Loss: 0.4570 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.3978 | Val  Acc: 0.9270
 Site-Painting                  (2) | Val  Loss: 0.4411 | Val  Acc: 0.8762
 Site-Painting                  (2) | Val  Loss: 0.5265 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.6092 | Val  Acc: 0.8095
 Site-Sketch                    (0) | Val  Loss: 0.6018 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 1.0911 | Val  Acc: 0.6952
 Site-QuickDraw                 (1) | Val  Loss: 1.0588 | Val  Acc: 0.7238
 Site-Infograph                 (0) | Val  Loss: 1.3747 | Val  Acc: 0.5714
 Site-Infograph                 (0) | Val  Loss: 1.3203 | Val  Acc: 0.5873
Average Valid Accuracy: 0.7873
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:11 | Val Acc: 0.8063
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.8952
 Best site-Real                     (2)  | Epoch:11 | Val Acc: 0.9270
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8762
 Best site-Painting                 (2)  | Epoch:11 | Val Acc: 0.8667
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8095
 Best site-Sketch                   (0)  | Epoch:11 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6952
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7238
 Best site-Infograph                (0)  | Epoch:11 | Val Acc: 0.5714
 Best site-Infograph                (0)  | Epoch:11 | Val Acc: 0.5873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 12 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.6379 | Train Acc: 0.8471
 Site-Clipart                   (2) | Train Loss: 0.5983 | Train Acc: 0.8284
 Site-Real                      (2) | Train Loss: 0.4489 | Train Acc: 0.8981
 Site-Real                      (2) | Train Loss: 0.3569 | Train Acc: 0.9322
 Site-Painting                  (0) | Train Loss: 0.5176 | Train Acc: 0.8662
 Site-Painting                  (0) | Train Loss: 0.5155 | Train Acc: 0.8623
 Site-Sketch                    (2) | Train Loss: 0.5338 | Train Acc: 0.8535
 Site-Sketch                    (2) | Train Loss: 0.6222 | Train Acc: 0.8030
 Site-QuickDraw                 (1) | Train Loss: 1.0402 | Train Acc: 0.7134
 Site-QuickDraw                 (1) | Train Loss: 1.0198 | Train Acc: 0.7225
 Site-Infograph                 (0) | Train Loss: 1.3553 | Train Acc: 0.5605
 Site-Infograph                 (0) | Train Loss: 1.2276 | Train Acc: 0.5975
Average Train Accuracy: 0.7904
 Site-Clipart                   (2) | Val  Loss: 0.6848 | Val  Acc: 0.8286
 Site-Clipart                   (2) | Val  Loss: 0.6791 | Val  Acc: 0.8032
 Site-Real                      (2) | Val  Loss: 0.4483 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.3770 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.4132 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.4750 | Val  Acc: 0.8762
 Site-Sketch                    (2) | Val  Loss: 0.5926 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.6160 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 1.0277 | Val  Acc: 0.6952
 Site-QuickDraw                 (1) | Val  Loss: 0.9858 | Val  Acc: 0.7460
 Site-Infograph                 (0) | Val  Loss: 1.3321 | Val  Acc: 0.5619
 Site-Infograph                 (0) | Val  Loss: 1.2559 | Val  Acc: 0.5746
Average Valid Accuracy: 0.7907
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8286
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8032
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9048
 Best site-Real                     (2)  | Epoch:12 | Val Acc: 0.9270
 Best site-Painting                 (0)  | Epoch:12 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:12 | Val Acc: 0.8762
 Best site-Sketch                   (2)  | Epoch:12 | Val Acc: 0.8286
 Best site-Sketch                   (2)  | Epoch:12 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6952
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.7460
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.5619
 Best site-Infograph                (0)  | Epoch:12 | Val Acc: 0.5746
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (2) | Train Loss: 0.5887 | Train Acc: 0.8471
 Site-Clipart                   (2) | Train Loss: 0.6250 | Train Acc: 0.8263
 Site-Real                      (1) | Train Loss: 0.4074 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.3394 | Train Acc: 0.9343
 Site-Painting                  (1) | Train Loss: 0.4744 | Train Acc: 0.8726
 Site-Painting                  (1) | Train Loss: 0.4654 | Train Acc: 0.8750
 Site-Sketch                    (2) | Train Loss: 0.5194 | Train Acc: 0.8471
 Site-Sketch                    (2) | Train Loss: 0.5790 | Train Acc: 0.8136
 Site-QuickDraw                 (0) | Train Loss: 1.0148 | Train Acc: 0.6815
 Site-QuickDraw                 (0) | Train Loss: 0.9818 | Train Acc: 0.7013
 Site-Infograph                 (1) | Train Loss: 1.3919 | Train Acc: 0.5796
 Site-Infograph                 (1) | Train Loss: 1.1842 | Train Acc: 0.6144
Average Train Accuracy: 0.7925
 Site-Clipart                   (2) | Val  Loss: 0.6321 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.6562 | Val  Acc: 0.8063
 Site-Real                      (1) | Val  Loss: 0.3876 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.3334 | Val  Acc: 0.9365
 Site-Painting                  (1) | Val  Loss: 0.4182 | Val  Acc: 0.9048
 Site-Painting                  (1) | Val  Loss: 0.4439 | Val  Acc: 0.8921
 Site-Sketch                    (2) | Val  Loss: 0.5540 | Val  Acc: 0.8476
 Site-Sketch                    (2) | Val  Loss: 0.5733 | Val  Acc: 0.8381
 Site-QuickDraw                 (0) | Val  Loss: 1.0112 | Val  Acc: 0.7143
 Site-QuickDraw                 (0) | Val  Loss: 0.9613 | Val  Acc: 0.7270
 Site-Infograph                 (1) | Val  Loss: 1.2727 | Val  Acc: 0.5714
 Site-Infograph                 (1) | Val  Loss: 1.2519 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8011
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:13 | Val Acc: 0.8063
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9365
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.9048
 Best site-Painting                 (1)  | Epoch:13 | Val Acc: 0.8921
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8476
 Best site-Sketch                   (2)  | Epoch:13 | Val Acc: 0.8381
 Best site-QuickDraw                (0)  | Epoch:13 | Val Acc: 0.7143
 Best site-QuickDraw                (0)  | Epoch:13 | Val Acc: 0.7270
 Best site-Infograph                (1)  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph                (1)  | Epoch:13 | Val Acc: 0.6032
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (2) | Train Loss: 0.5932 | Train Acc: 0.8280
 Site-Clipart                   (2) | Train Loss: 0.5460 | Train Acc: 0.8475
 Site-Real                      (1) | Train Loss: 0.3718 | Train Acc: 0.9108
 Site-Real                      (1) | Train Loss: 0.3304 | Train Acc: 0.9386
 Site-Painting                  (1) | Train Loss: 0.4740 | Train Acc: 0.8790
 Site-Painting                  (1) | Train Loss: 0.4485 | Train Acc: 0.8877
 Site-Sketch                    (2) | Train Loss: 0.4555 | Train Acc: 0.8726
 Site-Sketch                    (2) | Train Loss: 0.5646 | Train Acc: 0.8347
 Site-QuickDraw                 (0) | Train Loss: 0.9232 | Train Acc: 0.7134
 Site-QuickDraw                 (0) | Train Loss: 0.9178 | Train Acc: 0.7627
 Site-Infograph                 (1) | Train Loss: 1.3584 | Train Acc: 0.5669
 Site-Infograph                 (1) | Train Loss: 1.1827 | Train Acc: 0.6144
Average Train Accuracy: 0.8047
 Site-Clipart                   (2) | Val  Loss: 0.6193 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6222 | Val  Acc: 0.8190
 Site-Real                      (1) | Val  Loss: 0.3680 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3274 | Val  Acc: 0.9397
 Site-Painting                  (1) | Val  Loss: 0.3658 | Val  Acc: 0.8952
 Site-Painting                  (1) | Val  Loss: 0.4549 | Val  Acc: 0.8762
 Site-Sketch                    (2) | Val  Loss: 0.5768 | Val  Acc: 0.8095
 Site-Sketch                    (2) | Val  Loss: 0.5417 | Val  Acc: 0.8603
 Site-QuickDraw                 (0) | Val  Loss: 0.9673 | Val  Acc: 0.6952
 Site-QuickDraw                 (0) | Val  Loss: 0.9125 | Val  Acc: 0.7492
 Site-Infograph                 (1) | Val  Loss: 1.3280 | Val  Acc: 0.5905
 Site-Infograph                 (1) | Val  Loss: 1.2371 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8008
============ Train epoch 15 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (2) | Train Loss: 0.6022 | Train Acc: 0.8599
 Site-Clipart                   (2) | Train Loss: 0.5456 | Train Acc: 0.8263
 Site-Real                      (0) | Train Loss: 0.3729 | Train Acc: 0.9108
 Site-Real                      (0) | Train Loss: 0.2963 | Train Acc: 0.9449
 Site-Painting                  (0) | Train Loss: 0.4983 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.4693 | Train Acc: 0.8814
 Site-Sketch                    (2) | Train Loss: 0.4519 | Train Acc: 0.8917
 Site-Sketch                    (2) | Train Loss: 0.5487 | Train Acc: 0.8242
 Site-QuickDraw                 (1) | Train Loss: 0.9296 | Train Acc: 0.7325
 Site-QuickDraw                 (1) | Train Loss: 0.8866 | Train Acc: 0.7797
 Site-Infograph                 (0) | Train Loss: 1.3897 | Train Acc: 0.6242
 Site-Infograph                 (0) | Train Loss: 1.1647 | Train Acc: 0.6208
Average Train Accuracy: 0.8146
 Site-Clipart                   (2) | Val  Loss: 0.5618 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.5841 | Val  Acc: 0.8222
 Site-Real                      (0) | Val  Loss: 0.3616 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.3169 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3576 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.4324 | Val  Acc: 0.8921
 Site-Sketch                    (2) | Val  Loss: 0.5181 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.5589 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.9352 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.8768 | Val  Acc: 0.7873
 Site-Infograph                 (0) | Val  Loss: 1.2714 | Val  Acc: 0.5619
 Site-Infograph                 (0) | Val  Loss: 1.2252 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8032
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8381
 Best site-Clipart                  (2)  | Epoch:15 | Val Acc: 0.8222
 Best site-Real                     (0)  | Epoch:15 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:15 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.9048
 Best site-Painting                 (0)  | Epoch:15 | Val Acc: 0.8921
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8286
 Best site-Sketch                   (2)  | Epoch:15 | Val Acc: 0.8349
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7048
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7873
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.5619
 Best site-Infograph                (0)  | Epoch:15 | Val Acc: 0.5873
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.5879 | Train Acc: 0.8535
 Site-Clipart                   (0) | Train Loss: 0.5524 | Train Acc: 0.8347
 Site-Real                      (0) | Train Loss: 0.3513 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.3109 | Train Acc: 0.9407
 Site-Painting                  (2) | Train Loss: 0.4791 | Train Acc: 0.8535
 Site-Painting                  (2) | Train Loss: 0.4261 | Train Acc: 0.8919
 Site-Sketch                    (0) | Train Loss: 0.4866 | Train Acc: 0.8344
 Site-Sketch                    (0) | Train Loss: 0.5604 | Train Acc: 0.8242
 Site-QuickDraw                 (1) | Train Loss: 0.8700 | Train Acc: 0.7070
 Site-QuickDraw                 (1) | Train Loss: 0.8761 | Train Acc: 0.7288
 Site-Infograph                 (2) | Train Loss: 1.3390 | Train Acc: 0.5605
 Site-Infograph                 (2) | Train Loss: 1.1727 | Train Acc: 0.6356
Average Train Accuracy: 0.7990
 Site-Clipart                   (0) | Val  Loss: 0.5601 | Val  Acc: 0.8381
 Site-Clipart                   (0) | Val  Loss: 0.5990 | Val  Acc: 0.8063
 Site-Real                      (0) | Val  Loss: 0.3616 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.3204 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.3402 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.4112 | Val  Acc: 0.8921
 Site-Sketch                    (0) | Val  Loss: 0.5480 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.5169 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.8942 | Val  Acc: 0.7524
 Site-QuickDraw                 (1) | Val  Loss: 0.8373 | Val  Acc: 0.7651
 Site-Infograph                 (2) | Val  Loss: 1.2716 | Val  Acc: 0.5619
 Site-Infograph                 (2) | Val  Loss: 1.2140 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8079
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8381
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8063
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:16 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:16 | Val Acc: 0.8921
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.8286
 Best site-Sketch                   (0)  | Epoch:16 | Val Acc: 0.8444
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7524
 Best site-QuickDraw                (1)  | Epoch:16 | Val Acc: 0.7651
 Best site-Infograph                (2)  | Epoch:16 | Val Acc: 0.5619
 Best site-Infograph                (2)  | Epoch:16 | Val Acc: 0.6063
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 17 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (2) | Train Loss: 0.6437 | Train Acc: 0.8344
 Site-Clipart                   (2) | Train Loss: 0.4938 | Train Acc: 0.8432
 Site-Real                      (2) | Train Loss: 0.3722 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2677 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.4725 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.4062 | Train Acc: 0.8962
 Site-Sketch                    (2) | Train Loss: 0.5474 | Train Acc: 0.8280
 Site-Sketch                    (2) | Train Loss: 0.4976 | Train Acc: 0.8496
 Site-QuickDraw                 (1) | Train Loss: 0.8664 | Train Acc: 0.7516
 Site-QuickDraw                 (1) | Train Loss: 0.8540 | Train Acc: 0.7754
 Site-Infograph                 (0) | Train Loss: 1.3456 | Train Acc: 0.5478
 Site-Infograph                 (0) | Train Loss: 1.1255 | Train Acc: 0.6335
Average Train Accuracy: 0.8098
 Site-Clipart                   (2) | Val  Loss: 0.5356 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.5901 | Val  Acc: 0.8190
 Site-Real                      (2) | Val  Loss: 0.3693 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2901 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.3216 | Val  Acc: 0.9238
 Site-Painting                  (0) | Val  Loss: 0.4285 | Val  Acc: 0.8921
 Site-Sketch                    (2) | Val  Loss: 0.5562 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.5117 | Val  Acc: 0.8508
 Site-QuickDraw                 (1) | Val  Loss: 0.9135 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.8401 | Val  Acc: 0.7873
 Site-Infograph                 (0) | Val  Loss: 1.2413 | Val  Acc: 0.6571
 Site-Infograph                 (0) | Val  Loss: 1.1583 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8238
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:17 | Val Acc: 0.8190
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9492
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.9238
 Best site-Painting                 (0)  | Epoch:17 | Val Acc: 0.8921
 Best site-Sketch                   (2)  | Epoch:17 | Val Acc: 0.8571
 Best site-Sketch                   (2)  | Epoch:17 | Val Acc: 0.8508
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7333
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.7873
 Best site-Infograph                (0)  | Epoch:17 | Val Acc: 0.6571
 Best site-Infograph                (0)  | Epoch:17 | Val Acc: 0.6159
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[6, 4, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (1) | Train Loss: 0.6088 | Train Acc: 0.8662
 Site-Clipart                   (1) | Train Loss: 0.5326 | Train Acc: 0.8517
 Site-Real                      (0) | Train Loss: 0.3208 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.2731 | Train Acc: 0.9513
 Site-Painting                  (0) | Train Loss: 0.4538 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.3826 | Train Acc: 0.9131
 Site-Sketch                    (1) | Train Loss: 0.4905 | Train Acc: 0.8535
 Site-Sketch                    (1) | Train Loss: 0.5493 | Train Acc: 0.8178
 Site-QuickDraw                 (2) | Train Loss: 0.8781 | Train Acc: 0.7006
 Site-QuickDraw                 (2) | Train Loss: 0.8298 | Train Acc: 0.7839
 Site-Infograph                 (0) | Train Loss: 1.3454 | Train Acc: 0.5669
 Site-Infograph                 (0) | Train Loss: 1.0963 | Train Acc: 0.6483
Average Train Accuracy: 0.8130
 Site-Clipart                   (1) | Val  Loss: 0.5179 | Val  Acc: 0.8571
 Site-Clipart                   (1) | Val  Loss: 0.5785 | Val  Acc: 0.8159
 Site-Real                      (0) | Val  Loss: 0.3043 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.3033 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.3111 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.3838 | Val  Acc: 0.9206
 Site-Sketch                    (1) | Val  Loss: 0.5542 | Val  Acc: 0.8190
 Site-Sketch                    (1) | Val  Loss: 0.5045 | Val  Acc: 0.8540
 Site-QuickDraw                 (2) | Val  Loss: 0.8302 | Val  Acc: 0.7714
 Site-QuickDraw                 (2) | Val  Loss: 0.8122 | Val  Acc: 0.7937
 Site-Infograph                 (0) | Val  Loss: 1.2613 | Val  Acc: 0.6286
 Site-Infograph                 (0) | Val  Loss: 1.1874 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8217
============ Train epoch 19 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (2) | Train Loss: 0.5453 | Train Acc: 0.8535
 Site-Clipart                   (2) | Train Loss: 0.4969 | Train Acc: 0.8517
 Site-Real                      (1) | Train Loss: 0.3167 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.2422 | Train Acc: 0.9534
 Site-Painting                  (1) | Train Loss: 0.4814 | Train Acc: 0.8726
 Site-Painting                  (1) | Train Loss: 0.3847 | Train Acc: 0.8898
 Site-Sketch                    (2) | Train Loss: 0.4677 | Train Acc: 0.8854
 Site-Sketch                    (2) | Train Loss: 0.5062 | Train Acc: 0.8581
 Site-QuickDraw                 (0) | Train Loss: 0.8200 | Train Acc: 0.7898
 Site-QuickDraw                 (0) | Train Loss: 0.7903 | Train Acc: 0.7754
 Site-Infograph                 (1) | Train Loss: 1.3676 | Train Acc: 0.5669
 Site-Infograph                 (1) | Train Loss: 1.0660 | Train Acc: 0.6462
Average Train Accuracy: 0.8217
 Site-Clipart                   (2) | Val  Loss: 0.5429 | Val  Acc: 0.8381
 Site-Clipart                   (2) | Val  Loss: 0.5635 | Val  Acc: 0.8222
 Site-Real                      (1) | Val  Loss: 0.3108 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2782 | Val  Acc: 0.9460
 Site-Painting                  (1) | Val  Loss: 0.3111 | Val  Acc: 0.9238
 Site-Painting                  (1) | Val  Loss: 0.3841 | Val  Acc: 0.9111
 Site-Sketch                    (2) | Val  Loss: 0.5032 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.4930 | Val  Acc: 0.8444
 Site-QuickDraw                 (0) | Val  Loss: 0.9231 | Val  Acc: 0.7048
 Site-QuickDraw                 (0) | Val  Loss: 0.7775 | Val  Acc: 0.7810
 Site-Infograph                 (1) | Val  Loss: 1.1659 | Val  Acc: 0.6190
 Site-Infograph                 (1) | Val  Loss: 1.1565 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8122
============ Train epoch 20 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (0) | Train Loss: 0.5391 | Train Acc: 0.8535
 Site-Clipart                   (0) | Train Loss: 0.4946 | Train Acc: 0.8453
 Site-Real                      (2) | Train Loss: 0.3482 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2512 | Train Acc: 0.9513
 Site-Painting                  (2) | Train Loss: 0.4111 | Train Acc: 0.8917
 Site-Painting                  (2) | Train Loss: 0.3879 | Train Acc: 0.9068
 Site-Sketch                    (0) | Train Loss: 0.4901 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.5355 | Train Acc: 0.8411
 Site-QuickDraw                 (1) | Train Loss: 0.8868 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.8053 | Train Acc: 0.7691
 Site-Infograph                 (2) | Train Loss: 1.2723 | Train Acc: 0.5605
 Site-Infograph                 (2) | Train Loss: 1.0866 | Train Acc: 0.6547
Average Train Accuracy: 0.8185
 Site-Clipart                   (0) | Val  Loss: 0.4856 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.5428 | Val  Acc: 0.8444
 Site-Real                      (2) | Val  Loss: 0.3002 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2874 | Val  Acc: 0.9302
 Site-Painting                  (2) | Val  Loss: 0.2828 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.3601 | Val  Acc: 0.9206
 Site-Sketch                    (0) | Val  Loss: 0.5257 | Val  Acc: 0.8286
 Site-Sketch                    (0) | Val  Loss: 0.4962 | Val  Acc: 0.8444
 Site-QuickDraw                 (1) | Val  Loss: 0.8086 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 0.7816 | Val  Acc: 0.7810
 Site-Infograph                 (2) | Val  Loss: 1.2015 | Val  Acc: 0.5905
 Site-Infograph                 (2) | Val  Loss: 1.1210 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8209
============ Train epoch 21 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.5139 | Train Acc: 0.8535
 Site-Clipart                   (0) | Train Loss: 0.4656 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.3419 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2388 | Train Acc: 0.9534
 Site-Painting                  (2) | Train Loss: 0.4252 | Train Acc: 0.8917
 Site-Painting                  (2) | Train Loss: 0.3866 | Train Acc: 0.8983
 Site-Sketch                    (0) | Train Loss: 0.4751 | Train Acc: 0.8726
 Site-Sketch                    (0) | Train Loss: 0.5143 | Train Acc: 0.8581
 Site-QuickDraw                 (1) | Train Loss: 0.7855 | Train Acc: 0.7771
 Site-QuickDraw                 (1) | Train Loss: 0.7575 | Train Acc: 0.7966
 Site-Infograph                 (2) | Train Loss: 1.4002 | Train Acc: 0.5669
 Site-Infograph                 (2) | Train Loss: 1.0097 | Train Acc: 0.6674
Average Train Accuracy: 0.8271
 Site-Clipart                   (0) | Val  Loss: 0.5163 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.5748 | Val  Acc: 0.8190
 Site-Real                      (2) | Val  Loss: 0.2842 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2605 | Val  Acc: 0.9556
 Site-Painting                  (2) | Val  Loss: 0.2802 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3676 | Val  Acc: 0.9079
 Site-Sketch                    (0) | Val  Loss: 0.4534 | Val  Acc: 0.8571
 Site-Sketch                    (0) | Val  Loss: 0.4986 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.8315 | Val  Acc: 0.7429
 Site-QuickDraw                 (1) | Val  Loss: 0.7602 | Val  Acc: 0.7968
 Site-Infograph                 (2) | Val  Loss: 1.1728 | Val  Acc: 0.6190
 Site-Infograph                 (2) | Val  Loss: 1.1200 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8270
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8190
 Best site-Real                     (2)  | Epoch:21 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:21 | Val Acc: 0.9556
 Best site-Painting                 (2)  | Epoch:21 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:21 | Val Acc: 0.9079
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8571
 Best site-Sketch                   (0)  | Epoch:21 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7429
 Best site-QuickDraw                (1)  | Epoch:21 | Val Acc: 0.7968
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.6190
 Best site-Infograph                (2)  | Epoch:21 | Val Acc: 0.6254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (2) | Train Loss: 0.5487 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.4506 | Train Acc: 0.8729
 Site-Real                      (1) | Train Loss: 0.3011 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.2502 | Train Acc: 0.9449
 Site-Painting                  (1) | Train Loss: 0.3978 | Train Acc: 0.8854
 Site-Painting                  (1) | Train Loss: 0.3785 | Train Acc: 0.9047
 Site-Sketch                    (2) | Train Loss: 0.4733 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.4886 | Train Acc: 0.8496
 Site-QuickDraw                 (0) | Train Loss: 0.7847 | Train Acc: 0.7452
 Site-QuickDraw                 (0) | Train Loss: 0.7568 | Train Acc: 0.7860
 Site-Infograph                 (1) | Train Loss: 1.2786 | Train Acc: 0.5987
 Site-Infograph                 (1) | Train Loss: 1.0708 | Train Acc: 0.6653
Average Train Accuracy: 0.8257
 Site-Clipart                   (2) | Val  Loss: 0.4725 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.5439 | Val  Acc: 0.8286
 Site-Real                      (1) | Val  Loss: 0.2605 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2438 | Val  Acc: 0.9587
 Site-Painting                  (1) | Val  Loss: 0.2579 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.3343 | Val  Acc: 0.9206
 Site-Sketch                    (2) | Val  Loss: 0.4541 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4628 | Val  Acc: 0.8698
 Site-QuickDraw                 (0) | Val  Loss: 0.7847 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 0.7666 | Val  Acc: 0.7937
 Site-Infograph                 (1) | Val  Loss: 1.2023 | Val  Acc: 0.6190
 Site-Infograph                 (1) | Val  Loss: 1.1100 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8384
 Best site-Clipart                  (2)  | Epoch:22 | Val Acc: 0.8476
 Best site-Clipart                  (2)  | Epoch:22 | Val Acc: 0.8286
 Best site-Real                     (1)  | Epoch:22 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:22 | Val Acc: 0.9587
 Best site-Painting                 (1)  | Epoch:22 | Val Acc: 0.9429
 Best site-Painting                 (1)  | Epoch:22 | Val Acc: 0.9206
 Best site-Sketch                   (2)  | Epoch:22 | Val Acc: 0.9048
 Best site-Sketch                   (2)  | Epoch:22 | Val Acc: 0.8698
 Best site-QuickDraw                (0)  | Epoch:22 | Val Acc: 0.8000
 Best site-QuickDraw                (0)  | Epoch:22 | Val Acc: 0.7937
 Best site-Infograph                (1)  | Epoch:22 | Val Acc: 0.6190
 Best site-Infograph                (1)  | Epoch:22 | Val Acc: 0.6222
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 23 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.4642 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.4704 | Train Acc: 0.8581
 Site-Real                      (2) | Train Loss: 0.3475 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.2288 | Train Acc: 0.9555
 Site-Painting                  (0) | Train Loss: 0.4197 | Train Acc: 0.8535
 Site-Painting                  (0) | Train Loss: 0.3534 | Train Acc: 0.9216
 Site-Sketch                    (2) | Train Loss: 0.4365 | Train Acc: 0.8599
 Site-Sketch                    (2) | Train Loss: 0.4689 | Train Acc: 0.8390
 Site-QuickDraw                 (1) | Train Loss: 0.7851 | Train Acc: 0.7389
 Site-QuickDraw                 (1) | Train Loss: 0.7395 | Train Acc: 0.7945
 Site-Infograph                 (0) | Train Loss: 1.2539 | Train Acc: 0.6051
 Site-Infograph                 (0) | Train Loss: 0.9847 | Train Acc: 0.6716
Average Train Accuracy: 0.8250
 Site-Clipart                   (2) | Val  Loss: 0.4938 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.5407 | Val  Acc: 0.8286
 Site-Real                      (2) | Val  Loss: 0.2760 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.2879 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2678 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3455 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.4917 | Val  Acc: 0.8571
 Site-Sketch                    (2) | Val  Loss: 0.4768 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.7597 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.7507 | Val  Acc: 0.7968
 Site-Infograph                 (0) | Val  Loss: 1.1626 | Val  Acc: 0.6190
 Site-Infograph                 (0) | Val  Loss: 1.1073 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8323
============ Train epoch 24 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (0) | Train Loss: 0.5261 | Train Acc: 0.8726
 Site-Clipart                   (0) | Train Loss: 0.4710 | Train Acc: 0.8771
 Site-Real                      (0) | Train Loss: 0.3211 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2164 | Train Acc: 0.9534
 Site-Painting                  (2) | Train Loss: 0.3929 | Train Acc: 0.8726
 Site-Painting                  (2) | Train Loss: 0.3512 | Train Acc: 0.9110
 Site-Sketch                    (0) | Train Loss: 0.4630 | Train Acc: 0.8280
 Site-Sketch                    (0) | Train Loss: 0.4655 | Train Acc: 0.8453
 Site-QuickDraw                 (1) | Train Loss: 0.8759 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.7344 | Train Acc: 0.8051
 Site-Infograph                 (2) | Train Loss: 1.2726 | Train Acc: 0.6115
 Site-Infograph                 (2) | Train Loss: 1.0210 | Train Acc: 0.6589
Average Train Accuracy: 0.8275
 Site-Clipart                   (0) | Val  Loss: 0.4686 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.5299 | Val  Acc: 0.8540
 Site-Real                      (0) | Val  Loss: 0.3085 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2724 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.2579 | Val  Acc: 0.9619
 Site-Painting                  (2) | Val  Loss: 0.3460 | Val  Acc: 0.9238
 Site-Sketch                    (0) | Val  Loss: 0.4824 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.4745 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.7527 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.7202 | Val  Acc: 0.8032
 Site-Infograph                 (2) | Val  Loss: 1.1552 | Val  Acc: 0.6381
 Site-Infograph                 (2) | Val  Loss: 1.0967 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8386
 Best site-Clipart                  (0)  | Epoch:24 | Val Acc: 0.8857
 Best site-Clipart                  (0)  | Epoch:24 | Val Acc: 0.8540
 Best site-Real                     (0)  | Epoch:24 | Val Acc: 0.9143
 Best site-Real                     (0)  | Epoch:24 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:24 | Val Acc: 0.9619
 Best site-Painting                 (2)  | Epoch:24 | Val Acc: 0.9238
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8762
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8540
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.7810
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.8032
 Best site-Infograph                (2)  | Epoch:24 | Val Acc: 0.6381
 Best site-Infograph                (2)  | Epoch:24 | Val Acc: 0.6381
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (0) | Train Loss: 0.5062 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.4503 | Train Acc: 0.8665
 Site-Real                      (2) | Train Loss: 0.2961 | Train Acc: 0.9363
 Site-Real                      (2) | Train Loss: 0.2207 | Train Acc: 0.9576
 Site-Painting                  (2) | Train Loss: 0.4370 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.3336 | Train Acc: 0.9110
 Site-Sketch                    (0) | Train Loss: 0.3874 | Train Acc: 0.8790
 Site-Sketch                    (0) | Train Loss: 0.4756 | Train Acc: 0.8347
 Site-QuickDraw                 (1) | Train Loss: 0.8205 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.7231 | Train Acc: 0.7945
 Site-Infograph                 (2) | Train Loss: 1.2455 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 1.0744 | Train Acc: 0.6801
Average Train Accuracy: 0.8349
 Site-Clipart                   (0) | Val  Loss: 0.4459 | Val  Acc: 0.8857
 Site-Clipart                   (0) | Val  Loss: 0.5185 | Val  Acc: 0.8286
 Site-Real                      (2) | Val  Loss: 0.2370 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2567 | Val  Acc: 0.9492
 Site-Painting                  (2) | Val  Loss: 0.2853 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.3453 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.4414 | Val  Acc: 0.8476
 Site-Sketch                    (0) | Val  Loss: 0.4365 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.7163 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6888 | Val  Acc: 0.8127
 Site-Infograph                 (2) | Val  Loss: 1.1045 | Val  Acc: 0.6000
 Site-Infograph                 (2) | Val  Loss: 1.0555 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8365
============ Train epoch 26 ============
cnt=[5, 2, 5, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (0) | Train Loss: 0.4693 | Train Acc: 0.8854
 Site-Clipart                   (0) | Train Loss: 0.4550 | Train Acc: 0.8665
 Site-Real                      (0) | Train Loss: 0.2722 | Train Acc: 0.9108
 Site-Real                      (2) | Train Loss: 0.2310 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.3734 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.3125 | Train Acc: 0.9047
 Site-Sketch                    (0) | Train Loss: 0.3617 | Train Acc: 0.8981
 Site-Sketch                    (0) | Train Loss: 0.4821 | Train Acc: 0.8475
 Site-QuickDraw                 (1) | Train Loss: 0.8224 | Train Acc: 0.7580
 Site-QuickDraw                 (1) | Train Loss: 0.7312 | Train Acc: 0.7966
 Site-Infograph                 (2) | Train Loss: 1.2593 | Train Acc: 0.6051
 Site-Infograph                 (2) | Train Loss: 0.9924 | Train Acc: 0.6907
Average Train Accuracy: 0.8324
 Site-Clipart                   (0) | Val  Loss: 0.4317 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4853 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2602 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2459 | Val  Acc: 0.9556
 Site-Painting                  (2) | Val  Loss: 0.2818 | Val  Acc: 0.9238
 Site-Painting                  (2) | Val  Loss: 0.3328 | Val  Acc: 0.9333
 Site-Sketch                    (0) | Val  Loss: 0.4283 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.4204 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.7387 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.7010 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 1.1645 | Val  Acc: 0.6381
 Site-Infograph                 (2) | Val  Loss: 1.0501 | Val  Acc: 0.6444
Average Valid Accuracy: 0.8497
 Best site-Clipart                  (0)  | Epoch:26 | Val Acc: 0.8952
 Best site-Clipart                  (0)  | Epoch:26 | Val Acc: 0.8508
 Best site-Real                     (0)  | Epoch:26 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:26 | Val Acc: 0.9556
 Best site-Painting                 (2)  | Epoch:26 | Val Acc: 0.9238
 Best site-Painting                 (2)  | Epoch:26 | Val Acc: 0.9333
 Best site-Sketch                   (0)  | Epoch:26 | Val Acc: 0.8857
 Best site-Sketch                   (0)  | Epoch:26 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.8000
 Best site-QuickDraw                (1)  | Epoch:26 | Val Acc: 0.8286
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6381
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6444
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 6, 4, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (1) | Train Loss: 0.4823 | Train Acc: 0.8599
 Site-Clipart                   (1) | Train Loss: 0.4360 | Train Acc: 0.8750
 Site-Real                      (1) | Train Loss: 0.3204 | Train Acc: 0.9299
 Site-Real                      (1) | Train Loss: 0.2370 | Train Acc: 0.9407
 Site-Painting                  (2) | Train Loss: 0.3843 | Train Acc: 0.8790
 Site-Painting                  (2) | Train Loss: 0.3255 | Train Acc: 0.8962
 Site-Sketch                    (1) | Train Loss: 0.4004 | Train Acc: 0.8726
 Site-Sketch                    (1) | Train Loss: 0.4620 | Train Acc: 0.8496
 Site-QuickDraw                 (0) | Train Loss: 0.7364 | Train Acc: 0.8025
 Site-QuickDraw                 (0) | Train Loss: 0.7317 | Train Acc: 0.8051
 Site-Infograph                 (2) | Train Loss: 1.2778 | Train Acc: 0.5924
 Site-Infograph                 (2) | Train Loss: 0.9375 | Train Acc: 0.6843
Average Train Accuracy: 0.8323
 Site-Clipart                   (1) | Val  Loss: 0.4505 | Val  Acc: 0.8857
 Site-Clipart                   (1) | Val  Loss: 0.5072 | Val  Acc: 0.8444
 Site-Real                      (1) | Val  Loss: 0.3079 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2497 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2480 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.3290 | Val  Acc: 0.9175
 Site-Sketch                    (1) | Val  Loss: 0.4932 | Val  Acc: 0.8667
 Site-Sketch                    (1) | Val  Loss: 0.4391 | Val  Acc: 0.8698
 Site-QuickDraw                 (0) | Val  Loss: 0.7486 | Val  Acc: 0.7714
 Site-QuickDraw                 (0) | Val  Loss: 0.7038 | Val  Acc: 0.8032
 Site-Infograph                 (2) | Val  Loss: 1.0949 | Val  Acc: 0.6190
 Site-Infograph                 (2) | Val  Loss: 1.0162 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8357
============ Train epoch 28 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.5557 | Train Acc: 0.8280
 Site-Clipart                   (0) | Train Loss: 0.4194 | Train Acc: 0.8708
 Site-Real                      (2) | Train Loss: 0.2808 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2046 | Train Acc: 0.9576
 Site-Painting                  (2) | Train Loss: 0.3379 | Train Acc: 0.9172
 Site-Painting                  (2) | Train Loss: 0.3559 | Train Acc: 0.9047
 Site-Sketch                    (0) | Train Loss: 0.3968 | Train Acc: 0.8917
 Site-Sketch                    (0) | Train Loss: 0.4191 | Train Acc: 0.8623
 Site-QuickDraw                 (1) | Train Loss: 0.7797 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.7062 | Train Acc: 0.8030
 Site-Infograph                 (2) | Train Loss: 1.2220 | Train Acc: 0.6369
 Site-Infograph                 (2) | Train Loss: 1.0010 | Train Acc: 0.6737
Average Train Accuracy: 0.8372
 Site-Clipart                   (0) | Val  Loss: 0.3767 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4699 | Val  Acc: 0.8508
 Site-Real                      (2) | Val  Loss: 0.2690 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2341 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2416 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3176 | Val  Acc: 0.9429
 Site-Sketch                    (0) | Val  Loss: 0.4689 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.3955 | Val  Acc: 0.8952
 Site-QuickDraw                 (1) | Val  Loss: 0.7678 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.6745 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 1.0905 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.0802 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8426
============ Train epoch 29 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (0) | Train Loss: 0.4828 | Train Acc: 0.8535
 Site-Clipart                   (0) | Train Loss: 0.4527 | Train Acc: 0.8877
 Site-Real                      (0) | Train Loss: 0.3001 | Train Acc: 0.9363
 Site-Real                      (0) | Train Loss: 0.2194 | Train Acc: 0.9513
 Site-Painting                  (2) | Train Loss: 0.3842 | Train Acc: 0.8854
 Site-Painting                  (2) | Train Loss: 0.3541 | Train Acc: 0.9131
 Site-Sketch                    (0) | Train Loss: 0.4510 | Train Acc: 0.8599
 Site-Sketch                    (0) | Train Loss: 0.4598 | Train Acc: 0.8559
 Site-QuickDraw                 (1) | Train Loss: 0.7442 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6813 | Train Acc: 0.7881
 Site-Infograph                 (2) | Train Loss: 1.2357 | Train Acc: 0.6242
 Site-Infograph                 (2) | Train Loss: 0.9813 | Train Acc: 0.6970
Average Train Accuracy: 0.8353
 Site-Clipart                   (0) | Val  Loss: 0.4400 | Val  Acc: 0.9048
 Site-Clipart                   (0) | Val  Loss: 0.4967 | Val  Acc: 0.8476
 Site-Real                      (0) | Val  Loss: 0.2843 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2384 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2276 | Val  Acc: 0.9619
 Site-Painting                  (2) | Val  Loss: 0.3225 | Val  Acc: 0.9238
 Site-Sketch                    (0) | Val  Loss: 0.4533 | Val  Acc: 0.8571
 Site-Sketch                    (0) | Val  Loss: 0.4482 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.6791 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6685 | Val  Acc: 0.8159
 Site-Infograph                 (2) | Val  Loss: 1.1140 | Val  Acc: 0.6381
 Site-Infograph                 (2) | Val  Loss: 1.0192 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8471
============ Train epoch 30 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (0) | Train Loss: 0.4590 | Train Acc: 0.8726
 Site-Clipart                   (0) | Train Loss: 0.3935 | Train Acc: 0.8814
 Site-Real                      (2) | Train Loss: 0.2826 | Train Acc: 0.9299
 Site-Real                      (2) | Train Loss: 0.2110 | Train Acc: 0.9470
 Site-Painting                  (2) | Train Loss: 0.4046 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3154 | Train Acc: 0.9237
 Site-Sketch                    (0) | Train Loss: 0.4223 | Train Acc: 0.8535
 Site-Sketch                    (0) | Train Loss: 0.4523 | Train Acc: 0.8559
 Site-QuickDraw                 (1) | Train Loss: 0.7211 | Train Acc: 0.7898
 Site-QuickDraw                 (1) | Train Loss: 0.6689 | Train Acc: 0.8199
 Site-Infograph                 (2) | Train Loss: 1.2418 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.9880 | Train Acc: 0.6843
Average Train Accuracy: 0.8395
 Site-Clipart                   (0) | Val  Loss: 0.4404 | Val  Acc: 0.8762
 Site-Clipart                   (0) | Val  Loss: 0.4672 | Val  Acc: 0.8603
 Site-Real                      (2) | Val  Loss: 0.2319 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.2354 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2639 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3243 | Val  Acc: 0.9365
 Site-Sketch                    (0) | Val  Loss: 0.4344 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.4435 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.6324 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.6564 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 1.0706 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 1.0390 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8537
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8762
 Best site-Clipart                  (0)  | Epoch:30 | Val Acc: 0.8603
 Best site-Real                     (2)  | Epoch:30 | Val Acc: 0.9429
 Best site-Real                     (2)  | Epoch:30 | Val Acc: 0.9460
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:30 | Val Acc: 0.9365
 Best site-Sketch                   (0)  | Epoch:30 | Val Acc: 0.8762
 Best site-Sketch                   (0)  | Epoch:30 | Val Acc: 0.8698
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:30 | Val Acc: 0.8286
 Best site-Infograph                (2)  | Epoch:30 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:30 | Val Acc: 0.6508
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 31 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (2) | Train Loss: 0.4208 | Train Acc: 0.8726
 Site-Clipart                   (2) | Train Loss: 0.4333 | Train Acc: 0.8729
 Site-Real                      (0) | Train Loss: 0.2887 | Train Acc: 0.9172
 Site-Real                      (0) | Train Loss: 0.2047 | Train Acc: 0.9576
 Site-Painting                  (0) | Train Loss: 0.3434 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.2964 | Train Acc: 0.9110
 Site-Sketch                    (2) | Train Loss: 0.4231 | Train Acc: 0.8344
 Site-Sketch                    (2) | Train Loss: 0.3911 | Train Acc: 0.8729
 Site-QuickDraw                 (1) | Train Loss: 0.7241 | Train Acc: 0.8025
 Site-QuickDraw                 (1) | Train Loss: 0.6501 | Train Acc: 0.8220
 Site-Infograph                 (0) | Train Loss: 1.1307 | Train Acc: 0.6369
 Site-Infograph                 (0) | Train Loss: 0.9842 | Train Acc: 0.6822
Average Train Accuracy: 0.8395
 Site-Clipart                   (2) | Val  Loss: 0.3895 | Val  Acc: 0.9429
 Site-Clipart                   (2) | Val  Loss: 0.5048 | Val  Acc: 0.8413
 Site-Real                      (0) | Val  Loss: 0.2657 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2364 | Val  Acc: 0.9460
 Site-Painting                  (0) | Val  Loss: 0.2076 | Val  Acc: 0.9619
 Site-Painting                  (0) | Val  Loss: 0.3070 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.4574 | Val  Acc: 0.8857
 Site-Sketch                    (2) | Val  Loss: 0.4210 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.7116 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.6533 | Val  Acc: 0.8222
 Site-Infograph                 (0) | Val  Loss: 1.0165 | Val  Acc: 0.6857
 Site-Infograph                 (0) | Val  Loss: 1.0114 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8577
 Best site-Clipart                  (2)  | Epoch:31 | Val Acc: 0.9429
 Best site-Clipart                  (2)  | Epoch:31 | Val Acc: 0.8413
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9429
 Best site-Real                     (0)  | Epoch:31 | Val Acc: 0.9460
 Best site-Painting                 (0)  | Epoch:31 | Val Acc: 0.9619
 Best site-Painting                 (0)  | Epoch:31 | Val Acc: 0.9143
 Best site-Sketch                   (2)  | Epoch:31 | Val Acc: 0.8857
 Best site-Sketch                   (2)  | Epoch:31 | Val Acc: 0.8889
 Best site-QuickDraw                (1)  | Epoch:31 | Val Acc: 0.7905
 Best site-QuickDraw                (1)  | Epoch:31 | Val Acc: 0.8222
 Best site-Infograph                (0)  | Epoch:31 | Val Acc: 0.6857
 Best site-Infograph                (0)  | Epoch:31 | Val Acc: 0.6698
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 32 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4331 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.4148 | Train Acc: 0.8835
 Site-Real                      (2) | Train Loss: 0.3003 | Train Acc: 0.9172
 Site-Real                      (2) | Train Loss: 0.2072 | Train Acc: 0.9534
 Site-Painting                  (0) | Train Loss: 0.3542 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.3215 | Train Acc: 0.9131
 Site-Sketch                    (2) | Train Loss: 0.4000 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.4454 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.7103 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.6803 | Train Acc: 0.7924
 Site-Infograph                 (0) | Train Loss: 1.2468 | Train Acc: 0.6369
 Site-Infograph                 (0) | Train Loss: 0.9112 | Train Acc: 0.7140
Average Train Accuracy: 0.8453
 Site-Clipart                   (2) | Val  Loss: 0.3788 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.4567 | Val  Acc: 0.8603
 Site-Real                      (2) | Val  Loss: 0.2652 | Val  Acc: 0.9429
 Site-Real                      (2) | Val  Loss: 0.2374 | Val  Acc: 0.9460
 Site-Painting                  (0) | Val  Loss: 0.2640 | Val  Acc: 0.9143
 Site-Painting                  (0) | Val  Loss: 0.3051 | Val  Acc: 0.9206
 Site-Sketch                    (2) | Val  Loss: 0.3817 | Val  Acc: 0.9048
 Site-Sketch                    (2) | Val  Loss: 0.4461 | Val  Acc: 0.8730
 Site-QuickDraw                 (1) | Val  Loss: 0.6725 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.6486 | Val  Acc: 0.8063
 Site-Infograph                 (0) | Val  Loss: 1.0532 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 0.9651 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8503
============ Train epoch 33 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (2) | Train Loss: 0.4185 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.3937 | Train Acc: 0.8814
 Site-Real                      (0) | Train Loss: 0.3060 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2096 | Train Acc: 0.9470
 Site-Painting                  (0) | Train Loss: 0.3571 | Train Acc: 0.8790
 Site-Painting                  (0) | Train Loss: 0.3029 | Train Acc: 0.9110
 Site-Sketch                    (2) | Train Loss: 0.4309 | Train Acc: 0.8662
 Site-Sketch                    (2) | Train Loss: 0.4450 | Train Acc: 0.8538
 Site-QuickDraw                 (1) | Train Loss: 0.6501 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.6365 | Train Acc: 0.8242
 Site-Infograph                 (0) | Train Loss: 1.2391 | Train Acc: 0.5987
 Site-Infograph                 (0) | Train Loss: 0.9321 | Train Acc: 0.7034
Average Train Accuracy: 0.8392
 Site-Clipart                   (2) | Val  Loss: 0.4181 | Val  Acc: 0.9048
 Site-Clipart                   (2) | Val  Loss: 0.4648 | Val  Acc: 0.8508
 Site-Real                      (0) | Val  Loss: 0.2814 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2270 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.2569 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2899 | Val  Acc: 0.9175
 Site-Sketch                    (2) | Val  Loss: 0.4517 | Val  Acc: 0.8667
 Site-Sketch                    (2) | Val  Loss: 0.4154 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6554 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6555 | Val  Acc: 0.8286
 Site-Infograph                 (0) | Val  Loss: 1.0103 | Val  Acc: 0.6381
 Site-Infograph                 (0) | Val  Loss: 1.0047 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8500
============ Train epoch 34 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (0) | Train Loss: 0.4444 | Train Acc: 0.8790
 Site-Clipart                   (0) | Train Loss: 0.3880 | Train Acc: 0.8835
 Site-Real                      (2) | Train Loss: 0.2533 | Train Acc: 0.9236
 Site-Real                      (2) | Train Loss: 0.1910 | Train Acc: 0.9746
 Site-Painting                  (2) | Train Loss: 0.3613 | Train Acc: 0.9172
 Site-Painting                  (2) | Train Loss: 0.3269 | Train Acc: 0.9174
 Site-Sketch                    (0) | Train Loss: 0.4468 | Train Acc: 0.8471
 Site-Sketch                    (0) | Train Loss: 0.4488 | Train Acc: 0.8517
 Site-QuickDraw                 (1) | Train Loss: 0.6702 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.6160 | Train Acc: 0.8305
 Site-Infograph                 (2) | Train Loss: 1.1072 | Train Acc: 0.6561
 Site-Infograph                 (2) | Train Loss: 0.9000 | Train Acc: 0.7182
Average Train Accuracy: 0.8496
 Site-Clipart                   (0) | Val  Loss: 0.4005 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.4136 | Val  Acc: 0.8667
 Site-Real                      (2) | Val  Loss: 0.2695 | Val  Acc: 0.9143
 Site-Real                      (2) | Val  Loss: 0.2419 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2127 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.2968 | Val  Acc: 0.9302
 Site-Sketch                    (0) | Val  Loss: 0.3680 | Val  Acc: 0.8952
 Site-Sketch                    (0) | Val  Loss: 0.3862 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6643 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6243 | Val  Acc: 0.8413
 Site-Infograph                 (2) | Val  Loss: 1.0323 | Val  Acc: 0.6571
 Site-Infograph                 (2) | Val  Loss: 0.9808 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8545
============ Train epoch 35 ============
cnt=[4, 2, 6, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.4267 | Train Acc: 0.8917
 Site-Clipart                   (0) | Train Loss: 0.3844 | Train Acc: 0.8919
 Site-Real                      (2) | Train Loss: 0.2612 | Train Acc: 0.9363
 Site-Real                      (2) | Train Loss: 0.1852 | Train Acc: 0.9597
 Site-Painting                  (2) | Train Loss: 0.3510 | Train Acc: 0.9172
 Site-Painting                  (2) | Train Loss: 0.2966 | Train Acc: 0.9174
 Site-Sketch                    (0) | Train Loss: 0.3671 | Train Acc: 0.8981
 Site-Sketch                    (0) | Train Loss: 0.3849 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.7652 | Train Acc: 0.7643
 Site-QuickDraw                 (1) | Train Loss: 0.6437 | Train Acc: 0.8517
 Site-Infograph                 (2) | Train Loss: 1.2074 | Train Acc: 0.6178
 Site-Infograph                 (2) | Train Loss: 0.9365 | Train Acc: 0.6992
Average Train Accuracy: 0.8522
 Site-Clipart                   (0) | Val  Loss: 0.3280 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.4488 | Val  Acc: 0.8540
 Site-Real                      (2) | Val  Loss: 0.2480 | Val  Acc: 0.9238
 Site-Real                      (2) | Val  Loss: 0.2184 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2400 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3029 | Val  Acc: 0.9270
 Site-Sketch                    (0) | Val  Loss: 0.3567 | Val  Acc: 0.9048
 Site-Sketch                    (0) | Val  Loss: 0.3983 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.6455 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.5848 | Val  Acc: 0.8603
 Site-Infograph                 (2) | Val  Loss: 1.0024 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.9821 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8638
 Best site-Clipart                  (0)  | Epoch:35 | Val Acc: 0.9143
 Best site-Clipart                  (0)  | Epoch:35 | Val Acc: 0.8540
 Best site-Real                     (2)  | Epoch:35 | Val Acc: 0.9238
 Best site-Real                     (2)  | Epoch:35 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:35 | Val Acc: 0.9333
 Best site-Painting                 (2)  | Epoch:35 | Val Acc: 0.9270
 Best site-Sketch                   (0)  | Epoch:35 | Val Acc: 0.9048
 Best site-Sketch                   (0)  | Epoch:35 | Val Acc: 0.8794
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8381
 Best site-QuickDraw                (1)  | Epoch:35 | Val Acc: 0.8603
 Best site-Infograph                (2)  | Epoch:35 | Val Acc: 0.7048
 Best site-Infograph                (2)  | Epoch:35 | Val Acc: 0.6730
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 8, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (1) | Train Loss: 0.5032 | Train Acc: 0.8662
 Site-Clipart                   (1) | Train Loss: 0.3957 | Train Acc: 0.8856
 Site-Real                      (1) | Train Loss: 0.2672 | Train Acc: 0.9172
 Site-Real                      (1) | Train Loss: 0.1935 | Train Acc: 0.9492
 Site-Painting                  (1) | Train Loss: 0.3549 | Train Acc: 0.8790
 Site-Painting                  (1) | Train Loss: 0.2946 | Train Acc: 0.9131
 Site-Sketch                    (1) | Train Loss: 0.4258 | Train Acc: 0.8854
 Site-Sketch                    (1) | Train Loss: 0.4230 | Train Acc: 0.8559
 Site-QuickDraw                 (0) | Train Loss: 0.6740 | Train Acc: 0.7962
 Site-QuickDraw                 (0) | Train Loss: 0.6182 | Train Acc: 0.8326
 Site-Infograph                 (2) | Train Loss: 1.1994 | Train Acc: 0.6306
 Site-Infograph                 (2) | Train Loss: 0.9150 | Train Acc: 0.7161
Average Train Accuracy: 0.8439
 Site-Clipart                   (1) | Val  Loss: 0.4284 | Val  Acc: 0.8952
 Site-Clipart                   (1) | Val  Loss: 0.4515 | Val  Acc: 0.8540
 Site-Real                      (1) | Val  Loss: 0.2806 | Val  Acc: 0.9143
 Site-Real                      (1) | Val  Loss: 0.2479 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.1841 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.3000 | Val  Acc: 0.9270
 Site-Sketch                    (1) | Val  Loss: 0.4051 | Val  Acc: 0.9048
 Site-Sketch                    (1) | Val  Loss: 0.4357 | Val  Acc: 0.8667
 Site-QuickDraw                 (0) | Val  Loss: 0.5995 | Val  Acc: 0.8476
 Site-QuickDraw                 (0) | Val  Loss: 0.6604 | Val  Acc: 0.8190
 Site-Infograph                 (2) | Val  Loss: 0.9233 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 0.9458 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8571
============ Train epoch 37 ============
cnt=[8, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (0) | Train Loss: 0.4957 | Train Acc: 0.8662
 Site-Clipart                   (0) | Train Loss: 0.4000 | Train Acc: 0.8856
 Site-Real                      (0) | Train Loss: 0.2679 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.2331 | Train Acc: 0.9492
 Site-Painting                  (0) | Train Loss: 0.3711 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.3448 | Train Acc: 0.9068
 Site-Sketch                    (0) | Train Loss: 0.3954 | Train Acc: 0.8599
 Site-Sketch                    (0) | Train Loss: 0.4061 | Train Acc: 0.8644
 Site-QuickDraw                 (1) | Train Loss: 0.6913 | Train Acc: 0.7707
 Site-QuickDraw                 (1) | Train Loss: 0.6331 | Train Acc: 0.8263
 Site-Infograph                 (2) | Train Loss: 1.0971 | Train Acc: 0.6306
 Site-Infograph                 (2) | Train Loss: 0.8894 | Train Acc: 0.7225
Average Train Accuracy: 0.8441
 Site-Clipart                   (0) | Val  Loss: 0.3593 | Val  Acc: 0.9143
 Site-Clipart                   (0) | Val  Loss: 0.4571 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.2861 | Val  Acc: 0.9143
 Site-Real                      (0) | Val  Loss: 0.2476 | Val  Acc: 0.9397
 Site-Painting                  (0) | Val  Loss: 0.2684 | Val  Acc: 0.9048
 Site-Painting                  (0) | Val  Loss: 0.3125 | Val  Acc: 0.9270
 Site-Sketch                    (0) | Val  Loss: 0.4208 | Val  Acc: 0.8857
 Site-Sketch                    (0) | Val  Loss: 0.4110 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.6562 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.6043 | Val  Acc: 0.8540
 Site-Infograph                 (2) | Val  Loss: 0.9424 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.9262 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8587
============ Train epoch 38 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (2) | Train Loss: 0.4125 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.3664 | Train Acc: 0.9004
 Site-Real                      (0) | Train Loss: 0.2848 | Train Acc: 0.9236
 Site-Real                      (0) | Train Loss: 0.1948 | Train Acc: 0.9576
 Site-Painting                  (0) | Train Loss: 0.3294 | Train Acc: 0.9299
 Site-Painting                  (0) | Train Loss: 0.2868 | Train Acc: 0.9174
 Site-Sketch                    (2) | Train Loss: 0.4346 | Train Acc: 0.8790
 Site-Sketch                    (2) | Train Loss: 0.3659 | Train Acc: 0.8750
 Site-QuickDraw                 (1) | Train Loss: 0.6646 | Train Acc: 0.8089
 Site-QuickDraw                 (1) | Train Loss: 0.5626 | Train Acc: 0.8623
 Site-Infograph                 (0) | Train Loss: 1.1068 | Train Acc: 0.6369
 Site-Infograph                 (0) | Train Loss: 0.8679 | Train Acc: 0.7415
Average Train Accuracy: 0.8593
 Site-Clipart                   (2) | Val  Loss: 0.3762 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4406 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.2519 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2146 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2020 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2901 | Val  Acc: 0.9270
 Site-Sketch                    (2) | Val  Loss: 0.3165 | Val  Acc: 0.9238
 Site-Sketch                    (2) | Val  Loss: 0.3878 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.6526 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.6180 | Val  Acc: 0.8222
 Site-Infograph                 (0) | Val  Loss: 0.9926 | Val  Acc: 0.6762
 Site-Infograph                 (0) | Val  Loss: 0.9312 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8590
============ Train epoch 39 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (2) | Train Loss: 0.4180 | Train Acc: 0.8790
 Site-Clipart                   (2) | Train Loss: 0.3519 | Train Acc: 0.9004
 Site-Real                      (0) | Train Loss: 0.2655 | Train Acc: 0.9299
 Site-Real                      (0) | Train Loss: 0.1972 | Train Acc: 0.9534
 Site-Painting                  (0) | Train Loss: 0.3226 | Train Acc: 0.9172
 Site-Painting                  (0) | Train Loss: 0.2930 | Train Acc: 0.9174
 Site-Sketch                    (2) | Train Loss: 0.3375 | Train Acc: 0.9172
 Site-Sketch                    (2) | Train Loss: 0.4058 | Train Acc: 0.8877
 Site-QuickDraw                 (1) | Train Loss: 0.6523 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.6268 | Train Acc: 0.8326
 Site-Infograph                 (0) | Train Loss: 1.2052 | Train Acc: 0.6306
 Site-Infograph                 (0) | Train Loss: 0.9099 | Train Acc: 0.7161
Average Train Accuracy: 0.8565
 Site-Clipart                   (2) | Val  Loss: 0.4145 | Val  Acc: 0.8667
 Site-Clipart                   (2) | Val  Loss: 0.4210 | Val  Acc: 0.8698
 Site-Real                      (0) | Val  Loss: 0.2243 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2014 | Val  Acc: 0.9460
 Site-Painting                  (0) | Val  Loss: 0.1832 | Val  Acc: 0.9714
 Site-Painting                  (0) | Val  Loss: 0.2731 | Val  Acc: 0.9333
 Site-Sketch                    (2) | Val  Loss: 0.3301 | Val  Acc: 0.9143
 Site-Sketch                    (2) | Val  Loss: 0.3260 | Val  Acc: 0.9016
 Site-QuickDraw                 (1) | Val  Loss: 0.6077 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.5961 | Val  Acc: 0.8603
 Site-Infograph                 (0) | Val  Loss: 0.9783 | Val  Acc: 0.6762
 Site-Infograph                 (0) | Val  Loss: 0.9078 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8667
 Best site-Clipart                  (2)  | Epoch:39 | Val Acc: 0.8667
 Best site-Clipart                  (2)  | Epoch:39 | Val Acc: 0.8698
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:39 | Val Acc: 0.9460
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9714
 Best site-Painting                 (0)  | Epoch:39 | Val Acc: 0.9333
 Best site-Sketch                   (2)  | Epoch:39 | Val Acc: 0.9143
 Best site-Sketch                   (2)  | Epoch:39 | Val Acc: 0.9016
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:39 | Val Acc: 0.8603
 Best site-Infograph                (0)  | Epoch:39 | Val Acc: 0.6762
 Best site-Infograph                (0)  | Epoch:39 | Val Acc: 0.7079
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cluster_3/ccop_q=1...
============ Train epoch 40 ============
cnt=[6, 2, 4, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (2) | Train Loss: 0.4374 | Train Acc: 0.8662
 Site-Clipart                   (2) | Train Loss: 0.3914 | Train Acc: 0.8856
 Site-Real                      (0) | Train Loss: 0.2750 | Train Acc: 0.9427
 Site-Real                      (0) | Train Loss: 0.1707 | Train Acc: 0.9619
 Site-Painting                  (0) | Train Loss: 0.3936 | Train Acc: 0.8917
 Site-Painting                  (0) | Train Loss: 0.2749 | Train Acc: 0.9195
 Site-Sketch                    (2) | Train Loss: 0.3378 | Train Acc: 0.8854
 Site-Sketch                    (2) | Train Loss: 0.3737 | Train Acc: 0.8814
 Site-QuickDraw                 (1) | Train Loss: 0.6215 | Train Acc: 0.7962
 Site-QuickDraw                 (1) | Train Loss: 0.5651 | Train Acc: 0.8453
 Site-Infograph                 (0) | Train Loss: 1.1518 | Train Acc: 0.6242
 Site-Infograph                 (0) | Train Loss: 0.8683 | Train Acc: 0.7373
Average Train Accuracy: 0.8531
 Site-Clipart                   (2) | Val  Loss: 0.3612 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4151 | Val  Acc: 0.8667
 Site-Real                      (0) | Val  Loss: 0.2347 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2007 | Val  Acc: 0.9556
 Site-Painting                  (0) | Val  Loss: 0.1755 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3056 | Val  Acc: 0.9302
 Site-Sketch                    (2) | Val  Loss: 0.3750 | Val  Acc: 0.8952
 Site-Sketch                    (2) | Val  Loss: 0.3749 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.6522 | Val  Acc: 0.8000
 Site-QuickDraw                 (1) | Val  Loss: 0.5811 | Val  Acc: 0.8317
 Site-Infograph                 (0) | Val  Loss: 0.9663 | Val  Acc: 0.7143
 Site-Infograph                 (0) | Val  Loss: 0.9330 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8601
 Test site-Clipart                   (2)| Epoch:39 | Test Acc: 0.8764
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9449
 Test site-Painting                  (0)| Epoch:39 | Test Acc: 0.9402
 Test site-Sketch                    (2)| Epoch:39 | Test Acc: 0.8881
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7860
 Test site-Infograph                 (0)| Epoch:39 | Test Acc: 0.6119
Clipart: 0.8764, Real: 0.9449, Painting: 0.9402, Sketch: 0.8881, QuickDraw: 0.7860, Infograph: 0.6119, 
Average Test Accuracy(group): 0.8413, Average Test Accuracy(individual): 0.8413,
domain std=0.1152, cluster std=0.0393, individual std=0.1152, 
===2023-08-13 09:01:55===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 3
Loading snapshots...
 Test site-Clipart                   (2)| Epoch:39 | Test Acc: 0.8764
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9458
 Test site-Painting                  (0)| Epoch:39 | Test Acc: 0.9370
 Test site-Sketch                    (2)| Epoch:39 | Test Acc: 0.8863
 Test site-QuickDraw                 (1)| Epoch:39 | Test Acc: 0.7870
 Test site-Infograph                 (0)| Epoch:39 | Test Acc: 0.6149
Clipart: 0.8764, Real: 0.9458, Painting: 0.9370, Sketch: 0.8863, QuickDraw: 0.7870, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8412, Average Test Accuracy(individual): 0.8412,
domain std=0.1137, cluster std=0.0385, individual std=0.1137, 
