===2023-07-02 09:19:50===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.0961 | Train Acc: 0.8190
 Site-Real                          | Train Loss: 0.7248 | Train Acc: 0.9444
 Site-Painting                      | Train Loss: 0.8555 | Train Acc: 0.8505
 Site-Sketch                        | Train Loss: 1.1245 | Train Acc: 0.6987
 Site-QuickDraw                     | Train Loss: 2.0666 | Train Acc: 0.3436
 Site-Infograph                     | Train Loss: 1.8914 | Train Acc: 0.3675
Average Train Accuracy: 0.6706
 Site-Clipart                       | Val  Loss: 1.0884 | Val  Acc: 0.8238
 Site-Real                          | Val  Loss: 0.7201 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.0156 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 1.0886 | Val  Acc: 0.7320
 Site-QuickDraw                     | Val  Loss: 2.0814 | Val  Acc: 0.3028
 Site-Infograph                     | Val  Loss: 1.8111 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6844
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8238
 Best site-Real                      | Epoch:0 | Val Acc: 0.9500
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8364
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7320
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.3028
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.6944 | Train Acc: 0.8714
 Site-Real                          | Train Loss: 0.3859 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.5016 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.7703 | Train Acc: 0.7817
 Site-QuickDraw                     | Train Loss: 1.9582 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.7700 | Train Acc: 0.3675
Average Train Accuracy: 0.7063
 Site-Clipart                       | Val  Loss: 0.7032 | Val  Acc: 0.8619
 Site-Real                          | Val  Loss: 0.3483 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.6508 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.7797 | Val  Acc: 0.7647
 Site-QuickDraw                     | Val  Loss: 1.9718 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.5430 | Val  Acc: 0.4615
Average Valid Accuracy: 0.7148
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8619
 Best site-Real                      | Epoch:1 | Val Acc: 0.9600
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8738
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7647
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.3670
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.5187 | Train Acc: 0.8968
 Site-Real                          | Train Loss: 0.2071 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.4293 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6527 | Train Acc: 0.7948
 Site-QuickDraw                     | Train Loss: 1.8787 | Train Acc: 0.3988
 Site-Infograph                     | Train Loss: 1.7360 | Train Acc: 0.4188
Average Train Accuracy: 0.7280
 Site-Clipart                       | Val  Loss: 0.5412 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.2527 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5551 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.6732 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.9568 | Val  Acc: 0.3211
 Site-Infograph                     | Val  Loss: 1.4073 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7300
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8857
 Best site-Real                      | Epoch:2 | Val Acc: 0.9633
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8738
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8105
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.3211
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.4235 | Train Acc: 0.9143
 Site-Real                          | Train Loss: 0.1453 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3912 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.6156 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.8215 | Train Acc: 0.4110
 Site-Infograph                     | Train Loss: 1.6412 | Train Acc: 0.4103
Average Train Accuracy: 0.7406
 Site-Clipart                       | Val  Loss: 0.4597 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.2094 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5530 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5815 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.8256 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.4227 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7282
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.3597 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1183 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3055 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.5855 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.7460 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.6250 | Train Acc: 0.4786
Average Train Accuracy: 0.7573
 Site-Clipart                       | Val  Loss: 0.4039 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.1642 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5752 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.5174 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7790 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.4823 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7461
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9119
 Best site-Real                      | Epoch:4 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8364
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.4220
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.3107 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1541 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.2813 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.4993 | Train Acc: 0.8603
 Site-QuickDraw                     | Train Loss: 1.7527 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.6414 | Train Acc: 0.4188
Average Train Accuracy: 0.7485
 Site-Clipart                       | Val  Loss: 0.3663 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.1533 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4930 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.4780 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.8020 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.4095 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7382
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.2866 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.2036 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.2639 | Train Acc: 0.9221
 Site-Sketch                        | Train Loss: 0.5120 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.7919 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.6502 | Train Acc: 0.4274
Average Train Accuracy: 0.7504
 Site-Clipart                       | Val  Loss: 0.3348 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.1388 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4794 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.5074 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.8431 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3433 | Val  Acc: 0.4744
Average Valid Accuracy: 0.7459
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.2408 | Train Acc: 0.9556
 Site-Real                          | Train Loss: 0.0836 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.2401 | Train Acc: 0.9221
 Site-Sketch                        | Train Loss: 0.4114 | Train Acc: 0.8646
 Site-QuickDraw                     | Train Loss: 1.7488 | Train Acc: 0.3988
 Site-Infograph                     | Train Loss: 1.5836 | Train Acc: 0.4530
Average Train Accuracy: 0.7627
 Site-Clipart                       | Val  Loss: 0.3148 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1399 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.3821 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.5235 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.8993 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3538 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7467
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9190
 Best site-Real                      | Epoch:7 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:7 | Val Acc: 0.8879
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8105
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.3670
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.2327 | Train Acc: 0.9556
 Site-Real                          | Train Loss: 0.0727 | Train Acc: 0.9867
 Site-Painting                      | Train Loss: 0.2213 | Train Acc: 0.9283
 Site-Sketch                        | Train Loss: 0.5044 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.7623 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.6889 | Train Acc: 0.4017
Average Train Accuracy: 0.7557
 Site-Clipart                       | Val  Loss: 0.3117 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1135 | Val  Acc: 0.9800
 Site-Painting                      | Val  Loss: 0.4389 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5312 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7988 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3825 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7481
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9214
 Best site-Real                      | Epoch:8 | Val Acc: 0.9800
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8785
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3853
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.2083 | Train Acc: 0.9683
 Site-Real                          | Train Loss: 0.0622 | Train Acc: 0.9867
 Site-Painting                      | Train Loss: 0.2095 | Train Acc: 0.9439
 Site-Sketch                        | Train Loss: 0.4828 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6075 | Train Acc: 0.4847
 Site-Infograph                     | Train Loss: 1.6206 | Train Acc: 0.4274
Average Train Accuracy: 0.7756
 Site-Clipart                       | Val  Loss: 0.2801 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1262 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4049 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4637 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.8402 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.4764 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7553
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9333
 Best site-Real                      | Epoch:9 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8879
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8497
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3945
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.1900 | Train Acc: 0.9683
 Site-Real                          | Train Loss: 0.0735 | Train Acc: 0.9889
 Site-Painting                      | Train Loss: 0.1879 | Train Acc: 0.9346
 Site-Sketch                        | Train Loss: 0.4050 | Train Acc: 0.8821
 Site-QuickDraw                     | Train Loss: 1.6042 | Train Acc: 0.4663
 Site-Infograph                     | Train Loss: 1.6292 | Train Acc: 0.4359
Average Train Accuracy: 0.7793
 Site-Clipart                       | Val  Loss: 0.2645 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1282 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.4228 | Val  Acc: 0.8925
 Site-Sketch                        | Val  Loss: 0.4990 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.7393 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.2743 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7516
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.1893 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.0462 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1832 | Train Acc: 0.9533
 Site-Sketch                        | Train Loss: 0.4233 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.5907 | Train Acc: 0.5031
 Site-Infograph                     | Train Loss: 1.6218 | Train Acc: 0.4103
Average Train Accuracy: 0.7782
 Site-Clipart                       | Val  Loss: 0.2513 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.1017 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4801 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4036 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.7372 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3784 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7587
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.9405
 Best site-Real                      | Epoch:11 | Val Acc: 0.9767
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8879
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.8562
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.1852 | Train Acc: 0.9603
 Site-Real                          | Train Loss: 0.0465 | Train Acc: 0.9911
 Site-Painting                      | Train Loss: 0.1732 | Train Acc: 0.9439
 Site-Sketch                        | Train Loss: 0.4251 | Train Acc: 0.8603
 Site-QuickDraw                     | Train Loss: 1.6085 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6497 | Train Acc: 0.3932
Average Train Accuracy: 0.7682
 Site-Clipart                       | Val  Loss: 0.2588 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1015 | Val  Acc: 0.9800
 Site-Painting                      | Val  Loss: 0.4454 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.4365 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.7084 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.4749 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7735
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9333
 Best site-Real                      | Epoch:12 | Val Acc: 0.9800
 Best site-Painting                  | Epoch:12 | Val Acc: 0.8785
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8627
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.4862
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.1941 | Train Acc: 0.9556
 Site-Real                          | Train Loss: 0.0400 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1746 | Train Acc: 0.9315
 Site-Sketch                        | Train Loss: 0.4353 | Train Acc: 0.8603
 Site-QuickDraw                     | Train Loss: 1.6567 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.6483 | Train Acc: 0.4530
Average Train Accuracy: 0.7647
 Site-Clipart                       | Val  Loss: 0.2530 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1009 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3812 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.4644 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7177 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.4035 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7548
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.1531 | Train Acc: 0.9714
 Site-Real                          | Train Loss: 0.0503 | Train Acc: 0.9889
 Site-Painting                      | Train Loss: 0.1544 | Train Acc: 0.9626
 Site-Sketch                        | Train Loss: 0.3959 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.6397 | Train Acc: 0.4908
 Site-Infograph                     | Train Loss: 1.6738 | Train Acc: 0.4701
Average Train Accuracy: 0.7965
 Site-Clipart                       | Val  Loss: 0.2445 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0977 | Val  Acc: 0.9800
 Site-Painting                      | Val  Loss: 0.4861 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4067 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7132 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.4205 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7678
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.1791 | Train Acc: 0.9635
 Site-Real                          | Train Loss: 0.0580 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1469 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.3572 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.4742 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.6224 | Train Acc: 0.4359
Average Train Accuracy: 0.7846
 Site-Clipart                       | Val  Loss: 0.2276 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0988 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4151 | Val  Acc: 0.8925
 Site-Sketch                        | Val  Loss: 0.4948 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.5946 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.4485 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7660
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.1597 | Train Acc: 0.9571
 Site-Real                          | Train Loss: 0.0321 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1537 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.3538 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.5570 | Train Acc: 0.4540
 Site-Infograph                     | Train Loss: 1.6693 | Train Acc: 0.4359
Average Train Accuracy: 0.7797
 Site-Clipart                       | Val  Loss: 0.1954 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0968 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4426 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.4265 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.6633 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.3482 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7694
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.1429 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0317 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1436 | Train Acc: 0.9502
 Site-Sketch                        | Train Loss: 0.4175 | Train Acc: 0.8777
 Site-QuickDraw                     | Train Loss: 1.5646 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.6277 | Train Acc: 0.4444
Average Train Accuracy: 0.7898
 Site-Clipart                       | Val  Loss: 0.2114 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0902 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4019 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.3990 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.6381 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3992 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7651
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.1321 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0261 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1531 | Train Acc: 0.9502
 Site-Sketch                        | Train Loss: 0.3404 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.4899 | Train Acc: 0.4785
 Site-Infograph                     | Train Loss: 1.6343 | Train Acc: 0.4444
Average Train Accuracy: 0.7903
 Site-Clipart                       | Val  Loss: 0.2010 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.1085 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4386 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.4257 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.5472 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.3020 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7655
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.1214 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0605 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1400 | Train Acc: 0.9564
 Site-Sketch                        | Train Loss: 0.3682 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.3485 | Train Acc: 0.5460
 Site-Infograph                     | Train Loss: 1.6055 | Train Acc: 0.4786
Average Train Accuracy: 0.8076
 Site-Clipart                       | Val  Loss: 0.2072 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0834 | Val  Acc: 0.9867
 Site-Painting                      | Val  Loss: 0.3008 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.4605 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.6168 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.2548 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7825
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.9429
 Best site-Real                      | Epoch:19 | Val Acc: 0.9867
 Best site-Painting                  | Epoch:19 | Val Acc: 0.9252
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.8301
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.4587
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.1157 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0267 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1916 | Train Acc: 0.9657
 Site-Sketch                        | Train Loss: 0.3520 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.4090 | Train Acc: 0.5215
 Site-Infograph                     | Train Loss: 1.6783 | Train Acc: 0.4530
Average Train Accuracy: 0.8005
 Site-Clipart                       | Val  Loss: 0.2020 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0805 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3741 | Val  Acc: 0.9299
 Site-Sketch                        | Val  Loss: 0.3900 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.5708 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.4327 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7868
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9548
 Best site-Real                      | Epoch:20 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9299
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.8693
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.4679
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.1270 | Train Acc: 0.9698
 Site-Real                          | Train Loss: 0.0421 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1311 | Train Acc: 0.9657
 Site-Sketch                        | Train Loss: 0.3802 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.4108 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.6357 | Train Acc: 0.4274
Average Train Accuracy: 0.7910
 Site-Clipart                       | Val  Loss: 0.2066 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0830 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.3292 | Val  Acc: 0.9112
 Site-Sketch                        | Val  Loss: 0.3916 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.5855 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.2013 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7891
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9429
 Best site-Real                      | Epoch:21 | Val Acc: 0.9767
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9112
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8497
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.4771
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.1290 | Train Acc: 0.9698
 Site-Real                          | Train Loss: 0.0266 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1050 | Train Acc: 0.9626
 Site-Sketch                        | Train Loss: 0.3674 | Train Acc: 0.8821
 Site-QuickDraw                     | Train Loss: 1.5587 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.5919 | Train Acc: 0.4359
Average Train Accuracy: 0.7864
 Site-Clipart                       | Val  Loss: 0.2174 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.0850 | Val  Acc: 0.9800
 Site-Painting                      | Val  Loss: 0.3958 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.3954 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.5597 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.3756 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7902
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.9405
 Best site-Real                      | Epoch:22 | Val Acc: 0.9800
 Best site-Painting                  | Epoch:22 | Val Acc: 0.9252
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8562
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.5138
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.1191 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0272 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1185 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.3247 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.5982 | Train Acc: 0.4663
 Site-Infograph                     | Train Loss: 1.6535 | Train Acc: 0.4530
Average Train Accuracy: 0.7941
 Site-Clipart                       | Val  Loss: 0.1912 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.0751 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3378 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.3354 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.6050 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3974 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7790
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.1203 | Train Acc: 0.9683
 Site-Real                          | Train Loss: 0.0293 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1520 | Train Acc: 0.9720
 Site-Sketch                        | Train Loss: 0.3560 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.4910 | Train Acc: 0.5092
 Site-Infograph                     | Train Loss: 1.5398 | Train Acc: 0.4701
Average Train Accuracy: 0.8010
 Site-Clipart                       | Val  Loss: 0.1746 | Val  Acc: 0.9595
 Site-Real                          | Val  Loss: 0.0718 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3548 | Val  Acc: 0.9112
 Site-Sketch                        | Val  Loss: 0.3790 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.7182 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.3705 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7687
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.1195 | Train Acc: 0.9714
 Site-Real                          | Train Loss: 0.0292 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1047 | Train Acc: 0.9751
 Site-Sketch                        | Train Loss: 0.3153 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.5213 | Train Acc: 0.4847
 Site-Infograph                     | Train Loss: 1.6448 | Train Acc: 0.3932
Average Train Accuracy: 0.7855
 Site-Clipart                       | Val  Loss: 0.2214 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.0835 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4215 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.4142 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.5452 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.2948 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7809
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.1142 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0219 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.6370 | Train Acc: 0.9626
 Site-Sketch                        | Train Loss: 0.3408 | Train Acc: 0.8821
 Site-QuickDraw                     | Train Loss: 1.4277 | Train Acc: 0.5031
 Site-Infograph                     | Train Loss: 1.6430 | Train Acc: 0.4872
Average Train Accuracy: 0.8014
 Site-Clipart                       | Val  Loss: 0.2229 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0879 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3872 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.3289 | Val  Acc: 0.8758
 Site-QuickDraw                     | Val  Loss: 1.5302 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.3856 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7856
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.1202 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0207 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.2041 | Train Acc: 0.9688
 Site-Sketch                        | Train Loss: 0.3754 | Train Acc: 0.8865
 Site-QuickDraw                     | Train Loss: 1.4644 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.5964 | Train Acc: 0.4786
Average Train Accuracy: 0.7958
 Site-Clipart                       | Val  Loss: 0.1980 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0797 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.3592 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.3557 | Val  Acc: 0.8824
 Site-QuickDraw                     | Val  Loss: 1.4472 | Val  Acc: 0.5321
 Site-Infograph                     | Val  Loss: 1.3532 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7923
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9524
 Best site-Real                      | Epoch:27 | Val Acc: 0.9767
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8972
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8824
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.5321
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.1004 | Train Acc: 0.9825
 Site-Real                          | Train Loss: 0.0212 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1026 | Train Acc: 0.9782
 Site-Sketch                        | Train Loss: 0.3302 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.4548 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.4944 | Train Acc: 0.5043
Average Train Accuracy: 0.8043
 Site-Clipart                       | Val  Loss: 0.1781 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0711 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3865 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.2978 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.4656 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.3245 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7932
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9524
 Best site-Real                      | Epoch:28 | Val Acc: 0.9833
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8972
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.4862
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.1077 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0191 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.1034 | Train Acc: 0.9782
 Site-Sketch                        | Train Loss: 0.3474 | Train Acc: 0.8821
 Site-QuickDraw                     | Train Loss: 1.3799 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.6009 | Train Acc: 0.4444
Average Train Accuracy: 0.7965
 Site-Clipart                       | Val  Loss: 0.1992 | Val  Acc: 0.9381
 Site-Real                          | Val  Loss: 0.0926 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4194 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.4010 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.5401 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3013 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7731
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.1112 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0417 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.2734 | Train Acc: 0.9657
 Site-Sketch                        | Train Loss: 0.3001 | Train Acc: 0.9039
 Site-QuickDraw                     | Train Loss: 1.3978 | Train Acc: 0.5092
 Site-Infograph                     | Train Loss: 1.6341 | Train Acc: 0.4274
Average Train Accuracy: 0.7962
 Site-Clipart                       | Val  Loss: 0.1898 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0662 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3500 | Val  Acc: 0.9159
 Site-Sketch                        | Val  Loss: 0.3978 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.3340 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.3025 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7867
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.1052 | Train Acc: 0.9730
 Site-Real                          | Train Loss: 0.0200 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1090 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.3746 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.4155 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.5738 | Train Acc: 0.4786
Average Train Accuracy: 0.8027
 Site-Clipart                       | Val  Loss: 0.1699 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0853 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4668 | Val  Acc: 0.8925
 Site-Sketch                        | Val  Loss: 0.3375 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.5262 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.1898 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7694
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.1083 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0333 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1118 | Train Acc: 0.9595
 Site-Sketch                        | Train Loss: 0.3398 | Train Acc: 0.8865
 Site-QuickDraw                     | Train Loss: 1.3823 | Train Acc: 0.4847
 Site-Infograph                     | Train Loss: 1.6473 | Train Acc: 0.4701
Average Train Accuracy: 0.7957
 Site-Clipart                       | Val  Loss: 0.1629 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0685 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.3311 | Val  Acc: 0.9159
 Site-Sketch                        | Val  Loss: 0.3564 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.4562 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.2553 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7939
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9571
 Best site-Real                      | Epoch:32 | Val Acc: 0.9767
 Best site-Painting                  | Epoch:32 | Val Acc: 0.9159
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.4862
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.1009 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0217 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.1120 | Train Acc: 0.9782
 Site-Sketch                        | Train Loss: 0.3217 | Train Acc: 0.9127
 Site-QuickDraw                     | Train Loss: 1.3871 | Train Acc: 0.5399
 Site-Infograph                     | Train Loss: 1.5985 | Train Acc: 0.4530
Average Train Accuracy: 0.8094
 Site-Clipart                       | Val  Loss: 0.1895 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0808 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3268 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.4507 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.3710 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.2364 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7862
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.0940 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0213 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.0957 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.2843 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 1.3544 | Train Acc: 0.5521
 Site-Infograph                     | Train Loss: 1.6629 | Train Acc: 0.4444
Average Train Accuracy: 0.8135
 Site-Clipart                       | Val  Loss: 0.2062 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0629 | Val  Acc: 0.9867
 Site-Painting                      | Val  Loss: 0.3922 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.3332 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.4188 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.3821 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7916
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.0914 | Train Acc: 0.9841
 Site-Real                          | Train Loss: 0.0189 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.0909 | Train Acc: 0.9844
 Site-Sketch                        | Train Loss: 0.3377 | Train Acc: 0.8952
 Site-QuickDraw                     | Train Loss: 1.4410 | Train Acc: 0.5215
 Site-Infograph                     | Train Loss: 1.5738 | Train Acc: 0.4872
Average Train Accuracy: 0.8113
 Site-Clipart                       | Val  Loss: 0.1920 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0916 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.3888 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.3923 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.5536 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.2632 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7719
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.0861 | Train Acc: 0.9873
 Site-Real                          | Train Loss: 0.0182 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1245 | Train Acc: 0.9751
 Site-Sketch                        | Train Loss: 0.3294 | Train Acc: 0.8734
 Site-QuickDraw                     | Train Loss: 1.3351 | Train Acc: 0.5521
 Site-Infograph                     | Train Loss: 1.6736 | Train Acc: 0.4444
Average Train Accuracy: 0.8046
 Site-Clipart                       | Val  Loss: 0.2095 | Val  Acc: 0.9405
 Site-Real                          | Val  Loss: 0.0798 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.3134 | Val  Acc: 0.9112
 Site-Sketch                        | Val  Loss: 0.4060 | Val  Acc: 0.8758
 Site-QuickDraw                     | Val  Loss: 1.4132 | Val  Acc: 0.5321
 Site-Infograph                     | Val  Loss: 1.1803 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7941
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.9405
 Best site-Real                      | Epoch:36 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:36 | Val Acc: 0.9112
 Best site-Sketch                    | Epoch:36 | Val Acc: 0.8758
 Best site-QuickDraw                 | Epoch:36 | Val Acc: 0.5321
 Best site-Infograph                 | Epoch:36 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.1061 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0154 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.0938 | Train Acc: 0.9751
 Site-Sketch                        | Train Loss: 0.3313 | Train Acc: 0.9039
 Site-QuickDraw                     | Train Loss: 1.3281 | Train Acc: 0.5399
 Site-Infograph                     | Train Loss: 1.6087 | Train Acc: 0.4786
Average Train Accuracy: 0.8119
 Site-Clipart                       | Val  Loss: 0.2048 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0781 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4395 | Val  Acc: 0.9065
 Site-Sketch                        | Val  Loss: 0.3493 | Val  Acc: 0.8758
 Site-QuickDraw                     | Val  Loss: 1.4563 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3231 | Val  Acc: 0.4744
Average Valid Accuracy: 0.7759
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.0868 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0188 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.1043 | Train Acc: 0.9751
 Site-Sketch                        | Train Loss: 0.2778 | Train Acc: 0.9127
 Site-QuickDraw                     | Train Loss: 1.2633 | Train Acc: 0.5460
 Site-Infograph                     | Train Loss: 1.6391 | Train Acc: 0.4444
Average Train Accuracy: 0.8092
 Site-Clipart                       | Val  Loss: 0.1847 | Val  Acc: 0.9595
 Site-Real                          | Val  Loss: 0.0768 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3616 | Val  Acc: 0.9019
 Site-Sketch                        | Val  Loss: 0.3501 | Val  Acc: 0.8824
 Site-QuickDraw                     | Val  Loss: 1.5866 | Val  Acc: 0.5229
 Site-Infograph                     | Val  Loss: 1.1731 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7959
 Best site-Clipart                   | Epoch:38 | Val Acc: 0.9595
 Best site-Real                      | Epoch:38 | Val Acc: 0.9833
 Best site-Painting                  | Epoch:38 | Val Acc: 0.9019
 Best site-Sketch                    | Epoch:38 | Val Acc: 0.8824
 Best site-QuickDraw                 | Epoch:38 | Val Acc: 0.5229
 Best site-Infograph                 | Epoch:38 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.0902 | Train Acc: 0.9825
 Site-Real                          | Train Loss: 0.0181 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1006 | Train Acc: 0.9751
 Site-Sketch                        | Train Loss: 0.3257 | Train Acc: 0.9039
 Site-QuickDraw                     | Train Loss: 1.2997 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.5647 | Train Acc: 0.4957
Average Train Accuracy: 0.8042
 Site-Clipart                       | Val  Loss: 0.1756 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0735 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.3188 | Val  Acc: 0.9065
 Site-Sketch                        | Val  Loss: 0.3594 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.4486 | Val  Acc: 0.5321
 Site-Infograph                     | Val  Loss: 1.2137 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8005
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.9548
 Best site-Real                      | Epoch:39 | Val Acc: 0.9767
 Best site-Painting                  | Epoch:39 | Val Acc: 0.9065
 Best site-Sketch                    | Epoch:39 | Val Acc: 0.8431
 Best site-QuickDraw                 | Epoch:39 | Val Acc: 0.5321
 Best site-Infograph                 | Epoch:39 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.0898 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0164 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.1085 | Train Acc: 0.9782
 Site-Sketch                        | Train Loss: 0.3381 | Train Acc: 0.8996
 Site-QuickDraw                     | Train Loss: 1.3944 | Train Acc: 0.5153
 Site-Infograph                     | Train Loss: 1.5631 | Train Acc: 0.4957
Average Train Accuracy: 0.8106
 Site-Clipart                       | Val  Loss: 0.1618 | Val  Acc: 0.9476
 Site-Real                          | Val  Loss: 0.1150 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.3023 | Val  Acc: 0.9299
 Site-Sketch                        | Val  Loss: 0.3612 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.3846 | Val  Acc: 0.5413
 Site-Infograph                     | Val  Loss: 1.2738 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7940
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.0839 | Train Acc: 0.9810
 Site-Real                          | Train Loss: 0.0200 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.0696 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.3170 | Train Acc: 0.9258
 Site-QuickDraw                     | Train Loss: 1.4135 | Train Acc: 0.4908
 Site-Infograph                     | Train Loss: 1.6576 | Train Acc: 0.4444
Average Train Accuracy: 0.8031
 Site-Clipart                       | Val  Loss: 0.1893 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0890 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3472 | Val  Acc: 0.9065
 Site-Sketch                        | Val  Loss: 0.3510 | Val  Acc: 0.8824
 Site-QuickDraw                     | Val  Loss: 1.4622 | Val  Acc: 0.5046
 Site-Infograph                     | Val  Loss: 1.3303 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7976
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.0883 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0173 | Train Acc: 0.9933
 Site-Painting                      | Train Loss: 0.0726 | Train Acc: 0.9875
 Site-Sketch                        | Train Loss: 0.2925 | Train Acc: 0.9170
 Site-QuickDraw                     | Train Loss: 1.2883 | Train Acc: 0.5092
 Site-Infograph                     | Train Loss: 1.5069 | Train Acc: 0.4701
Average Train Accuracy: 0.8094
 Site-Clipart                       | Val  Loss: 0.1833 | Val  Acc: 0.9571
 Site-Real                          | Val  Loss: 0.0800 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3217 | Val  Acc: 0.9206
 Site-Sketch                        | Val  Loss: 0.4603 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.4060 | Val  Acc: 0.5505
 Site-Infograph                     | Val  Loss: 1.3550 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7919
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.0894 | Train Acc: 0.9825
 Site-Real                          | Train Loss: 0.0158 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.0907 | Train Acc: 0.9844
 Site-Sketch                        | Train Loss: 0.2783 | Train Acc: 0.9083
 Site-QuickDraw                     | Train Loss: 1.3075 | Train Acc: 0.5706
 Site-Infograph                     | Train Loss: 1.5701 | Train Acc: 0.4786
Average Train Accuracy: 0.8200
 Site-Clipart                       | Val  Loss: 0.1790 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.1137 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.3698 | Val  Acc: 0.9112
 Site-Sketch                        | Val  Loss: 0.3738 | Val  Acc: 0.8824
 Site-QuickDraw                     | Val  Loss: 1.4256 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.2485 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7918
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.0795 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0150 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.0800 | Train Acc: 0.9844
 Site-Sketch                        | Train Loss: 0.3033 | Train Acc: 0.9214
 Site-QuickDraw                     | Train Loss: 1.3446 | Train Acc: 0.5276
 Site-Infograph                     | Train Loss: 1.5186 | Train Acc: 0.4701
Average Train Accuracy: 0.8132
 Site-Clipart                       | Val  Loss: 0.1847 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0945 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.3310 | Val  Acc: 0.9159
 Site-Sketch                        | Val  Loss: 0.4287 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.3641 | Val  Acc: 0.5321
 Site-Infograph                     | Val  Loss: 1.2920 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7963
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.0783 | Train Acc: 0.9825
 Site-Real                          | Train Loss: 0.0157 | Train Acc: 0.9956
 Site-Painting                      | Train Loss: 0.0898 | Train Acc: 0.9844
 Site-Sketch                        | Train Loss: 0.3102 | Train Acc: 0.9083
 Site-QuickDraw                     | Train Loss: 1.3567 | Train Acc: 0.5399
 Site-Infograph                     | Train Loss: 1.6587 | Train Acc: 0.4530
Average Train Accuracy: 0.8106
 Site-Clipart                       | Val  Loss: 0.1812 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0819 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3565 | Val  Acc: 0.9159
 Site-Sketch                        | Val  Loss: 0.3462 | Val  Acc: 0.8954
 Site-QuickDraw                     | Val  Loss: 1.4029 | Val  Acc: 0.5229
 Site-Infograph                     | Val  Loss: 1.4201 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7912
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.0806 | Train Acc: 0.9794
 Site-Real                          | Train Loss: 0.0171 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.0690 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.3289 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.3431 | Train Acc: 0.5337
 Site-Infograph                     | Train Loss: 1.5106 | Train Acc: 0.4274
Average Train Accuracy: 0.8017
 Site-Clipart                       | Val  Loss: 0.1901 | Val  Acc: 0.9452
 Site-Real                          | Val  Loss: 0.0787 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.3291 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.3654 | Val  Acc: 0.8758
 Site-QuickDraw                     | Val  Loss: 1.3116 | Val  Acc: 0.5596
 Site-Infograph                     | Val  Loss: 1.2964 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7987
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.0954 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0124 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.0821 | Train Acc: 0.9720
 Site-Sketch                        | Train Loss: 0.3352 | Train Acc: 0.8996
 Site-QuickDraw                     | Train Loss: 1.2936 | Train Acc: 0.6074
 Site-Infograph                     | Train Loss: 1.5049 | Train Acc: 0.4786
Average Train Accuracy: 0.8219
 Site-Clipart                       | Val  Loss: 0.1958 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0903 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.3821 | Val  Acc: 0.9065
 Site-Sketch                        | Val  Loss: 0.3448 | Val  Acc: 0.8693
 Site-QuickDraw                     | Val  Loss: 1.4840 | Val  Acc: 0.5321
 Site-Infograph                     | Val  Loss: 1.2202 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7965
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.0886 | Train Acc: 0.9762
 Site-Real                          | Train Loss: 0.0164 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.1065 | Train Acc: 0.9813
 Site-Sketch                        | Train Loss: 0.3438 | Train Acc: 0.8908
 Site-QuickDraw                     | Train Loss: 1.3326 | Train Acc: 0.5521
 Site-Infograph                     | Train Loss: 1.5445 | Train Acc: 0.5043
Average Train Accuracy: 0.8171
 Site-Clipart                       | Val  Loss: 0.1890 | Val  Acc: 0.9500
 Site-Real                          | Val  Loss: 0.0706 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.3742 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.2685 | Val  Acc: 0.8954
 Site-QuickDraw                     | Val  Loss: 1.4747 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.2689 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8044
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9500
 Best site-Real                      | Epoch:48 | Val Acc: 0.9833
 Best site-Painting                  | Epoch:48 | Val Acc: 0.9252
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8954
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.4954
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/harmo-fl...
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.0893 | Train Acc: 0.9778
 Site-Real                          | Train Loss: 0.0135 | Train Acc: 0.9978
 Site-Painting                      | Train Loss: 0.0706 | Train Acc: 0.9875
 Site-Sketch                        | Train Loss: 0.2870 | Train Acc: 0.8996
 Site-QuickDraw                     | Train Loss: 1.3452 | Train Acc: 0.5337
 Site-Infograph                     | Train Loss: 1.5042 | Train Acc: 0.5128
Average Train Accuracy: 0.8182
 Site-Clipart                       | Val  Loss: 0.1796 | Val  Acc: 0.9548
 Site-Real                          | Val  Loss: 0.0657 | Val  Acc: 0.9867
 Site-Painting                      | Val  Loss: 0.3321 | Val  Acc: 0.9252
 Site-Sketch                        | Val  Loss: 0.4069 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.4296 | Val  Acc: 0.5046
 Site-Infograph                     | Val  Loss: 1.3739 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7986
===2023-07-02 11:14:26===
===2023-07-02 11:14:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:48 | Test Acc: 0.9449
 Test site-Real                      | Epoch:48 | Test Acc: 0.9622
 Test site-Painting                  | Epoch:48 | Test Acc: 0.9257
 Test site-Sketch                    | Epoch:48 | Test Acc: 0.8899
 Test site-QuickDraw                 | Epoch:48 | Test Acc: 0.6050
 Test site-Infograph                 | Epoch:48 | Test Acc: 0.5129
Clipart: 0.9449, Real: 0.9622, Painting: 0.9257, Sketch: 0.8899, QuickDraw: 0.6050, Infograph: 0.5129, 
Average Test Accuracy(group): 0.8068, Average Test Accuracy(individual): 0.8068,
domain std=0.1786, cluster std=-1.0000, individual std=0.1786, 
