===2023-07-02 06:21:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.1288 | Train Acc: 0.5683
 Site-Real                          | Train Loss: 2.1227 | Train Acc: 0.7444
 Site-Painting                      | Train Loss: 2.1015 | Train Acc: 0.6137
 Site-Sketch                        | Train Loss: 2.1401 | Train Acc: 0.5502
 Site-QuickDraw                     | Train Loss: 2.2694 | Train Acc: 0.1963
 Site-Infograph                     | Train Loss: 2.2674 | Train Acc: 0.2393
Average Train Accuracy: 0.4854
 Site-Clipart                       | Val  Loss: 2.1283 | Val  Acc: 0.5810
 Site-Real                          | Val  Loss: 2.0881 | Val  Acc: 0.7500
 Site-Painting                      | Val  Loss: 2.1179 | Val  Acc: 0.6262
 Site-Sketch                        | Val  Loss: 2.1413 | Val  Acc: 0.4967
 Site-QuickDraw                     | Val  Loss: 2.2627 | Val  Acc: 0.1927
 Site-Infograph                     | Val  Loss: 2.2816 | Val  Acc: 0.2692
Average Valid Accuracy: 0.4860
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.5810
 Best site-Real                      | Epoch:0 | Val Acc: 0.7500
 Best site-Painting                  | Epoch:0 | Val Acc: 0.6262
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.4967
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1927
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2692
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.9522 | Train Acc: 0.7270
 Site-Real                          | Train Loss: 1.8583 | Train Acc: 0.8956
 Site-Painting                      | Train Loss: 1.9944 | Train Acc: 0.7508
 Site-Sketch                        | Train Loss: 1.9736 | Train Acc: 0.6769
 Site-QuickDraw                     | Train Loss: 2.2345 | Train Acc: 0.2577
 Site-Infograph                     | Train Loss: 2.2104 | Train Acc: 0.3248
Average Train Accuracy: 0.6054
 Site-Clipart                       | Val  Loss: 1.9526 | Val  Acc: 0.7405
 Site-Real                          | Val  Loss: 1.8657 | Val  Acc: 0.9000
 Site-Painting                      | Val  Loss: 1.9438 | Val  Acc: 0.7477
 Site-Sketch                        | Val  Loss: 1.9734 | Val  Acc: 0.6536
 Site-QuickDraw                     | Val  Loss: 2.2264 | Val  Acc: 0.2752
 Site-Infograph                     | Val  Loss: 2.1795 | Val  Acc: 0.3718
Average Valid Accuracy: 0.6148
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7405
 Best site-Real                      | Epoch:1 | Val Acc: 0.9000
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7477
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6536
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2752
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3718
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.7869 | Train Acc: 0.7762
 Site-Real                          | Train Loss: 1.6523 | Train Acc: 0.9289
 Site-Painting                      | Train Loss: 1.7818 | Train Acc: 0.8069
 Site-Sketch                        | Train Loss: 1.8246 | Train Acc: 0.6900
 Site-QuickDraw                     | Train Loss: 2.1885 | Train Acc: 0.2822
 Site-Infograph                     | Train Loss: 2.1630 | Train Acc: 0.3419
Average Train Accuracy: 0.6377
 Site-Clipart                       | Val  Loss: 1.7841 | Val  Acc: 0.7738
 Site-Real                          | Val  Loss: 1.6595 | Val  Acc: 0.9167
 Site-Painting                      | Val  Loss: 1.7725 | Val  Acc: 0.8037
 Site-Sketch                        | Val  Loss: 1.7884 | Val  Acc: 0.6993
 Site-QuickDraw                     | Val  Loss: 2.1911 | Val  Acc: 0.2844
 Site-Infograph                     | Val  Loss: 2.1009 | Val  Acc: 0.4872
Average Valid Accuracy: 0.6609
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7738
 Best site-Real                      | Epoch:2 | Val Acc: 0.9167
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8037
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.6993
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.2844
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.6342 | Train Acc: 0.7825
 Site-Real                          | Train Loss: 1.4358 | Train Acc: 0.9356
 Site-Painting                      | Train Loss: 1.6803 | Train Acc: 0.8224
 Site-Sketch                        | Train Loss: 1.6573 | Train Acc: 0.7336
 Site-QuickDraw                     | Train Loss: 2.1521 | Train Acc: 0.3252
 Site-Infograph                     | Train Loss: 2.1150 | Train Acc: 0.3504
Average Train Accuracy: 0.6583
 Site-Clipart                       | Val  Loss: 1.6286 | Val  Acc: 0.7976
 Site-Real                          | Val  Loss: 1.4794 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 1.6139 | Val  Acc: 0.8131
 Site-Sketch                        | Val  Loss: 1.6471 | Val  Acc: 0.7386
 Site-QuickDraw                     | Val  Loss: 2.1606 | Val  Acc: 0.3119
 Site-Infograph                     | Val  Loss: 2.0222 | Val  Acc: 0.4487
Average Valid Accuracy: 0.6778
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7976
 Best site-Real                      | Epoch:3 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8131
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7386
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3119
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.4487
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.4955 | Train Acc: 0.8127
 Site-Real                          | Train Loss: 1.2971 | Train Acc: 0.9422
 Site-Painting                      | Train Loss: 1.3898 | Train Acc: 0.8100
 Site-Sketch                        | Train Loss: 1.5433 | Train Acc: 0.7424
 Site-QuickDraw                     | Train Loss: 2.1580 | Train Acc: 0.2945
 Site-Infograph                     | Train Loss: 2.0701 | Train Acc: 0.3333
Average Train Accuracy: 0.6558
 Site-Clipart                       | Val  Loss: 1.5004 | Val  Acc: 0.8214
 Site-Real                          | Val  Loss: 1.3133 | Val  Acc: 0.9333
 Site-Painting                      | Val  Loss: 1.4781 | Val  Acc: 0.8084
 Site-Sketch                        | Val  Loss: 1.5204 | Val  Acc: 0.7255
 Site-QuickDraw                     | Val  Loss: 2.1304 | Val  Acc: 0.3119
 Site-Infograph                     | Val  Loss: 1.9810 | Val  Acc: 0.3846
Average Valid Accuracy: 0.6642
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.3935 | Train Acc: 0.8063
 Site-Real                          | Train Loss: 1.1491 | Train Acc: 0.9378
 Site-Painting                      | Train Loss: 1.4777 | Train Acc: 0.8287
 Site-Sketch                        | Train Loss: 1.4170 | Train Acc: 0.7817
 Site-QuickDraw                     | Train Loss: 2.0971 | Train Acc: 0.3129
 Site-Infograph                     | Train Loss: 2.0539 | Train Acc: 0.3419
Average Train Accuracy: 0.6682
 Site-Clipart                       | Val  Loss: 1.3704 | Val  Acc: 0.8214
 Site-Real                          | Val  Loss: 1.1372 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.3761 | Val  Acc: 0.8037
 Site-Sketch                        | Val  Loss: 1.3720 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 2.1190 | Val  Acc: 0.3303
 Site-Infograph                     | Val  Loss: 1.9423 | Val  Acc: 0.4744
Average Valid Accuracy: 0.6886
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8214
 Best site-Real                      | Epoch:5 | Val Acc: 0.9500
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8037
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7516
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.3303
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4744
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.2589 | Train Acc: 0.8333
 Site-Real                          | Train Loss: 0.9840 | Train Acc: 0.9511
 Site-Painting                      | Train Loss: 1.1746 | Train Acc: 0.8505
 Site-Sketch                        | Train Loss: 1.3037 | Train Acc: 0.7642
 Site-QuickDraw                     | Train Loss: 2.0561 | Train Acc: 0.3436
 Site-Infograph                     | Train Loss: 1.9918 | Train Acc: 0.3590
Average Train Accuracy: 0.6836
 Site-Clipart                       | Val  Loss: 1.2745 | Val  Acc: 0.8333
 Site-Real                          | Val  Loss: 1.0179 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 1.2384 | Val  Acc: 0.8271
 Site-Sketch                        | Val  Loss: 1.3040 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 2.0928 | Val  Acc: 0.3119
 Site-Infograph                     | Val  Loss: 1.7934 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7033
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8333
 Best site-Real                      | Epoch:6 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8271
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7908
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3119
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.1708 | Train Acc: 0.8302
 Site-Real                          | Train Loss: 0.9275 | Train Acc: 0.9556
 Site-Painting                      | Train Loss: 1.1005 | Train Acc: 0.8380
 Site-Sketch                        | Train Loss: 1.2256 | Train Acc: 0.7729
 Site-QuickDraw                     | Train Loss: 2.0394 | Train Acc: 0.3436
 Site-Infograph                     | Train Loss: 1.9360 | Train Acc: 0.3675
Average Train Accuracy: 0.6846
 Site-Clipart                       | Val  Loss: 1.1636 | Val  Acc: 0.8333
 Site-Real                          | Val  Loss: 0.8940 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 1.1662 | Val  Acc: 0.8037
 Site-Sketch                        | Val  Loss: 1.1568 | Val  Acc: 0.7647
 Site-QuickDraw                     | Val  Loss: 2.0636 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.8033 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7022
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.0632 | Train Acc: 0.8540
 Site-Real                          | Train Loss: 0.7849 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.9031 | Train Acc: 0.8411
 Site-Sketch                        | Train Loss: 1.1253 | Train Acc: 0.7948
 Site-QuickDraw                     | Train Loss: 2.0351 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.9116 | Train Acc: 0.4017
Average Train Accuracy: 0.7071
 Site-Clipart                       | Val  Loss: 1.0830 | Val  Acc: 0.8357
 Site-Real                          | Val  Loss: 0.7792 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 1.0469 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 1.1621 | Val  Acc: 0.7582
 Site-QuickDraw                     | Val  Loss: 2.0210 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.6952 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7092
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8357
 Best site-Real                      | Epoch:8 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8505
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7582
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3670
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.9992 | Train Acc: 0.8603
 Site-Real                          | Train Loss: 0.6665 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.9726 | Train Acc: 0.8474
 Site-Sketch                        | Train Loss: 1.0489 | Train Acc: 0.7948
 Site-QuickDraw                     | Train Loss: 1.9962 | Train Acc: 0.3742
 Site-Infograph                     | Train Loss: 1.9009 | Train Acc: 0.3504
Average Train Accuracy: 0.6982
 Site-Clipart                       | Val  Loss: 1.0038 | Val  Acc: 0.8571
 Site-Real                          | Val  Loss: 0.7069 | Val  Acc: 0.9467
 Site-Painting                      | Val  Loss: 1.0033 | Val  Acc: 0.8271
 Site-Sketch                        | Val  Loss: 1.0068 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 2.0437 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 1.6306 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7124
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8571
 Best site-Real                      | Epoch:9 | Val Acc: 0.9467
 Best site-Painting                  | Epoch:9 | Val Acc: 0.8271
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.3394
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.9271 | Train Acc: 0.8683
 Site-Real                          | Train Loss: 0.6595 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.9702 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 1.0077 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.9557 | Train Acc: 0.3681
 Site-Infograph                     | Train Loss: 1.9012 | Train Acc: 0.4017
Average Train Accuracy: 0.7128
 Site-Clipart                       | Val  Loss: 0.9574 | Val  Acc: 0.8595
 Site-Real                          | Val  Loss: 0.6093 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.8901 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.9707 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 1.9985 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.6892 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7130
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8595
 Best site-Real                      | Epoch:10 | Val Acc: 0.9633
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8458
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7516
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.8707 | Train Acc: 0.8698
 Site-Real                          | Train Loss: 0.5308 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.8291 | Train Acc: 0.8660
 Site-Sketch                        | Train Loss: 0.9593 | Train Acc: 0.7948
 Site-QuickDraw                     | Train Loss: 1.9421 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.8405 | Train Acc: 0.3932
Average Train Accuracy: 0.7077
 Site-Clipart                       | Val  Loss: 0.9026 | Val  Acc: 0.8595
 Site-Real                          | Val  Loss: 0.5819 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.8322 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.9126 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.9684 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.5809 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7239
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.8595
 Best site-Real                      | Epoch:11 | Val Acc: 0.9600
 Best site-Painting                  | Epoch:11 | Val Acc: 0.8458
 Best site-Sketch                    | Epoch:11 | Val Acc: 0.7908
 Best site-QuickDraw                 | Epoch:11 | Val Acc: 0.3486
 Best site-Infograph                 | Epoch:11 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8066 | Train Acc: 0.8825
 Site-Real                          | Train Loss: 0.4862 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.6865 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.9012 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.9138 | Train Acc: 0.4110
 Site-Infograph                     | Train Loss: 1.8029 | Train Acc: 0.4103
Average Train Accuracy: 0.7231
 Site-Clipart                       | Val  Loss: 0.8432 | Val  Acc: 0.8619
 Site-Real                          | Val  Loss: 0.5162 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 0.8160 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.8627 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.9725 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.5844 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7235
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.7889 | Train Acc: 0.8635
 Site-Real                          | Train Loss: 0.5354 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.6739 | Train Acc: 0.8660
 Site-Sketch                        | Train Loss: 0.8501 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.9599 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.8247 | Train Acc: 0.4017
Average Train Accuracy: 0.7103
 Site-Clipart                       | Val  Loss: 0.8149 | Val  Acc: 0.8500
 Site-Real                          | Val  Loss: 0.4881 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 0.7559 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.8731 | Val  Acc: 0.7582
 Site-QuickDraw                     | Val  Loss: 1.9331 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.5331 | Val  Acc: 0.4744
Average Valid Accuracy: 0.7068
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.7506 | Train Acc: 0.8651
 Site-Real                          | Train Loss: 0.4156 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.8734 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 0.8586 | Train Acc: 0.7991
 Site-QuickDraw                     | Train Loss: 1.9557 | Train Acc: 0.3804
 Site-Infograph                     | Train Loss: 1.8012 | Train Acc: 0.3761
Average Train Accuracy: 0.7067
 Site-Clipart                       | Val  Loss: 0.7491 | Val  Acc: 0.8738
 Site-Real                          | Val  Loss: 0.4471 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.7490 | Val  Acc: 0.8318
 Site-Sketch                        | Val  Loss: 0.8094 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.9651 | Val  Acc: 0.2936
 Site-Infograph                     | Val  Loss: 1.4961 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7126
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.7109 | Train Acc: 0.8873
 Site-Real                          | Train Loss: 0.3837 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.7930 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.8324 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.9618 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.7752 | Train Acc: 0.4359
Average Train Accuracy: 0.7216
 Site-Clipart                       | Val  Loss: 0.7482 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.3987 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.7231 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.8029 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.8945 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 1.4010 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7220
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.6814 | Train Acc: 0.8921
 Site-Real                          | Train Loss: 0.3443 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.7747 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 0.7882 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.9485 | Train Acc: 0.3374
 Site-Infograph                     | Train Loss: 1.7509 | Train Acc: 0.4188
Average Train Accuracy: 0.7174
 Site-Clipart                       | Val  Loss: 0.6741 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.3816 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.6925 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.7679 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.9394 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 1.4514 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7238
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.6418 | Train Acc: 0.8952
 Site-Real                          | Train Loss: 0.4113 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.5154 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.7669 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.8853 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.7694 | Train Acc: 0.4017
Average Train Accuracy: 0.7230
 Site-Clipart                       | Val  Loss: 0.6663 | Val  Acc: 0.8690
 Site-Real                          | Val  Loss: 0.3650 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.7197 | Val  Acc: 0.8271
 Site-Sketch                        | Val  Loss: 0.7434 | Val  Acc: 0.7582
 Site-QuickDraw                     | Val  Loss: 1.9016 | Val  Acc: 0.3303
 Site-Infograph                     | Val  Loss: 1.4201 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7090
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.6220 | Train Acc: 0.8778
 Site-Real                          | Train Loss: 0.3151 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.5151 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 0.7596 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.8532 | Train Acc: 0.3804
 Site-Infograph                     | Train Loss: 1.7386 | Train Acc: 0.4017
Average Train Accuracy: 0.7192
 Site-Clipart                       | Val  Loss: 0.6473 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.3253 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.6682 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.7347 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8834 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.3378 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7283
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.8857
 Best site-Real                      | Epoch:18 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:18 | Val Acc: 0.8364
 Best site-Sketch                    | Epoch:18 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:18 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:18 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.5994 | Train Acc: 0.8968
 Site-Real                          | Train Loss: 0.4314 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.5202 | Train Acc: 0.8723
 Site-Sketch                        | Train Loss: 0.7772 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 1.9171 | Train Acc: 0.3804
 Site-Infograph                     | Train Loss: 1.7597 | Train Acc: 0.4188
Average Train Accuracy: 0.7220
 Site-Clipart                       | Val  Loss: 0.6155 | Val  Acc: 0.8881
 Site-Real                          | Val  Loss: 0.3180 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.6368 | Val  Acc: 0.8411
 Site-Sketch                        | Val  Loss: 0.7270 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.8814 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.3462 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7380
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.8881
 Best site-Real                      | Epoch:19 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:19 | Val Acc: 0.8411
 Best site-Sketch                    | Epoch:19 | Val Acc: 0.7778
 Best site-QuickDraw                 | Epoch:19 | Val Acc: 0.4128
 Best site-Infograph                 | Epoch:19 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.5851 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.2692 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.8587 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.7522 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.8856 | Train Acc: 0.3620
 Site-Infograph                     | Train Loss: 1.7416 | Train Acc: 0.3932
Average Train Accuracy: 0.7175
 Site-Clipart                       | Val  Loss: 0.5902 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.3143 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.6218 | Val  Acc: 0.8411
 Site-Sketch                        | Val  Loss: 0.7061 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8754 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.3793 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7301
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.5590 | Train Acc: 0.9000
 Site-Real                          | Train Loss: 0.3924 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.6419 | Train Acc: 0.8847
 Site-Sketch                        | Train Loss: 0.7077 | Train Acc: 0.8079
 Site-QuickDraw                     | Train Loss: 1.8162 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.6977 | Train Acc: 0.4444
Average Train Accuracy: 0.7386
 Site-Clipart                       | Val  Loss: 0.5771 | Val  Acc: 0.8976
 Site-Real                          | Val  Loss: 0.2959 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5978 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6582 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8671 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3874 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7499
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.8976
 Best site-Real                      | Epoch:21 | Val Acc: 0.9600
 Best site-Painting                  | Epoch:21 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.3945
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.5160 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.2328 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4657 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.6754 | Train Acc: 0.8253
 Site-QuickDraw                     | Train Loss: 1.7982 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.7222 | Train Acc: 0.4359
Average Train Accuracy: 0.7340
 Site-Clipart                       | Val  Loss: 0.5741 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2694 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5988 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6699 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.7962 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.2334 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7441
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.5328 | Train Acc: 0.9016
 Site-Real                          | Train Loss: 0.2713 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.4292 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.7056 | Train Acc: 0.7991
 Site-QuickDraw                     | Train Loss: 1.7863 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.6785 | Train Acc: 0.4188
Average Train Accuracy: 0.7398
 Site-Clipart                       | Val  Loss: 0.5499 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2768 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.5983 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6331 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8566 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.4114 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7429
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.5097 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.2176 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.7521 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.6576 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.8003 | Train Acc: 0.4049
 Site-Infograph                     | Train Loss: 1.6854 | Train Acc: 0.4274
Average Train Accuracy: 0.7348
 Site-Clipart                       | Val  Loss: 0.5270 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.2366 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5887 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.6227 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.7987 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.4079 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7472
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.5165 | Train Acc: 0.9016
 Site-Real                          | Train Loss: 0.2083 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.4298 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.6440 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.8269 | Train Acc: 0.3742
 Site-Infograph                     | Train Loss: 1.6442 | Train Acc: 0.4359
Average Train Accuracy: 0.7278
 Site-Clipart                       | Val  Loss: 0.5292 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2282 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5519 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6431 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7700 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.3666 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7510
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9000
 Best site-Real                      | Epoch:25 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:25 | Val Acc: 0.8458
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.4220
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.4926 | Train Acc: 0.9159
 Site-Real                          | Train Loss: 0.2776 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.4731 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.6518 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.7891 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.7144 | Train Acc: 0.4359
Average Train Accuracy: 0.7377
 Site-Clipart                       | Val  Loss: 0.5124 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.2259 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5720 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.6173 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.8075 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3548 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7541
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.9048
 Best site-Real                      | Epoch:26 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:26 | Val Acc: 0.8505
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.8497
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.3853
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.4635 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.1896 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.5104 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6452 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.7757 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6660 | Train Acc: 0.4444
Average Train Accuracy: 0.7465
 Site-Clipart                       | Val  Loss: 0.5198 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2252 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5302 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.5871 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.7913 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3156 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7445
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.4263 | Train Acc: 0.9238
 Site-Real                          | Train Loss: 0.1905 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.5748 | Train Acc: 0.8847
 Site-Sketch                        | Train Loss: 0.6428 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.8170 | Train Acc: 0.4110
 Site-Infograph                     | Train Loss: 1.6849 | Train Acc: 0.4103
Average Train Accuracy: 0.7388
 Site-Clipart                       | Val  Loss: 0.4752 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.2379 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5382 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6327 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7877 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.4942 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7427
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.4397 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.1744 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.4419 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.5789 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.7676 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.7174 | Train Acc: 0.4274
Average Train Accuracy: 0.7465
 Site-Clipart                       | Val  Loss: 0.4862 | Val  Acc: 0.8881
 Site-Real                          | Val  Loss: 0.2405 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.5925 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6153 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.8149 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3529 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7352
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.4261 | Train Acc: 0.9270
 Site-Real                          | Train Loss: 0.1739 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.3722 | Train Acc: 0.8847
 Site-Sketch                        | Train Loss: 0.6202 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.7817 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.6576 | Train Acc: 0.4274
Average Train Accuracy: 0.7450
 Site-Clipart                       | Val  Loss: 0.4613 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.2149 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5242 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.6428 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7747 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3405 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7563
 Best site-Clipart                   | Epoch:30 | Val Acc: 0.9048
 Best site-Real                      | Epoch:30 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:30 | Val Acc: 0.8785
 Best site-Sketch                    | Epoch:30 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:30 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:30 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.4206 | Train Acc: 0.9159
 Site-Real                          | Train Loss: 0.1677 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.4894 | Train Acc: 0.8723
 Site-Sketch                        | Train Loss: 0.6329 | Train Acc: 0.8079
 Site-QuickDraw                     | Train Loss: 1.7785 | Train Acc: 0.4356
 Site-Infograph                     | Train Loss: 1.6251 | Train Acc: 0.4615
Average Train Accuracy: 0.7455
 Site-Clipart                       | Val  Loss: 0.4722 | Val  Acc: 0.9071
 Site-Real                          | Val  Loss: 0.2024 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5034 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5348 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8106 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3877 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7472
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.4038 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1614 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.5761 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.5965 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.7650 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6697 | Train Acc: 0.4444
Average Train Accuracy: 0.7478
 Site-Clipart                       | Val  Loss: 0.4643 | Val  Acc: 0.9095
 Site-Real                          | Val  Loss: 0.1941 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4843 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.6098 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7930 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3394 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7492
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.4167 | Train Acc: 0.9254
 Site-Real                          | Train Loss: 0.1605 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.4991 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.5958 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.7511 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6110 | Train Acc: 0.4188
Average Train Accuracy: 0.7518
 Site-Clipart                       | Val  Loss: 0.4679 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.1894 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5036 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.5865 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7391 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.2453 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7636
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9048
 Best site-Real                      | Epoch:33 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:33 | Val Acc: 0.8645
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.4167 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.1537 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.3528 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.5920 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.7556 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6485 | Train Acc: 0.4530
Average Train Accuracy: 0.7539
 Site-Clipart                       | Val  Loss: 0.4186 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1997 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5122 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.5539 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7653 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.3213 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7622
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.3772 | Train Acc: 0.9349
 Site-Real                          | Train Loss: 0.1933 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3583 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.6146 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.6685 | Train Acc: 0.4417
 Site-Infograph                     | Train Loss: 1.6104 | Train Acc: 0.4444
Average Train Accuracy: 0.7552
 Site-Clipart                       | Val  Loss: 0.4203 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.1950 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.5334 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.6049 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7529 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3306 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7505
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.3679 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1398 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.5426 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.5378 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.7537 | Train Acc: 0.3988
 Site-Infograph                     | Train Loss: 1.5630 | Train Acc: 0.4444
Average Train Accuracy: 0.7502
 Site-Clipart                       | Val  Loss: 0.3835 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1846 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4487 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.5398 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.8011 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.2136 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7547
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.3623 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1529 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.5081 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.5772 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.6729 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6419 | Train Acc: 0.4017
Average Train Accuracy: 0.7456
 Site-Clipart                       | Val  Loss: 0.3937 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1832 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4928 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.5614 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.6961 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.4212 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7473
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3443 | Train Acc: 0.9349
 Site-Real                          | Train Loss: 0.1305 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3182 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.6015 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.7094 | Train Acc: 0.4110
 Site-Infograph                     | Train Loss: 1.6135 | Train Acc: 0.4615
Average Train Accuracy: 0.7563
 Site-Clipart                       | Val  Loss: 0.4206 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1696 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4818 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.5459 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.7928 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3656 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7557
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.3622 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1337 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.2945 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5505 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.7194 | Train Acc: 0.4540
 Site-Infograph                     | Train Loss: 1.5817 | Train Acc: 0.4274
Average Train Accuracy: 0.7564
 Site-Clipart                       | Val  Loss: 0.4070 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.1868 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4569 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5165 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.7591 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.2742 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7538
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3707 | Train Acc: 0.9317
 Site-Real                          | Train Loss: 0.1337 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3125 | Train Acc: 0.9128
 Site-Sketch                        | Train Loss: 0.6012 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.7270 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.6533 | Train Acc: 0.4359
Average Train Accuracy: 0.7501
 Site-Clipart                       | Val  Loss: 0.4059 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1831 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4737 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.4973 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7338 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.2449 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7557
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.3491 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1274 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3326 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.5269 | Train Acc: 0.8515
 Site-QuickDraw                     | Train Loss: 1.7035 | Train Acc: 0.4417
 Site-Infograph                     | Train Loss: 1.6131 | Train Acc: 0.4530
Average Train Accuracy: 0.7599
 Site-Clipart                       | Val  Loss: 0.3978 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.1639 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4794 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5878 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7367 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.2906 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7560
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.3503 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.1789 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.4057 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.4996 | Train Acc: 0.8559
 Site-QuickDraw                     | Train Loss: 1.6401 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.6336 | Train Acc: 0.4615
Average Train Accuracy: 0.7633
 Site-Clipart                       | Val  Loss: 0.3903 | Val  Acc: 0.9310
 Site-Real                          | Val  Loss: 0.1738 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4258 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.5667 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.7131 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.3654 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7654
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.9310
 Best site-Real                      | Epoch:42 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:42 | Val Acc: 0.8832
 Best site-Sketch                    | Epoch:42 | Val Acc: 0.8366
 Best site-QuickDraw                 | Epoch:42 | Val Acc: 0.4495
 Best site-Infograph                 | Epoch:42 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.3307 | Train Acc: 0.9349
 Site-Real                          | Train Loss: 0.1199 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3167 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.5874 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.6959 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.6302 | Train Acc: 0.4274
Average Train Accuracy: 0.7485
 Site-Clipart                       | Val  Loss: 0.3824 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1479 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4599 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5159 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7265 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.2584 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7547
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3270 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.2451 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3116 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.5136 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.6484 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6272 | Train Acc: 0.4530
Average Train Accuracy: 0.7640
 Site-Clipart                       | Val  Loss: 0.3780 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1573 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4662 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.5489 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7063 | Val  Acc: 0.4312
 Site-Infograph                     | Val  Loss: 1.1822 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7645
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.3347 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1204 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3850 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.5348 | Train Acc: 0.8559
 Site-QuickDraw                     | Train Loss: 1.7083 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6050 | Train Acc: 0.4274
Average Train Accuracy: 0.7584
 Site-Clipart                       | Val  Loss: 0.3694 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.1520 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.4616 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.5119 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6892 | Val  Acc: 0.4404
 Site-Infograph                     | Val  Loss: 1.2472 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7642
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.3152 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1477 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.3062 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5865 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.6484 | Train Acc: 0.4908
 Site-Infograph                     | Train Loss: 1.5812 | Train Acc: 0.4701
Average Train Accuracy: 0.7703
 Site-Clipart                       | Val  Loss: 0.3601 | Val  Acc: 0.9310
 Site-Real                          | Val  Loss: 0.1570 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4510 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5233 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.7121 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.3376 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7639
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.2976 | Train Acc: 0.9524
 Site-Real                          | Train Loss: 0.1033 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.2986 | Train Acc: 0.9128
 Site-Sketch                        | Train Loss: 0.5536 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.5992 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.6180 | Train Acc: 0.4444
Average Train Accuracy: 0.7678
 Site-Clipart                       | Val  Loss: 0.3666 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1490 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4626 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.5221 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7142 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.2398 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7583
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3008 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1064 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.5690 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.5529 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6469 | Train Acc: 0.4417
 Site-Infograph                     | Train Loss: 1.6057 | Train Acc: 0.4444
Average Train Accuracy: 0.7578
 Site-Clipart                       | Val  Loss: 0.3673 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1375 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4721 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.5024 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.7360 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.2425 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7649
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3178 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1218 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.2722 | Train Acc: 0.9159
 Site-Sketch                        | Train Loss: 0.4952 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.6146 | Train Acc: 0.5031
 Site-Infograph                     | Train Loss: 1.5783 | Train Acc: 0.4530
Average Train Accuracy: 0.7725
 Site-Clipart                       | Val  Loss: 0.3524 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1502 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4293 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.5161 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7029 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.1958 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7699
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.9190
 Best site-Real                      | Epoch:49 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:49 | Val Acc: 0.8551
 Best site-Sketch                    | Epoch:49 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:49 | Val Acc: 0.4587
 Best site-Infograph                 | Epoch:49 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/fedavg...
===2023-07-02 07:05:46===
===2023-07-02 07:05:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:49 | Test Acc: 0.9392
 Test site-Real                      | Epoch:49 | Test Acc: 0.9680
 Test site-Painting                  | Epoch:49 | Test Acc: 0.9063
 Test site-Sketch                    | Epoch:49 | Test Acc: 0.8899
 Test site-QuickDraw                 | Epoch:49 | Test Acc: 0.5680
 Test site-Infograph                 | Epoch:49 | Test Acc: 0.5236
Clipart: 0.9392, Real: 0.9680, Painting: 0.9063, Sketch: 0.8899, QuickDraw: 0.5680, Infograph: 0.5236, 
Average Test Accuracy(group): 0.7992, Average Test Accuracy(individual): 0.7992,
domain std=0.1813, cluster std=-1.0000, individual std=0.1813, 
