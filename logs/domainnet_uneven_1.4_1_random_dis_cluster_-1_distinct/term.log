===2023-07-02 08:36:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.1088 | Train Acc: 0.5794
 Site-Real                          | Train Loss: 2.0573 | Train Acc: 0.8044
 Site-Painting                      | Train Loss: 2.0536 | Train Acc: 0.6604
 Site-Sketch                        | Train Loss: 2.1264 | Train Acc: 0.5633
 Site-QuickDraw                     | Train Loss: 2.2766 | Train Acc: 0.1350
 Site-Infograph                     | Train Loss: 2.2394 | Train Acc: 0.2479
Average Train Accuracy: 0.4984
 Site-Clipart                       | Val  Loss: 2.1095 | Val  Acc: 0.6071
 Site-Real                          | Val  Loss: 2.0460 | Val  Acc: 0.8133
 Site-Painting                      | Val  Loss: 2.0964 | Val  Acc: 0.6215
 Site-Sketch                        | Val  Loss: 2.1163 | Val  Acc: 0.6013
 Site-QuickDraw                     | Val  Loss: 2.2591 | Val  Acc: 0.1376
 Site-Infograph                     | Val  Loss: 2.2281 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5105
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6071
 Best site-Real                      | Epoch:0 | Val Acc: 0.8133
 Best site-Painting                  | Epoch:0 | Val Acc: 0.6215
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.6013
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1376
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.9363 | Train Acc: 0.7000
 Site-Real                          | Train Loss: 1.8473 | Train Acc: 0.8778
 Site-Painting                      | Train Loss: 1.8789 | Train Acc: 0.7664
 Site-Sketch                        | Train Loss: 1.9608 | Train Acc: 0.6463
 Site-QuickDraw                     | Train Loss: 2.2494 | Train Acc: 0.1472
 Site-Infograph                     | Train Loss: 2.1999 | Train Acc: 0.2821
Average Train Accuracy: 0.5700
 Site-Clipart                       | Val  Loss: 1.9394 | Val  Acc: 0.7119
 Site-Real                          | Val  Loss: 1.8334 | Val  Acc: 0.8833
 Site-Painting                      | Val  Loss: 1.9109 | Val  Acc: 0.7710
 Site-Sketch                        | Val  Loss: 1.9639 | Val  Acc: 0.6536
 Site-QuickDraw                     | Val  Loss: 2.2259 | Val  Acc: 0.2110
 Site-Infograph                     | Val  Loss: 2.1351 | Val  Acc: 0.3718
Average Valid Accuracy: 0.6004
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7119
 Best site-Real                      | Epoch:1 | Val Acc: 0.8833
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7710
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6536
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2110
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3718
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.7728 | Train Acc: 0.7603
 Site-Real                          | Train Loss: 1.6277 | Train Acc: 0.9156
 Site-Painting                      | Train Loss: 1.7455 | Train Acc: 0.8069
 Site-Sketch                        | Train Loss: 1.7960 | Train Acc: 0.6987
 Site-QuickDraw                     | Train Loss: 2.2037 | Train Acc: 0.2393
 Site-Infograph                     | Train Loss: 2.1591 | Train Acc: 0.2906
Average Train Accuracy: 0.6185
 Site-Clipart                       | Val  Loss: 1.7832 | Val  Acc: 0.7690
 Site-Real                          | Val  Loss: 1.6289 | Val  Acc: 0.9067
 Site-Painting                      | Val  Loss: 1.7478 | Val  Acc: 0.7991
 Site-Sketch                        | Val  Loss: 1.8067 | Val  Acc: 0.7124
 Site-QuickDraw                     | Val  Loss: 2.1931 | Val  Acc: 0.1743
 Site-Infograph                     | Val  Loss: 2.0785 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6286
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7690
 Best site-Real                      | Epoch:2 | Val Acc: 0.9067
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7991
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7124
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.1743
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.6253 | Train Acc: 0.7841
 Site-Real                          | Train Loss: 1.4268 | Train Acc: 0.9267
 Site-Painting                      | Train Loss: 1.6265 | Train Acc: 0.8193
 Site-Sketch                        | Train Loss: 1.6606 | Train Acc: 0.7336
 Site-QuickDraw                     | Train Loss: 2.1631 | Train Acc: 0.2761
 Site-Infograph                     | Train Loss: 2.1032 | Train Acc: 0.3162
Average Train Accuracy: 0.6427
 Site-Clipart                       | Val  Loss: 1.6286 | Val  Acc: 0.7738
 Site-Real                          | Val  Loss: 1.4412 | Val  Acc: 0.9267
 Site-Painting                      | Val  Loss: 1.5907 | Val  Acc: 0.8131
 Site-Sketch                        | Val  Loss: 1.6633 | Val  Acc: 0.7255
 Site-QuickDraw                     | Val  Loss: 2.1387 | Val  Acc: 0.3303
 Site-Infograph                     | Val  Loss: 2.0089 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6611
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7738
 Best site-Real                      | Epoch:3 | Val Acc: 0.9267
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8131
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7255
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3303
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3974
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.4808 | Train Acc: 0.8032
 Site-Real                          | Train Loss: 1.2459 | Train Acc: 0.9400
 Site-Painting                      | Train Loss: 1.3407 | Train Acc: 0.8224
 Site-Sketch                        | Train Loss: 1.5662 | Train Acc: 0.7511
 Site-QuickDraw                     | Train Loss: 2.1294 | Train Acc: 0.3129
 Site-Infograph                     | Train Loss: 2.0433 | Train Acc: 0.3932
Average Train Accuracy: 0.6705
 Site-Clipart                       | Val  Loss: 1.5061 | Val  Acc: 0.8000
 Site-Real                          | Val  Loss: 1.2629 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 1.4896 | Val  Acc: 0.7991
 Site-Sketch                        | Val  Loss: 1.5160 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 2.1073 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.9632 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6772
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8000
 Best site-Real                      | Epoch:4 | Val Acc: 0.9533
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7991
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7516
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3486
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.3592 | Train Acc: 0.8206
 Site-Real                          | Train Loss: 1.1521 | Train Acc: 0.9467
 Site-Painting                      | Train Loss: 1.2192 | Train Acc: 0.8442
 Site-Sketch                        | Train Loss: 1.4155 | Train Acc: 0.7511
 Site-QuickDraw                     | Train Loss: 2.0982 | Train Acc: 0.3374
 Site-Infograph                     | Train Loss: 1.9802 | Train Acc: 0.4103
Average Train Accuracy: 0.6851
 Site-Clipart                       | Val  Loss: 1.3693 | Val  Acc: 0.8286
 Site-Real                          | Val  Loss: 1.1222 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 1.3500 | Val  Acc: 0.8224
 Site-Sketch                        | Val  Loss: 1.3651 | Val  Acc: 0.7712
 Site-QuickDraw                     | Val  Loss: 2.0863 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.8466 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7051
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8286
 Best site-Real                      | Epoch:5 | Val Acc: 0.9600
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8224
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7712
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.3486
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.2542 | Train Acc: 0.8492
 Site-Real                          | Train Loss: 1.0456 | Train Acc: 0.9489
 Site-Painting                      | Train Loss: 1.0863 | Train Acc: 0.8567
 Site-Sketch                        | Train Loss: 1.3178 | Train Acc: 0.7424
 Site-QuickDraw                     | Train Loss: 2.0904 | Train Acc: 0.2883
 Site-Infograph                     | Train Loss: 1.9484 | Train Acc: 0.4017
Average Train Accuracy: 0.6812
 Site-Clipart                       | Val  Loss: 1.2632 | Val  Acc: 0.8405
 Site-Real                          | Val  Loss: 0.9775 | Val  Acc: 0.9467
 Site-Painting                      | Val  Loss: 1.2414 | Val  Acc: 0.8318
 Site-Sketch                        | Val  Loss: 1.3428 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 2.0715 | Val  Acc: 0.3119
 Site-Infograph                     | Val  Loss: 1.7364 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7058
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8405
 Best site-Real                      | Epoch:6 | Val Acc: 0.9467
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8318
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7908
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3119
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.1439 | Train Acc: 0.8508
 Site-Real                          | Train Loss: 0.8537 | Train Acc: 0.9533
 Site-Painting                      | Train Loss: 0.9992 | Train Acc: 0.8380
 Site-Sketch                        | Train Loss: 1.1572 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 2.0531 | Train Acc: 0.3436
 Site-Infograph                     | Train Loss: 1.9054 | Train Acc: 0.4103
Average Train Accuracy: 0.6970
 Site-Clipart                       | Val  Loss: 1.1663 | Val  Acc: 0.8333
 Site-Real                          | Val  Loss: 0.8737 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 1.0933 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 1.2274 | Val  Acc: 0.7582
 Site-QuickDraw                     | Val  Loss: 2.0633 | Val  Acc: 0.3211
 Site-Infograph                     | Val  Loss: 1.7433 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7027
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.0779 | Train Acc: 0.8397
 Site-Real                          | Train Loss: 0.7439 | Train Acc: 0.9556
 Site-Painting                      | Train Loss: 0.9109 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 1.1646 | Train Acc: 0.7817
 Site-QuickDraw                     | Train Loss: 2.0324 | Train Acc: 0.3067
 Site-Infograph                     | Train Loss: 1.9037 | Train Acc: 0.4188
Average Train Accuracy: 0.6937
 Site-Clipart                       | Val  Loss: 1.0776 | Val  Acc: 0.8500
 Site-Real                          | Val  Loss: 0.7746 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.0370 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 1.1158 | Val  Acc: 0.7647
 Site-QuickDraw                     | Val  Loss: 2.0018 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.7320 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7152
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8500
 Best site-Real                      | Epoch:8 | Val Acc: 0.9500
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7647
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3670
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.0036 | Train Acc: 0.8508
 Site-Real                          | Train Loss: 0.6438 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.9129 | Train Acc: 0.8505
 Site-Sketch                        | Train Loss: 1.0825 | Train Acc: 0.7336
 Site-QuickDraw                     | Train Loss: 1.9740 | Train Acc: 0.3681
 Site-Infograph                     | Train Loss: 1.8597 | Train Acc: 0.3675
Average Train Accuracy: 0.6888
 Site-Clipart                       | Val  Loss: 1.0029 | Val  Acc: 0.8476
 Site-Real                          | Val  Loss: 0.6855 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.9954 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 1.0941 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 2.0289 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.6722 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7115
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.9395 | Train Acc: 0.8587
 Site-Real                          | Train Loss: 0.6468 | Train Acc: 0.9578
 Site-Painting                      | Train Loss: 0.8255 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 1.0168 | Train Acc: 0.7948
 Site-QuickDraw                     | Train Loss: 1.9809 | Train Acc: 0.3497
 Site-Infograph                     | Train Loss: 1.8034 | Train Acc: 0.4103
Average Train Accuracy: 0.7083
 Site-Clipart                       | Val  Loss: 0.9308 | Val  Acc: 0.8738
 Site-Real                          | Val  Loss: 0.6152 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.8986 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 1.0070 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.9881 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.5424 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7306
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8738
 Best site-Real                      | Epoch:10 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7843
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.8687 | Train Acc: 0.8619
 Site-Real                          | Train Loss: 0.5075 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.8504 | Train Acc: 0.8723
 Site-Sketch                        | Train Loss: 0.9411 | Train Acc: 0.7817
 Site-QuickDraw                     | Train Loss: 1.9486 | Train Acc: 0.3620
 Site-Infograph                     | Train Loss: 1.8168 | Train Acc: 0.3932
Average Train Accuracy: 0.7059
 Site-Clipart                       | Val  Loss: 0.8763 | Val  Acc: 0.8548
 Site-Real                          | Val  Loss: 0.5521 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.8772 | Val  Acc: 0.8271
 Site-Sketch                        | Val  Loss: 0.9526 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.9950 | Val  Acc: 0.3394
 Site-Infograph                     | Val  Loss: 1.5427 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7169
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8327 | Train Acc: 0.8651
 Site-Real                          | Train Loss: 0.4646 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.6657 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 0.9379 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.9677 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.7917 | Train Acc: 0.3932
Average Train Accuracy: 0.7055
 Site-Clipart                       | Val  Loss: 0.8491 | Val  Acc: 0.8524
 Site-Real                          | Val  Loss: 0.5189 | Val  Acc: 0.9467
 Site-Painting                      | Val  Loss: 0.8367 | Val  Acc: 0.8318
 Site-Sketch                        | Val  Loss: 0.9042 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.9515 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.6054 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7227
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.7975 | Train Acc: 0.8524
 Site-Real                          | Train Loss: 0.4435 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.6443 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 0.8910 | Train Acc: 0.7991
 Site-QuickDraw                     | Train Loss: 1.9268 | Train Acc: 0.3988
 Site-Infograph                     | Train Loss: 1.7733 | Train Acc: 0.4701
Average Train Accuracy: 0.7241
 Site-Clipart                       | Val  Loss: 0.8217 | Val  Acc: 0.8524
 Site-Real                          | Val  Loss: 0.4592 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.7443 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.8803 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.9656 | Val  Acc: 0.3303
 Site-Infograph                     | Val  Loss: 1.5514 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7151
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.7377 | Train Acc: 0.8730
 Site-Real                          | Train Loss: 0.3978 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.6224 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.8654 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.9555 | Train Acc: 0.3620
 Site-Infograph                     | Train Loss: 1.7534 | Train Acc: 0.4188
Average Train Accuracy: 0.7172
 Site-Clipart                       | Val  Loss: 0.7746 | Val  Acc: 0.8738
 Site-Real                          | Val  Loss: 0.4346 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.7815 | Val  Acc: 0.8271
 Site-Sketch                        | Val  Loss: 0.8310 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.9334 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.5403 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7230
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.7149 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.4672 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.5631 | Train Acc: 0.8847
 Site-Sketch                        | Train Loss: 0.8358 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.8778 | Train Acc: 0.3804
 Site-Infograph                     | Train Loss: 1.7562 | Train Acc: 0.4274
Average Train Accuracy: 0.7231
 Site-Clipart                       | Val  Loss: 0.7392 | Val  Acc: 0.8833
 Site-Real                          | Val  Loss: 0.4132 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.7372 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.8620 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.9067 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.5268 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7289
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.6785 | Train Acc: 0.8921
 Site-Real                          | Train Loss: 0.3450 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.5613 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 0.8121 | Train Acc: 0.7817
 Site-QuickDraw                     | Train Loss: 1.9241 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.7398 | Train Acc: 0.4188
Average Train Accuracy: 0.7145
 Site-Clipart                       | Val  Loss: 0.6924 | Val  Acc: 0.8976
 Site-Real                          | Val  Loss: 0.3880 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.7166 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.8040 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.9246 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.4617 | Val  Acc: 0.6026
Average Valid Accuracy: 0.7496
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8976
 Best site-Real                      | Epoch:16 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8505
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.8039
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.3761
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6026
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.6496 | Train Acc: 0.8889
 Site-Real                          | Train Loss: 0.3292 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.5044 | Train Acc: 0.8723
 Site-Sketch                        | Train Loss: 0.8046 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 1.9495 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.7689 | Train Acc: 0.3932
Average Train Accuracy: 0.7094
 Site-Clipart                       | Val  Loss: 0.6785 | Val  Acc: 0.8738
 Site-Real                          | Val  Loss: 0.3692 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.6888 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.7186 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.9276 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.5000 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7279
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.6228 | Train Acc: 0.8810
 Site-Real                          | Train Loss: 0.2845 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.5016 | Train Acc: 0.8660
 Site-Sketch                        | Train Loss: 0.7687 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.8856 | Train Acc: 0.3742
 Site-Infograph                     | Train Loss: 1.7799 | Train Acc: 0.4017
Average Train Accuracy: 0.7232
 Site-Clipart                       | Val  Loss: 0.6422 | Val  Acc: 0.8857
 Site-Real                          | Val  Loss: 0.3441 | Val  Acc: 0.9433
 Site-Painting                      | Val  Loss: 0.6716 | Val  Acc: 0.8411
 Site-Sketch                        | Val  Loss: 0.7418 | Val  Acc: 0.7712
 Site-QuickDraw                     | Val  Loss: 1.9015 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3853 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7181
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.5873 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.3673 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.5025 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.7344 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.8461 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.6866 | Train Acc: 0.4188
Average Train Accuracy: 0.7296
 Site-Clipart                       | Val  Loss: 0.6249 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.3229 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.6047 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.7423 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.8683 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3835 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7449
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.5715 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.2578 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.7580 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.7061 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.8626 | Train Acc: 0.4356
 Site-Infograph                     | Train Loss: 1.7355 | Train Acc: 0.4274
Average Train Accuracy: 0.7392
 Site-Clipart                       | Val  Loss: 0.5985 | Val  Acc: 0.9071
 Site-Real                          | Val  Loss: 0.2877 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.6420 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.7107 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.8279 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.4139 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7414
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.5630 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.3626 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.4616 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.7226 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.8311 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.7352 | Train Acc: 0.4444
Average Train Accuracy: 0.7347
 Site-Clipart                       | Val  Loss: 0.6014 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.2885 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5848 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.6553 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.8893 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3307 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7407
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.5458 | Train Acc: 0.9016
 Site-Real                          | Train Loss: 0.2457 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.4327 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.7272 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.8885 | Train Acc: 0.3497
 Site-Infograph                     | Train Loss: 1.6724 | Train Acc: 0.4615
Average Train Accuracy: 0.7319
 Site-Clipart                       | Val  Loss: 0.5969 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.2740 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.6054 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.6726 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.8245 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.4105 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7400
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.5276 | Train Acc: 0.8984
 Site-Real                          | Train Loss: 0.2642 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.4365 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.6705 | Train Acc: 0.8253
 Site-QuickDraw                     | Train Loss: 1.8819 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.7042 | Train Acc: 0.4188
Average Train Accuracy: 0.7309
 Site-Clipart                       | Val  Loss: 0.5624 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2535 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.5602 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.6536 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.8753 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.3878 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7409
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.5083 | Train Acc: 0.9111
 Site-Real                          | Train Loss: 0.2382 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.7311 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.6815 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.8667 | Train Acc: 0.3742
 Site-Infograph                     | Train Loss: 1.6603 | Train Acc: 0.4274
Average Train Accuracy: 0.7363
 Site-Clipart                       | Val  Loss: 0.5478 | Val  Acc: 0.8905
 Site-Real                          | Val  Loss: 0.2402 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5788 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6480 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8773 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.4212 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7325
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.4915 | Train Acc: 0.9175
 Site-Real                          | Train Loss: 0.2160 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4013 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.6418 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.7942 | Train Acc: 0.3988
 Site-Infograph                     | Train Loss: 1.6497 | Train Acc: 0.4786
Average Train Accuracy: 0.7525
 Site-Clipart                       | Val  Loss: 0.5446 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2436 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.5800 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6541 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8177 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3151 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7482
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.5070 | Train Acc: 0.8984
 Site-Real                          | Train Loss: 0.1995 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.8129 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.6555 | Train Acc: 0.7991
 Site-QuickDraw                     | Train Loss: 1.7744 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.6772 | Train Acc: 0.4188
Average Train Accuracy: 0.7242
 Site-Clipart                       | Val  Loss: 0.5242 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.2463 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5616 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.6242 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7764 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.4572 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7475
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.4775 | Train Acc: 0.9238
 Site-Real                          | Train Loss: 0.1962 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.6565 | Train Acc: 0.8941
 Site-Sketch                        | Train Loss: 0.6439 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.7524 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6741 | Train Acc: 0.4188
Average Train Accuracy: 0.7438
 Site-Clipart                       | Val  Loss: 0.5098 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2266 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.5641 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.6216 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.7938 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.3754 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7559
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9000
 Best site-Real                      | Epoch:27 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8738
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8627
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.4128
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.4540 | Train Acc: 0.9238
 Site-Real                          | Train Loss: 0.1900 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.3750 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6293 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.7954 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.5869 | Train Acc: 0.4701
Average Train Accuracy: 0.7478
 Site-Clipart                       | Val  Loss: 0.4931 | Val  Acc: 0.9071
 Site-Real                          | Val  Loss: 0.2195 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5133 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5569 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7904 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3235 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7543
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.4649 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 0.1820 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3951 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 0.6175 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.7834 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.6187 | Train Acc: 0.4615
Average Train Accuracy: 0.7412
 Site-Clipart                       | Val  Loss: 0.4943 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 0.2135 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.5404 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.6350 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.8142 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.3264 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7447
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.4546 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.3052 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.6415 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.6084 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7705 | Train Acc: 0.4785
 Site-Infograph                     | Train Loss: 1.6417 | Train Acc: 0.4274
Average Train Accuracy: 0.7509
 Site-Clipart                       | Val  Loss: 0.4638 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.2073 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5337 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.6289 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.7749 | Val  Acc: 0.4404
 Site-Infograph                     | Val  Loss: 1.4076 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7436
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.4452 | Train Acc: 0.9127
 Site-Real                          | Train Loss: 0.1732 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.4221 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.6431 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.7248 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.6468 | Train Acc: 0.4274
Average Train Accuracy: 0.7433
 Site-Clipart                       | Val  Loss: 0.4668 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2032 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5503 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6256 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.8096 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.3277 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7386
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.4153 | Train Acc: 0.9238
 Site-Real                          | Train Loss: 0.3004 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3843 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.5995 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.7443 | Train Acc: 0.4540
 Site-Infograph                     | Train Loss: 1.6845 | Train Acc: 0.4274
Average Train Accuracy: 0.7502
 Site-Clipart                       | Val  Loss: 0.4424 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.2143 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5268 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5761 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7892 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.3442 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7511
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.4131 | Train Acc: 0.9270
 Site-Real                          | Train Loss: 0.1764 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.4750 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.6059 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7028 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6404 | Train Acc: 0.4444
Average Train Accuracy: 0.7569
 Site-Clipart                       | Val  Loss: 0.4532 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.2009 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4985 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.6135 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7440 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.2309 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7449
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.4046 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.1690 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.3470 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.5875 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7110 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.6797 | Train Acc: 0.4359
Average Train Accuracy: 0.7499
 Site-Clipart                       | Val  Loss: 0.4393 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.1855 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.5023 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.5256 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.7895 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3963 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7489
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.4030 | Train Acc: 0.9286
 Site-Real                          | Train Loss: 0.1618 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.3444 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.5879 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7915 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6552 | Train Acc: 0.4701
Average Train Accuracy: 0.7556
 Site-Clipart                       | Val  Loss: 0.4240 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.1863 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4975 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5754 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.7680 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.2690 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7606
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.9167
 Best site-Real                      | Epoch:35 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:35 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.8366
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.3915 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.1503 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.5420 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.5730 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.6931 | Train Acc: 0.4540
 Site-Infograph                     | Train Loss: 1.6732 | Train Acc: 0.4359
Average Train Accuracy: 0.7520
 Site-Clipart                       | Val  Loss: 0.4426 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.1887 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4787 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.6107 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7624 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.2913 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7450
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.3875 | Train Acc: 0.9302
 Site-Real                          | Train Loss: 0.1403 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.3222 | Train Acc: 0.9128
 Site-Sketch                        | Train Loss: 0.5777 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.6962 | Train Acc: 0.4663
 Site-Infograph                     | Train Loss: 1.6109 | Train Acc: 0.4786
Average Train Accuracy: 0.7666
 Site-Clipart                       | Val  Loss: 0.4149 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1776 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.5166 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.5887 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.7576 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3056 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7615
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.9214
 Best site-Real                      | Epoch:37 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:37 | Val Acc: 0.8832
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.8235
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.4037
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3686 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1435 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.3396 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.5365 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.7546 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.6805 | Train Acc: 0.4188
Average Train Accuracy: 0.7485
 Site-Clipart                       | Val  Loss: 0.4122 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1857 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4492 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.5150 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8001 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.2269 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7535
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.3636 | Train Acc: 0.9429
 Site-Real                          | Train Loss: 0.1389 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3243 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.5977 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7196 | Train Acc: 0.4049
 Site-Infograph                     | Train Loss: 1.6283 | Train Acc: 0.4444
Average Train Accuracy: 0.7505
 Site-Clipart                       | Val  Loss: 0.4113 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1573 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.4579 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.5270 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7358 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.3200 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7534
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3633 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1404 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.4533 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5629 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6866 | Train Acc: 0.4356
 Site-Infograph                     | Train Loss: 1.6410 | Train Acc: 0.4615
Average Train Accuracy: 0.7622
 Site-Clipart                       | Val  Loss: 0.3795 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1851 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4479 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4914 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6838 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.3004 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7583
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.3497 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1280 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3032 | Train Acc: 0.9221
 Site-Sketch                        | Train Loss: 0.5354 | Train Acc: 0.8515
 Site-QuickDraw                     | Train Loss: 1.6818 | Train Acc: 0.4356
 Site-Infograph                     | Train Loss: 1.6666 | Train Acc: 0.4530
Average Train Accuracy: 0.7625
 Site-Clipart                       | Val  Loss: 0.3772 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.1731 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5047 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.5214 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.7449 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3125 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7581
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.3502 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1247 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3076 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.5568 | Train Acc: 0.8515
 Site-QuickDraw                     | Train Loss: 1.6523 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.6107 | Train Acc: 0.4530
Average Train Accuracy: 0.7635
 Site-Clipart                       | Val  Loss: 0.4000 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1610 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4446 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5518 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6668 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.3918 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7535
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.3403 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1226 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.2994 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.5351 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.6452 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6596 | Train Acc: 0.4103
Average Train Accuracy: 0.7557
 Site-Clipart                       | Val  Loss: 0.3767 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1773 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5249 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.5320 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.6954 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.2066 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7540
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3177 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1207 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.2790 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5112 | Train Acc: 0.8777
 Site-QuickDraw                     | Train Loss: 1.6609 | Train Acc: 0.4356
 Site-Infograph                     | Train Loss: 1.6063 | Train Acc: 0.4615
Average Train Accuracy: 0.7669
 Site-Clipart                       | Val  Loss: 0.3919 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.1653 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4827 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.5934 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7049 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.4657 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7536
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.3136 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1496 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3293 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5463 | Train Acc: 0.8559
 Site-QuickDraw                     | Train Loss: 1.7010 | Train Acc: 0.4417
 Site-Infograph                     | Train Loss: 1.6191 | Train Acc: 0.4786
Average Train Accuracy: 0.7686
 Site-Clipart                       | Val  Loss: 0.3726 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1591 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4796 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.5049 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.7008 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3691 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7542
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.3277 | Train Acc: 0.9365
 Site-Real                          | Train Loss: 0.1670 | Train Acc: 0.9822
 Site-Painting                      | Train Loss: 0.2824 | Train Acc: 0.9283
 Site-Sketch                        | Train Loss: 0.5363 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6639 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6062 | Train Acc: 0.4444
Average Train Accuracy: 0.7657
 Site-Clipart                       | Val  Loss: 0.3743 | Val  Acc: 0.9310
 Site-Real                          | Val  Loss: 0.1457 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4424 | Val  Acc: 0.8972
 Site-Sketch                        | Val  Loss: 0.5229 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.6852 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.3176 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7661
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.9310
 Best site-Real                      | Epoch:46 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:46 | Val Acc: 0.8972
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.8366
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.3945
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.3269 | Train Acc: 0.9302
 Site-Real                          | Train Loss: 0.1109 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.2840 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.5685 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.6236 | Train Acc: 0.4601
 Site-Infograph                     | Train Loss: 1.6209 | Train Acc: 0.4188
Average Train Accuracy: 0.7544
 Site-Clipart                       | Val  Loss: 0.3689 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1659 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4559 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4904 | Val  Acc: 0.8627
 Site-QuickDraw                     | Val  Loss: 1.7536 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.2257 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7620
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3204 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1153 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3116 | Train Acc: 0.9221
 Site-Sketch                        | Train Loss: 0.5578 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6653 | Train Acc: 0.4785
 Site-Infograph                     | Train Loss: 1.6021 | Train Acc: 0.4530
Average Train Accuracy: 0.7680
 Site-Clipart                       | Val  Loss: 0.3666 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.1388 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4523 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.4745 | Val  Acc: 0.8497
 Site-QuickDraw                     | Val  Loss: 1.6857 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.3982 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7662
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9167
 Best site-Real                      | Epoch:48 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:48 | Val Acc: 0.8879
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8497
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.4220
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/term...
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3083 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.1090 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.2706 | Train Acc: 0.9159
 Site-Sketch                        | Train Loss: 0.4952 | Train Acc: 0.8515
 Site-QuickDraw                     | Train Loss: 1.7064 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.5693 | Train Acc: 0.4530
Average Train Accuracy: 0.7595
 Site-Clipart                       | Val  Loss: 0.3600 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1426 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.4152 | Val  Acc: 0.8832
 Site-Sketch                        | Val  Loss: 0.5537 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6736 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.3824 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7539
===2023-07-02 09:18:41===
===2023-07-02 09:18:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:48 | Test Acc: 0.9335
 Test site-Real                      | Epoch:48 | Test Acc: 0.9647
 Test site-Painting                  | Epoch:48 | Test Acc: 0.9192
 Test site-Sketch                    | Epoch:48 | Test Acc: 0.8736
 Test site-QuickDraw                 | Epoch:48 | Test Acc: 0.5630
 Test site-Infograph                 | Epoch:48 | Test Acc: 0.5205
Clipart: 0.9335, Real: 0.9647, Painting: 0.9192, Sketch: 0.8736, QuickDraw: 0.5630, Infograph: 0.5205, 
Average Test Accuracy(group): 0.7958, Average Test Accuracy(individual): 0.7958,
domain std=0.1820, cluster std=-1.0000, individual std=0.1820, 
