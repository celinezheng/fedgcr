===2023-07-02 07:06:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 2.1122 | Train Acc: 0.5778
 Site-Real                          | Train Loss: 2.0621 | Train Acc: 0.8000
 Site-Painting                      | Train Loss: 2.0576 | Train Acc: 0.6604
 Site-Sketch                        | Train Loss: 2.1294 | Train Acc: 0.5590
 Site-QuickDraw                     | Train Loss: 2.2765 | Train Acc: 0.1288
 Site-Infograph                     | Train Loss: 2.2400 | Train Acc: 0.2393
Average Train Accuracy: 0.4942
 Site-Clipart                       | Val  Loss: 2.1127 | Val  Acc: 0.6024
 Site-Real                          | Val  Loss: 2.0509 | Val  Acc: 0.8133
 Site-Painting                      | Val  Loss: 2.0998 | Val  Acc: 0.6121
 Site-Sketch                        | Val  Loss: 2.1194 | Val  Acc: 0.6078
 Site-QuickDraw                     | Val  Loss: 2.2594 | Val  Acc: 0.1376
 Site-Infograph                     | Val  Loss: 2.2291 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5092
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6024
 Best site-Real                      | Epoch:0 | Val Acc: 0.8133
 Best site-Painting                  | Epoch:0 | Val Acc: 0.6121
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.6078
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.1376
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 1.9448 | Train Acc: 0.7000
 Site-Real                          | Train Loss: 1.8617 | Train Acc: 0.8800
 Site-Painting                      | Train Loss: 1.8901 | Train Acc: 0.7664
 Site-Sketch                        | Train Loss: 1.9689 | Train Acc: 0.6419
 Site-QuickDraw                     | Train Loss: 2.2481 | Train Acc: 0.1656
 Site-Infograph                     | Train Loss: 2.2014 | Train Acc: 0.2906
Average Train Accuracy: 0.5741
 Site-Clipart                       | Val  Loss: 1.9475 | Val  Acc: 0.7119
 Site-Real                          | Val  Loss: 1.8473 | Val  Acc: 0.8833
 Site-Painting                      | Val  Loss: 1.9210 | Val  Acc: 0.7664
 Site-Sketch                        | Val  Loss: 1.9728 | Val  Acc: 0.6340
 Site-QuickDraw                     | Val  Loss: 2.2244 | Val  Acc: 0.2018
 Site-Infograph                     | Val  Loss: 2.1374 | Val  Acc: 0.3590
Average Valid Accuracy: 0.5927
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7119
 Best site-Real                      | Epoch:1 | Val Acc: 0.8833
 Best site-Painting                  | Epoch:1 | Val Acc: 0.7664
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.6340
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.2018
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.3590
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 1.7890 | Train Acc: 0.7587
 Site-Real                          | Train Loss: 1.6540 | Train Acc: 0.9133
 Site-Painting                      | Train Loss: 1.7678 | Train Acc: 0.8069
 Site-Sketch                        | Train Loss: 1.8124 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 2.2011 | Train Acc: 0.2454
 Site-Infograph                     | Train Loss: 2.1613 | Train Acc: 0.2991
Average Train Accuracy: 0.6196
 Site-Clipart                       | Val  Loss: 1.7996 | Val  Acc: 0.7690
 Site-Real                          | Val  Loss: 1.6548 | Val  Acc: 0.8967
 Site-Painting                      | Val  Loss: 1.7691 | Val  Acc: 0.7897
 Site-Sketch                        | Val  Loss: 1.8241 | Val  Acc: 0.7124
 Site-QuickDraw                     | Val  Loss: 2.1915 | Val  Acc: 0.1743
 Site-Infograph                     | Val  Loss: 2.0831 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6254
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7690
 Best site-Real                      | Epoch:2 | Val Acc: 0.8967
 Best site-Painting                  | Epoch:2 | Val Acc: 0.7897
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.7124
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.1743
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 1.6493 | Train Acc: 0.7841
 Site-Real                          | Train Loss: 1.4681 | Train Acc: 0.9222
 Site-Painting                      | Train Loss: 1.6579 | Train Acc: 0.8255
 Site-Sketch                        | Train Loss: 1.6842 | Train Acc: 0.7293
 Site-QuickDraw                     | Train Loss: 2.1579 | Train Acc: 0.2945
 Site-Infograph                     | Train Loss: 2.1054 | Train Acc: 0.3504
Average Train Accuracy: 0.6510
 Site-Clipart                       | Val  Loss: 1.6512 | Val  Acc: 0.7762
 Site-Real                          | Val  Loss: 1.4788 | Val  Acc: 0.9233
 Site-Painting                      | Val  Loss: 1.6205 | Val  Acc: 0.8084
 Site-Sketch                        | Val  Loss: 1.6873 | Val  Acc: 0.7190
 Site-QuickDraw                     | Val  Loss: 2.1385 | Val  Acc: 0.3211
 Site-Infograph                     | Val  Loss: 2.0168 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6576
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7762
 Best site-Real                      | Epoch:3 | Val Acc: 0.9233
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8084
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.7190
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.3211
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.3974
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 1.5109 | Train Acc: 0.8016
 Site-Real                          | Train Loss: 1.2997 | Train Acc: 0.9400
 Site-Painting                      | Train Loss: 1.3886 | Train Acc: 0.8411
 Site-Sketch                        | Train Loss: 1.5955 | Train Acc: 0.7336
 Site-QuickDraw                     | Train Loss: 2.1204 | Train Acc: 0.3436
 Site-Infograph                     | Train Loss: 2.0476 | Train Acc: 0.4103
Average Train Accuracy: 0.6784
 Site-Clipart                       | Val  Loss: 1.5367 | Val  Acc: 0.8000
 Site-Real                          | Val  Loss: 1.3148 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 1.5275 | Val  Acc: 0.7897
 Site-Sketch                        | Val  Loss: 1.5488 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 2.1036 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.9739 | Val  Acc: 0.3974
Average Valid Accuracy: 0.6750
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8000
 Best site-Real                      | Epoch:4 | Val Acc: 0.9533
 Best site-Painting                  | Epoch:4 | Val Acc: 0.7897
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.7516
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.3974
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 1.3985 | Train Acc: 0.8222
 Site-Real                          | Train Loss: 1.2122 | Train Acc: 0.9356
 Site-Painting                      | Train Loss: 1.2702 | Train Acc: 0.8411
 Site-Sketch                        | Train Loss: 1.4561 | Train Acc: 0.7511
 Site-QuickDraw                     | Train Loss: 2.0908 | Train Acc: 0.3497
 Site-Infograph                     | Train Loss: 1.9890 | Train Acc: 0.3932
Average Train Accuracy: 0.6821
 Site-Clipart                       | Val  Loss: 1.4082 | Val  Acc: 0.8357
 Site-Real                          | Val  Loss: 1.1835 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 1.3952 | Val  Acc: 0.8224
 Site-Sketch                        | Val  Loss: 1.4086 | Val  Acc: 0.7712
 Site-QuickDraw                     | Val  Loss: 2.0831 | Val  Acc: 0.3486
 Site-Infograph                     | Val  Loss: 1.8630 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7031
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8357
 Best site-Real                      | Epoch:5 | Val Acc: 0.9533
 Best site-Painting                  | Epoch:5 | Val Acc: 0.8224
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.7712
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.3486
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 1.2990 | Train Acc: 0.8476
 Site-Real                          | Train Loss: 1.1129 | Train Acc: 0.9422
 Site-Painting                      | Train Loss: 1.1460 | Train Acc: 0.8567
 Site-Sketch                        | Train Loss: 1.3599 | Train Acc: 0.7467
 Site-QuickDraw                     | Train Loss: 2.0777 | Train Acc: 0.3067
 Site-Infograph                     | Train Loss: 1.9565 | Train Acc: 0.4188
Average Train Accuracy: 0.6865
 Site-Clipart                       | Val  Loss: 1.3076 | Val  Acc: 0.8429
 Site-Real                          | Val  Loss: 1.0458 | Val  Acc: 0.9433
 Site-Painting                      | Val  Loss: 1.2919 | Val  Acc: 0.8318
 Site-Sketch                        | Val  Loss: 1.3836 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 2.0656 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.7595 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7132
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8429
 Best site-Real                      | Epoch:6 | Val Acc: 0.9433
 Best site-Painting                  | Epoch:6 | Val Acc: 0.8318
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.7908
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.3578
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 1.1917 | Train Acc: 0.8524
 Site-Real                          | Train Loss: 0.9327 | Train Acc: 0.9533
 Site-Painting                      | Train Loss: 1.0613 | Train Acc: 0.8349
 Site-Sketch                        | Train Loss: 1.2069 | Train Acc: 0.7773
 Site-QuickDraw                     | Train Loss: 2.0345 | Train Acc: 0.3558
 Site-Infograph                     | Train Loss: 1.9121 | Train Acc: 0.4188
Average Train Accuracy: 0.6988
 Site-Clipart                       | Val  Loss: 1.2146 | Val  Acc: 0.8357
 Site-Real                          | Val  Loss: 0.9483 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.1583 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 1.2714 | Val  Acc: 0.7582
 Site-QuickDraw                     | Val  Loss: 2.0512 | Val  Acc: 0.3303
 Site-Infograph                     | Val  Loss: 1.7676 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7062
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 1.1286 | Train Acc: 0.8429
 Site-Real                          | Train Loss: 0.8257 | Train Acc: 0.9556
 Site-Painting                      | Train Loss: 0.9779 | Train Acc: 0.8598
 Site-Sketch                        | Train Loss: 1.2171 | Train Acc: 0.7773
 Site-QuickDraw                     | Train Loss: 2.0061 | Train Acc: 0.3313
 Site-Infograph                     | Train Loss: 1.9107 | Train Acc: 0.4188
Average Train Accuracy: 0.6976
 Site-Clipart                       | Val  Loss: 1.1304 | Val  Acc: 0.8476
 Site-Real                          | Val  Loss: 0.8511 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.0969 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 1.1652 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 1.9859 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.7517 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7177
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.8476
 Best site-Real                      | Epoch:8 | Val Acc: 0.9500
 Best site-Painting                  | Epoch:8 | Val Acc: 0.8551
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.7516
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.3761
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 1.0556 | Train Acc: 0.8492
 Site-Real                          | Train Loss: 0.7259 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.9744 | Train Acc: 0.8505
 Site-Sketch                        | Train Loss: 1.1302 | Train Acc: 0.7380
 Site-QuickDraw                     | Train Loss: 1.9457 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.8646 | Train Acc: 0.3932
Average Train Accuracy: 0.6972
 Site-Clipart                       | Val  Loss: 1.0565 | Val  Acc: 0.8452
 Site-Real                          | Val  Loss: 0.7624 | Val  Acc: 0.9500
 Site-Painting                      | Val  Loss: 1.0574 | Val  Acc: 0.8318
 Site-Sketch                        | Val  Loss: 1.1420 | Val  Acc: 0.7516
 Site-QuickDraw                     | Val  Loss: 2.0093 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.6913 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7082
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.9917 | Train Acc: 0.8635
 Site-Real                          | Train Loss: 0.7284 | Train Acc: 0.9489
 Site-Painting                      | Train Loss: 0.9031 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 1.0667 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.9413 | Train Acc: 0.3865
 Site-Infograph                     | Train Loss: 1.8078 | Train Acc: 0.4103
Average Train Accuracy: 0.7130
 Site-Clipart                       | Val  Loss: 0.9842 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.6929 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.9613 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 1.0542 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.9575 | Val  Acc: 0.3853
 Site-Infograph                     | Val  Loss: 1.5694 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7337
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.8714
 Best site-Real                      | Epoch:10 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:10 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:10 | Val Acc: 0.7778
 Best site-QuickDraw                 | Epoch:10 | Val Acc: 0.3853
 Best site-Infograph                 | Epoch:10 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.9223 | Train Acc: 0.8635
 Site-Real                          | Train Loss: 0.5849 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.9220 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.9889 | Train Acc: 0.7598
 Site-QuickDraw                     | Train Loss: 1.9029 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.8161 | Train Acc: 0.4017
Average Train Accuracy: 0.7082
 Site-Clipart                       | Val  Loss: 0.9303 | Val  Acc: 0.8571
 Site-Real                          | Val  Loss: 0.6279 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.9400 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 1.0023 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.9595 | Val  Acc: 0.3578
 Site-Infograph                     | Val  Loss: 1.5690 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7187
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.8847 | Train Acc: 0.8571
 Site-Real                          | Train Loss: 0.5401 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.7269 | Train Acc: 0.8660
 Site-Sketch                        | Train Loss: 0.9879 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 1.9194 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.7913 | Train Acc: 0.4017
Average Train Accuracy: 0.7113
 Site-Clipart                       | Val  Loss: 0.9017 | Val  Acc: 0.8524
 Site-Real                          | Val  Loss: 0.5930 | Val  Acc: 0.9433
 Site-Painting                      | Val  Loss: 0.8959 | Val  Acc: 0.8224
 Site-Sketch                        | Val  Loss: 0.9544 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.9150 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.6212 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7268
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.8445 | Train Acc: 0.8556
 Site-Real                          | Train Loss: 0.5198 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.7073 | Train Acc: 0.8629
 Site-Sketch                        | Train Loss: 0.9383 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.8712 | Train Acc: 0.4172
 Site-Infograph                     | Train Loss: 1.7693 | Train Acc: 0.4615
Average Train Accuracy: 0.7253
 Site-Clipart                       | Val  Loss: 0.8728 | Val  Acc: 0.8548
 Site-Real                          | Val  Loss: 0.5314 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.8038 | Val  Acc: 0.8411
 Site-Sketch                        | Val  Loss: 0.9218 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.9227 | Val  Acc: 0.3670
 Site-Infograph                     | Val  Loss: 1.5671 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7189
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.7863 | Train Acc: 0.8698
 Site-Real                          | Train Loss: 0.4680 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.6856 | Train Acc: 0.8723
 Site-Sketch                        | Train Loss: 0.9093 | Train Acc: 0.7991
 Site-QuickDraw                     | Train Loss: 1.8886 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.7480 | Train Acc: 0.4274
Average Train Accuracy: 0.7202
 Site-Clipart                       | Val  Loss: 0.8254 | Val  Acc: 0.8643
 Site-Real                          | Val  Loss: 0.5029 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.8364 | Val  Acc: 0.8224
 Site-Sketch                        | Val  Loss: 0.8756 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.8842 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.5592 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7251
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.7615 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.5352 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.6226 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.8816 | Train Acc: 0.7904
 Site-QuickDraw                     | Train Loss: 1.8089 | Train Acc: 0.4049
 Site-Infograph                     | Train Loss: 1.7453 | Train Acc: 0.4274
Average Train Accuracy: 0.7271
 Site-Clipart                       | Val  Loss: 0.7878 | Val  Acc: 0.8833
 Site-Real                          | Val  Loss: 0.4781 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.7950 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.9010 | Val  Acc: 0.7908
 Site-QuickDraw                     | Val  Loss: 1.8537 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.5461 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7346
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.8833
 Best site-Real                      | Epoch:15 | Val Acc: 0.9533
 Best site-Painting                  | Epoch:15 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:15 | Val Acc: 0.7908
 Best site-QuickDraw                 | Epoch:15 | Val Acc: 0.3945
 Best site-Infograph                 | Epoch:15 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.7242 | Train Acc: 0.8937
 Site-Real                          | Train Loss: 0.4147 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.6245 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.8527 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 1.8467 | Train Acc: 0.4233
 Site-Infograph                     | Train Loss: 1.7291 | Train Acc: 0.4444
Average Train Accuracy: 0.7294
 Site-Clipart                       | Val  Loss: 0.7414 | Val  Acc: 0.8976
 Site-Real                          | Val  Loss: 0.4517 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.7684 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.8445 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.8610 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.4771 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7517
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.8976
 Best site-Real                      | Epoch:16 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:16 | Val Acc: 0.8458
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.7974
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.4128
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.6944 | Train Acc: 0.8825
 Site-Real                          | Train Loss: 0.3947 | Train Acc: 0.9600
 Site-Painting                      | Train Loss: 0.5578 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.8415 | Train Acc: 0.7860
 Site-QuickDraw                     | Train Loss: 1.8547 | Train Acc: 0.3926
 Site-Infograph                     | Train Loss: 1.7532 | Train Acc: 0.4017
Average Train Accuracy: 0.7153
 Site-Clipart                       | Val  Loss: 0.7233 | Val  Acc: 0.8714
 Site-Real                          | Val  Loss: 0.4286 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.7432 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.7586 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.8619 | Val  Acc: 0.3761
 Site-Infograph                     | Val  Loss: 1.5090 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7281
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.6655 | Train Acc: 0.8841
 Site-Real                          | Train Loss: 0.3400 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.5518 | Train Acc: 0.8567
 Site-Sketch                        | Train Loss: 0.8113 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.7835 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.7546 | Train Acc: 0.4188
Average Train Accuracy: 0.7331
 Site-Clipart                       | Val  Loss: 0.6873 | Val  Acc: 0.8786
 Site-Real                          | Val  Loss: 0.4005 | Val  Acc: 0.9400
 Site-Painting                      | Val  Loss: 0.7178 | Val  Acc: 0.8364
 Site-Sketch                        | Val  Loss: 0.7773 | Val  Acc: 0.7778
 Site-QuickDraw                     | Val  Loss: 1.8226 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.3994 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7249
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.6278 | Train Acc: 0.9032
 Site-Real                          | Train Loss: 0.4259 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.5499 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.7703 | Train Acc: 0.8122
 Site-QuickDraw                     | Train Loss: 1.7535 | Train Acc: 0.4785
 Site-Infograph                     | Train Loss: 1.6620 | Train Acc: 0.4359
Average Train Accuracy: 0.7446
 Site-Clipart                       | Val  Loss: 0.6672 | Val  Acc: 0.8667
 Site-Real                          | Val  Loss: 0.3781 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.6505 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.7794 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7965 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.4010 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7454
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.6122 | Train Acc: 0.8968
 Site-Real                          | Train Loss: 0.3101 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.8089 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.7417 | Train Acc: 0.8079
 Site-QuickDraw                     | Train Loss: 1.7626 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.7125 | Train Acc: 0.4530
Average Train Accuracy: 0.7528
 Site-Clipart                       | Val  Loss: 0.6430 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 0.3406 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.6838 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.7470 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.7550 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.4216 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7505
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.6027 | Train Acc: 0.8984
 Site-Real                          | Train Loss: 0.4196 | Train Acc: 0.9556
 Site-Painting                      | Train Loss: 0.5094 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 0.7574 | Train Acc: 0.8079
 Site-QuickDraw                     | Train Loss: 1.7335 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.7060 | Train Acc: 0.4359
Average Train Accuracy: 0.7343
 Site-Clipart                       | Val  Loss: 0.6420 | Val  Acc: 0.8786
 Site-Real                          | Val  Loss: 0.3384 | Val  Acc: 0.9533
 Site-Painting                      | Val  Loss: 0.6292 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.6863 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.8074 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.3399 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7467
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.5843 | Train Acc: 0.8921
 Site-Real                          | Train Loss: 0.2974 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4784 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.7623 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.7782 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.6370 | Train Acc: 0.4786
Average Train Accuracy: 0.7483
 Site-Clipart                       | Val  Loss: 0.6368 | Val  Acc: 0.8690
 Site-Real                          | Val  Loss: 0.3211 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.6486 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.7078 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7398 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.4105 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7534
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.8690
 Best site-Real                      | Epoch:22 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:22 | Val Acc: 0.8645
 Best site-Sketch                    | Epoch:22 | Val Acc: 0.8105
 Best site-QuickDraw                 | Epoch:22 | Val Acc: 0.4587
 Best site-Infograph                 | Epoch:22 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.5662 | Train Acc: 0.9048
 Site-Real                          | Train Loss: 0.3227 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.4805 | Train Acc: 0.8785
 Site-Sketch                        | Train Loss: 0.7113 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.7642 | Train Acc: 0.4479
 Site-Infograph                     | Train Loss: 1.6694 | Train Acc: 0.4444
Average Train Accuracy: 0.7442
 Site-Clipart                       | Val  Loss: 0.6009 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2991 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.6005 | Val  Acc: 0.8411
 Site-Sketch                        | Val  Loss: 0.6913 | Val  Acc: 0.8039
 Site-QuickDraw                     | Val  Loss: 1.7763 | Val  Acc: 0.4128
 Site-Infograph                     | Val  Loss: 1.3981 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7527
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.5447 | Train Acc: 0.9079
 Site-Real                          | Train Loss: 0.2862 | Train Acc: 0.9578
 Site-Painting                      | Train Loss: 0.7925 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.7141 | Train Acc: 0.8253
 Site-QuickDraw                     | Train Loss: 1.7373 | Train Acc: 0.4294
 Site-Infograph                     | Train Loss: 1.6218 | Train Acc: 0.4615
Average Train Accuracy: 0.7455
 Site-Clipart                       | Val  Loss: 0.5879 | Val  Acc: 0.8881
 Site-Real                          | Val  Loss: 0.2834 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.6189 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6758 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.7837 | Val  Acc: 0.4037
 Site-Infograph                     | Val  Loss: 1.4297 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7418
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.5266 | Train Acc: 0.9079
 Site-Real                          | Train Loss: 0.2626 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4405 | Train Acc: 0.9034
 Site-Sketch                        | Train Loss: 0.6756 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.6636 | Train Acc: 0.4724
 Site-Infograph                     | Train Loss: 1.6142 | Train Acc: 0.4872
Average Train Accuracy: 0.7634
 Site-Clipart                       | Val  Loss: 0.5804 | Val  Acc: 0.9024
 Site-Real                          | Val  Loss: 0.2868 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.6166 | Val  Acc: 0.8458
 Site-Sketch                        | Val  Loss: 0.6855 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.7153 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.3212 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7606
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9024
 Best site-Real                      | Epoch:25 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:25 | Val Acc: 0.8458
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.7974
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.4679
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.5423 | Train Acc: 0.9016
 Site-Real                          | Train Loss: 0.2404 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.8551 | Train Acc: 0.8692
 Site-Sketch                        | Train Loss: 0.6799 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.6537 | Train Acc: 0.4540
 Site-Infograph                     | Train Loss: 1.6342 | Train Acc: 0.4359
Average Train Accuracy: 0.7388
 Site-Clipart                       | Val  Loss: 0.5584 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2872 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5992 | Val  Acc: 0.8879
 Site-Sketch                        | Val  Loss: 0.6514 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.6742 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.4589 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7640
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.9000
 Best site-Real                      | Epoch:26 | Val Acc: 0.9633
 Best site-Painting                  | Epoch:26 | Val Acc: 0.8879
 Best site-Sketch                    | Epoch:26 | Val Acc: 0.8301
 Best site-QuickDraw                 | Epoch:26 | Val Acc: 0.4771
 Best site-Infograph                 | Epoch:26 | Val Acc: 0.5256
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.5120 | Train Acc: 0.9190
 Site-Real                          | Train Loss: 0.2396 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.7023 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6772 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.6281 | Train Acc: 0.4969
 Site-Infograph                     | Train Loss: 1.6318 | Train Acc: 0.4444
Average Train Accuracy: 0.7538
 Site-Clipart                       | Val  Loss: 0.5449 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.2689 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5963 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.6484 | Val  Acc: 0.8562
 Site-QuickDraw                     | Val  Loss: 1.6835 | Val  Acc: 0.4862
 Site-Infograph                     | Val  Loss: 1.3555 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7649
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.8952
 Best site-Real                      | Epoch:27 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:27 | Val Acc: 0.8692
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.8562
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.4862
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.4891 | Train Acc: 0.9159
 Site-Real                          | Train Loss: 0.2360 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4127 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.6572 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.6570 | Train Acc: 0.4847
 Site-Infograph                     | Train Loss: 1.5560 | Train Acc: 0.4872
Average Train Accuracy: 0.7566
 Site-Clipart                       | Val  Loss: 0.5258 | Val  Acc: 0.9071
 Site-Real                          | Val  Loss: 0.2589 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5406 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5879 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.6753 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.3094 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7656
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.9071
 Best site-Real                      | Epoch:28 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:28 | Val Acc: 0.8598
 Best site-Sketch                    | Epoch:28 | Val Acc: 0.8301
 Best site-QuickDraw                 | Epoch:28 | Val Acc: 0.4495
 Best site-Infograph                 | Epoch:28 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.4968 | Train Acc: 0.8984
 Site-Real                          | Train Loss: 0.2199 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.4365 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.6442 | Train Acc: 0.8253
 Site-QuickDraw                     | Train Loss: 1.6380 | Train Acc: 0.4847
 Site-Infograph                     | Train Loss: 1.5717 | Train Acc: 0.4786
Average Train Accuracy: 0.7548
 Site-Clipart                       | Val  Loss: 0.5282 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 0.2520 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5735 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6549 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.6833 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3072 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7596
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.4859 | Train Acc: 0.9143
 Site-Real                          | Train Loss: 0.3500 | Train Acc: 0.9644
 Site-Painting                      | Train Loss: 0.7054 | Train Acc: 0.8847
 Site-Sketch                        | Train Loss: 0.6365 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.6136 | Train Acc: 0.5276
 Site-Infograph                     | Train Loss: 1.5886 | Train Acc: 0.4359
Average Train Accuracy: 0.7609
 Site-Clipart                       | Val  Loss: 0.4965 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.2471 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5655 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.6490 | Val  Acc: 0.7843
 Site-QuickDraw                     | Val  Loss: 1.6467 | Val  Acc: 0.5046
 Site-Infograph                     | Val  Loss: 1.3878 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7569
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.4776 | Train Acc: 0.9159
 Site-Real                          | Train Loss: 0.2162 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.4630 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.6712 | Train Acc: 0.8035
 Site-QuickDraw                     | Train Loss: 1.5716 | Train Acc: 0.5276
 Site-Infograph                     | Train Loss: 1.5882 | Train Acc: 0.4444
Average Train Accuracy: 0.7581
 Site-Clipart                       | Val  Loss: 0.5009 | Val  Acc: 0.8929
 Site-Real                          | Val  Loss: 0.2377 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.5848 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.6483 | Val  Acc: 0.7974
 Site-QuickDraw                     | Val  Loss: 1.6831 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3045 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7585
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.4433 | Train Acc: 0.9206
 Site-Real                          | Train Loss: 0.3418 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.4215 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6224 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.5901 | Train Acc: 0.5153
 Site-Infograph                     | Train Loss: 1.6250 | Train Acc: 0.4615
Average Train Accuracy: 0.7625
 Site-Clipart                       | Val  Loss: 0.4740 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.2469 | Val  Acc: 0.9567
 Site-Painting                      | Val  Loss: 0.5513 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.6059 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.6558 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.3379 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7660
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.9143
 Best site-Real                      | Epoch:32 | Val Acc: 0.9567
 Best site-Painting                  | Epoch:32 | Val Acc: 0.8692
 Best site-Sketch                    | Epoch:32 | Val Acc: 0.8366
 Best site-QuickDraw                 | Epoch:32 | Val Acc: 0.4679
 Best site-Infograph                 | Epoch:32 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.4389 | Train Acc: 0.9270
 Site-Real                          | Train Loss: 0.2131 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.5657 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.6350 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.5521 | Train Acc: 0.5583
 Site-Infograph                     | Train Loss: 1.5813 | Train Acc: 0.4701
Average Train Accuracy: 0.7718
 Site-Clipart                       | Val  Loss: 0.4837 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.2331 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.5328 | Val  Acc: 0.8645
 Site-Sketch                        | Val  Loss: 0.6378 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6269 | Val  Acc: 0.4220
 Site-Infograph                     | Val  Loss: 1.2216 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7571
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.4294 | Train Acc: 0.9254
 Site-Real                          | Train Loss: 0.2028 | Train Acc: 0.9667
 Site-Painting                      | Train Loss: 0.3815 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.6149 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.5519 | Train Acc: 0.5153
 Site-Infograph                     | Train Loss: 1.6164 | Train Acc: 0.4530
Average Train Accuracy: 0.7658
 Site-Clipart                       | Val  Loss: 0.4644 | Val  Acc: 0.9119
 Site-Real                          | Val  Loss: 0.2163 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.5305 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5564 | Val  Acc: 0.8366
 Site-QuickDraw                     | Val  Loss: 1.6501 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.3796 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7678
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.9119
 Best site-Real                      | Epoch:34 | Val Acc: 0.9733
 Best site-Painting                  | Epoch:34 | Val Acc: 0.8785
 Best site-Sketch                    | Epoch:34 | Val Acc: 0.8366
 Best site-QuickDraw                 | Epoch:34 | Val Acc: 0.4679
 Best site-Infograph                 | Epoch:34 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.4292 | Train Acc: 0.9270
 Site-Real                          | Train Loss: 0.1978 | Train Acc: 0.9622
 Site-Painting                      | Train Loss: 0.3733 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.6166 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.6163 | Train Acc: 0.5031
 Site-Infograph                     | Train Loss: 1.5710 | Train Acc: 0.4615
Average Train Accuracy: 0.7631
 Site-Clipart                       | Val  Loss: 0.4554 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.2192 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5228 | Val  Acc: 0.8551
 Site-Sketch                        | Val  Loss: 0.5981 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.6266 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.2486 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7748
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.9262
 Best site-Real                      | Epoch:35 | Val Acc: 0.9667
 Best site-Painting                  | Epoch:35 | Val Acc: 0.8551
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.8431
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.4679
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.4166 | Train Acc: 0.9175
 Site-Real                          | Train Loss: 0.1864 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.5875 | Train Acc: 0.8910
 Site-Sketch                        | Train Loss: 0.6019 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.5299 | Train Acc: 0.5399
 Site-Infograph                     | Train Loss: 1.6015 | Train Acc: 0.4530
Average Train Accuracy: 0.7656
 Site-Clipart                       | Val  Loss: 0.4672 | Val  Acc: 0.9000
 Site-Real                          | Val  Loss: 0.2150 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5068 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.6306 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6256 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.2668 | Val  Acc: 0.5256
Average Valid Accuracy: 0.7568
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.4145 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1756 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3570 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.6110 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.5252 | Train Acc: 0.5215
 Site-Infograph                     | Train Loss: 1.5438 | Train Acc: 0.4872
Average Train Accuracy: 0.7759
 Site-Clipart                       | Val  Loss: 0.4470 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.2063 | Val  Acc: 0.9767
 Site-Painting                      | Val  Loss: 0.5416 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.6198 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.6113 | Val  Acc: 0.4587
 Site-Infograph                     | Val  Loss: 1.2691 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7689
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.3945 | Train Acc: 0.9413
 Site-Real                          | Train Loss: 0.1770 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3774 | Train Acc: 0.8754
 Site-Sketch                        | Train Loss: 0.5574 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.5746 | Train Acc: 0.5460
 Site-Infograph                     | Train Loss: 1.6056 | Train Acc: 0.4188
Average Train Accuracy: 0.7655
 Site-Clipart                       | Val  Loss: 0.4408 | Val  Acc: 0.9214
 Site-Real                          | Val  Loss: 0.2146 | Val  Acc: 0.9733
 Site-Painting                      | Val  Loss: 0.4742 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5413 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.6700 | Val  Acc: 0.3945
 Site-Infograph                     | Val  Loss: 1.2047 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7583
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.3918 | Train Acc: 0.9349
 Site-Real                          | Train Loss: 0.1704 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.3562 | Train Acc: 0.8816
 Site-Sketch                        | Train Loss: 0.6218 | Train Acc: 0.8210
 Site-QuickDraw                     | Train Loss: 1.5388 | Train Acc: 0.5215
 Site-Infograph                     | Train Loss: 1.5558 | Train Acc: 0.4615
Average Train Accuracy: 0.7653
 Site-Clipart                       | Val  Loss: 0.4422 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1861 | Val  Acc: 0.9833
 Site-Painting                      | Val  Loss: 0.4907 | Val  Acc: 0.8738
 Site-Sketch                        | Val  Loss: 0.5487 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.6003 | Val  Acc: 0.4495
 Site-Infograph                     | Val  Loss: 1.2923 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7711
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3907 | Train Acc: 0.9317
 Site-Real                          | Train Loss: 0.1736 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.4977 | Train Acc: 0.9003
 Site-Sketch                        | Train Loss: 0.5839 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.5184 | Train Acc: 0.5706
 Site-Infograph                     | Train Loss: 1.5640 | Train Acc: 0.4701
Average Train Accuracy: 0.7797
 Site-Clipart                       | Val  Loss: 0.4114 | Val  Acc: 0.9167
 Site-Real                          | Val  Loss: 0.2158 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.4762 | Val  Acc: 0.8925
 Site-Sketch                        | Val  Loss: 0.5137 | Val  Acc: 0.8235
 Site-QuickDraw                     | Val  Loss: 1.5341 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.2763 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7711
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.3755 | Train Acc: 0.9413
 Site-Real                          | Train Loss: 0.1600 | Train Acc: 0.9733
 Site-Painting                      | Train Loss: 0.3419 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.5541 | Train Acc: 0.8297
 Site-QuickDraw                     | Train Loss: 1.4927 | Train Acc: 0.5337
 Site-Infograph                     | Train Loss: 1.5829 | Train Acc: 0.4701
Average Train Accuracy: 0.7763
 Site-Clipart                       | Val  Loss: 0.4048 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.2008 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5317 | Val  Acc: 0.8505
 Site-Sketch                        | Val  Loss: 0.5377 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.5851 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.2848 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7723
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.3772 | Train Acc: 0.9333
 Site-Real                          | Train Loss: 0.1574 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3395 | Train Acc: 0.8879
 Site-Sketch                        | Train Loss: 0.5910 | Train Acc: 0.8341
 Site-QuickDraw                     | Train Loss: 1.4754 | Train Acc: 0.5337
 Site-Infograph                     | Train Loss: 1.5308 | Train Acc: 0.4872
Average Train Accuracy: 0.7757
 Site-Clipart                       | Val  Loss: 0.4280 | Val  Acc: 0.9143
 Site-Real                          | Val  Loss: 0.1902 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4711 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5673 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.5195 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.3551 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7702
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.3671 | Train Acc: 0.9460
 Site-Real                          | Train Loss: 0.1522 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3296 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.5652 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.4488 | Train Acc: 0.5644
 Site-Infograph                     | Train Loss: 1.5725 | Train Acc: 0.4359
Average Train Accuracy: 0.7774
 Site-Clipart                       | Val  Loss: 0.4045 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.2018 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.5430 | Val  Acc: 0.8598
 Site-Sketch                        | Val  Loss: 0.5421 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.5343 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.1821 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7652
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.3442 | Train Acc: 0.9444
 Site-Real                          | Train Loss: 0.1531 | Train Acc: 0.9689
 Site-Painting                      | Train Loss: 0.3066 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.5429 | Train Acc: 0.8603
 Site-QuickDraw                     | Train Loss: 1.4772 | Train Acc: 0.5215
 Site-Infograph                     | Train Loss: 1.5153 | Train Acc: 0.4872
Average Train Accuracy: 0.7815
 Site-Clipart                       | Val  Loss: 0.4148 | Val  Acc: 0.9286
 Site-Real                          | Val  Loss: 0.1901 | Val  Acc: 0.9633
 Site-Painting                      | Val  Loss: 0.4951 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.6150 | Val  Acc: 0.8105
 Site-QuickDraw                     | Val  Loss: 1.5399 | Val  Acc: 0.5138
 Site-Infograph                     | Val  Loss: 1.4269 | Val  Acc: 0.5513
Average Valid Accuracy: 0.7743
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.3332 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1921 | Train Acc: 0.9800
 Site-Painting                      | Train Loss: 0.3770 | Train Acc: 0.9065
 Site-Sketch                        | Train Loss: 0.5704 | Train Acc: 0.8559
 Site-QuickDraw                     | Train Loss: 1.4957 | Train Acc: 0.5521
 Site-Infograph                     | Train Loss: 1.5333 | Train Acc: 0.4786
Average Train Accuracy: 0.7852
 Site-Clipart                       | Val  Loss: 0.3966 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1831 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.5013 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.5341 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.5424 | Val  Acc: 0.4679
 Site-Infograph                     | Val  Loss: 1.3294 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7687
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.3499 | Train Acc: 0.9429
 Site-Real                          | Train Loss: 0.2131 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.3082 | Train Acc: 0.9097
 Site-Sketch                        | Train Loss: 0.5598 | Train Acc: 0.8384
 Site-QuickDraw                     | Train Loss: 1.4682 | Train Acc: 0.5644
 Site-Infograph                     | Train Loss: 1.5165 | Train Acc: 0.4786
Average Train Accuracy: 0.7842
 Site-Clipart                       | Val  Loss: 0.4015 | Val  Acc: 0.9238
 Site-Real                          | Val  Loss: 0.1675 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4624 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5368 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.5152 | Val  Acc: 0.5046
 Site-Infograph                     | Val  Loss: 1.2821 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7806
 Best site-Clipart                   | Epoch:46 | Val Acc: 0.9238
 Best site-Real                      | Epoch:46 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:46 | Val Acc: 0.8785
 Best site-Sketch                    | Epoch:46 | Val Acc: 0.8301
 Best site-QuickDraw                 | Epoch:46 | Val Acc: 0.5046
 Best site-Infograph                 | Epoch:46 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.3468 | Train Acc: 0.9381
 Site-Real                          | Train Loss: 0.1391 | Train Acc: 0.9756
 Site-Painting                      | Train Loss: 0.3178 | Train Acc: 0.8972
 Site-Sketch                        | Train Loss: 0.5946 | Train Acc: 0.8166
 Site-QuickDraw                     | Train Loss: 1.4270 | Train Acc: 0.5644
 Site-Infograph                     | Train Loss: 1.5210 | Train Acc: 0.4530
Average Train Accuracy: 0.7741
 Site-Clipart                       | Val  Loss: 0.3949 | Val  Acc: 0.9262
 Site-Real                          | Val  Loss: 0.1908 | Val  Acc: 0.9600
 Site-Painting                      | Val  Loss: 0.4760 | Val  Acc: 0.8785
 Site-Sketch                        | Val  Loss: 0.5186 | Val  Acc: 0.8301
 Site-QuickDraw                     | Val  Loss: 1.5983 | Val  Acc: 0.4954
 Site-Infograph                     | Val  Loss: 1.1925 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7778
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.3455 | Train Acc: 0.9397
 Site-Real                          | Train Loss: 0.1461 | Train Acc: 0.9711
 Site-Painting                      | Train Loss: 0.3728 | Train Acc: 0.9221
 Site-Sketch                        | Train Loss: 0.5853 | Train Acc: 0.8428
 Site-QuickDraw                     | Train Loss: 1.4517 | Train Acc: 0.5828
 Site-Infograph                     | Train Loss: 1.4938 | Train Acc: 0.4872
Average Train Accuracy: 0.7910
 Site-Clipart                       | Val  Loss: 0.3907 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1647 | Val  Acc: 0.9700
 Site-Painting                      | Val  Loss: 0.4674 | Val  Acc: 0.8692
 Site-Sketch                        | Val  Loss: 0.4900 | Val  Acc: 0.8431
 Site-QuickDraw                     | Val  Loss: 1.5027 | Val  Acc: 0.5229
 Site-Infograph                     | Val  Loss: 1.3678 | Val  Acc: 0.5769
Average Valid Accuracy: 0.7835
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.9190
 Best site-Real                      | Epoch:48 | Val Acc: 0.9700
 Best site-Painting                  | Epoch:48 | Val Acc: 0.8692
 Best site-Sketch                    | Epoch:48 | Val Acc: 0.8431
 Best site-QuickDraw                 | Epoch:48 | Val Acc: 0.5229
 Best site-Infograph                 | Epoch:48 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_distinct/afl...
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.3330 | Train Acc: 0.9349
 Site-Real                          | Train Loss: 0.1371 | Train Acc: 0.9778
 Site-Painting                      | Train Loss: 0.3037 | Train Acc: 0.9190
 Site-Sketch                        | Train Loss: 0.5230 | Train Acc: 0.8472
 Site-QuickDraw                     | Train Loss: 1.4743 | Train Acc: 0.5399
 Site-Infograph                     | Train Loss: 1.4681 | Train Acc: 0.4786
Average Train Accuracy: 0.7829
 Site-Clipart                       | Val  Loss: 0.3881 | Val  Acc: 0.9190
 Site-Real                          | Val  Loss: 0.1630 | Val  Acc: 0.9667
 Site-Painting                      | Val  Loss: 0.4314 | Val  Acc: 0.8925
 Site-Sketch                        | Val  Loss: 0.5711 | Val  Acc: 0.8170
 Site-QuickDraw                     | Val  Loss: 1.4997 | Val  Acc: 0.4771
 Site-Infograph                     | Val  Loss: 1.3428 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7770
===2023-07-02 07:49:58===
===2023-07-02 07:50:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[630,450,321,229,163,117,
client_nums=[1,1,1,1,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:48 | Test Acc: 0.9259
 Test site-Real                      | Epoch:48 | Test Acc: 0.9622
 Test site-Painting                  | Epoch:48 | Test Acc: 0.9208
 Test site-Sketch                    | Epoch:48 | Test Acc: 0.8755
 Test site-QuickDraw                 | Epoch:48 | Test Acc: 0.6250
 Test site-Infograph                 | Epoch:48 | Test Acc: 0.5282
Clipart: 0.9259, Real: 0.9622, Painting: 0.9208, Sketch: 0.8755, QuickDraw: 0.6250, Infograph: 0.5282, 
Average Test Accuracy(group): 0.8063, Average Test Accuracy(individual): 0.8063,
domain std=0.1667, cluster std=-1.0000, individual std=0.1667, 
