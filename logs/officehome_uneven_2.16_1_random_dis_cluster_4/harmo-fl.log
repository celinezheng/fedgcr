===2023-08-05 09:38:02===
===Setting===
    dataset: officehome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[21,27,35,45,58,75,97,126,163,210,30,45,68,101,152,61,122,85,
client_nums=[10,5,2,1,]
len_dataset=[1435,664,307,142,]
domain number = 4
============ Train epoch 0 ============
 Site-Art                           | Train Loss: 3.6917 | Train Acc: 0.6190
 Site-Art                           | Train Loss: 3.7381 | Train Acc: 0.5556
 Site-Art                           | Train Loss: 3.7532 | Train Acc: 0.5429
 Site-Art                           | Train Loss: 3.7810 | Train Acc: 0.4889
 Site-Art                           | Train Loss: 3.7264 | Train Acc: 0.5517
 Site-Art                           | Train Loss: 3.7700 | Train Acc: 0.4933
 Site-Art                           | Train Loss: 3.6993 | Train Acc: 0.6392
 Site-Art                           | Train Loss: 3.7205 | Train Acc: 0.6190
 Site-Art                           | Train Loss: 3.7727 | Train Acc: 0.5031
 Site-Art                           | Train Loss: 3.6647 | Train Acc: 0.5810
 Site-RealWorld                     | Train Loss: 3.7715 | Train Acc: 0.6000
 Site-RealWorld                     | Train Loss: 3.7175 | Train Acc: 0.6000
 Site-RealWorld                     | Train Loss: 3.6894 | Train Acc: 0.5735
 Site-RealWorld                     | Train Loss: 3.7438 | Train Acc: 0.5347
 Site-RealWorld                     | Train Loss: 3.7181 | Train Acc: 0.5658
 Site-Clipart                       | Train Loss: 3.8217 | Train Acc: 0.4262
 Site-Clipart                       | Train Loss: 3.8775 | Train Acc: 0.3115
 Site-Product                       | Train Loss: 3.8122 | Train Acc: 0.4235
Average Train Accuracy: 0.5349
 Site-Art                           | Val  Loss: 3.8373 | Val  Acc: 0.3571
 Site-Art                           | Val  Loss: 3.8723 | Val  Acc: 0.3333
 Site-Art                           | Val  Loss: 3.7438 | Val  Acc: 0.5652
 Site-Art                           | Val  Loss: 3.7295 | Val  Acc: 0.5333
 Site-Art                           | Val  Loss: 3.8532 | Val  Acc: 0.2051
 Site-Art                           | Val  Loss: 3.7391 | Val  Acc: 0.5400
 Site-Art                           | Val  Loss: 3.9104 | Val  Acc: 0.6154
 Site-Art                           | Val  Loss: 3.7261 | Val  Acc: 0.5595
 Site-Art                           | Val  Loss: 3.7119 | Val  Acc: 0.6111
 Site-Art                           | Val  Loss: 3.7394 | Val  Acc: 0.5429
 Site-RealWorld                     | Val  Loss: 3.5977 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 3.7156 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 3.7314 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 3.6395 | Val  Acc: 0.5224
 Site-RealWorld                     | Val  Loss: 3.7249 | Val  Acc: 0.5842
 Site-Clipart                       | Val  Loss: 3.9057 | Val  Acc: 0.3000
 Site-Clipart                       | Val  Loss: 3.8740 | Val  Acc: 0.3210
 Site-Product                       | Val  Loss: 3.7806 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5023
 Best site-Art                       | Epoch:0 | Val Acc: 0.3571
 Best site-Art                       | Epoch:0 | Val Acc: 0.3333
 Best site-Art                       | Epoch:0 | Val Acc: 0.5652
 Best site-Art                       | Epoch:0 | Val Acc: 0.5333
 Best site-Art                       | Epoch:0 | Val Acc: 0.2051
 Best site-Art                       | Epoch:0 | Val Acc: 0.5400
 Best site-Art                       | Epoch:0 | Val Acc: 0.6154
 Best site-Art                       | Epoch:0 | Val Acc: 0.5595
 Best site-Art                       | Epoch:0 | Val Acc: 0.6111
 Best site-Art                       | Epoch:0 | Val Acc: 0.5429
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.7500
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.5224
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.5842
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3000
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.3210
 Best site-Product                   | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 1 ============
 Site-Art                           | Train Loss: 3.2589 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 3.3671 | Train Acc: 0.7037
 Site-Art                           | Train Loss: 3.3335 | Train Acc: 0.6286
 Site-Art                           | Train Loss: 3.3890 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 3.3270 | Train Acc: 0.6207
 Site-Art                           | Train Loss: 3.3109 | Train Acc: 0.6133
 Site-Art                           | Train Loss: 3.2037 | Train Acc: 0.6804
 Site-Art                           | Train Loss: 3.2774 | Train Acc: 0.6905
 Site-Art                           | Train Loss: 3.3552 | Train Acc: 0.6074
 Site-Art                           | Train Loss: 3.1563 | Train Acc: 0.7095
 Site-RealWorld                     | Train Loss: 3.3810 | Train Acc: 0.6667
 Site-RealWorld                     | Train Loss: 3.2569 | Train Acc: 0.6889
 Site-RealWorld                     | Train Loss: 3.1088 | Train Acc: 0.6618
 Site-RealWorld                     | Train Loss: 3.3435 | Train Acc: 0.7030
 Site-RealWorld                     | Train Loss: 3.2559 | Train Acc: 0.6974
 Site-Clipart                       | Train Loss: 3.4532 | Train Acc: 0.5082
 Site-Clipart                       | Train Loss: 3.5948 | Train Acc: 0.4344
 Site-Product                       | Train Loss: 3.4569 | Train Acc: 0.6118
Average Train Accuracy: 0.6448
 Site-Art                           | Val  Loss: 3.5463 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 3.5203 | Val  Acc: 0.4444
 Site-Art                           | Val  Loss: 3.3727 | Val  Acc: 0.5652
 Site-Art                           | Val  Loss: 3.2999 | Val  Acc: 0.6333
 Site-Art                           | Val  Loss: 3.5104 | Val  Acc: 0.4359
 Site-Art                           | Val  Loss: 3.2981 | Val  Acc: 0.6400
 Site-Art                           | Val  Loss: 3.5627 | Val  Acc: 0.6462
 Site-Art                           | Val  Loss: 3.2812 | Val  Acc: 0.6905
 Site-Art                           | Val  Loss: 3.2272 | Val  Acc: 0.6852
 Site-Art                           | Val  Loss: 3.3144 | Val  Acc: 0.6214
 Site-RealWorld                     | Val  Loss: 3.1186 | Val  Acc: 0.8500
 Site-RealWorld                     | Val  Loss: 3.2961 | Val  Acc: 0.8333
 Site-RealWorld                     | Val  Loss: 3.2984 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 3.0916 | Val  Acc: 0.6567
 Site-RealWorld                     | Val  Loss: 3.3025 | Val  Acc: 0.6832
 Site-Clipart                       | Val  Loss: 3.6294 | Val  Acc: 0.3500
 Site-Clipart                       | Val  Loss: 3.5808 | Val  Acc: 0.4321
 Site-Product                       | Val  Loss: 3.3964 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6098
 Best site-Art                       | Epoch:1 | Val Acc: 0.5000
 Best site-Art                       | Epoch:1 | Val Acc: 0.4444
 Best site-Art                       | Epoch:1 | Val Acc: 0.5652
 Best site-Art                       | Epoch:1 | Val Acc: 0.6333
 Best site-Art                       | Epoch:1 | Val Acc: 0.4359
 Best site-Art                       | Epoch:1 | Val Acc: 0.6400
 Best site-Art                       | Epoch:1 | Val Acc: 0.6462
 Best site-Art                       | Epoch:1 | Val Acc: 0.6905
 Best site-Art                       | Epoch:1 | Val Acc: 0.6852
 Best site-Art                       | Epoch:1 | Val Acc: 0.6214
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8500
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8333
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.6567
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.6832
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.3500
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.4321
 Best site-Product                   | Epoch:1 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 2 ============
 Site-Art                           | Train Loss: 2.9665 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.9452 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 3.0236 | Train Acc: 0.6286
 Site-Art                           | Train Loss: 3.0495 | Train Acc: 0.6889
 Site-Art                           | Train Loss: 2.9180 | Train Acc: 0.6379
 Site-Art                           | Train Loss: 2.9537 | Train Acc: 0.6400
 Site-Art                           | Train Loss: 2.7474 | Train Acc: 0.7423
 Site-Art                           | Train Loss: 2.9272 | Train Acc: 0.6984
 Site-Art                           | Train Loss: 3.0047 | Train Acc: 0.6135
 Site-Art                           | Train Loss: 2.7222 | Train Acc: 0.7667
 Site-RealWorld                     | Train Loss: 2.9371 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.8194 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.5815 | Train Acc: 0.7059
 Site-RealWorld                     | Train Loss: 2.9207 | Train Acc: 0.7426
 Site-RealWorld                     | Train Loss: 2.8973 | Train Acc: 0.7368
 Site-Clipart                       | Train Loss: 3.1842 | Train Acc: 0.5410
 Site-Clipart                       | Train Loss: 3.3383 | Train Acc: 0.4672
 Site-Product                       | Train Loss: 3.0842 | Train Acc: 0.6353
Average Train Accuracy: 0.6848
 Site-Art                           | Val  Loss: 3.1889 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 3.2901 | Val  Acc: 0.4444
 Site-Art                           | Val  Loss: 3.0088 | Val  Acc: 0.5217
 Site-Art                           | Val  Loss: 2.8619 | Val  Acc: 0.6667
 Site-Art                           | Val  Loss: 3.2023 | Val  Acc: 0.4615
 Site-Art                           | Val  Loss: 2.9222 | Val  Acc: 0.6400
 Site-Art                           | Val  Loss: 3.0048 | Val  Acc: 0.7231
 Site-Art                           | Val  Loss: 2.8890 | Val  Acc: 0.7024
 Site-Art                           | Val  Loss: 2.8384 | Val  Acc: 0.6944
 Site-Art                           | Val  Loss: 2.9571 | Val  Acc: 0.6286
 Site-RealWorld                     | Val  Loss: 2.6316 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.8004 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 2.9373 | Val  Acc: 0.6889
 Site-RealWorld                     | Val  Loss: 2.6784 | Val  Acc: 0.7164
 Site-RealWorld                     | Val  Loss: 2.8929 | Val  Acc: 0.7525
 Site-Clipart                       | Val  Loss: 3.3742 | Val  Acc: 0.3750
 Site-Clipart                       | Val  Loss: 3.3243 | Val  Acc: 0.4198
 Site-Product                       | Val  Loss: 3.0107 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6342
 Best site-Art                       | Epoch:2 | Val Acc: 0.5714
 Best site-Art                       | Epoch:2 | Val Acc: 0.4444
 Best site-Art                       | Epoch:2 | Val Acc: 0.5217
 Best site-Art                       | Epoch:2 | Val Acc: 0.6667
 Best site-Art                       | Epoch:2 | Val Acc: 0.4615
 Best site-Art                       | Epoch:2 | Val Acc: 0.6400
 Best site-Art                       | Epoch:2 | Val Acc: 0.7231
 Best site-Art                       | Epoch:2 | Val Acc: 0.7024
 Best site-Art                       | Epoch:2 | Val Acc: 0.6944
 Best site-Art                       | Epoch:2 | Val Acc: 0.6286
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6889
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.7164
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.7525
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.3750
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.4198
 Best site-Product                   | Epoch:2 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 3 ============
 Site-Art                           | Train Loss: 2.6583 | Train Acc: 0.6190
 Site-Art                           | Train Loss: 2.6663 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 2.6747 | Train Acc: 0.6571
 Site-Art                           | Train Loss: 2.7323 | Train Acc: 0.7111
 Site-Art                           | Train Loss: 2.6220 | Train Acc: 0.6207
 Site-Art                           | Train Loss: 2.7202 | Train Acc: 0.6933
 Site-Art                           | Train Loss: 2.4495 | Train Acc: 0.7216
 Site-Art                           | Train Loss: 2.5256 | Train Acc: 0.7460
 Site-Art                           | Train Loss: 2.6902 | Train Acc: 0.6319
 Site-Art                           | Train Loss: 2.3208 | Train Acc: 0.7762
 Site-RealWorld                     | Train Loss: 2.6211 | Train Acc: 0.7667
 Site-RealWorld                     | Train Loss: 2.4322 | Train Acc: 0.8222
 Site-RealWorld                     | Train Loss: 2.5161 | Train Acc: 0.6765
 Site-RealWorld                     | Train Loss: 2.6354 | Train Acc: 0.7327
 Site-RealWorld                     | Train Loss: 2.5298 | Train Acc: 0.7697
 Site-Clipart                       | Train Loss: 2.8635 | Train Acc: 0.5738
 Site-Clipart                       | Train Loss: 3.1045 | Train Acc: 0.5082
 Site-Product                       | Train Loss: 2.7600 | Train Acc: 0.6235
Average Train Accuracy: 0.6905
 Site-Art                           | Val  Loss: 2.9105 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 2.9917 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 2.7289 | Val  Acc: 0.6087
 Site-Art                           | Val  Loss: 2.5600 | Val  Acc: 0.6000
 Site-Art                           | Val  Loss: 2.9267 | Val  Acc: 0.5385
 Site-Art                           | Val  Loss: 2.5213 | Val  Acc: 0.7400
 Site-Art                           | Val  Loss: 3.0623 | Val  Acc: 0.7231
 Site-Art                           | Val  Loss: 2.5645 | Val  Acc: 0.7024
 Site-Art                           | Val  Loss: 2.4621 | Val  Acc: 0.7407
 Site-Art                           | Val  Loss: 2.6085 | Val  Acc: 0.6214
 Site-RealWorld                     | Val  Loss: 2.2298 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.4432 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.6006 | Val  Acc: 0.6889
 Site-RealWorld                     | Val  Loss: 2.1955 | Val  Acc: 0.7015
 Site-RealWorld                     | Val  Loss: 2.4906 | Val  Acc: 0.8020
 Site-Clipart                       | Val  Loss: 3.1130 | Val  Acc: 0.4000
 Site-Clipart                       | Val  Loss: 3.1058 | Val  Acc: 0.4074
 Site-Product                       | Val  Loss: 2.7192 | Val  Acc: 0.6607
Average Valid Accuracy: 0.6559
 Best site-Art                       | Epoch:3 | Val Acc: 0.5714
 Best site-Art                       | Epoch:3 | Val Acc: 0.5000
 Best site-Art                       | Epoch:3 | Val Acc: 0.6087
 Best site-Art                       | Epoch:3 | Val Acc: 0.6000
 Best site-Art                       | Epoch:3 | Val Acc: 0.5385
 Best site-Art                       | Epoch:3 | Val Acc: 0.7400
 Best site-Art                       | Epoch:3 | Val Acc: 0.7231
 Best site-Art                       | Epoch:3 | Val Acc: 0.7024
 Best site-Art                       | Epoch:3 | Val Acc: 0.7407
 Best site-Art                       | Epoch:3 | Val Acc: 0.6214
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6889
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7015
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8020
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.4000
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.4074
 Best site-Product                   | Epoch:3 | Val Acc: 0.6607
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 4 ============
 Site-Art                           | Train Loss: 2.3378 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.3503 | Train Acc: 0.7407
 Site-Art                           | Train Loss: 2.3847 | Train Acc: 0.6857
 Site-Art                           | Train Loss: 2.4831 | Train Acc: 0.7333
 Site-Art                           | Train Loss: 2.2538 | Train Acc: 0.6897
 Site-Art                           | Train Loss: 2.1078 | Train Acc: 0.7333
 Site-Art                           | Train Loss: 2.1556 | Train Acc: 0.7526
 Site-Art                           | Train Loss: 2.2726 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.3932 | Train Acc: 0.6933
 Site-Art                           | Train Loss: 2.0890 | Train Acc: 0.8143
 Site-RealWorld                     | Train Loss: 2.3182 | Train Acc: 0.7667
 Site-RealWorld                     | Train Loss: 2.1002 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.1535 | Train Acc: 0.7353
 Site-RealWorld                     | Train Loss: 2.3310 | Train Acc: 0.7624
 Site-RealWorld                     | Train Loss: 2.2459 | Train Acc: 0.7895
 Site-Clipart                       | Train Loss: 2.5899 | Train Acc: 0.5410
 Site-Clipart                       | Train Loss: 2.8146 | Train Acc: 0.5246
 Site-Product                       | Train Loss: 2.3942 | Train Acc: 0.7176
Average Train Accuracy: 0.7221
 Site-Art                           | Val  Loss: 2.7010 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 2.6706 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 2.3978 | Val  Acc: 0.6522
 Site-Art                           | Val  Loss: 2.2526 | Val  Acc: 0.6333
 Site-Art                           | Val  Loss: 2.6635 | Val  Acc: 0.5385
 Site-Art                           | Val  Loss: 2.3017 | Val  Acc: 0.7400
 Site-Art                           | Val  Loss: 2.3388 | Val  Acc: 0.7538
 Site-Art                           | Val  Loss: 2.2724 | Val  Acc: 0.7262
 Site-Art                           | Val  Loss: 2.1860 | Val  Acc: 0.7222
 Site-Art                           | Val  Loss: 2.3204 | Val  Acc: 0.7071
 Site-RealWorld                     | Val  Loss: 1.8543 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.1143 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.4404 | Val  Acc: 0.6444
 Site-RealWorld                     | Val  Loss: 1.9811 | Val  Acc: 0.7463
 Site-RealWorld                     | Val  Loss: 2.1922 | Val  Acc: 0.7921
 Site-Clipart                       | Val  Loss: 2.8372 | Val  Acc: 0.4750
 Site-Clipart                       | Val  Loss: 2.8999 | Val  Acc: 0.4815
 Site-Product                       | Val  Loss: 2.4093 | Val  Acc: 0.6964
Average Valid Accuracy: 0.6834
 Best site-Art                       | Epoch:4 | Val Acc: 0.6429
 Best site-Art                       | Epoch:4 | Val Acc: 0.5000
 Best site-Art                       | Epoch:4 | Val Acc: 0.6522
 Best site-Art                       | Epoch:4 | Val Acc: 0.6333
 Best site-Art                       | Epoch:4 | Val Acc: 0.5385
 Best site-Art                       | Epoch:4 | Val Acc: 0.7400
 Best site-Art                       | Epoch:4 | Val Acc: 0.7538
 Best site-Art                       | Epoch:4 | Val Acc: 0.7262
 Best site-Art                       | Epoch:4 | Val Acc: 0.7222
 Best site-Art                       | Epoch:4 | Val Acc: 0.7071
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6444
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7463
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7921
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.4750
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.4815
 Best site-Product                   | Epoch:4 | Val Acc: 0.6964
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 5 ============
 Site-Art                           | Train Loss: 2.1012 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.1559 | Train Acc: 0.7407
 Site-Art                           | Train Loss: 2.1579 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.2120 | Train Acc: 0.7333
 Site-Art                           | Train Loss: 2.0870 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 2.2420 | Train Acc: 0.7067
 Site-Art                           | Train Loss: 1.9162 | Train Acc: 0.7629
 Site-Art                           | Train Loss: 2.0174 | Train Acc: 0.7540
 Site-Art                           | Train Loss: 2.1247 | Train Acc: 0.6503
 Site-Art                           | Train Loss: 1.7584 | Train Acc: 0.8238
 Site-RealWorld                     | Train Loss: 2.1060 | Train Acc: 0.7667
 Site-RealWorld                     | Train Loss: 1.8947 | Train Acc: 0.8222
 Site-RealWorld                     | Train Loss: 1.6633 | Train Acc: 0.7353
 Site-RealWorld                     | Train Loss: 2.1019 | Train Acc: 0.7624
 Site-RealWorld                     | Train Loss: 1.8599 | Train Acc: 0.8092
 Site-Clipart                       | Train Loss: 2.4779 | Train Acc: 0.5574
 Site-Clipart                       | Train Loss: 2.6510 | Train Acc: 0.4836
 Site-Product                       | Train Loss: 2.3563 | Train Acc: 0.6588
Average Train Accuracy: 0.7161
 Site-Art                           | Val  Loss: 2.5941 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 2.5471 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 2.1540 | Val  Acc: 0.6957
 Site-Art                           | Val  Loss: 1.8801 | Val  Acc: 0.7333
 Site-Art                           | Val  Loss: 2.4322 | Val  Acc: 0.5641
 Site-Art                           | Val  Loss: 1.9836 | Val  Acc: 0.7600
 Site-Art                           | Val  Loss: 2.5664 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 1.9164 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.9012 | Val  Acc: 0.7593
 Site-Art                           | Val  Loss: 2.0113 | Val  Acc: 0.6929
 Site-RealWorld                     | Val  Loss: 1.6945 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.9742 | Val  Acc: 0.8333
 Site-RealWorld                     | Val  Loss: 2.1932 | Val  Acc: 0.7111
 Site-RealWorld                     | Val  Loss: 1.5548 | Val  Acc: 0.7313
 Site-RealWorld                     | Val  Loss: 1.8561 | Val  Acc: 0.8416
 Site-Clipart                       | Val  Loss: 2.6879 | Val  Acc: 0.4500
 Site-Clipart                       | Val  Loss: 2.6696 | Val  Acc: 0.4691
 Site-Product                       | Val  Loss: 2.1135 | Val  Acc: 0.7321
Average Valid Accuracy: 0.6964
 Best site-Art                       | Epoch:5 | Val Acc: 0.6429
 Best site-Art                       | Epoch:5 | Val Acc: 0.5000
 Best site-Art                       | Epoch:5 | Val Acc: 0.6957
 Best site-Art                       | Epoch:5 | Val Acc: 0.7333
 Best site-Art                       | Epoch:5 | Val Acc: 0.5641
 Best site-Art                       | Epoch:5 | Val Acc: 0.7600
 Best site-Art                       | Epoch:5 | Val Acc: 0.7692
 Best site-Art                       | Epoch:5 | Val Acc: 0.7500
 Best site-Art                       | Epoch:5 | Val Acc: 0.7593
 Best site-Art                       | Epoch:5 | Val Acc: 0.6929
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8333
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7111
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7313
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8416
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.4500
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.4691
 Best site-Product                   | Epoch:5 | Val Acc: 0.7321
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 6 ============
 Site-Art                           | Train Loss: 1.8845 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.9266 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.9114 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 2.0909 | Train Acc: 0.6889
 Site-Art                           | Train Loss: 1.8321 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 1.7881 | Train Acc: 0.7467
 Site-Art                           | Train Loss: 1.5842 | Train Acc: 0.7938
 Site-Art                           | Train Loss: 1.8351 | Train Acc: 0.7937
 Site-Art                           | Train Loss: 1.9351 | Train Acc: 0.7239
 Site-Art                           | Train Loss: 1.5269 | Train Acc: 0.8524
 Site-RealWorld                     | Train Loss: 1.8996 | Train Acc: 0.7667
 Site-RealWorld                     | Train Loss: 1.6252 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.6065 | Train Acc: 0.7647
 Site-RealWorld                     | Train Loss: 1.8085 | Train Acc: 0.7921
 Site-RealWorld                     | Train Loss: 1.6294 | Train Acc: 0.8421
 Site-Clipart                       | Train Loss: 2.3202 | Train Acc: 0.5738
 Site-Clipart                       | Train Loss: 2.5051 | Train Acc: 0.5492
 Site-Product                       | Train Loss: 1.8432 | Train Acc: 0.7176
Average Train Accuracy: 0.7544
 Site-Art                           | Val  Loss: 2.1888 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 2.4140 | Val  Acc: 0.4444
 Site-Art                           | Val  Loss: 2.0593 | Val  Acc: 0.6522
 Site-Art                           | Val  Loss: 1.7851 | Val  Acc: 0.7000
 Site-Art                           | Val  Loss: 2.2238 | Val  Acc: 0.6154
 Site-Art                           | Val  Loss: 1.8307 | Val  Acc: 0.7400
 Site-Art                           | Val  Loss: 2.4553 | Val  Acc: 0.7538
 Site-Art                           | Val  Loss: 1.7288 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.7102 | Val  Acc: 0.7593
 Site-Art                           | Val  Loss: 1.8104 | Val  Acc: 0.6929
 Site-RealWorld                     | Val  Loss: 1.4006 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.5941 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.9346 | Val  Acc: 0.6889
 Site-RealWorld                     | Val  Loss: 1.2557 | Val  Acc: 0.7463
 Site-RealWorld                     | Val  Loss: 1.6785 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 2.6101 | Val  Acc: 0.4250
 Site-Clipart                       | Val  Loss: 2.3873 | Val  Acc: 0.5185
 Site-Product                       | Val  Loss: 1.9507 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6916
============ Train epoch 7 ============
 Site-Art                           | Train Loss: 1.7640 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.7821 | Train Acc: 0.7037
 Site-Art                           | Train Loss: 1.9229 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.7819 | Train Acc: 0.7333
 Site-Art                           | Train Loss: 1.7167 | Train Acc: 0.7241
 Site-Art                           | Train Loss: 1.5975 | Train Acc: 0.7467
 Site-Art                           | Train Loss: 1.4222 | Train Acc: 0.8144
 Site-Art                           | Train Loss: 1.5897 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.7569 | Train Acc: 0.6933
 Site-Art                           | Train Loss: 1.3385 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.6532 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 1.3852 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.5962 | Train Acc: 0.7794
 Site-RealWorld                     | Train Loss: 1.6210 | Train Acc: 0.7822
 Site-RealWorld                     | Train Loss: 1.4731 | Train Acc: 0.8355
 Site-Clipart                       | Train Loss: 2.0489 | Train Acc: 0.6066
 Site-Clipart                       | Train Loss: 2.4199 | Train Acc: 0.4672
 Site-Product                       | Train Loss: 1.9364 | Train Acc: 0.6941
Average Train Accuracy: 0.7408
 Site-Art                           | Val  Loss: 1.9248 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.2719 | Val  Acc: 0.3889
 Site-Art                           | Val  Loss: 1.7587 | Val  Acc: 0.6522
 Site-Art                           | Val  Loss: 1.5364 | Val  Acc: 0.7333
 Site-Art                           | Val  Loss: 2.0901 | Val  Acc: 0.5641
 Site-Art                           | Val  Loss: 1.5844 | Val  Acc: 0.8000
 Site-Art                           | Val  Loss: 2.1103 | Val  Acc: 0.7231
 Site-Art                           | Val  Loss: 1.6361 | Val  Acc: 0.7381
 Site-Art                           | Val  Loss: 1.4858 | Val  Acc: 0.7870
 Site-Art                           | Val  Loss: 1.6327 | Val  Acc: 0.7357
 Site-RealWorld                     | Val  Loss: 1.1460 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.3618 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 1.7892 | Val  Acc: 0.7333
 Site-RealWorld                     | Val  Loss: 1.1044 | Val  Acc: 0.7612
 Site-RealWorld                     | Val  Loss: 1.4772 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 2.4384 | Val  Acc: 0.4000
 Site-Clipart                       | Val  Loss: 2.3931 | Val  Acc: 0.4815
 Site-Product                       | Val  Loss: 1.7397 | Val  Acc: 0.6964
Average Valid Accuracy: 0.6987
 Best site-Art                       | Epoch:7 | Val Acc: 0.7143
 Best site-Art                       | Epoch:7 | Val Acc: 0.3889
 Best site-Art                       | Epoch:7 | Val Acc: 0.6522
 Best site-Art                       | Epoch:7 | Val Acc: 0.7333
 Best site-Art                       | Epoch:7 | Val Acc: 0.5641
 Best site-Art                       | Epoch:7 | Val Acc: 0.8000
 Best site-Art                       | Epoch:7 | Val Acc: 0.7231
 Best site-Art                       | Epoch:7 | Val Acc: 0.7381
 Best site-Art                       | Epoch:7 | Val Acc: 0.7870
 Best site-Art                       | Epoch:7 | Val Acc: 0.7357
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7333
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7612
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8515
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.4000
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.4815
 Best site-Product                   | Epoch:7 | Val Acc: 0.6964
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 8 ============
 Site-Art                           | Train Loss: 1.5865 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.6936 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.6500 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.7114 | Train Acc: 0.7556
 Site-Art                           | Train Loss: 1.5852 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 1.5430 | Train Acc: 0.7600
 Site-Art                           | Train Loss: 1.4310 | Train Acc: 0.7732
 Site-Art                           | Train Loss: 1.4639 | Train Acc: 0.8016
 Site-Art                           | Train Loss: 1.6515 | Train Acc: 0.7178
 Site-Art                           | Train Loss: 1.1915 | Train Acc: 0.8905
 Site-RealWorld                     | Train Loss: 1.4139 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.3308 | Train Acc: 0.8222
 Site-RealWorld                     | Train Loss: 1.2378 | Train Acc: 0.8088
 Site-RealWorld                     | Train Loss: 1.5034 | Train Acc: 0.7723
 Site-RealWorld                     | Train Loss: 1.2790 | Train Acc: 0.8487
 Site-Clipart                       | Train Loss: 1.9556 | Train Acc: 0.6393
 Site-Clipart                       | Train Loss: 2.1823 | Train Acc: 0.5246
 Site-Product                       | Train Loss: 1.6732 | Train Acc: 0.7176
Average Train Accuracy: 0.7581
 Site-Art                           | Val  Loss: 2.2022 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 2.0632 | Val  Acc: 0.5556
 Site-Art                           | Val  Loss: 1.5641 | Val  Acc: 0.7826
 Site-Art                           | Val  Loss: 1.3529 | Val  Acc: 0.7667
 Site-Art                           | Val  Loss: 1.9161 | Val  Acc: 0.6154
 Site-Art                           | Val  Loss: 1.5546 | Val  Acc: 0.7600
 Site-Art                           | Val  Loss: 2.2308 | Val  Acc: 0.7846
 Site-Art                           | Val  Loss: 1.5373 | Val  Acc: 0.7262
 Site-Art                           | Val  Loss: 1.3396 | Val  Acc: 0.7778
 Site-Art                           | Val  Loss: 1.4955 | Val  Acc: 0.7571
 Site-RealWorld                     | Val  Loss: 1.0280 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.1700 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.5476 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 0.9256 | Val  Acc: 0.7761
 Site-RealWorld                     | Val  Loss: 1.2875 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 2.3507 | Val  Acc: 0.4750
 Site-Clipart                       | Val  Loss: 2.2237 | Val  Acc: 0.4938
 Site-Product                       | Val  Loss: 1.5467 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7242
 Best site-Art                       | Epoch:8 | Val Acc: 0.5000
 Best site-Art                       | Epoch:8 | Val Acc: 0.5556
 Best site-Art                       | Epoch:8 | Val Acc: 0.7826
 Best site-Art                       | Epoch:8 | Val Acc: 0.7667
 Best site-Art                       | Epoch:8 | Val Acc: 0.6154
 Best site-Art                       | Epoch:8 | Val Acc: 0.7600
 Best site-Art                       | Epoch:8 | Val Acc: 0.7846
 Best site-Art                       | Epoch:8 | Val Acc: 0.7262
 Best site-Art                       | Epoch:8 | Val Acc: 0.7778
 Best site-Art                       | Epoch:8 | Val Acc: 0.7571
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.7778
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.7761
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8515
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.4750
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.4938
 Best site-Product                   | Epoch:8 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 9 ============
 Site-Art                           | Train Loss: 1.5539 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.4643 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.4923 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.6404 | Train Acc: 0.7111
 Site-Art                           | Train Loss: 1.4889 | Train Acc: 0.7069
 Site-Art                           | Train Loss: 1.6046 | Train Acc: 0.7467
 Site-Art                           | Train Loss: 1.2919 | Train Acc: 0.7835
 Site-Art                           | Train Loss: 1.3011 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.5100 | Train Acc: 0.7485
 Site-Art                           | Train Loss: 1.1148 | Train Acc: 0.8905
 Site-RealWorld                     | Train Loss: 1.3720 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 1.0712 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 1.6357 | Train Acc: 0.8088
 Site-RealWorld                     | Train Loss: 1.4186 | Train Acc: 0.8020
 Site-RealWorld                     | Train Loss: 1.1670 | Train Acc: 0.8684
 Site-Clipart                       | Train Loss: 1.7821 | Train Acc: 0.6557
 Site-Clipart                       | Train Loss: 2.1614 | Train Acc: 0.5574
 Site-Product                       | Train Loss: 1.4991 | Train Acc: 0.7529
Average Train Accuracy: 0.7704
 Site-Art                           | Val  Loss: 1.6804 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 1.8866 | Val  Acc: 0.6111
 Site-Art                           | Val  Loss: 1.4255 | Val  Acc: 0.7826
 Site-Art                           | Val  Loss: 1.2695 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 1.8035 | Val  Acc: 0.6923
 Site-Art                           | Val  Loss: 1.3195 | Val  Acc: 0.8400
 Site-Art                           | Val  Loss: 2.2489 | Val  Acc: 0.8000
 Site-Art                           | Val  Loss: 1.4043 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.2070 | Val  Acc: 0.7963
 Site-Art                           | Val  Loss: 1.3881 | Val  Acc: 0.7429
 Site-RealWorld                     | Val  Loss: 0.8380 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.0415 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.4247 | Val  Acc: 0.7111
 Site-RealWorld                     | Val  Loss: 0.8507 | Val  Acc: 0.8060
 Site-RealWorld                     | Val  Loss: 1.1871 | Val  Acc: 0.8713
 Site-Clipart                       | Val  Loss: 2.2386 | Val  Acc: 0.4750
 Site-Clipart                       | Val  Loss: 2.0801 | Val  Acc: 0.5309
 Site-Product                       | Val  Loss: 1.3301 | Val  Acc: 0.8036
Average Valid Accuracy: 0.7522
 Best site-Art                       | Epoch:9 | Val Acc: 0.6429
 Best site-Art                       | Epoch:9 | Val Acc: 0.6111
 Best site-Art                       | Epoch:9 | Val Acc: 0.7826
 Best site-Art                       | Epoch:9 | Val Acc: 0.8333
 Best site-Art                       | Epoch:9 | Val Acc: 0.6923
 Best site-Art                       | Epoch:9 | Val Acc: 0.8400
 Best site-Art                       | Epoch:9 | Val Acc: 0.8000
 Best site-Art                       | Epoch:9 | Val Acc: 0.7500
 Best site-Art                       | Epoch:9 | Val Acc: 0.7963
 Best site-Art                       | Epoch:9 | Val Acc: 0.7429
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7111
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8060
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8713
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.4750
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.5309
 Best site-Product                   | Epoch:9 | Val Acc: 0.8036
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 10 ============
 Site-Art                           | Train Loss: 1.4620 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.4222 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.5466 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.5492 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 1.4004 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 1.5423 | Train Acc: 0.7733
 Site-Art                           | Train Loss: 1.1003 | Train Acc: 0.7938
 Site-Art                           | Train Loss: 1.1906 | Train Acc: 0.8016
 Site-Art                           | Train Loss: 1.3857 | Train Acc: 0.7730
 Site-Art                           | Train Loss: 0.9016 | Train Acc: 0.8762
 Site-RealWorld                     | Train Loss: 1.1796 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.9911 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.1897 | Train Acc: 0.7941
 Site-RealWorld                     | Train Loss: 1.2564 | Train Acc: 0.7723
 Site-RealWorld                     | Train Loss: 1.0486 | Train Acc: 0.8618
 Site-Clipart                       | Train Loss: 1.6722 | Train Acc: 0.6230
 Site-Clipart                       | Train Loss: 2.0198 | Train Acc: 0.5820
 Site-Product                       | Train Loss: 1.5320 | Train Acc: 0.7059
Average Train Accuracy: 0.7772
 Site-Art                           | Val  Loss: 1.6845 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.8332 | Val  Acc: 0.5000
 Site-Art                           | Val  Loss: 1.3405 | Val  Acc: 0.7391
 Site-Art                           | Val  Loss: 1.1917 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 1.6312 | Val  Acc: 0.7179
 Site-Art                           | Val  Loss: 1.3057 | Val  Acc: 0.8200
 Site-Art                           | Val  Loss: 2.1275 | Val  Acc: 0.8000
 Site-Art                           | Val  Loss: 1.2678 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.1377 | Val  Acc: 0.7870
 Site-Art                           | Val  Loss: 1.2820 | Val  Acc: 0.7571
 Site-RealWorld                     | Val  Loss: 0.8034 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.9827 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 1.3686 | Val  Acc: 0.8222
 Site-RealWorld                     | Val  Loss: 0.8828 | Val  Acc: 0.8060
 Site-RealWorld                     | Val  Loss: 1.0540 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 2.0812 | Val  Acc: 0.5000
 Site-Clipart                       | Val  Loss: 2.0731 | Val  Acc: 0.5802
 Site-Product                       | Val  Loss: 1.3093 | Val  Acc: 0.7679
Average Valid Accuracy: 0.7580
 Best site-Art                       | Epoch:10 | Val Acc: 0.7857
 Best site-Art                       | Epoch:10 | Val Acc: 0.5000
 Best site-Art                       | Epoch:10 | Val Acc: 0.7391
 Best site-Art                       | Epoch:10 | Val Acc: 0.8333
 Best site-Art                       | Epoch:10 | Val Acc: 0.7179
 Best site-Art                       | Epoch:10 | Val Acc: 0.8200
 Best site-Art                       | Epoch:10 | Val Acc: 0.8000
 Best site-Art                       | Epoch:10 | Val Acc: 0.7500
 Best site-Art                       | Epoch:10 | Val Acc: 0.7870
 Best site-Art                       | Epoch:10 | Val Acc: 0.7571
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8222
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8060
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8614
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.5802
 Best site-Product                   | Epoch:10 | Val Acc: 0.7679
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 11 ============
 Site-Art                           | Train Loss: 1.4409 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.3713 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.4132 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 1.4396 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.2778 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 1.2819 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.0107 | Train Acc: 0.8041
 Site-Art                           | Train Loss: 1.0603 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.2874 | Train Acc: 0.7791
 Site-Art                           | Train Loss: 0.8350 | Train Acc: 0.9143
 Site-RealWorld                     | Train Loss: 1.0416 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.8796 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.0756 | Train Acc: 0.8382
 Site-RealWorld                     | Train Loss: 1.1869 | Train Acc: 0.8317
 Site-RealWorld                     | Train Loss: 0.9586 | Train Acc: 0.8882
 Site-Clipart                       | Train Loss: 1.5932 | Train Acc: 0.6557
 Site-Clipart                       | Train Loss: 1.9382 | Train Acc: 0.5492
 Site-Product                       | Train Loss: 1.1797 | Train Acc: 0.8000
Average Train Accuracy: 0.7933
 Site-Art                           | Val  Loss: 1.5246 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.8244 | Val  Acc: 0.6667
 Site-Art                           | Val  Loss: 1.3398 | Val  Acc: 0.7391
 Site-Art                           | Val  Loss: 0.9463 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 1.5312 | Val  Acc: 0.7179
 Site-Art                           | Val  Loss: 1.1920 | Val  Acc: 0.8400
 Site-Art                           | Val  Loss: 1.2380 | Val  Acc: 0.8000
 Site-Art                           | Val  Loss: 1.2026 | Val  Acc: 0.7976
 Site-Art                           | Val  Loss: 1.1313 | Val  Acc: 0.7778
 Site-Art                           | Val  Loss: 1.1700 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.6455 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.8174 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.3114 | Val  Acc: 0.7778
 Site-RealWorld                     | Val  Loss: 0.7054 | Val  Acc: 0.7761
 Site-RealWorld                     | Val  Loss: 0.9694 | Val  Acc: 0.8713
 Site-Clipart                       | Val  Loss: 1.9929 | Val  Acc: 0.5500
 Site-Clipart                       | Val  Loss: 1.8520 | Val  Acc: 0.5309
 Site-Product                       | Val  Loss: 1.1932 | Val  Acc: 0.7679
Average Valid Accuracy: 0.7768
 Best site-Art                       | Epoch:11 | Val Acc: 0.7857
 Best site-Art                       | Epoch:11 | Val Acc: 0.6667
 Best site-Art                       | Epoch:11 | Val Acc: 0.7391
 Best site-Art                       | Epoch:11 | Val Acc: 0.9000
 Best site-Art                       | Epoch:11 | Val Acc: 0.7179
 Best site-Art                       | Epoch:11 | Val Acc: 0.8400
 Best site-Art                       | Epoch:11 | Val Acc: 0.8000
 Best site-Art                       | Epoch:11 | Val Acc: 0.7976
 Best site-Art                       | Epoch:11 | Val Acc: 0.7778
 Best site-Art                       | Epoch:11 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.7778
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.7761
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8713
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.5500
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.5309
 Best site-Product                   | Epoch:11 | Val Acc: 0.7679
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 12 ============
 Site-Art                           | Train Loss: 1.1954 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.3273 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.2882 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.3068 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.1929 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 1.0620 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.0794 | Train Acc: 0.8144
 Site-Art                           | Train Loss: 1.0615 | Train Acc: 0.8254
 Site-Art                           | Train Loss: 1.1943 | Train Acc: 0.8037
 Site-Art                           | Train Loss: 0.7821 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 0.9223 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.8444 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.9112 | Train Acc: 0.7647
 Site-RealWorld                     | Train Loss: 1.1344 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.7699 | Train Acc: 0.8816
 Site-Clipart                       | Train Loss: 1.5674 | Train Acc: 0.6557
 Site-Clipart                       | Train Loss: 1.9070 | Train Acc: 0.5902
 Site-Product                       | Train Loss: 1.2157 | Train Acc: 0.8353
Average Train Accuracy: 0.8040
 Site-Art                           | Val  Loss: 1.6713 | Val  Acc: 0.6429
 Site-Art                           | Val  Loss: 1.6352 | Val  Acc: 0.5556
 Site-Art                           | Val  Loss: 0.8957 | Val  Acc: 0.8261
 Site-Art                           | Val  Loss: 0.8996 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 1.3339 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 1.0519 | Val  Acc: 0.8600
 Site-Art                           | Val  Loss: 1.5413 | Val  Acc: 0.8308
 Site-Art                           | Val  Loss: 1.1344 | Val  Acc: 0.7619
 Site-Art                           | Val  Loss: 1.0270 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 1.0854 | Val  Acc: 0.8286
 Site-RealWorld                     | Val  Loss: 0.6447 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.7101 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.2016 | Val  Acc: 0.8444
 Site-RealWorld                     | Val  Loss: 0.7124 | Val  Acc: 0.8060
 Site-RealWorld                     | Val  Loss: 0.9064 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 1.8971 | Val  Acc: 0.5750
 Site-Clipart                       | Val  Loss: 1.8005 | Val  Acc: 0.5926
 Site-Product                       | Val  Loss: 1.1467 | Val  Acc: 0.8036
Average Valid Accuracy: 0.7888
 Best site-Art                       | Epoch:12 | Val Acc: 0.6429
 Best site-Art                       | Epoch:12 | Val Acc: 0.5556
 Best site-Art                       | Epoch:12 | Val Acc: 0.8261
 Best site-Art                       | Epoch:12 | Val Acc: 0.9333
 Best site-Art                       | Epoch:12 | Val Acc: 0.7692
 Best site-Art                       | Epoch:12 | Val Acc: 0.8600
 Best site-Art                       | Epoch:12 | Val Acc: 0.8308
 Best site-Art                       | Epoch:12 | Val Acc: 0.7619
 Best site-Art                       | Epoch:12 | Val Acc: 0.8333
 Best site-Art                       | Epoch:12 | Val Acc: 0.8286
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8444
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8060
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8515
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.5750
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.5926
 Best site-Product                   | Epoch:12 | Val Acc: 0.8036
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 13 ============
 Site-Art                           | Train Loss: 1.3081 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.1534 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.2023 | Train Acc: 0.8286
 Site-Art                           | Train Loss: 1.2481 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.2015 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 1.0085 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.9191 | Train Acc: 0.8454
 Site-Art                           | Train Loss: 1.0096 | Train Acc: 0.8254
 Site-Art                           | Train Loss: 1.0837 | Train Acc: 0.8098
 Site-Art                           | Train Loss: 0.7508 | Train Acc: 0.9095
 Site-RealWorld                     | Train Loss: 0.8061 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.7763 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.6542 | Train Acc: 0.8088
 Site-RealWorld                     | Train Loss: 1.0570 | Train Acc: 0.8218
 Site-RealWorld                     | Train Loss: 0.7888 | Train Acc: 0.9013
 Site-Clipart                       | Train Loss: 1.4985 | Train Acc: 0.6393
 Site-Clipart                       | Train Loss: 1.7691 | Train Acc: 0.6230
 Site-Product                       | Train Loss: 1.0953 | Train Acc: 0.8000
Average Train Accuracy: 0.8110
 Site-Art                           | Val  Loss: 1.4654 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.6128 | Val  Acc: 0.6667
 Site-Art                           | Val  Loss: 0.8412 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 1.0236 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 1.2469 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 0.9979 | Val  Acc: 0.8600
 Site-Art                           | Val  Loss: 1.0782 | Val  Acc: 0.8615
 Site-Art                           | Val  Loss: 1.0083 | Val  Acc: 0.8452
 Site-Art                           | Val  Loss: 0.9384 | Val  Acc: 0.8426
 Site-Art                           | Val  Loss: 1.0452 | Val  Acc: 0.8357
 Site-RealWorld                     | Val  Loss: 0.5111 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.7438 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 1.1083 | Val  Acc: 0.8222
 Site-RealWorld                     | Val  Loss: 0.5870 | Val  Acc: 0.8209
 Site-RealWorld                     | Val  Loss: 0.8790 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 1.8074 | Val  Acc: 0.5500
 Site-Clipart                       | Val  Loss: 1.8007 | Val  Acc: 0.6173
 Site-Product                       | Val  Loss: 0.9644 | Val  Acc: 0.8393
Average Valid Accuracy: 0.8014
 Best site-Art                       | Epoch:13 | Val Acc: 0.7143
 Best site-Art                       | Epoch:13 | Val Acc: 0.6667
 Best site-Art                       | Epoch:13 | Val Acc: 0.8696
 Best site-Art                       | Epoch:13 | Val Acc: 0.8333
 Best site-Art                       | Epoch:13 | Val Acc: 0.7692
 Best site-Art                       | Epoch:13 | Val Acc: 0.8600
 Best site-Art                       | Epoch:13 | Val Acc: 0.8615
 Best site-Art                       | Epoch:13 | Val Acc: 0.8452
 Best site-Art                       | Epoch:13 | Val Acc: 0.8426
 Best site-Art                       | Epoch:13 | Val Acc: 0.8357
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8222
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8209
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8614
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.5500
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.6173
 Best site-Product                   | Epoch:13 | Val Acc: 0.8393
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 14 ============
 Site-Art                           | Train Loss: 1.1687 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.1922 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 1.1509 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 1.2040 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.1856 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.8795 | Train Acc: 0.8533
 Site-Art                           | Train Loss: 0.8999 | Train Acc: 0.8454
 Site-Art                           | Train Loss: 0.9366 | Train Acc: 0.8254
 Site-Art                           | Train Loss: 1.0267 | Train Acc: 0.8466
 Site-Art                           | Train Loss: 0.6928 | Train Acc: 0.9381
 Site-RealWorld                     | Train Loss: 0.9307 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 0.7465 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5812 | Train Acc: 0.8529
 Site-RealWorld                     | Train Loss: 0.9302 | Train Acc: 0.8218
 Site-RealWorld                     | Train Loss: 0.7312 | Train Acc: 0.8882
 Site-Clipart                       | Train Loss: 1.4893 | Train Acc: 0.6557
 Site-Clipart                       | Train Loss: 1.6724 | Train Acc: 0.5984
 Site-Product                       | Train Loss: 0.9302 | Train Acc: 0.8471
Average Train Accuracy: 0.8156
 Site-Art                           | Val  Loss: 1.4417 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.4450 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 1.0372 | Val  Acc: 0.7391
 Site-Art                           | Val  Loss: 0.6773 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 1.1956 | Val  Acc: 0.8205
 Site-Art                           | Val  Loss: 0.9731 | Val  Acc: 0.8400
 Site-Art                           | Val  Loss: 1.2356 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.9689 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.9155 | Val  Acc: 0.8426
 Site-Art                           | Val  Loss: 1.0439 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.4704 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.6211 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 1.0265 | Val  Acc: 0.8222
 Site-RealWorld                     | Val  Loss: 0.5803 | Val  Acc: 0.8209
 Site-RealWorld                     | Val  Loss: 0.8244 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 1.5742 | Val  Acc: 0.5750
 Site-Clipart                       | Val  Loss: 1.7091 | Val  Acc: 0.6420
 Site-Product                       | Val  Loss: 0.9922 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8160
 Best site-Art                       | Epoch:14 | Val Acc: 0.7143
 Best site-Art                       | Epoch:14 | Val Acc: 0.8333
 Best site-Art                       | Epoch:14 | Val Acc: 0.7391
 Best site-Art                       | Epoch:14 | Val Acc: 0.9667
 Best site-Art                       | Epoch:14 | Val Acc: 0.8205
 Best site-Art                       | Epoch:14 | Val Acc: 0.8400
 Best site-Art                       | Epoch:14 | Val Acc: 0.8462
 Best site-Art                       | Epoch:14 | Val Acc: 0.8333
 Best site-Art                       | Epoch:14 | Val Acc: 0.8426
 Best site-Art                       | Epoch:14 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.8222
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.8209
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.8515
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.5750
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.6420
 Best site-Product                   | Epoch:14 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 15 ============
 Site-Art                           | Train Loss: 1.0125 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.9952 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.1328 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 1.1650 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 1.0696 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 1.0317 | Train Acc: 0.7867
 Site-Art                           | Train Loss: 0.8590 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 0.9556 | Train Acc: 0.8254
 Site-Art                           | Train Loss: 1.0148 | Train Acc: 0.8344
 Site-Art                           | Train Loss: 0.6084 | Train Acc: 0.9524
 Site-RealWorld                     | Train Loss: 0.8262 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.6915 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.7577 | Train Acc: 0.8235
 Site-RealWorld                     | Train Loss: 0.9328 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.6766 | Train Acc: 0.9145
 Site-Clipart                       | Train Loss: 1.4696 | Train Acc: 0.6885
 Site-Clipart                       | Train Loss: 1.7114 | Train Acc: 0.6475
 Site-Product                       | Train Loss: 1.0974 | Train Acc: 0.8706
Average Train Accuracy: 0.8196
 Site-Art                           | Val  Loss: 1.1974 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.3871 | Val  Acc: 0.7222
 Site-Art                           | Val  Loss: 0.7543 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.7406 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 1.1570 | Val  Acc: 0.7692
 Site-Art                           | Val  Loss: 0.8574 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 0.7481 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.9933 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.8724 | Val  Acc: 0.8148
 Site-Art                           | Val  Loss: 0.9810 | Val  Acc: 0.8143
 Site-RealWorld                     | Val  Loss: 0.4194 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.6829 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.9897 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.4960 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.7389 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 1.6773 | Val  Acc: 0.6250
 Site-Clipart                       | Val  Loss: 1.6016 | Val  Acc: 0.6543
 Site-Product                       | Val  Loss: 0.8773 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8246
 Best site-Art                       | Epoch:15 | Val Acc: 0.7857
 Best site-Art                       | Epoch:15 | Val Acc: 0.7222
 Best site-Art                       | Epoch:15 | Val Acc: 0.9130
 Best site-Art                       | Epoch:15 | Val Acc: 0.9333
 Best site-Art                       | Epoch:15 | Val Acc: 0.7692
 Best site-Art                       | Epoch:15 | Val Acc: 0.8800
 Best site-Art                       | Epoch:15 | Val Acc: 0.8462
 Best site-Art                       | Epoch:15 | Val Acc: 0.8571
 Best site-Art                       | Epoch:15 | Val Acc: 0.8148
 Best site-Art                       | Epoch:15 | Val Acc: 0.8143
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8507
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8515
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.6250
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.6543
 Best site-Product                   | Epoch:15 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 16 ============
 Site-Art                           | Train Loss: 1.2887 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 1.1064 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.0614 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 1.1249 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.0607 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.8451 | Train Acc: 0.8267
 Site-Art                           | Train Loss: 0.7656 | Train Acc: 0.8557
 Site-Art                           | Train Loss: 0.7957 | Train Acc: 0.8810
 Site-Art                           | Train Loss: 0.9516 | Train Acc: 0.8344
 Site-Art                           | Train Loss: 0.5550 | Train Acc: 0.9429
 Site-RealWorld                     | Train Loss: 0.6775 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.6772 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.6292 | Train Acc: 0.8235
 Site-RealWorld                     | Train Loss: 0.8538 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.6792 | Train Acc: 0.9145
 Site-Clipart                       | Train Loss: 1.3298 | Train Acc: 0.7213
 Site-Clipart                       | Train Loss: 1.5123 | Train Acc: 0.6721
 Site-Product                       | Train Loss: 1.0324 | Train Acc: 0.8118
Average Train Accuracy: 0.8309
 Site-Art                           | Val  Loss: 1.2272 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.4957 | Val  Acc: 0.7778
 Site-Art                           | Val  Loss: 0.8838 | Val  Acc: 0.8261
 Site-Art                           | Val  Loss: 0.8002 | Val  Acc: 0.8000
 Site-Art                           | Val  Loss: 1.0683 | Val  Acc: 0.8718
 Site-Art                           | Val  Loss: 0.8716 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 1.3433 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.8987 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.8871 | Val  Acc: 0.8426
 Site-Art                           | Val  Loss: 0.9475 | Val  Acc: 0.8357
 Site-RealWorld                     | Val  Loss: 0.4118 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.6113 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.8534 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 0.4635 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.6771 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 1.4804 | Val  Acc: 0.6500
 Site-Clipart                       | Val  Loss: 1.5890 | Val  Acc: 0.5802
 Site-Product                       | Val  Loss: 0.9738 | Val  Acc: 0.8393
Average Valid Accuracy: 0.8265
 Best site-Art                       | Epoch:16 | Val Acc: 0.8571
 Best site-Art                       | Epoch:16 | Val Acc: 0.7778
 Best site-Art                       | Epoch:16 | Val Acc: 0.8261
 Best site-Art                       | Epoch:16 | Val Acc: 0.8000
 Best site-Art                       | Epoch:16 | Val Acc: 0.8718
 Best site-Art                       | Epoch:16 | Val Acc: 0.9000
 Best site-Art                       | Epoch:16 | Val Acc: 0.8462
 Best site-Art                       | Epoch:16 | Val Acc: 0.8571
 Best site-Art                       | Epoch:16 | Val Acc: 0.8426
 Best site-Art                       | Epoch:16 | Val Acc: 0.8357
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8657
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8614
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.6500
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.5802
 Best site-Product                   | Epoch:16 | Val Acc: 0.8393
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 17 ============
 Site-Art                           | Train Loss: 1.1262 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.0248 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.2087 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 1.1838 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.1053 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 1.1365 | Train Acc: 0.8267
 Site-Art                           | Train Loss: 0.6847 | Train Acc: 0.8454
 Site-Art                           | Train Loss: 0.8781 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 0.8824 | Train Acc: 0.8344
 Site-Art                           | Train Loss: 0.4773 | Train Acc: 0.9524
 Site-RealWorld                     | Train Loss: 0.6435 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.6269 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.9754 | Train Acc: 0.8235
 Site-RealWorld                     | Train Loss: 0.8216 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.6009 | Train Acc: 0.9145
 Site-Clipart                       | Train Loss: 1.3445 | Train Acc: 0.6721
 Site-Clipart                       | Train Loss: 1.5523 | Train Acc: 0.6557
 Site-Product                       | Train Loss: 0.8065 | Train Acc: 0.8824
Average Train Accuracy: 0.8186
 Site-Art                           | Val  Loss: 1.0533 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.2088 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.7098 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.6653 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 1.0972 | Val  Acc: 0.7436
 Site-Art                           | Val  Loss: 0.8336 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 1.2004 | Val  Acc: 0.8615
 Site-Art                           | Val  Loss: 0.8727 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 0.8089 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.9313 | Val  Acc: 0.8071
 Site-RealWorld                     | Val  Loss: 0.4196 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.5547 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.9102 | Val  Acc: 0.8222
 Site-RealWorld                     | Val  Loss: 0.4967 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.7270 | Val  Acc: 0.8416
 Site-Clipart                       | Val  Loss: 1.5475 | Val  Acc: 0.7000
 Site-Clipart                       | Val  Loss: 1.6059 | Val  Acc: 0.6543
 Site-Product                       | Val  Loss: 0.8482 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8299
 Best site-Art                       | Epoch:17 | Val Acc: 0.7857
 Best site-Art                       | Epoch:17 | Val Acc: 0.8333
 Best site-Art                       | Epoch:17 | Val Acc: 0.8696
 Best site-Art                       | Epoch:17 | Val Acc: 0.9000
 Best site-Art                       | Epoch:17 | Val Acc: 0.7436
 Best site-Art                       | Epoch:17 | Val Acc: 0.8800
 Best site-Art                       | Epoch:17 | Val Acc: 0.8615
 Best site-Art                       | Epoch:17 | Val Acc: 0.8214
 Best site-Art                       | Epoch:17 | Val Acc: 0.8611
 Best site-Art                       | Epoch:17 | Val Acc: 0.8071
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.8222
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.8657
 Best site-RealWorld                 | Epoch:17 | Val Acc: 0.8416
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.7000
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.6543
 Best site-Product                   | Epoch:17 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 18 ============
 Site-Art                           | Train Loss: 1.1114 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.0254 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 1.1023 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.1020 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 1.0110 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 0.8503 | Train Acc: 0.8267
 Site-Art                           | Train Loss: 0.7448 | Train Acc: 0.8763
 Site-Art                           | Train Loss: 0.7755 | Train Acc: 0.8810
 Site-Art                           | Train Loss: 0.8783 | Train Acc: 0.8589
 Site-Art                           | Train Loss: 0.4749 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.7852 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.6850 | Train Acc: 0.8444
 Site-RealWorld                     | Train Loss: 0.4409 | Train Acc: 0.8676
 Site-RealWorld                     | Train Loss: 0.8618 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.4997 | Train Acc: 0.9145
 Site-Clipart                       | Train Loss: 1.3878 | Train Acc: 0.6885
 Site-Clipart                       | Train Loss: 1.5657 | Train Acc: 0.6393
 Site-Product                       | Train Loss: 0.8808 | Train Acc: 0.8588
Average Train Accuracy: 0.8327
 Site-Art                           | Val  Loss: 1.1986 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.3288 | Val  Acc: 0.7222
 Site-Art                           | Val  Loss: 0.7582 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.5654 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 1.0713 | Val  Acc: 0.8205
 Site-Art                           | Val  Loss: 0.7859 | Val  Acc: 0.8600
 Site-Art                           | Val  Loss: 0.8394 | Val  Acc: 0.8769
 Site-Art                           | Val  Loss: 0.8448 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.7595 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.9136 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 0.3473 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.5295 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.8531 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.4925 | Val  Acc: 0.8060
 Site-RealWorld                     | Val  Loss: 0.6483 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 1.6039 | Val  Acc: 0.6000
 Site-Clipart                       | Val  Loss: 1.5722 | Val  Acc: 0.6543
 Site-Product                       | Val  Loss: 0.7803 | Val  Acc: 0.8929
Average Valid Accuracy: 0.8297
============ Train epoch 19 ============
 Site-Art                           | Train Loss: 1.1591 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.0870 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.0000 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.0549 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.0371 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.8628 | Train Acc: 0.8533
 Site-Art                           | Train Loss: 0.6322 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.7112 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.8182 | Train Acc: 0.8528
 Site-Art                           | Train Loss: 0.4452 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.8012 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 0.5801 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4574 | Train Acc: 0.8382
 Site-RealWorld                     | Train Loss: 0.8900 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.4593 | Train Acc: 0.9079
 Site-Clipart                       | Train Loss: 1.1549 | Train Acc: 0.8197
 Site-Clipart                       | Train Loss: 1.5362 | Train Acc: 0.6311
 Site-Product                       | Train Loss: 0.8243 | Train Acc: 0.9059
Average Train Accuracy: 0.8412
 Site-Art                           | Val  Loss: 0.8971 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1266 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.8672 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.6584 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.9371 | Val  Acc: 0.8718
 Site-Art                           | Val  Loss: 0.7211 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 1.1627 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.7890 | Val  Acc: 0.8810
 Site-Art                           | Val  Loss: 0.7602 | Val  Acc: 0.8426
 Site-Art                           | Val  Loss: 0.8201 | Val  Acc: 0.8143
 Site-RealWorld                     | Val  Loss: 0.2692 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.4636 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.8851 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 0.4402 | Val  Acc: 0.8358
 Site-RealWorld                     | Val  Loss: 0.6392 | Val  Acc: 0.8416
 Site-Clipart                       | Val  Loss: 1.5598 | Val  Acc: 0.6500
 Site-Clipart                       | Val  Loss: 1.5165 | Val  Acc: 0.6420
 Site-Product                       | Val  Loss: 0.7666 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8496
 Best site-Art                       | Epoch:19 | Val Acc: 1.0000
 Best site-Art                       | Epoch:19 | Val Acc: 0.8333
 Best site-Art                       | Epoch:19 | Val Acc: 0.9130
 Best site-Art                       | Epoch:19 | Val Acc: 0.9000
 Best site-Art                       | Epoch:19 | Val Acc: 0.8718
 Best site-Art                       | Epoch:19 | Val Acc: 0.8800
 Best site-Art                       | Epoch:19 | Val Acc: 0.8462
 Best site-Art                       | Epoch:19 | Val Acc: 0.8810
 Best site-Art                       | Epoch:19 | Val Acc: 0.8426
 Best site-Art                       | Epoch:19 | Val Acc: 0.8143
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8358
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8416
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.6500
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.6420
 Best site-Product                   | Epoch:19 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 20 ============
 Site-Art                           | Train Loss: 0.9629 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.9309 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9550 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 1.1228 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 1.0395 | Train Acc: 0.7414
 Site-Art                           | Train Loss: 0.8445 | Train Acc: 0.8533
 Site-Art                           | Train Loss: 0.6539 | Train Acc: 0.8557
 Site-Art                           | Train Loss: 0.6978 | Train Acc: 0.8810
 Site-Art                           | Train Loss: 0.7095 | Train Acc: 0.8712
 Site-Art                           | Train Loss: 0.3850 | Train Acc: 0.9714
 Site-RealWorld                     | Train Loss: 0.7163 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.5324 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.7887 | Train Acc: 0.7941
 Site-RealWorld                     | Train Loss: 0.7254 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.5767 | Train Acc: 0.9342
 Site-Clipart                       | Train Loss: 1.3185 | Train Acc: 0.7377
 Site-Clipart                       | Train Loss: 1.4891 | Train Acc: 0.6721
 Site-Product                       | Train Loss: 0.8581 | Train Acc: 0.8471
Average Train Accuracy: 0.8336
 Site-Art                           | Val  Loss: 0.8311 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 1.2528 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.8133 | Val  Acc: 0.7826
 Site-Art                           | Val  Loss: 0.5365 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.8694 | Val  Acc: 0.8462
 Site-Art                           | Val  Loss: 0.7945 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 1.0082 | Val  Acc: 0.8615
 Site-Art                           | Val  Loss: 0.7003 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.7459 | Val  Acc: 0.8704
 Site-Art                           | Val  Loss: 0.7865 | Val  Acc: 0.8357
 Site-RealWorld                     | Val  Loss: 0.2642 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.4275 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.7384 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 0.5392 | Val  Acc: 0.8358
 Site-RealWorld                     | Val  Loss: 0.5448 | Val  Acc: 0.8713
 Site-Clipart                       | Val  Loss: 1.4182 | Val  Acc: 0.6250
 Site-Clipart                       | Val  Loss: 1.5190 | Val  Acc: 0.7037
 Site-Product                       | Val  Loss: 0.7778 | Val  Acc: 0.9107
Average Valid Accuracy: 0.8526
 Best site-Art                       | Epoch:20 | Val Acc: 0.9286
 Best site-Art                       | Epoch:20 | Val Acc: 0.8333
 Best site-Art                       | Epoch:20 | Val Acc: 0.7826
 Best site-Art                       | Epoch:20 | Val Acc: 0.9333
 Best site-Art                       | Epoch:20 | Val Acc: 0.8462
 Best site-Art                       | Epoch:20 | Val Acc: 0.8800
 Best site-Art                       | Epoch:20 | Val Acc: 0.8615
 Best site-Art                       | Epoch:20 | Val Acc: 0.8571
 Best site-Art                       | Epoch:20 | Val Acc: 0.8704
 Best site-Art                       | Epoch:20 | Val Acc: 0.8357
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.8358
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.8713
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.6250
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.7037
 Best site-Product                   | Epoch:20 | Val Acc: 0.9107
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 21 ============
 Site-Art                           | Train Loss: 1.1352 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.0049 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.1328 | Train Acc: 0.6286
 Site-Art                           | Train Loss: 1.0086 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.9476 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 0.6822 | Train Acc: 0.9067
 Site-Art                           | Train Loss: 0.7258 | Train Acc: 0.8557
 Site-Art                           | Train Loss: 0.6927 | Train Acc: 0.8651
 Site-Art                           | Train Loss: 0.8496 | Train Acc: 0.8466
 Site-Art                           | Train Loss: 0.4117 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.5873 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.5490 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.6164 | Train Acc: 0.8529
 Site-RealWorld                     | Train Loss: 0.7467 | Train Acc: 0.8218
 Site-RealWorld                     | Train Loss: 0.3957 | Train Acc: 0.9276
 Site-Clipart                       | Train Loss: 1.2770 | Train Acc: 0.6885
 Site-Clipart                       | Train Loss: 1.3576 | Train Acc: 0.6967
 Site-Product                       | Train Loss: 0.8542 | Train Acc: 0.8588
Average Train Accuracy: 0.8283
 Site-Art                           | Val  Loss: 1.1067 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.1909 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.7533 | Val  Acc: 0.7826
 Site-Art                           | Val  Loss: 0.5738 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.9583 | Val  Acc: 0.7949
 Site-Art                           | Val  Loss: 0.7749 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 1.3244 | Val  Acc: 0.8769
 Site-Art                           | Val  Loss: 0.7632 | Val  Acc: 0.8452
 Site-Art                           | Val  Loss: 0.7408 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.7364 | Val  Acc: 0.8714
 Site-RealWorld                     | Val  Loss: 0.2341 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3352 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.6870 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.4228 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.5949 | Val  Acc: 0.8812
 Site-Clipart                       | Val  Loss: 1.5595 | Val  Acc: 0.6750
 Site-Clipart                       | Val  Loss: 1.3583 | Val  Acc: 0.6543
 Site-Product                       | Val  Loss: 0.7949 | Val  Acc: 0.8214
Average Valid Accuracy: 0.8446
============ Train epoch 22 ============
 Site-Art                           | Train Loss: 0.9330 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.0000 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 0.9903 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 1.1383 | Train Acc: 0.7556
 Site-Art                           | Train Loss: 0.9115 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.8313 | Train Acc: 0.8133
 Site-Art                           | Train Loss: 0.7776 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 0.6617 | Train Acc: 0.8651
 Site-Art                           | Train Loss: 0.6977 | Train Acc: 0.8896
 Site-Art                           | Train Loss: 0.3656 | Train Acc: 0.9571
 Site-RealWorld                     | Train Loss: 0.7308 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.5102 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4316 | Train Acc: 0.8382
 Site-RealWorld                     | Train Loss: 0.7878 | Train Acc: 0.8317
 Site-RealWorld                     | Train Loss: 0.4155 | Train Acc: 0.9342
 Site-Clipart                       | Train Loss: 1.0947 | Train Acc: 0.7705
 Site-Clipart                       | Train Loss: 1.4270 | Train Acc: 0.6721
 Site-Product                       | Train Loss: 0.8675 | Train Acc: 0.8824
Average Train Accuracy: 0.8357
 Site-Art                           | Val  Loss: 0.8983 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 1.0406 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.5685 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.5290 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.8208 | Val  Acc: 0.8205
 Site-Art                           | Val  Loss: 0.6447 | Val  Acc: 0.8400
 Site-Art                           | Val  Loss: 1.0931 | Val  Acc: 0.8923
 Site-Art                           | Val  Loss: 0.6801 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.7260 | Val  Acc: 0.8426
 Site-Art                           | Val  Loss: 0.8925 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 0.1840 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.3442 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.6227 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.4519 | Val  Acc: 0.8060
 Site-RealWorld                     | Val  Loss: 0.5946 | Val  Acc: 0.8812
 Site-Clipart                       | Val  Loss: 1.3731 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.4693 | Val  Acc: 0.7037
 Site-Product                       | Val  Loss: 0.7086 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8638
 Best site-Art                       | Epoch:22 | Val Acc: 0.9286
 Best site-Art                       | Epoch:22 | Val Acc: 0.8333
 Best site-Art                       | Epoch:22 | Val Acc: 0.9130
 Best site-Art                       | Epoch:22 | Val Acc: 0.9667
 Best site-Art                       | Epoch:22 | Val Acc: 0.8205
 Best site-Art                       | Epoch:22 | Val Acc: 0.8400
 Best site-Art                       | Epoch:22 | Val Acc: 0.8923
 Best site-Art                       | Epoch:22 | Val Acc: 0.8571
 Best site-Art                       | Epoch:22 | Val Acc: 0.8426
 Best site-Art                       | Epoch:22 | Val Acc: 0.8214
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.8060
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.8812
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.7037
 Best site-Product                   | Epoch:22 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 23 ============
 Site-Art                           | Train Loss: 0.8273 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.9736 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.0623 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.8950 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.9104 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.8279 | Train Acc: 0.8533
 Site-Art                           | Train Loss: 0.7117 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.6055 | Train Acc: 0.9127
 Site-Art                           | Train Loss: 0.6375 | Train Acc: 0.8834
 Site-Art                           | Train Loss: 0.3052 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.7458 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.5568 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.6150 | Train Acc: 0.8676
 Site-RealWorld                     | Train Loss: 0.6719 | Train Acc: 0.8911
 Site-RealWorld                     | Train Loss: 0.4101 | Train Acc: 0.9474
 Site-Clipart                       | Train Loss: 1.1401 | Train Acc: 0.7541
 Site-Clipart                       | Train Loss: 1.3465 | Train Acc: 0.6721
 Site-Product                       | Train Loss: 0.8624 | Train Acc: 0.8588
Average Train Accuracy: 0.8502
 Site-Art                           | Val  Loss: 1.0893 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.0280 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 0.8183 | Val  Acc: 0.8261
 Site-Art                           | Val  Loss: 0.5568 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.7886 | Val  Acc: 0.8974
 Site-Art                           | Val  Loss: 0.6187 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 0.9035 | Val  Acc: 0.8615
 Site-Art                           | Val  Loss: 0.6387 | Val  Acc: 0.8929
 Site-Art                           | Val  Loss: 0.6605 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.8577 | Val  Acc: 0.8286
 Site-RealWorld                     | Val  Loss: 0.1672 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4106 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.6541 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 0.5725 | Val  Acc: 0.8806
 Site-RealWorld                     | Val  Loss: 0.5271 | Val  Acc: 0.8515
 Site-Clipart                       | Val  Loss: 1.4713 | Val  Acc: 0.6250
 Site-Clipart                       | Val  Loss: 1.4724 | Val  Acc: 0.6914
 Site-Product                       | Val  Loss: 0.7203 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8486
============ Train epoch 24 ============
 Site-Art                           | Train Loss: 1.0845 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 0.8532 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9981 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 1.1156 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 1.0119 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.5960 | Train Acc: 0.9067
 Site-Art                           | Train Loss: 0.6132 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 0.6214 | Train Acc: 0.8730
 Site-Art                           | Train Loss: 0.6785 | Train Acc: 0.9080
 Site-Art                           | Train Loss: 0.3068 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.5266 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5878 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.7714 | Train Acc: 0.8529
 Site-RealWorld                     | Train Loss: 0.6934 | Train Acc: 0.8416
 Site-RealWorld                     | Train Loss: 0.4550 | Train Acc: 0.9408
 Site-Clipart                       | Train Loss: 1.1231 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.2995 | Train Acc: 0.7049
 Site-Product                       | Train Loss: 0.6704 | Train Acc: 0.8706
Average Train Accuracy: 0.8456
 Site-Art                           | Val  Loss: 0.8481 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.0337 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6381 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.4638 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.8469 | Val  Acc: 0.8205
 Site-Art                           | Val  Loss: 0.5812 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.7448 | Val  Acc: 0.8615
 Site-Art                           | Val  Loss: 0.5883 | Val  Acc: 0.8929
 Site-Art                           | Val  Loss: 0.6906 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.7296 | Val  Acc: 0.8286
 Site-RealWorld                     | Val  Loss: 0.1839 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3968 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.6321 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 0.3959 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.5621 | Val  Acc: 0.9010
 Site-Clipart                       | Val  Loss: 1.3380 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.4419 | Val  Acc: 0.7037
 Site-Product                       | Val  Loss: 0.7297 | Val  Acc: 0.8393
Average Valid Accuracy: 0.8648
 Best site-Art                       | Epoch:24 | Val Acc: 0.8571
 Best site-Art                       | Epoch:24 | Val Acc: 0.8889
 Best site-Art                       | Epoch:24 | Val Acc: 0.8696
 Best site-Art                       | Epoch:24 | Val Acc: 0.9333
 Best site-Art                       | Epoch:24 | Val Acc: 0.8205
 Best site-Art                       | Epoch:24 | Val Acc: 0.9000
 Best site-Art                       | Epoch:24 | Val Acc: 0.8615
 Best site-Art                       | Epoch:24 | Val Acc: 0.8929
 Best site-Art                       | Epoch:24 | Val Acc: 0.8611
 Best site-Art                       | Epoch:24 | Val Acc: 0.8286
 Best site-RealWorld                 | Epoch:24 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.8507
 Best site-RealWorld                 | Epoch:24 | Val Acc: 0.9010
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.7250
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.7037
 Best site-Product                   | Epoch:24 | Val Acc: 0.8393
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 25 ============
 Site-Art                           | Train Loss: 1.0289 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 0.8409 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.1454 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 0.9435 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.8809 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.5513 | Train Acc: 0.9200
 Site-Art                           | Train Loss: 0.6265 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 0.5795 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.6574 | Train Acc: 0.8957
 Site-Art                           | Train Loss: 0.3176 | Train Acc: 0.9619
 Site-RealWorld                     | Train Loss: 0.4950 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5565 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.3597 | Train Acc: 0.8529
 Site-RealWorld                     | Train Loss: 0.6803 | Train Acc: 0.8812
 Site-RealWorld                     | Train Loss: 0.4390 | Train Acc: 0.9211
 Site-Clipart                       | Train Loss: 1.0494 | Train Acc: 0.7541
 Site-Clipart                       | Train Loss: 1.3293 | Train Acc: 0.7213
 Site-Product                       | Train Loss: 0.7941 | Train Acc: 0.9059
Average Train Accuracy: 0.8552
 Site-Art                           | Val  Loss: 0.4842 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9921 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6409 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.4745 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.7069 | Val  Acc: 0.8974
 Site-Art                           | Val  Loss: 0.5846 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 0.4983 | Val  Acc: 0.9077
 Site-Art                           | Val  Loss: 0.7495 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.6732 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.7929 | Val  Acc: 0.8643
 Site-RealWorld                     | Val  Loss: 0.2369 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.3682 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.6918 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 0.4014 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.4361 | Val  Acc: 0.9208
 Site-Clipart                       | Val  Loss: 1.2603 | Val  Acc: 0.7000
 Site-Clipart                       | Val  Loss: 1.3094 | Val  Acc: 0.7284
 Site-Product                       | Val  Loss: 0.6859 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8756
 Best site-Art                       | Epoch:25 | Val Acc: 1.0000
 Best site-Art                       | Epoch:25 | Val Acc: 0.8889
 Best site-Art                       | Epoch:25 | Val Acc: 0.9130
 Best site-Art                       | Epoch:25 | Val Acc: 0.9000
 Best site-Art                       | Epoch:25 | Val Acc: 0.8974
 Best site-Art                       | Epoch:25 | Val Acc: 0.8800
 Best site-Art                       | Epoch:25 | Val Acc: 0.9077
 Best site-Art                       | Epoch:25 | Val Acc: 0.8571
 Best site-Art                       | Epoch:25 | Val Acc: 0.8611
 Best site-Art                       | Epoch:25 | Val Acc: 0.8643
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.8667
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.8507
 Best site-RealWorld                 | Epoch:25 | Val Acc: 0.9208
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.7000
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.7284
 Best site-Product                   | Epoch:25 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 26 ============
 Site-Art                           | Train Loss: 0.8868 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.8246 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.9523 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.9790 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.9348 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.7899 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.5158 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 0.5585 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.6669 | Train Acc: 0.9080
 Site-Art                           | Train Loss: 0.3197 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.4733 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5335 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4140 | Train Acc: 0.8235
 Site-RealWorld                     | Train Loss: 0.6048 | Train Acc: 0.8614
 Site-RealWorld                     | Train Loss: 0.3971 | Train Acc: 0.9539
 Site-Clipart                       | Train Loss: 1.0456 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.2872 | Train Acc: 0.7295
 Site-Product                       | Train Loss: 0.6224 | Train Acc: 0.9176
Average Train Accuracy: 0.8605
 Site-Art                           | Val  Loss: 0.6844 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 1.0412 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 1.0509 | Val  Acc: 0.7826
 Site-Art                           | Val  Loss: 0.4938 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.6976 | Val  Acc: 0.8974
 Site-Art                           | Val  Loss: 0.5510 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 1.1561 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.6728 | Val  Acc: 0.8690
 Site-Art                           | Val  Loss: 0.6456 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.7827 | Val  Acc: 0.8429
 Site-RealWorld                     | Val  Loss: 0.1403 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3375 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.6624 | Val  Acc: 0.8667
 Site-RealWorld                     | Val  Loss: 0.3604 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.5882 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 1.2589 | Val  Acc: 0.7750
 Site-Clipart                       | Val  Loss: 1.4611 | Val  Acc: 0.6914
 Site-Product                       | Val  Loss: 0.6554 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8680
============ Train epoch 27 ============
 Site-Art                           | Train Loss: 0.8553 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.9015 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 1.0093 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.8732 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.8776 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.7534 | Train Acc: 0.8533
 Site-Art                           | Train Loss: 0.6650 | Train Acc: 0.8557
 Site-Art                           | Train Loss: 0.5651 | Train Acc: 0.9127
 Site-Art                           | Train Loss: 0.5489 | Train Acc: 0.9141
 Site-Art                           | Train Loss: 0.2485 | Train Acc: 0.9810
 Site-RealWorld                     | Train Loss: 0.4689 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.3977 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4053 | Train Acc: 0.8529
 Site-RealWorld                     | Train Loss: 0.5930 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.3247 | Train Acc: 0.9539
 Site-Clipart                       | Train Loss: 1.3081 | Train Acc: 0.6885
 Site-Clipart                       | Train Loss: 1.2578 | Train Acc: 0.7131
 Site-Product                       | Train Loss: 0.7110 | Train Acc: 0.8824
Average Train Accuracy: 0.8563
 Site-Art                           | Val  Loss: 0.7250 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.9406 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6906 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.4944 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.6753 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.5670 | Val  Acc: 0.9200
 Site-Art                           | Val  Loss: 0.3716 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5974 | Val  Acc: 0.8690
 Site-Art                           | Val  Loss: 0.6806 | Val  Acc: 0.8981
 Site-Art                           | Val  Loss: 0.8473 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 0.1641 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3001 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4982 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.3569 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.5117 | Val  Acc: 0.8614
 Site-Clipart                       | Val  Loss: 1.3710 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.2008 | Val  Acc: 0.7284
 Site-Product                       | Val  Loss: 0.6151 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8894
 Best site-Art                       | Epoch:27 | Val Acc: 0.9286
 Best site-Art                       | Epoch:27 | Val Acc: 0.8889
 Best site-Art                       | Epoch:27 | Val Acc: 0.8696
 Best site-Art                       | Epoch:27 | Val Acc: 0.9667
 Best site-Art                       | Epoch:27 | Val Acc: 0.9231
 Best site-Art                       | Epoch:27 | Val Acc: 0.9200
 Best site-Art                       | Epoch:27 | Val Acc: 0.9385
 Best site-Art                       | Epoch:27 | Val Acc: 0.8690
 Best site-Art                       | Epoch:27 | Val Acc: 0.8981
 Best site-Art                       | Epoch:27 | Val Acc: 0.8214
 Best site-RealWorld                 | Epoch:27 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.9556
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.8657
 Best site-RealWorld                 | Epoch:27 | Val Acc: 0.8614
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.7284
 Best site-Product                   | Epoch:27 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 28 ============
 Site-Art                           | Train Loss: 0.7288 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.8495 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.8847 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.9189 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.9296 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.7062 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.4844 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.5106 | Train Acc: 0.9127
 Site-Art                           | Train Loss: 0.5300 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.2680 | Train Acc: 0.9810
 Site-RealWorld                     | Train Loss: 0.5300 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5034 | Train Acc: 0.9556
 Site-RealWorld                     | Train Loss: 0.4761 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.6054 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.2743 | Train Acc: 0.9539
 Site-Clipart                       | Train Loss: 1.0731 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.2558 | Train Acc: 0.7131
 Site-Product                       | Train Loss: 0.7760 | Train Acc: 0.8824
Average Train Accuracy: 0.8721
 Site-Art                           | Val  Loss: 0.6683 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.9414 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.3888 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.4306 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.6731 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.5743 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.9799 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5425 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.6313 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.7041 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 0.1397 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3301 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.5551 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.3354 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.4822 | Val  Acc: 0.8812
 Site-Clipart                       | Val  Loss: 1.3914 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.4071 | Val  Acc: 0.6914
 Site-Product                       | Val  Loss: 0.6854 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8948
 Best site-Art                       | Epoch:28 | Val Acc: 0.9286
 Best site-Art                       | Epoch:28 | Val Acc: 0.8889
 Best site-Art                       | Epoch:28 | Val Acc: 0.9565
 Best site-Art                       | Epoch:28 | Val Acc: 0.9667
 Best site-Art                       | Epoch:28 | Val Acc: 0.9231
 Best site-Art                       | Epoch:28 | Val Acc: 0.9000
 Best site-Art                       | Epoch:28 | Val Acc: 0.9385
 Best site-Art                       | Epoch:28 | Val Acc: 0.9405
 Best site-Art                       | Epoch:28 | Val Acc: 0.8796
 Best site-Art                       | Epoch:28 | Val Acc: 0.8214
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.8657
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.8812
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.6914
 Best site-Product                   | Epoch:28 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 29 ============
 Site-Art                           | Train Loss: 0.8450 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.9384 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9700 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.8780 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.9531 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.6796 | Train Acc: 0.8133
 Site-Art                           | Train Loss: 0.5583 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.5130 | Train Acc: 0.9206
 Site-Art                           | Train Loss: 0.5317 | Train Acc: 0.9141
 Site-Art                           | Train Loss: 0.2534 | Train Acc: 0.9714
 Site-RealWorld                     | Train Loss: 0.5092 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4636 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5833 | Train Acc: 0.8676
 Site-RealWorld                     | Train Loss: 0.5832 | Train Acc: 0.8812
 Site-RealWorld                     | Train Loss: 0.3640 | Train Acc: 0.9605
 Site-Clipart                       | Train Loss: 1.1182 | Train Acc: 0.7377
 Site-Clipart                       | Train Loss: 1.2322 | Train Acc: 0.7459
 Site-Product                       | Train Loss: 0.6631 | Train Acc: 0.8824
Average Train Accuracy: 0.8575
 Site-Art                           | Val  Loss: 0.4890 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.9558 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.5794 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.4134 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.5339 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4764 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 0.6768 | Val  Acc: 0.8923
 Site-Art                           | Val  Loss: 0.6354 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.6277 | Val  Acc: 0.8981
 Site-Art                           | Val  Loss: 0.7306 | Val  Acc: 0.8429
 Site-RealWorld                     | Val  Loss: 0.1055 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2726 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.6119 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.5156 | Val  Acc: 0.8806
 Site-RealWorld                     | Val  Loss: 0.4333 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.1791 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.2578 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.6165 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9049
 Best site-Art                       | Epoch:29 | Val Acc: 1.0000
 Best site-Art                       | Epoch:29 | Val Acc: 0.8889
 Best site-Art                       | Epoch:29 | Val Acc: 0.9130
 Best site-Art                       | Epoch:29 | Val Acc: 0.9333
 Best site-Art                       | Epoch:29 | Val Acc: 0.9231
 Best site-Art                       | Epoch:29 | Val Acc: 0.9600
 Best site-Art                       | Epoch:29 | Val Acc: 0.8923
 Best site-Art                       | Epoch:29 | Val Acc: 0.9048
 Best site-Art                       | Epoch:29 | Val Acc: 0.8981
 Best site-Art                       | Epoch:29 | Val Acc: 0.8429
 Best site-RealWorld                 | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:29 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:29 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:29 | Val Acc: 0.8806
 Best site-RealWorld                 | Epoch:29 | Val Acc: 0.9109
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:29 | Val Acc: 0.7654
 Best site-Product                   | Epoch:29 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 30 ============
 Site-Art                           | Train Loss: 0.7923 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.9278 | Train Acc: 0.7407
 Site-Art                           | Train Loss: 0.8386 | Train Acc: 0.8286
 Site-Art                           | Train Loss: 0.9341 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.8942 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.8633 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4573 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.4824 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.5609 | Train Acc: 0.9202
 Site-Art                           | Train Loss: 0.2804 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.5926 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.5324 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5527 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.5420 | Train Acc: 0.8812
 Site-RealWorld                     | Train Loss: 0.3206 | Train Acc: 0.9474
 Site-Clipart                       | Train Loss: 1.1357 | Train Acc: 0.6885
 Site-Clipart                       | Train Loss: 1.1839 | Train Acc: 0.7295
 Site-Product                       | Train Loss: 0.5377 | Train Acc: 0.8941
Average Train Accuracy: 0.8556
 Site-Art                           | Val  Loss: 0.6753 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.8316 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6725 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.4818 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.5785 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4954 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.7478 | Val  Acc: 0.9077
 Site-Art                           | Val  Loss: 0.5329 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.5384 | Val  Acc: 0.8981
 Site-Art                           | Val  Loss: 0.5906 | Val  Acc: 0.8714
 Site-RealWorld                     | Val  Loss: 0.1536 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2759 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.5198 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 0.3336 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.5096 | Val  Acc: 0.8812
 Site-Clipart                       | Val  Loss: 1.2268 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.2217 | Val  Acc: 0.7160
 Site-Product                       | Val  Loss: 0.5592 | Val  Acc: 0.9107
Average Valid Accuracy: 0.8920
============ Train epoch 31 ============
 Site-Art                           | Train Loss: 0.7542 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.9717 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.9553 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.8207 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.8878 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.8649 | Train Acc: 0.8400
 Site-Art                           | Train Loss: 0.5193 | Train Acc: 0.8763
 Site-Art                           | Train Loss: 0.4882 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.4719 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.2095 | Train Acc: 0.9810
 Site-RealWorld                     | Train Loss: 0.4960 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.3841 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.3489 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 0.5127 | Train Acc: 0.8911
 Site-RealWorld                     | Train Loss: 0.2880 | Train Acc: 0.9605
 Site-Clipart                       | Train Loss: 1.0409 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.2078 | Train Acc: 0.7377
 Site-Product                       | Train Loss: 0.6052 | Train Acc: 0.8706
Average Train Accuracy: 0.8656
 Site-Art                           | Val  Loss: 0.6521 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8905 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.4583 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.3689 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.5565 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4825 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.8536 | Val  Acc: 0.9692
 Site-Art                           | Val  Loss: 0.5464 | Val  Acc: 0.9524
 Site-Art                           | Val  Loss: 0.5784 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.6457 | Val  Acc: 0.8500
 Site-RealWorld                     | Val  Loss: 0.1426 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.2432 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4114 | Val  Acc: 0.9778
 Site-RealWorld                     | Val  Loss: 0.4865 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.4574 | Val  Acc: 0.8713
 Site-Clipart                       | Val  Loss: 1.1595 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.2568 | Val  Acc: 0.7160
 Site-Product                       | Val  Loss: 0.6294 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9000
============ Train epoch 32 ============
 Site-Art                           | Train Loss: 0.9405 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 0.7901 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9922 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.8180 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.8906 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 0.6595 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4925 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.4348 | Train Acc: 0.9603
 Site-Art                           | Train Loss: 0.4305 | Train Acc: 0.9325
 Site-Art                           | Train Loss: 0.2324 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.5376 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.4321 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4820 | Train Acc: 0.9265
 Site-RealWorld                     | Train Loss: 0.5838 | Train Acc: 0.8614
 Site-RealWorld                     | Train Loss: 0.3013 | Train Acc: 0.9539
 Site-Clipart                       | Train Loss: 0.9950 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.2165 | Train Acc: 0.7131
 Site-Product                       | Train Loss: 0.4339 | Train Acc: 0.9059
Average Train Accuracy: 0.8708
 Site-Art                           | Val  Loss: 0.5606 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.8238 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.6483 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.3332 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5126 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4234 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.2723 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5291 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.5946 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.6453 | Val  Acc: 0.8500
 Site-RealWorld                     | Val  Loss: 0.1427 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2590 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4690 | Val  Acc: 0.9111
 Site-RealWorld                     | Val  Loss: 0.5337 | Val  Acc: 0.9104
 Site-RealWorld                     | Val  Loss: 0.4733 | Val  Acc: 0.9010
 Site-Clipart                       | Val  Loss: 1.2125 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.3606 | Val  Acc: 0.7160
 Site-Product                       | Val  Loss: 0.6410 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9001
============ Train epoch 33 ============
 Site-Art                           | Train Loss: 0.8157 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.8272 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9945 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.7958 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.8152 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.5806 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.4984 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.4786 | Train Acc: 0.9286
 Site-Art                           | Train Loss: 0.4850 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.1951 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.4943 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.4236 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4854 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 0.5392 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.2787 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 0.9964 | Train Acc: 0.7705
 Site-Clipart                       | Train Loss: 1.1432 | Train Acc: 0.7623
 Site-Product                       | Train Loss: 0.6747 | Train Acc: 0.9059
Average Train Accuracy: 0.8660
 Site-Art                           | Val  Loss: 0.5043 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6312 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.3618 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.5478 | Val  Acc: 0.9000
 Site-Art                           | Val  Loss: 0.5473 | Val  Acc: 0.8974
 Site-Art                           | Val  Loss: 0.3927 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.7461 | Val  Acc: 0.9846
 Site-Art                           | Val  Loss: 0.4631 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5211 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.5849 | Val  Acc: 0.8786
 Site-RealWorld                     | Val  Loss: 0.1482 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.2343 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5409 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.3761 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.4116 | Val  Acc: 0.9208
 Site-Clipart                       | Val  Loss: 1.2390 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.1753 | Val  Acc: 0.7531
 Site-Product                       | Val  Loss: 0.5790 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9106
 Best site-Art                       | Epoch:33 | Val Acc: 1.0000
 Best site-Art                       | Epoch:33 | Val Acc: 0.9444
 Best site-Art                       | Epoch:33 | Val Acc: 0.9565
 Best site-Art                       | Epoch:33 | Val Acc: 0.9000
 Best site-Art                       | Epoch:33 | Val Acc: 0.8974
 Best site-Art                       | Epoch:33 | Val Acc: 0.9400
 Best site-Art                       | Epoch:33 | Val Acc: 0.9846
 Best site-Art                       | Epoch:33 | Val Acc: 0.9286
 Best site-Art                       | Epoch:33 | Val Acc: 0.8796
 Best site-Art                       | Epoch:33 | Val Acc: 0.8786
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:33 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.9556
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.8657
 Best site-RealWorld                 | Epoch:33 | Val Acc: 0.9208
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.7250
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.7531
 Best site-Product                   | Epoch:33 | Val Acc: 0.9107
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 34 ============
 Site-Art                           | Train Loss: 0.7406 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.7680 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 0.8997 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.7825 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.9511 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.8566 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4126 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.4881 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 0.4782 | Train Acc: 0.9325
 Site-Art                           | Train Loss: 0.2478 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.3320 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5171 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5823 | Train Acc: 0.9118
 Site-RealWorld                     | Train Loss: 0.4866 | Train Acc: 0.9109
 Site-RealWorld                     | Train Loss: 0.2905 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 1.1052 | Train Acc: 0.7377
 Site-Clipart                       | Train Loss: 1.1119 | Train Acc: 0.7459
 Site-Product                       | Train Loss: 0.6461 | Train Acc: 0.8941
Average Train Accuracy: 0.8774
 Site-Art                           | Val  Loss: 0.6642 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6744 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4388 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3502 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4844 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.3879 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.3523 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.5295 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5773 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.6815 | Val  Acc: 0.8357
 Site-RealWorld                     | Val  Loss: 0.1711 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2014 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4624 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3400 | Val  Acc: 0.8358
 Site-RealWorld                     | Val  Loss: 0.4475 | Val  Acc: 0.8911
 Site-Clipart                       | Val  Loss: 1.2520 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.2500 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.5788 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9137
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 0.9444
 Best site-Art                       | Epoch:34 | Val Acc: 0.9565
 Best site-Art                       | Epoch:34 | Val Acc: 1.0000
 Best site-Art                       | Epoch:34 | Val Acc: 0.9487
 Best site-Art                       | Epoch:34 | Val Acc: 0.9400
 Best site-Art                       | Epoch:34 | Val Acc: 0.9231
 Best site-Art                       | Epoch:34 | Val Acc: 0.9167
 Best site-Art                       | Epoch:34 | Val Acc: 0.8796
 Best site-Art                       | Epoch:34 | Val Acc: 0.8357
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:34 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:34 | Val Acc: 0.8358
 Best site-RealWorld                 | Epoch:34 | Val Acc: 0.8911
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:34 | Val Acc: 0.7654
 Best site-Product                   | Epoch:34 | Val Acc: 0.8929
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 35 ============
 Site-Art                           | Train Loss: 0.6770 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.8338 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.9377 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.7903 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.8470 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 0.8497 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.5039 | Train Acc: 0.8763
 Site-Art                           | Train Loss: 0.4566 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.4455 | Train Acc: 0.9202
 Site-Art                           | Train Loss: 0.2014 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.4367 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4463 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5186 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.5502 | Train Acc: 0.8812
 Site-RealWorld                     | Train Loss: 0.2261 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 1.0696 | Train Acc: 0.7705
 Site-Clipart                       | Train Loss: 1.1258 | Train Acc: 0.7377
 Site-Product                       | Train Loss: 0.5094 | Train Acc: 0.9294
Average Train Accuracy: 0.8691
 Site-Art                           | Val  Loss: 0.5597 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.7705 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4552 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.3738 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.4738 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.3909 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.7092 | Val  Acc: 0.9692
 Site-Art                           | Val  Loss: 0.5221 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5575 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.5853 | Val  Acc: 0.8643
 Site-RealWorld                     | Val  Loss: 0.1472 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1751 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.5582 | Val  Acc: 0.9111
 Site-RealWorld                     | Val  Loss: 0.3274 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.3511 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.1870 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.1911 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.5390 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9057
============ Train epoch 36 ============
 Site-Art                           | Train Loss: 0.6597 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.7870 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 1.0110 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.7887 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.9010 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.4147 | Train Acc: 0.9067
 Site-Art                           | Train Loss: 0.4794 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 0.4715 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.4566 | Train Acc: 0.9448
 Site-Art                           | Train Loss: 0.1669 | Train Acc: 0.9952
 Site-RealWorld                     | Train Loss: 0.5535 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4506 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.6925 | Train Acc: 0.8676
 Site-RealWorld                     | Train Loss: 0.5460 | Train Acc: 0.8812
 Site-RealWorld                     | Train Loss: 0.2109 | Train Acc: 0.9539
 Site-Clipart                       | Train Loss: 1.0770 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.0803 | Train Acc: 0.7623
 Site-Product                       | Train Loss: 0.5017 | Train Acc: 0.9059
Average Train Accuracy: 0.8717
 Site-Art                           | Val  Loss: 0.5964 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 0.8048 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.5113 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3102 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.4648 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.3885 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.3198 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5187 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5181 | Val  Acc: 0.8981
 Site-Art                           | Val  Loss: 0.6240 | Val  Acc: 0.8786
 Site-RealWorld                     | Val  Loss: 0.1064 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3534 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4705 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.2900 | Val  Acc: 0.8955
 Site-RealWorld                     | Val  Loss: 0.3840 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.0910 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.1967 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.5328 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9122
============ Train epoch 37 ============
 Site-Art                           | Train Loss: 0.6113 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.9509 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.8476 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.7848 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.9165 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.4742 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.4796 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.3847 | Train Acc: 0.9603
 Site-Art                           | Train Loss: 0.4733 | Train Acc: 0.9202
 Site-Art                           | Train Loss: 0.1993 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.5699 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.4820 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.3973 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 0.5073 | Train Acc: 0.9109
 Site-RealWorld                     | Train Loss: 0.2296 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 1.0335 | Train Acc: 0.7541
 Site-Clipart                       | Train Loss: 1.0558 | Train Acc: 0.7705
 Site-Product                       | Train Loss: 0.5415 | Train Acc: 0.8941
Average Train Accuracy: 0.8745
 Site-Art                           | Val  Loss: 0.4474 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.6226 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.5266 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.2673 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4541 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.3418 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 0.2375 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5200 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5425 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 0.6431 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 0.1437 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.1958 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4105 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.2877 | Val  Acc: 0.8806
 Site-RealWorld                     | Val  Loss: 0.4217 | Val  Acc: 0.8911
 Site-Clipart                       | Val  Loss: 1.1892 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.1425 | Val  Acc: 0.7778
 Site-Product                       | Val  Loss: 0.5569 | Val  Acc: 0.8750
Average Valid Accuracy: 0.8987
============ Train epoch 38 ============
 Site-Art                           | Train Loss: 0.6809 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.8105 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.7853 | Train Acc: 0.8286
 Site-Art                           | Train Loss: 0.7358 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.9318 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.6220 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.4625 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.4140 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.4684 | Train Acc: 0.9141
 Site-Art                           | Train Loss: 0.1550 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.3286 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4456 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.9939 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.4421 | Train Acc: 0.9109
 Site-RealWorld                     | Train Loss: 0.2081 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 1.0748 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.0580 | Train Acc: 0.7787
 Site-Product                       | Train Loss: 0.4629 | Train Acc: 0.9412
Average Train Accuracy: 0.8866
 Site-Art                           | Val  Loss: 0.4807 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.6330 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6643 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.3213 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.4243 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.3226 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.3917 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.4725 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5691 | Val  Acc: 0.8519
 Site-Art                           | Val  Loss: 0.5921 | Val  Acc: 0.8571
 Site-RealWorld                     | Val  Loss: 0.1157 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2033 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4386 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.2689 | Val  Acc: 0.9104
 Site-RealWorld                     | Val  Loss: 0.3930 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.1824 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.1711 | Val  Acc: 0.7284
 Site-Product                       | Val  Loss: 0.5496 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8986
============ Train epoch 39 ============
 Site-Art                           | Train Loss: 0.6894 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.7242 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9579 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 0.9116 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.8439 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.6706 | Train Acc: 0.8267
 Site-Art                           | Train Loss: 0.4778 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.3488 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.3998 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.1680 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.4095 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.3916 | Train Acc: 0.9556
 Site-RealWorld                     | Train Loss: 0.4213 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 0.4453 | Train Acc: 0.9010
 Site-RealWorld                     | Train Loss: 0.1721 | Train Acc: 0.9803
 Site-Clipart                       | Train Loss: 0.9499 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 0.9769 | Train Acc: 0.7869
 Site-Product                       | Train Loss: 0.6513 | Train Acc: 0.9059
Average Train Accuracy: 0.8738
 Site-Art                           | Val  Loss: 0.4627 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5906 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4832 | Val  Acc: 0.8261
 Site-Art                           | Val  Loss: 0.2710 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3691 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.3034 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 0.6135 | Val  Acc: 0.9692
 Site-Art                           | Val  Loss: 0.4757 | Val  Acc: 0.9048
 Site-Art                           | Val  Loss: 0.4796 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.5044 | Val  Acc: 0.8429
 Site-RealWorld                     | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1954 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4216 | Val  Acc: 0.9778
 Site-RealWorld                     | Val  Loss: 0.2726 | Val  Acc: 0.8955
 Site-RealWorld                     | Val  Loss: 0.3537 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.2463 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.1635 | Val  Acc: 0.7531
 Site-Product                       | Val  Loss: 0.5349 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9128
============ Train epoch 40 ============
 Site-Art                           | Train Loss: 0.7929 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.8265 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.9449 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.7014 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.7400 | Train Acc: 0.8448
 Site-Art                           | Train Loss: 0.8477 | Train Acc: 0.8800
 Site-Art                           | Train Loss: 0.3690 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.3959 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 0.4111 | Train Acc: 0.9387
 Site-Art                           | Train Loss: 0.1536 | Train Acc: 0.9952
 Site-RealWorld                     | Train Loss: 0.5904 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.3714 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5210 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 0.5806 | Train Acc: 0.8614
 Site-RealWorld                     | Train Loss: 0.2244 | Train Acc: 0.9737
 Site-Clipart                       | Train Loss: 1.0444 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.1222 | Train Acc: 0.7459
 Site-Product                       | Train Loss: 0.4655 | Train Acc: 0.9647
Average Train Accuracy: 0.8814
 Site-Art                           | Val  Loss: 0.4698 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.7107 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4691 | Val  Acc: 0.9130
 Site-Art                           | Val  Loss: 0.2798 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.3479 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.4345 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.9386 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.4003 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5210 | Val  Acc: 0.8981
 Site-Art                           | Val  Loss: 0.4508 | Val  Acc: 0.8857
 Site-RealWorld                     | Val  Loss: 0.1291 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1840 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.3764 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.2800 | Val  Acc: 0.8806
 Site-RealWorld                     | Val  Loss: 0.3600 | Val  Acc: 0.9010
 Site-Clipart                       | Val  Loss: 1.0507 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.2646 | Val  Acc: 0.7778
 Site-Product                       | Val  Loss: 0.6061 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9171
 Best site-Art                       | Epoch:40 | Val Acc: 0.9286
 Best site-Art                       | Epoch:40 | Val Acc: 0.9444
 Best site-Art                       | Epoch:40 | Val Acc: 0.9130
 Best site-Art                       | Epoch:40 | Val Acc: 1.0000
 Best site-Art                       | Epoch:40 | Val Acc: 0.9744
 Best site-Art                       | Epoch:40 | Val Acc: 0.9400
 Best site-Art                       | Epoch:40 | Val Acc: 0.9385
 Best site-Art                       | Epoch:40 | Val Acc: 0.9286
 Best site-Art                       | Epoch:40 | Val Acc: 0.8981
 Best site-Art                       | Epoch:40 | Val Acc: 0.8857
 Best site-RealWorld                 | Epoch:40 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:40 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:40 | Val Acc: 0.9556
 Best site-RealWorld                 | Epoch:40 | Val Acc: 0.8806
 Best site-RealWorld                 | Epoch:40 | Val Acc: 0.9010
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.8000
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.7778
 Best site-Product                   | Epoch:40 | Val Acc: 0.8750
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 41 ============
 Site-Art                           | Train Loss: 0.7172 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.7989 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.9732 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.8389 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.8525 | Train Acc: 0.7586
 Site-Art                           | Train Loss: 0.3757 | Train Acc: 0.9067
 Site-Art                           | Train Loss: 0.4830 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.4026 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.4649 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.1419 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.6486 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.3971 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5445 | Train Acc: 0.9559
 Site-RealWorld                     | Train Loss: 0.4189 | Train Acc: 0.9208
 Site-RealWorld                     | Train Loss: 0.1955 | Train Acc: 0.9737
 Site-Clipart                       | Train Loss: 0.9039 | Train Acc: 0.8361
 Site-Clipart                       | Train Loss: 1.0598 | Train Acc: 0.7459
 Site-Product                       | Train Loss: 0.5948 | Train Acc: 0.9294
Average Train Accuracy: 0.8761
 Site-Art                           | Val  Loss: 0.2462 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4731 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.3803 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3919 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.3953 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.3107 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 0.2640 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.4899 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5038 | Val  Acc: 0.9074
 Site-Art                           | Val  Loss: 0.5669 | Val  Acc: 0.8714
 Site-RealWorld                     | Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2125 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.3967 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.2598 | Val  Acc: 0.9254
 Site-RealWorld                     | Val  Loss: 0.4128 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.0972 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.1916 | Val  Acc: 0.7407
 Site-Product                       | Val  Loss: 0.5108 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9187
 Best site-Art                       | Epoch:41 | Val Acc: 1.0000
 Best site-Art                       | Epoch:41 | Val Acc: 0.9444
 Best site-Art                       | Epoch:41 | Val Acc: 0.9565
 Best site-Art                       | Epoch:41 | Val Acc: 0.9667
 Best site-Art                       | Epoch:41 | Val Acc: 0.9487
 Best site-Art                       | Epoch:41 | Val Acc: 0.9600
 Best site-Art                       | Epoch:41 | Val Acc: 0.9231
 Best site-Art                       | Epoch:41 | Val Acc: 0.9167
 Best site-Art                       | Epoch:41 | Val Acc: 0.9074
 Best site-Art                       | Epoch:41 | Val Acc: 0.8714
 Best site-RealWorld                 | Epoch:41 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9556
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9254
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9109
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.7500
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.7407
 Best site-Product                   | Epoch:41 | Val Acc: 0.8929
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 42 ============
 Site-Art                           | Train Loss: 0.6473 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.7554 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.8635 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.9416 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.8370 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.4805 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4529 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.4723 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.4136 | Train Acc: 0.9509
 Site-Art                           | Train Loss: 0.1406 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.5424 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.4066 | Train Acc: 0.9556
 Site-RealWorld                     | Train Loss: 0.4502 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.4938 | Train Acc: 0.8911
 Site-RealWorld                     | Train Loss: 0.2182 | Train Acc: 0.9803
 Site-Clipart                       | Train Loss: 0.9608 | Train Acc: 0.8361
 Site-Clipart                       | Train Loss: 1.0103 | Train Acc: 0.7623
 Site-Product                       | Train Loss: 0.6652 | Train Acc: 0.9412
Average Train Accuracy: 0.8767
 Site-Art                           | Val  Loss: 0.3809 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5208 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4424 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3011 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.3770 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.3745 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.3571 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.4899 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.4965 | Val  Acc: 0.8704
 Site-Art                           | Val  Loss: 0.5692 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 0.1043 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2228 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.4417 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.3108 | Val  Acc: 0.8955
 Site-RealWorld                     | Val  Loss: 0.3106 | Val  Acc: 0.9208
 Site-Clipart                       | Val  Loss: 0.9713 | Val  Acc: 0.8500
 Site-Clipart                       | Val  Loss: 1.1237 | Val  Acc: 0.8025
 Site-Product                       | Val  Loss: 0.4900 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9243
 Best site-Art                       | Epoch:42 | Val Acc: 0.9286
 Best site-Art                       | Epoch:42 | Val Acc: 0.9444
 Best site-Art                       | Epoch:42 | Val Acc: 0.9565
 Best site-Art                       | Epoch:42 | Val Acc: 0.9667
 Best site-Art                       | Epoch:42 | Val Acc: 0.9744
 Best site-Art                       | Epoch:42 | Val Acc: 0.9400
 Best site-Art                       | Epoch:42 | Val Acc: 0.9385
 Best site-Art                       | Epoch:42 | Val Acc: 0.9286
 Best site-Art                       | Epoch:42 | Val Acc: 0.8704
 Best site-Art                       | Epoch:42 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9667
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.8955
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9208
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8500
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.8025
 Best site-Product                   | Epoch:42 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
============ Train epoch 43 ============
 Site-Art                           | Train Loss: 0.7672 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.8313 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.8545 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.7990 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.8600 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.7180 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4239 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 0.3930 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.3799 | Train Acc: 0.9264
 Site-Art                           | Train Loss: 0.1544 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.4760 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.4052 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.5074 | Train Acc: 0.9118
 Site-RealWorld                     | Train Loss: 0.5214 | Train Acc: 0.8911
 Site-RealWorld                     | Train Loss: 0.2026 | Train Acc: 0.9737
 Site-Clipart                       | Train Loss: 0.9905 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.0530 | Train Acc: 0.7541
 Site-Product                       | Train Loss: 0.5049 | Train Acc: 0.9176
Average Train Accuracy: 0.8744
 Site-Art                           | Val  Loss: 0.3833 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.6585 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.6584 | Val  Acc: 0.8696
 Site-Art                           | Val  Loss: 0.1747 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4129 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.3996 | Val  Acc: 0.8800
 Site-Art                           | Val  Loss: 0.6277 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.5699 | Val  Acc: 0.8929
 Site-Art                           | Val  Loss: 0.4421 | Val  Acc: 0.9074
 Site-Art                           | Val  Loss: 0.5550 | Val  Acc: 0.8714
 Site-RealWorld                     | Val  Loss: 0.1241 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1454 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3958 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.2787 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.3312 | Val  Acc: 0.9208
 Site-Clipart                       | Val  Loss: 1.0032 | Val  Acc: 0.8000
 Site-Clipart                       | Val  Loss: 1.1299 | Val  Acc: 0.7778
 Site-Product                       | Val  Loss: 0.6366 | Val  Acc: 0.8393
Average Valid Accuracy: 0.9101
============ Train epoch 44 ============
 Site-Art                           | Train Loss: 0.7769 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 0.7290 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 0.8114 | Train Acc: 0.7429
 Site-Art                           | Train Loss: 0.8076 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.8033 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.5636 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.4832 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.3703 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.3354 | Train Acc: 0.9632
 Site-Art                           | Train Loss: 0.1135 | Train Acc: 0.9952
 Site-RealWorld                     | Train Loss: 0.4163 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.4363 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.3786 | Train Acc: 0.9559
 Site-RealWorld                     | Train Loss: 0.4856 | Train Acc: 0.8911
 Site-RealWorld                     | Train Loss: 0.1640 | Train Acc: 0.9803
 Site-Clipart                       | Train Loss: 0.9510 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 1.0017 | Train Acc: 0.7623
 Site-Product                       | Train Loss: 0.6015 | Train Acc: 0.9294
Average Train Accuracy: 0.8767
 Site-Art                           | Val  Loss: 0.4122 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5167 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.3660 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3241 | Val  Acc: 0.9333
 Site-Art                           | Val  Loss: 0.3397 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.2986 | Val  Acc: 0.9800
 Site-Art                           | Val  Loss: 0.3225 | Val  Acc: 0.9538
 Site-Art                           | Val  Loss: 0.4163 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.4885 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.4573 | Val  Acc: 0.8571
 Site-RealWorld                     | Val  Loss: 0.0999 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1521 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3277 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5169 | Val  Acc: 0.8507
 Site-RealWorld                     | Val  Loss: 0.3559 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.0972 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 0.9950 | Val  Acc: 0.7531
 Site-Product                       | Val  Loss: 0.4853 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9145
============ Train epoch 45 ============
 Site-Art                           | Train Loss: 0.7059 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.6128 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 1.0020 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 0.7666 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.8743 | Train Acc: 0.7759
 Site-Art                           | Train Loss: 0.5390 | Train Acc: 0.9333
 Site-Art                           | Train Loss: 0.4629 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 0.3729 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 0.3546 | Train Acc: 0.9387
 Site-Art                           | Train Loss: 0.1224 | Train Acc: 0.9857
 Site-RealWorld                     | Train Loss: 0.6716 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 0.4379 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.5053 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.4070 | Train Acc: 0.9307
 Site-RealWorld                     | Train Loss: 0.2192 | Train Acc: 0.9737
 Site-Clipart                       | Train Loss: 1.0417 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.0158 | Train Acc: 0.7623
 Site-Product                       | Train Loss: 0.3707 | Train Acc: 0.9412
Average Train Accuracy: 0.8832
 Site-Art                           | Val  Loss: 0.4769 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.6026 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.3978 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.3083 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.3313 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.3104 | Val  Acc: 0.9800
 Site-Art                           | Val  Loss: 0.2690 | Val  Acc: 0.9846
 Site-Art                           | Val  Loss: 0.4094 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.4636 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 0.5570 | Val  Acc: 0.8857
 Site-RealWorld                     | Val  Loss: 0.1238 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.1739 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4008 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.2368 | Val  Acc: 0.9254
 Site-RealWorld                     | Val  Loss: 0.3496 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 1.2221 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.1898 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.5603 | Val  Acc: 0.8929
Average Valid Accuracy: 0.9159
============ Train epoch 46 ============
 Site-Art                           | Train Loss: 0.7440 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.7439 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 0.9111 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.8414 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.7688 | Train Acc: 0.7931
 Site-Art                           | Train Loss: 0.4547 | Train Acc: 0.8800
 Site-Art                           | Train Loss: 0.4590 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 0.3672 | Train Acc: 0.9683
 Site-Art                           | Train Loss: 0.3909 | Train Acc: 0.9325
 Site-Art                           | Train Loss: 0.1273 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.4151 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 0.4055 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.6283 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.4136 | Train Acc: 0.9307
 Site-RealWorld                     | Train Loss: 0.1730 | Train Acc: 0.9671
 Site-Clipart                       | Train Loss: 1.0408 | Train Acc: 0.8033
 Site-Clipart                       | Train Loss: 1.0267 | Train Acc: 0.7541
 Site-Product                       | Train Loss: 0.5230 | Train Acc: 0.9294
Average Train Accuracy: 0.8789
 Site-Art                           | Val  Loss: 0.5237 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.4115 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4995 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.2569 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.2957 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.2953 | Val  Acc: 0.9400
 Site-Art                           | Val  Loss: 0.2748 | Val  Acc: 0.9538
 Site-Art                           | Val  Loss: 0.4055 | Val  Acc: 0.9524
 Site-Art                           | Val  Loss: 0.4702 | Val  Acc: 0.9074
 Site-Art                           | Val  Loss: 0.5453 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 0.0983 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1500 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3355 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.3161 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.3485 | Val  Acc: 0.9307
 Site-Clipart                       | Val  Loss: 1.2285 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.0121 | Val  Acc: 0.7654
 Site-Product                       | Val  Loss: 0.5166 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9200
============ Train epoch 47 ============
 Site-Art                           | Train Loss: 0.6269 | Train Acc: 0.9048
 Site-Art                           | Train Loss: 0.7339 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 0.8441 | Train Acc: 0.7714
 Site-Art                           | Train Loss: 0.6582 | Train Acc: 0.8667
 Site-Art                           | Train Loss: 0.8805 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.5065 | Train Acc: 0.8800
 Site-Art                           | Train Loss: 0.4404 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 0.3549 | Train Acc: 0.9524
 Site-Art                           | Train Loss: 0.3273 | Train Acc: 0.9755
 Site-Art                           | Train Loss: 0.1180 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.4967 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.4216 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.6192 | Train Acc: 0.9265
 Site-RealWorld                     | Train Loss: 0.4835 | Train Acc: 0.8713
 Site-RealWorld                     | Train Loss: 0.1905 | Train Acc: 0.9737
 Site-Clipart                       | Train Loss: 0.8373 | Train Acc: 0.8689
 Site-Clipart                       | Train Loss: 0.8597 | Train Acc: 0.8033
 Site-Product                       | Train Loss: 0.5685 | Train Acc: 0.9059
Average Train Accuracy: 0.8965
 Site-Art                           | Val  Loss: 0.5248 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.5312 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.3849 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.2319 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.2956 | Val  Acc: 0.9487
 Site-Art                           | Val  Loss: 0.2834 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 0.2484 | Val  Acc: 0.9692
 Site-Art                           | Val  Loss: 0.4202 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.5156 | Val  Acc: 0.8704
 Site-Art                           | Val  Loss: 0.4840 | Val  Acc: 0.8857
 Site-RealWorld                     | Val  Loss: 0.1238 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 0.2176 | Val  Acc: 0.9667
 Site-RealWorld                     | Val  Loss: 0.3616 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.2929 | Val  Acc: 0.8806
 Site-RealWorld                     | Val  Loss: 0.3262 | Val  Acc: 0.9208
 Site-Clipart                       | Val  Loss: 0.9724 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.0341 | Val  Acc: 0.8025
 Site-Product                       | Val  Loss: 0.5385 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9199
============ Train epoch 48 ============
 Site-Art                           | Train Loss: 0.6736 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.6798 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 0.8190 | Train Acc: 0.8286
 Site-Art                           | Train Loss: 0.7384 | Train Acc: 0.8444
 Site-Art                           | Train Loss: 0.8459 | Train Acc: 0.8103
 Site-Art                           | Train Loss: 0.4833 | Train Acc: 0.8800
 Site-Art                           | Train Loss: 0.4988 | Train Acc: 0.8763
 Site-Art                           | Train Loss: 0.3647 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 0.3891 | Train Acc: 0.9448
 Site-Art                           | Train Loss: 0.1139 | Train Acc: 0.9952
 Site-RealWorld                     | Train Loss: 0.3654 | Train Acc: 0.9667
 Site-RealWorld                     | Train Loss: 0.4026 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 0.3267 | Train Acc: 0.8971
 Site-RealWorld                     | Train Loss: 0.4005 | Train Acc: 0.9208
 Site-RealWorld                     | Train Loss: 0.1656 | Train Acc: 0.9803
 Site-Clipart                       | Train Loss: 0.9002 | Train Acc: 0.7869
 Site-Clipart                       | Train Loss: 0.9568 | Train Acc: 0.7869
 Site-Product                       | Train Loss: 0.5596 | Train Acc: 0.9294
Average Train Accuracy: 0.8908
 Site-Art                           | Val  Loss: 0.5956 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5461 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.3138 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.2996 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.3822 | Val  Acc: 0.9231
 Site-Art                           | Val  Loss: 0.3113 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 1.0466 | Val  Acc: 0.9538
 Site-Art                           | Val  Loss: 0.3624 | Val  Acc: 0.9405
 Site-Art                           | Val  Loss: 0.4702 | Val  Acc: 0.9074
 Site-Art                           | Val  Loss: 0.5971 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1574 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2992 | Val  Acc: 0.9778
 Site-RealWorld                     | Val  Loss: 0.2787 | Val  Acc: 0.8657
 Site-RealWorld                     | Val  Loss: 0.3224 | Val  Acc: 0.9307
 Site-Clipart                       | Val  Loss: 1.1865 | Val  Acc: 0.7250
 Site-Clipart                       | Val  Loss: 1.1512 | Val  Acc: 0.7160
 Site-Product                       | Val  Loss: 0.5844 | Val  Acc: 0.8571
Average Valid Accuracy: 0.9137
============ Train epoch 49 ============
 Site-Art                           | Train Loss: 0.6098 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 0.6080 | Train Acc: 0.8519
 Site-Art                           | Train Loss: 0.8586 | Train Acc: 0.8000
 Site-Art                           | Train Loss: 0.7041 | Train Acc: 0.8222
 Site-Art                           | Train Loss: 0.7114 | Train Acc: 0.8448
 Site-Art                           | Train Loss: 0.4810 | Train Acc: 0.8933
 Site-Art                           | Train Loss: 0.4979 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 0.3815 | Train Acc: 0.9365
 Site-Art                           | Train Loss: 0.3087 | Train Acc: 0.9509
 Site-Art                           | Train Loss: 0.0907 | Train Acc: 0.9905
 Site-RealWorld                     | Train Loss: 0.4739 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 0.3990 | Train Acc: 0.9111
 Site-RealWorld                     | Train Loss: 0.4698 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 0.4686 | Train Acc: 0.9010
 Site-RealWorld                     | Train Loss: 0.1422 | Train Acc: 0.9868
 Site-Clipart                       | Train Loss: 0.9378 | Train Acc: 0.7213
 Site-Clipart                       | Train Loss: 0.9307 | Train Acc: 0.8361
 Site-Product                       | Train Loss: 0.3497 | Train Acc: 0.9647
Average Train Accuracy: 0.8841
 Site-Art                           | Val  Loss: 0.4544 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4618 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.3853 | Val  Acc: 0.9565
 Site-Art                           | Val  Loss: 0.2565 | Val  Acc: 0.9667
 Site-Art                           | Val  Loss: 0.2979 | Val  Acc: 0.9744
 Site-Art                           | Val  Loss: 0.2563 | Val  Acc: 0.9600
 Site-Art                           | Val  Loss: 0.8010 | Val  Acc: 0.9385
 Site-Art                           | Val  Loss: 0.3982 | Val  Acc: 0.9286
 Site-Art                           | Val  Loss: 0.5165 | Val  Acc: 0.8796
 Site-Art                           | Val  Loss: 0.4640 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 0.1275 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1688 | Val  Acc: 0.9333
 Site-RealWorld                     | Val  Loss: 0.3535 | Val  Acc: 0.9556
 Site-RealWorld                     | Val  Loss: 0.2870 | Val  Acc: 0.8955
 Site-RealWorld                     | Val  Loss: 0.3707 | Val  Acc: 0.9109
 Site-Clipart                       | Val  Loss: 0.8431 | Val  Acc: 0.9000
 Site-Clipart                       | Val  Loss: 1.1595 | Val  Acc: 0.8272
 Site-Product                       | Val  Loss: 0.5256 | Val  Acc: 0.9107
Average Valid Accuracy: 0.9319
 Best site-Art                       | Epoch:49 | Val Acc: 1.0000
 Best site-Art                       | Epoch:49 | Val Acc: 0.9444
 Best site-Art                       | Epoch:49 | Val Acc: 0.9565
 Best site-Art                       | Epoch:49 | Val Acc: 0.9667
 Best site-Art                       | Epoch:49 | Val Acc: 0.9744
 Best site-Art                       | Epoch:49 | Val Acc: 0.9600
 Best site-Art                       | Epoch:49 | Val Acc: 0.9385
 Best site-Art                       | Epoch:49 | Val Acc: 0.9286
 Best site-Art                       | Epoch:49 | Val Acc: 0.8796
 Best site-Art                       | Epoch:49 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9333
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9556
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.8955
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9109
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.9000
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.8272
 Best site-Product                   | Epoch:49 | Val Acc: 0.9107
 Saving the local and server checkpoint to ../checkpoint/fed_officehome_uneven_2.16_1/harmo-fl...
===2023-08-05 11:50:57===
===2023-08-05 11:51:14===
===Setting===
    dataset: officehome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[21,27,35,45,58,75,97,126,163,210,30,45,68,101,152,61,122,85,
client_nums=[10,5,2,1,]
len_dataset=[1435,664,307,142,]
domain number = 4
Loading snapshots...
 Test site-Art                       (0)| Epoch:49 | Test Acc: 0.8115
 Test site-RealWorld                 (2)| Epoch:49 | Test Acc: 0.8611
 Test site-Clipart                   (3)| Epoch:49 | Test Acc: 0.6552
 Test site-Product                   (1)| Epoch:49 | Test Acc: 0.8370
Art: 0.8115, RealWorld: 0.8611, Clipart: 0.6552, Product: 0.8370, 
Average Test Accuracy(group): 0.7912, Average Test Accuracy(individual): 0.8093,
domain std=0.0805, cluster std=0.0747, individual std=0.0586, 
