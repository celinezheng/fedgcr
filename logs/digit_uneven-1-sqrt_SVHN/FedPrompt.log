===2023-03-30 00:28:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6552 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.5424 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.5614 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.4582 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.5148 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5365 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 1.4245 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.4514 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 2.0854 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.2272 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.4719 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.5852 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.6031 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.5424 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.4103 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4489 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.5808 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.5234 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 2.1027 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.2436 | Val  Acc: 0.1525
Average Valid Accuracy: 0.6017
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.7288
 Best site-USPS       | Epoch:0 | Val Acc: 0.7966
 Best site-USPS       | Epoch:0 | Val Acc: 0.7288
 Best site-USPS       | Epoch:0 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1306 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.0272 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.0815 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.9183 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.9204 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.9599 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.8944 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.9169 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.8688 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.1004 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 0.9412 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.1034 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1001 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0216 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.8430 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9082 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.9676 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.9936 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9752 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1698 | Val  Acc: 0.1525
Average Valid Accuracy: 0.6661
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-USPS       | Epoch:1 | Val Acc: 0.8644
 Best site-USPS       | Epoch:1 | Val Acc: 0.8305
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6386 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.5833 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6179 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.5198 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.5252 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.5933 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5796 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.5002 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.5636 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.9736 | Train Acc: 0.2955
 Site-MNIST     | Val  Loss: 0.4786 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6587 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.6245 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5698 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.5179 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5900 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.6165 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5439 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6925 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.1096 | Val  Acc: 0.2373
Average Valid Accuracy: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4175 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.3981 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4694 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3024 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.3331 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.3480 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3454 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2655 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 1.4462 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.7848 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.3021 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4713 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4386 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.3941 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.2877 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3633 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3594 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3105 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.6884 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9711 | Val  Acc: 0.2881
Average Valid Accuracy: 0.8068
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-USPS       | Epoch:3 | Val Acc: 0.9492
 Best site-USPS       | Epoch:3 | Val Acc: 0.9153
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-USPS       | Epoch:3 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2434 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2746 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2875 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1760 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.3011 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2690 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3106 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1951 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.2599 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.4607 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.1974 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3033 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.3006 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.2674 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.2382 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3033 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2683 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2511 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.4905 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.7851 | Val  Acc: 0.4407
Average Valid Accuracy: 0.8508
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2231 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2255 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2691 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1453 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1996 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1620 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2001 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1332 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 1.2004 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.2144 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.1669 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3000 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2321 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2293 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1537 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1971 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1682 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1705 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.4884 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6340 | Val  Acc: 0.4576
Average Valid Accuracy: 0.8610
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1406 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1269 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1477 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0744 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1802 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1501 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.2247 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1247 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.0208 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.8510 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.1025 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1630 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1403 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1526 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1561 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2183 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1548 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1474 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.3861 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4855 | Val  Acc: 0.5085
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-USPS       | Epoch:6 | Val Acc: 1.0000
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1313 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1034 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1557 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.0684 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1112 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0787 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1216 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.0748 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.7666 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.7115 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.1007 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1572 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1122 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1319 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0771 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1187 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.0804 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1009 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.3038 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3744 | Val  Acc: 0.6780
Average Valid Accuracy: 0.9051
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9831
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-USPS       | Epoch:7 | Val Acc: 1.0000
 Best site-USPS       | Epoch:7 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0942 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0583 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0332 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1230 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0765 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1212 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0757 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.7281 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.4929 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0514 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0646 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0961 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0899 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1247 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0769 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 1.3237 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2732 | Val  Acc: 0.6271
Average Valid Accuracy: 0.9136
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0769 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0601 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0856 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0396 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1073 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0783 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.5122 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.4044 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0481 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0912 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0665 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0865 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0508 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0780 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0470 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0699 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.1698 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.2526 | Val  Acc: 0.6780
Average Valid Accuracy: 0.9237
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_SVHN...
===2023-03-30 01:02:08===
===2023-03-30 01:02:09===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.2579
Average Test Accuracy: 0.2579
