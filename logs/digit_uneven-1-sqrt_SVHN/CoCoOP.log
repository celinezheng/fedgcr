===2023-03-30 03:19:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6960 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.6034 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.6095 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.5192 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 1.5849 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 1.6145 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 1.4944 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5407 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 2.0987 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2210 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.5244 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6278 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6487 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.5953 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.4818 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.5189 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.6591 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.5998 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1211 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.2328 | Val  Acc: 0.1356
Average Valid Accuracy: 0.5627
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-USPS       | Epoch:0 | Val Acc: 0.6949
 Best site-USPS       | Epoch:0 | Val Acc: 0.7627
 Best site-USPS       | Epoch:0 | Val Acc: 0.7119
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2307 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.1584 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1641 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.0509 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 1.1015 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.1562 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.0354 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.0828 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.9425 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.1069 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.0702 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.1910 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2206 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.1302 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0166 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.0698 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.1801 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1286 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9443 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.1428 | Val  Acc: 0.1864
Average Valid Accuracy: 0.6881
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8136
 Best site-USPS       | Epoch:1 | Val Acc: 0.8475
 Best site-USPS       | Epoch:1 | Val Acc: 0.8305
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9397 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8747 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.9110 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.8003 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.8275 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.8758 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7964 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8112 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.8239 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.9773 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 0.7952 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.9249 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.9490 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8636 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.7374 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.8032 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.8822 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.8471 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.8466 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0704 | Val  Acc: 0.2203
Average Valid Accuracy: 0.7458
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.9492
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7056 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6904 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.7176 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6234 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.6319 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6708 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6159 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6313 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.7665 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.8854 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.6039 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.7419 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7582 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6897 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.5480 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.6150 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6864 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.6686 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.7483 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0079 | Val  Acc: 0.2203
Average Valid Accuracy: 0.7661
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-USPS       | Epoch:3 | Val Acc: 0.9492
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.5840 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5775 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5762 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4945 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.5287 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5660 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4745 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4969 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.6759 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.8179 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.4738 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.6162 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6167 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5659 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.4370 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.4974 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5672 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5458 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6615 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9516 | Val  Acc: 0.2373
Average Valid Accuracy: 0.7847
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-USPS       | Epoch:4 | Val Acc: 0.9492
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4916 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4815 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5000 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3736 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.4569 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.4771 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4120 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4180 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.5931 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.7401 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.3868 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.5211 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5122 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4841 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.3616 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.4195 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4762 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4633 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6094 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.8731 | Val  Acc: 0.2881
Average Valid Accuracy: 0.7949
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.4164 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.3876 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4229 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3419 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.4618 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4114 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3605 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3677 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.5104 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6376 | Train Acc: 0.3977
 Site-MNIST     | Val  Loss: 0.3278 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4504 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4260 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4162 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.3116 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3658 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4167 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4136 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5687 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.7935 | Val  Acc: 0.3390
Average Valid Accuracy: 0.8119
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.3823 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.3821 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3825 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2670 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.3455 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3705 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3212 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3171 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.4568 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.5388 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.2812 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4050 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3658 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3720 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.2737 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3278 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3682 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3754 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5249 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.7307 | Val  Acc: 0.3729
Average Valid Accuracy: 0.8203
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8644
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.3419 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.3319 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3659 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2310 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.3279 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3051 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2918 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2676 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.4117 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.4537 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.2483 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3738 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3242 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3365 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.2447 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3034 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3220 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3423 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4828 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.6539 | Val  Acc: 0.4068
Average Valid Accuracy: 0.8237
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3162 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2680 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.3491 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.2026 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2866 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3110 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2684 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2634 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.3260 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.3865 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.2181 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3550 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.2884 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3119 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.2229 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2832 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2905 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3155 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4394 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5850 | Val  Acc: 0.4407
Average Valid Accuracy: 0.8322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8814
 Best site-USPS       | Epoch:9 | Val Acc: 0.9322
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-USPS       | Epoch:9 | Val Acc: 0.9322
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_SVHN...
===2023-03-30 03:52:21===
===2023-03-30 03:52:22===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.3103
Average Test Accuracy: 0.3103
