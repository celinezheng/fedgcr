===2023-04-05 00:43:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 1, 3, ]
 Site-MNIST     | Train Loss: 1.8880 | Train Acc: 0.3636
 Site-MNIST     | Train Loss: 1.8144 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.1957 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.2008 | Train Acc: 0.2159
 Site-USPS      | Train Loss: 1.8236 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 1.8856 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 2.1320 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.1272 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2829 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2009 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.8517 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.7869 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 2.1807 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2235 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.8713 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 1.8586 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.1408 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.1406 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2085 | Val  Acc: 0.1695
 Site-MNIST-M   | Val  Loss: 2.2133 | Val  Acc: 0.2203
Average Valid Accuracy: 0.3136
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-USPS       | Epoch:0 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 1.5596 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.4722 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 2.1106 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0810 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 1.4693 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 1.5146 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.9453 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9285 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.1874 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.0770 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.5255 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.4180 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.0961 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 2.1117 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5338 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.4635 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9591 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.9111 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 2.0731 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.1033 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4814
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-USPS       | Epoch:1 | Val Acc: 0.6441
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
cnt=[5, 2, 3, ]
 Site-MNIST     | Train Loss: 1.2824 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.2502 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.0411 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0116 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.1826 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.2108 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.7629 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.7635 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.0458 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 1.9567 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.2993 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1785 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.0310 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.0094 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 1.2610 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.1793 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.7874 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.7270 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.9577 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0030 | Val  Acc: 0.3051
Average Valid Accuracy: 0.5458
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-2
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 1.0380 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 1.0006 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 1.9843 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.9205 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.9406 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.9965 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.6120 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.6095 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.9533 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.8363 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.0725 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.9442 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9833 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9279 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 1.0326 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.9663 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.6318 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.5939 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.8447 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8883 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5831
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-USPS       | Epoch:3 | Val Acc: 0.7627
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 0.8861 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.8421 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9382 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8660 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.7964 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.8333 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.5041 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.4365 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.8201 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.7070 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.8919 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.7795 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9247 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8188 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.8542 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 0.8019 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.4787 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 1.4498 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.7193 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7585 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6102
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-USPS       | Epoch:4 | Val Acc: 0.7627
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
 Test site-MNIST     | Epoch:4 | Test Acc: 0.7236
 Test site-SVHN      | Epoch:4 | Test Acc: 0.3139
 Test site-USPS      | Epoch:4 | Test Acc: 0.7903
 Test site-SynthDigits| Epoch:4 | Test Acc: 0.4973
 Test site-MNIST-M   | Epoch:4 | Test Acc: 0.3657
Average Test Accuracy: 0.5382
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 0.7320 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7128 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 1.8796 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7815 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.6698 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7121 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.3730 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3647 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.6707 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.5725 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.7637 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6600 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8541 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7231 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.7171 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.6744 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3756 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.3434 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.5976 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6239 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6458
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4576
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
cnt=[6, 2, 2, ]
 Site-MNIST     | Train Loss: 0.6243 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.6126 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.8185 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6893 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.6181 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.6740 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.2825 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.2106 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.5403 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.4091 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.6566 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5644 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.7899 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6495 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.6771 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6448 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3022 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2553 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.4439 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4581 | Val  Acc: 0.6102
Average Valid Accuracy: 0.6797
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt_2/Nova...
============ Train epoch 35 ============
