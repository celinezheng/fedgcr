===2023-05-24 11:24:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 30
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[48,82,140,238,261,96,163,259,117,199,186,]
client_nums=[5,3,2,1,]
domain number = -1
============ Train epoch 0 ============
 Site-White_Male               | Train Loss: 2.2017 | Train Acc: 0.1250
 Site-White_Female             | Train Loss: 2.1730 | Train Acc: 0.1585
 Site-White_Male               | Train Loss: 2.1877 | Train Acc: 0.1786
 Site-White_Female             | Train Loss: 2.1758 | Train Acc: 0.1723
 Site-White_Male               | Train Loss: 2.1754 | Train Acc: 0.1341
 Site-Black_Female             | Train Loss: 2.1859 | Train Acc: 0.0625
 Site-Black_Male               | Train Loss: 2.1831 | Train Acc: 0.1043
 Site-Black_Female             | Train Loss: 2.1798 | Train Acc: 0.1313
 Site-Indian_Male              | Train Loss: 2.1691 | Train Acc: 0.1453
 Site-Indian_Female            | Train Loss: 2.1817 | Train Acc: 0.1055
 Site-Middle_Eastern_Male      | Train Loss: 2.2008 | Train Acc: 0.0753
 Site-White_Male                    | Val  Loss: 2.2012 | Val  Acc: 0.0625
 Site-White_Female                  | Val  Loss: 2.1787 | Val  Acc: 0.1481
 Site-White_Male                    | Val  Loss: 2.1735 | Val  Acc: 0.1398
 Site-White_Female                  | Val  Loss: 2.1734 | Val  Acc: 0.2278
 Site-White_Male                    | Val  Loss: 2.1798 | Val  Acc: 0.1667
 Site-Black_Female                  | Val  Loss: 2.1783 | Val  Acc: 0.1562
 Site-Black_Male                    | Val  Loss: 2.1845 | Val  Acc: 0.1376
 Site-Black_Female                  | Val  Loss: 2.1834 | Val  Acc: 0.1329
 Site-Indian_Male                   | Val  Loss: 2.1807 | Val  Acc: 0.1154
 Site-Indian_Female                 | Val  Loss: 2.1429 | Val  Acc: 0.1515
 Site-Middle_Eastern_Male           | Val  Loss: 2.1873 | Val  Acc: 0.1855
Average Valid Accuracy: 0.1476
 Best site-White_Male                | Epoch:0 | Val Acc: 0.0625
 Best site-White_Female              | Epoch:0 | Val Acc: 0.1481
 Best site-White_Male                | Epoch:0 | Val Acc: 0.1398
 Best site-White_Female              | Epoch:0 | Val Acc: 0.2278
 Best site-White_Male                | Epoch:0 | Val Acc: 0.1667
 Best site-Black_Female              | Epoch:0 | Val Acc: 0.1562
 Best site-Black_Male                | Epoch:0 | Val Acc: 0.1376
 Best site-Black_Female              | Epoch:0 | Val Acc: 0.1329
 Best site-Indian_Male               | Epoch:0 | Val Acc: 0.1154
 Best site-Indian_Female             | Epoch:0 | Val Acc: 0.1515
 Best site-Middle_Eastern_Male       | Epoch:0 | Val Acc: 0.1855
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 1 ============
 Site-White_Male               | Train Loss: 2.1798 | Train Acc: 0.1458
 Site-White_Female             | Train Loss: 2.1559 | Train Acc: 0.2073
 Site-White_Male               | Train Loss: 2.1405 | Train Acc: 0.2357
 Site-White_Female             | Train Loss: 2.1490 | Train Acc: 0.2017
 Site-White_Male               | Train Loss: 2.1714 | Train Acc: 0.1916
 Site-Black_Female             | Train Loss: 2.1835 | Train Acc: 0.1354
 Site-Black_Male               | Train Loss: 2.1735 | Train Acc: 0.1288
 Site-Black_Female             | Train Loss: 2.1848 | Train Acc: 0.1737
 Site-Indian_Male              | Train Loss: 2.1469 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 2.1643 | Train Acc: 0.1558
 Site-Middle_Eastern_Male      | Train Loss: 2.1879 | Train Acc: 0.1720
 Site-White_Male                    | Val  Loss: 2.1583 | Val  Acc: 0.2500
 Site-White_Female                  | Val  Loss: 2.1568 | Val  Acc: 0.2037
 Site-White_Male                    | Val  Loss: 2.1547 | Val  Acc: 0.2366
 Site-White_Female                  | Val  Loss: 2.1482 | Val  Acc: 0.2532
 Site-White_Male                    | Val  Loss: 2.1616 | Val  Acc: 0.1897
 Site-Black_Female                  | Val  Loss: 2.1510 | Val  Acc: 0.2031
 Site-Black_Male                    | Val  Loss: 2.1650 | Val  Acc: 0.1651
 Site-Black_Female                  | Val  Loss: 2.1694 | Val  Acc: 0.1850
 Site-Indian_Male                   | Val  Loss: 2.1577 | Val  Acc: 0.1667
 Site-Indian_Female                 | Val  Loss: 2.1399 | Val  Acc: 0.2045
 Site-Middle_Eastern_Male           | Val  Loss: 2.1715 | Val  Acc: 0.1935
Average Valid Accuracy: 0.2046
 Best site-White_Male                | Epoch:1 | Val Acc: 0.2500
 Best site-White_Female              | Epoch:1 | Val Acc: 0.2037
 Best site-White_Male                | Epoch:1 | Val Acc: 0.2366
 Best site-White_Female              | Epoch:1 | Val Acc: 0.2532
 Best site-White_Male                | Epoch:1 | Val Acc: 0.1897
 Best site-Black_Female              | Epoch:1 | Val Acc: 0.2031
 Best site-Black_Male                | Epoch:1 | Val Acc: 0.1651
 Best site-Black_Female              | Epoch:1 | Val Acc: 0.1850
 Best site-Indian_Male               | Epoch:1 | Val Acc: 0.1667
 Best site-Indian_Female             | Epoch:1 | Val Acc: 0.2045
 Best site-Middle_Eastern_Male       | Epoch:1 | Val Acc: 0.1935
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 2 ============
 Site-White_Male               | Train Loss: 2.1648 | Train Acc: 0.1667
 Site-White_Female             | Train Loss: 2.0960 | Train Acc: 0.2683
 Site-White_Male               | Train Loss: 2.1483 | Train Acc: 0.2429
 Site-White_Female             | Train Loss: 2.1248 | Train Acc: 0.2311
 Site-White_Male               | Train Loss: 2.1533 | Train Acc: 0.2222
 Site-Black_Female             | Train Loss: 2.1544 | Train Acc: 0.2188
 Site-Black_Male               | Train Loss: 2.1467 | Train Acc: 0.1472
 Site-Black_Female             | Train Loss: 2.1501 | Train Acc: 0.1892
 Site-Indian_Male              | Train Loss: 2.1375 | Train Acc: 0.1795
 Site-Indian_Female            | Train Loss: 2.1427 | Train Acc: 0.1457
 Site-Middle_Eastern_Male      | Train Loss: 2.1737 | Train Acc: 0.1828
 Site-White_Male                    | Val  Loss: 2.1483 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 2.1201 | Val  Acc: 0.1852
 Site-White_Male                    | Val  Loss: 2.1329 | Val  Acc: 0.2151
 Site-White_Female                  | Val  Loss: 2.1188 | Val  Acc: 0.3291
 Site-White_Male                    | Val  Loss: 2.1402 | Val  Acc: 0.2184
 Site-Black_Female                  | Val  Loss: 2.1287 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 2.1480 | Val  Acc: 0.1743
 Site-Black_Female                  | Val  Loss: 2.1334 | Val  Acc: 0.2543
 Site-Indian_Male                   | Val  Loss: 2.1280 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 2.0999 | Val  Acc: 0.2045
 Site-Middle_Eastern_Male           | Val  Loss: 2.1669 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2262
 Best site-White_Male                | Epoch:2 | Val Acc: 0.2188
 Best site-White_Female              | Epoch:2 | Val Acc: 0.1852
 Best site-White_Male                | Epoch:2 | Val Acc: 0.2151
 Best site-White_Female              | Epoch:2 | Val Acc: 0.3291
 Best site-White_Male                | Epoch:2 | Val Acc: 0.2184
 Best site-Black_Female              | Epoch:2 | Val Acc: 0.2812
 Best site-Black_Male                | Epoch:2 | Val Acc: 0.1743
 Best site-Black_Female              | Epoch:2 | Val Acc: 0.2543
 Best site-Indian_Male               | Epoch:2 | Val Acc: 0.2051
 Best site-Indian_Female             | Epoch:2 | Val Acc: 0.2045
 Best site-Middle_Eastern_Male       | Epoch:2 | Val Acc: 0.2016
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 3 ============
 Site-White_Male               | Train Loss: 2.1458 | Train Acc: 0.2292
 Site-White_Female             | Train Loss: 2.1043 | Train Acc: 0.2683
 Site-White_Male               | Train Loss: 2.1184 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 2.1005 | Train Acc: 0.2899
 Site-White_Male               | Train Loss: 2.1216 | Train Acc: 0.2720
 Site-Black_Female             | Train Loss: 2.1313 | Train Acc: 0.2708
 Site-Black_Male               | Train Loss: 2.1438 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 2.1133 | Train Acc: 0.2124
 Site-Indian_Male              | Train Loss: 2.1226 | Train Acc: 0.2650
 Site-Indian_Female            | Train Loss: 2.1313 | Train Acc: 0.2010
 Site-Middle_Eastern_Male      | Train Loss: 2.1591 | Train Acc: 0.2097
 Site-White_Male                    | Val  Loss: 2.1333 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 2.0876 | Val  Acc: 0.1852
 Site-White_Male                    | Val  Loss: 2.1108 | Val  Acc: 0.2796
 Site-White_Female                  | Val  Loss: 2.0896 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.1271 | Val  Acc: 0.2241
 Site-Black_Female                  | Val  Loss: 2.1094 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 2.1289 | Val  Acc: 0.2294
 Site-Black_Female                  | Val  Loss: 2.1136 | Val  Acc: 0.2601
 Site-Indian_Male                   | Val  Loss: 2.1120 | Val  Acc: 0.2179
 Site-Indian_Female                 | Val  Loss: 2.0799 | Val  Acc: 0.2576
 Site-Middle_Eastern_Male           | Val  Loss: 2.1512 | Val  Acc: 0.2177
Average Valid Accuracy: 0.2421
 Best site-White_Male                | Epoch:3 | Val Acc: 0.1875
 Best site-White_Female              | Epoch:3 | Val Acc: 0.1852
 Best site-White_Male                | Epoch:3 | Val Acc: 0.2796
 Best site-White_Female              | Epoch:3 | Val Acc: 0.3544
 Best site-White_Male                | Epoch:3 | Val Acc: 0.2241
 Best site-Black_Female              | Epoch:3 | Val Acc: 0.2500
 Best site-Black_Male                | Epoch:3 | Val Acc: 0.2294
 Best site-Black_Female              | Epoch:3 | Val Acc: 0.2601
 Best site-Indian_Male               | Epoch:3 | Val Acc: 0.2179
 Best site-Indian_Female             | Epoch:3 | Val Acc: 0.2576
 Best site-Middle_Eastern_Male       | Epoch:3 | Val Acc: 0.2177
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 4 ============
 Site-White_Male               | Train Loss: 2.1291 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 2.0350 | Train Acc: 0.3293
 Site-White_Male               | Train Loss: 2.1044 | Train Acc: 0.2929
 Site-White_Female             | Train Loss: 2.0742 | Train Acc: 0.3025
 Site-White_Male               | Train Loss: 2.1194 | Train Acc: 0.2414
 Site-Black_Female             | Train Loss: 2.1009 | Train Acc: 0.2708
 Site-Black_Male               | Train Loss: 2.1274 | Train Acc: 0.2147
 Site-Black_Female             | Train Loss: 2.0986 | Train Acc: 0.2394
 Site-Indian_Male              | Train Loss: 2.1054 | Train Acc: 0.2564
 Site-Indian_Female            | Train Loss: 2.1144 | Train Acc: 0.2211
 Site-Middle_Eastern_Male      | Train Loss: 2.1488 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 2.1311 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 2.0777 | Val  Acc: 0.2222
 Site-White_Male                    | Val  Loss: 2.0968 | Val  Acc: 0.2581
 Site-White_Female                  | Val  Loss: 2.0792 | Val  Acc: 0.3291
 Site-White_Male                    | Val  Loss: 2.1142 | Val  Acc: 0.2356
 Site-Black_Female                  | Val  Loss: 2.0893 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 2.1187 | Val  Acc: 0.2569
 Site-Black_Female                  | Val  Loss: 2.0999 | Val  Acc: 0.2543
 Site-Indian_Male                   | Val  Loss: 2.0887 | Val  Acc: 0.2308
 Site-Indian_Female                 | Val  Loss: 2.0695 | Val  Acc: 0.2424
 Site-Middle_Eastern_Male           | Val  Loss: 2.1363 | Val  Acc: 0.2500
Average Valid Accuracy: 0.2470
 Best site-White_Male                | Epoch:4 | Val Acc: 0.1875
 Best site-White_Female              | Epoch:4 | Val Acc: 0.2222
 Best site-White_Male                | Epoch:4 | Val Acc: 0.2581
 Best site-White_Female              | Epoch:4 | Val Acc: 0.3291
 Best site-White_Male                | Epoch:4 | Val Acc: 0.2356
 Best site-Black_Female              | Epoch:4 | Val Acc: 0.2500
 Best site-Black_Male                | Epoch:4 | Val Acc: 0.2569
 Best site-Black_Female              | Epoch:4 | Val Acc: 0.2543
 Best site-Indian_Male               | Epoch:4 | Val Acc: 0.2308
 Best site-Indian_Female             | Epoch:4 | Val Acc: 0.2424
 Best site-Middle_Eastern_Male       | Epoch:4 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 5 ============
 Site-White_Male               | Train Loss: 2.1080 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 2.0429 | Train Acc: 0.3415
 Site-White_Male               | Train Loss: 2.0891 | Train Acc: 0.2857
 Site-White_Female             | Train Loss: 2.0557 | Train Acc: 0.2899
 Site-White_Male               | Train Loss: 2.1034 | Train Acc: 0.2720
 Site-Black_Female             | Train Loss: 2.0840 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.1122 | Train Acc: 0.1902
 Site-Black_Female             | Train Loss: 2.0620 | Train Acc: 0.2278
 Site-Indian_Male              | Train Loss: 2.0975 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 2.1013 | Train Acc: 0.2312
 Site-Middle_Eastern_Male      | Train Loss: 2.1452 | Train Acc: 0.2151
 Site-White_Male                    | Val  Loss: 2.1174 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 2.0461 | Val  Acc: 0.2778
 Site-White_Male                    | Val  Loss: 2.0845 | Val  Acc: 0.3118
 Site-White_Female                  | Val  Loss: 2.0593 | Val  Acc: 0.3481
 Site-White_Male                    | Val  Loss: 2.0995 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 2.0861 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 2.1027 | Val  Acc: 0.2202
 Site-Black_Female                  | Val  Loss: 2.0872 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 2.0855 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 2.0467 | Val  Acc: 0.2576
 Site-Middle_Eastern_Male           | Val  Loss: 2.1374 | Val  Acc: 0.2419
Average Valid Accuracy: 0.2573
 Best site-White_Male                | Epoch:5 | Val Acc: 0.1875
 Best site-White_Female              | Epoch:5 | Val Acc: 0.2778
 Best site-White_Male                | Epoch:5 | Val Acc: 0.3118
 Best site-White_Female              | Epoch:5 | Val Acc: 0.3481
 Best site-White_Male                | Epoch:5 | Val Acc: 0.2414
 Best site-Black_Female              | Epoch:5 | Val Acc: 0.2812
 Best site-Black_Male                | Epoch:5 | Val Acc: 0.2202
 Best site-Black_Female              | Epoch:5 | Val Acc: 0.2832
 Best site-Indian_Male               | Epoch:5 | Val Acc: 0.1795
 Best site-Indian_Female             | Epoch:5 | Val Acc: 0.2576
 Best site-Middle_Eastern_Male       | Epoch:5 | Val Acc: 0.2419
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 6 ============
 Site-White_Male               | Train Loss: 2.0927 | Train Acc: 0.2083
 Site-White_Female             | Train Loss: 2.0394 | Train Acc: 0.3659
 Site-White_Male               | Train Loss: 2.0544 | Train Acc: 0.2857
 Site-White_Female             | Train Loss: 2.0255 | Train Acc: 0.3403
 Site-White_Male               | Train Loss: 2.0882 | Train Acc: 0.2682
 Site-Black_Female             | Train Loss: 2.0654 | Train Acc: 0.2917
 Site-Black_Male               | Train Loss: 2.0969 | Train Acc: 0.2209
 Site-Black_Female             | Train Loss: 2.0399 | Train Acc: 0.2510
 Site-Indian_Male              | Train Loss: 2.0857 | Train Acc: 0.2564
 Site-Indian_Female            | Train Loss: 2.1070 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.1364 | Train Acc: 0.1720
 Site-White_Male                    | Val  Loss: 2.1043 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 2.0336 | Val  Acc: 0.2593
 Site-White_Male                    | Val  Loss: 2.0644 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 2.0396 | Val  Acc: 0.3354
 Site-White_Male                    | Val  Loss: 2.0868 | Val  Acc: 0.2184
 Site-Black_Female                  | Val  Loss: 2.0686 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 2.0917 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 2.0672 | Val  Acc: 0.3064
 Site-Indian_Male                   | Val  Loss: 2.0555 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 2.0259 | Val  Acc: 0.2879
 Site-Middle_Eastern_Male           | Val  Loss: 2.1299 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2643
 Best site-White_Male                | Epoch:6 | Val Acc: 0.2188
 Best site-White_Female              | Epoch:6 | Val Acc: 0.2593
 Best site-White_Male                | Epoch:6 | Val Acc: 0.3333
 Best site-White_Female              | Epoch:6 | Val Acc: 0.3354
 Best site-White_Male                | Epoch:6 | Val Acc: 0.2184
 Best site-Black_Female              | Epoch:6 | Val Acc: 0.2656
 Best site-Black_Male                | Epoch:6 | Val Acc: 0.2752
 Best site-Black_Female              | Epoch:6 | Val Acc: 0.3064
 Best site-Indian_Male               | Epoch:6 | Val Acc: 0.2051
 Best site-Indian_Female             | Epoch:6 | Val Acc: 0.2879
 Best site-Middle_Eastern_Male       | Epoch:6 | Val Acc: 0.2016
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 7 ============
 Site-White_Male               | Train Loss: 2.0758 | Train Acc: 0.2708
 Site-White_Female             | Train Loss: 2.0175 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 2.0875 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 2.0131 | Train Acc: 0.3739
 Site-White_Male               | Train Loss: 2.0915 | Train Acc: 0.2529
 Site-Black_Female             | Train Loss: 2.0618 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.0923 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 2.0634 | Train Acc: 0.2934
 Site-Indian_Male              | Train Loss: 2.0773 | Train Acc: 0.2308
 Site-Indian_Female            | Train Loss: 2.0928 | Train Acc: 0.2563
 Site-Middle_Eastern_Male      | Train Loss: 2.1230 | Train Acc: 0.1720
 Site-White_Male                    | Val  Loss: 2.0830 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 2.0028 | Val  Acc: 0.2963
 Site-White_Male                    | Val  Loss: 2.0509 | Val  Acc: 0.3011
 Site-White_Female                  | Val  Loss: 2.0212 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 2.0727 | Val  Acc: 0.2241
 Site-Black_Female                  | Val  Loss: 2.0578 | Val  Acc: 0.3125
 Site-Black_Male                    | Val  Loss: 2.0744 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 2.0499 | Val  Acc: 0.3006
 Site-Indian_Male                   | Val  Loss: 2.0522 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 2.0156 | Val  Acc: 0.2652
 Site-Middle_Eastern_Male           | Val  Loss: 2.1145 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2686
 Best site-White_Male                | Epoch:7 | Val Acc: 0.2188
 Best site-White_Female              | Epoch:7 | Val Acc: 0.2963
 Best site-White_Male                | Epoch:7 | Val Acc: 0.3011
 Best site-White_Female              | Epoch:7 | Val Acc: 0.3797
 Best site-White_Male                | Epoch:7 | Val Acc: 0.2241
 Best site-Black_Female              | Epoch:7 | Val Acc: 0.3125
 Best site-Black_Male                | Epoch:7 | Val Acc: 0.2752
 Best site-Black_Female              | Epoch:7 | Val Acc: 0.3006
 Best site-Indian_Male               | Epoch:7 | Val Acc: 0.1795
 Best site-Indian_Female             | Epoch:7 | Val Acc: 0.2652
 Best site-Middle_Eastern_Male       | Epoch:7 | Val Acc: 0.2016
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
============ Train epoch 8 ============
 Site-White_Male               | Train Loss: 2.0613 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.9892 | Train Acc: 0.3659
 Site-White_Male               | Train Loss: 2.0489 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.9969 | Train Acc: 0.3403
 Site-White_Male               | Train Loss: 2.0628 | Train Acc: 0.2337
 Site-Black_Female             | Train Loss: 2.0640 | Train Acc: 0.3021
 Site-Black_Male               | Train Loss: 2.0906 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 2.0238 | Train Acc: 0.2664
 Site-Indian_Male              | Train Loss: 2.0748 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 2.1023 | Train Acc: 0.2613
 Site-Middle_Eastern_Male      | Train Loss: 2.1206 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 2.0716 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.9817 | Val  Acc: 0.2778
 Site-White_Male                    | Val  Loss: 2.0336 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 2.0120 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 2.0632 | Val  Acc: 0.2701
 Site-Black_Female                  | Val  Loss: 2.0444 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 2.0646 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 2.0406 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 2.0386 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 2.0005 | Val  Acc: 0.2576
 Site-Middle_Eastern_Male           | Val  Loss: 2.1115 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2629
============ Train epoch 9 ============
 Site-White_Male               | Train Loss: 2.0392 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.9873 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 2.0473 | Train Acc: 0.2929
 Site-White_Female             | Train Loss: 1.9802 | Train Acc: 0.3571
 Site-White_Male               | Train Loss: 2.0490 | Train Acc: 0.2605
 Site-Black_Female             | Train Loss: 2.0494 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 2.0658 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 2.0174 | Train Acc: 0.2780
 Site-Indian_Male              | Train Loss: 2.0611 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.0510 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.1139 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 2.0710 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.9619 | Val  Acc: 0.3704
 Site-White_Male                    | Val  Loss: 2.0268 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 1.9893 | Val  Acc: 0.3861
 Site-White_Male                    | Val  Loss: 2.0502 | Val  Acc: 0.2701
 Site-Black_Female                  | Val  Loss: 2.0446 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 2.0507 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 2.0232 | Val  Acc: 0.3064
 Site-Indian_Male                   | Val  Loss: 2.0217 | Val  Acc: 0.1923
 Site-Indian_Female                 | Val  Loss: 1.9766 | Val  Acc: 0.2879
 Site-Middle_Eastern_Male           | Val  Loss: 2.1099 | Val  Acc: 0.2339
Average Valid Accuracy: 0.2762
 Best site-White_Male                | Epoch:9 | Val Acc: 0.1562
 Best site-White_Female              | Epoch:9 | Val Acc: 0.3704
 Best site-White_Male                | Epoch:9 | Val Acc: 0.2688
 Best site-White_Female              | Epoch:9 | Val Acc: 0.3861
 Best site-White_Male                | Epoch:9 | Val Acc: 0.2701
 Best site-Black_Female              | Epoch:9 | Val Acc: 0.2812
 Best site-Black_Male                | Epoch:9 | Val Acc: 0.2844
 Best site-Black_Female              | Epoch:9 | Val Acc: 0.3064
 Best site-Indian_Male               | Epoch:9 | Val Acc: 0.1923
 Best site-Indian_Female             | Epoch:9 | Val Acc: 0.2879
 Best site-Middle_Eastern_Male       | Epoch:9 | Val Acc: 0.2339
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/fedavg...
 Test site-White_Male               | Epoch:9 | Test Acc: 0.3039
 Test site-White_Female             | Epoch:9 | Test Acc: 0.2440
 Test site-Black_Female             | Epoch:9 | Test Acc: 0.1569
 Test site-Black_Male               | Epoch:9 | Test Acc: 0.2237
 Test site-Indian_Male              | Epoch:9 | Test Acc: 0.2407
 Test site-Indian_Female            | Epoch:9 | Test Acc: 0.2110
 Test site-Middle_Eastern_Male      | Epoch:9 | Test Acc: 0.3142
Average Test Accuracy: 0.2421
============ Train epoch 10 ============
 Site-White_Male               | Train Loss: 2.0414 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.9559 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 2.0254 | Train Acc: 0.3357
 Site-White_Female             | Train Loss: 1.9609 | Train Acc: 0.3613
 Site-White_Male               | Train Loss: 2.0282 | Train Acc: 0.2146
 Site-Black_Female             | Train Loss: 2.0392 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.0598 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 2.0076 | Train Acc: 0.2703
 Site-Indian_Male              | Train Loss: 2.0406 | Train Acc: 0.2735
 Site-Indian_Female            | Train Loss: 2.0714 | Train Acc: 0.2563
 Site-Middle_Eastern_Male      | Train Loss: 2.1055 | Train Acc: 0.1505
 Site-White_Male                    | Val  Loss: 2.0714 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.9477 | Val  Acc: 0.3519
 Site-White_Male                    | Val  Loss: 2.0088 | Val  Acc: 0.3226
 Site-White_Female                  | Val  Loss: 1.9738 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 2.0456 | Val  Acc: 0.2471
 Site-Black_Female                  | Val  Loss: 2.0253 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 2.0423 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 2.0093 | Val  Acc: 0.3121
 Site-Indian_Male                   | Val  Loss: 1.9996 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 1.9567 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.1048 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2722
============ Train epoch 11 ============
 Site-White_Male               | Train Loss: 2.0303 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.9288 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 2.0458 | Train Acc: 0.2857
 Site-White_Female             | Train Loss: 1.9419 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 2.0287 | Train Acc: 0.2529
 Site-Black_Female             | Train Loss: 2.0054 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 2.0413 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 2.0136 | Train Acc: 0.2857
 Site-Indian_Male              | Train Loss: 2.0408 | Train Acc: 0.2479
 Site-Indian_Female            | Train Loss: 2.0188 | Train Acc: 0.2864
 Site-Middle_Eastern_Male      | Train Loss: 2.0986 | Train Acc: 0.1505
 Site-White_Male                    | Val  Loss: 2.0563 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.9320 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.9987 | Val  Acc: 0.2366
 Site-White_Female                  | Val  Loss: 1.9623 | Val  Acc: 0.3418
 Site-White_Male                    | Val  Loss: 2.0279 | Val  Acc: 0.2701
 Site-Black_Female                  | Val  Loss: 2.0138 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 2.0307 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.9967 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 1.9896 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.9354 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0815 | Val  Acc: 0.2258
Average Valid Accuracy: 0.2735
============ Train epoch 12 ============
 Site-White_Male               | Train Loss: 2.0047 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.9160 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9847 | Train Acc: 0.2929
 Site-White_Female             | Train Loss: 1.9310 | Train Acc: 0.3655
 Site-White_Male               | Train Loss: 2.0020 | Train Acc: 0.2835
 Site-Black_Female             | Train Loss: 2.0007 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.0448 | Train Acc: 0.2761
 Site-Black_Female             | Train Loss: 2.0132 | Train Acc: 0.2973
 Site-Indian_Male              | Train Loss: 2.0289 | Train Acc: 0.2393
 Site-Indian_Female            | Train Loss: 2.0402 | Train Acc: 0.2864
 Site-Middle_Eastern_Male      | Train Loss: 2.0909 | Train Acc: 0.1774
 Site-White_Male                    | Val  Loss: 2.0485 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.9188 | Val  Acc: 0.3148
 Site-White_Male                    | Val  Loss: 1.9962 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.9528 | Val  Acc: 0.3608
 Site-White_Male                    | Val  Loss: 2.0252 | Val  Acc: 0.2471
 Site-Black_Female                  | Val  Loss: 1.9913 | Val  Acc: 0.3281
 Site-Black_Male                    | Val  Loss: 2.0285 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.9956 | Val  Acc: 0.3006
 Site-Indian_Male                   | Val  Loss: 1.9868 | Val  Acc: 0.1923
 Site-Indian_Female                 | Val  Loss: 1.9388 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0810 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2639
============ Train epoch 13 ============
 Site-White_Male               | Train Loss: 1.9998 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.9124 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9675 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 1.9199 | Train Acc: 0.4076
 Site-White_Male               | Train Loss: 1.9901 | Train Acc: 0.2490
 Site-Black_Female             | Train Loss: 1.9959 | Train Acc: 0.3438
 Site-Black_Male               | Train Loss: 2.0357 | Train Acc: 0.2270
 Site-Black_Female             | Train Loss: 1.9732 | Train Acc: 0.2973
 Site-Indian_Male              | Train Loss: 2.0245 | Train Acc: 0.2308
 Site-Indian_Female            | Train Loss: 2.0586 | Train Acc: 0.2714
 Site-Middle_Eastern_Male      | Train Loss: 2.0966 | Train Acc: 0.1344
 Site-White_Male                    | Val  Loss: 2.0447 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.9017 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.9842 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.9309 | Val  Acc: 0.3987
 Site-White_Male                    | Val  Loss: 2.0182 | Val  Acc: 0.2184
 Site-Black_Female                  | Val  Loss: 1.9893 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 2.0161 | Val  Acc: 0.2569
 Site-Black_Female                  | Val  Loss: 1.9852 | Val  Acc: 0.2890
 Site-Indian_Male                   | Val  Loss: 1.9751 | Val  Acc: 0.2179
 Site-Indian_Female                 | Val  Loss: 1.9227 | Val  Acc: 0.3106
 Site-Middle_Eastern_Male           | Val  Loss: 2.0822 | Val  Acc: 0.2177
Average Valid Accuracy: 0.2754
============ Train epoch 14 ============
 Site-White_Male               | Train Loss: 1.9991 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 1.8940 | Train Acc: 0.3537
 Site-White_Male               | Train Loss: 2.0124 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.9025 | Train Acc: 0.3908
 Site-White_Male               | Train Loss: 2.0393 | Train Acc: 0.2261
 Site-Black_Female             | Train Loss: 1.9779 | Train Acc: 0.3021
 Site-Black_Male               | Train Loss: 2.0311 | Train Acc: 0.2515
 Site-Black_Female             | Train Loss: 1.9613 | Train Acc: 0.2896
 Site-Indian_Male              | Train Loss: 2.0153 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 1.9898 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0895 | Train Acc: 0.1452
 Site-White_Male                    | Val  Loss: 2.0341 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.9023 | Val  Acc: 0.3519
 Site-White_Male                    | Val  Loss: 1.9635 | Val  Acc: 0.2581
 Site-White_Female                  | Val  Loss: 1.9261 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.0100 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 2.0014 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 2.0052 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.9793 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 1.9613 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 1.9095 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0713 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2669
============ Train epoch 15 ============
 Site-White_Male               | Train Loss: 1.9979 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.8800 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9777 | Train Acc: 0.2714
 Site-White_Female             | Train Loss: 1.9012 | Train Acc: 0.3908
 Site-White_Male               | Train Loss: 1.9797 | Train Acc: 0.2490
 Site-Black_Female             | Train Loss: 1.9825 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 2.0193 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.9846 | Train Acc: 0.2973
 Site-Indian_Male              | Train Loss: 2.0087 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.0388 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.0786 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 2.0279 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.8804 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.9570 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.9122 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.0054 | Val  Acc: 0.2184
 Site-Black_Female                  | Val  Loss: 1.9800 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9959 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.9672 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.9527 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 1.8812 | Val  Acc: 0.3182
 Site-Middle_Eastern_Male           | Val  Loss: 2.0695 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2621
============ Train epoch 16 ============
 Site-White_Male               | Train Loss: 1.9758 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.8050 | Train Acc: 0.3537
 Site-White_Male               | Train Loss: 2.0260 | Train Acc: 0.2714
 Site-White_Female             | Train Loss: 1.8783 | Train Acc: 0.3908
 Site-White_Male               | Train Loss: 1.9143 | Train Acc: 0.2682
 Site-Black_Female             | Train Loss: 1.9786 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.0179 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.8874 | Train Acc: 0.2896
 Site-Indian_Male              | Train Loss: 2.0028 | Train Acc: 0.2308
 Site-Indian_Female            | Train Loss: 1.9952 | Train Acc: 0.2663
 Site-Middle_Eastern_Male      | Train Loss: 2.0776 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 2.0166 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.8605 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.9491 | Val  Acc: 0.2903
 Site-White_Female                  | Val  Loss: 1.9025 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.0103 | Val  Acc: 0.2011
 Site-Black_Female                  | Val  Loss: 1.9753 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9923 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.9596 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.9430 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.8911 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0683 | Val  Acc: 0.2177
Average Valid Accuracy: 0.2690
============ Train epoch 17 ============
 Site-White_Male               | Train Loss: 1.9796 | Train Acc: 0.2708
 Site-White_Female             | Train Loss: 1.8223 | Train Acc: 0.4024
 Site-White_Male               | Train Loss: 1.9960 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.8737 | Train Acc: 0.3739
 Site-White_Male               | Train Loss: 1.9949 | Train Acc: 0.2490
 Site-Black_Female             | Train Loss: 1.9695 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 2.0206 | Train Acc: 0.2577
 Site-Black_Female             | Train Loss: 1.9508 | Train Acc: 0.2934
 Site-Indian_Male              | Train Loss: 2.0016 | Train Acc: 0.2393
 Site-Indian_Female            | Train Loss: 2.0131 | Train Acc: 0.2663
 Site-Middle_Eastern_Male      | Train Loss: 2.0764 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 2.0186 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.8630 | Val  Acc: 0.4074
 Site-White_Male                    | Val  Loss: 1.9496 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.9061 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 1.9871 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 1.9554 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9793 | Val  Acc: 0.3028
 Site-Black_Female                  | Val  Loss: 1.9453 | Val  Acc: 0.2601
 Site-Indian_Male                   | Val  Loss: 1.9473 | Val  Acc: 0.1538
 Site-Indian_Female                 | Val  Loss: 1.8647 | Val  Acc: 0.3106
 Site-Middle_Eastern_Male           | Val  Loss: 2.0590 | Val  Acc: 0.2097
Average Valid Accuracy: 0.2662
============ Train epoch 18 ============
 Site-White_Male               | Train Loss: 1.9572 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.9087 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9399 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.8676 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 1.9715 | Train Acc: 0.2414
 Site-Black_Female             | Train Loss: 1.9661 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 1.9968 | Train Acc: 0.2515
 Site-Black_Female             | Train Loss: 1.9471 | Train Acc: 0.2896
 Site-Indian_Male              | Train Loss: 1.9920 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.0199 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.0761 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 2.0108 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.8512 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.9335 | Val  Acc: 0.2366
 Site-White_Female                  | Val  Loss: 1.8950 | Val  Acc: 0.3861
 Site-White_Male                    | Val  Loss: 1.9907 | Val  Acc: 0.2356
 Site-Black_Female                  | Val  Loss: 1.9590 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9655 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.9435 | Val  Acc: 0.2659
 Site-Indian_Male                   | Val  Loss: 1.9313 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.8702 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0615 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2678
============ Train epoch 19 ============
 Site-White_Male               | Train Loss: 1.9703 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.8132 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9734 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.8602 | Train Acc: 0.3697
 Site-White_Male               | Train Loss: 1.9637 | Train Acc: 0.2414
 Site-Black_Female             | Train Loss: 1.9581 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9935 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.9909 | Train Acc: 0.2973
 Site-Indian_Male              | Train Loss: 1.9869 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 1.9978 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.0747 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 2.0047 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.8290 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.9365 | Val  Acc: 0.2366
 Site-White_Female                  | Val  Loss: 1.8821 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 1.9823 | Val  Acc: 0.2241
 Site-Black_Female                  | Val  Loss: 1.9571 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9761 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.9366 | Val  Acc: 0.2948
 Site-Indian_Male                   | Val  Loss: 1.9260 | Val  Acc: 0.1538
 Site-Indian_Female                 | Val  Loss: 1.8635 | Val  Acc: 0.3106
 Site-Middle_Eastern_Male           | Val  Loss: 2.0549 | Val  Acc: 0.1855
Average Valid Accuracy: 0.2675
============ Train epoch 20 ============
 Site-White_Male               | Train Loss: 1.9519 | Train Acc: 0.2292
 Site-White_Female             | Train Loss: 1.8344 | Train Acc: 0.3659
 Site-White_Male               | Train Loss: 1.9829 | Train Acc: 0.2857
 Site-White_Female             | Train Loss: 1.8370 | Train Acc: 0.3992
 Site-White_Male               | Train Loss: 2.0094 | Train Acc: 0.2529
 Site-Black_Female             | Train Loss: 1.9149 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9801 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 1.9275 | Train Acc: 0.2934
 Site-Indian_Male              | Train Loss: 1.9817 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 2.0182 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.0550 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 1.9927 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.8292 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.9301 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.8628 | Val  Acc: 0.3608
 Site-White_Male                    | Val  Loss: 1.9729 | Val  Acc: 0.2241
 Site-Black_Female                  | Val  Loss: 1.9625 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9730 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.9342 | Val  Acc: 0.2717
 Site-Indian_Male                   | Val  Loss: 1.9172 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.8447 | Val  Acc: 0.2879
 Site-Middle_Eastern_Male           | Val  Loss: 2.0574 | Val  Acc: 0.1532
Average Valid Accuracy: 0.2651
============ Train epoch 21 ============
 Site-White_Male               | Train Loss: 1.9445 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.8274 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9478 | Train Acc: 0.2571
 Site-White_Female             | Train Loss: 1.8299 | Train Acc: 0.3992
 Site-White_Male               | Train Loss: 1.9285 | Train Acc: 0.2644
 Site-Black_Female             | Train Loss: 1.9270 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9745 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.9880 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.9824 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 2.0063 | Train Acc: 0.2864
 Site-Middle_Eastern_Male      | Train Loss: 2.0601 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 1.9724 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.8152 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.9267 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.8627 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 1.9686 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 1.9370 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9657 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.9264 | Val  Acc: 0.2717
 Site-Indian_Male                   | Val  Loss: 1.9152 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 1.8335 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0462 | Val  Acc: 0.1855
Average Valid Accuracy: 0.2698
============ Train epoch 22 ============
 Site-White_Male               | Train Loss: 1.9529 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.7608 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9616 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.8274 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 2.0098 | Train Acc: 0.2644
 Site-Black_Female             | Train Loss: 1.8955 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9859 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.8466 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.9705 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.0113 | Train Acc: 0.2714
 Site-Middle_Eastern_Male      | Train Loss: 2.0501 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 1.9785 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.8120 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8909 | Val  Acc: 0.2581
 Site-White_Female                  | Val  Loss: 1.8561 | Val  Acc: 0.3671
 Site-White_Male                    | Val  Loss: 1.9653 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 1.9366 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9663 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.9068 | Val  Acc: 0.2717
 Site-Indian_Male                   | Val  Loss: 1.9032 | Val  Acc: 0.1667
 Site-Indian_Female                 | Val  Loss: 1.8467 | Val  Acc: 0.3106
 Site-Middle_Eastern_Male           | Val  Loss: 2.0479 | Val  Acc: 0.1694
Average Valid Accuracy: 0.2686
============ Train epoch 23 ============
 Site-White_Male               | Train Loss: 1.9268 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.8116 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9167 | Train Acc: 0.2857
 Site-White_Female             | Train Loss: 1.8134 | Train Acc: 0.3908
 Site-White_Male               | Train Loss: 1.9364 | Train Acc: 0.2605
 Site-Black_Female             | Train Loss: 1.9150 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 1.9745 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 1.9727 | Train Acc: 0.2973
 Site-Indian_Male              | Train Loss: 1.9776 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 1.9788 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0514 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 1.9739 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.8050 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.9079 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.8443 | Val  Acc: 0.3481
 Site-White_Male                    | Val  Loss: 1.9627 | Val  Acc: 0.2126
 Site-Black_Female                  | Val  Loss: 1.9219 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9452 | Val  Acc: 0.3028
 Site-Black_Female                  | Val  Loss: 1.9157 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 1.8960 | Val  Acc: 0.1795
 Site-Indian_Female                 | Val  Loss: 1.8122 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0355 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2647
============ Train epoch 24 ============
 Site-White_Male               | Train Loss: 1.9285 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.7972 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 2.0222 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.8141 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 1.9024 | Train Acc: 0.2529
 Site-Black_Female             | Train Loss: 1.8963 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9581 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 1.8594 | Train Acc: 0.2934
 Site-Indian_Male              | Train Loss: 1.9596 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 2.0129 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0380 | Train Acc: 0.1613
 Site-White_Male                    | Val  Loss: 1.9796 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7789 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.9048 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.8516 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 1.9585 | Val  Acc: 0.2356
 Site-Black_Female                  | Val  Loss: 1.9369 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9486 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.9115 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.8831 | Val  Acc: 0.1923
 Site-Indian_Female                 | Val  Loss: 1.8264 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0462 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2699
============ Train epoch 25 ============
 Site-White_Male               | Train Loss: 1.9275 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.7771 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9438 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.8216 | Train Acc: 0.3992
 Site-White_Male               | Train Loss: 1.9124 | Train Acc: 0.2605
 Site-Black_Female             | Train Loss: 1.9248 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 1.9642 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 1.9526 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.9517 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 1.9096 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0447 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 1.9783 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7923 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.9066 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 1.8425 | Val  Acc: 0.3608
 Site-White_Male                    | Val  Loss: 1.9560 | Val  Acc: 0.2126
 Site-Black_Female                  | Val  Loss: 1.9086 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9453 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.9109 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.8822 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.8168 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.0348 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2683
============ Train epoch 26 ============
 Site-White_Male               | Train Loss: 1.9019 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.8059 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 2.0010 | Train Acc: 0.2929
 Site-White_Female             | Train Loss: 1.7968 | Train Acc: 0.3950
 Site-White_Male               | Train Loss: 1.9237 | Train Acc: 0.2567
 Site-Black_Female             | Train Loss: 1.9061 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9431 | Train Acc: 0.2454
 Site-Black_Female             | Train Loss: 1.9324 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.9519 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 1.9617 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0439 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 1.9678 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7768 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8917 | Val  Acc: 0.2366
 Site-White_Female                  | Val  Loss: 1.8256 | Val  Acc: 0.3671
 Site-White_Male                    | Val  Loss: 1.9428 | Val  Acc: 0.2184
 Site-Black_Female                  | Val  Loss: 1.9171 | Val  Acc: 0.2344
 Site-Black_Male                    | Val  Loss: 1.9380 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.9128 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.8841 | Val  Acc: 0.2179
 Site-Indian_Female                 | Val  Loss: 1.8021 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0338 | Val  Acc: 0.1694
Average Valid Accuracy: 0.2662
============ Train epoch 27 ============
 Site-White_Male               | Train Loss: 1.9345 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.7236 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9834 | Train Acc: 0.2571
 Site-White_Female             | Train Loss: 1.8014 | Train Acc: 0.3950
 Site-White_Male               | Train Loss: 1.9687 | Train Acc: 0.2567
 Site-Black_Female             | Train Loss: 1.9123 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9670 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.9190 | Train Acc: 0.3050
 Site-Indian_Male              | Train Loss: 1.9462 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 1.9171 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0410 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 1.9604 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.7816 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8857 | Val  Acc: 0.2796
 Site-White_Female                  | Val  Loss: 1.8317 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 1.9444 | Val  Acc: 0.2126
 Site-Black_Female                  | Val  Loss: 1.9075 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9316 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8937 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 1.8843 | Val  Acc: 0.2051
 Site-Indian_Female                 | Val  Loss: 1.8205 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0292 | Val  Acc: 0.1855
Average Valid Accuracy: 0.2685
============ Train epoch 28 ============
 Site-White_Male               | Train Loss: 1.9107 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.6263 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9032 | Train Acc: 0.2786
 Site-White_Female             | Train Loss: 1.7783 | Train Acc: 0.3782
 Site-White_Male               | Train Loss: 1.8891 | Train Acc: 0.2529
 Site-Black_Female             | Train Loss: 1.8973 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9535 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 1.9222 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.9464 | Train Acc: 0.2393
 Site-Indian_Female            | Train Loss: 2.0458 | Train Acc: 0.2814
 Site-Middle_Eastern_Male      | Train Loss: 2.0397 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 1.9473 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7757 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.8787 | Val  Acc: 0.2581
 Site-White_Female                  | Val  Loss: 1.8177 | Val  Acc: 0.3481
 Site-White_Male                    | Val  Loss: 1.9393 | Val  Acc: 0.2356
 Site-Black_Female                  | Val  Loss: 1.9008 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9334 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8918 | Val  Acc: 0.2717
 Site-Indian_Male                   | Val  Loss: 1.8708 | Val  Acc: 0.1923
 Site-Indian_Female                 | Val  Loss: 1.8041 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.0269 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2691
============ Train epoch 29 ============
 Site-White_Male               | Train Loss: 1.9166 | Train Acc: 0.2708
 Site-White_Female             | Train Loss: 1.7487 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.8489 | Train Acc: 0.2571
 Site-White_Female             | Train Loss: 1.7895 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 1.9638 | Train Acc: 0.2452
 Site-Black_Female             | Train Loss: 1.8815 | Train Acc: 0.3333
 Site-Black_Male               | Train Loss: 1.9567 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 1.8902 | Train Acc: 0.3050
 Site-Indian_Male              | Train Loss: 1.9357 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 1.9841 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 2.0328 | Train Acc: 0.1452
 Site-White_Male                    | Val  Loss: 1.9500 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7839 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.8788 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 1.8049 | Val  Acc: 0.3671
 Site-White_Male                    | Val  Loss: 1.9288 | Val  Acc: 0.2471
 Site-Black_Female                  | Val  Loss: 1.9255 | Val  Acc: 0.2500
 Site-Black_Male                    | Val  Loss: 1.9349 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8851 | Val  Acc: 0.2659
 Site-Indian_Male                   | Val  Loss: 1.8630 | Val  Acc: 0.2179
 Site-Indian_Female                 | Val  Loss: 1.7888 | Val  Acc: 0.3106
 Site-Middle_Eastern_Male           | Val  Loss: 2.0277 | Val  Acc: 0.1694
Average Valid Accuracy: 0.2739
===2023-05-24 11:45:14===
===2023-05-24 11:45:30===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[48,82,140,238,261,96,163,259,117,199,186,]
client_nums=[5,3,2,1,]
domain number = -1
Loading snapshots...
 Test site-White_Male               | Epoch:9 | Test Acc: 0.3039
 Test site-White_Female             | Epoch:9 | Test Acc: 0.2440
 Test site-Black_Female             | Epoch:9 | Test Acc: 0.1569
 Test site-Black_Male               | Epoch:9 | Test Acc: 0.2237
 Test site-Indian_Male              | Epoch:9 | Test Acc: 0.2407
 Test site-Indian_Female            | Epoch:9 | Test Acc: 0.2110
 Test site-Middle_Eastern_Male      | Epoch:9 | Test Acc: 0.3142
Average Test Accuracy: 0.2421
