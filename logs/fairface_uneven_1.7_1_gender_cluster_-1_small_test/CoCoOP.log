===2023-05-23 20:33:52===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 30
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[48,82,140,238,261,96,163,259,117,199,186,]
client_nums=[5,3,2,1,]
domain number = -1
============ Train epoch 0 ============
===2023-05-23 21:20:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 30
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[48,82,140,238,261,96,163,259,117,199,186,]
client_nums=[5,3,2,1,]
domain number = -1
============ Train epoch 0 ============
 Site-White_Male               | Train Loss: 1.9857 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.7877 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 2.0195 | Train Acc: 0.2500
 Site-White_Female             | Train Loss: 1.7858 | Train Acc: 0.3950
 Site-White_Male               | Train Loss: 2.0035 | Train Acc: 0.2567
 Site-Black_Female             | Train Loss: 1.9252 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 2.0187 | Train Acc: 0.2393
 Site-Black_Female             | Train Loss: 1.9867 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 2.0760 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.1747 | Train Acc: 0.2864
 Site-Middle_Eastern_Male      | Train Loss: 2.2326 | Train Acc: 0.1559
 Site-White_Male                    | Val  Loss: 2.0603 | Val  Acc: 0.1250
 Site-White_Female                  | Val  Loss: 1.7284 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.9543 | Val  Acc: 0.2473
 Site-White_Female                  | Val  Loss: 1.8626 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.0745 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 1.9159 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 1.9961 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.9312 | Val  Acc: 0.2890
 Site-Indian_Male                   | Val  Loss: 1.8977 | Val  Acc: 0.2436
 Site-Indian_Female                 | Val  Loss: 1.8387 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.2238 | Val  Acc: 0.1532
Average Valid Accuracy: 0.2706
 Best site-White_Male                | Epoch:0 | Val Acc: 0.1250
 Best site-White_Female              | Epoch:0 | Val Acc: 0.4444
 Best site-White_Male                | Epoch:0 | Val Acc: 0.2473
 Best site-White_Female              | Epoch:0 | Val Acc: 0.3544
 Best site-White_Male                | Epoch:0 | Val Acc: 0.2414
 Best site-Black_Female              | Epoch:0 | Val Acc: 0.2812
 Best site-Black_Male                | Epoch:0 | Val Acc: 0.2936
 Best site-Black_Female              | Epoch:0 | Val Acc: 0.2890
 Best site-Indian_Male               | Epoch:0 | Val Acc: 0.2436
 Best site-Indian_Female             | Epoch:0 | Val Acc: 0.3030
 Best site-Middle_Eastern_Male       | Epoch:0 | Val Acc: 0.1532
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 1 ============
 Site-White_Male               | Train Loss: 1.9371 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.7714 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 2.0238 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.7851 | Train Acc: 0.3992
 Site-White_Male               | Train Loss: 1.9237 | Train Acc: 0.2452
 Site-Black_Female             | Train Loss: 1.8883 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 2.0008 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 1.9734 | Train Acc: 0.2896
 Site-Indian_Male              | Train Loss: 2.0113 | Train Acc: 0.2051
 Site-Indian_Female            | Train Loss: 2.0355 | Train Acc: 0.2663
 Site-Middle_Eastern_Male      | Train Loss: 2.1646 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 2.0030 | Val  Acc: 0.1562
 Site-White_Female                  | Val  Loss: 1.7601 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.9124 | Val  Acc: 0.2796
 Site-White_Female                  | Val  Loss: 1.8535 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 2.0088 | Val  Acc: 0.2586
 Site-Black_Female                  | Val  Loss: 1.9092 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 1.9599 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8990 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.8737 | Val  Acc: 0.2692
 Site-Indian_Female                 | Val  Loss: 1.8197 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.1745 | Val  Acc: 0.1694
Average Valid Accuracy: 0.2811
 Best site-White_Male                | Epoch:1 | Val Acc: 0.1562
 Best site-White_Female              | Epoch:1 | Val Acc: 0.4444
 Best site-White_Male                | Epoch:1 | Val Acc: 0.2796
 Best site-White_Female              | Epoch:1 | Val Acc: 0.3544
 Best site-White_Male                | Epoch:1 | Val Acc: 0.2586
 Best site-Black_Female              | Epoch:1 | Val Acc: 0.2969
 Best site-Black_Male                | Epoch:1 | Val Acc: 0.2844
 Best site-Black_Female              | Epoch:1 | Val Acc: 0.2832
 Best site-Indian_Male               | Epoch:1 | Val Acc: 0.2692
 Best site-Indian_Female             | Epoch:1 | Val Acc: 0.2955
 Best site-Middle_Eastern_Male       | Epoch:1 | Val Acc: 0.1694
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 2 ============
 Site-White_Male               | Train Loss: 1.9071 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.7411 | Train Acc: 0.3537
 Site-White_Male               | Train Loss: 1.9459 | Train Acc: 0.2429
 Site-White_Female             | Train Loss: 1.7496 | Train Acc: 0.3950
 Site-White_Male               | Train Loss: 1.9469 | Train Acc: 0.2644
 Site-Black_Female             | Train Loss: 1.8652 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 1.9443 | Train Acc: 0.2331
 Site-Black_Female             | Train Loss: 1.8834 | Train Acc: 0.2819
 Site-Indian_Male              | Train Loss: 2.0050 | Train Acc: 0.2393
 Site-Indian_Female            | Train Loss: 2.0535 | Train Acc: 0.2563
 Site-Middle_Eastern_Male      | Train Loss: 2.1096 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 1.9658 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.7415 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8768 | Val  Acc: 0.2581
 Site-White_Female                  | Val  Loss: 1.8285 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 1.9751 | Val  Acc: 0.2414
 Site-Black_Female                  | Val  Loss: 1.8950 | Val  Acc: 0.2656
 Site-Black_Male                    | Val  Loss: 1.9005 | Val  Acc: 0.2661
 Site-Black_Female                  | Val  Loss: 1.8901 | Val  Acc: 0.3006
 Site-Indian_Male                   | Val  Loss: 1.8536 | Val  Acc: 0.2949
 Site-Indian_Female                 | Val  Loss: 1.8360 | Val  Acc: 0.2803
 Site-Middle_Eastern_Male           | Val  Loss: 2.1127 | Val  Acc: 0.1613
Average Valid Accuracy: 0.2788
============ Train epoch 3 ============
 Site-White_Male               | Train Loss: 1.9029 | Train Acc: 0.2708
 Site-White_Female             | Train Loss: 1.7557 | Train Acc: 0.3537
 Site-White_Male               | Train Loss: 1.9351 | Train Acc: 0.2714
 Site-White_Female             | Train Loss: 1.7432 | Train Acc: 0.3866
 Site-White_Male               | Train Loss: 1.9456 | Train Acc: 0.2720
 Site-Black_Female             | Train Loss: 1.8766 | Train Acc: 0.2812
 Site-Black_Male               | Train Loss: 1.9428 | Train Acc: 0.2270
 Site-Black_Female             | Train Loss: 1.7608 | Train Acc: 0.2934
 Site-Indian_Male              | Train Loss: 1.9859 | Train Acc: 0.2308
 Site-Indian_Female            | Train Loss: 2.0225 | Train Acc: 0.2462
 Site-Middle_Eastern_Male      | Train Loss: 2.0760 | Train Acc: 0.1935
 Site-White_Male                    | Val  Loss: 1.9536 | Val  Acc: 0.3125
 Site-White_Female                  | Val  Loss: 1.7282 | Val  Acc: 0.4074
 Site-White_Male                    | Val  Loss: 1.8484 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 1.8039 | Val  Acc: 0.3291
 Site-White_Male                    | Val  Loss: 1.9543 | Val  Acc: 0.2644
 Site-Black_Female                  | Val  Loss: 1.8375 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 1.8988 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.8657 | Val  Acc: 0.2601
 Site-Indian_Male                   | Val  Loss: 1.8310 | Val  Acc: 0.2692
 Site-Indian_Female                 | Val  Loss: 1.8094 | Val  Acc: 0.3182
 Site-Middle_Eastern_Male           | Val  Loss: 2.0950 | Val  Acc: 0.2097
Average Valid Accuracy: 0.2905
 Best site-White_Male                | Epoch:3 | Val Acc: 0.3125
 Best site-White_Female              | Epoch:3 | Val Acc: 0.4074
 Best site-White_Male                | Epoch:3 | Val Acc: 0.2688
 Best site-White_Female              | Epoch:3 | Val Acc: 0.3291
 Best site-White_Male                | Epoch:3 | Val Acc: 0.2644
 Best site-Black_Female              | Epoch:3 | Val Acc: 0.2812
 Best site-Black_Male                | Epoch:3 | Val Acc: 0.2752
 Best site-Black_Female              | Epoch:3 | Val Acc: 0.2601
 Best site-Indian_Male               | Epoch:3 | Val Acc: 0.2692
 Best site-Indian_Female             | Epoch:3 | Val Acc: 0.3182
 Best site-Middle_Eastern_Male       | Epoch:3 | Val Acc: 0.2097
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 4 ============
 Site-White_Male               | Train Loss: 1.8854 | Train Acc: 0.3125
 Site-White_Female             | Train Loss: 1.6744 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.8608 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.7296 | Train Acc: 0.3950
 Site-White_Male               | Train Loss: 1.7942 | Train Acc: 0.3027
 Site-Black_Female             | Train Loss: 1.8373 | Train Acc: 0.3125
 Site-Black_Male               | Train Loss: 1.9047 | Train Acc: 0.2270
 Site-Black_Female             | Train Loss: 1.9089 | Train Acc: 0.3050
 Site-Indian_Male              | Train Loss: 1.9474 | Train Acc: 0.2137
 Site-Indian_Female            | Train Loss: 2.0255 | Train Acc: 0.2563
 Site-Middle_Eastern_Male      | Train Loss: 2.0654 | Train Acc: 0.1828
 Site-White_Male                    | Val  Loss: 1.9386 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.7287 | Val  Acc: 0.4630
 Site-White_Male                    | Val  Loss: 1.8447 | Val  Acc: 0.2903
 Site-White_Female                  | Val  Loss: 1.8071 | Val  Acc: 0.3228
 Site-White_Male                    | Val  Loss: 1.9123 | Val  Acc: 0.2816
 Site-Black_Female                  | Val  Loss: 1.8362 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 1.8892 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8449 | Val  Acc: 0.2832
 Site-Indian_Male                   | Val  Loss: 1.8197 | Val  Acc: 0.2821
 Site-Indian_Female                 | Val  Loss: 1.7938 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.0535 | Val  Acc: 0.1694
Average Valid Accuracy: 0.2898
============ Train epoch 5 ============
 Site-White_Male               | Train Loss: 1.8685 | Train Acc: 0.3750
 Site-White_Female             | Train Loss: 1.6070 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.8539 | Train Acc: 0.2429
 Site-White_Female             | Train Loss: 1.7149 | Train Acc: 0.3824
 Site-White_Male               | Train Loss: 1.8265 | Train Acc: 0.2874
 Site-Black_Female             | Train Loss: 1.8443 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 1.9083 | Train Acc: 0.2515
 Site-Black_Female             | Train Loss: 1.7535 | Train Acc: 0.2819
 Site-Indian_Male              | Train Loss: 1.9440 | Train Acc: 0.2308
 Site-Indian_Female            | Train Loss: 2.0110 | Train Acc: 0.2764
 Site-Middle_Eastern_Male      | Train Loss: 1.9959 | Train Acc: 0.2258
 Site-White_Male                    | Val  Loss: 1.9229 | Val  Acc: 0.2500
 Site-White_Female                  | Val  Loss: 1.7414 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.8268 | Val  Acc: 0.2796
 Site-White_Female                  | Val  Loss: 1.8004 | Val  Acc: 0.3354
 Site-White_Male                    | Val  Loss: 1.9089 | Val  Acc: 0.2931
 Site-Black_Female                  | Val  Loss: 1.8358 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.8895 | Val  Acc: 0.2569
 Site-Black_Female                  | Val  Loss: 1.8313 | Val  Acc: 0.2601
 Site-Indian_Male                   | Val  Loss: 1.7996 | Val  Acc: 0.2949
 Site-Indian_Female                 | Val  Loss: 1.7981 | Val  Acc: 0.2955
 Site-Middle_Eastern_Male           | Val  Loss: 2.0459 | Val  Acc: 0.1774
Average Valid Accuracy: 0.2952
 Best site-White_Male                | Epoch:5 | Val Acc: 0.2500
 Best site-White_Female              | Epoch:5 | Val Acc: 0.4444
 Best site-White_Male                | Epoch:5 | Val Acc: 0.2796
 Best site-White_Female              | Epoch:5 | Val Acc: 0.3354
 Best site-White_Male                | Epoch:5 | Val Acc: 0.2931
 Best site-Black_Female              | Epoch:5 | Val Acc: 0.3594
 Best site-Black_Male                | Epoch:5 | Val Acc: 0.2569
 Best site-Black_Female              | Epoch:5 | Val Acc: 0.2601
 Best site-Indian_Male               | Epoch:5 | Val Acc: 0.2949
 Best site-Indian_Female             | Epoch:5 | Val Acc: 0.2955
 Best site-Middle_Eastern_Male       | Epoch:5 | Val Acc: 0.1774
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 6 ============
 Site-White_Male               | Train Loss: 1.8272 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.6095 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.9505 | Train Acc: 0.2643
 Site-White_Female             | Train Loss: 1.6855 | Train Acc: 0.4034
 Site-White_Male               | Train Loss: 1.8526 | Train Acc: 0.2452
 Site-Black_Female             | Train Loss: 1.8151 | Train Acc: 0.3229
 Site-Black_Male               | Train Loss: 1.9503 | Train Acc: 0.2515
 Site-Black_Female             | Train Loss: 1.7716 | Train Acc: 0.3243
 Site-Indian_Male              | Train Loss: 1.9577 | Train Acc: 0.2222
 Site-Indian_Female            | Train Loss: 2.0154 | Train Acc: 0.2714
 Site-Middle_Eastern_Male      | Train Loss: 1.9890 | Train Acc: 0.1667
 Site-White_Male                    | Val  Loss: 1.8935 | Val  Acc: 0.1875
 Site-White_Female                  | Val  Loss: 1.7161 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8095 | Val  Acc: 0.2688
 Site-White_Female                  | Val  Loss: 1.7893 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 1.8912 | Val  Acc: 0.2759
 Site-Black_Female                  | Val  Loss: 1.8261 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 1.8997 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.8522 | Val  Acc: 0.2659
 Site-Indian_Male                   | Val  Loss: 1.7968 | Val  Acc: 0.2821
 Site-Indian_Female                 | Val  Loss: 1.7794 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 2.0203 | Val  Acc: 0.2016
Average Valid Accuracy: 0.2846
============ Train epoch 7 ============
 Site-White_Male               | Train Loss: 1.8467 | Train Acc: 0.3542
 Site-White_Female             | Train Loss: 1.6985 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.8991 | Train Acc: 0.2929
 Site-White_Female             | Train Loss: 1.6797 | Train Acc: 0.4118
 Site-White_Male               | Train Loss: 1.8317 | Train Acc: 0.2912
 Site-Black_Female             | Train Loss: 1.7780 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 1.8988 | Train Acc: 0.2270
 Site-Black_Female             | Train Loss: 1.7002 | Train Acc: 0.3282
 Site-Indian_Male              | Train Loss: 1.9149 | Train Acc: 0.2393
 Site-Indian_Female            | Train Loss: 1.8532 | Train Acc: 0.2714
 Site-Middle_Eastern_Male      | Train Loss: 1.9499 | Train Acc: 0.2097
 Site-White_Male                    | Val  Loss: 1.8513 | Val  Acc: 0.2188
 Site-White_Female                  | Val  Loss: 1.7147 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.8148 | Val  Acc: 0.3118
 Site-White_Female                  | Val  Loss: 1.7658 | Val  Acc: 0.3418
 Site-White_Male                    | Val  Loss: 1.8580 | Val  Acc: 0.2759
 Site-Black_Female                  | Val  Loss: 1.8209 | Val  Acc: 0.2969
 Site-Black_Male                    | Val  Loss: 1.8876 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.8300 | Val  Acc: 0.2197
 Site-Indian_Male                   | Val  Loss: 1.7499 | Val  Acc: 0.3205
 Site-Indian_Female                 | Val  Loss: 1.7353 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 1.9997 | Val  Acc: 0.1935
Average Valid Accuracy: 0.2910
============ Train epoch 8 ============
 Site-White_Male               | Train Loss: 1.8130 | Train Acc: 0.2917
 Site-White_Female             | Train Loss: 1.6853 | Train Acc: 0.4146
 Site-White_Male               | Train Loss: 1.8206 | Train Acc: 0.3000
 Site-White_Female             | Train Loss: 1.6454 | Train Acc: 0.4328
 Site-White_Male               | Train Loss: 1.7679 | Train Acc: 0.2682
 Site-Black_Female             | Train Loss: 1.8099 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 1.8690 | Train Acc: 0.2883
 Site-Black_Female             | Train Loss: 1.7812 | Train Acc: 0.3436
 Site-Indian_Male              | Train Loss: 1.8778 | Train Acc: 0.2564
 Site-Indian_Female            | Train Loss: 1.8597 | Train Acc: 0.2965
 Site-Middle_Eastern_Male      | Train Loss: 1.9239 | Train Acc: 0.2043
 Site-White_Male                    | Val  Loss: 1.8252 | Val  Acc: 0.2500
 Site-White_Female                  | Val  Loss: 1.6995 | Val  Acc: 0.4074
 Site-White_Male                    | Val  Loss: 1.7868 | Val  Acc: 0.2796
 Site-White_Female                  | Val  Loss: 1.7611 | Val  Acc: 0.3354
 Site-White_Male                    | Val  Loss: 1.8505 | Val  Acc: 0.3046
 Site-Black_Female                  | Val  Loss: 1.8169 | Val  Acc: 0.3125
 Site-Black_Male                    | Val  Loss: 1.8610 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.8022 | Val  Acc: 0.2948
 Site-Indian_Male                   | Val  Loss: 1.7146 | Val  Acc: 0.3462
 Site-Indian_Female                 | Val  Loss: 1.7234 | Val  Acc: 0.2727
 Site-Middle_Eastern_Male           | Val  Loss: 1.9757 | Val  Acc: 0.1935
Average Valid Accuracy: 0.2991
 Best site-White_Male                | Epoch:8 | Val Acc: 0.2500
 Best site-White_Female              | Epoch:8 | Val Acc: 0.4074
 Best site-White_Male                | Epoch:8 | Val Acc: 0.2796
 Best site-White_Female              | Epoch:8 | Val Acc: 0.3354
 Best site-White_Male                | Epoch:8 | Val Acc: 0.3046
 Best site-Black_Female              | Epoch:8 | Val Acc: 0.3125
 Best site-Black_Male                | Epoch:8 | Val Acc: 0.2936
 Best site-Black_Female              | Epoch:8 | Val Acc: 0.2948
 Best site-Indian_Male               | Epoch:8 | Val Acc: 0.3462
 Best site-Indian_Female             | Epoch:8 | Val Acc: 0.2727
 Best site-Middle_Eastern_Male       | Epoch:8 | Val Acc: 0.1935
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 9 ============
 Site-White_Male               | Train Loss: 1.7506 | Train Acc: 0.3958
 Site-White_Female             | Train Loss: 1.6059 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.7658 | Train Acc: 0.3429
 Site-White_Female             | Train Loss: 1.6466 | Train Acc: 0.4160
 Site-White_Male               | Train Loss: 1.7019 | Train Acc: 0.3333
 Site-Black_Female             | Train Loss: 1.7678 | Train Acc: 0.3021
 Site-Black_Male               | Train Loss: 1.8699 | Train Acc: 0.2699
 Site-Black_Female             | Train Loss: 1.7662 | Train Acc: 0.3127
 Site-Indian_Male              | Train Loss: 1.8560 | Train Acc: 0.2991
 Site-Indian_Female            | Train Loss: 1.7681 | Train Acc: 0.3216
 Site-Middle_Eastern_Male      | Train Loss: 1.7974 | Train Acc: 0.2957
 Site-White_Male                    | Val  Loss: 1.7695 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.7226 | Val  Acc: 0.3704
 Site-White_Male                    | Val  Loss: 1.7648 | Val  Acc: 0.3656
 Site-White_Female                  | Val  Loss: 1.7672 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 1.7782 | Val  Acc: 0.3276
 Site-Black_Female                  | Val  Loss: 1.7886 | Val  Acc: 0.4219
 Site-Black_Male                    | Val  Loss: 1.8410 | Val  Acc: 0.2661
 Site-Black_Female                  | Val  Loss: 1.7848 | Val  Acc: 0.2717
 Site-Indian_Male                   | Val  Loss: 1.6771 | Val  Acc: 0.3718
 Site-Indian_Female                 | Val  Loss: 1.7283 | Val  Acc: 0.3030
 Site-Middle_Eastern_Male           | Val  Loss: 1.8945 | Val  Acc: 0.2419
Average Valid Accuracy: 0.3364
 Best site-White_Male                | Epoch:9 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:9 | Val Acc: 0.3704
 Best site-White_Male                | Epoch:9 | Val Acc: 0.3656
 Best site-White_Female              | Epoch:9 | Val Acc: 0.3544
 Best site-White_Male                | Epoch:9 | Val Acc: 0.3276
 Best site-Black_Female              | Epoch:9 | Val Acc: 0.4219
 Best site-Black_Male                | Epoch:9 | Val Acc: 0.2661
 Best site-Black_Female              | Epoch:9 | Val Acc: 0.2717
 Best site-Indian_Male               | Epoch:9 | Val Acc: 0.3718
 Best site-Indian_Female             | Epoch:9 | Val Acc: 0.3030
 Best site-Middle_Eastern_Male       | Epoch:9 | Val Acc: 0.2419
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
 Test site-White_Male               | Epoch:9 | Test Acc: 0.3978
 Test site-White_Female             | Epoch:9 | Test Acc: 0.3062
 Test site-Black_Female             | Epoch:9 | Test Acc: 0.2810
 Test site-Black_Male               | Epoch:9 | Test Acc: 0.2961
 Test site-Indian_Male              | Epoch:9 | Test Acc: 0.3519
 Test site-Indian_Female            | Epoch:9 | Test Acc: 0.2752
 Test site-Middle_Eastern_Male      | Epoch:9 | Test Acc: 0.3480
Average Test Accuracy: 0.3223
============ Train epoch 10 ============
 Site-White_Male               | Train Loss: 1.7129 | Train Acc: 0.4375
 Site-White_Female             | Train Loss: 1.6311 | Train Acc: 0.3902
 Site-White_Male               | Train Loss: 1.7780 | Train Acc: 0.3571
 Site-White_Female             | Train Loss: 1.6069 | Train Acc: 0.4244
 Site-White_Male               | Train Loss: 1.8013 | Train Acc: 0.3180
 Site-Black_Female             | Train Loss: 1.7956 | Train Acc: 0.2917
 Site-Black_Male               | Train Loss: 1.8285 | Train Acc: 0.2761
 Site-Black_Female             | Train Loss: 1.7122 | Train Acc: 0.3012
 Site-Indian_Male              | Train Loss: 1.7869 | Train Acc: 0.3162
 Site-Indian_Female            | Train Loss: 1.7799 | Train Acc: 0.3116
 Site-Middle_Eastern_Male      | Train Loss: 1.7503 | Train Acc: 0.3441
 Site-White_Male                    | Val  Loss: 1.7590 | Val  Acc: 0.3750
 Site-White_Female                  | Val  Loss: 1.7638 | Val  Acc: 0.3148
 Site-White_Male                    | Val  Loss: 1.7475 | Val  Acc: 0.3763
 Site-White_Female                  | Val  Loss: 1.7190 | Val  Acc: 0.3544
 Site-White_Male                    | Val  Loss: 1.7602 | Val  Acc: 0.3218
 Site-Black_Female                  | Val  Loss: 1.7953 | Val  Acc: 0.2812
 Site-Black_Male                    | Val  Loss: 1.8540 | Val  Acc: 0.2202
 Site-Black_Female                  | Val  Loss: 1.7449 | Val  Acc: 0.2775
 Site-Indian_Male                   | Val  Loss: 1.6392 | Val  Acc: 0.3462
 Site-Indian_Female                 | Val  Loss: 1.6643 | Val  Acc: 0.2879
 Site-Middle_Eastern_Male           | Val  Loss: 1.8552 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3147
============ Train epoch 11 ============
 Site-White_Male               | Train Loss: 1.6843 | Train Acc: 0.3750
 Site-White_Female             | Train Loss: 1.7162 | Train Acc: 0.4024
 Site-White_Male               | Train Loss: 1.6390 | Train Acc: 0.3429
 Site-White_Female             | Train Loss: 1.6008 | Train Acc: 0.4286
 Site-White_Male               | Train Loss: 1.6303 | Train Acc: 0.3448
 Site-Black_Female             | Train Loss: 1.6973 | Train Acc: 0.3438
 Site-Black_Male               | Train Loss: 1.8153 | Train Acc: 0.3129
 Site-Black_Female             | Train Loss: 1.7982 | Train Acc: 0.3436
 Site-Indian_Male              | Train Loss: 1.7578 | Train Acc: 0.3077
 Site-Indian_Female            | Train Loss: 1.6874 | Train Acc: 0.3668
 Site-Middle_Eastern_Male      | Train Loss: 1.7515 | Train Acc: 0.3441
 Site-White_Male                    | Val  Loss: 1.7262 | Val  Acc: 0.3438
 Site-White_Female                  | Val  Loss: 1.6132 | Val  Acc: 0.3889
 Site-White_Male                    | Val  Loss: 1.7056 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6927 | Val  Acc: 0.3354
 Site-White_Male                    | Val  Loss: 1.7450 | Val  Acc: 0.3218
 Site-Black_Female                  | Val  Loss: 1.7599 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.7505 | Val  Acc: 0.3119
 Site-Black_Female                  | Val  Loss: 1.7338 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.6151 | Val  Acc: 0.3718
 Site-Indian_Female                 | Val  Loss: 1.6494 | Val  Acc: 0.3561
 Site-Middle_Eastern_Male           | Val  Loss: 1.8747 | Val  Acc: 0.2581
Average Valid Accuracy: 0.3367
 Best site-White_Male                | Epoch:11 | Val Acc: 0.3438
 Best site-White_Female              | Epoch:11 | Val Acc: 0.3889
 Best site-White_Male                | Epoch:11 | Val Acc: 0.3333
 Best site-White_Female              | Epoch:11 | Val Acc: 0.3354
 Best site-White_Male                | Epoch:11 | Val Acc: 0.3218
 Best site-Black_Female              | Epoch:11 | Val Acc: 0.3594
 Best site-Black_Male                | Epoch:11 | Val Acc: 0.3119
 Best site-Black_Female              | Epoch:11 | Val Acc: 0.3237
 Best site-Indian_Male               | Epoch:11 | Val Acc: 0.3718
 Best site-Indian_Female             | Epoch:11 | Val Acc: 0.3561
 Best site-Middle_Eastern_Male       | Epoch:11 | Val Acc: 0.2581
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 12 ============
 Site-White_Male               | Train Loss: 1.6212 | Train Acc: 0.3542
 Site-White_Female             | Train Loss: 1.5652 | Train Acc: 0.4268
 Site-White_Male               | Train Loss: 1.7690 | Train Acc: 0.3000
 Site-White_Female             | Train Loss: 1.5230 | Train Acc: 0.4580
 Site-White_Male               | Train Loss: 1.5999 | Train Acc: 0.3142
 Site-Black_Female             | Train Loss: 1.6473 | Train Acc: 0.3646
 Site-Black_Male               | Train Loss: 1.7761 | Train Acc: 0.3129
 Site-Black_Female             | Train Loss: 1.7648 | Train Acc: 0.3552
 Site-Indian_Male              | Train Loss: 1.7290 | Train Acc: 0.2906
 Site-Indian_Female            | Train Loss: 1.7586 | Train Acc: 0.3467
 Site-Middle_Eastern_Male      | Train Loss: 1.7446 | Train Acc: 0.2796
 Site-White_Male                    | Val  Loss: 1.7580 | Val  Acc: 0.2500
 Site-White_Female                  | Val  Loss: 1.6038 | Val  Acc: 0.4630
 Site-White_Male                    | Val  Loss: 1.6899 | Val  Acc: 0.3441
 Site-White_Female                  | Val  Loss: 1.7114 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 1.7304 | Val  Acc: 0.2989
 Site-Black_Female                  | Val  Loss: 1.7291 | Val  Acc: 0.3281
 Site-Black_Male                    | Val  Loss: 1.7789 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.6826 | Val  Acc: 0.3064
 Site-Indian_Male                   | Val  Loss: 1.5969 | Val  Acc: 0.3462
 Site-Indian_Female                 | Val  Loss: 1.6470 | Val  Acc: 0.3409
 Site-Middle_Eastern_Male           | Val  Loss: 1.8520 | Val  Acc: 0.2339
Average Valid Accuracy: 0.3259
============ Train epoch 13 ============
 Site-White_Male               | Train Loss: 1.6301 | Train Acc: 0.4167
 Site-White_Female             | Train Loss: 1.4769 | Train Acc: 0.4512
 Site-White_Male               | Train Loss: 1.6975 | Train Acc: 0.3143
 Site-White_Female             | Train Loss: 1.4939 | Train Acc: 0.4454
 Site-White_Male               | Train Loss: 1.5360 | Train Acc: 0.3602
 Site-Black_Female             | Train Loss: 1.7178 | Train Acc: 0.3646
 Site-Black_Male               | Train Loss: 1.7680 | Train Acc: 0.2945
 Site-Black_Female             | Train Loss: 1.5920 | Train Acc: 0.3320
 Site-Indian_Male              | Train Loss: 1.7235 | Train Acc: 0.3248
 Site-Indian_Female            | Train Loss: 1.7260 | Train Acc: 0.3769
 Site-Middle_Eastern_Male      | Train Loss: 1.7053 | Train Acc: 0.3172
 Site-White_Male                    | Val  Loss: 1.6547 | Val  Acc: 0.2812
 Site-White_Female                  | Val  Loss: 1.6006 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.6542 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6810 | Val  Acc: 0.4051
 Site-White_Male                    | Val  Loss: 1.6855 | Val  Acc: 0.2874
 Site-Black_Female                  | Val  Loss: 1.7583 | Val  Acc: 0.3438
 Site-Black_Male                    | Val  Loss: 1.8127 | Val  Acc: 0.2752
 Site-Black_Female                  | Val  Loss: 1.6787 | Val  Acc: 0.3468
 Site-Indian_Male                   | Val  Loss: 1.6430 | Val  Acc: 0.3205
 Site-Indian_Female                 | Val  Loss: 1.5804 | Val  Acc: 0.3561
 Site-Middle_Eastern_Male           | Val  Loss: 1.8214 | Val  Acc: 0.2661
Average Valid Accuracy: 0.3327
============ Train epoch 14 ============
 Site-White_Male               | Train Loss: 1.5701 | Train Acc: 0.5208
 Site-White_Female             | Train Loss: 1.5147 | Train Acc: 0.4024
 Site-White_Male               | Train Loss: 1.6227 | Train Acc: 0.3143
 Site-White_Female             | Train Loss: 1.5082 | Train Acc: 0.4538
 Site-White_Male               | Train Loss: 1.6604 | Train Acc: 0.3640
 Site-Black_Female             | Train Loss: 1.6517 | Train Acc: 0.4271
 Site-Black_Male               | Train Loss: 1.7841 | Train Acc: 0.2883
 Site-Black_Female             | Train Loss: 1.6175 | Train Acc: 0.3552
 Site-Indian_Male              | Train Loss: 1.6956 | Train Acc: 0.3419
 Site-Indian_Female            | Train Loss: 1.6772 | Train Acc: 0.3568
 Site-Middle_Eastern_Male      | Train Loss: 1.6466 | Train Acc: 0.3548
 Site-White_Male                    | Val  Loss: 1.7054 | Val  Acc: 0.3750
 Site-White_Female                  | Val  Loss: 1.6145 | Val  Acc: 0.4074
 Site-White_Male                    | Val  Loss: 1.6729 | Val  Acc: 0.2903
 Site-White_Female                  | Val  Loss: 1.6721 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 1.7030 | Val  Acc: 0.3333
 Site-Black_Female                  | Val  Loss: 1.7217 | Val  Acc: 0.3750
 Site-Black_Male                    | Val  Loss: 1.7912 | Val  Acc: 0.2844
 Site-Black_Female                  | Val  Loss: 1.6612 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.5723 | Val  Acc: 0.4103
 Site-Indian_Female                 | Val  Loss: 1.6397 | Val  Acc: 0.3561
 Site-Middle_Eastern_Male           | Val  Loss: 1.7744 | Val  Acc: 0.2823
Average Valid Accuracy: 0.3465
 Best site-White_Male                | Epoch:14 | Val Acc: 0.3750
 Best site-White_Female              | Epoch:14 | Val Acc: 0.4074
 Best site-White_Male                | Epoch:14 | Val Acc: 0.2903
 Best site-White_Female              | Epoch:14 | Val Acc: 0.3734
 Best site-White_Male                | Epoch:14 | Val Acc: 0.3333
 Best site-Black_Female              | Epoch:14 | Val Acc: 0.3750
 Best site-Black_Male                | Epoch:14 | Val Acc: 0.2844
 Best site-Black_Female              | Epoch:14 | Val Acc: 0.3237
 Best site-Indian_Male               | Epoch:14 | Val Acc: 0.4103
 Best site-Indian_Female             | Epoch:14 | Val Acc: 0.3561
 Best site-Middle_Eastern_Male       | Epoch:14 | Val Acc: 0.2823
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 15 ============
 Site-White_Male               | Train Loss: 1.5820 | Train Acc: 0.4167
 Site-White_Female             | Train Loss: 1.5389 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.6271 | Train Acc: 0.3500
 Site-White_Female             | Train Loss: 1.4680 | Train Acc: 0.4580
 Site-White_Male               | Train Loss: 1.7483 | Train Acc: 0.3563
 Site-Black_Female             | Train Loss: 1.6406 | Train Acc: 0.4062
 Site-Black_Male               | Train Loss: 1.7572 | Train Acc: 0.2638
 Site-Black_Female             | Train Loss: 1.7198 | Train Acc: 0.3552
 Site-Indian_Male              | Train Loss: 1.7118 | Train Acc: 0.3077
 Site-Indian_Female            | Train Loss: 1.6754 | Train Acc: 0.3367
 Site-Middle_Eastern_Male      | Train Loss: 1.6040 | Train Acc: 0.3495
 Site-White_Male                    | Val  Loss: 1.6584 | Val  Acc: 0.2500
 Site-White_Female                  | Val  Loss: 1.6326 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.6549 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6437 | Val  Acc: 0.3987
 Site-White_Male                    | Val  Loss: 1.6650 | Val  Acc: 0.3506
 Site-Black_Female                  | Val  Loss: 1.7114 | Val  Acc: 0.3906
 Site-Black_Male                    | Val  Loss: 1.7939 | Val  Acc: 0.3394
 Site-Black_Female                  | Val  Loss: 1.6654 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.5319 | Val  Acc: 0.4103
 Site-Indian_Female                 | Val  Loss: 1.5837 | Val  Acc: 0.3712
 Site-Middle_Eastern_Male           | Val  Loss: 1.7382 | Val  Acc: 0.3387
Average Valid Accuracy: 0.3575
 Best site-White_Male                | Epoch:15 | Val Acc: 0.2500
 Best site-White_Female              | Epoch:15 | Val Acc: 0.4259
 Best site-White_Male                | Epoch:15 | Val Acc: 0.3333
 Best site-White_Female              | Epoch:15 | Val Acc: 0.3987
 Best site-White_Male                | Epoch:15 | Val Acc: 0.3506
 Best site-Black_Female              | Epoch:15 | Val Acc: 0.3906
 Best site-Black_Male                | Epoch:15 | Val Acc: 0.3394
 Best site-Black_Female              | Epoch:15 | Val Acc: 0.3237
 Best site-Indian_Male               | Epoch:15 | Val Acc: 0.4103
 Best site-Indian_Female             | Epoch:15 | Val Acc: 0.3712
 Best site-Middle_Eastern_Male       | Epoch:15 | Val Acc: 0.3387
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 16 ============
 Site-White_Male               | Train Loss: 1.5384 | Train Acc: 0.4167
 Site-White_Female             | Train Loss: 1.4838 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.5428 | Train Acc: 0.3143
 Site-White_Female             | Train Loss: 1.4679 | Train Acc: 0.4706
 Site-White_Male               | Train Loss: 1.5716 | Train Acc: 0.3716
 Site-Black_Female             | Train Loss: 1.5812 | Train Acc: 0.3854
 Site-Black_Male               | Train Loss: 1.7324 | Train Acc: 0.3313
 Site-Black_Female             | Train Loss: 1.5425 | Train Acc: 0.4170
 Site-Indian_Male              | Train Loss: 1.6632 | Train Acc: 0.3419
 Site-Indian_Female            | Train Loss: 1.6163 | Train Acc: 0.3769
 Site-Middle_Eastern_Male      | Train Loss: 1.6415 | Train Acc: 0.3333
 Site-White_Male                    | Val  Loss: 1.6428 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.5960 | Val  Acc: 0.4815
 Site-White_Male                    | Val  Loss: 1.6000 | Val  Acc: 0.3226
 Site-White_Female                  | Val  Loss: 1.6285 | Val  Acc: 0.3861
 Site-White_Male                    | Val  Loss: 1.6464 | Val  Acc: 0.3161
 Site-Black_Female                  | Val  Loss: 1.6947 | Val  Acc: 0.4062
 Site-Black_Male                    | Val  Loss: 1.7422 | Val  Acc: 0.3211
 Site-Black_Female                  | Val  Loss: 1.6389 | Val  Acc: 0.3295
 Site-Indian_Male                   | Val  Loss: 1.5449 | Val  Acc: 0.4231
 Site-Indian_Female                 | Val  Loss: 1.5284 | Val  Acc: 0.3636
 Site-Middle_Eastern_Male           | Val  Loss: 1.7604 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3693
 Best site-White_Male                | Epoch:16 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:16 | Val Acc: 0.4815
 Best site-White_Male                | Epoch:16 | Val Acc: 0.3226
 Best site-White_Female              | Epoch:16 | Val Acc: 0.3861
 Best site-White_Male                | Epoch:16 | Val Acc: 0.3161
 Best site-Black_Female              | Epoch:16 | Val Acc: 0.4062
 Best site-Black_Male                | Epoch:16 | Val Acc: 0.3211
 Best site-Black_Female              | Epoch:16 | Val Acc: 0.3295
 Best site-Indian_Male               | Epoch:16 | Val Acc: 0.4231
 Best site-Indian_Female             | Epoch:16 | Val Acc: 0.3636
 Best site-Middle_Eastern_Male       | Epoch:16 | Val Acc: 0.3065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 17 ============
 Site-White_Male               | Train Loss: 1.6285 | Train Acc: 0.4375
 Site-White_Female             | Train Loss: 1.5018 | Train Acc: 0.4268
 Site-White_Male               | Train Loss: 1.6549 | Train Acc: 0.3571
 Site-White_Female             | Train Loss: 1.4527 | Train Acc: 0.4664
 Site-White_Male               | Train Loss: 1.5507 | Train Acc: 0.3755
 Site-Black_Female             | Train Loss: 1.5856 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 1.7331 | Train Acc: 0.3313
 Site-Black_Female             | Train Loss: 1.6405 | Train Acc: 0.3938
 Site-Indian_Male              | Train Loss: 1.6530 | Train Acc: 0.3333
 Site-Indian_Female            | Train Loss: 1.6321 | Train Acc: 0.3668
 Site-Middle_Eastern_Male      | Train Loss: 1.5947 | Train Acc: 0.3978
 Site-White_Male                    | Val  Loss: 1.5780 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.6105 | Val  Acc: 0.4259
 Site-White_Male                    | Val  Loss: 1.6697 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6545 | Val  Acc: 0.4367
 Site-White_Male                    | Val  Loss: 1.6507 | Val  Acc: 0.3276
 Site-Black_Female                  | Val  Loss: 1.6769 | Val  Acc: 0.4062
 Site-Black_Male                    | Val  Loss: 1.6986 | Val  Acc: 0.3670
 Site-Black_Female                  | Val  Loss: 1.6013 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.4701 | Val  Acc: 0.3718
 Site-Indian_Female                 | Val  Loss: 1.5913 | Val  Acc: 0.3788
 Site-Middle_Eastern_Male           | Val  Loss: 1.7031 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3713
 Best site-White_Male                | Epoch:17 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:17 | Val Acc: 0.4259
 Best site-White_Male                | Epoch:17 | Val Acc: 0.3333
 Best site-White_Female              | Epoch:17 | Val Acc: 0.4367
 Best site-White_Male                | Epoch:17 | Val Acc: 0.3276
 Best site-Black_Female              | Epoch:17 | Val Acc: 0.4062
 Best site-Black_Male                | Epoch:17 | Val Acc: 0.3670
 Best site-Black_Female              | Epoch:17 | Val Acc: 0.3237
 Best site-Indian_Male               | Epoch:17 | Val Acc: 0.3718
 Best site-Indian_Female             | Epoch:17 | Val Acc: 0.3788
 Best site-Middle_Eastern_Male       | Epoch:17 | Val Acc: 0.3065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 18 ============
 Site-White_Male               | Train Loss: 1.6005 | Train Acc: 0.5000
 Site-White_Female             | Train Loss: 1.6264 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.6053 | Train Acc: 0.3000
 Site-White_Female             | Train Loss: 1.4708 | Train Acc: 0.4496
 Site-White_Male               | Train Loss: 1.4751 | Train Acc: 0.3908
 Site-Black_Female             | Train Loss: 1.5804 | Train Acc: 0.4583
 Site-Black_Male               | Train Loss: 1.6947 | Train Acc: 0.3067
 Site-Black_Female             | Train Loss: 1.5921 | Train Acc: 0.4208
 Site-Indian_Male              | Train Loss: 1.6651 | Train Acc: 0.3504
 Site-Indian_Female            | Train Loss: 1.5990 | Train Acc: 0.3769
 Site-Middle_Eastern_Male      | Train Loss: 1.5737 | Train Acc: 0.3817
 Site-White_Male                    | Val  Loss: 1.5886 | Val  Acc: 0.3438
 Site-White_Female                  | Val  Loss: 1.6328 | Val  Acc: 0.4815
 Site-White_Male                    | Val  Loss: 1.6475 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6584 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 1.6317 | Val  Acc: 0.3161
 Site-Black_Female                  | Val  Loss: 1.7616 | Val  Acc: 0.3438
 Site-Black_Male                    | Val  Loss: 1.6901 | Val  Acc: 0.3670
 Site-Black_Female                  | Val  Loss: 1.6265 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.4911 | Val  Acc: 0.4231
 Site-Indian_Female                 | Val  Loss: 1.5952 | Val  Acc: 0.4015
 Site-Middle_Eastern_Male           | Val  Loss: 1.7370 | Val  Acc: 0.2903
Average Valid Accuracy: 0.3640
============ Train epoch 19 ============
 Site-White_Male               | Train Loss: 1.5463 | Train Acc: 0.4375
 Site-White_Female             | Train Loss: 1.4907 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.5851 | Train Acc: 0.3643
 Site-White_Female             | Train Loss: 1.4437 | Train Acc: 0.4328
 Site-White_Male               | Train Loss: 1.4902 | Train Acc: 0.3870
 Site-Black_Female             | Train Loss: 1.6443 | Train Acc: 0.3542
 Site-Black_Male               | Train Loss: 1.6917 | Train Acc: 0.3681
 Site-Black_Female             | Train Loss: 1.4976 | Train Acc: 0.3900
 Site-Indian_Male              | Train Loss: 1.6395 | Train Acc: 0.3333
 Site-Indian_Female            | Train Loss: 1.7017 | Train Acc: 0.4070
 Site-Middle_Eastern_Male      | Train Loss: 1.5533 | Train Acc: 0.3978
 Site-White_Male                    | Val  Loss: 1.6374 | Val  Acc: 0.3125
 Site-White_Female                  | Val  Loss: 1.5974 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.6114 | Val  Acc: 0.3763
 Site-White_Female                  | Val  Loss: 1.6386 | Val  Acc: 0.3671
 Site-White_Male                    | Val  Loss: 1.5779 | Val  Acc: 0.3908
 Site-Black_Female                  | Val  Loss: 1.7097 | Val  Acc: 0.4062
 Site-Black_Male                    | Val  Loss: 1.6989 | Val  Acc: 0.3761
 Site-Black_Female                  | Val  Loss: 1.6239 | Val  Acc: 0.3526
 Site-Indian_Male                   | Val  Loss: 1.4501 | Val  Acc: 0.4615
 Site-Indian_Female                 | Val  Loss: 1.5653 | Val  Acc: 0.3712
 Site-Middle_Eastern_Male           | Val  Loss: 1.6924 | Val  Acc: 0.3306
Average Valid Accuracy: 0.3809
 Best site-White_Male                | Epoch:19 | Val Acc: 0.3125
 Best site-White_Female              | Epoch:19 | Val Acc: 0.4444
 Best site-White_Male                | Epoch:19 | Val Acc: 0.3763
 Best site-White_Female              | Epoch:19 | Val Acc: 0.3671
 Best site-White_Male                | Epoch:19 | Val Acc: 0.3908
 Best site-Black_Female              | Epoch:19 | Val Acc: 0.4062
 Best site-Black_Male                | Epoch:19 | Val Acc: 0.3761
 Best site-Black_Female              | Epoch:19 | Val Acc: 0.3526
 Best site-Indian_Male               | Epoch:19 | Val Acc: 0.4615
 Best site-Indian_Female             | Epoch:19 | Val Acc: 0.3712
 Best site-Middle_Eastern_Male       | Epoch:19 | Val Acc: 0.3306
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
 Test site-White_Male               | Epoch:19 | Test Acc: 0.4530
 Test site-White_Female             | Epoch:19 | Test Acc: 0.3301
 Test site-Black_Female             | Epoch:19 | Test Acc: 0.3007
 Test site-Black_Male               | Epoch:19 | Test Acc: 0.3322
 Test site-Indian_Male              | Epoch:19 | Test Acc: 0.3704
 Test site-Indian_Female            | Epoch:19 | Test Acc: 0.3349
 Test site-Middle_Eastern_Male      | Epoch:19 | Test Acc: 0.3919
Average Test Accuracy: 0.3590
============ Train epoch 20 ============
 Site-White_Male               | Train Loss: 1.5234 | Train Acc: 0.4375
 Site-White_Female             | Train Loss: 1.4995 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.5487 | Train Acc: 0.3571
 Site-White_Female             | Train Loss: 1.4210 | Train Acc: 0.4664
 Site-White_Male               | Train Loss: 1.5611 | Train Acc: 0.3640
 Site-Black_Female             | Train Loss: 1.6030 | Train Acc: 0.3646
 Site-Black_Male               | Train Loss: 1.7287 | Train Acc: 0.3558
 Site-Black_Female             | Train Loss: 1.5538 | Train Acc: 0.3900
 Site-Indian_Male              | Train Loss: 1.6278 | Train Acc: 0.3846
 Site-Indian_Female            | Train Loss: 1.5435 | Train Acc: 0.3317
 Site-Middle_Eastern_Male      | Train Loss: 1.5504 | Train Acc: 0.3656
 Site-White_Male                    | Val  Loss: 1.5897 | Val  Acc: 0.3750
 Site-White_Female                  | Val  Loss: 1.5159 | Val  Acc: 0.4815
 Site-White_Male                    | Val  Loss: 1.5706 | Val  Acc: 0.4086
 Site-White_Female                  | Val  Loss: 1.6097 | Val  Acc: 0.3734
 Site-White_Male                    | Val  Loss: 1.5933 | Val  Acc: 0.3678
 Site-Black_Female                  | Val  Loss: 1.6479 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.7265 | Val  Acc: 0.3119
 Site-Black_Female                  | Val  Loss: 1.6118 | Val  Acc: 0.3526
 Site-Indian_Male                   | Val  Loss: 1.4971 | Val  Acc: 0.3846
 Site-Indian_Female                 | Val  Loss: 1.5683 | Val  Acc: 0.3485
 Site-Middle_Eastern_Male           | Val  Loss: 1.7176 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3700
============ Train epoch 21 ============
 Site-White_Male               | Train Loss: 1.5522 | Train Acc: 0.5000
 Site-White_Female             | Train Loss: 1.3965 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.6543 | Train Acc: 0.3643
 Site-White_Female             | Train Loss: 1.4156 | Train Acc: 0.4664
 Site-White_Male               | Train Loss: 1.4621 | Train Acc: 0.3908
 Site-Black_Female             | Train Loss: 1.6039 | Train Acc: 0.4167
 Site-Black_Male               | Train Loss: 1.6562 | Train Acc: 0.3926
 Site-Black_Female             | Train Loss: 1.4206 | Train Acc: 0.4170
 Site-Indian_Male              | Train Loss: 1.5640 | Train Acc: 0.4103
 Site-Indian_Female            | Train Loss: 1.6290 | Train Acc: 0.3869
 Site-Middle_Eastern_Male      | Train Loss: 1.5751 | Train Acc: 0.3656
 Site-White_Male                    | Val  Loss: 1.6085 | Val  Acc: 0.3438
 Site-White_Female                  | Val  Loss: 1.5924 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.5823 | Val  Acc: 0.3441
 Site-White_Female                  | Val  Loss: 1.6087 | Val  Acc: 0.4367
 Site-White_Male                    | Val  Loss: 1.6172 | Val  Acc: 0.3563
 Site-Black_Female                  | Val  Loss: 1.5866 | Val  Acc: 0.3438
 Site-Black_Male                    | Val  Loss: 1.6935 | Val  Acc: 0.3578
 Site-Black_Female                  | Val  Loss: 1.5851 | Val  Acc: 0.3699
 Site-Indian_Male                   | Val  Loss: 1.4878 | Val  Acc: 0.4359
 Site-Indian_Female                 | Val  Loss: 1.6246 | Val  Acc: 0.3485
 Site-Middle_Eastern_Male           | Val  Loss: 1.6786 | Val  Acc: 0.2984
Average Valid Accuracy: 0.3709
============ Train epoch 22 ============
 Site-White_Male               | Train Loss: 1.4705 | Train Acc: 0.5000
 Site-White_Female             | Train Loss: 1.4725 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.5553 | Train Acc: 0.3929
 Site-White_Female             | Train Loss: 1.4053 | Train Acc: 0.4748
 Site-White_Male               | Train Loss: 1.6949 | Train Acc: 0.3640
 Site-Black_Female             | Train Loss: 1.5807 | Train Acc: 0.3854
 Site-Black_Male               | Train Loss: 1.6882 | Train Acc: 0.3620
 Site-Black_Female             | Train Loss: 1.4609 | Train Acc: 0.4247
 Site-Indian_Male              | Train Loss: 1.6040 | Train Acc: 0.3675
 Site-Indian_Female            | Train Loss: 1.5931 | Train Acc: 0.3970
 Site-Middle_Eastern_Male      | Train Loss: 1.5360 | Train Acc: 0.3710
 Site-White_Male                    | Val  Loss: 1.6007 | Val  Acc: 0.3125
 Site-White_Female                  | Val  Loss: 1.5172 | Val  Acc: 0.5000
 Site-White_Male                    | Val  Loss: 1.5853 | Val  Acc: 0.3656
 Site-White_Female                  | Val  Loss: 1.6250 | Val  Acc: 0.3797
 Site-White_Male                    | Val  Loss: 1.5677 | Val  Acc: 0.3678
 Site-Black_Female                  | Val  Loss: 1.6748 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.6884 | Val  Acc: 0.3670
 Site-Black_Female                  | Val  Loss: 1.5896 | Val  Acc: 0.3468
 Site-Indian_Male                   | Val  Loss: 1.4697 | Val  Acc: 0.3974
 Site-Indian_Female                 | Val  Loss: 1.6090 | Val  Acc: 0.3485
 Site-Middle_Eastern_Male           | Val  Loss: 1.6684 | Val  Acc: 0.3306
Average Valid Accuracy: 0.3705
============ Train epoch 23 ============
 Site-White_Male               | Train Loss: 1.5556 | Train Acc: 0.4792
 Site-White_Female             | Train Loss: 1.5219 | Train Acc: 0.4146
 Site-White_Male               | Train Loss: 1.5734 | Train Acc: 0.3643
 Site-White_Female             | Train Loss: 1.3701 | Train Acc: 0.4790
 Site-White_Male               | Train Loss: 1.4802 | Train Acc: 0.4176
 Site-Black_Female             | Train Loss: 1.5969 | Train Acc: 0.3438
 Site-Black_Male               | Train Loss: 1.6878 | Train Acc: 0.3620
 Site-Black_Female             | Train Loss: 1.7371 | Train Acc: 0.4054
 Site-Indian_Male              | Train Loss: 1.5808 | Train Acc: 0.4274
 Site-Indian_Female            | Train Loss: 1.6764 | Train Acc: 0.3970
 Site-Middle_Eastern_Male      | Train Loss: 1.5220 | Train Acc: 0.3978
 Site-White_Male                    | Val  Loss: 1.5999 | Val  Acc: 0.2812
 Site-White_Female                  | Val  Loss: 1.5548 | Val  Acc: 0.4444
 Site-White_Male                    | Val  Loss: 1.6343 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6570 | Val  Acc: 0.4051
 Site-White_Male                    | Val  Loss: 1.5885 | Val  Acc: 0.3966
 Site-Black_Female                  | Val  Loss: 1.7408 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.6851 | Val  Acc: 0.3394
 Site-Black_Female                  | Val  Loss: 1.6167 | Val  Acc: 0.3295
 Site-Indian_Male                   | Val  Loss: 1.4882 | Val  Acc: 0.4231
 Site-Indian_Female                 | Val  Loss: 1.6262 | Val  Acc: 0.3409
 Site-Middle_Eastern_Male           | Val  Loss: 1.6480 | Val  Acc: 0.3629
Average Valid Accuracy: 0.3651
============ Train epoch 24 ============
 Site-White_Male               | Train Loss: 1.4924 | Train Acc: 0.4583
 Site-White_Female             | Train Loss: 1.5330 | Train Acc: 0.4390
 Site-White_Male               | Train Loss: 1.5277 | Train Acc: 0.3714
 Site-White_Female             | Train Loss: 1.4169 | Train Acc: 0.4706
 Site-White_Male               | Train Loss: 1.4807 | Train Acc: 0.4291
 Site-Black_Female             | Train Loss: 1.5530 | Train Acc: 0.4167
 Site-Black_Male               | Train Loss: 1.6433 | Train Acc: 0.3558
 Site-Black_Female             | Train Loss: 1.3509 | Train Acc: 0.4170
 Site-Indian_Male              | Train Loss: 1.5736 | Train Acc: 0.3590
 Site-Indian_Female            | Train Loss: 1.5660 | Train Acc: 0.4121
 Site-Middle_Eastern_Male      | Train Loss: 1.5203 | Train Acc: 0.4032
 Site-White_Male                    | Val  Loss: 1.5536 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.5315 | Val  Acc: 0.5185
 Site-White_Male                    | Val  Loss: 1.6114 | Val  Acc: 0.3656
 Site-White_Female                  | Val  Loss: 1.6784 | Val  Acc: 0.3608
 Site-White_Male                    | Val  Loss: 1.5626 | Val  Acc: 0.4023
 Site-Black_Female                  | Val  Loss: 1.6763 | Val  Acc: 0.4375
 Site-Black_Male                    | Val  Loss: 1.7429 | Val  Acc: 0.3119
 Site-Black_Female                  | Val  Loss: 1.6290 | Val  Acc: 0.2948
 Site-Indian_Male                   | Val  Loss: 1.4433 | Val  Acc: 0.4744
 Site-Indian_Female                 | Val  Loss: 1.5548 | Val  Acc: 0.4091
 Site-Middle_Eastern_Male           | Val  Loss: 1.6785 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3898
 Best site-White_Male                | Epoch:24 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:24 | Val Acc: 0.5185
 Best site-White_Male                | Epoch:24 | Val Acc: 0.3656
 Best site-White_Female              | Epoch:24 | Val Acc: 0.3608
 Best site-White_Male                | Epoch:24 | Val Acc: 0.4023
 Best site-Black_Female              | Epoch:24 | Val Acc: 0.4375
 Best site-Black_Male                | Epoch:24 | Val Acc: 0.3119
 Best site-Black_Female              | Epoch:24 | Val Acc: 0.2948
 Best site-Indian_Male               | Epoch:24 | Val Acc: 0.4744
 Best site-Indian_Female             | Epoch:24 | Val Acc: 0.4091
 Best site-Middle_Eastern_Male       | Epoch:24 | Val Acc: 0.3065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 25 ============
 Site-White_Male               | Train Loss: 1.5489 | Train Acc: 0.3958
 Site-White_Female             | Train Loss: 1.4934 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.4766 | Train Acc: 0.3429
 Site-White_Female             | Train Loss: 1.3886 | Train Acc: 0.4664
 Site-White_Male               | Train Loss: 1.4555 | Train Acc: 0.3946
 Site-Black_Female             | Train Loss: 1.5719 | Train Acc: 0.3646
 Site-Black_Male               | Train Loss: 1.6825 | Train Acc: 0.3374
 Site-Black_Female             | Train Loss: 1.5640 | Train Acc: 0.4208
 Site-Indian_Male              | Train Loss: 1.5642 | Train Acc: 0.3761
 Site-Indian_Female            | Train Loss: 1.5651 | Train Acc: 0.4322
 Site-Middle_Eastern_Male      | Train Loss: 1.4699 | Train Acc: 0.4409
 Site-White_Male                    | Val  Loss: 1.5777 | Val  Acc: 0.3750
 Site-White_Female                  | Val  Loss: 1.5630 | Val  Acc: 0.4630
 Site-White_Male                    | Val  Loss: 1.5795 | Val  Acc: 0.3656
 Site-White_Female                  | Val  Loss: 1.6338 | Val  Acc: 0.4114
 Site-White_Male                    | Val  Loss: 1.5374 | Val  Acc: 0.4195
 Site-Black_Female                  | Val  Loss: 1.6537 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.6861 | Val  Acc: 0.2936
 Site-Black_Female                  | Val  Loss: 1.5848 | Val  Acc: 0.3468
 Site-Indian_Male                   | Val  Loss: 1.4381 | Val  Acc: 0.4103
 Site-Indian_Female                 | Val  Loss: 1.6037 | Val  Acc: 0.3636
 Site-Middle_Eastern_Male           | Val  Loss: 1.6290 | Val  Acc: 0.3226
Average Valid Accuracy: 0.3755
============ Train epoch 26 ============
 Site-White_Male               | Train Loss: 1.5238 | Train Acc: 0.4583
 Site-White_Female             | Train Loss: 1.5475 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.4420 | Train Acc: 0.3286
 Site-White_Female             | Train Loss: 1.3953 | Train Acc: 0.4580
 Site-White_Male               | Train Loss: 1.5167 | Train Acc: 0.4253
 Site-Black_Female             | Train Loss: 1.5323 | Train Acc: 0.3750
 Site-Black_Male               | Train Loss: 1.6917 | Train Acc: 0.3436
 Site-Black_Female             | Train Loss: 1.5736 | Train Acc: 0.3938
 Site-Indian_Male              | Train Loss: 1.5544 | Train Acc: 0.4103
 Site-Indian_Female            | Train Loss: 1.7101 | Train Acc: 0.4121
 Site-Middle_Eastern_Male      | Train Loss: 1.4782 | Train Acc: 0.3925
 Site-White_Male                    | Val  Loss: 1.5057 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.5292 | Val  Acc: 0.4815
 Site-White_Male                    | Val  Loss: 1.5736 | Val  Acc: 0.3441
 Site-White_Female                  | Val  Loss: 1.6180 | Val  Acc: 0.4241
 Site-White_Male                    | Val  Loss: 1.5493 | Val  Acc: 0.3908
 Site-Black_Female                  | Val  Loss: 1.6246 | Val  Acc: 0.4062
 Site-Black_Male                    | Val  Loss: 1.7015 | Val  Acc: 0.3578
 Site-Black_Female                  | Val  Loss: 1.5689 | Val  Acc: 0.3353
 Site-Indian_Male                   | Val  Loss: 1.3987 | Val  Acc: 0.4359
 Site-Indian_Female                 | Val  Loss: 1.5788 | Val  Acc: 0.4167
 Site-Middle_Eastern_Male           | Val  Loss: 1.6321 | Val  Acc: 0.2984
Average Valid Accuracy: 0.3906
 Best site-White_Male                | Epoch:26 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:26 | Val Acc: 0.4815
 Best site-White_Male                | Epoch:26 | Val Acc: 0.3441
 Best site-White_Female              | Epoch:26 | Val Acc: 0.4241
 Best site-White_Male                | Epoch:26 | Val Acc: 0.3908
 Best site-Black_Female              | Epoch:26 | Val Acc: 0.4062
 Best site-Black_Male                | Epoch:26 | Val Acc: 0.3578
 Best site-Black_Female              | Epoch:26 | Val Acc: 0.3353
 Best site-Indian_Male               | Epoch:26 | Val Acc: 0.4359
 Best site-Indian_Female             | Epoch:26 | Val Acc: 0.4167
 Best site-Middle_Eastern_Male       | Epoch:26 | Val Acc: 0.2984
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
============ Train epoch 27 ============
 Site-White_Male               | Train Loss: 1.4792 | Train Acc: 0.4167
 Site-White_Female             | Train Loss: 1.3610 | Train Acc: 0.5122
 Site-White_Male               | Train Loss: 1.5482 | Train Acc: 0.4000
 Site-White_Female             | Train Loss: 1.3615 | Train Acc: 0.4832
 Site-White_Male               | Train Loss: 1.4162 | Train Acc: 0.4023
 Site-Black_Female             | Train Loss: 1.4602 | Train Acc: 0.3750
 Site-Black_Male               | Train Loss: 1.6492 | Train Acc: 0.3436
 Site-Black_Female             | Train Loss: 1.3987 | Train Acc: 0.4247
 Site-Indian_Male              | Train Loss: 1.5430 | Train Acc: 0.3932
 Site-Indian_Female            | Train Loss: 1.5051 | Train Acc: 0.4322
 Site-Middle_Eastern_Male      | Train Loss: 1.5122 | Train Acc: 0.4194
 Site-White_Male                    | Val  Loss: 1.5833 | Val  Acc: 0.3750
 Site-White_Female                  | Val  Loss: 1.5324 | Val  Acc: 0.4630
 Site-White_Male                    | Val  Loss: 1.5332 | Val  Acc: 0.3871
 Site-White_Female                  | Val  Loss: 1.6640 | Val  Acc: 0.3861
 Site-White_Male                    | Val  Loss: 1.5498 | Val  Acc: 0.3678
 Site-Black_Female                  | Val  Loss: 1.6395 | Val  Acc: 0.3438
 Site-Black_Male                    | Val  Loss: 1.6332 | Val  Acc: 0.3578
 Site-Black_Female                  | Val  Loss: 1.5740 | Val  Acc: 0.3526
 Site-Indian_Male                   | Val  Loss: 1.3757 | Val  Acc: 0.4487
 Site-Indian_Female                 | Val  Loss: 1.5661 | Val  Acc: 0.3788
 Site-Middle_Eastern_Male           | Val  Loss: 1.6587 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3788
============ Train epoch 28 ============
 Site-White_Male               | Train Loss: 1.5189 | Train Acc: 0.5208
 Site-White_Female             | Train Loss: 1.4334 | Train Acc: 0.4634
 Site-White_Male               | Train Loss: 1.5525 | Train Acc: 0.3429
 Site-White_Female             | Train Loss: 1.3498 | Train Acc: 0.4748
 Site-White_Male               | Train Loss: 1.4620 | Train Acc: 0.4215
 Site-Black_Female             | Train Loss: 1.4810 | Train Acc: 0.4583
 Site-Black_Male               | Train Loss: 1.6232 | Train Acc: 0.3926
 Site-Black_Female             | Train Loss: 1.4171 | Train Acc: 0.4479
 Site-Indian_Male              | Train Loss: 1.5491 | Train Acc: 0.3932
 Site-Indian_Female            | Train Loss: 1.6647 | Train Acc: 0.4121
 Site-Middle_Eastern_Male      | Train Loss: 1.4544 | Train Acc: 0.4140
 Site-White_Male                    | Val  Loss: 1.5314 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.5328 | Val  Acc: 0.4815
 Site-White_Male                    | Val  Loss: 1.5509 | Val  Acc: 0.3333
 Site-White_Female                  | Val  Loss: 1.6591 | Val  Acc: 0.3671
 Site-White_Male                    | Val  Loss: 1.5556 | Val  Acc: 0.3621
 Site-Black_Female                  | Val  Loss: 1.6305 | Val  Acc: 0.3594
 Site-Black_Male                    | Val  Loss: 1.6681 | Val  Acc: 0.3486
 Site-Black_Female                  | Val  Loss: 1.5740 | Val  Acc: 0.3237
 Site-Indian_Male                   | Val  Loss: 1.3532 | Val  Acc: 0.5385
 Site-Indian_Female                 | Val  Loss: 1.5865 | Val  Acc: 0.3864
 Site-Middle_Eastern_Male           | Val  Loss: 1.6742 | Val  Acc: 0.2742
Average Valid Accuracy: 0.3801
============ Train epoch 29 ============
 Site-White_Male               | Train Loss: 1.5076 | Train Acc: 0.4375
 Site-White_Female             | Train Loss: 1.3809 | Train Acc: 0.4268
 Site-White_Male               | Train Loss: 1.6086 | Train Acc: 0.3643
 Site-White_Female             | Train Loss: 1.3504 | Train Acc: 0.4832
 Site-White_Male               | Train Loss: 1.4858 | Train Acc: 0.4100
 Site-Black_Female             | Train Loss: 1.5151 | Train Acc: 0.4271
 Site-Black_Male               | Train Loss: 1.5762 | Train Acc: 0.4172
 Site-Black_Female             | Train Loss: 1.4675 | Train Acc: 0.4749
 Site-Indian_Male              | Train Loss: 1.5625 | Train Acc: 0.3846
 Site-Indian_Female            | Train Loss: 1.4518 | Train Acc: 0.4322
 Site-Middle_Eastern_Male      | Train Loss: 1.4622 | Train Acc: 0.4570
 Site-White_Male                    | Val  Loss: 1.4992 | Val  Acc: 0.4062
 Site-White_Female                  | Val  Loss: 1.5521 | Val  Acc: 0.5000
 Site-White_Male                    | Val  Loss: 1.5340 | Val  Acc: 0.3441
 Site-White_Female                  | Val  Loss: 1.6294 | Val  Acc: 0.3861
 Site-White_Male                    | Val  Loss: 1.5287 | Val  Acc: 0.3736
 Site-Black_Female                  | Val  Loss: 1.6652 | Val  Acc: 0.4219
 Site-Black_Male                    | Val  Loss: 1.6221 | Val  Acc: 0.4128
 Site-Black_Female                  | Val  Loss: 1.5686 | Val  Acc: 0.3353
 Site-Indian_Male                   | Val  Loss: 1.4333 | Val  Acc: 0.4615
 Site-Indian_Female                 | Val  Loss: 1.5593 | Val  Acc: 0.4015
 Site-Middle_Eastern_Male           | Val  Loss: 1.6361 | Val  Acc: 0.3065
Average Valid Accuracy: 0.3954
 Best site-White_Male                | Epoch:29 | Val Acc: 0.4062
 Best site-White_Female              | Epoch:29 | Val Acc: 0.5000
 Best site-White_Male                | Epoch:29 | Val Acc: 0.3441
 Best site-White_Female              | Epoch:29 | Val Acc: 0.3861
 Best site-White_Male                | Epoch:29 | Val Acc: 0.3736
 Best site-Black_Female              | Epoch:29 | Val Acc: 0.4219
 Best site-Black_Male                | Epoch:29 | Val Acc: 0.4128
 Best site-Black_Female              | Epoch:29 | Val Acc: 0.3353
 Best site-Indian_Male               | Epoch:29 | Val Acc: 0.4615
 Best site-Indian_Female             | Epoch:29 | Val Acc: 0.4015
 Best site-Middle_Eastern_Male       | Epoch:29 | Val Acc: 0.3065
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_gender_cluster_-1_small_test/CoCoOP...
 Test site-White_Male               | Epoch:29 | Test Acc: 0.4530
 Test site-White_Female             | Epoch:29 | Test Acc: 0.3684
 Test site-Black_Female             | Epoch:29 | Test Acc: 0.3137
 Test site-Black_Male               | Epoch:29 | Test Acc: 0.3224
 Test site-Indian_Male              | Epoch:29 | Test Acc: 0.3519
 Test site-Indian_Female            | Epoch:29 | Test Acc: 0.3349
 Test site-Middle_Eastern_Male      | Epoch:29 | Test Acc: 0.4189
Average Test Accuracy: 0.3662
===2023-05-23 21:55:47===
===2023-05-23 21:56:04===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[48,82,140,238,261,96,163,259,117,199,186,]
client_nums=[5,3,2,1,]
domain number = -1
Loading snapshots...
 Test site-White_Male               | Epoch:29 | Test Acc: 0.4530
 Test site-White_Female             | Epoch:29 | Test Acc: 0.3684
 Test site-Black_Female             | Epoch:29 | Test Acc: 0.3137
 Test site-Black_Male               | Epoch:29 | Test Acc: 0.3224
 Test site-Indian_Male              | Epoch:29 | Test Acc: 0.3519
 Test site-Indian_Female            | Epoch:29 | Test Acc: 0.3349
 Test site-Middle_Eastern_Male      | Epoch:29 | Test Acc: 0.4189
Average Test Accuracy: 0.3662
