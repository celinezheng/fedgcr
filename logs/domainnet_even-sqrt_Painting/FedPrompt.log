===2023-03-26 17:27:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0678 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9369 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 2.2049 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1423 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.2235 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.1767 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.8484 | Train Acc: 0.4762
 Site-Real      | Train Loss: 1.9688 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.9312 | Train Acc: 0.5714
 Site-Sketch    | Train Loss: 2.0294 | Train Acc: 0.3968
 Site-Clipart   | Val  Loss: 1.9665 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 2.0018 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1702 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1871 | Val  Acc: 0.2143
 Site-QuickDraw | Val  Loss: 2.1971 | Val  Acc: 0.2857
 Site-QuickDraw | Val  Loss: 2.2133 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.9506 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.9276 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9761 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 2.0054 | Val  Acc: 0.4762
Average Valid Accuracy: 0.3833
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2857
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2619
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7550 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.7705 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 2.1267 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.0870 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 2.1253 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.0048 | Train Acc: 0.3968
 Site-Real      | Train Loss: 1.5011 | Train Acc: 0.7460
 Site-Real      | Train Loss: 1.5630 | Train Acc: 0.7302
 Site-Sketch    | Train Loss: 1.5345 | Train Acc: 0.6984
 Site-Sketch    | Train Loss: 1.6619 | Train Acc: 0.5873
 Site-Clipart   | Val  Loss: 1.7933 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8077 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1689 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.2363 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 1.9350 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 2.0009 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.5625 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 1.5780 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.7356 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 1.6910 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4286
 Best site-Real       | Epoch:1 | Val Acc: 0.6429
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3850 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4149 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.9607 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.7942 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.9314 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 1.7765 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.0515 | Train Acc: 0.9048
 Site-Real      | Train Loss: 1.0746 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 1.2633 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.3406 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.4740 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3582 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7576 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0000 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 1.6859 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 1.8654 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.0960 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.0358 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.3458 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.3662 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6429
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4762
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0995 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.1004 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.8222 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5999 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.7658 | Train Acc: 0.3810
 Site-QuickDraw | Train Loss: 1.5737 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.7464 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.7427 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.9371 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.0248 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.2516 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.0891 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.5011 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.9255 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.4933 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.7459 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.6836 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.7439 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 1.0986 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.0446 | Val  Acc: 0.8095
Average Valid Accuracy: 0.6976
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-Real       | Epoch:3 | Val Acc: 0.9762
 Best site-Real       | Epoch:3 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:3 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8601 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9785 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6608 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5994 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.6555 | Train Acc: 0.4286
 Site-QuickDraw | Train Loss: 1.4422 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.5113 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.4901 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.7076 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8669 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.0497 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.8595 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3983 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7464 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 1.2511 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.6419 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.4682 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5504 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8690 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.9155 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7119
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5000
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6580 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8367 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6114 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4072 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.4145 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.1976 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.3996 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3550 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.6460 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 0.6894 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.7829 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8051 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1805 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6234 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 1.1125 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.4059 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3404 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3927 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.7893 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.7389 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5238
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5402 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6116 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.3008 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0681 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.4550 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.2777 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3109 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.2731 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5458 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5252 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5338 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5469 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0393 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2669 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.1584 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.4280 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.2510 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2927 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5327 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.4883 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8024
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5238
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4179 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5473 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.2053 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9946 | Train Acc: 0.7619
 Site-QuickDraw | Train Loss: 1.2049 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0828 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.3044 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.1986 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4507 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5045 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.6429 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5999 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.8340 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.2322 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 0.8503 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.3234 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1840 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2227 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6080 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 0.4932 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3156 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4227 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1461 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9479 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 1.3304 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 1.0634 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.1579 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1429 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3297 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3818 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.4912 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4693 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8463 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1051 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 0.8892 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4056 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1412 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1675 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.3766 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3496 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8262
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Real       | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.3144 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3882 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.0392 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7817 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.1644 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 0.9215 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.2103 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1237 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2940 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3522 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4125 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3475 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6779 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9799 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 0.8283 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.0769 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1902 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4169 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.3205 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8690
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6429
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
===2023-03-26 17:55:13===
===2023-03-26 17:55:14===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Painting: 0.8174
Average Test Accuracy: 0.8174
===2023-03-27 23:10:21===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0500 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9395 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 2.2091 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1477 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.2372 | Train Acc: 0.2381
 Site-QuickDraw | Train Loss: 2.1660 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.8113 | Train Acc: 0.5556
 Site-Real      | Train Loss: 1.9460 | Train Acc: 0.3968
 Site-Sketch    | Train Loss: 1.9094 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 2.0147 | Train Acc: 0.3810
 Site-Clipart   | Val  Loss: 1.9665 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 2.0141 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1786 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.2147 | Val  Acc: 0.2143
 Site-QuickDraw | Val  Loss: 2.1840 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 2.2242 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9435 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 1.8692 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9576 | Val  Acc: 0.4762
 Site-Sketch    | Val  Loss: 1.9730 | Val  Acc: 0.5238
Average Valid Accuracy: 0.3714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1905
 Best site-Real       | Epoch:0 | Val Acc: 0.4524
 Best site-Real       | Epoch:0 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:0 | Val Acc: 0.4762
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7169 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.6914 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.1452 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.1192 | Train Acc: 0.2698
 Site-QuickDraw | Train Loss: 2.1741 | Train Acc: 0.2540
 Site-QuickDraw | Train Loss: 2.0484 | Train Acc: 0.3333
 Site-Real      | Train Loss: 1.4086 | Train Acc: 0.8095
 Site-Real      | Train Loss: 1.4783 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.4721 | Train Acc: 0.6349
 Site-Sketch    | Train Loss: 1.5907 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6997 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.7434 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.1729 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.2534 | Val  Acc: 0.1905
 Site-QuickDraw | Val  Loss: 1.9858 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.0689 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4880 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 1.4656 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.6668 | Val  Acc: 0.4524
 Site-Sketch    | Val  Loss: 1.6224 | Val  Acc: 0.5476
Average Valid Accuracy: 0.4524
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2857
 Best site-Real       | Epoch:1 | Val Acc: 0.6190
 Best site-Real       | Epoch:1 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4524
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3364 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3423 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.8662 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6669 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.9888 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 1.8322 | Train Acc: 0.4444
 Site-Real      | Train Loss: 1.0460 | Train Acc: 0.8889
 Site-Real      | Train Loss: 0.9866 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 1.2348 | Train Acc: 0.7143
 Site-Sketch    | Train Loss: 1.2758 | Train Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3834 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2451 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6594 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8996 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.8001 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 1.8765 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0517 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 0.9988 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.2603 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.3169 | Val  Acc: 0.7857
Average Valid Accuracy: 0.6381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0622 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.0924 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8880 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.6527 | Train Acc: 0.5079
 Site-QuickDraw | Train Loss: 1.8465 | Train Acc: 0.2857
 Site-QuickDraw | Train Loss: 1.6696 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.6335 | Train Acc: 0.9206
 Site-Real      | Train Loss: 0.6837 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.8655 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.9328 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.2179 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.0934 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5151 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.9319 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 1.5486 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.8792 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6154 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6389 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9915 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 0.9973 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 1.0000
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7943 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8962 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6409 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.4704 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.5166 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.3500 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.4542 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.4199 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.6732 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8352 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 0.9976 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.8386 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3167 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.7135 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 1.2906 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.5220 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.4121 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.4916 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8091 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.8846 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7333
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5476
 Best site-Real       | Epoch:4 | Val Acc: 0.9762
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.5660 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6992 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6142 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3191 | Train Acc: 0.6349
 Site-QuickDraw | Train Loss: 1.3207 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.2182 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.3325 | Train Acc: 0.9524
 Site-Real      | Train Loss: 0.2926 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5585 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.5829 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.6634 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7148 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1102 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5648 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 1.1538 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3724 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2785 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3183 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.6409 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6876 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5000
 Best site-Real       | Epoch:5 | Val Acc: 1.0000
 Best site-Real       | Epoch:5 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4574 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6512 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.3351 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0121 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 1.2355 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 1.1257 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2843 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.2494 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5336 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5372 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5479 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5696 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0004 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3048 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.0101 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 1.1667 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.2198 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.2876 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4557 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.4968 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8143
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6190
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Real       | Epoch:6 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3218 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4542 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2400 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9746 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.0870 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.0814 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2295 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1460 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3030 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3839 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.5098 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4987 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9345 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1960 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 0.8179 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.2000 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.1384 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1584 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4369 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.4742 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8262
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5714
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2480 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3823 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0592 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7227 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.1551 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.0759 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.1595 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1273 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2868 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3247 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4053 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4313 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6568 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9461 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 0.9410 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.3065 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1328 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.1835 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3104 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.3501 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8500
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5476
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Real       | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2511 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3072 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.0097 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.6595 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.0701 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 0.9671 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1410 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.0957 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2038 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2313 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.2855 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3129 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.5645 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9290 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 0.9445 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.0854 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0932 | Val  Acc: 0.9762
 Site-Real      | Val  Loss: 0.1427 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2472 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.2312 | Val  Acc: 0.9762
Average Valid Accuracy: 0.8643
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5476
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/FedPrompt_Painting...
===2023-03-27 23:37:45===
===2023-03-27 23:37:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of Painting: 0.8191
Average Test Accuracy: 0.8191
