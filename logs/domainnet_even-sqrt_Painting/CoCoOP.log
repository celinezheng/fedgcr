===2023-03-26 23:17:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0106 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9662 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 2.1507 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1722 | Train Acc: 0.2698
 Site-QuickDraw | Train Loss: 2.2455 | Train Acc: 0.2063
 Site-QuickDraw | Train Loss: 2.1780 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.9075 | Train Acc: 0.5238
 Site-Real      | Train Loss: 1.9792 | Train Acc: 0.4762
 Site-Sketch    | Train Loss: 1.9195 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.9428 | Train Acc: 0.4921
 Site-Clipart   | Val  Loss: 1.9486 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9744 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1529 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1532 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.1261 | Val  Acc: 0.3095
 Site-QuickDraw | Val  Loss: 2.1788 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9217 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.9973 | Val  Acc: 0.4286
 Site-Sketch    | Val  Loss: 1.9139 | Val  Acc: 0.5476
 Site-Sketch    | Val  Loss: 1.9571 | Val  Acc: 0.5238
Average Valid Accuracy: 0.4024
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.3095
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.4762
 Best site-Real       | Epoch:0 | Val Acc: 0.4286
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5476
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6529 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.6197 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.0109 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.9056 | Train Acc: 0.3968
 Site-QuickDraw | Train Loss: 2.0638 | Train Acc: 0.3016
 Site-QuickDraw | Train Loss: 1.9219 | Train Acc: 0.4127
 Site-Real      | Train Loss: 1.4256 | Train Acc: 0.7778
 Site-Real      | Train Loss: 1.4716 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.4559 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.5762 | Train Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.6721 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.6321 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9116 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9613 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 1.9082 | Val  Acc: 0.4286
 Site-QuickDraw | Val  Loss: 2.0144 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 1.4157 | Val  Acc: 0.7619
 Site-Real      | Val  Loss: 1.4948 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.5522 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.6574 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.4286
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3571
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Real       | Epoch:1 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.3008 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.2818 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8289 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6877 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.9974 | Train Acc: 0.3175
 Site-QuickDraw | Train Loss: 1.8582 | Train Acc: 0.4444
 Site-Real      | Train Loss: 1.0484 | Train Acc: 0.8254
 Site-Real      | Train Loss: 1.0445 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 1.1190 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.2934 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 1.3156 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.2502 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6353 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7761 | Val  Acc: 0.4048
 Site-QuickDraw | Val  Loss: 1.6851 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.9398 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.9851 | Val  Acc: 0.8571
 Site-Real      | Val  Loss: 1.0866 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2297 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.2689 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6524
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.4286
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Real       | Epoch:2 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0701 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.1667 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.6852 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.5116 | Train Acc: 0.6032
 Site-QuickDraw | Train Loss: 1.8449 | Train Acc: 0.4127
 Site-QuickDraw | Train Loss: 1.6361 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.7636 | Train Acc: 0.9048
 Site-Real      | Train Loss: 0.7826 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.9060 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.1061 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1127 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0543 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4402 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5763 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 1.5288 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.7816 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7262 | Val  Acc: 0.9286
 Site-Real      | Val  Loss: 0.7816 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.0402 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.1253 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7071
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3810
 Best site-Real       | Epoch:3 | Val Acc: 0.9286
 Best site-Real       | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.7954 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.9105 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.5170 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3269 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.6750 | Train Acc: 0.5238
 Site-QuickDraw | Train Loss: 1.5742 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.5095 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.4942 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.7348 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8448 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8634 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8911 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2460 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4366 | Val  Acc: 0.6190
 Site-QuickDraw | Val  Loss: 1.3577 | Val  Acc: 0.5952
 Site-QuickDraw | Val  Loss: 1.6790 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.4675 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.5167 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8159 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.7938 | Val  Acc: 0.9048
Average Valid Accuracy: 0.7643
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.6190
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.5952
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.4524
 Best site-Real       | Epoch:4 | Val Acc: 0.9524
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6447 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7326 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.3399 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1694 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 1.7708 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 1.4383 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.3963 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.3765 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.5280 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.7033 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7115 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7152 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0758 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3857 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 1.2333 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.6766 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3294 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3718 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6399 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8646 | Val  Acc: 0.8810
Average Valid Accuracy: 0.7690
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Real       | Epoch:5 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.4662 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5937 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.1635 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 1.0567 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.5638 | Train Acc: 0.5397
 Site-QuickDraw | Train Loss: 1.1652 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.3128 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2687 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.5263 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.5712 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5978 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5772 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9894 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2129 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 1.1170 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.4773 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.2599 | Val  Acc: 0.9524
 Site-Real      | Val  Loss: 0.3391 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.4773 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6236 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5000
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.4126 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5354 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.0995 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9558 | Train Acc: 0.6984
 Site-QuickDraw | Train Loss: 1.3636 | Train Acc: 0.6190
 Site-QuickDraw | Train Loss: 1.2323 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2585 | Train Acc: 0.9365
 Site-Real      | Train Loss: 0.2046 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4476 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.4708 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.5157 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4781 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7727 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0804 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.0166 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 1.4264 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1835 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2370 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4250 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5526 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8310
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2829 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4180 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.9768 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7996 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 1.4402 | Train Acc: 0.5556
 Site-QuickDraw | Train Loss: 1.0935 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2138 | Train Acc: 0.9683
 Site-Real      | Train Loss: 0.1378 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4351 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.3904 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3869 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4263 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6436 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9627 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 0.9102 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2859 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1471 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2113 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.3103 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5299 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8500
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.5238
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:8 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2792 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2928 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 0.7801 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 0.7002 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.3050 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 1.0085 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1669 | Train Acc: 0.9841
 Site-Real      | Train Loss: 0.1298 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2616 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3319 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3737 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3408 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6970 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8122 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 0.8888 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.2999 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.1126 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1811 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.2821 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3800 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8643
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5952
 Best site-Real       | Epoch:9 | Val Acc: 1.0000
 Best site-Real       | Epoch:9 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:9 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:9 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even-sqrt/CoCoOP_Painting...
===2023-03-26 23:42:40===
===2023-03-26 23:42:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 3
Loading snapshots...
Test Accuracy of Painting: 0.8336
Average Test Accuracy: 0.8336
