===2023-07-28 16:07:33===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[21,36,61,104,177,11,19,32,13,23,21,
client_nums=[5,3,2,1,]
len_dataset=[667,106,62,36,]
domain number = 4
============ Train epoch 0 ============
 Site-amazon                        | Train Loss: 2.1568 | Train Acc: 0.1429
 Site-amazon                        | Train Loss: 2.1675 | Train Acc: 0.0556
 Site-amazon                        | Train Loss: 2.0583 | Train Acc: 0.2459
 Site-amazon                        | Train Loss: 1.7507 | Train Acc: 0.8750
 Site-amazon                        | Train Loss: 1.3349 | Train Acc: 0.9605
 Site-dslr                          | Train Loss: 2.1671 | Train Acc: 0.0000
 Site-dslr                          | Train Loss: 2.1682 | Train Acc: 0.1053
 Site-dslr                          | Train Loss: 1.3818 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.2518 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2539 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 2.2006 | Train Acc: 0.0476
Average Train Accuracy: 0.3064
 Site-amazon                        | Val  Loss: 1.3611 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.3042 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.2608 | Val  Acc: 0.9250
 Site-amazon                        | Val  Loss: 1.2298 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 1.6196 | Val  Acc: 0.8718
 Site-dslr                          | Val  Loss: 1.5233 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 1.3534 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 1.6289 | Val  Acc: 0.6667
 Site-synthetic                     | Val  Loss: 2.2732 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2814 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 2.1383 | Val  Acc: 0.0000
Average Valid Accuracy: 0.6616
 Best site-amazon                    | Epoch:0 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:0 | Val Acc: 0.9250
 Best site-amazon                    | Epoch:0 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:0 | Val Acc: 0.8718
 Best site-dslr                      | Epoch:0 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:0 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:0 | Val Acc: 0.6667
 Best site-synthetic                 | Epoch:0 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:0 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 1 ============
 Site-amazon                        | Train Loss: 1.9926 | Train Acc: 0.1429
 Site-amazon                        | Train Loss: 2.0102 | Train Acc: 0.1667
 Site-amazon                        | Train Loss: 1.7991 | Train Acc: 0.7869
 Site-amazon                        | Train Loss: 1.2679 | Train Acc: 0.9423
 Site-amazon                        | Train Loss: 0.7405 | Train Acc: 0.9661
 Site-dslr                          | Train Loss: 2.0047 | Train Acc: 0.1818
 Site-dslr                          | Train Loss: 1.9462 | Train Acc: 0.1579
 Site-dslr                          | Train Loss: 0.8560 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.1967 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2169 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 2.0624 | Train Acc: 0.1905
Average Train Accuracy: 0.4066
 Site-amazon                        | Val  Loss: 0.7272 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.7663 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.6223 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.6141 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 1.1228 | Val  Acc: 0.9402
 Site-dslr                          | Val  Loss: 1.0190 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.7676 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 1.0989 | Val  Acc: 0.7143
 Site-synthetic                     | Val  Loss: 2.2472 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2438 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.9848 | Val  Acc: 0.2857
Average Valid Accuracy: 0.6948
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9750
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9855
 Best site-amazon                    | Epoch:1 | Val Acc: 0.9402
 Best site-dslr                      | Epoch:1 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:1 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:1 | Val Acc: 0.7143
 Best site-synthetic                 | Epoch:1 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:1 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:1 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 2 ============
 Site-amazon                        | Train Loss: 1.8494 | Train Acc: 0.2381
 Site-amazon                        | Train Loss: 1.8681 | Train Acc: 0.2778
 Site-amazon                        | Train Loss: 1.5160 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.9416 | Train Acc: 0.9327
 Site-amazon                        | Train Loss: 0.4094 | Train Acc: 0.9718
 Site-dslr                          | Train Loss: 1.8598 | Train Acc: 0.4545
 Site-dslr                          | Train Loss: 1.7290 | Train Acc: 0.5789
 Site-dslr                          | Train Loss: 0.5263 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.3766 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2570 | Train Acc: 0.0435
 Site-webcam                        | Train Loss: 1.9783 | Train Acc: 0.1905
Average Train Accuracy: 0.5068
 Site-amazon                        | Val  Loss: 0.4182 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.3554 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.3056 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.3782 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 0.8062 | Val  Acc: 0.9573
 Site-dslr                          | Val  Loss: 0.7436 | Val  Acc: 0.7143
 Site-dslr                          | Val  Loss: 0.4441 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.8710 | Val  Acc: 0.7143
 Site-synthetic                     | Val  Loss: 2.2522 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2790 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.7908 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7201
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9500
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9855
 Best site-amazon                    | Epoch:2 | Val Acc: 0.9573
 Best site-dslr                      | Epoch:2 | Val Acc: 0.7143
 Best site-dslr                      | Epoch:2 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:2 | Val Acc: 0.7143
 Best site-synthetic                 | Epoch:2 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:2 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 3 ============
 Site-amazon                        | Train Loss: 1.7381 | Train Acc: 0.3810
 Site-amazon                        | Train Loss: 1.7945 | Train Acc: 0.3333
 Site-amazon                        | Train Loss: 1.3134 | Train Acc: 0.9672
 Site-amazon                        | Train Loss: 0.7478 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.2423 | Train Acc: 0.9605
 Site-dslr                          | Train Loss: 1.7427 | Train Acc: 0.3636
 Site-dslr                          | Train Loss: 1.5970 | Train Acc: 0.5263
 Site-dslr                          | Train Loss: 0.3403 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 2.3922 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2910 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.9352 | Train Acc: 0.2857
Average Train Accuracy: 0.5254
 Site-amazon                        | Val  Loss: 0.2214 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.1985 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1839 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.1275 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.6099 | Val  Acc: 0.9573
 Site-dslr                          | Val  Loss: 0.5140 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2230 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.6953 | Val  Acc: 0.6667
 Site-synthetic                     | Val  Loss: 2.2780 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2902 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.7091 | Val  Acc: 0.5714
Average Valid Accuracy: 0.7363
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:3 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9750
 Best site-amazon                    | Epoch:3 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.9573
 Best site-dslr                      | Epoch:3 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:3 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:3 | Val Acc: 0.6667
 Best site-synthetic                 | Epoch:3 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:3 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:3 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 4 ============
 Site-amazon                        | Train Loss: 1.6076 | Train Acc: 0.4762
 Site-amazon                        | Train Loss: 1.6999 | Train Acc: 0.4722
 Site-amazon                        | Train Loss: 1.0794 | Train Acc: 0.9180
 Site-amazon                        | Train Loss: 0.5789 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.1701 | Train Acc: 0.9548
 Site-dslr                          | Train Loss: 1.6072 | Train Acc: 0.5455
 Site-dslr                          | Train Loss: 1.3086 | Train Acc: 0.7895
 Site-dslr                          | Train Loss: 0.2261 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.4175 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.3000 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.8951 | Train Acc: 0.5238
Average Train Accuracy: 0.6009
 Site-amazon                        | Val  Loss: 0.1145 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2071 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0776 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1078 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.4684 | Val  Acc: 0.9744
 Site-dslr                          | Val  Loss: 0.2753 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2221 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.5734 | Val  Acc: 0.8095
 Site-synthetic                     | Val  Loss: 2.2926 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.1988 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.4697 | Val  Acc: 0.6429
Average Valid Accuracy: 0.7545
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.9744
 Best site-dslr                      | Epoch:4 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:4 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:4 | Val Acc: 0.8095
 Best site-synthetic                 | Epoch:4 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:4 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:4 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 5 ============
 Site-amazon                        | Train Loss: 1.4935 | Train Acc: 0.6190
 Site-amazon                        | Train Loss: 1.5123 | Train Acc: 0.5833
 Site-amazon                        | Train Loss: 0.8588 | Train Acc: 0.9672
 Site-amazon                        | Train Loss: 0.4419 | Train Acc: 0.9712
 Site-amazon                        | Train Loss: 0.1275 | Train Acc: 0.9661
 Site-dslr                          | Train Loss: 1.7251 | Train Acc: 0.5455
 Site-dslr                          | Train Loss: 1.3279 | Train Acc: 0.6316
 Site-dslr                          | Train Loss: 0.1753 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 2.4984 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.3839 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.7779 | Train Acc: 0.4286
Average Train Accuracy: 0.6102
 Site-amazon                        | Val  Loss: 0.1037 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2011 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 0.1152 | Val  Acc: 0.9500
 Site-amazon                        | Val  Loss: 0.1553 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 0.3627 | Val  Acc: 0.9487
 Site-dslr                          | Val  Loss: 0.3841 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.2024 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.6462 | Val  Acc: 0.7619
 Site-synthetic                     | Val  Loss: 2.2562 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2911 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.2573 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
============ Train epoch 6 ============
 Site-amazon                        | Train Loss: 1.3194 | Train Acc: 0.6190
 Site-amazon                        | Train Loss: 1.3790 | Train Acc: 0.6667
 Site-amazon                        | Train Loss: 0.6767 | Train Acc: 0.9672
 Site-amazon                        | Train Loss: 0.3368 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.0703 | Train Acc: 0.9887
 Site-dslr                          | Train Loss: 1.5859 | Train Acc: 0.5455
 Site-dslr                          | Train Loss: 1.1757 | Train Acc: 0.7368
 Site-dslr                          | Train Loss: 0.1673 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 2.4973 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.3488 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.6086 | Train Acc: 0.4762
Average Train Accuracy: 0.6272
 Site-amazon                        | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0543 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0555 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1332 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 0.2819 | Val  Acc: 0.9658
 Site-dslr                          | Val  Loss: 0.3307 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4974 | Val  Acc: 0.7619
 Site-synthetic                     | Val  Loss: 2.4107 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2778 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.1274 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7596
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9855
 Best site-amazon                    | Epoch:6 | Val Acc: 0.9658
 Best site-dslr                      | Epoch:6 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:6 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:6 | Val Acc: 0.7619
 Best site-synthetic                 | Epoch:6 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:6 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 7 ============
 Site-amazon                        | Train Loss: 1.2816 | Train Acc: 0.7143
 Site-amazon                        | Train Loss: 1.2748 | Train Acc: 0.7778
 Site-amazon                        | Train Loss: 0.5259 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.2912 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.0523 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 1.2550 | Train Acc: 0.7273
 Site-dslr                          | Train Loss: 1.0269 | Train Acc: 0.7895
 Site-dslr                          | Train Loss: 0.1620 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.7164 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.4473 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.6352 | Train Acc: 0.5714
Average Train Accuracy: 0.6808
 Site-amazon                        | Val  Loss: 0.1988 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0330 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0447 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.2001 | Val  Acc: 0.9744
 Site-dslr                          | Val  Loss: 0.2436 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.5122 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 2.3549 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.3818 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 1.0061 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7746
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9750
 Best site-amazon                    | Epoch:7 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:7 | Val Acc: 0.9744
 Best site-dslr                      | Epoch:7 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:7 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:7 | Val Acc: 0.8571
 Best site-synthetic                 | Epoch:7 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:7 | Val Acc: 0.0000
 Best site-webcam                    | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 8 ============
 Site-amazon                        | Train Loss: 0.9907 | Train Acc: 0.9048
 Site-amazon                        | Train Loss: 1.2374 | Train Acc: 0.6944
 Site-amazon                        | Train Loss: 0.3990 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2551 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.0446 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 1.2153 | Train Acc: 0.7273
 Site-dslr                          | Train Loss: 0.8306 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1388 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.6882 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.4209 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 1.4541 | Train Acc: 0.4762
Average Train Accuracy: 0.6881
 Site-amazon                        | Val  Loss: 0.1508 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0652 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0974 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 0.1928 | Val  Acc: 0.9658
 Site-dslr                          | Val  Loss: 0.2967 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1211 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.6132 | Val  Acc: 0.7619
 Site-synthetic                     | Val  Loss: 2.4670 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.4711 | Val  Acc: 0.0000
 Site-webcam                        | Val  Loss: 0.9457 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7481
============ Train epoch 9 ============
 Site-amazon                        | Train Loss: 1.0282 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.0646 | Train Acc: 0.7222
 Site-amazon                        | Train Loss: 0.2886 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1747 | Train Acc: 0.9712
 Site-amazon                        | Train Loss: 0.0288 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 1.0193 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.8878 | Train Acc: 0.7895
 Site-dslr                          | Train Loss: 0.0987 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 2.5193 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.3374 | Train Acc: 0.0435
 Site-webcam                        | Train Loss: 1.6144 | Train Acc: 0.6667
Average Train Accuracy: 0.7148
 Site-amazon                        | Val  Loss: 0.0938 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0452 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1472 | Val  Acc: 0.9658
 Site-dslr                          | Val  Loss: 0.4015 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0886 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.6720 | Val  Acc: 0.8095
 Site-synthetic                     | Val  Loss: 2.3478 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.3094 | Val  Acc: 0.0667
 Site-webcam                        | Val  Loss: 1.0261 | Val  Acc: 0.6429
Average Valid Accuracy: 0.7573
============ Train epoch 10 ============
 Site-amazon                        | Train Loss: 0.9785 | Train Acc: 0.7143
 Site-amazon                        | Train Loss: 0.8308 | Train Acc: 0.9167
 Site-amazon                        | Train Loss: 0.2612 | Train Acc: 0.9672
 Site-amazon                        | Train Loss: 0.1380 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 1.1445 | Train Acc: 0.7273
 Site-dslr                          | Train Loss: 0.7199 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1063 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 2.3924 | Train Acc: 0.1538
 Site-synthetic                     | Train Loss: 2.3158 | Train Acc: 0.0870
 Site-webcam                        | Train Loss: 1.5315 | Train Acc: 0.6190
Average Train Accuracy: 0.7263
 Site-amazon                        | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1260 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2875 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1192 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.6160 | Val  Acc: 0.7619
 Site-synthetic                     | Val  Loss: 2.2996 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.2919 | Val  Acc: 0.0667
 Site-webcam                        | Val  Loss: 0.7211 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7686
============ Train epoch 11 ============
 Site-amazon                        | Train Loss: 0.7444 | Train Acc: 0.9048
 Site-amazon                        | Train Loss: 0.8003 | Train Acc: 0.8889
 Site-amazon                        | Train Loss: 0.2006 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.1237 | Train Acc: 0.9712
 Site-amazon                        | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.9698 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.8396 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 2.1623 | Train Acc: 0.0769
 Site-synthetic                     | Train Loss: 2.0813 | Train Acc: 0.1739
 Site-webcam                        | Train Loss: 1.2424 | Train Acc: 0.6190
Average Train Accuracy: 0.7609
 Site-amazon                        | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0667 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0626 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1119 | Val  Acc: 0.9658
 Site-dslr                          | Val  Loss: 0.1785 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0906 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.3272 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 2.0187 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.0736 | Val  Acc: 0.1333
 Site-webcam                        | Val  Loss: 0.7411 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7784
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9750
 Best site-amazon                    | Epoch:11 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9658
 Best site-dslr                      | Epoch:11 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:11 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:11 | Val Acc: 0.8571
 Best site-synthetic                 | Epoch:11 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:11 | Val Acc: 0.1333
 Best site-webcam                    | Epoch:11 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 12 ============
 Site-amazon                        | Train Loss: 0.6609 | Train Acc: 0.9048
 Site-amazon                        | Train Loss: 0.6653 | Train Acc: 0.9444
 Site-amazon                        | Train Loss: 0.1774 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.0866 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0277 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 1.0228 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.7155 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1119 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.4459 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2510 | Train Acc: 0.0435
 Site-webcam                        | Train Loss: 1.1487 | Train Acc: 0.6190
Average Train Accuracy: 0.7372
 Site-amazon                        | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0144 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1299 | Val  Acc: 0.9573
 Site-dslr                          | Val  Loss: 0.2719 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1197 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.6850 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 2.2851 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 1.9944 | Val  Acc: 0.0667
 Site-webcam                        | Val  Loss: 0.5177 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7868
 Best site-amazon                    | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9573
 Best site-dslr                      | Epoch:12 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:12 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:12 | Val Acc: 0.8571
 Best site-synthetic                 | Epoch:12 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:12 | Val Acc: 0.0667
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 13 ============
 Site-amazon                        | Train Loss: 0.5161 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.5927 | Train Acc: 0.9444
 Site-amazon                        | Train Loss: 0.1513 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.0931 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0116 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.7361 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.7159 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1186 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.6429 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2362 | Train Acc: 0.0435
 Site-webcam                        | Train Loss: 1.2218 | Train Acc: 0.5714
Average Train Accuracy: 0.7412
 Site-amazon                        | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0537 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0981 | Val  Acc: 0.9744
 Site-dslr                          | Val  Loss: 0.1988 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1468 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.2508 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 2.1992 | Val  Acc: 0.0000
 Site-synthetic                     | Val  Loss: 2.0689 | Val  Acc: 0.1333
 Site-webcam                        | Val  Loss: 0.4387 | Val  Acc: 0.9286
Average Valid Accuracy: 0.7970
 Best site-amazon                    | Epoch:13 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:13 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:13 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9744
 Best site-dslr                      | Epoch:13 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:13 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:13 | Val Acc: 0.8571
 Best site-synthetic                 | Epoch:13 | Val Acc: 0.0000
 Best site-synthetic                 | Epoch:13 | Val Acc: 0.1333
 Best site-webcam                    | Epoch:13 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 14 ============
 Site-amazon                        | Train Loss: 0.4854 | Train Acc: 0.9524
 Site-amazon                        | Train Loss: 0.5449 | Train Acc: 0.9444
 Site-amazon                        | Train Loss: 0.1124 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1085 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0146 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 0.8033 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.4977 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1073 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.1611 | Train Acc: 0.0000
 Site-synthetic                     | Train Loss: 2.2080 | Train Acc: 0.1304
 Site-webcam                        | Train Loss: 0.9564 | Train Acc: 0.7619
Average Train Accuracy: 0.7726
 Site-amazon                        | Val  Loss: 0.1527 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1074 | Val  Acc: 0.9658
 Site-dslr                          | Val  Loss: 0.1976 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0880 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.5168 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 2.1795 | Val  Acc: 0.1250
 Site-synthetic                     | Val  Loss: 1.9264 | Val  Acc: 0.2000
 Site-webcam                        | Val  Loss: 0.4260 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8230
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9286
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9658
 Best site-dslr                      | Epoch:14 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:14 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:14 | Val Acc: 0.9048
 Best site-synthetic                 | Epoch:14 | Val Acc: 0.1250
 Best site-synthetic                 | Epoch:14 | Val Acc: 0.2000
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 15 ============
 Site-amazon                        | Train Loss: 0.4420 | Train Acc: 0.9524
 Site-amazon                        | Train Loss: 0.4355 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0945 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0888 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0138 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5657 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.5690 | Train Acc: 0.8947
 Site-dslr                          | Train Loss: 0.2140 | Train Acc: 0.8750
 Site-synthetic                     | Train Loss: 2.1661 | Train Acc: 0.1538
 Site-synthetic                     | Train Loss: 1.9323 | Train Acc: 0.1739
 Site-webcam                        | Train Loss: 1.2022 | Train Acc: 0.4762
Average Train Accuracy: 0.7626
 Site-amazon                        | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0679 | Val  Acc: 0.9744
 Site-dslr                          | Val  Loss: 0.3625 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1473 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.4109 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 1.8762 | Val  Acc: 0.1250
 Site-synthetic                     | Val  Loss: 1.7508 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 0.4734 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8045
============ Train epoch 16 ============
 Site-amazon                        | Train Loss: 0.3557 | Train Acc: 0.9524
 Site-amazon                        | Train Loss: 0.3963 | Train Acc: 0.9167
 Site-amazon                        | Train Loss: 0.0900 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0644 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5810 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.4300 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0837 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.9657 | Train Acc: 0.0769
 Site-synthetic                     | Train Loss: 1.7990 | Train Acc: 0.3913
 Site-webcam                        | Train Loss: 0.9455 | Train Acc: 0.7143
Average Train Accuracy: 0.8061
 Site-amazon                        | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0424 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0619 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2904 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1237 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1549 | Val  Acc: 1.0000
 Site-synthetic                     | Val  Loss: 1.7634 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.8394 | Val  Acc: 0.2667
 Site-webcam                        | Val  Loss: 0.2669 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8483
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9750
 Best site-amazon                    | Epoch:16 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9829
 Best site-dslr                      | Epoch:16 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:16 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:16 | Val Acc: 1.0000
 Best site-synthetic                 | Epoch:16 | Val Acc: 0.2500
 Best site-synthetic                 | Epoch:16 | Val Acc: 0.2667
 Best site-webcam                    | Epoch:16 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 17 ============
 Site-amazon                        | Train Loss: 0.3324 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.3090 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0880 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0868 | Train Acc: 0.9615
 Site-amazon                        | Train Loss: 0.0183 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 0.4352 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.6662 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1400 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.6044 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.7237 | Train Acc: 0.3043
 Site-webcam                        | Train Loss: 1.0983 | Train Acc: 0.5714
Average Train Accuracy: 0.8000
 Site-amazon                        | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0593 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.3919 | Val  Acc: 0.7143
 Site-dslr                          | Val  Loss: 0.0680 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4231 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.8565 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.5363 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.3611 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8407
============ Train epoch 18 ============
 Site-amazon                        | Train Loss: 0.2332 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.3372 | Train Acc: 0.9167
 Site-amazon                        | Train Loss: 0.0789 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.0645 | Train Acc: 0.9712
 Site-amazon                        | Train Loss: 0.0109 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3786 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.5453 | Train Acc: 0.8947
 Site-dslr                          | Train Loss: 0.1054 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 2.0440 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.7561 | Train Acc: 0.3913
 Site-webcam                        | Train Loss: 0.7836 | Train Acc: 0.7619
Average Train Accuracy: 0.8277
 Site-amazon                        | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0071 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0488 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1847 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1235 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.5420 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 1.4806 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.8151 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 0.3342 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8434
============ Train epoch 19 ============
 Site-amazon                        | Train Loss: 0.2709 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2679 | Train Acc: 0.9444
 Site-amazon                        | Train Loss: 0.0576 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0593 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0097 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.7711 | Train Acc: 0.7273
 Site-dslr                          | Train Loss: 0.2849 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.0929 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.8936 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.5933 | Train Acc: 0.3478
 Site-webcam                        | Train Loss: 0.5998 | Train Acc: 0.8095
Average Train Accuracy: 0.8117
 Site-amazon                        | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0129 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0512 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2120 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0800 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4224 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.8119 | Val  Acc: 0.3750
 Site-synthetic                     | Val  Loss: 1.6366 | Val  Acc: 0.2667
 Site-webcam                        | Val  Loss: 0.2934 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8641
 Best site-amazon                    | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:19 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9829
 Best site-dslr                      | Epoch:19 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:19 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:19 | Val Acc: 0.9524
 Best site-synthetic                 | Epoch:19 | Val Acc: 0.3750
 Best site-synthetic                 | Epoch:19 | Val Acc: 0.2667
 Best site-webcam                    | Epoch:19 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 20 ============
 Site-amazon                        | Train Loss: 0.1980 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2700 | Train Acc: 0.9444
 Site-amazon                        | Train Loss: 0.0618 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0784 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0092 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.4485 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.5421 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0828 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.7600 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.6029 | Train Acc: 0.3478
 Site-webcam                        | Train Loss: 0.8185 | Train Acc: 0.7619
Average Train Accuracy: 0.8280
 Site-amazon                        | Val  Loss: 0.1110 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0449 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1945 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1087 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.2117 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.6694 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.5335 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.3308 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8447
============ Train epoch 21 ============
 Site-amazon                        | Train Loss: 0.2389 | Train Acc: 0.9524
 Site-amazon                        | Train Loss: 0.2234 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0699 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.0621 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.4528 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.4139 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1264 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.5352 | Train Acc: 0.2308
 Site-synthetic                     | Train Loss: 1.5903 | Train Acc: 0.4348
 Site-webcam                        | Train Loss: 0.6336 | Train Acc: 0.8095
Average Train Accuracy: 0.8243
 Site-amazon                        | Val  Loss: 0.1762 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0838 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0353 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2272 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3620 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.3380 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.3212 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.2583 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8579
============ Train epoch 22 ============
 Site-amazon                        | Train Loss: 0.1971 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2737 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0700 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0470 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3438 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.7253 | Train Acc: 0.8947
 Site-dslr                          | Train Loss: 0.1029 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.8557 | Train Acc: 0.1538
 Site-synthetic                     | Train Loss: 1.4703 | Train Acc: 0.4348
 Site-webcam                        | Train Loss: 0.8459 | Train Acc: 0.6667
Average Train Accuracy: 0.8219
 Site-amazon                        | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0405 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.3159 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1254 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.0993 | Val  Acc: 1.0000
 Site-synthetic                     | Val  Loss: 1.6081 | Val  Acc: 0.2500
 Site-synthetic                     | Val  Loss: 1.2626 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.2870 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8547
============ Train epoch 23 ============
 Site-amazon                        | Train Loss: 0.1722 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1744 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0525 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0536 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2670 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.6155 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1108 | Train Acc: 0.9375
 Site-synthetic                     | Train Loss: 1.4751 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.5305 | Train Acc: 0.4783
 Site-webcam                        | Train Loss: 0.5374 | Train Acc: 0.8571
Average Train Accuracy: 0.8549
 Site-amazon                        | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1293 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0331 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.2290 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2134 | Val  Acc: 0.8333
 Site-dslr                          | Val  Loss: 0.4453 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 1.5188 | Val  Acc: 0.3750
 Site-synthetic                     | Val  Loss: 1.2999 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 0.1885 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8497
============ Train epoch 24 ============
 Site-amazon                        | Train Loss: 0.1719 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1667 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0479 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0555 | Train Acc: 0.9712
 Site-amazon                        | Train Loss: 0.0132 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 0.3306 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5707 | Train Acc: 0.8947
 Site-dslr                          | Train Loss: 0.1030 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2483 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 1.3932 | Train Acc: 0.5652
 Site-webcam                        | Train Loss: 0.5223 | Train Acc: 0.8571
Average Train Accuracy: 0.8760
 Site-amazon                        | Val  Loss: 0.2028 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0666 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2048 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0635 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.5384 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.4500 | Val  Acc: 0.3750
 Site-synthetic                     | Val  Loss: 1.2900 | Val  Acc: 0.4000
 Site-webcam                        | Val  Loss: 0.3531 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8589
============ Train epoch 25 ============
 Site-amazon                        | Train Loss: 0.1349 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1853 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0482 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0517 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2700 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5077 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0617 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.4006 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 1.1720 | Train Acc: 0.6522
 Site-webcam                        | Train Loss: 0.5648 | Train Acc: 0.8571
Average Train Accuracy: 0.9041
 Site-amazon                        | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0476 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.2472 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0897 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1356 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.2126 | Val  Acc: 0.3750
 Site-synthetic                     | Val  Loss: 1.2236 | Val  Acc: 0.6000
 Site-webcam                        | Val  Loss: 0.3049 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8815
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:25 | Val Acc: 0.9829
 Best site-dslr                      | Epoch:25 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:25 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:25 | Val Acc: 0.9524
 Best site-synthetic                 | Epoch:25 | Val Acc: 0.3750
 Best site-synthetic                 | Epoch:25 | Val Acc: 0.6000
 Best site-webcam                    | Epoch:25 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 26 ============
 Site-amazon                        | Train Loss: 0.1484 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1571 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0491 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0344 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.4282 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.1774 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0717 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.5311 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.2711 | Train Acc: 0.5217
 Site-webcam                        | Train Loss: 0.6954 | Train Acc: 0.8571
Average Train Accuracy: 0.8667
 Site-amazon                        | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0387 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.1342 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1895 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.4198 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.1600 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 1.0476 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 0.2532 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9065
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:26 | Val Acc: 0.9829
 Best site-dslr                      | Epoch:26 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:26 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:26 | Val Acc: 0.9048
 Best site-synthetic                 | Epoch:26 | Val Acc: 0.5000
 Best site-synthetic                 | Epoch:26 | Val Acc: 0.6667
 Best site-webcam                    | Epoch:26 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 27 ============
 Site-amazon                        | Train Loss: 0.1180 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1586 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0490 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2492 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.2646 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0816 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.4402 | Train Acc: 0.4615
 Site-synthetic                     | Train Loss: 1.1759 | Train Acc: 0.4783
 Site-webcam                        | Train Loss: 0.5850 | Train Acc: 0.8571
Average Train Accuracy: 0.8730
 Site-amazon                        | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0352 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.4458 | Val  Acc: 0.7143
 Site-dslr                          | Val  Loss: 0.1018 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.3535 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.1635 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 1.1527 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.2273 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8780
============ Train epoch 28 ============
 Site-amazon                        | Train Loss: 0.1519 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1623 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0549 | Train Acc: 0.9836
 Site-amazon                        | Train Loss: 0.0328 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3314 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1374 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1035 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.1747 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.2905 | Train Acc: 0.7391
 Site-webcam                        | Train Loss: 0.5721 | Train Acc: 0.8571
Average Train Accuracy: 0.8952
 Site-amazon                        | Val  Loss: 0.0110 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1357 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3880 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0531 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4736 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 1.1864 | Val  Acc: 0.7500
 Site-synthetic                     | Val  Loss: 1.2433 | Val  Acc: 0.4667
 Site-webcam                        | Val  Loss: 0.2403 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8924
============ Train epoch 29 ============
 Site-amazon                        | Train Loss: 0.1327 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1412 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0390 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0390 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2480 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.4814 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0653 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.0259 | Train Acc: 0.3077
 Site-synthetic                     | Train Loss: 1.1747 | Train Acc: 0.6087
 Site-webcam                        | Train Loss: 0.3807 | Train Acc: 0.9048
Average Train Accuracy: 0.8761
 Site-amazon                        | Val  Loss: 0.1031 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0722 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0312 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.2404 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1371 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.4971 | Val  Acc: 0.8571
 Site-synthetic                     | Val  Loss: 0.9315 | Val  Acc: 0.7500
 Site-synthetic                     | Val  Loss: 1.0219 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 0.1410 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9022
============ Train epoch 30 ============
 Site-amazon                        | Train Loss: 0.1162 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1205 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0446 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0356 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3839 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.5420 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0493 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.1630 | Train Acc: 0.6154
 Site-synthetic                     | Train Loss: 1.0895 | Train Acc: 0.7391
 Site-webcam                        | Train Loss: 0.5716 | Train Acc: 0.8571
Average Train Accuracy: 0.9061
 Site-amazon                        | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1083 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0395 | Val  Acc: 0.9829
 Site-dslr                          | Val  Loss: 0.1229 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1112 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.1636 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.0732 | Val  Acc: 0.7500
 Site-synthetic                     | Val  Loss: 0.9155 | Val  Acc: 0.6000
 Site-webcam                        | Val  Loss: 0.1906 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9235
 Best site-amazon                    | Epoch:30 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:30 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:30 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:30 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:30 | Val Acc: 0.9829
 Best site-dslr                      | Epoch:30 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:30 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:30 | Val Acc: 0.9524
 Best site-synthetic                 | Epoch:30 | Val Acc: 0.7500
 Best site-synthetic                 | Epoch:30 | Val Acc: 0.6000
 Best site-webcam                    | Epoch:30 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 31 ============
 Site-amazon                        | Train Loss: 0.1173 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1215 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0427 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0331 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2702 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.3458 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1270 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.3294 | Train Acc: 0.6154
 Site-synthetic                     | Train Loss: 1.2353 | Train Acc: 0.6957
 Site-webcam                        | Train Loss: 0.5472 | Train Acc: 0.8095
Average Train Accuracy: 0.9042
 Site-amazon                        | Val  Loss: 0.0216 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0358 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1875 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0648 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4831 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.0636 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 0.9083 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.2473 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9252
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:31 | Val Acc: 0.9915
 Best site-dslr                      | Epoch:31 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:31 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:31 | Val Acc: 0.9524
 Best site-synthetic                 | Epoch:31 | Val Acc: 0.5000
 Best site-synthetic                 | Epoch:31 | Val Acc: 0.7333
 Best site-webcam                    | Epoch:31 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 32 ============
 Site-amazon                        | Train Loss: 0.1188 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1552 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0220 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0050 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3055 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5311 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0673 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.3860 | Train Acc: 0.6154
 Site-synthetic                     | Train Loss: 1.0436 | Train Acc: 0.7391
 Site-webcam                        | Train Loss: 0.4465 | Train Acc: 0.9048
Average Train Accuracy: 0.9254
 Site-amazon                        | Val  Loss: 0.0854 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1041 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0808 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4683 | Val  Acc: 0.8095
 Site-synthetic                     | Val  Loss: 1.0786 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.7405 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.1519 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9179
============ Train epoch 33 ============
 Site-amazon                        | Train Loss: 0.1311 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1536 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0580 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0233 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2881 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.4008 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1124 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.4510 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 1.2155 | Train Acc: 0.6087
 Site-webcam                        | Train Loss: 0.4849 | Train Acc: 0.8571
Average Train Accuracy: 0.8796
 Site-amazon                        | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1249 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0402 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1360 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1950 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.1486 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.8920 | Val  Acc: 0.5333
 Site-webcam                        | Val  Loss: 0.2920 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9101
============ Train epoch 34 ============
 Site-amazon                        | Train Loss: 0.1148 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1282 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0462 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0435 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2572 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.5246 | Train Acc: 0.8421
 Site-dslr                          | Train Loss: 0.1032 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2007 | Train Acc: 0.4615
 Site-synthetic                     | Train Loss: 1.1103 | Train Acc: 0.6087
 Site-webcam                        | Train Loss: 0.3806 | Train Acc: 0.9048
Average Train Accuracy: 0.8805
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0313 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1782 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0691 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3619 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.2387 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 1.0273 | Val  Acc: 0.6000
 Site-webcam                        | Val  Loss: 0.2134 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9023
============ Train epoch 35 ============
 Site-amazon                        | Train Loss: 0.1205 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1138 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0450 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0496 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0231 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 0.3347 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.5434 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0767 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2155 | Train Acc: 0.6154
 Site-synthetic                     | Train Loss: 1.1521 | Train Acc: 0.6087
 Site-webcam                        | Train Loss: 0.7660 | Train Acc: 0.7143
Average Train Accuracy: 0.8862
 Site-amazon                        | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0252 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0423 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0233 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.0828 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0270 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3508 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.2064 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 1.0455 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.2246 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9121
============ Train epoch 36 ============
 Site-amazon                        | Train Loss: 0.1322 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1515 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0519 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0472 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3006 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.4831 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1006 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.1676 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 1.2936 | Train Acc: 0.5652
 Site-webcam                        | Train Loss: 0.4591 | Train Acc: 0.9048
Average Train Accuracy: 0.8782
 Site-amazon                        | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.1814 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0990 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0283 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.2779 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3718 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.0050 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.9108 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.2298 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9130
============ Train epoch 37 ============
 Site-amazon                        | Train Loss: 0.1429 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1907 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0600 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0425 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2359 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.2623 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0778 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.3878 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 1.0829 | Train Acc: 0.7826
 Site-webcam                        | Train Loss: 0.5401 | Train Acc: 0.9048
Average Train Accuracy: 0.8955
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0980 | Val  Acc: 0.9855
 Site-amazon                        | Val  Loss: 0.0338 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.3811 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4298 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.0989 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 1.1879 | Val  Acc: 0.6000
 Site-webcam                        | Val  Loss: 0.1915 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8988
============ Train epoch 38 ============
 Site-amazon                        | Train Loss: 0.1436 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1626 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0559 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0349 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0260 | Train Acc: 0.9887
 Site-dslr                          | Train Loss: 0.2955 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.5599 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1126 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2773 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 1.0962 | Train Acc: 0.6522
 Site-webcam                        | Train Loss: 0.4949 | Train Acc: 0.8095
Average Train Accuracy: 0.8839
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2581 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1170 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-synthetic                     | Val  Loss: 1.1445 | Val  Acc: 0.3750
 Site-synthetic                     | Val  Loss: 0.9192 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.1960 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9114
============ Train epoch 39 ============
 Site-amazon                        | Train Loss: 0.1144 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1616 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0507 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0677 | Train Acc: 0.9808
 Site-amazon                        | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.4869 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.1344 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0694 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.3249 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 0.9851 | Train Acc: 0.6957
 Site-webcam                        | Train Loss: 0.3823 | Train Acc: 0.9048
Average Train Accuracy: 0.9006
 Site-amazon                        | Val  Loss: 0.0407 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1247 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0737 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.0761 | Val  Acc: 1.0000
 Site-synthetic                     | Val  Loss: 0.9642 | Val  Acc: 0.7500
 Site-synthetic                     | Val  Loss: 0.8848 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 0.1691 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9394
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:39 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:39 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:39 | Val Acc: 0.9167
 Best site-dslr                      | Epoch:39 | Val Acc: 1.0000
 Best site-synthetic                 | Epoch:39 | Val Acc: 0.7500
 Best site-synthetic                 | Epoch:39 | Val Acc: 0.6667
 Best site-webcam                    | Epoch:39 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 40 ============
 Site-amazon                        | Train Loss: 0.1298 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1501 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0492 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0423 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1929 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3969 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.2254 | Train Acc: 0.4615
 Site-synthetic                     | Train Loss: 0.9595 | Train Acc: 0.7826
 Site-webcam                        | Train Loss: 0.5136 | Train Acc: 0.8571
Average Train Accuracy: 0.9110
 Site-amazon                        | Val  Loss: 0.2067 | Val  Acc: 0.9286
 Site-amazon                        | Val  Loss: 0.0949 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0245 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3317 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0933 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.3470 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 0.9671 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 0.7200 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.2708 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8950
============ Train epoch 41 ============
 Site-amazon                        | Train Loss: 0.1374 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1663 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0592 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2285 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.5029 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1447 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 0.9061 | Train Acc: 0.6154
 Site-synthetic                     | Train Loss: 0.9402 | Train Acc: 0.6957
 Site-webcam                        | Train Loss: 0.3567 | Train Acc: 0.9524
Average Train Accuracy: 0.9229
 Site-amazon                        | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0190 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0661 | Val  Acc: 0.9750
 Site-amazon                        | Val  Loss: 0.0299 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0285 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.1901 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0255 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4364 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 1.0391 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.9189 | Val  Acc: 0.8000
 Site-webcam                        | Val  Loss: 0.2353 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9230
============ Train epoch 42 ============
 Site-amazon                        | Train Loss: 0.1292 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1403 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0601 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0280 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3343 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.1328 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.0611 | Train Acc: 1.0000
 Site-synthetic                     | Train Loss: 1.2447 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 1.0888 | Train Acc: 0.6522
 Site-webcam                        | Train Loss: 0.5794 | Train Acc: 0.9048
Average Train Accuracy: 0.8955
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0971 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.4246 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 0.9965 | Val  Acc: 0.5000
 Site-synthetic                     | Val  Loss: 0.8739 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 0.2412 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9091
============ Train epoch 43 ============
 Site-amazon                        | Train Loss: 0.1565 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1469 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0626 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0362 | Train Acc: 0.9904
 Site-amazon                        | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3918 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.4767 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1175 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.1549 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 1.1879 | Train Acc: 0.6522
 Site-webcam                        | Train Loss: 0.4904 | Train Acc: 0.8095
Average Train Accuracy: 0.8923
 Site-amazon                        | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1361 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1740 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.4334 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 0.9379 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.8555 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.3148 | Val  Acc: 0.9286
Average Valid Accuracy: 0.9189
============ Train epoch 44 ============
 Site-amazon                        | Train Loss: 0.1372 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1617 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0491 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0141 | Train Acc: 0.9944
 Site-dslr                          | Train Loss: 0.1939 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.1340 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1407 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 1.2300 | Train Acc: 0.6923
 Site-synthetic                     | Train Loss: 1.0844 | Train Acc: 0.6522
 Site-webcam                        | Train Loss: 0.5638 | Train Acc: 0.9048
Average Train Accuracy: 0.9144
 Site-amazon                        | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0336 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.3711 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.1405 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.4367 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 0.9095 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.8131 | Val  Acc: 0.7333
 Site-webcam                        | Val  Loss: 0.2032 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9160
============ Train epoch 45 ============
 Site-amazon                        | Train Loss: 0.1507 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1693 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0540 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0240 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.7113 | Train Acc: 0.8182
 Site-dslr                          | Train Loss: 0.1479 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1235 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2324 | Train Acc: 0.6923
 Site-synthetic                     | Train Loss: 1.0838 | Train Acc: 0.6087
 Site-webcam                        | Train Loss: 0.4847 | Train Acc: 0.8095
Average Train Accuracy: 0.8925
 Site-amazon                        | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0321 | Val  Acc: 0.9915
 Site-dslr                          | Val  Loss: 0.2185 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3071 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.0626 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.9204 | Val  Acc: 0.5333
 Site-webcam                        | Val  Loss: 0.2583 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9054
============ Train epoch 46 ============
 Site-amazon                        | Train Loss: 0.1388 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1548 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0507 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3565 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.5166 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1163 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.3673 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 1.0793 | Train Acc: 0.5217
 Site-webcam                        | Train Loss: 0.4447 | Train Acc: 0.8571
Average Train Accuracy: 0.8832
 Site-amazon                        | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2936 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.3926 | Val  Acc: 0.9048
 Site-synthetic                     | Val  Loss: 0.9388 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.9221 | Val  Acc: 0.5333
 Site-webcam                        | Val  Loss: 0.2458 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9073
============ Train epoch 47 ============
 Site-amazon                        | Train Loss: 0.1067 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1953 | Train Acc: 0.9722
 Site-amazon                        | Train Loss: 0.0511 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0317 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.3519 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.2521 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1527 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.2930 | Train Acc: 0.3846
 Site-synthetic                     | Train Loss: 0.9851 | Train Acc: 0.6957
 Site-webcam                        | Train Loss: 0.5816 | Train Acc: 0.8571
Average Train Accuracy: 0.8850
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0168 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.5338 | Val  Acc: 0.7143
 Site-dslr                          | Val  Loss: 0.1357 | Val  Acc: 0.9167
 Site-dslr                          | Val  Loss: 0.2168 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 1.0236 | Val  Acc: 0.6250
 Site-synthetic                     | Val  Loss: 0.7552 | Val  Acc: 0.8000
 Site-webcam                        | Val  Loss: 0.2249 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9098
============ Train epoch 48 ============
 Site-amazon                        | Train Loss: 0.1233 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1290 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0453 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0269 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2061 | Train Acc: 0.9091
 Site-dslr                          | Train Loss: 0.2617 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1939 | Train Acc: 0.9062
 Site-synthetic                     | Train Loss: 1.2058 | Train Acc: 0.4615
 Site-synthetic                     | Train Loss: 0.9572 | Train Acc: 0.7391
 Site-webcam                        | Train Loss: 0.4427 | Train Acc: 0.9048
Average Train Accuracy: 0.8971
 Site-amazon                        | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0006 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.2220 | Val  Acc: 0.8571
 Site-dslr                          | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.3766 | Val  Acc: 0.9524
 Site-synthetic                     | Val  Loss: 0.7528 | Val  Acc: 0.8750
 Site-synthetic                     | Val  Loss: 0.9933 | Val  Acc: 0.8000
 Site-webcam                        | Val  Loss: 0.2387 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9531
 Best site-amazon                    | Epoch:48 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:48 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:48 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:48 | Val Acc: 1.0000
 Best site-amazon                    | Epoch:48 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:48 | Val Acc: 0.8571
 Best site-dslr                      | Epoch:48 | Val Acc: 1.0000
 Best site-dslr                      | Epoch:48 | Val Acc: 0.9524
 Best site-synthetic                 | Epoch:48 | Val Acc: 0.8750
 Best site-synthetic                 | Epoch:48 | Val Acc: 0.8000
 Best site-webcam                    | Epoch:48 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_office_uneven_1.7_1/harmo-fl...
============ Train epoch 49 ============
 Site-amazon                        | Train Loss: 0.1290 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1223 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0490 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0207 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.2536 | Train Acc: 1.0000
 Site-dslr                          | Train Loss: 0.1588 | Train Acc: 0.9474
 Site-dslr                          | Train Loss: 0.1769 | Train Acc: 0.9688
 Site-synthetic                     | Train Loss: 1.3461 | Train Acc: 0.5385
 Site-synthetic                     | Train Loss: 0.8612 | Train Acc: 0.6957
 Site-webcam                        | Train Loss: 0.5953 | Train Acc: 0.8095
Average Train Accuracy: 0.9054
 Site-amazon                        | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0003 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0004 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.1317 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-dslr                          | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-synthetic                     | Val  Loss: 0.7836 | Val  Acc: 0.7500
 Site-synthetic                     | Val  Loss: 0.8734 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 0.1803 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9470
===2023-07-28 16:47:52===
===2023-07-28 16:48:04===
===Setting===
    dataset: office
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[21,36,61,104,177,11,19,32,13,23,21,
client_nums=[5,3,2,1,]
len_dataset=[667,106,62,36,]
domain number = 4
Loading snapshots...
 Test site-amazon                    (0)| Epoch:48 | Test Acc: 0.6942
 Test site-dslr                      (3)| Epoch:48 | Test Acc: 0.7059
 Test site-synthetic                 (0)| Epoch:48 | Test Acc: 0.4567
 Test site-webcam                    (3)| Epoch:48 | Test Acc: 0.5699
amazon: 0.6942, dslr: 0.7059, synthetic: 0.4567, webcam: 0.5699, 
Average Test Accuracy(group): 0.6066, Average Test Accuracy(individual): 0.6429,
domain std=0.1017, cluster std=0.0509, individual std=0.0952, 
