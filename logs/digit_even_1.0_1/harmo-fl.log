===2023-05-12 15:25:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[297,891,297,891,297,891,297,891,297,891,
client_nums=[2,2,2,2,2,domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.4191 | Train Acc: 0.7306
 Site-MNIST     | Train Loss: 1.4981 | Train Acc: 0.6599
 Site-USPS      | Train Loss: 1.2090 | Train Acc: 0.8047
 Site-USPS      | Train Loss: 1.2261 | Train Acc: 0.7621
 Site-SynthDigits| Train Loss: 1.9465 | Train Acc: 0.3502
 Site-SynthDigits| Train Loss: 1.9112 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.1114 | Train Acc: 0.2997
 Site-MNIST-M   | Train Loss: 2.0962 | Train Acc: 0.3042
 Site-SVHN      | Train Loss: 2.1733 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 2.1587 | Train Acc: 0.2413
 Site-MNIST     | Val  Loss: 1.4591 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.4668 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 1.2122 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 1.2229 | Val  Acc: 0.7477
 Site-SynthDigits| Val  Loss: 1.9346 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 1.9466 | Val  Acc: 0.3198
 Site-MNIST-M   | Val  Loss: 2.1404 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 2.1030 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.2051 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1355 | Val  Acc: 0.2613
Average Valid Accuracy: 0.4640
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-USPS       | Epoch:0 | Val Acc: 0.7432
 Best site-USPS       | Epoch:0 | Val Acc: 0.7477
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3198
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2613
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 0.9686 | Train Acc: 0.7879
 Site-MNIST     | Train Loss: 1.0648 | Train Acc: 0.7329
 Site-USPS      | Train Loss: 0.8415 | Train Acc: 0.8249
 Site-USPS      | Train Loss: 0.8552 | Train Acc: 0.8260
 Site-SynthDigits| Train Loss: 1.5859 | Train Acc: 0.5118
 Site-SynthDigits| Train Loss: 1.5501 | Train Acc: 0.5365
 Site-MNIST-M   | Train Loss: 1.8696 | Train Acc: 0.4276
 Site-MNIST-M   | Train Loss: 1.8577 | Train Acc: 0.3928
 Site-SVHN      | Train Loss: 2.0187 | Train Acc: 0.3232
 Site-SVHN      | Train Loss: 1.9526 | Train Acc: 0.3704
 Site-MNIST     | Val  Loss: 0.9119 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.0000 | Val  Acc: 0.8018
 Site-USPS      | Val  Loss: 0.7953 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.8809 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.6409 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.6158 | Val  Acc: 0.4640
 Site-MNIST-M   | Val  Loss: 1.9121 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.8296 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.9708 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.9269 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5739
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8018
 Best site-USPS       | Epoch:1 | Val Acc: 0.8649
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4640
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 0.7469 | Train Acc: 0.8215
 Site-MNIST     | Train Loss: 0.8383 | Train Acc: 0.7778
 Site-USPS      | Train Loss: 0.5811 | Train Acc: 0.8653
 Site-USPS      | Train Loss: 0.6107 | Train Acc: 0.8485
 Site-SynthDigits| Train Loss: 1.5284 | Train Acc: 0.4882
 Site-SynthDigits| Train Loss: 1.4478 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.7476 | Train Acc: 0.4411
 Site-MNIST-M   | Train Loss: 1.7421 | Train Acc: 0.4287
 Site-SVHN      | Train Loss: 1.9817 | Train Acc: 0.3535
 Site-SVHN      | Train Loss: 1.9111 | Train Acc: 0.3782
 Site-MNIST     | Val  Loss: 0.7026 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.7622 | Val  Acc: 0.8288
 Site-USPS      | Val  Loss: 0.5543 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.6339 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.5810 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.5262 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.8516 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.7051 | Val  Acc: 0.4414
 Site-SVHN      | Val  Loss: 1.9340 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 1.8903 | Val  Acc: 0.3784
Average Valid Accuracy: 0.5865
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8288
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-USPS       | Epoch:2 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4414
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 0.6734 | Train Acc: 0.8013
 Site-MNIST     | Train Loss: 0.7546 | Train Acc: 0.7868
 Site-USPS      | Train Loss: 0.5251 | Train Acc: 0.8620
 Site-USPS      | Train Loss: 0.5496 | Train Acc: 0.8519
 Site-SynthDigits| Train Loss: 1.3423 | Train Acc: 0.5724
 Site-SynthDigits| Train Loss: 1.2844 | Train Acc: 0.5859
 Site-MNIST-M   | Train Loss: 1.6568 | Train Acc: 0.4512
 Site-MNIST-M   | Train Loss: 1.6583 | Train Acc: 0.4467
 Site-SVHN      | Train Loss: 1.9163 | Train Acc: 0.3670
 Site-SVHN      | Train Loss: 1.7842 | Train Acc: 0.4040
 Site-MNIST     | Val  Loss: 0.5798 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.6721 | Val  Acc: 0.8153
 Site-USPS      | Val  Loss: 0.4994 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.6001 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.3265 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.3510 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.7742 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.5952 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.7601 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7651 | Val  Acc: 0.4144
Average Valid Accuracy: 0.6216
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8153
 Best site-USPS       | Epoch:3 | Val Acc: 0.8514
 Best site-USPS       | Epoch:3 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4144
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.5418 | Train Acc: 0.8586
 Site-MNIST     | Train Loss: 0.6301 | Train Acc: 0.8204
 Site-USPS      | Train Loss: 0.4763 | Train Acc: 0.8754
 Site-USPS      | Train Loss: 0.4798 | Train Acc: 0.8563
 Site-SynthDigits| Train Loss: 1.2938 | Train Acc: 0.5724
 Site-SynthDigits| Train Loss: 1.2148 | Train Acc: 0.6072
 Site-MNIST-M   | Train Loss: 1.5822 | Train Acc: 0.4983
 Site-MNIST-M   | Train Loss: 1.5529 | Train Acc: 0.4815
 Site-SVHN      | Train Loss: 1.8693 | Train Acc: 0.3670
 Site-SVHN      | Train Loss: 1.7373 | Train Acc: 0.4052
 Site-MNIST     | Val  Loss: 0.4875 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.5638 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.4160 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.5374 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.2561 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.2802 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.6801 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.4905 | Val  Acc: 0.5180
 Site-SVHN      | Val  Loss: 1.7256 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.7233 | Val  Acc: 0.3964
Average Valid Accuracy: 0.6279
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-USPS       | Epoch:4 | Val Acc: 0.8514
 Best site-USPS       | Epoch:4 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5180
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3964
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.4968 | Train Acc: 0.8620
 Site-MNIST     | Train Loss: 0.5746 | Train Acc: 0.8384
 Site-USPS      | Train Loss: 0.4193 | Train Acc: 0.8956
 Site-USPS      | Train Loss: 0.4220 | Train Acc: 0.8844
 Site-SynthDigits| Train Loss: 1.2450 | Train Acc: 0.6162
 Site-SynthDigits| Train Loss: 1.1584 | Train Acc: 0.6386
 Site-MNIST-M   | Train Loss: 1.5325 | Train Acc: 0.5084
 Site-MNIST-M   | Train Loss: 1.4821 | Train Acc: 0.5275
 Site-SVHN      | Train Loss: 1.8398 | Train Acc: 0.3805
 Site-SVHN      | Train Loss: 1.6975 | Train Acc: 0.4175
 Site-MNIST     | Val  Loss: 0.4221 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.5103 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.3761 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4789 | Val  Acc: 0.8739
 Site-SynthDigits| Val  Loss: 1.1765 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 1.2203 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.6190 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.4152 | Val  Acc: 0.5495
 Site-SVHN      | Val  Loss: 1.6533 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 1.6734 | Val  Acc: 0.4279
Average Valid Accuracy: 0.6649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-USPS       | Epoch:5 | Val Acc: 0.8919
 Best site-USPS       | Epoch:5 | Val Acc: 0.8739
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5495
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4279
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.4509 | Train Acc: 0.8687
 Site-MNIST     | Train Loss: 0.5053 | Train Acc: 0.8563
 Site-USPS      | Train Loss: 0.3705 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3758 | Train Acc: 0.8967
 Site-SynthDigits| Train Loss: 1.1918 | Train Acc: 0.6330
 Site-SynthDigits| Train Loss: 1.1219 | Train Acc: 0.6330
 Site-MNIST-M   | Train Loss: 1.4469 | Train Acc: 0.5387
 Site-MNIST-M   | Train Loss: 1.4049 | Train Acc: 0.5410
 Site-SVHN      | Train Loss: 1.8279 | Train Acc: 0.3805
 Site-SVHN      | Train Loss: 1.6555 | Train Acc: 0.4276
 Site-MNIST     | Val  Loss: 0.3766 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4542 | Val  Acc: 0.8739
 Site-USPS      | Val  Loss: 0.3379 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4253 | Val  Acc: 0.8829
 Site-SynthDigits| Val  Loss: 1.1367 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 1.1695 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.5574 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.3500 | Val  Acc: 0.5721
 Site-SVHN      | Val  Loss: 1.5950 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.6356 | Val  Acc: 0.4279
Average Valid Accuracy: 0.6770
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8739
 Best site-USPS       | Epoch:6 | Val Acc: 0.8919
 Best site-USPS       | Epoch:6 | Val Acc: 0.8829
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5721
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4279
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.4348 | Train Acc: 0.8721
 Site-MNIST     | Train Loss: 0.4664 | Train Acc: 0.8631
 Site-USPS      | Train Loss: 0.3522 | Train Acc: 0.9125
 Site-USPS      | Train Loss: 0.3472 | Train Acc: 0.9057
 Site-SynthDigits| Train Loss: 1.1610 | Train Acc: 0.6465
 Site-SynthDigits| Train Loss: 1.0776 | Train Acc: 0.6588
 Site-MNIST-M   | Train Loss: 1.4201 | Train Acc: 0.5354
 Site-MNIST-M   | Train Loss: 1.3470 | Train Acc: 0.5657
 Site-SVHN      | Train Loss: 1.7964 | Train Acc: 0.3704
 Site-SVHN      | Train Loss: 1.6066 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.3345 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.4100 | Val  Acc: 0.8964
 Site-USPS      | Val  Loss: 0.3266 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.4023 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.1153 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 1.1253 | Val  Acc: 0.6577
 Site-MNIST-M   | Val  Loss: 1.4629 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2763 | Val  Acc: 0.5991
 Site-SVHN      | Val  Loss: 1.5162 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.5782 | Val  Acc: 0.4730
Average Valid Accuracy: 0.7032
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8964
 Best site-USPS       | Epoch:7 | Val Acc: 0.9054
 Best site-USPS       | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6577
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5991
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.3726 | Train Acc: 0.9057
 Site-MNIST     | Train Loss: 0.4196 | Train Acc: 0.8810
 Site-USPS      | Train Loss: 0.3277 | Train Acc: 0.9360
 Site-USPS      | Train Loss: 0.3230 | Train Acc: 0.9158
 Site-SynthDigits| Train Loss: 1.1119 | Train Acc: 0.6431
 Site-SynthDigits| Train Loss: 1.0480 | Train Acc: 0.6554
 Site-MNIST-M   | Train Loss: 1.3491 | Train Acc: 0.5758
 Site-MNIST-M   | Train Loss: 1.2993 | Train Acc: 0.5802
 Site-SVHN      | Train Loss: 1.7784 | Train Acc: 0.4108
 Site-SVHN      | Train Loss: 1.5803 | Train Acc: 0.4635
 Site-MNIST     | Val  Loss: 0.2907 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.3659 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.2912 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3763 | Val  Acc: 0.9099
 Site-SynthDigits| Val  Loss: 1.0721 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.1066 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.4217 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2136 | Val  Acc: 0.5991
 Site-SVHN      | Val  Loss: 1.4993 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.5640 | Val  Acc: 0.4955
Average Valid Accuracy: 0.7122
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-USPS       | Epoch:8 | Val Acc: 0.9324
 Best site-USPS       | Epoch:8 | Val Acc: 0.9099
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5991
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4955
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.3710 | Train Acc: 0.8923
 Site-MNIST     | Train Loss: 0.3945 | Train Acc: 0.8900
 Site-USPS      | Train Loss: 0.2984 | Train Acc: 0.9360
 Site-USPS      | Train Loss: 0.2986 | Train Acc: 0.9226
 Site-SynthDigits| Train Loss: 1.0852 | Train Acc: 0.6532
 Site-SynthDigits| Train Loss: 1.0061 | Train Acc: 0.6790
 Site-MNIST-M   | Train Loss: 1.3291 | Train Acc: 0.5724
 Site-MNIST-M   | Train Loss: 1.2512 | Train Acc: 0.5993
 Site-SVHN      | Train Loss: 1.7316 | Train Acc: 0.4377
 Site-SVHN      | Train Loss: 1.5411 | Train Acc: 0.4826
 Site-MNIST     | Val  Loss: 0.2779 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.3382 | Val  Acc: 0.9009
 Site-USPS      | Val  Loss: 0.2707 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3503 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0311 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.0455 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.3539 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.1560 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 1.4623 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.5227 | Val  Acc: 0.5180
Average Valid Accuracy: 0.7230
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9009
 Best site-USPS       | Epoch:9 | Val Acc: 0.9324
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5180
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8757
 Test site-USPS      | Epoch:9 | Test Acc: 0.9108
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6399
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4931
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3893
Average Test Accuracy: 0.6618
============ Train epoch 10 ============
===2023-05-13 16:22:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST           | Train Loss: 1.3266 | Train Acc: 0.7332
 Site-MNIST           | Train Loss: 1.4026 | Train Acc: 0.6538
 Site-USPS            | Train Loss: 1.2121 | Train Acc: 0.7197
 Site-USPS            | Train Loss: 1.1884 | Train Acc: 0.7596
 Site-SynthDigits     | Train Loss: 1.8216 | Train Acc: 0.3639
 Site-SynthDigits     | Train Loss: 1.7592 | Train Acc: 0.4287
 Site-MNIST-M         | Train Loss: 2.0392 | Train Acc: 0.3235
 Site-MNIST-M         | Train Loss: 2.0506 | Train Acc: 0.3112
 Site-SVHN            | Train Loss: 2.1465 | Train Acc: 0.2480
 Site-SVHN            | Train Loss: 2.0920 | Train Acc: 0.2834
 Site-MNIST           | Val  Loss: 1.4448 | Val  Acc: 0.6087
 Site-MNIST           | Val  Loss: 1.3987 | Val  Acc: 0.6906
 Site-USPS            | Val  Loss: 1.2838 | Val  Acc: 0.7283
 Site-USPS            | Val  Loss: 1.2444 | Val  Acc: 0.7302
 Site-SynthDigits     | Val  Loss: 1.7863 | Val  Acc: 0.4130
 Site-SynthDigits     | Val  Loss: 1.7942 | Val  Acc: 0.3993
 Site-MNIST-M         | Val  Loss: 2.0318 | Val  Acc: 0.3478
 Site-MNIST-M         | Val  Loss: 2.0210 | Val  Acc: 0.3309
 Site-SVHN            | Val  Loss: 2.0567 | Val  Acc: 0.2609
 Site-SVHN            | Val  Loss: 2.1171 | Val  Acc: 0.2734
Average Valid Accuracy: 0.4783
 Best site-MNIST            | Epoch:0 | Val Acc: 0.6087
 Best site-MNIST            | Epoch:0 | Val Acc: 0.6906
 Best site-USPS             | Epoch:0 | Val Acc: 0.7283
 Best site-USPS             | Epoch:0 | Val Acc: 0.7302
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.4130
 Best site-SynthDigits      | Epoch:0 | Val Acc: 0.3993
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.3478
 Best site-MNIST-M          | Epoch:0 | Val Acc: 0.3309
 Best site-SVHN             | Epoch:0 | Val Acc: 0.2609
 Best site-SVHN             | Epoch:0 | Val Acc: 0.2734
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST           | Train Loss: 0.8158 | Train Acc: 0.7844
 Site-MNIST           | Train Loss: 0.9305 | Train Acc: 0.7399
 Site-USPS            | Train Loss: 0.7306 | Train Acc: 0.8383
 Site-USPS            | Train Loss: 0.7339 | Train Acc: 0.8296
 Site-SynthDigits     | Train Loss: 1.5364 | Train Acc: 0.4987
 Site-SynthDigits     | Train Loss: 1.4015 | Train Acc: 0.5641
 Site-MNIST-M         | Train Loss: 1.8034 | Train Acc: 0.3693
 Site-MNIST-M         | Train Loss: 1.8338 | Train Acc: 0.3677
 Site-SVHN            | Train Loss: 1.9756 | Train Acc: 0.3181
 Site-SVHN            | Train Loss: 1.8939 | Train Acc: 0.3641
 Site-MNIST           | Val  Loss: 0.9534 | Val  Acc: 0.7391
 Site-MNIST           | Val  Loss: 0.9164 | Val  Acc: 0.7626
 Site-USPS            | Val  Loss: 0.8624 | Val  Acc: 0.7391
 Site-USPS            | Val  Loss: 0.7866 | Val  Acc: 0.7950
 Site-SynthDigits     | Val  Loss: 1.4269 | Val  Acc: 0.5435
 Site-SynthDigits     | Val  Loss: 1.4808 | Val  Acc: 0.5072
 Site-MNIST-M         | Val  Loss: 1.8204 | Val  Acc: 0.3696
 Site-MNIST-M         | Val  Loss: 1.7724 | Val  Acc: 0.3957
 Site-SVHN            | Val  Loss: 1.8344 | Val  Acc: 0.3804
 Site-SVHN            | Val  Loss: 1.8999 | Val  Acc: 0.3669
Average Valid Accuracy: 0.5599
 Best site-MNIST            | Epoch:1 | Val Acc: 0.7391
 Best site-MNIST            | Epoch:1 | Val Acc: 0.7626
 Best site-USPS             | Epoch:1 | Val Acc: 0.7391
 Best site-USPS             | Epoch:1 | Val Acc: 0.7950
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.5435
 Best site-SynthDigits      | Epoch:1 | Val Acc: 0.5072
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.3696
 Best site-MNIST-M          | Epoch:1 | Val Acc: 0.3957
 Best site-SVHN             | Epoch:1 | Val Acc: 0.3804
 Best site-SVHN             | Epoch:1 | Val Acc: 0.3669
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST           | Train Loss: 0.6085 | Train Acc: 0.8518
 Site-MNIST           | Train Loss: 0.7157 | Train Acc: 0.7883
 Site-USPS            | Train Loss: 0.5382 | Train Acc: 0.9003
 Site-USPS            | Train Loss: 0.5520 | Train Acc: 0.8753
 Site-SynthDigits     | Train Loss: 1.4155 | Train Acc: 0.5580
 Site-SynthDigits     | Train Loss: 1.2677 | Train Acc: 0.6143
 Site-MNIST-M         | Train Loss: 1.6845 | Train Acc: 0.4286
 Site-MNIST-M         | Train Loss: 1.7039 | Train Acc: 0.4269
 Site-SVHN            | Train Loss: 1.9197 | Train Acc: 0.3208
 Site-SVHN            | Train Loss: 1.8201 | Train Acc: 0.3812
 Site-MNIST           | Val  Loss: 0.7041 | Val  Acc: 0.7826
 Site-MNIST           | Val  Loss: 0.6989 | Val  Acc: 0.8237
 Site-USPS            | Val  Loss: 0.7027 | Val  Acc: 0.7826
 Site-USPS            | Val  Loss: 0.6045 | Val  Acc: 0.8489
 Site-SynthDigits     | Val  Loss: 1.2722 | Val  Acc: 0.5870
 Site-SynthDigits     | Val  Loss: 1.3488 | Val  Acc: 0.5612
 Site-MNIST-M         | Val  Loss: 1.6790 | Val  Acc: 0.4674
 Site-MNIST-M         | Val  Loss: 1.6332 | Val  Acc: 0.4856
 Site-SVHN            | Val  Loss: 1.7474 | Val  Acc: 0.3478
 Site-SVHN            | Val  Loss: 1.8290 | Val  Acc: 0.3525
Average Valid Accuracy: 0.6039
 Best site-MNIST            | Epoch:2 | Val Acc: 0.7826
 Best site-MNIST            | Epoch:2 | Val Acc: 0.8237
 Best site-USPS             | Epoch:2 | Val Acc: 0.7826
 Best site-USPS             | Epoch:2 | Val Acc: 0.8489
 Best site-SynthDigits      | Epoch:2 | Val Acc: 0.5870
 Best site-SynthDigits      | Epoch:2 | Val Acc: 0.5612
 Best site-MNIST-M          | Epoch:2 | Val Acc: 0.4674
 Best site-MNIST-M          | Epoch:2 | Val Acc: 0.4856
 Best site-SVHN             | Epoch:2 | Val Acc: 0.3478
 Best site-SVHN             | Epoch:2 | Val Acc: 0.3525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST           | Train Loss: 0.5144 | Train Acc: 0.8598
 Site-MNIST           | Train Loss: 0.6088 | Train Acc: 0.8305
 Site-USPS            | Train Loss: 0.4392 | Train Acc: 0.9111
 Site-USPS            | Train Loss: 0.4414 | Train Acc: 0.8942
 Site-SynthDigits     | Train Loss: 1.2963 | Train Acc: 0.5768
 Site-SynthDigits     | Train Loss: 1.1564 | Train Acc: 0.6269
 Site-MNIST-M         | Train Loss: 1.6089 | Train Acc: 0.4690
 Site-MNIST-M         | Train Loss: 1.6003 | Train Acc: 0.4655
 Site-SVHN            | Train Loss: 1.8377 | Train Acc: 0.3531
 Site-SVHN            | Train Loss: 1.7361 | Train Acc: 0.4135
 Site-MNIST           | Val  Loss: 0.5865 | Val  Acc: 0.8370
 Site-MNIST           | Val  Loss: 0.5807 | Val  Acc: 0.8525
 Site-USPS            | Val  Loss: 0.6068 | Val  Acc: 0.8152
 Site-USPS            | Val  Loss: 0.5014 | Val  Acc: 0.8633
 Site-SynthDigits     | Val  Loss: 1.1579 | Val  Acc: 0.6196
 Site-SynthDigits     | Val  Loss: 1.2398 | Val  Acc: 0.5755
 Site-MNIST-M         | Val  Loss: 1.5578 | Val  Acc: 0.5109
 Site-MNIST-M         | Val  Loss: 1.5287 | Val  Acc: 0.5036
 Site-SVHN            | Val  Loss: 1.6541 | Val  Acc: 0.3804
 Site-SVHN            | Val  Loss: 1.7381 | Val  Acc: 0.4029
Average Valid Accuracy: 0.6361
 Best site-MNIST            | Epoch:3 | Val Acc: 0.8370
 Best site-MNIST            | Epoch:3 | Val Acc: 0.8525
 Best site-USPS             | Epoch:3 | Val Acc: 0.8152
 Best site-USPS             | Epoch:3 | Val Acc: 0.8633
 Best site-SynthDigits      | Epoch:3 | Val Acc: 0.6196
 Best site-SynthDigits      | Epoch:3 | Val Acc: 0.5755
 Best site-MNIST-M          | Epoch:3 | Val Acc: 0.5109
 Best site-MNIST-M          | Epoch:3 | Val Acc: 0.5036
 Best site-SVHN             | Epoch:3 | Val Acc: 0.3804
 Best site-SVHN             | Epoch:3 | Val Acc: 0.4029
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST           | Train Loss: 0.4512 | Train Acc: 0.8733
 Site-MNIST           | Train Loss: 0.5373 | Train Acc: 0.8413
 Site-USPS            | Train Loss: 0.3844 | Train Acc: 0.9003
 Site-USPS            | Train Loss: 0.3788 | Train Acc: 0.9076
 Site-SynthDigits     | Train Loss: 1.2224 | Train Acc: 0.5687
 Site-SynthDigits     | Train Loss: 1.0982 | Train Acc: 0.6188
 Site-MNIST-M         | Train Loss: 1.5156 | Train Acc: 0.4717
 Site-MNIST-M         | Train Loss: 1.5228 | Train Acc: 0.4834
 Site-SVHN            | Train Loss: 1.8066 | Train Acc: 0.3558
 Site-SVHN            | Train Loss: 1.6842 | Train Acc: 0.4287
 Site-MNIST           | Val  Loss: 0.5169 | Val  Acc: 0.8478
 Site-MNIST           | Val  Loss: 0.5187 | Val  Acc: 0.8489
 Site-USPS            | Val  Loss: 0.5643 | Val  Acc: 0.8370
 Site-USPS            | Val  Loss: 0.4482 | Val  Acc: 0.8813
 Site-SynthDigits     | Val  Loss: 1.1076 | Val  Acc: 0.5870
 Site-SynthDigits     | Val  Loss: 1.1604 | Val  Acc: 0.5647
 Site-MNIST-M         | Val  Loss: 1.4611 | Val  Acc: 0.4783
 Site-MNIST-M         | Val  Loss: 1.4402 | Val  Acc: 0.5000
 Site-SVHN            | Val  Loss: 1.6060 | Val  Acc: 0.4565
 Site-SVHN            | Val  Loss: 1.7075 | Val  Acc: 0.4353
Average Valid Accuracy: 0.6437
 Best site-MNIST            | Epoch:4 | Val Acc: 0.8478
 Best site-MNIST            | Epoch:4 | Val Acc: 0.8489
 Best site-USPS             | Epoch:4 | Val Acc: 0.8370
 Best site-USPS             | Epoch:4 | Val Acc: 0.8813
 Best site-SynthDigits      | Epoch:4 | Val Acc: 0.5870
 Best site-SynthDigits      | Epoch:4 | Val Acc: 0.5647
 Best site-MNIST-M          | Epoch:4 | Val Acc: 0.4783
 Best site-MNIST-M          | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN             | Epoch:4 | Val Acc: 0.4565
 Best site-SVHN             | Epoch:4 | Val Acc: 0.4353
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST           | Train Loss: 0.4052 | Train Acc: 0.8787
 Site-MNIST           | Train Loss: 0.4660 | Train Acc: 0.8664
 Site-USPS            | Train Loss: 0.3274 | Train Acc: 0.9272
 Site-USPS            | Train Loss: 0.3197 | Train Acc: 0.9202
 Site-SynthDigits     | Train Loss: 1.1636 | Train Acc: 0.5957
 Site-SynthDigits     | Train Loss: 1.0229 | Train Acc: 0.6448
 Site-MNIST-M         | Train Loss: 1.4938 | Train Acc: 0.4906
 Site-MNIST-M         | Train Loss: 1.4560 | Train Acc: 0.4933
 Site-SVHN            | Train Loss: 1.7687 | Train Acc: 0.3908
 Site-SVHN            | Train Loss: 1.6365 | Train Acc: 0.4511
 Site-MNIST           | Val  Loss: 0.4483 | Val  Acc: 0.8913
 Site-MNIST           | Val  Loss: 0.4523 | Val  Acc: 0.8885
 Site-USPS            | Val  Loss: 0.4990 | Val  Acc: 0.8696
 Site-USPS            | Val  Loss: 0.3829 | Val  Acc: 0.9029
 Site-SynthDigits     | Val  Loss: 1.0540 | Val  Acc: 0.6087
 Site-SynthDigits     | Val  Loss: 1.1028 | Val  Acc: 0.5791
 Site-MNIST-M         | Val  Loss: 1.3865 | Val  Acc: 0.5000
 Site-MNIST-M         | Val  Loss: 1.3876 | Val  Acc: 0.5180
 Site-SVHN            | Val  Loss: 1.5724 | Val  Acc: 0.4783
 Site-SVHN            | Val  Loss: 1.6649 | Val  Acc: 0.4532
Average Valid Accuracy: 0.6690
 Best site-MNIST            | Epoch:5 | Val Acc: 0.8913
 Best site-MNIST            | Epoch:5 | Val Acc: 0.8885
 Best site-USPS             | Epoch:5 | Val Acc: 0.8696
 Best site-USPS             | Epoch:5 | Val Acc: 0.9029
 Best site-SynthDigits      | Epoch:5 | Val Acc: 0.6087
 Best site-SynthDigits      | Epoch:5 | Val Acc: 0.5791
 Best site-MNIST-M          | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST-M          | Epoch:5 | Val Acc: 0.5180
 Best site-SVHN             | Epoch:5 | Val Acc: 0.4783
 Best site-SVHN             | Epoch:5 | Val Acc: 0.4532
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST           | Train Loss: 0.3580 | Train Acc: 0.8868
 Site-MNIST           | Train Loss: 0.4252 | Train Acc: 0.8682
 Site-USPS            | Train Loss: 0.2989 | Train Acc: 0.9380
 Site-USPS            | Train Loss: 0.2908 | Train Acc: 0.9229
 Site-SynthDigits     | Train Loss: 1.1000 | Train Acc: 0.6307
 Site-SynthDigits     | Train Loss: 0.9723 | Train Acc: 0.6771
 Site-MNIST-M         | Train Loss: 1.4295 | Train Acc: 0.5013
 Site-MNIST-M         | Train Loss: 1.3859 | Train Acc: 0.5229
 Site-SVHN            | Train Loss: 1.7299 | Train Acc: 0.4124
 Site-SVHN            | Train Loss: 1.5883 | Train Acc: 0.4798
 Site-MNIST           | Val  Loss: 0.4128 | Val  Acc: 0.8913
 Site-MNIST           | Val  Loss: 0.4037 | Val  Acc: 0.8957
 Site-USPS            | Val  Loss: 0.4678 | Val  Acc: 0.8478
 Site-USPS            | Val  Loss: 0.3494 | Val  Acc: 0.9029
 Site-SynthDigits     | Val  Loss: 1.0012 | Val  Acc: 0.6630
 Site-SynthDigits     | Val  Loss: 1.0528 | Val  Acc: 0.6295
 Site-MNIST-M         | Val  Loss: 1.2974 | Val  Acc: 0.5435
 Site-MNIST-M         | Val  Loss: 1.3196 | Val  Acc: 0.5252
 Site-SVHN            | Val  Loss: 1.5128 | Val  Acc: 0.4674
 Site-SVHN            | Val  Loss: 1.6210 | Val  Acc: 0.4568
Average Valid Accuracy: 0.6823
 Best site-MNIST            | Epoch:6 | Val Acc: 0.8913
 Best site-MNIST            | Epoch:6 | Val Acc: 0.8957
 Best site-USPS             | Epoch:6 | Val Acc: 0.8478
 Best site-USPS             | Epoch:6 | Val Acc: 0.9029
 Best site-SynthDigits      | Epoch:6 | Val Acc: 0.6630
 Best site-SynthDigits      | Epoch:6 | Val Acc: 0.6295
 Best site-MNIST-M          | Epoch:6 | Val Acc: 0.5435
 Best site-MNIST-M          | Epoch:6 | Val Acc: 0.5252
 Best site-SVHN             | Epoch:6 | Val Acc: 0.4674
 Best site-SVHN             | Epoch:6 | Val Acc: 0.4568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST           | Train Loss: 0.3153 | Train Acc: 0.9003
 Site-MNIST           | Train Loss: 0.3794 | Train Acc: 0.8834
 Site-USPS            | Train Loss: 0.2768 | Train Acc: 0.9380
 Site-USPS            | Train Loss: 0.2626 | Train Acc: 0.9327
 Site-SynthDigits     | Train Loss: 1.0486 | Train Acc: 0.6442
 Site-SynthDigits     | Train Loss: 0.9149 | Train Acc: 0.6933
 Site-MNIST-M         | Train Loss: 1.3648 | Train Acc: 0.5364
 Site-MNIST-M         | Train Loss: 1.3140 | Train Acc: 0.5498
 Site-SVHN            | Train Loss: 1.6870 | Train Acc: 0.4178
 Site-SVHN            | Train Loss: 1.5695 | Train Acc: 0.4753
 Site-MNIST           | Val  Loss: 0.3670 | Val  Acc: 0.8913
 Site-MNIST           | Val  Loss: 0.3633 | Val  Acc: 0.8921
 Site-USPS            | Val  Loss: 0.4358 | Val  Acc: 0.8696
 Site-USPS            | Val  Loss: 0.3202 | Val  Acc: 0.9101
 Site-SynthDigits     | Val  Loss: 0.9241 | Val  Acc: 0.7174
 Site-SynthDigits     | Val  Loss: 1.0013 | Val  Acc: 0.6727
 Site-MNIST-M         | Val  Loss: 1.2351 | Val  Acc: 0.5761
 Site-MNIST-M         | Val  Loss: 1.2566 | Val  Acc: 0.5612
 Site-SVHN            | Val  Loss: 1.4965 | Val  Acc: 0.4891
 Site-SVHN            | Val  Loss: 1.6103 | Val  Acc: 0.4640
Average Valid Accuracy: 0.7043
 Best site-MNIST            | Epoch:7 | Val Acc: 0.8913
 Best site-MNIST            | Epoch:7 | Val Acc: 0.8921
 Best site-USPS             | Epoch:7 | Val Acc: 0.8696
 Best site-USPS             | Epoch:7 | Val Acc: 0.9101
 Best site-SynthDigits      | Epoch:7 | Val Acc: 0.7174
 Best site-SynthDigits      | Epoch:7 | Val Acc: 0.6727
 Best site-MNIST-M          | Epoch:7 | Val Acc: 0.5761
 Best site-MNIST-M          | Epoch:7 | Val Acc: 0.5612
 Best site-SVHN             | Epoch:7 | Val Acc: 0.4891
 Best site-SVHN             | Epoch:7 | Val Acc: 0.4640
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST           | Train Loss: 0.3202 | Train Acc: 0.8976
 Site-MNIST           | Train Loss: 0.3760 | Train Acc: 0.8852
 Site-USPS            | Train Loss: 0.2663 | Train Acc: 0.9326
 Site-USPS            | Train Loss: 0.2495 | Train Acc: 0.9291
 Site-SynthDigits     | Train Loss: 1.0155 | Train Acc: 0.6496
 Site-SynthDigits     | Train Loss: 0.8739 | Train Acc: 0.7175
 Site-MNIST-M         | Train Loss: 1.3395 | Train Acc: 0.5472
 Site-MNIST-M         | Train Loss: 1.2911 | Train Acc: 0.5722
 Site-SVHN            | Train Loss: 1.6480 | Train Acc: 0.4690
 Site-SVHN            | Train Loss: 1.5229 | Train Acc: 0.4906
 Site-MNIST           | Val  Loss: 0.3633 | Val  Acc: 0.8587
 Site-MNIST           | Val  Loss: 0.3624 | Val  Acc: 0.8921
 Site-USPS            | Val  Loss: 0.4285 | Val  Acc: 0.8587
 Site-USPS            | Val  Loss: 0.3089 | Val  Acc: 0.8993
 Site-SynthDigits     | Val  Loss: 0.8660 | Val  Acc: 0.7283
 Site-SynthDigits     | Val  Loss: 0.9430 | Val  Acc: 0.6799
 Site-MNIST-M         | Val  Loss: 1.2002 | Val  Acc: 0.6087
 Site-MNIST-M         | Val  Loss: 1.2300 | Val  Acc: 0.5863
 Site-SVHN            | Val  Loss: 1.4309 | Val  Acc: 0.5217
 Site-SVHN            | Val  Loss: 1.5698 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7134
 Best site-MNIST            | Epoch:8 | Val Acc: 0.8587
 Best site-MNIST            | Epoch:8 | Val Acc: 0.8921
 Best site-USPS             | Epoch:8 | Val Acc: 0.8587
 Best site-USPS             | Epoch:8 | Val Acc: 0.8993
 Best site-SynthDigits      | Epoch:8 | Val Acc: 0.7283
 Best site-SynthDigits      | Epoch:8 | Val Acc: 0.6799
 Best site-MNIST-M          | Epoch:8 | Val Acc: 0.6087
 Best site-MNIST-M          | Epoch:8 | Val Acc: 0.5863
 Best site-SVHN             | Epoch:8 | Val Acc: 0.5217
 Best site-SVHN             | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST           | Train Loss: 0.2945 | Train Acc: 0.9111
 Site-MNIST           | Train Loss: 0.3354 | Train Acc: 0.8942
 Site-USPS            | Train Loss: 0.2588 | Train Acc: 0.9353
 Site-USPS            | Train Loss: 0.2292 | Train Acc: 0.9318
 Site-SynthDigits     | Train Loss: 0.9713 | Train Acc: 0.6739
 Site-SynthDigits     | Train Loss: 0.8169 | Train Acc: 0.7390
 Site-MNIST-M         | Train Loss: 1.2923 | Train Acc: 0.5499
 Site-MNIST-M         | Train Loss: 1.2299 | Train Acc: 0.5848
 Site-SVHN            | Train Loss: 1.6069 | Train Acc: 0.4582
 Site-SVHN            | Train Loss: 1.4911 | Train Acc: 0.4987
 Site-MNIST           | Val  Loss: 0.3090 | Val  Acc: 0.9130
 Site-MNIST           | Val  Loss: 0.3146 | Val  Acc: 0.9173
 Site-USPS            | Val  Loss: 0.4190 | Val  Acc: 0.8696
 Site-USPS            | Val  Loss: 0.2932 | Val  Acc: 0.9065
 Site-SynthDigits     | Val  Loss: 0.8104 | Val  Acc: 0.7500
 Site-SynthDigits     | Val  Loss: 0.9023 | Val  Acc: 0.6942
 Site-MNIST-M         | Val  Loss: 1.1133 | Val  Acc: 0.6522
 Site-MNIST-M         | Val  Loss: 1.1694 | Val  Acc: 0.6043
 Site-SVHN            | Val  Loss: 1.4116 | Val  Acc: 0.5217
 Site-SVHN            | Val  Loss: 1.5395 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7329
 Best site-MNIST            | Epoch:9 | Val Acc: 0.9130
 Best site-MNIST            | Epoch:9 | Val Acc: 0.9173
 Best site-USPS             | Epoch:9 | Val Acc: 0.8696
 Best site-USPS             | Epoch:9 | Val Acc: 0.9065
 Best site-SynthDigits      | Epoch:9 | Val Acc: 0.7500
 Best site-SynthDigits      | Epoch:9 | Val Acc: 0.6942
 Best site-MNIST-M          | Epoch:9 | Val Acc: 0.6522
 Best site-MNIST-M          | Epoch:9 | Val Acc: 0.6043
 Best site-SVHN             | Epoch:9 | Val Acc: 0.5217
 Best site-SVHN             | Epoch:9 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
 Test site-MNIST           | Epoch:9 | Test Acc: 0.8861
 Test site-USPS            | Epoch:9 | Test Acc: 0.9054
 Test site-SynthDigits     | Epoch:9 | Test Acc: 0.6840
 Test site-MNIST-M         | Epoch:9 | Test Acc: 0.4873
 Test site-SVHN            | Epoch:9 | Test Acc: 0.4035
Average Test Accuracy: 0.6732
============ Train epoch 10 ============
 Site-MNIST           | Train Loss: 0.2848 | Train Acc: 0.9218
 Site-MNIST           | Train Loss: 0.3144 | Train Acc: 0.8987
 Site-USPS            | Train Loss: 0.2349 | Train Acc: 0.9299
 Site-USPS            | Train Loss: 0.2200 | Train Acc: 0.9363
 Site-SynthDigits     | Train Loss: 0.9348 | Train Acc: 0.6792
 Site-SynthDigits     | Train Loss: 0.7906 | Train Acc: 0.7498
 Site-MNIST-M         | Train Loss: 1.2847 | Train Acc: 0.5580
 Site-MNIST-M         | Train Loss: 1.2236 | Train Acc: 0.5857
 Site-SVHN            | Train Loss: 1.5726 | Train Acc: 0.4852
 Site-SVHN            | Train Loss: 1.4275 | Train Acc: 0.5157
 Site-MNIST           | Val  Loss: 0.2917 | Val  Acc: 0.8913
 Site-MNIST           | Val  Loss: 0.3042 | Val  Acc: 0.9101
 Site-USPS            | Val  Loss: 0.4040 | Val  Acc: 0.8913
 Site-USPS            | Val  Loss: 0.2717 | Val  Acc: 0.9173
 Site-SynthDigits     | Val  Loss: 0.7816 | Val  Acc: 0.7826
 Site-SynthDigits     | Val  Loss: 0.8663 | Val  Acc: 0.7158
 Site-MNIST-M         | Val  Loss: 1.1027 | Val  Acc: 0.6522
 Site-MNIST-M         | Val  Loss: 1.1611 | Val  Acc: 0.6007
 Site-SVHN            | Val  Loss: 1.3704 | Val  Acc: 0.5326
 Site-SVHN            | Val  Loss: 1.4765 | Val  Acc: 0.5072
Average Valid Accuracy: 0.7401
 Best site-MNIST            | Epoch:10 | Val Acc: 0.8913
 Best site-MNIST            | Epoch:10 | Val Acc: 0.9101
 Best site-USPS             | Epoch:10 | Val Acc: 0.8913
 Best site-USPS             | Epoch:10 | Val Acc: 0.9173
 Best site-SynthDigits      | Epoch:10 | Val Acc: 0.7826
 Best site-SynthDigits      | Epoch:10 | Val Acc: 0.7158
 Best site-MNIST-M          | Epoch:10 | Val Acc: 0.6522
 Best site-MNIST-M          | Epoch:10 | Val Acc: 0.6007
 Best site-SVHN             | Epoch:10 | Val Acc: 0.5326
 Best site-SVHN             | Epoch:10 | Val Acc: 0.5072
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST           | Train Loss: 0.2614 | Train Acc: 0.9191
 Site-MNIST           | Train Loss: 0.2891 | Train Acc: 0.9166
 Site-USPS            | Train Loss: 0.2286 | Train Acc: 0.9407
 Site-USPS            | Train Loss: 0.2032 | Train Acc: 0.9408
 Site-SynthDigits     | Train Loss: 0.9091 | Train Acc: 0.6927
 Site-SynthDigits     | Train Loss: 0.7595 | Train Acc: 0.7668
 Site-MNIST-M         | Train Loss: 1.2773 | Train Acc: 0.5580
 Site-MNIST-M         | Train Loss: 1.1946 | Train Acc: 0.5964
 Site-SVHN            | Train Loss: 1.5677 | Train Acc: 0.4825
 Site-SVHN            | Train Loss: 1.4279 | Train Acc: 0.5166
 Site-MNIST           | Val  Loss: 0.2554 | Val  Acc: 0.9130
 Site-MNIST           | Val  Loss: 0.2754 | Val  Acc: 0.9281
 Site-USPS            | Val  Loss: 0.3914 | Val  Acc: 0.8696
 Site-USPS            | Val  Loss: 0.2647 | Val  Acc: 0.9101
 Site-SynthDigits     | Val  Loss: 0.7492 | Val  Acc: 0.7826
 Site-SynthDigits     | Val  Loss: 0.8435 | Val  Acc: 0.7374
 Site-MNIST-M         | Val  Loss: 1.0933 | Val  Acc: 0.6304
 Site-MNIST-M         | Val  Loss: 1.1436 | Val  Acc: 0.6043
 Site-SVHN            | Val  Loss: 1.3426 | Val  Acc: 0.5217
 Site-SVHN            | Val  Loss: 1.4674 | Val  Acc: 0.5036
Average Valid Accuracy: 0.7401
============ Train epoch 12 ============
 Site-MNIST           | Train Loss: 0.2577 | Train Acc: 0.9218
 Site-MNIST           | Train Loss: 0.2755 | Train Acc: 0.9220
 Site-USPS            | Train Loss: 0.2130 | Train Acc: 0.9380
 Site-USPS            | Train Loss: 0.1925 | Train Acc: 0.9471
 Site-SynthDigits     | Train Loss: 0.8855 | Train Acc: 0.7062
 Site-SynthDigits     | Train Loss: 0.7424 | Train Acc: 0.7650
 Site-MNIST-M         | Train Loss: 1.2548 | Train Acc: 0.5687
 Site-MNIST-M         | Train Loss: 1.1672 | Train Acc: 0.6170
 Site-SVHN            | Train Loss: 1.5440 | Train Acc: 0.4960
 Site-SVHN            | Train Loss: 1.3996 | Train Acc: 0.5291
 Site-MNIST           | Val  Loss: 0.2544 | Val  Acc: 0.9239
 Site-MNIST           | Val  Loss: 0.2666 | Val  Acc: 0.9353
 Site-USPS            | Val  Loss: 0.3676 | Val  Acc: 0.8913
 Site-USPS            | Val  Loss: 0.2468 | Val  Acc: 0.9209
 Site-SynthDigits     | Val  Loss: 0.7384 | Val  Acc: 0.7717
 Site-SynthDigits     | Val  Loss: 0.8312 | Val  Acc: 0.7230
 Site-MNIST-M         | Val  Loss: 1.0667 | Val  Acc: 0.6630
 Site-MNIST-M         | Val  Loss: 1.1222 | Val  Acc: 0.6295
 Site-SVHN            | Val  Loss: 1.3131 | Val  Acc: 0.5543
 Site-SVHN            | Val  Loss: 1.4251 | Val  Acc: 0.5216
Average Valid Accuracy: 0.7535
 Best site-MNIST            | Epoch:12 | Val Acc: 0.9239
 Best site-MNIST            | Epoch:12 | Val Acc: 0.9353
 Best site-USPS             | Epoch:12 | Val Acc: 0.8913
 Best site-USPS             | Epoch:12 | Val Acc: 0.9209
 Best site-SynthDigits      | Epoch:12 | Val Acc: 0.7717
 Best site-SynthDigits      | Epoch:12 | Val Acc: 0.7230
 Best site-MNIST-M          | Epoch:12 | Val Acc: 0.6630
 Best site-MNIST-M          | Epoch:12 | Val Acc: 0.6295
 Best site-SVHN             | Epoch:12 | Val Acc: 0.5543
 Best site-SVHN             | Epoch:12 | Val Acc: 0.5216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST           | Train Loss: 0.2370 | Train Acc: 0.9299
 Site-MNIST           | Train Loss: 0.2592 | Train Acc: 0.9211
 Site-USPS            | Train Loss: 0.2048 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1748 | Train Acc: 0.9578
 Site-SynthDigits     | Train Loss: 0.8831 | Train Acc: 0.6927
 Site-SynthDigits     | Train Loss: 0.7260 | Train Acc: 0.7713
 Site-MNIST-M         | Train Loss: 1.2334 | Train Acc: 0.5768
 Site-MNIST-M         | Train Loss: 1.1409 | Train Acc: 0.6251
 Site-SVHN            | Train Loss: 1.5412 | Train Acc: 0.4825
 Site-SVHN            | Train Loss: 1.4106 | Train Acc: 0.5211
 Site-MNIST           | Val  Loss: 0.2485 | Val  Acc: 0.9130
 Site-MNIST           | Val  Loss: 0.2594 | Val  Acc: 0.9317
 Site-USPS            | Val  Loss: 0.3351 | Val  Acc: 0.9022
 Site-USPS            | Val  Loss: 0.2336 | Val  Acc: 0.9317
 Site-SynthDigits     | Val  Loss: 0.7048 | Val  Acc: 0.7935
 Site-SynthDigits     | Val  Loss: 0.8216 | Val  Acc: 0.7302
 Site-MNIST-M         | Val  Loss: 1.0299 | Val  Acc: 0.6848
 Site-MNIST-M         | Val  Loss: 1.0947 | Val  Acc: 0.6403
 Site-SVHN            | Val  Loss: 1.2973 | Val  Acc: 0.5761
 Site-SVHN            | Val  Loss: 1.4181 | Val  Acc: 0.5144
Average Valid Accuracy: 0.7618
 Best site-MNIST            | Epoch:13 | Val Acc: 0.9130
 Best site-MNIST            | Epoch:13 | Val Acc: 0.9317
 Best site-USPS             | Epoch:13 | Val Acc: 0.9022
 Best site-USPS             | Epoch:13 | Val Acc: 0.9317
 Best site-SynthDigits      | Epoch:13 | Val Acc: 0.7935
 Best site-SynthDigits      | Epoch:13 | Val Acc: 0.7302
 Best site-MNIST-M          | Epoch:13 | Val Acc: 0.6848
 Best site-MNIST-M          | Epoch:13 | Val Acc: 0.6403
 Best site-SVHN             | Epoch:13 | Val Acc: 0.5761
 Best site-SVHN             | Epoch:13 | Val Acc: 0.5144
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST           | Train Loss: 0.2465 | Train Acc: 0.9137
 Site-MNIST           | Train Loss: 0.2567 | Train Acc: 0.9229
 Site-USPS            | Train Loss: 0.1952 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1742 | Train Acc: 0.9489
 Site-SynthDigits     | Train Loss: 0.8535 | Train Acc: 0.7008
 Site-SynthDigits     | Train Loss: 0.6981 | Train Acc: 0.7812
 Site-MNIST-M         | Train Loss: 1.1971 | Train Acc: 0.5903
 Site-MNIST-M         | Train Loss: 1.0804 | Train Acc: 0.6430
 Site-SVHN            | Train Loss: 1.5080 | Train Acc: 0.5121
 Site-SVHN            | Train Loss: 1.3789 | Train Acc: 0.5309
 Site-MNIST           | Val  Loss: 0.2210 | Val  Acc: 0.9457
 Site-MNIST           | Val  Loss: 0.2489 | Val  Acc: 0.9388
 Site-USPS            | Val  Loss: 0.3385 | Val  Acc: 0.8804
 Site-USPS            | Val  Loss: 0.2239 | Val  Acc: 0.9173
 Site-SynthDigits     | Val  Loss: 0.6778 | Val  Acc: 0.8043
 Site-SynthDigits     | Val  Loss: 0.7897 | Val  Acc: 0.7338
 Site-MNIST-M         | Val  Loss: 0.9849 | Val  Acc: 0.6848
 Site-MNIST-M         | Val  Loss: 1.0538 | Val  Acc: 0.6367
 Site-SVHN            | Val  Loss: 1.2768 | Val  Acc: 0.5435
 Site-SVHN            | Val  Loss: 1.3895 | Val  Acc: 0.5144
Average Valid Accuracy: 0.7600
============ Train epoch 15 ============
 Site-MNIST           | Train Loss: 0.2284 | Train Acc: 0.9407
 Site-MNIST           | Train Loss: 0.2514 | Train Acc: 0.9256
 Site-USPS            | Train Loss: 0.2146 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1795 | Train Acc: 0.9507
 Site-SynthDigits     | Train Loss: 0.8212 | Train Acc: 0.7224
 Site-SynthDigits     | Train Loss: 0.6662 | Train Acc: 0.8027
 Site-MNIST-M         | Train Loss: 1.2047 | Train Acc: 0.5903
 Site-MNIST-M         | Train Loss: 1.0868 | Train Acc: 0.6448
 Site-SVHN            | Train Loss: 1.5093 | Train Acc: 0.5067
 Site-SVHN            | Train Loss: 1.3314 | Train Acc: 0.5390
 Site-MNIST           | Val  Loss: 0.2020 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.2369 | Val  Acc: 0.9460
 Site-USPS            | Val  Loss: 0.3545 | Val  Acc: 0.8913
 Site-USPS            | Val  Loss: 0.2347 | Val  Acc: 0.9281
 Site-SynthDigits     | Val  Loss: 0.6595 | Val  Acc: 0.8478
 Site-SynthDigits     | Val  Loss: 0.7665 | Val  Acc: 0.7734
 Site-MNIST-M         | Val  Loss: 0.9837 | Val  Acc: 0.6739
 Site-MNIST-M         | Val  Loss: 1.0426 | Val  Acc: 0.6403
 Site-SVHN            | Val  Loss: 1.2669 | Val  Acc: 0.5543
 Site-SVHN            | Val  Loss: 1.3710 | Val  Acc: 0.5252
Average Valid Accuracy: 0.7737
 Best site-MNIST            | Epoch:15 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:15 | Val Acc: 0.9460
 Best site-USPS             | Epoch:15 | Val Acc: 0.8913
 Best site-USPS             | Epoch:15 | Val Acc: 0.9281
 Best site-SynthDigits      | Epoch:15 | Val Acc: 0.8478
 Best site-SynthDigits      | Epoch:15 | Val Acc: 0.7734
 Best site-MNIST-M          | Epoch:15 | Val Acc: 0.6739
 Best site-MNIST-M          | Epoch:15 | Val Acc: 0.6403
 Best site-SVHN             | Epoch:15 | Val Acc: 0.5543
 Best site-SVHN             | Epoch:15 | Val Acc: 0.5252
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST           | Train Loss: 0.2274 | Train Acc: 0.9353
 Site-MNIST           | Train Loss: 0.2454 | Train Acc: 0.9291
 Site-USPS            | Train Loss: 0.1914 | Train Acc: 0.9461
 Site-USPS            | Train Loss: 0.1609 | Train Acc: 0.9587
 Site-SynthDigits     | Train Loss: 0.8083 | Train Acc: 0.7197
 Site-SynthDigits     | Train Loss: 0.6504 | Train Acc: 0.8054
 Site-MNIST-M         | Train Loss: 1.1852 | Train Acc: 0.5957
 Site-MNIST-M         | Train Loss: 1.0639 | Train Acc: 0.6502
 Site-SVHN            | Train Loss: 1.4882 | Train Acc: 0.5121
 Site-SVHN            | Train Loss: 1.3258 | Train Acc: 0.5453
 Site-MNIST           | Val  Loss: 0.1984 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.2314 | Val  Acc: 0.9496
 Site-USPS            | Val  Loss: 0.3231 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.2149 | Val  Acc: 0.9388
 Site-SynthDigits     | Val  Loss: 0.6256 | Val  Acc: 0.8152
 Site-SynthDigits     | Val  Loss: 0.7484 | Val  Acc: 0.7590
 Site-MNIST-M         | Val  Loss: 0.9438 | Val  Acc: 0.6848
 Site-MNIST-M         | Val  Loss: 1.0322 | Val  Acc: 0.6367
 Site-SVHN            | Val  Loss: 1.2104 | Val  Acc: 0.5652
 Site-SVHN            | Val  Loss: 1.3315 | Val  Acc: 0.5432
Average Valid Accuracy: 0.7784
 Best site-MNIST            | Epoch:16 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:16 | Val Acc: 0.9496
 Best site-USPS             | Epoch:16 | Val Acc: 0.9348
 Best site-USPS             | Epoch:16 | Val Acc: 0.9388
 Best site-SynthDigits      | Epoch:16 | Val Acc: 0.8152
 Best site-SynthDigits      | Epoch:16 | Val Acc: 0.7590
 Best site-MNIST-M          | Epoch:16 | Val Acc: 0.6848
 Best site-MNIST-M          | Epoch:16 | Val Acc: 0.6367
 Best site-SVHN             | Epoch:16 | Val Acc: 0.5652
 Best site-SVHN             | Epoch:16 | Val Acc: 0.5432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST           | Train Loss: 0.2149 | Train Acc: 0.9299
 Site-MNIST           | Train Loss: 0.2278 | Train Acc: 0.9327
 Site-USPS            | Train Loss: 0.1816 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1545 | Train Acc: 0.9623
 Site-SynthDigits     | Train Loss: 0.7948 | Train Acc: 0.7278
 Site-SynthDigits     | Train Loss: 0.6391 | Train Acc: 0.8063
 Site-MNIST-M         | Train Loss: 1.1531 | Train Acc: 0.6092
 Site-MNIST-M         | Train Loss: 1.0346 | Train Acc: 0.6628
 Site-SVHN            | Train Loss: 1.4566 | Train Acc: 0.5067
 Site-SVHN            | Train Loss: 1.2955 | Train Acc: 0.5596
 Site-MNIST           | Val  Loss: 0.1930 | Val  Acc: 0.9457
 Site-MNIST           | Val  Loss: 0.2272 | Val  Acc: 0.9424
 Site-USPS            | Val  Loss: 0.3074 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.2100 | Val  Acc: 0.9317
 Site-SynthDigits     | Val  Loss: 0.6392 | Val  Acc: 0.8478
 Site-SynthDigits     | Val  Loss: 0.7237 | Val  Acc: 0.7878
 Site-MNIST-M         | Val  Loss: 0.9347 | Val  Acc: 0.6739
 Site-MNIST-M         | Val  Loss: 1.0147 | Val  Acc: 0.6511
 Site-SVHN            | Val  Loss: 1.1872 | Val  Acc: 0.5652
 Site-SVHN            | Val  Loss: 1.2910 | Val  Acc: 0.5540
Average Valid Accuracy: 0.7823
 Best site-MNIST            | Epoch:17 | Val Acc: 0.9457
 Best site-MNIST            | Epoch:17 | Val Acc: 0.9424
 Best site-USPS             | Epoch:17 | Val Acc: 0.9239
 Best site-USPS             | Epoch:17 | Val Acc: 0.9317
 Best site-SynthDigits      | Epoch:17 | Val Acc: 0.8478
 Best site-SynthDigits      | Epoch:17 | Val Acc: 0.7878
 Best site-MNIST-M          | Epoch:17 | Val Acc: 0.6739
 Best site-MNIST-M          | Epoch:17 | Val Acc: 0.6511
 Best site-SVHN             | Epoch:17 | Val Acc: 0.5652
 Best site-SVHN             | Epoch:17 | Val Acc: 0.5540
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST           | Train Loss: 0.2106 | Train Acc: 0.9407
 Site-MNIST           | Train Loss: 0.2214 | Train Acc: 0.9318
 Site-USPS            | Train Loss: 0.1867 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1542 | Train Acc: 0.9623
 Site-SynthDigits     | Train Loss: 0.7930 | Train Acc: 0.7332
 Site-SynthDigits     | Train Loss: 0.6307 | Train Acc: 0.8179
 Site-MNIST-M         | Train Loss: 1.1603 | Train Acc: 0.6199
 Site-MNIST-M         | Train Loss: 1.0235 | Train Acc: 0.6529
 Site-SVHN            | Train Loss: 1.4677 | Train Acc: 0.5202
 Site-SVHN            | Train Loss: 1.2835 | Train Acc: 0.5561
 Site-MNIST           | Val  Loss: 0.1877 | Val  Acc: 0.9457
 Site-MNIST           | Val  Loss: 0.2141 | Val  Acc: 0.9496
 Site-USPS            | Val  Loss: 0.3102 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.2036 | Val  Acc: 0.9353
 Site-SynthDigits     | Val  Loss: 0.6272 | Val  Acc: 0.8370
 Site-SynthDigits     | Val  Loss: 0.7290 | Val  Acc: 0.7878
 Site-MNIST-M         | Val  Loss: 0.9229 | Val  Acc: 0.6957
 Site-MNIST-M         | Val  Loss: 1.0048 | Val  Acc: 0.6619
 Site-SVHN            | Val  Loss: 1.1918 | Val  Acc: 0.5652
 Site-SVHN            | Val  Loss: 1.2929 | Val  Acc: 0.5396
Average Valid Accuracy: 0.7841
 Best site-MNIST            | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST            | Epoch:18 | Val Acc: 0.9496
 Best site-USPS             | Epoch:18 | Val Acc: 0.9239
 Best site-USPS             | Epoch:18 | Val Acc: 0.9353
 Best site-SynthDigits      | Epoch:18 | Val Acc: 0.8370
 Best site-SynthDigits      | Epoch:18 | Val Acc: 0.7878
 Best site-MNIST-M          | Epoch:18 | Val Acc: 0.6957
 Best site-MNIST-M          | Epoch:18 | Val Acc: 0.6619
 Best site-SVHN             | Epoch:18 | Val Acc: 0.5652
 Best site-SVHN             | Epoch:18 | Val Acc: 0.5396
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST           | Train Loss: 0.2185 | Train Acc: 0.9434
 Site-MNIST           | Train Loss: 0.2307 | Train Acc: 0.9318
 Site-USPS            | Train Loss: 0.1836 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1547 | Train Acc: 0.9605
 Site-SynthDigits     | Train Loss: 0.7616 | Train Acc: 0.7412
 Site-SynthDigits     | Train Loss: 0.6019 | Train Acc: 0.8242
 Site-MNIST-M         | Train Loss: 1.1134 | Train Acc: 0.6173
 Site-MNIST-M         | Train Loss: 0.9874 | Train Acc: 0.6717
 Site-SVHN            | Train Loss: 1.4358 | Train Acc: 0.5283
 Site-SVHN            | Train Loss: 1.2506 | Train Acc: 0.5794
 Site-MNIST           | Val  Loss: 0.1826 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.2243 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.3086 | Val  Acc: 0.9130
 Site-USPS            | Val  Loss: 0.1987 | Val  Acc: 0.9317
 Site-SynthDigits     | Val  Loss: 0.5988 | Val  Acc: 0.8696
 Site-SynthDigits     | Val  Loss: 0.7005 | Val  Acc: 0.8022
 Site-MNIST-M         | Val  Loss: 0.8967 | Val  Acc: 0.7065
 Site-MNIST-M         | Val  Loss: 0.9676 | Val  Acc: 0.6727
 Site-SVHN            | Val  Loss: 1.1807 | Val  Acc: 0.5870
 Site-SVHN            | Val  Loss: 1.2750 | Val  Acc: 0.5755
Average Valid Accuracy: 0.7971
 Best site-MNIST            | Epoch:19 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:19 | Val Acc: 0.9568
 Best site-USPS             | Epoch:19 | Val Acc: 0.9130
 Best site-USPS             | Epoch:19 | Val Acc: 0.9317
 Best site-SynthDigits      | Epoch:19 | Val Acc: 0.8696
 Best site-SynthDigits      | Epoch:19 | Val Acc: 0.8022
 Best site-MNIST-M          | Epoch:19 | Val Acc: 0.7065
 Best site-MNIST-M          | Epoch:19 | Val Acc: 0.6727
 Best site-SVHN             | Epoch:19 | Val Acc: 0.5870
 Best site-SVHN             | Epoch:19 | Val Acc: 0.5755
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
 Test site-MNIST           | Epoch:19 | Test Acc: 0.9126
 Test site-USPS            | Epoch:19 | Test Acc: 0.9290
 Test site-SynthDigits     | Epoch:19 | Test Acc: 0.7480
 Test site-MNIST-M         | Epoch:19 | Test Acc: 0.5231
 Test site-SVHN            | Epoch:19 | Test Acc: 0.4582
Average Test Accuracy: 0.7142
============ Train epoch 20 ============
 Site-MNIST           | Train Loss: 0.2118 | Train Acc: 0.9380
 Site-MNIST           | Train Loss: 0.2203 | Train Acc: 0.9381
 Site-USPS            | Train Loss: 0.1760 | Train Acc: 0.9488
 Site-USPS            | Train Loss: 0.1470 | Train Acc: 0.9623
 Site-SynthDigits     | Train Loss: 0.7671 | Train Acc: 0.7412
 Site-SynthDigits     | Train Loss: 0.6075 | Train Acc: 0.8206
 Site-MNIST-M         | Train Loss: 1.1032 | Train Acc: 0.6280
 Site-MNIST-M         | Train Loss: 0.9644 | Train Acc: 0.6744
 Site-SVHN            | Train Loss: 1.4553 | Train Acc: 0.5202
 Site-SVHN            | Train Loss: 1.2783 | Train Acc: 0.5695
 Site-MNIST           | Val  Loss: 0.1755 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.2145 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2927 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1909 | Val  Acc: 0.9317
 Site-SynthDigits     | Val  Loss: 0.5846 | Val  Acc: 0.8587
 Site-SynthDigits     | Val  Loss: 0.7013 | Val  Acc: 0.7986
 Site-MNIST-M         | Val  Loss: 0.8546 | Val  Acc: 0.7283
 Site-MNIST-M         | Val  Loss: 0.9424 | Val  Acc: 0.6763
 Site-SVHN            | Val  Loss: 1.1900 | Val  Acc: 0.5652
 Site-SVHN            | Val  Loss: 1.3056 | Val  Acc: 0.5719
Average Valid Accuracy: 0.7982
 Best site-MNIST            | Epoch:20 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:20 | Val Acc: 0.9604
 Best site-USPS             | Epoch:20 | Val Acc: 0.9239
 Best site-USPS             | Epoch:20 | Val Acc: 0.9317
 Best site-SynthDigits      | Epoch:20 | Val Acc: 0.8587
 Best site-SynthDigits      | Epoch:20 | Val Acc: 0.7986
 Best site-MNIST-M          | Epoch:20 | Val Acc: 0.7283
 Best site-MNIST-M          | Epoch:20 | Val Acc: 0.6763
 Best site-SVHN             | Epoch:20 | Val Acc: 0.5652
 Best site-SVHN             | Epoch:20 | Val Acc: 0.5719
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST           | Train Loss: 0.2187 | Train Acc: 0.9353
 Site-MNIST           | Train Loss: 0.2092 | Train Acc: 0.9318
 Site-USPS            | Train Loss: 0.1698 | Train Acc: 0.9542
 Site-USPS            | Train Loss: 0.1418 | Train Acc: 0.9641
 Site-SynthDigits     | Train Loss: 0.7573 | Train Acc: 0.7439
 Site-SynthDigits     | Train Loss: 0.5840 | Train Acc: 0.8287
 Site-MNIST-M         | Train Loss: 1.0933 | Train Acc: 0.6226
 Site-MNIST-M         | Train Loss: 0.9415 | Train Acc: 0.6960
 Site-SVHN            | Train Loss: 1.4424 | Train Acc: 0.5256
 Site-SVHN            | Train Loss: 1.2599 | Train Acc: 0.5677
 Site-MNIST           | Val  Loss: 0.1643 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.2026 | Val  Acc: 0.9496
 Site-USPS            | Val  Loss: 0.2975 | Val  Acc: 0.9130
 Site-USPS            | Val  Loss: 0.1853 | Val  Acc: 0.9460
 Site-SynthDigits     | Val  Loss: 0.5572 | Val  Acc: 0.8696
 Site-SynthDigits     | Val  Loss: 0.6878 | Val  Acc: 0.7878
 Site-MNIST-M         | Val  Loss: 0.8384 | Val  Acc: 0.7391
 Site-MNIST-M         | Val  Loss: 0.9357 | Val  Acc: 0.6906
 Site-SVHN            | Val  Loss: 1.1857 | Val  Acc: 0.5652
 Site-SVHN            | Val  Loss: 1.2718 | Val  Acc: 0.5468
Average Valid Accuracy: 0.7964
============ Train epoch 22 ============
 Site-MNIST           | Train Loss: 0.1992 | Train Acc: 0.9353
 Site-MNIST           | Train Loss: 0.2017 | Train Acc: 0.9399
 Site-USPS            | Train Loss: 0.1676 | Train Acc: 0.9569
 Site-USPS            | Train Loss: 0.1337 | Train Acc: 0.9641
 Site-SynthDigits     | Train Loss: 0.7385 | Train Acc: 0.7439
 Site-SynthDigits     | Train Loss: 0.5689 | Train Acc: 0.8368
 Site-MNIST-M         | Train Loss: 1.0862 | Train Acc: 0.6307
 Site-MNIST-M         | Train Loss: 0.9437 | Train Acc: 0.6951
 Site-SVHN            | Train Loss: 1.4240 | Train Acc: 0.5256
 Site-SVHN            | Train Loss: 1.2451 | Train Acc: 0.5758
 Site-MNIST           | Val  Loss: 0.1599 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1967 | Val  Acc: 0.9496
 Site-USPS            | Val  Loss: 0.2904 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1866 | Val  Acc: 0.9388
 Site-SynthDigits     | Val  Loss: 0.5472 | Val  Acc: 0.8587
 Site-SynthDigits     | Val  Loss: 0.6599 | Val  Acc: 0.7878
 Site-MNIST-M         | Val  Loss: 0.8412 | Val  Acc: 0.7283
 Site-MNIST-M         | Val  Loss: 0.9219 | Val  Acc: 0.6942
 Site-SVHN            | Val  Loss: 1.1728 | Val  Acc: 0.5870
 Site-SVHN            | Val  Loss: 1.2584 | Val  Acc: 0.5612
Average Valid Accuracy: 0.7986
 Best site-MNIST            | Epoch:22 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:22 | Val Acc: 0.9496
 Best site-USPS             | Epoch:22 | Val Acc: 0.9239
 Best site-USPS             | Epoch:22 | Val Acc: 0.9388
 Best site-SynthDigits      | Epoch:22 | Val Acc: 0.8587
 Best site-SynthDigits      | Epoch:22 | Val Acc: 0.7878
 Best site-MNIST-M          | Epoch:22 | Val Acc: 0.7283
 Best site-MNIST-M          | Epoch:22 | Val Acc: 0.6942
 Best site-SVHN             | Epoch:22 | Val Acc: 0.5870
 Best site-SVHN             | Epoch:22 | Val Acc: 0.5612
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST           | Train Loss: 0.1930 | Train Acc: 0.9326
 Site-MNIST           | Train Loss: 0.1993 | Train Acc: 0.9417
 Site-USPS            | Train Loss: 0.1630 | Train Acc: 0.9542
 Site-USPS            | Train Loss: 0.1337 | Train Acc: 0.9650
 Site-SynthDigits     | Train Loss: 0.7391 | Train Acc: 0.7466
 Site-SynthDigits     | Train Loss: 0.5724 | Train Acc: 0.8395
 Site-MNIST-M         | Train Loss: 1.0745 | Train Acc: 0.6307
 Site-MNIST-M         | Train Loss: 0.9156 | Train Acc: 0.6960
 Site-SVHN            | Train Loss: 1.4083 | Train Acc: 0.5229
 Site-SVHN            | Train Loss: 1.2091 | Train Acc: 0.5946
 Site-MNIST           | Val  Loss: 0.1650 | Val  Acc: 0.9457
 Site-MNIST           | Val  Loss: 0.1950 | Val  Acc: 0.9460
 Site-USPS            | Val  Loss: 0.2792 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1787 | Val  Acc: 0.9460
 Site-SynthDigits     | Val  Loss: 0.5711 | Val  Acc: 0.8478
 Site-SynthDigits     | Val  Loss: 0.6732 | Val  Acc: 0.7986
 Site-MNIST-M         | Val  Loss: 0.8294 | Val  Acc: 0.7609
 Site-MNIST-M         | Val  Loss: 0.9183 | Val  Acc: 0.6978
 Site-SVHN            | Val  Loss: 1.1566 | Val  Acc: 0.6196
 Site-SVHN            | Val  Loss: 1.2269 | Val  Acc: 0.5719
Average Valid Accuracy: 0.8069
 Best site-MNIST            | Epoch:23 | Val Acc: 0.9457
 Best site-MNIST            | Epoch:23 | Val Acc: 0.9460
 Best site-USPS             | Epoch:23 | Val Acc: 0.9348
 Best site-USPS             | Epoch:23 | Val Acc: 0.9460
 Best site-SynthDigits      | Epoch:23 | Val Acc: 0.8478
 Best site-SynthDigits      | Epoch:23 | Val Acc: 0.7986
 Best site-MNIST-M          | Epoch:23 | Val Acc: 0.7609
 Best site-MNIST-M          | Epoch:23 | Val Acc: 0.6978
 Best site-SVHN             | Epoch:23 | Val Acc: 0.6196
 Best site-SVHN             | Epoch:23 | Val Acc: 0.5719
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST           | Train Loss: 0.1993 | Train Acc: 0.9380
 Site-MNIST           | Train Loss: 0.1967 | Train Acc: 0.9390
 Site-USPS            | Train Loss: 0.1571 | Train Acc: 0.9650
 Site-USPS            | Train Loss: 0.1250 | Train Acc: 0.9677
 Site-SynthDigits     | Train Loss: 0.7360 | Train Acc: 0.7439
 Site-SynthDigits     | Train Loss: 0.5577 | Train Acc: 0.8377
 Site-MNIST-M         | Train Loss: 1.0728 | Train Acc: 0.6307
 Site-MNIST-M         | Train Loss: 0.9096 | Train Acc: 0.7004
 Site-SVHN            | Train Loss: 1.4124 | Train Acc: 0.5202
 Site-SVHN            | Train Loss: 1.2032 | Train Acc: 0.5919
 Site-MNIST           | Val  Loss: 0.1642 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1911 | Val  Acc: 0.9460
 Site-USPS            | Val  Loss: 0.2740 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1701 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.5464 | Val  Acc: 0.8370
 Site-SynthDigits     | Val  Loss: 0.6467 | Val  Acc: 0.7878
 Site-MNIST-M         | Val  Loss: 0.8091 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8984 | Val  Acc: 0.7122
 Site-SVHN            | Val  Loss: 1.1335 | Val  Acc: 0.5870
 Site-SVHN            | Val  Loss: 1.2185 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8069
============ Train epoch 25 ============
 Site-MNIST           | Train Loss: 0.2085 | Train Acc: 0.9353
 Site-MNIST           | Train Loss: 0.2007 | Train Acc: 0.9390
 Site-USPS            | Train Loss: 0.1591 | Train Acc: 0.9569
 Site-USPS            | Train Loss: 0.1304 | Train Acc: 0.9659
 Site-SynthDigits     | Train Loss: 0.7057 | Train Acc: 0.7628
 Site-SynthDigits     | Train Loss: 0.5383 | Train Acc: 0.8439
 Site-MNIST-M         | Train Loss: 1.0701 | Train Acc: 0.6442
 Site-MNIST-M         | Train Loss: 0.8875 | Train Acc: 0.6924
 Site-SVHN            | Train Loss: 1.4157 | Train Acc: 0.5445
 Site-SVHN            | Train Loss: 1.1976 | Train Acc: 0.5955
 Site-MNIST           | Val  Loss: 0.1551 | Val  Acc: 0.9457
 Site-MNIST           | Val  Loss: 0.1878 | Val  Acc: 0.9424
 Site-USPS            | Val  Loss: 0.2848 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1723 | Val  Acc: 0.9532
 Site-SynthDigits     | Val  Loss: 0.5189 | Val  Acc: 0.8478
 Site-SynthDigits     | Val  Loss: 0.6173 | Val  Acc: 0.7914
 Site-MNIST-M         | Val  Loss: 0.7918 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8791 | Val  Acc: 0.7122
 Site-SVHN            | Val  Loss: 1.1145 | Val  Acc: 0.5870
 Site-SVHN            | Val  Loss: 1.2134 | Val  Acc: 0.5827
Average Valid Accuracy: 0.8091
 Best site-MNIST            | Epoch:25 | Val Acc: 0.9457
 Best site-MNIST            | Epoch:25 | Val Acc: 0.9424
 Best site-USPS             | Epoch:25 | Val Acc: 0.9348
 Best site-USPS             | Epoch:25 | Val Acc: 0.9532
 Best site-SynthDigits      | Epoch:25 | Val Acc: 0.8478
 Best site-SynthDigits      | Epoch:25 | Val Acc: 0.7914
 Best site-MNIST-M          | Epoch:25 | Val Acc: 0.7935
 Best site-MNIST-M          | Epoch:25 | Val Acc: 0.7122
 Best site-SVHN             | Epoch:25 | Val Acc: 0.5870
 Best site-SVHN             | Epoch:25 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 26 ============
 Site-MNIST           | Train Loss: 0.2092 | Train Acc: 0.9380
 Site-MNIST           | Train Loss: 0.2069 | Train Acc: 0.9399
 Site-USPS            | Train Loss: 0.1634 | Train Acc: 0.9515
 Site-USPS            | Train Loss: 0.1258 | Train Acc: 0.9650
 Site-SynthDigits     | Train Loss: 0.6916 | Train Acc: 0.7574
 Site-SynthDigits     | Train Loss: 0.5208 | Train Acc: 0.8529
 Site-MNIST-M         | Train Loss: 1.0668 | Train Acc: 0.6442
 Site-MNIST-M         | Train Loss: 0.8730 | Train Acc: 0.7076
 Site-SVHN            | Train Loss: 1.3969 | Train Acc: 0.5391
 Site-SVHN            | Train Loss: 1.1621 | Train Acc: 0.6143
 Site-MNIST           | Val  Loss: 0.1551 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1887 | Val  Acc: 0.9460
 Site-USPS            | Val  Loss: 0.2784 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1725 | Val  Acc: 0.9496
 Site-SynthDigits     | Val  Loss: 0.5181 | Val  Acc: 0.8804
 Site-SynthDigits     | Val  Loss: 0.6045 | Val  Acc: 0.8094
 Site-MNIST-M         | Val  Loss: 0.7897 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8732 | Val  Acc: 0.7230
 Site-SVHN            | Val  Loss: 1.0831 | Val  Acc: 0.5978
 Site-SVHN            | Val  Loss: 1.1788 | Val  Acc: 0.5827
Average Valid Accuracy: 0.8163
 Best site-MNIST            | Epoch:26 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:26 | Val Acc: 0.9460
 Best site-USPS             | Epoch:26 | Val Acc: 0.9239
 Best site-USPS             | Epoch:26 | Val Acc: 0.9496
 Best site-SynthDigits      | Epoch:26 | Val Acc: 0.8804
 Best site-SynthDigits      | Epoch:26 | Val Acc: 0.8094
 Best site-MNIST-M          | Epoch:26 | Val Acc: 0.7935
 Best site-MNIST-M          | Epoch:26 | Val Acc: 0.7230
 Best site-SVHN             | Epoch:26 | Val Acc: 0.5978
 Best site-SVHN             | Epoch:26 | Val Acc: 0.5827
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST           | Train Loss: 0.1913 | Train Acc: 0.9434
 Site-MNIST           | Train Loss: 0.1848 | Train Acc: 0.9435
 Site-USPS            | Train Loss: 0.1520 | Train Acc: 0.9623
 Site-USPS            | Train Loss: 0.1236 | Train Acc: 0.9713
 Site-SynthDigits     | Train Loss: 0.7036 | Train Acc: 0.7520
 Site-SynthDigits     | Train Loss: 0.5335 | Train Acc: 0.8475
 Site-MNIST-M         | Train Loss: 1.0638 | Train Acc: 0.6361
 Site-MNIST-M         | Train Loss: 0.8577 | Train Acc: 0.7211
 Site-SVHN            | Train Loss: 1.3970 | Train Acc: 0.5337
 Site-SVHN            | Train Loss: 1.1711 | Train Acc: 0.6135
 Site-MNIST           | Val  Loss: 0.1352 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1797 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2518 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1612 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.5384 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.6302 | Val  Acc: 0.8022
 Site-MNIST-M         | Val  Loss: 0.7634 | Val  Acc: 0.7826
 Site-MNIST-M         | Val  Loss: 0.8664 | Val  Acc: 0.7050
 Site-SVHN            | Val  Loss: 1.0799 | Val  Acc: 0.5978
 Site-SVHN            | Val  Loss: 1.1777 | Val  Acc: 0.5935
Average Valid Accuracy: 0.8192
 Best site-MNIST            | Epoch:27 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:27 | Val Acc: 0.9568
 Best site-USPS             | Epoch:27 | Val Acc: 0.9348
 Best site-USPS             | Epoch:27 | Val Acc: 0.9604
 Best site-SynthDigits      | Epoch:27 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:27 | Val Acc: 0.8022
 Best site-MNIST-M          | Epoch:27 | Val Acc: 0.7826
 Best site-MNIST-M          | Epoch:27 | Val Acc: 0.7050
 Best site-SVHN             | Epoch:27 | Val Acc: 0.5978
 Best site-SVHN             | Epoch:27 | Val Acc: 0.5935
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 28 ============
 Site-MNIST           | Train Loss: 0.1870 | Train Acc: 0.9434
 Site-MNIST           | Train Loss: 0.1778 | Train Acc: 0.9435
 Site-USPS            | Train Loss: 0.1414 | Train Acc: 0.9677
 Site-USPS            | Train Loss: 0.1121 | Train Acc: 0.9758
 Site-SynthDigits     | Train Loss: 0.7142 | Train Acc: 0.7466
 Site-SynthDigits     | Train Loss: 0.5369 | Train Acc: 0.8422
 Site-MNIST-M         | Train Loss: 1.0476 | Train Acc: 0.6307
 Site-MNIST-M         | Train Loss: 0.8423 | Train Acc: 0.7283
 Site-SVHN            | Train Loss: 1.4106 | Train Acc: 0.5256
 Site-SVHN            | Train Loss: 1.1904 | Train Acc: 0.6072
 Site-MNIST           | Val  Loss: 0.1316 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1732 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2338 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1499 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.5208 | Val  Acc: 0.8804
 Site-SynthDigits     | Val  Loss: 0.6258 | Val  Acc: 0.7914
 Site-MNIST-M         | Val  Loss: 0.7494 | Val  Acc: 0.8152
 Site-MNIST-M         | Val  Loss: 0.8537 | Val  Acc: 0.7302
 Site-SVHN            | Val  Loss: 1.0925 | Val  Acc: 0.6087
 Site-SVHN            | Val  Loss: 1.2008 | Val  Acc: 0.5755
Average Valid Accuracy: 0.8225
 Best site-MNIST            | Epoch:28 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:28 | Val Acc: 0.9568
 Best site-USPS             | Epoch:28 | Val Acc: 0.9348
 Best site-USPS             | Epoch:28 | Val Acc: 0.9640
 Best site-SynthDigits      | Epoch:28 | Val Acc: 0.8804
 Best site-SynthDigits      | Epoch:28 | Val Acc: 0.7914
 Best site-MNIST-M          | Epoch:28 | Val Acc: 0.8152
 Best site-MNIST-M          | Epoch:28 | Val Acc: 0.7302
 Best site-SVHN             | Epoch:28 | Val Acc: 0.6087
 Best site-SVHN             | Epoch:28 | Val Acc: 0.5755
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST           | Train Loss: 0.1910 | Train Acc: 0.9407
 Site-MNIST           | Train Loss: 0.1877 | Train Acc: 0.9390
 Site-USPS            | Train Loss: 0.1571 | Train Acc: 0.9542
 Site-USPS            | Train Loss: 0.1201 | Train Acc: 0.9695
 Site-SynthDigits     | Train Loss: 0.6819 | Train Acc: 0.7628
 Site-SynthDigits     | Train Loss: 0.5135 | Train Acc: 0.8565
 Site-MNIST-M         | Train Loss: 1.0332 | Train Acc: 0.6334
 Site-MNIST-M         | Train Loss: 0.8318 | Train Acc: 0.7283
 Site-SVHN            | Train Loss: 1.3822 | Train Acc: 0.5364
 Site-SVHN            | Train Loss: 1.1376 | Train Acc: 0.6206
 Site-MNIST           | Val  Loss: 0.1396 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1816 | Val  Acc: 0.9460
 Site-USPS            | Val  Loss: 0.2624 | Val  Acc: 0.9130
 Site-USPS            | Val  Loss: 0.1576 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.5046 | Val  Acc: 0.8804
 Site-SynthDigits     | Val  Loss: 0.5961 | Val  Acc: 0.8165
 Site-MNIST-M         | Val  Loss: 0.7408 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8435 | Val  Acc: 0.7194
 Site-SVHN            | Val  Loss: 1.0595 | Val  Acc: 0.6413
 Site-SVHN            | Val  Loss: 1.1559 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8224
============ Train epoch 30 ============
 Site-MNIST           | Train Loss: 0.1870 | Train Acc: 0.9488
 Site-MNIST           | Train Loss: 0.1791 | Train Acc: 0.9435
 Site-USPS            | Train Loss: 0.1516 | Train Acc: 0.9623
 Site-USPS            | Train Loss: 0.1148 | Train Acc: 0.9740
 Site-SynthDigits     | Train Loss: 0.6863 | Train Acc: 0.7574
 Site-SynthDigits     | Train Loss: 0.5053 | Train Acc: 0.8538
 Site-MNIST-M         | Train Loss: 1.0289 | Train Acc: 0.6523
 Site-MNIST-M         | Train Loss: 0.8204 | Train Acc: 0.7372
 Site-SVHN            | Train Loss: 1.3988 | Train Acc: 0.5283
 Site-SVHN            | Train Loss: 1.1786 | Train Acc: 0.6063
 Site-MNIST           | Val  Loss: 0.1369 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1717 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2522 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1544 | Val  Acc: 0.9676
 Site-SynthDigits     | Val  Loss: 0.4838 | Val  Acc: 0.8696
 Site-SynthDigits     | Val  Loss: 0.5943 | Val  Acc: 0.8129
 Site-MNIST-M         | Val  Loss: 0.7342 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8254 | Val  Acc: 0.7266
 Site-SVHN            | Val  Loss: 1.0879 | Val  Acc: 0.5978
 Site-SVHN            | Val  Loss: 1.2059 | Val  Acc: 0.5755
Average Valid Accuracy: 0.8206
============ Train epoch 31 ============
 Site-MNIST           | Train Loss: 0.1738 | Train Acc: 0.9542
 Site-MNIST           | Train Loss: 0.1726 | Train Acc: 0.9453
 Site-USPS            | Train Loss: 0.1401 | Train Acc: 0.9677
 Site-USPS            | Train Loss: 0.1098 | Train Acc: 0.9740
 Site-SynthDigits     | Train Loss: 0.7006 | Train Acc: 0.7412
 Site-SynthDigits     | Train Loss: 0.5238 | Train Acc: 0.8422
 Site-MNIST-M         | Train Loss: 1.0063 | Train Acc: 0.6496
 Site-MNIST-M         | Train Loss: 0.8066 | Train Acc: 0.7399
 Site-SVHN            | Train Loss: 1.4125 | Train Acc: 0.5175
 Site-SVHN            | Train Loss: 1.1598 | Train Acc: 0.6161
 Site-MNIST           | Val  Loss: 0.1349 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1650 | Val  Acc: 0.9532
 Site-USPS            | Val  Loss: 0.2316 | Val  Acc: 0.9130
 Site-USPS            | Val  Loss: 0.1465 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.5179 | Val  Acc: 0.8587
 Site-SynthDigits     | Val  Loss: 0.6221 | Val  Acc: 0.8058
 Site-MNIST-M         | Val  Loss: 0.7056 | Val  Acc: 0.7935
 Site-MNIST-M         | Val  Loss: 0.8086 | Val  Acc: 0.7374
 Site-SVHN            | Val  Loss: 1.0510 | Val  Acc: 0.6413
 Site-SVHN            | Val  Loss: 1.1628 | Val  Acc: 0.5899
Average Valid Accuracy: 0.8210
============ Train epoch 32 ============
 Site-MNIST           | Train Loss: 0.1806 | Train Acc: 0.9488
 Site-MNIST           | Train Loss: 0.1750 | Train Acc: 0.9435
 Site-USPS            | Train Loss: 0.1376 | Train Acc: 0.9623
 Site-USPS            | Train Loss: 0.1079 | Train Acc: 0.9740
 Site-SynthDigits     | Train Loss: 0.6693 | Train Acc: 0.7628
 Site-SynthDigits     | Train Loss: 0.5082 | Train Acc: 0.8574
 Site-MNIST-M         | Train Loss: 1.0240 | Train Acc: 0.6523
 Site-MNIST-M         | Train Loss: 0.8039 | Train Acc: 0.7417
 Site-SVHN            | Train Loss: 1.3996 | Train Acc: 0.5283
 Site-SVHN            | Train Loss: 1.1205 | Train Acc: 0.6224
 Site-MNIST           | Val  Loss: 0.1279 | Val  Acc: 0.9565
 Site-MNIST           | Val  Loss: 0.1677 | Val  Acc: 0.9532
 Site-USPS            | Val  Loss: 0.2286 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1417 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4952 | Val  Acc: 0.8587
 Site-SynthDigits     | Val  Loss: 0.5922 | Val  Acc: 0.8129
 Site-MNIST-M         | Val  Loss: 0.7058 | Val  Acc: 0.8261
 Site-MNIST-M         | Val  Loss: 0.8129 | Val  Acc: 0.7374
 Site-SVHN            | Val  Loss: 1.0383 | Val  Acc: 0.6413
 Site-SVHN            | Val  Loss: 1.1429 | Val  Acc: 0.6007
Average Valid Accuracy: 0.8275
 Best site-MNIST            | Epoch:32 | Val Acc: 0.9565
 Best site-MNIST            | Epoch:32 | Val Acc: 0.9532
 Best site-USPS             | Epoch:32 | Val Acc: 0.9239
 Best site-USPS             | Epoch:32 | Val Acc: 0.9640
 Best site-SynthDigits      | Epoch:32 | Val Acc: 0.8587
 Best site-SynthDigits      | Epoch:32 | Val Acc: 0.8129
 Best site-MNIST-M          | Epoch:32 | Val Acc: 0.8261
 Best site-MNIST-M          | Epoch:32 | Val Acc: 0.7374
 Best site-SVHN             | Epoch:32 | Val Acc: 0.6413
 Best site-SVHN             | Epoch:32 | Val Acc: 0.6007
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST           | Train Loss: 0.1846 | Train Acc: 0.9515
 Site-MNIST           | Train Loss: 0.1791 | Train Acc: 0.9471
 Site-USPS            | Train Loss: 0.1508 | Train Acc: 0.9569
 Site-USPS            | Train Loss: 0.1156 | Train Acc: 0.9695
 Site-SynthDigits     | Train Loss: 0.6740 | Train Acc: 0.7736
 Site-SynthDigits     | Train Loss: 0.4907 | Train Acc: 0.8646
 Site-MNIST-M         | Train Loss: 1.0007 | Train Acc: 0.6550
 Site-MNIST-M         | Train Loss: 0.8035 | Train Acc: 0.7543
 Site-SVHN            | Train Loss: 1.3752 | Train Acc: 0.5256
 Site-SVHN            | Train Loss: 1.1141 | Train Acc: 0.6287
 Site-MNIST           | Val  Loss: 0.1286 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1748 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2420 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1492 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.5019 | Val  Acc: 0.8587
 Site-SynthDigits     | Val  Loss: 0.5759 | Val  Acc: 0.8094
 Site-MNIST-M         | Val  Loss: 0.6872 | Val  Acc: 0.8043
 Site-MNIST-M         | Val  Loss: 0.7984 | Val  Acc: 0.7446
 Site-SVHN            | Val  Loss: 1.0332 | Val  Acc: 0.6196
 Site-SVHN            | Val  Loss: 1.1538 | Val  Acc: 0.5971
Average Valid Accuracy: 0.8257
============ Train epoch 34 ============
 Site-MNIST           | Train Loss: 0.1931 | Train Acc: 0.9407
 Site-MNIST           | Train Loss: 0.1861 | Train Acc: 0.9444
 Site-USPS            | Train Loss: 0.1445 | Train Acc: 0.9569
 Site-USPS            | Train Loss: 0.1084 | Train Acc: 0.9731
 Site-SynthDigits     | Train Loss: 0.6753 | Train Acc: 0.7547
 Site-SynthDigits     | Train Loss: 0.4988 | Train Acc: 0.8601
 Site-MNIST-M         | Train Loss: 1.0063 | Train Acc: 0.6523
 Site-MNIST-M         | Train Loss: 0.7848 | Train Acc: 0.7552
 Site-SVHN            | Train Loss: 1.3921 | Train Acc: 0.5256
 Site-SVHN            | Train Loss: 1.0957 | Train Acc: 0.6350
 Site-MNIST           | Val  Loss: 0.1192 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1740 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2338 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1455 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.4870 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5853 | Val  Acc: 0.8129
 Site-MNIST-M         | Val  Loss: 0.6968 | Val  Acc: 0.8261
 Site-MNIST-M         | Val  Loss: 0.8012 | Val  Acc: 0.7338
 Site-SVHN            | Val  Loss: 1.0259 | Val  Acc: 0.6522
 Site-SVHN            | Val  Loss: 1.1409 | Val  Acc: 0.6115
Average Valid Accuracy: 0.8344
 Best site-MNIST            | Epoch:34 | Val Acc: 0.9783
 Best site-MNIST            | Epoch:34 | Val Acc: 0.9568
 Best site-USPS             | Epoch:34 | Val Acc: 0.9239
 Best site-USPS             | Epoch:34 | Val Acc: 0.9568
 Best site-SynthDigits      | Epoch:34 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:34 | Val Acc: 0.8129
 Best site-MNIST-M          | Epoch:34 | Val Acc: 0.8261
 Best site-MNIST-M          | Epoch:34 | Val Acc: 0.7338
 Best site-SVHN             | Epoch:34 | Val Acc: 0.6522
 Best site-SVHN             | Epoch:34 | Val Acc: 0.6115
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST           | Train Loss: 0.1903 | Train Acc: 0.9461
 Site-MNIST           | Train Loss: 0.1840 | Train Acc: 0.9435
 Site-USPS            | Train Loss: 0.1421 | Train Acc: 0.9542
 Site-USPS            | Train Loss: 0.1060 | Train Acc: 0.9776
 Site-SynthDigits     | Train Loss: 0.6580 | Train Acc: 0.7736
 Site-SynthDigits     | Train Loss: 0.4702 | Train Acc: 0.8700
 Site-MNIST-M         | Train Loss: 1.0289 | Train Acc: 0.6442
 Site-MNIST-M         | Train Loss: 0.7923 | Train Acc: 0.7336
 Site-SVHN            | Train Loss: 1.3779 | Train Acc: 0.5202
 Site-SVHN            | Train Loss: 1.1049 | Train Acc: 0.6395
 Site-MNIST           | Val  Loss: 0.1260 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1708 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2433 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1453 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.4677 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5592 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.7192 | Val  Acc: 0.7609
 Site-MNIST-M         | Val  Loss: 0.8067 | Val  Acc: 0.7194
 Site-SVHN            | Val  Loss: 1.0067 | Val  Acc: 0.6630
 Site-SVHN            | Val  Loss: 1.1397 | Val  Acc: 0.6151
Average Valid Accuracy: 0.8300
============ Train epoch 36 ============
 Site-MNIST           | Train Loss: 0.1909 | Train Acc: 0.9434
 Site-MNIST           | Train Loss: 0.1742 | Train Acc: 0.9480
 Site-USPS            | Train Loss: 0.1511 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.1113 | Train Acc: 0.9758
 Site-SynthDigits     | Train Loss: 0.6619 | Train Acc: 0.7682
 Site-SynthDigits     | Train Loss: 0.4706 | Train Acc: 0.8655
 Site-MNIST-M         | Train Loss: 1.0043 | Train Acc: 0.6550
 Site-MNIST-M         | Train Loss: 0.7594 | Train Acc: 0.7605
 Site-SVHN            | Train Loss: 1.3600 | Train Acc: 0.5472
 Site-SVHN            | Train Loss: 1.0859 | Train Acc: 0.6422
 Site-MNIST           | Val  Loss: 0.1181 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1689 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2496 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1477 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.4710 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5509 | Val  Acc: 0.8237
 Site-MNIST-M         | Val  Loss: 0.6961 | Val  Acc: 0.8152
 Site-MNIST-M         | Val  Loss: 0.7929 | Val  Acc: 0.7410
 Site-SVHN            | Val  Loss: 1.0068 | Val  Acc: 0.6413
 Site-SVHN            | Val  Loss: 1.1250 | Val  Acc: 0.6295
Average Valid Accuracy: 0.8372
 Best site-MNIST            | Epoch:36 | Val Acc: 0.9783
 Best site-MNIST            | Epoch:36 | Val Acc: 0.9568
 Best site-USPS             | Epoch:36 | Val Acc: 0.9348
 Best site-USPS             | Epoch:36 | Val Acc: 0.9604
 Best site-SynthDigits      | Epoch:36 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:36 | Val Acc: 0.8237
 Best site-MNIST-M          | Epoch:36 | Val Acc: 0.8152
 Best site-MNIST-M          | Epoch:36 | Val Acc: 0.7410
 Best site-SVHN             | Epoch:36 | Val Acc: 0.6413
 Best site-SVHN             | Epoch:36 | Val Acc: 0.6295
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 37 ============
 Site-MNIST           | Train Loss: 0.1704 | Train Acc: 0.9488
 Site-MNIST           | Train Loss: 0.1635 | Train Acc: 0.9543
 Site-USPS            | Train Loss: 0.1439 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.1067 | Train Acc: 0.9749
 Site-SynthDigits     | Train Loss: 0.6596 | Train Acc: 0.7682
 Site-SynthDigits     | Train Loss: 0.4814 | Train Acc: 0.8700
 Site-MNIST-M         | Train Loss: 0.9950 | Train Acc: 0.6523
 Site-MNIST-M         | Train Loss: 0.7569 | Train Acc: 0.7489
 Site-SVHN            | Train Loss: 1.3621 | Train Acc: 0.5499
 Site-SVHN            | Train Loss: 1.1064 | Train Acc: 0.6404
 Site-MNIST           | Val  Loss: 0.1097 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1565 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2284 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1383 | Val  Acc: 0.9532
 Site-SynthDigits     | Val  Loss: 0.4608 | Val  Acc: 0.9022
 Site-SynthDigits     | Val  Loss: 0.5652 | Val  Acc: 0.8201
 Site-MNIST-M         | Val  Loss: 0.6927 | Val  Acc: 0.7826
 Site-MNIST-M         | Val  Loss: 0.7764 | Val  Acc: 0.7302
 Site-SVHN            | Val  Loss: 1.0124 | Val  Acc: 0.6522
 Site-SVHN            | Val  Loss: 1.1362 | Val  Acc: 0.6115
Average Valid Accuracy: 0.8315
============ Train epoch 38 ============
 Site-MNIST           | Train Loss: 0.1791 | Train Acc: 0.9461
 Site-MNIST           | Train Loss: 0.1698 | Train Acc: 0.9444
 Site-USPS            | Train Loss: 0.1422 | Train Acc: 0.9623
 Site-USPS            | Train Loss: 0.1104 | Train Acc: 0.9767
 Site-SynthDigits     | Train Loss: 0.6417 | Train Acc: 0.7709
 Site-SynthDigits     | Train Loss: 0.4557 | Train Acc: 0.8717
 Site-MNIST-M         | Train Loss: 0.9945 | Train Acc: 0.6577
 Site-MNIST-M         | Train Loss: 0.7652 | Train Acc: 0.7525
 Site-SVHN            | Train Loss: 1.3375 | Train Acc: 0.5714
 Site-SVHN            | Train Loss: 1.0676 | Train Acc: 0.6466
 Site-MNIST           | Val  Loss: 0.1172 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1579 | Val  Acc: 0.9532
 Site-USPS            | Val  Loss: 0.2348 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1406 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4555 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5304 | Val  Acc: 0.8273
 Site-MNIST-M         | Val  Loss: 0.6946 | Val  Acc: 0.7826
 Site-MNIST-M         | Val  Loss: 0.7748 | Val  Acc: 0.7446
 Site-SVHN            | Val  Loss: 0.9978 | Val  Acc: 0.6957
 Site-SVHN            | Val  Loss: 1.1217 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8387
 Best site-MNIST            | Epoch:38 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:38 | Val Acc: 0.9532
 Best site-USPS             | Epoch:38 | Val Acc: 0.9348
 Best site-USPS             | Epoch:38 | Val Acc: 0.9640
 Best site-SynthDigits      | Epoch:38 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:38 | Val Acc: 0.8273
 Best site-MNIST-M          | Epoch:38 | Val Acc: 0.7826
 Best site-MNIST-M          | Epoch:38 | Val Acc: 0.7446
 Best site-SVHN             | Epoch:38 | Val Acc: 0.6957
 Best site-SVHN             | Epoch:38 | Val Acc: 0.6259
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST           | Train Loss: 0.1676 | Train Acc: 0.9542
 Site-MNIST           | Train Loss: 0.1576 | Train Acc: 0.9507
 Site-USPS            | Train Loss: 0.1298 | Train Acc: 0.9677
 Site-USPS            | Train Loss: 0.0980 | Train Acc: 0.9758
 Site-SynthDigits     | Train Loss: 0.6524 | Train Acc: 0.7736
 Site-SynthDigits     | Train Loss: 0.4621 | Train Acc: 0.8682
 Site-MNIST-M         | Train Loss: 0.9728 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.7312 | Train Acc: 0.7686
 Site-SVHN            | Train Loss: 1.3394 | Train Acc: 0.5499
 Site-SVHN            | Train Loss: 1.0647 | Train Acc: 0.6511
 Site-MNIST           | Val  Loss: 0.1124 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1548 | Val  Acc: 0.9532
 Site-USPS            | Val  Loss: 0.2120 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1296 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4721 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5583 | Val  Acc: 0.8094
 Site-MNIST-M         | Val  Loss: 0.6553 | Val  Acc: 0.8152
 Site-MNIST-M         | Val  Loss: 0.7465 | Val  Acc: 0.7554
 Site-SVHN            | Val  Loss: 0.9749 | Val  Acc: 0.7065
 Site-SVHN            | Val  Loss: 1.0947 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8412
 Best site-MNIST            | Epoch:39 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:39 | Val Acc: 0.9532
 Best site-USPS             | Epoch:39 | Val Acc: 0.9239
 Best site-USPS             | Epoch:39 | Val Acc: 0.9640
 Best site-SynthDigits      | Epoch:39 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:39 | Val Acc: 0.8094
 Best site-MNIST-M          | Epoch:39 | Val Acc: 0.8152
 Best site-MNIST-M          | Epoch:39 | Val Acc: 0.7554
 Best site-SVHN             | Epoch:39 | Val Acc: 0.7065
 Best site-SVHN             | Epoch:39 | Val Acc: 0.6259
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
 Test site-MNIST           | Epoch:39 | Test Acc: 0.9241
 Test site-USPS            | Epoch:39 | Test Acc: 0.9462
 Test site-SynthDigits     | Epoch:39 | Test Acc: 0.7800
 Test site-MNIST-M         | Epoch:39 | Test Acc: 0.5493
 Test site-SVHN            | Epoch:39 | Test Acc: 0.4931
Average Test Accuracy: 0.7386
============ Train epoch 40 ============
 Site-MNIST           | Train Loss: 0.1702 | Train Acc: 0.9515
 Site-MNIST           | Train Loss: 0.1653 | Train Acc: 0.9525
 Site-USPS            | Train Loss: 0.1417 | Train Acc: 0.9650
 Site-USPS            | Train Loss: 0.1019 | Train Acc: 0.9767
 Site-SynthDigits     | Train Loss: 0.6253 | Train Acc: 0.7871
 Site-SynthDigits     | Train Loss: 0.4500 | Train Acc: 0.8709
 Site-MNIST-M         | Train Loss: 0.9918 | Train Acc: 0.6604
 Site-MNIST-M         | Train Loss: 0.7257 | Train Acc: 0.7749
 Site-SVHN            | Train Loss: 1.3485 | Train Acc: 0.5633
 Site-SVHN            | Train Loss: 1.0553 | Train Acc: 0.6493
 Site-MNIST           | Val  Loss: 0.1171 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1629 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2238 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1353 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4578 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5342 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.6590 | Val  Acc: 0.8152
 Site-MNIST-M         | Val  Loss: 0.7492 | Val  Acc: 0.7554
 Site-SVHN            | Val  Loss: 0.9652 | Val  Acc: 0.6739
 Site-SVHN            | Val  Loss: 1.1033 | Val  Acc: 0.6259
Average Valid Accuracy: 0.8408
============ Train epoch 41 ============
 Site-MNIST           | Train Loss: 0.1816 | Train Acc: 0.9461
 Site-MNIST           | Train Loss: 0.1625 | Train Acc: 0.9543
 Site-USPS            | Train Loss: 0.1334 | Train Acc: 0.9623
 Site-USPS            | Train Loss: 0.1004 | Train Acc: 0.9758
 Site-SynthDigits     | Train Loss: 0.6361 | Train Acc: 0.7844
 Site-SynthDigits     | Train Loss: 0.4495 | Train Acc: 0.8744
 Site-MNIST-M         | Train Loss: 0.9913 | Train Acc: 0.6658
 Site-MNIST-M         | Train Loss: 0.7150 | Train Acc: 0.7874
 Site-SVHN            | Train Loss: 1.3474 | Train Acc: 0.5606
 Site-SVHN            | Train Loss: 1.0488 | Train Acc: 0.6601
 Site-MNIST           | Val  Loss: 0.1094 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1578 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2202 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1310 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.4563 | Val  Acc: 0.8913
 Site-SynthDigits     | Val  Loss: 0.5365 | Val  Acc: 0.8345
 Site-MNIST-M         | Val  Loss: 0.6273 | Val  Acc: 0.8261
 Site-MNIST-M         | Val  Loss: 0.7446 | Val  Acc: 0.7698
 Site-SVHN            | Val  Loss: 0.9368 | Val  Acc: 0.6739
 Site-SVHN            | Val  Loss: 1.0824 | Val  Acc: 0.6223
Average Valid Accuracy: 0.8441
 Best site-MNIST            | Epoch:41 | Val Acc: 0.9783
 Best site-MNIST            | Epoch:41 | Val Acc: 0.9604
 Best site-USPS             | Epoch:41 | Val Acc: 0.9239
 Best site-USPS             | Epoch:41 | Val Acc: 0.9604
 Best site-SynthDigits      | Epoch:41 | Val Acc: 0.8913
 Best site-SynthDigits      | Epoch:41 | Val Acc: 0.8345
 Best site-MNIST-M          | Epoch:41 | Val Acc: 0.8261
 Best site-MNIST-M          | Epoch:41 | Val Acc: 0.7698
 Best site-SVHN             | Epoch:41 | Val Acc: 0.6739
 Best site-SVHN             | Epoch:41 | Val Acc: 0.6223
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 42 ============
 Site-MNIST           | Train Loss: 0.1859 | Train Acc: 0.9488
 Site-MNIST           | Train Loss: 0.1632 | Train Acc: 0.9543
 Site-USPS            | Train Loss: 0.1310 | Train Acc: 0.9650
 Site-USPS            | Train Loss: 0.0982 | Train Acc: 0.9776
 Site-SynthDigits     | Train Loss: 0.6382 | Train Acc: 0.7736
 Site-SynthDigits     | Train Loss: 0.4480 | Train Acc: 0.8771
 Site-MNIST-M         | Train Loss: 0.9830 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.7226 | Train Acc: 0.7749
 Site-SVHN            | Train Loss: 1.3198 | Train Acc: 0.5741
 Site-SVHN            | Train Loss: 1.0473 | Train Acc: 0.6709
 Site-MNIST           | Val  Loss: 0.1151 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1523 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2183 | Val  Acc: 0.9130
 Site-USPS            | Val  Loss: 0.1274 | Val  Acc: 0.9604
 Site-SynthDigits     | Val  Loss: 0.4395 | Val  Acc: 0.9022
 Site-SynthDigits     | Val  Loss: 0.5365 | Val  Acc: 0.8273
 Site-MNIST-M         | Val  Loss: 0.6308 | Val  Acc: 0.8370
 Site-MNIST-M         | Val  Loss: 0.7494 | Val  Acc: 0.7626
 Site-SVHN            | Val  Loss: 0.9481 | Val  Acc: 0.7065
 Site-SVHN            | Val  Loss: 1.0765 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8495
 Best site-MNIST            | Epoch:42 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:42 | Val Acc: 0.9568
 Best site-USPS             | Epoch:42 | Val Acc: 0.9130
 Best site-USPS             | Epoch:42 | Val Acc: 0.9604
 Best site-SynthDigits      | Epoch:42 | Val Acc: 0.9022
 Best site-SynthDigits      | Epoch:42 | Val Acc: 0.8273
 Best site-MNIST-M          | Epoch:42 | Val Acc: 0.8370
 Best site-MNIST-M          | Epoch:42 | Val Acc: 0.7626
 Best site-SVHN             | Epoch:42 | Val Acc: 0.7065
 Best site-SVHN             | Epoch:42 | Val Acc: 0.6619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST           | Train Loss: 0.1654 | Train Acc: 0.9515
 Site-MNIST           | Train Loss: 0.1495 | Train Acc: 0.9570
 Site-USPS            | Train Loss: 0.1275 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.0933 | Train Acc: 0.9785
 Site-SynthDigits     | Train Loss: 0.6348 | Train Acc: 0.7763
 Site-SynthDigits     | Train Loss: 0.4514 | Train Acc: 0.8789
 Site-MNIST-M         | Train Loss: 0.9813 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.7014 | Train Acc: 0.7955
 Site-SVHN            | Train Loss: 1.3490 | Train Acc: 0.5499
 Site-SVHN            | Train Loss: 1.0371 | Train Acc: 0.6601
 Site-MNIST           | Val  Loss: 0.1125 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1459 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.2093 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1241 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.4402 | Val  Acc: 0.9022
 Site-SynthDigits     | Val  Loss: 0.5451 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.6135 | Val  Acc: 0.8261
 Site-MNIST-M         | Val  Loss: 0.7326 | Val  Acc: 0.7662
 Site-SVHN            | Val  Loss: 0.9192 | Val  Acc: 0.6848
 Site-SVHN            | Val  Loss: 1.0659 | Val  Acc: 0.6367
Average Valid Accuracy: 0.8452
============ Train epoch 44 ============
 Site-MNIST           | Train Loss: 0.1674 | Train Acc: 0.9569
 Site-MNIST           | Train Loss: 0.1465 | Train Acc: 0.9552
 Site-USPS            | Train Loss: 0.1203 | Train Acc: 0.9757
 Site-USPS            | Train Loss: 0.0942 | Train Acc: 0.9794
 Site-SynthDigits     | Train Loss: 0.6359 | Train Acc: 0.7736
 Site-SynthDigits     | Train Loss: 0.4426 | Train Acc: 0.8753
 Site-MNIST-M         | Train Loss: 0.9763 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.6995 | Train Acc: 0.7830
 Site-SVHN            | Train Loss: 1.3443 | Train Acc: 0.5499
 Site-SVHN            | Train Loss: 1.0505 | Train Acc: 0.6574
 Site-MNIST           | Val  Loss: 0.1141 | Val  Acc: 0.9674
 Site-MNIST           | Val  Loss: 0.1438 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2000 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1213 | Val  Acc: 0.9676
 Site-SynthDigits     | Val  Loss: 0.4290 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5385 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.6123 | Val  Acc: 0.8370
 Site-MNIST-M         | Val  Loss: 0.7252 | Val  Acc: 0.7662
 Site-SVHN            | Val  Loss: 0.9350 | Val  Acc: 0.7065
 Site-SVHN            | Val  Loss: 1.0677 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8513
 Best site-MNIST            | Epoch:44 | Val Acc: 0.9674
 Best site-MNIST            | Epoch:44 | Val Acc: 0.9604
 Best site-USPS             | Epoch:44 | Val Acc: 0.9239
 Best site-USPS             | Epoch:44 | Val Acc: 0.9676
 Best site-SynthDigits      | Epoch:44 | Val Acc: 0.9130
 Best site-SynthDigits      | Epoch:44 | Val Acc: 0.8309
 Best site-MNIST-M          | Epoch:44 | Val Acc: 0.8370
 Best site-MNIST-M          | Epoch:44 | Val Acc: 0.7662
 Best site-SVHN             | Epoch:44 | Val Acc: 0.7065
 Best site-SVHN             | Epoch:44 | Val Acc: 0.6403
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 45 ============
 Site-MNIST           | Train Loss: 0.1534 | Train Acc: 0.9596
 Site-MNIST           | Train Loss: 0.1397 | Train Acc: 0.9605
 Site-USPS            | Train Loss: 0.1254 | Train Acc: 0.9677
 Site-USPS            | Train Loss: 0.0922 | Train Acc: 0.9803
 Site-SynthDigits     | Train Loss: 0.6295 | Train Acc: 0.7790
 Site-SynthDigits     | Train Loss: 0.4359 | Train Acc: 0.8753
 Site-MNIST-M         | Train Loss: 0.9451 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.6750 | Train Acc: 0.7964
 Site-SVHN            | Train Loss: 1.3461 | Train Acc: 0.5553
 Site-SVHN            | Train Loss: 1.0363 | Train Acc: 0.6610
 Site-MNIST           | Val  Loss: 0.1040 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1314 | Val  Acc: 0.9676
 Site-USPS            | Val  Loss: 0.2032 | Val  Acc: 0.9348
 Site-USPS            | Val  Loss: 0.1255 | Val  Acc: 0.9676
 Site-SynthDigits     | Val  Loss: 0.4403 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5456 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.5824 | Val  Acc: 0.8478
 Site-MNIST-M         | Val  Loss: 0.7024 | Val  Acc: 0.7806
 Site-SVHN            | Val  Loss: 0.9097 | Val  Acc: 0.7065
 Site-SVHN            | Val  Loss: 1.0613 | Val  Acc: 0.6439
Average Valid Accuracy: 0.8571
 Best site-MNIST            | Epoch:45 | Val Acc: 0.9783
 Best site-MNIST            | Epoch:45 | Val Acc: 0.9676
 Best site-USPS             | Epoch:45 | Val Acc: 0.9348
 Best site-USPS             | Epoch:45 | Val Acc: 0.9676
 Best site-SynthDigits      | Epoch:45 | Val Acc: 0.9130
 Best site-SynthDigits      | Epoch:45 | Val Acc: 0.8309
 Best site-MNIST-M          | Epoch:45 | Val Acc: 0.8478
 Best site-MNIST-M          | Epoch:45 | Val Acc: 0.7806
 Best site-SVHN             | Epoch:45 | Val Acc: 0.7065
 Best site-SVHN             | Epoch:45 | Val Acc: 0.6439
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1/harmo-fl...
============ Train epoch 46 ============
 Site-MNIST           | Train Loss: 0.1657 | Train Acc: 0.9434
 Site-MNIST           | Train Loss: 0.1447 | Train Acc: 0.9578
 Site-USPS            | Train Loss: 0.1183 | Train Acc: 0.9704
 Site-USPS            | Train Loss: 0.0915 | Train Acc: 0.9794
 Site-SynthDigits     | Train Loss: 0.6316 | Train Acc: 0.7817
 Site-SynthDigits     | Train Loss: 0.4336 | Train Acc: 0.8753
 Site-MNIST-M         | Train Loss: 0.9574 | Train Acc: 0.6712
 Site-MNIST-M         | Train Loss: 0.6731 | Train Acc: 0.8045
 Site-SVHN            | Train Loss: 1.3300 | Train Acc: 0.5580
 Site-SVHN            | Train Loss: 1.0197 | Train Acc: 0.6762
 Site-MNIST           | Val  Loss: 0.1033 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1429 | Val  Acc: 0.9568
 Site-USPS            | Val  Loss: 0.1898 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1179 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4440 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5318 | Val  Acc: 0.8165
 Site-MNIST-M         | Val  Loss: 0.5890 | Val  Acc: 0.8370
 Site-MNIST-M         | Val  Loss: 0.7153 | Val  Acc: 0.7770
 Site-SVHN            | Val  Loss: 0.8876 | Val  Acc: 0.7283
 Site-SVHN            | Val  Loss: 1.0429 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8557
============ Train epoch 47 ============
 Site-MNIST           | Train Loss: 0.1645 | Train Acc: 0.9488
 Site-MNIST           | Train Loss: 0.1456 | Train Acc: 0.9605
 Site-USPS            | Train Loss: 0.1249 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.0917 | Train Acc: 0.9812
 Site-SynthDigits     | Train Loss: 0.6092 | Train Acc: 0.8032
 Site-SynthDigits     | Train Loss: 0.4175 | Train Acc: 0.8798
 Site-MNIST-M         | Train Loss: 0.9699 | Train Acc: 0.6631
 Site-MNIST-M         | Train Loss: 0.6743 | Train Acc: 0.7964
 Site-SVHN            | Train Loss: 1.3154 | Train Acc: 0.5768
 Site-SVHN            | Train Loss: 0.9902 | Train Acc: 0.6753
 Site-MNIST           | Val  Loss: 0.1071 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1427 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2006 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1216 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4309 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5083 | Val  Acc: 0.8453
 Site-MNIST-M         | Val  Loss: 0.5835 | Val  Acc: 0.8478
 Site-MNIST-M         | Val  Loss: 0.7032 | Val  Acc: 0.7770
 Site-SVHN            | Val  Loss: 0.8932 | Val  Acc: 0.6957
 Site-SVHN            | Val  Loss: 1.0440 | Val  Acc: 0.6619
Average Valid Accuracy: 0.8567
============ Train epoch 48 ============
 Site-MNIST           | Train Loss: 0.1640 | Train Acc: 0.9569
 Site-MNIST           | Train Loss: 0.1420 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.1377 | Train Acc: 0.9569
 Site-USPS            | Train Loss: 0.0988 | Train Acc: 0.9785
 Site-SynthDigits     | Train Loss: 0.6078 | Train Acc: 0.8032
 Site-SynthDigits     | Train Loss: 0.4175 | Train Acc: 0.8843
 Site-MNIST-M         | Train Loss: 0.9484 | Train Acc: 0.6765
 Site-MNIST-M         | Train Loss: 0.6504 | Train Acc: 0.8036
 Site-SVHN            | Train Loss: 1.3024 | Train Acc: 0.5741
 Site-SVHN            | Train Loss: 1.0241 | Train Acc: 0.6735
 Site-MNIST           | Val  Loss: 0.1124 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1445 | Val  Acc: 0.9604
 Site-USPS            | Val  Loss: 0.2183 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1292 | Val  Acc: 0.9568
 Site-SynthDigits     | Val  Loss: 0.4192 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5058 | Val  Acc: 0.8561
 Site-MNIST-M         | Val  Loss: 0.5680 | Val  Acc: 0.8478
 Site-MNIST-M         | Val  Loss: 0.6838 | Val  Acc: 0.7734
 Site-SVHN            | Val  Loss: 0.9325 | Val  Acc: 0.6957
 Site-SVHN            | Val  Loss: 1.0824 | Val  Acc: 0.6583
Average Valid Accuracy: 0.8564
============ Train epoch 49 ============
 Site-MNIST           | Train Loss: 0.1532 | Train Acc: 0.9596
 Site-MNIST           | Train Loss: 0.1407 | Train Acc: 0.9605
 Site-USPS            | Train Loss: 0.1271 | Train Acc: 0.9596
 Site-USPS            | Train Loss: 0.0876 | Train Acc: 0.9812
 Site-SynthDigits     | Train Loss: 0.6395 | Train Acc: 0.7790
 Site-SynthDigits     | Train Loss: 0.4424 | Train Acc: 0.8807
 Site-MNIST-M         | Train Loss: 0.9476 | Train Acc: 0.6712
 Site-MNIST-M         | Train Loss: 0.6506 | Train Acc: 0.8063
 Site-SVHN            | Train Loss: 1.3321 | Train Acc: 0.5472
 Site-SVHN            | Train Loss: 1.0387 | Train Acc: 0.6655
 Site-MNIST           | Val  Loss: 0.1075 | Val  Acc: 0.9783
 Site-MNIST           | Val  Loss: 0.1331 | Val  Acc: 0.9676
 Site-USPS            | Val  Loss: 0.1882 | Val  Acc: 0.9239
 Site-USPS            | Val  Loss: 0.1151 | Val  Acc: 0.9640
 Site-SynthDigits     | Val  Loss: 0.4316 | Val  Acc: 0.9130
 Site-SynthDigits     | Val  Loss: 0.5307 | Val  Acc: 0.8309
 Site-MNIST-M         | Val  Loss: 0.5758 | Val  Acc: 0.8478
 Site-MNIST-M         | Val  Loss: 0.6955 | Val  Acc: 0.7734
 Site-SVHN            | Val  Loss: 0.9194 | Val  Acc: 0.7065
 Site-SVHN            | Val  Loss: 1.0671 | Val  Acc: 0.6403
Average Valid Accuracy: 0.8546
===2023-05-13 23:55:12===
===2023-05-13 23:55:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST           | Epoch:45 | Test Acc: 0.9294
 Test site-USPS            | Epoch:45 | Test Acc: 0.9473
 Test site-SynthDigits     | Epoch:45 | Test Acc: 0.7881
 Test site-MNIST-M         | Epoch:45 | Test Acc: 0.5529
 Test site-SVHN            | Epoch:45 | Test Acc: 0.4962
Average Test Accuracy: 0.7428

[1, 1, 1, 1, 1]
mean_domain: 0.7428, mean_individual: 0.7428,
std_domain: 0.1874, std_individual: 0.1874, 
