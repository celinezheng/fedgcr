===2023-03-30 12:27:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.1464 | Train Acc: 0.1746
 Site-SVHN      | Train Loss: 2.2629 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 2.1194 | Train Acc: 0.2698
 Site-SVHN      | Train Loss: 2.2355 | Train Acc: 0.1746
 Site-SVHN      | Train Loss: 2.0602 | Train Acc: 0.3810
 Site-SVHN      | Train Loss: 2.1042 | Train Acc: 0.3175
 Site-SVHN      | Train Loss: 2.1000 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 2.1294 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.2529 | Train Acc: 0.0952
 Site-MNIST-M   | Train Loss: 2.3181 | Train Acc: 0.1746
 Site-SVHN      | Val  Loss: 2.1349 | Val  Acc: 0.3095
 Site-SVHN      | Val  Loss: 2.0968 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 2.1673 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.3510 | Val  Acc: 0.0952
 Site-SVHN      | Val  Loss: 2.0624 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.2684 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.2302 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 2.1403 | Val  Acc: 0.1667
 Site-SynthDigits| Val  Loss: 2.2728 | Val  Acc: 0.0476
 Site-MNIST-M   | Val  Loss: 2.3549 | Val  Acc: 0.0238
Average Valid Accuracy: 0.1952
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3095
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0952
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1667
 Best site-USPS       | Epoch:0 | Val Acc: 0.1667
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0476
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0238
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0777 | Train Acc: 0.2063
 Site-SVHN      | Train Loss: 2.1926 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 2.0468 | Train Acc: 0.2698
 Site-SVHN      | Train Loss: 2.1576 | Train Acc: 0.2540
 Site-SVHN      | Train Loss: 1.9935 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 2.0154 | Train Acc: 0.3175
 Site-SVHN      | Train Loss: 2.0085 | Train Acc: 0.2540
 Site-USPS      | Train Loss: 1.9419 | Train Acc: 0.2857
 Site-SynthDigits| Train Loss: 2.1363 | Train Acc: 0.1587
 Site-MNIST-M   | Train Loss: 2.2343 | Train Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.0457 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 2.0406 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 2.0607 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 2.2920 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 1.9835 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.1987 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.1615 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 1.9660 | Val  Acc: 0.2381
 Site-SynthDigits| Val  Loss: 2.2000 | Val  Acc: 0.1429
 Site-MNIST-M   | Val  Loss: 2.3189 | Val  Acc: 0.1190
Average Valid Accuracy: 0.2476
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1905
 Best site-USPS       | Epoch:1 | Val Acc: 0.2381
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1429
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.0165 | Train Acc: 0.2381
 Site-SVHN      | Train Loss: 2.1330 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 1.9750 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 2.0721 | Train Acc: 0.2698
 Site-SVHN      | Train Loss: 1.9248 | Train Acc: 0.4921
 Site-SVHN      | Train Loss: 1.9437 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 1.9433 | Train Acc: 0.3651
 Site-USPS      | Train Loss: 1.7790 | Train Acc: 0.4444
 Site-SynthDigits| Train Loss: 2.0109 | Train Acc: 0.3175
 Site-MNIST-M   | Train Loss: 2.1567 | Train Acc: 0.2540
 Site-SVHN      | Val  Loss: 1.9729 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.9758 | Val  Acc: 0.4524
 Site-SVHN      | Val  Loss: 1.9735 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 2.2019 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 1.9144 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 2.1200 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.1158 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 1.8096 | Val  Acc: 0.3810
 Site-SynthDigits| Val  Loss: 2.0875 | Val  Acc: 0.2619
 Site-MNIST-M   | Val  Loss: 2.2907 | Val  Acc: 0.1190
Average Valid Accuracy: 0.3024
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4524
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1905
 Best site-USPS       | Epoch:2 | Val Acc: 0.3810
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2619
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.9482 | Train Acc: 0.2857
 Site-SVHN      | Train Loss: 2.0678 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 1.9087 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.9953 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 1.8658 | Train Acc: 0.5079
 Site-SVHN      | Train Loss: 1.8729 | Train Acc: 0.4603
 Site-SVHN      | Train Loss: 1.8822 | Train Acc: 0.4127
 Site-USPS      | Train Loss: 1.6428 | Train Acc: 0.5238
 Site-SynthDigits| Train Loss: 1.9088 | Train Acc: 0.4286
 Site-MNIST-M   | Train Loss: 2.0823 | Train Acc: 0.2540
 Site-SVHN      | Val  Loss: 1.9049 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9224 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.8941 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.1342 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 1.8384 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 2.0559 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.0594 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 1.6850 | Val  Acc: 0.4524
 Site-SynthDigits| Val  Loss: 2.0113 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.2764 | Val  Acc: 0.0952
Average Valid Accuracy: 0.3333
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2143
 Best site-USPS       | Epoch:3 | Val Acc: 0.4524
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.0952
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.9236 | Train Acc: 0.3016
 Site-SVHN      | Train Loss: 1.9966 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 1.8498 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 1.9280 | Train Acc: 0.3651
 Site-SVHN      | Train Loss: 1.7914 | Train Acc: 0.5556
 Site-SVHN      | Train Loss: 1.8031 | Train Acc: 0.4444
 Site-SVHN      | Train Loss: 1.8258 | Train Acc: 0.4127
 Site-USPS      | Train Loss: 1.5279 | Train Acc: 0.5079
 Site-SynthDigits| Train Loss: 1.8183 | Train Acc: 0.4762
 Site-MNIST-M   | Train Loss: 2.0282 | Train Acc: 0.3175
 Site-SVHN      | Val  Loss: 1.8281 | Val  Acc: 0.5476
 Site-SVHN      | Val  Loss: 1.8717 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.8183 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 2.0909 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 1.7788 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 1.9782 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.0186 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 1.5756 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.9410 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.2501 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3571
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5476
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2143
 Best site-USPS       | Epoch:4 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.8677 | Train Acc: 0.3810
 Site-SVHN      | Train Loss: 1.9467 | Train Acc: 0.2381
 Site-SVHN      | Train Loss: 1.7931 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 1.8700 | Train Acc: 0.3810
 Site-SVHN      | Train Loss: 1.7493 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.7304 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.7754 | Train Acc: 0.4444
 Site-USPS      | Train Loss: 1.4108 | Train Acc: 0.5397
 Site-SynthDigits| Train Loss: 1.7288 | Train Acc: 0.4921
 Site-MNIST-M   | Train Loss: 1.9527 | Train Acc: 0.3492
 Site-SVHN      | Val  Loss: 1.7674 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 1.8277 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.7527 | Val  Acc: 0.4524
 Site-SVHN      | Val  Loss: 2.0330 | Val  Acc: 0.2619
 Site-SVHN      | Val  Loss: 1.7245 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9130 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 1.9654 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 1.4651 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.8868 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.2097 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3762
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4524
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2619
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2143
 Best site-USPS       | Epoch:5 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.8222 | Train Acc: 0.3651
 Site-SVHN      | Train Loss: 1.8894 | Train Acc: 0.3016
 Site-SVHN      | Train Loss: 1.7371 | Train Acc: 0.3968
 Site-SVHN      | Train Loss: 1.8123 | Train Acc: 0.3968
 Site-SVHN      | Train Loss: 1.6885 | Train Acc: 0.5556
 Site-SVHN      | Train Loss: 1.6630 | Train Acc: 0.5079
 Site-SVHN      | Train Loss: 1.7061 | Train Acc: 0.4762
 Site-USPS      | Train Loss: 1.3110 | Train Acc: 0.5556
 Site-SynthDigits| Train Loss: 1.6467 | Train Acc: 0.5079
 Site-MNIST-M   | Train Loss: 1.8899 | Train Acc: 0.3651
 Site-SVHN      | Val  Loss: 1.7019 | Val  Acc: 0.5952
 Site-SVHN      | Val  Loss: 1.7600 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.6917 | Val  Acc: 0.4524
 Site-SVHN      | Val  Loss: 1.9857 | Val  Acc: 0.2619
 Site-SVHN      | Val  Loss: 1.6675 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.8517 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 1.9262 | Val  Acc: 0.2619
 Site-USPS      | Val  Loss: 1.3757 | Val  Acc: 0.5476
 Site-SynthDigits| Val  Loss: 1.8305 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.1879 | Val  Acc: 0.1190
Average Valid Accuracy: 0.3881
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5952
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4524
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2619
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2619
 Best site-USPS       | Epoch:6 | Val Acc: 0.5476
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 1.7685 | Train Acc: 0.3651
 Site-SVHN      | Train Loss: 1.8532 | Train Acc: 0.3016
 Site-SVHN      | Train Loss: 1.6941 | Train Acc: 0.4444
 Site-SVHN      | Train Loss: 1.7635 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 1.6315 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.6232 | Train Acc: 0.5556
 Site-SVHN      | Train Loss: 1.6555 | Train Acc: 0.5238
 Site-USPS      | Train Loss: 1.2194 | Train Acc: 0.6508
 Site-SynthDigits| Train Loss: 1.5762 | Train Acc: 0.5397
 Site-MNIST-M   | Train Loss: 1.8386 | Train Acc: 0.3810
 Site-SVHN      | Val  Loss: 1.6546 | Val  Acc: 0.6190
 Site-SVHN      | Val  Loss: 1.7126 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.6456 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9339 | Val  Acc: 0.2619
 Site-SVHN      | Val  Loss: 1.6202 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.8128 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 1.8848 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.2964 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.7809 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.1534 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4071
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6190
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2619
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2857
 Best site-USPS       | Epoch:7 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 1.7229 | Train Acc: 0.4286
 Site-SVHN      | Train Loss: 1.7880 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.6423 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.7037 | Train Acc: 0.4444
 Site-SVHN      | Train Loss: 1.5872 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.5564 | Train Acc: 0.5873
 Site-SVHN      | Train Loss: 1.6119 | Train Acc: 0.5714
 Site-USPS      | Train Loss: 1.1263 | Train Acc: 0.6984
 Site-SynthDigits| Train Loss: 1.4833 | Train Acc: 0.5397
 Site-MNIST-M   | Train Loss: 1.7760 | Train Acc: 0.4286
 Site-SVHN      | Val  Loss: 1.6004 | Val  Acc: 0.6190
 Site-SVHN      | Val  Loss: 1.6677 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.5907 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.8662 | Val  Acc: 0.3095
 Site-SVHN      | Val  Loss: 1.5735 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 1.7480 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.8382 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.2091 | Val  Acc: 0.6905
 Site-SynthDigits| Val  Loss: 1.7157 | Val  Acc: 0.4048
 Site-MNIST-M   | Val  Loss: 2.1321 | Val  Acc: 0.1905
Average Valid Accuracy: 0.4381
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6190
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3095
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2857
 Best site-USPS       | Epoch:8 | Val Acc: 0.6905
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4048
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1905
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 1.6850 | Train Acc: 0.4603
 Site-SVHN      | Train Loss: 1.7572 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.5826 | Train Acc: 0.4921
 Site-SVHN      | Train Loss: 1.6557 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.5290 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.5111 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.5509 | Train Acc: 0.5714
 Site-USPS      | Train Loss: 1.0570 | Train Acc: 0.7143
 Site-SynthDigits| Train Loss: 1.4346 | Train Acc: 0.5714
 Site-MNIST-M   | Train Loss: 1.7261 | Train Acc: 0.4603
 Site-SVHN      | Val  Loss: 1.5541 | Val  Acc: 0.6429
 Site-SVHN      | Val  Loss: 1.6209 | Val  Acc: 0.4762
 Site-SVHN      | Val  Loss: 1.5558 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.8209 | Val  Acc: 0.3095
 Site-SVHN      | Val  Loss: 1.5233 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 1.7075 | Val  Acc: 0.3571
 Site-SVHN      | Val  Loss: 1.8105 | Val  Acc: 0.3095
 Site-USPS      | Val  Loss: 1.1490 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.6746 | Val  Acc: 0.4524
 Site-MNIST-M   | Val  Loss: 2.1066 | Val  Acc: 0.2381
Average Valid Accuracy: 0.4595
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6429
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4762
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3095
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3571
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3095
 Best site-USPS       | Epoch:9 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4524
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST...
===2023-03-30 12:51:09===
===2023-03-30 12:51:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.3986
Average Test Accuracy: 0.3986
