===2023-03-30 05:33:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.1588 | Train Acc: 0.2063
 Site-SVHN      | Train Loss: 2.2685 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 2.1224 | Train Acc: 0.2381
 Site-SVHN      | Train Loss: 2.2378 | Train Acc: 0.1746
 Site-SVHN      | Train Loss: 2.0459 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 2.0907 | Train Acc: 0.3016
 Site-SVHN      | Train Loss: 2.1093 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 2.1314 | Train Acc: 0.1905
 Site-SynthDigits| Train Loss: 2.2631 | Train Acc: 0.1429
 Site-MNIST-M   | Train Loss: 2.3035 | Train Acc: 0.1905
 Site-SVHN      | Val  Loss: 2.1194 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 2.0875 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.1618 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.3734 | Val  Acc: 0.0952
 Site-SVHN      | Val  Loss: 2.0592 | Val  Acc: 0.2857
 Site-SVHN      | Val  Loss: 2.2587 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.2475 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 2.1442 | Val  Acc: 0.1429
 Site-SynthDigits| Val  Loss: 2.2759 | Val  Acc: 0.0952
 Site-MNIST-M   | Val  Loss: 2.3624 | Val  Acc: 0.0714
Average Valid Accuracy: 0.1952
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0952
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2857
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1905
 Best site-USPS       | Epoch:0 | Val Acc: 0.1429
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0952
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.0830 | Train Acc: 0.2063
 Site-SVHN      | Train Loss: 2.1889 | Train Acc: 0.1905
 Site-SVHN      | Train Loss: 2.0600 | Train Acc: 0.2698
 Site-SVHN      | Train Loss: 2.1537 | Train Acc: 0.2222
 Site-SVHN      | Train Loss: 1.9887 | Train Acc: 0.4286
 Site-SVHN      | Train Loss: 2.0296 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 2.0196 | Train Acc: 0.2698
 Site-USPS      | Train Loss: 1.9416 | Train Acc: 0.2698
 Site-SynthDigits| Train Loss: 2.1316 | Train Acc: 0.2222
 Site-MNIST-M   | Train Loss: 2.2113 | Train Acc: 0.2063
 Site-SVHN      | Val  Loss: 2.0465 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 2.0326 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 2.0691 | Val  Acc: 0.2619
 Site-SVHN      | Val  Loss: 2.2832 | Val  Acc: 0.1429
 Site-SVHN      | Val  Loss: 1.9963 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.1738 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.1928 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.9638 | Val  Acc: 0.2381
 Site-SynthDigits| Val  Loss: 2.1664 | Val  Acc: 0.1667
 Site-MNIST-M   | Val  Loss: 2.3083 | Val  Acc: 0.0714
Average Valid Accuracy: 0.2381
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2619
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-USPS       | Epoch:1 | Val Acc: 0.2381
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1667
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.0714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.0286 | Train Acc: 0.3016
 Site-SVHN      | Train Loss: 2.0871 | Train Acc: 0.2063
 Site-SVHN      | Train Loss: 1.9787 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 2.0443 | Train Acc: 0.2698
 Site-SVHN      | Train Loss: 1.9145 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 1.9108 | Train Acc: 0.3968
 Site-SVHN      | Train Loss: 1.9651 | Train Acc: 0.3016
 Site-USPS      | Train Loss: 1.6290 | Train Acc: 0.5873
 Site-SynthDigits| Train Loss: 1.9152 | Train Acc: 0.4127
 Site-MNIST-M   | Train Loss: 2.0775 | Train Acc: 0.2222
 Site-SVHN      | Val  Loss: 1.9537 | Val  Acc: 0.3810
 Site-SVHN      | Val  Loss: 1.9575 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 1.9378 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.2049 | Val  Acc: 0.1905
 Site-SVHN      | Val  Loss: 1.9209 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 2.0545 | Val  Acc: 0.2143
 Site-SVHN      | Val  Loss: 2.1457 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 1.6787 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 2.0290 | Val  Acc: 0.3571
 Site-MNIST-M   | Val  Loss: 2.2617 | Val  Acc: 0.1429
Average Valid Accuracy: 0.3143
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3810
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1905
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2143
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2143
 Best site-USPS       | Epoch:2 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3571
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.8735 | Train Acc: 0.3968
 Site-SVHN      | Train Loss: 2.0231 | Train Acc: 0.2381
 Site-SVHN      | Train Loss: 1.8195 | Train Acc: 0.3968
 Site-SVHN      | Train Loss: 1.9573 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 1.7777 | Train Acc: 0.4127
 Site-SVHN      | Train Loss: 1.7716 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.7514 | Train Acc: 0.3968
 Site-USPS      | Train Loss: 1.3006 | Train Acc: 0.6667
 Site-SynthDigits| Train Loss: 1.7743 | Train Acc: 0.4444
 Site-MNIST-M   | Train Loss: 1.9166 | Train Acc: 0.3016
 Site-SVHN      | Val  Loss: 1.8218 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 1.8648 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 1.8032 | Val  Acc: 0.4524
 Site-SVHN      | Val  Loss: 2.1917 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 1.6971 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 2.0173 | Val  Acc: 0.2381
 Site-SVHN      | Val  Loss: 2.0204 | Val  Acc: 0.2619
 Site-USPS      | Val  Loss: 1.3760 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 2.0214 | Val  Acc: 0.2619
 Site-MNIST-M   | Val  Loss: 2.2343 | Val  Acc: 0.1190
Average Valid Accuracy: 0.3381
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4524
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2381
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2619
 Best site-USPS       | Epoch:3 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2619
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1190
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.7198 | Train Acc: 0.4444
 Site-SVHN      | Train Loss: 1.8053 | Train Acc: 0.3492
 Site-SVHN      | Train Loss: 1.6167 | Train Acc: 0.4444
 Site-SVHN      | Train Loss: 1.7440 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.5604 | Train Acc: 0.5238
 Site-SVHN      | Train Loss: 1.5163 | Train Acc: 0.4762
 Site-SVHN      | Train Loss: 1.4819 | Train Acc: 0.5079
 Site-USPS      | Train Loss: 1.1071 | Train Acc: 0.6667
 Site-SynthDigits| Train Loss: 1.4278 | Train Acc: 0.6190
 Site-MNIST-M   | Train Loss: 1.7593 | Train Acc: 0.4127
 Site-SVHN      | Val  Loss: 1.5422 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.6506 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5697 | Val  Acc: 0.5476
 Site-SVHN      | Val  Loss: 2.0165 | Val  Acc: 0.2619
 Site-SVHN      | Val  Loss: 1.5014 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 1.7396 | Val  Acc: 0.3571
 Site-SVHN      | Val  Loss: 1.8512 | Val  Acc: 0.3571
 Site-USPS      | Val  Loss: 1.1815 | Val  Acc: 0.5714
 Site-SynthDigits| Val  Loss: 1.7361 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.2614 | Val  Acc: 0.1429
Average Valid Accuracy: 0.4167
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5476
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2619
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3571
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3571
 Best site-USPS       | Epoch:4 | Val Acc: 0.5714
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1429
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.3866 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.6742 | Train Acc: 0.4603
 Site-SVHN      | Train Loss: 1.3386 | Train Acc: 0.6825
 Site-SVHN      | Train Loss: 1.4675 | Train Acc: 0.4921
 Site-SVHN      | Train Loss: 1.4310 | Train Acc: 0.5556
 Site-SVHN      | Train Loss: 1.4343 | Train Acc: 0.5714
 Site-SVHN      | Train Loss: 1.2148 | Train Acc: 0.6190
 Site-USPS      | Train Loss: 0.8123 | Train Acc: 0.7778
 Site-SynthDigits| Train Loss: 1.2130 | Train Acc: 0.6349
 Site-MNIST-M   | Train Loss: 1.4395 | Train Acc: 0.5714
 Site-SVHN      | Val  Loss: 1.5311 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.4772 | Val  Acc: 0.5476
 Site-SVHN      | Val  Loss: 1.3790 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.5630 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 1.2548 | Val  Acc: 0.7143
 Site-SVHN      | Val  Loss: 1.6487 | Val  Acc: 0.4048
 Site-SVHN      | Val  Loss: 1.5782 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.9528 | Val  Acc: 0.6429
 Site-SynthDigits| Val  Loss: 1.5961 | Val  Acc: 0.4524
 Site-MNIST-M   | Val  Loss: 2.1514 | Val  Acc: 0.2619
Average Valid Accuracy: 0.5095
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5476
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:5 | Val Acc: 0.7143
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4048
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-USPS       | Epoch:5 | Val Acc: 0.6429
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4524
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.2600 | Train Acc: 0.6032
 Site-SVHN      | Train Loss: 1.4031 | Train Acc: 0.6032
 Site-SVHN      | Train Loss: 1.0929 | Train Acc: 0.6825
 Site-SVHN      | Train Loss: 1.3109 | Train Acc: 0.6032
 Site-SVHN      | Train Loss: 1.1244 | Train Acc: 0.6190
 Site-SVHN      | Train Loss: 1.0632 | Train Acc: 0.6984
 Site-SVHN      | Train Loss: 1.0080 | Train Acc: 0.6984
 Site-USPS      | Train Loss: 0.7265 | Train Acc: 0.7778
 Site-SynthDigits| Train Loss: 0.9908 | Train Acc: 0.7778
 Site-MNIST-M   | Train Loss: 1.2692 | Train Acc: 0.6032
 Site-SVHN      | Val  Loss: 1.1119 | Val  Acc: 0.6905
 Site-SVHN      | Val  Loss: 1.2089 | Val  Acc: 0.5476
 Site-SVHN      | Val  Loss: 1.1697 | Val  Acc: 0.6429
 Site-SVHN      | Val  Loss: 1.4795 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 0.9944 | Val  Acc: 0.7143
 Site-SVHN      | Val  Loss: 1.3323 | Val  Acc: 0.5952
 Site-SVHN      | Val  Loss: 1.3698 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.8243 | Val  Acc: 0.6667
 Site-SynthDigits| Val  Loss: 1.4344 | Val  Acc: 0.4762
 Site-MNIST-M   | Val  Loss: 2.1506 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5810
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6905
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5476
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6429
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7143
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5952
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5714
 Best site-USPS       | Epoch:6 | Val Acc: 0.6667
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4762
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 1.0593 | Train Acc: 0.6349
 Site-SVHN      | Train Loss: 1.2013 | Train Acc: 0.6508
 Site-SVHN      | Train Loss: 0.9069 | Train Acc: 0.7778
 Site-SVHN      | Train Loss: 1.0883 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 0.9729 | Train Acc: 0.7302
 Site-SVHN      | Train Loss: 1.0009 | Train Acc: 0.7460
 Site-SVHN      | Train Loss: 0.8164 | Train Acc: 0.7619
 Site-USPS      | Train Loss: 0.5508 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 0.7669 | Train Acc: 0.8571
 Site-MNIST-M   | Train Loss: 0.9598 | Train Acc: 0.8571
 Site-SVHN      | Val  Loss: 1.1127 | Val  Acc: 0.6905
 Site-SVHN      | Val  Loss: 1.0038 | Val  Acc: 0.7381
 Site-SVHN      | Val  Loss: 1.0043 | Val  Acc: 0.7143
 Site-SVHN      | Val  Loss: 1.1600 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 0.8415 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 1.1518 | Val  Acc: 0.6190
 Site-SVHN      | Val  Loss: 1.1693 | Val  Acc: 0.5952
 Site-USPS      | Val  Loss: 0.6475 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.2571 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 2.0296 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6643
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6905
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7381
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7143
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6190
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5952
 Best site-USPS       | Epoch:7 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4286
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.8845 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.0346 | Train Acc: 0.6984
 Site-SVHN      | Train Loss: 0.7296 | Train Acc: 0.8254
 Site-SVHN      | Train Loss: 0.9814 | Train Acc: 0.7460
 Site-SVHN      | Train Loss: 0.7380 | Train Acc: 0.8095
 Site-SVHN      | Train Loss: 0.7605 | Train Acc: 0.8413
 Site-SVHN      | Train Loss: 0.7373 | Train Acc: 0.7778
 Site-USPS      | Train Loss: 0.4623 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 0.6599 | Train Acc: 0.8571
 Site-MNIST-M   | Train Loss: 0.8557 | Train Acc: 0.8413
 Site-SVHN      | Val  Loss: 0.8297 | Val  Acc: 0.8095
 Site-SVHN      | Val  Loss: 0.7970 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 0.8918 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 1.0431 | Val  Acc: 0.7143
 Site-SVHN      | Val  Loss: 0.6546 | Val  Acc: 0.8571
 Site-SVHN      | Val  Loss: 1.0179 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 0.9485 | Val  Acc: 0.6905
 Site-USPS      | Val  Loss: 0.5693 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.1969 | Val  Acc: 0.5714
 Site-MNIST-M   | Val  Loss: 1.9911 | Val  Acc: 0.4762
Average Valid Accuracy: 0.7167
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8095
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7143
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8571
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6905
 Best site-USPS       | Epoch:8 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5714
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.7930 | Train Acc: 0.7619
 Site-SVHN      | Train Loss: 0.7516 | Train Acc: 0.8254
 Site-SVHN      | Train Loss: 0.6351 | Train Acc: 0.8413
 Site-SVHN      | Train Loss: 0.7033 | Train Acc: 0.8413
 Site-SVHN      | Train Loss: 0.6077 | Train Acc: 0.8254
 Site-SVHN      | Train Loss: 0.6391 | Train Acc: 0.8571
 Site-SVHN      | Train Loss: 0.5934 | Train Acc: 0.8254
 Site-USPS      | Train Loss: 0.3960 | Train Acc: 0.9206
 Site-SynthDigits| Train Loss: 0.5035 | Train Acc: 0.8730
 Site-MNIST-M   | Train Loss: 0.6044 | Train Acc: 0.9524
 Site-SVHN      | Val  Loss: 0.6963 | Val  Acc: 0.8095
 Site-SVHN      | Val  Loss: 0.6426 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 0.6205 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 0.8142 | Val  Acc: 0.8571
 Site-SVHN      | Val  Loss: 0.5834 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 0.7406 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 0.7258 | Val  Acc: 0.8095
 Site-USPS      | Val  Loss: 0.4882 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.0925 | Val  Acc: 0.6190
 Site-MNIST-M   | Val  Loss: 1.9374 | Val  Acc: 0.4762
Average Valid Accuracy: 0.7762
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8095
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8571
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8095
 Best site-USPS       | Epoch:9 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6190
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST...
===2023-03-30 05:57:56===
===2023-03-30 05:57:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.4421
Average Test Accuracy: 0.4421
