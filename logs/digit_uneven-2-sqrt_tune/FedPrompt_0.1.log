===2023-03-27 15:57:11===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6934 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.5810 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6249 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5357 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.6472 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2590 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1708 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.7308 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 2.1094 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.1870 | Train Acc: 0.1932
 Site-MNIST     | Val  Loss: 1.5367 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.5655 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6273 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.6433 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.5700 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1963 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.1977 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7414 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1149 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2042 | Val  Acc: 0.1356
Average Valid Accuracy: 0.4661
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.0678 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.0010 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.0416 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.8860 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0562 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1754 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 1.9999 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.2109 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.8546 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.9969 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 0.8542 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.9539 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0297 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0595 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.9697 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0773 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0729 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.2328 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9167 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0752 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6298 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6286 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6085 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5061 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.6556 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0555 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 1.9209 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.8773 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.7008 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.8592 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.4671 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.5462 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6064 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6610 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6060 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0138 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9098 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.9207 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.7079 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.9136 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6424
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-USPS       | Epoch:2 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4177 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.3865 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4073 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3013 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.4045 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.8559 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.7864 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.5748 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.4353 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.5978 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.2876 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3216 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3947 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4087 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4144 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.8725 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7356 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.6170 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5187 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.7380 | Val  Acc: 0.3898
Average Valid Accuracy: 0.7254
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2507 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2527 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2336 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1711 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2440 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.5697 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5898 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.4179 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.1073 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.3248 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.1606 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1801 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2609 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2661 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2605 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.6957 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.5515 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.4434 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3611 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5468 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7746
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5254
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1702 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1681 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1450 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1115 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1575 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.4472 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.4776 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.2884 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.9061 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.0952 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.0994 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1118 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1660 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1664 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1728 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.5275 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3897 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.3481 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2871 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4269 | Val  Acc: 0.5085
Average Valid Accuracy: 0.8068
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1202 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1151 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0993 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0664 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0993 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.0701 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 1.1803 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 0.1925 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.6944 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.8213 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0693 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1147 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1107 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1234 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.2655 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 1.0967 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.2684 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1306 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.2860 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8525
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7119
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1019 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0946 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0763 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0581 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0825 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8939 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 1.1149 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.1378 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.5834 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.6511 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.0598 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0540 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0861 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0884 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1066 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.2019 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.9665 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.2465 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1147 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1904 | Val  Acc: 0.6271
Average Valid Accuracy: 0.8661
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7458
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0577 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0470 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0459 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0481 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.7385 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.8364 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 0.1140 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4422 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5051 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0290 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0497 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0550 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.9254 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.7768 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.2033 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.9816 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.0959 | Val  Acc: 0.6949
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0359 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0440 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0410 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0221 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0291 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5352 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.6625 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.0921 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.3041 | Train Acc: 0.9773
 Site-MNIST-M   | Train Loss: 0.3360 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0454 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7093 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.5784 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.1697 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.8745 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.9954 | Val  Acc: 0.7288
Average Valid Accuracy: 0.9136
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.1...
===2023-03-27 16:31:27===
===2023-03-27 16:31:28===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3219
 Test site-USPS      | Epoch:9 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5284
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3557
Average Test Accuracy: 0.5950
