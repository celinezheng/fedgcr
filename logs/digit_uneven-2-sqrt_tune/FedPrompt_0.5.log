===2023-03-27 16:35:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6674 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.5785 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6006 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5153 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.6309 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2496 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.1742 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.6961 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 2.1177 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1965 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.5107 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.5463 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6039 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6385 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.5629 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1856 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.2071 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7153 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1048 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2164 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1055 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.0332 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.0709 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 0.9265 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 1.0652 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.2001 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 1.9770 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2396 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.8145 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.0440 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 0.8988 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.9678 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0694 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0884 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.0033 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.0443 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0971 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2280 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.8523 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.0727 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5678
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6649 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.6502 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6613 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5665 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.6596 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0484 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8433 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.8083 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.6188 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.8737 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 0.5306 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5794 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6584 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6910 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6278 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9203 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9238 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.8389 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.6731 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9447 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6729
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4345 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.4398 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4548 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3436 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.4232 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.8895 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.6718 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.5668 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4616 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.5972 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 0.3316 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3672 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4465 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4631 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4226 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.7094 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7601 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.6118 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5684 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.7439 | Val  Acc: 0.4407
Average Valid Accuracy: 0.7153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3898
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2377 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2585 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2509 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1830 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2677 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.6961 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.4851 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4114 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.2308 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.3699 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.1847 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1855 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2746 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2634 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2681 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.5702 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5605 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.4360 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.4420 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6161 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7525
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5254
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1697 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1930 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1825 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.1312 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1760 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.4391 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.1605 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.2863 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9917 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.0108 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.1256 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1331 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2049 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1757 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2039 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.2056 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.2563 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.3543 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.2762 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.3296 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8119
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:5 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.0962 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1165 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1173 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0697 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1156 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.1731 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 0.9952 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.2246 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.9057 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 0.7669 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.0720 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0754 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1342 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1142 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1195 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.0588 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.0871 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.3017 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.2772 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.2041 | Val  Acc: 0.6102
Average Valid Accuracy: 0.8322
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1002 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0871 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0907 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0475 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0760 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.9056 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.7852 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 0.1551 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6510 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.5559 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.0484 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0579 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1017 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0829 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0958 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8379 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.8425 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.2650 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1507 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.0271 | Val  Acc: 0.7119
Average Valid Accuracy: 0.8712
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7458
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0546 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0523 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0613 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0578 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.7019 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.6526 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.1567 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6644 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.3605 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0310 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0744 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0561 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0537 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6979 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.7181 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 0.2379 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.1452 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 0.8850 | Val  Acc: 0.7797
Average Valid Accuracy: 0.8932
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7966
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7797
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0560 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0402 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0449 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0343 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5559 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 0.5337 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.1263 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.3934 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.2743 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0248 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0400 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0478 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5647 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.5453 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.2027 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0274 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 0.8723 | Val  Acc: 0.7627
Average Valid Accuracy: 0.9119
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt_tune/FedPrompt_tune_0.5...
===2023-03-27 17:09:39===
===2023-03-27 17:09:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: True
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8957
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3340
 Test site-USPS      | Epoch:9 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4913
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3686
Average Test Accuracy: 0.5910
