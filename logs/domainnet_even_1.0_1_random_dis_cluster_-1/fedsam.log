===2023-07-01 14:21:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart                       | Train Loss: 1.3100 | Train Acc: 0.7834
 Site-Clipart                       | Train Loss: 1.2946 | Train Acc: 0.7945
 Site-Real                          | Train Loss: 1.0564 | Train Acc: 0.8917
 Site-Real                          | Train Loss: 0.9366 | Train Acc: 0.9492
 Site-Painting                      | Train Loss: 1.1113 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 1.1400 | Train Acc: 0.8326
 Site-Sketch                        | Train Loss: 1.2948 | Train Acc: 0.6879
 Site-Sketch                        | Train Loss: 1.2735 | Train Acc: 0.7246
 Site-QuickDraw                     | Train Loss: 1.9421 | Train Acc: 0.4650
 Site-QuickDraw                     | Train Loss: 1.9524 | Train Acc: 0.4428
 Site-Infograph                     | Train Loss: 1.8266 | Train Acc: 0.4777
 Site-Infograph                     | Train Loss: 1.8116 | Train Acc: 0.4979
Average Train Accuracy: 0.7001
 Site-Clipart                       | Val  Loss: 1.3213 | Val  Acc: 0.8095
 Site-Clipart                       | Val  Loss: 1.3094 | Val  Acc: 0.7714
 Site-Real                          | Val  Loss: 0.9441 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.9714 | Val  Acc: 0.9397
 Site-Painting                      | Val  Loss: 1.0556 | Val  Acc: 0.8667
 Site-Painting                      | Val  Loss: 1.1506 | Val  Acc: 0.8413
 Site-Sketch                        | Val  Loss: 1.2658 | Val  Acc: 0.7333
 Site-Sketch                        | Val  Loss: 1.2618 | Val  Acc: 0.7365
 Site-QuickDraw                     | Val  Loss: 1.9371 | Val  Acc: 0.4476
 Site-QuickDraw                     | Val  Loss: 1.9358 | Val  Acc: 0.4349
 Site-Infograph                     | Val  Loss: 1.9059 | Val  Acc: 0.4381
 Site-Infograph                     | Val  Loss: 1.8330 | Val  Acc: 0.4857
Average Valid Accuracy: 0.7056
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.8095
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.7714
 Best site-Real                      | Epoch:0 | Val Acc: 0.9619
 Best site-Real                      | Epoch:0 | Val Acc: 0.9397
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8667
 Best site-Painting                  | Epoch:0 | Val Acc: 0.8413
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7333
 Best site-Sketch                    | Epoch:0 | Val Acc: 0.7365
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4476
 Best site-QuickDraw                 | Epoch:0 | Val Acc: 0.4349
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4381
 Best site-Infograph                 | Epoch:0 | Val Acc: 0.4857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 1 ============
 Site-Clipart                       | Train Loss: 0.8847 | Train Acc: 0.8344
 Site-Clipart                       | Train Loss: 0.8871 | Train Acc: 0.8326
 Site-Real                          | Train Loss: 0.5424 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.4543 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.6936 | Train Acc: 0.8535
 Site-Painting                      | Train Loss: 0.6825 | Train Acc: 0.8898
 Site-Sketch                        | Train Loss: 0.8948 | Train Acc: 0.7325
 Site-Sketch                        | Train Loss: 0.8155 | Train Acc: 0.7733
 Site-QuickDraw                     | Train Loss: 1.6948 | Train Acc: 0.5478
 Site-QuickDraw                     | Train Loss: 1.7127 | Train Acc: 0.5106
 Site-Infograph                     | Train Loss: 1.6059 | Train Acc: 0.5223
 Site-Infograph                     | Train Loss: 1.5882 | Train Acc: 0.5191
Average Train Accuracy: 0.7434
 Site-Clipart                       | Val  Loss: 0.8248 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.8958 | Val  Acc: 0.8190
 Site-Real                          | Val  Loss: 0.4781 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.4622 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.5682 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.7067 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.7486 | Val  Acc: 0.8190
 Site-Sketch                        | Val  Loss: 0.8468 | Val  Acc: 0.7968
 Site-QuickDraw                     | Val  Loss: 1.7202 | Val  Acc: 0.4667
 Site-QuickDraw                     | Val  Loss: 1.7030 | Val  Acc: 0.5302
 Site-Infograph                     | Val  Loss: 1.6900 | Val  Acc: 0.4476
 Site-Infograph                     | Val  Loss: 1.6255 | Val  Acc: 0.4952
Average Valid Accuracy: 0.7489
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.8190
 Best site-Real                      | Epoch:1 | Val Acc: 0.9714
 Best site-Real                      | Epoch:1 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:1 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:1 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.8190
 Best site-Sketch                    | Epoch:1 | Val Acc: 0.7968
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.4667
 Best site-QuickDraw                 | Epoch:1 | Val Acc: 0.5302
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4476
 Best site-Infograph                 | Epoch:1 | Val Acc: 0.4952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 2 ============
 Site-Clipart                       | Train Loss: 0.6535 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.6675 | Train Acc: 0.8856
 Site-Real                          | Train Loss: 0.3790 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.2914 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.5100 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.5469 | Train Acc: 0.8983
 Site-Sketch                        | Train Loss: 0.7196 | Train Acc: 0.8025
 Site-Sketch                        | Train Loss: 0.6379 | Train Acc: 0.8157
 Site-QuickDraw                     | Train Loss: 1.5612 | Train Acc: 0.4841
 Site-QuickDraw                     | Train Loss: 1.5730 | Train Acc: 0.5339
 Site-Infograph                     | Train Loss: 1.5662 | Train Acc: 0.5032
 Site-Infograph                     | Train Loss: 1.4840 | Train Acc: 0.5424
Average Train Accuracy: 0.7614
 Site-Clipart                       | Val  Loss: 0.6650 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6772 | Val  Acc: 0.8794
 Site-Real                          | Val  Loss: 0.3095 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.3154 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.4280 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.5544 | Val  Acc: 0.8603
 Site-Sketch                        | Val  Loss: 0.6372 | Val  Acc: 0.8286
 Site-Sketch                        | Val  Loss: 0.6404 | Val  Acc: 0.8190
 Site-QuickDraw                     | Val  Loss: 1.5262 | Val  Acc: 0.5048
 Site-QuickDraw                     | Val  Loss: 1.5867 | Val  Acc: 0.5206
 Site-Infograph                     | Val  Loss: 1.6151 | Val  Acc: 0.4857
 Site-Infograph                     | Val  Loss: 1.5245 | Val  Acc: 0.5079
Average Valid Accuracy: 0.7624
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.8794
 Best site-Real                      | Epoch:2 | Val Acc: 0.9714
 Best site-Real                      | Epoch:2 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:2 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:2 | Val Acc: 0.8603
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8286
 Best site-Sketch                    | Epoch:2 | Val Acc: 0.8190
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.5048
 Best site-QuickDraw                 | Epoch:2 | Val Acc: 0.5206
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.4857
 Best site-Infograph                 | Epoch:2 | Val Acc: 0.5079
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 3 ============
 Site-Clipart                       | Train Loss: 0.6206 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.5571 | Train Acc: 0.8919
 Site-Real                          | Train Loss: 0.2830 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.2155 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.5186 | Train Acc: 0.8662
 Site-Painting                      | Train Loss: 0.4516 | Train Acc: 0.8898
 Site-Sketch                        | Train Loss: 0.6439 | Train Acc: 0.7962
 Site-Sketch                        | Train Loss: 0.6178 | Train Acc: 0.8242
 Site-QuickDraw                     | Train Loss: 1.4545 | Train Acc: 0.6178
 Site-QuickDraw                     | Train Loss: 1.4436 | Train Acc: 0.5657
 Site-Infograph                     | Train Loss: 1.5588 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.4483 | Train Acc: 0.5805
Average Train Accuracy: 0.7817
 Site-Clipart                       | Val  Loss: 0.5404 | Val  Acc: 0.8762
 Site-Clipart                       | Val  Loss: 0.6125 | Val  Acc: 0.8635
 Site-Real                          | Val  Loss: 0.2344 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.2606 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3581 | Val  Acc: 0.9238
 Site-Painting                      | Val  Loss: 0.4710 | Val  Acc: 0.8825
 Site-Sketch                        | Val  Loss: 0.5530 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 0.5776 | Val  Acc: 0.8444
 Site-QuickDraw                     | Val  Loss: 1.5380 | Val  Acc: 0.4857
 Site-QuickDraw                     | Val  Loss: 1.4403 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.5894 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.4672 | Val  Acc: 0.5460
Average Valid Accuracy: 0.7757
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8762
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.8635
 Best site-Real                      | Epoch:3 | Val Acc: 0.9714
 Best site-Real                      | Epoch:3 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:3 | Val Acc: 0.9238
 Best site-Painting                  | Epoch:3 | Val Acc: 0.8825
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8381
 Best site-Sketch                    | Epoch:3 | Val Acc: 0.8444
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.4857
 Best site-QuickDraw                 | Epoch:3 | Val Acc: 0.6000
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5143
 Best site-Infograph                 | Epoch:3 | Val Acc: 0.5460
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 4 ============
 Site-Clipart                       | Train Loss: 0.5607 | Train Acc: 0.8726
 Site-Clipart                       | Train Loss: 0.4814 | Train Acc: 0.8983
 Site-Real                          | Train Loss: 0.2411 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1762 | Train Acc: 0.9746
 Site-Painting                      | Train Loss: 0.4000 | Train Acc: 0.8917
 Site-Painting                      | Train Loss: 0.4125 | Train Acc: 0.8919
 Site-Sketch                        | Train Loss: 0.5573 | Train Acc: 0.8089
 Site-Sketch                        | Train Loss: 0.5386 | Train Acc: 0.8347
 Site-QuickDraw                     | Train Loss: 1.4355 | Train Acc: 0.5414
 Site-QuickDraw                     | Train Loss: 1.3690 | Train Acc: 0.5911
 Site-Infograph                     | Train Loss: 1.4658 | Train Acc: 0.4968
 Site-Infograph                     | Train Loss: 1.3936 | Train Acc: 0.5678
Average Train Accuracy: 0.7766
 Site-Clipart                       | Val  Loss: 0.5004 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.5370 | Val  Acc: 0.8889
 Site-Real                          | Val  Loss: 0.1833 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.1859 | Val  Acc: 0.9778
 Site-Painting                      | Val  Loss: 0.3176 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.4185 | Val  Acc: 0.8921
 Site-Sketch                        | Val  Loss: 0.4858 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.5536 | Val  Acc: 0.8190
 Site-QuickDraw                     | Val  Loss: 1.4618 | Val  Acc: 0.4857
 Site-QuickDraw                     | Val  Loss: 1.3306 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.5565 | Val  Acc: 0.5238
 Site-Infograph                     | Val  Loss: 1.4386 | Val  Acc: 0.5619
Average Valid Accuracy: 0.7862
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.8889
 Best site-Real                      | Epoch:4 | Val Acc: 0.9810
 Best site-Real                      | Epoch:4 | Val Acc: 0.9778
 Best site-Painting                  | Epoch:4 | Val Acc: 0.9143
 Best site-Painting                  | Epoch:4 | Val Acc: 0.8921
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:4 | Val Acc: 0.8190
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.4857
 Best site-QuickDraw                 | Epoch:4 | Val Acc: 0.6190
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph                 | Epoch:4 | Val Acc: 0.5619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 5 ============
 Site-Clipart                       | Train Loss: 0.4809 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.4510 | Train Acc: 0.8919
 Site-Real                          | Train Loss: 0.2407 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.1680 | Train Acc: 0.9767
 Site-Painting                      | Train Loss: 0.3837 | Train Acc: 0.8790
 Site-Painting                      | Train Loss: 0.3563 | Train Acc: 0.9174
 Site-Sketch                        | Train Loss: 0.6031 | Train Acc: 0.7962
 Site-Sketch                        | Train Loss: 0.4668 | Train Acc: 0.8665
 Site-QuickDraw                     | Train Loss: 1.2934 | Train Acc: 0.5478
 Site-QuickDraw                     | Train Loss: 1.3106 | Train Acc: 0.5890
 Site-Infograph                     | Train Loss: 1.4805 | Train Acc: 0.5287
 Site-Infograph                     | Train Loss: 1.3329 | Train Acc: 0.5784
Average Train Accuracy: 0.7844
 Site-Clipart                       | Val  Loss: 0.4426 | Val  Acc: 0.9048
 Site-Clipart                       | Val  Loss: 0.5011 | Val  Acc: 0.8762
 Site-Real                          | Val  Loss: 0.1914 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.1717 | Val  Acc: 0.9746
 Site-Painting                      | Val  Loss: 0.2477 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.3809 | Val  Acc: 0.9079
 Site-Sketch                        | Val  Loss: 0.4758 | Val  Acc: 0.8381
 Site-Sketch                        | Val  Loss: 0.4988 | Val  Acc: 0.8571
 Site-QuickDraw                     | Val  Loss: 1.3264 | Val  Acc: 0.5429
 Site-QuickDraw                     | Val  Loss: 1.3104 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.5671 | Val  Acc: 0.4952
 Site-Infograph                     | Val  Loss: 1.4034 | Val  Acc: 0.5841
Average Valid Accuracy: 0.7952
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.8762
 Best site-Real                      | Epoch:5 | Val Acc: 0.9714
 Best site-Real                      | Epoch:5 | Val Acc: 0.9746
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:5 | Val Acc: 0.9079
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8381
 Best site-Sketch                    | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.5429
 Best site-QuickDraw                 | Epoch:5 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.4952
 Best site-Infograph                 | Epoch:5 | Val Acc: 0.5841
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 6 ============
 Site-Clipart                       | Train Loss: 0.4155 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.4488 | Train Acc: 0.9025
 Site-Real                          | Train Loss: 0.2048 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.1316 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.3436 | Train Acc: 0.8854
 Site-Painting                      | Train Loss: 0.3535 | Train Acc: 0.9047
 Site-Sketch                        | Train Loss: 0.6101 | Train Acc: 0.8025
 Site-Sketch                        | Train Loss: 0.4791 | Train Acc: 0.8559
 Site-QuickDraw                     | Train Loss: 1.2802 | Train Acc: 0.6115
 Site-QuickDraw                     | Train Loss: 1.1948 | Train Acc: 0.6335
 Site-Infograph                     | Train Loss: 1.4246 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.3156 | Train Acc: 0.5975
Average Train Accuracy: 0.7946
 Site-Clipart                       | Val  Loss: 0.3609 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.4475 | Val  Acc: 0.8952
 Site-Real                          | Val  Loss: 0.1645 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1439 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.2813 | Val  Acc: 0.9143
 Site-Painting                      | Val  Loss: 0.3498 | Val  Acc: 0.9016
 Site-Sketch                        | Val  Loss: 0.4513 | Val  Acc: 0.8667
 Site-Sketch                        | Val  Loss: 0.4483 | Val  Acc: 0.8857
 Site-QuickDraw                     | Val  Loss: 1.2583 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.2180 | Val  Acc: 0.6317
 Site-Infograph                     | Val  Loss: 1.4439 | Val  Acc: 0.5429
 Site-Infograph                     | Val  Loss: 1.3557 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8095
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.8952
 Best site-Real                      | Epoch:6 | Val Acc: 0.9905
 Best site-Real                      | Epoch:6 | Val Acc: 0.9841
 Best site-Painting                  | Epoch:6 | Val Acc: 0.9143
 Best site-Painting                  | Epoch:6 | Val Acc: 0.9016
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8667
 Best site-Sketch                    | Epoch:6 | Val Acc: 0.8857
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.5905
 Best site-QuickDraw                 | Epoch:6 | Val Acc: 0.6317
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5429
 Best site-Infograph                 | Epoch:6 | Val Acc: 0.5778
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 7 ============
 Site-Clipart                       | Train Loss: 0.4654 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.4218 | Train Acc: 0.9068
 Site-Real                          | Train Loss: 0.2119 | Train Acc: 0.9299
 Site-Real                          | Train Loss: 0.1278 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3342 | Train Acc: 0.9045
 Site-Painting                      | Train Loss: 0.3339 | Train Acc: 0.9089
 Site-Sketch                        | Train Loss: 0.5345 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.4420 | Train Acc: 0.8771
 Site-QuickDraw                     | Train Loss: 1.2212 | Train Acc: 0.5987
 Site-QuickDraw                     | Train Loss: 1.1607 | Train Acc: 0.6314
 Site-Infograph                     | Train Loss: 1.4601 | Train Acc: 0.4904
 Site-Infograph                     | Train Loss: 1.2062 | Train Acc: 0.6419
Average Train Accuracy: 0.8026
 Site-Clipart                       | Val  Loss: 0.3767 | Val  Acc: 0.9333
 Site-Clipart                       | Val  Loss: 0.4041 | Val  Acc: 0.9048
 Site-Real                          | Val  Loss: 0.1221 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1291 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2106 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.3247 | Val  Acc: 0.9111
 Site-Sketch                        | Val  Loss: 0.3679 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.4599 | Val  Acc: 0.8603
 Site-QuickDraw                     | Val  Loss: 1.2847 | Val  Acc: 0.5333
 Site-QuickDraw                     | Val  Loss: 1.1760 | Val  Acc: 0.6413
 Site-Infograph                     | Val  Loss: 1.4525 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.2919 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8130
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9333
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.9048
 Best site-Real                      | Epoch:7 | Val Acc: 0.9905
 Best site-Real                      | Epoch:7 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:7 | Val Acc: 0.9111
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:7 | Val Acc: 0.8603
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.5333
 Best site-QuickDraw                 | Epoch:7 | Val Acc: 0.6413
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:7 | Val Acc: 0.6095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 8 ============
 Site-Clipart                       | Train Loss: 0.4027 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.3820 | Train Acc: 0.9047
 Site-Real                          | Train Loss: 0.2280 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.1251 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3556 | Train Acc: 0.9172
 Site-Painting                      | Train Loss: 0.2921 | Train Acc: 0.9216
 Site-Sketch                        | Train Loss: 0.4916 | Train Acc: 0.8217
 Site-Sketch                        | Train Loss: 0.4100 | Train Acc: 0.8686
 Site-QuickDraw                     | Train Loss: 1.0757 | Train Acc: 0.6369
 Site-QuickDraw                     | Train Loss: 1.1273 | Train Acc: 0.6674
 Site-Infograph                     | Train Loss: 1.4492 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.2903 | Train Acc: 0.5890
Average Train Accuracy: 0.8089
 Site-Clipart                       | Val  Loss: 0.2937 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.4026 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.1311 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1219 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.2211 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.3140 | Val  Acc: 0.9270
 Site-Sketch                        | Val  Loss: 0.3922 | Val  Acc: 0.8476
 Site-Sketch                        | Val  Loss: 0.4149 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.1903 | Val  Acc: 0.6095
 Site-QuickDraw                     | Val  Loss: 1.1467 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.4772 | Val  Acc: 0.5143
 Site-Infograph                     | Val  Loss: 1.3287 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8159
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.9111
 Best site-Real                      | Epoch:8 | Val Acc: 0.9905
 Best site-Real                      | Epoch:8 | Val Acc: 0.9841
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:8 | Val Acc: 0.9270
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8476
 Best site-Sketch                    | Epoch:8 | Val Acc: 0.8794
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6095
 Best site-QuickDraw                 | Epoch:8 | Val Acc: 0.6286
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5143
 Best site-Infograph                 | Epoch:8 | Val Acc: 0.5937
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 9 ============
 Site-Clipart                       | Train Loss: 0.3795 | Train Acc: 0.8854
 Site-Clipart                       | Train Loss: 0.3507 | Train Acc: 0.9110
 Site-Real                          | Train Loss: 0.1622 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.1163 | Train Acc: 0.9788
 Site-Painting                      | Train Loss: 0.3451 | Train Acc: 0.8981
 Site-Painting                      | Train Loss: 0.3165 | Train Acc: 0.9343
 Site-Sketch                        | Train Loss: 0.4507 | Train Acc: 0.8471
 Site-Sketch                        | Train Loss: 0.3720 | Train Acc: 0.8771
 Site-QuickDraw                     | Train Loss: 1.0520 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 1.0613 | Train Acc: 0.6864
 Site-Infograph                     | Train Loss: 1.3052 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.2358 | Train Acc: 0.5975
Average Train Accuracy: 0.8183
 Site-Clipart                       | Val  Loss: 0.2863 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.3607 | Val  Acc: 0.8984
 Site-Real                          | Val  Loss: 0.1097 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.1013 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1833 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.2853 | Val  Acc: 0.9206
 Site-Sketch                        | Val  Loss: 0.3720 | Val  Acc: 0.8762
 Site-Sketch                        | Val  Loss: 0.3881 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 1.1302 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 1.0958 | Val  Acc: 0.6635
 Site-Infograph                     | Val  Loss: 1.3286 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.2626 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8323
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8984
 Best site-Real                      | Epoch:9 | Val Acc: 0.9905
 Best site-Real                      | Epoch:9 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9619
 Best site-Painting                  | Epoch:9 | Val Acc: 0.9206
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8762
 Best site-Sketch                    | Epoch:9 | Val Acc: 0.8984
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6381
 Best site-QuickDraw                 | Epoch:9 | Val Acc: 0.6635
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:9 | Val Acc: 0.6063
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 10 ============
 Site-Clipart                       | Train Loss: 0.4003 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.3133 | Train Acc: 0.9195
 Site-Real                          | Train Loss: 0.1803 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0936 | Train Acc: 0.9873
 Site-Painting                      | Train Loss: 0.3273 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.2493 | Train Acc: 0.9322
 Site-Sketch                        | Train Loss: 0.4353 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3734 | Train Acc: 0.8877
 Site-QuickDraw                     | Train Loss: 1.0905 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.0585 | Train Acc: 0.6547
 Site-Infograph                     | Train Loss: 1.4023 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.2049 | Train Acc: 0.6017
Average Train Accuracy: 0.8181
 Site-Clipart                       | Val  Loss: 0.3143 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3449 | Val  Acc: 0.9111
 Site-Real                          | Val  Loss: 0.1076 | Val  Acc: 0.9714
 Site-Real                          | Val  Loss: 0.1063 | Val  Acc: 0.9841
 Site-Painting                      | Val  Loss: 0.2023 | Val  Acc: 0.9429
 Site-Painting                      | Val  Loss: 0.2678 | Val  Acc: 0.9175
 Site-Sketch                        | Val  Loss: 0.3461 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.3489 | Val  Acc: 0.9048
 Site-QuickDraw                     | Val  Loss: 1.1413 | Val  Acc: 0.5905
 Site-QuickDraw                     | Val  Loss: 1.0556 | Val  Acc: 0.6698
 Site-Infograph                     | Val  Loss: 1.4239 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.2349 | Val  Acc: 0.5937
Average Valid Accuracy: 0.8214
============ Train epoch 11 ============
 Site-Clipart                       | Train Loss: 0.3373 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2849 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.2129 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0966 | Train Acc: 0.9831
 Site-Painting                      | Train Loss: 0.3498 | Train Acc: 0.9045
 Site-Painting                      | Train Loss: 0.2468 | Train Acc: 0.9364
 Site-Sketch                        | Train Loss: 0.4266 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.3408 | Train Acc: 0.8983
 Site-QuickDraw                     | Train Loss: 1.0326 | Train Acc: 0.6306
 Site-QuickDraw                     | Train Loss: 1.0723 | Train Acc: 0.6419
 Site-Infograph                     | Train Loss: 1.2941 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.1922 | Train Acc: 0.6186
Average Train Accuracy: 0.8176
 Site-Clipart                       | Val  Loss: 0.3087 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3471 | Val  Acc: 0.9079
 Site-Real                          | Val  Loss: 0.0996 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0934 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.2160 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2548 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3436 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.3621 | Val  Acc: 0.8794
 Site-QuickDraw                     | Val  Loss: 1.1043 | Val  Acc: 0.5810
 Site-QuickDraw                     | Val  Loss: 1.0405 | Val  Acc: 0.6698
 Site-Infograph                     | Val  Loss: 1.3222 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.2573 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8249
============ Train epoch 12 ============
 Site-Clipart                       | Train Loss: 0.3986 | Train Acc: 0.8790
 Site-Clipart                       | Train Loss: 0.2463 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1767 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0842 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.2641 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.2116 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.4739 | Train Acc: 0.8344
 Site-Sketch                        | Train Loss: 0.3726 | Train Acc: 0.8835
 Site-QuickDraw                     | Train Loss: 1.0305 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9898 | Train Acc: 0.6970
 Site-Infograph                     | Train Loss: 1.3433 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.1448 | Train Acc: 0.6208
Average Train Accuracy: 0.8254
 Site-Clipart                       | Val  Loss: 0.2701 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.3521 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0800 | Val  Acc: 0.9810
 Site-Real                          | Val  Loss: 0.0886 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1601 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.2327 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.3220 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.3473 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 1.1123 | Val  Acc: 0.6286
 Site-QuickDraw                     | Val  Loss: 1.0088 | Val  Acc: 0.6508
 Site-Infograph                     | Val  Loss: 1.2896 | Val  Acc: 0.5524
 Site-Infograph                     | Val  Loss: 1.2291 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8328
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.9270
 Best site-Real                      | Epoch:12 | Val Acc: 0.9810
 Best site-Real                      | Epoch:12 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:12 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.9238
 Best site-Sketch                    | Epoch:12 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6286
 Best site-QuickDraw                 | Epoch:12 | Val Acc: 0.6508
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5524
 Best site-Infograph                 | Epoch:12 | Val Acc: 0.5968
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 13 ============
 Site-Clipart                       | Train Loss: 0.3032 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2756 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1482 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0769 | Train Acc: 0.9852
 Site-Painting                      | Train Loss: 0.2505 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.2510 | Train Acc: 0.9322
 Site-Sketch                        | Train Loss: 0.4257 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.3437 | Train Acc: 0.8835
 Site-QuickDraw                     | Train Loss: 0.9745 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.9497 | Train Acc: 0.7013
 Site-Infograph                     | Train Loss: 1.3378 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.1511 | Train Acc: 0.6208
Average Train Accuracy: 0.8321
 Site-Clipart                       | Val  Loss: 0.2417 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3294 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0798 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0934 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1739 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2311 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2896 | Val  Acc: 0.8857
 Site-Sketch                        | Val  Loss: 0.3370 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 1.0256 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9869 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 1.4002 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.2141 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8333
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.9175
 Best site-Real                      | Epoch:13 | Val Acc: 0.9905
 Best site-Real                      | Epoch:13 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:13 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.8857
 Best site-Sketch                    | Epoch:13 | Val Acc: 0.9016
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:13 | Val Acc: 0.6762
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.5333
 Best site-Infograph                 | Epoch:13 | Val Acc: 0.6095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 14 ============
 Site-Clipart                       | Train Loss: 0.4002 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2791 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1632 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0705 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2370 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.2009 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.3520 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.3291 | Train Acc: 0.9004
 Site-QuickDraw                     | Train Loss: 1.0344 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9743 | Train Acc: 0.6928
 Site-Infograph                     | Train Loss: 1.3667 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 1.1319 | Train Acc: 0.6462
Average Train Accuracy: 0.8335
 Site-Clipart                       | Val  Loss: 0.2569 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.3078 | Val  Acc: 0.9175
 Site-Real                          | Val  Loss: 0.0686 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0871 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1598 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2508 | Val  Acc: 0.9270
 Site-Sketch                        | Val  Loss: 0.3004 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.2990 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.9943 | Val  Acc: 0.6667
 Site-QuickDraw                     | Val  Loss: 0.9484 | Val  Acc: 0.6889
 Site-Infograph                     | Val  Loss: 1.2435 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 1.1841 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8458
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.9175
 Best site-Real                      | Epoch:14 | Val Acc: 0.9905
 Best site-Real                      | Epoch:14 | Val Acc: 0.9873
 Best site-Painting                  | Epoch:14 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:14 | Val Acc: 0.9270
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:14 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.6667
 Best site-QuickDraw                 | Epoch:14 | Val Acc: 0.6889
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.5810
 Best site-Infograph                 | Epoch:14 | Val Acc: 0.6381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 15 ============
 Site-Clipart                       | Train Loss: 0.3319 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2802 | Train Acc: 0.9322
 Site-Real                          | Train Loss: 0.1221 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0655 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2420 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1913 | Train Acc: 0.9470
 Site-Sketch                        | Train Loss: 0.4492 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.3158 | Train Acc: 0.8983
 Site-QuickDraw                     | Train Loss: 0.9158 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.9822 | Train Acc: 0.6822
 Site-Infograph                     | Train Loss: 1.2859 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.1124 | Train Acc: 0.6547
Average Train Accuracy: 0.8363
 Site-Clipart                       | Val  Loss: 0.2260 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2775 | Val  Acc: 0.9270
 Site-Real                          | Val  Loss: 0.0660 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0736 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1559 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2098 | Val  Acc: 0.9492
 Site-Sketch                        | Val  Loss: 0.2957 | Val  Acc: 0.8952
 Site-Sketch                        | Val  Loss: 0.3122 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 1.0186 | Val  Acc: 0.6381
 Site-QuickDraw                     | Val  Loss: 0.9259 | Val  Acc: 0.6952
 Site-Infograph                     | Val  Loss: 1.3481 | Val  Acc: 0.5619
 Site-Infograph                     | Val  Loss: 1.1843 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8418
============ Train epoch 16 ============
 Site-Clipart                       | Train Loss: 0.2570 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2903 | Train Acc: 0.9237
 Site-Real                          | Train Loss: 0.1547 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0624 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2022 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.2252 | Train Acc: 0.9364
 Site-Sketch                        | Train Loss: 0.4227 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.3035 | Train Acc: 0.9025
 Site-QuickDraw                     | Train Loss: 0.9234 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.8915 | Train Acc: 0.7140
 Site-Infograph                     | Train Loss: 1.3242 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.1067 | Train Acc: 0.6504
Average Train Accuracy: 0.8365
 Site-Clipart                       | Val  Loss: 0.2572 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.3001 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0548 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0681 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1454 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.2095 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2720 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.2929 | Val  Acc: 0.9016
 Site-QuickDraw                     | Val  Loss: 1.0157 | Val  Acc: 0.6476
 Site-QuickDraw                     | Val  Loss: 0.9105 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.3751 | Val  Acc: 0.5714
 Site-Infograph                     | Val  Loss: 1.1530 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8468
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.9206
 Best site-Real                      | Epoch:16 | Val Acc: 0.9905
 Best site-Real                      | Epoch:16 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:16 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.9048
 Best site-Sketch                    | Epoch:16 | Val Acc: 0.9016
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.6476
 Best site-QuickDraw                 | Epoch:16 | Val Acc: 0.7270
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.5714
 Best site-Infograph                 | Epoch:16 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 17 ============
 Site-Clipart                       | Train Loss: 0.2563 | Train Acc: 0.9363
 Site-Clipart                       | Train Loss: 0.2320 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1413 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0588 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2255 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.2030 | Train Acc: 0.9597
 Site-Sketch                        | Train Loss: 0.4200 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.3023 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9594 | Train Acc: 0.6561
 Site-QuickDraw                     | Train Loss: 0.9335 | Train Acc: 0.7161
 Site-Infograph                     | Train Loss: 1.3571 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.1074 | Train Acc: 0.6398
Average Train Accuracy: 0.8397
 Site-Clipart                       | Val  Loss: 0.2800 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2599 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0571 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0684 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1537 | Val  Acc: 0.9524
 Site-Painting                      | Val  Loss: 0.2103 | Val  Acc: 0.9460
 Site-Sketch                        | Val  Loss: 0.2058 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.3107 | Val  Acc: 0.8889
 Site-QuickDraw                     | Val  Loss: 0.9795 | Val  Acc: 0.6857
 Site-QuickDraw                     | Val  Loss: 0.9124 | Val  Acc: 0.7302
 Site-Infograph                     | Val  Loss: 1.3036 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1566 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8569
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9429
 Best site-Clipart                   | Epoch:17 | Val Acc: 0.9365
 Best site-Real                      | Epoch:17 | Val Acc: 0.9905
 Best site-Real                      | Epoch:17 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9524
 Best site-Painting                  | Epoch:17 | Val Acc: 0.9460
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:17 | Val Acc: 0.8889
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.6857
 Best site-QuickDraw                 | Epoch:17 | Val Acc: 0.7302
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:17 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 18 ============
 Site-Clipart                       | Train Loss: 0.2751 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.2296 | Train Acc: 0.9364
 Site-Real                          | Train Loss: 0.1496 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0571 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2434 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1819 | Train Acc: 0.9619
 Site-Sketch                        | Train Loss: 0.4440 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.2824 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9267 | Train Acc: 0.6752
 Site-QuickDraw                     | Train Loss: 0.9262 | Train Acc: 0.7203
 Site-Infograph                     | Train Loss: 1.4230 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0268 | Train Acc: 0.6547
Average Train Accuracy: 0.8358
 Site-Clipart                       | Val  Loss: 0.2446 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2700 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0738 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0616 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.1363 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1669 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.2149 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2790 | Val  Acc: 0.9079
 Site-QuickDraw                     | Val  Loss: 0.9439 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.9310 | Val  Acc: 0.7111
 Site-Infograph                     | Val  Loss: 1.1968 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1420 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8569
============ Train epoch 19 ============
 Site-Clipart                       | Train Loss: 0.3227 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.2261 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1601 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0466 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.2549 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1619 | Train Acc: 0.9555
 Site-Sketch                        | Train Loss: 0.4877 | Train Acc: 0.8535
 Site-Sketch                        | Train Loss: 0.2794 | Train Acc: 0.9110
 Site-QuickDraw                     | Train Loss: 0.9418 | Train Acc: 0.6688
 Site-QuickDraw                     | Train Loss: 0.9180 | Train Acc: 0.7182
 Site-Infograph                     | Train Loss: 1.3870 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 1.0818 | Train Acc: 0.6547
Average Train Accuracy: 0.8352
 Site-Clipart                       | Val  Loss: 0.1888 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2765 | Val  Acc: 0.9206
 Site-Real                          | Val  Loss: 0.0528 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0617 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1027 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1775 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2416 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.2500 | Val  Acc: 0.9302
 Site-QuickDraw                     | Val  Loss: 0.9831 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 0.8903 | Val  Acc: 0.7016
 Site-Infograph                     | Val  Loss: 1.2838 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.1306 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8534
============ Train epoch 20 ============
 Site-Clipart                       | Train Loss: 0.3101 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2516 | Train Acc: 0.9343
 Site-Real                          | Train Loss: 0.1205 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0528 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2252 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1675 | Train Acc: 0.9513
 Site-Sketch                        | Train Loss: 0.3678 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2928 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.9258 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.8646 | Train Acc: 0.7521
 Site-Infograph                     | Train Loss: 1.2934 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.1020 | Train Acc: 0.6674
Average Train Accuracy: 0.8450
 Site-Clipart                       | Val  Loss: 0.1987 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2621 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0681 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0559 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1507 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1789 | Val  Acc: 0.9492
 Site-Sketch                        | Val  Loss: 0.2393 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2585 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.9388 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8856 | Val  Acc: 0.7238
 Site-Infograph                     | Val  Loss: 1.1349 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.1670 | Val  Acc: 0.6127
Average Valid Accuracy: 0.8590
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.9302
 Best site-Real                      | Epoch:20 | Val Acc: 0.9905
 Best site-Real                      | Epoch:20 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:20 | Val Acc: 0.9492
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:20 | Val Acc: 0.9270
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.7048
 Best site-QuickDraw                 | Epoch:20 | Val Acc: 0.7238
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:20 | Val Acc: 0.6127
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 21 ============
 Site-Clipart                       | Train Loss: 0.3083 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2041 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1411 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0496 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2452 | Train Acc: 0.9108
 Site-Painting                      | Train Loss: 0.1880 | Train Acc: 0.9555
 Site-Sketch                        | Train Loss: 0.3974 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2578 | Train Acc: 0.9216
 Site-QuickDraw                     | Train Loss: 0.8592 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.8513 | Train Acc: 0.7458
 Site-Infograph                     | Train Loss: 1.3608 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0936 | Train Acc: 0.6568
Average Train Accuracy: 0.8434
 Site-Clipart                       | Val  Loss: 0.2258 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2480 | Val  Acc: 0.9302
 Site-Real                          | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0956 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1595 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2140 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2576 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.9421 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 0.8571 | Val  Acc: 0.7429
 Site-Infograph                     | Val  Loss: 1.2811 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.1211 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8614
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.9302
 Best site-Real                      | Epoch:21 | Val Acc: 1.0000
 Best site-Real                      | Epoch:21 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:21 | Val Acc: 0.9587
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.9333
 Best site-Sketch                    | Epoch:21 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.6571
 Best site-QuickDraw                 | Epoch:21 | Val Acc: 0.7429
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.5905
 Best site-Infograph                 | Epoch:21 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 22 ============
 Site-Clipart                       | Train Loss: 0.2944 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2140 | Train Acc: 0.9386
 Site-Real                          | Train Loss: 0.1331 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0550 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.2409 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.1815 | Train Acc: 0.9619
 Site-Sketch                        | Train Loss: 0.3749 | Train Acc: 0.8662
 Site-Sketch                        | Train Loss: 0.2548 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.8366 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.8362 | Train Acc: 0.7288
 Site-Infograph                     | Train Loss: 1.2886 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 1.0421 | Train Acc: 0.6631
Average Train Accuracy: 0.8499
 Site-Clipart                       | Val  Loss: 0.2198 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.2424 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0490 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1264 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1583 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2673 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2879 | Val  Acc: 0.8984
 Site-QuickDraw                     | Val  Loss: 0.8608 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7899 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.2663 | Val  Acc: 0.5333
 Site-Infograph                     | Val  Loss: 1.1365 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8558
============ Train epoch 23 ============
 Site-Clipart                       | Train Loss: 0.2706 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.2020 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1462 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0440 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1820 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.1454 | Train Acc: 0.9661
 Site-Sketch                        | Train Loss: 0.3276 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2501 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.8724 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.8329 | Train Acc: 0.7585
 Site-Infograph                     | Train Loss: 1.3267 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.0688 | Train Acc: 0.6610
Average Train Accuracy: 0.8520
 Site-Clipart                       | Val  Loss: 0.2059 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2196 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0464 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1162 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1505 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.2304 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2376 | Val  Acc: 0.9206
 Site-QuickDraw                     | Val  Loss: 0.9249 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.8298 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.1855 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.0602 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8685
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.9429
 Best site-Real                      | Epoch:23 | Val Acc: 1.0000
 Best site-Real                      | Epoch:23 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:23 | Val Acc: 0.9746
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:23 | Val Acc: 0.9206
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.6952
 Best site-QuickDraw                 | Epoch:23 | Val Acc: 0.7556
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.5905
 Best site-Infograph                 | Epoch:23 | Val Acc: 0.6603
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 24 ============
 Site-Clipart                       | Train Loss: 0.2519 | Train Acc: 0.9299
 Site-Clipart                       | Train Loss: 0.2273 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1203 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0503 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2546 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1681 | Train Acc: 0.9576
 Site-Sketch                        | Train Loss: 0.2869 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2672 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.9169 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.8556 | Train Acc: 0.7267
 Site-Infograph                     | Train Loss: 1.2417 | Train Acc: 0.5478
 Site-Infograph                     | Train Loss: 1.0418 | Train Acc: 0.6801
Average Train Accuracy: 0.8524
 Site-Clipart                       | Val  Loss: 0.1745 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.2522 | Val  Acc: 0.9333
 Site-Real                          | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0449 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1235 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1466 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2167 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2661 | Val  Acc: 0.9175
 Site-QuickDraw                     | Val  Loss: 0.8361 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.8372 | Val  Acc: 0.7587
 Site-Infograph                     | Val  Loss: 1.2186 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0733 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8709
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:24 | Val Acc: 0.9333
 Best site-Real                      | Epoch:24 | Val Acc: 1.0000
 Best site-Real                      | Epoch:24 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9714
 Best site-Painting                  | Epoch:24 | Val Acc: 0.9683
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9143
 Best site-Sketch                    | Epoch:24 | Val Acc: 0.9175
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7714
 Best site-QuickDraw                 | Epoch:24 | Val Acc: 0.7587
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6190
 Best site-Infograph                 | Epoch:24 | Val Acc: 0.6476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 25 ============
 Site-Clipart                       | Train Loss: 0.2959 | Train Acc: 0.8917
 Site-Clipart                       | Train Loss: 0.2162 | Train Acc: 0.9407
 Site-Real                          | Train Loss: 0.1268 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0424 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1773 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.1246 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3468 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2500 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.8362 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.8423 | Train Acc: 0.7415
 Site-Infograph                     | Train Loss: 1.2936 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.0161 | Train Acc: 0.6843
Average Train Accuracy: 0.8552
 Site-Clipart                       | Val  Loss: 0.1885 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2216 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0507 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0907 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1440 | Val  Acc: 0.9492
 Site-Sketch                        | Val  Loss: 0.1853 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2387 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8725 | Val  Acc: 0.7333
 Site-QuickDraw                     | Val  Loss: 0.8360 | Val  Acc: 0.7397
 Site-Infograph                     | Val  Loss: 1.2666 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 1.0949 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8722
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:25 | Val Acc: 0.9397
 Best site-Real                      | Epoch:25 | Val Acc: 1.0000
 Best site-Real                      | Epoch:25 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:25 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:25 | Val Acc: 0.9492
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.9714
 Best site-Sketch                    | Epoch:25 | Val Acc: 0.9238
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.7333
 Best site-QuickDraw                 | Epoch:25 | Val Acc: 0.7397
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.5905
 Best site-Infograph                 | Epoch:25 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 26 ============
 Site-Clipart                       | Train Loss: 0.2424 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.2098 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1557 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0435 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2306 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1295 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.3471 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2349 | Train Acc: 0.9174
 Site-QuickDraw                     | Train Loss: 0.8296 | Train Acc: 0.7006
 Site-QuickDraw                     | Train Loss: 0.8094 | Train Acc: 0.7331
 Site-Infograph                     | Train Loss: 1.3111 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 1.0420 | Train Acc: 0.6589
Average Train Accuracy: 0.8510
 Site-Clipart                       | Val  Loss: 0.1950 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2354 | Val  Acc: 0.9397
 Site-Real                          | Val  Loss: 0.0609 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0408 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1228 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.1288 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.2440 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2528 | Val  Acc: 0.9143
 Site-QuickDraw                     | Val  Loss: 0.7798 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.8366 | Val  Acc: 0.7270
 Site-Infograph                     | Val  Loss: 1.1521 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 1.0620 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8661
============ Train epoch 27 ============
 Site-Clipart                       | Train Loss: 0.2430 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1986 | Train Acc: 0.9449
 Site-Real                          | Train Loss: 0.1217 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0431 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2144 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1130 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.4052 | Train Acc: 0.8599
 Site-Sketch                        | Train Loss: 0.2516 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.8521 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.8137 | Train Acc: 0.7500
 Site-Infograph                     | Train Loss: 1.2664 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 0.9960 | Train Acc: 0.6631
Average Train Accuracy: 0.8494
 Site-Clipart                       | Val  Loss: 0.1497 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2087 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0545 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0447 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.1228 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1332 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1990 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2466 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.8127 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7590 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.0972 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 1.0548 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8802
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:27 | Val Acc: 0.9460
 Best site-Real                      | Epoch:27 | Val Acc: 0.9905
 Best site-Real                      | Epoch:27 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:27 | Val Acc: 0.9683
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:27 | Val Acc: 0.9270
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.7714
 Best site-QuickDraw                 | Epoch:27 | Val Acc: 0.7556
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.6381
 Best site-Infograph                 | Epoch:27 | Val Acc: 0.6762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 28 ============
 Site-Clipart                       | Train Loss: 0.2716 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1751 | Train Acc: 0.9428
 Site-Real                          | Train Loss: 0.1421 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0377 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1983 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.1392 | Train Acc: 0.9725
 Site-Sketch                        | Train Loss: 0.4569 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.2218 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.7594 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7946 | Train Acc: 0.7606
 Site-Infograph                     | Train Loss: 1.2690 | Train Acc: 0.5796
 Site-Infograph                     | Train Loss: 0.9729 | Train Acc: 0.6864
Average Train Accuracy: 0.8536
 Site-Clipart                       | Val  Loss: 0.1692 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2281 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0449 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1056 | Val  Acc: 0.9619
 Site-Painting                      | Val  Loss: 0.1343 | Val  Acc: 0.9651
 Site-Sketch                        | Val  Loss: 0.1940 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2444 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.8597 | Val  Acc: 0.7143
 Site-QuickDraw                     | Val  Loss: 0.8138 | Val  Acc: 0.7397
 Site-Infograph                     | Val  Loss: 1.1356 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0476 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8669
============ Train epoch 29 ============
 Site-Clipart                       | Train Loss: 0.2798 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1757 | Train Acc: 0.9470
 Site-Real                          | Train Loss: 0.1302 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0347 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1851 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1461 | Train Acc: 0.9661
 Site-Sketch                        | Train Loss: 0.3234 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2336 | Train Acc: 0.9195
 Site-QuickDraw                     | Train Loss: 0.7770 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7879 | Train Acc: 0.7458
 Site-Infograph                     | Train Loss: 1.2876 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 1.0089 | Train Acc: 0.6801
Average Train Accuracy: 0.8558
 Site-Clipart                       | Val  Loss: 0.1611 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2060 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0391 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0470 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0966 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.0931 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.2782 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2067 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.8042 | Val  Acc: 0.7238
 Site-QuickDraw                     | Val  Loss: 0.7760 | Val  Acc: 0.7619
 Site-Infograph                     | Val  Loss: 1.1467 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 1.0448 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8786
============ Train epoch 30 ============
 Site-Clipart                       | Train Loss: 0.2077 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1944 | Train Acc: 0.9343
 Site-Real                          | Train Loss: 0.1570 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0412 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2012 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1169 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.4088 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2232 | Train Acc: 0.9280
 Site-QuickDraw                     | Train Loss: 0.7303 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.7719 | Train Acc: 0.7564
 Site-Infograph                     | Train Loss: 1.2159 | Train Acc: 0.5605
 Site-Infograph                     | Train Loss: 0.9765 | Train Acc: 0.6801
Average Train Accuracy: 0.8565
 Site-Clipart                       | Val  Loss: 0.1778 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2135 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0506 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0331 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0931 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1656 | Val  Acc: 0.9587
 Site-Sketch                        | Val  Loss: 0.2033 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2395 | Val  Acc: 0.9270
 Site-QuickDraw                     | Val  Loss: 0.8095 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7916 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.1093 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0260 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8746
============ Train epoch 31 ============
 Site-Clipart                       | Train Loss: 0.2044 | Train Acc: 0.9427
 Site-Clipart                       | Train Loss: 0.1723 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1194 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0383 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.1984 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1092 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3507 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2301 | Train Acc: 0.9407
 Site-QuickDraw                     | Train Loss: 0.7521 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7600 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.3342 | Train Acc: 0.5414
 Site-Infograph                     | Train Loss: 0.9463 | Train Acc: 0.7034
Average Train Accuracy: 0.8635
 Site-Clipart                       | Val  Loss: 0.1804 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1832 | Val  Acc: 0.9587
 Site-Real                          | Val  Loss: 0.0406 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0422 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0701 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1286 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.1886 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2311 | Val  Acc: 0.9238
 Site-QuickDraw                     | Val  Loss: 0.8544 | Val  Acc: 0.6952
 Site-QuickDraw                     | Val  Loss: 0.7359 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.2361 | Val  Acc: 0.5048
 Site-Infograph                     | Val  Loss: 1.0218 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8619
============ Train epoch 32 ============
 Site-Clipart                       | Train Loss: 0.2452 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1875 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1267 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0351 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1961 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.1071 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.2852 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2146 | Train Acc: 0.9322
 Site-QuickDraw                     | Train Loss: 0.7405 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7152 | Train Acc: 0.7712
 Site-Infograph                     | Train Loss: 1.2416 | Train Acc: 0.5669
 Site-Infograph                     | Train Loss: 1.0039 | Train Acc: 0.6801
Average Train Accuracy: 0.8593
 Site-Clipart                       | Val  Loss: 0.2003 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1892 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0386 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.1094 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1422 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2230 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.2360 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.8528 | Val  Acc: 0.7048
 Site-QuickDraw                     | Val  Loss: 0.7115 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.1299 | Val  Acc: 0.5810
 Site-Infograph                     | Val  Loss: 0.9890 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8683
============ Train epoch 33 ============
 Site-Clipart                       | Train Loss: 0.3125 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1980 | Train Acc: 0.9534
 Site-Real                          | Train Loss: 0.1284 | Train Acc: 0.9490
 Site-Real                          | Train Loss: 0.0327 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1946 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.1131 | Train Acc: 0.9682
 Site-Sketch                        | Train Loss: 0.3249 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2243 | Train Acc: 0.9301
 Site-QuickDraw                     | Train Loss: 0.7794 | Train Acc: 0.7070
 Site-QuickDraw                     | Train Loss: 0.7200 | Train Acc: 0.7691
 Site-Infograph                     | Train Loss: 1.2188 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.9999 | Train Acc: 0.6928
Average Train Accuracy: 0.8586
 Site-Clipart                       | Val  Loss: 0.1556 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2113 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0329 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0532 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0776 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.1251 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.1379 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.2074 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.7665 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.7663 | Val  Acc: 0.7619
 Site-Infograph                     | Val  Loss: 1.1627 | Val  Acc: 0.6095
 Site-Infograph                     | Val  Loss: 1.0011 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8823
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:33 | Val Acc: 0.9365
 Best site-Real                      | Epoch:33 | Val Acc: 1.0000
 Best site-Real                      | Epoch:33 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:33 | Val Acc: 0.9683
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.9714
 Best site-Sketch                    | Epoch:33 | Val Acc: 0.9429
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.7524
 Best site-QuickDraw                 | Epoch:33 | Val Acc: 0.7619
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6095
 Best site-Infograph                 | Epoch:33 | Val Acc: 0.6921
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 34 ============
 Site-Clipart                       | Train Loss: 0.2419 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1734 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.0787 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0350 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2238 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.1080 | Train Acc: 0.9746
 Site-Sketch                        | Train Loss: 0.3871 | Train Acc: 0.8790
 Site-Sketch                        | Train Loss: 0.2207 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.8671 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.7262 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.3616 | Train Acc: 0.6051
 Site-Infograph                     | Train Loss: 0.9260 | Train Acc: 0.6886
Average Train Accuracy: 0.8579
 Site-Clipart                       | Val  Loss: 0.1801 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2292 | Val  Acc: 0.9365
 Site-Real                          | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0342 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0926 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1104 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1724 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2025 | Val  Acc: 0.9302
 Site-QuickDraw                     | Val  Loss: 0.8742 | Val  Acc: 0.6571
 Site-QuickDraw                     | Val  Loss: 0.7347 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.1250 | Val  Acc: 0.6190
 Site-Infograph                     | Val  Loss: 1.0300 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8717
============ Train epoch 35 ============
 Site-Clipart                       | Train Loss: 0.2745 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1544 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.0944 | Train Acc: 0.9745
 Site-Real                          | Train Loss: 0.0294 | Train Acc: 0.9915
 Site-Painting                      | Train Loss: 0.1377 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.1025 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.2915 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.2128 | Train Acc: 0.9364
 Site-QuickDraw                     | Train Loss: 0.6936 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.7151 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.2582 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 0.9472 | Train Acc: 0.6928
Average Train Accuracy: 0.8713
 Site-Clipart                       | Val  Loss: 0.1457 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.2048 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0302 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0389 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0943 | Val  Acc: 0.9810
 Site-Painting                      | Val  Loss: 0.1052 | Val  Acc: 0.9905
 Site-Sketch                        | Val  Loss: 0.1904 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2343 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7504 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7268 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1041 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 0.9828 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8873
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.9429
 Best site-Real                      | Epoch:35 | Val Acc: 1.0000
 Best site-Real                      | Epoch:35 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:35 | Val Acc: 0.9810
 Best site-Painting                  | Epoch:35 | Val Acc: 0.9905
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.9524
 Best site-Sketch                    | Epoch:35 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.7619
 Best site-QuickDraw                 | Epoch:35 | Val Acc: 0.7714
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.6571
 Best site-Infograph                 | Epoch:35 | Val Acc: 0.6984
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 36 ============
 Site-Clipart                       | Train Loss: 0.2224 | Train Acc: 0.9363
 Site-Clipart                       | Train Loss: 0.1464 | Train Acc: 0.9661
 Site-Real                          | Train Loss: 0.1095 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0320 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2091 | Train Acc: 0.9554
 Site-Painting                      | Train Loss: 0.0955 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.3038 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2083 | Train Acc: 0.9492
 Site-QuickDraw                     | Train Loss: 0.8539 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.7434 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.2250 | Train Acc: 0.5860
 Site-Infograph                     | Train Loss: 0.9533 | Train Acc: 0.6801
Average Train Accuracy: 0.8662
 Site-Clipart                       | Val  Loss: 0.1934 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.1767 | Val  Acc: 0.9746
 Site-Real                          | Val  Loss: 0.0283 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0398 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0756 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1250 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.2137 | Val  Acc: 0.9333
 Site-Sketch                        | Val  Loss: 0.2424 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.8074 | Val  Acc: 0.7619
 Site-QuickDraw                     | Val  Loss: 0.7272 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 1.1457 | Val  Acc: 0.6000
 Site-Infograph                     | Val  Loss: 1.0105 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8820
============ Train epoch 37 ============
 Site-Clipart                       | Train Loss: 0.2854 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1465 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1012 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0405 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.1735 | Train Acc: 0.9682
 Site-Painting                      | Train Loss: 0.1053 | Train Acc: 0.9767
 Site-Sketch                        | Train Loss: 0.2661 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.1891 | Train Acc: 0.9428
 Site-QuickDraw                     | Train Loss: 0.7938 | Train Acc: 0.7325
 Site-QuickDraw                     | Train Loss: 0.7038 | Train Acc: 0.7797
 Site-Infograph                     | Train Loss: 1.2812 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.9419 | Train Acc: 0.7076
Average Train Accuracy: 0.8717
 Site-Clipart                       | Val  Loss: 0.1824 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1928 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0352 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0554 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0869 | Val  Acc: 0.9968
 Site-Sketch                        | Val  Loss: 0.1722 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2056 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7302 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.7159 | Val  Acc: 0.7841
 Site-Infograph                     | Val  Loss: 1.0870 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9972 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8892
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:37 | Val Acc: 0.9492
 Best site-Real                      | Epoch:37 | Val Acc: 1.0000
 Best site-Real                      | Epoch:37 | Val Acc: 0.9937
 Best site-Painting                  | Epoch:37 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:37 | Val Acc: 0.9968
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.9619
 Best site-Sketch                    | Epoch:37 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:37 | Val Acc: 0.7841
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.6476
 Best site-Infograph                 | Epoch:37 | Val Acc: 0.6794
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 38 ============
 Site-Clipart                       | Train Loss: 0.2251 | Train Acc: 0.9299
 Site-Clipart                       | Train Loss: 0.1817 | Train Acc: 0.9492
 Site-Real                          | Train Loss: 0.1279 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0435 | Train Acc: 0.9894
 Site-Painting                      | Train Loss: 0.1893 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.0894 | Train Acc: 0.9703
 Site-Sketch                        | Train Loss: 0.2738 | Train Acc: 0.8917
 Site-Sketch                        | Train Loss: 0.2056 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.8626 | Train Acc: 0.6879
 Site-QuickDraw                     | Train Loss: 0.7480 | Train Acc: 0.7733
 Site-Infograph                     | Train Loss: 1.1450 | Train Acc: 0.6624
 Site-Infograph                     | Train Loss: 0.9754 | Train Acc: 0.6843
Average Train Accuracy: 0.8621
 Site-Clipart                       | Val  Loss: 0.1380 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1893 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0363 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0347 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0767 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1252 | Val  Acc: 0.9683
 Site-Sketch                        | Val  Loss: 0.2304 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.1977 | Val  Acc: 0.9460
 Site-QuickDraw                     | Val  Loss: 0.6924 | Val  Acc: 0.7714
 Site-QuickDraw                     | Val  Loss: 0.7098 | Val  Acc: 0.7778
 Site-Infograph                     | Val  Loss: 1.1895 | Val  Acc: 0.5905
 Site-Infograph                     | Val  Loss: 0.9692 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8788
============ Train epoch 39 ============
 Site-Clipart                       | Train Loss: 0.3052 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1450 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.0897 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0296 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2138 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0848 | Train Acc: 0.9873
 Site-Sketch                        | Train Loss: 0.2949 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.1951 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.8114 | Train Acc: 0.7452
 Site-QuickDraw                     | Train Loss: 0.7009 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.2882 | Train Acc: 0.5987
 Site-Infograph                     | Train Loss: 0.9437 | Train Acc: 0.6928
Average Train Accuracy: 0.8687
 Site-Clipart                       | Val  Loss: 0.1576 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1989 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0230 | Val  Acc: 0.9905
 Site-Real                          | Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0557 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1140 | Val  Acc: 0.9714
 Site-Sketch                        | Val  Loss: 0.1739 | Val  Acc: 0.9238
 Site-Sketch                        | Val  Loss: 0.2122 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.8402 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.7347 | Val  Acc: 0.7556
 Site-Infograph                     | Val  Loss: 0.9973 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.9629 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8807
============ Train epoch 40 ============
 Site-Clipart                       | Train Loss: 0.3039 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1498 | Train Acc: 0.9576
 Site-Real                          | Train Loss: 0.1007 | Train Acc: 0.9809
 Site-Real                          | Train Loss: 0.0291 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2072 | Train Acc: 0.9299
 Site-Painting                      | Train Loss: 0.1041 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2351 | Train Acc: 0.9172
 Site-Sketch                        | Train Loss: 0.2086 | Train Acc: 0.9407
 Site-QuickDraw                     | Train Loss: 0.7609 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.6774 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.2675 | Train Acc: 0.6115
 Site-Infograph                     | Train Loss: 0.9093 | Train Acc: 0.7055
Average Train Accuracy: 0.8694
 Site-Clipart                       | Val  Loss: 0.1388 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1886 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0513 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0905 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1744 | Val  Acc: 0.9619
 Site-Sketch                        | Val  Loss: 0.2055 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7235 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.7127 | Val  Acc: 0.7683
 Site-Infograph                     | Val  Loss: 1.1505 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 0.9604 | Val  Acc: 0.7111
Average Valid Accuracy: 0.8937
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9714
 Best site-Clipart                   | Epoch:40 | Val Acc: 0.9524
 Best site-Real                      | Epoch:40 | Val Acc: 1.0000
 Best site-Real                      | Epoch:40 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:40 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:40 | Val Acc: 0.9873
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.9619
 Best site-Sketch                    | Epoch:40 | Val Acc: 0.9333
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.7810
 Best site-QuickDraw                 | Epoch:40 | Val Acc: 0.7683
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.6571
 Best site-Infograph                 | Epoch:40 | Val Acc: 0.7111
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 41 ============
 Site-Clipart                       | Train Loss: 0.2900 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1587 | Train Acc: 0.9513
 Site-Real                          | Train Loss: 0.1119 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0333 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2094 | Train Acc: 0.9236
 Site-Painting                      | Train Loss: 0.0820 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.2396 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.2025 | Train Acc: 0.9343
 Site-QuickDraw                     | Train Loss: 0.7793 | Train Acc: 0.7261
 Site-QuickDraw                     | Train Loss: 0.6870 | Train Acc: 0.7839
 Site-Infograph                     | Train Loss: 1.2576 | Train Acc: 0.6178
 Site-Infograph                     | Train Loss: 0.9394 | Train Acc: 0.7034
Average Train Accuracy: 0.8641
 Site-Clipart                       | Val  Loss: 0.1054 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1776 | Val  Acc: 0.9619
 Site-Real                          | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0372 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0445 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0822 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.2191 | Val  Acc: 0.9143
 Site-Sketch                        | Val  Loss: 0.1908 | Val  Acc: 0.9524
 Site-QuickDraw                     | Val  Loss: 0.7428 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.6793 | Val  Acc: 0.7714
 Site-Infograph                     | Val  Loss: 1.1000 | Val  Acc: 0.6571
 Site-Infograph                     | Val  Loss: 0.9381 | Val  Acc: 0.7048
Average Valid Accuracy: 0.8878
============ Train epoch 42 ============
 Site-Clipart                       | Train Loss: 0.2776 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1561 | Train Acc: 0.9640
 Site-Real                          | Train Loss: 0.1489 | Train Acc: 0.9427
 Site-Real                          | Train Loss: 0.0242 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1569 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.0800 | Train Acc: 0.9788
 Site-Sketch                        | Train Loss: 0.2884 | Train Acc: 0.9045
 Site-Sketch                        | Train Loss: 0.1739 | Train Acc: 0.9534
 Site-QuickDraw                     | Train Loss: 0.8510 | Train Acc: 0.6624
 Site-QuickDraw                     | Train Loss: 0.6898 | Train Acc: 0.7754
 Site-Infograph                     | Train Loss: 1.3392 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.8959 | Train Acc: 0.7097
Average Train Accuracy: 0.8632
 Site-Clipart                       | Val  Loss: 0.1209 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.1806 | Val  Acc: 0.9524
 Site-Real                          | Val  Loss: 0.0249 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0283 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0622 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0741 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.1191 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1943 | Val  Acc: 0.9429
 Site-QuickDraw                     | Val  Loss: 0.7271 | Val  Acc: 0.7429
 Site-QuickDraw                     | Val  Loss: 0.6619 | Val  Acc: 0.8000
 Site-Infograph                     | Val  Loss: 1.1353 | Val  Acc: 0.6286
 Site-Infograph                     | Val  Loss: 0.9471 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8910
============ Train epoch 43 ============
 Site-Clipart                       | Train Loss: 0.2740 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1346 | Train Acc: 0.9640
 Site-Real                          | Train Loss: 0.1406 | Train Acc: 0.9363
 Site-Real                          | Train Loss: 0.0212 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1895 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0819 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.2901 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.2092 | Train Acc: 0.9449
 Site-QuickDraw                     | Train Loss: 0.8153 | Train Acc: 0.6815
 Site-QuickDraw                     | Train Loss: 0.6765 | Train Acc: 0.7669
 Site-Infograph                     | Train Loss: 1.2464 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.9066 | Train Acc: 0.7140
Average Train Accuracy: 0.8610
 Site-Clipart                       | Val  Loss: 0.1692 | Val  Acc: 0.9524
 Site-Clipart                       | Val  Loss: 0.1933 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0241 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.1015 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1680 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.1869 | Val  Acc: 0.9683
 Site-QuickDraw                     | Val  Loss: 0.6383 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 0.6571 | Val  Acc: 0.8063
 Site-Infograph                     | Val  Loss: 1.0041 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 0.9271 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8968
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9524
 Best site-Clipart                   | Epoch:43 | Val Acc: 0.9556
 Best site-Real                      | Epoch:43 | Val Acc: 1.0000
 Best site-Real                      | Epoch:43 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:43 | Val Acc: 1.0000
 Best site-Painting                  | Epoch:43 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.9429
 Best site-Sketch                    | Epoch:43 | Val Acc: 0.9683
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.8000
 Best site-QuickDraw                 | Epoch:43 | Val Acc: 0.8063
 Best site-Infograph                 | Epoch:43 | Val Acc: 0.6667
 Best site-Infograph                 | Epoch:43 | Val Acc: 0.6921
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 44 ============
 Site-Clipart                       | Train Loss: 0.2462 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1624 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.0892 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0237 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1759 | Train Acc: 0.9618
 Site-Painting                      | Train Loss: 0.0859 | Train Acc: 0.9894
 Site-Sketch                        | Train Loss: 0.2783 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.1767 | Train Acc: 0.9576
 Site-QuickDraw                     | Train Loss: 0.7500 | Train Acc: 0.7134
 Site-QuickDraw                     | Train Loss: 0.6501 | Train Acc: 0.7945
 Site-Infograph                     | Train Loss: 1.1978 | Train Acc: 0.6242
 Site-Infograph                     | Train Loss: 0.9056 | Train Acc: 0.7076
Average Train Accuracy: 0.8725
 Site-Clipart                       | Val  Loss: 0.1439 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.2070 | Val  Acc: 0.9429
 Site-Real                          | Val  Loss: 0.0160 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0249 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0462 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0696 | Val  Acc: 0.9841
 Site-Sketch                        | Val  Loss: 0.1531 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.1895 | Val  Acc: 0.9333
 Site-QuickDraw                     | Val  Loss: 0.7078 | Val  Acc: 0.7810
 Site-QuickDraw                     | Val  Loss: 0.6565 | Val  Acc: 0.8000
 Site-Infograph                     | Val  Loss: 0.9924 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 0.9067 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8934
============ Train epoch 45 ============
 Site-Clipart                       | Train Loss: 0.2460 | Train Acc: 0.9108
 Site-Clipart                       | Train Loss: 0.1714 | Train Acc: 0.9555
 Site-Real                          | Train Loss: 0.1092 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0316 | Train Acc: 0.9936
 Site-Painting                      | Train Loss: 0.2002 | Train Acc: 0.9490
 Site-Painting                      | Train Loss: 0.0785 | Train Acc: 0.9894
 Site-Sketch                        | Train Loss: 0.3163 | Train Acc: 0.8726
 Site-Sketch                        | Train Loss: 0.1856 | Train Acc: 0.9470
 Site-QuickDraw                     | Train Loss: 0.7046 | Train Acc: 0.7516
 Site-QuickDraw                     | Train Loss: 0.6797 | Train Acc: 0.7860
 Site-Infograph                     | Train Loss: 1.1421 | Train Acc: 0.6178
 Site-Infograph                     | Train Loss: 0.9367 | Train Acc: 0.7055
Average Train Accuracy: 0.8706
 Site-Clipart                       | Val  Loss: 0.1499 | Val  Acc: 0.9619
 Site-Clipart                       | Val  Loss: 0.1619 | Val  Acc: 0.9587
 Site-Real                          | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0229 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0655 | Val  Acc: 0.9905
 Site-Painting                      | Val  Loss: 0.0780 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1416 | Val  Acc: 0.9810
 Site-Sketch                        | Val  Loss: 0.1692 | Val  Acc: 0.9651
 Site-QuickDraw                     | Val  Loss: 0.6620 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6561 | Val  Acc: 0.8159
 Site-Infograph                     | Val  Loss: 0.9000 | Val  Acc: 0.6667
 Site-Infograph                     | Val  Loss: 0.9272 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8976
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9619
 Best site-Clipart                   | Epoch:45 | Val Acc: 0.9587
 Best site-Real                      | Epoch:45 | Val Acc: 1.0000
 Best site-Real                      | Epoch:45 | Val Acc: 0.9968
 Best site-Painting                  | Epoch:45 | Val Acc: 0.9905
 Best site-Painting                  | Epoch:45 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.9810
 Best site-Sketch                    | Epoch:45 | Val Acc: 0.9651
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.7524
 Best site-QuickDraw                 | Epoch:45 | Val Acc: 0.8159
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.6667
 Best site-Infograph                 | Epoch:45 | Val Acc: 0.7016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/fedsam...
============ Train epoch 46 ============
 Site-Clipart                       | Train Loss: 0.3159 | Train Acc: 0.8981
 Site-Clipart                       | Train Loss: 0.1707 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.1050 | Train Acc: 0.9554
 Site-Real                          | Train Loss: 0.0279 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.2068 | Train Acc: 0.9363
 Site-Painting                      | Train Loss: 0.0654 | Train Acc: 0.9894
 Site-Sketch                        | Train Loss: 0.2847 | Train Acc: 0.8981
 Site-Sketch                        | Train Loss: 0.1712 | Train Acc: 0.9534
 Site-QuickDraw                     | Train Loss: 0.7026 | Train Acc: 0.6943
 Site-QuickDraw                     | Train Loss: 0.6373 | Train Acc: 0.8030
 Site-Infograph                     | Train Loss: 1.2433 | Train Acc: 0.6306
 Site-Infograph                     | Train Loss: 0.9327 | Train Acc: 0.7119
Average Train Accuracy: 0.8690
 Site-Clipart                       | Val  Loss: 0.1422 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1963 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0345 | Val  Acc: 0.9873
 Site-Painting                      | Val  Loss: 0.0545 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0773 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1905 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.1805 | Val  Acc: 0.9492
 Site-QuickDraw                     | Val  Loss: 0.7020 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6698 | Val  Acc: 0.7905
 Site-Infograph                     | Val  Loss: 1.0329 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9549 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8907
============ Train epoch 47 ============
 Site-Clipart                       | Train Loss: 0.2677 | Train Acc: 0.9045
 Site-Clipart                       | Train Loss: 0.1500 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.0960 | Train Acc: 0.9682
 Site-Real                          | Train Loss: 0.0243 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1913 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0657 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.2748 | Train Acc: 0.9108
 Site-Sketch                        | Train Loss: 0.1784 | Train Acc: 0.9407
 Site-QuickDraw                     | Train Loss: 0.7999 | Train Acc: 0.7197
 Site-QuickDraw                     | Train Loss: 0.6483 | Train Acc: 0.7966
 Site-Infograph                     | Train Loss: 1.2178 | Train Acc: 0.6369
 Site-Infograph                     | Train Loss: 0.8605 | Train Acc: 0.7119
Average Train Accuracy: 0.8727
 Site-Clipart                       | Val  Loss: 0.1994 | Val  Acc: 0.9429
 Site-Clipart                       | Val  Loss: 0.1839 | Val  Acc: 0.9460
 Site-Real                          | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0227 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0704 | Val  Acc: 0.9714
 Site-Painting                      | Val  Loss: 0.1046 | Val  Acc: 0.9746
 Site-Sketch                        | Val  Loss: 0.1910 | Val  Acc: 0.9524
 Site-Sketch                        | Val  Loss: 0.2006 | Val  Acc: 0.9365
 Site-QuickDraw                     | Val  Loss: 0.7082 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6403 | Val  Acc: 0.8159
 Site-Infograph                     | Val  Loss: 1.0615 | Val  Acc: 0.6381
 Site-Infograph                     | Val  Loss: 0.9254 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8868
============ Train epoch 48 ============
 Site-Clipart                       | Train Loss: 0.2110 | Train Acc: 0.9236
 Site-Clipart                       | Train Loss: 0.1553 | Train Acc: 0.9619
 Site-Real                          | Train Loss: 0.0885 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0265 | Train Acc: 0.9958
 Site-Painting                      | Train Loss: 0.1579 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0857 | Train Acc: 0.9831
 Site-Sketch                        | Train Loss: 0.3534 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.1613 | Train Acc: 0.9555
 Site-QuickDraw                     | Train Loss: 0.7662 | Train Acc: 0.7389
 Site-QuickDraw                     | Train Loss: 0.6432 | Train Acc: 0.7860
 Site-Infograph                     | Train Loss: 1.2107 | Train Acc: 0.5732
 Site-Infograph                     | Train Loss: 0.8692 | Train Acc: 0.7076
Average Train Accuracy: 0.8679
 Site-Clipart                       | Val  Loss: 0.1596 | Val  Acc: 0.9810
 Site-Clipart                       | Val  Loss: 0.1645 | Val  Acc: 0.9556
 Site-Real                          | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0285 | Val  Acc: 0.9937
 Site-Painting                      | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0857 | Val  Acc: 0.9873
 Site-Sketch                        | Val  Loss: 0.1646 | Val  Acc: 0.9429
 Site-Sketch                        | Val  Loss: 0.2068 | Val  Acc: 0.9397
 Site-QuickDraw                     | Val  Loss: 0.7098 | Val  Acc: 0.7524
 Site-QuickDraw                     | Val  Loss: 0.6892 | Val  Acc: 0.7746
 Site-Infograph                     | Val  Loss: 1.0707 | Val  Acc: 0.6476
 Site-Infograph                     | Val  Loss: 0.8935 | Val  Acc: 0.7238
Average Valid Accuracy: 0.8915
============ Train epoch 49 ============
 Site-Clipart                       | Train Loss: 0.2245 | Train Acc: 0.9172
 Site-Clipart                       | Train Loss: 0.1553 | Train Acc: 0.9597
 Site-Real                          | Train Loss: 0.1139 | Train Acc: 0.9618
 Site-Real                          | Train Loss: 0.0182 | Train Acc: 0.9979
 Site-Painting                      | Train Loss: 0.1501 | Train Acc: 0.9427
 Site-Painting                      | Train Loss: 0.0828 | Train Acc: 0.9852
 Site-Sketch                        | Train Loss: 0.2969 | Train Acc: 0.8854
 Site-Sketch                        | Train Loss: 0.1590 | Train Acc: 0.9597
 Site-QuickDraw                     | Train Loss: 0.7373 | Train Acc: 0.7516
 Site-QuickDraw                     | Train Loss: 0.6353 | Train Acc: 0.7966
 Site-Infograph                     | Train Loss: 1.2797 | Train Acc: 0.5924
 Site-Infograph                     | Train Loss: 0.8515 | Train Acc: 0.7182
Average Train Accuracy: 0.8724
 Site-Clipart                       | Val  Loss: 0.1459 | Val  Acc: 0.9714
 Site-Clipart                       | Val  Loss: 0.1857 | Val  Acc: 0.9492
 Site-Real                          | Val  Loss: 0.0160 | Val  Acc: 1.0000
 Site-Real                          | Val  Loss: 0.0215 | Val  Acc: 0.9968
 Site-Painting                      | Val  Loss: 0.0430 | Val  Acc: 1.0000
 Site-Painting                      | Val  Loss: 0.0720 | Val  Acc: 0.9937
 Site-Sketch                        | Val  Loss: 0.2107 | Val  Acc: 0.9048
 Site-Sketch                        | Val  Loss: 0.1641 | Val  Acc: 0.9587
 Site-QuickDraw                     | Val  Loss: 0.6540 | Val  Acc: 0.8000
 Site-QuickDraw                     | Val  Loss: 0.6409 | Val  Acc: 0.8063
 Site-Infograph                     | Val  Loss: 0.9829 | Val  Acc: 0.6762
 Site-Infograph                     | Val  Loss: 0.9072 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8963
===2023-07-01 16:10:57===
===2023-07-01 16:11:00===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   | Epoch:45 | Test Acc: 0.9259
 Test site-Real                      | Epoch:45 | Test Acc: 0.9548
 Test site-Painting                  | Epoch:45 | Test Acc: 0.9386
 Test site-Sketch                    | Epoch:45 | Test Acc: 0.9007
 Test site-QuickDraw                 | Epoch:45 | Test Acc: 0.7190
 Test site-Infograph                 | Epoch:45 | Test Acc: 0.5875
Clipart: 0.9259, Real: 0.9548, Painting: 0.9386, Sketch: 0.9007, QuickDraw: 0.7190, Infograph: 0.5875, 
Average Test Accuracy(group): 0.8378, Average Test Accuracy(individual): 0.8378,
domain std=0.1368, cluster std=-1.0000, individual std=0.1368, 
