===2023-03-29 12:05:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.8727 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.8057 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 2.2204 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1863 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7823 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 1.8129 | Train Acc: 0.5568
 Site-SynthDigits| Train Loss: 2.1241 | Train Acc: 0.2614
 Site-SynthDigits| Train Loss: 2.1306 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.2228 | Train Acc: 0.1477
 Site-MNIST-M   | Train Loss: 2.1455 | Train Acc: 0.2273
 Site-MNIST     | Val  Loss: 1.8402 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7915 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.1878 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2204 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.8432 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.7833 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1380 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.1063 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.1469 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1932 | Val  Acc: 0.1695
Average Valid Accuracy: 0.3441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5593
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5596 | Train Acc: 0.5227
 Site-MNIST     | Train Loss: 1.4260 | Train Acc: 0.6818
 Site-SVHN      | Train Loss: 2.1459 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0859 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 1.3745 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.4087 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.8956 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.8878 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 2.0851 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 1.9951 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.4900 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.4278 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.0937 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0969 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.4395 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.3809 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9347 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.8397 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9844 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0479 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4780
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1026 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 0.9857 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 1.9809 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9048 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.9251 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9352 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.6948 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6457 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.9347 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.8389 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0465 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 0.9691 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.9201 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9416 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.9582 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.9217 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.7135 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 1.6676 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8318 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.9167 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5542
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7742 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 0.7078 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.8534 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7691 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.6502 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5912 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4069 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.3427 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.7181 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 1.5572 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.7394 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.6399 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.7863 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8083 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.6475 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5574 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.3990 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.3989 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.4966 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6302 | Val  Acc: 0.4407
Average Valid Accuracy: 0.6119
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6688 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 0.5662 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 1.6738 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.6084 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.4607 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.4771 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.2462 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.1198 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.7221 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.4954 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.6534 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.5553 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.5933 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.7194 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.4930 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4010 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1692 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 1.2617 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.4447 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5602 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6288
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4141 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4048 | Train Acc: 0.9091
 Site-SVHN      | Train Loss: 1.5014 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4912 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.3527 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3447 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9138 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.7947 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.5132 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.1987 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.4400 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3592 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5439 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5077 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.3722 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.2931 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8523 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 0.9218 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.1900 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2869 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7271
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4576
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2859 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2884 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.3276 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2893 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.2785 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.2461 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.8024 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.7306 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.2511 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.0497 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.3103 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2710 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.3230 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3168 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.2615 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2240 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.7254 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.8353 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.0351 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.1399 | Val  Acc: 0.6102
Average Valid Accuracy: 0.7576
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2226 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2260 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.9875 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 0.9931 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.2816 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.1836 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6184 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.5749 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9976 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 0.6981 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.2458 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1947 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.0645 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.0445 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.2028 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.1816 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5366 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6639 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.7428 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.8064 | Val  Acc: 0.7627
Average Valid Accuracy: 0.8322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6102
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1916 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1801 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 0.8891 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.9312 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.2040 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.1374 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.4040 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.3473 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.6971 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.5004 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2056 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1674 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 0.8894 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.8971 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 0.1430 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1537 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.3457 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4588 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4861 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5599 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6949
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1397 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1237 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.6808 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.7065 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.1516 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0927 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.3578 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.2919 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.5671 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4290 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.1321 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1323 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 0.6702 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.6658 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.0989 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1167 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.3001 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.3932 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.4610 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.4501 | Val  Acc: 0.9153
Average Valid Accuracy: 0.9169
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7119
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9153
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-align/FedPrompt...
===2023-03-29 12:39:39===
===2023-03-29 12:39:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8243
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3562
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6390
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3529
Average Test Accuracy: 0.6044
