===2023-05-11 23:35:01===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.6554 | Train Acc: 0.6089
 Site-MNIST     | Train Loss: 1.6225 | Train Acc: 0.6391
 Site-MNIST     | Train Loss: 1.6790 | Train Acc: 0.5621
 Site-MNIST     | Train Loss: 1.6504 | Train Acc: 0.5808
 Site-MNIST     | Train Loss: 1.6490 | Train Acc: 0.5963
 Site-USPS      | Train Loss: 1.6041 | Train Acc: 0.6403
 Site-USPS      | Train Loss: 1.6093 | Train Acc: 0.6613
 Site-USPS      | Train Loss: 1.6061 | Train Acc: 0.6262
 Site-SynthDigits| Train Loss: 2.0926 | Train Acc: 0.2462
 Site-SynthDigits| Train Loss: 2.0550 | Train Acc: 0.2967
 Site-MNIST-M   | Train Loss: 2.1970 | Train Acc: 0.2244
 Site-MNIST-M   | Train Loss: 2.1940 | Train Acc: 0.2330
 Site-SVHN      | Train Loss: 2.2029 | Train Acc: 0.2147
 Site-MNIST     | Val  Loss: 1.7488 | Val  Acc: 0.5357
 Site-MNIST     | Val  Loss: 1.7562 | Val  Acc: 0.5476
 Site-MNIST     | Val  Loss: 1.6025 | Val  Acc: 0.6270
 Site-MNIST     | Val  Loss: 1.6493 | Val  Acc: 0.5947
 Site-MNIST     | Val  Loss: 1.6424 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.6431 | Val  Acc: 0.5962
 Site-USPS      | Val  Loss: 1.6547 | Val  Acc: 0.5962
 Site-USPS      | Val  Loss: 1.5757 | Val  Acc: 0.6538
 Site-SynthDigits| Val  Loss: 2.2347 | Val  Acc: 0.2273
 Site-SynthDigits| Val  Loss: 2.0681 | Val  Acc: 0.2172
 Site-MNIST-M   | Val  Loss: 2.1229 | Val  Acc: 0.2614
 Site-MNIST-M   | Val  Loss: 2.1725 | Val  Acc: 0.2424
 Site-SVHN      | Val  Loss: 2.2141 | Val  Acc: 0.2192
Average Valid Accuracy: 0.4580
Aggregated Acc | Val Acc: 0.3793
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5357
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5476
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5947
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-USPS       | Epoch:0 | Val Acc: 0.5962
 Best site-USPS       | Epoch:0 | Val Acc: 0.5962
 Best site-USPS       | Epoch:0 | Val Acc: 0.6538
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2273
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2172
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2614
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2424
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2192
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
client-11 is in G-4
client-12 is in G-0
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.1622 | Train Acc: 0.8000
 Site-MNIST     | Train Loss: 1.1145 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 1.2106 | Train Acc: 0.7574
 Site-MNIST     | Train Loss: 1.1709 | Train Acc: 0.7582
 Site-MNIST     | Train Loss: 1.1635 | Train Acc: 0.7697
 Site-USPS      | Train Loss: 1.1209 | Train Acc: 0.7890
 Site-USPS      | Train Loss: 1.1236 | Train Acc: 0.7827
 Site-USPS      | Train Loss: 1.1184 | Train Acc: 0.7891
 Site-SynthDigits| Train Loss: 1.8481 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 1.7981 | Train Acc: 0.3535
 Site-MNIST-M   | Train Loss: 2.0537 | Train Acc: 0.2869
 Site-MNIST-M   | Train Loss: 2.0113 | Train Acc: 0.3011
 Site-SVHN      | Train Loss: 2.0834 | Train Acc: 0.2538
 Site-MNIST     | Val  Loss: 1.2442 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.2421 | Val  Acc: 0.8214
 Site-MNIST     | Val  Loss: 1.1263 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 1.1834 | Val  Acc: 0.7789
 Site-MNIST     | Val  Loss: 1.1656 | Val  Acc: 0.8000
 Site-USPS      | Val  Loss: 1.1267 | Val  Acc: 0.7981
 Site-USPS      | Val  Loss: 1.1724 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.1083 | Val  Acc: 0.7821
 Site-SynthDigits| Val  Loss: 2.0414 | Val  Acc: 0.3333
 Site-SynthDigits| Val  Loss: 1.7841 | Val  Acc: 0.3586
 Site-MNIST-M   | Val  Loss: 1.9111 | Val  Acc: 0.3750
 Site-MNIST-M   | Val  Loss: 2.0237 | Val  Acc: 0.2652
 Site-SVHN      | Val  Loss: 2.0800 | Val  Acc: 0.2603
Average Valid Accuracy: 0.6115
Aggregated Acc | Val Acc: 0.5017
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8214
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7789
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8000
 Best site-USPS       | Epoch:1 | Val Acc: 0.7981
 Best site-USPS       | Epoch:1 | Val Acc: 0.7500
 Best site-USPS       | Epoch:1 | Val Acc: 0.7821
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3333
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3586
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3750
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2652
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2603
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
client-11 is in G-4
client-12 is in G-0
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9274 | Train Acc: 0.8044
 Site-MNIST     | Train Loss: 0.9328 | Train Acc: 0.8284
 Site-MNIST     | Train Loss: 0.9957 | Train Acc: 0.7850
 Site-MNIST     | Train Loss: 0.9543 | Train Acc: 0.8016
 Site-MNIST     | Train Loss: 0.9428 | Train Acc: 0.8030
 Site-USPS      | Train Loss: 0.9089 | Train Acc: 0.8034
 Site-USPS      | Train Loss: 0.9161 | Train Acc: 0.8019
 Site-USPS      | Train Loss: 0.9085 | Train Acc: 0.8211
 Site-SynthDigits| Train Loss: 1.6951 | Train Acc: 0.4413
 Site-SynthDigits| Train Loss: 1.6137 | Train Acc: 0.4508
 Site-MNIST-M   | Train Loss: 1.9100 | Train Acc: 0.3352
 Site-MNIST-M   | Train Loss: 1.8794 | Train Acc: 0.3693
 Site-SVHN      | Train Loss: 1.9805 | Train Acc: 0.2930
 Site-MNIST     | Val  Loss: 1.0156 | Val  Acc: 0.8214
 Site-MNIST     | Val  Loss: 1.0103 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.9102 | Val  Acc: 0.8492
 Site-MNIST     | Val  Loss: 0.9775 | Val  Acc: 0.8053
 Site-MNIST     | Val  Loss: 0.9487 | Val  Acc: 0.8175
 Site-USPS      | Val  Loss: 0.9153 | Val  Acc: 0.8269
 Site-USPS      | Val  Loss: 0.9716 | Val  Acc: 0.7628
 Site-USPS      | Val  Loss: 0.9127 | Val  Acc: 0.7863
 Site-SynthDigits| Val  Loss: 1.9465 | Val  Acc: 0.4394
 Site-SynthDigits| Val  Loss: 1.5883 | Val  Acc: 0.4293
 Site-MNIST-M   | Val  Loss: 1.7808 | Val  Acc: 0.4205
 Site-MNIST-M   | Val  Loss: 1.8962 | Val  Acc: 0.3106
 Site-SVHN      | Val  Loss: 2.0046 | Val  Acc: 0.3014
Average Valid Accuracy: 0.6465
Aggregated Acc | Val Acc: 0.5437
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8214
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8492
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8053
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8175
 Best site-USPS       | Epoch:2 | Val Acc: 0.8269
 Best site-USPS       | Epoch:2 | Val Acc: 0.7628
 Best site-USPS       | Epoch:2 | Val Acc: 0.7863
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4394
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4293
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4205
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3106
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3014
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7936 | Train Acc: 0.8311
 Site-MNIST     | Train Loss: 0.8180 | Train Acc: 0.8373
 Site-MNIST     | Train Loss: 0.8748 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8334 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.8202 | Train Acc: 0.8266
 Site-USPS      | Train Loss: 0.7763 | Train Acc: 0.8393
 Site-USPS      | Train Loss: 0.7858 | Train Acc: 0.8147
 Site-USPS      | Train Loss: 0.7799 | Train Acc: 0.8339
 Site-SynthDigits| Train Loss: 1.5064 | Train Acc: 0.4716
 Site-SynthDigits| Train Loss: 1.4272 | Train Acc: 0.5152
 Site-MNIST-M   | Train Loss: 1.7689 | Train Acc: 0.4062
 Site-MNIST-M   | Train Loss: 1.7403 | Train Acc: 0.3996
 Site-SVHN      | Train Loss: 1.9116 | Train Acc: 0.3543
 Site-MNIST     | Val  Loss: 0.8950 | Val  Acc: 0.8036
 Site-MNIST     | Val  Loss: 0.8746 | Val  Acc: 0.8452
 Site-MNIST     | Val  Loss: 0.7879 | Val  Acc: 0.8492
 Site-MNIST     | Val  Loss: 0.8567 | Val  Acc: 0.8263
 Site-MNIST     | Val  Loss: 0.8308 | Val  Acc: 0.8281
 Site-USPS      | Val  Loss: 0.7838 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.8430 | Val  Acc: 0.8077
 Site-USPS      | Val  Loss: 0.7898 | Val  Acc: 0.8376
 Site-SynthDigits| Val  Loss: 1.7543 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.4148 | Val  Acc: 0.4798
 Site-MNIST-M   | Val  Loss: 1.6270 | Val  Acc: 0.4659
 Site-MNIST-M   | Val  Loss: 1.7584 | Val  Acc: 0.4091
 Site-SVHN      | Val  Loss: 1.8945 | Val  Acc: 0.3493
Average Valid Accuracy: 0.6814
Aggregated Acc | Val Acc: 0.5882
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8036
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8452
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8263
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8281
 Best site-USPS       | Epoch:3 | Val Acc: 0.8558
 Best site-USPS       | Epoch:3 | Val Acc: 0.8077
 Best site-USPS       | Epoch:3 | Val Acc: 0.8376
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4798
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4659
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4091
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3493
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7272 | Train Acc: 0.8400
 Site-MNIST     | Train Loss: 0.7485 | Train Acc: 0.8314
 Site-MNIST     | Train Loss: 0.8038 | Train Acc: 0.8047
 Site-MNIST     | Train Loss: 0.7604 | Train Acc: 0.8213
 Site-MNIST     | Train Loss: 0.7437 | Train Acc: 0.8257
 Site-USPS      | Train Loss: 0.7078 | Train Acc: 0.8393
 Site-USPS      | Train Loss: 0.7216 | Train Acc: 0.8211
 Site-USPS      | Train Loss: 0.7106 | Train Acc: 0.8317
 Site-SynthDigits| Train Loss: 1.3845 | Train Acc: 0.5492
 Site-SynthDigits| Train Loss: 1.2914 | Train Acc: 0.5960
 Site-MNIST-M   | Train Loss: 1.6352 | Train Acc: 0.4744
 Site-MNIST-M   | Train Loss: 1.6213 | Train Acc: 0.4697
 Site-SVHN      | Train Loss: 1.8136 | Train Acc: 0.3935
 Site-MNIST     | Val  Loss: 0.8074 | Val  Acc: 0.8036
 Site-MNIST     | Val  Loss: 0.7963 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.7169 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7889 | Val  Acc: 0.8211
 Site-MNIST     | Val  Loss: 0.7601 | Val  Acc: 0.8246
 Site-USPS      | Val  Loss: 0.7143 | Val  Acc: 0.8462
 Site-USPS      | Val  Loss: 0.7680 | Val  Acc: 0.8141
 Site-USPS      | Val  Loss: 0.7267 | Val  Acc: 0.8205
 Site-SynthDigits| Val  Loss: 1.6408 | Val  Acc: 0.5455
 Site-SynthDigits| Val  Loss: 1.2805 | Val  Acc: 0.5404
 Site-MNIST-M   | Val  Loss: 1.4760 | Val  Acc: 0.5341
 Site-MNIST-M   | Val  Loss: 1.6436 | Val  Acc: 0.4848
 Site-SVHN      | Val  Loss: 1.8056 | Val  Acc: 0.3767
Average Valid Accuracy: 0.6989
Aggregated Acc | Val Acc: 0.6162
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8036
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8211
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8246
 Best site-USPS       | Epoch:4 | Val Acc: 0.8462
 Best site-USPS       | Epoch:4 | Val Acc: 0.8141
 Best site-USPS       | Epoch:4 | Val Acc: 0.8205
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5455
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5404
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5341
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4848
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3767
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6592 | Train Acc: 0.8400
 Site-MNIST     | Train Loss: 0.6335 | Train Acc: 0.8314
 Site-MNIST     | Train Loss: 0.7156 | Train Acc: 0.8284
 Site-MNIST     | Train Loss: 0.6801 | Train Acc: 0.8449
 Site-MNIST     | Train Loss: 0.6656 | Train Acc: 0.8398
 Site-USPS      | Train Loss: 0.6461 | Train Acc: 0.8489
 Site-USPS      | Train Loss: 0.6539 | Train Acc: 0.8355
 Site-USPS      | Train Loss: 0.6415 | Train Acc: 0.8541
 Site-SynthDigits| Train Loss: 1.2649 | Train Acc: 0.6061
 Site-SynthDigits| Train Loss: 1.1496 | Train Acc: 0.6465
 Site-MNIST-M   | Train Loss: 1.5249 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.5222 | Train Acc: 0.5133
 Site-SVHN      | Train Loss: 1.6333 | Train Acc: 0.4497
 Site-MNIST     | Val  Loss: 0.7196 | Val  Acc: 0.8036
 Site-MNIST     | Val  Loss: 0.6988 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.6449 | Val  Acc: 0.8651
 Site-MNIST     | Val  Loss: 0.7104 | Val  Acc: 0.8368
 Site-MNIST     | Val  Loss: 0.6806 | Val  Acc: 0.8175
 Site-USPS      | Val  Loss: 0.6350 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.6972 | Val  Acc: 0.8205
 Site-USPS      | Val  Loss: 0.6665 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.4871 | Val  Acc: 0.5985
 Site-SynthDigits| Val  Loss: 1.1361 | Val  Acc: 0.6061
 Site-MNIST-M   | Val  Loss: 1.3894 | Val  Acc: 0.5682
 Site-MNIST-M   | Val  Loss: 1.5434 | Val  Acc: 0.4924
 Site-SVHN      | Val  Loss: 1.6658 | Val  Acc: 0.4658
Average Valid Accuracy: 0.7228
Aggregated Acc | Val Acc: 0.6532
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8036
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8651
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8368
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8175
 Best site-USPS       | Epoch:5 | Val Acc: 0.8558
 Best site-USPS       | Epoch:5 | Val Acc: 0.8205
 Best site-USPS       | Epoch:5 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5985
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6061
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5682
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4924
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4658
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5965 | Train Acc: 0.8667
 Site-MNIST     | Train Loss: 0.5782 | Train Acc: 0.8402
 Site-MNIST     | Train Loss: 0.6453 | Train Acc: 0.8462
 Site-MNIST     | Train Loss: 0.6152 | Train Acc: 0.8594
 Site-MNIST     | Train Loss: 0.5960 | Train Acc: 0.8625
 Site-USPS      | Train Loss: 0.5986 | Train Acc: 0.8513
 Site-USPS      | Train Loss: 0.6103 | Train Acc: 0.8403
 Site-USPS      | Train Loss: 0.5988 | Train Acc: 0.8647
 Site-SynthDigits| Train Loss: 1.1042 | Train Acc: 0.6629
 Site-SynthDigits| Train Loss: 1.0318 | Train Acc: 0.6995
 Site-MNIST-M   | Train Loss: 1.4263 | Train Acc: 0.5597
 Site-MNIST-M   | Train Loss: 1.3948 | Train Acc: 0.5720
 Site-SVHN      | Train Loss: 1.5744 | Train Acc: 0.4838
 Site-MNIST     | Val  Loss: 0.6361 | Val  Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.6216 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.5773 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6447 | Val  Acc: 0.8421
 Site-MNIST     | Val  Loss: 0.6168 | Val  Acc: 0.8281
 Site-USPS      | Val  Loss: 0.5868 | Val  Acc: 0.8462
 Site-USPS      | Val  Loss: 0.6424 | Val  Acc: 0.8205
 Site-USPS      | Val  Loss: 0.6289 | Val  Acc: 0.8162
 Site-SynthDigits| Val  Loss: 1.3508 | Val  Acc: 0.6364
 Site-SynthDigits| Val  Loss: 1.0162 | Val  Acc: 0.6869
 Site-MNIST-M   | Val  Loss: 1.2912 | Val  Acc: 0.5909
 Site-MNIST-M   | Val  Loss: 1.4356 | Val  Acc: 0.5379
 Site-SVHN      | Val  Loss: 1.5399 | Val  Acc: 0.4932
Average Valid Accuracy: 0.7464
Aggregated Acc | Val Acc: 0.6804
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8750
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8421
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8281
 Best site-USPS       | Epoch:6 | Val Acc: 0.8462
 Best site-USPS       | Epoch:6 | Val Acc: 0.8205
 Best site-USPS       | Epoch:6 | Val Acc: 0.8162
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6364
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6869
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5909
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5379
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5326 | Train Acc: 0.8800
 Site-MNIST     | Train Loss: 0.5245 | Train Acc: 0.8698
 Site-MNIST     | Train Loss: 0.5743 | Train Acc: 0.8757
 Site-MNIST     | Train Loss: 0.5555 | Train Acc: 0.8725
 Site-MNIST     | Train Loss: 0.5276 | Train Acc: 0.8835
 Site-USPS      | Train Loss: 0.5788 | Train Acc: 0.8561
 Site-USPS      | Train Loss: 0.5728 | Train Acc: 0.8594
 Site-USPS      | Train Loss: 0.5584 | Train Acc: 0.8754
 Site-SynthDigits| Train Loss: 1.0266 | Train Acc: 0.6970
 Site-SynthDigits| Train Loss: 0.9432 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.3288 | Train Acc: 0.6051
 Site-MNIST-M   | Train Loss: 1.3277 | Train Acc: 0.6042
 Site-SVHN      | Train Loss: 1.4526 | Train Acc: 0.4974
 Site-MNIST     | Val  Loss: 0.5441 | Val  Acc: 0.9107
 Site-MNIST     | Val  Loss: 0.5389 | Val  Acc: 0.8690
 Site-MNIST     | Val  Loss: 0.5158 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5769 | Val  Acc: 0.8579
 Site-MNIST     | Val  Loss: 0.5498 | Val  Acc: 0.8632
 Site-USPS      | Val  Loss: 0.5452 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.6022 | Val  Acc: 0.8205
 Site-USPS      | Val  Loss: 0.6009 | Val  Acc: 0.8291
 Site-SynthDigits| Val  Loss: 1.2407 | Val  Acc: 0.6667
 Site-SynthDigits| Val  Loss: 0.9321 | Val  Acc: 0.6970
 Site-MNIST-M   | Val  Loss: 1.2030 | Val  Acc: 0.6023
 Site-MNIST-M   | Val  Loss: 1.3514 | Val  Acc: 0.5530
 Site-SVHN      | Val  Loss: 1.4619 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7636
Aggregated Acc | Val Acc: 0.6983
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9107
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8690
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8579
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8632
 Best site-USPS       | Epoch:7 | Val Acc: 0.8558
 Best site-USPS       | Epoch:7 | Val Acc: 0.8205
 Best site-USPS       | Epoch:7 | Val Acc: 0.8291
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6667
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6970
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6023
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5530
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4761 | Train Acc: 0.8800
 Site-MNIST     | Train Loss: 0.4917 | Train Acc: 0.8817
 Site-MNIST     | Train Loss: 0.5315 | Train Acc: 0.8757
 Site-MNIST     | Train Loss: 0.5147 | Train Acc: 0.8699
 Site-MNIST     | Train Loss: 0.4885 | Train Acc: 0.8949
 Site-USPS      | Train Loss: 0.5426 | Train Acc: 0.8705
 Site-USPS      | Train Loss: 0.5376 | Train Acc: 0.8594
 Site-USPS      | Train Loss: 0.5247 | Train Acc: 0.8775
 Site-SynthDigits| Train Loss: 0.9311 | Train Acc: 0.7405
 Site-SynthDigits| Train Loss: 0.8653 | Train Acc: 0.7487
 Site-MNIST-M   | Train Loss: 1.2655 | Train Acc: 0.6307
 Site-MNIST-M   | Train Loss: 1.2508 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 1.3525 | Train Acc: 0.5468
 Site-MNIST     | Val  Loss: 0.4930 | Val  Acc: 0.9107
 Site-MNIST     | Val  Loss: 0.4944 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.4773 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.5370 | Val  Acc: 0.8684
 Site-MNIST     | Val  Loss: 0.5095 | Val  Acc: 0.8807
 Site-USPS      | Val  Loss: 0.5037 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.5578 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5675 | Val  Acc: 0.8419
 Site-SynthDigits| Val  Loss: 1.1578 | Val  Acc: 0.7045
 Site-SynthDigits| Val  Loss: 0.8387 | Val  Acc: 0.7424
 Site-MNIST-M   | Val  Loss: 1.1496 | Val  Acc: 0.6250
 Site-MNIST-M   | Val  Loss: 1.2795 | Val  Acc: 0.5909
 Site-SVHN      | Val  Loss: 1.3759 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7814
Aggregated Acc | Val Acc: 0.7191
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9107
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8684
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8807
 Best site-USPS       | Epoch:8 | Val Acc: 0.8558
 Best site-USPS       | Epoch:8 | Val Acc: 0.8333
 Best site-USPS       | Epoch:8 | Val Acc: 0.8419
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7045
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7424
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6250
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5909
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5342
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
client-12 is in G-1
cnt=[2, 4, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4270 | Train Acc: 0.8844
 Site-MNIST     | Train Loss: 0.4300 | Train Acc: 0.8994
 Site-MNIST     | Train Loss: 0.4742 | Train Acc: 0.8856
 Site-MNIST     | Train Loss: 0.4612 | Train Acc: 0.8870
 Site-MNIST     | Train Loss: 0.4323 | Train Acc: 0.9081
 Site-USPS      | Train Loss: 0.4982 | Train Acc: 0.8801
 Site-USPS      | Train Loss: 0.4863 | Train Acc: 0.8706
 Site-USPS      | Train Loss: 0.4772 | Train Acc: 0.8807
 Site-SynthDigits| Train Loss: 0.8954 | Train Acc: 0.7292
 Site-SynthDigits| Train Loss: 0.8379 | Train Acc: 0.7551
 Site-MNIST-M   | Train Loss: 1.1827 | Train Acc: 0.6534
 Site-MNIST-M   | Train Loss: 1.1819 | Train Acc: 0.6534
 Site-SVHN      | Train Loss: 1.3313 | Train Acc: 0.5315
 Site-MNIST     | Val  Loss: 0.4229 | Val  Acc: 0.9107
 Site-MNIST     | Val  Loss: 0.4299 | Val  Acc: 0.8929
 Site-MNIST     | Val  Loss: 0.4233 | Val  Acc: 0.9127
 Site-MNIST     | Val  Loss: 0.4869 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.4543 | Val  Acc: 0.8982
 Site-USPS      | Val  Loss: 0.4661 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.5086 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5209 | Val  Acc: 0.8419
 Site-SynthDigits| Val  Loss: 1.1096 | Val  Acc: 0.7045
 Site-SynthDigits| Val  Loss: 0.8030 | Val  Acc: 0.7525
 Site-MNIST-M   | Val  Loss: 1.0800 | Val  Acc: 0.6818
 Site-MNIST-M   | Val  Loss: 1.2084 | Val  Acc: 0.6364
 Site-SVHN      | Val  Loss: 1.3859 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7961
Aggregated Acc | Val Acc: 0.7918
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9107
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9127
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8947
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8982
 Best site-USPS       | Epoch:9 | Val Acc: 0.8558
 Best site-USPS       | Epoch:9 | Val Acc: 0.8333
 Best site-USPS       | Epoch:9 | Val Acc: 0.8419
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7045
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7525
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6818
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6364
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5342
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8933
 Test site-USPS      | Epoch:9 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.7311
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.6083
 Test site-SVHN      | Epoch:9 | Test Acc: 0.5048
Average Test Accuracy: 0.7260
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4064 | Train Acc: 0.8933
 Site-MNIST     | Train Loss: 0.4253 | Train Acc: 0.9024
 Site-MNIST     | Train Loss: 0.4410 | Train Acc: 0.8895
 Site-MNIST     | Train Loss: 0.4331 | Train Acc: 0.8975
 Site-MNIST     | Train Loss: 0.3998 | Train Acc: 0.9168
 Site-USPS      | Train Loss: 0.4885 | Train Acc: 0.8705
 Site-USPS      | Train Loss: 0.4810 | Train Acc: 0.8626
 Site-USPS      | Train Loss: 0.4672 | Train Acc: 0.8743
 Site-SynthDigits| Train Loss: 0.8483 | Train Acc: 0.7557
 Site-SynthDigits| Train Loss: 0.7767 | Train Acc: 0.7765
 Site-MNIST-M   | Train Loss: 1.1315 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.1242 | Train Acc: 0.6572
 Site-SVHN      | Train Loss: 1.3239 | Train Acc: 0.5571
 Site-MNIST     | Val  Loss: 0.3860 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3954 | Val  Acc: 0.9167
 Site-MNIST     | Val  Loss: 0.3951 | Val  Acc: 0.9127
 Site-MNIST     | Val  Loss: 0.4569 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.4266 | Val  Acc: 0.9018
 Site-USPS      | Val  Loss: 0.4501 | Val  Acc: 0.8558
 Site-USPS      | Val  Loss: 0.5008 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5162 | Val  Acc: 0.8419
 Site-SynthDigits| Val  Loss: 1.0212 | Val  Acc: 0.7424
 Site-SynthDigits| Val  Loss: 0.7501 | Val  Acc: 0.7727
 Site-MNIST-M   | Val  Loss: 1.0448 | Val  Acc: 0.6818
 Site-MNIST-M   | Val  Loss: 1.1393 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3119 | Val  Acc: 0.5548
Average Valid Accuracy: 0.8080
Aggregated Acc | Val Acc: 0.7482
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9167
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9127
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8947
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9018
 Best site-USPS       | Epoch:10 | Val Acc: 0.8558
 Best site-USPS       | Epoch:10 | Val Acc: 0.8333
 Best site-USPS       | Epoch:10 | Val Acc: 0.8419
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.7424
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.7727
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.6818
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:10 | Val Acc: 0.5548
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3621 | Train Acc: 0.8978
 Site-MNIST     | Train Loss: 0.3741 | Train Acc: 0.9053
 Site-MNIST     | Train Loss: 0.4156 | Train Acc: 0.8955
 Site-MNIST     | Train Loss: 0.4079 | Train Acc: 0.8988
 Site-MNIST     | Train Loss: 0.3743 | Train Acc: 0.9177
 Site-USPS      | Train Loss: 0.4562 | Train Acc: 0.8801
 Site-USPS      | Train Loss: 0.4580 | Train Acc: 0.8706
 Site-USPS      | Train Loss: 0.4494 | Train Acc: 0.8807
 Site-SynthDigits| Train Loss: 0.8089 | Train Acc: 0.7576
 Site-SynthDigits| Train Loss: 0.7240 | Train Acc: 0.7891
 Site-MNIST-M   | Train Loss: 1.0623 | Train Acc: 0.6960
 Site-MNIST-M   | Train Loss: 1.1010 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 1.2393 | Train Acc: 0.5707
 Site-MNIST     | Val  Loss: 0.3594 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3683 | Val  Acc: 0.9167
 Site-MNIST     | Val  Loss: 0.3729 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4353 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.4009 | Val  Acc: 0.8982
 Site-USPS      | Val  Loss: 0.4301 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.4743 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4941 | Val  Acc: 0.8504
 Site-SynthDigits| Val  Loss: 0.9686 | Val  Acc: 0.7500
 Site-SynthDigits| Val  Loss: 0.6881 | Val  Acc: 0.7727
 Site-MNIST-M   | Val  Loss: 1.0151 | Val  Acc: 0.7159
 Site-MNIST-M   | Val  Loss: 1.1048 | Val  Acc: 0.6970
 Site-SVHN      | Val  Loss: 1.2576 | Val  Acc: 0.5548
Average Valid Accuracy: 0.8160
Aggregated Acc | Val Acc: 0.7575
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9167
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8947
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8982
 Best site-USPS       | Epoch:11 | Val Acc: 0.8750
 Best site-USPS       | Epoch:11 | Val Acc: 0.8333
 Best site-USPS       | Epoch:11 | Val Acc: 0.8504
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.7500
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.7727
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.7159
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.6970
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5548
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3484 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.3599 | Train Acc: 0.9172
 Site-MNIST     | Train Loss: 0.3877 | Train Acc: 0.9034
 Site-MNIST     | Train Loss: 0.3856 | Train Acc: 0.9067
 Site-MNIST     | Train Loss: 0.3485 | Train Acc: 0.9291
 Site-USPS      | Train Loss: 0.4431 | Train Acc: 0.8801
 Site-USPS      | Train Loss: 0.4366 | Train Acc: 0.8770
 Site-USPS      | Train Loss: 0.4272 | Train Acc: 0.8882
 Site-SynthDigits| Train Loss: 0.7671 | Train Acc: 0.7708
 Site-SynthDigits| Train Loss: 0.6902 | Train Acc: 0.8131
 Site-MNIST-M   | Train Loss: 1.0586 | Train Acc: 0.7188
 Site-MNIST-M   | Train Loss: 1.0733 | Train Acc: 0.6894
 Site-SVHN      | Train Loss: 1.1753 | Train Acc: 0.5928
 Site-MNIST     | Val  Loss: 0.3199 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3354 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3499 | Val  Acc: 0.9127
 Site-MNIST     | Val  Loss: 0.4136 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.3763 | Val  Acc: 0.9158
 Site-USPS      | Val  Loss: 0.4074 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.4467 | Val  Acc: 0.8397
 Site-USPS      | Val  Loss: 0.4746 | Val  Acc: 0.8547
 Site-SynthDigits| Val  Loss: 0.9385 | Val  Acc: 0.7424
 Site-SynthDigits| Val  Loss: 0.6486 | Val  Acc: 0.7778
 Site-MNIST-M   | Val  Loss: 0.9888 | Val  Acc: 0.7273
 Site-MNIST-M   | Val  Loss: 1.0764 | Val  Acc: 0.7197
 Site-SVHN      | Val  Loss: 1.2002 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8217
Aggregated Acc | Val Acc: 0.7657
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9127
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8947
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9158
 Best site-USPS       | Epoch:12 | Val Acc: 0.8654
 Best site-USPS       | Epoch:12 | Val Acc: 0.8397
 Best site-USPS       | Epoch:12 | Val Acc: 0.8547
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7424
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7273
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7197
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5753
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 13 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3346 | Train Acc: 0.9156
 Site-MNIST     | Train Loss: 0.3490 | Train Acc: 0.9142
 Site-MNIST     | Train Loss: 0.3642 | Train Acc: 0.9073
 Site-MNIST     | Train Loss: 0.3629 | Train Acc: 0.9080
 Site-MNIST     | Train Loss: 0.3261 | Train Acc: 0.9291
 Site-USPS      | Train Loss: 0.4223 | Train Acc: 0.8729
 Site-USPS      | Train Loss: 0.4164 | Train Acc: 0.8770
 Site-USPS      | Train Loss: 0.4091 | Train Acc: 0.8903
 Site-SynthDigits| Train Loss: 0.7349 | Train Acc: 0.7803
 Site-SynthDigits| Train Loss: 0.6536 | Train Acc: 0.8144
 Site-MNIST-M   | Train Loss: 1.0269 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.0457 | Train Acc: 0.6875
 Site-SVHN      | Train Loss: 1.1977 | Train Acc: 0.5877
 Site-MNIST     | Val  Loss: 0.2986 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3139 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3265 | Val  Acc: 0.9127
 Site-MNIST     | Val  Loss: 0.3927 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.3565 | Val  Acc: 0.9123
 Site-USPS      | Val  Loss: 0.3884 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.4251 | Val  Acc: 0.8526
 Site-USPS      | Val  Loss: 0.4571 | Val  Acc: 0.8547
 Site-SynthDigits| Val  Loss: 0.9005 | Val  Acc: 0.7727
 Site-SynthDigits| Val  Loss: 0.6175 | Val  Acc: 0.7980
 Site-MNIST-M   | Val  Loss: 0.9488 | Val  Acc: 0.7045
 Site-MNIST-M   | Val  Loss: 1.0286 | Val  Acc: 0.7197
 Site-SVHN      | Val  Loss: 1.1743 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8267
Aggregated Acc | Val Acc: 0.7716
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9127
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9053
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9123
 Best site-USPS       | Epoch:13 | Val Acc: 0.8750
 Best site-USPS       | Epoch:13 | Val Acc: 0.8526
 Best site-USPS       | Epoch:13 | Val Acc: 0.8547
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7727
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7980
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7045
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7197
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5822
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3078 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.3145 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.3484 | Train Acc: 0.9132
 Site-MNIST     | Train Loss: 0.3494 | Train Acc: 0.9080
 Site-MNIST     | Train Loss: 0.3132 | Train Acc: 0.9343
 Site-USPS      | Train Loss: 0.4158 | Train Acc: 0.8825
 Site-USPS      | Train Loss: 0.4072 | Train Acc: 0.8802
 Site-USPS      | Train Loss: 0.4008 | Train Acc: 0.8892
 Site-SynthDigits| Train Loss: 0.6972 | Train Acc: 0.7898
 Site-SynthDigits| Train Loss: 0.6344 | Train Acc: 0.8270
 Site-MNIST-M   | Train Loss: 0.9632 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.9707 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 1.1275 | Train Acc: 0.6048
 Site-MNIST     | Val  Loss: 0.2767 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2903 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.3107 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3779 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.3390 | Val  Acc: 0.9193
 Site-USPS      | Val  Loss: 0.3774 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.4110 | Val  Acc: 0.8462
 Site-USPS      | Val  Loss: 0.4468 | Val  Acc: 0.8590
 Site-SynthDigits| Val  Loss: 0.8646 | Val  Acc: 0.7803
 Site-SynthDigits| Val  Loss: 0.5859 | Val  Acc: 0.8232
 Site-MNIST-M   | Val  Loss: 0.9198 | Val  Acc: 0.7273
 Site-MNIST-M   | Val  Loss: 0.9939 | Val  Acc: 0.7348
 Site-SVHN      | Val  Loss: 1.1427 | Val  Acc: 0.6096
Average Valid Accuracy: 0.8375
Aggregated Acc | Val Acc: 0.7858
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9053
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9193
 Best site-USPS       | Epoch:14 | Val Acc: 0.8750
 Best site-USPS       | Epoch:14 | Val Acc: 0.8462
 Best site-USPS       | Epoch:14 | Val Acc: 0.8590
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7803
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8232
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7273
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7348
 Best site-SVHN       | Epoch:14 | Val Acc: 0.6096
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2877 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.3124 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.3312 | Train Acc: 0.9152
 Site-MNIST     | Train Loss: 0.3322 | Train Acc: 0.9146
 Site-MNIST     | Train Loss: 0.2969 | Train Acc: 0.9387
 Site-USPS      | Train Loss: 0.4062 | Train Acc: 0.8825
 Site-USPS      | Train Loss: 0.3866 | Train Acc: 0.8834
 Site-USPS      | Train Loss: 0.3834 | Train Acc: 0.8935
 Site-SynthDigits| Train Loss: 0.6803 | Train Acc: 0.7898
 Site-SynthDigits| Train Loss: 0.6070 | Train Acc: 0.8270
 Site-MNIST-M   | Train Loss: 0.9397 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.9283 | Train Acc: 0.7083
 Site-SVHN      | Train Loss: 1.1674 | Train Acc: 0.5945
 Site-MNIST     | Val  Loss: 0.2537 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2694 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2952 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3675 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.3267 | Val  Acc: 0.9228
 Site-USPS      | Val  Loss: 0.3682 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3949 | Val  Acc: 0.8526
 Site-USPS      | Val  Loss: 0.4315 | Val  Acc: 0.8547
 Site-SynthDigits| Val  Loss: 0.8560 | Val  Acc: 0.7879
 Site-SynthDigits| Val  Loss: 0.5665 | Val  Acc: 0.8283
 Site-MNIST-M   | Val  Loss: 0.9038 | Val  Acc: 0.7273
 Site-MNIST-M   | Val  Loss: 0.9727 | Val  Acc: 0.7348
 Site-SVHN      | Val  Loss: 1.1171 | Val  Acc: 0.6027
Average Valid Accuracy: 0.8407
Aggregated Acc | Val Acc: 0.7871
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9053
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9228
 Best site-USPS       | Epoch:15 | Val Acc: 0.8750
 Best site-USPS       | Epoch:15 | Val Acc: 0.8526
 Best site-USPS       | Epoch:15 | Val Acc: 0.8547
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7879
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.8283
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7273
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7348
 Best site-SVHN       | Epoch:15 | Val Acc: 0.6027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2972 | Train Acc: 0.9244
 Site-MNIST     | Train Loss: 0.2936 | Train Acc: 0.9201
 Site-MNIST     | Train Loss: 0.3254 | Train Acc: 0.9112
 Site-MNIST     | Train Loss: 0.3273 | Train Acc: 0.9106
 Site-MNIST     | Train Loss: 0.2902 | Train Acc: 0.9335
 Site-USPS      | Train Loss: 0.3793 | Train Acc: 0.8921
 Site-USPS      | Train Loss: 0.3798 | Train Acc: 0.8898
 Site-USPS      | Train Loss: 0.3649 | Train Acc: 0.8946
 Site-SynthDigits| Train Loss: 0.6509 | Train Acc: 0.7992
 Site-SynthDigits| Train Loss: 0.5797 | Train Acc: 0.8346
 Site-MNIST-M   | Train Loss: 0.9384 | Train Acc: 0.7301
 Site-MNIST-M   | Train Loss: 0.9369 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 1.1082 | Train Acc: 0.6082
 Site-MNIST     | Val  Loss: 0.2553 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2724 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2887 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3637 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.3229 | Val  Acc: 0.9158
 Site-USPS      | Val  Loss: 0.3447 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3807 | Val  Acc: 0.8526
 Site-USPS      | Val  Loss: 0.4185 | Val  Acc: 0.8547
 Site-SynthDigits| Val  Loss: 0.8451 | Val  Acc: 0.7879
 Site-SynthDigits| Val  Loss: 0.5322 | Val  Acc: 0.8232
 Site-MNIST-M   | Val  Loss: 0.8821 | Val  Acc: 0.7386
 Site-MNIST-M   | Val  Loss: 0.9477 | Val  Acc: 0.7348
 Site-SVHN      | Val  Loss: 1.0930 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8350
Aggregated Acc | Val Acc: 0.7824
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2741 | Train Acc: 0.9156
 Site-MNIST     | Train Loss: 0.3021 | Train Acc: 0.9290
 Site-MNIST     | Train Loss: 0.3126 | Train Acc: 0.9152
 Site-MNIST     | Train Loss: 0.3166 | Train Acc: 0.9172
 Site-MNIST     | Train Loss: 0.2793 | Train Acc: 0.9352
 Site-USPS      | Train Loss: 0.3711 | Train Acc: 0.8897
 Site-USPS      | Train Loss: 0.3796 | Train Acc: 0.8834
 Site-USPS      | Train Loss: 0.3655 | Train Acc: 0.8914
 Site-SynthDigits| Train Loss: 0.6199 | Train Acc: 0.8125
 Site-SynthDigits| Train Loss: 0.5732 | Train Acc: 0.8333
 Site-MNIST-M   | Train Loss: 0.9207 | Train Acc: 0.7301
 Site-MNIST-M   | Train Loss: 0.9209 | Train Acc: 0.7330
 Site-SVHN      | Train Loss: 1.0586 | Train Acc: 0.6235
 Site-MNIST     | Val  Loss: 0.2453 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2603 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2791 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3535 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.3141 | Val  Acc: 0.9263
 Site-USPS      | Val  Loss: 0.3511 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3783 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.4171 | Val  Acc: 0.8547
 Site-SynthDigits| Val  Loss: 0.8017 | Val  Acc: 0.7955
 Site-SynthDigits| Val  Loss: 0.5143 | Val  Acc: 0.8586
 Site-MNIST-M   | Val  Loss: 0.8553 | Val  Acc: 0.7159
 Site-MNIST-M   | Val  Loss: 0.9218 | Val  Acc: 0.7348
 Site-SVHN      | Val  Loss: 1.0664 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8437
Aggregated Acc | Val Acc: 0.7929
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9105
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9263
 Best site-USPS       | Epoch:17 | Val Acc: 0.8750
 Best site-USPS       | Epoch:17 | Val Acc: 0.8654
 Best site-USPS       | Epoch:17 | Val Acc: 0.8547
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7955
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.8586
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7159
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7348
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6164
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 18 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
client-12 is in G-4
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2574 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2755 | Train Acc: 0.9231
 Site-MNIST     | Train Loss: 0.3032 | Train Acc: 0.9172
 Site-MNIST     | Train Loss: 0.3090 | Train Acc: 0.9159
 Site-MNIST     | Train Loss: 0.2710 | Train Acc: 0.9387
 Site-USPS      | Train Loss: 0.3745 | Train Acc: 0.8897
 Site-USPS      | Train Loss: 0.3648 | Train Acc: 0.8898
 Site-USPS      | Train Loss: 0.3530 | Train Acc: 0.8988
 Site-SynthDigits| Train Loss: 0.6009 | Train Acc: 0.8201
 Site-SynthDigits| Train Loss: 0.5366 | Train Acc: 0.8447
 Site-MNIST-M   | Train Loss: 0.8543 | Train Acc: 0.7330
 Site-MNIST-M   | Train Loss: 0.8555 | Train Acc: 0.7443
 Site-SVHN      | Train Loss: 1.0592 | Train Acc: 0.6405
 Site-MNIST     | Val  Loss: 0.2343 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2484 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2681 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3445 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.3045 | Val  Acc: 0.9228
 Site-USPS      | Val  Loss: 0.3367 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3644 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.4030 | Val  Acc: 0.8590
 Site-SynthDigits| Val  Loss: 0.7716 | Val  Acc: 0.8106
 Site-SynthDigits| Val  Loss: 0.4938 | Val  Acc: 0.8636
 Site-MNIST-M   | Val  Loss: 0.8351 | Val  Acc: 0.7045
 Site-MNIST-M   | Val  Loss: 0.8996 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.0521 | Val  Acc: 0.6301
Average Valid Accuracy: 0.8463
Aggregated Acc | Val Acc: 0.7979
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9053
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9228
 Best site-USPS       | Epoch:18 | Val Acc: 0.8750
 Best site-USPS       | Epoch:18 | Val Acc: 0.8654
 Best site-USPS       | Epoch:18 | Val Acc: 0.8590
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8106
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8636
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7045
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6301
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2549 | Train Acc: 0.9244
 Site-MNIST     | Train Loss: 0.2685 | Train Acc: 0.9320
 Site-MNIST     | Train Loss: 0.2916 | Train Acc: 0.9152
 Site-MNIST     | Train Loss: 0.2989 | Train Acc: 0.9172
 Site-MNIST     | Train Loss: 0.2612 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.3520 | Train Acc: 0.8897
 Site-USPS      | Train Loss: 0.3492 | Train Acc: 0.8946
 Site-USPS      | Train Loss: 0.3450 | Train Acc: 0.9010
 Site-SynthDigits| Train Loss: 0.5701 | Train Acc: 0.8352
 Site-SynthDigits| Train Loss: 0.5106 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 0.8555 | Train Acc: 0.7528
 Site-MNIST-M   | Train Loss: 0.8567 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 1.0552 | Train Acc: 0.6593
 Site-MNIST     | Val  Loss: 0.2124 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2297 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2586 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3348 | Val  Acc: 0.9000
 Site-MNIST     | Val  Loss: 0.2946 | Val  Acc: 0.9298
 Site-USPS      | Val  Loss: 0.3123 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3473 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.3947 | Val  Acc: 0.8590
 Site-SynthDigits| Val  Loss: 0.7341 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 0.4663 | Val  Acc: 0.8788
 Site-MNIST-M   | Val  Loss: 0.8280 | Val  Acc: 0.7386
 Site-MNIST-M   | Val  Loss: 0.8933 | Val  Acc: 0.7424
 Site-SVHN      | Val  Loss: 1.0103 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8536
Aggregated Acc | Val Acc: 0.8067
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9298
 Best site-USPS       | Epoch:19 | Val Acc: 0.8750
 Best site-USPS       | Epoch:19 | Val Acc: 0.8654
 Best site-USPS       | Epoch:19 | Val Acc: 0.8590
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8788
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7386
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7424
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6370
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.9229
 Test site-USPS      | Epoch:19 | Test Acc: 0.9065
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.8374
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.6841
 Test site-SVHN      | Epoch:19 | Test Acc: 0.6178
Average Test Accuracy: 0.7937
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
client-12 is in G-4
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2604 | Train Acc: 0.9244
 Site-MNIST     | Train Loss: 0.2525 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2860 | Train Acc: 0.9191
 Site-MNIST     | Train Loss: 0.2921 | Train Acc: 0.9225
 Site-MNIST     | Train Loss: 0.2559 | Train Acc: 0.9431
 Site-USPS      | Train Loss: 0.3592 | Train Acc: 0.9017
 Site-USPS      | Train Loss: 0.3387 | Train Acc: 0.8978
 Site-USPS      | Train Loss: 0.3237 | Train Acc: 0.9042
 Site-SynthDigits| Train Loss: 0.5709 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.4983 | Train Acc: 0.8687
 Site-MNIST-M   | Train Loss: 0.8275 | Train Acc: 0.7415
 Site-MNIST-M   | Train Loss: 0.8157 | Train Acc: 0.7538
 Site-SVHN      | Train Loss: 0.9977 | Train Acc: 0.6542
 Site-MNIST     | Val  Loss: 0.2102 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2258 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2542 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3308 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.2890 | Val  Acc: 0.9333
 Site-USPS      | Val  Loss: 0.2986 | Val  Acc: 0.8942
 Site-USPS      | Val  Loss: 0.3295 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3820 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.7446 | Val  Acc: 0.8258
 Site-SynthDigits| Val  Loss: 0.4579 | Val  Acc: 0.8636
 Site-MNIST-M   | Val  Loss: 0.8153 | Val  Acc: 0.7386
 Site-MNIST-M   | Val  Loss: 0.8743 | Val  Acc: 0.7424
 Site-SVHN      | Val  Loss: 0.9828 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8553
Aggregated Acc | Val Acc: 0.8043
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9105
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9333
 Best site-USPS       | Epoch:20 | Val Acc: 0.8942
 Best site-USPS       | Epoch:20 | Val Acc: 0.8846
 Best site-USPS       | Epoch:20 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8258
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8636
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.7386
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.7424
 Best site-SVHN       | Epoch:20 | Val Acc: 0.6164
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2744 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2951 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2847 | Train Acc: 0.9250
 Site-MNIST     | Train Loss: 0.2910 | Train Acc: 0.9133
 Site-MNIST     | Train Loss: 0.2548 | Train Acc: 0.9361
 Site-USPS      | Train Loss: 0.3338 | Train Acc: 0.8921
 Site-USPS      | Train Loss: 0.3370 | Train Acc: 0.8946
 Site-USPS      | Train Loss: 0.3360 | Train Acc: 0.8924
 Site-SynthDigits| Train Loss: 0.5380 | Train Acc: 0.8390
 Site-SynthDigits| Train Loss: 0.4856 | Train Acc: 0.8712
 Site-MNIST-M   | Train Loss: 0.8256 | Train Acc: 0.7415
 Site-MNIST-M   | Train Loss: 0.7982 | Train Acc: 0.7708
 Site-SVHN      | Train Loss: 1.0111 | Train Acc: 0.6729
 Site-MNIST     | Val  Loss: 0.2192 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2289 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2511 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3288 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.2873 | Val  Acc: 0.9333
 Site-USPS      | Val  Loss: 0.3081 | Val  Acc: 0.8654
 Site-USPS      | Val  Loss: 0.3377 | Val  Acc: 0.8782
 Site-USPS      | Val  Loss: 0.3826 | Val  Acc: 0.8504
 Site-SynthDigits| Val  Loss: 0.6982 | Val  Acc: 0.8182
 Site-SynthDigits| Val  Loss: 0.4412 | Val  Acc: 0.8687
 Site-MNIST-M   | Val  Loss: 0.7948 | Val  Acc: 0.7386
 Site-MNIST-M   | Val  Loss: 0.8664 | Val  Acc: 0.7424
 Site-SVHN      | Val  Loss: 0.9830 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8513
Aggregated Acc | Val Acc: 0.8016
============ Train epoch 22 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2565 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.3001 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2788 | Train Acc: 0.9191
 Site-MNIST     | Train Loss: 0.2844 | Train Acc: 0.9159
 Site-MNIST     | Train Loss: 0.2479 | Train Acc: 0.9413
 Site-USPS      | Train Loss: 0.3247 | Train Acc: 0.8969
 Site-USPS      | Train Loss: 0.3206 | Train Acc: 0.8994
 Site-USPS      | Train Loss: 0.3134 | Train Acc: 0.9010
 Site-SynthDigits| Train Loss: 0.5424 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.4689 | Train Acc: 0.8662
 Site-MNIST-M   | Train Loss: 0.7944 | Train Acc: 0.7557
 Site-MNIST-M   | Train Loss: 0.7769 | Train Acc: 0.7746
 Site-SVHN      | Train Loss: 0.9809 | Train Acc: 0.6644
 Site-MNIST     | Val  Loss: 0.2142 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2290 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2467 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3240 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.2819 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2912 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3219 | Val  Acc: 0.8782
 Site-USPS      | Val  Loss: 0.3635 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.6893 | Val  Acc: 0.8106
 Site-SynthDigits| Val  Loss: 0.4329 | Val  Acc: 0.8737
 Site-MNIST-M   | Val  Loss: 0.7721 | Val  Acc: 0.7386
 Site-MNIST-M   | Val  Loss: 0.8447 | Val  Acc: 0.7576
 Site-SVHN      | Val  Loss: 0.9691 | Val  Acc: 0.6575
Average Valid Accuracy: 0.8540
Aggregated Acc | Val Acc: 0.8101
============ Train epoch 23 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2529 | Train Acc: 0.9289
 Site-MNIST     | Train Loss: 0.2759 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2747 | Train Acc: 0.9250
 Site-MNIST     | Train Loss: 0.2822 | Train Acc: 0.9238
 Site-MNIST     | Train Loss: 0.2446 | Train Acc: 0.9396
 Site-USPS      | Train Loss: 0.3277 | Train Acc: 0.9041
 Site-USPS      | Train Loss: 0.3136 | Train Acc: 0.9042
 Site-USPS      | Train Loss: 0.3017 | Train Acc: 0.9095
 Site-SynthDigits| Train Loss: 0.5301 | Train Acc: 0.8352
 Site-SynthDigits| Train Loss: 0.4551 | Train Acc: 0.8788
 Site-MNIST-M   | Train Loss: 0.7978 | Train Acc: 0.7358
 Site-MNIST-M   | Train Loss: 0.7931 | Train Acc: 0.7860
 Site-SVHN      | Train Loss: 0.9451 | Train Acc: 0.6763
 Site-MNIST     | Val  Loss: 0.2078 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2232 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2451 | Val  Acc: 0.9127
 Site-MNIST     | Val  Loss: 0.3231 | Val  Acc: 0.8947
 Site-MNIST     | Val  Loss: 0.2795 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2707 | Val  Acc: 0.8942
 Site-USPS      | Val  Loss: 0.3106 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3612 | Val  Acc: 0.8846
 Site-SynthDigits| Val  Loss: 0.6869 | Val  Acc: 0.8106
 Site-SynthDigits| Val  Loss: 0.4199 | Val  Acc: 0.8788
 Site-MNIST-M   | Val  Loss: 0.7760 | Val  Acc: 0.7500
 Site-MNIST-M   | Val  Loss: 0.8454 | Val  Acc: 0.7273
 Site-SVHN      | Val  Loss: 0.9306 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8563
Aggregated Acc | Val Acc: 0.8137
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9127
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8947
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9368
 Best site-USPS       | Epoch:23 | Val Acc: 0.8942
 Best site-USPS       | Epoch:23 | Val Acc: 0.8846
 Best site-USPS       | Epoch:23 | Val Acc: 0.8846
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8106
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8788
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.7500
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.7273
 Best site-SVHN       | Epoch:23 | Val Acc: 0.6712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 24 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2522 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2665 | Train Acc: 0.9379
 Site-MNIST     | Train Loss: 0.2668 | Train Acc: 0.9310
 Site-MNIST     | Train Loss: 0.2743 | Train Acc: 0.9251
 Site-MNIST     | Train Loss: 0.2391 | Train Acc: 0.9413
 Site-USPS      | Train Loss: 0.3289 | Train Acc: 0.8993
 Site-USPS      | Train Loss: 0.3137 | Train Acc: 0.8978
 Site-USPS      | Train Loss: 0.3081 | Train Acc: 0.9042
 Site-SynthDigits| Train Loss: 0.4855 | Train Acc: 0.8390
 Site-SynthDigits| Train Loss: 0.4365 | Train Acc: 0.8838
 Site-MNIST-M   | Train Loss: 0.7526 | Train Acc: 0.7670
 Site-MNIST-M   | Train Loss: 0.7528 | Train Acc: 0.7765
 Site-SVHN      | Train Loss: 0.9597 | Train Acc: 0.6899
 Site-MNIST     | Val  Loss: 0.2007 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2163 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2366 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3186 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.2751 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2766 | Val  Acc: 0.8942
 Site-USPS      | Val  Loss: 0.3080 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3526 | Val  Acc: 0.8675
 Site-SynthDigits| Val  Loss: 0.6441 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 0.4073 | Val  Acc: 0.8939
 Site-MNIST-M   | Val  Loss: 0.7391 | Val  Acc: 0.7500
 Site-MNIST-M   | Val  Loss: 0.8128 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 0.9273 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8661
Aggregated Acc | Val Acc: 0.8244
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9105
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9368
 Best site-USPS       | Epoch:24 | Val Acc: 0.8942
 Best site-USPS       | Epoch:24 | Val Acc: 0.8846
 Best site-USPS       | Epoch:24 | Val Acc: 0.8675
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8939
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7500
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:24 | Val Acc: 0.6781
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2754 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2807 | Train Acc: 0.9379
 Site-MNIST     | Train Loss: 0.2638 | Train Acc: 0.9290
 Site-MNIST     | Train Loss: 0.2732 | Train Acc: 0.9264
 Site-MNIST     | Train Loss: 0.2374 | Train Acc: 0.9422
 Site-USPS      | Train Loss: 0.3106 | Train Acc: 0.9017
 Site-USPS      | Train Loss: 0.2993 | Train Acc: 0.9073
 Site-USPS      | Train Loss: 0.2934 | Train Acc: 0.9116
 Site-SynthDigits| Train Loss: 0.5117 | Train Acc: 0.8580
 Site-SynthDigits| Train Loss: 0.4507 | Train Acc: 0.8674
 Site-MNIST-M   | Train Loss: 0.7397 | Train Acc: 0.7585
 Site-MNIST-M   | Train Loss: 0.7335 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.9399 | Train Acc: 0.6831
 Site-MNIST     | Val  Loss: 0.2082 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2149 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2337 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.3133 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.2730 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2619 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2975 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3374 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.6453 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.4038 | Val  Acc: 0.8838
 Site-MNIST-M   | Val  Loss: 0.7271 | Val  Acc: 0.7614
 Site-MNIST-M   | Val  Loss: 0.8012 | Val  Acc: 0.7576
 Site-SVHN      | Val  Loss: 0.9168 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8668
Aggregated Acc | Val Acc: 0.8239
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9105
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9368
 Best site-USPS       | Epoch:25 | Val Acc: 0.9038
 Best site-USPS       | Epoch:25 | Val Acc: 0.8846
 Best site-USPS       | Epoch:25 | Val Acc: 0.8803
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8838
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.7614
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.7576
 Best site-SVHN       | Epoch:25 | Val Acc: 0.6712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2468 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2577 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2572 | Train Acc: 0.9329
 Site-MNIST     | Train Loss: 0.2665 | Train Acc: 0.9343
 Site-MNIST     | Train Loss: 0.2334 | Train Acc: 0.9405
 Site-USPS      | Train Loss: 0.3140 | Train Acc: 0.9017
 Site-USPS      | Train Loss: 0.2979 | Train Acc: 0.9058
 Site-USPS      | Train Loss: 0.2948 | Train Acc: 0.9127
 Site-SynthDigits| Train Loss: 0.5464 | Train Acc: 0.8561
 Site-SynthDigits| Train Loss: 0.4225 | Train Acc: 0.8876
 Site-MNIST-M   | Train Loss: 0.7422 | Train Acc: 0.7472
 Site-MNIST-M   | Train Loss: 0.7149 | Train Acc: 0.7879
 Site-SVHN      | Train Loss: 0.9210 | Train Acc: 0.7002
 Site-MNIST     | Val  Loss: 0.1964 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.2040 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2295 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3051 | Val  Acc: 0.9158
 Site-MNIST     | Val  Loss: 0.2668 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2612 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2985 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3463 | Val  Acc: 0.8675
 Site-SynthDigits| Val  Loss: 0.6061 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3928 | Val  Acc: 0.8737
 Site-MNIST-M   | Val  Loss: 0.7276 | Val  Acc: 0.7500
 Site-MNIST-M   | Val  Loss: 0.8068 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 0.8941 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8628
Aggregated Acc | Val Acc: 0.8209
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2636 | Train Acc: 0.9200
 Site-MNIST     | Train Loss: 0.2798 | Train Acc: 0.9438
 Site-MNIST     | Train Loss: 0.2550 | Train Acc: 0.9329
 Site-MNIST     | Train Loss: 0.2656 | Train Acc: 0.9251
 Site-MNIST     | Train Loss: 0.2299 | Train Acc: 0.9413
 Site-USPS      | Train Loss: 0.3006 | Train Acc: 0.9017
 Site-USPS      | Train Loss: 0.2856 | Train Acc: 0.9089
 Site-USPS      | Train Loss: 0.2776 | Train Acc: 0.9137
 Site-SynthDigits| Train Loss: 0.5057 | Train Acc: 0.8504
 Site-SynthDigits| Train Loss: 0.4034 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.7433 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.7216 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.8728 | Train Acc: 0.7104
 Site-MNIST     | Val  Loss: 0.1969 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.2043 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2269 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3041 | Val  Acc: 0.9158
 Site-MNIST     | Val  Loss: 0.2638 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2510 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2874 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3335 | Val  Acc: 0.8846
 Site-SynthDigits| Val  Loss: 0.5930 | Val  Acc: 0.8258
 Site-SynthDigits| Val  Loss: 0.3774 | Val  Acc: 0.8889
 Site-MNIST-M   | Val  Loss: 0.6969 | Val  Acc: 0.7500
 Site-MNIST-M   | Val  Loss: 0.7799 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 0.8842 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8670
Aggregated Acc | Val Acc: 0.8246
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9158
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9368
 Best site-USPS       | Epoch:27 | Val Acc: 0.9038
 Best site-USPS       | Epoch:27 | Val Acc: 0.8846
 Best site-USPS       | Epoch:27 | Val Acc: 0.8846
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8258
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8889
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.7500
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:27 | Val Acc: 0.6849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2282 | Train Acc: 0.9244
 Site-MNIST     | Train Loss: 0.2423 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2455 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2549 | Train Acc: 0.9304
 Site-MNIST     | Train Loss: 0.2216 | Train Acc: 0.9440
 Site-USPS      | Train Loss: 0.2925 | Train Acc: 0.9089
 Site-USPS      | Train Loss: 0.2849 | Train Acc: 0.9105
 Site-USPS      | Train Loss: 0.2723 | Train Acc: 0.9169
 Site-SynthDigits| Train Loss: 0.4580 | Train Acc: 0.8485
 Site-SynthDigits| Train Loss: 0.3937 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.6772 | Train Acc: 0.7756
 Site-MNIST-M   | Train Loss: 0.6859 | Train Acc: 0.7973
 Site-SVHN      | Train Loss: 0.8805 | Train Acc: 0.7036
 Site-MNIST     | Val  Loss: 0.1892 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1947 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2198 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.2951 | Val  Acc: 0.9053
 Site-MNIST     | Val  Loss: 0.2560 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2457 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2855 | Val  Acc: 0.8846
 Site-USPS      | Val  Loss: 0.3245 | Val  Acc: 0.8761
 Site-SynthDigits| Val  Loss: 0.5885 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3709 | Val  Acc: 0.8788
 Site-MNIST-M   | Val  Loss: 0.6712 | Val  Acc: 0.7727
 Site-MNIST-M   | Val  Loss: 0.7636 | Val  Acc: 0.7652
 Site-SVHN      | Val  Loss: 0.8765 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8668
Aggregated Acc | Val Acc: 0.8268
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
client-12 is in G-4
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2363 | Train Acc: 0.9333
 Site-MNIST     | Train Loss: 0.2346 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2438 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2537 | Train Acc: 0.9304
 Site-MNIST     | Train Loss: 0.2209 | Train Acc: 0.9475
 Site-USPS      | Train Loss: 0.2927 | Train Acc: 0.9161
 Site-USPS      | Train Loss: 0.2729 | Train Acc: 0.9185
 Site-USPS      | Train Loss: 0.2629 | Train Acc: 0.9148
 Site-SynthDigits| Train Loss: 0.4657 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3923 | Train Acc: 0.8914
 Site-MNIST-M   | Train Loss: 0.7079 | Train Acc: 0.7784
 Site-MNIST-M   | Train Loss: 0.7048 | Train Acc: 0.8144
 Site-SVHN      | Train Loss: 0.8626 | Train Acc: 0.7189
 Site-MNIST     | Val  Loss: 0.1869 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1924 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2181 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2917 | Val  Acc: 0.9105
 Site-MNIST     | Val  Loss: 0.2498 | Val  Acc: 0.9404
 Site-USPS      | Val  Loss: 0.2342 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2726 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.3199 | Val  Acc: 0.8846
 Site-SynthDigits| Val  Loss: 0.5748 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3614 | Val  Acc: 0.8737
 Site-MNIST-M   | Val  Loss: 0.6683 | Val  Acc: 0.7614
 Site-MNIST-M   | Val  Loss: 0.7599 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 0.8533 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8701
Aggregated Acc | Val Acc: 0.8325
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9105
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9404
 Best site-USPS       | Epoch:29 | Val Acc: 0.9038
 Best site-USPS       | Epoch:29 | Val Acc: 0.8910
 Best site-USPS       | Epoch:29 | Val Acc: 0.8846
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8737
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.7614
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:29 | Val Acc: 0.7192
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.9313
 Test site-USPS      | Epoch:29 | Test Acc: 0.9226
 Test site-SynthDigits| Epoch:29 | Test Acc: 0.8699
 Test site-MNIST-M   | Epoch:29 | Test Acc: 0.7214
 Test site-SVHN      | Epoch:29 | Test Acc: 0.6529
Average Test Accuracy: 0.8196
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2290 | Train Acc: 0.9333
 Site-MNIST     | Train Loss: 0.2299 | Train Acc: 0.9497
 Site-MNIST     | Train Loss: 0.2376 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2473 | Train Acc: 0.9304
 Site-MNIST     | Train Loss: 0.2140 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2820 | Train Acc: 0.9185
 Site-USPS      | Train Loss: 0.2716 | Train Acc: 0.9201
 Site-USPS      | Train Loss: 0.2614 | Train Acc: 0.9191
 Site-SynthDigits| Train Loss: 0.4453 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4044 | Train Acc: 0.8939
 Site-MNIST-M   | Train Loss: 0.7062 | Train Acc: 0.7898
 Site-MNIST-M   | Train Loss: 0.6806 | Train Acc: 0.8125
 Site-SVHN      | Train Loss: 0.8549 | Train Acc: 0.7223
 Site-MNIST     | Val  Loss: 0.1756 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.1829 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2120 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2856 | Val  Acc: 0.9158
 Site-MNIST     | Val  Loss: 0.2426 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.2307 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2676 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.3131 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5891 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3571 | Val  Acc: 0.8889
 Site-MNIST-M   | Val  Loss: 0.6617 | Val  Acc: 0.7614
 Site-MNIST-M   | Val  Loss: 0.7503 | Val  Acc: 0.7652
 Site-SVHN      | Val  Loss: 0.8366 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8706
Aggregated Acc | Val Acc: 0.8336
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9158
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9439
 Best site-USPS       | Epoch:30 | Val Acc: 0.9038
 Best site-USPS       | Epoch:30 | Val Acc: 0.8910
 Best site-USPS       | Epoch:30 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8889
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.7614
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.7652
 Best site-SVHN       | Epoch:30 | Val Acc: 0.7123
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 31 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2302 | Train Acc: 0.9333
 Site-MNIST     | Train Loss: 0.2330 | Train Acc: 0.9438
 Site-MNIST     | Train Loss: 0.2457 | Train Acc: 0.9349
 Site-MNIST     | Train Loss: 0.2534 | Train Acc: 0.9277
 Site-MNIST     | Train Loss: 0.2190 | Train Acc: 0.9457
 Site-USPS      | Train Loss: 0.2745 | Train Acc: 0.9065
 Site-USPS      | Train Loss: 0.2760 | Train Acc: 0.9137
 Site-USPS      | Train Loss: 0.2691 | Train Acc: 0.9180
 Site-SynthDigits| Train Loss: 0.4528 | Train Acc: 0.8674
 Site-SynthDigits| Train Loss: 0.3896 | Train Acc: 0.8876
 Site-MNIST-M   | Train Loss: 0.6534 | Train Acc: 0.7898
 Site-MNIST-M   | Train Loss: 0.6440 | Train Acc: 0.8106
 Site-SVHN      | Train Loss: 0.8458 | Train Acc: 0.7257
 Site-MNIST     | Val  Loss: 0.1902 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1926 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2149 | Val  Acc: 0.9444
 Site-MNIST     | Val  Loss: 0.2912 | Val  Acc: 0.9263
 Site-MNIST     | Val  Loss: 0.2495 | Val  Acc: 0.9404
 Site-USPS      | Val  Loss: 0.2393 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2758 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.3091 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.5856 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3610 | Val  Acc: 0.8939
 Site-MNIST-M   | Val  Loss: 0.6332 | Val  Acc: 0.8068
 Site-MNIST-M   | Val  Loss: 0.7449 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 0.8337 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8742
Aggregated Acc | Val Acc: 0.8341
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9444
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9263
 Best site-MNIST      | Epoch:31 | Val Acc: 0.9404
 Best site-USPS       | Epoch:31 | Val Acc: 0.9038
 Best site-USPS       | Epoch:31 | Val Acc: 0.8910
 Best site-USPS       | Epoch:31 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.8939
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.8068
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:31 | Val Acc: 0.6849
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 32 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2413 | Train Acc: 0.9289
 Site-MNIST     | Train Loss: 0.2338 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2449 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2552 | Train Acc: 0.9251
 Site-MNIST     | Train Loss: 0.2223 | Train Acc: 0.9448
 Site-USPS      | Train Loss: 0.2821 | Train Acc: 0.9209
 Site-USPS      | Train Loss: 0.2674 | Train Acc: 0.9185
 Site-USPS      | Train Loss: 0.2544 | Train Acc: 0.9233
 Site-SynthDigits| Train Loss: 0.4630 | Train Acc: 0.8693
 Site-SynthDigits| Train Loss: 0.3962 | Train Acc: 0.8826
 Site-MNIST-M   | Train Loss: 0.6497 | Train Acc: 0.8153
 Site-MNIST-M   | Train Loss: 0.6289 | Train Acc: 0.8314
 Site-SVHN      | Train Loss: 0.8545 | Train Acc: 0.7240
 Site-MNIST     | Val  Loss: 0.1962 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1973 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.2192 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2917 | Val  Acc: 0.9263
 Site-MNIST     | Val  Loss: 0.2510 | Val  Acc: 0.9368
 Site-USPS      | Val  Loss: 0.2311 | Val  Acc: 0.9231
 Site-USPS      | Val  Loss: 0.2674 | Val  Acc: 0.8974
 Site-USPS      | Val  Loss: 0.3031 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5856 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 0.3505 | Val  Acc: 0.8838
 Site-MNIST-M   | Val  Loss: 0.6114 | Val  Acc: 0.8182
 Site-MNIST-M   | Val  Loss: 0.7236 | Val  Acc: 0.7803
 Site-SVHN      | Val  Loss: 0.8156 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8777
Aggregated Acc | Val Acc: 0.8394
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9263
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9368
 Best site-USPS       | Epoch:32 | Val Acc: 0.9231
 Best site-USPS       | Epoch:32 | Val Acc: 0.8974
 Best site-USPS       | Epoch:32 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8838
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.8182
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.7803
 Best site-SVHN       | Epoch:32 | Val Acc: 0.6986
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2134 | Train Acc: 0.9422
 Site-MNIST     | Train Loss: 0.2103 | Train Acc: 0.9527
 Site-MNIST     | Train Loss: 0.2311 | Train Acc: 0.9389
 Site-MNIST     | Train Loss: 0.2428 | Train Acc: 0.9343
 Site-MNIST     | Train Loss: 0.2119 | Train Acc: 0.9466
 Site-USPS      | Train Loss: 0.2678 | Train Acc: 0.9209
 Site-USPS      | Train Loss: 0.2651 | Train Acc: 0.9217
 Site-USPS      | Train Loss: 0.2562 | Train Acc: 0.9212
 Site-SynthDigits| Train Loss: 0.4298 | Train Acc: 0.8674
 Site-SynthDigits| Train Loss: 0.3677 | Train Acc: 0.9053
 Site-MNIST-M   | Train Loss: 0.6293 | Train Acc: 0.7983
 Site-MNIST-M   | Train Loss: 0.6591 | Train Acc: 0.8258
 Site-SVHN      | Train Loss: 0.8487 | Train Acc: 0.7342
 Site-MNIST     | Val  Loss: 0.1704 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1800 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2092 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2805 | Val  Acc: 0.9211
 Site-MNIST     | Val  Loss: 0.2389 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.2231 | Val  Acc: 0.9135
 Site-USPS      | Val  Loss: 0.2619 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.3064 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5615 | Val  Acc: 0.8485
 Site-SynthDigits| Val  Loss: 0.3387 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.6127 | Val  Acc: 0.7955
 Site-MNIST-M   | Val  Loss: 0.7202 | Val  Acc: 0.7727
 Site-SVHN      | Val  Loss: 0.8211 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8803
Aggregated Acc | Val Acc: 0.8428
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9211
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9439
 Best site-USPS       | Epoch:33 | Val Acc: 0.9135
 Best site-USPS       | Epoch:33 | Val Acc: 0.8910
 Best site-USPS       | Epoch:33 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8485
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9040
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.7955
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.7727
 Best site-SVHN       | Epoch:33 | Val Acc: 0.7123
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2116 | Train Acc: 0.9333
 Site-MNIST     | Train Loss: 0.2155 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2241 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2365 | Train Acc: 0.9330
 Site-MNIST     | Train Loss: 0.2034 | Train Acc: 0.9475
 Site-USPS      | Train Loss: 0.2686 | Train Acc: 0.9233
 Site-USPS      | Train Loss: 0.2602 | Train Acc: 0.9217
 Site-USPS      | Train Loss: 0.2512 | Train Acc: 0.9191
 Site-SynthDigits| Train Loss: 0.4284 | Train Acc: 0.8561
 Site-SynthDigits| Train Loss: 0.3598 | Train Acc: 0.9040
 Site-MNIST-M   | Train Loss: 0.6576 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 0.6790 | Train Acc: 0.8201
 Site-SVHN      | Train Loss: 0.7847 | Train Acc: 0.7274
 Site-MNIST     | Val  Loss: 0.1604 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1675 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2019 | Val  Acc: 0.9444
 Site-MNIST     | Val  Loss: 0.2735 | Val  Acc: 0.9316
 Site-MNIST     | Val  Loss: 0.2331 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.2136 | Val  Acc: 0.9135
 Site-USPS      | Val  Loss: 0.2589 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.3018 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5625 | Val  Acc: 0.8485
 Site-SynthDigits| Val  Loss: 0.3383 | Val  Acc: 0.8990
 Site-MNIST-M   | Val  Loss: 0.6003 | Val  Acc: 0.8182
 Site-MNIST-M   | Val  Loss: 0.7192 | Val  Acc: 0.7424
 Site-SVHN      | Val  Loss: 0.7956 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8805
Aggregated Acc | Val Acc: 0.8411
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9316
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9474
 Best site-USPS       | Epoch:34 | Val Acc: 0.9135
 Best site-USPS       | Epoch:34 | Val Acc: 0.8910
 Best site-USPS       | Epoch:34 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8485
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8990
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.8182
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.7424
 Best site-SVHN       | Epoch:34 | Val Acc: 0.7055
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2272 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.2084 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2216 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2308 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2012 | Train Acc: 0.9483
 Site-USPS      | Train Loss: 0.2576 | Train Acc: 0.9161
 Site-USPS      | Train Loss: 0.2560 | Train Acc: 0.9217
 Site-USPS      | Train Loss: 0.2464 | Train Acc: 0.9223
 Site-SynthDigits| Train Loss: 0.4265 | Train Acc: 0.8731
 Site-SynthDigits| Train Loss: 0.3646 | Train Acc: 0.9028
 Site-MNIST-M   | Train Loss: 0.6265 | Train Acc: 0.7983
 Site-MNIST-M   | Train Loss: 0.6020 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 0.7937 | Train Acc: 0.7428
 Site-MNIST     | Val  Loss: 0.1645 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1682 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1950 | Val  Acc: 0.9444
 Site-MNIST     | Val  Loss: 0.2699 | Val  Acc: 0.9263
 Site-MNIST     | Val  Loss: 0.2298 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.2134 | Val  Acc: 0.9231
 Site-USPS      | Val  Loss: 0.2558 | Val  Acc: 0.8910
 Site-USPS      | Val  Loss: 0.2927 | Val  Acc: 0.8846
 Site-SynthDigits| Val  Loss: 0.5763 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3350 | Val  Acc: 0.8939
 Site-MNIST-M   | Val  Loss: 0.5845 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6859 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.7918 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8842
Aggregated Acc | Val Acc: 0.8487
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9444
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9263
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9439
 Best site-USPS       | Epoch:35 | Val Acc: 0.9231
 Best site-USPS       | Epoch:35 | Val Acc: 0.8910
 Best site-USPS       | Epoch:35 | Val Acc: 0.8846
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8939
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.8295
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:35 | Val Acc: 0.7123
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
client-12 is in G-4
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1987 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.2096 | Train Acc: 0.9497
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9448
 Site-MNIST     | Train Loss: 0.2249 | Train Acc: 0.9343
 Site-MNIST     | Train Loss: 0.1956 | Train Acc: 0.9483
 Site-USPS      | Train Loss: 0.2733 | Train Acc: 0.9257
 Site-USPS      | Train Loss: 0.2523 | Train Acc: 0.9265
 Site-USPS      | Train Loss: 0.2433 | Train Acc: 0.9286
 Site-SynthDigits| Train Loss: 0.4172 | Train Acc: 0.8731
 Site-SynthDigits| Train Loss: 0.3424 | Train Acc: 0.9104
 Site-MNIST-M   | Train Loss: 0.5982 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.6157 | Train Acc: 0.8352
 Site-SVHN      | Train Loss: 0.7516 | Train Acc: 0.7513
 Site-MNIST     | Val  Loss: 0.1531 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1612 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1925 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2638 | Val  Acc: 0.9263
 Site-MNIST     | Val  Loss: 0.2250 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.2081 | Val  Acc: 0.9135
 Site-USPS      | Val  Loss: 0.2533 | Val  Acc: 0.8974
 Site-USPS      | Val  Loss: 0.2926 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.5461 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.3252 | Val  Acc: 0.8939
 Site-MNIST-M   | Val  Loss: 0.5882 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6968 | Val  Acc: 0.8106
 Site-SVHN      | Val  Loss: 0.7721 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8867
Aggregated Acc | Val Acc: 0.8513
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9263
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9474
 Best site-USPS       | Epoch:36 | Val Acc: 0.9135
 Best site-USPS       | Epoch:36 | Val Acc: 0.8974
 Best site-USPS       | Epoch:36 | Val Acc: 0.8803
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8561
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8939
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.8295
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.8106
 Best site-SVHN       | Epoch:36 | Val Acc: 0.7192
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 37 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[2, 3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2011 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.2069 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.2173 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2276 | Train Acc: 0.9343
 Site-MNIST     | Train Loss: 0.1955 | Train Acc: 0.9492
 Site-USPS      | Train Loss: 0.2607 | Train Acc: 0.9281
 Site-USPS      | Train Loss: 0.2501 | Train Acc: 0.9281
 Site-USPS      | Train Loss: 0.2360 | Train Acc: 0.9255
 Site-SynthDigits| Train Loss: 0.4070 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.3377 | Train Acc: 0.9104
 Site-MNIST-M   | Train Loss: 0.5795 | Train Acc: 0.8267
 Site-MNIST-M   | Train Loss: 0.5944 | Train Acc: 0.8258
 Site-SVHN      | Train Loss: 0.7960 | Train Acc: 0.7479
 Site-MNIST     | Val  Loss: 0.1490 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1600 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1939 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.2623 | Val  Acc: 0.9316
 Site-MNIST     | Val  Loss: 0.2242 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.1962 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2438 | Val  Acc: 0.8974
 Site-USPS      | Val  Loss: 0.2869 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5399 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3201 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.5673 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6910 | Val  Acc: 0.8030
 Site-SVHN      | Val  Loss: 0.7667 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8877
Aggregated Acc | Val Acc: 0.8499
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9316
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9439
 Best site-USPS       | Epoch:37 | Val Acc: 0.9423
 Best site-USPS       | Epoch:37 | Val Acc: 0.8974
 Best site-USPS       | Epoch:37 | Val Acc: 0.8889
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9040
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.8295
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.8030
 Best site-SVHN       | Epoch:37 | Val Acc: 0.7055
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1921 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.2024 | Train Acc: 0.9527
 Site-MNIST     | Train Loss: 0.2135 | Train Acc: 0.9487
 Site-MNIST     | Train Loss: 0.2222 | Train Acc: 0.9396
 Site-MNIST     | Train Loss: 0.1904 | Train Acc: 0.9510
 Site-USPS      | Train Loss: 0.2496 | Train Acc: 0.9209
 Site-USPS      | Train Loss: 0.2439 | Train Acc: 0.9329
 Site-USPS      | Train Loss: 0.2290 | Train Acc: 0.9286
 Site-SynthDigits| Train Loss: 0.4564 | Train Acc: 0.8693
 Site-SynthDigits| Train Loss: 0.3432 | Train Acc: 0.9129
 Site-MNIST-M   | Train Loss: 0.5846 | Train Acc: 0.8210
 Site-MNIST-M   | Train Loss: 0.5894 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 0.7782 | Train Acc: 0.7359
 Site-MNIST     | Val  Loss: 0.1470 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1585 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1892 | Val  Acc: 0.9444
 Site-MNIST     | Val  Loss: 0.2616 | Val  Acc: 0.9316
 Site-MNIST     | Val  Loss: 0.2214 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.1873 | Val  Acc: 0.9327
 Site-USPS      | Val  Loss: 0.2394 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2869 | Val  Acc: 0.8761
 Site-SynthDigits| Val  Loss: 0.5326 | Val  Acc: 0.8485
 Site-SynthDigits| Val  Loss: 0.3133 | Val  Acc: 0.8889
 Site-MNIST-M   | Val  Loss: 0.5682 | Val  Acc: 0.8409
 Site-MNIST-M   | Val  Loss: 0.6872 | Val  Acc: 0.8030
 Site-SVHN      | Val  Loss: 0.7584 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8882
Aggregated Acc | Val Acc: 0.8510
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9444
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9316
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9474
 Best site-USPS       | Epoch:38 | Val Acc: 0.9327
 Best site-USPS       | Epoch:38 | Val Acc: 0.9038
 Best site-USPS       | Epoch:38 | Val Acc: 0.8761
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8485
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8889
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.8409
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.8030
 Best site-SVHN       | Epoch:38 | Val Acc: 0.7123
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 39 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2212 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.2074 | Train Acc: 0.9527
 Site-MNIST     | Train Loss: 0.2150 | Train Acc: 0.9428
 Site-MNIST     | Train Loss: 0.2246 | Train Acc: 0.9382
 Site-MNIST     | Train Loss: 0.1891 | Train Acc: 0.9483
 Site-USPS      | Train Loss: 0.2487 | Train Acc: 0.9161
 Site-USPS      | Train Loss: 0.2395 | Train Acc: 0.9233
 Site-USPS      | Train Loss: 0.2322 | Train Acc: 0.9276
 Site-SynthDigits| Train Loss: 0.4137 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 0.3328 | Train Acc: 0.9154
 Site-MNIST-M   | Train Loss: 0.5691 | Train Acc: 0.8352
 Site-MNIST-M   | Train Loss: 0.5647 | Train Acc: 0.8333
 Site-SVHN      | Train Loss: 0.7640 | Train Acc: 0.7513
 Site-MNIST     | Val  Loss: 0.1510 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1616 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1879 | Val  Acc: 0.9444
 Site-MNIST     | Val  Loss: 0.2643 | Val  Acc: 0.9368
 Site-MNIST     | Val  Loss: 0.2224 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.1942 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2391 | Val  Acc: 0.9038
 Site-USPS      | Val  Loss: 0.2814 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.5221 | Val  Acc: 0.8409
 Site-SynthDigits| Val  Loss: 0.3085 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.5599 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6920 | Val  Acc: 0.8106
 Site-SVHN      | Val  Loss: 0.7551 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8901
Aggregated Acc | Val Acc: 0.8548
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9444
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9368
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9474
 Best site-USPS       | Epoch:39 | Val Acc: 0.9423
 Best site-USPS       | Epoch:39 | Val Acc: 0.9038
 Best site-USPS       | Epoch:39 | Val Acc: 0.8803
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8409
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9040
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.8295
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.8106
 Best site-SVHN       | Epoch:39 | Val Acc: 0.7260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.9377
 Test site-USPS      | Epoch:39 | Test Acc: 0.9312
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.8824
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.7396
 Test site-SVHN      | Epoch:39 | Test Acc: 0.6705
Average Test Accuracy: 0.8323
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2064 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.1850 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.2059 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2187 | Train Acc: 0.9356
 Site-MNIST     | Train Loss: 0.1863 | Train Acc: 0.9501
 Site-USPS      | Train Loss: 0.2436 | Train Acc: 0.9233
 Site-USPS      | Train Loss: 0.2364 | Train Acc: 0.9281
 Site-USPS      | Train Loss: 0.2292 | Train Acc: 0.9265
 Site-SynthDigits| Train Loss: 0.4207 | Train Acc: 0.8845
 Site-SynthDigits| Train Loss: 0.3249 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5619 | Train Acc: 0.8239
 Site-MNIST-M   | Train Loss: 0.5768 | Train Acc: 0.8428
 Site-SVHN      | Train Loss: 0.7243 | Train Acc: 0.7581
 Site-MNIST     | Val  Loss: 0.1407 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1504 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1854 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2557 | Val  Acc: 0.9421
 Site-MNIST     | Val  Loss: 0.2137 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.1901 | Val  Acc: 0.9327
 Site-USPS      | Val  Loss: 0.2354 | Val  Acc: 0.9103
 Site-USPS      | Val  Loss: 0.2792 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.5180 | Val  Acc: 0.8485
 Site-SynthDigits| Val  Loss: 0.3017 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.5587 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6977 | Val  Acc: 0.8106
 Site-SVHN      | Val  Loss: 0.7461 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8890
Aggregated Acc | Val Acc: 0.8524
============ Train epoch 41 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1891 | Train Acc: 0.9422
 Site-MNIST     | Train Loss: 0.1759 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.2006 | Train Acc: 0.9448
 Site-MNIST     | Train Loss: 0.2131 | Train Acc: 0.9356
 Site-MNIST     | Train Loss: 0.1814 | Train Acc: 0.9527
 Site-USPS      | Train Loss: 0.2490 | Train Acc: 0.9137
 Site-USPS      | Train Loss: 0.2366 | Train Acc: 0.9297
 Site-USPS      | Train Loss: 0.2238 | Train Acc: 0.9276
 Site-SynthDigits| Train Loss: 0.3805 | Train Acc: 0.8769
 Site-SynthDigits| Train Loss: 0.3168 | Train Acc: 0.9154
 Site-MNIST-M   | Train Loss: 0.5700 | Train Acc: 0.8125
 Site-MNIST-M   | Train Loss: 0.5644 | Train Acc: 0.8466
 Site-SVHN      | Train Loss: 0.7824 | Train Acc: 0.7547
 Site-MNIST     | Val  Loss: 0.1371 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.1459 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1850 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2490 | Val  Acc: 0.9368
 Site-MNIST     | Val  Loss: 0.2077 | Val  Acc: 0.9509
 Site-USPS      | Val  Loss: 0.1859 | Val  Acc: 0.9327
 Site-USPS      | Val  Loss: 0.2338 | Val  Acc: 0.9103
 Site-USPS      | Val  Loss: 0.2796 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5080 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2942 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.5557 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6843 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 0.7403 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8887
Aggregated Acc | Val Acc: 0.8532
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2046 | Train Acc: 0.9378
 Site-MNIST     | Train Loss: 0.1861 | Train Acc: 0.9586
 Site-MNIST     | Train Loss: 0.1994 | Train Acc: 0.9527
 Site-MNIST     | Train Loss: 0.2112 | Train Acc: 0.9396
 Site-MNIST     | Train Loss: 0.1784 | Train Acc: 0.9518
 Site-USPS      | Train Loss: 0.2381 | Train Acc: 0.9257
 Site-USPS      | Train Loss: 0.2323 | Train Acc: 0.9329
 Site-USPS      | Train Loss: 0.2213 | Train Acc: 0.9286
 Site-SynthDigits| Train Loss: 0.4031 | Train Acc: 0.8712
 Site-SynthDigits| Train Loss: 0.3122 | Train Acc: 0.9167
 Site-MNIST-M   | Train Loss: 0.5980 | Train Acc: 0.8040
 Site-MNIST-M   | Train Loss: 0.5601 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.6988 | Train Acc: 0.7615
 Site-MNIST     | Val  Loss: 0.1316 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1446 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1816 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2469 | Val  Acc: 0.9421
 Site-MNIST     | Val  Loss: 0.2051 | Val  Acc: 0.9544
 Site-USPS      | Val  Loss: 0.1809 | Val  Acc: 0.9327
 Site-USPS      | Val  Loss: 0.2293 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2760 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.5111 | Val  Acc: 0.8636
 Site-SynthDigits| Val  Loss: 0.2883 | Val  Acc: 0.9192
 Site-MNIST-M   | Val  Loss: 0.5538 | Val  Acc: 0.8409
 Site-MNIST-M   | Val  Loss: 0.6806 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 0.7390 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8947
Aggregated Acc | Val Acc: 0.8593
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9603
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9421
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9544
 Best site-USPS       | Epoch:42 | Val Acc: 0.9327
 Best site-USPS       | Epoch:42 | Val Acc: 0.9167
 Best site-USPS       | Epoch:42 | Val Acc: 0.8803
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8636
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9192
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.8409
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.7955
 Best site-SVHN       | Epoch:42 | Val Acc: 0.7260
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2086 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.1938 | Train Acc: 0.9527
 Site-MNIST     | Train Loss: 0.1965 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2106 | Train Acc: 0.9343
 Site-MNIST     | Train Loss: 0.1749 | Train Acc: 0.9510
 Site-USPS      | Train Loss: 0.2305 | Train Acc: 0.9233
 Site-USPS      | Train Loss: 0.2269 | Train Acc: 0.9361
 Site-USPS      | Train Loss: 0.2176 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.3811 | Train Acc: 0.8807
 Site-SynthDigits| Train Loss: 0.3296 | Train Acc: 0.9116
 Site-MNIST-M   | Train Loss: 0.5292 | Train Acc: 0.8239
 Site-MNIST-M   | Train Loss: 0.5423 | Train Acc: 0.8428
 Site-SVHN      | Train Loss: 0.7091 | Train Acc: 0.7632
 Site-MNIST     | Val  Loss: 0.1323 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1451 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1806 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2442 | Val  Acc: 0.9421
 Site-MNIST     | Val  Loss: 0.2027 | Val  Acc: 0.9509
 Site-USPS      | Val  Loss: 0.1724 | Val  Acc: 0.9519
 Site-USPS      | Val  Loss: 0.2255 | Val  Acc: 0.9103
 Site-USPS      | Val  Loss: 0.2649 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.5266 | Val  Acc: 0.8485
 Site-SynthDigits| Val  Loss: 0.2898 | Val  Acc: 0.9141
 Site-MNIST-M   | Val  Loss: 0.5343 | Val  Acc: 0.8523
 Site-MNIST-M   | Val  Loss: 0.6798 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 0.7281 | Val  Acc: 0.7260
Average Valid Accuracy: 0.8944
Aggregated Acc | Val Acc: 0.8593
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1845 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.1883 | Train Acc: 0.9497
 Site-MNIST     | Train Loss: 0.1994 | Train Acc: 0.9408
 Site-MNIST     | Train Loss: 0.2138 | Train Acc: 0.9317
 Site-MNIST     | Train Loss: 0.1772 | Train Acc: 0.9501
 Site-USPS      | Train Loss: 0.2299 | Train Acc: 0.9257
 Site-USPS      | Train Loss: 0.2225 | Train Acc: 0.9265
 Site-USPS      | Train Loss: 0.2187 | Train Acc: 0.9244
 Site-SynthDigits| Train Loss: 0.3824 | Train Acc: 0.8826
 Site-SynthDigits| Train Loss: 0.3095 | Train Acc: 0.9129
 Site-MNIST-M   | Train Loss: 0.5795 | Train Acc: 0.8324
 Site-MNIST-M   | Train Loss: 0.5668 | Train Acc: 0.8466
 Site-SVHN      | Train Loss: 0.7248 | Train Acc: 0.7598
 Site-MNIST     | Val  Loss: 0.1369 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1465 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1803 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2455 | Val  Acc: 0.9368
 Site-MNIST     | Val  Loss: 0.2037 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.1757 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2276 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2626 | Val  Acc: 0.8803
 Site-SynthDigits| Val  Loss: 0.5183 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2901 | Val  Acc: 0.9040
 Site-MNIST-M   | Val  Loss: 0.5412 | Val  Acc: 0.8523
 Site-MNIST-M   | Val  Loss: 0.6873 | Val  Acc: 0.8030
 Site-SVHN      | Val  Loss: 0.7139 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8938
Aggregated Acc | Val Acc: 0.8600
============ Train epoch 45 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1765 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.1964 | Train Acc: 0.9586
 Site-MNIST     | Train Loss: 0.1902 | Train Acc: 0.9487
 Site-MNIST     | Train Loss: 0.2050 | Train Acc: 0.9396
 Site-MNIST     | Train Loss: 0.1694 | Train Acc: 0.9510
 Site-USPS      | Train Loss: 0.2384 | Train Acc: 0.9257
 Site-USPS      | Train Loss: 0.2284 | Train Acc: 0.9329
 Site-USPS      | Train Loss: 0.2183 | Train Acc: 0.9329
 Site-SynthDigits| Train Loss: 0.3685 | Train Acc: 0.8826
 Site-SynthDigits| Train Loss: 0.3206 | Train Acc: 0.9154
 Site-MNIST-M   | Train Loss: 0.5183 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5472 | Train Acc: 0.8485
 Site-SVHN      | Train Loss: 0.7507 | Train Acc: 0.7598
 Site-MNIST     | Val  Loss: 0.1287 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1421 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1725 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2366 | Val  Acc: 0.9421
 Site-MNIST     | Val  Loss: 0.1963 | Val  Acc: 0.9509
 Site-USPS      | Val  Loss: 0.1762 | Val  Acc: 0.9327
 Site-USPS      | Val  Loss: 0.2255 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2595 | Val  Acc: 0.8932
 Site-SynthDigits| Val  Loss: 0.4971 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2875 | Val  Acc: 0.9141
 Site-MNIST-M   | Val  Loss: 0.5340 | Val  Acc: 0.8409
 Site-MNIST-M   | Val  Loss: 0.6673 | Val  Acc: 0.8106
 Site-SVHN      | Val  Loss: 0.7234 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8936
Aggregated Acc | Val Acc: 0.8571
 Test site-MNIST     | Epoch:42 | Test Acc: 0.9409
 Test site-USPS      | Epoch:42 | Test Acc: 0.9323
 Test site-SynthDigits| Epoch:42 | Test Acc: 0.8887
 Test site-MNIST-M   | Epoch:42 | Test Acc: 0.7451
 Test site-SVHN      | Epoch:42 | Test Acc: 0.6768
Average Test Accuracy: 0.8368
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1830 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1883 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.1909 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2033 | Train Acc: 0.9382
 Site-MNIST     | Train Loss: 0.1685 | Train Acc: 0.9518
 Site-USPS      | Train Loss: 0.2321 | Train Acc: 0.9161
 Site-USPS      | Train Loss: 0.2208 | Train Acc: 0.9329
 Site-USPS      | Train Loss: 0.2163 | Train Acc: 0.9297
 Site-SynthDigits| Train Loss: 0.4017 | Train Acc: 0.8845
 Site-SynthDigits| Train Loss: 0.3045 | Train Acc: 0.9230
 Site-MNIST-M   | Train Loss: 0.5571 | Train Acc: 0.8097
 Site-MNIST-M   | Train Loss: 0.5588 | Train Acc: 0.8598
 Site-SVHN      | Train Loss: 0.7349 | Train Acc: 0.7683
 Site-MNIST     | Val  Loss: 0.1285 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1376 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1735 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2369 | Val  Acc: 0.9368
 Site-MNIST     | Val  Loss: 0.1966 | Val  Acc: 0.9474
 Site-USPS      | Val  Loss: 0.1647 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2253 | Val  Acc: 0.9103
 Site-USPS      | Val  Loss: 0.2611 | Val  Acc: 0.8889
 Site-SynthDigits| Val  Loss: 0.4889 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2824 | Val  Acc: 0.9141
 Site-MNIST-M   | Val  Loss: 0.5367 | Val  Acc: 0.8409
 Site-MNIST-M   | Val  Loss: 0.6537 | Val  Acc: 0.7955
 Site-SVHN      | Val  Loss: 0.7009 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8938
Aggregated Acc | Val Acc: 0.8606
 Test site-MNIST     | Epoch:45 | Test Acc: 0.9406
 Test site-USPS      | Epoch:45 | Test Acc: 0.9387
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.8908
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.7464
 Test site-SVHN      | Epoch:45 | Test Acc: 0.6799
Average Test Accuracy: 0.8393
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 47 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1991 | Train Acc: 0.9511
 Site-MNIST     | Train Loss: 0.1957 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.1942 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2069 | Train Acc: 0.9382
 Site-MNIST     | Train Loss: 0.1709 | Train Acc: 0.9510
 Site-USPS      | Train Loss: 0.2276 | Train Acc: 0.9305
 Site-USPS      | Train Loss: 0.2165 | Train Acc: 0.9345
 Site-USPS      | Train Loss: 0.2113 | Train Acc: 0.9425
 Site-SynthDigits| Train Loss: 0.3650 | Train Acc: 0.8996
 Site-SynthDigits| Train Loss: 0.3065 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5379 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.5300 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.6927 | Train Acc: 0.7734
 Site-MNIST     | Val  Loss: 0.1383 | Val  Acc: 0.9464
 Site-MNIST     | Val  Loss: 0.1442 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1742 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2409 | Val  Acc: 0.9421
 Site-MNIST     | Val  Loss: 0.2009 | Val  Acc: 0.9509
 Site-USPS      | Val  Loss: 0.1656 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2214 | Val  Acc: 0.9103
 Site-USPS      | Val  Loss: 0.2487 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.4949 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2826 | Val  Acc: 0.9192
 Site-MNIST-M   | Val  Loss: 0.5302 | Val  Acc: 0.8523
 Site-MNIST-M   | Val  Loss: 0.6605 | Val  Acc: 0.8182
 Site-SVHN      | Val  Loss: 0.6946 | Val  Acc: 0.7397
Average Valid Accuracy: 0.8981
Aggregated Acc | Val Acc: 0.8655
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9464
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9405
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9603
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9421
 Best site-MNIST      | Epoch:47 | Val Acc: 0.9509
 Best site-USPS       | Epoch:47 | Val Acc: 0.9423
 Best site-USPS       | Epoch:47 | Val Acc: 0.9103
 Best site-USPS       | Epoch:47 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.8561
 Best site-SynthDigits | Epoch:47 | Val Acc: 0.9192
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.8523
 Best site-MNIST-M    | Epoch:47 | Val Acc: 0.8182
 Best site-SVHN       | Epoch:47 | Val Acc: 0.7397
 Test site-MNIST     | Epoch:47 | Test Acc: 0.9389
 Test site-USPS      | Epoch:47 | Test Acc: 0.9376
 Test site-SynthDigits| Epoch:47 | Test Acc: 0.8897
 Test site-MNIST-M   | Epoch:47 | Test Acc: 0.7510
 Test site-SVHN      | Epoch:47 | Test Acc: 0.6782
Average Test Accuracy: 0.8391
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1747 | Train Acc: 0.9422
 Site-MNIST     | Train Loss: 0.1656 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.1840 | Train Acc: 0.9507
 Site-MNIST     | Train Loss: 0.1956 | Train Acc: 0.9382
 Site-MNIST     | Train Loss: 0.1629 | Train Acc: 0.9553
 Site-USPS      | Train Loss: 0.2225 | Train Acc: 0.9376
 Site-USPS      | Train Loss: 0.2079 | Train Acc: 0.9361
 Site-USPS      | Train Loss: 0.1959 | Train Acc: 0.9478
 Site-SynthDigits| Train Loss: 0.3781 | Train Acc: 0.8883
 Site-SynthDigits| Train Loss: 0.3042 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5406 | Train Acc: 0.8153
 Site-MNIST-M   | Train Loss: 0.5368 | Train Acc: 0.8617
 Site-SVHN      | Train Loss: 0.6704 | Train Acc: 0.7802
 Site-MNIST     | Val  Loss: 0.1209 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1299 | Val  Acc: 0.9643
 Site-MNIST     | Val  Loss: 0.1704 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2344 | Val  Acc: 0.9316
 Site-MNIST     | Val  Loss: 0.1948 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.1500 | Val  Acc: 0.9615
 Site-USPS      | Val  Loss: 0.2112 | Val  Acc: 0.9231
 Site-USPS      | Val  Loss: 0.2455 | Val  Acc: 0.8932
 Site-SynthDigits| Val  Loss: 0.4827 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2764 | Val  Acc: 0.9192
 Site-MNIST-M   | Val  Loss: 0.5377 | Val  Acc: 0.8295
 Site-MNIST-M   | Val  Loss: 0.6466 | Val  Acc: 0.8030
 Site-SVHN      | Val  Loss: 0.6880 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9003
Aggregated Acc | Val Acc: 0.8672
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9643
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9603
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9316
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9439
 Best site-USPS       | Epoch:48 | Val Acc: 0.9615
 Best site-USPS       | Epoch:48 | Val Acc: 0.9231
 Best site-USPS       | Epoch:48 | Val Acc: 0.8932
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8561
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9192
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.8295
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.8030
 Best site-SVHN       | Epoch:48 | Val Acc: 0.7534
 Test site-MNIST     | Epoch:48 | Test Acc: 0.9421
 Test site-USPS      | Epoch:48 | Test Acc: 0.9419
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.8901
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.7470
 Test site-SVHN      | Epoch:48 | Test Acc: 0.6775
Average Test Accuracy: 0.8397
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.1755 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.1894 | Train Acc: 0.9556
 Site-MNIST     | Train Loss: 0.1862 | Train Acc: 0.9467
 Site-MNIST     | Train Loss: 0.2004 | Train Acc: 0.9409
 Site-MNIST     | Train Loss: 0.1653 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2428 | Train Acc: 0.9329
 Site-USPS      | Train Loss: 0.2099 | Train Acc: 0.9361
 Site-USPS      | Train Loss: 0.2067 | Train Acc: 0.9382
 Site-SynthDigits| Train Loss: 0.3755 | Train Acc: 0.8788
 Site-SynthDigits| Train Loss: 0.2969 | Train Acc: 0.9230
 Site-MNIST-M   | Train Loss: 0.5345 | Train Acc: 0.8381
 Site-MNIST-M   | Train Loss: 0.5093 | Train Acc: 0.8655
 Site-SVHN      | Train Loss: 0.6910 | Train Acc: 0.7802
 Site-MNIST     | Val  Loss: 0.1286 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.1327 | Val  Acc: 0.9405
 Site-MNIST     | Val  Loss: 0.1730 | Val  Acc: 0.9603
 Site-MNIST     | Val  Loss: 0.2338 | Val  Acc: 0.9368
 Site-MNIST     | Val  Loss: 0.1950 | Val  Acc: 0.9439
 Site-USPS      | Val  Loss: 0.1530 | Val  Acc: 0.9423
 Site-USPS      | Val  Loss: 0.2113 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2441 | Val  Acc: 0.9060
 Site-SynthDigits| Val  Loss: 0.4804 | Val  Acc: 0.8561
 Site-SynthDigits| Val  Loss: 0.2709 | Val  Acc: 0.9192
 Site-MNIST-M   | Val  Loss: 0.5251 | Val  Acc: 0.8523
 Site-MNIST-M   | Val  Loss: 0.6511 | Val  Acc: 0.8106
 Site-SVHN      | Val  Loss: 0.6779 | Val  Acc: 0.7603
Average Valid Accuracy: 0.8980
Aggregated Acc | Val Acc: 0.8686
 Test site-MNIST     | Epoch:48 | Test Acc: 0.9413
 Test site-USPS      | Epoch:48 | Test Acc: 0.9366
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.8920
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.7483
 Test site-SVHN      | Epoch:48 | Test Acc: 0.6810
Average Test Accuracy: 0.8398
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_1/ccop_q=1...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.9413
 Test site-USPS      | Epoch:49 | Test Acc: 0.9366
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.8920
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.7483
 Test site-SVHN      | Epoch:49 | Test Acc: 0.6810
Average Test Accuracy: 0.8398
===2023-05-12 04:11:22===
===2023-05-12 04:11:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.9413
 Test site-USPS      | Epoch:49 | Test Acc: 0.9366
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.8920
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.7483
 Test site-SVHN      | Epoch:49 | Test Acc: 0.6810
Average Test Accuracy: 0.8398
===2023-05-13 16:20:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST           | Epoch:49 | Test Acc: 0.9409
 Test site-USPS            | Epoch:49 | Test Acc: 0.9280
 Test site-SynthDigits     | Epoch:49 | Test Acc: 0.8912
 Test site-MNIST-M         | Epoch:49 | Test Acc: 0.7269
 Test site-SVHN            | Epoch:49 | Test Acc: 0.6825
Average Test Accuracy: 0.8339
