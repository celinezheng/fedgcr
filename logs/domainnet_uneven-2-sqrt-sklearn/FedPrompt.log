===2023-03-31 01:29:16===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-2
cnt=[(4,)(3,)(6,)]
 Site-Clipart   | Train Loss: 1.9530 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9216 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8755 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.8898 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0154 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9962 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1936 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1156 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0590 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.0035 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2964 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.9009 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8681 | Train Acc: 0.5556
 Site-Clipart   | Val  Loss: 2.0369 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8193 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8019 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8729 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9410 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9952 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0508 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1509 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1978 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.0974 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2466 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9439 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9630 | Val  Acc: 0.5000
Average Valid Accuracy: 0.3956
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[(6,)(4,)(3,)]
 Site-Clipart   | Train Loss: 1.5144 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6105 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4732 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4339 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.6531 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.5896 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 2.0941 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.0355 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8731 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.5222 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.2818 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3473 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.4382 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6562 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3482 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.3649 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4845 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5984 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.6067 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9639 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9882 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1699 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.7369 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.2843 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.3931 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.7017 | Val  Acc: 0.4524
Average Valid Accuracy: 0.5201
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2143
 Best site-Real       | Epoch:1 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[(4,)(6,)(3,)]
 Site-Clipart   | Train Loss: 1.1903 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.3136 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.0779 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9041 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 1.3095 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2843 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8444 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.8177 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5246 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.1334 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.2181 | Train Acc: 0.2222
 Site-Real      | Train Loss: 1.0411 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1384 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2472 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9771 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0315 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9970 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2878 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1779 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6857 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6971 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9606 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3224 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1485 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0358 | Val  Acc: 0.7381
 Site-Sketch    | Val  Loss: 1.4268 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6447
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3095
 Best site-Real       | Epoch:2 | Val Acc: 0.7381
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[(4,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.8665 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.0382 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 0.7455 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7177 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9598 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9620 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.8826 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.5847 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4866 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 0.9257 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0248 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.7293 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.8663 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9466 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.6061 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7388 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8653 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9715 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9655 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6340 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5497 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9308 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.2246 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 2.0187 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7607 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0753 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6593
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2619
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[(4,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.6206 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8028 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.5801 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4513 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7332 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7407 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.6873 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5036 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2383 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7050 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9640 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.5681 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.7914 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.6861 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4462 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5162 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4805 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.8489 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.7220 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3421 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3485 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7877 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 0.9671 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9900 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5385 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9997 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7289
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3333
 Best site-Painting   | Epoch:4 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3333
 Best site-Real       | Epoch:4 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-2
client-12 is in G-1
cnt=[(4,)(6,)(3,)]
 Site-Clipart   | Train Loss: 0.4446 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6471 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4627 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3421 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5966 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6281 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.5254 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3308 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2317 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.5935 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7394 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.4618 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5545 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.5267 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4067 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4126 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3818 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6529 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5034 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1987 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3135 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7750 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 0.9092 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8548 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4117 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8149 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7454
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2381
 Best site-Painting   | Epoch:5 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3810
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
client-12 is in G-0
cnt=[(9,)(1,)(3,)]
 Site-Clipart   | Train Loss: 0.3843 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.4734 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4152 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2738 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4679 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5523 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.4184 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1409 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9435 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.5658 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.7523 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.4719 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5315 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.4581 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2641 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2150 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3216 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4477 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4109 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9705 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.9934 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4451 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9952 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.8022 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.3452 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7710 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7967
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4048
 Best site-Painting   | Epoch:6 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[(8,)(4,)(1,)]
 Site-Clipart   | Train Loss: 0.2599 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3272 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2302 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1789 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2997 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4595 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.2488 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0290 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.8469 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3635 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.7131 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.3185 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3576 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2571 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1816 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1730 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1992 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3657 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2856 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8719 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9773 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3107 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5756 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6570 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2766 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8341 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8370
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3810
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
client-12 is in G-0
cnt=[(10,)(1,)(2,)]
 Site-Clipart   | Train Loss: 0.2450 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3652 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2407 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2019 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3810 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3836 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2260 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9005 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8903 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3826 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.6326 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.2624 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4420 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3860 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1804 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2236 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1648 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3651 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3399 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8448 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8320 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4243 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6697 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.6777 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.2946 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7035 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8297
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
client-12 is in G-2
cnt=[(5,)(1,)(7,)]
 Site-Clipart   | Train Loss: 0.1455 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1935 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1394 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1127 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2952 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3155 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0485 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7677 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7463 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2346 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.5945 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.1968 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3119 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2276 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.0997 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1081 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1590 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2358 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1674 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7994 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8263 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.2324 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5389 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8541 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2350 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7963 | Val  Acc: 0.7619
Average Valid Accuracy: 0.8407
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5000
 Best site-Painting   | Epoch:9 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3810
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
===2023-03-31 02:04:22===
===2023-03-31 02:04:23===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8821
 Test site-Infograph | Epoch:9 | Test Acc: 0.4581
 Test site-Painting  | Epoch:9 | Test Acc: 0.8255
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3800
 Test site-Real      | Epoch:9 | Test Acc: 0.9113
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8087
Average Test Accuracy: 0.7110
===2023-03-31 02:13:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-0
client-12 is in G-1
cnt=[(2,)(6,)(5,)]
 Site-Clipart   | Train Loss: 1.9528 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9209 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8734 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8894 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0162 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9952 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1942 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1120 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0601 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 2.0017 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2958 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8958 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8669 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0359 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8200 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7983 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.8725 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9402 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9960 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0506 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1972 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.0997 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2457 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9416 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9597 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4011
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
===2023-03-31 02:19:28===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-0
client-12 is in G-1
cnt=[(2,)(6,)(5,)]
 Site-Clipart   | Train Loss: 1.9528 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.9209 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8734 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8894 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0162 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9952 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1942 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1120 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0601 | Train Acc: 0.3968
 Site-Painting  | Train Loss: 2.0017 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2958 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8958 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8669 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0359 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8200 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7983 | Val  Acc: 0.5952
 Site-Clipart   | Val  Loss: 1.8725 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9402 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9960 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0506 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1972 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.0997 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2457 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9416 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9597 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4011
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5952
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-0
client-12 is in G-0
cnt=[(7,)(3,)(3,)]
 Site-Clipart   | Train Loss: 1.5213 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.6151 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.4883 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4450 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.6392 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.5893 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.0876 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0399 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8525 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.5349 | Train Acc: 0.5873
 Site-QuickDraw | Train Loss: 2.2835 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3935 | Train Acc: 0.7460
 Site-Sketch    | Train Loss: 1.4470 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.6648 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3280 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.4001 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4970 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.6191 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.5908 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9615 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0076 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1378 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.7326 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.2979 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.4109 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.7177 | Val  Acc: 0.4762
Average Valid Accuracy: 0.5110
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[(6,)(4,)(3,)]
 Site-Clipart   | Train Loss: 1.2038 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3234 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.0727 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9147 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 1.3271 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.2993 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.8637 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8352 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5520 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.1454 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.1766 | Train Acc: 0.2540
 Site-Real      | Train Loss: 1.0221 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1255 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.2686 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9819 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.0334 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9902 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2732 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1932 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.7074 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.7174 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9881 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3368 | Val  Acc: 0.6429
 Site-QuickDraw | Val  Loss: 2.1226 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.0412 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.4006 | Val  Acc: 0.7143
Average Valid Accuracy: 0.6392
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.6429
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(3,)(7,)(3,)]
 Site-Clipart   | Train Loss: 0.8640 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0442 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 0.7649 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7151 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9691 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9618 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.8825 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.5983 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4815 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 0.9452 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0519 | Train Acc: 0.2698
 Site-Real      | Train Loss: 0.7450 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8896 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9532 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.6092 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7573 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8855 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.9769 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9734 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6321 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.5484 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9398 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.2270 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0103 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.7818 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0900 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6538
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2857
 Best site-Painting   | Epoch:3 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(3,)(7,)(3,)]
 Site-Clipart   | Train Loss: 0.6162 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.8070 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.5863 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4547 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7437 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7493 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6691 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4883 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2253 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.7167 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9899 | Train Acc: 0.2540
 Site-Real      | Train Loss: 0.5838 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 0.8280 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.6824 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4498 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5162 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4665 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.8605 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.7406 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3081 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3321 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7808 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.9883 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0195 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5520 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0224 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7234
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3095
 Best site-Painting   | Epoch:4 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2857
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(2,)(7,)(4,)]
 Site-Clipart   | Train Loss: 0.4309 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6016 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4471 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3256 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5734 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6133 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4760 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.2457 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.1702 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5881 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7757 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.4751 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5464 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4877 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3883 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3889 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3409 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5959 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4737 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.1224 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2283 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6505 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.8900 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.8846 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.4505 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8407 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7784
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2857
 Best site-Painting   | Epoch:5 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4048
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-0
client-12 is in G-1
cnt=[(5,)(7,)(1,)]
 Site-Clipart   | Train Loss: 0.4097 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5087 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4057 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2790 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5049 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5521 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.4305 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1954 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9796 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.5800 | Train Acc: 0.8413
 Site-QuickDraw | Train Loss: 1.5557 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.4251 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.5193 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4754 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2720 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2494 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3408 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4839 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4115 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 1.0388 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0298 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5326 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.9785 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.6380 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3205 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7623 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7949
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3810
 Best site-Painting   | Epoch:6 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.4048
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(3,)(9,)(1,)]
 Site-Clipart   | Train Loss: 0.2609 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3516 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2179 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1945 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3222 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4717 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2597 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0649 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8342 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3705 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.7781 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.3550 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.3742 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2720 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1899 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1660 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1883 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3850 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2901 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8867 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9119 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3494 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5556 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.7708 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.2677 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.8030 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8388
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(3,)(9,)(1,)]
 Site-Clipart   | Train Loss: 0.2240 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3513 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2189 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1407 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3419 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3169 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.1904 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9695 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9102 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3562 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5719 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2066 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3984 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.3435 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1373 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1998 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1656 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3564 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3039 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9548 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.9327 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3407 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6627 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.7143 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.2550 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6914 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8315
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[(4,)(8,)(1,)]
 Site-Clipart   | Train Loss: 0.1412 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2016 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1140 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2914 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3429 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0405 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.6946 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7071 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.2157 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.6055 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.2156 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3319 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2106 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1085 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1600 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2584 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1672 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7781 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.7710 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1742 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5086 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.8483 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2590 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7923 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8425
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Painting   | Epoch:9 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3571
 Best site-Real       | Epoch:9 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
===2023-03-31 02:54:26===
===2023-03-31 02:54:27===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8897
 Test site-Infograph | Epoch:9 | Test Acc: 0.4688
 Test site-Painting  | Epoch:9 | Test Acc: 0.8320
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3880
 Test site-Real      | Epoch:9 | Test Acc: 0.9096
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7888
Average Test Accuracy: 0.7128
===2023-03-31 10:56:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[(6,)(3,)(4,)]
 Site-Clipart   | Train Loss: 1.9518 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.9214 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8732 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8894 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0159 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9937 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1936 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1116 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0580 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.0034 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2972 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8974 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8663 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0345 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8189 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7997 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.8728 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9414 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9933 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0482 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1941 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.0985 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2451 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9417 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9612 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4029
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[(6,)(3,)(4,)]
 Site-Clipart   | Train Loss: 1.5138 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.6070 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4711 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.4338 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.6560 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.5912 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.0973 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.0332 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8716 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 1.5191 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.2818 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3386 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.4352 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.6574 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3495 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3618 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4844 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5940 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.6083 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9587 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9817 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1714 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.7408 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.2809 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3902 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.6952 | Val  Acc: 0.4524
Average Valid Accuracy: 0.5275
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2381
 Best site-Real       | Epoch:1 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-0
cnt=[(6,)(4,)(3,)]
 Site-Clipart   | Train Loss: 1.1912 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.3190 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.0834 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9120 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 1.3168 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3022 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8583 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.8291 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.5306 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.1343 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.2245 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.0366 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 1.1264 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.2471 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.9763 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0305 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9908 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.2902 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.1786 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6939 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7125 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0034 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 1.3320 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1482 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0407 | Val  Acc: 0.7619
 Site-Sketch    | Val  Loss: 1.4144 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6374
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3095
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.7619
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-0
cnt=[(6,)(4,)(3,)]
 Site-Clipart   | Train Loss: 0.8587 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0231 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 0.7472 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7076 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.9530 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 0.9570 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.8757 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.5709 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4902 | Train Acc: 0.4762
 Site-Painting  | Train Loss: 0.9187 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.0110 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.7304 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.8763 | Train Acc: 0.7460
 Site-Clipart   | Val  Loss: 0.9437 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.6028 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7278 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8676 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9609 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9484 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.6160 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.5270 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8970 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.2162 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.9924 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.7587 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0972 | Val  Acc: 0.6667
Average Valid Accuracy: 0.6612
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2619
 Best site-Painting   | Epoch:3 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[(5,)(4,)(4,)]
 Site-Clipart   | Train Loss: 0.6079 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7882 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.5561 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4528 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.7238 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7528 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.6654 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4750 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2224 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.7011 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9507 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.5714 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7797 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6685 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4457 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5074 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4549 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.8300 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.7174 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3270 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3359 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7576 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.9760 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.0251 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5353 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0000 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7509
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:4 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-Painting   | Epoch:4 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3333
 Best site-Real       | Epoch:4 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[(5,)(4,)(4,)]
 Site-Clipart   | Train Loss: 0.4478 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.6221 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.4368 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3253 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5606 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6110 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5292 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3065 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2218 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5704 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.7984 | Train Acc: 0.3968
 Site-Real      | Train Loss: 0.4291 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5080 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4953 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3837 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3869 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3511 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.6194 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4728 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.1979 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3004 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7070 | Val  Acc: 0.3095
 Site-Painting  | Val  Loss: 0.9037 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9082 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4081 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7785 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7656
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3095
 Best site-Painting   | Epoch:5 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3810
 Best site-Real       | Epoch:5 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:5 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-2
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[(5,)(4,)(4,)]
 Site-Clipart   | Train Loss: 0.3473 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4581 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3709 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2597 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4340 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5354 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.3935 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1431 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9437 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.5310 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.7827 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.4337 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.4822 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4201 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2388 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2119 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3122 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4392 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3874 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 1.0061 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.9709 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3690 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9576 | Val  Acc: 0.7143
 Site-QuickDraw | Val  Loss: 1.8387 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.3221 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7350 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5000
 Best site-Painting   | Epoch:6 | Val Acc: 0.7143
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
client-12 is in G-0
cnt=[(6,)(4,)(3,)]
 Site-Clipart   | Train Loss: 0.2961 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3606 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2405 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1925 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3141 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4676 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2671 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0888 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8831 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3473 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.6621 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.3281 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3479 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2777 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1984 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1857 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1949 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4204 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3068 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9040 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9766 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3899 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.5858 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.6426 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2356 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.8091 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8297
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4524
 Best site-Painting   | Epoch:7 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3571
 Best site-Real       | Epoch:7 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
client-12 is in G-0
cnt=[(7,)(4,)(2,)]
 Site-Clipart   | Train Loss: 0.2067 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3529 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2102 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1531 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3298 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3556 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1113 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8574 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.8472 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3555 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.5926 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.2276 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4218 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.3425 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1383 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2016 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1580 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3287 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2897 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8113 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8430 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2880 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.6451 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.7271 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2697 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7453 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8370
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Painting   | Epoch:8 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[(6,)(3,)(4,)]
 Site-Clipart   | Train Loss: 0.1480 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1779 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1204 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1054 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2827 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3267 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0290 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.6921 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.7266 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1945 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.6023 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.1905 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.2872 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1915 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1022 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1494 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2355 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1614 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7804 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7674 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0861 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5151 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.8798 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.2524 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7920 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8498
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Painting   | Epoch:9 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3810
 Best site-Real       | Epoch:9 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
===2023-03-31 11:31:09===
===2023-03-31 11:31:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8802
 Test site-Infograph | Epoch:9 | Test Acc: 0.4749
 Test site-Painting  | Epoch:9 | Test Acc: 0.8401
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.3850
 Test site-Real      | Epoch:9 | Test Acc: 0.9137
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8014
Average Test Accuracy: 0.7159
===2023-03-31 11:41:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[6, 3, 4, ]
 Site-Clipart   | Train Loss: 1.9518 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.9214 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8732 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8894 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0159 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9937 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1936 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1116 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0580 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.0034 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2972 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8974 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8663 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0345 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8189 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7997 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.8728 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9414 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9933 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0482 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1941 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.0985 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2451 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9417 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9612 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4029
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[6, 3, 4, ]
 Site-Clipart   | Train Loss: 1.5052 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.5856 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4519 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.4086 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.6343 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.5705 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.0718 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 2.0134 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8050 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.5084 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.2932 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3519 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.4263 | Train Acc: 0.6984
 Site-Clipart   | Val  Loss: 1.6397 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.3034 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3558 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4732 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.5594 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5760 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.9297 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9404 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.1647 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.7244 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.2860 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3910 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6897 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5275
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
===2023-03-31 11:48:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[6, 3, 4, ]
 Site-Clipart   | Train Loss: 1.9518 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.9214 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8732 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.8894 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 2.0159 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9937 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 2.1936 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1116 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0580 | Train Acc: 0.4127
 Site-Painting  | Train Loss: 2.0034 | Train Acc: 0.4444
 Site-QuickDraw | Train Loss: 2.2972 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.8974 | Train Acc: 0.5079
 Site-Sketch    | Train Loss: 1.8663 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 2.0345 | Val  Acc: 0.2381
 Site-Clipart   | Val  Loss: 1.8189 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.7997 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.8728 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.9414 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9933 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0482 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1941 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 2.0985 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2451 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9417 | Val  Acc: 0.5238
 Site-Sketch    | Val  Loss: 1.9612 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4029
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2381
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2381
 Best site-Real       | Epoch:0 | Val Acc: 0.5238
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[6, 3, 4, ]
 Site-Clipart   | Train Loss: 1.5018 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.5863 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4511 | Train Acc: 0.6190
 Site-Clipart   | Train Loss: 1.4044 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.6278 | Train Acc: 0.5079
 Site-Clipart   | Train Loss: 1.5684 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 2.0704 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 2.0136 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.8058 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.5104 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.2930 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.3608 | Train Acc: 0.7619
 Site-Sketch    | Train Loss: 1.4261 | Train Acc: 0.6825
 Site-Clipart   | Val  Loss: 1.6354 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.2914 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.3581 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.4707 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.5634 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5740 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9320 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9490 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.1567 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.7261 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.2906 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.3869 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.6930 | Val  Acc: 0.4762
Average Valid Accuracy: 0.5330
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
client-12 is in G-0
cnt=[6, 3, 4, ]
 Site-Clipart   | Train Loss: 1.1866 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.2718 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.0568 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8752 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 1.2859 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.2708 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8627 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.8042 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5241 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0737 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.2389 | Train Acc: 0.2222
 Site-Real      | Train Loss: 0.9897 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0911 | Train Acc: 0.7778
 Site-Clipart   | Val  Loss: 1.2079 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9289 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.9805 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9632 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 1.2329 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1462 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.6892 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7037 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9342 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.2900 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.1883 | Val  Acc: 0.2143
 Site-Real      | Val  Loss: 1.0031 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4055 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4524
 Best site-Painting   | Epoch:2 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2143
 Best site-Real       | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2-sqrt-sklearn/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
