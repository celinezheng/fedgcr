===2023-08-06 10:31:55===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
============ Train epoch 0 ============
 Site-RealWorld                     | Train Loss: 2.9414 | Train Acc: 0.1429
 Site-RealWorld                     | Train Loss: 2.9559 | Train Acc: 0.1111
 Site-RealWorld                     | Train Loss: 2.9950 | Train Acc: 0.0417
 Site-RealWorld                     | Train Loss: 2.9917 | Train Acc: 0.0645
 Site-RealWorld                     | Train Loss: 2.9681 | Train Acc: 0.1250
 Site-RealWorld                     | Train Loss: 2.9753 | Train Acc: 0.0392
 Site-RealWorld                     | Train Loss: 2.9804 | Train Acc: 0.0746
 Site-RealWorld                     | Train Loss: 2.9743 | Train Acc: 0.0698
 Site-RealWorld                     | Train Loss: 2.9560 | Train Acc: 0.0721
 Site-RealWorld                     | Train Loss: 2.9509 | Train Acc: 0.0903
 Site-Product                       | Train Loss: 2.9671 | Train Acc: 0.0588
 Site-Product                       | Train Loss: 2.9349 | Train Acc: 0.1250
 Site-Product                       | Train Loss: 2.9413 | Train Acc: 0.1212
 Site-Product                       | Train Loss: 2.9383 | Train Acc: 0.1522
 Site-Product                       | Train Loss: 2.9584 | Train Acc: 0.1094
 Site-Product                       | Train Loss: 2.9525 | Train Acc: 0.0899
 Site-Product                       | Train Loss: 2.9451 | Train Acc: 0.1129
 Site-amazon                        | Train Loss: 2.9745 | Train Acc: 0.1500
 Site-amazon                        | Train Loss: 2.9589 | Train Acc: 0.0968
 Site-amazon                        | Train Loss: 2.9598 | Train Acc: 0.0217
 Site-amazon                        | Train Loss: 2.9549 | Train Acc: 0.1014
 Site-amazon                        | Train Loss: 2.9688 | Train Acc: 0.1154
 Site-webcam                        | Train Loss: 2.9352 | Train Acc: 0.2188
 Site-webcam                        | Train Loss: 2.9787 | Train Acc: 0.0893
 Site-webcam                        | Train Loss: 2.9588 | Train Acc: 0.0722
 Site-Art                           | Train Loss: 2.9883 | Train Acc: 0.0476
 Site-Art                           | Train Loss: 2.9662 | Train Acc: 0.0714
 Site-Clipart                       | Train Loss: 2.9597 | Train Acc: 0.0941
 Site-dslr                          | Train Loss: 2.9441 | Train Acc: 0.1552
Average Train Accuracy: 0.0977
 Site-RealWorld                     | Val  Loss: 2.9879 | Val  Acc: 0.0000
 Site-RealWorld                     | Val  Loss: 2.9330 | Val  Acc: 0.1667
 Site-RealWorld                     | Val  Loss: 2.9607 | Val  Acc: 0.1250
 Site-RealWorld                     | Val  Loss: 2.9861 | Val  Acc: 0.0000
 Site-RealWorld                     | Val  Loss: 2.9865 | Val  Acc: 0.0385
 Site-RealWorld                     | Val  Loss: 2.9815 | Val  Acc: 0.0882
 Site-RealWorld                     | Val  Loss: 2.9525 | Val  Acc: 0.0909
 Site-RealWorld                     | Val  Loss: 2.9699 | Val  Acc: 0.0702
 Site-RealWorld                     | Val  Loss: 2.9735 | Val  Acc: 0.0405
 Site-RealWorld                     | Val  Loss: 2.9675 | Val  Acc: 0.0521
 Site-Product                       | Val  Loss: 2.9343 | Val  Acc: 0.0000
 Site-Product                       | Val  Loss: 2.9739 | Val  Acc: 0.0625
 Site-Product                       | Val  Loss: 3.0003 | Val  Acc: 0.0000
 Site-Product                       | Val  Loss: 2.9868 | Val  Acc: 0.0323
 Site-Product                       | Val  Loss: 2.9463 | Val  Acc: 0.0930
 Site-Product                       | Val  Loss: 2.9710 | Val  Acc: 0.0678
 Site-Product                       | Val  Loss: 2.9513 | Val  Acc: 0.1463
 Site-amazon                        | Val  Loss: 2.9827 | Val  Acc: 0.0000
 Site-amazon                        | Val  Loss: 2.9912 | Val  Acc: 0.0000
 Site-amazon                        | Val  Loss: 2.9634 | Val  Acc: 0.0968
 Site-amazon                        | Val  Loss: 2.9472 | Val  Acc: 0.1304
 Site-amazon                        | Val  Loss: 2.9572 | Val  Acc: 0.0580
 Site-webcam                        | Val  Loss: 2.9563 | Val  Acc: 0.0476
 Site-webcam                        | Val  Loss: 2.9663 | Val  Acc: 0.0270
 Site-webcam                        | Val  Loss: 2.9635 | Val  Acc: 0.0469
 Site-Art                           | Val  Loss: 2.9724 | Val  Acc: 0.0714
 Site-Art                           | Val  Loss: 2.9814 | Val  Acc: 0.1071
 Site-Clipart                       | Val  Loss: 2.9397 | Val  Acc: 0.1228
 Site-dslr                          | Val  Loss: 2.9510 | Val  Acc: 0.1053
Average Valid Accuracy: 0.0651
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1667
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1250
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0385
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0882
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0909
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0702
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0405
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0521
 Best site-Product                   | Epoch:0 | Val Acc: 0.0000
 Best site-Product                   | Epoch:0 | Val Acc: 0.0625
 Best site-Product                   | Epoch:0 | Val Acc: 0.0000
 Best site-Product                   | Epoch:0 | Val Acc: 0.0323
 Best site-Product                   | Epoch:0 | Val Acc: 0.0930
 Best site-Product                   | Epoch:0 | Val Acc: 0.0678
 Best site-Product                   | Epoch:0 | Val Acc: 0.1463
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0000
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0000
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0968
 Best site-amazon                    | Epoch:0 | Val Acc: 0.1304
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0580
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0476
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0270
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0469
 Best site-Art                       | Epoch:0 | Val Acc: 0.0714
 Best site-Art                       | Epoch:0 | Val Acc: 0.1071
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.1228
 Best site-dslr                      | Epoch:0 | Val Acc: 0.1053
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 1 ============
 Site-RealWorld                     | Train Loss: 2.8994 | Train Acc: 0.2143
 Site-RealWorld                     | Train Loss: 2.9008 | Train Acc: 0.1667
 Site-RealWorld                     | Train Loss: 2.9337 | Train Acc: 0.1250
 Site-RealWorld                     | Train Loss: 2.9434 | Train Acc: 0.1613
 Site-RealWorld                     | Train Loss: 2.9101 | Train Acc: 0.1500
 Site-RealWorld                     | Train Loss: 2.9207 | Train Acc: 0.1765
 Site-RealWorld                     | Train Loss: 2.9095 | Train Acc: 0.1343
 Site-RealWorld                     | Train Loss: 2.9004 | Train Acc: 0.2093
 Site-RealWorld                     | Train Loss: 2.9063 | Train Acc: 0.2252
 Site-RealWorld                     | Train Loss: 2.8983 | Train Acc: 0.2292
 Site-Product                       | Train Loss: 2.9113 | Train Acc: 0.0588
 Site-Product                       | Train Loss: 2.8842 | Train Acc: 0.3750
 Site-Product                       | Train Loss: 2.8946 | Train Acc: 0.1212
 Site-Product                       | Train Loss: 2.8930 | Train Acc: 0.2174
 Site-Product                       | Train Loss: 2.9096 | Train Acc: 0.1562
 Site-Product                       | Train Loss: 2.9058 | Train Acc: 0.1910
 Site-Product                       | Train Loss: 2.8857 | Train Acc: 0.2581
 Site-amazon                        | Train Loss: 2.9022 | Train Acc: 0.1500
 Site-amazon                        | Train Loss: 2.8853 | Train Acc: 0.2903
 Site-amazon                        | Train Loss: 2.8998 | Train Acc: 0.1522
 Site-amazon                        | Train Loss: 2.9165 | Train Acc: 0.1739
 Site-amazon                        | Train Loss: 2.9122 | Train Acc: 0.2500
 Site-webcam                        | Train Loss: 2.8886 | Train Acc: 0.2812
 Site-webcam                        | Train Loss: 2.9172 | Train Acc: 0.1607
 Site-webcam                        | Train Loss: 2.9070 | Train Acc: 0.1753
 Site-Art                           | Train Loss: 2.9435 | Train Acc: 0.0952
 Site-Art                           | Train Loss: 2.9283 | Train Acc: 0.1548
 Site-Clipart                       | Train Loss: 2.9144 | Train Acc: 0.1176
 Site-dslr                          | Train Loss: 2.8830 | Train Acc: 0.2759
Average Train Accuracy: 0.1878
 Site-RealWorld                     | Val  Loss: 2.9304 | Val  Acc: 0.1111
 Site-RealWorld                     | Val  Loss: 2.8977 | Val  Acc: 0.2500
 Site-RealWorld                     | Val  Loss: 2.8868 | Val  Acc: 0.2500
 Site-RealWorld                     | Val  Loss: 2.9112 | Val  Acc: 0.3000
 Site-RealWorld                     | Val  Loss: 2.9297 | Val  Acc: 0.0385
 Site-RealWorld                     | Val  Loss: 2.9344 | Val  Acc: 0.1176
 Site-RealWorld                     | Val  Loss: 2.8952 | Val  Acc: 0.2045
 Site-RealWorld                     | Val  Loss: 2.9108 | Val  Acc: 0.1930
 Site-RealWorld                     | Val  Loss: 2.9134 | Val  Acc: 0.2297
 Site-RealWorld                     | Val  Loss: 2.9043 | Val  Acc: 0.2292
 Site-Product                       | Val  Loss: 2.9084 | Val  Acc: 0.3636
 Site-Product                       | Val  Loss: 2.9080 | Val  Acc: 0.2500
 Site-Product                       | Val  Loss: 2.9295 | Val  Acc: 0.1364
 Site-Product                       | Val  Loss: 2.9333 | Val  Acc: 0.1613
 Site-Product                       | Val  Loss: 2.9002 | Val  Acc: 0.2558
 Site-Product                       | Val  Loss: 2.9193 | Val  Acc: 0.1525
 Site-Product                       | Val  Loss: 2.9066 | Val  Acc: 0.2195
 Site-amazon                        | Val  Loss: 2.9197 | Val  Acc: 0.0000
 Site-amazon                        | Val  Loss: 2.9305 | Val  Acc: 0.2000
 Site-amazon                        | Val  Loss: 2.8980 | Val  Acc: 0.1935
 Site-amazon                        | Val  Loss: 2.8866 | Val  Acc: 0.2609
 Site-amazon                        | Val  Loss: 2.9168 | Val  Acc: 0.1739
 Site-webcam                        | Val  Loss: 2.9189 | Val  Acc: 0.0952
 Site-webcam                        | Val  Loss: 2.8947 | Val  Acc: 0.2162
 Site-webcam                        | Val  Loss: 2.9124 | Val  Acc: 0.1562
 Site-Art                           | Val  Loss: 2.9317 | Val  Acc: 0.2500
 Site-Art                           | Val  Loss: 2.9314 | Val  Acc: 0.1964
 Site-Clipart                       | Val  Loss: 2.8974 | Val  Acc: 0.2105
 Site-dslr                          | Val  Loss: 2.8868 | Val  Acc: 0.2632
Average Valid Accuracy: 0.1958
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.1111
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2500
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2500
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.0385
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.1176
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2045
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.1930
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2297
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2292
 Best site-Product                   | Epoch:1 | Val Acc: 0.3636
 Best site-Product                   | Epoch:1 | Val Acc: 0.2500
 Best site-Product                   | Epoch:1 | Val Acc: 0.1364
 Best site-Product                   | Epoch:1 | Val Acc: 0.1613
 Best site-Product                   | Epoch:1 | Val Acc: 0.2558
 Best site-Product                   | Epoch:1 | Val Acc: 0.1525
 Best site-Product                   | Epoch:1 | Val Acc: 0.2195
 Best site-amazon                    | Epoch:1 | Val Acc: 0.0000
 Best site-amazon                    | Epoch:1 | Val Acc: 0.2000
 Best site-amazon                    | Epoch:1 | Val Acc: 0.1935
 Best site-amazon                    | Epoch:1 | Val Acc: 0.2609
 Best site-amazon                    | Epoch:1 | Val Acc: 0.1739
 Best site-webcam                    | Epoch:1 | Val Acc: 0.0952
 Best site-webcam                    | Epoch:1 | Val Acc: 0.2162
 Best site-webcam                    | Epoch:1 | Val Acc: 0.1562
 Best site-Art                       | Epoch:1 | Val Acc: 0.2500
 Best site-Art                       | Epoch:1 | Val Acc: 0.1964
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.2105
 Best site-dslr                      | Epoch:1 | Val Acc: 0.2632
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 2 ============
 Site-RealWorld                     | Train Loss: 2.8329 | Train Acc: 0.2143
 Site-RealWorld                     | Train Loss: 2.8304 | Train Acc: 0.2778
 Site-RealWorld                     | Train Loss: 2.8815 | Train Acc: 0.3750
 Site-RealWorld                     | Train Loss: 2.8790 | Train Acc: 0.2581
 Site-RealWorld                     | Train Loss: 2.8546 | Train Acc: 0.3000
 Site-RealWorld                     | Train Loss: 2.8616 | Train Acc: 0.3922
 Site-RealWorld                     | Train Loss: 2.8266 | Train Acc: 0.3433
 Site-RealWorld                     | Train Loss: 2.8499 | Train Acc: 0.3953
 Site-RealWorld                     | Train Loss: 2.8502 | Train Acc: 0.3604
 Site-RealWorld                     | Train Loss: 2.8137 | Train Acc: 0.4514
 Site-Product                       | Train Loss: 2.8298 | Train Acc: 0.4706
 Site-Product                       | Train Loss: 2.8386 | Train Acc: 0.4583
 Site-Product                       | Train Loss: 2.8453 | Train Acc: 0.4242
 Site-Product                       | Train Loss: 2.8376 | Train Acc: 0.3696
 Site-Product                       | Train Loss: 2.8517 | Train Acc: 0.3594
 Site-Product                       | Train Loss: 2.8610 | Train Acc: 0.3820
 Site-Product                       | Train Loss: 2.8401 | Train Acc: 0.4355
 Site-amazon                        | Train Loss: 2.8558 | Train Acc: 0.3500
 Site-amazon                        | Train Loss: 2.8460 | Train Acc: 0.4839
 Site-amazon                        | Train Loss: 2.8389 | Train Acc: 0.4565
 Site-amazon                        | Train Loss: 2.8563 | Train Acc: 0.3768
 Site-amazon                        | Train Loss: 2.8610 | Train Acc: 0.3942
 Site-webcam                        | Train Loss: 2.8424 | Train Acc: 0.4062
 Site-webcam                        | Train Loss: 2.8573 | Train Acc: 0.4107
 Site-webcam                        | Train Loss: 2.8589 | Train Acc: 0.3608
 Site-Art                           | Train Loss: 2.8869 | Train Acc: 0.1667
 Site-Art                           | Train Loss: 2.8811 | Train Acc: 0.2500
 Site-Clipart                       | Train Loss: 2.8883 | Train Acc: 0.2941
 Site-dslr                          | Train Loss: 2.8384 | Train Acc: 0.4483
Average Train Accuracy: 0.3678
 Site-RealWorld                     | Val  Loss: 2.8469 | Val  Acc: 0.4444
 Site-RealWorld                     | Val  Loss: 2.8463 | Val  Acc: 0.3333
 Site-RealWorld                     | Val  Loss: 2.8607 | Val  Acc: 0.5000
 Site-RealWorld                     | Val  Loss: 2.8911 | Val  Acc: 0.3500
 Site-RealWorld                     | Val  Loss: 2.8819 | Val  Acc: 0.2308
 Site-RealWorld                     | Val  Loss: 2.8672 | Val  Acc: 0.3235
 Site-RealWorld                     | Val  Loss: 2.8415 | Val  Acc: 0.4318
 Site-RealWorld                     | Val  Loss: 2.8522 | Val  Acc: 0.3684
 Site-RealWorld                     | Val  Loss: 2.8693 | Val  Acc: 0.3919
 Site-RealWorld                     | Val  Loss: 2.8553 | Val  Acc: 0.3958
 Site-Product                       | Val  Loss: 2.8255 | Val  Acc: 0.4545
 Site-Product                       | Val  Loss: 2.8364 | Val  Acc: 0.5625
 Site-Product                       | Val  Loss: 2.8597 | Val  Acc: 0.4545
 Site-Product                       | Val  Loss: 2.8624 | Val  Acc: 0.4194
 Site-Product                       | Val  Loss: 2.8456 | Val  Acc: 0.3721
 Site-Product                       | Val  Loss: 2.8569 | Val  Acc: 0.3729
 Site-Product                       | Val  Loss: 2.8418 | Val  Acc: 0.3902
 Site-amazon                        | Val  Loss: 2.8754 | Val  Acc: 0.3846
 Site-amazon                        | Val  Loss: 2.8934 | Val  Acc: 0.2500
 Site-amazon                        | Val  Loss: 2.8453 | Val  Acc: 0.3871
 Site-amazon                        | Val  Loss: 2.8178 | Val  Acc: 0.5000
 Site-amazon                        | Val  Loss: 2.8632 | Val  Acc: 0.4203
 Site-webcam                        | Val  Loss: 2.8664 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 2.8711 | Val  Acc: 0.3243
 Site-webcam                        | Val  Loss: 2.8567 | Val  Acc: 0.3906
 Site-Art                           | Val  Loss: 2.8673 | Val  Acc: 0.3929
 Site-Art                           | Val  Loss: 2.8838 | Val  Acc: 0.3036
 Site-Clipart                       | Val  Loss: 2.8568 | Val  Acc: 0.3333
 Site-dslr                          | Val  Loss: 2.8168 | Val  Acc: 0.4474
Average Valid Accuracy: 0.3884
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.4444
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3333
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.5000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3500
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.2308
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3235
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.4318
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3684
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3919
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3958
 Best site-Product                   | Epoch:2 | Val Acc: 0.4545
 Best site-Product                   | Epoch:2 | Val Acc: 0.5625
 Best site-Product                   | Epoch:2 | Val Acc: 0.4545
 Best site-Product                   | Epoch:2 | Val Acc: 0.4194
 Best site-Product                   | Epoch:2 | Val Acc: 0.3721
 Best site-Product                   | Epoch:2 | Val Acc: 0.3729
 Best site-Product                   | Epoch:2 | Val Acc: 0.3902
 Best site-amazon                    | Epoch:2 | Val Acc: 0.3846
 Best site-amazon                    | Epoch:2 | Val Acc: 0.2500
 Best site-amazon                    | Epoch:2 | Val Acc: 0.3871
 Best site-amazon                    | Epoch:2 | Val Acc: 0.5000
 Best site-amazon                    | Epoch:2 | Val Acc: 0.4203
 Best site-webcam                    | Epoch:2 | Val Acc: 0.3333
 Best site-webcam                    | Epoch:2 | Val Acc: 0.3243
 Best site-webcam                    | Epoch:2 | Val Acc: 0.3906
 Best site-Art                       | Epoch:2 | Val Acc: 0.3929
 Best site-Art                       | Epoch:2 | Val Acc: 0.3036
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.3333
 Best site-dslr                      | Epoch:2 | Val Acc: 0.4474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 3 ============
 Site-RealWorld                     | Train Loss: 2.7821 | Train Acc: 0.5000
 Site-RealWorld                     | Train Loss: 2.7874 | Train Acc: 0.4444
 Site-RealWorld                     | Train Loss: 2.8471 | Train Acc: 0.3750
 Site-RealWorld                     | Train Loss: 2.8345 | Train Acc: 0.3548
 Site-RealWorld                     | Train Loss: 2.7989 | Train Acc: 0.5250
 Site-RealWorld                     | Train Loss: 2.8118 | Train Acc: 0.5686
 Site-RealWorld                     | Train Loss: 2.8165 | Train Acc: 0.4627
 Site-RealWorld                     | Train Loss: 2.8090 | Train Acc: 0.5930
 Site-RealWorld                     | Train Loss: 2.7945 | Train Acc: 0.5405
 Site-RealWorld                     | Train Loss: 2.7720 | Train Acc: 0.6250
 Site-Product                       | Train Loss: 2.7894 | Train Acc: 0.7647
 Site-Product                       | Train Loss: 2.7939 | Train Acc: 0.5000
 Site-Product                       | Train Loss: 2.8075 | Train Acc: 0.5152
 Site-Product                       | Train Loss: 2.7857 | Train Acc: 0.5217
 Site-Product                       | Train Loss: 2.7955 | Train Acc: 0.5469
 Site-Product                       | Train Loss: 2.8075 | Train Acc: 0.5843
 Site-Product                       | Train Loss: 2.7748 | Train Acc: 0.5726
 Site-amazon                        | Train Loss: 2.7877 | Train Acc: 0.4500
 Site-amazon                        | Train Loss: 2.7763 | Train Acc: 0.5806
 Site-amazon                        | Train Loss: 2.7954 | Train Acc: 0.5652
 Site-amazon                        | Train Loss: 2.7885 | Train Acc: 0.6377
 Site-amazon                        | Train Loss: 2.8177 | Train Acc: 0.5865
 Site-webcam                        | Train Loss: 2.7774 | Train Acc: 0.7188
 Site-webcam                        | Train Loss: 2.7935 | Train Acc: 0.5000
 Site-webcam                        | Train Loss: 2.8066 | Train Acc: 0.5773
 Site-Art                           | Train Loss: 2.8606 | Train Acc: 0.2857
 Site-Art                           | Train Loss: 2.8539 | Train Acc: 0.3571
 Site-Clipart                       | Train Loss: 2.8391 | Train Acc: 0.3412
 Site-dslr                          | Train Loss: 2.7718 | Train Acc: 0.6379
Average Train Accuracy: 0.5253
 Site-RealWorld                     | Val  Loss: 2.8136 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.7838 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.7858 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 2.8241 | Val  Acc: 0.5000
 Site-RealWorld                     | Val  Loss: 2.8282 | Val  Acc: 0.3846
 Site-RealWorld                     | Val  Loss: 2.8106 | Val  Acc: 0.5294
 Site-RealWorld                     | Val  Loss: 2.7938 | Val  Acc: 0.5455
 Site-RealWorld                     | Val  Loss: 2.8045 | Val  Acc: 0.5614
 Site-RealWorld                     | Val  Loss: 2.8310 | Val  Acc: 0.4595
 Site-RealWorld                     | Val  Loss: 2.8029 | Val  Acc: 0.4896
 Site-Product                       | Val  Loss: 2.7557 | Val  Acc: 0.6364
 Site-Product                       | Val  Loss: 2.7825 | Val  Acc: 0.5625
 Site-Product                       | Val  Loss: 2.7973 | Val  Acc: 0.5909
 Site-Product                       | Val  Loss: 2.7916 | Val  Acc: 0.5484
 Site-Product                       | Val  Loss: 2.8000 | Val  Acc: 0.5581
 Site-Product                       | Val  Loss: 2.7893 | Val  Acc: 0.5763
 Site-Product                       | Val  Loss: 2.7885 | Val  Acc: 0.5732
 Site-amazon                        | Val  Loss: 2.8300 | Val  Acc: 0.4615
 Site-amazon                        | Val  Loss: 2.8420 | Val  Acc: 0.4000
 Site-amazon                        | Val  Loss: 2.7949 | Val  Acc: 0.5806
 Site-amazon                        | Val  Loss: 2.7838 | Val  Acc: 0.6739
 Site-amazon                        | Val  Loss: 2.8098 | Val  Acc: 0.6232
 Site-webcam                        | Val  Loss: 2.8015 | Val  Acc: 0.5238
 Site-webcam                        | Val  Loss: 2.8258 | Val  Acc: 0.5135
 Site-webcam                        | Val  Loss: 2.7983 | Val  Acc: 0.5781
 Site-Art                           | Val  Loss: 2.8228 | Val  Acc: 0.3929
 Site-Art                           | Val  Loss: 2.8370 | Val  Acc: 0.4464
 Site-Clipart                       | Val  Loss: 2.8172 | Val  Acc: 0.4737
 Site-dslr                          | Val  Loss: 2.7628 | Val  Acc: 0.6579
Average Valid Accuracy: 0.5513
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.8125
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.5000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.3846
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.5294
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.5455
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.5614
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.4595
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.4896
 Best site-Product                   | Epoch:3 | Val Acc: 0.6364
 Best site-Product                   | Epoch:3 | Val Acc: 0.5625
 Best site-Product                   | Epoch:3 | Val Acc: 0.5909
 Best site-Product                   | Epoch:3 | Val Acc: 0.5484
 Best site-Product                   | Epoch:3 | Val Acc: 0.5581
 Best site-Product                   | Epoch:3 | Val Acc: 0.5763
 Best site-Product                   | Epoch:3 | Val Acc: 0.5732
 Best site-amazon                    | Epoch:3 | Val Acc: 0.4615
 Best site-amazon                    | Epoch:3 | Val Acc: 0.4000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.5806
 Best site-amazon                    | Epoch:3 | Val Acc: 0.6739
 Best site-amazon                    | Epoch:3 | Val Acc: 0.6232
 Best site-webcam                    | Epoch:3 | Val Acc: 0.5238
 Best site-webcam                    | Epoch:3 | Val Acc: 0.5135
 Best site-webcam                    | Epoch:3 | Val Acc: 0.5781
 Best site-Art                       | Epoch:3 | Val Acc: 0.3929
 Best site-Art                       | Epoch:3 | Val Acc: 0.4464
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.4737
 Best site-dslr                      | Epoch:3 | Val Acc: 0.6579
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 4 ============
 Site-RealWorld                     | Train Loss: 2.7323 | Train Acc: 0.7143
 Site-RealWorld                     | Train Loss: 2.7386 | Train Acc: 0.5556
 Site-RealWorld                     | Train Loss: 2.7749 | Train Acc: 0.5000
 Site-RealWorld                     | Train Loss: 2.7892 | Train Acc: 0.5161
 Site-RealWorld                     | Train Loss: 2.7417 | Train Acc: 0.6250
 Site-RealWorld                     | Train Loss: 2.7533 | Train Acc: 0.5686
 Site-RealWorld                     | Train Loss: 2.7659 | Train Acc: 0.5970
 Site-RealWorld                     | Train Loss: 2.7408 | Train Acc: 0.7093
 Site-RealWorld                     | Train Loss: 2.7421 | Train Acc: 0.7207
 Site-RealWorld                     | Train Loss: 2.7109 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.7259 | Train Acc: 0.7647
 Site-Product                       | Train Loss: 2.7583 | Train Acc: 0.5833
 Site-Product                       | Train Loss: 2.7443 | Train Acc: 0.6364
 Site-Product                       | Train Loss: 2.7137 | Train Acc: 0.7174
 Site-Product                       | Train Loss: 2.7367 | Train Acc: 0.7344
 Site-Product                       | Train Loss: 2.7402 | Train Acc: 0.6742
 Site-Product                       | Train Loss: 2.7299 | Train Acc: 0.6855
 Site-amazon                        | Train Loss: 2.7216 | Train Acc: 0.6000
 Site-amazon                        | Train Loss: 2.7065 | Train Acc: 0.7742
 Site-amazon                        | Train Loss: 2.7374 | Train Acc: 0.6739
 Site-amazon                        | Train Loss: 2.7175 | Train Acc: 0.7101
 Site-amazon                        | Train Loss: 2.7555 | Train Acc: 0.6731
 Site-webcam                        | Train Loss: 2.7532 | Train Acc: 0.6875
 Site-webcam                        | Train Loss: 2.7391 | Train Acc: 0.6607
 Site-webcam                        | Train Loss: 2.7565 | Train Acc: 0.5979
 Site-Art                           | Train Loss: 2.8319 | Train Acc: 0.3810
 Site-Art                           | Train Loss: 2.7946 | Train Acc: 0.4524
 Site-Clipart                       | Train Loss: 2.7948 | Train Acc: 0.4706
 Site-dslr                          | Train Loss: 2.7110 | Train Acc: 0.7586
Average Train Accuracy: 0.6377
 Site-RealWorld                     | Val  Loss: 2.7018 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 2.7346 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 2.7285 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 2.7903 | Val  Acc: 0.6000
 Site-RealWorld                     | Val  Loss: 2.7698 | Val  Acc: 0.5769
 Site-RealWorld                     | Val  Loss: 2.7596 | Val  Acc: 0.5882
 Site-RealWorld                     | Val  Loss: 2.7306 | Val  Acc: 0.7045
 Site-RealWorld                     | Val  Loss: 2.7490 | Val  Acc: 0.6842
 Site-RealWorld                     | Val  Loss: 2.7657 | Val  Acc: 0.5405
 Site-RealWorld                     | Val  Loss: 2.7527 | Val  Acc: 0.6042
 Site-Product                       | Val  Loss: 2.7223 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 2.7406 | Val  Acc: 0.6250
 Site-Product                       | Val  Loss: 2.7194 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 2.7512 | Val  Acc: 0.6452
 Site-Product                       | Val  Loss: 2.7508 | Val  Acc: 0.6977
 Site-Product                       | Val  Loss: 2.7409 | Val  Acc: 0.6271
 Site-Product                       | Val  Loss: 2.7313 | Val  Acc: 0.6829
 Site-amazon                        | Val  Loss: 2.7798 | Val  Acc: 0.4615
 Site-amazon                        | Val  Loss: 2.7894 | Val  Acc: 0.5000
 Site-amazon                        | Val  Loss: 2.7428 | Val  Acc: 0.6129
 Site-amazon                        | Val  Loss: 2.7133 | Val  Acc: 0.7174
 Site-amazon                        | Val  Loss: 2.7483 | Val  Acc: 0.7101
 Site-webcam                        | Val  Loss: 2.7707 | Val  Acc: 0.4762
 Site-webcam                        | Val  Loss: 2.7556 | Val  Acc: 0.6216
 Site-webcam                        | Val  Loss: 2.7379 | Val  Acc: 0.6406
 Site-Art                           | Val  Loss: 2.7822 | Val  Acc: 0.5357
 Site-Art                           | Val  Loss: 2.7999 | Val  Acc: 0.5000
 Site-Clipart                       | Val  Loss: 2.7936 | Val  Acc: 0.4211
 Site-dslr                          | Val  Loss: 2.7130 | Val  Acc: 0.6842
Average Valid Accuracy: 0.6332
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7500
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8125
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.5769
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.5882
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7045
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6842
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.5405
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6042
 Best site-Product                   | Epoch:4 | Val Acc: 0.7273
 Best site-Product                   | Epoch:4 | Val Acc: 0.6250
 Best site-Product                   | Epoch:4 | Val Acc: 0.7273
 Best site-Product                   | Epoch:4 | Val Acc: 0.6452
 Best site-Product                   | Epoch:4 | Val Acc: 0.6977
 Best site-Product                   | Epoch:4 | Val Acc: 0.6271
 Best site-Product                   | Epoch:4 | Val Acc: 0.6829
 Best site-amazon                    | Epoch:4 | Val Acc: 0.4615
 Best site-amazon                    | Epoch:4 | Val Acc: 0.5000
 Best site-amazon                    | Epoch:4 | Val Acc: 0.6129
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7174
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7101
 Best site-webcam                    | Epoch:4 | Val Acc: 0.4762
 Best site-webcam                    | Epoch:4 | Val Acc: 0.6216
 Best site-webcam                    | Epoch:4 | Val Acc: 0.6406
 Best site-Art                       | Epoch:4 | Val Acc: 0.5357
 Best site-Art                       | Epoch:4 | Val Acc: 0.5000
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.4211
 Best site-dslr                      | Epoch:4 | Val Acc: 0.6842
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 5 ============
 Site-RealWorld                     | Train Loss: 2.6534 | Train Acc: 0.7857
 Site-RealWorld                     | Train Loss: 2.7086 | Train Acc: 0.5000
 Site-RealWorld                     | Train Loss: 2.7395 | Train Acc: 0.5417
 Site-RealWorld                     | Train Loss: 2.7216 | Train Acc: 0.5484
 Site-RealWorld                     | Train Loss: 2.6824 | Train Acc: 0.6750
 Site-RealWorld                     | Train Loss: 2.7086 | Train Acc: 0.6667
 Site-RealWorld                     | Train Loss: 2.7062 | Train Acc: 0.6418
 Site-RealWorld                     | Train Loss: 2.6855 | Train Acc: 0.7442
 Site-RealWorld                     | Train Loss: 2.6885 | Train Acc: 0.7568
 Site-RealWorld                     | Train Loss: 2.6624 | Train Acc: 0.8403
 Site-Product                       | Train Loss: 2.6529 | Train Acc: 0.8235
 Site-Product                       | Train Loss: 2.7062 | Train Acc: 0.7083
 Site-Product                       | Train Loss: 2.7149 | Train Acc: 0.6667
 Site-Product                       | Train Loss: 2.6635 | Train Acc: 0.7609
 Site-Product                       | Train Loss: 2.6798 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.6867 | Train Acc: 0.6854
 Site-Product                       | Train Loss: 2.6775 | Train Acc: 0.7016
 Site-amazon                        | Train Loss: 2.6910 | Train Acc: 0.7000
 Site-amazon                        | Train Loss: 2.6562 | Train Acc: 0.8065
 Site-amazon                        | Train Loss: 2.6756 | Train Acc: 0.6739
 Site-amazon                        | Train Loss: 2.6397 | Train Acc: 0.7681
 Site-amazon                        | Train Loss: 2.7301 | Train Acc: 0.6538
 Site-webcam                        | Train Loss: 2.6837 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 2.6896 | Train Acc: 0.7143
 Site-webcam                        | Train Loss: 2.6826 | Train Acc: 0.7216
 Site-Art                           | Train Loss: 2.7882 | Train Acc: 0.5000
 Site-Art                           | Train Loss: 2.7700 | Train Acc: 0.4643
 Site-Clipart                       | Train Loss: 2.7736 | Train Acc: 0.5294
 Site-dslr                          | Train Loss: 2.6632 | Train Acc: 0.7931
Average Train Accuracy: 0.6874
 Site-RealWorld                     | Val  Loss: 2.6685 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.6577 | Val  Acc: 0.8333
 Site-RealWorld                     | Val  Loss: 2.6525 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.7086 | Val  Acc: 0.7000
 Site-RealWorld                     | Val  Loss: 2.7266 | Val  Acc: 0.7308
 Site-RealWorld                     | Val  Loss: 2.6763 | Val  Acc: 0.7647
 Site-RealWorld                     | Val  Loss: 2.6810 | Val  Acc: 0.7955
 Site-RealWorld                     | Val  Loss: 2.7025 | Val  Acc: 0.7193
 Site-RealWorld                     | Val  Loss: 2.7219 | Val  Acc: 0.6757
 Site-RealWorld                     | Val  Loss: 2.6992 | Val  Acc: 0.7083
 Site-Product                       | Val  Loss: 2.6362 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 2.6568 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.6807 | Val  Acc: 0.5909
 Site-Product                       | Val  Loss: 2.6878 | Val  Acc: 0.6452
 Site-Product                       | Val  Loss: 2.7023 | Val  Acc: 0.6279
 Site-Product                       | Val  Loss: 2.6927 | Val  Acc: 0.6949
 Site-Product                       | Val  Loss: 2.6611 | Val  Acc: 0.7073
 Site-amazon                        | Val  Loss: 2.7387 | Val  Acc: 0.6154
 Site-amazon                        | Val  Loss: 2.7630 | Val  Acc: 0.5500
 Site-amazon                        | Val  Loss: 2.6902 | Val  Acc: 0.6774
 Site-amazon                        | Val  Loss: 2.6737 | Val  Acc: 0.7174
 Site-amazon                        | Val  Loss: 2.7060 | Val  Acc: 0.7391
 Site-webcam                        | Val  Loss: 2.7151 | Val  Acc: 0.5714
 Site-webcam                        | Val  Loss: 2.7028 | Val  Acc: 0.7027
 Site-webcam                        | Val  Loss: 2.6820 | Val  Acc: 0.7656
 Site-Art                           | Val  Loss: 2.7360 | Val  Acc: 0.5357
 Site-Art                           | Val  Loss: 2.7634 | Val  Acc: 0.5179
 Site-Clipart                       | Val  Loss: 2.7575 | Val  Acc: 0.5088
 Site-dslr                          | Val  Loss: 2.6528 | Val  Acc: 0.7895
Average Valid Accuracy: 0.6926
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8333
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7308
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7647
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7955
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7193
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.6757
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7083
 Best site-Product                   | Epoch:5 | Val Acc: 0.9091
 Best site-Product                   | Epoch:5 | Val Acc: 0.7500
 Best site-Product                   | Epoch:5 | Val Acc: 0.5909
 Best site-Product                   | Epoch:5 | Val Acc: 0.6452
 Best site-Product                   | Epoch:5 | Val Acc: 0.6279
 Best site-Product                   | Epoch:5 | Val Acc: 0.6949
 Best site-Product                   | Epoch:5 | Val Acc: 0.7073
 Best site-amazon                    | Epoch:5 | Val Acc: 0.6154
 Best site-amazon                    | Epoch:5 | Val Acc: 0.5500
 Best site-amazon                    | Epoch:5 | Val Acc: 0.6774
 Best site-amazon                    | Epoch:5 | Val Acc: 0.7174
 Best site-amazon                    | Epoch:5 | Val Acc: 0.7391
 Best site-webcam                    | Epoch:5 | Val Acc: 0.5714
 Best site-webcam                    | Epoch:5 | Val Acc: 0.7027
 Best site-webcam                    | Epoch:5 | Val Acc: 0.7656
 Best site-Art                       | Epoch:5 | Val Acc: 0.5357
 Best site-Art                       | Epoch:5 | Val Acc: 0.5179
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.5088
 Best site-dslr                      | Epoch:5 | Val Acc: 0.7895
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 6 ============
 Site-RealWorld                     | Train Loss: 2.6162 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 2.6508 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.6929 | Train Acc: 0.7083
 Site-RealWorld                     | Train Loss: 2.6725 | Train Acc: 0.7419
 Site-RealWorld                     | Train Loss: 2.6151 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.6657 | Train Acc: 0.7647
 Site-RealWorld                     | Train Loss: 2.6761 | Train Acc: 0.6866
 Site-RealWorld                     | Train Loss: 2.6373 | Train Acc: 0.7907
 Site-RealWorld                     | Train Loss: 2.6428 | Train Acc: 0.7838
 Site-RealWorld                     | Train Loss: 2.6153 | Train Acc: 0.8611
 Site-Product                       | Train Loss: 2.5820 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.6490 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.6600 | Train Acc: 0.6364
 Site-Product                       | Train Loss: 2.6243 | Train Acc: 0.7391
 Site-Product                       | Train Loss: 2.6170 | Train Acc: 0.7656
 Site-Product                       | Train Loss: 2.6315 | Train Acc: 0.7191
 Site-Product                       | Train Loss: 2.6398 | Train Acc: 0.7419
 Site-amazon                        | Train Loss: 2.6215 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 2.6061 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 2.6317 | Train Acc: 0.7391
 Site-amazon                        | Train Loss: 2.6608 | Train Acc: 0.7971
 Site-amazon                        | Train Loss: 2.6709 | Train Acc: 0.6923
 Site-webcam                        | Train Loss: 2.6605 | Train Acc: 0.6875
 Site-webcam                        | Train Loss: 2.6365 | Train Acc: 0.7143
 Site-webcam                        | Train Loss: 2.6410 | Train Acc: 0.7835
 Site-Art                           | Train Loss: 2.7585 | Train Acc: 0.5000
 Site-Art                           | Train Loss: 2.7055 | Train Acc: 0.5595
 Site-Clipart                       | Train Loss: 2.7210 | Train Acc: 0.5647
 Site-dslr                          | Train Loss: 2.6048 | Train Acc: 0.7759
Average Train Accuracy: 0.7431
 Site-RealWorld                     | Val  Loss: 2.6298 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 2.6106 | Val  Acc: 0.8333
 Site-RealWorld                     | Val  Loss: 2.6211 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.6658 | Val  Acc: 0.7500
 Site-RealWorld                     | Val  Loss: 2.6945 | Val  Acc: 0.7308
 Site-RealWorld                     | Val  Loss: 2.6257 | Val  Acc: 0.7353
 Site-RealWorld                     | Val  Loss: 2.6108 | Val  Acc: 0.8409
 Site-RealWorld                     | Val  Loss: 2.6418 | Val  Acc: 0.7544
 Site-RealWorld                     | Val  Loss: 2.6748 | Val  Acc: 0.7027
 Site-RealWorld                     | Val  Loss: 2.6429 | Val  Acc: 0.7396
 Site-Product                       | Val  Loss: 2.5971 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.5806 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.6148 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 2.6454 | Val  Acc: 0.6452
 Site-Product                       | Val  Loss: 2.6433 | Val  Acc: 0.6977
 Site-Product                       | Val  Loss: 2.6331 | Val  Acc: 0.7458
 Site-Product                       | Val  Loss: 2.6061 | Val  Acc: 0.8049
 Site-amazon                        | Val  Loss: 2.6472 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.6665 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 2.6459 | Val  Acc: 0.7097
 Site-amazon                        | Val  Loss: 2.6303 | Val  Acc: 0.7391
 Site-amazon                        | Val  Loss: 2.6628 | Val  Acc: 0.7536
 Site-webcam                        | Val  Loss: 2.6729 | Val  Acc: 0.5238
 Site-webcam                        | Val  Loss: 2.6569 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 2.6333 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 2.7119 | Val  Acc: 0.6071
 Site-Art                           | Val  Loss: 2.7155 | Val  Acc: 0.5536
 Site-Clipart                       | Val  Loss: 2.7006 | Val  Acc: 0.5263
 Site-dslr                          | Val  Loss: 2.5971 | Val  Acc: 0.7895
Average Valid Accuracy: 0.7356
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8333
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7500
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7308
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7353
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8409
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7544
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7027
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7396
 Best site-Product                   | Epoch:6 | Val Acc: 0.8182
 Best site-Product                   | Epoch:6 | Val Acc: 0.8125
 Best site-Product                   | Epoch:6 | Val Acc: 0.7273
 Best site-Product                   | Epoch:6 | Val Acc: 0.6452
 Best site-Product                   | Epoch:6 | Val Acc: 0.6977
 Best site-Product                   | Epoch:6 | Val Acc: 0.7458
 Best site-Product                   | Epoch:6 | Val Acc: 0.8049
 Best site-amazon                    | Epoch:6 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8000
 Best site-amazon                    | Epoch:6 | Val Acc: 0.7097
 Best site-amazon                    | Epoch:6 | Val Acc: 0.7391
 Best site-amazon                    | Epoch:6 | Val Acc: 0.7536
 Best site-webcam                    | Epoch:6 | Val Acc: 0.5238
 Best site-webcam                    | Epoch:6 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:6 | Val Acc: 0.7500
 Best site-Art                       | Epoch:6 | Val Acc: 0.6071
 Best site-Art                       | Epoch:6 | Val Acc: 0.5536
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.5263
 Best site-dslr                      | Epoch:6 | Val Acc: 0.7895
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 7 ============
 Site-RealWorld                     | Train Loss: 2.5514 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 2.5884 | Train Acc: 0.6111
 Site-RealWorld                     | Train Loss: 2.6190 | Train Acc: 0.7917
 Site-RealWorld                     | Train Loss: 2.6437 | Train Acc: 0.7097
 Site-RealWorld                     | Train Loss: 2.5853 | Train Acc: 0.8250
 Site-RealWorld                     | Train Loss: 2.6023 | Train Acc: 0.8235
 Site-RealWorld                     | Train Loss: 2.6037 | Train Acc: 0.7910
 Site-RealWorld                     | Train Loss: 2.5928 | Train Acc: 0.8140
 Site-RealWorld                     | Train Loss: 2.5918 | Train Acc: 0.7658
 Site-RealWorld                     | Train Loss: 2.5465 | Train Acc: 0.8819
 Site-Product                       | Train Loss: 2.5430 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 2.6086 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.5980 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 2.5757 | Train Acc: 0.7826
 Site-Product                       | Train Loss: 2.5630 | Train Acc: 0.8281
 Site-Product                       | Train Loss: 2.5657 | Train Acc: 0.7303
 Site-Product                       | Train Loss: 2.5643 | Train Acc: 0.7984
 Site-amazon                        | Train Loss: 2.6018 | Train Acc: 0.7000
 Site-amazon                        | Train Loss: 2.5327 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 2.5834 | Train Acc: 0.7174
 Site-amazon                        | Train Loss: 2.5764 | Train Acc: 0.8551
 Site-amazon                        | Train Loss: 2.6151 | Train Acc: 0.6731
 Site-webcam                        | Train Loss: 2.5889 | Train Acc: 0.7812
 Site-webcam                        | Train Loss: 2.5890 | Train Acc: 0.7321
 Site-webcam                        | Train Loss: 2.6048 | Train Acc: 0.7732
 Site-Art                           | Train Loss: 2.7152 | Train Acc: 0.6190
 Site-Art                           | Train Loss: 2.6774 | Train Acc: 0.6310
 Site-Clipart                       | Train Loss: 2.6641 | Train Acc: 0.6353
 Site-dslr                          | Train Loss: 2.5474 | Train Acc: 0.7759
Average Train Accuracy: 0.7647
 Site-RealWorld                     | Val  Loss: 2.5499 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.5439 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.5481 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.6381 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 2.6332 | Val  Acc: 0.7308
 Site-RealWorld                     | Val  Loss: 2.5757 | Val  Acc: 0.7647
 Site-RealWorld                     | Val  Loss: 2.5817 | Val  Acc: 0.8182
 Site-RealWorld                     | Val  Loss: 2.5929 | Val  Acc: 0.7719
 Site-RealWorld                     | Val  Loss: 2.6306 | Val  Acc: 0.7703
 Site-RealWorld                     | Val  Loss: 2.5940 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.5617 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.5326 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.5610 | Val  Acc: 0.6818
 Site-Product                       | Val  Loss: 2.5853 | Val  Acc: 0.7097
 Site-Product                       | Val  Loss: 2.5948 | Val  Acc: 0.7674
 Site-Product                       | Val  Loss: 2.5721 | Val  Acc: 0.8136
 Site-Product                       | Val  Loss: 2.5510 | Val  Acc: 0.8049
 Site-amazon                        | Val  Loss: 2.6200 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.6542 | Val  Acc: 0.6500
 Site-amazon                        | Val  Loss: 2.5832 | Val  Acc: 0.7742
 Site-amazon                        | Val  Loss: 2.5550 | Val  Acc: 0.8043
 Site-amazon                        | Val  Loss: 2.6187 | Val  Acc: 0.7246
 Site-webcam                        | Val  Loss: 2.6025 | Val  Acc: 0.7143
 Site-webcam                        | Val  Loss: 2.6133 | Val  Acc: 0.7568
 Site-webcam                        | Val  Loss: 2.5645 | Val  Acc: 0.8438
 Site-Art                           | Val  Loss: 2.6385 | Val  Acc: 0.6071
 Site-Art                           | Val  Loss: 2.6634 | Val  Acc: 0.6071
 Site-Clipart                       | Val  Loss: 2.6654 | Val  Acc: 0.5789
 Site-dslr                          | Val  Loss: 2.5359 | Val  Acc: 0.8947
Average Valid Accuracy: 0.7652
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7308
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7647
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8182
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7719
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7703
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.7500
 Best site-Product                   | Epoch:7 | Val Acc: 0.8182
 Best site-Product                   | Epoch:7 | Val Acc: 0.7500
 Best site-Product                   | Epoch:7 | Val Acc: 0.6818
 Best site-Product                   | Epoch:7 | Val Acc: 0.7097
 Best site-Product                   | Epoch:7 | Val Acc: 0.7674
 Best site-Product                   | Epoch:7 | Val Acc: 0.8136
 Best site-Product                   | Epoch:7 | Val Acc: 0.8049
 Best site-amazon                    | Epoch:7 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:7 | Val Acc: 0.6500
 Best site-amazon                    | Epoch:7 | Val Acc: 0.7742
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8043
 Best site-amazon                    | Epoch:7 | Val Acc: 0.7246
 Best site-webcam                    | Epoch:7 | Val Acc: 0.7143
 Best site-webcam                    | Epoch:7 | Val Acc: 0.7568
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8438
 Best site-Art                       | Epoch:7 | Val Acc: 0.6071
 Best site-Art                       | Epoch:7 | Val Acc: 0.6071
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.5789
 Best site-dslr                      | Epoch:7 | Val Acc: 0.8947
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 8 ============
 Site-RealWorld                     | Train Loss: 2.5209 | Train Acc: 0.7857
 Site-RealWorld                     | Train Loss: 2.5107 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 2.5871 | Train Acc: 0.7500
 Site-RealWorld                     | Train Loss: 2.5849 | Train Acc: 0.8065
 Site-RealWorld                     | Train Loss: 2.5226 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.5554 | Train Acc: 0.7647
 Site-RealWorld                     | Train Loss: 2.5697 | Train Acc: 0.7910
 Site-RealWorld                     | Train Loss: 2.5174 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 2.5430 | Train Acc: 0.8288
 Site-RealWorld                     | Train Loss: 2.4798 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 2.4853 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.5411 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 2.5488 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 2.5221 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 2.5099 | Train Acc: 0.8438
 Site-Product                       | Train Loss: 2.5336 | Train Acc: 0.8090
 Site-Product                       | Train Loss: 2.5244 | Train Acc: 0.7903
 Site-amazon                        | Train Loss: 2.5423 | Train Acc: 0.7500
 Site-amazon                        | Train Loss: 2.5140 | Train Acc: 0.8065
 Site-amazon                        | Train Loss: 2.5372 | Train Acc: 0.7391
 Site-amazon                        | Train Loss: 2.4526 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 2.5671 | Train Acc: 0.7212
 Site-webcam                        | Train Loss: 2.5518 | Train Acc: 0.7188
 Site-webcam                        | Train Loss: 2.5343 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.5621 | Train Acc: 0.7938
 Site-Art                           | Train Loss: 2.6714 | Train Acc: 0.6429
 Site-Art                           | Train Loss: 2.6145 | Train Acc: 0.6429
 Site-Clipart                       | Train Loss: 2.6695 | Train Acc: 0.6235
 Site-dslr                          | Train Loss: 2.4960 | Train Acc: 0.8793
Average Train Accuracy: 0.7979
 Site-RealWorld                     | Val  Loss: 2.4745 | Val  Acc: 0.8889
 Site-RealWorld                     | Val  Loss: 2.5043 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.5158 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.5715 | Val  Acc: 0.8500
 Site-RealWorld                     | Val  Loss: 2.6035 | Val  Acc: 0.8077
 Site-RealWorld                     | Val  Loss: 2.5027 | Val  Acc: 0.8529
 Site-RealWorld                     | Val  Loss: 2.5086 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 2.5391 | Val  Acc: 0.8070
 Site-RealWorld                     | Val  Loss: 2.5906 | Val  Acc: 0.7162
 Site-RealWorld                     | Val  Loss: 2.5460 | Val  Acc: 0.7708
 Site-Product                       | Val  Loss: 2.4753 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 2.4705 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.4835 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 2.5016 | Val  Acc: 0.8065
 Site-Product                       | Val  Loss: 2.5638 | Val  Acc: 0.6977
 Site-Product                       | Val  Loss: 2.5144 | Val  Acc: 0.8305
 Site-Product                       | Val  Loss: 2.5070 | Val  Acc: 0.8415
 Site-amazon                        | Val  Loss: 2.5523 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.5648 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.5275 | Val  Acc: 0.6774
 Site-amazon                        | Val  Loss: 2.5010 | Val  Acc: 0.8478
 Site-amazon                        | Val  Loss: 2.5255 | Val  Acc: 0.8406
 Site-webcam                        | Val  Loss: 2.5418 | Val  Acc: 0.7619
 Site-webcam                        | Val  Loss: 2.5519 | Val  Acc: 0.7838
 Site-webcam                        | Val  Loss: 2.5418 | Val  Acc: 0.7969
 Site-Art                           | Val  Loss: 2.6250 | Val  Acc: 0.5714
 Site-Art                           | Val  Loss: 2.6342 | Val  Acc: 0.6071
 Site-Clipart                       | Val  Loss: 2.6320 | Val  Acc: 0.6140
 Site-dslr                          | Val  Loss: 2.4827 | Val  Acc: 0.8947
Average Valid Accuracy: 0.7816
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8889
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8500
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8077
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8529
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8864
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8070
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.7162
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.7708
 Best site-Product                   | Epoch:8 | Val Acc: 0.7273
 Best site-Product                   | Epoch:8 | Val Acc: 0.7500
 Best site-Product                   | Epoch:8 | Val Acc: 0.7273
 Best site-Product                   | Epoch:8 | Val Acc: 0.8065
 Best site-Product                   | Epoch:8 | Val Acc: 0.6977
 Best site-Product                   | Epoch:8 | Val Acc: 0.8305
 Best site-Product                   | Epoch:8 | Val Acc: 0.8415
 Best site-amazon                    | Epoch:8 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:8 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:8 | Val Acc: 0.6774
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8478
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8406
 Best site-webcam                    | Epoch:8 | Val Acc: 0.7619
 Best site-webcam                    | Epoch:8 | Val Acc: 0.7838
 Best site-webcam                    | Epoch:8 | Val Acc: 0.7969
 Best site-Art                       | Epoch:8 | Val Acc: 0.5714
 Best site-Art                       | Epoch:8 | Val Acc: 0.6071
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.6140
 Best site-dslr                      | Epoch:8 | Val Acc: 0.8947
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 9 ============
 Site-RealWorld                     | Train Loss: 2.4505 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 2.5173 | Train Acc: 0.6111
 Site-RealWorld                     | Train Loss: 2.5206 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.5308 | Train Acc: 0.8065
 Site-RealWorld                     | Train Loss: 2.4852 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.5083 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 2.5104 | Train Acc: 0.8209
 Site-RealWorld                     | Train Loss: 2.4615 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.4843 | Train Acc: 0.8559
 Site-RealWorld                     | Train Loss: 2.4300 | Train Acc: 0.9097
 Site-Product                       | Train Loss: 2.4282 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.5280 | Train Acc: 0.7917
 Site-Product                       | Train Loss: 2.5219 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 2.4775 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 2.4559 | Train Acc: 0.8438
 Site-Product                       | Train Loss: 2.4741 | Train Acc: 0.7753
 Site-Product                       | Train Loss: 2.4823 | Train Acc: 0.8468
 Site-amazon                        | Train Loss: 2.4909 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 2.4473 | Train Acc: 0.8065
 Site-amazon                        | Train Loss: 2.4637 | Train Acc: 0.7609
 Site-amazon                        | Train Loss: 2.5236 | Train Acc: 0.8406
 Site-amazon                        | Train Loss: 2.5314 | Train Acc: 0.7404
 Site-webcam                        | Train Loss: 2.4941 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 2.5120 | Train Acc: 0.7321
 Site-webcam                        | Train Loss: 2.4676 | Train Acc: 0.8763
 Site-Art                           | Train Loss: 2.6647 | Train Acc: 0.5714
 Site-Art                           | Train Loss: 2.5738 | Train Acc: 0.6310
 Site-Clipart                       | Train Loss: 2.5564 | Train Acc: 0.6000
 Site-dslr                          | Train Loss: 2.4478 | Train Acc: 0.8448
Average Train Accuracy: 0.7964
 Site-RealWorld                     | Val  Loss: 2.4268 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.4661 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.4419 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.5185 | Val  Acc: 0.8500
 Site-RealWorld                     | Val  Loss: 2.5407 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 2.4573 | Val  Acc: 0.8529
 Site-RealWorld                     | Val  Loss: 2.4801 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 2.4913 | Val  Acc: 0.7895
 Site-RealWorld                     | Val  Loss: 2.5527 | Val  Acc: 0.7973
 Site-RealWorld                     | Val  Loss: 2.4899 | Val  Acc: 0.7917
 Site-Product                       | Val  Loss: 2.4157 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 2.4511 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.4206 | Val  Acc: 0.6818
 Site-Product                       | Val  Loss: 2.4522 | Val  Acc: 0.8387
 Site-Product                       | Val  Loss: 2.5088 | Val  Acc: 0.7907
 Site-Product                       | Val  Loss: 2.4569 | Val  Acc: 0.7966
 Site-Product                       | Val  Loss: 2.4350 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 2.5146 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.5551 | Val  Acc: 0.6500
 Site-amazon                        | Val  Loss: 2.4772 | Val  Acc: 0.7742
 Site-amazon                        | Val  Loss: 2.4522 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 2.5226 | Val  Acc: 0.7681
 Site-webcam                        | Val  Loss: 2.4994 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 2.5034 | Val  Acc: 0.8108
 Site-webcam                        | Val  Loss: 2.4983 | Val  Acc: 0.8125
 Site-Art                           | Val  Loss: 2.5568 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 2.5818 | Val  Acc: 0.7321
 Site-Clipart                       | Val  Loss: 2.5679 | Val  Acc: 0.6491
 Site-dslr                          | Val  Loss: 2.4401 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8167
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8500
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8529
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8864
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7895
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7973
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7917
 Best site-Product                   | Epoch:9 | Val Acc: 0.9091
 Best site-Product                   | Epoch:9 | Val Acc: 0.7500
 Best site-Product                   | Epoch:9 | Val Acc: 0.6818
 Best site-Product                   | Epoch:9 | Val Acc: 0.8387
 Best site-Product                   | Epoch:9 | Val Acc: 0.7907
 Best site-Product                   | Epoch:9 | Val Acc: 0.7966
 Best site-Product                   | Epoch:9 | Val Acc: 0.8780
 Best site-amazon                    | Epoch:9 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:9 | Val Acc: 0.6500
 Best site-amazon                    | Epoch:9 | Val Acc: 0.7742
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:9 | Val Acc: 0.7681
 Best site-webcam                    | Epoch:9 | Val Acc: 0.8571
 Best site-webcam                    | Epoch:9 | Val Acc: 0.8108
 Best site-webcam                    | Epoch:9 | Val Acc: 0.8125
 Best site-Art                       | Epoch:9 | Val Acc: 0.7500
 Best site-Art                       | Epoch:9 | Val Acc: 0.7321
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.6491
 Best site-dslr                      | Epoch:9 | Val Acc: 0.9211
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 10 ============
 Site-RealWorld                     | Train Loss: 2.3551 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 2.4496 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.4780 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.4652 | Train Acc: 0.8065
 Site-RealWorld                     | Train Loss: 2.4227 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.4574 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 2.3344 | Train Acc: 0.8358
 Site-RealWorld                     | Train Loss: 2.4175 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.4331 | Train Acc: 0.8649
 Site-RealWorld                     | Train Loss: 2.4018 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 2.3634 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.4585 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 2.4700 | Train Acc: 0.7576
 Site-Product                       | Train Loss: 2.4338 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 2.4081 | Train Acc: 0.8438
 Site-Product                       | Train Loss: 2.4411 | Train Acc: 0.8315
 Site-Product                       | Train Loss: 2.4237 | Train Acc: 0.8548
 Site-amazon                        | Train Loss: 2.3930 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 2.3822 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 2.4083 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 2.4021 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 2.4713 | Train Acc: 0.7019
 Site-webcam                        | Train Loss: 2.4483 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 2.4582 | Train Acc: 0.8036
 Site-webcam                        | Train Loss: 2.4394 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 2.6104 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.5675 | Train Acc: 0.6667
 Site-Clipart                       | Train Loss: 2.5993 | Train Acc: 0.6000
 Site-dslr                          | Train Loss: 2.4160 | Train Acc: 0.8103
Average Train Accuracy: 0.8229
 Site-RealWorld                     | Val  Loss: 2.3799 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.4109 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.3688 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.4799 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.5036 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 2.3898 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 2.4224 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 2.4351 | Val  Acc: 0.7719
 Site-RealWorld                     | Val  Loss: 2.4933 | Val  Acc: 0.7838
 Site-RealWorld                     | Val  Loss: 2.4499 | Val  Acc: 0.8229
 Site-Product                       | Val  Loss: 2.3748 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.4058 | Val  Acc: 0.6875
 Site-Product                       | Val  Loss: 2.3667 | Val  Acc: 0.7727
 Site-Product                       | Val  Loss: 2.4087 | Val  Acc: 0.7419
 Site-Product                       | Val  Loss: 2.4440 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.3840 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 2.3964 | Val  Acc: 0.8171
 Site-amazon                        | Val  Loss: 2.4610 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.4568 | Val  Acc: 0.7000
 Site-amazon                        | Val  Loss: 2.4330 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.3938 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 2.4538 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 2.5028 | Val  Acc: 0.7143
 Site-webcam                        | Val  Loss: 2.4249 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.4277 | Val  Acc: 0.8438
 Site-Art                           | Val  Loss: 2.5275 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 2.5328 | Val  Acc: 0.7321
 Site-Clipart                       | Val  Loss: 2.5598 | Val  Acc: 0.6491
 Site-dslr                          | Val  Loss: 2.3740 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8224
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9318
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.7719
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.7838
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8229
 Best site-Product                   | Epoch:10 | Val Acc: 0.8182
 Best site-Product                   | Epoch:10 | Val Acc: 0.6875
 Best site-Product                   | Epoch:10 | Val Acc: 0.7727
 Best site-Product                   | Epoch:10 | Val Acc: 0.7419
 Best site-Product                   | Epoch:10 | Val Acc: 0.8372
 Best site-Product                   | Epoch:10 | Val Acc: 0.9153
 Best site-Product                   | Epoch:10 | Val Acc: 0.8171
 Best site-amazon                    | Epoch:10 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:10 | Val Acc: 0.7000
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8696
 Best site-webcam                    | Epoch:10 | Val Acc: 0.7143
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8649
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8438
 Best site-Art                       | Epoch:10 | Val Acc: 0.7500
 Best site-Art                       | Epoch:10 | Val Acc: 0.7321
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.6491
 Best site-dslr                      | Epoch:10 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 11 ============
 Site-RealWorld                     | Train Loss: 2.3366 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 2.4046 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.4290 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.4284 | Train Acc: 0.8065
 Site-RealWorld                     | Train Loss: 2.3567 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.3994 | Train Acc: 0.8627
 Site-RealWorld                     | Train Loss: 2.4569 | Train Acc: 0.8657
 Site-RealWorld                     | Train Loss: 2.3886 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 2.3801 | Train Acc: 0.9009
 Site-RealWorld                     | Train Loss: 2.3033 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 2.3207 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 2.3946 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 2.4216 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 2.3573 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 2.3431 | Train Acc: 0.8594
 Site-Product                       | Train Loss: 2.3763 | Train Acc: 0.8539
 Site-Product                       | Train Loss: 2.3730 | Train Acc: 0.8468
 Site-amazon                        | Train Loss: 2.3709 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.3168 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.3862 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 2.3031 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 2.4209 | Train Acc: 0.7788
 Site-webcam                        | Train Loss: 2.4364 | Train Acc: 0.7812
 Site-webcam                        | Train Loss: 2.3678 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 2.3867 | Train Acc: 0.8454
 Site-Art                           | Train Loss: 2.5842 | Train Acc: 0.6905
 Site-Art                           | Train Loss: 2.4871 | Train Acc: 0.7262
 Site-Clipart                       | Train Loss: 2.5117 | Train Acc: 0.6353
 Site-dslr                          | Train Loss: 2.3293 | Train Acc: 0.8793
Average Train Accuracy: 0.8432
 Site-RealWorld                     | Val  Loss: 2.3006 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.3227 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.3564 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 2.4183 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.4623 | Val  Acc: 0.8077
 Site-RealWorld                     | Val  Loss: 2.3627 | Val  Acc: 0.9118
 Site-RealWorld                     | Val  Loss: 2.3635 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 2.3844 | Val  Acc: 0.8070
 Site-RealWorld                     | Val  Loss: 2.4269 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 2.3943 | Val  Acc: 0.8229
 Site-Product                       | Val  Loss: 2.3104 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 2.2983 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.3216 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 2.3456 | Val  Acc: 0.7742
 Site-Product                       | Val  Loss: 2.4090 | Val  Acc: 0.8140
 Site-Product                       | Val  Loss: 2.3406 | Val  Acc: 0.8814
 Site-Product                       | Val  Loss: 2.3403 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 2.4297 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.4556 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.3662 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.3624 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 2.4215 | Val  Acc: 0.8261
 Site-webcam                        | Val  Loss: 2.4588 | Val  Acc: 0.7619
 Site-webcam                        | Val  Loss: 2.4019 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 2.3738 | Val  Acc: 0.8750
 Site-Art                           | Val  Loss: 2.4578 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.5178 | Val  Acc: 0.6607
 Site-Clipart                       | Val  Loss: 2.5139 | Val  Acc: 0.6316
 Site-dslr                          | Val  Loss: 2.3302 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8458
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8077
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9118
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8070
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8229
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 0.8125
 Best site-Product                   | Epoch:11 | Val Acc: 0.9091
 Best site-Product                   | Epoch:11 | Val Acc: 0.7742
 Best site-Product                   | Epoch:11 | Val Acc: 0.8140
 Best site-Product                   | Epoch:11 | Val Acc: 0.8814
 Best site-Product                   | Epoch:11 | Val Acc: 0.8293
 Best site-amazon                    | Epoch:11 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:11 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:11 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:11 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:11 | Val Acc: 0.8261
 Best site-webcam                    | Epoch:11 | Val Acc: 0.7619
 Best site-webcam                    | Epoch:11 | Val Acc: 0.8378
 Best site-webcam                    | Epoch:11 | Val Acc: 0.8750
 Best site-Art                       | Epoch:11 | Val Acc: 0.7143
 Best site-Art                       | Epoch:11 | Val Acc: 0.6607
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.6316
 Best site-dslr                      | Epoch:11 | Val Acc: 0.9737
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 12 ============
 Site-RealWorld                     | Train Loss: 2.2902 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 2.3190 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.4064 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.3823 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 2.3464 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.3662 | Train Acc: 0.8627
 Site-RealWorld                     | Train Loss: 2.4005 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 2.2966 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.3254 | Train Acc: 0.8829
 Site-RealWorld                     | Train Loss: 2.2704 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 2.2536 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.3823 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 2.4076 | Train Acc: 0.6667
 Site-Product                       | Train Loss: 2.3428 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 2.2934 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 2.2743 | Train Acc: 0.8652
 Site-Product                       | Train Loss: 2.3219 | Train Acc: 0.8226
 Site-amazon                        | Train Loss: 2.2838 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.2613 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 2.3373 | Train Acc: 0.7826
 Site-amazon                        | Train Loss: 2.1866 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 2.3950 | Train Acc: 0.7500
 Site-webcam                        | Train Loss: 2.3895 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.3179 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 2.3375 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 2.5443 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.4950 | Train Acc: 0.7143
 Site-Clipart                       | Train Loss: 2.5173 | Train Acc: 0.5765
 Site-dslr                          | Train Loss: 2.2776 | Train Acc: 0.9310
Average Train Accuracy: 0.8405
 Site-RealWorld                     | Val  Loss: 2.2583 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.3380 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.2830 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.3785 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.3760 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 2.2906 | Val  Acc: 0.9118
 Site-RealWorld                     | Val  Loss: 2.3148 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 2.3362 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 2.3765 | Val  Acc: 0.8378
 Site-RealWorld                     | Val  Loss: 2.3349 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.2785 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.2616 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.2332 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.2880 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 2.3646 | Val  Acc: 0.7674
 Site-Product                       | Val  Loss: 2.2985 | Val  Acc: 0.8644
 Site-Product                       | Val  Loss: 2.2949 | Val  Acc: 0.8415
 Site-amazon                        | Val  Loss: 2.3348 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.3504 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 2.3329 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 2.2943 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 2.4129 | Val  Acc: 0.8116
 Site-webcam                        | Val  Loss: 2.3368 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 2.3430 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 2.3111 | Val  Acc: 0.8750
 Site-Art                           | Val  Loss: 2.4282 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.4505 | Val  Acc: 0.7857
 Site-Clipart                       | Val  Loss: 2.4760 | Val  Acc: 0.6140
 Site-dslr                          | Val  Loss: 2.2844 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8545
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9118
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9318
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8421
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8378
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8125
 Best site-Product                   | Epoch:12 | Val Acc: 0.8182
 Best site-Product                   | Epoch:12 | Val Acc: 0.8125
 Best site-Product                   | Epoch:12 | Val Acc: 0.8182
 Best site-Product                   | Epoch:12 | Val Acc: 0.9032
 Best site-Product                   | Epoch:12 | Val Acc: 0.7674
 Best site-Product                   | Epoch:12 | Val Acc: 0.8644
 Best site-Product                   | Epoch:12 | Val Acc: 0.8415
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:12 | Val Acc: 0.9000
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8116
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8095
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:12 | Val Acc: 0.8750
 Best site-Art                       | Epoch:12 | Val Acc: 0.7143
 Best site-Art                       | Epoch:12 | Val Acc: 0.7857
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.6140
 Best site-dslr                      | Epoch:12 | Val Acc: 0.8947
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 13 ============
 Site-RealWorld                     | Train Loss: 2.2134 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 2.3063 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.3745 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.3228 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 2.2907 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.3133 | Train Acc: 0.9020
 Site-RealWorld                     | Train Loss: 2.2427 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 2.2626 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 2.2908 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 2.2160 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 2.2015 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 2.2913 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 2.3290 | Train Acc: 0.7576
 Site-Product                       | Train Loss: 2.2599 | Train Acc: 0.8913
 Site-Product                       | Train Loss: 2.2107 | Train Acc: 0.8906
 Site-Product                       | Train Loss: 2.2559 | Train Acc: 0.8764
 Site-Product                       | Train Loss: 2.2856 | Train Acc: 0.8387
 Site-amazon                        | Train Loss: 2.2611 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.2240 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 2.3053 | Train Acc: 0.7609
 Site-amazon                        | Train Loss: 2.1935 | Train Acc: 0.8406
 Site-amazon                        | Train Loss: 2.3419 | Train Acc: 0.7692
 Site-webcam                        | Train Loss: 2.3168 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 2.2600 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 2.3042 | Train Acc: 0.8351
 Site-Art                           | Train Loss: 2.5084 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 2.4360 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 2.4570 | Train Acc: 0.6471
 Site-dslr                          | Train Loss: 2.2344 | Train Acc: 0.9138
Average Train Accuracy: 0.8601
 Site-RealWorld                     | Val  Loss: 2.1504 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.2247 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1999 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.3242 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.3773 | Val  Acc: 0.8846
 Site-RealWorld                     | Val  Loss: 2.2326 | Val  Acc: 0.9118
 Site-RealWorld                     | Val  Loss: 2.2990 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 2.2856 | Val  Acc: 0.8070
 Site-RealWorld                     | Val  Loss: 2.3661 | Val  Acc: 0.8784
 Site-RealWorld                     | Val  Loss: 2.3055 | Val  Acc: 0.8438
 Site-Product                       | Val  Loss: 2.1999 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 2.2339 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.1704 | Val  Acc: 0.8636
 Site-Product                       | Val  Loss: 2.2320 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 2.3050 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.2380 | Val  Acc: 0.8983
 Site-Product                       | Val  Loss: 2.2537 | Val  Acc: 0.8293
 Site-amazon                        | Val  Loss: 2.3451 | Val  Acc: 0.6154
 Site-amazon                        | Val  Loss: 2.3776 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 2.2896 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.2266 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 2.2878 | Val  Acc: 0.8261
 Site-webcam                        | Val  Loss: 2.3153 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 2.3295 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.2513 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 2.3855 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 2.4339 | Val  Acc: 0.7321
 Site-Clipart                       | Val  Loss: 2.4261 | Val  Acc: 0.5965
 Site-dslr                          | Val  Loss: 2.2139 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8643
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8846
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9118
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.9318
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8070
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8784
 Best site-RealWorld                 | Epoch:13 | Val Acc: 0.8438
 Best site-Product                   | Epoch:13 | Val Acc: 1.0000
 Best site-Product                   | Epoch:13 | Val Acc: 0.8125
 Best site-Product                   | Epoch:13 | Val Acc: 0.8636
 Best site-Product                   | Epoch:13 | Val Acc: 0.9032
 Best site-Product                   | Epoch:13 | Val Acc: 0.8372
 Best site-Product                   | Epoch:13 | Val Acc: 0.8983
 Best site-Product                   | Epoch:13 | Val Acc: 0.8293
 Best site-amazon                    | Epoch:13 | Val Acc: 0.6154
 Best site-amazon                    | Epoch:13 | Val Acc: 0.8500
 Best site-amazon                    | Epoch:13 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:13 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:13 | Val Acc: 0.8261
 Best site-webcam                    | Epoch:13 | Val Acc: 0.8095
 Best site-webcam                    | Epoch:13 | Val Acc: 0.8649
 Best site-webcam                    | Epoch:13 | Val Acc: 0.9219
 Best site-Art                       | Epoch:13 | Val Acc: 0.7857
 Best site-Art                       | Epoch:13 | Val Acc: 0.7321
 Best site-Clipart                   | Epoch:13 | Val Acc: 0.5965
 Best site-dslr                      | Epoch:13 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 14 ============
 Site-RealWorld                     | Train Loss: 2.1610 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 2.2431 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.3104 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.2761 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 2.2295 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.2788 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 2.3374 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 2.1838 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 2.2439 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 2.1685 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 2.1352 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.2786 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 2.2570 | Train Acc: 0.8485
 Site-Product                       | Train Loss: 2.2402 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 2.1744 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 2.2087 | Train Acc: 0.8876
 Site-Product                       | Train Loss: 2.2478 | Train Acc: 0.8387
 Site-amazon                        | Train Loss: 2.2562 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.1806 | Train Acc: 0.8387
 Site-amazon                        | Train Loss: 2.2556 | Train Acc: 0.7609
 Site-amazon                        | Train Loss: 2.3219 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 2.2802 | Train Acc: 0.7596
 Site-webcam                        | Train Loss: 2.2880 | Train Acc: 0.7812
 Site-webcam                        | Train Loss: 2.2373 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 2.2448 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 2.4501 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 2.4021 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 2.4139 | Train Acc: 0.6235
 Site-dslr                          | Train Loss: 2.1754 | Train Acc: 0.9310
Average Train Accuracy: 0.8599
 Site-RealWorld                     | Val  Loss: 2.1228 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.2027 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1473 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 2.3133 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.3242 | Val  Acc: 0.8077
 Site-RealWorld                     | Val  Loss: 2.1889 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 2.2304 | Val  Acc: 0.9773
 Site-RealWorld                     | Val  Loss: 2.2427 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 2.3079 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 2.2378 | Val  Acc: 0.9062
 Site-Product                       | Val  Loss: 2.1229 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.2060 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.1253 | Val  Acc: 0.8636
 Site-Product                       | Val  Loss: 2.2000 | Val  Acc: 0.7742
 Site-Product                       | Val  Loss: 2.2587 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.1684 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 2.1758 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 2.2512 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.3002 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 2.2408 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.2010 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 2.2729 | Val  Acc: 0.7971
 Site-webcam                        | Val  Loss: 2.2781 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 2.2818 | Val  Acc: 0.8378
 Site-webcam                        | Val  Loss: 2.2362 | Val  Acc: 0.8594
 Site-Art                           | Val  Loss: 2.3736 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 2.3908 | Val  Acc: 0.7321
 Site-Clipart                       | Val  Loss: 2.3881 | Val  Acc: 0.6842
 Site-dslr                          | Val  Loss: 2.1514 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8599
============ Train epoch 15 ============
 Site-RealWorld                     | Train Loss: 2.1333 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 2.2114 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.2508 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.2301 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 2.1894 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.2200 | Train Acc: 0.9020
 Site-RealWorld                     | Train Loss: 2.2078 | Train Acc: 0.8657
 Site-RealWorld                     | Train Loss: 2.1543 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.1917 | Train Acc: 0.9099
 Site-RealWorld                     | Train Loss: 2.1491 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 2.0870 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.2035 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 2.2319 | Train Acc: 0.7273
 Site-Product                       | Train Loss: 2.1992 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 2.1348 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 2.1405 | Train Acc: 0.8427
 Site-Product                       | Train Loss: 2.1993 | Train Acc: 0.8548
 Site-amazon                        | Train Loss: 2.1929 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.0924 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.2165 | Train Acc: 0.7174
 Site-amazon                        | Train Loss: 2.2061 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 2.2411 | Train Acc: 0.7788
 Site-webcam                        | Train Loss: 2.2124 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.2139 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 2.1989 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 2.4223 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.3964 | Train Acc: 0.7024
 Site-Clipart                       | Train Loss: 2.3465 | Train Acc: 0.6471
 Site-dslr                          | Train Loss: 2.1508 | Train Acc: 0.8966
Average Train Accuracy: 0.8504
 Site-RealWorld                     | Val  Loss: 2.0575 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1315 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1143 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.2500 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.2887 | Val  Acc: 0.8846
 Site-RealWorld                     | Val  Loss: 2.1365 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 2.1727 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 2.1745 | Val  Acc: 0.7895
 Site-RealWorld                     | Val  Loss: 2.2732 | Val  Acc: 0.8514
 Site-RealWorld                     | Val  Loss: 2.1938 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 2.1334 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.0733 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 2.0401 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 2.1240 | Val  Acc: 0.8387
 Site-Product                       | Val  Loss: 2.2069 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 2.1390 | Val  Acc: 0.8814
 Site-Product                       | Val  Loss: 2.1177 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 2.1950 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.2811 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.1719 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 2.1471 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 2.2684 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 2.1686 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 2.1826 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 2.1692 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 2.2815 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 2.3331 | Val  Acc: 0.7857
 Site-Clipart                       | Val  Loss: 2.3614 | Val  Acc: 0.6667
 Site-dslr                          | Val  Loss: 2.1452 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8642
============ Train epoch 16 ============
 Site-RealWorld                     | Train Loss: 2.1251 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 2.1988 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.2113 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.1815 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 2.1415 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.1470 | Train Acc: 0.9020
 Site-RealWorld                     | Train Loss: 2.1056 | Train Acc: 0.8657
 Site-RealWorld                     | Train Loss: 2.1501 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.1504 | Train Acc: 0.9009
 Site-RealWorld                     | Train Loss: 2.0665 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 2.0164 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.1478 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 2.2046 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 2.1562 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 2.0896 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 2.1179 | Train Acc: 0.8989
 Site-Product                       | Train Loss: 2.1351 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 2.1443 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.0264 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.1627 | Train Acc: 0.7826
 Site-amazon                        | Train Loss: 2.0636 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 2.1742 | Train Acc: 0.7788
 Site-webcam                        | Train Loss: 2.1527 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 2.1377 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 2.1658 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 2.4061 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.3444 | Train Acc: 0.7500
 Site-Clipart                       | Train Loss: 2.3996 | Train Acc: 0.6235
 Site-dslr                          | Train Loss: 2.0835 | Train Acc: 0.9138
Average Train Accuracy: 0.8595
 Site-RealWorld                     | Val  Loss: 2.0145 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0354 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0401 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 2.1983 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.2464 | Val  Acc: 0.8077
 Site-RealWorld                     | Val  Loss: 2.0862 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 2.1276 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 2.1437 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 2.2197 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 2.1664 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 2.0444 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 2.0444 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 2.0200 | Val  Acc: 0.7727
 Site-Product                       | Val  Loss: 2.0348 | Val  Acc: 0.8710
 Site-Product                       | Val  Loss: 2.1989 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.0791 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 2.0825 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 2.1872 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.1912 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 2.1108 | Val  Acc: 0.9032
 Site-amazon                        | Val  Loss: 2.0709 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 2.1794 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 2.1572 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 2.1681 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 2.1284 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 2.2541 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 2.3117 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 2.3488 | Val  Acc: 0.6491
 Site-dslr                          | Val  Loss: 2.1009 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8791
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8077
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8864
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8421
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.9054
 Best site-RealWorld                 | Epoch:16 | Val Acc: 0.8646
 Best site-Product                   | Epoch:16 | Val Acc: 1.0000
 Best site-Product                   | Epoch:16 | Val Acc: 0.8750
 Best site-Product                   | Epoch:16 | Val Acc: 0.7727
 Best site-Product                   | Epoch:16 | Val Acc: 0.8710
 Best site-Product                   | Epoch:16 | Val Acc: 0.8372
 Best site-Product                   | Epoch:16 | Val Acc: 0.9153
 Best site-Product                   | Epoch:16 | Val Acc: 0.8537
 Best site-amazon                    | Epoch:16 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9000
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9032
 Best site-amazon                    | Epoch:16 | Val Acc: 0.9348
 Best site-amazon                    | Epoch:16 | Val Acc: 0.8696
 Best site-webcam                    | Epoch:16 | Val Acc: 0.8571
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:16 | Val Acc: 0.9062
 Best site-Art                       | Epoch:16 | Val Acc: 0.8214
 Best site-Art                       | Epoch:16 | Val Acc: 0.8036
 Best site-Clipart                   | Epoch:16 | Val Acc: 0.6491
 Best site-dslr                      | Epoch:16 | Val Acc: 0.9211
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 17 ============
 Site-RealWorld                     | Train Loss: 2.0461 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 2.1629 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.1235 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.1662 | Train Acc: 0.8387
 Site-RealWorld                     | Train Loss: 2.0866 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.1075 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 2.2025 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 2.0440 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 2.0919 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.9823 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 1.9511 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.1548 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 2.1719 | Train Acc: 0.7273
 Site-Product                       | Train Loss: 2.1188 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 2.0595 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 2.0645 | Train Acc: 0.8764
 Site-Product                       | Train Loss: 2.0906 | Train Acc: 0.8790
 Site-amazon                        | Train Loss: 2.0816 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.9899 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.0871 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 2.0620 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 2.1678 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 2.1383 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 2.1054 | Train Acc: 0.8929
 Site-webcam                        | Train Loss: 2.1110 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 2.3384 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 2.2775 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 2.3172 | Train Acc: 0.6235
 Site-dslr                          | Train Loss: 2.0401 | Train Acc: 0.8966
Average Train Accuracy: 0.8630
 Site-RealWorld                     | Val  Loss: 1.9896 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9784 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0227 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1308 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.2032 | Val  Acc: 0.8077
 Site-RealWorld                     | Val  Loss: 2.0225 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 2.0745 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 2.0635 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 2.1371 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 2.1153 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 1.9172 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 2.0236 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 2.0115 | Val  Acc: 0.7273
 Site-Product                       | Val  Loss: 1.9998 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 2.1384 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 2.0249 | Val  Acc: 0.8983
 Site-Product                       | Val  Loss: 2.0439 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 2.1321 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.1886 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.0972 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 2.0237 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 2.1445 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 2.1127 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 2.1173 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 2.0789 | Val  Acc: 0.9375
 Site-Art                           | Val  Loss: 2.2435 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 2.2842 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 2.3079 | Val  Acc: 0.6842
 Site-dslr                          | Val  Loss: 2.0330 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8724
============ Train epoch 18 ============
 Site-RealWorld                     | Train Loss: 2.0005 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 2.1171 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.1342 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.0868 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 2.0678 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.0661 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 2.1442 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 2.0302 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.0733 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 1.9674 | Train Acc: 0.9583
 Site-Product                       | Train Loss: 1.9304 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.1831 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.1284 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 2.0675 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.9834 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 2.0219 | Train Acc: 0.9101
 Site-Product                       | Train Loss: 2.0600 | Train Acc: 0.8468
 Site-amazon                        | Train Loss: 2.0233 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.9397 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.0575 | Train Acc: 0.7826
 Site-amazon                        | Train Loss: 2.1466 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 2.1216 | Train Acc: 0.7692
 Site-webcam                        | Train Loss: 2.1113 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 2.0327 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 2.0599 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 2.3274 | Train Acc: 0.6190
 Site-Art                           | Train Loss: 2.2944 | Train Acc: 0.7857
 Site-Clipart                       | Train Loss: 2.2889 | Train Acc: 0.6118
 Site-dslr                          | Train Loss: 1.9840 | Train Acc: 0.8966
Average Train Accuracy: 0.8557
 Site-RealWorld                     | Val  Loss: 1.8673 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9262 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9464 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0904 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.1321 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.9815 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 2.0656 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 2.0211 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 2.1350 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 2.0542 | Val  Acc: 0.8542
 Site-Product                       | Val  Loss: 1.9557 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 1.9793 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 1.8779 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 1.9499 | Val  Acc: 0.9677
 Site-Product                       | Val  Loss: 2.0964 | Val  Acc: 0.7907
 Site-Product                       | Val  Loss: 1.9819 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.9861 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 2.0139 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.1165 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.0521 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 2.0001 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 2.1492 | Val  Acc: 0.8406
 Site-webcam                        | Val  Loss: 2.1257 | Val  Acc: 0.7619
 Site-webcam                        | Val  Loss: 2.0604 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 2.0473 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 2.2027 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 2.2182 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 2.2846 | Val  Acc: 0.6667
 Site-dslr                          | Val  Loss: 1.9574 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8709
============ Train epoch 19 ============
 Site-RealWorld                     | Train Loss: 1.9966 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.9894 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.0807 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 2.0261 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.9871 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.9984 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 2.0039 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.9556 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 2.0060 | Train Acc: 0.9009
 Site-RealWorld                     | Train Loss: 1.9286 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.8841 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 2.0119 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 2.0897 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 2.0520 | Train Acc: 0.7609
 Site-Product                       | Train Loss: 1.9610 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 2.0014 | Train Acc: 0.8539
 Site-Product                       | Train Loss: 2.0245 | Train Acc: 0.8226
 Site-amazon                        | Train Loss: 1.9855 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.8860 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 2.0019 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 2.0616 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 2.0682 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 2.0374 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.9721 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 2.0389 | Train Acc: 0.9381
 Site-Art                           | Train Loss: 2.2858 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 2.2260 | Train Acc: 0.8095
 Site-Clipart                       | Train Loss: 2.3308 | Train Acc: 0.6471
 Site-dslr                          | Train Loss: 1.9288 | Train Acc: 0.9483
Average Train Accuracy: 0.8713
 Site-RealWorld                     | Val  Loss: 1.8692 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9173 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8711 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0831 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.1038 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.9146 | Val  Acc: 0.9118
 Site-RealWorld                     | Val  Loss: 1.9819 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 2.0073 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 2.0811 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 2.0243 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.9416 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.9521 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.8914 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.9389 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.9926 | Val  Acc: 0.9535
 Site-Product                       | Val  Loss: 1.9182 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.9085 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 2.0368 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.1358 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.9925 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.9131 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 2.0736 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.9822 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 2.0680 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.9811 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 2.1567 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 2.2099 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 2.2285 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.9127 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8920
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9118
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8246
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:19 | Val Acc: 0.8958
 Best site-Product                   | Epoch:19 | Val Acc: 0.9091
 Best site-Product                   | Epoch:19 | Val Acc: 0.8750
 Best site-Product                   | Epoch:19 | Val Acc: 0.9091
 Best site-Product                   | Epoch:19 | Val Acc: 0.9355
 Best site-Product                   | Epoch:19 | Val Acc: 0.9535
 Best site-Product                   | Epoch:19 | Val Acc: 0.9322
 Best site-Product                   | Epoch:19 | Val Acc: 0.8902
 Best site-amazon                    | Epoch:19 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:19 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:19 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:19 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:19 | Val Acc: 0.8841
 Best site-webcam                    | Epoch:19 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:19 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:19 | Val Acc: 0.9531
 Best site-Art                       | Epoch:19 | Val Acc: 0.7500
 Best site-Art                       | Epoch:19 | Val Acc: 0.8036
 Best site-Clipart                   | Epoch:19 | Val Acc: 0.7018
 Best site-dslr                      | Epoch:19 | Val Acc: 0.9211
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 20 ============
 Site-RealWorld                     | Train Loss: 1.8891 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 2.0353 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.0078 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 2.0168 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 1.9347 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.9703 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 2.0138 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.8917 | Train Acc: 0.8488
 Site-RealWorld                     | Train Loss: 1.9643 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 1.8969 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 1.8220 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 2.0015 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 2.0673 | Train Acc: 0.7576
 Site-Product                       | Train Loss: 1.9878 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.8948 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.8933 | Train Acc: 0.8652
 Site-Product                       | Train Loss: 1.9755 | Train Acc: 0.8226
 Site-amazon                        | Train Loss: 1.9098 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.8718 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.9663 | Train Acc: 0.7826
 Site-amazon                        | Train Loss: 2.0007 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 2.0339 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.9744 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.9232 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.9565 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 2.2696 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.2065 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 2.2633 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.9069 | Train Acc: 0.8966
Average Train Accuracy: 0.8740
 Site-RealWorld                     | Val  Loss: 1.8186 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8916 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8986 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0061 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 2.0474 | Val  Acc: 0.8846
 Site-RealWorld                     | Val  Loss: 1.8818 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.9063 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.9389 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 2.0410 | Val  Acc: 0.8784
 Site-RealWorld                     | Val  Loss: 1.9735 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.8848 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 1.8673 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.7647 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.8811 | Val  Acc: 0.8710
 Site-Product                       | Val  Loss: 1.9943 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.8903 | Val  Acc: 0.8814
 Site-Product                       | Val  Loss: 1.8590 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.9787 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.0593 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.9542 | Val  Acc: 0.7419
 Site-amazon                        | Val  Loss: 1.8844 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 2.0068 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 1.9857 | Val  Acc: 0.9524
 Site-webcam                        | Val  Loss: 1.9635 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.8961 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 2.1312 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 2.1580 | Val  Acc: 0.7679
 Site-Clipart                       | Val  Loss: 2.1892 | Val  Acc: 0.7368
 Site-dslr                          | Val  Loss: 1.8821 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8823
============ Train epoch 21 ============
 Site-RealWorld                     | Train Loss: 1.8689 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.9906 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.9333 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.9600 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.8860 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.9278 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.8950 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.9149 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.9185 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.8206 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 1.8195 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 2.0300 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 2.0111 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.9318 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.8265 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 1.8709 | Train Acc: 0.8427
 Site-Product                       | Train Loss: 1.9175 | Train Acc: 0.8306
 Site-amazon                        | Train Loss: 1.8618 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.8265 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.9014 | Train Acc: 0.8913
 Site-amazon                        | Train Loss: 2.1048 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 2.0467 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.9710 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.8685 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.9252 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 2.2129 | Train Acc: 0.7381
 Site-Art                           | Train Loss: 2.1250 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 2.1321 | Train Acc: 0.7059
 Site-dslr                          | Train Loss: 1.8594 | Train Acc: 0.8966
Average Train Accuracy: 0.8766
 Site-RealWorld                     | Val  Loss: 1.7615 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7428 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8277 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9734 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.0315 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.8228 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.9008 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.9099 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 2.0042 | Val  Acc: 0.8784
 Site-RealWorld                     | Val  Loss: 1.9402 | Val  Acc: 0.8854
 Site-Product                       | Val  Loss: 1.8177 | Val  Acc: 0.8182
 Site-Product                       | Val  Loss: 1.8508 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.7407 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.8220 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.9451 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 1.8429 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.8361 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.9057 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.0339 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.9511 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.8535 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 1.9799 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.9841 | Val  Acc: 0.9524
 Site-webcam                        | Val  Loss: 1.8944 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.8834 | Val  Acc: 0.8906
 Site-Art                           | Val  Loss: 2.0720 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 2.1364 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 2.1361 | Val  Acc: 0.7368
 Site-dslr                          | Val  Loss: 1.8563 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8845
============ Train epoch 22 ============
 Site-RealWorld                     | Train Loss: 1.8199 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.9248 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.9623 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.8997 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.8815 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.8697 | Train Acc: 0.9020
 Site-RealWorld                     | Train Loss: 1.9805 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.7809 | Train Acc: 0.9186
 Site-RealWorld                     | Train Loss: 1.8737 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.7388 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 1.7695 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.9393 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.9849 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.8714 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.7785 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.7901 | Train Acc: 0.8989
 Site-Product                       | Train Loss: 1.8558 | Train Acc: 0.8790
 Site-amazon                        | Train Loss: 1.9364 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.7321 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.8819 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.6864 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.9901 | Train Acc: 0.7692
 Site-webcam                        | Train Loss: 1.9578 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.8345 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.8669 | Train Acc: 0.9381
 Site-Art                           | Train Loss: 2.2268 | Train Acc: 0.7143
 Site-Art                           | Train Loss: 2.0987 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 2.1500 | Train Acc: 0.6353
 Site-dslr                          | Train Loss: 1.8007 | Train Acc: 0.9138
Average Train Accuracy: 0.8776
 Site-RealWorld                     | Val  Loss: 1.7187 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7841 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7627 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9170 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.9752 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7553 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.8485 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.8708 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 1.9631 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 1.8897 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.6994 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7461 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.7181 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.7676 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.8671 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.7782 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.7951 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.9244 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.9730 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.9212 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.8052 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 1.9856 | Val  Acc: 0.8116
 Site-webcam                        | Val  Loss: 1.9155 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.9114 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.8163 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.9852 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 2.0800 | Val  Acc: 0.7679
 Site-Clipart                       | Val  Loss: 2.0913 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.7680 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8937
 Best site-RealWorld                 | Epoch:22 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.8421
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.9054
 Best site-RealWorld                 | Epoch:22 | Val Acc: 0.8750
 Best site-Product                   | Epoch:22 | Val Acc: 1.0000
 Best site-Product                   | Epoch:22 | Val Acc: 0.8750
 Best site-Product                   | Epoch:22 | Val Acc: 0.9091
 Best site-Product                   | Epoch:22 | Val Acc: 0.9032
 Best site-Product                   | Epoch:22 | Val Acc: 0.9070
 Best site-Product                   | Epoch:22 | Val Acc: 0.9492
 Best site-Product                   | Epoch:22 | Val Acc: 0.8659
 Best site-amazon                    | Epoch:22 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:22 | Val Acc: 0.8500
 Best site-amazon                    | Epoch:22 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:22 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:22 | Val Acc: 0.8116
 Best site-webcam                    | Epoch:22 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:22 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:22 | Val Acc: 0.9062
 Best site-Art                       | Epoch:22 | Val Acc: 0.8571
 Best site-Art                       | Epoch:22 | Val Acc: 0.7679
 Best site-Clipart                   | Epoch:22 | Val Acc: 0.7018
 Best site-dslr                      | Epoch:22 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 23 ============
 Site-RealWorld                     | Train Loss: 1.7886 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.9171 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.8980 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.8725 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 1.7927 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.8172 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 2.1287 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 1.8228 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 1.8139 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.7228 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.6983 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.9046 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.9369 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 1.8611 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.7568 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.8081 | Train Acc: 0.8427
 Site-Product                       | Train Loss: 1.8465 | Train Acc: 0.8548
 Site-amazon                        | Train Loss: 1.7586 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.7443 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.8123 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.8140 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.8592 | Train Acc: 0.8365
 Site-webcam                        | Train Loss: 1.8984 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.8083 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.8067 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 2.1772 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 2.0615 | Train Acc: 0.7738
 Site-Clipart                       | Train Loss: 2.0753 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.7693 | Train Acc: 0.9483
Average Train Accuracy: 0.8792
 Site-RealWorld                     | Val  Loss: 1.6797 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7906 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7243 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8422 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.9407 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7459 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.7914 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.8230 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.9082 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.8584 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.7042 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.7014 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.6743 | Val  Acc: 0.8636
 Site-Product                       | Val  Loss: 1.7101 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.8624 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 1.7924 | Val  Acc: 0.8983
 Site-Product                       | Val  Loss: 1.7329 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.9163 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.9598 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.8300 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.7340 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 1.9123 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 1.9433 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 1.8708 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.7756 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 2.0104 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 2.0428 | Val  Acc: 0.7857
 Site-Clipart                       | Val  Loss: 2.0961 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.7903 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8741
============ Train epoch 24 ============
 Site-RealWorld                     | Train Loss: 1.7417 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.8892 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.8988 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.8519 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 1.7651 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.8311 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.8347 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.6906 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.7703 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.6446 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.6056 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.8609 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.8213 | Train Acc: 0.8485
 Site-Product                       | Train Loss: 1.7924 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 1.7018 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.7141 | Train Acc: 0.8764
 Site-Product                       | Train Loss: 1.7939 | Train Acc: 0.8548
 Site-amazon                        | Train Loss: 1.8091 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.6737 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.8216 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.8237 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.8670 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 1.8239 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.7422 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.8205 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 2.1346 | Train Acc: 0.7381
 Site-Art                           | Train Loss: 2.0498 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 2.1405 | Train Acc: 0.6000
 Site-dslr                          | Train Loss: 1.7246 | Train Acc: 0.9138
Average Train Accuracy: 0.8744
 Site-RealWorld                     | Val  Loss: 1.5966 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6564 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6938 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8445 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.9050 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.6985 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.7419 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.7893 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.8728 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.8281 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.7000 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.6442 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.5705 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.6956 | Val  Acc: 0.8387
 Site-Product                       | Val  Loss: 1.8351 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.7267 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.6654 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.7376 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.8579 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.7897 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.7042 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.8419 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.8862 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 1.8409 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.7755 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 2.0433 | Val  Acc: 0.6786
 Site-Art                           | Val  Loss: 2.0328 | Val  Acc: 0.7857
 Site-Clipart                       | Val  Loss: 2.0762 | Val  Acc: 0.6491
 Site-dslr                          | Val  Loss: 1.7144 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8833
============ Train epoch 25 ============
 Site-RealWorld                     | Train Loss: 1.7219 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.7373 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.8694 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.7960 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.7110 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.7493 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.9065 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.6551 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 1.7505 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.6610 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.6421 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 1.8183 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 1.8685 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.7910 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.7000 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.6558 | Train Acc: 0.8876
 Site-Product                       | Train Loss: 1.7436 | Train Acc: 0.8952
 Site-amazon                        | Train Loss: 1.6926 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.5659 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.7517 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.9186 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 1.8413 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 1.7780 | Train Acc: 0.9375
 Site-webcam                        | Train Loss: 1.7059 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.7536 | Train Acc: 0.9381
 Site-Art                           | Train Loss: 2.0959 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.9603 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 2.0950 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.6376 | Train Acc: 0.9655
Average Train Accuracy: 0.8886
 Site-RealWorld                     | Val  Loss: 1.5191 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6112 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6937 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 1.8064 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.8359 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.6429 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.7141 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.7368 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.8691 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 1.7911 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 1.6386 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.6325 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.5275 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.6290 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.8016 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.6165 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.6254 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.8244 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.8536 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.7871 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.6347 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.7403 | Val  Acc: 0.8986
 Site-webcam                        | Val  Loss: 1.7693 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.7989 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.7298 | Val  Acc: 0.8906
 Site-Art                           | Val  Loss: 1.9191 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.9867 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 2.0392 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 1.6276 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8866
============ Train epoch 26 ============
 Site-RealWorld                     | Train Loss: 1.6340 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7768 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.7816 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.7318 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.6748 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.7158 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.6234 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.6516 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.6909 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.5686 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 1.5510 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.7885 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.8041 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.7565 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.6164 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.6525 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.7231 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.7070 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.5586 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.7466 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.6940 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.8355 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 1.7545 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.7140 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.7030 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 2.1269 | Train Acc: 0.6667
 Site-Art                           | Train Loss: 1.9850 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.9783 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.6429 | Train Acc: 0.8966
Average Train Accuracy: 0.8746
 Site-RealWorld                     | Val  Loss: 1.4603 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6386 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5958 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7858 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.8172 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5980 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.6771 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 1.6854 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.8020 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.7171 | Val  Acc: 0.9062
 Site-Product                       | Val  Loss: 1.4929 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6422 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.5008 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.5766 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.7856 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.6162 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 1.6182 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.7773 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.8443 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.7307 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.6332 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.8058 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 1.7835 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.7028 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.6444 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.8961 | Val  Acc: 0.7143
 Site-Art                           | Val  Loss: 1.9644 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.9784 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 1.6384 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8910
============ Train epoch 27 ============
 Site-RealWorld                     | Train Loss: 1.6057 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.7470 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.7941 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.7277 | Train Acc: 0.8710
 Site-RealWorld                     | Train Loss: 1.6852 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.6776 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.6793 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.6462 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.6623 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.5895 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 1.5438 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 1.7128 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.8460 | Train Acc: 0.7576
 Site-Product                       | Train Loss: 1.6880 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.5786 | Train Acc: 0.9688
 Site-Product                       | Train Loss: 1.5694 | Train Acc: 0.9101
 Site-Product                       | Train Loss: 1.6781 | Train Acc: 0.8468
 Site-amazon                        | Train Loss: 1.6158 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.5357 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.6868 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.6740 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.7657 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.6949 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.6423 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.6375 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 2.0727 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.9390 | Train Acc: 0.7619
 Site-Clipart                       | Train Loss: 2.0226 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.5814 | Train Acc: 0.9483
Average Train Accuracy: 0.8756
 Site-RealWorld                     | Val  Loss: 1.4423 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5305 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5625 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7242 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.7998 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5435 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.6421 | Val  Acc: 0.9773
 Site-RealWorld                     | Val  Loss: 1.6452 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.7628 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.7115 | Val  Acc: 0.8542
 Site-Product                       | Val  Loss: 1.4843 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5386 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.4071 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.5543 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.7050 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.5673 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 1.5739 | Val  Acc: 0.9146
 Site-amazon                        | Val  Loss: 1.7784 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.7908 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.6756 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.5264 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.6697 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.6848 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 1.7373 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.6521 | Val  Acc: 0.8906
 Site-Art                           | Val  Loss: 1.8952 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.9135 | Val  Acc: 0.7679
 Site-Clipart                       | Val  Loss: 1.9471 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.5417 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8914
============ Train epoch 28 ============
 Site-RealWorld                     | Train Loss: 1.6375 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.6882 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.6766 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.6790 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.6071 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.6404 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.8093 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.5277 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 1.6363 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.5084 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 1.3994 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.7317 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.7421 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.6552 | Train Acc: 0.8043
 Site-Product                       | Train Loss: 1.5539 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.5282 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.6296 | Train Acc: 0.8952
 Site-amazon                        | Train Loss: 1.6379 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.5054 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.6338 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.4038 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.6975 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.7327 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.5986 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.5922 | Train Acc: 0.9485
 Site-Art                           | Train Loss: 1.9825 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.8534 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 1.8999 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.5404 | Train Acc: 0.9138
Average Train Accuracy: 0.8752
 Site-RealWorld                     | Val  Loss: 1.4199 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4586 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4910 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6571 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.7951 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5539 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5994 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.6143 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.7202 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 1.6220 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.4904 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.4524 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.4145 | Val  Acc: 0.8636
 Site-Product                       | Val  Loss: 1.5057 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.7040 | Val  Acc: 0.8372
 Site-Product                       | Val  Loss: 1.5413 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.5292 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.7576 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.7992 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.5979 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.5550 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.5969 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.6528 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.6538 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.5737 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 1.8490 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.8846 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.9355 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.5401 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8889
============ Train epoch 29 ============
 Site-RealWorld                     | Train Loss: 1.5023 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6415 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.6441 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.6377 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.5947 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.6051 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.5409 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 1.5278 | Train Acc: 0.9186
 Site-RealWorld                     | Train Loss: 1.6223 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.4889 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 1.4174 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.6750 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.7357 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.6472 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.5326 | Train Acc: 0.9062
 Site-Product                       | Train Loss: 1.5084 | Train Acc: 0.9101
 Site-Product                       | Train Loss: 1.5917 | Train Acc: 0.8871
 Site-amazon                        | Train Loss: 1.5032 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.4348 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.6104 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.3124 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.7000 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.7119 | Train Acc: 0.7812
 Site-webcam                        | Train Loss: 1.5369 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.6369 | Train Acc: 0.8866
 Site-Art                           | Train Loss: 2.0201 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.8336 | Train Acc: 0.8214
 Site-Clipart                       | Train Loss: 1.9005 | Train Acc: 0.6706
 Site-dslr                          | Train Loss: 1.5083 | Train Acc: 0.9483
Average Train Accuracy: 0.8843
 Site-RealWorld                     | Val  Loss: 1.3246 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4850 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4499 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6261 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.7030 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4945 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5544 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.6174 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.7293 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.6036 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.4146 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4687 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.4121 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.4650 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.6209 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 1.5207 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 1.5234 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.6539 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.7903 | Val  Acc: 0.7000
 Site-amazon                        | Val  Loss: 1.6165 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.4708 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.7482 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 1.6426 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.6408 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.5346 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 1.7808 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.8621 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.9345 | Val  Acc: 0.6842
 Site-dslr                          | Val  Loss: 1.4996 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8883
============ Train epoch 30 ============
 Site-RealWorld                     | Train Loss: 1.4711 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.6582 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.6246 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.5905 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.5203 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.5557 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 1.6927 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.5195 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 1.5568 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 1.4122 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 1.4362 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.7199 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.6601 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.5572 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.4798 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.4712 | Train Acc: 0.9101
 Site-Product                       | Train Loss: 1.5535 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.6612 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.4103 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.5710 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.8350 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 1.6451 | Train Acc: 0.7981
 Site-webcam                        | Train Loss: 1.6808 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.5007 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.6035 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 1.9366 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.8274 | Train Acc: 0.8214
 Site-Clipart                       | Train Loss: 1.9330 | Train Acc: 0.6706
 Site-dslr                          | Train Loss: 1.4930 | Train Acc: 0.9138
Average Train Accuracy: 0.8782
 Site-RealWorld                     | Val  Loss: 1.4202 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4947 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3871 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6326 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.6717 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4661 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5118 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.5404 | Val  Acc: 0.8070
 Site-RealWorld                     | Val  Loss: 1.6428 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.6125 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.4830 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.4604 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 1.4003 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.4744 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.6155 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.4508 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.4506 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.6708 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.6783 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.5715 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.4591 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.6057 | Val  Acc: 0.8261
 Site-webcam                        | Val  Loss: 1.6500 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 1.6204 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 1.5190 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.8275 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.7658 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.8715 | Val  Acc: 0.7544
 Site-dslr                          | Val  Loss: 1.4788 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8859
============ Train epoch 31 ============
 Site-RealWorld                     | Train Loss: 1.5147 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.5201 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.5537 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.5900 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.5000 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.5242 | Train Acc: 0.9608
 Site-RealWorld                     | Train Loss: 1.5677 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.5493 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.5151 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.3809 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 1.3855 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.6683 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 1.6631 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.5142 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.3999 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.4007 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.5165 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 1.4887 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3490 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.5396 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.5214 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.6198 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 1.5804 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.5159 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 1.5232 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 1.9175 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.8276 | Train Acc: 0.8095
 Site-Clipart                       | Train Loss: 1.8291 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.4231 | Train Acc: 0.9138
Average Train Accuracy: 0.8877
 Site-RealWorld                     | Val  Loss: 1.3125 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4677 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4184 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5754 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.6186 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4412 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.4355 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.5178 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 1.6274 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.5413 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.3108 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4080 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.2848 | Val  Acc: 0.8636
 Site-Product                       | Val  Loss: 1.4256 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.5607 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.3810 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.4299 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.5944 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.5828 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.5582 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.4250 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.6139 | Val  Acc: 0.8986
 Site-webcam                        | Val  Loss: 1.5732 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.5597 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.4583 | Val  Acc: 0.9688
 Site-Art                           | Val  Loss: 1.7230 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.8088 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.9090 | Val  Acc: 0.6667
 Site-dslr                          | Val  Loss: 1.4449 | Val  Acc: 0.8684
Average Valid Accuracy: 0.8959
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.8421
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9189
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.8958
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 0.8750
 Best site-Product                   | Epoch:31 | Val Acc: 0.8636
 Best site-Product                   | Epoch:31 | Val Acc: 0.9355
 Best site-Product                   | Epoch:31 | Val Acc: 0.8837
 Best site-Product                   | Epoch:31 | Val Acc: 0.9492
 Best site-Product                   | Epoch:31 | Val Acc: 0.8902
 Best site-amazon                    | Epoch:31 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8000
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:31 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8986
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:31 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9688
 Best site-Art                       | Epoch:31 | Val Acc: 0.8571
 Best site-Art                       | Epoch:31 | Val Acc: 0.8036
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.6667
 Best site-dslr                      | Epoch:31 | Val Acc: 0.8684
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 32 ============
 Site-RealWorld                     | Train Loss: 1.4488 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.5864 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.5648 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.5217 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.4962 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.5216 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.3208 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.3879 | Train Acc: 0.8721
 Site-RealWorld                     | Train Loss: 1.4937 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.3312 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.2925 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 1.6361 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.5953 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.4905 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.4135 | Train Acc: 0.8594
 Site-Product                       | Train Loss: 1.3491 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.4823 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 1.4636 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3532 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.5060 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.6623 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.5958 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.5588 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.4454 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 1.5279 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 1.8818 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.8830 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 1.8562 | Train Acc: 0.7294
 Site-dslr                          | Train Loss: 1.3869 | Train Acc: 0.9310
Average Train Accuracy: 0.8806
 Site-RealWorld                     | Val  Loss: 1.1756 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3252 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3443 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5029 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.6125 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.3372 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.4590 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 1.5034 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.6450 | Val  Acc: 0.8784
 Site-RealWorld                     | Val  Loss: 1.4644 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.3143 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.3687 | Val  Acc: 0.9375
 Site-Product                       | Val  Loss: 1.2294 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.3481 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.5129 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.3523 | Val  Acc: 0.9661
 Site-Product                       | Val  Loss: 1.3914 | Val  Acc: 0.8415
 Site-amazon                        | Val  Loss: 1.5656 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.4946 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.5182 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.3965 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.5316 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.5617 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.5167 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.4063 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 1.6869 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.7448 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 1.8527 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 1.3746 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8963
 Best site-RealWorld                 | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.8864
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.8246
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.8784
 Best site-RealWorld                 | Epoch:32 | Val Acc: 0.8750
 Best site-Product                   | Epoch:32 | Val Acc: 0.9091
 Best site-Product                   | Epoch:32 | Val Acc: 0.9375
 Best site-Product                   | Epoch:32 | Val Acc: 0.9091
 Best site-Product                   | Epoch:32 | Val Acc: 0.9032
 Best site-Product                   | Epoch:32 | Val Acc: 0.9070
 Best site-Product                   | Epoch:32 | Val Acc: 0.9661
 Best site-Product                   | Epoch:32 | Val Acc: 0.8415
 Best site-amazon                    | Epoch:32 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:32 | Val Acc: 0.8500
 Best site-amazon                    | Epoch:32 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:32 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:32 | Val Acc: 0.8696
 Best site-webcam                    | Epoch:32 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:32 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:32 | Val Acc: 0.9531
 Best site-Art                       | Epoch:32 | Val Acc: 0.8571
 Best site-Art                       | Epoch:32 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:32 | Val Acc: 0.7193
 Best site-dslr                      | Epoch:32 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 33 ============
 Site-RealWorld                     | Train Loss: 1.3471 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4958 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.5513 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.4665 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.4498 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.4181 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.3227 | Train Acc: 0.8209
 Site-RealWorld                     | Train Loss: 1.4318 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.4468 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.2535 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 1.3359 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.5820 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.6377 | Train Acc: 0.6970
 Site-Product                       | Train Loss: 1.4713 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.3409 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.3871 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.4564 | Train Acc: 0.8871
 Site-amazon                        | Train Loss: 1.4550 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.2667 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.4326 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 1.2988 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.5859 | Train Acc: 0.7692
 Site-webcam                        | Train Loss: 1.5473 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 1.4035 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.4897 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 1.8055 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.7061 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 1.8849 | Train Acc: 0.6471
 Site-dslr                          | Train Loss: 1.3385 | Train Acc: 0.9828
Average Train Accuracy: 0.8783
 Site-RealWorld                     | Val  Loss: 1.2134 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2788 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3010 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4586 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.6012 | Val  Acc: 0.8846
 Site-RealWorld                     | Val  Loss: 1.3442 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.4438 | Val  Acc: 0.8636
 Site-RealWorld                     | Val  Loss: 1.4088 | Val  Acc: 0.8246
 Site-RealWorld                     | Val  Loss: 1.5569 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 1.4841 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 1.2776 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.3635 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.1865 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.3783 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.5365 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.3247 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.3228 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.5528 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.6030 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.4593 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 1.3375 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.6260 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.4833 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.5711 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 1.3967 | Val  Acc: 0.9375
 Site-Art                           | Val  Loss: 1.7363 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.7347 | Val  Acc: 0.8393
 Site-Clipart                       | Val  Loss: 1.8302 | Val  Acc: 0.7544
 Site-dslr                          | Val  Loss: 1.3557 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8934
============ Train epoch 34 ============
 Site-RealWorld                     | Train Loss: 1.3081 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.5340 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.4422 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.4681 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.3997 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.4396 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 1.4935 | Train Acc: 0.9403
 Site-RealWorld                     | Train Loss: 1.3678 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.4312 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.2745 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.1942 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.5147 | Train Acc: 0.9167
 Site-Product                       | Train Loss: 1.6264 | Train Acc: 0.7576
 Site-Product                       | Train Loss: 1.4717 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.3309 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.4548 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.4359 | Train Acc: 0.8952
 Site-amazon                        | Train Loss: 1.3916 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3133 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.4650 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 1.3353 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.5545 | Train Acc: 0.8365
 Site-webcam                        | Train Loss: 1.5314 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 1.4155 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.4054 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 1.8655 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.7197 | Train Acc: 0.8214
 Site-Clipart                       | Train Loss: 1.7763 | Train Acc: 0.6706
 Site-dslr                          | Train Loss: 1.3587 | Train Acc: 0.8966
Average Train Accuracy: 0.8849
 Site-RealWorld                     | Val  Loss: 1.2088 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1988 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2467 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4545 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.5361 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2710 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.3863 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 1.3910 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 1.5399 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 1.4393 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.2089 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.2910 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 1.2873 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.2912 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.5145 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.3059 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.3112 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.5512 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.5653 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.4117 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.3656 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.5080 | Val  Acc: 0.8986
 Site-webcam                        | Val  Loss: 1.4743 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 1.4655 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.4569 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.6790 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.6954 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.8132 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.2818 | Val  Acc: 1.0000
Average Valid Accuracy: 0.8874
============ Train epoch 35 ============
 Site-RealWorld                     | Train Loss: 1.3294 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.4701 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.4192 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.4277 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.3411 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.4130 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 1.4856 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.3370 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.3993 | Train Acc: 0.9459
 Site-RealWorld                     | Train Loss: 1.2365 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 1.1766 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 1.4830 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.4911 | Train Acc: 0.8485
 Site-Product                       | Train Loss: 1.3789 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.2533 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.2911 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.4092 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 1.3114 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.2626 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.4343 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.3737 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.5432 | Train Acc: 0.7596
 Site-webcam                        | Train Loss: 1.3970 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.3261 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.3778 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 1.8367 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.7563 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 1.7357 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.3323 | Train Acc: 0.8793
Average Train Accuracy: 0.8832
 Site-RealWorld                     | Val  Loss: 1.1215 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2805 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1971 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4507 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.4664 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2557 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.3708 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.3730 | Val  Acc: 0.8070
 Site-RealWorld                     | Val  Loss: 1.4916 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.4096 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 1.1223 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2652 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.1383 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.2982 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.4193 | Val  Acc: 0.9302
 Site-Product                       | Val  Loss: 1.3103 | Val  Acc: 0.8983
 Site-Product                       | Val  Loss: 1.2464 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.3834 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.5882 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.3978 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.2978 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.4843 | Val  Acc: 0.8986
 Site-webcam                        | Val  Loss: 1.4270 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.4508 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.3283 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.6106 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.6504 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 1.6898 | Val  Acc: 0.7368
 Site-dslr                          | Val  Loss: 1.2582 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9005
 Best site-RealWorld                 | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.8070
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:35 | Val Acc: 0.8646
 Best site-Product                   | Epoch:35 | Val Acc: 1.0000
 Best site-Product                   | Epoch:35 | Val Acc: 0.8750
 Best site-Product                   | Epoch:35 | Val Acc: 0.9091
 Best site-Product                   | Epoch:35 | Val Acc: 0.9355
 Best site-Product                   | Epoch:35 | Val Acc: 0.9302
 Best site-Product                   | Epoch:35 | Val Acc: 0.8983
 Best site-Product                   | Epoch:35 | Val Acc: 0.8902
 Best site-amazon                    | Epoch:35 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:35 | Val Acc: 0.9000
 Best site-amazon                    | Epoch:35 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:35 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:35 | Val Acc: 0.8986
 Best site-webcam                    | Epoch:35 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:35 | Val Acc: 0.9189
 Best site-webcam                    | Epoch:35 | Val Acc: 0.9062
 Best site-Art                       | Epoch:35 | Val Acc: 0.8214
 Best site-Art                       | Epoch:35 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:35 | Val Acc: 0.7368
 Best site-dslr                      | Epoch:35 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 36 ============
 Site-RealWorld                     | Train Loss: 1.2924 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.5369 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.3770 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.3874 | Train Acc: 0.9032
 Site-RealWorld                     | Train Loss: 1.3292 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.3592 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 1.2394 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.2856 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.3289 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.1829 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 1.1333 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.5013 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.5003 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.4240 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.2281 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.3338 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.4061 | Train Acc: 0.8790
 Site-amazon                        | Train Loss: 1.3305 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.1787 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.3951 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 1.1620 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.4695 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.4251 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.3082 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.3470 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 1.8734 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.6786 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.7015 | Train Acc: 0.7176
 Site-dslr                          | Train Loss: 1.2562 | Train Acc: 0.8966
Average Train Accuracy: 0.8819
 Site-RealWorld                     | Val  Loss: 1.0878 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1410 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 1.1569 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4036 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.5075 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2760 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.2723 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.3605 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.4381 | Val  Acc: 0.9324
 Site-RealWorld                     | Val  Loss: 1.3461 | Val  Acc: 0.9062
 Site-Product                       | Val  Loss: 1.1332 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3203 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.1211 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.1990 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.4066 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.2236 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.2746 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.4175 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.4201 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.4289 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.2808 | Val  Acc: 0.8913
 Site-amazon                        | Val  Loss: 1.4436 | Val  Acc: 0.8551
 Site-webcam                        | Val  Loss: 1.3301 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.3858 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.3087 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 1.6140 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.6764 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.7515 | Val  Acc: 0.7544
 Site-dslr                          | Val  Loss: 1.1550 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9034
 Best site-RealWorld                 | Epoch:36 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:36 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.8596
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9324
 Best site-RealWorld                 | Epoch:36 | Val Acc: 0.9062
 Best site-Product                   | Epoch:36 | Val Acc: 1.0000
 Best site-Product                   | Epoch:36 | Val Acc: 0.8750
 Best site-Product                   | Epoch:36 | Val Acc: 0.9545
 Best site-Product                   | Epoch:36 | Val Acc: 0.9355
 Best site-Product                   | Epoch:36 | Val Acc: 0.9070
 Best site-Product                   | Epoch:36 | Val Acc: 0.9492
 Best site-Product                   | Epoch:36 | Val Acc: 0.8659
 Best site-amazon                    | Epoch:36 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:36 | Val Acc: 0.9000
 Best site-amazon                    | Epoch:36 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:36 | Val Acc: 0.8913
 Best site-amazon                    | Epoch:36 | Val Acc: 0.8551
 Best site-webcam                    | Epoch:36 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:36 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:36 | Val Acc: 0.9219
 Best site-Art                       | Epoch:36 | Val Acc: 0.8214
 Best site-Art                       | Epoch:36 | Val Acc: 0.8036
 Best site-Clipart                   | Epoch:36 | Val Acc: 0.7544
 Best site-dslr                      | Epoch:36 | Val Acc: 0.9737
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 37 ============
 Site-RealWorld                     | Train Loss: 1.2745 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.3188 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.3741 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.3267 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.3193 | Train Acc: 0.8250
 Site-RealWorld                     | Train Loss: 1.3447 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.1518 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.2982 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 1.3296 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.2163 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.1400 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.4095 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.4874 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.3507 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.1973 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.2250 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.3229 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.2433 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.1506 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.4025 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.4955 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.4689 | Train Acc: 0.7885
 Site-webcam                        | Train Loss: 1.3875 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.2541 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 1.3546 | Train Acc: 0.9485
 Site-Art                           | Train Loss: 1.7193 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.6546 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.7744 | Train Acc: 0.7059
 Site-dslr                          | Train Loss: 1.2607 | Train Acc: 0.9483
Average Train Accuracy: 0.8881
 Site-RealWorld                     | Val  Loss: 1.1125 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1234 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1341 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3379 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.4746 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2155 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2962 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.2942 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 1.3983 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.3667 | Val  Acc: 0.9167
 Site-Product                       | Val  Loss: 1.1526 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2235 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 1.1231 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.1672 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.3978 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.1880 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.2149 | Val  Acc: 0.8537
 Site-amazon                        | Val  Loss: 1.4226 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.4697 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.4128 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.2371 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.3165 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.2964 | Val  Acc: 0.9524
 Site-webcam                        | Val  Loss: 1.3113 | Val  Acc: 0.8649
 Site-webcam                        | Val  Loss: 1.2730 | Val  Acc: 0.8906
 Site-Art                           | Val  Loss: 1.5978 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.6097 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.6680 | Val  Acc: 0.7719
 Site-dslr                          | Val  Loss: 1.2309 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8992
============ Train epoch 38 ============
 Site-RealWorld                     | Train Loss: 1.3030 | Train Acc: 0.7857
 Site-RealWorld                     | Train Loss: 1.4399 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.3788 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.3293 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.2574 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.2853 | Train Acc: 0.9608
 Site-RealWorld                     | Train Loss: 1.3185 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 1.2353 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.2722 | Train Acc: 0.9189
 Site-RealWorld                     | Train Loss: 1.1304 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 1.0610 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.4469 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.3932 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.3251 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.1677 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.2133 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.3154 | Train Acc: 0.8952
 Site-amazon                        | Train Loss: 1.3244 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.1316 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.3256 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.1796 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.3894 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.3546 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.2258 | Train Acc: 0.9821
 Site-webcam                        | Train Loss: 1.2480 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 1.7407 | Train Acc: 0.8810
 Site-Art                           | Train Loss: 1.6819 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.6744 | Train Acc: 0.7059
 Site-dslr                          | Train Loss: 1.1820 | Train Acc: 0.9483
Average Train Accuracy: 0.8935
 Site-RealWorld                     | Val  Loss: 1.0199 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0771 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0961 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4078 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.4696 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1329 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.2500 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.3081 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 1.4368 | Val  Acc: 0.9054
 Site-RealWorld                     | Val  Loss: 1.3201 | Val  Acc: 0.8854
 Site-Product                       | Val  Loss: 1.1452 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.1806 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.0945 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.2275 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.3541 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.1468 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.1742 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.2505 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4003 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.3650 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.1982 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.4115 | Val  Acc: 0.8986
 Site-webcam                        | Val  Loss: 1.3192 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.2651 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.2516 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 1.5532 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.6251 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.6973 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 1.1647 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9012
============ Train epoch 39 ============
 Site-RealWorld                     | Train Loss: 1.2130 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.3839 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.3332 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2949 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.2223 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.2386 | Train Acc: 0.9020
 Site-RealWorld                     | Train Loss: 1.5234 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.1604 | Train Acc: 0.9419
 Site-RealWorld                     | Train Loss: 1.2702 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.1798 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 1.0378 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.4016 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.4667 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.3008 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.1428 | Train Acc: 0.9688
 Site-Product                       | Train Loss: 1.2649 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.2519 | Train Acc: 0.8871
 Site-amazon                        | Train Loss: 1.2286 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.1209 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.3480 | Train Acc: 0.7826
 Site-amazon                        | Train Loss: 1.3098 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.4415 | Train Acc: 0.8173
 Site-webcam                        | Train Loss: 1.2784 | Train Acc: 0.9062
 Site-webcam                        | Train Loss: 1.1738 | Train Acc: 0.9821
 Site-webcam                        | Train Loss: 1.2317 | Train Acc: 0.9381
 Site-Art                           | Train Loss: 1.7864 | Train Acc: 0.7381
 Site-Art                           | Train Loss: 1.5911 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 1.7837 | Train Acc: 0.6824
 Site-dslr                          | Train Loss: 1.1266 | Train Acc: 0.9310
Average Train Accuracy: 0.8897
 Site-RealWorld                     | Val  Loss: 1.0162 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0863 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0682 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3173 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.3847 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1160 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2236 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.2841 | Val  Acc: 0.8421
 Site-RealWorld                     | Val  Loss: 1.3346 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 1.2845 | Val  Acc: 0.8854
 Site-Product                       | Val  Loss: 1.0137 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2198 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.0035 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.1296 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.3461 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.1569 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 1.1280 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.2577 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4676 | Val  Acc: 0.8000
 Site-amazon                        | Val  Loss: 1.2844 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.2092 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 1.2660 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.3744 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 1.2972 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.1145 | Val  Acc: 0.9844
 Site-Art                           | Val  Loss: 1.5812 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.5690 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 1.6903 | Val  Acc: 0.7719
 Site-dslr                          | Val  Loss: 1.1125 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9048
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9318
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.8421
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.8854
 Best site-Product                   | Epoch:39 | Val Acc: 1.0000
 Best site-Product                   | Epoch:39 | Val Acc: 0.8750
 Best site-Product                   | Epoch:39 | Val Acc: 0.9545
 Best site-Product                   | Epoch:39 | Val Acc: 0.9355
 Best site-Product                   | Epoch:39 | Val Acc: 0.9070
 Best site-Product                   | Epoch:39 | Val Acc: 0.9322
 Best site-Product                   | Epoch:39 | Val Acc: 0.8780
 Best site-amazon                    | Epoch:39 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:39 | Val Acc: 0.8000
 Best site-amazon                    | Epoch:39 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:39 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:39 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:39 | Val Acc: 0.8095
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9459
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9844
 Best site-Art                       | Epoch:39 | Val Acc: 0.8214
 Best site-Art                       | Epoch:39 | Val Acc: 0.8214
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.7719
 Best site-dslr                      | Epoch:39 | Val Acc: 0.9211
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 40 ============
 Site-RealWorld                     | Train Loss: 1.1171 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3487 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.3102 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.2227 | Train Acc: 0.9677
 Site-RealWorld                     | Train Loss: 1.2263 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.2572 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 1.1326 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 1.1594 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.2395 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 1.0801 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 0.9907 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.3771 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.3370 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.2181 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.0867 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.1955 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.2679 | Train Acc: 0.8790
 Site-amazon                        | Train Loss: 1.1841 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.0394 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.2500 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.0990 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.4109 | Train Acc: 0.7981
 Site-webcam                        | Train Loss: 1.2669 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 1.1591 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.2482 | Train Acc: 0.8969
 Site-Art                           | Train Loss: 1.6764 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.5833 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.6561 | Train Acc: 0.6941
 Site-dslr                          | Train Loss: 1.1349 | Train Acc: 0.9310
Average Train Accuracy: 0.8915
 Site-RealWorld                     | Val  Loss: 0.9208 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1041 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0210 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2480 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.3858 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1003 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.1752 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.2162 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 1.3250 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.2800 | Val  Acc: 0.9167
 Site-Product                       | Val  Loss: 1.0371 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1343 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.9876 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.1640 | Val  Acc: 0.8710
 Site-Product                       | Val  Loss: 1.3206 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 1.1422 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 1.1088 | Val  Acc: 0.8659
 Site-amazon                        | Val  Loss: 1.2596 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.3420 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.3432 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.2115 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.2900 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.3168 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.2447 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.1613 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.5187 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.5855 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 1.6125 | Val  Acc: 0.7544
 Site-dslr                          | Val  Loss: 1.0779 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9042
============ Train epoch 41 ============
 Site-RealWorld                     | Train Loss: 1.1089 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.3261 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.3608 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.2539 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.2209 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.2092 | Train Acc: 0.9608
 Site-RealWorld                     | Train Loss: 1.2351 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.1462 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 1.2077 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.0823 | Train Acc: 0.9722
 Site-Product                       | Train Loss: 0.9588 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.3122 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.3370 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.2370 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 1.0974 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.0981 | Train Acc: 0.9326
 Site-Product                       | Train Loss: 1.2443 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.1481 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.0298 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.3459 | Train Acc: 0.8043
 Site-amazon                        | Train Loss: 1.2290 | Train Acc: 0.8841
 Site-amazon                        | Train Loss: 1.3566 | Train Acc: 0.8269
 Site-webcam                        | Train Loss: 1.2651 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.1498 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.2436 | Train Acc: 0.9072
 Site-Art                           | Train Loss: 1.7816 | Train Acc: 0.7619
 Site-Art                           | Train Loss: 1.5703 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.6306 | Train Acc: 0.7059
 Site-dslr                          | Train Loss: 1.1074 | Train Acc: 0.8966
Average Train Accuracy: 0.8802
 Site-RealWorld                     | Val  Loss: 0.9463 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9938 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9707 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2450 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.3679 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0595 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.1181 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.1895 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 1.3083 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.2406 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 0.9215 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1213 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.9820 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1345 | Val  Acc: 0.8710
 Site-Product                       | Val  Loss: 1.3164 | Val  Acc: 0.9070
 Site-Product                       | Val  Loss: 1.0586 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.0903 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.2539 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.3912 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.3360 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.0934 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.3395 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.2673 | Val  Acc: 0.9524
 Site-webcam                        | Val  Loss: 1.2394 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 1.1229 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 1.4880 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.4897 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.5594 | Val  Acc: 0.7719
 Site-dslr                          | Val  Loss: 1.0287 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9056
 Best site-RealWorld                 | Epoch:41 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:41 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:41 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.8772
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.9189
 Best site-RealWorld                 | Epoch:41 | Val Acc: 0.8958
 Best site-Product                   | Epoch:41 | Val Acc: 1.0000
 Best site-Product                   | Epoch:41 | Val Acc: 0.8750
 Best site-Product                   | Epoch:41 | Val Acc: 1.0000
 Best site-Product                   | Epoch:41 | Val Acc: 0.8710
 Best site-Product                   | Epoch:41 | Val Acc: 0.9070
 Best site-Product                   | Epoch:41 | Val Acc: 0.9492
 Best site-Product                   | Epoch:41 | Val Acc: 0.8780
 Best site-amazon                    | Epoch:41 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:41 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:41 | Val Acc: 0.8065
 Best site-amazon                    | Epoch:41 | Val Acc: 0.9348
 Best site-amazon                    | Epoch:41 | Val Acc: 0.8841
 Best site-webcam                    | Epoch:41 | Val Acc: 0.9524
 Best site-webcam                    | Epoch:41 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:41 | Val Acc: 0.9219
 Best site-Art                       | Epoch:41 | Val Acc: 0.8571
 Best site-Art                       | Epoch:41 | Val Acc: 0.8036
 Best site-Clipart                   | Epoch:41 | Val Acc: 0.7719
 Best site-dslr                      | Epoch:41 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 42 ============
 Site-RealWorld                     | Train Loss: 1.1315 | Train Acc: 0.8571
 Site-RealWorld                     | Train Loss: 1.2881 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.2191 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2230 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.1588 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.1968 | Train Acc: 0.9804
 Site-RealWorld                     | Train Loss: 1.2218 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.1085 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.1556 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 0.9694 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 0.9410 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.3016 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.3336 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.2196 | Train Acc: 0.8696
 Site-Product                       | Train Loss: 1.0515 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.1610 | Train Acc: 0.8876
 Site-Product                       | Train Loss: 1.2560 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 1.1746 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.0148 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.2331 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.4239 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.3282 | Train Acc: 0.7981
 Site-webcam                        | Train Loss: 1.1897 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 1.1035 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 1.1828 | Train Acc: 0.9485
 Site-Art                           | Train Loss: 1.6949 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.5688 | Train Acc: 0.8571
 Site-Clipart                       | Train Loss: 1.4946 | Train Acc: 0.7294
 Site-dslr                          | Train Loss: 1.0659 | Train Acc: 0.9310
Average Train Accuracy: 0.8998
 Site-RealWorld                     | Val  Loss: 0.9861 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9486 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9979 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2073 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.3006 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0486 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.1553 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.1820 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.2514 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.2240 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 0.9267 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1278 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.9105 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 1.0868 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.2680 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.0340 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 1.0158 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.3023 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.2620 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.2181 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.0446 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.1640 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.2775 | Val  Acc: 0.8095
 Site-webcam                        | Val  Loss: 1.2366 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.0473 | Val  Acc: 0.9688
 Site-Art                           | Val  Loss: 1.4659 | Val  Acc: 0.8929
 Site-Art                           | Val  Loss: 1.4657 | Val  Acc: 0.8214
 Site-Clipart                       | Val  Loss: 1.6099 | Val  Acc: 0.6842
 Site-dslr                          | Val  Loss: 1.0687 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9003
============ Train epoch 43 ============
 Site-RealWorld                     | Train Loss: 1.0469 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2519 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.2092 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.1558 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.1389 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.1728 | Train Acc: 0.8824
 Site-RealWorld                     | Train Loss: 1.4695 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.1394 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.1609 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 0.9526 | Train Acc: 0.9931
 Site-Product                       | Train Loss: 0.9342 | Train Acc: 0.8824
 Site-Product                       | Train Loss: 1.3321 | Train Acc: 0.8333
 Site-Product                       | Train Loss: 1.3677 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 1.2573 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 1.0417 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.0590 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.1787 | Train Acc: 0.8871
 Site-amazon                        | Train Loss: 1.1383 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9161 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.2075 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.1856 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.3261 | Train Acc: 0.8269
 Site-webcam                        | Train Loss: 1.1780 | Train Acc: 0.9375
 Site-webcam                        | Train Loss: 1.0939 | Train Acc: 0.9643
 Site-webcam                        | Train Loss: 1.1654 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 1.6440 | Train Acc: 0.7857
 Site-Art                           | Train Loss: 1.4485 | Train Acc: 0.7976
 Site-Clipart                       | Train Loss: 1.5977 | Train Acc: 0.7176
 Site-dslr                          | Train Loss: 1.0386 | Train Acc: 0.9655
Average Train Accuracy: 0.8957
 Site-RealWorld                     | Val  Loss: 0.8319 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9827 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9652 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2254 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.2961 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0278 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.1165 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.1505 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 1.2205 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.1769 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.0338 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 1.0738 | Val  Acc: 0.9375
 Site-Product                       | Val  Loss: 0.8812 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 0.9808 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.2186 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.0220 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 1.0182 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.1086 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.3784 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.2763 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.0051 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.1606 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.2316 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.1645 | Val  Acc: 0.9459
 Site-webcam                        | Val  Loss: 1.0421 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 1.4561 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.4523 | Val  Acc: 0.7857
 Site-Clipart                       | Val  Loss: 1.6113 | Val  Acc: 0.7018
 Site-dslr                          | Val  Loss: 1.0203 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9056
============ Train epoch 44 ============
 Site-RealWorld                     | Train Loss: 1.0259 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.2236 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.2020 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.1504 | Train Acc: 0.9677
 Site-RealWorld                     | Train Loss: 1.1396 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.1340 | Train Acc: 0.9412
 Site-RealWorld                     | Train Loss: 0.9896 | Train Acc: 0.8806
 Site-RealWorld                     | Train Loss: 1.0638 | Train Acc: 0.9186
 Site-RealWorld                     | Train Loss: 1.0989 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 0.9655 | Train Acc: 0.9792
 Site-Product                       | Train Loss: 0.9091 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.2357 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.2115 | Train Acc: 0.8788
 Site-Product                       | Train Loss: 1.1837 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 0.9929 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.0678 | Train Acc: 0.9213
 Site-Product                       | Train Loss: 1.1762 | Train Acc: 0.8629
 Site-amazon                        | Train Loss: 1.1156 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9521 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.1551 | Train Acc: 0.8913
 Site-amazon                        | Train Loss: 1.0611 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.2542 | Train Acc: 0.8269
 Site-webcam                        | Train Loss: 1.1858 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 1.1240 | Train Acc: 0.9107
 Site-webcam                        | Train Loss: 1.1287 | Train Acc: 0.9278
 Site-Art                           | Train Loss: 1.6492 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.5258 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 1.5135 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.0511 | Train Acc: 0.9310
Average Train Accuracy: 0.8947
 Site-RealWorld                     | Val  Loss: 0.9354 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9467 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 0.9254 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2009 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.2521 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0060 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.0921 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.1288 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.2825 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.1453 | Val  Acc: 0.8958
 Site-Product                       | Val  Loss: 1.0171 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 0.9733 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.8714 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9804 | Val  Acc: 0.9677
 Site-Product                       | Val  Loss: 1.2171 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 1.0147 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 0.9628 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.1068 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1875 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.2335 | Val  Acc: 0.8065
 Site-amazon                        | Val  Loss: 1.0389 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.2804 | Val  Acc: 0.8696
 Site-webcam                        | Val  Loss: 1.1883 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.1353 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.1548 | Val  Acc: 0.9219
 Site-Art                           | Val  Loss: 1.4219 | Val  Acc: 0.8571
 Site-Art                           | Val  Loss: 1.4536 | Val  Acc: 0.8393
 Site-Clipart                       | Val  Loss: 1.5748 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 0.9617 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9047
============ Train epoch 45 ============
 Site-RealWorld                     | Train Loss: 1.0935 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.2084 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.1748 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.1203 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.0491 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.1092 | Train Acc: 0.9608
 Site-RealWorld                     | Train Loss: 1.3508 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 1.0411 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 1.0917 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 1.0015 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 0.8304 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.2141 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.3043 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.1740 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 0.9988 | Train Acc: 0.9219
 Site-Product                       | Train Loss: 1.0862 | Train Acc: 0.8989
 Site-Product                       | Train Loss: 1.1036 | Train Acc: 0.8952
 Site-amazon                        | Train Loss: 1.0658 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 0.9073 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.1000 | Train Acc: 0.8478
 Site-amazon                        | Train Loss: 1.4134 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.3217 | Train Acc: 0.8269
 Site-webcam                        | Train Loss: 1.2445 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 1.0515 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.0860 | Train Acc: 0.9175
 Site-Art                           | Train Loss: 1.6782 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.4339 | Train Acc: 0.8214
 Site-Clipart                       | Train Loss: 1.4953 | Train Acc: 0.6588
 Site-dslr                          | Train Loss: 1.0035 | Train Acc: 0.9655
Average Train Accuracy: 0.8838
 Site-RealWorld                     | Val  Loss: 0.7908 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9429 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 0.8618 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1910 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.1552 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9433 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.0837 | Val  Acc: 0.8864
 Site-RealWorld                     | Val  Loss: 1.1270 | Val  Acc: 0.8947
 Site-RealWorld                     | Val  Loss: 1.2281 | Val  Acc: 0.9324
 Site-RealWorld                     | Val  Loss: 1.1177 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.8557 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0836 | Val  Acc: 0.8125
 Site-Product                       | Val  Loss: 0.9585 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 0.9405 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.2002 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 1.0215 | Val  Acc: 0.9153
 Site-Product                       | Val  Loss: 0.9385 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.1506 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 1.2794 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 1.1420 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.0396 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.1254 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.0783 | Val  Acc: 0.9524
 Site-webcam                        | Val  Loss: 1.0702 | Val  Acc: 0.9189
 Site-webcam                        | Val  Loss: 1.0222 | Val  Acc: 0.9531
 Site-Art                           | Val  Loss: 1.4063 | Val  Acc: 0.7857
 Site-Art                           | Val  Loss: 1.4630 | Val  Acc: 0.8036
 Site-Clipart                       | Val  Loss: 1.5763 | Val  Acc: 0.6667
 Site-dslr                          | Val  Loss: 0.9834 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8976
============ Train epoch 46 ============
 Site-RealWorld                     | Train Loss: 1.0220 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.2205 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.0722 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.0484 | Train Acc: 0.9677
 Site-RealWorld                     | Train Loss: 1.0357 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.0741 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 0.9233 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 0.9659 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.0853 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 0.8897 | Train Acc: 0.9861
 Site-Product                       | Train Loss: 0.8947 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.2145 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.2884 | Train Acc: 0.8485
 Site-Product                       | Train Loss: 1.2290 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 0.9928 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.0165 | Train Acc: 0.8989
 Site-Product                       | Train Loss: 1.0661 | Train Acc: 0.8871
 Site-amazon                        | Train Loss: 1.0307 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.8416 | Train Acc: 0.9677
 Site-amazon                        | Train Loss: 1.1893 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.1823 | Train Acc: 0.8986
 Site-amazon                        | Train Loss: 1.3117 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.1901 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 0.9932 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.0268 | Train Acc: 0.9485
 Site-Art                           | Train Loss: 1.6182 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 1.5144 | Train Acc: 0.8690
 Site-Clipart                       | Train Loss: 1.6223 | Train Acc: 0.7176
 Site-dslr                          | Train Loss: 0.9643 | Train Acc: 0.9483
Average Train Accuracy: 0.8934
 Site-RealWorld                     | Val  Loss: 0.8330 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9078 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8887 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0729 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.1933 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9793 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.0208 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.0805 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.1958 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.0547 | Val  Acc: 0.9271
 Site-Product                       | Val  Loss: 0.8538 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 0.9747 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.8458 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 0.8856 | Val  Acc: 0.9032
 Site-Product                       | Val  Loss: 1.0666 | Val  Acc: 0.9302
 Site-Product                       | Val  Loss: 0.9151 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 0.9660 | Val  Acc: 0.8780
 Site-amazon                        | Val  Loss: 1.1526 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.2187 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.1356 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 1.0070 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.0765 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.1596 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 1.1014 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.9273 | Val  Acc: 0.9844
 Site-Art                           | Val  Loss: 1.4126 | Val  Acc: 0.7500
 Site-Art                           | Val  Loss: 1.3584 | Val  Acc: 0.8393
 Site-Clipart                       | Val  Loss: 1.5500 | Val  Acc: 0.7368
 Site-dslr                          | Val  Loss: 0.9772 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9001
============ Train epoch 47 ============
 Site-RealWorld                     | Train Loss: 0.9553 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2245 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.1267 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.0524 | Train Acc: 0.9677
 Site-RealWorld                     | Train Loss: 1.0561 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.0434 | Train Acc: 0.9608
 Site-RealWorld                     | Train Loss: 1.2293 | Train Acc: 0.9104
 Site-RealWorld                     | Train Loss: 0.9836 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 1.0359 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 0.9528 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 0.8212 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.2110 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.2791 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.0776 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 0.9626 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 0.9836 | Train Acc: 0.9101
 Site-Product                       | Train Loss: 1.0799 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.0025 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 0.8490 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.1332 | Train Acc: 0.8261
 Site-amazon                        | Train Loss: 1.0140 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.2214 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.0738 | Train Acc: 0.8438
 Site-webcam                        | Train Loss: 0.9888 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.0120 | Train Acc: 0.9485
 Site-Art                           | Train Loss: 1.5221 | Train Acc: 0.8571
 Site-Art                           | Train Loss: 1.3847 | Train Acc: 0.8214
 Site-Clipart                       | Train Loss: 1.5399 | Train Acc: 0.6706
 Site-dslr                          | Train Loss: 0.9668 | Train Acc: 0.9483
Average Train Accuracy: 0.8911
 Site-RealWorld                     | Val  Loss: 0.8111 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8273 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9156 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0777 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.2275 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9462 | Val  Acc: 0.9118
 Site-RealWorld                     | Val  Loss: 1.0056 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.0426 | Val  Acc: 0.8596
 Site-RealWorld                     | Val  Loss: 1.1710 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.0879 | Val  Acc: 0.8542
 Site-Product                       | Val  Loss: 0.8267 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9332 | Val  Acc: 0.9375
 Site-Product                       | Val  Loss: 0.7947 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 0.9739 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.1154 | Val  Acc: 0.8605
 Site-Product                       | Val  Loss: 0.9510 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 0.9187 | Val  Acc: 0.9024
 Site-amazon                        | Val  Loss: 1.2283 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.2187 | Val  Acc: 0.9000
 Site-amazon                        | Val  Loss: 1.1471 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.9653 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.0781 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.1144 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.0699 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.9907 | Val  Acc: 0.9062
 Site-Art                           | Val  Loss: 1.3800 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.2947 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.4878 | Val  Acc: 0.7193
 Site-dslr                          | Val  Loss: 0.9096 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9016
============ Train epoch 48 ============
 Site-RealWorld                     | Train Loss: 1.0042 | Train Acc: 0.9286
 Site-RealWorld                     | Train Loss: 1.1536 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.0620 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9821 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 1.0254 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 1.0085 | Train Acc: 0.9216
 Site-RealWorld                     | Train Loss: 1.1551 | Train Acc: 0.8955
 Site-RealWorld                     | Train Loss: 0.9494 | Train Acc: 0.9186
 Site-RealWorld                     | Train Loss: 1.0316 | Train Acc: 0.9279
 Site-RealWorld                     | Train Loss: 0.8661 | Train Acc: 0.9653
 Site-Product                       | Train Loss: 0.8935 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.1903 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.1916 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.0571 | Train Acc: 0.8478
 Site-Product                       | Train Loss: 0.8949 | Train Acc: 0.9531
 Site-Product                       | Train Loss: 1.0093 | Train Acc: 0.8876
 Site-Product                       | Train Loss: 1.0278 | Train Acc: 0.8710
 Site-amazon                        | Train Loss: 1.0149 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 0.8251 | Train Acc: 0.9355
 Site-amazon                        | Train Loss: 1.0890 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 0.9055 | Train Acc: 0.9275
 Site-amazon                        | Train Loss: 1.1619 | Train Acc: 0.8654
 Site-webcam                        | Train Loss: 1.1412 | Train Acc: 0.8125
 Site-webcam                        | Train Loss: 0.9486 | Train Acc: 0.9464
 Site-webcam                        | Train Loss: 1.0715 | Train Acc: 0.9588
 Site-Art                           | Train Loss: 1.5692 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.2974 | Train Acc: 0.8333
 Site-Clipart                       | Train Loss: 1.4861 | Train Acc: 0.7059
 Site-dslr                          | Train Loss: 0.9265 | Train Acc: 0.9310
Average Train Accuracy: 0.8922
 Site-RealWorld                     | Val  Loss: 0.7081 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8796 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8201 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0663 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.1779 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.8314 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 0.9509 | Val  Acc: 0.9773
 Site-RealWorld                     | Val  Loss: 1.0421 | Val  Acc: 0.8947
 Site-RealWorld                     | Val  Loss: 1.1235 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.0976 | Val  Acc: 0.8854
 Site-Product                       | Val  Loss: 0.7719 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9470 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.8370 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 0.8648 | Val  Acc: 0.9677
 Site-Product                       | Val  Loss: 1.0717 | Val  Acc: 0.9302
 Site-Product                       | Val  Loss: 0.8631 | Val  Acc: 0.9492
 Site-Product                       | Val  Loss: 0.9281 | Val  Acc: 0.8415
 Site-amazon                        | Val  Loss: 1.1344 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 1.2659 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.0909 | Val  Acc: 0.8710
 Site-amazon                        | Val  Loss: 0.9407 | Val  Acc: 0.9565
 Site-amazon                        | Val  Loss: 1.0217 | Val  Acc: 0.8841
 Site-webcam                        | Val  Loss: 1.1551 | Val  Acc: 0.8571
 Site-webcam                        | Val  Loss: 1.0697 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.9270 | Val  Acc: 0.9375
 Site-Art                           | Val  Loss: 1.3004 | Val  Acc: 0.8214
 Site-Art                           | Val  Loss: 1.3469 | Val  Acc: 0.8571
 Site-Clipart                       | Val  Loss: 1.4384 | Val  Acc: 0.7544
 Site-dslr                          | Val  Loss: 0.9167 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9065
 Best site-RealWorld                 | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.9773
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.8947
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.9189
 Best site-RealWorld                 | Epoch:48 | Val Acc: 0.8854
 Best site-Product                   | Epoch:48 | Val Acc: 1.0000
 Best site-Product                   | Epoch:48 | Val Acc: 0.8750
 Best site-Product                   | Epoch:48 | Val Acc: 0.9091
 Best site-Product                   | Epoch:48 | Val Acc: 0.9677
 Best site-Product                   | Epoch:48 | Val Acc: 0.9302
 Best site-Product                   | Epoch:48 | Val Acc: 0.9492
 Best site-Product                   | Epoch:48 | Val Acc: 0.8415
 Best site-amazon                    | Epoch:48 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:48 | Val Acc: 0.8500
 Best site-amazon                    | Epoch:48 | Val Acc: 0.8710
 Best site-amazon                    | Epoch:48 | Val Acc: 0.9565
 Best site-amazon                    | Epoch:48 | Val Acc: 0.8841
 Best site-webcam                    | Epoch:48 | Val Acc: 0.8571
 Best site-webcam                    | Epoch:48 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:48 | Val Acc: 0.9375
 Best site-Art                       | Epoch:48 | Val Acc: 0.8214
 Best site-Art                       | Epoch:48 | Val Acc: 0.8571
 Best site-Clipart                   | Epoch:48 | Val Acc: 0.7544
 Best site-dslr                      | Epoch:48 | Val Acc: 0.9737
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 49 ============
 Site-RealWorld                     | Train Loss: 0.9457 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0906 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.0379 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0967 | Train Acc: 0.9355
 Site-RealWorld                     | Train Loss: 0.9858 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.0227 | Train Acc: 0.9804
 Site-RealWorld                     | Train Loss: 0.8781 | Train Acc: 0.9254
 Site-RealWorld                     | Train Loss: 0.8693 | Train Acc: 0.8953
 Site-RealWorld                     | Train Loss: 1.0167 | Train Acc: 0.9369
 Site-RealWorld                     | Train Loss: 0.9138 | Train Acc: 0.9514
 Site-Product                       | Train Loss: 0.8269 | Train Acc: 0.9412
 Site-Product                       | Train Loss: 1.1492 | Train Acc: 0.8750
 Site-Product                       | Train Loss: 1.2092 | Train Acc: 0.7879
 Site-Product                       | Train Loss: 1.0906 | Train Acc: 0.8261
 Site-Product                       | Train Loss: 0.9209 | Train Acc: 0.9375
 Site-Product                       | Train Loss: 1.0056 | Train Acc: 0.8989
 Site-Product                       | Train Loss: 0.9935 | Train Acc: 0.9113
 Site-amazon                        | Train Loss: 0.9825 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.8432 | Train Acc: 0.9032
 Site-amazon                        | Train Loss: 1.0502 | Train Acc: 0.8696
 Site-amazon                        | Train Loss: 0.8322 | Train Acc: 0.9130
 Site-amazon                        | Train Loss: 1.1601 | Train Acc: 0.8077
 Site-webcam                        | Train Loss: 1.0911 | Train Acc: 0.8750
 Site-webcam                        | Train Loss: 1.0161 | Train Acc: 0.9286
 Site-webcam                        | Train Loss: 1.0071 | Train Acc: 0.9381
 Site-Art                           | Train Loss: 1.5355 | Train Acc: 0.8095
 Site-Art                           | Train Loss: 1.3808 | Train Acc: 0.8452
 Site-Clipart                       | Train Loss: 1.3988 | Train Acc: 0.6824
 Site-dslr                          | Train Loss: 0.9657 | Train Acc: 0.8793
Average Train Accuracy: 0.9000
 Site-RealWorld                     | Val  Loss: 0.6911 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8622 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8054 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0674 | Val  Acc: 0.9500
 Site-RealWorld                     | Val  Loss: 1.1495 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.8584 | Val  Acc: 0.9706
 Site-RealWorld                     | Val  Loss: 1.0085 | Val  Acc: 0.9318
 Site-RealWorld                     | Val  Loss: 1.0072 | Val  Acc: 0.8772
 Site-RealWorld                     | Val  Loss: 1.1179 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.0376 | Val  Acc: 0.8646
 Site-Product                       | Val  Loss: 0.8200 | Val  Acc: 0.9091
 Site-Product                       | Val  Loss: 0.9387 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 0.7934 | Val  Acc: 0.9545
 Site-Product                       | Val  Loss: 0.9136 | Val  Acc: 0.9355
 Site-Product                       | Val  Loss: 1.0417 | Val  Acc: 0.8837
 Site-Product                       | Val  Loss: 0.9079 | Val  Acc: 0.9322
 Site-Product                       | Val  Loss: 0.9136 | Val  Acc: 0.8902
 Site-amazon                        | Val  Loss: 1.1256 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.0770 | Val  Acc: 0.8500
 Site-amazon                        | Val  Loss: 1.0678 | Val  Acc: 0.8387
 Site-amazon                        | Val  Loss: 0.8964 | Val  Acc: 0.9348
 Site-amazon                        | Val  Loss: 1.1948 | Val  Acc: 0.9130
 Site-webcam                        | Val  Loss: 1.1285 | Val  Acc: 0.9048
 Site-webcam                        | Val  Loss: 1.0613 | Val  Acc: 0.8919
 Site-webcam                        | Val  Loss: 0.9221 | Val  Acc: 0.9688
 Site-Art                           | Val  Loss: 1.2619 | Val  Acc: 0.8929
 Site-Art                           | Val  Loss: 1.3523 | Val  Acc: 0.7679
 Site-Clipart                       | Val  Loss: 1.4760 | Val  Acc: 0.7719
 Site-dslr                          | Val  Loss: 0.8843 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9067
 Best site-RealWorld                 | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9500
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9706
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9318
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.8772
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.9459
 Best site-RealWorld                 | Epoch:49 | Val Acc: 0.8646
 Best site-Product                   | Epoch:49 | Val Acc: 0.9091
 Best site-Product                   | Epoch:49 | Val Acc: 0.8750
 Best site-Product                   | Epoch:49 | Val Acc: 0.9545
 Best site-Product                   | Epoch:49 | Val Acc: 0.9355
 Best site-Product                   | Epoch:49 | Val Acc: 0.8837
 Best site-Product                   | Epoch:49 | Val Acc: 0.9322
 Best site-Product                   | Epoch:49 | Val Acc: 0.8902
 Best site-amazon                    | Epoch:49 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:49 | Val Acc: 0.8500
 Best site-amazon                    | Epoch:49 | Val Acc: 0.8387
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9348
 Best site-amazon                    | Epoch:49 | Val Acc: 0.9130
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9048
 Best site-webcam                    | Epoch:49 | Val Acc: 0.8919
 Best site-webcam                    | Epoch:49 | Val Acc: 0.9688
 Best site-Art                       | Epoch:49 | Val Acc: 0.8929
 Best site-Art                       | Epoch:49 | Val Acc: 0.7679
 Best site-Clipart                   | Epoch:49 | Val Acc: 0.7719
 Best site-dslr                      | Epoch:49 | Val Acc: 0.9474
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
===2023-08-06 11:57:15===
===2023-08-06 11:57:21===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
Loading snapshots...
 Test site-RealWorld                 (1)| Epoch:49 | Test Acc: 0.9475
 Test site-Product                   (6)| Epoch:49 | Test Acc: 0.9248
 Test site-amazon                    (3)| Epoch:49 | Test Acc: 0.8516
 Test site-webcam                    (4)| Epoch:49 | Test Acc: 0.9146
 Test site-Art                       (1)| Epoch:49 | Test Acc: 0.8610
 Test site-Clipart                   (2)| Epoch:49 | Test Acc: 0.7851
 Test site-dslr                      (1)| Epoch:49 | Test Acc: 0.8969
RealWorld: 0.9475, Product: 0.9248, amazon: 0.8516, webcam: 0.9146, Art: 0.8610, Clipart: 0.7851, dslr: 0.8969, 
Average Test Accuracy(group): 0.8831, Average Test Accuracy(individual): 0.9088,
domain std=0.0509, cluster std=0.0502, individual std=0.0428, 
===2023-08-06 20:35:13===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[9,12,15,20,25,33,43,55,72,93,11,15,21,30,41,57,79,13,20,29,44,66,20,35,62,27,54,55,37,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[635,431,293,199,135,92,62,]
domain number = 7
============ Train epoch 0 ============
 Site-RealWorld                     | Train Loss: 2.4633 | Train Acc: 0.0000
 Site-RealWorld                     | Train Loss: 2.4716 | Train Acc: 0.0000
 Site-RealWorld                     | Train Loss: 2.4398 | Train Acc: 0.1333
 Site-RealWorld                     | Train Loss: 2.4357 | Train Acc: 0.2500
 Site-RealWorld                     | Train Loss: 2.4412 | Train Acc: 0.1200
 Site-RealWorld                     | Train Loss: 2.4435 | Train Acc: 0.1515
 Site-RealWorld                     | Train Loss: 2.4333 | Train Acc: 0.1860
 Site-RealWorld                     | Train Loss: 2.4589 | Train Acc: 0.0727
 Site-RealWorld                     | Train Loss: 2.4428 | Train Acc: 0.1389
 Site-RealWorld                     | Train Loss: 2.4421 | Train Acc: 0.1505
 Site-caltech                       | Train Loss: 2.5096 | Train Acc: 0.0909
 Site-caltech                       | Train Loss: 2.4697 | Train Acc: 0.1333
 Site-caltech                       | Train Loss: 2.4408 | Train Acc: 0.0952
 Site-caltech                       | Train Loss: 2.4710 | Train Acc: 0.0667
 Site-caltech                       | Train Loss: 2.4402 | Train Acc: 0.1220
 Site-caltech                       | Train Loss: 2.4456 | Train Acc: 0.1228
 Site-caltech                       | Train Loss: 2.4652 | Train Acc: 0.1139
 Site-Product                       | Train Loss: 2.4412 | Train Acc: 0.1538
 Site-Product                       | Train Loss: 2.4678 | Train Acc: 0.0000
 Site-Product                       | Train Loss: 2.4498 | Train Acc: 0.1724
 Site-Product                       | Train Loss: 2.4572 | Train Acc: 0.1364
 Site-Product                       | Train Loss: 2.4772 | Train Acc: 0.1970
 Site-amazon                        | Train Loss: 2.4515 | Train Acc: 0.1500
 Site-amazon                        | Train Loss: 2.4451 | Train Acc: 0.1429
 Site-amazon                        | Train Loss: 2.4442 | Train Acc: 0.1129
 Site-webcam                        | Train Loss: 2.4765 | Train Acc: 0.0000
 Site-webcam                        | Train Loss: 2.4757 | Train Acc: 0.0370
 Site-Art                           | Train Loss: 2.4702 | Train Acc: 0.1091
 Site-Clipart                       | Train Loss: 2.4759 | Train Acc: 0.1081
Average Train Accuracy: 0.1127
 Site-RealWorld                     | Val  Loss: 2.3941 | Val  Acc: 0.3333
 Site-RealWorld                     | Val  Loss: 2.4408 | Val  Acc: 0.1250
 Site-RealWorld                     | Val  Loss: 2.4379 | Val  Acc: 0.2000
 Site-RealWorld                     | Val  Loss: 2.4489 | Val  Acc: 0.2308
 Site-RealWorld                     | Val  Loss: 2.4414 | Val  Acc: 0.1765
 Site-RealWorld                     | Val  Loss: 2.4844 | Val  Acc: 0.1364
 Site-RealWorld                     | Val  Loss: 2.4680 | Val  Acc: 0.1071
 Site-RealWorld                     | Val  Loss: 2.4521 | Val  Acc: 0.0541
 Site-RealWorld                     | Val  Loss: 2.4364 | Val  Acc: 0.1875
 Site-RealWorld                     | Val  Loss: 2.4517 | Val  Acc: 0.1452
 Site-caltech                       | Val  Loss: 2.4313 | Val  Acc: 0.1429
 Site-caltech                       | Val  Loss: 2.4800 | Val  Acc: 0.0000
 Site-caltech                       | Val  Loss: 2.4707 | Val  Acc: 0.0714
 Site-caltech                       | Val  Loss: 2.4246 | Val  Acc: 0.2000
 Site-caltech                       | Val  Loss: 2.4229 | Val  Acc: 0.2222
 Site-caltech                       | Val  Loss: 2.4304 | Val  Acc: 0.2105
 Site-caltech                       | Val  Loss: 2.4678 | Val  Acc: 0.0377
 Site-Product                       | Val  Loss: 2.4398 | Val  Acc: 0.1250
 Site-Product                       | Val  Loss: 2.4689 | Val  Acc: 0.1538
 Site-Product                       | Val  Loss: 2.4492 | Val  Acc: 0.1500
 Site-Product                       | Val  Loss: 2.4603 | Val  Acc: 0.0690
 Site-Product                       | Val  Loss: 2.4541 | Val  Acc: 0.1364
 Site-amazon                        | Val  Loss: 2.4502 | Val  Acc: 0.0769
 Site-amazon                        | Val  Loss: 2.4768 | Val  Acc: 0.0870
 Site-amazon                        | Val  Loss: 2.4517 | Val  Acc: 0.1951
 Site-webcam                        | Val  Loss: 2.4702 | Val  Acc: 0.0556
 Site-webcam                        | Val  Loss: 2.4713 | Val  Acc: 0.0556
 Site-Art                           | Val  Loss: 2.4622 | Val  Acc: 0.0833
 Site-Clipart                       | Val  Loss: 2.4799 | Val  Acc: 0.0833
Average Valid Accuracy: 0.1328
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.3333
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1250
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.2000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.2308
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1765
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1364
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1071
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.0541
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1875
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.1452
 Best site-caltech                   | Epoch:0 | Val Acc: 0.1429
 Best site-caltech                   | Epoch:0 | Val Acc: 0.0000
 Best site-caltech                   | Epoch:0 | Val Acc: 0.0714
 Best site-caltech                   | Epoch:0 | Val Acc: 0.2000
 Best site-caltech                   | Epoch:0 | Val Acc: 0.2222
 Best site-caltech                   | Epoch:0 | Val Acc: 0.2105
 Best site-caltech                   | Epoch:0 | Val Acc: 0.0377
 Best site-Product                   | Epoch:0 | Val Acc: 0.1250
 Best site-Product                   | Epoch:0 | Val Acc: 0.1538
 Best site-Product                   | Epoch:0 | Val Acc: 0.1500
 Best site-Product                   | Epoch:0 | Val Acc: 0.0690
 Best site-Product                   | Epoch:0 | Val Acc: 0.1364
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0769
 Best site-amazon                    | Epoch:0 | Val Acc: 0.0870
 Best site-amazon                    | Epoch:0 | Val Acc: 0.1951
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0556
 Best site-webcam                    | Epoch:0 | Val Acc: 0.0556
 Best site-Art                       | Epoch:0 | Val Acc: 0.0833
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.0833
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 1 ============
 Site-RealWorld                     | Train Loss: 2.4145 | Train Acc: 0.1111
 Site-RealWorld                     | Train Loss: 2.4368 | Train Acc: 0.2500
 Site-RealWorld                     | Train Loss: 2.3784 | Train Acc: 0.4000
 Site-RealWorld                     | Train Loss: 2.4005 | Train Acc: 0.3000
 Site-RealWorld                     | Train Loss: 2.3862 | Train Acc: 0.2400
 Site-RealWorld                     | Train Loss: 2.4049 | Train Acc: 0.3030
 Site-RealWorld                     | Train Loss: 2.3746 | Train Acc: 0.3256
 Site-RealWorld                     | Train Loss: 2.4151 | Train Acc: 0.2000
 Site-RealWorld                     | Train Loss: 2.4191 | Train Acc: 0.2639
 Site-RealWorld                     | Train Loss: 2.3938 | Train Acc: 0.2581
 Site-caltech                       | Train Loss: 2.4336 | Train Acc: 0.0909
 Site-caltech                       | Train Loss: 2.4218 | Train Acc: 0.2667
 Site-caltech                       | Train Loss: 2.3921 | Train Acc: 0.2381
 Site-caltech                       | Train Loss: 2.4361 | Train Acc: 0.0667
 Site-caltech                       | Train Loss: 2.3935 | Train Acc: 0.2195
 Site-caltech                       | Train Loss: 2.4022 | Train Acc: 0.2105
 Site-caltech                       | Train Loss: 2.4075 | Train Acc: 0.1899
 Site-Product                       | Train Loss: 2.4102 | Train Acc: 0.2308
 Site-Product                       | Train Loss: 2.4235 | Train Acc: 0.0500
 Site-Product                       | Train Loss: 2.3941 | Train Acc: 0.2759
 Site-Product                       | Train Loss: 2.4093 | Train Acc: 0.2727
 Site-Product                       | Train Loss: 2.4259 | Train Acc: 0.2576
 Site-amazon                        | Train Loss: 2.4150 | Train Acc: 0.2500
 Site-amazon                        | Train Loss: 2.4037 | Train Acc: 0.2286
 Site-amazon                        | Train Loss: 2.4047 | Train Acc: 0.1613
 Site-webcam                        | Train Loss: 2.4130 | Train Acc: 0.1481
 Site-webcam                        | Train Loss: 2.4263 | Train Acc: 0.1296
 Site-Art                           | Train Loss: 2.4335 | Train Acc: 0.1818
 Site-Clipart                       | Train Loss: 2.4300 | Train Acc: 0.0811
Average Train Accuracy: 0.2138
 Site-RealWorld                     | Val  Loss: 2.3418 | Val  Acc: 0.5000
 Site-RealWorld                     | Val  Loss: 2.3470 | Val  Acc: 0.3750
 Site-RealWorld                     | Val  Loss: 2.3827 | Val  Acc: 0.3000
 Site-RealWorld                     | Val  Loss: 2.3983 | Val  Acc: 0.2308
 Site-RealWorld                     | Val  Loss: 2.4212 | Val  Acc: 0.2353
 Site-RealWorld                     | Val  Loss: 2.4191 | Val  Acc: 0.2273
 Site-RealWorld                     | Val  Loss: 2.4256 | Val  Acc: 0.2143
 Site-RealWorld                     | Val  Loss: 2.4034 | Val  Acc: 0.2162
 Site-RealWorld                     | Val  Loss: 2.3896 | Val  Acc: 0.3125
 Site-RealWorld                     | Val  Loss: 2.4087 | Val  Acc: 0.2419
 Site-caltech                       | Val  Loss: 2.4037 | Val  Acc: 0.2857
 Site-caltech                       | Val  Loss: 2.4168 | Val  Acc: 0.1000
 Site-caltech                       | Val  Loss: 2.4239 | Val  Acc: 0.1429
 Site-caltech                       | Val  Loss: 2.3782 | Val  Acc: 0.3500
 Site-caltech                       | Val  Loss: 2.3795 | Val  Acc: 0.2963
 Site-caltech                       | Val  Loss: 2.3983 | Val  Acc: 0.2368
 Site-caltech                       | Val  Loss: 2.4161 | Val  Acc: 0.1887
 Site-Product                       | Val  Loss: 2.3956 | Val  Acc: 0.2500
 Site-Product                       | Val  Loss: 2.4028 | Val  Acc: 0.3077
 Site-Product                       | Val  Loss: 2.3913 | Val  Acc: 0.3000
 Site-Product                       | Val  Loss: 2.4135 | Val  Acc: 0.2069
 Site-Product                       | Val  Loss: 2.4077 | Val  Acc: 0.3182
 Site-amazon                        | Val  Loss: 2.4364 | Val  Acc: 0.0769
 Site-amazon                        | Val  Loss: 2.4348 | Val  Acc: 0.0870
 Site-amazon                        | Val  Loss: 2.3982 | Val  Acc: 0.2683
 Site-webcam                        | Val  Loss: 2.4176 | Val  Acc: 0.3333
 Site-webcam                        | Val  Loss: 2.4181 | Val  Acc: 0.1111
 Site-Art                           | Val  Loss: 2.4385 | Val  Acc: 0.1667
 Site-Clipart                       | Val  Loss: 2.4340 | Val  Acc: 0.0833
Average Valid Accuracy: 0.2401
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.5000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3750
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2308
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2353
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2273
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2143
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2162
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.3125
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.2419
 Best site-caltech                   | Epoch:1 | Val Acc: 0.2857
 Best site-caltech                   | Epoch:1 | Val Acc: 0.1000
 Best site-caltech                   | Epoch:1 | Val Acc: 0.1429
 Best site-caltech                   | Epoch:1 | Val Acc: 0.3500
 Best site-caltech                   | Epoch:1 | Val Acc: 0.2963
 Best site-caltech                   | Epoch:1 | Val Acc: 0.2368
 Best site-caltech                   | Epoch:1 | Val Acc: 0.1887
 Best site-Product                   | Epoch:1 | Val Acc: 0.2500
 Best site-Product                   | Epoch:1 | Val Acc: 0.3077
 Best site-Product                   | Epoch:1 | Val Acc: 0.3000
 Best site-Product                   | Epoch:1 | Val Acc: 0.2069
 Best site-Product                   | Epoch:1 | Val Acc: 0.3182
 Best site-amazon                    | Epoch:1 | Val Acc: 0.0769
 Best site-amazon                    | Epoch:1 | Val Acc: 0.0870
 Best site-amazon                    | Epoch:1 | Val Acc: 0.2683
 Best site-webcam                    | Epoch:1 | Val Acc: 0.3333
 Best site-webcam                    | Epoch:1 | Val Acc: 0.1111
 Best site-Art                       | Epoch:1 | Val Acc: 0.1667
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.0833
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 2 ============
 Site-RealWorld                     | Train Loss: 2.3695 | Train Acc: 0.1111
 Site-RealWorld                     | Train Loss: 2.3927 | Train Acc: 0.1667
 Site-RealWorld                     | Train Loss: 2.3288 | Train Acc: 0.4000
 Site-RealWorld                     | Train Loss: 2.3516 | Train Acc: 0.4500
 Site-RealWorld                     | Train Loss: 2.3485 | Train Acc: 0.4400
 Site-RealWorld                     | Train Loss: 2.3676 | Train Acc: 0.4848
 Site-RealWorld                     | Train Loss: 2.3352 | Train Acc: 0.4884
 Site-RealWorld                     | Train Loss: 2.3626 | Train Acc: 0.3455
 Site-RealWorld                     | Train Loss: 2.3521 | Train Acc: 0.4444
 Site-RealWorld                     | Train Loss: 2.3352 | Train Acc: 0.4516
 Site-caltech                       | Train Loss: 2.4144 | Train Acc: 0.0909
 Site-caltech                       | Train Loss: 2.3942 | Train Acc: 0.4000
 Site-caltech                       | Train Loss: 2.3600 | Train Acc: 0.2857
 Site-caltech                       | Train Loss: 2.3788 | Train Acc: 0.3333
 Site-caltech                       | Train Loss: 2.3559 | Train Acc: 0.3171
 Site-caltech                       | Train Loss: 2.3525 | Train Acc: 0.3860
 Site-caltech                       | Train Loss: 2.3663 | Train Acc: 0.3291
 Site-Product                       | Train Loss: 2.3630 | Train Acc: 0.3077
 Site-Product                       | Train Loss: 2.3801 | Train Acc: 0.2500
 Site-Product                       | Train Loss: 2.3523 | Train Acc: 0.3448
 Site-Product                       | Train Loss: 2.3647 | Train Acc: 0.3636
 Site-Product                       | Train Loss: 2.3137 | Train Acc: 0.4394
 Site-amazon                        | Train Loss: 2.3633 | Train Acc: 0.4000
 Site-amazon                        | Train Loss: 2.3476 | Train Acc: 0.4571
 Site-amazon                        | Train Loss: 2.3651 | Train Acc: 0.3871
 Site-webcam                        | Train Loss: 2.3715 | Train Acc: 0.3704
 Site-webcam                        | Train Loss: 2.3779 | Train Acc: 0.2778
 Site-Art                           | Train Loss: 2.4015 | Train Acc: 0.2727
 Site-Clipart                       | Train Loss: 2.3894 | Train Acc: 0.1892
Average Train Accuracy: 0.3443
 Site-RealWorld                     | Val  Loss: 2.2620 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.3128 | Val  Acc: 0.6250
 Site-RealWorld                     | Val  Loss: 2.3363 | Val  Acc: 0.7000
 Site-RealWorld                     | Val  Loss: 2.3461 | Val  Acc: 0.5385
 Site-RealWorld                     | Val  Loss: 2.3654 | Val  Acc: 0.4118
 Site-RealWorld                     | Val  Loss: 2.3702 | Val  Acc: 0.3636
 Site-RealWorld                     | Val  Loss: 2.3746 | Val  Acc: 0.3214
 Site-RealWorld                     | Val  Loss: 2.3469 | Val  Acc: 0.4054
 Site-RealWorld                     | Val  Loss: 2.3380 | Val  Acc: 0.5417
 Site-RealWorld                     | Val  Loss: 2.3625 | Val  Acc: 0.5000
 Site-caltech                       | Val  Loss: 2.3761 | Val  Acc: 0.2857
 Site-caltech                       | Val  Loss: 2.3635 | Val  Acc: 0.3000
 Site-caltech                       | Val  Loss: 2.3826 | Val  Acc: 0.2857
 Site-caltech                       | Val  Loss: 2.3214 | Val  Acc: 0.4500
 Site-caltech                       | Val  Loss: 2.3277 | Val  Acc: 0.4444
 Site-caltech                       | Val  Loss: 2.3438 | Val  Acc: 0.3158
 Site-caltech                       | Val  Loss: 2.3629 | Val  Acc: 0.3208
 Site-Product                       | Val  Loss: 2.3469 | Val  Acc: 0.5000
 Site-Product                       | Val  Loss: 2.3467 | Val  Acc: 0.4615
 Site-Product                       | Val  Loss: 2.3476 | Val  Acc: 0.5000
 Site-Product                       | Val  Loss: 2.3552 | Val  Acc: 0.3793
 Site-Product                       | Val  Loss: 2.3539 | Val  Acc: 0.4318
 Site-amazon                        | Val  Loss: 2.3786 | Val  Acc: 0.4615
 Site-amazon                        | Val  Loss: 2.3857 | Val  Acc: 0.1739
 Site-amazon                        | Val  Loss: 2.3670 | Val  Acc: 0.4390
 Site-webcam                        | Val  Loss: 2.3811 | Val  Acc: 0.2222
 Site-webcam                        | Val  Loss: 2.3828 | Val  Acc: 0.3333
 Site-Art                           | Val  Loss: 2.4066 | Val  Acc: 0.1944
 Site-Clipart                       | Val  Loss: 2.3866 | Val  Acc: 0.2917
Average Valid Accuracy: 0.4091
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.6250
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.7000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.5385
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.4118
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3636
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.3214
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.4054
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.5417
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.5000
 Best site-caltech                   | Epoch:2 | Val Acc: 0.2857
 Best site-caltech                   | Epoch:2 | Val Acc: 0.3000
 Best site-caltech                   | Epoch:2 | Val Acc: 0.2857
 Best site-caltech                   | Epoch:2 | Val Acc: 0.4500
 Best site-caltech                   | Epoch:2 | Val Acc: 0.4444
 Best site-caltech                   | Epoch:2 | Val Acc: 0.3158
 Best site-caltech                   | Epoch:2 | Val Acc: 0.3208
 Best site-Product                   | Epoch:2 | Val Acc: 0.5000
 Best site-Product                   | Epoch:2 | Val Acc: 0.4615
 Best site-Product                   | Epoch:2 | Val Acc: 0.5000
 Best site-Product                   | Epoch:2 | Val Acc: 0.3793
 Best site-Product                   | Epoch:2 | Val Acc: 0.4318
 Best site-amazon                    | Epoch:2 | Val Acc: 0.4615
 Best site-amazon                    | Epoch:2 | Val Acc: 0.1739
 Best site-amazon                    | Epoch:2 | Val Acc: 0.4390
 Best site-webcam                    | Epoch:2 | Val Acc: 0.2222
 Best site-webcam                    | Epoch:2 | Val Acc: 0.3333
 Best site-Art                       | Epoch:2 | Val Acc: 0.1944
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.2917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 3 ============
 Site-RealWorld                     | Train Loss: 2.3412 | Train Acc: 0.3333
 Site-RealWorld                     | Train Loss: 2.3407 | Train Acc: 0.4167
 Site-RealWorld                     | Train Loss: 2.2619 | Train Acc: 0.7333
 Site-RealWorld                     | Train Loss: 2.2988 | Train Acc: 0.6000
 Site-RealWorld                     | Train Loss: 2.3011 | Train Acc: 0.6800
 Site-RealWorld                     | Train Loss: 2.3232 | Train Acc: 0.6667
 Site-RealWorld                     | Train Loss: 2.2848 | Train Acc: 0.6512
 Site-RealWorld                     | Train Loss: 2.3096 | Train Acc: 0.5636
 Site-RealWorld                     | Train Loss: 2.3087 | Train Acc: 0.5694
 Site-RealWorld                     | Train Loss: 2.3007 | Train Acc: 0.6774
 Site-caltech                       | Train Loss: 2.3529 | Train Acc: 0.2727
 Site-caltech                       | Train Loss: 2.3488 | Train Acc: 0.4667
 Site-caltech                       | Train Loss: 2.2849 | Train Acc: 0.6667
 Site-caltech                       | Train Loss: 2.3412 | Train Acc: 0.4667
 Site-caltech                       | Train Loss: 2.2941 | Train Acc: 0.4878
 Site-caltech                       | Train Loss: 2.3018 | Train Acc: 0.6491
 Site-caltech                       | Train Loss: 2.3268 | Train Acc: 0.5443
 Site-Product                       | Train Loss: 2.2798 | Train Acc: 0.6923
 Site-Product                       | Train Loss: 2.3325 | Train Acc: 0.5500
 Site-Product                       | Train Loss: 2.3209 | Train Acc: 0.5862
 Site-Product                       | Train Loss: 2.3143 | Train Acc: 0.4773
 Site-Product                       | Train Loss: 2.3329 | Train Acc: 0.5455
 Site-amazon                        | Train Loss: 2.3015 | Train Acc: 0.5500
 Site-amazon                        | Train Loss: 2.3148 | Train Acc: 0.5429
 Site-amazon                        | Train Loss: 2.3179 | Train Acc: 0.5484
 Site-webcam                        | Train Loss: 2.3396 | Train Acc: 0.5185
 Site-webcam                        | Train Loss: 2.3338 | Train Acc: 0.3704
 Site-Art                           | Train Loss: 2.3636 | Train Acc: 0.3818
 Site-Clipart                       | Train Loss: 2.3592 | Train Acc: 0.3784
Average Train Accuracy: 0.5375
 Site-RealWorld                     | Val  Loss: 2.2408 | Val  Acc: 0.6667
 Site-RealWorld                     | Val  Loss: 2.2590 | Val  Acc: 0.6250
 Site-RealWorld                     | Val  Loss: 2.2736 | Val  Acc: 0.7000
 Site-RealWorld                     | Val  Loss: 2.3087 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 2.3311 | Val  Acc: 0.4118
 Site-RealWorld                     | Val  Loss: 2.3242 | Val  Acc: 0.4091
 Site-RealWorld                     | Val  Loss: 2.3215 | Val  Acc: 0.6071
 Site-RealWorld                     | Val  Loss: 2.3009 | Val  Acc: 0.7027
 Site-RealWorld                     | Val  Loss: 2.2850 | Val  Acc: 0.6042
 Site-RealWorld                     | Val  Loss: 2.3189 | Val  Acc: 0.6129
 Site-caltech                       | Val  Loss: 2.3098 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.3244 | Val  Acc: 0.5000
 Site-caltech                       | Val  Loss: 2.3450 | Val  Acc: 0.5714
 Site-caltech                       | Val  Loss: 2.2738 | Val  Acc: 0.6000
 Site-caltech                       | Val  Loss: 2.2847 | Val  Acc: 0.6667
 Site-caltech                       | Val  Loss: 2.2912 | Val  Acc: 0.5526
 Site-caltech                       | Val  Loss: 2.3306 | Val  Acc: 0.4717
 Site-Product                       | Val  Loss: 2.2979 | Val  Acc: 0.5000
 Site-Product                       | Val  Loss: 2.2995 | Val  Acc: 0.6154
 Site-Product                       | Val  Loss: 2.2960 | Val  Acc: 0.6500
 Site-Product                       | Val  Loss: 2.3151 | Val  Acc: 0.5862
 Site-Product                       | Val  Loss: 2.3120 | Val  Acc: 0.5000
 Site-amazon                        | Val  Loss: 2.3146 | Val  Acc: 0.5385
 Site-amazon                        | Val  Loss: 2.3549 | Val  Acc: 0.3478
 Site-amazon                        | Val  Loss: 2.3234 | Val  Acc: 0.6341
 Site-webcam                        | Val  Loss: 2.3292 | Val  Acc: 0.4444
 Site-webcam                        | Val  Loss: 2.3357 | Val  Acc: 0.3889
 Site-Art                           | Val  Loss: 2.3694 | Val  Acc: 0.3611
 Site-Clipart                       | Val  Loss: 2.3545 | Val  Acc: 0.4167
Average Valid Accuracy: 0.5674
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6667
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6250
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.4118
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.4091
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6071
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.7027
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6042
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.6129
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 0.5000
 Best site-caltech                   | Epoch:3 | Val Acc: 0.5714
 Best site-caltech                   | Epoch:3 | Val Acc: 0.6000
 Best site-caltech                   | Epoch:3 | Val Acc: 0.6667
 Best site-caltech                   | Epoch:3 | Val Acc: 0.5526
 Best site-caltech                   | Epoch:3 | Val Acc: 0.4717
 Best site-Product                   | Epoch:3 | Val Acc: 0.5000
 Best site-Product                   | Epoch:3 | Val Acc: 0.6154
 Best site-Product                   | Epoch:3 | Val Acc: 0.6500
 Best site-Product                   | Epoch:3 | Val Acc: 0.5862
 Best site-Product                   | Epoch:3 | Val Acc: 0.5000
 Best site-amazon                    | Epoch:3 | Val Acc: 0.5385
 Best site-amazon                    | Epoch:3 | Val Acc: 0.3478
 Best site-amazon                    | Epoch:3 | Val Acc: 0.6341
 Best site-webcam                    | Epoch:3 | Val Acc: 0.4444
 Best site-webcam                    | Epoch:3 | Val Acc: 0.3889
 Best site-Art                       | Epoch:3 | Val Acc: 0.3611
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.4167
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 4 ============
 Site-RealWorld                     | Train Loss: 2.2670 | Train Acc: 0.6667
 Site-RealWorld                     | Train Loss: 2.2867 | Train Acc: 0.6667
 Site-RealWorld                     | Train Loss: 2.2423 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.2538 | Train Acc: 0.6500
 Site-RealWorld                     | Train Loss: 2.2464 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.2820 | Train Acc: 0.6970
 Site-RealWorld                     | Train Loss: 2.2287 | Train Acc: 0.8140
 Site-RealWorld                     | Train Loss: 2.2666 | Train Acc: 0.7273
 Site-RealWorld                     | Train Loss: 2.2638 | Train Acc: 0.6944
 Site-RealWorld                     | Train Loss: 2.2392 | Train Acc: 0.7742
 Site-caltech                       | Train Loss: 2.3333 | Train Acc: 0.4545
 Site-caltech                       | Train Loss: 2.3141 | Train Acc: 0.6000
 Site-caltech                       | Train Loss: 2.2367 | Train Acc: 0.9048
 Site-caltech                       | Train Loss: 2.3207 | Train Acc: 0.5000
 Site-caltech                       | Train Loss: 2.2564 | Train Acc: 0.7073
 Site-caltech                       | Train Loss: 2.2597 | Train Acc: 0.7895
 Site-caltech                       | Train Loss: 2.3023 | Train Acc: 0.6329
 Site-Product                       | Train Loss: 2.2462 | Train Acc: 0.7692
 Site-Product                       | Train Loss: 2.2631 | Train Acc: 0.7500
 Site-Product                       | Train Loss: 2.2634 | Train Acc: 0.6207
 Site-Product                       | Train Loss: 2.2724 | Train Acc: 0.7045
 Site-Product                       | Train Loss: 2.2417 | Train Acc: 0.6818
 Site-amazon                        | Train Loss: 2.2459 | Train Acc: 0.7000
 Site-amazon                        | Train Loss: 2.2743 | Train Acc: 0.7714
 Site-amazon                        | Train Loss: 2.2737 | Train Acc: 0.7097
 Site-webcam                        | Train Loss: 2.2870 | Train Acc: 0.7037
 Site-webcam                        | Train Loss: 2.2897 | Train Acc: 0.5556
 Site-Art                           | Train Loss: 2.3301 | Train Acc: 0.5273
 Site-Clipart                       | Train Loss: 2.3234 | Train Acc: 0.5135
Average Train Accuracy: 0.6857
 Site-RealWorld                     | Val  Loss: 2.1889 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.2109 | Val  Acc: 0.8750
 Site-RealWorld                     | Val  Loss: 2.2276 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 2.2505 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 2.2825 | Val  Acc: 0.7059
 Site-RealWorld                     | Val  Loss: 2.2771 | Val  Acc: 0.6364
 Site-RealWorld                     | Val  Loss: 2.2701 | Val  Acc: 0.6786
 Site-RealWorld                     | Val  Loss: 2.2566 | Val  Acc: 0.8108
 Site-RealWorld                     | Val  Loss: 2.2300 | Val  Acc: 0.8125
 Site-RealWorld                     | Val  Loss: 2.2719 | Val  Acc: 0.7097
 Site-caltech                       | Val  Loss: 2.2587 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 2.3092 | Val  Acc: 0.7000
 Site-caltech                       | Val  Loss: 2.2948 | Val  Acc: 0.6429
 Site-caltech                       | Val  Loss: 2.2452 | Val  Acc: 0.7500
 Site-caltech                       | Val  Loss: 2.2230 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 2.2438 | Val  Acc: 0.6842
 Site-caltech                       | Val  Loss: 2.2838 | Val  Acc: 0.6604
 Site-Product                       | Val  Loss: 2.2505 | Val  Acc: 0.6250
 Site-Product                       | Val  Loss: 2.2423 | Val  Acc: 0.6154
 Site-Product                       | Val  Loss: 2.2456 | Val  Acc: 0.8500
 Site-Product                       | Val  Loss: 2.2663 | Val  Acc: 0.6897
 Site-Product                       | Val  Loss: 2.2636 | Val  Acc: 0.6136
 Site-amazon                        | Val  Loss: 2.2438 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.3110 | Val  Acc: 0.4783
 Site-amazon                        | Val  Loss: 2.2808 | Val  Acc: 0.6585
 Site-webcam                        | Val  Loss: 2.2963 | Val  Acc: 0.6667
 Site-webcam                        | Val  Loss: 2.2834 | Val  Acc: 0.5833
 Site-Art                           | Val  Loss: 2.3324 | Val  Acc: 0.5556
 Site-Clipart                       | Val  Loss: 2.3163 | Val  Acc: 0.5417
Average Valid Accuracy: 0.7113
 Best site-RealWorld                 | Epoch:4 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8750
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7059
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6364
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.6786
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8108
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.8125
 Best site-RealWorld                 | Epoch:4 | Val Acc: 0.7097
 Best site-caltech                   | Epoch:4 | Val Acc: 0.8571
 Best site-caltech                   | Epoch:4 | Val Acc: 0.7000
 Best site-caltech                   | Epoch:4 | Val Acc: 0.6429
 Best site-caltech                   | Epoch:4 | Val Acc: 0.7500
 Best site-caltech                   | Epoch:4 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:4 | Val Acc: 0.6842
 Best site-caltech                   | Epoch:4 | Val Acc: 0.6604
 Best site-Product                   | Epoch:4 | Val Acc: 0.6250
 Best site-Product                   | Epoch:4 | Val Acc: 0.6154
 Best site-Product                   | Epoch:4 | Val Acc: 0.8500
 Best site-Product                   | Epoch:4 | Val Acc: 0.6897
 Best site-Product                   | Epoch:4 | Val Acc: 0.6136
 Best site-amazon                    | Epoch:4 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:4 | Val Acc: 0.4783
 Best site-amazon                    | Epoch:4 | Val Acc: 0.6585
 Best site-webcam                    | Epoch:4 | Val Acc: 0.6667
 Best site-webcam                    | Epoch:4 | Val Acc: 0.5833
 Best site-Art                       | Epoch:4 | Val Acc: 0.5556
 Best site-Clipart                   | Epoch:4 | Val Acc: 0.5417
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 5 ============
 Site-RealWorld                     | Train Loss: 2.2230 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.2660 | Train Acc: 0.7500
 Site-RealWorld                     | Train Loss: 2.1623 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 2.1980 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 2.2144 | Train Acc: 0.8400
 Site-RealWorld                     | Train Loss: 2.2305 | Train Acc: 0.7576
 Site-RealWorld                     | Train Loss: 2.1774 | Train Acc: 0.8605
 Site-RealWorld                     | Train Loss: 2.2220 | Train Acc: 0.8182
 Site-RealWorld                     | Train Loss: 2.2032 | Train Acc: 0.7917
 Site-RealWorld                     | Train Loss: 2.2019 | Train Acc: 0.8495
 Site-caltech                       | Train Loss: 2.2935 | Train Acc: 0.6364
 Site-caltech                       | Train Loss: 2.2566 | Train Acc: 0.6667
 Site-caltech                       | Train Loss: 2.1984 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 2.2590 | Train Acc: 0.7000
 Site-caltech                       | Train Loss: 2.2179 | Train Acc: 0.7073
 Site-caltech                       | Train Loss: 2.2050 | Train Acc: 0.8421
 Site-caltech                       | Train Loss: 2.2206 | Train Acc: 0.7342
 Site-Product                       | Train Loss: 2.1791 | Train Acc: 0.7692
 Site-Product                       | Train Loss: 2.2369 | Train Acc: 0.7000
 Site-Product                       | Train Loss: 2.2288 | Train Acc: 0.7586
 Site-Product                       | Train Loss: 2.2151 | Train Acc: 0.7273
 Site-Product                       | Train Loss: 2.1592 | Train Acc: 0.8030
 Site-amazon                        | Train Loss: 2.1961 | Train Acc: 0.7500
 Site-amazon                        | Train Loss: 2.2266 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 2.2254 | Train Acc: 0.7903
 Site-webcam                        | Train Loss: 2.2469 | Train Acc: 0.7037
 Site-webcam                        | Train Loss: 2.2483 | Train Acc: 0.7222
 Site-Art                           | Train Loss: 2.2846 | Train Acc: 0.6182
 Site-Clipart                       | Train Loss: 2.2790 | Train Acc: 0.5676
Average Train Accuracy: 0.7658
 Site-RealWorld                     | Val  Loss: 2.1301 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1426 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.2038 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 2.2196 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 2.2660 | Val  Acc: 0.5882
 Site-RealWorld                     | Val  Loss: 2.2352 | Val  Acc: 0.6818
 Site-RealWorld                     | Val  Loss: 2.2274 | Val  Acc: 0.7857
 Site-RealWorld                     | Val  Loss: 2.2044 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 2.1786 | Val  Acc: 0.8542
 Site-RealWorld                     | Val  Loss: 2.2316 | Val  Acc: 0.7903
 Site-caltech                       | Val  Loss: 2.2387 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.2345 | Val  Acc: 0.8000
 Site-caltech                       | Val  Loss: 2.2497 | Val  Acc: 0.7143
 Site-caltech                       | Val  Loss: 2.1893 | Val  Acc: 0.8500
 Site-caltech                       | Val  Loss: 2.1724 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 2.1939 | Val  Acc: 0.7632
 Site-caltech                       | Val  Loss: 2.2533 | Val  Acc: 0.6604
 Site-Product                       | Val  Loss: 2.1926 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 2.2059 | Val  Acc: 0.6923
 Site-Product                       | Val  Loss: 2.1888 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 2.2177 | Val  Acc: 0.8276
 Site-Product                       | Val  Loss: 2.2214 | Val  Acc: 0.7500
 Site-amazon                        | Val  Loss: 2.2178 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.2652 | Val  Acc: 0.6087
 Site-amazon                        | Val  Loss: 2.2357 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 2.2497 | Val  Acc: 0.6111
 Site-webcam                        | Val  Loss: 2.2526 | Val  Acc: 0.6944
 Site-Art                           | Val  Loss: 2.3201 | Val  Acc: 0.5278
 Site-Clipart                       | Val  Loss: 2.2991 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7842
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.5882
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.6818
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7857
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.8542
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.7903
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 0.8000
 Best site-caltech                   | Epoch:5 | Val Acc: 0.7143
 Best site-caltech                   | Epoch:5 | Val Acc: 0.8500
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:5 | Val Acc: 0.7632
 Best site-caltech                   | Epoch:5 | Val Acc: 0.6604
 Best site-Product                   | Epoch:5 | Val Acc: 0.8750
 Best site-Product                   | Epoch:5 | Val Acc: 0.6923
 Best site-Product                   | Epoch:5 | Val Acc: 0.9000
 Best site-Product                   | Epoch:5 | Val Acc: 0.8276
 Best site-Product                   | Epoch:5 | Val Acc: 0.7500
 Best site-amazon                    | Epoch:5 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:5 | Val Acc: 0.6087
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:5 | Val Acc: 0.6111
 Best site-webcam                    | Epoch:5 | Val Acc: 0.6944
 Best site-Art                       | Epoch:5 | Val Acc: 0.5278
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 6 ============
 Site-RealWorld                     | Train Loss: 2.2101 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.2283 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.1474 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.1676 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.1540 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 2.1995 | Train Acc: 0.8182
 Site-RealWorld                     | Train Loss: 2.1276 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 2.1602 | Train Acc: 0.8364
 Site-RealWorld                     | Train Loss: 2.1921 | Train Acc: 0.8472
 Site-RealWorld                     | Train Loss: 2.1470 | Train Acc: 0.8817
 Site-caltech                       | Train Loss: 2.2488 | Train Acc: 0.6364
 Site-caltech                       | Train Loss: 2.2188 | Train Acc: 0.6667
 Site-caltech                       | Train Loss: 2.1442 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 2.2226 | Train Acc: 0.7333
 Site-caltech                       | Train Loss: 2.1760 | Train Acc: 0.8293
 Site-caltech                       | Train Loss: 2.1576 | Train Acc: 0.9123
 Site-caltech                       | Train Loss: 2.2030 | Train Acc: 0.7848
 Site-Product                       | Train Loss: 2.1502 | Train Acc: 0.7692
 Site-Product                       | Train Loss: 2.1931 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 2.1712 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 2.1723 | Train Acc: 0.8182
 Site-Product                       | Train Loss: 2.2007 | Train Acc: 0.8333
 Site-amazon                        | Train Loss: 2.1423 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 2.1755 | Train Acc: 0.7714
 Site-amazon                        | Train Loss: 2.1816 | Train Acc: 0.8226
 Site-webcam                        | Train Loss: 2.1959 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 2.2055 | Train Acc: 0.7778
 Site-Art                           | Train Loss: 2.2578 | Train Acc: 0.6364
 Site-Clipart                       | Train Loss: 2.2542 | Train Acc: 0.6486
Average Train Accuracy: 0.8158
 Site-RealWorld                     | Val  Loss: 2.0735 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0900 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1529 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.1677 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 2.2110 | Val  Acc: 0.6471
 Site-RealWorld                     | Val  Loss: 2.1781 | Val  Acc: 0.8182
 Site-RealWorld                     | Val  Loss: 2.1892 | Val  Acc: 0.7857
 Site-RealWorld                     | Val  Loss: 2.1541 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 2.1348 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.1897 | Val  Acc: 0.7742
 Site-caltech                       | Val  Loss: 2.1497 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.2264 | Val  Acc: 0.8000
 Site-caltech                       | Val  Loss: 2.2065 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 2.1529 | Val  Acc: 0.9000
 Site-caltech                       | Val  Loss: 2.1276 | Val  Acc: 0.9259
 Site-caltech                       | Val  Loss: 2.1616 | Val  Acc: 0.8421
 Site-caltech                       | Val  Loss: 2.2027 | Val  Acc: 0.8113
 Site-Product                       | Val  Loss: 2.1720 | Val  Acc: 0.7500
 Site-Product                       | Val  Loss: 2.1540 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 2.1343 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 2.1683 | Val  Acc: 0.7931
 Site-Product                       | Val  Loss: 2.1594 | Val  Acc: 0.7955
 Site-amazon                        | Val  Loss: 2.1796 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.2254 | Val  Acc: 0.6957
 Site-amazon                        | Val  Loss: 2.2024 | Val  Acc: 0.6829
 Site-webcam                        | Val  Loss: 2.1988 | Val  Acc: 0.7222
 Site-webcam                        | Val  Loss: 2.2077 | Val  Acc: 0.7778
 Site-Art                           | Val  Loss: 2.2929 | Val  Acc: 0.5833
 Site-Clipart                       | Val  Loss: 2.2323 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8288
 Best site-RealWorld                 | Epoch:6 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:6 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.6471
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8182
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7857
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:6 | Val Acc: 0.7742
 Best site-caltech                   | Epoch:6 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:6 | Val Acc: 0.8000
 Best site-caltech                   | Epoch:6 | Val Acc: 0.8571
 Best site-caltech                   | Epoch:6 | Val Acc: 0.9000
 Best site-caltech                   | Epoch:6 | Val Acc: 0.9259
 Best site-caltech                   | Epoch:6 | Val Acc: 0.8421
 Best site-caltech                   | Epoch:6 | Val Acc: 0.8113
 Best site-Product                   | Epoch:6 | Val Acc: 0.7500
 Best site-Product                   | Epoch:6 | Val Acc: 0.9231
 Best site-Product                   | Epoch:6 | Val Acc: 0.9500
 Best site-Product                   | Epoch:6 | Val Acc: 0.7931
 Best site-Product                   | Epoch:6 | Val Acc: 0.7955
 Best site-amazon                    | Epoch:6 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:6 | Val Acc: 0.6957
 Best site-amazon                    | Epoch:6 | Val Acc: 0.6829
 Best site-webcam                    | Epoch:6 | Val Acc: 0.7222
 Best site-webcam                    | Epoch:6 | Val Acc: 0.7778
 Best site-Art                       | Epoch:6 | Val Acc: 0.5833
 Best site-Clipart                   | Epoch:6 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 7 ============
 Site-RealWorld                     | Train Loss: 2.1765 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.1645 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 2.0624 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 2.1114 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.0972 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 2.1644 | Train Acc: 0.8182
 Site-RealWorld                     | Train Loss: 2.0886 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 2.1303 | Train Acc: 0.8364
 Site-RealWorld                     | Train Loss: 2.0999 | Train Acc: 0.8472
 Site-RealWorld                     | Train Loss: 2.0957 | Train Acc: 0.9140
 Site-caltech                       | Train Loss: 2.1930 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 2.1797 | Train Acc: 0.7333
 Site-caltech                       | Train Loss: 2.1125 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 2.1734 | Train Acc: 0.8333
 Site-caltech                       | Train Loss: 2.1145 | Train Acc: 0.8293
 Site-caltech                       | Train Loss: 2.1155 | Train Acc: 0.8947
 Site-caltech                       | Train Loss: 2.1496 | Train Acc: 0.8354
 Site-Product                       | Train Loss: 2.0957 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 2.1333 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 2.1261 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 2.1231 | Train Acc: 0.8409
 Site-Product                       | Train Loss: 2.0949 | Train Acc: 0.8939
 Site-amazon                        | Train Loss: 2.1080 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 2.1373 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 2.1373 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 2.1436 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 2.1688 | Train Acc: 0.8148
 Site-Art                           | Train Loss: 2.2113 | Train Acc: 0.6909
 Site-Clipart                       | Train Loss: 2.2243 | Train Acc: 0.5676
Average Train Accuracy: 0.8500
 Site-RealWorld                     | Val  Loss: 2.0124 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0276 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.1036 | Val  Acc: 0.8000
 Site-RealWorld                     | Val  Loss: 2.1502 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 2.1561 | Val  Acc: 0.8235
 Site-RealWorld                     | Val  Loss: 2.1338 | Val  Acc: 0.8182
 Site-RealWorld                     | Val  Loss: 2.1269 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 2.0993 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 2.0900 | Val  Acc: 0.8958
 Site-RealWorld                     | Val  Loss: 2.1483 | Val  Acc: 0.8065
 Site-caltech                       | Val  Loss: 2.1152 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.1563 | Val  Acc: 0.9000
 Site-caltech                       | Val  Loss: 2.1728 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 2.1125 | Val  Acc: 0.9000
 Site-caltech                       | Val  Loss: 2.0908 | Val  Acc: 0.9259
 Site-caltech                       | Val  Loss: 2.0989 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 2.1620 | Val  Acc: 0.7925
 Site-Product                       | Val  Loss: 2.1075 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 2.0902 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 2.1131 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 2.1118 | Val  Acc: 0.8621
 Site-Product                       | Val  Loss: 2.1130 | Val  Acc: 0.8409
 Site-amazon                        | Val  Loss: 2.1438 | Val  Acc: 0.6923
 Site-amazon                        | Val  Loss: 2.1708 | Val  Acc: 0.7391
 Site-amazon                        | Val  Loss: 2.1590 | Val  Acc: 0.7805
 Site-webcam                        | Val  Loss: 2.1498 | Val  Acc: 0.7778
 Site-webcam                        | Val  Loss: 2.1571 | Val  Acc: 0.8056
 Site-Art                           | Val  Loss: 2.2574 | Val  Acc: 0.6667
 Site-Clipart                       | Val  Loss: 2.2222 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8485
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8235
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8182
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8214
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8958
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.8065
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.8571
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9259
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:7 | Val Acc: 0.7925
 Best site-Product                   | Epoch:7 | Val Acc: 0.8750
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 0.9000
 Best site-Product                   | Epoch:7 | Val Acc: 0.8621
 Best site-Product                   | Epoch:7 | Val Acc: 0.8409
 Best site-amazon                    | Epoch:7 | Val Acc: 0.6923
 Best site-amazon                    | Epoch:7 | Val Acc: 0.7391
 Best site-amazon                    | Epoch:7 | Val Acc: 0.7805
 Best site-webcam                    | Epoch:7 | Val Acc: 0.7778
 Best site-webcam                    | Epoch:7 | Val Acc: 0.8056
 Best site-Art                       | Epoch:7 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 8 ============
 Site-RealWorld                     | Train Loss: 2.1003 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.1337 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 2.0552 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 2.0731 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 2.0600 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 2.0944 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 2.0369 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 2.0786 | Train Acc: 0.8727
 Site-RealWorld                     | Train Loss: 2.0596 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.0556 | Train Acc: 0.9462
 Site-caltech                       | Train Loss: 2.1723 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 2.1373 | Train Acc: 0.7333
 Site-caltech                       | Train Loss: 2.0662 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 2.1467 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 2.0921 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 2.0651 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 2.1018 | Train Acc: 0.8354
 Site-Product                       | Train Loss: 2.0508 | Train Acc: 0.6923
 Site-Product                       | Train Loss: 2.0917 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 2.0859 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 2.0764 | Train Acc: 0.8636
 Site-Product                       | Train Loss: 2.0373 | Train Acc: 0.9242
 Site-amazon                        | Train Loss: 2.0353 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 2.0883 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 2.0996 | Train Acc: 0.8387
 Site-webcam                        | Train Loss: 2.1233 | Train Acc: 0.7778
 Site-webcam                        | Train Loss: 2.1061 | Train Acc: 0.8889
 Site-Art                           | Train Loss: 2.1937 | Train Acc: 0.7091
 Site-Clipart                       | Train Loss: 2.1859 | Train Acc: 0.6757
Average Train Accuracy: 0.8601
 Site-RealWorld                     | Val  Loss: 1.9758 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0030 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0640 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.0755 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 2.1440 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 2.0959 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 2.0945 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 2.0611 | Val  Acc: 0.7838
 Site-RealWorld                     | Val  Loss: 2.0306 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 2.1014 | Val  Acc: 0.8710
 Site-caltech                       | Val  Loss: 2.0934 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.1012 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.1381 | Val  Acc: 0.7857
 Site-caltech                       | Val  Loss: 2.0819 | Val  Acc: 0.9000
 Site-caltech                       | Val  Loss: 2.0352 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 2.0523 | Val  Acc: 0.8684
 Site-caltech                       | Val  Loss: 2.1245 | Val  Acc: 0.8302
 Site-Product                       | Val  Loss: 2.0558 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 2.0454 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 2.0370 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 2.0809 | Val  Acc: 0.8621
 Site-Product                       | Val  Loss: 2.0730 | Val  Acc: 0.7727
 Site-amazon                        | Val  Loss: 2.1119 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.1499 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 2.1185 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 2.1082 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 2.1111 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 2.2115 | Val  Acc: 0.6389
 Site-Clipart                       | Val  Loss: 2.1662 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8723
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.7838
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.8710
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 0.7857
 Best site-caltech                   | Epoch:8 | Val Acc: 0.9000
 Best site-caltech                   | Epoch:8 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:8 | Val Acc: 0.8684
 Best site-caltech                   | Epoch:8 | Val Acc: 0.8302
 Best site-Product                   | Epoch:8 | Val Acc: 0.8750
 Best site-Product                   | Epoch:8 | Val Acc: 0.9231
 Best site-Product                   | Epoch:8 | Val Acc: 0.9000
 Best site-Product                   | Epoch:8 | Val Acc: 0.8621
 Best site-Product                   | Epoch:8 | Val Acc: 0.7727
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:8 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:8 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8333
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8333
 Best site-Art                       | Epoch:8 | Val Acc: 0.6389
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 9 ============
 Site-RealWorld                     | Train Loss: 2.0789 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 2.0906 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.9958 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 2.0269 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 2.0152 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 2.0750 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.9879 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 2.0501 | Train Acc: 0.8545
 Site-RealWorld                     | Train Loss: 2.0540 | Train Acc: 0.8611
 Site-RealWorld                     | Train Loss: 2.0124 | Train Acc: 0.9355
 Site-caltech                       | Train Loss: 2.1135 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 2.1156 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 2.0421 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 2.0979 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 2.0342 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 2.0430 | Train Acc: 0.9123
 Site-caltech                       | Train Loss: 2.0617 | Train Acc: 0.8481
 Site-Product                       | Train Loss: 2.0110 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 2.0540 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 2.0491 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 2.0282 | Train Acc: 0.8409
 Site-Product                       | Train Loss: 1.9707 | Train Acc: 0.8939
 Site-amazon                        | Train Loss: 2.0058 | Train Acc: 0.8000
 Site-amazon                        | Train Loss: 2.0699 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 2.0485 | Train Acc: 0.8387
 Site-webcam                        | Train Loss: 2.0746 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 2.0728 | Train Acc: 0.9259
 Site-Art                           | Train Loss: 2.1407 | Train Acc: 0.7636
 Site-Clipart                       | Train Loss: 2.1375 | Train Acc: 0.7568
Average Train Accuracy: 0.8694
 Site-RealWorld                     | Val  Loss: 1.8938 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9539 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0355 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 2.0485 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 2.0966 | Val  Acc: 0.7647
 Site-RealWorld                     | Val  Loss: 2.0536 | Val  Acc: 0.8636
 Site-RealWorld                     | Val  Loss: 2.0532 | Val  Acc: 0.8214
 Site-RealWorld                     | Val  Loss: 2.0197 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 1.9893 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 2.0635 | Val  Acc: 0.8387
 Site-caltech                       | Val  Loss: 2.0345 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.0564 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.1190 | Val  Acc: 0.7143
 Site-caltech                       | Val  Loss: 2.0240 | Val  Acc: 0.9000
 Site-caltech                       | Val  Loss: 1.9979 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 2.0005 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 2.0731 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.9990 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9802 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9961 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 2.0148 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 2.0426 | Val  Acc: 0.8182
 Site-amazon                        | Val  Loss: 2.0749 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 2.0916 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 2.0824 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 2.0604 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 2.0515 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 2.1922 | Val  Acc: 0.6944
 Site-Clipart                       | Val  Loss: 2.1227 | Val  Acc: 0.7500
Average Valid Accuracy: 0.8836
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.7647
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8636
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8214
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.8387
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 0.7143
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9000
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9057
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 0.9000
 Best site-Product                   | Epoch:9 | Val Acc: 0.9310
 Best site-Product                   | Epoch:9 | Val Acc: 0.8182
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:9 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:9 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9167
 Best site-Art                       | Epoch:9 | Val Acc: 0.6944
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 10 ============
 Site-RealWorld                     | Train Loss: 2.0585 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.0715 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.9734 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.9991 | Train Acc: 0.8500
 Site-RealWorld                     | Train Loss: 1.9805 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 2.0289 | Train Acc: 0.8485
 Site-RealWorld                     | Train Loss: 1.9462 | Train Acc: 0.9070
 Site-RealWorld                     | Train Loss: 1.9780 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.9201 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.9396 | Train Acc: 0.9570
 Site-caltech                       | Train Loss: 2.0732 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 2.0632 | Train Acc: 0.7333
 Site-caltech                       | Train Loss: 1.9965 | Train Acc: 0.9048
 Site-caltech                       | Train Loss: 2.0634 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 1.9928 | Train Acc: 0.8537
 Site-caltech                       | Train Loss: 1.9846 | Train Acc: 0.9123
 Site-caltech                       | Train Loss: 2.0414 | Train Acc: 0.8734
 Site-Product                       | Train Loss: 1.9326 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.9955 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 2.0254 | Train Acc: 0.8276
 Site-Product                       | Train Loss: 1.9823 | Train Acc: 0.8636
 Site-Product                       | Train Loss: 1.9882 | Train Acc: 0.9091
 Site-amazon                        | Train Loss: 1.9591 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 2.0182 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 2.0196 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 2.0411 | Train Acc: 0.8148
 Site-webcam                        | Train Loss: 2.0138 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 2.1338 | Train Acc: 0.6545
 Site-Clipart                       | Train Loss: 2.1059 | Train Acc: 0.7568
Average Train Accuracy: 0.8633
 Site-RealWorld                     | Val  Loss: 1.8837 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8955 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9971 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.9939 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 2.0428 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 2.0321 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 2.0077 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.9581 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.9592 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 2.0204 | Val  Acc: 0.8710
 Site-caltech                       | Val  Loss: 1.9983 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.0448 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.0750 | Val  Acc: 0.7857
 Site-caltech                       | Val  Loss: 1.9942 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.9478 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.9764 | Val  Acc: 0.9211
 Site-caltech                       | Val  Loss: 2.0448 | Val  Acc: 0.8679
 Site-Product                       | Val  Loss: 1.9546 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9558 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 1.9417 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.9684 | Val  Acc: 0.8966
 Site-Product                       | Val  Loss: 1.9833 | Val  Acc: 0.8636
 Site-amazon                        | Val  Loss: 2.0080 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.0548 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 2.0461 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 2.0259 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 2.0288 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 2.1578 | Val  Acc: 0.6667
 Site-Clipart                       | Val  Loss: 2.1092 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8928
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.8710
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 0.7857
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9500
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9211
 Best site-caltech                   | Epoch:10 | Val Acc: 0.8679
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 0.9231
 Best site-Product                   | Epoch:10 | Val Acc: 0.9500
 Best site-Product                   | Epoch:10 | Val Acc: 0.8966
 Best site-Product                   | Epoch:10 | Val Acc: 0.8636
 Best site-amazon                    | Epoch:10 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:10 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8333
 Best site-webcam                    | Epoch:10 | Val Acc: 0.8889
 Best site-Art                       | Epoch:10 | Val Acc: 0.6667
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 11 ============
 Site-RealWorld                     | Train Loss: 2.0243 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.0290 | Train Acc: 0.8333
 Site-RealWorld                     | Train Loss: 1.8635 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.9248 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.9182 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.9938 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.8861 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.9320 | Train Acc: 0.8909
 Site-RealWorld                     | Train Loss: 1.9321 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.9187 | Train Acc: 0.9355
 Site-caltech                       | Train Loss: 2.0437 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 2.0290 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 1.9466 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 2.0386 | Train Acc: 0.8333
 Site-caltech                       | Train Loss: 1.9504 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.9426 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.9897 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.9380 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.9465 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.9743 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 1.9464 | Train Acc: 0.8409
 Site-Product                       | Train Loss: 1.8316 | Train Acc: 0.9091
 Site-amazon                        | Train Loss: 1.8974 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.9783 | Train Acc: 0.7714
 Site-amazon                        | Train Loss: 1.9674 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.9889 | Train Acc: 0.8519
 Site-webcam                        | Train Loss: 1.9789 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 2.1012 | Train Acc: 0.7273
 Site-Clipart                       | Train Loss: 2.0840 | Train Acc: 0.7568
Average Train Accuracy: 0.8761
 Site-RealWorld                     | Val  Loss: 1.8236 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8468 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9327 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9652 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 2.0210 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.9541 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.9388 | Val  Acc: 0.9286
 Site-RealWorld                     | Val  Loss: 1.9143 | Val  Acc: 0.8649
 Site-RealWorld                     | Val  Loss: 1.8984 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 1.9634 | Val  Acc: 0.8710
 Site-caltech                       | Val  Loss: 1.9981 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.9878 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.9876 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 1.9430 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.8889 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.9034 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.9940 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.9216 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8894 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8814 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.9283 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.9486 | Val  Acc: 0.8409
 Site-amazon                        | Val  Loss: 1.9849 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.0483 | Val  Acc: 0.7391
 Site-amazon                        | Val  Loss: 2.0002 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.9667 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.9716 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 2.1232 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 2.0585 | Val  Acc: 0.7083
Average Valid Accuracy: 0.9096
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8824
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9286
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8649
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:11 | Val Acc: 0.8710
 Best site-caltech                   | Epoch:11 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:11 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:11 | Val Acc: 0.8571
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9500
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:11 | Val Acc: 0.9057
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 1.0000
 Best site-Product                   | Epoch:11 | Val Acc: 0.9500
 Best site-Product                   | Epoch:11 | Val Acc: 0.9310
 Best site-Product                   | Epoch:11 | Val Acc: 0.8409
 Best site-amazon                    | Epoch:11 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:11 | Val Acc: 0.7391
 Best site-amazon                    | Epoch:11 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9444
 Best site-webcam                    | Epoch:11 | Val Acc: 0.9444
 Best site-Art                       | Epoch:11 | Val Acc: 0.7778
 Best site-Clipart                   | Epoch:11 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 12 ============
 Site-RealWorld                     | Train Loss: 1.9927 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.0007 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.8664 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.8883 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.8896 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.9567 | Train Acc: 0.8182
 Site-RealWorld                     | Train Loss: 1.8583 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.8889 | Train Acc: 0.8909
 Site-RealWorld                     | Train Loss: 1.8736 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.8458 | Train Acc: 0.9677
 Site-caltech                       | Train Loss: 2.0103 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 1.9846 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.9066 | Train Acc: 0.9048
 Site-caltech                       | Train Loss: 1.9751 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 1.8948 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 1.8953 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.9149 | Train Acc: 0.8987
 Site-Product                       | Train Loss: 1.8695 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.9078 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.9458 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 1.8890 | Train Acc: 0.9091
 Site-Product                       | Train Loss: 1.9941 | Train Acc: 0.9242
 Site-amazon                        | Train Loss: 1.8539 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.9290 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.9188 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.9446 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.9382 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 2.0554 | Train Acc: 0.7455
 Site-Clipart                       | Train Loss: 2.0638 | Train Acc: 0.6486
Average Train Accuracy: 0.8759
 Site-RealWorld                     | Val  Loss: 1.7473 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8150 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8685 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9252 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.9814 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.9135 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9234 | Val  Acc: 0.8571
 Site-RealWorld                     | Val  Loss: 1.8757 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.8438 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.9437 | Val  Acc: 0.8387
 Site-caltech                       | Val  Loss: 1.9303 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.9567 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.9609 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8961 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8471 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8781 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.9462 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.8766 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8601 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8858 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.8790 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.9121 | Val  Acc: 0.8864
 Site-amazon                        | Val  Loss: 1.9548 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.9949 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.9710 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 1.9276 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.9221 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 2.1050 | Val  Acc: 0.7222
 Site-Clipart                       | Val  Loss: 2.0281 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9259
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8571
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:12 | Val Acc: 0.8387
 Best site-caltech                   | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:12 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:12 | Val Acc: 0.9057
 Best site-Product                   | Epoch:12 | Val Acc: 1.0000
 Best site-Product                   | Epoch:12 | Val Acc: 1.0000
 Best site-Product                   | Epoch:12 | Val Acc: 0.9000
 Best site-Product                   | Epoch:12 | Val Acc: 0.9310
 Best site-Product                   | Epoch:12 | Val Acc: 0.8864
 Best site-amazon                    | Epoch:12 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:12 | Val Acc: 0.8049
 Best site-webcam                    | Epoch:12 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:12 | Val Acc: 0.9722
 Best site-Art                       | Epoch:12 | Val Acc: 0.7222
 Best site-Clipart                   | Epoch:12 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 13 ============
 Site-RealWorld                     | Train Loss: 1.9180 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.9437 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.8000 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.8531 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.8148 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.9090 | Train Acc: 0.8485
 Site-RealWorld                     | Train Loss: 1.8069 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.8790 | Train Acc: 0.8909
 Site-RealWorld                     | Train Loss: 1.8424 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.8174 | Train Acc: 0.9570
 Site-caltech                       | Train Loss: 1.9947 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 1.9562 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.8593 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.9225 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.8546 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.8672 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.8849 | Train Acc: 0.9114
 Site-Product                       | Train Loss: 1.8151 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.8639 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.8916 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 1.8453 | Train Acc: 0.8864
 Site-Product                       | Train Loss: 1.8647 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.8083 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.9003 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.8825 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.9084 | Train Acc: 0.8519
 Site-webcam                        | Train Loss: 1.8993 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 2.0159 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 2.0263 | Train Acc: 0.7027
Average Train Accuracy: 0.8919
 Site-RealWorld                     | Val  Loss: 1.7427 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7242 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8813 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8994 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.9532 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.8848 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8562 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.8150 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.8179 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 1.8929 | Val  Acc: 0.8871
 Site-caltech                       | Val  Loss: 1.9881 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.9206 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8954 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.8463 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.8110 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8303 | Val  Acc: 0.9211
 Site-caltech                       | Val  Loss: 1.9270 | Val  Acc: 0.8868
 Site-Product                       | Val  Loss: 1.8253 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8221 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7850 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.8376 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.8628 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.8545 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.9630 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.9271 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.9154 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 1.8965 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 2.0464 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 1.9984 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9215
============ Train epoch 14 ============
 Site-RealWorld                     | Train Loss: 1.8974 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.8840 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.7551 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.8170 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.7978 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.8771 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.7638 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.8194 | Train Acc: 0.9273
 Site-RealWorld                     | Train Loss: 1.7979 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.7872 | Train Acc: 0.9677
 Site-caltech                       | Train Loss: 1.9296 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 1.9080 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.7865 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.9196 | Train Acc: 0.8333
 Site-caltech                       | Train Loss: 1.8251 | Train Acc: 0.8537
 Site-caltech                       | Train Loss: 1.7988 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.9320 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.7326 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.8314 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.8513 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 1.8208 | Train Acc: 0.9091
 Site-Product                       | Train Loss: 1.8897 | Train Acc: 0.9242
 Site-amazon                        | Train Loss: 1.7628 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.8612 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.8423 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.8760 | Train Acc: 0.8519
 Site-webcam                        | Train Loss: 1.8559 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 1.9950 | Train Acc: 0.7818
 Site-Clipart                       | Train Loss: 2.0077 | Train Acc: 0.7027
Average Train Accuracy: 0.9006
 Site-RealWorld                     | Val  Loss: 1.6447 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6623 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7645 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8678 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 1.8865 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.8551 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8281 | Val  Acc: 0.9286
 Site-RealWorld                     | Val  Loss: 1.7941 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 1.7641 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.8533 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.8673 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8696 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8909 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8013 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7573 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7875 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.8825 | Val  Acc: 0.8868
 Site-Product                       | Val  Loss: 1.7798 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7396 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7376 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.7943 | Val  Acc: 0.8966
 Site-Product                       | Val  Loss: 1.8234 | Val  Acc: 0.8636
 Site-amazon                        | Val  Loss: 1.8259 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.9399 | Val  Acc: 0.7391
 Site-amazon                        | Val  Loss: 1.8918 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.8670 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.8633 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 2.0478 | Val  Acc: 0.7500
 Site-Clipart                       | Val  Loss: 1.9690 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9248
============ Train epoch 15 ============
 Site-RealWorld                     | Train Loss: 1.8712 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.8783 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7698 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.7706 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.7688 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.8485 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.7279 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.7717 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.8058 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.7274 | Train Acc: 0.9785
 Site-caltech                       | Train Loss: 1.8938 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 1.8637 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.7477 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.8720 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 1.7650 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.7893 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.8104 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.7337 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.7757 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.8102 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 1.7735 | Train Acc: 0.9091
 Site-Product                       | Train Loss: 1.7101 | Train Acc: 0.9394
 Site-amazon                        | Train Loss: 1.7152 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.8312 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.8317 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.8061 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.8334 | Train Acc: 0.9074
 Site-Art                           | Train Loss: 1.9489 | Train Acc: 0.7818
 Site-Clipart                       | Train Loss: 1.9597 | Train Acc: 0.7297
Average Train Accuracy: 0.9131
 Site-RealWorld                     | Val  Loss: 1.6217 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6222 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7350 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8451 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.9044 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.8220 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.7909 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.7498 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.7355 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 1.8063 | Val  Acc: 0.8871
 Site-caltech                       | Val  Loss: 1.8119 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8285 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8953 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.7555 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7280 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7489 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.8416 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.7154 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7104 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7415 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.7354 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 1.7691 | Val  Acc: 0.9091
 Site-amazon                        | Val  Loss: 1.7803 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.9087 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.8672 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.8023 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.8486 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 2.0128 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.9170 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9341
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9459
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.8871
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 0.9286
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:15 | Val Acc: 0.9245
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 0.9500
 Best site-Product                   | Epoch:15 | Val Acc: 0.9655
 Best site-Product                   | Epoch:15 | Val Acc: 0.9091
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:15 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9444
 Best site-Art                       | Epoch:15 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 16 ============
 Site-RealWorld                     | Train Loss: 1.8196 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.8553 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7184 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.7281 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7346 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.7893 | Train Acc: 0.8485
 Site-RealWorld                     | Train Loss: 1.6675 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.7164 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.7623 | Train Acc: 0.9306
 Site-RealWorld                     | Train Loss: 1.6968 | Train Acc: 0.9677
 Site-caltech                       | Train Loss: 1.8924 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 1.8646 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.7017 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.8246 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.7541 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.7443 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.8157 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.6964 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.7446 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.7751 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.7156 | Train Acc: 0.9318
 Site-Product                       | Train Loss: 1.7468 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.6590 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.7902 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.7879 | Train Acc: 0.8387
 Site-webcam                        | Train Loss: 1.7948 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 1.7989 | Train Acc: 0.9259
 Site-Art                           | Train Loss: 1.9319 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.9451 | Train Acc: 0.6757
Average Train Accuracy: 0.9025
 Site-RealWorld                     | Val  Loss: 1.5831 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6093 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7388 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7755 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.8656 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.7757 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.7344 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.6949 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.6798 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.7736 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.7721 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7956 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.8295 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.7605 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.6663 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7107 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.7919 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.6868 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6736 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6918 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.7048 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.7414 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.7434 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.8330 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.8031 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 1.7810 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.7628 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.9895 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.9187 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9331
============ Train epoch 17 ============
 Site-RealWorld                     | Train Loss: 1.7629 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.7983 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.6336 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7051 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.6663 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.7299 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.6202 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.6773 | Train Acc: 0.9273
 Site-RealWorld                     | Train Loss: 1.6394 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.6637 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.8283 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.7986 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.6869 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.8109 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 1.6984 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.6719 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.7795 | Train Acc: 0.9114
 Site-Product                       | Train Loss: 1.6065 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6897 | Train Acc: 0.8500
 Site-Product                       | Train Loss: 1.7113 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.6581 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.5495 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.6336 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.7357 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.7381 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.7497 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.7189 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.8841 | Train Acc: 0.8364
 Site-Clipart                       | Train Loss: 1.8888 | Train Acc: 0.8108
Average Train Accuracy: 0.9191
 Site-RealWorld                     | Val  Loss: 1.5244 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5140 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7393 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 1.7579 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.8168 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7279 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.6921 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.6639 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.6438 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 1.7239 | Val  Acc: 0.9032
 Site-caltech                       | Val  Loss: 1.7393 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7699 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7546 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6847 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6340 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6834 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.7652 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.6652 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6345 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6269 | Val  Acc: 0.9000
 Site-Product                       | Val  Loss: 1.6531 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.6782 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.7321 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.8392 | Val  Acc: 0.7391
 Site-amazon                        | Val  Loss: 1.7960 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.7532 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.7581 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.9258 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 1.8792 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9311
============ Train epoch 18 ============
 Site-RealWorld                     | Train Loss: 1.7228 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7522 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6372 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6462 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6693 | Train Acc: 0.8400
 Site-RealWorld                     | Train Loss: 1.7207 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.5923 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.6378 | Train Acc: 0.9273
 Site-RealWorld                     | Train Loss: 1.7482 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.5956 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.7760 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.8080 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.6195 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.7400 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.6568 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.6591 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6879 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.5556 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.6413 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6658 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.6747 | Train Acc: 0.9318
 Site-Product                       | Train Loss: 1.4950 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.5808 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.7287 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.6978 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.6834 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.7014 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.8662 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.8636 | Train Acc: 0.7838
Average Train Accuracy: 0.9350
 Site-RealWorld                     | Val  Loss: 1.4771 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4961 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6327 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6935 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7972 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6879 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.6695 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.6060 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.5842 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.7052 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.7961 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7165 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7772 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6653 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6180 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6185 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.7273 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.6290 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5534 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5936 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.6159 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.6803 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.6314 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.7231 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.7515 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.7097 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.7076 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.9279 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.8233 | Val  Acc: 0.7083
Average Valid Accuracy: 0.9386
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:18 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:18 | Val Acc: 0.9516
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:18 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:18 | Val Acc: 0.9245
 Best site-Product                   | Epoch:18 | Val Acc: 1.0000
 Best site-Product                   | Epoch:18 | Val Acc: 1.0000
 Best site-Product                   | Epoch:18 | Val Acc: 1.0000
 Best site-Product                   | Epoch:18 | Val Acc: 0.9310
 Best site-Product                   | Epoch:18 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:18 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:18 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:18 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:18 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:18 | Val Acc: 0.9722
 Best site-Art                       | Epoch:18 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:18 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 19 ============
 Site-RealWorld                     | Train Loss: 1.7321 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.7282 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5662 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6274 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5999 | Train Acc: 0.8400
 Site-RealWorld                     | Train Loss: 1.6749 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.5611 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.5963 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.6747 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.5804 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.7311 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6973 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.5814 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.7373 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.6342 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.5940 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.7254 | Train Acc: 0.8861
 Site-Product                       | Train Loss: 1.5129 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.5914 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6754 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.6142 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.4901 | Train Acc: 0.9242
 Site-amazon                        | Train Loss: 1.5543 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.6781 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.6711 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.6599 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.6784 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 1.8304 | Train Acc: 0.7818
 Site-Clipart                       | Train Loss: 1.8304 | Train Acc: 0.7568
Average Train Accuracy: 0.9294
 Site-RealWorld                     | Val  Loss: 1.4257 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4621 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5804 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7130 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7524 | Val  Acc: 0.8824
 Site-RealWorld                     | Val  Loss: 1.6398 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.6130 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 1.5795 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.5406 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.6463 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.5842 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6837 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6801 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6012 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5883 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.5909 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.7207 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.5857 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5581 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5281 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5708 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.6199 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.6467 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.7667 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.7048 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.6517 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.6911 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.9239 | Val  Acc: 0.7222
 Site-Clipart                       | Val  Loss: 1.8000 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9340
============ Train epoch 20 ============
 Site-RealWorld                     | Train Loss: 1.7003 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.7558 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.4802 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5825 | Train Acc: 0.9000
 Site-RealWorld                     | Train Loss: 1.5908 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.6108 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.5092 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.5717 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.6291 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.5122 | Train Acc: 0.9785
 Site-caltech                       | Train Loss: 1.7293 | Train Acc: 0.7273
 Site-caltech                       | Train Loss: 1.6847 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.5599 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6756 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.5977 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.5891 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.5890 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 1.5401 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.5666 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.6085 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.5629 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 1.4825 | Train Acc: 0.9394
 Site-amazon                        | Train Loss: 1.4832 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.6471 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.6248 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.6530 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.6319 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.8168 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.7879 | Train Acc: 0.7838
Average Train Accuracy: 0.9160
 Site-RealWorld                     | Val  Loss: 1.4029 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3743 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5959 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6343 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7090 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6398 | Val  Acc: 0.8636
 Site-RealWorld                     | Val  Loss: 1.5661 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5414 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.5130 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.6194 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.5742 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5932 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6666 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5927 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5108 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5647 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.6466 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 1.5342 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4948 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5166 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.5334 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.5784 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.5614 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.6984 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.6610 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.6501 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 1.6425 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.9049 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.7476 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9388
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.8636
 Best site-RealWorld                 | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:20 | Val Acc: 0.9194
 Best site-caltech                   | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:20 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:20 | Val Acc: 0.9434
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 1.0000
 Best site-Product                   | Epoch:20 | Val Acc: 0.9500
 Best site-Product                   | Epoch:20 | Val Acc: 0.9310
 Best site-Product                   | Epoch:20 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:20 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:20 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:20 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:20 | Val Acc: 0.8333
 Best site-webcam                    | Epoch:20 | Val Acc: 0.9722
 Best site-Art                       | Epoch:20 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:20 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 21 ============
 Site-RealWorld                     | Train Loss: 1.6167 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.7021 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.4575 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5469 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5136 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.6152 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.4890 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.5215 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.5687 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.5018 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.7072 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 1.6710 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.5751 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6237 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.5500 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 1.5259 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6274 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.4213 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5259 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.6063 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.5284 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.6111 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 1.4782 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.5876 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 1.5846 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.5671 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.5961 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7939 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.7630 | Train Acc: 0.7568
Average Train Accuracy: 0.9331
 Site-RealWorld                     | Val  Loss: 1.3659 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3468 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4883 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5634 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.7206 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5977 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.5305 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 1.4911 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4906 | Val  Acc: 0.9167
 Site-RealWorld                     | Val  Loss: 1.5678 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.5716 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5803 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6664 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.5416 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4962 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.5377 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 1.5994 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.4912 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4601 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4561 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5163 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5442 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.5251 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.6706 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.6371 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.5552 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.5785 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.8322 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 1.7501 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9401
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9643
 Best site-RealWorld                 | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9167
 Best site-RealWorld                 | Epoch:21 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:21 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:21 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:21 | Val Acc: 0.9286
 Best site-caltech                   | Epoch:21 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:21 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:21 | Val Acc: 0.8947
 Best site-caltech                   | Epoch:21 | Val Acc: 0.9057
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 1.0000
 Best site-Product                   | Epoch:21 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:21 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:21 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:21 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:21 | Val Acc: 0.9444
 Best site-webcam                    | Epoch:21 | Val Acc: 0.9722
 Best site-Art                       | Epoch:21 | Val Acc: 0.7778
 Best site-Clipart                   | Epoch:21 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 22 ============
 Site-RealWorld                     | Train Loss: 1.5550 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.6258 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4816 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.5113 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4711 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.5655 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.4481 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.4991 | Train Acc: 0.9091
 Site-RealWorld                     | Train Loss: 1.5361 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.4294 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.6577 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6201 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.4900 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6148 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.5231 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.5011 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.5788 | Train Acc: 0.9114
 Site-Product                       | Train Loss: 1.4176 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.4977 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.5589 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.4741 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 1.4768 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.4305 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.5649 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 1.5378 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.5266 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.5565 | Train Acc: 0.9444
 Site-Art                           | Train Loss: 1.7209 | Train Acc: 0.8364
 Site-Clipart                       | Train Loss: 1.7850 | Train Acc: 0.7568
Average Train Accuracy: 0.9322
 Site-RealWorld                     | Val  Loss: 1.3151 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3236 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4828 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5711 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.6397 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.5395 | Val  Acc: 0.8636
 Site-RealWorld                     | Val  Loss: 1.5020 | Val  Acc: 0.9286
 Site-RealWorld                     | Val  Loss: 1.4496 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.4295 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.5460 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.4800 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6075 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6121 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.5234 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.4268 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.4832 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.5801 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 1.4223 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4389 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 1.4261 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.4612 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.4915 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.5217 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.6486 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.6092 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.5794 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.5496 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.8084 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.6784 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9314
============ Train epoch 23 ============
 Site-RealWorld                     | Train Loss: 1.5733 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.6737 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3997 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4621 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.4388 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.5216 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.3882 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.4454 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.4098 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.4242 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.6260 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.6387 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.4402 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.5842 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.4807 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 1.4656 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.4906 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 1.3843 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.4473 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.5080 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.4638 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.4092 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 1.3576 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.5420 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.5161 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.5117 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.4935 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.7471 | Train Acc: 0.7818
 Site-Clipart                       | Train Loss: 1.7547 | Train Acc: 0.7838
Average Train Accuracy: 0.9364
 Site-RealWorld                     | Val  Loss: 1.2834 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2393 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4808 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5239 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5907 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.4764 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4698 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.4057 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3989 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.5084 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.4672 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5269 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5356 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4952 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3763 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4410 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5403 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.4425 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3765 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3705 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4234 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.4730 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.5258 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.6557 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.5679 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 1.4792 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.5186 | Val  Acc: 0.8611
 Site-Art                           | Val  Loss: 1.7842 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.6323 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9460
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:23 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:23 | Val Acc: 0.9194
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:23 | Val Acc: 0.9245
 Best site-Product                   | Epoch:23 | Val Acc: 1.0000
 Best site-Product                   | Epoch:23 | Val Acc: 1.0000
 Best site-Product                   | Epoch:23 | Val Acc: 1.0000
 Best site-Product                   | Epoch:23 | Val Acc: 1.0000
 Best site-Product                   | Epoch:23 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:23 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:23 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:23 | Val Acc: 0.8049
 Best site-webcam                    | Epoch:23 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:23 | Val Acc: 0.8611
 Best site-Art                       | Epoch:23 | Val Acc: 0.8333
 Best site-Clipart                   | Epoch:23 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 24 ============
 Site-RealWorld                     | Train Loss: 1.5409 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.6099 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.3562 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4280 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.4374 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.4896 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.3583 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.4340 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.4928 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.3857 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.5762 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.5684 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.4457 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.5763 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.4658 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 1.4251 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.5050 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.3454 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.4200 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.4619 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.4426 | Train Acc: 0.9091
 Site-Product                       | Train Loss: 1.2903 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.3332 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.5171 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.4933 | Train Acc: 0.8387
 Site-webcam                        | Train Loss: 1.5225 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.4733 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.6845 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.7030 | Train Acc: 0.7568
Average Train Accuracy: 0.9349
 Site-RealWorld                     | Val  Loss: 1.2709 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2374 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3974 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.5330 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5955 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4938 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.4366 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 1.3944 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.3911 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.4872 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 1.5060 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 1.4671 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5382 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4502 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3846 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4047 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.5187 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 1.4074 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3399 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3110 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3819 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 1.4113 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.4978 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.5829 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.5299 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.5172 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.4691 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.7806 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.6440 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9437
============ Train epoch 25 ============
 Site-RealWorld                     | Train Loss: 1.4947 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.4974 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2951 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3991 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3662 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.4576 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.3347 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.4113 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.4745 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.3083 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.5530 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.5118 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.3572 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.5248 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.4163 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3720 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4555 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 1.2940 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.4236 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.4359 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.3832 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.2814 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.3070 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.4740 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.4544 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.4157 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.4766 | Train Acc: 0.9259
 Site-Art                           | Train Loss: 1.6576 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.6648 | Train Acc: 0.7838
Average Train Accuracy: 0.9414
 Site-RealWorld                     | Val  Loss: 1.2379 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1989 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4339 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4526 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5378 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.4394 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3745 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3718 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.3353 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.4497 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.3407 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4601 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5495 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.4271 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3398 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3834 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 1.4764 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.3153 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3339 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2886 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3702 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.3683 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.4170 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.5540 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 1.5105 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.4374 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.4597 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.7371 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.6209 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9403
============ Train epoch 26 ============
 Site-RealWorld                     | Train Loss: 1.4810 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.5069 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2753 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.3739 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.3358 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.4236 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2705 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.3325 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.3308 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2900 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.5089 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.5283 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.3225 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4622 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 1.3697 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.3543 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.4428 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.2560 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.3366 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.4344 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.3508 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.4845 | Train Acc: 0.9242
 Site-amazon                        | Train Loss: 1.3038 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.4275 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 1.4177 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.4508 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.4288 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.6454 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.6027 | Train Acc: 0.8378
Average Train Accuracy: 0.9516
 Site-RealWorld                     | Val  Loss: 1.1590 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1494 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4215 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4056 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.5222 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4002 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3571 | Val  Acc: 0.9286
 Site-RealWorld                     | Val  Loss: 1.3135 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.2939 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.4086 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 1.5277 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4386 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4921 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3519 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2979 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3147 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.4747 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 1.2865 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2627 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2778 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3168 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 1.3602 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.3970 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.5103 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.4792 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.4318 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.4129 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.7006 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 1.5922 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9477
 Best site-RealWorld                 | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:26 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:26 | Val Acc: 0.9286
 Best site-RealWorld                 | Epoch:26 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:26 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:26 | Val Acc: 0.9355
 Best site-caltech                   | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:26 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:26 | Val Acc: 0.9434
 Best site-Product                   | Epoch:26 | Val Acc: 1.0000
 Best site-Product                   | Epoch:26 | Val Acc: 1.0000
 Best site-Product                   | Epoch:26 | Val Acc: 1.0000
 Best site-Product                   | Epoch:26 | Val Acc: 0.9655
 Best site-Product                   | Epoch:26 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:26 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:26 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:26 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:26 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:26 | Val Acc: 0.9444
 Best site-Art                       | Epoch:26 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:26 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 27 ============
 Site-RealWorld                     | Train Loss: 1.4812 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.4323 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2553 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3118 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2817 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.4044 | Train Acc: 0.9091
 Site-RealWorld                     | Train Loss: 1.2493 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.3275 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.3905 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.2643 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.4916 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4979 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.2968 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.5072 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.3430 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.3407 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.3268 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.1959 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.2790 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.4326 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.2849 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.3205 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.2666 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.4222 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.3852 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.4559 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 1.3289 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.5930 | Train Acc: 0.8364
 Site-Clipart                       | Train Loss: 1.6389 | Train Acc: 0.7838
Average Train Accuracy: 0.9343
 Site-RealWorld                     | Val  Loss: 1.1711 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0989 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3484 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3832 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4979 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3810 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.2871 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2844 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.2599 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.3894 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.4303 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4166 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3786 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3310 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2705 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.3039 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.4160 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.2334 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2419 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2087 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2402 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.3662 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.4139 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4773 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.4553 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 1.3435 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.3852 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.6825 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.5756 | Val  Acc: 0.7083
Average Valid Accuracy: 0.9458
============ Train epoch 28 ============
 Site-RealWorld                     | Train Loss: 1.3986 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.4641 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2436 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3280 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2873 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.3433 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2321 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.2872 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.3512 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2143 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.4683 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 1.4393 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.2578 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4340 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.3687 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.2961 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3373 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.2473 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.2863 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.3297 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.3061 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.1257 | Train Acc: 0.9394
 Site-amazon                        | Train Loss: 1.1958 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.3779 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 1.3553 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.3522 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.3504 | Train Acc: 0.9074
 Site-Art                           | Train Loss: 1.5807 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.6434 | Train Acc: 0.7027
Average Train Accuracy: 0.9229
 Site-RealWorld                     | Val  Loss: 1.1028 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0225 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3231 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3438 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4979 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.3385 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.2593 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 1.2542 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.2142 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.3592 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.3813 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3528 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4136 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.2917 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2297 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.2649 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.3761 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 1.2474 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1645 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2131 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2050 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2872 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.3549 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4411 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.4381 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.3301 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.3425 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.7154 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.5398 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9490
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9643
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:28 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:28 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:28 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:28 | Val Acc: 0.9286
 Best site-caltech                   | Epoch:28 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:28 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:28 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:28 | Val Acc: 0.9434
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 1.0000
 Best site-Product                   | Epoch:28 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:28 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:28 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:28 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:28 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:28 | Val Acc: 0.9722
 Best site-Art                       | Epoch:28 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:28 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 29 ============
 Site-RealWorld                     | Train Loss: 1.4206 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.3453 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2134 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.3224 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2548 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.3347 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.1806 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.2412 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2006 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2018 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.4048 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4016 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.2308 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4034 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.2762 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2416 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3181 | Train Acc: 0.9114
 Site-Product                       | Train Loss: 1.2071 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.2378 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2741 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.2581 | Train Acc: 0.9091
 Site-Product                       | Train Loss: 1.0397 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 1.1705 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.3267 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.3214 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.3599 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 1.2840 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.5858 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.5768 | Train Acc: 0.7838
Average Train Accuracy: 0.9401
 Site-RealWorld                     | Val  Loss: 1.0236 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0168 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2667 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2909 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4151 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2976 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2575 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 1.2330 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.1889 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.3132 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.3703 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3372 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.4470 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.2448 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1710 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2451 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.3404 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 1.1922 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1414 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1512 | Val  Acc: 0.9500
 Site-Product                       | Val  Loss: 1.2140 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2775 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.2897 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4105 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.4328 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.3058 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.3030 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.6612 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 1.5144 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9456
============ Train epoch 30 ============
 Site-RealWorld                     | Train Loss: 1.3286 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.4356 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1670 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2617 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.2242 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.3004 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.1619 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 1.2373 | Train Acc: 0.9273
 Site-RealWorld                     | Train Loss: 1.1788 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.1507 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.3696 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3957 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1760 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3673 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.2752 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.2601 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.3135 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.1597 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.2169 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.2850 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.2345 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.0643 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 1.1651 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3321 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.2871 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.2643 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.2638 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.5277 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.5000 | Train Acc: 0.7838
Average Train Accuracy: 0.9411
 Site-RealWorld                     | Val  Loss: 1.0559 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0033 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1762 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3223 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.3884 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3010 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.1769 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1586 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.1869 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.2834 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.3626 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2940 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3911 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.2807 | Val  Acc: 0.9500
 Site-caltech                       | Val  Loss: 1.1842 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2192 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.3157 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.1685 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0974 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1005 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1467 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2316 | Val  Acc: 0.9091
 Site-amazon                        | Val  Loss: 1.2397 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4467 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.3615 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.3046 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.2603 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.6521 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.5502 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9445
============ Train epoch 31 ============
 Site-RealWorld                     | Train Loss: 1.3212 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.3177 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0855 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2204 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.1483 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.2643 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.1423 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.2044 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1685 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.1632 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.3540 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3838 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1501 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3771 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.2360 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 1.1680 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.3201 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 1.1756 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.1633 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2527 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.1790 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 1.0310 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 1.1248 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3023 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.2440 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.2683 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.2078 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4922 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.4695 | Train Acc: 0.8378
Average Train Accuracy: 0.9510
 Site-RealWorld                     | Val  Loss: 1.0074 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9948 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1273 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3486 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.3138 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2338 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1508 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1331 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.1050 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.2757 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.2357 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2651 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2673 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2065 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1232 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1587 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.3054 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.1535 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0945 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0391 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1372 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.2114 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.2975 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.3570 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.3343 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.2089 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.2626 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.5791 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.4491 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9562
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:31 | Val Acc: 0.9516
 Best site-caltech                   | Epoch:31 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:31 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:31 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:31 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:31 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:31 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:31 | Val Acc: 0.9057
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 1.0000
 Best site-Product                   | Epoch:31 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:31 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:31 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:31 | Val Acc: 0.9444
 Best site-Art                       | Epoch:31 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:31 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 32 ============
 Site-RealWorld                     | Train Loss: 1.3591 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.3538 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0143 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2181 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.1286 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.2352 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.0997 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.1344 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.0447 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 1.0975 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2944 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3074 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1395 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3229 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1994 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.1456 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2565 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 1.0896 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.1178 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.2524 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.1584 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 1.3600 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.1038 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 1.2721 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.2395 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.2915 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.2025 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4660 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 1.5166 | Train Acc: 0.7027
Average Train Accuracy: 0.9407
 Site-RealWorld                     | Val  Loss: 0.9547 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8824 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1669 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2765 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.3927 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2370 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 1.2452 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 1.1298 | Val  Acc: 0.9189
 Site-RealWorld                     | Val  Loss: 1.0801 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.2110 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.2171 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2192 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2418 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1963 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1165 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.1216 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.2487 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 1.1017 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0059 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0536 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1323 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1702 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.2357 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.3611 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.3541 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 1.2149 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.2478 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.5641 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.4542 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9371
============ Train epoch 33 ============
 Site-RealWorld                     | Train Loss: 1.3298 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.2854 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.0659 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1621 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0782 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2004 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.0414 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.1356 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.1944 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.0826 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2924 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.3427 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1246 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.3292 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1723 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.1693 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.1538 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 1.0442 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.1700 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.2127 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.1274 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.8965 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.0627 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.2475 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.2242 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.1782 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.1515 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.4528 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.4756 | Train Acc: 0.8108
Average Train Accuracy: 0.9395
 Site-RealWorld                     | Val  Loss: 0.9618 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8923 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1436 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2763 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2981 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1915 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.1261 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0562 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0584 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.2180 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 1.2661 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2013 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2374 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1826 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0563 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0782 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.2412 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 1.1097 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0605 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 1.0017 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0682 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1358 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.1814 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.3247 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.2988 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.1729 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.1769 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.5583 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.4188 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9455
============ Train epoch 34 ============
 Site-RealWorld                     | Train Loss: 1.3163 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2625 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9760 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1138 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1476 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.1878 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.0216 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.1095 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 1.0673 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.0049 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2884 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2900 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0745 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2653 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1245 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.0897 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.1733 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 1.0231 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 1.1056 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.1910 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 1.0883 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 1.2791 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.0522 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.2232 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.1408 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 1.1400 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.1616 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.4720 | Train Acc: 0.8182
 Site-Clipart                       | Train Loss: 1.4232 | Train Acc: 0.8108
Average Train Accuracy: 0.9405
 Site-RealWorld                     | Val  Loss: 0.9345 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8946 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0808 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1686 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.3041 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.1697 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.0998 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0364 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.0348 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.1674 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.1876 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2577 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1438 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1461 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0323 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0792 | Val  Acc: 0.9211
 Site-caltech                       | Val  Loss: 1.2202 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 1.0261 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9989 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9759 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0247 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 1.1130 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.1869 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.2601 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.1983 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 1.1483 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.1547 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.5321 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 1.3847 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9534
============ Train epoch 35 ============
 Site-RealWorld                     | Train Loss: 1.1941 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2090 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9913 | Train Acc: 0.9333
 Site-RealWorld                     | Train Loss: 1.0753 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0778 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.1547 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 1.0015 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.0598 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.0463 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.0188 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.3080 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.2416 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0685 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2174 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.1430 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.1141 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.1301 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 1.0160 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0288 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 1.1010 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 1.0594 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.8864 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.9890 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.2047 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.1401 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.1513 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.0904 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.3744 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 1.4679 | Train Acc: 0.7838
Average Train Accuracy: 0.9492
 Site-RealWorld                     | Val  Loss: 0.9900 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8553 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0514 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2345 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2414 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1048 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.0991 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0269 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.9870 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.1771 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.1079 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2188 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2148 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.0972 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0393 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0683 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.2164 | Val  Acc: 0.9057
 Site-Product                       | Val  Loss: 0.9819 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9311 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9177 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9915 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0590 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.1220 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.2595 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.2387 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 1.1424 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.1493 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.5082 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 1.3598 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9477
============ Train epoch 36 ============
 Site-RealWorld                     | Train Loss: 1.1722 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.2308 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 0.9285 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0433 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0360 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.1321 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.9770 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.0283 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.0358 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.9737 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2032 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2750 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.0315 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2505 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.0949 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.0363 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.1881 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 0.9702 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.0721 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.0880 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 1.0484 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.9401 | Train Acc: 0.9394
 Site-amazon                        | Train Loss: 0.9583 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.1576 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 1.0965 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.1046 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.0904 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.3703 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.3667 | Train Acc: 0.8649
Average Train Accuracy: 0.9446
 Site-RealWorld                     | Val  Loss: 0.8894 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7721 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0209 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1962 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2573 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.1440 | Val  Acc: 0.8636
 Site-RealWorld                     | Val  Loss: 1.0265 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9827 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9981 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.1106 | Val  Acc: 0.9194
 Site-caltech                       | Val  Loss: 1.2371 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0726 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1521 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1036 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0232 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.0288 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.1976 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.9835 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9135 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9498 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9787 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0296 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 1.1002 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.2444 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.2020 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.0895 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.1120 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.5026 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.3993 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9456
============ Train epoch 37 ============
 Site-RealWorld                     | Train Loss: 1.1926 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.1541 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9907 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0421 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9964 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.1085 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9503 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.0331 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.0644 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9789 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2186 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.1762 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9911 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.2060 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.0593 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 1.0471 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.0526 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.9501 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.9962 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.0839 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.9752 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.0300 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.9265 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.1371 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.1233 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 1.0947 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.0047 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.3838 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.3993 | Train Acc: 0.7568
Average Train Accuracy: 0.9457
 Site-RealWorld                     | Val  Loss: 0.8408 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7490 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9792 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1701 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2168 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.0773 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.0430 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9890 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.9325 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.1007 | Val  Acc: 0.9032
 Site-caltech                       | Val  Loss: 1.0327 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0880 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0925 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0432 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9469 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.0171 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.1486 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.9306 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9052 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8892 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9700 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0174 | Val  Acc: 0.9091
 Site-amazon                        | Val  Loss: 1.1342 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.3055 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.1903 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.0475 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.0429 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.4963 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.3110 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9472
============ Train epoch 38 ============
 Site-RealWorld                     | Train Loss: 1.0916 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1637 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9621 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.0247 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9694 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 1.0792 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.9004 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.9855 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0147 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.9087 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2137 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1336 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9854 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1472 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0360 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.9728 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0869 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 0.9123 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.9455 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.0880 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.9540 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.9195 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.8849 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.1195 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.0696 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.0153 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.0412 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.3759 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.4009 | Train Acc: 0.7568
Average Train Accuracy: 0.9480
 Site-RealWorld                     | Val  Loss: 0.8239 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7132 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9434 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0838 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.2054 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.0585 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9886 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.9077 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9412 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.0625 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.0113 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0608 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1068 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0099 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9107 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9728 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1036 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.8677 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8704 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8366 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9325 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9924 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.1085 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1709 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.1540 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.0305 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 1.0022 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.4684 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.3077 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9551
============ Train epoch 39 ============
 Site-RealWorld                     | Train Loss: 1.1766 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1061 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8302 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9869 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9363 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.0226 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8971 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.9459 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.0362 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 0.8958 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.2256 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.1757 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0145 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1334 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0296 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.9544 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1251 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 0.8976 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9424 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.0402 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.9312 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.0937 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.9167 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.0906 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.0146 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.0878 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.0142 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.3949 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 1.3168 | Train Acc: 0.7838
Average Train Accuracy: 0.9483
 Site-RealWorld                     | Val  Loss: 0.7858 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7009 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9059 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0876 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1479 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0514 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.9352 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9114 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.8922 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.0210 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.8868 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9877 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0171 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9286 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9202 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9537 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.0793 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.9845 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7976 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7992 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9056 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9665 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.0221 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.2072 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.1177 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 1.0966 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 0.9942 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.4345 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 1.2424 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9565
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9583
 Best site-RealWorld                 | Epoch:39 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:39 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:39 | Val Acc: 0.9623
 Best site-Product                   | Epoch:39 | Val Acc: 1.0000
 Best site-Product                   | Epoch:39 | Val Acc: 1.0000
 Best site-Product                   | Epoch:39 | Val Acc: 1.0000
 Best site-Product                   | Epoch:39 | Val Acc: 1.0000
 Best site-Product                   | Epoch:39 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:39 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:39 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:39 | Val Acc: 0.8780
 Best site-webcam                    | Epoch:39 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:39 | Val Acc: 0.9722
 Best site-Art                       | Epoch:39 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:39 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 40 ============
 Site-RealWorld                     | Train Loss: 1.1128 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.1041 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7644 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9769 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9371 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.9916 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.8773 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.9033 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.1025 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.8510 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.1200 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1736 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9205 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1141 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9887 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9174 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0941 | Train Acc: 0.9241
 Site-Product                       | Train Loss: 0.8854 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.9196 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0301 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 0.9223 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.8915 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.9077 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.0702 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.0382 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.0669 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.9752 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.2988 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.3661 | Train Acc: 0.7297
Average Train Accuracy: 0.9486
 Site-RealWorld                     | Val  Loss: 0.7805 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7038 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9696 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1074 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0994 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.0166 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.8801 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8979 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8739 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 1.0027 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 1.0722 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9903 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0719 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 0.9483 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8885 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 0.8994 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.0635 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.8875 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7795 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8876 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8617 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9266 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 1.0469 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1119 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.1099 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.0323 | Val  Acc: 0.8333
 Site-webcam                        | Val  Loss: 1.0131 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.3992 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.2902 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9455
============ Train epoch 41 ============
 Site-RealWorld                     | Train Loss: 1.0733 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0818 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8018 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9610 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9137 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.9688 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.8656 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.9050 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.0105 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.8826 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.1154 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 1.1229 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8735 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1103 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.9901 | Train Acc: 0.8537
 Site-caltech                       | Train Loss: 0.8745 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0170 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 0.8257 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.9301 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.0075 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.8896 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.7891 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.8253 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 1.0528 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 1.0320 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.0060 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.9589 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.2738 | Train Acc: 0.8909
 Site-Clipart                       | Train Loss: 1.3255 | Train Acc: 0.7568
Average Train Accuracy: 0.9523
 Site-RealWorld                     | Val  Loss: 0.6807 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6495 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9452 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0088 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1461 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9801 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8627 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8531 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.8271 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.0047 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 0.9395 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9782 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0882 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 0.9429 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8709 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9050 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0071 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.8522 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7473 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7982 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8772 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 0.9125 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.9755 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1509 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.1037 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 0.9477 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.9735 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3797 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 1.3300 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9509
============ Train epoch 42 ============
 Site-RealWorld                     | Train Loss: 1.1009 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.0464 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8592 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9375 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9174 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 0.9653 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.8613 | Train Acc: 0.9302
 Site-RealWorld                     | Train Loss: 0.8766 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.8862 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.8117 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.0442 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0210 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8601 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0270 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.9411 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.9114 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.0135 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.8309 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.9072 | Train Acc: 0.9000
 Site-Product                       | Train Loss: 0.9895 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.8833 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.8260 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.8550 | Train Acc: 0.9000
 Site-amazon                        | Train Loss: 1.0029 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.9708 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 0.9388 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.9426 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.2371 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 1.2611 | Train Acc: 0.7838
Average Train Accuracy: 0.9427
 Site-RealWorld                     | Val  Loss: 0.6651 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5979 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8921 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9785 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0614 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9548 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8842 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.8246 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 0.8028 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.9759 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 0.9928 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9984 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0269 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9458 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8222 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8553 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0225 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.8335 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7375 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7374 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8272 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8924 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 0.9617 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1417 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.0584 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.8822 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.9758 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.3494 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 1.2263 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9571
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9643
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9459
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:42 | Val Acc: 0.9516
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:42 | Val Acc: 0.9245
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 1.0000
 Best site-Product                   | Epoch:42 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:42 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:42 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:42 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:42 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:42 | Val Acc: 0.9722
 Best site-Art                       | Epoch:42 | Val Acc: 0.8889
 Best site-Clipart                   | Epoch:42 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedavg...
============ Train epoch 43 ============
 Site-RealWorld                     | Train Loss: 1.0628 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 1.0203 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7161 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8915 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8601 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.9540 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7862 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.8676 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.8503 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.7804 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.0298 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0328 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8519 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.0448 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.9092 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.8738 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9646 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.8357 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.8628 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9472 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.8325 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.9083 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.8310 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 0.9714 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 0.9443 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.8660 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.8837 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.2417 | Train Acc: 0.8909
 Site-Clipart                       | Train Loss: 1.3066 | Train Acc: 0.7568
Average Train Accuracy: 0.9455
 Site-RealWorld                     | Val  Loss: 0.6969 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6481 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8737 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.0385 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1032 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.9884 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 0.8585 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7790 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7916 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.9379 | Val  Acc: 0.9516
 Site-caltech                       | Val  Loss: 0.8677 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9684 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9019 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8834 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7657 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8517 | Val  Acc: 0.8947
 Site-caltech                       | Val  Loss: 0.9820 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.8355 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6970 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7379 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8089 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8886 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.9278 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.1270 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.0089 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.8970 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.9222 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.3343 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.2490 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9452
============ Train epoch 44 ============
 Site-RealWorld                     | Train Loss: 1.0339 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.9915 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7700 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8762 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8627 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.9128 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7602 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.8338 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.8007 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.7631 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9919 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0422 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8683 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0651 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9317 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 0.8166 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9564 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.7670 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.8292 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.0029 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 0.8220 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.8287 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.7749 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9925 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.9444 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 0.9732 | Train Acc: 0.8519
 Site-webcam                        | Train Loss: 0.8739 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.1875 | Train Acc: 0.8545
 Site-Clipart                       | Train Loss: 1.3087 | Train Acc: 0.7838
Average Train Accuracy: 0.9424
 Site-RealWorld                     | Val  Loss: 0.5739 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6001 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7828 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9654 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0140 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.9192 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8411 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.7794 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.7913 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.9250 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 1.0349 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9290 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9640 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9108 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8064 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 0.8365 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.9955 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.7442 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7078 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7444 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7232 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8556 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.9308 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0691 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.0008 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 0.8621 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8843 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3448 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.2170 | Val  Acc: 0.7083
Average Valid Accuracy: 0.9507
============ Train epoch 45 ============
 Site-RealWorld                     | Train Loss: 1.0293 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.9297 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7791 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8226 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8075 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.9269 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.7383 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.8349 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.7996 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 0.8011 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9579 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9765 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8398 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0343 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.9094 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.8097 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9443 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 0.8057 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.8193 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8643 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.7896 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.8288 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.7541 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.9364 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 0.8965 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.9126 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.8482 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.2387 | Train Acc: 0.8364
 Site-Clipart                       | Train Loss: 1.2387 | Train Acc: 0.7568
Average Train Accuracy: 0.9553
 Site-RealWorld                     | Val  Loss: 0.6845 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5425 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8261 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9697 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0203 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8909 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.8001 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.7852 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.7522 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 0.8911 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.8079 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8933 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0257 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 0.8348 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7515 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8159 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.9796 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.7485 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6956 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6773 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7710 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8429 | Val  Acc: 0.9091
 Site-amazon                        | Val  Loss: 0.9542 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0992 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 0.9826 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.8486 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8422 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.3179 | Val  Acc: 0.8333
 Site-Clipart                       | Val  Loss: 1.1466 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9516
============ Train epoch 46 ============
 Site-RealWorld                     | Train Loss: 0.9957 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.9388 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7036 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8346 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7729 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.8923 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.7253 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.8065 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.7997 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.7576 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9350 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9811 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8011 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9755 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.9026 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 0.8469 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.8988 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.7925 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.7440 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8603 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.7956 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.7108 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.7463 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9465 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.9219 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 0.9415 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.8602 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.1909 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.2289 | Train Acc: 0.7568
Average Train Accuracy: 0.9479
 Site-RealWorld                     | Val  Loss: 0.6171 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5169 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8208 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9841 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9837 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.9401 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 0.7762 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7529 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 0.7293 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.8696 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 0.9019 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9028 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9017 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8132 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7946 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7836 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9407 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.7215 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6541 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7064 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7305 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7843 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.8579 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0483 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.9659 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.8269 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8783 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 1.2879 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.1118 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9533
============ Train epoch 47 ============
 Site-RealWorld                     | Train Loss: 0.9427 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.0241 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6763 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8386 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.7692 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.8012 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7303 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.7564 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6794 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.7316 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9148 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9753 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.7710 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9297 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.8034 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.7633 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.9680 | Train Acc: 0.9873
 Site-Product                       | Train Loss: 0.6863 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.7502 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.9212 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.7781 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.6384 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.7592 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9173 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.8490 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.9259 | Train Acc: 0.8889
 Site-webcam                        | Train Loss: 0.7900 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 1.1474 | Train Acc: 0.9273
 Site-Clipart                       | Train Loss: 1.1433 | Train Acc: 0.7838
Average Train Accuracy: 0.9535
 Site-RealWorld                     | Val  Loss: 0.5683 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5294 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8137 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8886 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9999 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8194 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7571 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.7278 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 0.7150 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.8524 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.6666 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8818 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7713 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8459 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7127 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7394 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 0.9029 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.7347 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6487 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6130 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7539 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7646 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.8479 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0921 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 0.9390 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.7538 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.8504 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.2382 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.0681 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9556
============ Train epoch 48 ============
 Site-RealWorld                     | Train Loss: 0.9223 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9444 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5958 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8039 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.7116 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.8093 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6809 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.7437 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.7845 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.6947 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9866 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9390 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.7382 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9339 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.8218 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.7783 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 0.8434 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 0.7176 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.7228 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 0.7863 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.7004 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.6104 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.6996 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.9149 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.8805 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 0.7999 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.7987 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.1002 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.1313 | Train Acc: 0.8108
Average Train Accuracy: 0.9569
 Site-RealWorld                     | Val  Loss: 0.5640 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4982 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7101 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.8673 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0097 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.8499 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7082 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7079 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.7022 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.8499 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.7817 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8714 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7577 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8269 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7231 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7132 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.9150 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.7008 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5960 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6288 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7022 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 0.7921 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.8756 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 1.0443 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 0.9863 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 0.7859 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.7855 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.1821 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 1.0796 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9511
============ Train epoch 49 ============
 Site-RealWorld                     | Train Loss: 0.9728 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8845 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6648 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7849 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7437 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.8219 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.6844 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.7466 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.7767 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.6584 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.9437 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9981 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 0.7311 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.8927 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.7715 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.7854 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 0.8660 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.7511 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.7492 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 0.8788 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.7574 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.5654 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.7313 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.8981 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.8492 | Train Acc: 0.8710
 Site-webcam                        | Train Loss: 0.7603 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.7704 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.1486 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 1.1484 | Train Acc: 0.8378
Average Train Accuracy: 0.9545
 Site-RealWorld                     | Val  Loss: 0.6160 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4809 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7774 | Val  Acc: 0.9000
 Site-RealWorld                     | Val  Loss: 0.8855 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.9335 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.7705 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7177 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.6607 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.7089 | Val  Acc: 0.9583
 Site-RealWorld                     | Val  Loss: 0.7716 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.8164 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7893 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.8406 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7349 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.6429 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7123 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.9103 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.6733 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5808 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5935 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6761 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7415 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.8489 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0258 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.9571 | Val  Acc: 0.8049
 Site-webcam                        | Val  Loss: 0.7292 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.7833 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 1.1925 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 1.1012 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9522
===2023-08-06 21:42:33===
===2023-08-06 21:42:36===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[9,12,15,20,25,33,43,55,72,93,11,15,21,30,41,57,79,13,20,29,44,66,20,35,62,27,54,55,37,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[635,431,293,199,135,92,62,]
domain number = 7
Loading snapshots...
 Test site-RealWorld                 (2)| Epoch:42 | Test Acc: 0.9714
 Test site-caltech                   (5)| Epoch:42 | Test Acc: 0.9632
 Test site-Product                   (0)| Epoch:42 | Test Acc: 0.9377
 Test site-amazon                    (3)| Epoch:42 | Test Acc: 0.9061
 Test site-webcam                    (2)| Epoch:42 | Test Acc: 0.9434
 Test site-Art                       (6)| Epoch:42 | Test Acc: 0.9277
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.8208
RealWorld: 0.9714, caltech: 0.9632, Product: 0.9377, amazon: 0.9061, webcam: 0.9434, Art: 0.9277, Clipart: 0.8208, 
Average Test Accuracy(group): 0.9243, Average Test Accuracy(individual): 0.9482,
domain std=0.0468, cluster std=0.0111, individual std=0.0319, 
