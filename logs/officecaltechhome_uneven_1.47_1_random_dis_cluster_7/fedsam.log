===2023-08-06 12:40:52===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 20
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[9,12,15,20,25,33,43,55,72,93,11,15,21,30,41,57,79,13,20,29,44,66,20,35,62,27,54,55,37,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[635,431,293,199,135,92,62,]
domain number = 7
============ Train epoch 0 ============
 Site-RealWorld                     | Train Loss: 2.1121 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 2.0606 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 2.0528 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 2.0535 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.0375 | Train Acc: 0.8000
 Site-RealWorld                     | Train Loss: 2.0327 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 2.0129 | Train Acc: 0.8837
 Site-RealWorld                     | Train Loss: 2.0210 | Train Acc: 0.8909
 Site-RealWorld                     | Train Loss: 2.0647 | Train Acc: 0.8750
 Site-RealWorld                     | Train Loss: 2.0038 | Train Acc: 0.9462
 Site-caltech                       | Train Loss: 2.1384 | Train Acc: 0.8182
 Site-caltech                       | Train Loss: 2.0801 | Train Acc: 0.8000
 Site-caltech                       | Train Loss: 2.0483 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 2.0774 | Train Acc: 0.8333
 Site-caltech                       | Train Loss: 2.0600 | Train Acc: 0.8293
 Site-caltech                       | Train Loss: 2.0355 | Train Acc: 0.9298
 Site-caltech                       | Train Loss: 2.0213 | Train Acc: 0.8608
 Site-Product                       | Train Loss: 1.9620 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.9917 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 2.0962 | Train Acc: 0.7931
 Site-Product                       | Train Loss: 2.0165 | Train Acc: 0.8409
 Site-Product                       | Train Loss: 1.9317 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.9698 | Train Acc: 0.8500
 Site-amazon                        | Train Loss: 2.0865 | Train Acc: 0.7429
 Site-amazon                        | Train Loss: 2.0501 | Train Acc: 0.8226
 Site-webcam                        | Train Loss: 2.0132 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 2.0460 | Train Acc: 0.8333
 Site-Art                           | Train Loss: 2.1270 | Train Acc: 0.7818
 Site-Clipart                       | Train Loss: 2.1789 | Train Acc: 0.6486
Average Train Accuracy: 0.8566
 Site-RealWorld                     | Val  Loss: 1.9070 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.9109 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0092 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 2.0302 | Val  Acc: 0.7692
 Site-RealWorld                     | Val  Loss: 2.1016 | Val  Acc: 0.8235
 Site-RealWorld                     | Val  Loss: 2.0133 | Val  Acc: 0.9091
 Site-RealWorld                     | Val  Loss: 2.0234 | Val  Acc: 0.8929
 Site-RealWorld                     | Val  Loss: 2.0136 | Val  Acc: 0.8919
 Site-RealWorld                     | Val  Loss: 2.0028 | Val  Acc: 0.8958
 Site-RealWorld                     | Val  Loss: 2.0473 | Val  Acc: 0.8065
 Site-caltech                       | Val  Loss: 2.0424 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.0580 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 2.1001 | Val  Acc: 0.7857
 Site-caltech                       | Val  Loss: 2.0911 | Val  Acc: 0.8500
 Site-caltech                       | Val  Loss: 2.0298 | Val  Acc: 0.8889
 Site-caltech                       | Val  Loss: 2.0329 | Val  Acc: 0.9211
 Site-caltech                       | Val  Loss: 2.0852 | Val  Acc: 0.8302
 Site-Product                       | Val  Loss: 1.9840 | Val  Acc: 0.8750
 Site-Product                       | Val  Loss: 1.9327 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9335 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.9877 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 2.0376 | Val  Acc: 0.7727
 Site-amazon                        | Val  Loss: 2.0108 | Val  Acc: 0.7692
 Site-amazon                        | Val  Loss: 2.0780 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 2.1001 | Val  Acc: 0.7805
 Site-webcam                        | Val  Loss: 2.0318 | Val  Acc: 0.7778
 Site-webcam                        | Val  Loss: 2.0307 | Val  Acc: 0.8333
 Site-Art                           | Val  Loss: 2.1972 | Val  Acc: 0.7222
 Site-Clipart                       | Val  Loss: 2.1454 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8681
 Best site-RealWorld                 | Epoch:0 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.7692
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8235
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.9091
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8929
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8919
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8958
 Best site-RealWorld                 | Epoch:0 | Val Acc: 0.8065
 Best site-caltech                   | Epoch:0 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:0 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:0 | Val Acc: 0.7857
 Best site-caltech                   | Epoch:0 | Val Acc: 0.8500
 Best site-caltech                   | Epoch:0 | Val Acc: 0.8889
 Best site-caltech                   | Epoch:0 | Val Acc: 0.9211
 Best site-caltech                   | Epoch:0 | Val Acc: 0.8302
 Best site-Product                   | Epoch:0 | Val Acc: 0.8750
 Best site-Product                   | Epoch:0 | Val Acc: 1.0000
 Best site-Product                   | Epoch:0 | Val Acc: 1.0000
 Best site-Product                   | Epoch:0 | Val Acc: 0.9310
 Best site-Product                   | Epoch:0 | Val Acc: 0.7727
 Best site-amazon                    | Epoch:0 | Val Acc: 0.7692
 Best site-amazon                    | Epoch:0 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:0 | Val Acc: 0.7805
 Best site-webcam                    | Epoch:0 | Val Acc: 0.7778
 Best site-webcam                    | Epoch:0 | Val Acc: 0.8333
 Best site-Art                       | Epoch:0 | Val Acc: 0.7222
 Best site-Clipart                   | Epoch:0 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 1 ============
 Site-RealWorld                     | Train Loss: 1.7735 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.7059 | Train Acc: 0.9167
 Site-RealWorld                     | Train Loss: 1.6335 | Train Acc: 0.8667
 Site-RealWorld                     | Train Loss: 1.6440 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 1.6292 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.6501 | Train Acc: 0.8788
 Site-RealWorld                     | Train Loss: 1.5745 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 1.5982 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 1.6459 | Train Acc: 0.9444
 Site-RealWorld                     | Train Loss: 1.5451 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.7099 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.7066 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.6697 | Train Acc: 0.8571
 Site-caltech                       | Train Loss: 1.7496 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.6554 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 1.6269 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 1.6669 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 1.5260 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.5718 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.7247 | Train Acc: 0.8621
 Site-Product                       | Train Loss: 1.6137 | Train Acc: 0.9318
 Site-Product                       | Train Loss: 1.4246 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 1.5162 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.6948 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 1.6509 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 1.6474 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 1.6309 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.8084 | Train Acc: 0.7636
 Site-Clipart                       | Train Loss: 1.8737 | Train Acc: 0.7297
Average Train Accuracy: 0.9143
 Site-RealWorld                     | Val  Loss: 1.4999 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.4324 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6391 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.7324 | Val  Acc: 0.8462
 Site-RealWorld                     | Val  Loss: 1.7517 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.6346 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 1.5978 | Val  Acc: 0.9286
 Site-RealWorld                     | Val  Loss: 1.5925 | Val  Acc: 0.9459
 Site-RealWorld                     | Val  Loss: 1.5833 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 1.6579 | Val  Acc: 0.8710
 Site-caltech                       | Val  Loss: 1.6486 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6771 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.7052 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 1.6888 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.5837 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.6171 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.7050 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 1.5266 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5058 | Val  Acc: 0.9231
 Site-Product                       | Val  Loss: 1.4947 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.5604 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.6104 | Val  Acc: 0.8864
 Site-amazon                        | Val  Loss: 1.6063 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.7274 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.7168 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 1.6232 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 1.6606 | Val  Acc: 0.8889
 Site-Art                           | Val  Loss: 1.8956 | Val  Acc: 0.7778
 Site-Clipart                       | Val  Loss: 1.7965 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9317
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8462
 Best site-RealWorld                 | Epoch:1 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9286
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9459
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:1 | Val Acc: 0.8710
 Best site-caltech                   | Epoch:1 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:1 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:1 | Val Acc: 0.9286
 Best site-caltech                   | Epoch:1 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:1 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:1 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:1 | Val Acc: 0.9245
 Best site-Product                   | Epoch:1 | Val Acc: 1.0000
 Best site-Product                   | Epoch:1 | Val Acc: 0.9231
 Best site-Product                   | Epoch:1 | Val Acc: 1.0000
 Best site-Product                   | Epoch:1 | Val Acc: 0.9310
 Best site-Product                   | Epoch:1 | Val Acc: 0.8864
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:1 | Val Acc: 0.8780
 Best site-webcam                    | Epoch:1 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:1 | Val Acc: 0.8889
 Best site-Art                       | Epoch:1 | Val Acc: 0.7778
 Best site-Clipart                   | Epoch:1 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 2 ============
 Site-RealWorld                     | Train Loss: 1.3701 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.3079 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2138 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2806 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.2513 | Train Acc: 0.8800
 Site-RealWorld                     | Train Loss: 1.3211 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 1.2122 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 1.2405 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 1.2804 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 1.2067 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.4094 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.3842 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 1.2780 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.4198 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 1.2853 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 1.2765 | Train Acc: 0.9649
 Site-caltech                       | Train Loss: 1.4213 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 1.2464 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 1.2383 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 1.3794 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 1.2415 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.0694 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 1.1363 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.3671 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.3231 | Train Acc: 0.8548
 Site-webcam                        | Train Loss: 1.2735 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 1.2857 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.5763 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 1.5856 | Train Acc: 0.7568
Average Train Accuracy: 0.9375
 Site-RealWorld                     | Val  Loss: 1.2189 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9876 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2282 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.3913 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.4544 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 1.2536 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.2343 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1979 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 1.2104 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.2974 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 1.2806 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2979 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3615 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.3394 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.2477 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 1.2304 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 1.3561 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 1.1471 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1271 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.0945 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 1.1836 | Val  Acc: 0.9310
 Site-Product                       | Val  Loss: 1.2618 | Val  Acc: 0.8864
 Site-amazon                        | Val  Loss: 1.2915 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.4651 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 1.4032 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 1.3253 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.2658 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.6898 | Val  Acc: 0.8056
 Site-Clipart                       | Val  Loss: 1.5481 | Val  Acc: 0.7083
Average Valid Accuracy: 0.9430
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9412
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:2 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:2 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:2 | Val Acc: 0.9630
 Best site-caltech                   | Epoch:2 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:2 | Val Acc: 0.9623
 Best site-Product                   | Epoch:2 | Val Acc: 1.0000
 Best site-Product                   | Epoch:2 | Val Acc: 1.0000
 Best site-Product                   | Epoch:2 | Val Acc: 1.0000
 Best site-Product                   | Epoch:2 | Val Acc: 0.9310
 Best site-Product                   | Epoch:2 | Val Acc: 0.8864
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:2 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:2 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:2 | Val Acc: 0.9444
 Best site-Art                       | Epoch:2 | Val Acc: 0.8056
 Best site-Clipart                   | Epoch:2 | Val Acc: 0.7083
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 3 ============
 Site-RealWorld                     | Train Loss: 1.2103 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 1.0459 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8939 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.9401 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 1.0062 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 1.0629 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.9079 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.9804 | Train Acc: 0.9455
 Site-RealWorld                     | Train Loss: 0.9588 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.9084 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 1.1659 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.1112 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9890 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 1.1006 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 1.0429 | Train Acc: 0.9024
 Site-caltech                       | Train Loss: 0.9438 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 1.0489 | Train Acc: 0.9367
 Site-Product                       | Train Loss: 0.8429 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8845 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 1.1040 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 0.9454 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 1.0458 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.9069 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 1.1037 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 1.0702 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 1.0191 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.9758 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 1.2626 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 1.3868 | Train Acc: 0.7568
Average Train Accuracy: 0.9475
 Site-RealWorld                     | Val  Loss: 0.7705 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7313 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9837 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 1.1093 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.1437 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9847 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9424 | Val  Acc: 0.9643
 Site-RealWorld                     | Val  Loss: 0.9047 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.9222 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 1.0326 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.9804 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0659 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.1195 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 1.0300 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9355 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.9441 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 1.0950 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.8629 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7446 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.8462 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9030 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.9588 | Val  Acc: 0.9318
 Site-amazon                        | Val  Loss: 1.0421 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.2224 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 1.1453 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 1.0048 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 1.0282 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.4669 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 1.2730 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9540
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9643
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:3 | Val Acc: 0.9839
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:3 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:3 | Val Acc: 0.9434
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 1.0000
 Best site-Product                   | Epoch:3 | Val Acc: 0.9318
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:3 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:3 | Val Acc: 0.8780
 Best site-webcam                    | Epoch:3 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:3 | Val Acc: 0.9444
 Best site-Art                       | Epoch:3 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:3 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 4 ============
 Site-RealWorld                     | Train Loss: 0.8394 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.8324 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6096 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.8223 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.7208 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.8143 | Train Acc: 0.9394
 Site-RealWorld                     | Train Loss: 0.6783 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.7258 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.7297 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.6933 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.8934 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.8996 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.7700 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9787 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.8157 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 0.7477 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.9235 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 0.6484 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.6856 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.8622 | Train Acc: 0.8966
 Site-Product                       | Train Loss: 0.7675 | Train Acc: 0.9318
 Site-Product                       | Train Loss: 0.5546 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.6375 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.8903 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.8539 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 0.8347 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.8024 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 1.1756 | Train Acc: 0.8000
 Site-Clipart                       | Train Loss: 1.2516 | Train Acc: 0.7297
Average Train Accuracy: 0.9443
 Site-RealWorld                     | Val  Loss: 0.6005 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5622 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7411 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.9953 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 1.0229 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.8275 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6982 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6754 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.6752 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.8243 | Val  Acc: 0.9355
 Site-caltech                       | Val  Loss: 0.9569 | Val  Acc: 0.8571
 Site-caltech                       | Val  Loss: 0.8131 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7997 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7962 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.7080 | Val  Acc: 0.9630
 Site-caltech                       | Val  Loss: 0.7142 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.9066 | Val  Acc: 0.9245
 Site-Product                       | Val  Loss: 0.5660 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5697 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5817 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.6649 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.7348 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.7931 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 1.0367 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 0.9483 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.8413 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.8080 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 1.2168 | Val  Acc: 0.9444
 Site-Clipart                       | Val  Loss: 1.2364 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9478
============ Train epoch 5 ============
 Site-RealWorld                     | Train Loss: 0.7588 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.7039 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4965 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6331 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.6444 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.6170 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.5361 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.5664 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.6280 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.4914 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.7069 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.7953 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.5392 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.7687 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.6322 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.5984 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.6533 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.5727 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.5283 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.7184 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.6121 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.4097 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.5563 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.7508 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.6522 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.6136 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.5755 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.9829 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 1.0598 | Train Acc: 0.7838
Average Train Accuracy: 0.9522
 Site-RealWorld                     | Val  Loss: 0.3875 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2932 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5273 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7669 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.7523 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.6443 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.5034 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5492 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5442 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.6470 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.7448 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.6433 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.6053 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.6300 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.5670 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.5507 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 0.6703 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.5209 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4063 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3864 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5418 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.5994 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.6586 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 0.8566 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.8010 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 0.6539 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 0.6678 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 1.1006 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.9458 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9577
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:5 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9737
 Best site-caltech                   | Epoch:5 | Val Acc: 0.9623
 Best site-Product                   | Epoch:5 | Val Acc: 1.0000
 Best site-Product                   | Epoch:5 | Val Acc: 1.0000
 Best site-Product                   | Epoch:5 | Val Acc: 1.0000
 Best site-Product                   | Epoch:5 | Val Acc: 1.0000
 Best site-Product                   | Epoch:5 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:5 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:5 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:5 | Val Acc: 0.9167
 Best site-Art                       | Epoch:5 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:5 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 6 ============
 Site-RealWorld                     | Train Loss: 0.6805 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.5763 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3798 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4078 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4753 | Train Acc: 0.9200
 Site-RealWorld                     | Train Loss: 0.5121 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.4092 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.4108 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4324 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.3909 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.5149 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.6614 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 0.3795 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.6118 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.5393 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.4736 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.5559 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.4234 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.4164 | Train Acc: 0.9500
 Site-Product                       | Train Loss: 0.5999 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.4694 | Train Acc: 0.9545
 Site-Product                       | Train Loss: 0.2893 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.4958 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.6867 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 0.5946 | Train Acc: 0.8871
 Site-webcam                        | Train Loss: 0.5507 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.4150 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.8470 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 0.9599 | Train Acc: 0.8108
Average Train Accuracy: 0.9521
 Site-RealWorld                     | Val  Loss: 0.2516 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2332 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4638 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.7019 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.6885 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.5132 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4155 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4116 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.4617 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.5289 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.6270 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4919 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.5379 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.5179 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3721 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4563 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.5532 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.2880 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2632 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3301 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3936 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4806 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.6282 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 0.7503 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.6753 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 0.6054 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 0.5304 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.9953 | Val  Acc: 0.8889
 Site-Clipart                       | Val  Loss: 0.8835 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9525
============ Train epoch 7 ============
 Site-RealWorld                     | Train Loss: 0.6840 | Train Acc: 0.7778
 Site-RealWorld                     | Train Loss: 0.5159 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2107 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4286 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.4068 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.4027 | Train Acc: 0.9697
 Site-RealWorld                     | Train Loss: 0.3455 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.3473 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.4791 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.3217 | Train Acc: 0.9785
 Site-caltech                       | Train Loss: 0.5093 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.6160 | Train Acc: 0.8667
 Site-caltech                       | Train Loss: 0.3736 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 0.5855 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.4471 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.3647 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4754 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.3819 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.3289 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.5135 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.3640 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.6639 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.4397 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.5836 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.4991 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.4698 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.3386 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.7623 | Train Acc: 0.9273
 Site-Clipart                       | Train Loss: 0.8289 | Train Acc: 0.8108
Average Train Accuracy: 0.9474
 Site-RealWorld                     | Val  Loss: 0.2382 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1357 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3972 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4880 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.5306 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4354 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3060 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3033 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.3456 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.4384 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.5669 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4329 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3753 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4359 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3296 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3458 | Val  Acc: 0.9474
 Site-caltech                       | Val  Loss: 0.5075 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.2707 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2518 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2352 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3113 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.4413 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.5572 | Val  Acc: 0.8462
 Site-amazon                        | Val  Loss: 0.6863 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.6393 | Val  Acc: 0.8293
 Site-webcam                        | Val  Loss: 0.4226 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.3698 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.8502 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 0.9035 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9590
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9730
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:7 | Val Acc: 0.9839
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9474
 Best site-caltech                   | Epoch:7 | Val Acc: 0.9434
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 1.0000
 Best site-Product                   | Epoch:7 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8462
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8261
 Best site-amazon                    | Epoch:7 | Val Acc: 0.8293
 Best site-webcam                    | Epoch:7 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:7 | Val Acc: 0.9722
 Best site-Art                       | Epoch:7 | Val Acc: 0.8611
 Best site-Clipart                   | Epoch:7 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 8 ============
 Site-RealWorld                     | Train Loss: 0.4657 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4533 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1480 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3553 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3650 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.2994 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2813 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.3401 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.3627 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.2459 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.3390 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4935 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.2488 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4609 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.3489 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.2956 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3873 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.3110 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.2683 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3599 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3357 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.2748 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4189 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.5303 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.4910 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.3648 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.2476 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.7233 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 0.9592 | Train Acc: 0.7838
Average Train Accuracy: 0.9648
 Site-RealWorld                     | Val  Loss: 0.1923 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0868 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3391 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4536 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.5071 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3168 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2972 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2493 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2791 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.3489 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.2967 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2933 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3379 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3459 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2296 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2640 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.4489 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.1919 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1742 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2252 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2569 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.3127 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.5144 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.6918 | Val  Acc: 0.7826
 Site-amazon                        | Val  Loss: 0.5015 | Val  Acc: 0.9268
 Site-webcam                        | Val  Loss: 0.3917 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 0.3122 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.7623 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.7991 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9665
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:8 | Val Acc: 0.9839
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:8 | Val Acc: 0.9623
 Best site-Product                   | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 1.0000
 Best site-Product                   | Epoch:8 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:8 | Val Acc: 0.7826
 Best site-amazon                    | Epoch:8 | Val Acc: 0.9268
 Best site-webcam                    | Epoch:8 | Val Acc: 0.8889
 Best site-webcam                    | Epoch:8 | Val Acc: 0.9722
 Best site-Art                       | Epoch:8 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:8 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 9 ============
 Site-RealWorld                     | Train Loss: 0.3799 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.4551 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1777 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3255 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.2576 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.2606 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2327 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.2454 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.3241 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.2027 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.2487 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4878 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1958 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4390 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 0.2765 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.2432 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2559 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.2902 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.1676 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3042 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.2885 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1356 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.2664 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.5079 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 0.4529 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.4255 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.2266 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.5930 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 0.7620 | Train Acc: 0.8378
Average Train Accuracy: 0.9625
 Site-RealWorld                     | Val  Loss: 0.2827 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0669 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3341 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.5030 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.4342 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3129 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.2413 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2399 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2684 | Val  Acc: 0.9375
 Site-RealWorld                     | Val  Loss: 0.3495 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.2265 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2511 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2268 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2997 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1772 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2051 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3816 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.1352 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1017 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1414 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2201 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2936 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.4653 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.6072 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.5351 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 0.3428 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.2111 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.6638 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.6647 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9676
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9545
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9375
 Best site-RealWorld                 | Epoch:9 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:9 | Val Acc: 0.9623
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 1.0000
 Best site-Product                   | Epoch:9 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:9 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:9 | Val Acc: 0.8780
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9444
 Best site-webcam                    | Epoch:9 | Val Acc: 0.9722
 Best site-Art                       | Epoch:9 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 10 ============
 Site-RealWorld                     | Train Loss: 0.4251 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.4436 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1080 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1906 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2333 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.2425 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2135 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.2181 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.2775 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.1667 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.3137 | Train Acc: 0.9091
 Site-caltech                       | Train Loss: 0.4537 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1610 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.4037 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.2221 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2411 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.2723 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.2863 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.1761 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.3211 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.2508 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.1321 | Train Acc: 0.9697
 Site-amazon                        | Train Loss: 0.2881 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.5293 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 0.3798 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.2398 | Train Acc: 1.0000
 Site-webcam                        | Train Loss: 0.1908 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.6235 | Train Acc: 0.8727
 Site-Clipart                       | Train Loss: 0.7920 | Train Acc: 0.7297
Average Train Accuracy: 0.9487
 Site-RealWorld                     | Val  Loss: 0.1020 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1017 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2306 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3952 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.3194 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2317 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1986 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1723 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1936 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.3160 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.2046 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2251 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1867 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2388 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1659 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2004 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.3214 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.1140 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1220 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1488 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1745 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2754 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.4396 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.5864 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.5147 | Val  Acc: 0.8537
 Site-webcam                        | Val  Loss: 0.2703 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2496 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.5588 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.7603 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9688
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:10 | Val Acc: 0.9677
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:10 | Val Acc: 0.9623
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 1.0000
 Best site-Product                   | Epoch:10 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:10 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:10 | Val Acc: 0.8537
 Best site-webcam                    | Epoch:10 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:10 | Val Acc: 0.9722
 Best site-Art                       | Epoch:10 | Val Acc: 0.9167
 Best site-Clipart                   | Epoch:10 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 11 ============
 Site-RealWorld                     | Train Loss: 0.4330 | Train Acc: 0.8889
 Site-RealWorld                     | Train Loss: 0.3244 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1053 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2313 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2190 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.2278 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1826 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1650 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.2453 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.1578 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.1813 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3283 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1712 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3334 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.2875 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.1960 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.2350 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.2915 | Train Acc: 0.8462
 Site-Product                       | Train Loss: 0.1550 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2133 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.2471 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.0956 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.2310 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4351 | Train Acc: 0.8857
 Site-amazon                        | Train Loss: 0.4013 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.2753 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.1776 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.4934 | Train Acc: 0.9455
 Site-Clipart                       | Train Loss: 0.7216 | Train Acc: 0.8108
Average Train Accuracy: 0.9573
 Site-RealWorld                     | Val  Loss: 0.0784 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1963 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.4271 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.3908 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.2847 | Val  Acc: 0.9545
 Site-RealWorld                     | Val  Loss: 0.1442 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2138 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.2279 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1055 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2283 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2050 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1718 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1472 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1871 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 0.2705 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.1482 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1434 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1812 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2453 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.4141 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.5851 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.4446 | Val  Acc: 0.8780
 Site-webcam                        | Val  Loss: 0.2182 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.1998 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.5998 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 0.7415 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9622
============ Train epoch 12 ============
 Site-RealWorld                     | Train Loss: 0.3325 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2330 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1276 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2093 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.1852 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.1712 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1907 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1576 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.2012 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.1420 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.1700 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3923 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1266 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3106 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.2346 | Train Acc: 0.9268
 Site-caltech                       | Train Loss: 0.1145 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2200 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.2126 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1182 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2012 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.1931 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.3283 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.2354 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.4583 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.3953 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.2774 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.1642 | Train Acc: 1.0000
 Site-Art                           | Train Loss: 0.6123 | Train Acc: 0.9091
 Site-Clipart                       | Train Loss: 0.7911 | Train Acc: 0.7838
Average Train Accuracy: 0.9600
 Site-RealWorld                     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0320 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1497 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3381 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.2102 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2040 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1339 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1454 | Val  Acc: 0.9730
 Site-RealWorld                     | Val  Loss: 0.1602 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.2198 | Val  Acc: 0.9677
 Site-caltech                       | Val  Loss: 0.1827 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1583 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2439 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1232 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1493 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1257 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2744 | Val  Acc: 0.9811
 Site-Product                       | Val  Loss: 0.0795 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1644 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 0.2460 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.3590 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.6614 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.3760 | Val  Acc: 0.9024
 Site-webcam                        | Val  Loss: 0.2888 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.2876 | Val  Acc: 0.9167
 Site-Art                           | Val  Loss: 0.5111 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.7209 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9665
============ Train epoch 13 ============
 Site-RealWorld                     | Train Loss: 0.3072 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2240 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1438 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1560 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1380 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1613 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1826 | Train Acc: 0.9535
 Site-RealWorld                     | Train Loss: 0.1260 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1629 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.1102 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.1887 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3203 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1098 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2945 | Train Acc: 0.9000
 Site-caltech                       | Train Loss: 0.1487 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1757 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.1929 | Train Acc: 0.9620
 Site-Product                       | Train Loss: 0.1752 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.0993 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.2476 | Train Acc: 0.9310
 Site-Product                       | Train Loss: 0.2006 | Train Acc: 0.9318
 Site-Product                       | Train Loss: 0.3355 | Train Acc: 0.9545
 Site-amazon                        | Train Loss: 0.2134 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4673 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.3266 | Train Acc: 0.9355
 Site-webcam                        | Train Loss: 0.1916 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.1477 | Train Acc: 0.9815
 Site-Art                           | Train Loss: 0.5316 | Train Acc: 0.9455
 Site-Clipart                       | Train Loss: 0.7069 | Train Acc: 0.8108
Average Train Accuracy: 0.9630
 Site-RealWorld                     | Val  Loss: 0.1226 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3148 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.2230 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1977 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1351 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1117 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1640 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.2113 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.0950 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1023 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2536 | Val  Acc: 0.9286
 Site-caltech                       | Val  Loss: 0.1429 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1049 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1651 | Val  Acc: 0.9737
 Site-caltech                       | Val  Loss: 0.2999 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.1139 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0553 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0610 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1498 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1619 | Val  Acc: 1.0000
 Site-amazon                        | Val  Loss: 0.4438 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.5672 | Val  Acc: 0.8261
 Site-amazon                        | Val  Loss: 0.3775 | Val  Acc: 0.9024
 Site-webcam                        | Val  Loss: 0.2404 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2038 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.5927 | Val  Acc: 0.8611
 Site-Clipart                       | Val  Loss: 0.6996 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9644
============ Train epoch 14 ============
 Site-RealWorld                     | Train Loss: 0.2072 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2345 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0726 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1468 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1585 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.1219 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1937 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1381 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.1473 | Train Acc: 0.9583
 Site-RealWorld                     | Train Loss: 0.1056 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.1730 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2347 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1286 | Train Acc: 0.9524
 Site-caltech                       | Train Loss: 0.2331 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.1608 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.1616 | Train Acc: 0.9825
 Site-caltech                       | Train Loss: 0.1346 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.1729 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.0636 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1896 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.1542 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.0670 | Train Acc: 0.9848
 Site-amazon                        | Train Loss: 0.1410 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.4856 | Train Acc: 0.8571
 Site-amazon                        | Train Loss: 0.3699 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.4075 | Train Acc: 0.9630
 Site-webcam                        | Train Loss: 0.1384 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 0.5129 | Train Acc: 0.8364
 Site-Clipart                       | Train Loss: 0.7335 | Train Acc: 0.7838
Average Train Accuracy: 0.9588
 Site-RealWorld                     | Val  Loss: 0.0372 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1004 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2712 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.2058 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1538 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1130 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1178 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1520 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.2112 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.0969 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1036 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1825 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1040 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0898 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2446 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0297 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0753 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1203 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1494 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.3953 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.4412 | Val  Acc: 0.9130
 Site-amazon                        | Val  Loss: 0.4296 | Val  Acc: 0.9024
 Site-webcam                        | Val  Loss: 0.1892 | Val  Acc: 0.9444
 Site-webcam                        | Val  Loss: 0.1950 | Val  Acc: 0.9722
 Site-Art                           | Val  Loss: 0.4286 | Val  Acc: 0.9444
 Site-Clipart                       | Val  Loss: 0.7414 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9716
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9792
 Best site-RealWorld                 | Epoch:14 | Val Acc: 0.9839
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:14 | Val Acc: 0.9623
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 1.0000
 Best site-Product                   | Epoch:14 | Val Acc: 0.9773
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9130
 Best site-amazon                    | Epoch:14 | Val Acc: 0.9024
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9444
 Best site-webcam                    | Epoch:14 | Val Acc: 0.9722
 Best site-Art                       | Epoch:14 | Val Acc: 0.9444
 Best site-Clipart                   | Epoch:14 | Val Acc: 0.7500
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 15 ============
 Site-RealWorld                     | Train Loss: 0.2296 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.2322 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0748 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1651 | Train Acc: 0.9500
 Site-RealWorld                     | Train Loss: 0.1372 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1240 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1357 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1506 | Train Acc: 0.9636
 Site-RealWorld                     | Train Loss: 0.1029 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.0800 | Train Acc: 0.9892
 Site-caltech                       | Train Loss: 0.1025 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2347 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.0528 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2361 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.1681 | Train Acc: 0.9512
 Site-caltech                       | Train Loss: 0.1102 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1363 | Train Acc: 0.9747
 Site-Product                       | Train Loss: 0.1397 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.0844 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1635 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.1919 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.1366 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.2530 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.3970 | Train Acc: 0.9143
 Site-amazon                        | Train Loss: 0.3274 | Train Acc: 0.9194
 Site-webcam                        | Train Loss: 0.3524 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.1608 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 0.4237 | Train Acc: 0.9455
 Site-Clipart                       | Train Loss: 0.7347 | Train Acc: 0.7838
Average Train Accuracy: 0.9651
 Site-RealWorld                     | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1371 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.2555 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.2122 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1546 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1242 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0980 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1502 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.2000 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0990 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1246 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1777 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0923 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.2108 | Val  Acc: 0.9434
 Site-Product                       | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0478 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0963 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.2252 | Val  Acc: 0.9545
 Site-amazon                        | Val  Loss: 0.3768 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.5877 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.4368 | Val  Acc: 0.9024
 Site-webcam                        | Val  Loss: 0.1790 | Val  Acc: 1.0000
 Site-webcam                        | Val  Loss: 0.2292 | Val  Acc: 0.9444
 Site-Art                           | Val  Loss: 0.4035 | Val  Acc: 0.9444
 Site-Clipart                       | Val  Loss: 0.6055 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9717
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9231
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                 | Epoch:15 | Val Acc: 0.9839
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                   | Epoch:15 | Val Acc: 0.9434
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 1.0000
 Best site-Product                   | Epoch:15 | Val Acc: 0.9545
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9231
 Best site-amazon                    | Epoch:15 | Val Acc: 0.8696
 Best site-amazon                    | Epoch:15 | Val Acc: 0.9024
 Best site-webcam                    | Epoch:15 | Val Acc: 1.0000
 Best site-webcam                    | Epoch:15 | Val Acc: 0.9444
 Best site-Art                       | Epoch:15 | Val Acc: 0.9444
 Best site-Clipart                   | Epoch:15 | Val Acc: 0.7917
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/fedsam...
============ Train epoch 16 ============
 Site-RealWorld                     | Train Loss: 0.1665 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1334 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.0781 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1486 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1347 | Train Acc: 0.9600
 Site-RealWorld                     | Train Loss: 0.1191 | Train Acc: 1.0000
 Site-RealWorld                     | Train Loss: 0.1358 | Train Acc: 0.9767
 Site-RealWorld                     | Train Loss: 0.1131 | Train Acc: 0.9818
 Site-RealWorld                     | Train Loss: 0.1037 | Train Acc: 0.9722
 Site-RealWorld                     | Train Loss: 0.0598 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1191 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.1689 | Train Acc: 0.9333
 Site-caltech                       | Train Loss: 0.0490 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.2901 | Train Acc: 0.9667
 Site-caltech                       | Train Loss: 0.1278 | Train Acc: 0.9756
 Site-caltech                       | Train Loss: 0.0660 | Train Acc: 1.0000
 Site-caltech                       | Train Loss: 0.3003 | Train Acc: 0.9494
 Site-Product                       | Train Loss: 0.1481 | Train Acc: 0.9231
 Site-Product                       | Train Loss: 0.0549 | Train Acc: 1.0000
 Site-Product                       | Train Loss: 0.1476 | Train Acc: 0.9655
 Site-Product                       | Train Loss: 0.1940 | Train Acc: 0.9773
 Site-Product                       | Train Loss: 0.1165 | Train Acc: 1.0000
 Site-amazon                        | Train Loss: 0.1984 | Train Acc: 0.9500
 Site-amazon                        | Train Loss: 0.5110 | Train Acc: 0.8286
 Site-amazon                        | Train Loss: 0.3628 | Train Acc: 0.9032
 Site-webcam                        | Train Loss: 0.3223 | Train Acc: 0.9259
 Site-webcam                        | Train Loss: 0.1306 | Train Acc: 0.9630
 Site-Art                           | Train Loss: 0.3874 | Train Acc: 0.9273
 Site-Clipart                       | Train Loss: 0.7181 | Train Acc: 0.8108
Average Train Accuracy: 0.9617
 Site-RealWorld                     | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.3301 | Val  Acc: 0.9231
 Site-RealWorld                     | Val  Loss: 0.2156 | Val  Acc: 0.9412
 Site-RealWorld                     | Val  Loss: 0.1367 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0817 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.0611 | Val  Acc: 1.0000
 Site-RealWorld                     | Val  Loss: 0.1572 | Val  Acc: 0.9792
 Site-RealWorld                     | Val  Loss: 0.1551 | Val  Acc: 0.9839
 Site-caltech                       | Val  Loss: 0.0550 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0880 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0976 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1405 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0810 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.0956 | Val  Acc: 1.0000
 Site-caltech                       | Val  Loss: 0.1774 | Val  Acc: 0.9623
 Site-Product                       | Val  Loss: 0.1235 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.0368 | Val  Acc: 1.0000
 Site-Product                       | Val  Loss: 0.1416 | Val  Acc: 0.9655
 Site-Product                       | Val  Loss: 0.1559 | Val  Acc: 0.9773
 Site-amazon                        | Val  Loss: 0.3614 | Val  Acc: 0.9231
 Site-amazon                        | Val  Loss: 0.5581 | Val  Acc: 0.8696
 Site-amazon                        | Val  Loss: 0.3706 | Val  Acc: 0.9268
 Site-webcam                        | Val  Loss: 0.2922 | Val  Acc: 0.8889
 Site-webcam                        | Val  Loss: 0.0805 | Val  Acc: 1.0000
 Site-Art                           | Val  Loss: 0.4309 | Val  Acc: 0.9167
 Site-Clipart                       | Val  Loss: 0.5658 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9672
============ Train epoch 17 ============
