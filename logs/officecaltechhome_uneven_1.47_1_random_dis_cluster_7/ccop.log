===2023-08-05 13:09:37===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-05 13:09:57===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-05 13:10:17===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-05 13:12:20===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,8,11,16,22,30,42,58,9,14,22,32,49,15,26,45,19,39,40,27,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,317,215,146,99,67,45,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-05 13:12:26===
===2023-08-05 13:12:54===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[4,6,7,10,12,16,21,27,35,46,5,7,10,15,20,28,39,6,9,14,22,33,10,17,30,13,26,27,18,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[317,215,146,99,67,45,30,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-05 13:13:00===
===2023-08-05 13:13:16===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,8,11,16,22,30,42,58,9,14,22,32,49,15,26,45,19,39,40,27,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,317,215,146,99,67,45,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-05 13:13:22===
===2023-08-05 13:13:26===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,4,6,8,12,16,23,31,5,8,11,17,26,8,14,24,10,20,21,14,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,173,117,79,53,36,24,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-05 13:13:32===
===2023-08-05 13:13:38===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,8,11,16,22,30,42,58,9,14,22,32,49,15,26,45,19,39,40,27,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,317,215,146,99,67,45,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
===2023-08-05 13:13:44===
===2023-08-05 13:15:18===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,8,11,16,22,30,42,58,9,14,22,32,49,15,26,45,19,39,40,27,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,317,215,146,99,67,45,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 6, 1, 14, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-amazon                    (3) | Train Loss: 2.2515 | Train Acc: 0.1250
 Site-amazon                    (3) | Train Loss: 2.1823 | Train Acc: 0.4000
 Site-amazon                    (3) | Train Loss: 2.0709 | Train Acc: 0.3077
 Site-amazon                    (3) | Train Loss: 2.2544 | Train Acc: 0.1176
 Site-amazon                    (3) | Train Loss: 2.2101 | Train Acc: 0.2727
 Site-amazon                    (3) | Train Loss: 2.0915 | Train Acc: 0.2759
 Site-amazon                    (3) | Train Loss: 2.0744 | Train Acc: 0.3784
 Site-amazon                    (3) | Train Loss: 2.1208 | Train Acc: 0.2708
 Site-amazon                    (3) | Train Loss: 2.1774 | Train Acc: 0.1746
 Site-amazon                    (3) | Train Loss: 2.1032 | Train Acc: 0.2840
 Site-Art                       (2) | Train Loss: 2.3776 | Train Acc: 0.0000
 Site-Art                       (6) | Train Loss: 2.2928 | Train Acc: 0.0000
 Site-Art                       (5) | Train Loss: 2.3812 | Train Acc: 0.0625
 Site-Art                       (1) | Train Loss: 2.3598 | Train Acc: 0.0909
 Site-Art                       (4) | Train Loss: 2.2851 | Train Acc: 0.0667
 Site-Art                       (4) | Train Loss: 2.3236 | Train Acc: 0.0952
 Site-Art                       (1) | Train Loss: 2.2942 | Train Acc: 0.1552
 Site-RealWorld                 (3) | Train Loss: 2.2567 | Train Acc: 0.2222
 Site-RealWorld                 (1) | Train Loss: 2.2171 | Train Acc: 0.0714
 Site-RealWorld                 (1) | Train Loss: 2.3074 | Train Acc: 0.1818
 Site-RealWorld                 (1) | Train Loss: 2.2313 | Train Acc: 0.1875
 Site-RealWorld                 (1) | Train Loss: 2.2011 | Train Acc: 0.2653
 Site-webcam                    (0) | Train Loss: 2.1913 | Train Acc: 0.3333
 Site-webcam                    (0) | Train Loss: 2.3159 | Train Acc: 0.0385
 Site-webcam                    (0) | Train Loss: 2.2417 | Train Acc: 0.1333
 Site-Clipart                   (3) | Train Loss: 2.2746 | Train Acc: 0.2632
 Site-Clipart                   (3) | Train Loss: 2.2342 | Train Acc: 0.2308
 Site-dslr                      (0) | Train Loss: 2.3058 | Train Acc: 0.1750
 Site-Product                   (3) | Train Loss: 2.1124 | Train Acc: 0.2593
Average Train Accuracy: 0.1875
 Site-amazon                    (3) | Val  Loss: 2.3063 | Val  Acc: 0.0000
 Site-amazon                    (3) | Val  Loss: 2.2992 | Val  Acc: 0.1429
 Site-amazon                    (3) | Val  Loss: 1.9602 | Val  Acc: 0.4444
 Site-amazon                    (3) | Val  Loss: 2.1893 | Val  Acc: 0.1818
 Site-amazon                    (3) | Val  Loss: 2.1601 | Val  Acc: 0.2667
 Site-amazon                    (3) | Val  Loss: 2.1734 | Val  Acc: 0.2632
 Site-amazon                    (3) | Val  Loss: 2.1721 | Val  Acc: 0.1600
 Site-amazon                    (3) | Val  Loss: 2.0436 | Val  Acc: 0.4375
 Site-amazon                    (3) | Val  Loss: 2.1149 | Val  Acc: 0.3810
 Site-amazon                    (3) | Val  Loss: 2.1830 | Val  Acc: 0.2778
 Site-Art                       (2) | Val  Loss: 2.4189 | Val  Acc: 0.0000
 Site-Art                       (6) | Val  Loss: 2.2635 | Val  Acc: 0.2857
 Site-Art                       (5) | Val  Loss: 2.3080 | Val  Acc: 0.0000
 Site-Art                       (1) | Val  Loss: 2.3668 | Val  Acc: 0.1429
 Site-Art                       (4) | Val  Loss: 2.2886 | Val  Acc: 0.1500
 Site-Art                       (4) | Val  Loss: 2.2229 | Val  Acc: 0.1429
 Site-Art                       (1) | Val  Loss: 2.3244 | Val  Acc: 0.1316
 Site-RealWorld                 (3) | Val  Loss: 2.3378 | Val  Acc: 0.1667
 Site-RealWorld                 (1) | Val  Loss: 2.2401 | Val  Acc: 0.2222
 Site-RealWorld                 (1) | Val  Loss: 2.2485 | Val  Acc: 0.0714
 Site-RealWorld                 (1) | Val  Loss: 2.2499 | Val  Acc: 0.0952
 Site-RealWorld                 (1) | Val  Loss: 2.2995 | Val  Acc: 0.1562
 Site-webcam                    (0) | Val  Loss: 2.2674 | Val  Acc: 0.2000
 Site-webcam                    (0) | Val  Loss: 2.2310 | Val  Acc: 0.1765
 Site-webcam                    (0) | Val  Loss: 2.2217 | Val  Acc: 0.1667
 Site-Clipart                   (3) | Val  Loss: 2.1802 | Val  Acc: 0.2308
 Site-Clipart                   (3) | Val  Loss: 2.1841 | Val  Acc: 0.1923
 Site-dslr                      (0) | Val  Loss: 2.3665 | Val  Acc: 0.0769
 Site-Product                   (3) | Val  Loss: 2.1222 | Val  Acc: 0.3889
Average Valid Accuracy: 0.1914
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.0000
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.1429
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.4444
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.1818
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.2667
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.2632
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.1600
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.4375
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.3810
 Best site-amazon                   (3)  | Epoch:0 | Val Acc: 0.2778
 Best site-Art                      (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-Art                      (6)  | Epoch:0 | Val Acc: 0.2857
 Best site-Art                      (5)  | Epoch:0 | Val Acc: 0.0000
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.1429
 Best site-Art                      (4)  | Epoch:0 | Val Acc: 0.1500
 Best site-Art                      (4)  | Epoch:0 | Val Acc: 0.1429
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.1316
 Best site-RealWorld                (3)  | Epoch:0 | Val Acc: 0.1667
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.2222
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0714
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0952
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1562
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.2000
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.1765
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.1667
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.2308
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.1923
 Best site-dslr                     (0)  | Epoch:0 | Val Acc: 0.0769
 Best site-Product                  (3)  | Epoch:0 | Val Acc: 0.3889
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 1, 2, 1, 4, 8, 12, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-amazon                    (6) | Train Loss: 2.1279 | Train Acc: 0.2500
 Site-amazon                    (6) | Train Loss: 2.2186 | Train Acc: 0.1000
 Site-amazon                    (1) | Train Loss: 1.9238 | Train Acc: 0.5385
 Site-amazon                    (6) | Train Loss: 2.1388 | Train Acc: 0.1765
 Site-amazon                    (6) | Train Loss: 2.0935 | Train Acc: 0.1818
 Site-amazon                    (3) | Train Loss: 2.0995 | Train Acc: 0.1724
 Site-amazon                    (6) | Train Loss: 1.9667 | Train Acc: 0.4324
 Site-amazon                    (6) | Train Loss: 2.0088 | Train Acc: 0.3958
 Site-amazon                    (6) | Train Loss: 2.0539 | Train Acc: 0.3175
 Site-amazon                    (6) | Train Loss: 1.9805 | Train Acc: 0.3457
 Site-Art                       (2) | Train Loss: 2.3432 | Train Acc: 0.0000
 Site-Art                       (0) | Train Loss: 2.3332 | Train Acc: 0.0000
 Site-Art                       (2) | Train Loss: 2.2199 | Train Acc: 0.0625
 Site-Art                       (5) | Train Loss: 2.2876 | Train Acc: 0.0909
 Site-Art                       (5) | Train Loss: 2.1797 | Train Acc: 0.2667
 Site-Art                       (5) | Train Loss: 2.1539 | Train Acc: 0.2857
 Site-Art                       (5) | Train Loss: 2.2268 | Train Acc: 0.2241
 Site-RealWorld                 (6) | Train Loss: 2.0766 | Train Acc: 0.3333
 Site-RealWorld                 (5) | Train Loss: 2.1171 | Train Acc: 0.2143
 Site-RealWorld                 (5) | Train Loss: 2.1983 | Train Acc: 0.2273
 Site-RealWorld                 (5) | Train Loss: 2.1556 | Train Acc: 0.2188
 Site-RealWorld                 (5) | Train Loss: 2.0628 | Train Acc: 0.3469
 Site-webcam                    (4) | Train Loss: 2.0509 | Train Acc: 0.2667
 Site-webcam                    (4) | Train Loss: 2.1523 | Train Acc: 0.1923
 Site-webcam                    (4) | Train Loss: 2.1303 | Train Acc: 0.2222
 Site-Clipart                   (6) | Train Loss: 2.1758 | Train Acc: 0.2632
 Site-Clipart                   (6) | Train Loss: 2.1406 | Train Acc: 0.2564
 Site-dslr                      (4) | Train Loss: 2.2109 | Train Acc: 0.1250
 Site-Product                   (6) | Train Loss: 2.1154 | Train Acc: 0.3333
Average Train Accuracy: 0.2359
 Site-amazon                    (6) | Val  Loss: 2.1274 | Val  Acc: 0.2000
 Site-amazon                    (6) | Val  Loss: 2.2981 | Val  Acc: 0.0000
 Site-amazon                    (1) | Val  Loss: 1.7857 | Val  Acc: 0.7778
 Site-amazon                    (6) | Val  Loss: 2.1788 | Val  Acc: 0.1818
 Site-amazon                    (6) | Val  Loss: 2.0486 | Val  Acc: 0.4000
 Site-amazon                    (3) | Val  Loss: 2.0480 | Val  Acc: 0.3158
 Site-amazon                    (6) | Val  Loss: 2.0997 | Val  Acc: 0.3200
 Site-amazon                    (6) | Val  Loss: 1.9545 | Val  Acc: 0.5000
 Site-amazon                    (6) | Val  Loss: 1.9642 | Val  Acc: 0.4286
 Site-amazon                    (6) | Val  Loss: 2.0477 | Val  Acc: 0.2778
 Site-Art                       (2) | Val  Loss: 2.4047 | Val  Acc: 0.0000
 Site-Art                       (0) | Val  Loss: 2.1678 | Val  Acc: 0.2857
 Site-Art                       (2) | Val  Loss: 2.0358 | Val  Acc: 0.4000
 Site-Art                       (5) | Val  Loss: 2.2896 | Val  Acc: 0.4286
 Site-Art                       (5) | Val  Loss: 2.1603 | Val  Acc: 0.2000
 Site-Art                       (5) | Val  Loss: 2.1503 | Val  Acc: 0.2143
 Site-Art                       (5) | Val  Loss: 2.2509 | Val  Acc: 0.2368
 Site-RealWorld                 (6) | Val  Loss: 2.1968 | Val  Acc: 0.1667
 Site-RealWorld                 (5) | Val  Loss: 1.9899 | Val  Acc: 0.4444
 Site-RealWorld                 (5) | Val  Loss: 2.1666 | Val  Acc: 0.1429
 Site-RealWorld                 (5) | Val  Loss: 2.1994 | Val  Acc: 0.2857
 Site-RealWorld                 (5) | Val  Loss: 2.1498 | Val  Acc: 0.2500
 Site-webcam                    (4) | Val  Loss: 2.0628 | Val  Acc: 0.4000
 Site-webcam                    (4) | Val  Loss: 2.1056 | Val  Acc: 0.2941
 Site-webcam                    (4) | Val  Loss: 2.1558 | Val  Acc: 0.2333
 Site-Clipart                   (6) | Val  Loss: 2.1272 | Val  Acc: 0.3846
 Site-Clipart                   (6) | Val  Loss: 2.0892 | Val  Acc: 0.3846
 Site-dslr                      (4) | Val  Loss: 2.2808 | Val  Acc: 0.1154
 Site-Product                   (6) | Val  Loss: 2.0083 | Val  Acc: 0.3333
Average Valid Accuracy: 0.2966
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.2000
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.0000
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.7778
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.1818
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.4000
 Best site-amazon                   (3)  | Epoch:1 | Val Acc: 0.3158
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.3200
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.5000
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.4286
 Best site-amazon                   (6)  | Epoch:1 | Val Acc: 0.2778
 Best site-Art                      (2)  | Epoch:1 | Val Acc: 0.0000
 Best site-Art                      (0)  | Epoch:1 | Val Acc: 0.2857
 Best site-Art                      (2)  | Epoch:1 | Val Acc: 0.4000
 Best site-Art                      (5)  | Epoch:1 | Val Acc: 0.4286
 Best site-Art                      (5)  | Epoch:1 | Val Acc: 0.2000
 Best site-Art                      (5)  | Epoch:1 | Val Acc: 0.2143
 Best site-Art                      (5)  | Epoch:1 | Val Acc: 0.2368
 Best site-RealWorld                (6)  | Epoch:1 | Val Acc: 0.1667
 Best site-RealWorld                (5)  | Epoch:1 | Val Acc: 0.4444
 Best site-RealWorld                (5)  | Epoch:1 | Val Acc: 0.1429
 Best site-RealWorld                (5)  | Epoch:1 | Val Acc: 0.2857
 Best site-RealWorld                (5)  | Epoch:1 | Val Acc: 0.2500
 Best site-webcam                   (4)  | Epoch:1 | Val Acc: 0.4000
 Best site-webcam                   (4)  | Epoch:1 | Val Acc: 0.2941
 Best site-webcam                   (4)  | Epoch:1 | Val Acc: 0.2333
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.3846
 Best site-Clipart                  (6)  | Epoch:1 | Val Acc: 0.3846
 Best site-dslr                     (4)  | Epoch:1 | Val Acc: 0.1154
 Best site-Product                  (6)  | Epoch:1 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[4, 12, 1, 1, 4, 5, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-amazon                    (1) | Train Loss: 2.1501 | Train Acc: 0.1250
 Site-amazon                    (1) | Train Loss: 2.0359 | Train Acc: 0.4000
 Site-amazon                    (1) | Train Loss: 1.8618 | Train Acc: 0.5385
 Site-amazon                    (1) | Train Loss: 2.0763 | Train Acc: 0.2941
 Site-amazon                    (1) | Train Loss: 1.9984 | Train Acc: 0.4545
 Site-amazon                    (1) | Train Loss: 1.9619 | Train Acc: 0.3448
 Site-amazon                    (1) | Train Loss: 1.8952 | Train Acc: 0.5946
 Site-amazon                    (1) | Train Loss: 1.9471 | Train Acc: 0.5833
 Site-amazon                    (1) | Train Loss: 1.9680 | Train Acc: 0.4444
 Site-amazon                    (1) | Train Loss: 1.9270 | Train Acc: 0.4691
 Site-Art                       (3) | Train Loss: 2.2141 | Train Acc: 0.2500
 Site-Art                       (2) | Train Loss: 2.1043 | Train Acc: 0.2727
 Site-Art                       (4) | Train Loss: 2.1760 | Train Acc: 0.2500
 Site-Art                       (5) | Train Loss: 2.2092 | Train Acc: 0.1364
 Site-Art                       (4) | Train Loss: 2.1218 | Train Acc: 0.3000
 Site-Art                       (4) | Train Loss: 2.1329 | Train Acc: 0.3571
 Site-Art                       (4) | Train Loss: 2.1700 | Train Acc: 0.2414
 Site-RealWorld                 (1) | Train Loss: 2.0231 | Train Acc: 0.4444
 Site-RealWorld                 (5) | Train Loss: 2.0131 | Train Acc: 0.2857
 Site-RealWorld                 (5) | Train Loss: 2.1725 | Train Acc: 0.3182
 Site-RealWorld                 (5) | Train Loss: 2.0110 | Train Acc: 0.4688
 Site-RealWorld                 (5) | Train Loss: 1.9696 | Train Acc: 0.4082
 Site-webcam                    (0) | Train Loss: 1.9596 | Train Acc: 0.5333
 Site-webcam                    (0) | Train Loss: 2.0388 | Train Acc: 0.1923
 Site-webcam                    (0) | Train Loss: 2.0688 | Train Acc: 0.3778
 Site-Clipart                   (6) | Train Loss: 2.0391 | Train Acc: 0.3684
 Site-Clipart                   (6) | Train Loss: 2.1028 | Train Acc: 0.2308
 Site-dslr                      (0) | Train Loss: 2.0745 | Train Acc: 0.2750
 Site-Product                   (1) | Train Loss: 2.0059 | Train Acc: 0.4074
Average Train Accuracy: 0.3575
 Site-amazon                    (1) | Val  Loss: 1.9837 | Val  Acc: 0.4000
 Site-amazon                    (1) | Val  Loss: 2.1140 | Val  Acc: 0.0000
 Site-amazon                    (1) | Val  Loss: 1.7114 | Val  Acc: 0.6667
 Site-amazon                    (1) | Val  Loss: 1.9947 | Val  Acc: 0.4545
 Site-amazon                    (1) | Val  Loss: 1.9291 | Val  Acc: 0.4667
 Site-amazon                    (1) | Val  Loss: 1.9290 | Val  Acc: 0.4737
 Site-amazon                    (1) | Val  Loss: 1.9904 | Val  Acc: 0.4800
 Site-amazon                    (1) | Val  Loss: 1.9025 | Val  Acc: 0.6250
 Site-amazon                    (1) | Val  Loss: 1.8653 | Val  Acc: 0.6190
 Site-amazon                    (1) | Val  Loss: 1.9654 | Val  Acc: 0.3889
 Site-Art                       (3) | Val  Loss: 2.2603 | Val  Acc: 0.0000
 Site-Art                       (2) | Val  Loss: 2.0404 | Val  Acc: 0.5714
 Site-Art                       (4) | Val  Loss: 1.9772 | Val  Acc: 0.5000
 Site-Art                       (5) | Val  Loss: 2.2389 | Val  Acc: 0.4286
 Site-Art                       (4) | Val  Loss: 2.2072 | Val  Acc: 0.4000
 Site-Art                       (4) | Val  Loss: 2.0554 | Val  Acc: 0.3929
 Site-Art                       (4) | Val  Loss: 2.1593 | Val  Acc: 0.2895
 Site-RealWorld                 (1) | Val  Loss: 2.0259 | Val  Acc: 0.3333
 Site-RealWorld                 (5) | Val  Loss: 1.8251 | Val  Acc: 0.6667
 Site-RealWorld                 (5) | Val  Loss: 2.0978 | Val  Acc: 0.2857
 Site-RealWorld                 (5) | Val  Loss: 2.1262 | Val  Acc: 0.3333
 Site-RealWorld                 (5) | Val  Loss: 2.0302 | Val  Acc: 0.4688
 Site-webcam                    (0) | Val  Loss: 2.0161 | Val  Acc: 0.4000
 Site-webcam                    (0) | Val  Loss: 2.0564 | Val  Acc: 0.2941
 Site-webcam                    (0) | Val  Loss: 2.0814 | Val  Acc: 0.2667
 Site-Clipart                   (6) | Val  Loss: 2.0732 | Val  Acc: 0.3846
 Site-Clipart                   (6) | Val  Loss: 2.0033 | Val  Acc: 0.4615
 Site-dslr                      (0) | Val  Loss: 2.1326 | Val  Acc: 0.2308
 Site-Product                   (1) | Val  Loss: 1.9283 | Val  Acc: 0.5556
Average Valid Accuracy: 0.4082
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.4000
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.0000
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.6667
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.4545
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.4667
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.4737
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.4800
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.6250
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.6190
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.3889
 Best site-Art                      (3)  | Epoch:2 | Val Acc: 0.0000
 Best site-Art                      (2)  | Epoch:2 | Val Acc: 0.5714
 Best site-Art                      (4)  | Epoch:2 | Val Acc: 0.5000
 Best site-Art                      (5)  | Epoch:2 | Val Acc: 0.4286
 Best site-Art                      (4)  | Epoch:2 | Val Acc: 0.4000
 Best site-Art                      (4)  | Epoch:2 | Val Acc: 0.3929
 Best site-Art                      (4)  | Epoch:2 | Val Acc: 0.2895
 Best site-RealWorld                (1)  | Epoch:2 | Val Acc: 0.3333
 Best site-RealWorld                (5)  | Epoch:2 | Val Acc: 0.6667
 Best site-RealWorld                (5)  | Epoch:2 | Val Acc: 0.2857
 Best site-RealWorld                (5)  | Epoch:2 | Val Acc: 0.3333
 Best site-RealWorld                (5)  | Epoch:2 | Val Acc: 0.4688
 Best site-webcam                   (0)  | Epoch:2 | Val Acc: 0.4000
 Best site-webcam                   (0)  | Epoch:2 | Val Acc: 0.2941
 Best site-webcam                   (0)  | Epoch:2 | Val Acc: 0.2667
 Best site-Clipart                  (6)  | Epoch:2 | Val Acc: 0.3846
 Best site-Clipart                  (6)  | Epoch:2 | Val Acc: 0.4615
 Best site-dslr                     (0)  | Epoch:2 | Val Acc: 0.2308
 Best site-Product                  (1)  | Epoch:2 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[7, 1, 13, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-amazon                    (2) | Train Loss: 2.0210 | Train Acc: 0.5000
 Site-amazon                    (2) | Train Loss: 1.9612 | Train Acc: 0.5000
 Site-amazon                    (2) | Train Loss: 1.7807 | Train Acc: 0.6923
 Site-amazon                    (2) | Train Loss: 1.9374 | Train Acc: 0.4706
 Site-amazon                    (1) | Train Loss: 1.8682 | Train Acc: 0.5909
 Site-amazon                    (2) | Train Loss: 1.8839 | Train Acc: 0.4828
 Site-amazon                    (2) | Train Loss: 1.7833 | Train Acc: 0.7027
 Site-amazon                    (2) | Train Loss: 1.8112 | Train Acc: 0.6667
 Site-amazon                    (2) | Train Loss: 1.8407 | Train Acc: 0.6190
 Site-amazon                    (2) | Train Loss: 1.8880 | Train Acc: 0.5679
 Site-Art                       (4) | Train Loss: 2.0754 | Train Acc: 0.2500
 Site-Art                       (0) | Train Loss: 2.1404 | Train Acc: 0.2727
 Site-Art                       (0) | Train Loss: 2.0898 | Train Acc: 0.3125
 Site-Art                       (0) | Train Loss: 2.1199 | Train Acc: 0.3636
 Site-Art                       (0) | Train Loss: 2.0307 | Train Acc: 0.4000
 Site-Art                       (6) | Train Loss: 2.0481 | Train Acc: 0.4524
 Site-Art                       (0) | Train Loss: 2.0711 | Train Acc: 0.2586
 Site-RealWorld                 (2) | Train Loss: 1.8960 | Train Acc: 0.6667
 Site-RealWorld                 (2) | Train Loss: 1.9257 | Train Acc: 0.5714
 Site-RealWorld                 (0) | Train Loss: 2.0664 | Train Acc: 0.3636
 Site-RealWorld                 (2) | Train Loss: 1.9366 | Train Acc: 0.5938
 Site-RealWorld                 (0) | Train Loss: 1.8784 | Train Acc: 0.5918
 Site-webcam                    (3) | Train Loss: 1.8516 | Train Acc: 0.6000
 Site-webcam                    (3) | Train Loss: 1.9026 | Train Acc: 0.5385
 Site-webcam                    (3) | Train Loss: 1.9777 | Train Acc: 0.4222
 Site-Clipart                   (5) | Train Loss: 2.0166 | Train Acc: 0.4211
 Site-Clipart                   (5) | Train Loss: 2.0114 | Train Acc: 0.2821
 Site-dslr                      (3) | Train Loss: 1.9820 | Train Acc: 0.4500
 Site-Product                   (2) | Train Loss: 1.8851 | Train Acc: 0.4074
Average Train Accuracy: 0.4831
 Site-amazon                    (2) | Val  Loss: 1.8418 | Val  Acc: 0.6000
 Site-amazon                    (2) | Val  Loss: 1.9611 | Val  Acc: 0.4286
 Site-amazon                    (2) | Val  Loss: 1.6447 | Val  Acc: 0.6667
 Site-amazon                    (2) | Val  Loss: 1.8413 | Val  Acc: 0.6364
 Site-amazon                    (1) | Val  Loss: 1.8035 | Val  Acc: 0.6000
 Site-amazon                    (2) | Val  Loss: 1.8924 | Val  Acc: 0.5263
 Site-amazon                    (2) | Val  Loss: 1.8763 | Val  Acc: 0.5600
 Site-amazon                    (2) | Val  Loss: 1.7675 | Val  Acc: 0.7188
 Site-amazon                    (2) | Val  Loss: 1.7491 | Val  Acc: 0.7381
 Site-amazon                    (2) | Val  Loss: 1.8679 | Val  Acc: 0.5556
 Site-Art                       (4) | Val  Loss: 2.1547 | Val  Acc: 0.0000
 Site-Art                       (0) | Val  Loss: 2.0627 | Val  Acc: 0.5714
 Site-Art                       (0) | Val  Loss: 1.8561 | Val  Acc: 0.8000
 Site-Art                       (0) | Val  Loss: 2.1708 | Val  Acc: 0.4286
 Site-Art                       (0) | Val  Loss: 2.0565 | Val  Acc: 0.5000
 Site-Art                       (6) | Val  Loss: 2.0112 | Val  Acc: 0.3929
 Site-Art                       (0) | Val  Loss: 2.1022 | Val  Acc: 0.2895
 Site-RealWorld                 (2) | Val  Loss: 1.9826 | Val  Acc: 0.1667
 Site-RealWorld                 (2) | Val  Loss: 1.7702 | Val  Acc: 0.7778
 Site-RealWorld                 (0) | Val  Loss: 1.9956 | Val  Acc: 0.4286
 Site-RealWorld                 (2) | Val  Loss: 2.0194 | Val  Acc: 0.3810
 Site-RealWorld                 (0) | Val  Loss: 1.9411 | Val  Acc: 0.5625
 Site-webcam                    (3) | Val  Loss: 2.0460 | Val  Acc: 0.4000
 Site-webcam                    (3) | Val  Loss: 1.9183 | Val  Acc: 0.5294
 Site-webcam                    (3) | Val  Loss: 1.9346 | Val  Acc: 0.4333
 Site-Clipart                   (5) | Val  Loss: 1.8920 | Val  Acc: 0.5385
 Site-Clipart                   (5) | Val  Loss: 1.9560 | Val  Acc: 0.5000
 Site-dslr                      (3) | Val  Loss: 2.0051 | Val  Acc: 0.5000
 Site-Product                   (2) | Val  Loss: 1.8336 | Val  Acc: 0.6667
Average Valid Accuracy: 0.5137
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.6000
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.4286
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.6364
 Best site-amazon                   (1)  | Epoch:3 | Val Acc: 0.6000
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.5263
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.5600
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.7188
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.7381
 Best site-amazon                   (2)  | Epoch:3 | Val Acc: 0.5556
 Best site-Art                      (4)  | Epoch:3 | Val Acc: 0.0000
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.5714
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.4286
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.5000
 Best site-Art                      (6)  | Epoch:3 | Val Acc: 0.3929
 Best site-Art                      (0)  | Epoch:3 | Val Acc: 0.2895
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.1667
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.7778
 Best site-RealWorld                (0)  | Epoch:3 | Val Acc: 0.4286
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.3810
 Best site-RealWorld                (0)  | Epoch:3 | Val Acc: 0.5625
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.4000
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.5294
 Best site-webcam                   (3)  | Epoch:3 | Val Acc: 0.4333
 Best site-Clipart                  (5)  | Epoch:3 | Val Acc: 0.5385
 Best site-Clipart                  (5)  | Epoch:3 | Val Acc: 0.5000
 Best site-dslr                     (3)  | Epoch:3 | Val Acc: 0.5000
 Best site-Product                  (2)  | Epoch:3 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 9, 1, 5, 7, 1, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-amazon                    (1) | Train Loss: 2.0163 | Train Acc: 0.2500
 Site-amazon                    (1) | Train Loss: 1.8223 | Train Acc: 0.6000
 Site-amazon                    (1) | Train Loss: 1.7016 | Train Acc: 0.6154
 Site-amazon                    (6) | Train Loss: 1.8449 | Train Acc: 0.5882
 Site-amazon                    (6) | Train Loss: 1.8226 | Train Acc: 0.6364
 Site-amazon                    (1) | Train Loss: 1.7318 | Train Acc: 0.6897
 Site-amazon                    (1) | Train Loss: 1.6670 | Train Acc: 0.8108
 Site-amazon                    (1) | Train Loss: 1.7152 | Train Acc: 0.6875
 Site-amazon                    (1) | Train Loss: 1.7331 | Train Acc: 0.7302
 Site-amazon                    (1) | Train Loss: 1.7709 | Train Acc: 0.7037
 Site-Art                       (3) | Train Loss: 2.0599 | Train Acc: 0.2500
 Site-Art                       (2) | Train Loss: 2.0002 | Train Acc: 0.3636
 Site-Art                       (5) | Train Loss: 1.9673 | Train Acc: 0.2500
 Site-Art                       (3) | Train Loss: 2.0448 | Train Acc: 0.4091
 Site-Art                       (3) | Train Loss: 1.9292 | Train Acc: 0.5000
 Site-Art                       (3) | Train Loss: 1.9829 | Train Acc: 0.4524
 Site-Art                       (3) | Train Loss: 1.9972 | Train Acc: 0.3276
 Site-RealWorld                 (4) | Train Loss: 1.7594 | Train Acc: 0.6667
 Site-RealWorld                 (4) | Train Loss: 1.8434 | Train Acc: 0.7143
 Site-RealWorld                 (4) | Train Loss: 1.9925 | Train Acc: 0.3636
 Site-RealWorld                 (4) | Train Loss: 1.8463 | Train Acc: 0.6250
 Site-RealWorld                 (4) | Train Loss: 1.7810 | Train Acc: 0.6327
 Site-webcam                    (0) | Train Loss: 1.8203 | Train Acc: 0.6667
 Site-webcam                    (0) | Train Loss: 1.8256 | Train Acc: 0.5385
 Site-webcam                    (0) | Train Loss: 1.9158 | Train Acc: 0.5333
 Site-Clipart                   (4) | Train Loss: 1.9082 | Train Acc: 0.4211
 Site-Clipart                   (1) | Train Loss: 1.9046 | Train Acc: 0.4615
 Site-dslr                      (4) | Train Loss: 1.8962 | Train Acc: 0.5250
 Site-Product                   (6) | Train Loss: 1.7997 | Train Acc: 0.5185
Average Train Accuracy: 0.5356
 Site-amazon                    (1) | Val  Loss: 1.7741 | Val  Acc: 0.4000
 Site-amazon                    (1) | Val  Loss: 1.8666 | Val  Acc: 0.4286
 Site-amazon                    (1) | Val  Loss: 1.5967 | Val  Acc: 0.6667
 Site-amazon                    (6) | Val  Loss: 1.6567 | Val  Acc: 0.8182
 Site-amazon                    (6) | Val  Loss: 1.7159 | Val  Acc: 0.6667
 Site-amazon                    (1) | Val  Loss: 1.7425 | Val  Acc: 0.6842
 Site-amazon                    (1) | Val  Loss: 1.8036 | Val  Acc: 0.6800
 Site-amazon                    (1) | Val  Loss: 1.6873 | Val  Acc: 0.7188
 Site-amazon                    (1) | Val  Loss: 1.6775 | Val  Acc: 0.7143
 Site-amazon                    (1) | Val  Loss: 1.7686 | Val  Acc: 0.6667
 Site-Art                       (3) | Val  Loss: 2.1852 | Val  Acc: 0.0000
 Site-Art                       (2) | Val  Loss: 1.9248 | Val  Acc: 0.4286
 Site-Art                       (5) | Val  Loss: 1.6742 | Val  Acc: 0.8000
 Site-Art                       (3) | Val  Loss: 2.1034 | Val  Acc: 0.4286
 Site-Art                       (3) | Val  Loss: 2.0388 | Val  Acc: 0.4000
 Site-Art                       (3) | Val  Loss: 1.8958 | Val  Acc: 0.5357
 Site-Art                       (3) | Val  Loss: 2.0262 | Val  Acc: 0.3947
 Site-RealWorld                 (4) | Val  Loss: 1.7963 | Val  Acc: 0.5000
 Site-RealWorld                 (4) | Val  Loss: 1.6375 | Val  Acc: 0.7778
 Site-RealWorld                 (4) | Val  Loss: 1.9102 | Val  Acc: 0.6429
 Site-RealWorld                 (4) | Val  Loss: 1.9400 | Val  Acc: 0.4762
 Site-RealWorld                 (4) | Val  Loss: 1.8570 | Val  Acc: 0.6562
 Site-webcam                    (0) | Val  Loss: 1.9450 | Val  Acc: 0.5000
 Site-webcam                    (0) | Val  Loss: 1.8643 | Val  Acc: 0.5882
 Site-webcam                    (0) | Val  Loss: 1.8880 | Val  Acc: 0.5333
 Site-Clipart                   (4) | Val  Loss: 1.8707 | Val  Acc: 0.5385
 Site-Clipart                   (1) | Val  Loss: 1.8979 | Val  Acc: 0.5385
 Site-dslr                      (4) | Val  Loss: 1.9299 | Val  Acc: 0.6154
 Site-Product                   (6) | Val  Loss: 1.6954 | Val  Acc: 0.7222
Average Valid Accuracy: 0.5697
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.4000
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.4286
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.6667
 Best site-amazon                   (6)  | Epoch:4 | Val Acc: 0.8182
 Best site-amazon                   (6)  | Epoch:4 | Val Acc: 0.6667
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.6842
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.6800
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7188
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.7143
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.6667
 Best site-Art                      (3)  | Epoch:4 | Val Acc: 0.0000
 Best site-Art                      (2)  | Epoch:4 | Val Acc: 0.4286
 Best site-Art                      (5)  | Epoch:4 | Val Acc: 0.8000
 Best site-Art                      (3)  | Epoch:4 | Val Acc: 0.4286
 Best site-Art                      (3)  | Epoch:4 | Val Acc: 0.4000
 Best site-Art                      (3)  | Epoch:4 | Val Acc: 0.5357
 Best site-Art                      (3)  | Epoch:4 | Val Acc: 0.3947
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.5000
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.7778
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.6429
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.4762
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.6562
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.5000
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.5882
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.5333
 Best site-Clipart                  (4)  | Epoch:4 | Val Acc: 0.5385
 Best site-Clipart                  (1)  | Epoch:4 | Val Acc: 0.5385
 Best site-dslr                     (4)  | Epoch:4 | Val Acc: 0.6154
 Best site-Product                  (6)  | Epoch:4 | Val Acc: 0.7222
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[6, 1, 2, 3, 1, 3, 13, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-amazon                    (6) | Train Loss: 1.9213 | Train Acc: 0.5000
 Site-amazon                    (6) | Train Loss: 1.6785 | Train Acc: 0.7000
 Site-amazon                    (6) | Train Loss: 1.6566 | Train Acc: 0.7692
 Site-amazon                    (6) | Train Loss: 1.6446 | Train Acc: 0.7059
 Site-amazon                    (6) | Train Loss: 1.6630 | Train Acc: 0.8636
 Site-amazon                    (6) | Train Loss: 1.7051 | Train Acc: 0.7586
 Site-amazon                    (1) | Train Loss: 1.5521 | Train Acc: 0.8108
 Site-amazon                    (6) | Train Loss: 1.5986 | Train Acc: 0.7083
 Site-amazon                    (6) | Train Loss: 1.6278 | Train Acc: 0.7619
 Site-amazon                    (6) | Train Loss: 1.6867 | Train Acc: 0.7407
 Site-Art                       (4) | Train Loss: 1.9500 | Train Acc: 0.3750
 Site-Art                       (6) | Train Loss: 1.9663 | Train Acc: 0.5455
 Site-Art                       (0) | Train Loss: 1.9448 | Train Acc: 0.4375
 Site-Art                       (0) | Train Loss: 1.9284 | Train Acc: 0.4091
 Site-Art                       (0) | Train Loss: 1.8358 | Train Acc: 0.4667
 Site-Art                       (0) | Train Loss: 1.9122 | Train Acc: 0.5000
 Site-Art                       (0) | Train Loss: 1.9119 | Train Acc: 0.3966
 Site-RealWorld                 (6) | Train Loss: 1.7146 | Train Acc: 0.6667
 Site-RealWorld                 (3) | Train Loss: 1.7532 | Train Acc: 0.7857
 Site-RealWorld                 (2) | Train Loss: 1.9231 | Train Acc: 0.4545
 Site-RealWorld                 (3) | Train Loss: 1.7756 | Train Acc: 0.6250
 Site-RealWorld                 (3) | Train Loss: 1.6859 | Train Acc: 0.6939
 Site-webcam                    (5) | Train Loss: 1.6990 | Train Acc: 0.8000
 Site-webcam                    (5) | Train Loss: 1.6181 | Train Acc: 0.6923
 Site-webcam                    (5) | Train Loss: 1.8111 | Train Acc: 0.5556
 Site-Clipart                   (0) | Train Loss: 1.8842 | Train Acc: 0.3684
 Site-Clipart                   (6) | Train Loss: 1.8119 | Train Acc: 0.5897
 Site-dslr                      (2) | Train Loss: 1.7356 | Train Acc: 0.7500
 Site-Product                   (6) | Train Loss: 1.7148 | Train Acc: 0.6296
Average Train Accuracy: 0.6228
 Site-amazon                    (6) | Val  Loss: 1.6214 | Val  Acc: 0.6000
 Site-amazon                    (6) | Val  Loss: 1.7812 | Val  Acc: 0.7143
 Site-amazon                    (6) | Val  Loss: 1.4775 | Val  Acc: 0.8889
 Site-amazon                    (6) | Val  Loss: 1.5392 | Val  Acc: 0.9091
 Site-amazon                    (6) | Val  Loss: 1.5663 | Val  Acc: 0.6667
 Site-amazon                    (6) | Val  Loss: 1.6597 | Val  Acc: 0.7368
 Site-amazon                    (1) | Val  Loss: 1.7399 | Val  Acc: 0.6400
 Site-amazon                    (6) | Val  Loss: 1.5489 | Val  Acc: 0.7500
 Site-amazon                    (6) | Val  Loss: 1.5439 | Val  Acc: 0.8095
 Site-amazon                    (6) | Val  Loss: 1.6433 | Val  Acc: 0.7037
 Site-Art                       (4) | Val  Loss: 1.9706 | Val  Acc: 0.4000
 Site-Art                       (6) | Val  Loss: 1.7228 | Val  Acc: 0.7143
 Site-Art                       (0) | Val  Loss: 1.5824 | Val  Acc: 0.8000
 Site-Art                       (0) | Val  Loss: 2.0715 | Val  Acc: 0.5000
 Site-Art                       (0) | Val  Loss: 1.9022 | Val  Acc: 0.5000
 Site-Art                       (0) | Val  Loss: 1.8268 | Val  Acc: 0.4643
 Site-Art                       (0) | Val  Loss: 1.9647 | Val  Acc: 0.3421
 Site-RealWorld                 (6) | Val  Loss: 1.7890 | Val  Acc: 0.5000
 Site-RealWorld                 (3) | Val  Loss: 1.5535 | Val  Acc: 0.7778
 Site-RealWorld                 (2) | Val  Loss: 1.8192 | Val  Acc: 0.6429
 Site-RealWorld                 (3) | Val  Loss: 1.8024 | Val  Acc: 0.6190
 Site-RealWorld                 (3) | Val  Loss: 1.7234 | Val  Acc: 0.6875
 Site-webcam                    (5) | Val  Loss: 1.8800 | Val  Acc: 0.7000
 Site-webcam                    (5) | Val  Loss: 1.7600 | Val  Acc: 0.7059
 Site-webcam                    (5) | Val  Loss: 1.7700 | Val  Acc: 0.6000
 Site-Clipart                   (0) | Val  Loss: 1.7695 | Val  Acc: 0.6154
 Site-Clipart                   (6) | Val  Loss: 1.8051 | Val  Acc: 0.6154
 Site-dslr                      (2) | Val  Loss: 1.7850 | Val  Acc: 0.6154
 Site-Product                   (6) | Val  Loss: 1.6413 | Val  Acc: 0.6111
Average Valid Accuracy: 0.6493
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.6000
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.7143
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.8889
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.9091
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.6667
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.7368
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.6400
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.7500
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.8095
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.7037
 Best site-Art                      (4)  | Epoch:5 | Val Acc: 0.4000
 Best site-Art                      (6)  | Epoch:5 | Val Acc: 0.7143
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.8000
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.5000
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.5000
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.4643
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.3421
 Best site-RealWorld                (6)  | Epoch:5 | Val Acc: 0.5000
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.7778
 Best site-RealWorld                (2)  | Epoch:5 | Val Acc: 0.6429
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.6190
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.6875
 Best site-webcam                   (5)  | Epoch:5 | Val Acc: 0.7000
 Best site-webcam                   (5)  | Epoch:5 | Val Acc: 0.7059
 Best site-webcam                   (5)  | Epoch:5 | Val Acc: 0.6000
 Best site-Clipart                  (0)  | Epoch:5 | Val Acc: 0.6154
 Best site-Clipart                  (6)  | Epoch:5 | Val Acc: 0.6154
 Best site-dslr                     (2)  | Epoch:5 | Val Acc: 0.6154
 Best site-Product                  (6)  | Epoch:5 | Val Acc: 0.6111
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[12, 3, 6, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-amazon                    (0) | Train Loss: 1.7423 | Train Acc: 0.6250
 Site-amazon                    (2) | Train Loss: 1.5049 | Train Acc: 0.8000
 Site-amazon                    (0) | Train Loss: 1.5434 | Train Acc: 0.7692
 Site-amazon                    (0) | Train Loss: 1.5340 | Train Acc: 0.8235
 Site-amazon                    (0) | Train Loss: 1.6115 | Train Acc: 0.8182
 Site-amazon                    (0) | Train Loss: 1.5718 | Train Acc: 0.7241
 Site-amazon                    (0) | Train Loss: 1.4672 | Train Acc: 0.8108
 Site-amazon                    (0) | Train Loss: 1.5142 | Train Acc: 0.7292
 Site-amazon                    (0) | Train Loss: 1.5265 | Train Acc: 0.7778
 Site-amazon                    (0) | Train Loss: 1.4954 | Train Acc: 0.8025
 Site-Art                       (4) | Train Loss: 1.7713 | Train Acc: 0.5000
 Site-Art                       (6) | Train Loss: 1.8748 | Train Acc: 0.5455
 Site-Art                       (5) | Train Loss: 1.8747 | Train Acc: 0.3750
 Site-Art                       (3) | Train Loss: 1.8901 | Train Acc: 0.3636
 Site-Art                       (3) | Train Loss: 1.6762 | Train Acc: 0.5667
 Site-Art                       (5) | Train Loss: 1.7893 | Train Acc: 0.5952
 Site-Art                       (3) | Train Loss: 1.8096 | Train Acc: 0.5000
 Site-RealWorld                 (0) | Train Loss: 1.6697 | Train Acc: 0.6667
 Site-RealWorld                 (2) | Train Loss: 1.6547 | Train Acc: 0.7143
 Site-RealWorld                 (2) | Train Loss: 1.7986 | Train Acc: 0.4545
 Site-RealWorld                 (0) | Train Loss: 1.6258 | Train Acc: 0.6875
 Site-RealWorld                 (2) | Train Loss: 1.5899 | Train Acc: 0.7143
 Site-webcam                    (1) | Train Loss: 1.4922 | Train Acc: 0.8667
 Site-webcam                    (1) | Train Loss: 1.5625 | Train Acc: 0.6154
 Site-webcam                    (1) | Train Loss: 1.7151 | Train Acc: 0.6000
 Site-Clipart                   (2) | Train Loss: 1.7213 | Train Acc: 0.5789
 Site-Clipart                   (3) | Train Loss: 1.7097 | Train Acc: 0.5641
 Site-dslr                      (2) | Train Loss: 1.6449 | Train Acc: 0.7250
 Site-Product                   (0) | Train Loss: 1.5942 | Train Acc: 0.5556
Average Train Accuracy: 0.6507
 Site-amazon                    (0) | Val  Loss: 1.4958 | Val  Acc: 0.8000
 Site-amazon                    (2) | Val  Loss: 1.6784 | Val  Acc: 0.5714
 Site-amazon                    (0) | Val  Loss: 1.4116 | Val  Acc: 0.8889
 Site-amazon                    (0) | Val  Loss: 1.5204 | Val  Acc: 0.9091
 Site-amazon                    (0) | Val  Loss: 1.4684 | Val  Acc: 0.8000
 Site-amazon                    (0) | Val  Loss: 1.5753 | Val  Acc: 0.6842
 Site-amazon                    (0) | Val  Loss: 1.6291 | Val  Acc: 0.6800
 Site-amazon                    (0) | Val  Loss: 1.4384 | Val  Acc: 0.8125
 Site-amazon                    (0) | Val  Loss: 1.4260 | Val  Acc: 0.8095
 Site-amazon                    (0) | Val  Loss: 1.5410 | Val  Acc: 0.7778
 Site-Art                       (4) | Val  Loss: 2.0999 | Val  Acc: 0.2000
 Site-Art                       (6) | Val  Loss: 1.6432 | Val  Acc: 0.5714
 Site-Art                       (5) | Val  Loss: 1.5021 | Val  Acc: 0.8000
 Site-Art                       (3) | Val  Loss: 1.9725 | Val  Acc: 0.5000
 Site-Art                       (3) | Val  Loss: 1.9693 | Val  Acc: 0.4000
 Site-Art                       (5) | Val  Loss: 1.7212 | Val  Acc: 0.5000
 Site-Art                       (3) | Val  Loss: 1.8534 | Val  Acc: 0.4474
 Site-RealWorld                 (0) | Val  Loss: 1.6778 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 1.4478 | Val  Acc: 0.8889
 Site-RealWorld                 (2) | Val  Loss: 1.6959 | Val  Acc: 0.6429
 Site-RealWorld                 (0) | Val  Loss: 1.6972 | Val  Acc: 0.6190
 Site-RealWorld                 (2) | Val  Loss: 1.6238 | Val  Acc: 0.6875
 Site-webcam                    (1) | Val  Loss: 1.7366 | Val  Acc: 0.7000
 Site-webcam                    (1) | Val  Loss: 1.6533 | Val  Acc: 0.5882
 Site-webcam                    (1) | Val  Loss: 1.7052 | Val  Acc: 0.6333
 Site-Clipart                   (2) | Val  Loss: 1.6476 | Val  Acc: 0.6154
 Site-Clipart                   (3) | Val  Loss: 1.6812 | Val  Acc: 0.6154
 Site-dslr                      (2) | Val  Loss: 1.7001 | Val  Acc: 0.6154
 Site-Product                   (0) | Val  Loss: 1.4982 | Val  Acc: 0.8333
Average Valid Accuracy: 0.6583
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.5714
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8889
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.9091
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8000
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.6842
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.6800
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8125
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.8095
 Best site-amazon                   (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-Art                      (4)  | Epoch:6 | Val Acc: 0.2000
 Best site-Art                      (6)  | Epoch:6 | Val Acc: 0.5714
 Best site-Art                      (5)  | Epoch:6 | Val Acc: 0.8000
 Best site-Art                      (3)  | Epoch:6 | Val Acc: 0.5000
 Best site-Art                      (3)  | Epoch:6 | Val Acc: 0.4000
 Best site-Art                      (5)  | Epoch:6 | Val Acc: 0.5000
 Best site-Art                      (3)  | Epoch:6 | Val Acc: 0.4474
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:6 | Val Acc: 0.8889
 Best site-RealWorld                (2)  | Epoch:6 | Val Acc: 0.6429
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.6190
 Best site-RealWorld                (2)  | Epoch:6 | Val Acc: 0.6875
 Best site-webcam                   (1)  | Epoch:6 | Val Acc: 0.7000
 Best site-webcam                   (1)  | Epoch:6 | Val Acc: 0.5882
 Best site-webcam                   (1)  | Epoch:6 | Val Acc: 0.6333
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.6154
 Best site-Clipart                  (3)  | Epoch:6 | Val Acc: 0.6154
 Best site-dslr                     (2)  | Epoch:6 | Val Acc: 0.6154
 Best site-Product                  (0)  | Epoch:6 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 7, 3, 1, 4, 7, 6, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-amazon                    (6) | Train Loss: 1.6553 | Train Acc: 0.5000
 Site-amazon                    (6) | Train Loss: 1.4428 | Train Acc: 0.8000
 Site-amazon                    (6) | Train Loss: 1.5032 | Train Acc: 0.6923
 Site-amazon                    (5) | Train Loss: 1.4636 | Train Acc: 0.8235
 Site-amazon                    (5) | Train Loss: 1.4028 | Train Acc: 0.9545
 Site-amazon                    (5) | Train Loss: 1.4844 | Train Acc: 0.7586
 Site-amazon                    (6) | Train Loss: 1.3585 | Train Acc: 0.8108
 Site-amazon                    (0) | Train Loss: 1.4026 | Train Acc: 0.7500
 Site-amazon                    (5) | Train Loss: 1.4140 | Train Acc: 0.8095
 Site-amazon                    (5) | Train Loss: 1.4456 | Train Acc: 0.8025
 Site-Art                       (3) | Train Loss: 1.6224 | Train Acc: 0.7500
 Site-Art                       (1) | Train Loss: 1.8711 | Train Acc: 0.4545
 Site-Art                       (4) | Train Loss: 1.6917 | Train Acc: 0.7500
 Site-Art                       (1) | Train Loss: 1.7457 | Train Acc: 0.5455
 Site-Art                       (4) | Train Loss: 1.6710 | Train Acc: 0.6000
 Site-Art                       (4) | Train Loss: 1.7384 | Train Acc: 0.5238
 Site-Art                       (4) | Train Loss: 1.7480 | Train Acc: 0.4828
 Site-RealWorld                 (5) | Train Loss: 1.4949 | Train Acc: 0.7778
 Site-RealWorld                 (1) | Train Loss: 1.5803 | Train Acc: 0.6429
 Site-RealWorld                 (1) | Train Loss: 1.6612 | Train Acc: 0.5455
 Site-RealWorld                 (6) | Train Loss: 1.4994 | Train Acc: 0.7188
 Site-RealWorld                 (1) | Train Loss: 1.4926 | Train Acc: 0.7959
 Site-webcam                    (2) | Train Loss: 1.3698 | Train Acc: 0.9333
 Site-webcam                    (2) | Train Loss: 1.4336 | Train Acc: 0.8462
 Site-webcam                    (2) | Train Loss: 1.6188 | Train Acc: 0.6444
 Site-Clipart                   (1) | Train Loss: 1.6692 | Train Acc: 0.6316
 Site-Clipart                   (6) | Train Loss: 1.6760 | Train Acc: 0.5897
 Site-dslr                      (1) | Train Loss: 1.5209 | Train Acc: 0.7750
 Site-Product                   (5) | Train Loss: 1.4785 | Train Acc: 0.7037
Average Train Accuracy: 0.7039
 Site-amazon                    (6) | Val  Loss: 1.4338 | Val  Acc: 0.6000
 Site-amazon                    (6) | Val  Loss: 1.5976 | Val  Acc: 0.5714
 Site-amazon                    (6) | Val  Loss: 1.3299 | Val  Acc: 0.8889
 Site-amazon                    (5) | Val  Loss: 1.2696 | Val  Acc: 0.9091
 Site-amazon                    (5) | Val  Loss: 1.3291 | Val  Acc: 0.9333
 Site-amazon                    (5) | Val  Loss: 1.4679 | Val  Acc: 0.7368
 Site-amazon                    (6) | Val  Loss: 1.4909 | Val  Acc: 0.7600
 Site-amazon                    (0) | Val  Loss: 1.3429 | Val  Acc: 0.8125
 Site-amazon                    (5) | Val  Loss: 1.3498 | Val  Acc: 0.8095
 Site-amazon                    (5) | Val  Loss: 1.4481 | Val  Acc: 0.7963
 Site-Art                       (3) | Val  Loss: 1.8865 | Val  Acc: 0.4000
 Site-Art                       (1) | Val  Loss: 1.5844 | Val  Acc: 0.7143
 Site-Art                       (4) | Val  Loss: 1.4334 | Val  Acc: 0.8000
 Site-Art                       (1) | Val  Loss: 1.8480 | Val  Acc: 0.5000
 Site-Art                       (4) | Val  Loss: 1.8426 | Val  Acc: 0.5000
 Site-Art                       (4) | Val  Loss: 1.6161 | Val  Acc: 0.6429
 Site-Art                       (4) | Val  Loss: 1.7593 | Val  Acc: 0.5263
 Site-RealWorld                 (5) | Val  Loss: 1.5949 | Val  Acc: 0.5000
 Site-RealWorld                 (1) | Val  Loss: 1.2991 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 1.5663 | Val  Acc: 0.6429
 Site-RealWorld                 (6) | Val  Loss: 1.6205 | Val  Acc: 0.6190
 Site-RealWorld                 (1) | Val  Loss: 1.5260 | Val  Acc: 0.7188
 Site-webcam                    (2) | Val  Loss: 1.6172 | Val  Acc: 0.8000
 Site-webcam                    (2) | Val  Loss: 1.4782 | Val  Acc: 0.7059
 Site-webcam                    (2) | Val  Loss: 1.5684 | Val  Acc: 0.7000
 Site-Clipart                   (1) | Val  Loss: 1.5707 | Val  Acc: 0.6923
 Site-Clipart                   (6) | Val  Loss: 1.5725 | Val  Acc: 0.7308
 Site-dslr                      (1) | Val  Loss: 1.5519 | Val  Acc: 0.7308
 Site-Product                   (5) | Val  Loss: 1.4131 | Val  Acc: 0.7778
Average Valid Accuracy: 0.7037
 Best site-amazon                   (6)  | Epoch:7 | Val Acc: 0.6000
 Best site-amazon                   (6)  | Epoch:7 | Val Acc: 0.5714
 Best site-amazon                   (6)  | Epoch:7 | Val Acc: 0.8889
 Best site-amazon                   (5)  | Epoch:7 | Val Acc: 0.9091
 Best site-amazon                   (5)  | Epoch:7 | Val Acc: 0.9333
 Best site-amazon                   (5)  | Epoch:7 | Val Acc: 0.7368
 Best site-amazon                   (6)  | Epoch:7 | Val Acc: 0.7600
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.8125
 Best site-amazon                   (5)  | Epoch:7 | Val Acc: 0.8095
 Best site-amazon                   (5)  | Epoch:7 | Val Acc: 0.7963
 Best site-Art                      (3)  | Epoch:7 | Val Acc: 0.4000
 Best site-Art                      (1)  | Epoch:7 | Val Acc: 0.7143
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.8000
 Best site-Art                      (1)  | Epoch:7 | Val Acc: 0.5000
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.5000
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.6429
 Best site-Art                      (4)  | Epoch:7 | Val Acc: 0.5263
 Best site-RealWorld                (5)  | Epoch:7 | Val Acc: 0.5000
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.8889
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.6429
 Best site-RealWorld                (6)  | Epoch:7 | Val Acc: 0.6190
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7188
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.8000
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.7059
 Best site-webcam                   (2)  | Epoch:7 | Val Acc: 0.7000
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.6923
 Best site-Clipart                  (6)  | Epoch:7 | Val Acc: 0.7308
 Best site-dslr                     (1)  | Epoch:7 | Val Acc: 0.7308
 Best site-Product                  (5)  | Epoch:7 | Val Acc: 0.7778
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 5, 3, 2, 1, 8, 9, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-amazon                    (5) | Train Loss: 1.5463 | Train Acc: 0.6250
 Site-amazon                    (6) | Train Loss: 1.2098 | Train Acc: 0.8000
 Site-amazon                    (6) | Train Loss: 1.3573 | Train Acc: 0.7692
 Site-amazon                    (6) | Train Loss: 1.4270 | Train Acc: 0.7059
 Site-amazon                    (3) | Train Loss: 1.3706 | Train Acc: 0.8636
 Site-amazon                    (6) | Train Loss: 1.3712 | Train Acc: 0.7586
 Site-amazon                    (6) | Train Loss: 1.2393 | Train Acc: 0.8378
 Site-amazon                    (3) | Train Loss: 1.2898 | Train Acc: 0.8125
 Site-amazon                    (6) | Train Loss: 1.2944 | Train Acc: 0.8254
 Site-amazon                    (6) | Train Loss: 1.3438 | Train Acc: 0.8025
 Site-Art                       (4) | Train Loss: 1.5107 | Train Acc: 0.8750
 Site-Art                       (1) | Train Loss: 1.7136 | Train Acc: 0.4545
 Site-Art                       (1) | Train Loss: 1.6021 | Train Acc: 0.6875
 Site-Art                       (5) | Train Loss: 1.6345 | Train Acc: 0.5455
 Site-Art                       (1) | Train Loss: 1.5249 | Train Acc: 0.6667
 Site-Art                       (1) | Train Loss: 1.6765 | Train Acc: 0.6190
 Site-Art                       (1) | Train Loss: 1.6219 | Train Acc: 0.6034
 Site-RealWorld                 (5) | Train Loss: 1.3890 | Train Acc: 0.6667
 Site-RealWorld                 (5) | Train Loss: 1.4238 | Train Acc: 0.7857
 Site-RealWorld                 (5) | Train Loss: 1.5653 | Train Acc: 0.6364
 Site-RealWorld                 (0) | Train Loss: 1.4198 | Train Acc: 0.7188
 Site-RealWorld                 (5) | Train Loss: 1.3759 | Train Acc: 0.8980
 Site-webcam                    (2) | Train Loss: 1.2794 | Train Acc: 0.9333
 Site-webcam                    (2) | Train Loss: 1.3436 | Train Acc: 0.8077
 Site-webcam                    (2) | Train Loss: 1.4851 | Train Acc: 0.7111
 Site-Clipart                   (5) | Train Loss: 1.6320 | Train Acc: 0.5263
 Site-Clipart                   (6) | Train Loss: 1.5770 | Train Acc: 0.6410
 Site-dslr                      (5) | Train Loss: 1.4118 | Train Acc: 0.7000
 Site-Product                   (6) | Train Loss: 1.4009 | Train Acc: 0.6667
Average Train Accuracy: 0.7222
 Site-amazon                    (5) | Val  Loss: 1.3110 | Val  Acc: 0.6000
 Site-amazon                    (6) | Val  Loss: 1.5026 | Val  Acc: 0.5714
 Site-amazon                    (6) | Val  Loss: 1.1357 | Val  Acc: 0.8889
 Site-amazon                    (6) | Val  Loss: 1.2206 | Val  Acc: 0.9091
 Site-amazon                    (3) | Val  Loss: 1.2372 | Val  Acc: 0.9333
 Site-amazon                    (6) | Val  Loss: 1.3945 | Val  Acc: 0.7368
 Site-amazon                    (6) | Val  Loss: 1.3979 | Val  Acc: 0.8400
 Site-amazon                    (3) | Val  Loss: 1.2024 | Val  Acc: 0.8750
 Site-amazon                    (6) | Val  Loss: 1.2325 | Val  Acc: 0.9048
 Site-amazon                    (6) | Val  Loss: 1.3467 | Val  Acc: 0.8148
 Site-Art                       (4) | Val  Loss: 1.8641 | Val  Acc: 0.4000
 Site-Art                       (1) | Val  Loss: 1.6471 | Val  Acc: 0.7143
 Site-Art                       (1) | Val  Loss: 1.3537 | Val  Acc: 0.9000
 Site-Art                       (5) | Val  Loss: 1.7690 | Val  Acc: 0.5000
 Site-Art                       (1) | Val  Loss: 1.7701 | Val  Acc: 0.5000
 Site-Art                       (1) | Val  Loss: 1.5436 | Val  Acc: 0.7143
 Site-Art                       (1) | Val  Loss: 1.7082 | Val  Acc: 0.5263
 Site-RealWorld                 (5) | Val  Loss: 1.4193 | Val  Acc: 0.6667
 Site-RealWorld                 (5) | Val  Loss: 1.2380 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 1.4508 | Val  Acc: 0.7143
 Site-RealWorld                 (0) | Val  Loss: 1.5299 | Val  Acc: 0.6667
 Site-RealWorld                 (5) | Val  Loss: 1.4074 | Val  Acc: 0.7500
 Site-webcam                    (2) | Val  Loss: 1.6032 | Val  Acc: 0.7000
 Site-webcam                    (2) | Val  Loss: 1.3981 | Val  Acc: 0.7647
 Site-webcam                    (2) | Val  Loss: 1.4845 | Val  Acc: 0.7667
 Site-Clipart                   (5) | Val  Loss: 1.4053 | Val  Acc: 0.6923
 Site-Clipart                   (6) | Val  Loss: 1.4515 | Val  Acc: 0.7308
 Site-dslr                      (5) | Val  Loss: 1.4918 | Val  Acc: 0.7308
 Site-Product                   (6) | Val  Loss: 1.2642 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7360
 Best site-amazon                   (5)  | Epoch:8 | Val Acc: 0.6000
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.5714
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.8889
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.9091
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.9333
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.7368
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.8400
 Best site-amazon                   (3)  | Epoch:8 | Val Acc: 0.8750
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.9048
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.8148
 Best site-Art                      (4)  | Epoch:8 | Val Acc: 0.4000
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.7143
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.9000
 Best site-Art                      (5)  | Epoch:8 | Val Acc: 0.5000
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.5000
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.7143
 Best site-Art                      (1)  | Epoch:8 | Val Acc: 0.5263
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 0.6667
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 0.7143
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.6667
 Best site-RealWorld                (5)  | Epoch:8 | Val Acc: 0.7500
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.7000
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.7647
 Best site-webcam                   (2)  | Epoch:8 | Val Acc: 0.7667
 Best site-Clipart                  (5)  | Epoch:8 | Val Acc: 0.6923
 Best site-Clipart                  (6)  | Epoch:8 | Val Acc: 0.7308
 Best site-dslr                     (5)  | Epoch:8 | Val Acc: 0.7308
 Best site-Product                  (6)  | Epoch:8 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 12, 1, 1, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-amazon                    (1) | Train Loss: 1.4391 | Train Acc: 0.6250
 Site-amazon                    (1) | Train Loss: 1.1363 | Train Acc: 0.8000
 Site-amazon                    (6) | Train Loss: 1.3061 | Train Acc: 0.7692
 Site-amazon                    (1) | Train Loss: 1.2360 | Train Acc: 0.8824
 Site-amazon                    (1) | Train Loss: 1.2509 | Train Acc: 0.9091
 Site-amazon                    (1) | Train Loss: 1.2604 | Train Acc: 0.7586
 Site-amazon                    (1) | Train Loss: 1.1465 | Train Acc: 0.8378
 Site-amazon                    (1) | Train Loss: 1.1563 | Train Acc: 0.8333
 Site-amazon                    (1) | Train Loss: 1.1886 | Train Acc: 0.8254
 Site-amazon                    (1) | Train Loss: 1.2356 | Train Acc: 0.8395
 Site-Art                       (3) | Train Loss: 1.3961 | Train Acc: 0.8750
 Site-Art                       (0) | Train Loss: 1.7653 | Train Acc: 0.4545
 Site-Art                       (4) | Train Loss: 1.6050 | Train Acc: 0.5000
 Site-Art                       (0) | Train Loss: 1.5268 | Train Acc: 0.5455
 Site-Art                       (0) | Train Loss: 1.4911 | Train Acc: 0.6667
 Site-Art                       (5) | Train Loss: 1.6399 | Train Acc: 0.5952
 Site-Art                       (0) | Train Loss: 1.5471 | Train Acc: 0.5690
 Site-RealWorld                 (1) | Train Loss: 1.2939 | Train Acc: 0.7778
 Site-RealWorld                 (4) | Train Loss: 1.3189 | Train Acc: 0.7143
 Site-RealWorld                 (4) | Train Loss: 1.4706 | Train Acc: 0.6818
 Site-RealWorld                 (1) | Train Loss: 1.2813 | Train Acc: 0.7188
 Site-RealWorld                 (4) | Train Loss: 1.2591 | Train Acc: 0.8776
 Site-webcam                    (5) | Train Loss: 1.1361 | Train Acc: 0.9333
 Site-webcam                    (5) | Train Loss: 1.2484 | Train Acc: 0.8462
 Site-webcam                    (5) | Train Loss: 1.4142 | Train Acc: 0.7111
 Site-Clipart                   (4) | Train Loss: 1.5154 | Train Acc: 0.5789
 Site-Clipart                   (0) | Train Loss: 1.4778 | Train Acc: 0.6410
 Site-dslr                      (2) | Train Loss: 1.3466 | Train Acc: 0.7500
 Site-Product                   (1) | Train Loss: 1.3020 | Train Acc: 0.7407
Average Train Accuracy: 0.7330
 Site-amazon                    (1) | Val  Loss: 1.2435 | Val  Acc: 0.8000
 Site-amazon                    (1) | Val  Loss: 1.3556 | Val  Acc: 0.5714
 Site-amazon                    (6) | Val  Loss: 1.0675 | Val  Acc: 0.8889
 Site-amazon                    (1) | Val  Loss: 1.0898 | Val  Acc: 0.9091
 Site-amazon                    (1) | Val  Loss: 1.0900 | Val  Acc: 0.8667
 Site-amazon                    (1) | Val  Loss: 1.2647 | Val  Acc: 0.7895
 Site-amazon                    (1) | Val  Loss: 1.2747 | Val  Acc: 0.8000
 Site-amazon                    (1) | Val  Loss: 1.1280 | Val  Acc: 0.8438
 Site-amazon                    (1) | Val  Loss: 1.1211 | Val  Acc: 0.8333
 Site-amazon                    (1) | Val  Loss: 1.2482 | Val  Acc: 0.7963
 Site-Art                       (3) | Val  Loss: 1.8547 | Val  Acc: 0.4000
 Site-Art                       (0) | Val  Loss: 1.4474 | Val  Acc: 0.7143
 Site-Art                       (4) | Val  Loss: 1.2900 | Val  Acc: 0.9000
 Site-Art                       (0) | Val  Loss: 1.7083 | Val  Acc: 0.5000
 Site-Art                       (0) | Val  Loss: 1.7257 | Val  Acc: 0.4500
 Site-Art                       (5) | Val  Loss: 1.4001 | Val  Acc: 0.7143
 Site-Art                       (0) | Val  Loss: 1.5484 | Val  Acc: 0.6053
 Site-RealWorld                 (1) | Val  Loss: 1.3203 | Val  Acc: 0.8333
 Site-RealWorld                 (4) | Val  Loss: 1.0379 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 1.2750 | Val  Acc: 0.7857
 Site-RealWorld                 (1) | Val  Loss: 1.3398 | Val  Acc: 0.6667
 Site-RealWorld                 (4) | Val  Loss: 1.2728 | Val  Acc: 0.7500
 Site-webcam                    (5) | Val  Loss: 1.5488 | Val  Acc: 0.7000
 Site-webcam                    (5) | Val  Loss: 1.3203 | Val  Acc: 0.7059
 Site-webcam                    (5) | Val  Loss: 1.4724 | Val  Acc: 0.6333
 Site-Clipart                   (4) | Val  Loss: 1.3557 | Val  Acc: 0.7692
 Site-Clipart                   (0) | Val  Loss: 1.4222 | Val  Acc: 0.7692
 Site-dslr                      (2) | Val  Loss: 1.3638 | Val  Acc: 0.7692
 Site-Product                   (1) | Val  Loss: 1.1078 | Val  Acc: 0.8889
Average Valid Accuracy: 0.7467
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8000
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.5714
 Best site-amazon                   (6)  | Epoch:9 | Val Acc: 0.8889
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.9091
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8667
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.7895
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8000
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8438
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8333
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.7963
 Best site-Art                      (3)  | Epoch:9 | Val Acc: 0.4000
 Best site-Art                      (0)  | Epoch:9 | Val Acc: 0.7143
 Best site-Art                      (4)  | Epoch:9 | Val Acc: 0.9000
 Best site-Art                      (0)  | Epoch:9 | Val Acc: 0.5000
 Best site-Art                      (0)  | Epoch:9 | Val Acc: 0.4500
 Best site-Art                      (5)  | Epoch:9 | Val Acc: 0.7143
 Best site-Art                      (0)  | Epoch:9 | Val Acc: 0.6053
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.8333
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 0.7857
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.6667
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 0.7500
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.7000
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.7059
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.6333
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.7692
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.7692
 Best site-dslr                     (2)  | Epoch:9 | Val Acc: 0.7692
 Best site-Product                  (1)  | Epoch:9 | Val Acc: 0.8889
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
===2023-08-05 13:35:25===
===2023-08-05 13:35:41===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[8,10,13,17,22,29,37,48,63,81,8,11,16,22,30,42,58,9,14,22,32,49,15,26,45,19,39,40,27,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[555,317,215,146,99,67,45,]
domain number = 7
Loading snapshots...
 Test site-amazon                    (1)| Epoch:9 | Test Acc: 0.8306
 Test site-Art                       (3)| Epoch:9 | Test Acc: 0.6831
 Test site-RealWorld                 (1)| Epoch:9 | Test Acc: 0.8206
 Test site-webcam                    (5)| Epoch:9 | Test Acc: 0.7722
 Test site-Clipart                   (4)| Epoch:9 | Test Acc: 0.6576
 Test site-dslr                      (2)| Epoch:9 | Test Acc: 0.7551
 Test site-Product                   (1)| Epoch:9 | Test Acc: 0.8388
amazon: 0.8306, Art: 0.6831, RealWorld: 0.8206, webcam: 0.7722, Clipart: 0.6576, dslr: 0.7551, Product: 0.8388, 
Average Test Accuracy(group): 0.7654, Average Test Accuracy(individual): 0.7730,
domain std=0.0668, cluster std=0.0566, individual std=0.0676, 
===2023-08-05 16:30:13===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 11, 11, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-RealWorld                 (5) | Train Loss: 2.8992 | Train Acc: 0.2857
 Site-RealWorld                 (1) | Train Loss: 2.8988 | Train Acc: 0.0556
 Site-RealWorld                 (1) | Train Loss: 2.8687 | Train Acc: 0.0833
 Site-RealWorld                 (1) | Train Loss: 2.9569 | Train Acc: 0.0323
 Site-RealWorld                 (1) | Train Loss: 2.8883 | Train Acc: 0.0750
 Site-RealWorld                 (1) | Train Loss: 2.9163 | Train Acc: 0.0980
 Site-RealWorld                 (1) | Train Loss: 2.7837 | Train Acc: 0.1940
 Site-RealWorld                 (1) | Train Loss: 2.8318 | Train Acc: 0.1279
 Site-RealWorld                 (1) | Train Loss: 2.8529 | Train Acc: 0.1441
 Site-RealWorld                 (1) | Train Loss: 2.8352 | Train Acc: 0.1528
 Site-Product                   (4) | Train Loss: 2.7465 | Train Acc: 0.1765
 Site-Product                   (2) | Train Loss: 2.9005 | Train Acc: 0.1250
 Site-Product                   (2) | Train Loss: 2.8789 | Train Acc: 0.1818
 Site-Product                   (2) | Train Loss: 2.8545 | Train Acc: 0.1304
 Site-Product                   (2) | Train Loss: 2.8829 | Train Acc: 0.1406
 Site-Product                   (2) | Train Loss: 2.8390 | Train Acc: 0.1910
 Site-Product                   (2) | Train Loss: 2.8482 | Train Acc: 0.1129
 Site-amazon                    (2) | Train Loss: 2.8891 | Train Acc: 0.2000
 Site-amazon                    (2) | Train Loss: 2.7679 | Train Acc: 0.1613
 Site-amazon                    (2) | Train Loss: 2.8225 | Train Acc: 0.1522
 Site-amazon                    (2) | Train Loss: 2.8317 | Train Acc: 0.1304
 Site-amazon                    (2) | Train Loss: 2.9263 | Train Acc: 0.1154
 Site-webcam                    (6) | Train Loss: 2.9604 | Train Acc: 0.0625
 Site-webcam                    (0) | Train Loss: 2.9400 | Train Acc: 0.0536
 Site-webcam                    (0) | Train Loss: 2.8635 | Train Acc: 0.0928
 Site-Art                       (1) | Train Loss: 3.0560 | Train Acc: 0.0952
 Site-Art                       (1) | Train Loss: 2.9637 | Train Acc: 0.0476
 Site-Clipart                   (3) | Train Loss: 2.9723 | Train Acc: 0.0706
 Site-dslr                      (6) | Train Loss: 2.8284 | Train Acc: 0.1724
Average Train Accuracy: 0.1262
 Site-RealWorld                 (5) | Val  Loss: 2.7953 | Val  Acc: 0.1111
 Site-RealWorld                 (1) | Val  Loss: 2.8530 | Val  Acc: 0.1667
 Site-RealWorld                 (1) | Val  Loss: 2.8941 | Val  Acc: 0.0625
 Site-RealWorld                 (1) | Val  Loss: 2.9776 | Val  Acc: 0.0500
 Site-RealWorld                 (1) | Val  Loss: 3.0144 | Val  Acc: 0.0385
 Site-RealWorld                 (1) | Val  Loss: 2.8208 | Val  Acc: 0.1176
 Site-RealWorld                 (1) | Val  Loss: 2.8589 | Val  Acc: 0.0682
 Site-RealWorld                 (1) | Val  Loss: 2.8541 | Val  Acc: 0.1053
 Site-RealWorld                 (1) | Val  Loss: 2.9081 | Val  Acc: 0.1757
 Site-RealWorld                 (1) | Val  Loss: 2.9040 | Val  Acc: 0.1354
 Site-Product                   (4) | Val  Loss: 2.9583 | Val  Acc: 0.0000
 Site-Product                   (2) | Val  Loss: 2.8212 | Val  Acc: 0.1875
 Site-Product                   (2) | Val  Loss: 2.8174 | Val  Acc: 0.2727
 Site-Product                   (2) | Val  Loss: 2.7564 | Val  Acc: 0.1935
 Site-Product                   (2) | Val  Loss: 2.8696 | Val  Acc: 0.1628
 Site-Product                   (2) | Val  Loss: 2.9174 | Val  Acc: 0.1864
 Site-Product                   (2) | Val  Loss: 2.8959 | Val  Acc: 0.1098
 Site-amazon                    (2) | Val  Loss: 2.8827 | Val  Acc: 0.0769
 Site-amazon                    (2) | Val  Loss: 2.8880 | Val  Acc: 0.1500
 Site-amazon                    (2) | Val  Loss: 2.9187 | Val  Acc: 0.1290
 Site-amazon                    (2) | Val  Loss: 2.7964 | Val  Acc: 0.1739
 Site-amazon                    (2) | Val  Loss: 2.9890 | Val  Acc: 0.0870
 Site-webcam                    (6) | Val  Loss: 2.8282 | Val  Acc: 0.1905
 Site-webcam                    (0) | Val  Loss: 2.8977 | Val  Acc: 0.1081
 Site-webcam                    (0) | Val  Loss: 2.8875 | Val  Acc: 0.0625
 Site-Art                       (1) | Val  Loss: 2.9505 | Val  Acc: 0.1429
 Site-Art                       (1) | Val  Loss: 2.9654 | Val  Acc: 0.0893
 Site-Clipart                   (3) | Val  Loss: 2.8789 | Val  Acc: 0.1404
 Site-dslr                      (6) | Val  Loss: 2.8643 | Val  Acc: 0.1579
Average Valid Accuracy: 0.1259
 Best site-RealWorld                (5)  | Epoch:0 | Val Acc: 0.1111
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1667
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0625
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0500
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0385
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1176
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0682
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1053
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1757
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1354
 Best site-Product                  (4)  | Epoch:0 | Val Acc: 0.0000
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1875
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.2727
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1935
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1628
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1864
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1098
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.0769
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1500
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1290
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1739
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.0870
 Best site-webcam                   (6)  | Epoch:0 | Val Acc: 0.1905
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.1081
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.0625
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.1429
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.0893
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.1404
 Best site-dslr                     (6)  | Epoch:0 | Val Acc: 0.1579
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
===2023-08-05 16:33:52===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
Loading snapshots...
===2023-08-05 23:37:51===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 11, 11, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-RealWorld                 (5) | Train Loss: 2.8992 | Train Acc: 0.2857
 Site-RealWorld                 (1) | Train Loss: 2.8988 | Train Acc: 0.0556
 Site-RealWorld                 (1) | Train Loss: 2.8687 | Train Acc: 0.0833
 Site-RealWorld                 (1) | Train Loss: 2.9569 | Train Acc: 0.0323
 Site-RealWorld                 (1) | Train Loss: 2.8883 | Train Acc: 0.0750
 Site-RealWorld                 (1) | Train Loss: 2.9163 | Train Acc: 0.0980
 Site-RealWorld                 (1) | Train Loss: 2.7837 | Train Acc: 0.1940
 Site-RealWorld                 (1) | Train Loss: 2.8318 | Train Acc: 0.1279
 Site-RealWorld                 (1) | Train Loss: 2.8529 | Train Acc: 0.1441
 Site-RealWorld                 (1) | Train Loss: 2.8352 | Train Acc: 0.1528
 Site-Product                   (4) | Train Loss: 2.7465 | Train Acc: 0.1765
 Site-Product                   (2) | Train Loss: 2.9005 | Train Acc: 0.1250
 Site-Product                   (2) | Train Loss: 2.8789 | Train Acc: 0.1818
 Site-Product                   (2) | Train Loss: 2.8545 | Train Acc: 0.1304
 Site-Product                   (2) | Train Loss: 2.8829 | Train Acc: 0.1406
 Site-Product                   (2) | Train Loss: 2.8390 | Train Acc: 0.1910
 Site-Product                   (2) | Train Loss: 2.8482 | Train Acc: 0.1129
 Site-amazon                    (2) | Train Loss: 2.8891 | Train Acc: 0.2000
 Site-amazon                    (2) | Train Loss: 2.7679 | Train Acc: 0.1613
 Site-amazon                    (2) | Train Loss: 2.8225 | Train Acc: 0.1522
 Site-amazon                    (2) | Train Loss: 2.8317 | Train Acc: 0.1304
 Site-amazon                    (2) | Train Loss: 2.9263 | Train Acc: 0.1154
 Site-webcam                    (6) | Train Loss: 2.9604 | Train Acc: 0.0625
 Site-webcam                    (0) | Train Loss: 2.9400 | Train Acc: 0.0536
 Site-webcam                    (0) | Train Loss: 2.8635 | Train Acc: 0.0928
 Site-Art                       (1) | Train Loss: 3.0560 | Train Acc: 0.0952
 Site-Art                       (1) | Train Loss: 2.9637 | Train Acc: 0.0476
 Site-Clipart                   (3) | Train Loss: 2.9723 | Train Acc: 0.0706
 Site-dslr                      (6) | Train Loss: 2.8284 | Train Acc: 0.1724
Average Train Accuracy: 0.1262
 Site-RealWorld                 (5) | Val  Loss: 2.7953 | Val  Acc: 0.1111
 Site-RealWorld                 (1) | Val  Loss: 2.8530 | Val  Acc: 0.1667
 Site-RealWorld                 (1) | Val  Loss: 2.8941 | Val  Acc: 0.0625
 Site-RealWorld                 (1) | Val  Loss: 2.9776 | Val  Acc: 0.0500
 Site-RealWorld                 (1) | Val  Loss: 3.0144 | Val  Acc: 0.0385
 Site-RealWorld                 (1) | Val  Loss: 2.8208 | Val  Acc: 0.1176
 Site-RealWorld                 (1) | Val  Loss: 2.8589 | Val  Acc: 0.0682
 Site-RealWorld                 (1) | Val  Loss: 2.8541 | Val  Acc: 0.1053
 Site-RealWorld                 (1) | Val  Loss: 2.9081 | Val  Acc: 0.1757
 Site-RealWorld                 (1) | Val  Loss: 2.9040 | Val  Acc: 0.1354
 Site-Product                   (4) | Val  Loss: 2.9583 | Val  Acc: 0.0000
 Site-Product                   (2) | Val  Loss: 2.8212 | Val  Acc: 0.1875
 Site-Product                   (2) | Val  Loss: 2.8174 | Val  Acc: 0.2727
 Site-Product                   (2) | Val  Loss: 2.7564 | Val  Acc: 0.1935
 Site-Product                   (2) | Val  Loss: 2.8696 | Val  Acc: 0.1628
 Site-Product                   (2) | Val  Loss: 2.9174 | Val  Acc: 0.1864
 Site-Product                   (2) | Val  Loss: 2.8959 | Val  Acc: 0.1098
 Site-amazon                    (2) | Val  Loss: 2.8827 | Val  Acc: 0.0769
 Site-amazon                    (2) | Val  Loss: 2.8880 | Val  Acc: 0.1500
 Site-amazon                    (2) | Val  Loss: 2.9187 | Val  Acc: 0.1290
 Site-amazon                    (2) | Val  Loss: 2.7964 | Val  Acc: 0.1739
 Site-amazon                    (2) | Val  Loss: 2.9890 | Val  Acc: 0.0870
 Site-webcam                    (6) | Val  Loss: 2.8282 | Val  Acc: 0.1905
 Site-webcam                    (0) | Val  Loss: 2.8977 | Val  Acc: 0.1081
 Site-webcam                    (0) | Val  Loss: 2.8875 | Val  Acc: 0.0625
 Site-Art                       (1) | Val  Loss: 2.9505 | Val  Acc: 0.1429
 Site-Art                       (1) | Val  Loss: 2.9654 | Val  Acc: 0.0893
 Site-Clipart                   (3) | Val  Loss: 2.8789 | Val  Acc: 0.1404
 Site-dslr                      (6) | Val  Loss: 2.8643 | Val  Acc: 0.1579
Average Valid Accuracy: 0.1259
 Best site-RealWorld                (5)  | Epoch:0 | Val Acc: 0.1111
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1667
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0625
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0500
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0385
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1176
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0682
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1053
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1757
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1354
 Best site-Product                  (4)  | Epoch:0 | Val Acc: 0.0000
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1875
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.2727
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1935
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1628
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1864
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1098
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.0769
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1500
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1290
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1739
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.0870
 Best site-webcam                   (6)  | Epoch:0 | Val Acc: 0.1905
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.1081
 Best site-webcam                   (0)  | Epoch:0 | Val Acc: 0.0625
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.1429
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.0893
 Best site-Clipart                  (3)  | Epoch:0 | Val Acc: 0.1404
 Best site-dslr                     (6)  | Epoch:0 | Val Acc: 0.1579
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 12, 8, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-RealWorld                 (0) | Train Loss: 2.7775 | Train Acc: 0.2857
 Site-RealWorld                 (4) | Train Loss: 2.8168 | Train Acc: 0.1111
 Site-RealWorld                 (2) | Train Loss: 2.6913 | Train Acc: 0.3333
 Site-RealWorld                 (2) | Train Loss: 2.8158 | Train Acc: 0.1613
 Site-RealWorld                 (0) | Train Loss: 2.8011 | Train Acc: 0.2500
 Site-RealWorld                 (2) | Train Loss: 2.7655 | Train Acc: 0.2353
 Site-RealWorld                 (2) | Train Loss: 2.6851 | Train Acc: 0.2537
 Site-RealWorld                 (2) | Train Loss: 2.7135 | Train Acc: 0.2674
 Site-RealWorld                 (2) | Train Loss: 2.7262 | Train Acc: 0.2793
 Site-RealWorld                 (2) | Train Loss: 2.6874 | Train Acc: 0.2639
 Site-Product                   (5) | Train Loss: 2.6613 | Train Acc: 0.2353
 Site-Product                   (1) | Train Loss: 2.8204 | Train Acc: 0.2083
 Site-Product                   (1) | Train Loss: 2.7502 | Train Acc: 0.1818
 Site-Product                   (1) | Train Loss: 2.7151 | Train Acc: 0.2609
 Site-Product                   (1) | Train Loss: 2.7211 | Train Acc: 0.2031
 Site-Product                   (1) | Train Loss: 2.6820 | Train Acc: 0.3146
 Site-Product                   (1) | Train Loss: 2.7314 | Train Acc: 0.2177
 Site-amazon                    (1) | Train Loss: 2.7610 | Train Acc: 0.2000
 Site-amazon                    (1) | Train Loss: 2.6668 | Train Acc: 0.3226
 Site-amazon                    (1) | Train Loss: 2.6740 | Train Acc: 0.3043
 Site-amazon                    (1) | Train Loss: 2.7453 | Train Acc: 0.2464
 Site-amazon                    (1) | Train Loss: 2.7552 | Train Acc: 0.2404
 Site-webcam                    (6) | Train Loss: 2.8357 | Train Acc: 0.1250
 Site-webcam                    (3) | Train Loss: 2.8155 | Train Acc: 0.1429
 Site-webcam                    (3) | Train Loss: 2.7787 | Train Acc: 0.2784
 Site-Art                       (0) | Train Loss: 2.9735 | Train Acc: 0.1190
 Site-Art                       (2) | Train Loss: 2.8452 | Train Acc: 0.1786
 Site-Clipart                   (1) | Train Loss: 2.8348 | Train Acc: 0.2353
 Site-dslr                      (6) | Train Loss: 2.6892 | Train Acc: 0.3276
Average Train Accuracy: 0.2339
 Site-RealWorld                 (0) | Val  Loss: 2.6543 | Val  Acc: 0.2222
 Site-RealWorld                 (4) | Val  Loss: 2.6792 | Val  Acc: 0.2500
 Site-RealWorld                 (2) | Val  Loss: 2.7400 | Val  Acc: 0.3125
 Site-RealWorld                 (2) | Val  Loss: 2.8650 | Val  Acc: 0.1000
 Site-RealWorld                 (0) | Val  Loss: 2.8241 | Val  Acc: 0.1923
 Site-RealWorld                 (2) | Val  Loss: 2.7134 | Val  Acc: 0.1765
 Site-RealWorld                 (2) | Val  Loss: 2.6761 | Val  Acc: 0.2727
 Site-RealWorld                 (2) | Val  Loss: 2.7406 | Val  Acc: 0.2807
 Site-RealWorld                 (2) | Val  Loss: 2.8007 | Val  Acc: 0.2973
 Site-RealWorld                 (2) | Val  Loss: 2.7622 | Val  Acc: 0.2500
 Site-Product                   (5) | Val  Loss: 2.7515 | Val  Acc: 0.0909
 Site-Product                   (1) | Val  Loss: 2.7063 | Val  Acc: 0.3750
 Site-Product                   (1) | Val  Loss: 2.6524 | Val  Acc: 0.4091
 Site-Product                   (1) | Val  Loss: 2.6846 | Val  Acc: 0.2903
 Site-Product                   (1) | Val  Loss: 2.7175 | Val  Acc: 0.2558
 Site-Product                   (1) | Val  Loss: 2.7720 | Val  Acc: 0.2034
 Site-Product                   (1) | Val  Loss: 2.7141 | Val  Acc: 0.2805
 Site-amazon                    (1) | Val  Loss: 2.6881 | Val  Acc: 0.3846
 Site-amazon                    (1) | Val  Loss: 2.7974 | Val  Acc: 0.2000
 Site-amazon                    (1) | Val  Loss: 2.7880 | Val  Acc: 0.2258
 Site-amazon                    (1) | Val  Loss: 2.7661 | Val  Acc: 0.1957
 Site-amazon                    (1) | Val  Loss: 2.9734 | Val  Acc: 0.2029
 Site-webcam                    (6) | Val  Loss: 2.8378 | Val  Acc: 0.1905
 Site-webcam                    (3) | Val  Loss: 2.7586 | Val  Acc: 0.2162
 Site-webcam                    (3) | Val  Loss: 2.7396 | Val  Acc: 0.2500
 Site-Art                       (0) | Val  Loss: 2.7821 | Val  Acc: 0.2500
 Site-Art                       (2) | Val  Loss: 2.8405 | Val  Acc: 0.1607
 Site-Clipart                   (1) | Val  Loss: 2.7849 | Val  Acc: 0.2281
 Site-dslr                      (6) | Val  Loss: 2.7116 | Val  Acc: 0.3158
Average Valid Accuracy: 0.2441
 Best site-RealWorld                (0)  | Epoch:1 | Val Acc: 0.2222
 Best site-RealWorld                (4)  | Epoch:1 | Val Acc: 0.2500
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.3125
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.1000
 Best site-RealWorld                (0)  | Epoch:1 | Val Acc: 0.1923
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.1765
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.2727
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.2807
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.2973
 Best site-RealWorld                (2)  | Epoch:1 | Val Acc: 0.2500
 Best site-Product                  (5)  | Epoch:1 | Val Acc: 0.0909
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.4091
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2903
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2558
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2034
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2805
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.2000
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.2258
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.1957
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.2029
 Best site-webcam                   (6)  | Epoch:1 | Val Acc: 0.1905
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.2162
 Best site-webcam                   (3)  | Epoch:1 | Val Acc: 0.2500
 Best site-Art                      (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-Art                      (2)  | Epoch:1 | Val Acc: 0.1607
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.2281
 Best site-dslr                     (6)  | Epoch:1 | Val Acc: 0.3158
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 2, 4, 1, 9, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-RealWorld                 (1) | Train Loss: 2.5319 | Train Acc: 0.4286
 Site-RealWorld                 (4) | Train Loss: 2.6176 | Train Acc: 0.3889
 Site-RealWorld                 (4) | Train Loss: 2.5319 | Train Acc: 0.4583
 Site-RealWorld                 (4) | Train Loss: 2.6534 | Train Acc: 0.4194
 Site-RealWorld                 (4) | Train Loss: 2.6201 | Train Acc: 0.3250
 Site-RealWorld                 (1) | Train Loss: 2.6493 | Train Acc: 0.4118
 Site-RealWorld                 (4) | Train Loss: 2.6127 | Train Acc: 0.3731
 Site-RealWorld                 (4) | Train Loss: 2.5476 | Train Acc: 0.3837
 Site-RealWorld                 (4) | Train Loss: 2.5552 | Train Acc: 0.3964
 Site-RealWorld                 (4) | Train Loss: 2.5332 | Train Acc: 0.4097
 Site-Product                   (3) | Train Loss: 2.5293 | Train Acc: 0.4118
 Site-Product                   (0) | Train Loss: 2.7255 | Train Acc: 0.2083
 Site-Product                   (0) | Train Loss: 2.6356 | Train Acc: 0.2424
 Site-Product                   (0) | Train Loss: 2.6084 | Train Acc: 0.2826
 Site-Product                   (0) | Train Loss: 2.5508 | Train Acc: 0.3438
 Site-Product                   (0) | Train Loss: 2.5298 | Train Acc: 0.4045
 Site-Product                   (0) | Train Loss: 2.6080 | Train Acc: 0.3548
 Site-amazon                    (0) | Train Loss: 2.6225 | Train Acc: 0.5000
 Site-amazon                    (0) | Train Loss: 2.5130 | Train Acc: 0.5806
 Site-amazon                    (6) | Train Loss: 2.5188 | Train Acc: 0.4348
 Site-amazon                    (0) | Train Loss: 2.5748 | Train Acc: 0.3768
 Site-amazon                    (6) | Train Loss: 2.6618 | Train Acc: 0.3173
 Site-webcam                    (2) | Train Loss: 2.7451 | Train Acc: 0.1562
 Site-webcam                    (2) | Train Loss: 2.6739 | Train Acc: 0.3571
 Site-webcam                    (2) | Train Loss: 2.5755 | Train Acc: 0.3505
 Site-Art                       (5) | Train Loss: 2.9157 | Train Acc: 0.0952
 Site-Art                       (4) | Train Loss: 2.7146 | Train Acc: 0.2143
 Site-Clipart                   (0) | Train Loss: 2.7074 | Train Acc: 0.2941
 Site-dslr                      (2) | Train Loss: 2.5966 | Train Acc: 0.3621
Average Train Accuracy: 0.3546
 Site-RealWorld                 (1) | Val  Loss: 2.5055 | Val  Acc: 0.5556
 Site-RealWorld                 (4) | Val  Loss: 2.4793 | Val  Acc: 0.5000
 Site-RealWorld                 (4) | Val  Loss: 2.4623 | Val  Acc: 0.5000
 Site-RealWorld                 (4) | Val  Loss: 2.6909 | Val  Acc: 0.3000
 Site-RealWorld                 (4) | Val  Loss: 2.6299 | Val  Acc: 0.3077
 Site-RealWorld                 (1) | Val  Loss: 2.5603 | Val  Acc: 0.4412
 Site-RealWorld                 (4) | Val  Loss: 2.5390 | Val  Acc: 0.3409
 Site-RealWorld                 (4) | Val  Loss: 2.5655 | Val  Acc: 0.3684
 Site-RealWorld                 (4) | Val  Loss: 2.7103 | Val  Acc: 0.3243
 Site-RealWorld                 (4) | Val  Loss: 2.6485 | Val  Acc: 0.3750
 Site-Product                   (3) | Val  Loss: 2.6901 | Val  Acc: 0.1818
 Site-Product                   (0) | Val  Loss: 2.5696 | Val  Acc: 0.4375
 Site-Product                   (0) | Val  Loss: 2.4784 | Val  Acc: 0.5000
 Site-Product                   (0) | Val  Loss: 2.4443 | Val  Acc: 0.5161
 Site-Product                   (0) | Val  Loss: 2.5508 | Val  Acc: 0.4186
 Site-Product                   (0) | Val  Loss: 2.5893 | Val  Acc: 0.2712
 Site-Product                   (0) | Val  Loss: 2.5851 | Val  Acc: 0.3780
 Site-amazon                    (0) | Val  Loss: 2.6156 | Val  Acc: 0.3077
 Site-amazon                    (0) | Val  Loss: 2.6695 | Val  Acc: 0.4000
 Site-amazon                    (6) | Val  Loss: 2.6545 | Val  Acc: 0.4194
 Site-amazon                    (0) | Val  Loss: 2.5814 | Val  Acc: 0.3261
 Site-amazon                    (6) | Val  Loss: 2.6268 | Val  Acc: 0.3768
 Site-webcam                    (2) | Val  Loss: 2.6126 | Val  Acc: 0.3333
 Site-webcam                    (2) | Val  Loss: 2.6072 | Val  Acc: 0.3243
 Site-webcam                    (2) | Val  Loss: 2.6214 | Val  Acc: 0.3750
 Site-Art                       (5) | Val  Loss: 2.6597 | Val  Acc: 0.3214
 Site-Art                       (4) | Val  Loss: 2.7068 | Val  Acc: 0.2321
 Site-Clipart                   (0) | Val  Loss: 2.6852 | Val  Acc: 0.3509
 Site-dslr                      (2) | Val  Loss: 2.6037 | Val  Acc: 0.3421
Average Valid Accuracy: 0.3733
 Best site-RealWorld                (1)  | Epoch:2 | Val Acc: 0.5556
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5000
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5000
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3000
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3077
 Best site-RealWorld                (1)  | Epoch:2 | Val Acc: 0.4412
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3409
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3684
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3243
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.3750
 Best site-Product                  (3)  | Epoch:2 | Val Acc: 0.1818
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.4375
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.5161
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.4186
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.2712
 Best site-Product                  (0)  | Epoch:2 | Val Acc: 0.3780
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.3077
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.4000
 Best site-amazon                   (6)  | Epoch:2 | Val Acc: 0.4194
 Best site-amazon                   (0)  | Epoch:2 | Val Acc: 0.3261
 Best site-amazon                   (6)  | Epoch:2 | Val Acc: 0.3768
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.3333
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.3243
 Best site-webcam                   (2)  | Epoch:2 | Val Acc: 0.3750
 Best site-Art                      (5)  | Epoch:2 | Val Acc: 0.3214
 Best site-Art                      (4)  | Epoch:2 | Val Acc: 0.2321
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.3509
 Best site-dslr                     (2)  | Epoch:2 | Val Acc: 0.3421
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 10, 2, 1, 1, 4, 10, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-RealWorld                 (1) | Train Loss: 2.4331 | Train Acc: 0.5000
 Site-RealWorld                 (1) | Train Loss: 2.4826 | Train Acc: 0.4444
 Site-RealWorld                 (1) | Train Loss: 2.3611 | Train Acc: 0.5000
 Site-RealWorld                 (2) | Train Loss: 2.5373 | Train Acc: 0.3871
 Site-RealWorld                 (1) | Train Loss: 2.4903 | Train Acc: 0.3500
 Site-RealWorld                 (1) | Train Loss: 2.4575 | Train Acc: 0.5098
 Site-RealWorld                 (2) | Train Loss: 2.6281 | Train Acc: 0.3731
 Site-RealWorld                 (1) | Train Loss: 2.4239 | Train Acc: 0.5000
 Site-RealWorld                 (1) | Train Loss: 2.3919 | Train Acc: 0.5495
 Site-RealWorld                 (1) | Train Loss: 2.4041 | Train Acc: 0.5347
 Site-Product                   (6) | Train Loss: 2.3502 | Train Acc: 0.5294
 Site-Product                   (6) | Train Loss: 2.5459 | Train Acc: 0.3750
 Site-Product                   (6) | Train Loss: 2.5946 | Train Acc: 0.3030
 Site-Product                   (6) | Train Loss: 2.4521 | Train Acc: 0.5000
 Site-Product                   (3) | Train Loss: 2.4533 | Train Acc: 0.4531
 Site-Product                   (6) | Train Loss: 2.3836 | Train Acc: 0.5393
 Site-Product                   (6) | Train Loss: 2.4797 | Train Acc: 0.3952
 Site-amazon                    (0) | Train Loss: 2.4802 | Train Acc: 0.5000
 Site-amazon                    (6) | Train Loss: 2.3577 | Train Acc: 0.6129
 Site-amazon                    (6) | Train Loss: 2.3133 | Train Acc: 0.6304
 Site-amazon                    (6) | Train Loss: 2.4285 | Train Acc: 0.5507
 Site-amazon                    (6) | Train Loss: 2.5144 | Train Acc: 0.4519
 Site-webcam                    (5) | Train Loss: 2.6407 | Train Acc: 0.2812
 Site-webcam                    (5) | Train Loss: 2.5069 | Train Acc: 0.4643
 Site-webcam                    (5) | Train Loss: 2.4125 | Train Acc: 0.4330
 Site-Art                       (1) | Train Loss: 2.7619 | Train Acc: 0.1905
 Site-Art                       (1) | Train Loss: 2.4995 | Train Acc: 0.2857
 Site-Clipart                   (4) | Train Loss: 2.6031 | Train Acc: 0.3059
 Site-dslr                      (5) | Train Loss: 2.4318 | Train Acc: 0.3966
Average Train Accuracy: 0.4430
 Site-RealWorld                 (1) | Val  Loss: 2.3482 | Val  Acc: 0.5556
 Site-RealWorld                 (1) | Val  Loss: 2.3606 | Val  Acc: 0.5833
 Site-RealWorld                 (1) | Val  Loss: 2.2819 | Val  Acc: 0.6875
 Site-RealWorld                 (2) | Val  Loss: 2.5112 | Val  Acc: 0.5000
 Site-RealWorld                 (1) | Val  Loss: 2.4989 | Val  Acc: 0.4231
 Site-RealWorld                 (1) | Val  Loss: 2.3989 | Val  Acc: 0.5588
 Site-RealWorld                 (2) | Val  Loss: 2.3987 | Val  Acc: 0.4545
 Site-RealWorld                 (1) | Val  Loss: 2.4027 | Val  Acc: 0.4737
 Site-RealWorld                 (1) | Val  Loss: 2.5416 | Val  Acc: 0.3649
 Site-RealWorld                 (1) | Val  Loss: 2.4694 | Val  Acc: 0.5208
 Site-Product                   (6) | Val  Loss: 2.5448 | Val  Acc: 0.2727
 Site-Product                   (6) | Val  Loss: 2.3719 | Val  Acc: 0.5000
 Site-Product                   (6) | Val  Loss: 2.3524 | Val  Acc: 0.5909
 Site-Product                   (6) | Val  Loss: 2.2321 | Val  Acc: 0.6452
 Site-Product                   (3) | Val  Loss: 2.4621 | Val  Acc: 0.3953
 Site-Product                   (6) | Val  Loss: 2.4457 | Val  Acc: 0.4576
 Site-Product                   (6) | Val  Loss: 2.3970 | Val  Acc: 0.5244
 Site-amazon                    (0) | Val  Loss: 2.3897 | Val  Acc: 0.5385
 Site-amazon                    (6) | Val  Loss: 2.5488 | Val  Acc: 0.3000
 Site-amazon                    (6) | Val  Loss: 2.5125 | Val  Acc: 0.4516
 Site-amazon                    (6) | Val  Loss: 2.4308 | Val  Acc: 0.4783
 Site-amazon                    (6) | Val  Loss: 2.4709 | Val  Acc: 0.5072
 Site-webcam                    (5) | Val  Loss: 2.4567 | Val  Acc: 0.2857
 Site-webcam                    (5) | Val  Loss: 2.5499 | Val  Acc: 0.3784
 Site-webcam                    (5) | Val  Loss: 2.5124 | Val  Acc: 0.5000
 Site-Art                       (1) | Val  Loss: 2.5496 | Val  Acc: 0.2857
 Site-Art                       (1) | Val  Loss: 2.6184 | Val  Acc: 0.3214
 Site-Clipart                   (4) | Val  Loss: 2.5559 | Val  Acc: 0.4386
 Site-dslr                      (5) | Val  Loss: 2.3687 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4653
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.5556
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.5833
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.6875
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.4231
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.5588
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.4545
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.4737
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.3649
 Best site-RealWorld                (1)  | Epoch:3 | Val Acc: 0.5208
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.2727
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.5000
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.5909
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.6452
 Best site-Product                  (3)  | Epoch:3 | Val Acc: 0.3953
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.4576
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.5244
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.5385
 Best site-amazon                   (6)  | Epoch:3 | Val Acc: 0.3000
 Best site-amazon                   (6)  | Epoch:3 | Val Acc: 0.4516
 Best site-amazon                   (6)  | Epoch:3 | Val Acc: 0.4783
 Best site-amazon                   (6)  | Epoch:3 | Val Acc: 0.5072
 Best site-webcam                   (5)  | Epoch:3 | Val Acc: 0.2857
 Best site-webcam                   (5)  | Epoch:3 | Val Acc: 0.3784
 Best site-webcam                   (5)  | Epoch:3 | Val Acc: 0.5000
 Best site-Art                      (1)  | Epoch:3 | Val Acc: 0.2857
 Best site-Art                      (1)  | Epoch:3 | Val Acc: 0.3214
 Best site-Clipart                  (4)  | Epoch:3 | Val Acc: 0.4386
 Best site-dslr                     (5)  | Epoch:3 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[4, 4, 12, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-RealWorld                 (3) | Train Loss: 2.3367 | Train Acc: 0.4286
 Site-RealWorld                 (2) | Train Loss: 2.3497 | Train Acc: 0.5000
 Site-RealWorld                 (2) | Train Loss: 2.2393 | Train Acc: 0.6250
 Site-RealWorld                 (2) | Train Loss: 2.3724 | Train Acc: 0.5161
 Site-RealWorld                 (2) | Train Loss: 2.3112 | Train Acc: 0.5750
 Site-RealWorld                 (2) | Train Loss: 2.2794 | Train Acc: 0.6471
 Site-RealWorld                 (2) | Train Loss: 2.4347 | Train Acc: 0.5224
 Site-RealWorld                 (2) | Train Loss: 2.2005 | Train Acc: 0.6047
 Site-RealWorld                 (2) | Train Loss: 2.2306 | Train Acc: 0.6126
 Site-RealWorld                 (2) | Train Loss: 2.1867 | Train Acc: 0.6458
 Site-Product                   (4) | Train Loss: 2.2039 | Train Acc: 0.6471
 Site-Product                   (1) | Train Loss: 2.5043 | Train Acc: 0.2917
 Site-Product                   (5) | Train Loss: 2.4069 | Train Acc: 0.5455
 Site-Product                   (5) | Train Loss: 2.3201 | Train Acc: 0.5870
 Site-Product                   (1) | Train Loss: 2.2992 | Train Acc: 0.5000
 Site-Product                   (1) | Train Loss: 2.1602 | Train Acc: 0.6067
 Site-Product                   (1) | Train Loss: 2.3182 | Train Acc: 0.5323
 Site-amazon                    (4) | Train Loss: 2.3457 | Train Acc: 0.5500
 Site-amazon                    (4) | Train Loss: 2.1732 | Train Acc: 0.6774
 Site-amazon                    (6) | Train Loss: 2.2141 | Train Acc: 0.6957
 Site-amazon                    (4) | Train Loss: 2.3837 | Train Acc: 0.5362
 Site-amazon                    (4) | Train Loss: 2.3685 | Train Acc: 0.5385
 Site-webcam                    (0) | Train Loss: 2.4532 | Train Acc: 0.4375
 Site-webcam                    (0) | Train Loss: 2.3806 | Train Acc: 0.5536
 Site-webcam                    (0) | Train Loss: 2.2925 | Train Acc: 0.5155
 Site-Art                       (2) | Train Loss: 2.6265 | Train Acc: 0.2619
 Site-Art                       (2) | Train Loss: 2.3936 | Train Acc: 0.4048
 Site-Clipart                   (2) | Train Loss: 2.5148 | Train Acc: 0.3529
 Site-dslr                      (0) | Train Loss: 2.2029 | Train Acc: 0.6724
Average Train Accuracy: 0.5374
 Site-RealWorld                 (3) | Val  Loss: 2.0825 | Val  Acc: 0.8889
 Site-RealWorld                 (2) | Val  Loss: 2.1031 | Val  Acc: 0.7500
 Site-RealWorld                 (2) | Val  Loss: 2.0528 | Val  Acc: 0.8750
 Site-RealWorld                 (2) | Val  Loss: 2.3218 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 2.4376 | Val  Acc: 0.5385
 Site-RealWorld                 (2) | Val  Loss: 2.2862 | Val  Acc: 0.5882
 Site-RealWorld                 (2) | Val  Loss: 2.2348 | Val  Acc: 0.6364
 Site-RealWorld                 (2) | Val  Loss: 2.3012 | Val  Acc: 0.5088
 Site-RealWorld                 (2) | Val  Loss: 2.3790 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 2.3092 | Val  Acc: 0.6042
 Site-Product                   (4) | Val  Loss: 2.4225 | Val  Acc: 0.4545
 Site-Product                   (1) | Val  Loss: 2.2625 | Val  Acc: 0.6250
 Site-Product                   (5) | Val  Loss: 2.2035 | Val  Acc: 0.6818
 Site-Product                   (5) | Val  Loss: 2.0556 | Val  Acc: 0.7742
 Site-Product                   (1) | Val  Loss: 2.3167 | Val  Acc: 0.5581
 Site-Product                   (1) | Val  Loss: 2.3255 | Val  Acc: 0.5254
 Site-Product                   (1) | Val  Loss: 2.2652 | Val  Acc: 0.5610
 Site-amazon                    (4) | Val  Loss: 2.3269 | Val  Acc: 0.3846
 Site-amazon                    (4) | Val  Loss: 2.3880 | Val  Acc: 0.5000
 Site-amazon                    (6) | Val  Loss: 2.3746 | Val  Acc: 0.6129
 Site-amazon                    (4) | Val  Loss: 2.2541 | Val  Acc: 0.5870
 Site-amazon                    (4) | Val  Loss: 2.3651 | Val  Acc: 0.6232
 Site-webcam                    (0) | Val  Loss: 2.4162 | Val  Acc: 0.4286
 Site-webcam                    (0) | Val  Loss: 2.3472 | Val  Acc: 0.4595
 Site-webcam                    (0) | Val  Loss: 2.3583 | Val  Acc: 0.5469
 Site-Art                       (2) | Val  Loss: 2.3825 | Val  Acc: 0.4286
 Site-Art                       (2) | Val  Loss: 2.4647 | Val  Acc: 0.4464
 Site-Clipart                   (2) | Val  Loss: 2.3834 | Val  Acc: 0.5263
 Site-dslr                      (0) | Val  Loss: 2.1978 | Val  Acc: 0.5789
Average Valid Accuracy: 0.5756
 Best site-RealWorld                (3)  | Epoch:4 | Val Acc: 0.8889
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.7500
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.8750
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.5385
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.5882
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.6364
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.5088
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.6042
 Best site-Product                  (4)  | Epoch:4 | Val Acc: 0.4545
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.6250
 Best site-Product                  (5)  | Epoch:4 | Val Acc: 0.6818
 Best site-Product                  (5)  | Epoch:4 | Val Acc: 0.7742
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.5581
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.5254
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.5610
 Best site-amazon                   (4)  | Epoch:4 | Val Acc: 0.3846
 Best site-amazon                   (4)  | Epoch:4 | Val Acc: 0.5000
 Best site-amazon                   (6)  | Epoch:4 | Val Acc: 0.6129
 Best site-amazon                   (4)  | Epoch:4 | Val Acc: 0.5870
 Best site-amazon                   (4)  | Epoch:4 | Val Acc: 0.6232
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.4286
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.4595
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.5469
 Best site-Art                      (2)  | Epoch:4 | Val Acc: 0.4286
 Best site-Art                      (2)  | Epoch:4 | Val Acc: 0.4464
 Best site-Clipart                  (2)  | Epoch:4 | Val Acc: 0.5263
 Best site-dslr                     (0)  | Epoch:4 | Val Acc: 0.5789
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[9, 4, 1, 4, 4, 2, 5, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-RealWorld                 (0) | Train Loss: 2.1814 | Train Acc: 0.5000
 Site-RealWorld                 (0) | Train Loss: 2.1029 | Train Acc: 0.6111
 Site-RealWorld                 (0) | Train Loss: 2.0834 | Train Acc: 0.6667
 Site-RealWorld                 (0) | Train Loss: 2.1976 | Train Acc: 0.6774
 Site-RealWorld                 (3) | Train Loss: 2.1360 | Train Acc: 0.6750
 Site-RealWorld                 (3) | Train Loss: 2.1196 | Train Acc: 0.7647
 Site-RealWorld                 (0) | Train Loss: 2.2716 | Train Acc: 0.5224
 Site-RealWorld                 (0) | Train Loss: 2.0449 | Train Acc: 0.7093
 Site-RealWorld                 (0) | Train Loss: 2.0723 | Train Acc: 0.7027
 Site-RealWorld                 (0) | Train Loss: 2.0926 | Train Acc: 0.7708
 Site-Product                   (5) | Train Loss: 2.1191 | Train Acc: 0.7647
 Site-Product                   (6) | Train Loss: 2.3425 | Train Acc: 0.2917
 Site-Product                   (4) | Train Loss: 2.3269 | Train Acc: 0.6061
 Site-Product                   (4) | Train Loss: 2.1396 | Train Acc: 0.6522
 Site-Product                   (6) | Train Loss: 2.1522 | Train Acc: 0.5938
 Site-Product                   (4) | Train Loss: 2.0245 | Train Acc: 0.6854
 Site-Product                   (4) | Train Loss: 2.1807 | Train Acc: 0.5887
 Site-amazon                    (5) | Train Loss: 2.1508 | Train Acc: 0.7000
 Site-amazon                    (6) | Train Loss: 2.0486 | Train Acc: 0.7419
 Site-amazon                    (2) | Train Loss: 2.0668 | Train Acc: 0.7391
 Site-amazon                    (6) | Train Loss: 2.0852 | Train Acc: 0.6957
 Site-amazon                    (6) | Train Loss: 2.2377 | Train Acc: 0.5673
 Site-webcam                    (1) | Train Loss: 2.2990 | Train Acc: 0.4375
 Site-webcam                    (1) | Train Loss: 2.2266 | Train Acc: 0.6429
 Site-webcam                    (1) | Train Loss: 2.1042 | Train Acc: 0.6701
 Site-Art                       (3) | Train Loss: 2.5322 | Train Acc: 0.2857
 Site-Art                       (0) | Train Loss: 2.3331 | Train Acc: 0.4881
 Site-Clipart                   (3) | Train Loss: 2.3778 | Train Acc: 0.4353
 Site-dslr                      (1) | Train Loss: 2.0339 | Train Acc: 0.6897
Average Train Accuracy: 0.6164
 Site-RealWorld                 (0) | Val  Loss: 1.9029 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 1.8254 | Val  Acc: 0.7500
 Site-RealWorld                 (0) | Val  Loss: 1.9051 | Val  Acc: 0.8125
 Site-RealWorld                 (0) | Val  Loss: 2.2257 | Val  Acc: 0.6000
 Site-RealWorld                 (3) | Val  Loss: 2.3086 | Val  Acc: 0.5385
 Site-RealWorld                 (3) | Val  Loss: 2.0624 | Val  Acc: 0.7059
 Site-RealWorld                 (0) | Val  Loss: 2.0972 | Val  Acc: 0.6591
 Site-RealWorld                 (0) | Val  Loss: 2.1017 | Val  Acc: 0.6667
 Site-RealWorld                 (0) | Val  Loss: 2.2804 | Val  Acc: 0.5270
 Site-RealWorld                 (0) | Val  Loss: 2.1342 | Val  Acc: 0.6979
 Site-Product                   (5) | Val  Loss: 2.3136 | Val  Acc: 0.4545
 Site-Product                   (6) | Val  Loss: 2.0891 | Val  Acc: 0.6875
 Site-Product                   (4) | Val  Loss: 2.0186 | Val  Acc: 0.7273
 Site-Product                   (4) | Val  Loss: 1.8966 | Val  Acc: 0.8387
 Site-Product                   (6) | Val  Loss: 2.1485 | Val  Acc: 0.6744
 Site-Product                   (4) | Val  Loss: 2.1405 | Val  Acc: 0.6441
 Site-Product                   (4) | Val  Loss: 2.1107 | Val  Acc: 0.6707
 Site-amazon                    (5) | Val  Loss: 2.1040 | Val  Acc: 0.6154
 Site-amazon                    (6) | Val  Loss: 2.1572 | Val  Acc: 0.6000
 Site-amazon                    (2) | Val  Loss: 2.1453 | Val  Acc: 0.7097
 Site-amazon                    (6) | Val  Loss: 2.1171 | Val  Acc: 0.6957
 Site-amazon                    (6) | Val  Loss: 2.2596 | Val  Acc: 0.6522
 Site-webcam                    (1) | Val  Loss: 2.2660 | Val  Acc: 0.5238
 Site-webcam                    (1) | Val  Loss: 2.2223 | Val  Acc: 0.5676
 Site-webcam                    (1) | Val  Loss: 2.1479 | Val  Acc: 0.7344
 Site-Art                       (3) | Val  Loss: 2.2105 | Val  Acc: 0.6071
 Site-Art                       (0) | Val  Loss: 2.3707 | Val  Acc: 0.4821
 Site-Clipart                   (3) | Val  Loss: 2.3020 | Val  Acc: 0.5263
 Site-dslr                      (1) | Val  Loss: 2.0127 | Val  Acc: 0.7368
Average Valid Accuracy: 0.6550
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.7500
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.8125
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.6000
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.5385
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.7059
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.6591
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.6667
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.5270
 Best site-RealWorld                (0)  | Epoch:5 | Val Acc: 0.6979
 Best site-Product                  (5)  | Epoch:5 | Val Acc: 0.4545
 Best site-Product                  (6)  | Epoch:5 | Val Acc: 0.6875
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.7273
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.8387
 Best site-Product                  (6)  | Epoch:5 | Val Acc: 0.6744
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.6441
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.6707
 Best site-amazon                   (5)  | Epoch:5 | Val Acc: 0.6154
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.6000
 Best site-amazon                   (2)  | Epoch:5 | Val Acc: 0.7097
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.6957
 Best site-amazon                   (6)  | Epoch:5 | Val Acc: 0.6522
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.5238
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.5676
 Best site-webcam                   (1)  | Epoch:5 | Val Acc: 0.7344
 Best site-Art                      (3)  | Epoch:5 | Val Acc: 0.6071
 Best site-Art                      (0)  | Epoch:5 | Val Acc: 0.4821
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.5263
 Best site-dslr                     (1)  | Epoch:5 | Val Acc: 0.7368
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[5, 8, 2, 1, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-RealWorld                 (4) | Train Loss: 1.9660 | Train Acc: 0.7143
 Site-RealWorld                 (0) | Train Loss: 2.0682 | Train Acc: 0.7222
 Site-RealWorld                 (6) | Train Loss: 1.8832 | Train Acc: 0.7083
 Site-RealWorld                 (4) | Train Loss: 2.0198 | Train Acc: 0.6774
 Site-RealWorld                 (0) | Train Loss: 2.0061 | Train Acc: 0.6250
 Site-RealWorld                 (0) | Train Loss: 1.9258 | Train Acc: 0.7059
 Site-RealWorld                 (4) | Train Loss: 2.1019 | Train Acc: 0.6269
 Site-RealWorld                 (4) | Train Loss: 1.8900 | Train Acc: 0.7209
 Site-RealWorld                 (4) | Train Loss: 1.8929 | Train Acc: 0.7387
 Site-RealWorld                 (4) | Train Loss: 1.9260 | Train Acc: 0.7500
 Site-Product                   (1) | Train Loss: 1.8312 | Train Acc: 0.8235
 Site-Product                   (2) | Train Loss: 2.2721 | Train Acc: 0.5000
 Site-Product                   (1) | Train Loss: 2.0488 | Train Acc: 0.6970
 Site-Product                   (4) | Train Loss: 1.9595 | Train Acc: 0.7391
 Site-Product                   (1) | Train Loss: 1.9616 | Train Acc: 0.7031
 Site-Product                   (1) | Train Loss: 1.9622 | Train Acc: 0.7753
 Site-Product                   (1) | Train Loss: 2.0380 | Train Acc: 0.6452
 Site-amazon                    (3) | Train Loss: 2.0199 | Train Acc: 0.6500
 Site-amazon                    (1) | Train Loss: 1.8070 | Train Acc: 0.8710
 Site-amazon                    (2) | Train Loss: 1.9162 | Train Acc: 0.7174
 Site-amazon                    (1) | Train Loss: 2.0374 | Train Acc: 0.6957
 Site-amazon                    (1) | Train Loss: 2.0642 | Train Acc: 0.6346
 Site-webcam                    (5) | Train Loss: 2.1908 | Train Acc: 0.5625
 Site-webcam                    (4) | Train Loss: 2.0911 | Train Acc: 0.5893
 Site-webcam                    (0) | Train Loss: 2.0136 | Train Acc: 0.7010
 Site-Art                       (5) | Train Loss: 2.4393 | Train Acc: 0.3333
 Site-Art                       (4) | Train Loss: 2.2083 | Train Acc: 0.5238
 Site-Clipart                   (4) | Train Loss: 2.3306 | Train Acc: 0.5294
 Site-dslr                      (0) | Train Loss: 1.8445 | Train Acc: 0.8103
Average Train Accuracy: 0.6721
 Site-RealWorld                 (4) | Val  Loss: 1.7159 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 1.8056 | Val  Acc: 0.7500
 Site-RealWorld                 (6) | Val  Loss: 1.8002 | Val  Acc: 0.8750
 Site-RealWorld                 (4) | Val  Loss: 2.0336 | Val  Acc: 0.6000
 Site-RealWorld                 (0) | Val  Loss: 2.0240 | Val  Acc: 0.6923
 Site-RealWorld                 (0) | Val  Loss: 1.9131 | Val  Acc: 0.7647
 Site-RealWorld                 (4) | Val  Loss: 1.8946 | Val  Acc: 0.7727
 Site-RealWorld                 (4) | Val  Loss: 1.9374 | Val  Acc: 0.7719
 Site-RealWorld                 (4) | Val  Loss: 2.1054 | Val  Acc: 0.5946
 Site-RealWorld                 (4) | Val  Loss: 2.0027 | Val  Acc: 0.6667
 Site-Product                   (1) | Val  Loss: 2.1063 | Val  Acc: 0.8182
 Site-Product                   (2) | Val  Loss: 1.9137 | Val  Acc: 0.6875
 Site-Product                   (1) | Val  Loss: 1.7802 | Val  Acc: 0.8182
 Site-Product                   (4) | Val  Loss: 1.7692 | Val  Acc: 0.8387
 Site-Product                   (1) | Val  Loss: 2.0086 | Val  Acc: 0.6977
 Site-Product                   (1) | Val  Loss: 1.9519 | Val  Acc: 0.7119
 Site-Product                   (1) | Val  Loss: 1.9073 | Val  Acc: 0.7195
 Site-amazon                    (3) | Val  Loss: 2.0036 | Val  Acc: 0.5385
 Site-amazon                    (1) | Val  Loss: 2.1062 | Val  Acc: 0.5000
 Site-amazon                    (2) | Val  Loss: 2.0808 | Val  Acc: 0.6452
 Site-amazon                    (1) | Val  Loss: 1.9664 | Val  Acc: 0.7391
 Site-amazon                    (1) | Val  Loss: 1.9885 | Val  Acc: 0.7391
 Site-webcam                    (5) | Val  Loss: 2.1548 | Val  Acc: 0.5714
 Site-webcam                    (4) | Val  Loss: 2.1058 | Val  Acc: 0.6757
 Site-webcam                    (0) | Val  Loss: 1.9890 | Val  Acc: 0.7812
 Site-Art                       (5) | Val  Loss: 2.1442 | Val  Acc: 0.5714
 Site-Art                       (4) | Val  Loss: 2.2706 | Val  Acc: 0.6071
 Site-Clipart                   (4) | Val  Loss: 2.1522 | Val  Acc: 0.5789
 Site-dslr                      (0) | Val  Loss: 1.8472 | Val  Acc: 0.7632
Average Valid Accuracy: 0.7027
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.8889
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.7500
 Best site-RealWorld                (6)  | Epoch:6 | Val Acc: 0.8750
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.6000
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.6923
 Best site-RealWorld                (0)  | Epoch:6 | Val Acc: 0.7647
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.7727
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.7719
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.5946
 Best site-RealWorld                (4)  | Epoch:6 | Val Acc: 0.6667
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.8182
 Best site-Product                  (2)  | Epoch:6 | Val Acc: 0.6875
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.8182
 Best site-Product                  (4)  | Epoch:6 | Val Acc: 0.8387
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.6977
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.7119
 Best site-Product                  (1)  | Epoch:6 | Val Acc: 0.7195
 Best site-amazon                   (3)  | Epoch:6 | Val Acc: 0.5385
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.5000
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.6452
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.7391
 Best site-amazon                   (1)  | Epoch:6 | Val Acc: 0.7391
 Best site-webcam                   (5)  | Epoch:6 | Val Acc: 0.5714
 Best site-webcam                   (4)  | Epoch:6 | Val Acc: 0.6757
 Best site-webcam                   (0)  | Epoch:6 | Val Acc: 0.7812
 Best site-Art                      (5)  | Epoch:6 | Val Acc: 0.5714
 Best site-Art                      (4)  | Epoch:6 | Val Acc: 0.6071
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.5789
 Best site-dslr                     (0)  | Epoch:6 | Val Acc: 0.7632
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 7, 2, 7, 7, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-RealWorld                 (1) | Train Loss: 1.8923 | Train Acc: 0.6429
 Site-RealWorld                 (4) | Train Loss: 1.8301 | Train Acc: 0.7778
 Site-RealWorld                 (2) | Train Loss: 1.7600 | Train Acc: 0.7083
 Site-RealWorld                 (4) | Train Loss: 1.8530 | Train Acc: 0.8065
 Site-RealWorld                 (1) | Train Loss: 1.8845 | Train Acc: 0.6250
 Site-RealWorld                 (1) | Train Loss: 1.8353 | Train Acc: 0.7843
 Site-RealWorld                 (1) | Train Loss: 1.9561 | Train Acc: 0.6716
 Site-RealWorld                 (4) | Train Loss: 1.7904 | Train Acc: 0.7558
 Site-RealWorld                 (1) | Train Loss: 1.7937 | Train Acc: 0.7387
 Site-RealWorld                 (4) | Train Loss: 1.6846 | Train Acc: 0.8264
 Site-Product                   (4) | Train Loss: 1.7717 | Train Acc: 0.7647
 Site-Product                   (3) | Train Loss: 2.0454 | Train Acc: 0.5833
 Site-Product                   (0) | Train Loss: 2.0359 | Train Acc: 0.4848
 Site-Product                   (4) | Train Loss: 1.8687 | Train Acc: 0.7174
 Site-Product                   (3) | Train Loss: 1.8401 | Train Acc: 0.7188
 Site-Product                   (4) | Train Loss: 1.7879 | Train Acc: 0.8090
 Site-Product                   (3) | Train Loss: 1.9032 | Train Acc: 0.7177
 Site-amazon                    (0) | Train Loss: 1.8295 | Train Acc: 0.6500
 Site-amazon                    (3) | Train Loss: 1.6965 | Train Acc: 0.7742
 Site-amazon                    (3) | Train Loss: 1.7605 | Train Acc: 0.8696
 Site-amazon                    (3) | Train Loss: 1.9705 | Train Acc: 0.7681
 Site-amazon                    (3) | Train Loss: 1.8807 | Train Acc: 0.6442
 Site-webcam                    (6) | Train Loss: 2.0527 | Train Acc: 0.6875
 Site-webcam                    (5) | Train Loss: 1.9647 | Train Acc: 0.7321
 Site-webcam                    (5) | Train Loss: 1.8715 | Train Acc: 0.7835
 Site-Art                       (2) | Train Loss: 2.3241 | Train Acc: 0.4286
 Site-Art                       (1) | Train Loss: 2.1392 | Train Acc: 0.6190
 Site-Clipart                   (1) | Train Loss: 2.2394 | Train Acc: 0.5294
 Site-dslr                      (6) | Train Loss: 1.7213 | Train Acc: 0.8103
Average Train Accuracy: 0.7045
 Site-RealWorld                 (1) | Val  Loss: 1.5215 | Val  Acc: 0.8889
 Site-RealWorld                 (4) | Val  Loss: 1.6455 | Val  Acc: 0.8333
 Site-RealWorld                 (2) | Val  Loss: 1.5075 | Val  Acc: 0.9375
 Site-RealWorld                 (4) | Val  Loss: 1.8825 | Val  Acc: 0.6000
 Site-RealWorld                 (1) | Val  Loss: 1.9466 | Val  Acc: 0.6154
 Site-RealWorld                 (1) | Val  Loss: 1.7066 | Val  Acc: 0.7353
 Site-RealWorld                 (1) | Val  Loss: 1.7778 | Val  Acc: 0.7955
 Site-RealWorld                 (4) | Val  Loss: 1.7903 | Val  Acc: 0.7193
 Site-RealWorld                 (1) | Val  Loss: 1.9736 | Val  Acc: 0.6622
 Site-RealWorld                 (4) | Val  Loss: 1.8785 | Val  Acc: 0.7188
 Site-Product                   (4) | Val  Loss: 1.8584 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 1.7246 | Val  Acc: 0.8125
 Site-Product                   (0) | Val  Loss: 1.6808 | Val  Acc: 0.7727
 Site-Product                   (4) | Val  Loss: 1.6414 | Val  Acc: 0.8710
 Site-Product                   (3) | Val  Loss: 1.8425 | Val  Acc: 0.8140
 Site-Product                   (4) | Val  Loss: 1.8461 | Val  Acc: 0.6949
 Site-Product                   (3) | Val  Loss: 1.7257 | Val  Acc: 0.7439
 Site-amazon                    (0) | Val  Loss: 1.8532 | Val  Acc: 0.6154
 Site-amazon                    (3) | Val  Loss: 1.9320 | Val  Acc: 0.6000
 Site-amazon                    (3) | Val  Loss: 1.8615 | Val  Acc: 0.7742
 Site-amazon                    (3) | Val  Loss: 1.8070 | Val  Acc: 0.7826
 Site-amazon                    (3) | Val  Loss: 1.8920 | Val  Acc: 0.7536
 Site-webcam                    (6) | Val  Loss: 2.0010 | Val  Acc: 0.6190
 Site-webcam                    (5) | Val  Loss: 1.9470 | Val  Acc: 0.7568
 Site-webcam                    (5) | Val  Loss: 1.8240 | Val  Acc: 0.8438
 Site-Art                       (2) | Val  Loss: 2.0243 | Val  Acc: 0.6071
 Site-Art                       (1) | Val  Loss: 2.1300 | Val  Acc: 0.6250
 Site-Clipart                   (1) | Val  Loss: 2.1483 | Val  Acc: 0.5614
 Site-dslr                      (6) | Val  Loss: 1.6940 | Val  Acc: 0.8421
Average Valid Accuracy: 0.7384
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.8889
 Best site-RealWorld                (4)  | Epoch:7 | Val Acc: 0.8333
 Best site-RealWorld                (2)  | Epoch:7 | Val Acc: 0.9375
 Best site-RealWorld                (4)  | Epoch:7 | Val Acc: 0.6000
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.6154
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7353
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7955
 Best site-RealWorld                (4)  | Epoch:7 | Val Acc: 0.7193
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.6622
 Best site-RealWorld                (4)  | Epoch:7 | Val Acc: 0.7188
 Best site-Product                  (4)  | Epoch:7 | Val Acc: 0.8182
 Best site-Product                  (3)  | Epoch:7 | Val Acc: 0.8125
 Best site-Product                  (0)  | Epoch:7 | Val Acc: 0.7727
 Best site-Product                  (4)  | Epoch:7 | Val Acc: 0.8710
 Best site-Product                  (3)  | Epoch:7 | Val Acc: 0.8140
 Best site-Product                  (4)  | Epoch:7 | Val Acc: 0.6949
 Best site-Product                  (3)  | Epoch:7 | Val Acc: 0.7439
 Best site-amazon                   (0)  | Epoch:7 | Val Acc: 0.6154
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.6000
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.7742
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.7826
 Best site-amazon                   (3)  | Epoch:7 | Val Acc: 0.7536
 Best site-webcam                   (6)  | Epoch:7 | Val Acc: 0.6190
 Best site-webcam                   (5)  | Epoch:7 | Val Acc: 0.7568
 Best site-webcam                   (5)  | Epoch:7 | Val Acc: 0.8438
 Best site-Art                      (2)  | Epoch:7 | Val Acc: 0.6071
 Best site-Art                      (1)  | Epoch:7 | Val Acc: 0.6250
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.5614
 Best site-dslr                     (6)  | Epoch:7 | Val Acc: 0.8421
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[10, 4, 1, 2, 7, 1, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-RealWorld                 (1) | Train Loss: 1.6923 | Train Acc: 0.8571
 Site-RealWorld                 (0) | Train Loss: 1.6825 | Train Acc: 0.8333
 Site-RealWorld                 (0) | Train Loss: 1.6195 | Train Acc: 0.7083
 Site-RealWorld                 (4) | Train Loss: 1.7003 | Train Acc: 0.7419
 Site-RealWorld                 (1) | Train Loss: 1.7079 | Train Acc: 0.7500
 Site-RealWorld                 (0) | Train Loss: 1.7289 | Train Acc: 0.7647
 Site-RealWorld                 (0) | Train Loss: 1.5520 | Train Acc: 0.7164
 Site-RealWorld                 (0) | Train Loss: 1.6812 | Train Acc: 0.7558
 Site-RealWorld                 (0) | Train Loss: 1.6449 | Train Acc: 0.7748
 Site-RealWorld                 (0) | Train Loss: 1.5157 | Train Acc: 0.8611
 Site-Product                   (0) | Train Loss: 1.5822 | Train Acc: 0.9412
 Site-Product                   (4) | Train Loss: 2.0140 | Train Acc: 0.4167
 Site-Product                   (4) | Train Loss: 1.8864 | Train Acc: 0.6970
 Site-Product                   (4) | Train Loss: 1.7340 | Train Acc: 0.7609
 Site-Product                   (6) | Train Loss: 1.6551 | Train Acc: 0.8125
 Site-Product                   (4) | Train Loss: 1.5681 | Train Acc: 0.8202
 Site-Product                   (4) | Train Loss: 1.7503 | Train Acc: 0.7823
 Site-amazon                    (2) | Train Loss: 1.7715 | Train Acc: 0.7000
 Site-amazon                    (4) | Train Loss: 1.5539 | Train Acc: 0.8710
 Site-amazon                    (6) | Train Loss: 1.6258 | Train Acc: 0.8913
 Site-amazon                    (6) | Train Loss: 1.8809 | Train Acc: 0.7826
 Site-amazon                    (6) | Train Loss: 1.7947 | Train Acc: 0.6827
 Site-webcam                    (1) | Train Loss: 1.9680 | Train Acc: 0.6562
 Site-webcam                    (3) | Train Loss: 1.8453 | Train Acc: 0.6964
 Site-webcam                    (3) | Train Loss: 1.7502 | Train Acc: 0.7938
 Site-Art                       (5) | Train Loss: 2.2014 | Train Acc: 0.4762
 Site-Art                       (0) | Train Loss: 1.9239 | Train Acc: 0.6310
 Site-Clipart                   (0) | Train Loss: 2.0342 | Train Acc: 0.5647
 Site-dslr                      (1) | Train Loss: 1.6012 | Train Acc: 0.8103
Average Train Accuracy: 0.7431
 Site-RealWorld                 (1) | Val  Loss: 1.3243 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 1.5553 | Val  Acc: 0.8333
 Site-RealWorld                 (0) | Val  Loss: 1.3951 | Val  Acc: 0.9375
 Site-RealWorld                 (4) | Val  Loss: 1.7693 | Val  Acc: 0.6500
 Site-RealWorld                 (1) | Val  Loss: 1.7968 | Val  Acc: 0.6923
 Site-RealWorld                 (0) | Val  Loss: 1.5974 | Val  Acc: 0.7647
 Site-RealWorld                 (0) | Val  Loss: 1.6224 | Val  Acc: 0.7955
 Site-RealWorld                 (0) | Val  Loss: 1.7014 | Val  Acc: 0.7368
 Site-RealWorld                 (0) | Val  Loss: 1.8279 | Val  Acc: 0.7162
 Site-RealWorld                 (0) | Val  Loss: 1.7442 | Val  Acc: 0.7396
 Site-Product                   (0) | Val  Loss: 1.7432 | Val  Acc: 0.7273
 Site-Product                   (4) | Val  Loss: 1.7547 | Val  Acc: 0.8125
 Site-Product                   (4) | Val  Loss: 1.4706 | Val  Acc: 0.7727
 Site-Product                   (4) | Val  Loss: 1.4263 | Val  Acc: 0.9032
 Site-Product                   (6) | Val  Loss: 1.8196 | Val  Acc: 0.7442
 Site-Product                   (4) | Val  Loss: 1.7128 | Val  Acc: 0.7627
 Site-Product                   (4) | Val  Loss: 1.6795 | Val  Acc: 0.7439
 Site-amazon                    (2) | Val  Loss: 1.7020 | Val  Acc: 0.6923
 Site-amazon                    (4) | Val  Loss: 1.7957 | Val  Acc: 0.6000
 Site-amazon                    (6) | Val  Loss: 1.7949 | Val  Acc: 0.6774
 Site-amazon                    (6) | Val  Loss: 1.6735 | Val  Acc: 0.7826
 Site-amazon                    (6) | Val  Loss: 1.7230 | Val  Acc: 0.8551
 Site-webcam                    (1) | Val  Loss: 1.8206 | Val  Acc: 0.6667
 Site-webcam                    (3) | Val  Loss: 1.7672 | Val  Acc: 0.7838
 Site-webcam                    (3) | Val  Loss: 1.7585 | Val  Acc: 0.8125
 Site-Art                       (5) | Val  Loss: 1.8718 | Val  Acc: 0.6786
 Site-Art                       (0) | Val  Loss: 2.0225 | Val  Acc: 0.6429
 Site-Clipart                   (0) | Val  Loss: 1.9969 | Val  Acc: 0.6316
 Site-dslr                      (1) | Val  Loss: 1.5724 | Val  Acc: 0.8421
Average Valid Accuracy: 0.7547
 Best site-RealWorld                (1)  | Epoch:8 | Val Acc: 0.8889
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.8333
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.9375
 Best site-RealWorld                (4)  | Epoch:8 | Val Acc: 0.6500
 Best site-RealWorld                (1)  | Epoch:8 | Val Acc: 0.6923
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.7647
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.7955
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.7368
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.7162
 Best site-RealWorld                (0)  | Epoch:8 | Val Acc: 0.7396
 Best site-Product                  (0)  | Epoch:8 | Val Acc: 0.7273
 Best site-Product                  (4)  | Epoch:8 | Val Acc: 0.8125
 Best site-Product                  (4)  | Epoch:8 | Val Acc: 0.7727
 Best site-Product                  (4)  | Epoch:8 | Val Acc: 0.9032
 Best site-Product                  (6)  | Epoch:8 | Val Acc: 0.7442
 Best site-Product                  (4)  | Epoch:8 | Val Acc: 0.7627
 Best site-Product                  (4)  | Epoch:8 | Val Acc: 0.7439
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.6923
 Best site-amazon                   (4)  | Epoch:8 | Val Acc: 0.6000
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.6774
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.7826
 Best site-amazon                   (6)  | Epoch:8 | Val Acc: 0.8551
 Best site-webcam                   (1)  | Epoch:8 | Val Acc: 0.6667
 Best site-webcam                   (3)  | Epoch:8 | Val Acc: 0.7838
 Best site-webcam                   (3)  | Epoch:8 | Val Acc: 0.8125
 Best site-Art                      (5)  | Epoch:8 | Val Acc: 0.6786
 Best site-Art                      (0)  | Epoch:8 | Val Acc: 0.6429
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.6316
 Best site-dslr                     (1)  | Epoch:8 | Val Acc: 0.8421
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 4, 5, 4, 3, 10, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-RealWorld                 (0) | Train Loss: 1.5862 | Train Acc: 0.7857
 Site-RealWorld                 (4) | Train Loss: 1.6202 | Train Acc: 0.7222
 Site-RealWorld                 (4) | Train Loss: 1.4885 | Train Acc: 0.7500
 Site-RealWorld                 (5) | Train Loss: 1.5829 | Train Acc: 0.7742
 Site-RealWorld                 (4) | Train Loss: 1.6395 | Train Acc: 0.7500
 Site-RealWorld                 (5) | Train Loss: 1.5778 | Train Acc: 0.8039
 Site-RealWorld                 (5) | Train Loss: 1.7609 | Train Acc: 0.7463
 Site-RealWorld                 (5) | Train Loss: 1.4751 | Train Acc: 0.8372
 Site-RealWorld                 (5) | Train Loss: 1.5369 | Train Acc: 0.7838
 Site-RealWorld                 (1) | Train Loss: 1.4720 | Train Acc: 0.8958
 Site-Product                   (3) | Train Loss: 1.4827 | Train Acc: 0.9412
 Site-Product                   (2) | Train Loss: 1.8684 | Train Acc: 0.7500
 Site-Product                   (3) | Train Loss: 1.8154 | Train Acc: 0.6061
 Site-Product                   (3) | Train Loss: 1.7083 | Train Acc: 0.7826
 Site-Product                   (2) | Train Loss: 1.5662 | Train Acc: 0.7969
 Site-Product                   (3) | Train Loss: 1.5285 | Train Acc: 0.8315
 Site-Product                   (2) | Train Loss: 1.6435 | Train Acc: 0.7903
 Site-amazon                    (1) | Train Loss: 1.6664 | Train Acc: 0.7000
 Site-amazon                    (1) | Train Loss: 1.3818 | Train Acc: 0.8710
 Site-amazon                    (2) | Train Loss: 1.4974 | Train Acc: 0.7826
 Site-amazon                    (2) | Train Loss: 1.4242 | Train Acc: 0.8551
 Site-amazon                    (1) | Train Loss: 1.6774 | Train Acc: 0.7115
 Site-webcam                    (6) | Train Loss: 1.7273 | Train Acc: 0.7500
 Site-webcam                    (5) | Train Loss: 1.6172 | Train Acc: 0.7679
 Site-webcam                    (5) | Train Loss: 1.6378 | Train Acc: 0.8557
 Site-Art                       (5) | Train Loss: 2.1383 | Train Acc: 0.4762
 Site-Art                       (5) | Train Loss: 1.8248 | Train Acc: 0.6905
 Site-Clipart                   (5) | Train Loss: 1.9198 | Train Acc: 0.5412
 Site-dslr                      (6) | Train Loss: 1.4722 | Train Acc: 0.8621
Average Train Accuracy: 0.7659
 Site-RealWorld                 (0) | Val  Loss: 1.2443 | Val  Acc: 0.8889
 Site-RealWorld                 (4) | Val  Loss: 1.4588 | Val  Acc: 0.9167
 Site-RealWorld                 (4) | Val  Loss: 1.3115 | Val  Acc: 0.9375
 Site-RealWorld                 (5) | Val  Loss: 1.6408 | Val  Acc: 0.6500
 Site-RealWorld                 (4) | Val  Loss: 1.6398 | Val  Acc: 0.8077
 Site-RealWorld                 (5) | Val  Loss: 1.4867 | Val  Acc: 0.8235
 Site-RealWorld                 (5) | Val  Loss: 1.4746 | Val  Acc: 0.8182
 Site-RealWorld                 (5) | Val  Loss: 1.5807 | Val  Acc: 0.7368
 Site-RealWorld                 (5) | Val  Loss: 1.7189 | Val  Acc: 0.7703
 Site-RealWorld                 (1) | Val  Loss: 1.6386 | Val  Acc: 0.7396
 Site-Product                   (3) | Val  Loss: 1.5624 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 1.6191 | Val  Acc: 0.8125
 Site-Product                   (3) | Val  Loss: 1.3912 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 1.3367 | Val  Acc: 0.9032
 Site-Product                   (2) | Val  Loss: 1.6080 | Val  Acc: 0.8140
 Site-Product                   (3) | Val  Loss: 1.6254 | Val  Acc: 0.7627
 Site-Product                   (2) | Val  Loss: 1.5403 | Val  Acc: 0.7683
 Site-amazon                    (1) | Val  Loss: 1.4818 | Val  Acc: 0.8462
 Site-amazon                    (1) | Val  Loss: 1.7078 | Val  Acc: 0.6000
 Site-amazon                    (2) | Val  Loss: 1.7248 | Val  Acc: 0.7097
 Site-amazon                    (2) | Val  Loss: 1.5417 | Val  Acc: 0.8696
 Site-amazon                    (1) | Val  Loss: 1.5443 | Val  Acc: 0.8551
 Site-webcam                    (6) | Val  Loss: 1.6757 | Val  Acc: 0.7619
 Site-webcam                    (5) | Val  Loss: 1.6559 | Val  Acc: 0.8108
 Site-webcam                    (5) | Val  Loss: 1.5790 | Val  Acc: 0.8750
 Site-Art                       (5) | Val  Loss: 1.9179 | Val  Acc: 0.5000
 Site-Art                       (5) | Val  Loss: 1.9209 | Val  Acc: 0.6429
 Site-Clipart                   (5) | Val  Loss: 1.9243 | Val  Acc: 0.5789
 Site-dslr                      (6) | Val  Loss: 1.4403 | Val  Acc: 0.8684
Average Valid Accuracy: 0.7861
 Best site-RealWorld                (0)  | Epoch:9 | Val Acc: 0.8889
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 0.9167
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 0.9375
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.6500
 Best site-RealWorld                (4)  | Epoch:9 | Val Acc: 0.8077
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.8235
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.8182
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.7368
 Best site-RealWorld                (5)  | Epoch:9 | Val Acc: 0.7703
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.7396
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.9091
 Best site-Product                  (2)  | Epoch:9 | Val Acc: 0.8125
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.8182
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.9032
 Best site-Product                  (2)  | Epoch:9 | Val Acc: 0.8140
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.7627
 Best site-Product                  (2)  | Epoch:9 | Val Acc: 0.7683
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8462
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.6000
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.7097
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.8696
 Best site-amazon                   (1)  | Epoch:9 | Val Acc: 0.8551
 Best site-webcam                   (6)  | Epoch:9 | Val Acc: 0.7619
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.8108
 Best site-webcam                   (5)  | Epoch:9 | Val Acc: 0.8750
 Best site-Art                      (5)  | Epoch:9 | Val Acc: 0.5000
 Best site-Art                      (5)  | Epoch:9 | Val Acc: 0.6429
 Best site-Clipart                  (5)  | Epoch:9 | Val Acc: 0.5789
 Best site-dslr                     (6)  | Epoch:9 | Val Acc: 0.8684
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 5, 8, 2, 7, 1, 4, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-RealWorld                 (3) | Train Loss: 1.4310 | Train Acc: 0.8571
 Site-RealWorld                 (1) | Train Loss: 1.4272 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 1.4154 | Train Acc: 0.8333
 Site-RealWorld                 (1) | Train Loss: 1.5142 | Train Acc: 0.8387
 Site-RealWorld                 (2) | Train Loss: 1.4909 | Train Acc: 0.7500
 Site-RealWorld                 (6) | Train Loss: 1.4129 | Train Acc: 0.8235
 Site-RealWorld                 (2) | Train Loss: 1.6034 | Train Acc: 0.8060
 Site-RealWorld                 (2) | Train Loss: 1.3532 | Train Acc: 0.8140
 Site-RealWorld                 (2) | Train Loss: 1.4366 | Train Acc: 0.8378
 Site-RealWorld                 (2) | Train Loss: 1.2773 | Train Acc: 0.9028
 Site-Product                   (5) | Train Loss: 1.3487 | Train Acc: 0.8824
 Site-Product                   (0) | Train Loss: 1.7374 | Train Acc: 0.6667
 Site-Product                   (2) | Train Loss: 1.6925 | Train Acc: 0.6667
 Site-Product                   (2) | Train Loss: 1.4937 | Train Acc: 0.8261
 Site-Product                   (4) | Train Loss: 1.4469 | Train Acc: 0.8125
 Site-Product                   (4) | Train Loss: 1.3528 | Train Acc: 0.8652
 Site-Product                   (4) | Train Loss: 1.5115 | Train Acc: 0.8226
 Site-amazon                    (4) | Train Loss: 1.5479 | Train Acc: 0.7000
 Site-amazon                    (4) | Train Loss: 1.2727 | Train Acc: 0.8387
 Site-amazon                    (4) | Train Loss: 1.3346 | Train Acc: 0.8696
 Site-amazon                    (4) | Train Loss: 1.3256 | Train Acc: 0.8116
 Site-amazon                    (0) | Train Loss: 1.5672 | Train Acc: 0.7500
 Site-webcam                    (6) | Train Loss: 1.6550 | Train Acc: 0.7812
 Site-webcam                    (1) | Train Loss: 1.5325 | Train Acc: 0.8214
 Site-webcam                    (6) | Train Loss: 1.5074 | Train Acc: 0.8969
 Site-Art                       (1) | Train Loss: 2.0155 | Train Acc: 0.6429
 Site-Art                       (2) | Train Loss: 1.8055 | Train Acc: 0.6905
 Site-Clipart                   (1) | Train Loss: 1.9347 | Train Acc: 0.5294
 Site-dslr                      (3) | Train Loss: 1.3701 | Train Acc: 0.8793
Average Train Accuracy: 0.7948
 Site-RealWorld                 (3) | Val  Loss: 1.0713 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 1.2072 | Val  Acc: 0.8333
 Site-RealWorld                 (6) | Val  Loss: 1.1813 | Val  Acc: 0.9375
 Site-RealWorld                 (1) | Val  Loss: 1.5627 | Val  Acc: 0.7000
 Site-RealWorld                 (2) | Val  Loss: 1.5493 | Val  Acc: 0.7308
 Site-RealWorld                 (6) | Val  Loss: 1.2901 | Val  Acc: 0.8529
 Site-RealWorld                 (2) | Val  Loss: 1.3825 | Val  Acc: 0.8182
 Site-RealWorld                 (2) | Val  Loss: 1.4382 | Val  Acc: 0.7895
 Site-RealWorld                 (2) | Val  Loss: 1.5763 | Val  Acc: 0.8108
 Site-RealWorld                 (2) | Val  Loss: 1.4941 | Val  Acc: 0.8125
 Site-Product                   (5) | Val  Loss: 1.4231 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 1.5475 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 1.2101 | Val  Acc: 0.8182
 Site-Product                   (2) | Val  Loss: 1.2451 | Val  Acc: 0.8710
 Site-Product                   (4) | Val  Loss: 1.5474 | Val  Acc: 0.8372
 Site-Product                   (4) | Val  Loss: 1.4159 | Val  Acc: 0.8644
 Site-Product                   (4) | Val  Loss: 1.4079 | Val  Acc: 0.8537
 Site-amazon                    (4) | Val  Loss: 1.4208 | Val  Acc: 0.8462
 Site-amazon                    (4) | Val  Loss: 1.4776 | Val  Acc: 0.7000
 Site-amazon                    (4) | Val  Loss: 1.5111 | Val  Acc: 0.7742
 Site-amazon                    (4) | Val  Loss: 1.3908 | Val  Acc: 0.8913
 Site-amazon                    (0) | Val  Loss: 1.4534 | Val  Acc: 0.8696
 Site-webcam                    (6) | Val  Loss: 1.5503 | Val  Acc: 0.8571
 Site-webcam                    (1) | Val  Loss: 1.5511 | Val  Acc: 0.8378
 Site-webcam                    (6) | Val  Loss: 1.3956 | Val  Acc: 0.9219
 Site-Art                       (1) | Val  Loss: 1.6717 | Val  Acc: 0.7143
 Site-Art                       (2) | Val  Loss: 1.8031 | Val  Acc: 0.6786
 Site-Clipart                   (1) | Val  Loss: 1.8370 | Val  Acc: 0.6140
 Site-dslr                      (3) | Val  Loss: 1.3347 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8195
 Best site-RealWorld                (3)  | Epoch:10 | Val Acc: 0.8889
 Best site-RealWorld                (1)  | Epoch:10 | Val Acc: 0.8333
 Best site-RealWorld                (6)  | Epoch:10 | Val Acc: 0.9375
 Best site-RealWorld                (1)  | Epoch:10 | Val Acc: 0.7000
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.7308
 Best site-RealWorld                (6)  | Epoch:10 | Val Acc: 0.8529
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.8182
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.7895
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.8108
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.8125
 Best site-Product                  (5)  | Epoch:10 | Val Acc: 0.9091
 Best site-Product                  (0)  | Epoch:10 | Val Acc: 0.8125
 Best site-Product                  (2)  | Epoch:10 | Val Acc: 0.8182
 Best site-Product                  (2)  | Epoch:10 | Val Acc: 0.8710
 Best site-Product                  (4)  | Epoch:10 | Val Acc: 0.8372
 Best site-Product                  (4)  | Epoch:10 | Val Acc: 0.8644
 Best site-Product                  (4)  | Epoch:10 | Val Acc: 0.8537
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.8462
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.7000
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.7742
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.8913
 Best site-amazon                   (0)  | Epoch:10 | Val Acc: 0.8696
 Best site-webcam                   (6)  | Epoch:10 | Val Acc: 0.8571
 Best site-webcam                   (1)  | Epoch:10 | Val Acc: 0.8378
 Best site-webcam                   (6)  | Epoch:10 | Val Acc: 0.9219
 Best site-Art                      (1)  | Epoch:10 | Val Acc: 0.7143
 Best site-Art                      (2)  | Epoch:10 | Val Acc: 0.6786
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.6140
 Best site-dslr                     (3)  | Epoch:10 | Val Acc: 0.9211
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 3, 5, 2, 2, 5, 7, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-RealWorld                 (6) | Train Loss: 1.2827 | Train Acc: 0.9286
 Site-RealWorld                 (6) | Train Loss: 1.2880 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 1.2749 | Train Acc: 0.8750
 Site-RealWorld                 (6) | Train Loss: 1.3773 | Train Acc: 0.8065
 Site-RealWorld                 (2) | Train Loss: 1.3770 | Train Acc: 0.7500
 Site-RealWorld                 (2) | Train Loss: 1.3341 | Train Acc: 0.8824
 Site-RealWorld                 (0) | Train Loss: 1.6060 | Train Acc: 0.8060
 Site-RealWorld                 (6) | Train Loss: 1.3262 | Train Acc: 0.8023
 Site-RealWorld                 (6) | Train Loss: 1.3225 | Train Acc: 0.8468
 Site-RealWorld                 (0) | Train Loss: 1.1721 | Train Acc: 0.9306
 Site-Product                   (5) | Train Loss: 1.1934 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 1.5807 | Train Acc: 0.6250
 Site-Product                   (6) | Train Loss: 1.5882 | Train Acc: 0.7273
 Site-Product                   (3) | Train Loss: 1.4340 | Train Acc: 0.8043
 Site-Product                   (5) | Train Loss: 1.3557 | Train Acc: 0.7812
 Site-Product                   (0) | Train Loss: 1.2466 | Train Acc: 0.8315
 Site-Product                   (5) | Train Loss: 1.4285 | Train Acc: 0.8387
 Site-amazon                    (1) | Train Loss: 1.5142 | Train Acc: 0.7000
 Site-amazon                    (3) | Train Loss: 1.1802 | Train Acc: 0.8710
 Site-amazon                    (1) | Train Loss: 1.3141 | Train Acc: 0.8043
 Site-amazon                    (1) | Train Loss: 1.3708 | Train Acc: 0.8696
 Site-amazon                    (5) | Train Loss: 1.4219 | Train Acc: 0.7885
 Site-webcam                    (4) | Train Loss: 1.5382 | Train Acc: 0.8125
 Site-webcam                    (2) | Train Loss: 1.3910 | Train Acc: 0.8214
 Site-webcam                    (2) | Train Loss: 1.3261 | Train Acc: 0.8969
 Site-Art                       (2) | Train Loss: 1.8892 | Train Acc: 0.5238
 Site-Art                       (0) | Train Loss: 1.7268 | Train Acc: 0.7738
 Site-Clipart                   (6) | Train Loss: 1.7622 | Train Acc: 0.5294
 Site-dslr                      (4) | Train Loss: 1.2371 | Train Acc: 0.8448
Average Train Accuracy: 0.8015
 Site-RealWorld                 (6) | Val  Loss: 1.1662 | Val  Acc: 0.8889
 Site-RealWorld                 (6) | Val  Loss: 1.0827 | Val  Acc: 0.9167
 Site-RealWorld                 (0) | Val  Loss: 1.1096 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 1.4320 | Val  Acc: 0.8500
 Site-RealWorld                 (2) | Val  Loss: 1.4300 | Val  Acc: 0.7308
 Site-RealWorld                 (2) | Val  Loss: 1.2023 | Val  Acc: 0.8235
 Site-RealWorld                 (0) | Val  Loss: 1.1983 | Val  Acc: 0.8636
 Site-RealWorld                 (6) | Val  Loss: 1.3567 | Val  Acc: 0.7895
 Site-RealWorld                 (6) | Val  Loss: 1.4855 | Val  Acc: 0.7838
 Site-RealWorld                 (0) | Val  Loss: 1.3564 | Val  Acc: 0.8229
 Site-Product                   (5) | Val  Loss: 1.3069 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 1.3505 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 1.1701 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 1.0830 | Val  Acc: 0.9032
 Site-Product                   (5) | Val  Loss: 1.4290 | Val  Acc: 0.8372
 Site-Product                   (0) | Val  Loss: 1.3227 | Val  Acc: 0.7966
 Site-Product                   (5) | Val  Loss: 1.3440 | Val  Acc: 0.8049
 Site-amazon                    (1) | Val  Loss: 1.2716 | Val  Acc: 0.6923
 Site-amazon                    (3) | Val  Loss: 1.4431 | Val  Acc: 0.7500
 Site-amazon                    (1) | Val  Loss: 1.4636 | Val  Acc: 0.8065
 Site-amazon                    (1) | Val  Loss: 1.2679 | Val  Acc: 0.9130
 Site-amazon                    (5) | Val  Loss: 1.3912 | Val  Acc: 0.8841
 Site-webcam                    (4) | Val  Loss: 1.4802 | Val  Acc: 0.8571
 Site-webcam                    (2) | Val  Loss: 1.4043 | Val  Acc: 0.8378
 Site-webcam                    (2) | Val  Loss: 1.3514 | Val  Acc: 0.9062
 Site-Art                       (2) | Val  Loss: 1.5844 | Val  Acc: 0.7857
 Site-Art                       (0) | Val  Loss: 1.7734 | Val  Acc: 0.7321
 Site-Clipart                   (6) | Val  Loss: 1.7358 | Val  Acc: 0.6316
 Site-dslr                      (4) | Val  Loss: 1.2035 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8312
 Best site-RealWorld                (6)  | Epoch:11 | Val Acc: 0.8889
 Best site-RealWorld                (6)  | Epoch:11 | Val Acc: 0.9167
 Best site-RealWorld                (0)  | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:11 | Val Acc: 0.8500
 Best site-RealWorld                (2)  | Epoch:11 | Val Acc: 0.7308
 Best site-RealWorld                (2)  | Epoch:11 | Val Acc: 0.8235
 Best site-RealWorld                (0)  | Epoch:11 | Val Acc: 0.8636
 Best site-RealWorld                (6)  | Epoch:11 | Val Acc: 0.7895
 Best site-RealWorld                (6)  | Epoch:11 | Val Acc: 0.7838
 Best site-RealWorld                (0)  | Epoch:11 | Val Acc: 0.8229
 Best site-Product                  (5)  | Epoch:11 | Val Acc: 0.9091
 Best site-Product                  (5)  | Epoch:11 | Val Acc: 0.8750
 Best site-Product                  (6)  | Epoch:11 | Val Acc: 0.8182
 Best site-Product                  (3)  | Epoch:11 | Val Acc: 0.9032
 Best site-Product                  (5)  | Epoch:11 | Val Acc: 0.8372
 Best site-Product                  (0)  | Epoch:11 | Val Acc: 0.7966
 Best site-Product                  (5)  | Epoch:11 | Val Acc: 0.8049
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.6923
 Best site-amazon                   (3)  | Epoch:11 | Val Acc: 0.7500
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.8065
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.9130
 Best site-amazon                   (5)  | Epoch:11 | Val Acc: 0.8841
 Best site-webcam                   (4)  | Epoch:11 | Val Acc: 0.8571
 Best site-webcam                   (2)  | Epoch:11 | Val Acc: 0.8378
 Best site-webcam                   (2)  | Epoch:11 | Val Acc: 0.9062
 Best site-Art                      (2)  | Epoch:11 | Val Acc: 0.7857
 Best site-Art                      (0)  | Epoch:11 | Val Acc: 0.7321
 Best site-Clipart                  (6)  | Epoch:11 | Val Acc: 0.6316
 Best site-dslr                     (4)  | Epoch:11 | Val Acc: 0.8947
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[9, 5, 1, 2, 6, 2, 4, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-RealWorld                 (3) | Train Loss: 1.1921 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 1.3163 | Train Acc: 0.7222
 Site-RealWorld                 (6) | Train Loss: 1.1642 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 1.2641 | Train Acc: 0.9032
 Site-RealWorld                 (0) | Train Loss: 1.3142 | Train Acc: 0.7750
 Site-RealWorld                 (6) | Train Loss: 1.2257 | Train Acc: 0.7843
 Site-RealWorld                 (6) | Train Loss: 0.9468 | Train Acc: 0.8209
 Site-RealWorld                 (0) | Train Loss: 1.1062 | Train Acc: 0.8721
 Site-RealWorld                 (0) | Train Loss: 1.1905 | Train Acc: 0.8919
 Site-RealWorld                 (0) | Train Loss: 1.0881 | Train Acc: 0.9306
 Site-Product                   (1) | Train Loss: 1.1742 | Train Acc: 0.8824
 Site-Product                   (1) | Train Loss: 1.5770 | Train Acc: 0.7083
 Site-Product                   (4) | Train Loss: 1.5270 | Train Acc: 0.7576
 Site-Product                   (0) | Train Loss: 1.3280 | Train Acc: 0.8043
 Site-Product                   (4) | Train Loss: 1.2086 | Train Acc: 0.8438
 Site-Product                   (4) | Train Loss: 1.2079 | Train Acc: 0.8764
 Site-Product                   (4) | Train Loss: 1.3132 | Train Acc: 0.8226
 Site-amazon                    (4) | Train Loss: 1.3347 | Train Acc: 0.7500
 Site-amazon                    (1) | Train Loss: 1.0180 | Train Acc: 0.9032
 Site-amazon                    (4) | Train Loss: 1.1388 | Train Acc: 0.8696
 Site-amazon                    (1) | Train Loss: 1.3779 | Train Acc: 0.8841
 Site-amazon                    (1) | Train Loss: 1.3477 | Train Acc: 0.7692
 Site-webcam                    (5) | Train Loss: 1.3608 | Train Acc: 0.8750
 Site-webcam                    (6) | Train Loss: 1.2685 | Train Acc: 0.8214
 Site-webcam                    (5) | Train Loss: 1.1682 | Train Acc: 0.9175
 Site-Art                       (2) | Train Loss: 1.8530 | Train Acc: 0.6190
 Site-Art                       (0) | Train Loss: 1.5693 | Train Acc: 0.7500
 Site-Clipart                   (0) | Train Loss: 1.8664 | Train Acc: 0.6353
 Site-dslr                      (3) | Train Loss: 1.1728 | Train Acc: 0.8966
Average Train Accuracy: 0.8238
 Site-RealWorld                 (3) | Val  Loss: 0.9684 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 1.0541 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.9269 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 1.2994 | Val  Acc: 0.9000
 Site-RealWorld                 (0) | Val  Loss: 1.2815 | Val  Acc: 0.8462
 Site-RealWorld                 (6) | Val  Loss: 1.0875 | Val  Acc: 0.8529
 Site-RealWorld                 (6) | Val  Loss: 1.1246 | Val  Acc: 0.8864
 Site-RealWorld                 (0) | Val  Loss: 1.2285 | Val  Acc: 0.8070
 Site-RealWorld                 (0) | Val  Loss: 1.4244 | Val  Acc: 0.8243
 Site-RealWorld                 (0) | Val  Loss: 1.2774 | Val  Acc: 0.8125
 Site-Product                   (1) | Val  Loss: 1.1756 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 1.3783 | Val  Acc: 0.8125
 Site-Product                   (4) | Val  Loss: 1.0504 | Val  Acc: 0.8636
 Site-Product                   (0) | Val  Loss: 0.9749 | Val  Acc: 0.9355
 Site-Product                   (4) | Val  Loss: 1.3939 | Val  Acc: 0.7674
 Site-Product                   (4) | Val  Loss: 1.2163 | Val  Acc: 0.8305
 Site-Product                   (4) | Val  Loss: 1.1888 | Val  Acc: 0.7927
 Site-amazon                    (4) | Val  Loss: 1.1259 | Val  Acc: 1.0000
 Site-amazon                    (1) | Val  Loss: 1.3872 | Val  Acc: 0.7000
 Site-amazon                    (4) | Val  Loss: 1.3240 | Val  Acc: 0.8065
 Site-amazon                    (1) | Val  Loss: 1.1416 | Val  Acc: 0.9130
 Site-amazon                    (1) | Val  Loss: 1.2198 | Val  Acc: 0.8841
 Site-webcam                    (5) | Val  Loss: 1.3360 | Val  Acc: 0.8571
 Site-webcam                    (6) | Val  Loss: 1.2955 | Val  Acc: 0.8378
 Site-webcam                    (5) | Val  Loss: 1.2065 | Val  Acc: 0.8906
 Site-Art                       (2) | Val  Loss: 1.4275 | Val  Acc: 0.7857
 Site-Art                       (0) | Val  Loss: 1.6003 | Val  Acc: 0.7321
 Site-Clipart                   (0) | Val  Loss: 1.6763 | Val  Acc: 0.6140
 Site-dslr                      (3) | Val  Loss: 1.0805 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8517
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.8889
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.9000
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.8462
 Best site-RealWorld                (6)  | Epoch:12 | Val Acc: 0.8529
 Best site-RealWorld                (6)  | Epoch:12 | Val Acc: 0.8864
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.8070
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.8243
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.8125
 Best site-Product                  (1)  | Epoch:12 | Val Acc: 0.9091
 Best site-Product                  (1)  | Epoch:12 | Val Acc: 0.8125
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.8636
 Best site-Product                  (0)  | Epoch:12 | Val Acc: 0.9355
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.7674
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.8305
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.7927
 Best site-amazon                   (4)  | Epoch:12 | Val Acc: 1.0000
 Best site-amazon                   (1)  | Epoch:12 | Val Acc: 0.7000
 Best site-amazon                   (4)  | Epoch:12 | Val Acc: 0.8065
 Best site-amazon                   (1)  | Epoch:12 | Val Acc: 0.9130
 Best site-amazon                   (1)  | Epoch:12 | Val Acc: 0.8841
 Best site-webcam                   (5)  | Epoch:12 | Val Acc: 0.8571
 Best site-webcam                   (6)  | Epoch:12 | Val Acc: 0.8378
 Best site-webcam                   (5)  | Epoch:12 | Val Acc: 0.8906
 Best site-Art                      (2)  | Epoch:12 | Val Acc: 0.7857
 Best site-Art                      (0)  | Epoch:12 | Val Acc: 0.7321
 Best site-Clipart                  (0)  | Epoch:12 | Val Acc: 0.6140
 Best site-dslr                     (3)  | Epoch:12 | Val Acc: 0.9474
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[6, 7, 3, 1, 3, 1, 8, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-RealWorld                 (6) | Train Loss: 1.1064 | Train Acc: 0.9286
 Site-RealWorld                 (1) | Train Loss: 1.1305 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 1.0421 | Train Acc: 0.9583
 Site-RealWorld                 (6) | Train Loss: 1.1127 | Train Acc: 0.9032
 Site-RealWorld                 (0) | Train Loss: 1.2345 | Train Acc: 0.7750
 Site-RealWorld                 (6) | Train Loss: 1.1272 | Train Acc: 0.8431
 Site-RealWorld                 (1) | Train Loss: 1.3125 | Train Acc: 0.8209
 Site-RealWorld                 (6) | Train Loss: 1.0439 | Train Acc: 0.8488
 Site-RealWorld                 (6) | Train Loss: 1.1141 | Train Acc: 0.8739
 Site-RealWorld                 (6) | Train Loss: 0.9959 | Train Acc: 0.9514
 Site-Product                   (5) | Train Loss: 1.0361 | Train Acc: 0.9412
 Site-Product                   (1) | Train Loss: 1.3941 | Train Acc: 0.7500
 Site-Product                   (2) | Train Loss: 1.4286 | Train Acc: 0.7273
 Site-Product                   (1) | Train Loss: 1.2171 | Train Acc: 0.8478
 Site-Product                   (2) | Train Loss: 1.1018 | Train Acc: 0.8906
 Site-Product                   (4) | Train Loss: 1.0539 | Train Acc: 0.8989
 Site-Product                   (4) | Train Loss: 1.1740 | Train Acc: 0.8790
 Site-amazon                    (1) | Train Loss: 1.1956 | Train Acc: 0.7500
 Site-amazon                    (3) | Train Loss: 0.9701 | Train Acc: 0.9032
 Site-amazon                    (4) | Train Loss: 1.0832 | Train Acc: 0.8913
 Site-amazon                    (2) | Train Loss: 1.2439 | Train Acc: 0.8696
 Site-amazon                    (1) | Train Loss: 1.2303 | Train Acc: 0.7885
 Site-webcam                    (0) | Train Loss: 1.3715 | Train Acc: 0.8438
 Site-webcam                    (0) | Train Loss: 1.2418 | Train Acc: 0.8571
 Site-webcam                    (0) | Train Loss: 1.1440 | Train Acc: 0.9072
 Site-Art                       (0) | Train Loss: 1.6825 | Train Acc: 0.6190
 Site-Art                       (1) | Train Loss: 1.5419 | Train Acc: 0.7619
 Site-Clipart                   (6) | Train Loss: 1.6298 | Train Acc: 0.6235
 Site-dslr                      (0) | Train Loss: 1.0827 | Train Acc: 0.8966
Average Train Accuracy: 0.8427
 Site-RealWorld                 (6) | Val  Loss: 1.0198 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 1.0093 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.8062 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 1.2272 | Val  Acc: 0.9000
 Site-RealWorld                 (0) | Val  Loss: 1.1699 | Val  Acc: 0.8846
 Site-RealWorld                 (6) | Val  Loss: 1.0199 | Val  Acc: 0.8529
 Site-RealWorld                 (1) | Val  Loss: 1.0684 | Val  Acc: 0.8864
 Site-RealWorld                 (6) | Val  Loss: 1.1859 | Val  Acc: 0.7895
 Site-RealWorld                 (6) | Val  Loss: 1.2833 | Val  Acc: 0.7973
 Site-RealWorld                 (6) | Val  Loss: 1.1791 | Val  Acc: 0.8438
 Site-Product                   (5) | Val  Loss: 1.2129 | Val  Acc: 0.8182
 Site-Product                   (1) | Val  Loss: 1.3007 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 0.9422 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.8836 | Val  Acc: 0.9032
 Site-Product                   (2) | Val  Loss: 1.1962 | Val  Acc: 0.8605
 Site-Product                   (4) | Val  Loss: 1.1575 | Val  Acc: 0.8814
 Site-Product                   (4) | Val  Loss: 1.1065 | Val  Acc: 0.8537
 Site-amazon                    (1) | Val  Loss: 1.0044 | Val  Acc: 0.8462
 Site-amazon                    (3) | Val  Loss: 1.2274 | Val  Acc: 0.8500
 Site-amazon                    (4) | Val  Loss: 1.2539 | Val  Acc: 0.8710
 Site-amazon                    (2) | Val  Loss: 1.0725 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 1.2277 | Val  Acc: 0.8841
 Site-webcam                    (0) | Val  Loss: 1.2825 | Val  Acc: 0.8571
 Site-webcam                    (0) | Val  Loss: 1.2431 | Val  Acc: 0.8378
 Site-webcam                    (0) | Val  Loss: 1.1098 | Val  Acc: 0.9219
 Site-Art                       (0) | Val  Loss: 1.3796 | Val  Acc: 0.8571
 Site-Art                       (1) | Val  Loss: 1.5808 | Val  Acc: 0.8036
 Site-Clipart                   (6) | Val  Loss: 1.5597 | Val  Acc: 0.7193
 Site-dslr                      (0) | Val  Loss: 1.0520 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8676
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.8889
 Best site-RealWorld                (1)  | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.9000
 Best site-RealWorld                (0)  | Epoch:13 | Val Acc: 0.8846
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.8529
 Best site-RealWorld                (1)  | Epoch:13 | Val Acc: 0.8864
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.7895
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.7973
 Best site-RealWorld                (6)  | Epoch:13 | Val Acc: 0.8438
 Best site-Product                  (5)  | Epoch:13 | Val Acc: 0.8182
 Best site-Product                  (1)  | Epoch:13 | Val Acc: 0.8125
 Best site-Product                  (2)  | Epoch:13 | Val Acc: 0.9091
 Best site-Product                  (1)  | Epoch:13 | Val Acc: 0.9032
 Best site-Product                  (2)  | Epoch:13 | Val Acc: 0.8605
 Best site-Product                  (4)  | Epoch:13 | Val Acc: 0.8814
 Best site-Product                  (4)  | Epoch:13 | Val Acc: 0.8537
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.8462
 Best site-amazon                   (3)  | Epoch:13 | Val Acc: 0.8500
 Best site-amazon                   (4)  | Epoch:13 | Val Acc: 0.8710
 Best site-amazon                   (2)  | Epoch:13 | Val Acc: 0.9348
 Best site-amazon                   (1)  | Epoch:13 | Val Acc: 0.8841
 Best site-webcam                   (0)  | Epoch:13 | Val Acc: 0.8571
 Best site-webcam                   (0)  | Epoch:13 | Val Acc: 0.8378
 Best site-webcam                   (0)  | Epoch:13 | Val Acc: 0.9219
 Best site-Art                      (0)  | Epoch:13 | Val Acc: 0.8571
 Best site-Art                      (1)  | Epoch:13 | Val Acc: 0.8036
 Best site-Clipart                  (6)  | Epoch:13 | Val Acc: 0.7193
 Best site-dslr                     (0)  | Epoch:13 | Val Acc: 0.8947
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[6, 3, 3, 2, 7, 2, 6, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-RealWorld                 (3) | Train Loss: 1.1113 | Train Acc: 0.8571
 Site-RealWorld                 (4) | Train Loss: 1.0893 | Train Acc: 0.8333
 Site-RealWorld                 (0) | Train Loss: 0.9881 | Train Acc: 0.9167
 Site-RealWorld                 (2) | Train Loss: 1.0601 | Train Acc: 0.9355
 Site-RealWorld                 (4) | Train Loss: 1.1672 | Train Acc: 0.7750
 Site-RealWorld                 (5) | Train Loss: 1.0091 | Train Acc: 0.8824
 Site-RealWorld                 (6) | Train Loss: 0.9819 | Train Acc: 0.8507
 Site-RealWorld                 (2) | Train Loss: 1.0114 | Train Acc: 0.8721
 Site-RealWorld                 (6) | Train Loss: 1.0054 | Train Acc: 0.9009
 Site-RealWorld                 (6) | Train Loss: 0.8767 | Train Acc: 0.9444
 Site-Product                   (0) | Train Loss: 0.8992 | Train Acc: 0.9412
 Site-Product                   (1) | Train Loss: 1.2526 | Train Acc: 0.7917
 Site-Product                   (2) | Train Loss: 1.3978 | Train Acc: 0.7879
 Site-Product                   (0) | Train Loss: 1.1379 | Train Acc: 0.7826
 Site-Product                   (0) | Train Loss: 1.0775 | Train Acc: 0.7969
 Site-Product                   (6) | Train Loss: 0.9733 | Train Acc: 0.9101
 Site-Product                   (6) | Train Loss: 1.1323 | Train Acc: 0.8065
 Site-amazon                    (0) | Train Loss: 1.1515 | Train Acc: 0.7500
 Site-amazon                    (6) | Train Loss: 0.8249 | Train Acc: 0.9355
 Site-amazon                    (1) | Train Loss: 1.0329 | Train Acc: 0.8696
 Site-amazon                    (0) | Train Loss: 0.9492 | Train Acc: 0.9275
 Site-amazon                    (1) | Train Loss: 1.2330 | Train Acc: 0.8173
 Site-webcam                    (4) | Train Loss: 1.2303 | Train Acc: 0.8750
 Site-webcam                    (4) | Train Loss: 1.1285 | Train Acc: 0.8929
 Site-webcam                    (4) | Train Loss: 1.0932 | Train Acc: 0.9072
 Site-Art                       (4) | Train Loss: 1.6021 | Train Acc: 0.6667
 Site-Art                       (5) | Train Loss: 1.4701 | Train Acc: 0.7857
 Site-Clipart                   (4) | Train Loss: 1.4951 | Train Acc: 0.6471
 Site-dslr                      (3) | Train Loss: 1.0148 | Train Acc: 0.8621
Average Train Accuracy: 0.8456
 Site-RealWorld                 (3) | Val  Loss: 0.8358 | Val  Acc: 0.8889
 Site-RealWorld                 (4) | Val  Loss: 0.9029 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.7727 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 1.0800 | Val  Acc: 0.9000
 Site-RealWorld                 (4) | Val  Loss: 1.1804 | Val  Acc: 0.8462
 Site-RealWorld                 (5) | Val  Loss: 0.8985 | Val  Acc: 0.8824
 Site-RealWorld                 (6) | Val  Loss: 0.9948 | Val  Acc: 0.8636
 Site-RealWorld                 (2) | Val  Loss: 1.0316 | Val  Acc: 0.8070
 Site-RealWorld                 (6) | Val  Loss: 1.1473 | Val  Acc: 0.8649
 Site-RealWorld                 (6) | Val  Loss: 1.1189 | Val  Acc: 0.8438
 Site-Product                   (0) | Val  Loss: 0.9384 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 1.0843 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 0.9204 | Val  Acc: 0.8182
 Site-Product                   (0) | Val  Loss: 0.7806 | Val  Acc: 0.9677
 Site-Product                   (0) | Val  Loss: 1.1988 | Val  Acc: 0.8140
 Site-Product                   (6) | Val  Loss: 1.0648 | Val  Acc: 0.8644
 Site-Product                   (6) | Val  Loss: 1.0547 | Val  Acc: 0.7805
 Site-amazon                    (0) | Val  Loss: 1.0005 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 1.2152 | Val  Acc: 0.7500
 Site-amazon                    (1) | Val  Loss: 1.2243 | Val  Acc: 0.7742
 Site-amazon                    (0) | Val  Loss: 1.0579 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 1.0755 | Val  Acc: 0.8696
 Site-webcam                    (4) | Val  Loss: 1.2033 | Val  Acc: 0.7619
 Site-webcam                    (4) | Val  Loss: 1.1640 | Val  Acc: 0.8649
 Site-webcam                    (4) | Val  Loss: 1.0632 | Val  Acc: 0.9375
 Site-Art                       (4) | Val  Loss: 1.2811 | Val  Acc: 0.8214
 Site-Art                       (5) | Val  Loss: 1.4087 | Val  Acc: 0.8036
 Site-Clipart                   (4) | Val  Loss: 1.5528 | Val  Acc: 0.7018
 Site-dslr                      (3) | Val  Loss: 0.9441 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8542
============ Train epoch 15 ============
cnt=[4, 5, 5, 2, 4, 6, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-RealWorld                 (3) | Train Loss: 1.1499 | Train Acc: 0.8571
 Site-RealWorld                 (2) | Train Loss: 1.0813 | Train Acc: 0.8333
 Site-RealWorld                 (2) | Train Loss: 0.8750 | Train Acc: 0.9583
 Site-RealWorld                 (6) | Train Loss: 0.8888 | Train Acc: 0.9355
 Site-RealWorld                 (6) | Train Loss: 1.0408 | Train Acc: 0.7750
 Site-RealWorld                 (2) | Train Loss: 0.9268 | Train Acc: 0.8627
 Site-RealWorld                 (6) | Train Loss: 0.9582 | Train Acc: 0.8209
 Site-RealWorld                 (5) | Train Loss: 0.9075 | Train Acc: 0.8721
 Site-RealWorld                 (2) | Train Loss: 0.9291 | Train Acc: 0.9369
 Site-RealWorld                 (5) | Train Loss: 0.8833 | Train Acc: 0.9653
 Site-Product                   (4) | Train Loss: 0.8291 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 1.2116 | Train Acc: 0.8333
 Site-Product                   (1) | Train Loss: 1.3454 | Train Acc: 0.7273
 Site-Product                   (5) | Train Loss: 1.1638 | Train Acc: 0.8261
 Site-Product                   (4) | Train Loss: 0.9947 | Train Acc: 0.8438
 Site-Product                   (5) | Train Loss: 0.8775 | Train Acc: 0.8764
 Site-Product                   (1) | Train Loss: 1.0279 | Train Acc: 0.8468
 Site-amazon                    (5) | Train Loss: 0.9878 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.7565 | Train Acc: 0.9032
 Site-amazon                    (1) | Train Loss: 1.0158 | Train Acc: 0.8478
 Site-amazon                    (4) | Train Loss: 0.8976 | Train Acc: 0.8986
 Site-amazon                    (1) | Train Loss: 1.0937 | Train Acc: 0.7885
 Site-webcam                    (0) | Train Loss: 1.1834 | Train Acc: 0.8750
 Site-webcam                    (0) | Train Loss: 1.0483 | Train Acc: 0.8571
 Site-webcam                    (0) | Train Loss: 0.9954 | Train Acc: 0.8763
 Site-Art                       (0) | Train Loss: 1.6343 | Train Acc: 0.6905
 Site-Art                       (2) | Train Loss: 1.5122 | Train Acc: 0.8095
 Site-Clipart                   (5) | Train Loss: 1.5528 | Train Acc: 0.6588
 Site-dslr                      (3) | Train Loss: 0.8733 | Train Acc: 0.9310
Average Train Accuracy: 0.8496
 Site-RealWorld                 (3) | Val  Loss: 0.8242 | Val  Acc: 0.8889
 Site-RealWorld                 (2) | Val  Loss: 0.8153 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.6425 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 1.0128 | Val  Acc: 0.9500
 Site-RealWorld                 (6) | Val  Loss: 1.0557 | Val  Acc: 0.8846
 Site-RealWorld                 (2) | Val  Loss: 0.8611 | Val  Acc: 0.8824
 Site-RealWorld                 (6) | Val  Loss: 0.9265 | Val  Acc: 0.8864
 Site-RealWorld                 (5) | Val  Loss: 0.9718 | Val  Acc: 0.8246
 Site-RealWorld                 (2) | Val  Loss: 1.0525 | Val  Acc: 0.8514
 Site-RealWorld                 (5) | Val  Loss: 0.9899 | Val  Acc: 0.8438
 Site-Product                   (4) | Val  Loss: 0.9224 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 1.0947 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.8081 | Val  Acc: 0.8636
 Site-Product                   (5) | Val  Loss: 0.7557 | Val  Acc: 0.9355
 Site-Product                   (4) | Val  Loss: 1.0132 | Val  Acc: 0.9070
 Site-Product                   (5) | Val  Loss: 0.9450 | Val  Acc: 0.8814
 Site-Product                   (1) | Val  Loss: 0.9853 | Val  Acc: 0.8415
 Site-amazon                    (5) | Val  Loss: 0.9138 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 1.1734 | Val  Acc: 0.7000
 Site-amazon                    (1) | Val  Loss: 1.1601 | Val  Acc: 0.8710
 Site-amazon                    (4) | Val  Loss: 0.9211 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 1.0037 | Val  Acc: 0.8986
 Site-webcam                    (0) | Val  Loss: 1.1049 | Val  Acc: 0.8571
 Site-webcam                    (0) | Val  Loss: 1.0459 | Val  Acc: 0.8919
 Site-webcam                    (0) | Val  Loss: 0.9086 | Val  Acc: 0.9531
 Site-Art                       (0) | Val  Loss: 1.2621 | Val  Acc: 0.8929
 Site-Art                       (2) | Val  Loss: 1.3617 | Val  Acc: 0.8214
 Site-Clipart                   (5) | Val  Loss: 1.4990 | Val  Acc: 0.7018
 Site-dslr                      (3) | Val  Loss: 0.8840 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8763
 Best site-RealWorld                (3)  | Epoch:15 | Val Acc: 0.8889
 Best site-RealWorld                (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:15 | Val Acc: 0.9500
 Best site-RealWorld                (6)  | Epoch:15 | Val Acc: 0.8846
 Best site-RealWorld                (2)  | Epoch:15 | Val Acc: 0.8824
 Best site-RealWorld                (6)  | Epoch:15 | Val Acc: 0.8864
 Best site-RealWorld                (5)  | Epoch:15 | Val Acc: 0.8246
 Best site-RealWorld                (2)  | Epoch:15 | Val Acc: 0.8514
 Best site-RealWorld                (5)  | Epoch:15 | Val Acc: 0.8438
 Best site-Product                  (4)  | Epoch:15 | Val Acc: 0.9091
 Best site-Product                  (4)  | Epoch:15 | Val Acc: 0.8750
 Best site-Product                  (1)  | Epoch:15 | Val Acc: 0.8636
 Best site-Product                  (5)  | Epoch:15 | Val Acc: 0.9355
 Best site-Product                  (4)  | Epoch:15 | Val Acc: 0.9070
 Best site-Product                  (5)  | Epoch:15 | Val Acc: 0.8814
 Best site-Product                  (1)  | Epoch:15 | Val Acc: 0.8415
 Best site-amazon                   (5)  | Epoch:15 | Val Acc: 0.7692
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.7000
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.8710
 Best site-amazon                   (4)  | Epoch:15 | Val Acc: 0.9348
 Best site-amazon                   (1)  | Epoch:15 | Val Acc: 0.8986
 Best site-webcam                   (0)  | Epoch:15 | Val Acc: 0.8571
 Best site-webcam                   (0)  | Epoch:15 | Val Acc: 0.8919
 Best site-webcam                   (0)  | Epoch:15 | Val Acc: 0.9531
 Best site-Art                      (0)  | Epoch:15 | Val Acc: 0.8929
 Best site-Art                      (2)  | Epoch:15 | Val Acc: 0.8214
 Best site-Clipart                  (5)  | Epoch:15 | Val Acc: 0.7018
 Best site-dslr                     (3)  | Epoch:15 | Val Acc: 0.8947
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 7, 6, 7, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-RealWorld                 (4) | Train Loss: 0.9631 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 1.0309 | Train Acc: 0.8889
 Site-RealWorld                 (5) | Train Loss: 0.8488 | Train Acc: 0.9167
 Site-RealWorld                 (1) | Train Loss: 0.9344 | Train Acc: 0.8710
 Site-RealWorld                 (1) | Train Loss: 0.9781 | Train Acc: 0.7750
 Site-RealWorld                 (1) | Train Loss: 0.8900 | Train Acc: 0.8824
 Site-RealWorld                 (3) | Train Loss: 1.0779 | Train Acc: 0.8209
 Site-RealWorld                 (5) | Train Loss: 0.9480 | Train Acc: 0.8256
 Site-RealWorld                 (1) | Train Loss: 0.8717 | Train Acc: 0.9009
 Site-RealWorld                 (5) | Train Loss: 0.7852 | Train Acc: 0.9722
 Site-Product                   (0) | Train Loss: 0.7790 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 1.2958 | Train Acc: 0.7083
 Site-Product                   (2) | Train Loss: 1.2731 | Train Acc: 0.6667
 Site-Product                   (3) | Train Loss: 1.0627 | Train Acc: 0.8043
 Site-Product                   (2) | Train Loss: 0.9169 | Train Acc: 0.8750
 Site-Product                   (3) | Train Loss: 0.9125 | Train Acc: 0.8652
 Site-Product                   (3) | Train Loss: 1.0263 | Train Acc: 0.8387
 Site-amazon                    (3) | Train Loss: 0.9410 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.7421 | Train Acc: 0.8710
 Site-amazon                    (2) | Train Loss: 0.8899 | Train Acc: 0.8696
 Site-amazon                    (2) | Train Loss: 1.0667 | Train Acc: 0.8986
 Site-amazon                    (2) | Train Loss: 1.0417 | Train Acc: 0.7981
 Site-webcam                    (6) | Train Loss: 1.1310 | Train Acc: 0.8125
 Site-webcam                    (1) | Train Loss: 0.9753 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 0.9166 | Train Acc: 0.8969
 Site-Art                       (6) | Train Loss: 1.5314 | Train Acc: 0.6905
 Site-Art                       (5) | Train Loss: 1.3248 | Train Acc: 0.8095
 Site-Clipart                   (3) | Train Loss: 1.5064 | Train Acc: 0.6000
 Site-dslr                      (1) | Train Loss: 0.8440 | Train Acc: 0.9138
Average Train Accuracy: 0.8382
 Site-RealWorld                 (4) | Val  Loss: 0.6674 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.8320 | Val  Acc: 0.9167
 Site-RealWorld                 (5) | Val  Loss: 0.6118 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.9422 | Val  Acc: 0.9500
 Site-RealWorld                 (1) | Val  Loss: 0.9427 | Val  Acc: 0.8846
 Site-RealWorld                 (1) | Val  Loss: 0.7782 | Val  Acc: 0.9706
 Site-RealWorld                 (3) | Val  Loss: 0.8020 | Val  Acc: 0.9091
 Site-RealWorld                 (5) | Val  Loss: 0.9770 | Val  Acc: 0.8246
 Site-RealWorld                 (1) | Val  Loss: 1.0428 | Val  Acc: 0.8243
 Site-RealWorld                 (5) | Val  Loss: 0.9446 | Val  Acc: 0.8438
 Site-Product                   (0) | Val  Loss: 0.8326 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 1.1169 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 0.7598 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 0.6942 | Val  Acc: 0.9355
 Site-Product                   (2) | Val  Loss: 1.0163 | Val  Acc: 0.7907
 Site-Product                   (3) | Val  Loss: 0.9441 | Val  Acc: 0.8814
 Site-Product                   (3) | Val  Loss: 0.8796 | Val  Acc: 0.8537
 Site-amazon                    (3) | Val  Loss: 0.8516 | Val  Acc: 0.9231
 Site-amazon                    (2) | Val  Loss: 0.9934 | Val  Acc: 0.8500
 Site-amazon                    (2) | Val  Loss: 1.0134 | Val  Acc: 0.8710
 Site-amazon                    (2) | Val  Loss: 0.8297 | Val  Acc: 0.9348
 Site-amazon                    (2) | Val  Loss: 0.9483 | Val  Acc: 0.8841
 Site-webcam                    (6) | Val  Loss: 1.1196 | Val  Acc: 0.8095
 Site-webcam                    (1) | Val  Loss: 0.9288 | Val  Acc: 0.9189
 Site-webcam                    (1) | Val  Loss: 0.9005 | Val  Acc: 0.9375
 Site-Art                       (6) | Val  Loss: 1.1513 | Val  Acc: 0.8214
 Site-Art                       (5) | Val  Loss: 1.2871 | Val  Acc: 0.7857
 Site-Clipart                   (3) | Val  Loss: 1.4243 | Val  Acc: 0.6667
 Site-dslr                      (1) | Val  Loss: 0.8205 | Val  Acc: 0.9474
Average Valid Accuracy: 0.8746
============ Train epoch 17 ============
cnt=[6, 7, 2, 4, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-RealWorld                 (2) | Train Loss: 0.7694 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.8402 | Train Acc: 0.8889
 Site-RealWorld                 (4) | Train Loss: 0.7476 | Train Acc: 0.9583
 Site-RealWorld                 (6) | Train Loss: 0.8413 | Train Acc: 0.9355
 Site-RealWorld                 (6) | Train Loss: 0.9879 | Train Acc: 0.8250
 Site-RealWorld                 (5) | Train Loss: 0.8046 | Train Acc: 0.8824
 Site-RealWorld                 (4) | Train Loss: 0.5758 | Train Acc: 0.8806
 Site-RealWorld                 (0) | Train Loss: 0.7583 | Train Acc: 0.8837
 Site-RealWorld                 (0) | Train Loss: 0.8260 | Train Acc: 0.9279
 Site-RealWorld                 (4) | Train Loss: 0.7493 | Train Acc: 0.9375
 Site-Product                   (3) | Train Loss: 0.7438 | Train Acc: 0.9412
 Site-Product                   (3) | Train Loss: 1.0740 | Train Acc: 0.8333
 Site-Product                   (1) | Train Loss: 1.1995 | Train Acc: 0.7576
 Site-Product                   (0) | Train Loss: 0.9892 | Train Acc: 0.8261
 Site-Product                   (1) | Train Loss: 0.8458 | Train Acc: 0.8750
 Site-Product                   (1) | Train Loss: 0.8110 | Train Acc: 0.9101
 Site-Product                   (1) | Train Loss: 0.9053 | Train Acc: 0.8871
 Site-amazon                    (1) | Train Loss: 0.8543 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.6387 | Train Acc: 0.9032
 Site-amazon                    (1) | Train Loss: 0.8217 | Train Acc: 0.8478
 Site-amazon                    (3) | Train Loss: 0.7902 | Train Acc: 0.8986
 Site-amazon                    (3) | Train Loss: 1.0337 | Train Acc: 0.8269
 Site-webcam                    (5) | Train Loss: 1.0177 | Train Acc: 0.7812
 Site-webcam                    (6) | Train Loss: 0.8554 | Train Acc: 0.8750
 Site-webcam                    (6) | Train Loss: 0.8094 | Train Acc: 0.9175
 Site-Art                       (0) | Train Loss: 1.4205 | Train Acc: 0.7381
 Site-Art                       (4) | Train Loss: 1.2725 | Train Acc: 0.8452
 Site-Clipart                   (0) | Train Loss: 1.3489 | Train Acc: 0.6824
 Site-dslr                      (2) | Train Loss: 0.7765 | Train Acc: 0.8793
Average Train Accuracy: 0.8663
 Site-RealWorld                 (2) | Val  Loss: 0.6888 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.6488 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.5312 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.9572 | Val  Acc: 0.9500
 Site-RealWorld                 (6) | Val  Loss: 0.8858 | Val  Acc: 0.8846
 Site-RealWorld                 (5) | Val  Loss: 0.7783 | Val  Acc: 0.9118
 Site-RealWorld                 (4) | Val  Loss: 0.8073 | Val  Acc: 0.8636
 Site-RealWorld                 (0) | Val  Loss: 0.8974 | Val  Acc: 0.7895
 Site-RealWorld                 (0) | Val  Loss: 0.9954 | Val  Acc: 0.8514
 Site-RealWorld                 (4) | Val  Loss: 0.8943 | Val  Acc: 0.8542
 Site-Product                   (3) | Val  Loss: 0.8687 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 0.8845 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.7498 | Val  Acc: 0.8636
 Site-Product                   (0) | Val  Loss: 0.6484 | Val  Acc: 0.9355
 Site-Product                   (1) | Val  Loss: 0.9855 | Val  Acc: 0.8372
 Site-Product                   (1) | Val  Loss: 0.8270 | Val  Acc: 0.8644
 Site-Product                   (1) | Val  Loss: 0.8367 | Val  Acc: 0.8537
 Site-amazon                    (1) | Val  Loss: 0.7625 | Val  Acc: 0.8462
 Site-amazon                    (1) | Val  Loss: 0.9346 | Val  Acc: 0.8500
 Site-amazon                    (1) | Val  Loss: 1.0059 | Val  Acc: 0.8387
 Site-amazon                    (3) | Val  Loss: 0.7676 | Val  Acc: 0.9348
 Site-amazon                    (3) | Val  Loss: 0.7799 | Val  Acc: 0.9130
 Site-webcam                    (5) | Val  Loss: 1.0275 | Val  Acc: 0.8095
 Site-webcam                    (6) | Val  Loss: 0.9366 | Val  Acc: 0.8649
 Site-webcam                    (6) | Val  Loss: 0.8668 | Val  Acc: 0.9219
 Site-Art                       (0) | Val  Loss: 1.0638 | Val  Acc: 0.8929
 Site-Art                       (4) | Val  Loss: 1.1812 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 1.3011 | Val  Acc: 0.6842
 Site-dslr                      (2) | Val  Loss: 0.7244 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8789
 Best site-RealWorld                (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:17 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:17 | Val Acc: 0.9500
 Best site-RealWorld                (6)  | Epoch:17 | Val Acc: 0.8846
 Best site-RealWorld                (5)  | Epoch:17 | Val Acc: 0.9118
 Best site-RealWorld                (4)  | Epoch:17 | Val Acc: 0.8636
 Best site-RealWorld                (0)  | Epoch:17 | Val Acc: 0.7895
 Best site-RealWorld                (0)  | Epoch:17 | Val Acc: 0.8514
 Best site-RealWorld                (4)  | Epoch:17 | Val Acc: 0.8542
 Best site-Product                  (3)  | Epoch:17 | Val Acc: 0.8182
 Best site-Product                  (3)  | Epoch:17 | Val Acc: 0.8750
 Best site-Product                  (1)  | Epoch:17 | Val Acc: 0.8636
 Best site-Product                  (0)  | Epoch:17 | Val Acc: 0.9355
 Best site-Product                  (1)  | Epoch:17 | Val Acc: 0.8372
 Best site-Product                  (1)  | Epoch:17 | Val Acc: 0.8644
 Best site-Product                  (1)  | Epoch:17 | Val Acc: 0.8537
 Best site-amazon                   (1)  | Epoch:17 | Val Acc: 0.8462
 Best site-amazon                   (1)  | Epoch:17 | Val Acc: 0.8500
 Best site-amazon                   (1)  | Epoch:17 | Val Acc: 0.8387
 Best site-amazon                   (3)  | Epoch:17 | Val Acc: 0.9348
 Best site-amazon                   (3)  | Epoch:17 | Val Acc: 0.9130
 Best site-webcam                   (5)  | Epoch:17 | Val Acc: 0.8095
 Best site-webcam                   (6)  | Epoch:17 | Val Acc: 0.8649
 Best site-webcam                   (6)  | Epoch:17 | Val Acc: 0.9219
 Best site-Art                      (0)  | Epoch:17 | Val Acc: 0.8929
 Best site-Art                      (4)  | Epoch:17 | Val Acc: 0.8571
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.6842
 Best site-dslr                     (2)  | Epoch:17 | Val Acc: 0.9211
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[4, 6, 4, 5, 2, 3, 5, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-RealWorld                 (4) | Train Loss: 0.8353 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 0.8765 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 0.7003 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.7517 | Train Acc: 0.9032
 Site-RealWorld                 (5) | Train Loss: 0.8785 | Train Acc: 0.8500
 Site-RealWorld                 (2) | Train Loss: 0.7437 | Train Acc: 0.9216
 Site-RealWorld                 (6) | Train Loss: 0.8664 | Train Acc: 0.8955
 Site-RealWorld                 (6) | Train Loss: 0.6790 | Train Acc: 0.8837
 Site-RealWorld                 (6) | Train Loss: 0.7185 | Train Acc: 0.9279
 Site-RealWorld                 (0) | Train Loss: 0.6798 | Train Acc: 0.9514
 Site-Product                   (1) | Train Loss: 0.6673 | Train Acc: 0.9412
 Site-Product                   (1) | Train Loss: 0.9769 | Train Acc: 0.7917
 Site-Product                   (0) | Train Loss: 1.1180 | Train Acc: 0.8182
 Site-Product                   (1) | Train Loss: 0.9378 | Train Acc: 0.8261
 Site-Product                   (3) | Train Loss: 0.8204 | Train Acc: 0.8750
 Site-Product                   (1) | Train Loss: 0.8297 | Train Acc: 0.8989
 Site-Product                   (3) | Train Loss: 0.8576 | Train Acc: 0.9032
 Site-amazon                    (3) | Train Loss: 0.9141 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.6924 | Train Acc: 0.8710
 Site-amazon                    (3) | Train Loss: 0.8052 | Train Acc: 0.8696
 Site-amazon                    (1) | Train Loss: 0.8503 | Train Acc: 0.8986
 Site-amazon                    (1) | Train Loss: 0.9108 | Train Acc: 0.8077
 Site-webcam                    (2) | Train Loss: 0.9023 | Train Acc: 0.9062
 Site-webcam                    (2) | Train Loss: 0.8723 | Train Acc: 0.8929
 Site-webcam                    (2) | Train Loss: 0.7655 | Train Acc: 0.9072
 Site-Art                       (5) | Train Loss: 1.3057 | Train Acc: 0.7143
 Site-Art                       (6) | Train Loss: 1.1126 | Train Acc: 0.7976
 Site-Clipart                   (0) | Train Loss: 1.2498 | Train Acc: 0.6706
 Site-dslr                      (4) | Train Loss: 0.7232 | Train Acc: 0.9138
Average Train Accuracy: 0.8697
 Site-RealWorld                 (4) | Val  Loss: 0.6398 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.7520 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.4783 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.8482 | Val  Acc: 0.9000
 Site-RealWorld                 (5) | Val  Loss: 0.8623 | Val  Acc: 0.8462
 Site-RealWorld                 (2) | Val  Loss: 0.7160 | Val  Acc: 0.9118
 Site-RealWorld                 (6) | Val  Loss: 0.7359 | Val  Acc: 0.8864
 Site-RealWorld                 (6) | Val  Loss: 0.8635 | Val  Acc: 0.7719
 Site-RealWorld                 (6) | Val  Loss: 0.9135 | Val  Acc: 0.8243
 Site-RealWorld                 (0) | Val  Loss: 0.8506 | Val  Acc: 0.8229
 Site-Product                   (1) | Val  Loss: 0.6455 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.9959 | Val  Acc: 0.8125
 Site-Product                   (0) | Val  Loss: 0.6329 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.6231 | Val  Acc: 0.9355
 Site-Product                   (3) | Val  Loss: 0.9546 | Val  Acc: 0.8605
 Site-Product                   (1) | Val  Loss: 0.8498 | Val  Acc: 0.8644
 Site-Product                   (3) | Val  Loss: 0.7860 | Val  Acc: 0.8293
 Site-amazon                    (3) | Val  Loss: 0.8289 | Val  Acc: 0.6923
 Site-amazon                    (3) | Val  Loss: 0.8907 | Val  Acc: 0.8500
 Site-amazon                    (3) | Val  Loss: 0.9427 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.6682 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.6526 | Val  Acc: 0.8986
 Site-webcam                    (2) | Val  Loss: 0.9102 | Val  Acc: 0.7619
 Site-webcam                    (2) | Val  Loss: 0.8631 | Val  Acc: 0.9189
 Site-webcam                    (2) | Val  Loss: 0.8114 | Val  Acc: 0.9375
 Site-Art                       (5) | Val  Loss: 1.0947 | Val  Acc: 0.8571
 Site-Art                       (6) | Val  Loss: 1.1602 | Val  Acc: 0.8393
 Site-Clipart                   (0) | Val  Loss: 1.3168 | Val  Acc: 0.7018
 Site-dslr                      (4) | Val  Loss: 0.7202 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8666
============ Train epoch 19 ============
cnt=[3, 7, 7, 4, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-RealWorld                 (5) | Train Loss: 0.7231 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 0.8163 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.7293 | Train Acc: 0.8750
 Site-RealWorld                 (1) | Train Loss: 0.7370 | Train Acc: 0.8710
 Site-RealWorld                 (5) | Train Loss: 0.8928 | Train Acc: 0.8250
 Site-RealWorld                 (3) | Train Loss: 0.7042 | Train Acc: 0.9020
 Site-RealWorld                 (1) | Train Loss: 0.9649 | Train Acc: 0.8507
 Site-RealWorld                 (1) | Train Loss: 0.6265 | Train Acc: 0.8837
 Site-RealWorld                 (1) | Train Loss: 0.6702 | Train Acc: 0.9189
 Site-RealWorld                 (1) | Train Loss: 0.6057 | Train Acc: 0.9375
 Site-Product                   (0) | Train Loss: 0.6340 | Train Acc: 0.8824
 Site-Product                   (6) | Train Loss: 0.9622 | Train Acc: 0.8333
 Site-Product                   (2) | Train Loss: 1.0610 | Train Acc: 0.7273
 Site-Product                   (2) | Train Loss: 0.8728 | Train Acc: 0.8913
 Site-Product                   (0) | Train Loss: 0.7247 | Train Acc: 0.8750
 Site-Product                   (2) | Train Loss: 0.7437 | Train Acc: 0.8652
 Site-Product                   (6) | Train Loss: 0.8114 | Train Acc: 0.8629
 Site-amazon                    (1) | Train Loss: 0.8072 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.5466 | Train Acc: 0.9677
 Site-amazon                    (0) | Train Loss: 0.7538 | Train Acc: 0.8913
 Site-amazon                    (2) | Train Loss: 0.7226 | Train Acc: 0.9130
 Site-amazon                    (2) | Train Loss: 0.9077 | Train Acc: 0.8173
 Site-webcam                    (3) | Train Loss: 0.8786 | Train Acc: 0.8438
 Site-webcam                    (1) | Train Loss: 0.7574 | Train Acc: 0.8929
 Site-webcam                    (3) | Train Loss: 0.7110 | Train Acc: 0.9485
 Site-Art                       (5) | Train Loss: 1.3289 | Train Acc: 0.7381
 Site-Art                       (2) | Train Loss: 1.0484 | Train Acc: 0.7976
 Site-Clipart                   (5) | Train Loss: 1.3403 | Train Acc: 0.6471
 Site-dslr                      (4) | Train Loss: 0.6560 | Train Acc: 0.8966
Average Train Accuracy: 0.8628
 Site-RealWorld                 (5) | Val  Loss: 0.6280 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.6628 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4601 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.7294 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.8503 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.6630 | Val  Acc: 0.8824
 Site-RealWorld                 (1) | Val  Loss: 0.7047 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.7961 | Val  Acc: 0.7895
 Site-RealWorld                 (1) | Val  Loss: 0.8248 | Val  Acc: 0.8378
 Site-RealWorld                 (1) | Val  Loss: 0.8033 | Val  Acc: 0.8542
 Site-Product                   (0) | Val  Loss: 0.8720 | Val  Acc: 0.9091
 Site-Product                   (6) | Val  Loss: 0.8394 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 0.6471 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 0.5190 | Val  Acc: 0.9355
 Site-Product                   (0) | Val  Loss: 0.8257 | Val  Acc: 0.9070
 Site-Product                   (2) | Val  Loss: 0.7342 | Val  Acc: 0.8983
 Site-Product                   (6) | Val  Loss: 0.7645 | Val  Acc: 0.8415
 Site-amazon                    (1) | Val  Loss: 0.7647 | Val  Acc: 0.8462
 Site-amazon                    (2) | Val  Loss: 0.8152 | Val  Acc: 0.8500
 Site-amazon                    (0) | Val  Loss: 0.9813 | Val  Acc: 0.8387
 Site-amazon                    (2) | Val  Loss: 0.6590 | Val  Acc: 0.9348
 Site-amazon                    (2) | Val  Loss: 0.7276 | Val  Acc: 0.8986
 Site-webcam                    (3) | Val  Loss: 0.9384 | Val  Acc: 0.8571
 Site-webcam                    (1) | Val  Loss: 0.8252 | Val  Acc: 0.9189
 Site-webcam                    (3) | Val  Loss: 0.6658 | Val  Acc: 0.9688
 Site-Art                       (5) | Val  Loss: 1.0508 | Val  Acc: 0.8571
 Site-Art                       (2) | Val  Loss: 1.1584 | Val  Acc: 0.8393
 Site-Clipart                   (5) | Val  Loss: 1.2433 | Val  Acc: 0.7544
 Site-dslr                      (4) | Val  Loss: 0.6159 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8882
 Best site-RealWorld                (5)  | Epoch:19 | Val Acc: 0.8889
 Best site-RealWorld                (5)  | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:19 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:19 | Val Acc: 0.9231
 Best site-RealWorld                (3)  | Epoch:19 | Val Acc: 0.8824
 Best site-RealWorld                (1)  | Epoch:19 | Val Acc: 0.9091
 Best site-RealWorld                (1)  | Epoch:19 | Val Acc: 0.7895
 Best site-RealWorld                (1)  | Epoch:19 | Val Acc: 0.8378
 Best site-RealWorld                (1)  | Epoch:19 | Val Acc: 0.8542
 Best site-Product                  (0)  | Epoch:19 | Val Acc: 0.9091
 Best site-Product                  (6)  | Epoch:19 | Val Acc: 0.8125
 Best site-Product                  (2)  | Epoch:19 | Val Acc: 0.9091
 Best site-Product                  (2)  | Epoch:19 | Val Acc: 0.9355
 Best site-Product                  (0)  | Epoch:19 | Val Acc: 0.9070
 Best site-Product                  (2)  | Epoch:19 | Val Acc: 0.8983
 Best site-Product                  (6)  | Epoch:19 | Val Acc: 0.8415
 Best site-amazon                   (1)  | Epoch:19 | Val Acc: 0.8462
 Best site-amazon                   (2)  | Epoch:19 | Val Acc: 0.8500
 Best site-amazon                   (0)  | Epoch:19 | Val Acc: 0.8387
 Best site-amazon                   (2)  | Epoch:19 | Val Acc: 0.9348
 Best site-amazon                   (2)  | Epoch:19 | Val Acc: 0.8986
 Best site-webcam                   (3)  | Epoch:19 | Val Acc: 0.8571
 Best site-webcam                   (1)  | Epoch:19 | Val Acc: 0.9189
 Best site-webcam                   (3)  | Epoch:19 | Val Acc: 0.9688
 Best site-Art                      (5)  | Epoch:19 | Val Acc: 0.8571
 Best site-Art                      (2)  | Epoch:19 | Val Acc: 0.8393
 Best site-Clipart                  (5)  | Epoch:19 | Val Acc: 0.7544
 Best site-dslr                     (4)  | Epoch:19 | Val Acc: 0.8947
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 20 ============
cnt=[3, 7, 4, 5, 1, 7, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-RealWorld                 (1) | Train Loss: 0.7483 | Train Acc: 0.9286
 Site-RealWorld                 (1) | Train Loss: 0.7117 | Train Acc: 0.8333
 Site-RealWorld                 (5) | Train Loss: 0.5853 | Train Acc: 0.9583
 Site-RealWorld                 (5) | Train Loss: 0.5888 | Train Acc: 0.9355
 Site-RealWorld                 (1) | Train Loss: 0.8497 | Train Acc: 0.8250
 Site-RealWorld                 (6) | Train Loss: 0.6284 | Train Acc: 0.9020
 Site-RealWorld                 (5) | Train Loss: 0.4963 | Train Acc: 0.8806
 Site-RealWorld                 (5) | Train Loss: 0.7030 | Train Acc: 0.8605
 Site-RealWorld                 (5) | Train Loss: 0.6569 | Train Acc: 0.9279
 Site-RealWorld                 (5) | Train Loss: 0.5513 | Train Acc: 0.9653
 Site-Product                   (3) | Train Loss: 0.6027 | Train Acc: 0.8824
 Site-Product                   (0) | Train Loss: 0.9036 | Train Acc: 0.7917
 Site-Product                   (2) | Train Loss: 1.0595 | Train Acc: 0.7879
 Site-Product                   (2) | Train Loss: 0.8403 | Train Acc: 0.8261
 Site-Product                   (0) | Train Loss: 0.7171 | Train Acc: 0.8906
 Site-Product                   (2) | Train Loss: 0.6252 | Train Acc: 0.8989
 Site-Product                   (3) | Train Loss: 0.7793 | Train Acc: 0.9032
 Site-amazon                    (3) | Train Loss: 0.7278 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.5150 | Train Acc: 0.9355
 Site-amazon                    (3) | Train Loss: 0.6889 | Train Acc: 0.8913
 Site-amazon                    (0) | Train Loss: 0.5441 | Train Acc: 0.9130
 Site-amazon                    (3) | Train Loss: 0.8906 | Train Acc: 0.7981
 Site-webcam                    (1) | Train Loss: 0.8678 | Train Acc: 0.9062
 Site-webcam                    (1) | Train Loss: 0.8274 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 0.6418 | Train Acc: 0.9278
 Site-Art                       (1) | Train Loss: 1.3141 | Train Acc: 0.7381
 Site-Art                       (5) | Train Loss: 1.0418 | Train Acc: 0.8571
 Site-Clipart                   (6) | Train Loss: 1.1483 | Train Acc: 0.6706
 Site-dslr                      (4) | Train Loss: 0.7035 | Train Acc: 0.8448
Average Train Accuracy: 0.8691
 Site-RealWorld                 (1) | Val  Loss: 0.4350 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.5069 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.3989 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.7045 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.6882 | Val  Acc: 0.9615
 Site-RealWorld                 (6) | Val  Loss: 0.6111 | Val  Acc: 0.9118
 Site-RealWorld                 (5) | Val  Loss: 0.6627 | Val  Acc: 0.9091
 Site-RealWorld                 (5) | Val  Loss: 0.7188 | Val  Acc: 0.8596
 Site-RealWorld                 (5) | Val  Loss: 0.7476 | Val  Acc: 0.8514
 Site-RealWorld                 (5) | Val  Loss: 0.7755 | Val  Acc: 0.8333
 Site-Product                   (3) | Val  Loss: 0.5552 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.7778 | Val  Acc: 0.9375
 Site-Product                   (2) | Val  Loss: 0.6430 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 0.5136 | Val  Acc: 0.9355
 Site-Product                   (0) | Val  Loss: 0.7784 | Val  Acc: 0.8605
 Site-Product                   (2) | Val  Loss: 0.6520 | Val  Acc: 0.8983
 Site-Product                   (3) | Val  Loss: 0.7385 | Val  Acc: 0.8902
 Site-amazon                    (3) | Val  Loss: 0.7067 | Val  Acc: 0.8462
 Site-amazon                    (2) | Val  Loss: 0.8131 | Val  Acc: 0.7500
 Site-amazon                    (3) | Val  Loss: 0.8717 | Val  Acc: 0.8710
 Site-amazon                    (0) | Val  Loss: 0.5848 | Val  Acc: 0.9565
 Site-amazon                    (3) | Val  Loss: 0.7382 | Val  Acc: 0.8986
 Site-webcam                    (1) | Val  Loss: 0.8628 | Val  Acc: 0.8571
 Site-webcam                    (1) | Val  Loss: 0.7309 | Val  Acc: 0.9459
 Site-webcam                    (1) | Val  Loss: 0.7185 | Val  Acc: 0.9219
 Site-Art                       (1) | Val  Loss: 0.9897 | Val  Acc: 0.8929
 Site-Art                       (5) | Val  Loss: 1.1219 | Val  Acc: 0.7679
 Site-Clipart                   (6) | Val  Loss: 1.3275 | Val  Acc: 0.7018
 Site-dslr                      (4) | Val  Loss: 0.6216 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8956
 Best site-RealWorld                (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:20 | Val Acc: 0.9615
 Best site-RealWorld                (6)  | Epoch:20 | Val Acc: 0.9118
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 0.9091
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 0.8596
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 0.8514
 Best site-RealWorld                (5)  | Epoch:20 | Val Acc: 0.8333
 Best site-Product                  (3)  | Epoch:20 | Val Acc: 0.9091
 Best site-Product                  (0)  | Epoch:20 | Val Acc: 0.9375
 Best site-Product                  (2)  | Epoch:20 | Val Acc: 0.9091
 Best site-Product                  (2)  | Epoch:20 | Val Acc: 0.9355
 Best site-Product                  (0)  | Epoch:20 | Val Acc: 0.8605
 Best site-Product                  (2)  | Epoch:20 | Val Acc: 0.8983
 Best site-Product                  (3)  | Epoch:20 | Val Acc: 0.8902
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.8462
 Best site-amazon                   (2)  | Epoch:20 | Val Acc: 0.7500
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.8710
 Best site-amazon                   (0)  | Epoch:20 | Val Acc: 0.9565
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.8986
 Best site-webcam                   (1)  | Epoch:20 | Val Acc: 0.8571
 Best site-webcam                   (1)  | Epoch:20 | Val Acc: 0.9459
 Best site-webcam                   (1)  | Epoch:20 | Val Acc: 0.9219
 Best site-Art                      (1)  | Epoch:20 | Val Acc: 0.8929
 Best site-Art                      (5)  | Epoch:20 | Val Acc: 0.7679
 Best site-Clipart                  (6)  | Epoch:20 | Val Acc: 0.7018
 Best site-dslr                     (4)  | Epoch:20 | Val Acc: 0.8947
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 2, 4, 5, 7, 2, 5, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-RealWorld                 (0) | Train Loss: 0.8631 | Train Acc: 0.8571
 Site-RealWorld                 (0) | Train Loss: 0.8413 | Train Acc: 0.8333
 Site-RealWorld                 (4) | Train Loss: 0.5725 | Train Acc: 0.9167
 Site-RealWorld                 (4) | Train Loss: 0.5846 | Train Acc: 0.9032
 Site-RealWorld                 (4) | Train Loss: 0.7647 | Train Acc: 0.8250
 Site-RealWorld                 (5) | Train Loss: 0.6341 | Train Acc: 0.8627
 Site-RealWorld                 (2) | Train Loss: 0.9322 | Train Acc: 0.8955
 Site-RealWorld                 (6) | Train Loss: 0.5493 | Train Acc: 0.8837
 Site-RealWorld                 (2) | Train Loss: 0.5940 | Train Acc: 0.9550
 Site-RealWorld                 (4) | Train Loss: 0.5588 | Train Acc: 0.9583
 Site-Product                   (2) | Train Loss: 0.6047 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.9573 | Train Acc: 0.8333
 Site-Product                   (6) | Train Loss: 0.9017 | Train Acc: 0.8485
 Site-Product                   (6) | Train Loss: 0.7740 | Train Acc: 0.9130
 Site-Product                   (1) | Train Loss: 0.6549 | Train Acc: 0.8906
 Site-Product                   (2) | Train Loss: 0.6113 | Train Acc: 0.8876
 Site-Product                   (6) | Train Loss: 0.7415 | Train Acc: 0.8710
 Site-amazon                    (3) | Train Loss: 0.7626 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.4935 | Train Acc: 0.9355
 Site-amazon                    (3) | Train Loss: 0.6163 | Train Acc: 0.8913
 Site-amazon                    (3) | Train Loss: 0.5148 | Train Acc: 0.8986
 Site-amazon                    (1) | Train Loss: 0.8340 | Train Acc: 0.7981
 Site-webcam                    (0) | Train Loss: 0.8133 | Train Acc: 0.8438
 Site-webcam                    (4) | Train Loss: 0.7061 | Train Acc: 0.9286
 Site-webcam                    (5) | Train Loss: 0.6040 | Train Acc: 0.9278
 Site-Art                       (4) | Train Loss: 1.2345 | Train Acc: 0.8095
 Site-Art                       (6) | Train Loss: 1.0389 | Train Acc: 0.8690
 Site-Clipart                   (4) | Train Loss: 1.3289 | Train Acc: 0.6353
 Site-dslr                      (0) | Train Loss: 0.6133 | Train Acc: 0.8793
Average Train Accuracy: 0.8719
 Site-RealWorld                 (0) | Val  Loss: 0.5437 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.5657 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3800 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.6618 | Val  Acc: 0.9500
 Site-RealWorld                 (4) | Val  Loss: 0.7200 | Val  Acc: 0.9231
 Site-RealWorld                 (5) | Val  Loss: 0.5283 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.6098 | Val  Acc: 0.8864
 Site-RealWorld                 (6) | Val  Loss: 0.7977 | Val  Acc: 0.7544
 Site-RealWorld                 (2) | Val  Loss: 0.7981 | Val  Acc: 0.8514
 Site-RealWorld                 (4) | Val  Loss: 0.7114 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.6632 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.6912 | Val  Acc: 0.9375
 Site-Product                   (6) | Val  Loss: 0.6442 | Val  Acc: 0.8636
 Site-Product                   (6) | Val  Loss: 0.5031 | Val  Acc: 0.9677
 Site-Product                   (1) | Val  Loss: 0.7368 | Val  Acc: 0.9070
 Site-Product                   (2) | Val  Loss: 0.6702 | Val  Acc: 0.9153
 Site-Product                   (6) | Val  Loss: 0.6886 | Val  Acc: 0.8780
 Site-amazon                    (3) | Val  Loss: 0.6263 | Val  Acc: 0.9231
 Site-amazon                    (3) | Val  Loss: 0.7316 | Val  Acc: 0.9000
 Site-amazon                    (3) | Val  Loss: 0.8847 | Val  Acc: 0.9032
 Site-amazon                    (3) | Val  Loss: 0.6183 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.6565 | Val  Acc: 0.8841
 Site-webcam                    (0) | Val  Loss: 0.8194 | Val  Acc: 0.8571
 Site-webcam                    (4) | Val  Loss: 0.7996 | Val  Acc: 0.8378
 Site-webcam                    (5) | Val  Loss: 0.6326 | Val  Acc: 0.9375
 Site-Art                       (4) | Val  Loss: 0.8577 | Val  Acc: 0.8929
 Site-Art                       (6) | Val  Loss: 0.9609 | Val  Acc: 0.8750
 Site-Clipart                   (4) | Val  Loss: 1.1183 | Val  Acc: 0.7544
 Site-dslr                      (0) | Val  Loss: 0.6067 | Val  Acc: 0.8684
Average Valid Accuracy: 0.8971
 Best site-RealWorld                (0)  | Epoch:21 | Val Acc: 0.8889
 Best site-RealWorld                (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:21 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:21 | Val Acc: 0.9500
 Best site-RealWorld                (4)  | Epoch:21 | Val Acc: 0.9231
 Best site-RealWorld                (5)  | Epoch:21 | Val Acc: 0.9412
 Best site-RealWorld                (2)  | Epoch:21 | Val Acc: 0.8864
 Best site-RealWorld                (6)  | Epoch:21 | Val Acc: 0.7544
 Best site-RealWorld                (2)  | Epoch:21 | Val Acc: 0.8514
 Best site-RealWorld                (4)  | Epoch:21 | Val Acc: 0.8750
 Best site-Product                  (2)  | Epoch:21 | Val Acc: 0.9091
 Best site-Product                  (3)  | Epoch:21 | Val Acc: 0.9375
 Best site-Product                  (6)  | Epoch:21 | Val Acc: 0.8636
 Best site-Product                  (6)  | Epoch:21 | Val Acc: 0.9677
 Best site-Product                  (1)  | Epoch:21 | Val Acc: 0.9070
 Best site-Product                  (2)  | Epoch:21 | Val Acc: 0.9153
 Best site-Product                  (6)  | Epoch:21 | Val Acc: 0.8780
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9231
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9000
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9032
 Best site-amazon                   (3)  | Epoch:21 | Val Acc: 0.9348
 Best site-amazon                   (1)  | Epoch:21 | Val Acc: 0.8841
 Best site-webcam                   (0)  | Epoch:21 | Val Acc: 0.8571
 Best site-webcam                   (4)  | Epoch:21 | Val Acc: 0.8378
 Best site-webcam                   (5)  | Epoch:21 | Val Acc: 0.9375
 Best site-Art                      (4)  | Epoch:21 | Val Acc: 0.8929
 Best site-Art                      (6)  | Epoch:21 | Val Acc: 0.8750
 Best site-Clipart                  (4)  | Epoch:21 | Val Acc: 0.7544
 Best site-dslr                     (0)  | Epoch:21 | Val Acc: 0.8684
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[4, 1, 12, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-RealWorld                 (1) | Train Loss: 0.8025 | Train Acc: 0.8571
 Site-RealWorld                 (5) | Train Loss: 0.6977 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.5923 | Train Acc: 0.9167
 Site-RealWorld                 (2) | Train Loss: 0.5522 | Train Acc: 0.9355
 Site-RealWorld                 (2) | Train Loss: 0.7695 | Train Acc: 0.8500
 Site-RealWorld                 (5) | Train Loss: 0.5593 | Train Acc: 0.9608
 Site-RealWorld                 (2) | Train Loss: 0.6387 | Train Acc: 0.9254
 Site-RealWorld                 (2) | Train Loss: 0.5707 | Train Acc: 0.8721
 Site-RealWorld                 (2) | Train Loss: 0.5750 | Train Acc: 0.9279
 Site-RealWorld                 (2) | Train Loss: 0.4249 | Train Acc: 0.9653
 Site-Product                   (4) | Train Loss: 0.5763 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.7698 | Train Acc: 0.8333
 Site-Product                   (2) | Train Loss: 0.8865 | Train Acc: 0.8182
 Site-Product                   (2) | Train Loss: 0.7086 | Train Acc: 0.8478
 Site-Product                   (0) | Train Loss: 0.6895 | Train Acc: 0.8594
 Site-Product                   (4) | Train Loss: 0.5234 | Train Acc: 0.9213
 Site-Product                   (0) | Train Loss: 0.6650 | Train Acc: 0.8871
 Site-amazon                    (0) | Train Loss: 0.8207 | Train Acc: 0.8000
 Site-amazon                    (2) | Train Loss: 0.4696 | Train Acc: 0.9355
 Site-amazon                    (4) | Train Loss: 0.6273 | Train Acc: 0.8696
 Site-amazon                    (0) | Train Loss: 0.5437 | Train Acc: 0.8986
 Site-amazon                    (4) | Train Loss: 0.8294 | Train Acc: 0.7788
 Site-webcam                    (3) | Train Loss: 0.8351 | Train Acc: 0.7812
 Site-webcam                    (5) | Train Loss: 0.6445 | Train Acc: 0.8929
 Site-webcam                    (5) | Train Loss: 0.5658 | Train Acc: 0.9381
 Site-Art                       (2) | Train Loss: 1.1841 | Train Acc: 0.7381
 Site-Art                       (2) | Train Loss: 1.1180 | Train Acc: 0.8214
 Site-Clipart                   (2) | Train Loss: 1.1051 | Train Acc: 0.6941
 Site-dslr                      (6) | Train Loss: 0.6307 | Train Acc: 0.8793
Average Train Accuracy: 0.8682
 Site-RealWorld                 (1) | Val  Loss: 0.4807 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.3772 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.3321 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.5862 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.6378 | Val  Acc: 0.9231
 Site-RealWorld                 (5) | Val  Loss: 0.5156 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.5831 | Val  Acc: 0.9091
 Site-RealWorld                 (2) | Val  Loss: 0.7257 | Val  Acc: 0.7895
 Site-RealWorld                 (2) | Val  Loss: 0.7322 | Val  Acc: 0.8514
 Site-RealWorld                 (2) | Val  Loss: 0.6770 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.4828 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.5995 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.5215 | Val  Acc: 0.8636
 Site-Product                   (2) | Val  Loss: 0.4485 | Val  Acc: 0.9355
 Site-Product                   (0) | Val  Loss: 0.7523 | Val  Acc: 0.8837
 Site-Product                   (4) | Val  Loss: 0.6514 | Val  Acc: 0.9153
 Site-Product                   (0) | Val  Loss: 0.6632 | Val  Acc: 0.8659
 Site-amazon                    (0) | Val  Loss: 0.6922 | Val  Acc: 0.8462
 Site-amazon                    (2) | Val  Loss: 0.7557 | Val  Acc: 0.9000
 Site-amazon                    (4) | Val  Loss: 0.8416 | Val  Acc: 0.8387
 Site-amazon                    (0) | Val  Loss: 0.5658 | Val  Acc: 0.9348
 Site-amazon                    (4) | Val  Loss: 0.6483 | Val  Acc: 0.8986
 Site-webcam                    (3) | Val  Loss: 0.7464 | Val  Acc: 0.8571
 Site-webcam                    (5) | Val  Loss: 0.7472 | Val  Acc: 0.8919
 Site-webcam                    (5) | Val  Loss: 0.6210 | Val  Acc: 0.9219
 Site-Art                       (2) | Val  Loss: 0.8561 | Val  Acc: 0.8571
 Site-Art                       (2) | Val  Loss: 0.9823 | Val  Acc: 0.8750
 Site-Clipart                   (2) | Val  Loss: 1.1882 | Val  Acc: 0.7368
 Site-dslr                      (6) | Val  Loss: 0.5605 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8933
============ Train epoch 23 ============
cnt=[4, 5, 2, 2, 5, 5, 6, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-RealWorld                 (0) | Train Loss: 0.6787 | Train Acc: 0.8571
 Site-RealWorld                 (6) | Train Loss: 0.6589 | Train Acc: 0.8333
 Site-RealWorld                 (1) | Train Loss: 0.5249 | Train Acc: 0.8750
 Site-RealWorld                 (1) | Train Loss: 0.5584 | Train Acc: 0.9355
 Site-RealWorld                 (3) | Train Loss: 0.7645 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.5402 | Train Acc: 0.9020
 Site-RealWorld                 (6) | Train Loss: 0.5641 | Train Acc: 0.8955
 Site-RealWorld                 (6) | Train Loss: 0.5882 | Train Acc: 0.8721
 Site-RealWorld                 (6) | Train Loss: 0.5366 | Train Acc: 0.9279
 Site-RealWorld                 (5) | Train Loss: 0.3972 | Train Acc: 0.9792
 Site-Product                   (4) | Train Loss: 0.5155 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.7700 | Train Acc: 0.8750
 Site-Product                   (5) | Train Loss: 0.8989 | Train Acc: 0.8182
 Site-Product                   (5) | Train Loss: 0.7225 | Train Acc: 0.8696
 Site-Product                   (4) | Train Loss: 0.6351 | Train Acc: 0.8750
 Site-Product                   (5) | Train Loss: 0.5296 | Train Acc: 0.9438
 Site-Product                   (1) | Train Loss: 0.6730 | Train Acc: 0.8710
 Site-amazon                    (4) | Train Loss: 0.7124 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.4654 | Train Acc: 0.9355
 Site-amazon                    (1) | Train Loss: 0.6296 | Train Acc: 0.8696
 Site-amazon                    (4) | Train Loss: 0.9277 | Train Acc: 0.8841
 Site-amazon                    (1) | Train Loss: 0.8053 | Train Acc: 0.8173
 Site-webcam                    (2) | Train Loss: 0.7658 | Train Acc: 0.7812
 Site-webcam                    (0) | Train Loss: 0.6418 | Train Acc: 0.9286
 Site-webcam                    (0) | Train Loss: 0.5331 | Train Acc: 0.9278
 Site-Art                       (3) | Train Loss: 1.0678 | Train Acc: 0.7381
 Site-Art                       (6) | Train Loss: 0.9680 | Train Acc: 0.7976
 Site-Clipart                   (6) | Train Loss: 1.2644 | Train Acc: 0.6824
 Site-dslr                      (2) | Train Loss: 0.5390 | Train Acc: 0.9138
Average Train Accuracy: 0.8712
 Site-RealWorld                 (0) | Val  Loss: 0.4419 | Val  Acc: 0.8889
 Site-RealWorld                 (6) | Val  Loss: 0.3938 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2694 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.5291 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.5859 | Val  Acc: 0.9615
 Site-RealWorld                 (0) | Val  Loss: 0.5199 | Val  Acc: 0.9412
 Site-RealWorld                 (6) | Val  Loss: 0.5884 | Val  Acc: 0.8864
 Site-RealWorld                 (6) | Val  Loss: 0.6738 | Val  Acc: 0.8246
 Site-RealWorld                 (6) | Val  Loss: 0.7515 | Val  Acc: 0.8514
 Site-RealWorld                 (5) | Val  Loss: 0.6564 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.5453 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.6533 | Val  Acc: 0.9375
 Site-Product                   (5) | Val  Loss: 0.4754 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.4130 | Val  Acc: 0.9355
 Site-Product                   (4) | Val  Loss: 0.6583 | Val  Acc: 0.9070
 Site-Product                   (5) | Val  Loss: 0.5685 | Val  Acc: 0.9322
 Site-Product                   (1) | Val  Loss: 0.5626 | Val  Acc: 0.8902
 Site-amazon                    (4) | Val  Loss: 0.6496 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.7128 | Val  Acc: 0.8000
 Site-amazon                    (1) | Val  Loss: 0.7639 | Val  Acc: 0.8710
 Site-amazon                    (4) | Val  Loss: 0.5466 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.5192 | Val  Acc: 0.9420
 Site-webcam                    (2) | Val  Loss: 0.7954 | Val  Acc: 0.8095
 Site-webcam                    (0) | Val  Loss: 0.7175 | Val  Acc: 0.8378
 Site-webcam                    (0) | Val  Loss: 0.5706 | Val  Acc: 0.9062
 Site-Art                       (3) | Val  Loss: 0.8026 | Val  Acc: 0.8929
 Site-Art                       (6) | Val  Loss: 0.9530 | Val  Acc: 0.8929
 Site-Clipart                   (6) | Val  Loss: 1.0919 | Val  Acc: 0.7719
 Site-dslr                      (2) | Val  Loss: 0.5008 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8956
============ Train epoch 24 ============
cnt=[2, 6, 3, 7, 5, 5, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-RealWorld                 (5) | Train Loss: 0.6798 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.6267 | Train Acc: 0.9444
 Site-RealWorld                 (3) | Train Loss: 0.5653 | Train Acc: 0.8750
 Site-RealWorld                 (1) | Train Loss: 0.5399 | Train Acc: 0.9355
 Site-RealWorld                 (5) | Train Loss: 0.7256 | Train Acc: 0.8500
 Site-RealWorld                 (3) | Train Loss: 0.5249 | Train Acc: 0.8824
 Site-RealWorld                 (3) | Train Loss: 0.6064 | Train Acc: 0.8955
 Site-RealWorld                 (1) | Train Loss: 0.5158 | Train Acc: 0.8837
 Site-RealWorld                 (3) | Train Loss: 0.5323 | Train Acc: 0.9279
 Site-RealWorld                 (3) | Train Loss: 0.4782 | Train Acc: 0.9722
 Site-Product                   (1) | Train Loss: 0.5770 | Train Acc: 0.8824
 Site-Product                   (2) | Train Loss: 0.7352 | Train Acc: 0.9167
 Site-Product                   (1) | Train Loss: 0.8212 | Train Acc: 0.8182
 Site-Product                   (4) | Train Loss: 0.7306 | Train Acc: 0.8261
 Site-Product                   (2) | Train Loss: 0.6088 | Train Acc: 0.8906
 Site-Product                   (1) | Train Loss: 0.6236 | Train Acc: 0.8876
 Site-Product                   (1) | Train Loss: 0.6375 | Train Acc: 0.8952
 Site-amazon                    (4) | Train Loss: 0.6543 | Train Acc: 0.9000
 Site-amazon                    (4) | Train Loss: 0.3849 | Train Acc: 0.9355
 Site-amazon                    (2) | Train Loss: 0.6357 | Train Acc: 0.8696
 Site-amazon                    (4) | Train Loss: 0.4406 | Train Acc: 0.8986
 Site-amazon                    (4) | Train Loss: 0.7981 | Train Acc: 0.8077
 Site-webcam                    (0) | Train Loss: 0.7285 | Train Acc: 0.8438
 Site-webcam                    (5) | Train Loss: 0.5942 | Train Acc: 0.9643
 Site-webcam                    (5) | Train Loss: 0.5624 | Train Acc: 0.9381
 Site-Art                       (5) | Train Loss: 1.1606 | Train Acc: 0.7619
 Site-Art                       (3) | Train Loss: 0.9460 | Train Acc: 0.8452
 Site-Clipart                   (3) | Train Loss: 1.1194 | Train Acc: 0.6588
 Site-dslr                      (6) | Train Loss: 0.5271 | Train Acc: 0.8621
Average Train Accuracy: 0.8792
 Site-RealWorld                 (5) | Val  Loss: 0.4591 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.5201 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2626 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.5613 | Val  Acc: 0.9000
 Site-RealWorld                 (5) | Val  Loss: 0.6342 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.4584 | Val  Acc: 0.9412
 Site-RealWorld                 (3) | Val  Loss: 0.5259 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.6680 | Val  Acc: 0.8246
 Site-RealWorld                 (3) | Val  Loss: 0.6447 | Val  Acc: 0.8784
 Site-RealWorld                 (3) | Val  Loss: 0.6074 | Val  Acc: 0.8958
 Site-Product                   (1) | Val  Loss: 0.6153 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 0.7864 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.4803 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.4416 | Val  Acc: 0.9355
 Site-Product                   (2) | Val  Loss: 0.7625 | Val  Acc: 0.7907
 Site-Product                   (1) | Val  Loss: 0.5396 | Val  Acc: 0.9322
 Site-Product                   (1) | Val  Loss: 0.6149 | Val  Acc: 0.8537
 Site-amazon                    (4) | Val  Loss: 0.7699 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.6955 | Val  Acc: 0.8500
 Site-amazon                    (2) | Val  Loss: 0.7940 | Val  Acc: 0.8710
 Site-amazon                    (4) | Val  Loss: 0.5634 | Val  Acc: 0.9130
 Site-amazon                    (4) | Val  Loss: 0.4882 | Val  Acc: 0.9130
 Site-webcam                    (0) | Val  Loss: 0.6911 | Val  Acc: 0.9048
 Site-webcam                    (5) | Val  Loss: 0.6842 | Val  Acc: 0.8649
 Site-webcam                    (5) | Val  Loss: 0.5492 | Val  Acc: 0.8750
 Site-Art                       (5) | Val  Loss: 0.8018 | Val  Acc: 0.8929
 Site-Art                       (3) | Val  Loss: 0.8548 | Val  Acc: 0.8393
 Site-Clipart                   (3) | Val  Loss: 1.0569 | Val  Acc: 0.7544
 Site-dslr                      (6) | Val  Loss: 0.4812 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8874
============ Train epoch 25 ============
cnt=[1, 5, 5, 9, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-RealWorld                 (2) | Train Loss: 0.6634 | Train Acc: 0.8571
 Site-RealWorld                 (4) | Train Loss: 0.7255 | Train Acc: 0.8333
 Site-RealWorld                 (1) | Train Loss: 0.5023 | Train Acc: 0.9167
 Site-RealWorld                 (2) | Train Loss: 0.4625 | Train Acc: 0.9032
 Site-RealWorld                 (2) | Train Loss: 0.7454 | Train Acc: 0.8250
 Site-RealWorld                 (2) | Train Loss: 0.4841 | Train Acc: 0.9412
 Site-RealWorld                 (1) | Train Loss: 0.3554 | Train Acc: 0.8955
 Site-RealWorld                 (1) | Train Loss: 0.4811 | Train Acc: 0.8605
 Site-RealWorld                 (2) | Train Loss: 0.5067 | Train Acc: 0.9279
 Site-RealWorld                 (1) | Train Loss: 0.3944 | Train Acc: 0.9583
 Site-Product                   (3) | Train Loss: 0.4414 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.7964 | Train Acc: 0.8750
 Site-Product                   (5) | Train Loss: 0.8331 | Train Acc: 0.8485
 Site-Product                   (3) | Train Loss: 0.6625 | Train Acc: 0.9130
 Site-Product                   (5) | Train Loss: 0.5695 | Train Acc: 0.9219
 Site-Product                   (3) | Train Loss: 0.5884 | Train Acc: 0.9101
 Site-Product                   (3) | Train Loss: 0.5996 | Train Acc: 0.8871
 Site-amazon                    (3) | Train Loss: 0.5996 | Train Acc: 0.9500
 Site-amazon                    (3) | Train Loss: 0.4134 | Train Acc: 0.9032
 Site-amazon                    (3) | Train Loss: 0.5636 | Train Acc: 0.8696
 Site-amazon                    (5) | Train Loss: 0.5672 | Train Acc: 0.8986
 Site-amazon                    (3) | Train Loss: 0.7451 | Train Acc: 0.8365
 Site-webcam                    (6) | Train Loss: 0.8126 | Train Acc: 0.8125
 Site-webcam                    (4) | Train Loss: 0.5908 | Train Acc: 0.8929
 Site-webcam                    (4) | Train Loss: 0.5079 | Train Acc: 0.9485
 Site-Art                       (4) | Train Loss: 1.0769 | Train Acc: 0.7381
 Site-Art                       (1) | Train Loss: 0.9060 | Train Acc: 0.8452
 Site-Clipart                   (4) | Train Loss: 1.1650 | Train Acc: 0.7294
 Site-dslr                      (0) | Train Loss: 0.5156 | Train Acc: 0.8966
Average Train Accuracy: 0.8785
 Site-RealWorld                 (2) | Val  Loss: 0.4263 | Val  Acc: 0.8889
 Site-RealWorld                 (4) | Val  Loss: 0.3060 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2579 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4992 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.5752 | Val  Acc: 0.9231
 Site-RealWorld                 (2) | Val  Loss: 0.4957 | Val  Acc: 0.8824
 Site-RealWorld                 (1) | Val  Loss: 0.5462 | Val  Acc: 0.8864
 Site-RealWorld                 (1) | Val  Loss: 0.6106 | Val  Acc: 0.8070
 Site-RealWorld                 (2) | Val  Loss: 0.7087 | Val  Acc: 0.8378
 Site-RealWorld                 (1) | Val  Loss: 0.5999 | Val  Acc: 0.8646
 Site-Product                   (3) | Val  Loss: 0.4479 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.6147 | Val  Acc: 0.9375
 Site-Product                   (5) | Val  Loss: 0.4421 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.4093 | Val  Acc: 0.9032
 Site-Product                   (5) | Val  Loss: 0.5989 | Val  Acc: 0.9302
 Site-Product                   (3) | Val  Loss: 0.5676 | Val  Acc: 0.9153
 Site-Product                   (3) | Val  Loss: 0.5550 | Val  Acc: 0.8537
 Site-amazon                    (3) | Val  Loss: 0.5679 | Val  Acc: 0.8462
 Site-amazon                    (3) | Val  Loss: 0.5644 | Val  Acc: 0.9000
 Site-amazon                    (3) | Val  Loss: 0.7679 | Val  Acc: 0.9032
 Site-amazon                    (5) | Val  Loss: 0.4898 | Val  Acc: 0.9348
 Site-amazon                    (3) | Val  Loss: 0.4822 | Val  Acc: 0.8986
 Site-webcam                    (6) | Val  Loss: 0.7619 | Val  Acc: 0.8095
 Site-webcam                    (4) | Val  Loss: 0.6688 | Val  Acc: 0.8649
 Site-webcam                    (4) | Val  Loss: 0.5168 | Val  Acc: 0.9375
 Site-Art                       (4) | Val  Loss: 0.7036 | Val  Acc: 0.8929
 Site-Art                       (1) | Val  Loss: 0.8645 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 1.0693 | Val  Acc: 0.7544
 Site-dslr                      (0) | Val  Loss: 0.4624 | Val  Acc: 0.9737
Average Valid Accuracy: 0.8973
 Best site-RealWorld                (2)  | Epoch:25 | Val Acc: 0.8889
 Best site-RealWorld                (4)  | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:25 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:25 | Val Acc: 0.9231
 Best site-RealWorld                (2)  | Epoch:25 | Val Acc: 0.8824
 Best site-RealWorld                (1)  | Epoch:25 | Val Acc: 0.8864
 Best site-RealWorld                (1)  | Epoch:25 | Val Acc: 0.8070
 Best site-RealWorld                (2)  | Epoch:25 | Val Acc: 0.8378
 Best site-RealWorld                (1)  | Epoch:25 | Val Acc: 0.8646
 Best site-Product                  (3)  | Epoch:25 | Val Acc: 0.9091
 Best site-Product                  (3)  | Epoch:25 | Val Acc: 0.9375
 Best site-Product                  (5)  | Epoch:25 | Val Acc: 0.9091
 Best site-Product                  (3)  | Epoch:25 | Val Acc: 0.9032
 Best site-Product                  (5)  | Epoch:25 | Val Acc: 0.9302
 Best site-Product                  (3)  | Epoch:25 | Val Acc: 0.9153
 Best site-Product                  (3)  | Epoch:25 | Val Acc: 0.8537
 Best site-amazon                   (3)  | Epoch:25 | Val Acc: 0.8462
 Best site-amazon                   (3)  | Epoch:25 | Val Acc: 0.9000
 Best site-amazon                   (3)  | Epoch:25 | Val Acc: 0.9032
 Best site-amazon                   (5)  | Epoch:25 | Val Acc: 0.9348
 Best site-amazon                   (3)  | Epoch:25 | Val Acc: 0.8986
 Best site-webcam                   (6)  | Epoch:25 | Val Acc: 0.8095
 Best site-webcam                   (4)  | Epoch:25 | Val Acc: 0.8649
 Best site-webcam                   (4)  | Epoch:25 | Val Acc: 0.9375
 Best site-Art                      (4)  | Epoch:25 | Val Acc: 0.8929
 Best site-Art                      (1)  | Epoch:25 | Val Acc: 0.8571
 Best site-Clipart                  (4)  | Epoch:25 | Val Acc: 0.7544
 Best site-dslr                     (0)  | Epoch:25 | Val Acc: 0.9737
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 26 ============
cnt=[6, 3, 5, 2, 1, 5, 7, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-RealWorld                 (2) | Train Loss: 0.7646 | Train Acc: 0.8571
 Site-RealWorld                 (0) | Train Loss: 0.6596 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 0.4533 | Train Acc: 0.9583
 Site-RealWorld                 (0) | Train Loss: 0.4701 | Train Acc: 0.9032
 Site-RealWorld                 (6) | Train Loss: 0.6867 | Train Acc: 0.8500
 Site-RealWorld                 (6) | Train Loss: 0.4219 | Train Acc: 0.9216
 Site-RealWorld                 (6) | Train Loss: 0.4290 | Train Acc: 0.8806
 Site-RealWorld                 (6) | Train Loss: 0.4694 | Train Acc: 0.8721
 Site-RealWorld                 (0) | Train Loss: 0.5031 | Train Acc: 0.9189
 Site-RealWorld                 (6) | Train Loss: 0.4158 | Train Acc: 0.9792
 Site-Product                   (5) | Train Loss: 0.5964 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.6305 | Train Acc: 0.9583
 Site-Product                   (4) | Train Loss: 0.8866 | Train Acc: 0.7879
 Site-Product                   (1) | Train Loss: 0.6944 | Train Acc: 0.8478
 Site-Product                   (1) | Train Loss: 0.5158 | Train Acc: 0.9219
 Site-Product                   (5) | Train Loss: 0.4359 | Train Acc: 0.9213
 Site-Product                   (5) | Train Loss: 0.5862 | Train Acc: 0.8871
 Site-amazon                    (6) | Train Loss: 0.6543 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.4145 | Train Acc: 0.9032
 Site-amazon                    (1) | Train Loss: 0.6301 | Train Acc: 0.8696
 Site-amazon                    (5) | Train Loss: 0.4944 | Train Acc: 0.8841
 Site-amazon                    (5) | Train Loss: 0.7026 | Train Acc: 0.8365
 Site-webcam                    (2) | Train Loss: 0.7303 | Train Acc: 0.7500
 Site-webcam                    (2) | Train Loss: 0.5430 | Train Acc: 0.9286
 Site-webcam                    (2) | Train Loss: 0.4824 | Train Acc: 0.9381
 Site-Art                       (0) | Train Loss: 1.0321 | Train Acc: 0.8095
 Site-Art                       (0) | Train Loss: 0.8754 | Train Acc: 0.8571
 Site-Clipart                   (0) | Train Loss: 1.1405 | Train Acc: 0.7059
 Site-dslr                      (2) | Train Loss: 0.4944 | Train Acc: 0.9138
Average Train Accuracy: 0.8768
 Site-RealWorld                 (2) | Val  Loss: 0.5057 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.3072 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2567 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.4126 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.5445 | Val  Acc: 0.9615
 Site-RealWorld                 (6) | Val  Loss: 0.4896 | Val  Acc: 0.9412
 Site-RealWorld                 (6) | Val  Loss: 0.5027 | Val  Acc: 0.8636
 Site-RealWorld                 (6) | Val  Loss: 0.6070 | Val  Acc: 0.8246
 Site-RealWorld                 (0) | Val  Loss: 0.5960 | Val  Acc: 0.8514
 Site-RealWorld                 (6) | Val  Loss: 0.6515 | Val  Acc: 0.8542
 Site-Product                   (5) | Val  Loss: 0.4337 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.6983 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.5276 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.4675 | Val  Acc: 0.9032
 Site-Product                   (1) | Val  Loss: 0.5865 | Val  Acc: 0.8605
 Site-Product                   (5) | Val  Loss: 0.5616 | Val  Acc: 0.9153
 Site-Product                   (5) | Val  Loss: 0.5659 | Val  Acc: 0.8780
 Site-amazon                    (6) | Val  Loss: 0.6025 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.6239 | Val  Acc: 0.8500
 Site-amazon                    (1) | Val  Loss: 0.6976 | Val  Acc: 0.8710
 Site-amazon                    (5) | Val  Loss: 0.4497 | Val  Acc: 0.9348
 Site-amazon                    (5) | Val  Loss: 0.4889 | Val  Acc: 0.9275
 Site-webcam                    (2) | Val  Loss: 0.7162 | Val  Acc: 0.9048
 Site-webcam                    (2) | Val  Loss: 0.6516 | Val  Acc: 0.8378
 Site-webcam                    (2) | Val  Loss: 0.4853 | Val  Acc: 0.9219
 Site-Art                       (0) | Val  Loss: 0.7146 | Val  Acc: 0.8929
 Site-Art                       (0) | Val  Loss: 0.8324 | Val  Acc: 0.8393
 Site-Clipart                   (0) | Val  Loss: 1.0118 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.4382 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8929
============ Train epoch 27 ============
cnt=[6, 4, 7, 1, 7, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-RealWorld                 (1) | Train Loss: 0.5696 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.6459 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.4705 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.4138 | Train Acc: 0.9355
 Site-RealWorld                 (1) | Train Loss: 0.6584 | Train Acc: 0.8500
 Site-RealWorld                 (6) | Train Loss: 0.4467 | Train Acc: 0.9412
 Site-RealWorld                 (0) | Train Loss: 0.3348 | Train Acc: 0.9254
 Site-RealWorld                 (4) | Train Loss: 0.5400 | Train Acc: 0.8721
 Site-RealWorld                 (0) | Train Loss: 0.4651 | Train Acc: 0.9459
 Site-RealWorld                 (0) | Train Loss: 0.3515 | Train Acc: 0.9792
 Site-Product                   (4) | Train Loss: 0.4262 | Train Acc: 0.8824
 Site-Product                   (2) | Train Loss: 0.7281 | Train Acc: 0.8750
 Site-Product                   (4) | Train Loss: 0.7392 | Train Acc: 0.8485
 Site-Product                   (4) | Train Loss: 0.7050 | Train Acc: 0.8478
 Site-Product                   (2) | Train Loss: 0.5633 | Train Acc: 0.8594
 Site-Product                   (2) | Train Loss: 0.5211 | Train Acc: 0.8989
 Site-Product                   (2) | Train Loss: 0.5475 | Train Acc: 0.9032
 Site-amazon                    (2) | Train Loss: 0.5197 | Train Acc: 0.9000
 Site-amazon                    (4) | Train Loss: 0.4029 | Train Acc: 0.9355
 Site-amazon                    (2) | Train Loss: 0.5191 | Train Acc: 0.9348
 Site-amazon                    (2) | Train Loss: 0.5049 | Train Acc: 0.8841
 Site-amazon                    (4) | Train Loss: 0.7382 | Train Acc: 0.8173
 Site-webcam                    (1) | Train Loss: 0.6689 | Train Acc: 0.9062
 Site-webcam                    (6) | Train Loss: 0.5558 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.5261 | Train Acc: 0.8969
 Site-Art                       (5) | Train Loss: 0.9093 | Train Acc: 0.7857
 Site-Art                       (4) | Train Loss: 0.7798 | Train Acc: 0.8690
 Site-Clipart                   (5) | Train Loss: 1.0098 | Train Acc: 0.7412
 Site-dslr                      (3) | Train Loss: 0.4397 | Train Acc: 0.8966
Average Train Accuracy: 0.8895
 Site-RealWorld                 (1) | Val  Loss: 0.3861 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.3784 | Val  Acc: 0.9167
 Site-RealWorld                 (0) | Val  Loss: 0.2336 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.4595 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.5211 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.4690 | Val  Acc: 0.9118
 Site-RealWorld                 (0) | Val  Loss: 0.4594 | Val  Acc: 0.9545
 Site-RealWorld                 (4) | Val  Loss: 0.6152 | Val  Acc: 0.8070
 Site-RealWorld                 (0) | Val  Loss: 0.5862 | Val  Acc: 0.8784
 Site-RealWorld                 (0) | Val  Loss: 0.5797 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.4107 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 0.6208 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.4395 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.4247 | Val  Acc: 0.9355
 Site-Product                   (2) | Val  Loss: 0.5748 | Val  Acc: 0.9070
 Site-Product                   (2) | Val  Loss: 0.5272 | Val  Acc: 0.9153
 Site-Product                   (2) | Val  Loss: 0.5587 | Val  Acc: 0.8537
 Site-amazon                    (2) | Val  Loss: 0.5810 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.6113 | Val  Acc: 0.8500
 Site-amazon                    (2) | Val  Loss: 0.7263 | Val  Acc: 0.8710
 Site-amazon                    (2) | Val  Loss: 0.4737 | Val  Acc: 0.9348
 Site-amazon                    (4) | Val  Loss: 0.4557 | Val  Acc: 0.9130
 Site-webcam                    (1) | Val  Loss: 0.6058 | Val  Acc: 0.9048
 Site-webcam                    (6) | Val  Loss: 0.5610 | Val  Acc: 0.9189
 Site-webcam                    (1) | Val  Loss: 0.4647 | Val  Acc: 0.9531
 Site-Art                       (5) | Val  Loss: 0.7431 | Val  Acc: 0.8571
 Site-Art                       (4) | Val  Loss: 0.8356 | Val  Acc: 0.8571
 Site-Clipart                   (5) | Val  Loss: 0.9733 | Val  Acc: 0.7544
 Site-dslr                      (3) | Val  Loss: 0.4303 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8944
============ Train epoch 28 ============
cnt=[8, 1, 6, 7, 1, 2, 4, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-RealWorld                 (6) | Train Loss: 0.5312 | Train Acc: 0.9286
 Site-RealWorld                 (6) | Train Loss: 0.7104 | Train Acc: 0.8333
 Site-RealWorld                 (0) | Train Loss: 0.5011 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.3893 | Train Acc: 0.9355
 Site-RealWorld                 (6) | Train Loss: 0.6152 | Train Acc: 0.8250
 Site-RealWorld                 (3) | Train Loss: 0.4714 | Train Acc: 0.9020
 Site-RealWorld                 (0) | Train Loss: 0.4158 | Train Acc: 0.9104
 Site-RealWorld                 (3) | Train Loss: 0.5724 | Train Acc: 0.8488
 Site-RealWorld                 (3) | Train Loss: 0.4467 | Train Acc: 0.9550
 Site-RealWorld                 (0) | Train Loss: 0.3635 | Train Acc: 0.9722
 Site-Product                   (0) | Train Loss: 0.4725 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.6493 | Train Acc: 0.8333
 Site-Product                   (2) | Train Loss: 0.7731 | Train Acc: 0.8182
 Site-Product                   (0) | Train Loss: 0.6460 | Train Acc: 0.8913
 Site-Product                   (5) | Train Loss: 0.5087 | Train Acc: 0.9219
 Site-Product                   (2) | Train Loss: 0.5166 | Train Acc: 0.9438
 Site-Product                   (2) | Train Loss: 0.5046 | Train Acc: 0.9032
 Site-amazon                    (2) | Train Loss: 0.5847 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.3770 | Train Acc: 0.9032
 Site-amazon                    (0) | Train Loss: 0.5572 | Train Acc: 0.8696
 Site-amazon                    (5) | Train Loss: 0.4780 | Train Acc: 0.9130
 Site-amazon                    (2) | Train Loss: 0.7007 | Train Acc: 0.7981
 Site-webcam                    (6) | Train Loss: 0.7138 | Train Acc: 0.8125
 Site-webcam                    (3) | Train Loss: 0.4342 | Train Acc: 0.9643
 Site-webcam                    (3) | Train Loss: 0.4981 | Train Acc: 0.9485
 Site-Art                       (3) | Train Loss: 0.9756 | Train Acc: 0.7619
 Site-Art                       (0) | Train Loss: 0.8053 | Train Acc: 0.8095
 Site-Clipart                   (3) | Train Loss: 1.0547 | Train Acc: 0.7176
 Site-dslr                      (1) | Train Loss: 0.4480 | Train Acc: 0.9138
Average Train Accuracy: 0.8773
 Site-RealWorld                 (6) | Val  Loss: 0.4662 | Val  Acc: 0.8889
 Site-RealWorld                 (6) | Val  Loss: 0.3140 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2149 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.3873 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.4822 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.4009 | Val  Acc: 0.9706
 Site-RealWorld                 (0) | Val  Loss: 0.4651 | Val  Acc: 0.9091
 Site-RealWorld                 (3) | Val  Loss: 0.5981 | Val  Acc: 0.8246
 Site-RealWorld                 (3) | Val  Loss: 0.5421 | Val  Acc: 0.9189
 Site-RealWorld                 (0) | Val  Loss: 0.5957 | Val  Acc: 0.8854
 Site-Product                   (0) | Val  Loss: 0.4775 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.7074 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.4847 | Val  Acc: 0.8636
 Site-Product                   (0) | Val  Loss: 0.4191 | Val  Acc: 0.9355
 Site-Product                   (5) | Val  Loss: 0.5646 | Val  Acc: 0.9302
 Site-Product                   (2) | Val  Loss: 0.4890 | Val  Acc: 0.9153
 Site-Product                   (2) | Val  Loss: 0.4516 | Val  Acc: 0.9268
 Site-amazon                    (2) | Val  Loss: 0.3875 | Val  Acc: 0.9231
 Site-amazon                    (2) | Val  Loss: 0.5850 | Val  Acc: 0.8500
 Site-amazon                    (0) | Val  Loss: 0.7387 | Val  Acc: 0.8387
 Site-amazon                    (5) | Val  Loss: 0.4522 | Val  Acc: 0.9348
 Site-amazon                    (2) | Val  Loss: 0.4383 | Val  Acc: 0.9275
 Site-webcam                    (6) | Val  Loss: 0.6133 | Val  Acc: 0.9048
 Site-webcam                    (3) | Val  Loss: 0.6670 | Val  Acc: 0.8649
 Site-webcam                    (3) | Val  Loss: 0.4319 | Val  Acc: 0.9688
 Site-Art                       (3) | Val  Loss: 0.7083 | Val  Acc: 0.9286
 Site-Art                       (0) | Val  Loss: 0.7935 | Val  Acc: 0.8393
 Site-Clipart                   (3) | Val  Loss: 0.9530 | Val  Acc: 0.7719
 Site-dslr                      (1) | Val  Loss: 0.3830 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9086
 Best site-RealWorld                (6)  | Epoch:28 | Val Acc: 0.8889
 Best site-RealWorld                (6)  | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:28 | Val Acc: 0.9231
 Best site-RealWorld                (3)  | Epoch:28 | Val Acc: 0.9706
 Best site-RealWorld                (0)  | Epoch:28 | Val Acc: 0.9091
 Best site-RealWorld                (3)  | Epoch:28 | Val Acc: 0.8246
 Best site-RealWorld                (3)  | Epoch:28 | Val Acc: 0.9189
 Best site-RealWorld                (0)  | Epoch:28 | Val Acc: 0.8854
 Best site-Product                  (0)  | Epoch:28 | Val Acc: 0.9091
 Best site-Product                  (4)  | Epoch:28 | Val Acc: 0.8750
 Best site-Product                  (2)  | Epoch:28 | Val Acc: 0.8636
 Best site-Product                  (0)  | Epoch:28 | Val Acc: 0.9355
 Best site-Product                  (5)  | Epoch:28 | Val Acc: 0.9302
 Best site-Product                  (2)  | Epoch:28 | Val Acc: 0.9153
 Best site-Product                  (2)  | Epoch:28 | Val Acc: 0.9268
 Best site-amazon                   (2)  | Epoch:28 | Val Acc: 0.9231
 Best site-amazon                   (2)  | Epoch:28 | Val Acc: 0.8500
 Best site-amazon                   (0)  | Epoch:28 | Val Acc: 0.8387
 Best site-amazon                   (5)  | Epoch:28 | Val Acc: 0.9348
 Best site-amazon                   (2)  | Epoch:28 | Val Acc: 0.9275
 Best site-webcam                   (6)  | Epoch:28 | Val Acc: 0.9048
 Best site-webcam                   (3)  | Epoch:28 | Val Acc: 0.8649
 Best site-webcam                   (3)  | Epoch:28 | Val Acc: 0.9688
 Best site-Art                      (3)  | Epoch:28 | Val Acc: 0.9286
 Best site-Art                      (0)  | Epoch:28 | Val Acc: 0.8393
 Best site-Clipart                  (3)  | Epoch:28 | Val Acc: 0.7719
 Best site-dslr                     (1)  | Epoch:28 | Val Acc: 0.9211
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 2, 2, 7, 5, 4, 5, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-RealWorld                 (2) | Train Loss: 0.5795 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.5890 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 0.4289 | Train Acc: 0.9167
 Site-RealWorld                 (3) | Train Loss: 0.4048 | Train Acc: 0.9032
 Site-RealWorld                 (3) | Train Loss: 0.6545 | Train Acc: 0.8250
 Site-RealWorld                 (6) | Train Loss: 0.4431 | Train Acc: 0.9412
 Site-RealWorld                 (4) | Train Loss: 0.4359 | Train Acc: 0.8806
 Site-RealWorld                 (4) | Train Loss: 0.4173 | Train Acc: 0.8953
 Site-RealWorld                 (4) | Train Loss: 0.4355 | Train Acc: 0.9369
 Site-RealWorld                 (3) | Train Loss: 0.3341 | Train Acc: 0.9653
 Site-Product                   (5) | Train Loss: 0.5014 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 0.7629 | Train Acc: 0.7917
 Site-Product                   (1) | Train Loss: 0.6281 | Train Acc: 0.9091
 Site-Product                   (6) | Train Loss: 0.6838 | Train Acc: 0.8478
 Site-Product                   (5) | Train Loss: 0.5287 | Train Acc: 0.8906
 Site-Product                   (3) | Train Loss: 0.5169 | Train Acc: 0.9438
 Site-Product                   (3) | Train Loss: 0.5423 | Train Acc: 0.9113
 Site-amazon                    (3) | Train Loss: 0.5905 | Train Acc: 0.8000
 Site-amazon                    (6) | Train Loss: 0.3887 | Train Acc: 0.9032
 Site-amazon                    (6) | Train Loss: 0.5694 | Train Acc: 0.8478
 Site-amazon                    (5) | Train Loss: 1.0613 | Train Acc: 0.8986
 Site-amazon                    (1) | Train Loss: 0.7196 | Train Acc: 0.8077
 Site-webcam                    (0) | Train Loss: 0.6489 | Train Acc: 0.9062
 Site-webcam                    (4) | Train Loss: 0.5066 | Train Acc: 0.8929
 Site-webcam                    (0) | Train Loss: 0.4352 | Train Acc: 0.9175
 Site-Art                       (0) | Train Loss: 0.8898 | Train Acc: 0.8571
 Site-Art                       (3) | Train Loss: 0.7989 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 1.0229 | Train Acc: 0.7294
 Site-dslr                      (2) | Train Loss: 0.4311 | Train Acc: 0.8966
Average Train Accuracy: 0.8799
 Site-RealWorld                 (2) | Val  Loss: 0.2031 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.3684 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1942 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4420 | Val  Acc: 0.9500
 Site-RealWorld                 (3) | Val  Loss: 0.5043 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.3596 | Val  Acc: 0.9706
 Site-RealWorld                 (4) | Val  Loss: 0.4506 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.4952 | Val  Acc: 0.8596
 Site-RealWorld                 (4) | Val  Loss: 0.4863 | Val  Acc: 0.9054
 Site-RealWorld                 (3) | Val  Loss: 0.5375 | Val  Acc: 0.8958
 Site-Product                   (5) | Val  Loss: 0.4226 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.3779 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.3557 | Val  Acc: 0.9091
 Site-Product                   (6) | Val  Loss: 0.3429 | Val  Acc: 0.9677
 Site-Product                   (5) | Val  Loss: 0.5237 | Val  Acc: 0.9302
 Site-Product                   (3) | Val  Loss: 0.5363 | Val  Acc: 0.8983
 Site-Product                   (3) | Val  Loss: 0.4960 | Val  Acc: 0.9024
 Site-amazon                    (3) | Val  Loss: 0.3839 | Val  Acc: 0.8462
 Site-amazon                    (6) | Val  Loss: 0.5795 | Val  Acc: 0.9000
 Site-amazon                    (6) | Val  Loss: 0.7199 | Val  Acc: 0.8710
 Site-amazon                    (5) | Val  Loss: 0.4507 | Val  Acc: 0.9565
 Site-amazon                    (1) | Val  Loss: 0.4350 | Val  Acc: 0.9420
 Site-webcam                    (0) | Val  Loss: 0.6455 | Val  Acc: 0.8571
 Site-webcam                    (4) | Val  Loss: 0.6234 | Val  Acc: 0.8919
 Site-webcam                    (0) | Val  Loss: 0.4426 | Val  Acc: 0.9531
 Site-Art                       (0) | Val  Loss: 0.7277 | Val  Acc: 0.7857
 Site-Art                       (3) | Val  Loss: 0.8046 | Val  Acc: 0.8929
 Site-Clipart                   (4) | Val  Loss: 0.9554 | Val  Acc: 0.7544
 Site-dslr                      (2) | Val  Loss: 0.4222 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9139
 Best site-RealWorld                (2)  | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:29 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:29 | Val Acc: 0.9500
 Best site-RealWorld                (3)  | Epoch:29 | Val Acc: 0.9231
 Best site-RealWorld                (6)  | Epoch:29 | Val Acc: 0.9706
 Best site-RealWorld                (4)  | Epoch:29 | Val Acc: 0.9091
 Best site-RealWorld                (4)  | Epoch:29 | Val Acc: 0.8596
 Best site-RealWorld                (4)  | Epoch:29 | Val Acc: 0.9054
 Best site-RealWorld                (3)  | Epoch:29 | Val Acc: 0.8958
 Best site-Product                  (5)  | Epoch:29 | Val Acc: 0.9091
 Best site-Product                  (5)  | Epoch:29 | Val Acc: 1.0000
 Best site-Product                  (1)  | Epoch:29 | Val Acc: 0.9091
 Best site-Product                  (6)  | Epoch:29 | Val Acc: 0.9677
 Best site-Product                  (5)  | Epoch:29 | Val Acc: 0.9302
 Best site-Product                  (3)  | Epoch:29 | Val Acc: 0.8983
 Best site-Product                  (3)  | Epoch:29 | Val Acc: 0.9024
 Best site-amazon                   (3)  | Epoch:29 | Val Acc: 0.8462
 Best site-amazon                   (6)  | Epoch:29 | Val Acc: 0.9000
 Best site-amazon                   (6)  | Epoch:29 | Val Acc: 0.8710
 Best site-amazon                   (5)  | Epoch:29 | Val Acc: 0.9565
 Best site-amazon                   (1)  | Epoch:29 | Val Acc: 0.9420
 Best site-webcam                   (0)  | Epoch:29 | Val Acc: 0.8571
 Best site-webcam                   (4)  | Epoch:29 | Val Acc: 0.8919
 Best site-webcam                   (0)  | Epoch:29 | Val Acc: 0.9531
 Best site-Art                      (0)  | Epoch:29 | Val Acc: 0.7857
 Best site-Art                      (3)  | Epoch:29 | Val Acc: 0.8929
 Best site-Clipart                  (4)  | Epoch:29 | Val Acc: 0.7544
 Best site-dslr                     (2)  | Epoch:29 | Val Acc: 0.9211
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 30 ============
cnt=[6, 3, 6, 3, 6, 1, 4, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-RealWorld                 (1) | Train Loss: 0.5754 | Train Acc: 0.9286
 Site-RealWorld                 (6) | Train Loss: 0.5874 | Train Acc: 0.8333
 Site-RealWorld                 (2) | Train Loss: 0.4321 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.3943 | Train Acc: 0.9355
 Site-RealWorld                 (0) | Train Loss: 0.6647 | Train Acc: 0.8250
 Site-RealWorld                 (0) | Train Loss: 0.4294 | Train Acc: 0.9216
 Site-RealWorld                 (0) | Train Loss: 0.3901 | Train Acc: 0.8955
 Site-RealWorld                 (6) | Train Loss: 0.5072 | Train Acc: 0.8953
 Site-RealWorld                 (6) | Train Loss: 0.4104 | Train Acc: 0.9369
 Site-RealWorld                 (0) | Train Loss: 0.3072 | Train Acc: 0.9792
 Site-Product                   (2) | Train Loss: 0.4113 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.7857 | Train Acc: 0.8750
 Site-Product                   (2) | Train Loss: 0.7812 | Train Acc: 0.8788
 Site-Product                   (4) | Train Loss: 0.6508 | Train Acc: 0.8696
 Site-Product                   (2) | Train Loss: 0.4936 | Train Acc: 0.9219
 Site-Product                   (4) | Train Loss: 0.4610 | Train Acc: 0.8989
 Site-Product                   (4) | Train Loss: 0.5374 | Train Acc: 0.9113
 Site-amazon                    (0) | Train Loss: 0.5397 | Train Acc: 0.9000
 Site-amazon                    (4) | Train Loss: 0.3193 | Train Acc: 0.9355
 Site-amazon                    (2) | Train Loss: 0.5255 | Train Acc: 0.9130
 Site-amazon                    (5) | Train Loss: 0.5198 | Train Acc: 0.8986
 Site-amazon                    (2) | Train Loss: 0.7149 | Train Acc: 0.8173
 Site-webcam                    (1) | Train Loss: 0.6078 | Train Acc: 0.8438
 Site-webcam                    (3) | Train Loss: 0.5066 | Train Acc: 0.9107
 Site-webcam                    (3) | Train Loss: 0.4793 | Train Acc: 0.9278
 Site-Art                       (3) | Train Loss: 1.0560 | Train Acc: 0.7857
 Site-Art                       (4) | Train Loss: 0.8077 | Train Acc: 0.8571
 Site-Clipart                   (6) | Train Loss: 0.8541 | Train Acc: 0.7176
 Site-dslr                      (1) | Train Loss: 0.4545 | Train Acc: 0.8793
Average Train Accuracy: 0.8859
 Site-RealWorld                 (1) | Val  Loss: 0.3807 | Val  Acc: 0.8889
 Site-RealWorld                 (6) | Val  Loss: 0.2919 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.2022 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.3616 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.5297 | Val  Acc: 0.9231
 Site-RealWorld                 (0) | Val  Loss: 0.3565 | Val  Acc: 0.9706
 Site-RealWorld                 (0) | Val  Loss: 0.4550 | Val  Acc: 0.9545
 Site-RealWorld                 (6) | Val  Loss: 0.5634 | Val  Acc: 0.8421
 Site-RealWorld                 (6) | Val  Loss: 0.5914 | Val  Acc: 0.8919
 Site-RealWorld                 (0) | Val  Loss: 0.5686 | Val  Acc: 0.8542
 Site-Product                   (2) | Val  Loss: 0.4550 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.7802 | Val  Acc: 0.8125
 Site-Product                   (2) | Val  Loss: 0.4014 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.3253 | Val  Acc: 0.9677
 Site-Product                   (2) | Val  Loss: 0.5675 | Val  Acc: 0.9070
 Site-Product                   (4) | Val  Loss: 0.4850 | Val  Acc: 0.9322
 Site-Product                   (4) | Val  Loss: 0.4546 | Val  Acc: 0.8902
 Site-amazon                    (0) | Val  Loss: 0.5033 | Val  Acc: 0.8462
 Site-amazon                    (4) | Val  Loss: 0.5566 | Val  Acc: 0.9500
 Site-amazon                    (2) | Val  Loss: 0.6812 | Val  Acc: 0.9032
 Site-amazon                    (5) | Val  Loss: 0.4276 | Val  Acc: 0.9348
 Site-amazon                    (2) | Val  Loss: 0.4325 | Val  Acc: 0.9275
 Site-webcam                    (1) | Val  Loss: 0.6799 | Val  Acc: 0.8571
 Site-webcam                    (3) | Val  Loss: 0.5218 | Val  Acc: 0.8919
 Site-webcam                    (3) | Val  Loss: 0.4156 | Val  Acc: 0.9375
 Site-Art                       (3) | Val  Loss: 0.6248 | Val  Acc: 0.8929
 Site-Art                       (4) | Val  Loss: 0.8187 | Val  Acc: 0.8214
 Site-Clipart                   (6) | Val  Loss: 0.9439 | Val  Acc: 0.7544
 Site-dslr                      (1) | Val  Loss: 0.3757 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9075
============ Train epoch 31 ============
cnt=[5, 4, 4, 1, 9, 3, 3, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-RealWorld                 (3) | Train Loss: 0.5739 | Train Acc: 0.8571
 Site-RealWorld                 (0) | Train Loss: 0.5850 | Train Acc: 0.8333
 Site-RealWorld                 (4) | Train Loss: 0.4421 | Train Acc: 0.8750
 Site-RealWorld                 (4) | Train Loss: 0.3468 | Train Acc: 0.9355
 Site-RealWorld                 (2) | Train Loss: 0.6756 | Train Acc: 0.8250
 Site-RealWorld                 (2) | Train Loss: 0.4387 | Train Acc: 0.9020
 Site-RealWorld                 (4) | Train Loss: 0.3014 | Train Acc: 0.9104
 Site-RealWorld                 (0) | Train Loss: 0.4793 | Train Acc: 0.9070
 Site-RealWorld                 (0) | Train Loss: 0.3786 | Train Acc: 0.9369
 Site-RealWorld                 (4) | Train Loss: 0.3764 | Train Acc: 0.9653
 Site-Product                   (0) | Train Loss: 0.5316 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.8041 | Train Acc: 0.7500
 Site-Product                   (1) | Train Loss: 0.7315 | Train Acc: 0.7576
 Site-Product                   (4) | Train Loss: 0.5639 | Train Acc: 0.8696
 Site-Product                   (1) | Train Loss: 0.4809 | Train Acc: 0.9219
 Site-Product                   (4) | Train Loss: 0.4716 | Train Acc: 0.9213
 Site-Product                   (5) | Train Loss: 0.5321 | Train Acc: 0.8790
 Site-amazon                    (5) | Train Loss: 0.5051 | Train Acc: 0.8500
 Site-amazon                    (4) | Train Loss: 0.3860 | Train Acc: 0.9355
 Site-amazon                    (1) | Train Loss: 0.4674 | Train Acc: 0.8913
 Site-amazon                    (1) | Train Loss: 0.3022 | Train Acc: 0.8986
 Site-amazon                    (5) | Train Loss: 0.6669 | Train Acc: 0.8462
 Site-webcam                    (2) | Train Loss: 0.5613 | Train Acc: 0.8750
 Site-webcam                    (6) | Train Loss: 0.4291 | Train Acc: 0.9464
 Site-webcam                    (6) | Train Loss: 0.3646 | Train Acc: 0.9485
 Site-Art                       (6) | Train Loss: 0.8656 | Train Acc: 0.8333
 Site-Art                       (4) | Train Loss: 0.7618 | Train Acc: 0.8690
 Site-Clipart                   (0) | Train Loss: 0.9293 | Train Acc: 0.7176
 Site-dslr                      (2) | Train Loss: 0.4356 | Train Acc: 0.8793
Average Train Accuracy: 0.8766
 Site-RealWorld                 (3) | Val  Loss: 0.3493 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.2308 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.1713 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3660 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4171 | Val  Acc: 0.9615
 Site-RealWorld                 (2) | Val  Loss: 0.3811 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.4072 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.5638 | Val  Acc: 0.8246
 Site-RealWorld                 (0) | Val  Loss: 0.5063 | Val  Acc: 0.8919
 Site-RealWorld                 (4) | Val  Loss: 0.5109 | Val  Acc: 0.9062
 Site-Product                   (0) | Val  Loss: 0.4404 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.5029 | Val  Acc: 0.9375
 Site-Product                   (1) | Val  Loss: 0.3881 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.2990 | Val  Acc: 0.9677
 Site-Product                   (1) | Val  Loss: 0.5040 | Val  Acc: 0.9535
 Site-Product                   (4) | Val  Loss: 0.4548 | Val  Acc: 0.9492
 Site-Product                   (5) | Val  Loss: 0.4632 | Val  Acc: 0.8902
 Site-amazon                    (5) | Val  Loss: 0.4865 | Val  Acc: 0.8462
 Site-amazon                    (4) | Val  Loss: 0.5474 | Val  Acc: 0.9000
 Site-amazon                    (1) | Val  Loss: 0.6692 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.4113 | Val  Acc: 0.9130
 Site-amazon                    (5) | Val  Loss: 0.3679 | Val  Acc: 0.9420
 Site-webcam                    (2) | Val  Loss: 0.6512 | Val  Acc: 0.8571
 Site-webcam                    (6) | Val  Loss: 0.5404 | Val  Acc: 0.8378
 Site-webcam                    (6) | Val  Loss: 0.3319 | Val  Acc: 0.9531
 Site-Art                       (6) | Val  Loss: 0.7504 | Val  Acc: 0.8214
 Site-Art                       (4) | Val  Loss: 0.6856 | Val  Acc: 0.8929
 Site-Clipart                   (0) | Val  Loss: 0.8631 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.3380 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9107
============ Train epoch 32 ============
cnt=[4, 6, 4, 1, 9, 2, 3, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-RealWorld                 (5) | Train Loss: 0.5261 | Train Acc: 0.9286
 Site-RealWorld                 (4) | Train Loss: 0.5589 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.3189 | Train Acc: 0.9583
 Site-RealWorld                 (2) | Train Loss: 0.4644 | Train Acc: 0.8710
 Site-RealWorld                 (4) | Train Loss: 0.5493 | Train Acc: 0.8500
 Site-RealWorld                 (4) | Train Loss: 0.3923 | Train Acc: 0.9020
 Site-RealWorld                 (4) | Train Loss: 0.2708 | Train Acc: 0.9403
 Site-RealWorld                 (4) | Train Loss: 0.4495 | Train Acc: 0.8605
 Site-RealWorld                 (4) | Train Loss: 0.3635 | Train Acc: 0.9369
 Site-RealWorld                 (1) | Train Loss: 0.2775 | Train Acc: 0.9861
 Site-Product                   (2) | Train Loss: 0.4665 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.5965 | Train Acc: 0.8750
 Site-Product                   (1) | Train Loss: 0.7006 | Train Acc: 0.8182
 Site-Product                   (4) | Train Loss: 0.5362 | Train Acc: 0.9130
 Site-Product                   (6) | Train Loss: 0.4360 | Train Acc: 0.8906
 Site-Product                   (1) | Train Loss: 0.4969 | Train Acc: 0.8989
 Site-Product                   (1) | Train Loss: 0.4579 | Train Acc: 0.9194
 Site-amazon                    (2) | Train Loss: 0.5447 | Train Acc: 0.9500
 Site-amazon                    (2) | Train Loss: 0.3897 | Train Acc: 0.9032
 Site-amazon                    (6) | Train Loss: 0.5484 | Train Acc: 0.9130
 Site-amazon                    (6) | Train Loss: 0.5815 | Train Acc: 0.8841
 Site-amazon                    (1) | Train Loss: 0.6792 | Train Acc: 0.8365
 Site-webcam                    (5) | Train Loss: 0.6176 | Train Acc: 0.8438
 Site-webcam                    (0) | Train Loss: 0.4535 | Train Acc: 0.9464
 Site-webcam                    (0) | Train Loss: 0.3993 | Train Acc: 0.9485
 Site-Art                       (0) | Train Loss: 0.9615 | Train Acc: 0.7619
 Site-Art                       (4) | Train Loss: 0.7467 | Train Acc: 0.8810
 Site-Clipart                   (4) | Train Loss: 0.9253 | Train Acc: 0.7647
 Site-dslr                      (0) | Train Loss: 0.4402 | Train Acc: 0.8793
Average Train Accuracy: 0.8908
 Site-RealWorld                 (5) | Val  Loss: 0.3850 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2783 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1784 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3885 | Val  Acc: 0.9500
 Site-RealWorld                 (4) | Val  Loss: 0.4202 | Val  Acc: 0.9231
 Site-RealWorld                 (4) | Val  Loss: 0.3906 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.5046 | Val  Acc: 0.8636
 Site-RealWorld                 (4) | Val  Loss: 0.5410 | Val  Acc: 0.8421
 Site-RealWorld                 (4) | Val  Loss: 0.4919 | Val  Acc: 0.8784
 Site-RealWorld                 (1) | Val  Loss: 0.5649 | Val  Acc: 0.8646
 Site-Product                   (2) | Val  Loss: 0.4875 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.5296 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.4149 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.2804 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.4914 | Val  Acc: 0.9302
 Site-Product                   (1) | Val  Loss: 0.4432 | Val  Acc: 0.9661
 Site-Product                   (1) | Val  Loss: 0.4461 | Val  Acc: 0.9024
 Site-amazon                    (2) | Val  Loss: 0.5165 | Val  Acc: 0.8462
 Site-amazon                    (2) | Val  Loss: 0.5737 | Val  Acc: 0.8500
 Site-amazon                    (6) | Val  Loss: 0.6424 | Val  Acc: 0.8387
 Site-amazon                    (6) | Val  Loss: 0.3984 | Val  Acc: 0.9565
 Site-amazon                    (1) | Val  Loss: 0.4132 | Val  Acc: 0.9275
 Site-webcam                    (5) | Val  Loss: 0.6263 | Val  Acc: 0.7619
 Site-webcam                    (0) | Val  Loss: 0.5009 | Val  Acc: 0.8919
 Site-webcam                    (0) | Val  Loss: 0.3983 | Val  Acc: 0.9531
 Site-Art                       (0) | Val  Loss: 0.5934 | Val  Acc: 0.8929
 Site-Art                       (4) | Val  Loss: 0.7295 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.9306 | Val  Acc: 0.7895
 Site-dslr                      (0) | Val  Loss: 0.3627 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9058
============ Train epoch 33 ============
cnt=[8, 5, 7, 1, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-RealWorld                 (2) | Train Loss: 0.5284 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.4861 | Train Acc: 0.8333
 Site-RealWorld                 (2) | Train Loss: 0.4088 | Train Acc: 0.8750
 Site-RealWorld                 (2) | Train Loss: 0.4001 | Train Acc: 0.9032
 Site-RealWorld                 (0) | Train Loss: 0.5672 | Train Acc: 0.8500
 Site-RealWorld                 (0) | Train Loss: 0.4122 | Train Acc: 0.8824
 Site-RealWorld                 (2) | Train Loss: 0.7768 | Train Acc: 0.9254
 Site-RealWorld                 (5) | Train Loss: 0.3958 | Train Acc: 0.8837
 Site-RealWorld                 (0) | Train Loss: 0.4156 | Train Acc: 0.9459
 Site-RealWorld                 (2) | Train Loss: 0.3079 | Train Acc: 0.9653
 Site-Product                   (6) | Train Loss: 0.4269 | Train Acc: 0.8824
 Site-Product                   (1) | Train Loss: 0.6780 | Train Acc: 0.8750
 Site-Product                   (4) | Train Loss: 0.6132 | Train Acc: 0.8485
 Site-Product                   (5) | Train Loss: 0.5287 | Train Acc: 0.9130
 Site-Product                   (1) | Train Loss: 0.4401 | Train Acc: 0.9219
 Site-Product                   (1) | Train Loss: 0.4069 | Train Acc: 0.9326
 Site-Product                   (1) | Train Loss: 0.4714 | Train Acc: 0.9194
 Site-amazon                    (6) | Train Loss: 0.5322 | Train Acc: 0.9000
 Site-amazon                    (2) | Train Loss: 0.3332 | Train Acc: 0.9032
 Site-amazon                    (1) | Train Loss: 0.4775 | Train Acc: 0.8913
 Site-amazon                    (4) | Train Loss: 0.3468 | Train Acc: 0.9130
 Site-amazon                    (6) | Train Loss: 0.7002 | Train Acc: 0.8269
 Site-webcam                    (0) | Train Loss: 0.6147 | Train Acc: 0.8438
 Site-webcam                    (0) | Train Loss: 0.4698 | Train Acc: 0.8929
 Site-webcam                    (0) | Train Loss: 0.3791 | Train Acc: 0.9278
 Site-Art                       (0) | Train Loss: 0.7657 | Train Acc: 0.8095
 Site-Art                       (2) | Train Loss: 0.6534 | Train Acc: 0.8810
 Site-Clipart                   (5) | Train Loss: 0.8940 | Train Acc: 0.7882
 Site-dslr                      (3) | Train Loss: 0.3866 | Train Acc: 0.9138
Average Train Accuracy: 0.8889
 Site-RealWorld                 (2) | Val  Loss: 0.2783 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.2660 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.1682 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3466 | Val  Acc: 0.9500
 Site-RealWorld                 (0) | Val  Loss: 0.3864 | Val  Acc: 0.9231
 Site-RealWorld                 (0) | Val  Loss: 0.4306 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.4337 | Val  Acc: 0.9091
 Site-RealWorld                 (5) | Val  Loss: 0.5453 | Val  Acc: 0.8596
 Site-RealWorld                 (0) | Val  Loss: 0.5357 | Val  Acc: 0.8784
 Site-RealWorld                 (2) | Val  Loss: 0.5359 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 0.3299 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.4120 | Val  Acc: 0.9375
 Site-Product                   (4) | Val  Loss: 0.2839 | Val  Acc: 0.9545
 Site-Product                   (5) | Val  Loss: 0.2822 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.5503 | Val  Acc: 0.8372
 Site-Product                   (1) | Val  Loss: 0.4841 | Val  Acc: 0.9322
 Site-Product                   (1) | Val  Loss: 0.4226 | Val  Acc: 0.9024
 Site-amazon                    (6) | Val  Loss: 0.4549 | Val  Acc: 0.9231
 Site-amazon                    (2) | Val  Loss: 0.5955 | Val  Acc: 0.8000
 Site-amazon                    (1) | Val  Loss: 0.6536 | Val  Acc: 0.8710
 Site-amazon                    (4) | Val  Loss: 0.3931 | Val  Acc: 0.9348
 Site-amazon                    (6) | Val  Loss: 0.3758 | Val  Acc: 0.9130
 Site-webcam                    (0) | Val  Loss: 0.6795 | Val  Acc: 0.8095
 Site-webcam                    (0) | Val  Loss: 0.4589 | Val  Acc: 0.9189
 Site-webcam                    (0) | Val  Loss: 0.3854 | Val  Acc: 0.9375
 Site-Art                       (0) | Val  Loss: 0.5855 | Val  Acc: 0.8929
 Site-Art                       (2) | Val  Loss: 0.7096 | Val  Acc: 0.8393
 Site-Clipart                   (5) | Val  Loss: 0.9339 | Val  Acc: 0.7368
 Site-dslr                      (3) | Val  Loss: 0.2988 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9051
============ Train epoch 34 ============
cnt=[5, 5, 1, 8, 2, 4, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-RealWorld                 (4) | Train Loss: 0.4589 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.5674 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 0.4549 | Train Acc: 0.8750
 Site-RealWorld                 (1) | Train Loss: 0.3383 | Train Acc: 0.9032
 Site-RealWorld                 (5) | Train Loss: 0.5653 | Train Acc: 0.8500
 Site-RealWorld                 (1) | Train Loss: 0.3591 | Train Acc: 0.9412
 Site-RealWorld                 (0) | Train Loss: 0.4832 | Train Acc: 0.9104
 Site-RealWorld                 (0) | Train Loss: 0.4822 | Train Acc: 0.8953
 Site-RealWorld                 (0) | Train Loss: 0.3919 | Train Acc: 0.9279
 Site-RealWorld                 (6) | Train Loss: 0.3185 | Train Acc: 0.9653
 Site-Product                   (6) | Train Loss: 0.4151 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.4237 | Train Acc: 0.9167
 Site-Product                   (3) | Train Loss: 0.6554 | Train Acc: 0.8182
 Site-Product                   (1) | Train Loss: 0.6016 | Train Acc: 0.8478
 Site-Product                   (3) | Train Loss: 0.4665 | Train Acc: 0.9375
 Site-Product                   (1) | Train Loss: 0.4759 | Train Acc: 0.9213
 Site-Product                   (3) | Train Loss: 0.4415 | Train Acc: 0.9113
 Site-amazon                    (3) | Train Loss: 0.5395 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.3357 | Train Acc: 0.9355
 Site-amazon                    (1) | Train Loss: 0.5255 | Train Acc: 0.8478
 Site-amazon                    (3) | Train Loss: 0.3897 | Train Acc: 0.8986
 Site-amazon                    (3) | Train Loss: 0.7047 | Train Acc: 0.8365
 Site-webcam                    (4) | Train Loss: 0.6425 | Train Acc: 0.7812
 Site-webcam                    (5) | Train Loss: 0.4487 | Train Acc: 0.8929
 Site-webcam                    (5) | Train Loss: 0.3838 | Train Acc: 0.9381
 Site-Art                       (5) | Train Loss: 0.9379 | Train Acc: 0.8095
 Site-Art                       (0) | Train Loss: 0.7185 | Train Acc: 0.8571
 Site-Clipart                   (6) | Train Loss: 0.8967 | Train Acc: 0.7529
 Site-dslr                      (2) | Train Loss: 0.3932 | Train Acc: 0.9138
Average Train Accuracy: 0.8838
 Site-RealWorld                 (4) | Val  Loss: 0.3192 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.3170 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1631 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3771 | Val  Acc: 0.9000
 Site-RealWorld                 (5) | Val  Loss: 0.3540 | Val  Acc: 0.9615
 Site-RealWorld                 (1) | Val  Loss: 0.3406 | Val  Acc: 0.9412
 Site-RealWorld                 (0) | Val  Loss: 0.3799 | Val  Acc: 0.9773
 Site-RealWorld                 (0) | Val  Loss: 0.5209 | Val  Acc: 0.8246
 Site-RealWorld                 (0) | Val  Loss: 0.6692 | Val  Acc: 0.8784
 Site-RealWorld                 (6) | Val  Loss: 0.4923 | Val  Acc: 0.8854
 Site-Product                   (6) | Val  Loss: 0.3389 | Val  Acc: 0.8182
 Site-Product                   (3) | Val  Loss: 0.4116 | Val  Acc: 0.9375
 Site-Product                   (3) | Val  Loss: 0.4699 | Val  Acc: 0.8636
 Site-Product                   (1) | Val  Loss: 0.3099 | Val  Acc: 0.9677
 Site-Product                   (3) | Val  Loss: 0.4796 | Val  Acc: 0.9070
 Site-Product                   (1) | Val  Loss: 0.4856 | Val  Acc: 0.8983
 Site-Product                   (3) | Val  Loss: 0.4649 | Val  Acc: 0.8780
 Site-amazon                    (3) | Val  Loss: 0.4539 | Val  Acc: 0.8462
 Site-amazon                    (3) | Val  Loss: 0.5495 | Val  Acc: 0.9000
 Site-amazon                    (1) | Val  Loss: 0.6410 | Val  Acc: 0.8710
 Site-amazon                    (3) | Val  Loss: 0.3447 | Val  Acc: 0.9565
 Site-amazon                    (3) | Val  Loss: 0.3766 | Val  Acc: 0.9275
 Site-webcam                    (4) | Val  Loss: 0.6120 | Val  Acc: 0.8571
 Site-webcam                    (5) | Val  Loss: 0.5746 | Val  Acc: 0.8378
 Site-webcam                    (5) | Val  Loss: 0.3608 | Val  Acc: 0.9219
 Site-Art                       (5) | Val  Loss: 0.5642 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6570 | Val  Acc: 0.8750
 Site-Clipart                   (6) | Val  Loss: 0.8922 | Val  Acc: 0.7544
 Site-dslr                      (2) | Val  Loss: 0.3734 | Val  Acc: 0.9211
Average Valid Accuracy: 0.8984
============ Train epoch 35 ============
cnt=[7, 6, 5, 1, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-RealWorld                 (1) | Train Loss: 0.3780 | Train Acc: 0.9286
 Site-RealWorld                 (6) | Train Loss: 0.5731 | Train Acc: 0.8333
 Site-RealWorld                 (1) | Train Loss: 0.3425 | Train Acc: 0.9583
 Site-RealWorld                 (4) | Train Loss: 0.3551 | Train Acc: 0.9355
 Site-RealWorld                 (1) | Train Loss: 0.5522 | Train Acc: 0.8500
 Site-RealWorld                 (2) | Train Loss: 0.4436 | Train Acc: 0.8824
 Site-RealWorld                 (2) | Train Loss: 0.5581 | Train Acc: 0.8955
 Site-RealWorld                 (2) | Train Loss: 0.4233 | Train Acc: 0.8837
 Site-RealWorld                 (4) | Train Loss: 0.3606 | Train Acc: 0.9369
 Site-RealWorld                 (5) | Train Loss: 0.2483 | Train Acc: 0.9792
 Site-Product                   (2) | Train Loss: 0.3672 | Train Acc: 0.8824
 Site-Product                   (0) | Train Loss: 0.4207 | Train Acc: 0.9167
 Site-Product                   (0) | Train Loss: 0.6712 | Train Acc: 0.8485
 Site-Product                   (2) | Train Loss: 0.4906 | Train Acc: 0.9130
 Site-Product                   (0) | Train Loss: 0.4534 | Train Acc: 0.9219
 Site-Product                   (5) | Train Loss: 0.4167 | Train Acc: 0.9101
 Site-Product                   (5) | Train Loss: 0.4713 | Train Acc: 0.9194
 Site-amazon                    (5) | Train Loss: 0.5454 | Train Acc: 0.8500
 Site-amazon                    (0) | Train Loss: 0.3145 | Train Acc: 0.9355
 Site-amazon                    (0) | Train Loss: 0.4880 | Train Acc: 0.8913
 Site-amazon                    (0) | Train Loss: 0.7919 | Train Acc: 0.8986
 Site-amazon                    (0) | Train Loss: 0.6374 | Train Acc: 0.8462
 Site-webcam                    (6) | Train Loss: 0.5765 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 0.3913 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.3715 | Train Acc: 0.9381
 Site-Art                       (1) | Train Loss: 0.8520 | Train Acc: 0.8095
 Site-Art                       (4) | Train Loss: 0.6611 | Train Acc: 0.8571
 Site-Clipart                   (4) | Train Loss: 0.8674 | Train Acc: 0.7294
 Site-dslr                      (3) | Train Loss: 0.4132 | Train Acc: 0.9310
Average Train Accuracy: 0.8926
 Site-RealWorld                 (1) | Val  Loss: 0.2845 | Val  Acc: 0.8889
 Site-RealWorld                 (6) | Val  Loss: 0.2226 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1427 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3297 | Val  Acc: 0.9500
 Site-RealWorld                 (1) | Val  Loss: 0.3938 | Val  Acc: 0.9615
 Site-RealWorld                 (2) | Val  Loss: 0.3766 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.3559 | Val  Acc: 0.9545
 Site-RealWorld                 (2) | Val  Loss: 0.5432 | Val  Acc: 0.8246
 Site-RealWorld                 (4) | Val  Loss: 0.5016 | Val  Acc: 0.8784
 Site-RealWorld                 (5) | Val  Loss: 0.4617 | Val  Acc: 0.8854
 Site-Product                   (2) | Val  Loss: 0.3995 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.4599 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.2528 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.2491 | Val  Acc: 0.9677
 Site-Product                   (0) | Val  Loss: 0.4885 | Val  Acc: 0.9070
 Site-Product                   (5) | Val  Loss: 0.4240 | Val  Acc: 0.9492
 Site-Product                   (5) | Val  Loss: 0.4234 | Val  Acc: 0.9024
 Site-amazon                    (5) | Val  Loss: 0.4528 | Val  Acc: 0.8462
 Site-amazon                    (0) | Val  Loss: 0.5210 | Val  Acc: 0.8500
 Site-amazon                    (0) | Val  Loss: 0.6733 | Val  Acc: 0.8065
 Site-amazon                    (0) | Val  Loss: 0.3136 | Val  Acc: 0.9565
 Site-amazon                    (0) | Val  Loss: 0.3704 | Val  Acc: 0.9130
 Site-webcam                    (6) | Val  Loss: 0.6731 | Val  Acc: 0.8095
 Site-webcam                    (1) | Val  Loss: 0.5322 | Val  Acc: 0.9189
 Site-webcam                    (1) | Val  Loss: 0.3539 | Val  Acc: 0.9375
 Site-Art                       (1) | Val  Loss: 0.6223 | Val  Acc: 0.8929
 Site-Art                       (4) | Val  Loss: 0.6729 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.8431 | Val  Acc: 0.7719
 Site-dslr                      (3) | Val  Loss: 0.3154 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9070
============ Train epoch 36 ============
cnt=[2, 7, 2, 5, 3, 5, 5, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-RealWorld                 (0) | Train Loss: 0.4753 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 0.5069 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 0.3649 | Train Acc: 0.9167
 Site-RealWorld                 (6) | Train Loss: 0.2898 | Train Acc: 0.9355
 Site-RealWorld                 (5) | Train Loss: 0.6153 | Train Acc: 0.8250
 Site-RealWorld                 (3) | Train Loss: 0.3616 | Train Acc: 0.9412
 Site-RealWorld                 (3) | Train Loss: 0.2817 | Train Acc: 0.8955
 Site-RealWorld                 (3) | Train Loss: 0.4078 | Train Acc: 0.8837
 Site-RealWorld                 (6) | Train Loss: 0.3793 | Train Acc: 0.9189
 Site-RealWorld                 (6) | Train Loss: 0.2898 | Train Acc: 0.9583
 Site-Product                   (3) | Train Loss: 0.3898 | Train Acc: 0.8824
 Site-Product                   (1) | Train Loss: 0.5946 | Train Acc: 0.8750
 Site-Product                   (1) | Train Loss: 0.6803 | Train Acc: 0.8485
 Site-Product                   (6) | Train Loss: 0.6319 | Train Acc: 0.8261
 Site-Product                   (4) | Train Loss: 0.4019 | Train Acc: 0.9219
 Site-Product                   (1) | Train Loss: 0.3973 | Train Acc: 0.9551
 Site-Product                   (1) | Train Loss: 0.4454 | Train Acc: 0.9194
 Site-amazon                    (4) | Train Loss: 0.4938 | Train Acc: 0.9500
 Site-amazon                    (4) | Train Loss: 0.2945 | Train Acc: 0.9355
 Site-amazon                    (1) | Train Loss: 0.4986 | Train Acc: 0.8696
 Site-amazon                    (1) | Train Loss: 1.0784 | Train Acc: 0.8986
 Site-amazon                    (1) | Train Loss: 0.6652 | Train Acc: 0.8269
 Site-webcam                    (2) | Train Loss: 0.6480 | Train Acc: 0.8438
 Site-webcam                    (5) | Train Loss: 0.4265 | Train Acc: 0.9107
 Site-webcam                    (5) | Train Loss: 0.4121 | Train Acc: 0.9278
 Site-Art                       (5) | Train Loss: 0.8567 | Train Acc: 0.8095
 Site-Art                       (3) | Train Loss: 0.6856 | Train Acc: 0.8452
 Site-Clipart                   (0) | Train Loss: 0.9127 | Train Acc: 0.7529
 Site-dslr                      (2) | Train Loss: 0.4026 | Train Acc: 0.8793
Average Train Accuracy: 0.8867
 Site-RealWorld                 (0) | Val  Loss: 0.3333 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.2158 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1537 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3031 | Val  Acc: 0.9500
 Site-RealWorld                 (5) | Val  Loss: 0.4270 | Val  Acc: 0.9615
 Site-RealWorld                 (3) | Val  Loss: 0.3820 | Val  Acc: 0.9118
 Site-RealWorld                 (3) | Val  Loss: 0.3933 | Val  Acc: 0.9318
 Site-RealWorld                 (3) | Val  Loss: 0.4934 | Val  Acc: 0.8421
 Site-RealWorld                 (6) | Val  Loss: 0.4836 | Val  Acc: 0.8919
 Site-RealWorld                 (6) | Val  Loss: 0.4682 | Val  Acc: 0.9062
 Site-Product                   (3) | Val  Loss: 0.3876 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.4779 | Val  Acc: 0.9375
 Site-Product                   (1) | Val  Loss: 0.3835 | Val  Acc: 0.9091
 Site-Product                   (6) | Val  Loss: 0.2544 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.4598 | Val  Acc: 0.9070
 Site-Product                   (1) | Val  Loss: 0.3867 | Val  Acc: 0.9322
 Site-Product                   (1) | Val  Loss: 0.4614 | Val  Acc: 0.8902
 Site-amazon                    (4) | Val  Loss: 0.3647 | Val  Acc: 0.9231
 Site-amazon                    (4) | Val  Loss: 0.4923 | Val  Acc: 0.8500
 Site-amazon                    (1) | Val  Loss: 0.6297 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.3749 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.4423 | Val  Acc: 0.9130
 Site-webcam                    (2) | Val  Loss: 0.5518 | Val  Acc: 0.9048
 Site-webcam                    (5) | Val  Loss: 0.4752 | Val  Acc: 0.9189
 Site-webcam                    (5) | Val  Loss: 0.3787 | Val  Acc: 0.9219
 Site-Art                       (5) | Val  Loss: 0.5262 | Val  Acc: 0.8929
 Site-Art                       (3) | Val  Loss: 0.6581 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.8273 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.3636 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9127
============ Train epoch 37 ============
cnt=[4, 4, 2, 4, 1, 10, 4, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-RealWorld                 (5) | Train Loss: 0.5318 | Train Acc: 0.8571
 Site-RealWorld                 (6) | Train Loss: 0.4895 | Train Acc: 0.8889
 Site-RealWorld                 (5) | Train Loss: 0.4234 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.4475 | Train Acc: 0.9032
 Site-RealWorld                 (6) | Train Loss: 0.5998 | Train Acc: 0.8250
 Site-RealWorld                 (5) | Train Loss: 0.3595 | Train Acc: 0.9216
 Site-RealWorld                 (5) | Train Loss: 0.5048 | Train Acc: 0.9254
 Site-RealWorld                 (0) | Train Loss: 0.4610 | Train Acc: 0.9070
 Site-RealWorld                 (0) | Train Loss: 0.3533 | Train Acc: 0.9279
 Site-RealWorld                 (5) | Train Loss: 0.2785 | Train Acc: 0.9792
 Site-Product                   (1) | Train Loss: 0.5439 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 0.7496 | Train Acc: 0.8333
 Site-Product                   (5) | Train Loss: 0.5030 | Train Acc: 0.9091
 Site-Product                   (0) | Train Loss: 0.5420 | Train Acc: 0.8913
 Site-Product                   (3) | Train Loss: 0.4427 | Train Acc: 0.9219
 Site-Product                   (1) | Train Loss: 0.4095 | Train Acc: 0.8989
 Site-Product                   (3) | Train Loss: 0.4346 | Train Acc: 0.9274
 Site-amazon                    (3) | Train Loss: 0.4788 | Train Acc: 0.9000
 Site-amazon                    (1) | Train Loss: 0.3155 | Train Acc: 0.9355
 Site-amazon                    (5) | Train Loss: 0.5313 | Train Acc: 0.8478
 Site-amazon                    (1) | Train Loss: 0.3520 | Train Acc: 0.9130
 Site-amazon                    (3) | Train Loss: 0.6336 | Train Acc: 0.8750
 Site-webcam                    (2) | Train Loss: 0.5388 | Train Acc: 0.8438
 Site-webcam                    (6) | Train Loss: 0.4145 | Train Acc: 0.8929
 Site-webcam                    (2) | Train Loss: 0.4011 | Train Acc: 0.9485
 Site-Art                       (6) | Train Loss: 0.9440 | Train Acc: 0.7857
 Site-Art                       (5) | Train Loss: 0.6054 | Train Acc: 0.8333
 Site-Clipart                   (5) | Train Loss: 0.9570 | Train Acc: 0.7647
 Site-dslr                      (4) | Train Loss: 0.3832 | Train Acc: 0.9138
Average Train Accuracy: 0.8872
 Site-RealWorld                 (5) | Val  Loss: 0.1779 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2340 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.1395 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2947 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3490 | Val  Acc: 0.9615
 Site-RealWorld                 (5) | Val  Loss: 0.2823 | Val  Acc: 0.9706
 Site-RealWorld                 (5) | Val  Loss: 0.3659 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.4504 | Val  Acc: 0.8772
 Site-RealWorld                 (0) | Val  Loss: 0.4726 | Val  Acc: 0.8919
 Site-RealWorld                 (5) | Val  Loss: 0.4793 | Val  Acc: 0.8854
 Site-Product                   (1) | Val  Loss: 0.2890 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.5120 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.2789 | Val  Acc: 0.9545
 Site-Product                   (0) | Val  Loss: 0.2956 | Val  Acc: 0.9355
 Site-Product                   (3) | Val  Loss: 0.4927 | Val  Acc: 0.9302
 Site-Product                   (1) | Val  Loss: 0.4090 | Val  Acc: 0.9322
 Site-Product                   (3) | Val  Loss: 0.4437 | Val  Acc: 0.9024
 Site-amazon                    (3) | Val  Loss: 0.3129 | Val  Acc: 0.9231
 Site-amazon                    (1) | Val  Loss: 0.4628 | Val  Acc: 0.9000
 Site-amazon                    (5) | Val  Loss: 0.6210 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.3700 | Val  Acc: 0.9348
 Site-amazon                    (3) | Val  Loss: 0.3964 | Val  Acc: 0.8986
 Site-webcam                    (2) | Val  Loss: 0.6618 | Val  Acc: 0.8571
 Site-webcam                    (6) | Val  Loss: 0.5832 | Val  Acc: 0.7838
 Site-webcam                    (2) | Val  Loss: 0.3733 | Val  Acc: 0.9375
 Site-Art                       (6) | Val  Loss: 0.5443 | Val  Acc: 0.9286
 Site-Art                       (5) | Val  Loss: 0.6271 | Val  Acc: 0.8750
 Site-Clipart                   (5) | Val  Loss: 0.8421 | Val  Acc: 0.7719
 Site-dslr                      (4) | Val  Loss: 0.3489 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9166
 Best site-RealWorld                (5)  | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:37 | Val Acc: 0.9615
 Best site-RealWorld                (5)  | Epoch:37 | Val Acc: 0.9706
 Best site-RealWorld                (5)  | Epoch:37 | Val Acc: 0.9545
 Best site-RealWorld                (0)  | Epoch:37 | Val Acc: 0.8772
 Best site-RealWorld                (0)  | Epoch:37 | Val Acc: 0.8919
 Best site-RealWorld                (5)  | Epoch:37 | Val Acc: 0.8854
 Best site-Product                  (1)  | Epoch:37 | Val Acc: 0.9091
 Best site-Product                  (5)  | Epoch:37 | Val Acc: 0.8750
 Best site-Product                  (5)  | Epoch:37 | Val Acc: 0.9545
 Best site-Product                  (0)  | Epoch:37 | Val Acc: 0.9355
 Best site-Product                  (3)  | Epoch:37 | Val Acc: 0.9302
 Best site-Product                  (1)  | Epoch:37 | Val Acc: 0.9322
 Best site-Product                  (3)  | Epoch:37 | Val Acc: 0.9024
 Best site-amazon                   (3)  | Epoch:37 | Val Acc: 0.9231
 Best site-amazon                   (1)  | Epoch:37 | Val Acc: 0.9000
 Best site-amazon                   (5)  | Epoch:37 | Val Acc: 0.8710
 Best site-amazon                   (1)  | Epoch:37 | Val Acc: 0.9348
 Best site-amazon                   (3)  | Epoch:37 | Val Acc: 0.8986
 Best site-webcam                   (2)  | Epoch:37 | Val Acc: 0.8571
 Best site-webcam                   (6)  | Epoch:37 | Val Acc: 0.7838
 Best site-webcam                   (2)  | Epoch:37 | Val Acc: 0.9375
 Best site-Art                      (6)  | Epoch:37 | Val Acc: 0.9286
 Best site-Art                      (5)  | Epoch:37 | Val Acc: 0.8750
 Best site-Clipart                  (5)  | Epoch:37 | Val Acc: 0.7719
 Best site-dslr                     (4)  | Epoch:37 | Val Acc: 0.9211
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 38 ============
cnt=[6, 5, 2, 6, 4, 4, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-RealWorld                 (2) | Train Loss: 0.4380 | Train Acc: 0.9286
 Site-RealWorld                 (3) | Train Loss: 0.4707 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.3293 | Train Acc: 0.9583
 Site-RealWorld                 (4) | Train Loss: 0.3573 | Train Acc: 0.9032
 Site-RealWorld                 (3) | Train Loss: 0.5714 | Train Acc: 0.8500
 Site-RealWorld                 (3) | Train Loss: 0.3692 | Train Acc: 0.9020
 Site-RealWorld                 (4) | Train Loss: 0.5172 | Train Acc: 0.9403
 Site-RealWorld                 (0) | Train Loss: 0.3540 | Train Acc: 0.9186
 Site-RealWorld                 (0) | Train Loss: 0.3384 | Train Acc: 0.9279
 Site-RealWorld                 (4) | Train Loss: 0.2757 | Train Acc: 0.9792
 Site-Product                   (1) | Train Loss: 0.4511 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.4471 | Train Acc: 0.9167
 Site-Product                   (1) | Train Loss: 0.4905 | Train Acc: 0.8788
 Site-Product                   (0) | Train Loss: 0.5268 | Train Acc: 0.8696
 Site-Product                   (5) | Train Loss: 0.4337 | Train Acc: 0.8906
 Site-Product                   (1) | Train Loss: 0.3510 | Train Acc: 0.9101
 Site-Product                   (5) | Train Loss: 0.4319 | Train Acc: 0.9194
 Site-amazon                    (1) | Train Loss: 0.4274 | Train Acc: 0.9000
 Site-amazon                    (6) | Train Loss: 0.3552 | Train Acc: 0.8710
 Site-amazon                    (5) | Train Loss: 0.3736 | Train Acc: 0.9348
 Site-amazon                    (5) | Train Loss: 0.4064 | Train Acc: 0.9275
 Site-amazon                    (1) | Train Loss: 0.5943 | Train Acc: 0.8558
 Site-webcam                    (3) | Train Loss: 0.5442 | Train Acc: 0.8750
 Site-webcam                    (3) | Train Loss: 0.3417 | Train Acc: 0.9643
 Site-webcam                    (6) | Train Loss: 0.3540 | Train Acc: 0.9278
 Site-Art                       (3) | Train Loss: 0.7781 | Train Acc: 0.8333
 Site-Art                       (0) | Train Loss: 0.6267 | Train Acc: 0.8452
 Site-Clipart                   (0) | Train Loss: 0.8992 | Train Acc: 0.7882
 Site-dslr                      (2) | Train Loss: 0.3592 | Train Acc: 0.9310
Average Train Accuracy: 0.9006
 Site-RealWorld                 (2) | Val  Loss: 0.2843 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.3065 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1236 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2692 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.3758 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.3948 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.3265 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.5256 | Val  Acc: 0.8421
 Site-RealWorld                 (0) | Val  Loss: 0.5263 | Val  Acc: 0.8919
 Site-RealWorld                 (4) | Val  Loss: 0.4530 | Val  Acc: 0.8958
 Site-Product                   (1) | Val  Loss: 0.3050 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.4933 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.3608 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.2479 | Val  Acc: 0.9355
 Site-Product                   (5) | Val  Loss: 0.4368 | Val  Acc: 0.8837
 Site-Product                   (1) | Val  Loss: 0.4892 | Val  Acc: 0.8814
 Site-Product                   (5) | Val  Loss: 0.4066 | Val  Acc: 0.8902
 Site-amazon                    (1) | Val  Loss: 0.3959 | Val  Acc: 0.8462
 Site-amazon                    (6) | Val  Loss: 0.4538 | Val  Acc: 0.8500
 Site-amazon                    (5) | Val  Loss: 0.6123 | Val  Acc: 0.8710
 Site-amazon                    (5) | Val  Loss: 0.3425 | Val  Acc: 0.9348
 Site-amazon                    (1) | Val  Loss: 0.3356 | Val  Acc: 0.8986
 Site-webcam                    (3) | Val  Loss: 0.5945 | Val  Acc: 0.8095
 Site-webcam                    (3) | Val  Loss: 0.4233 | Val  Acc: 0.8919
 Site-webcam                    (6) | Val  Loss: 0.3005 | Val  Acc: 0.9688
 Site-Art                       (3) | Val  Loss: 0.5736 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6421 | Val  Acc: 0.8214
 Site-Clipart                   (0) | Val  Loss: 0.7793 | Val  Acc: 0.8246
 Site-dslr                      (2) | Val  Loss: 0.3390 | Val  Acc: 0.8947
Average Valid Accuracy: 0.9035
============ Train epoch 39 ============
cnt=[7, 4, 2, 2, 8, 5, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-RealWorld                 (3) | Train Loss: 0.5014 | Train Acc: 0.8571
 Site-RealWorld                 (1) | Train Loss: 0.5043 | Train Acc: 0.7778
 Site-RealWorld                 (4) | Train Loss: 0.3758 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.3749 | Train Acc: 0.9032
 Site-RealWorld                 (1) | Train Loss: 0.5929 | Train Acc: 0.8250
 Site-RealWorld                 (5) | Train Loss: 0.3101 | Train Acc: 0.9412
 Site-RealWorld                 (5) | Train Loss: 0.2585 | Train Acc: 0.8955
 Site-RealWorld                 (0) | Train Loss: 0.4176 | Train Acc: 0.8721
 Site-RealWorld                 (0) | Train Loss: 0.3109 | Train Acc: 0.9279
 Site-RealWorld                 (0) | Train Loss: 0.2536 | Train Acc: 0.9514
 Site-Product                   (0) | Train Loss: 0.2916 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 0.5772 | Train Acc: 0.9167
 Site-Product                   (4) | Train Loss: 0.5820 | Train Acc: 0.8485
 Site-Product                   (4) | Train Loss: 0.5475 | Train Acc: 0.8696
 Site-Product                   (2) | Train Loss: 0.3964 | Train Acc: 0.9219
 Site-Product                   (0) | Train Loss: 0.3266 | Train Acc: 0.9438
 Site-Product                   (4) | Train Loss: 0.4120 | Train Acc: 0.9113
 Site-amazon                    (4) | Train Loss: 0.5790 | Train Acc: 0.8500
 Site-amazon                    (4) | Train Loss: 0.2894 | Train Acc: 0.9032
 Site-amazon                    (2) | Train Loss: 0.4880 | Train Acc: 0.9130
 Site-amazon                    (4) | Train Loss: 0.2858 | Train Acc: 0.9130
 Site-amazon                    (4) | Train Loss: 0.5648 | Train Acc: 0.8365
 Site-webcam                    (3) | Train Loss: 0.5426 | Train Acc: 0.8438
 Site-webcam                    (1) | Train Loss: 0.3480 | Train Acc: 0.9643
 Site-webcam                    (1) | Train Loss: 0.3591 | Train Acc: 0.9485
 Site-Art                       (5) | Train Loss: 0.7716 | Train Acc: 0.8095
 Site-Art                       (0) | Train Loss: 0.6137 | Train Acc: 0.8452
 Site-Clipart                   (5) | Train Loss: 0.8511 | Train Acc: 0.8000
 Site-dslr                      (6) | Train Loss: 0.3847 | Train Acc: 0.9138
Average Train Accuracy: 0.8849
 Site-RealWorld                 (3) | Val  Loss: 0.2371 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 0.2039 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.1662 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2985 | Val  Acc: 0.9500
 Site-RealWorld                 (1) | Val  Loss: 0.3903 | Val  Acc: 0.9615
 Site-RealWorld                 (5) | Val  Loss: 0.3351 | Val  Acc: 0.9412
 Site-RealWorld                 (5) | Val  Loss: 0.3723 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.4876 | Val  Acc: 0.8596
 Site-RealWorld                 (0) | Val  Loss: 0.4901 | Val  Acc: 0.9054
 Site-RealWorld                 (0) | Val  Loss: 0.4623 | Val  Acc: 0.9062
 Site-Product                   (0) | Val  Loss: 0.2552 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.4295 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.2889 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.3126 | Val  Acc: 0.9355
 Site-Product                   (2) | Val  Loss: 0.4353 | Val  Acc: 0.9302
 Site-Product                   (0) | Val  Loss: 0.4135 | Val  Acc: 0.9492
 Site-Product                   (4) | Val  Loss: 0.4139 | Val  Acc: 0.9024
 Site-amazon                    (4) | Val  Loss: 0.4755 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.4988 | Val  Acc: 0.8500
 Site-amazon                    (2) | Val  Loss: 0.6286 | Val  Acc: 0.8387
 Site-amazon                    (4) | Val  Loss: 0.3594 | Val  Acc: 0.9348
 Site-amazon                    (4) | Val  Loss: 0.3771 | Val  Acc: 0.9275
 Site-webcam                    (3) | Val  Loss: 0.5243 | Val  Acc: 0.9048
 Site-webcam                    (1) | Val  Loss: 0.4707 | Val  Acc: 0.8919
 Site-webcam                    (1) | Val  Loss: 0.3453 | Val  Acc: 0.9375
 Site-Art                       (5) | Val  Loss: 0.5791 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6417 | Val  Acc: 0.8750
 Site-Clipart                   (5) | Val  Loss: 0.9384 | Val  Acc: 0.7368
 Site-dslr                      (6) | Val  Loss: 0.3462 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9027
============ Train epoch 40 ============
cnt=[2, 6, 6, 5, 4, 1, 5, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-RealWorld                 (1) | Train Loss: 0.3530 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.5818 | Train Acc: 0.8333
 Site-RealWorld                 (0) | Train Loss: 0.2944 | Train Acc: 0.9583
 Site-RealWorld                 (6) | Train Loss: 0.2945 | Train Acc: 0.9355
 Site-RealWorld                 (1) | Train Loss: 0.5912 | Train Acc: 0.8500
 Site-RealWorld                 (1) | Train Loss: 0.3843 | Train Acc: 0.8824
 Site-RealWorld                 (4) | Train Loss: 0.2307 | Train Acc: 0.9104
 Site-RealWorld                 (3) | Train Loss: 0.3579 | Train Acc: 0.8953
 Site-RealWorld                 (4) | Train Loss: 0.3305 | Train Acc: 0.9550
 Site-RealWorld                 (4) | Train Loss: 0.2551 | Train Acc: 0.9861
 Site-Product                   (2) | Train Loss: 0.3508 | Train Acc: 0.8824
 Site-Product                   (2) | Train Loss: 0.5331 | Train Acc: 0.9167
 Site-Product                   (6) | Train Loss: 0.6034 | Train Acc: 0.8485
 Site-Product                   (3) | Train Loss: 0.6179 | Train Acc: 0.8478
 Site-Product                   (2) | Train Loss: 0.4249 | Train Acc: 0.9375
 Site-Product                   (6) | Train Loss: 0.3582 | Train Acc: 0.9213
 Site-Product                   (6) | Train Loss: 0.4332 | Train Acc: 0.9032
 Site-amazon                    (2) | Train Loss: 0.3842 | Train Acc: 1.0000
 Site-amazon                    (6) | Train Loss: 0.3202 | Train Acc: 0.9355
 Site-amazon                    (5) | Train Loss: 0.4569 | Train Acc: 0.8913
 Site-amazon                    (2) | Train Loss: 0.2772 | Train Acc: 0.9275
 Site-amazon                    (2) | Train Loss: 0.5427 | Train Acc: 0.8654
 Site-webcam                    (1) | Train Loss: 0.6126 | Train Acc: 0.8438
 Site-webcam                    (3) | Train Loss: 0.3840 | Train Acc: 0.8929
 Site-webcam                    (1) | Train Loss: 0.3748 | Train Acc: 0.9175
 Site-Art                       (3) | Train Loss: 0.8598 | Train Acc: 0.7381
 Site-Art                       (4) | Train Loss: 0.6213 | Train Acc: 0.8571
 Site-Clipart                   (3) | Train Loss: 0.8239 | Train Acc: 0.7647
 Site-dslr                      (1) | Train Loss: 0.3575 | Train Acc: 0.9310
Average Train Accuracy: 0.8951
 Site-RealWorld                 (1) | Val  Loss: 0.2807 | Val  Acc: 0.8889
 Site-RealWorld                 (0) | Val  Loss: 0.1575 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1296 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2664 | Val  Acc: 0.9500
 Site-RealWorld                 (1) | Val  Loss: 0.4242 | Val  Acc: 0.9615
 Site-RealWorld                 (1) | Val  Loss: 0.3239 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.3529 | Val  Acc: 0.9318
 Site-RealWorld                 (3) | Val  Loss: 0.5186 | Val  Acc: 0.7895
 Site-RealWorld                 (4) | Val  Loss: 0.4628 | Val  Acc: 0.8784
 Site-RealWorld                 (4) | Val  Loss: 0.4390 | Val  Acc: 0.8958
 Site-Product                   (2) | Val  Loss: 0.3484 | Val  Acc: 0.8182
 Site-Product                   (2) | Val  Loss: 0.2589 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.3921 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.2755 | Val  Acc: 0.9677
 Site-Product                   (2) | Val  Loss: 0.4443 | Val  Acc: 0.9302
 Site-Product                   (6) | Val  Loss: 0.3943 | Val  Acc: 0.9492
 Site-Product                   (6) | Val  Loss: 0.3615 | Val  Acc: 0.9146
 Site-amazon                    (2) | Val  Loss: 0.4271 | Val  Acc: 0.8462
 Site-amazon                    (6) | Val  Loss: 0.4352 | Val  Acc: 0.9500
 Site-amazon                    (5) | Val  Loss: 0.6377 | Val  Acc: 0.8710
 Site-amazon                    (2) | Val  Loss: 0.2925 | Val  Acc: 0.9565
 Site-amazon                    (2) | Val  Loss: 0.3079 | Val  Acc: 0.9275
 Site-webcam                    (1) | Val  Loss: 0.7121 | Val  Acc: 0.8095
 Site-webcam                    (3) | Val  Loss: 0.4908 | Val  Acc: 0.8649
 Site-webcam                    (1) | Val  Loss: 0.3486 | Val  Acc: 0.9375
 Site-Art                       (3) | Val  Loss: 0.6619 | Val  Acc: 0.7857
 Site-Art                       (4) | Val  Loss: 0.6117 | Val  Acc: 0.8750
 Site-Clipart                   (3) | Val  Loss: 0.8581 | Val  Acc: 0.7368
 Site-dslr                      (1) | Val  Loss: 0.3076 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9055
 Test site-RealWorld                 (1)| Epoch:37 | Test Acc: 0.9361
 Test site-Product                   (2)| Epoch:37 | Test Acc: 0.9167
 Test site-amazon                    (2)| Epoch:37 | Test Acc: 0.8370
 Test site-webcam                    (1)| Epoch:37 | Test Acc: 0.9207
 Test site-Art                       (3)| Epoch:37 | Test Acc: 0.8700
 Test site-Clipart                   (3)| Epoch:37 | Test Acc: 0.7913
 Test site-dslr                      (1)| Epoch:37 | Test Acc: 0.9485
RealWorld: 0.9361, Product: 0.9167, amazon: 0.8370, webcam: 0.9207, Art: 0.8700, Clipart: 0.7913, dslr: 0.9485, 
Average Test Accuracy(group): 0.8886, Average Test Accuracy(individual): 0.9036,
domain std=0.0536, cluster std=0.0327, individual std=0.0422, 
Average Test Accuracy: 0.8886
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[4, 6, 2, 5, 1, 6, 5, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-RealWorld                 (4) | Train Loss: 0.5583 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 0.4690 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 0.2617 | Train Acc: 0.9583
 Site-RealWorld                 (1) | Train Loss: 0.2810 | Train Acc: 0.9677
 Site-RealWorld                 (5) | Train Loss: 0.5232 | Train Acc: 0.8500
 Site-RealWorld                 (1) | Train Loss: 0.3768 | Train Acc: 0.9020
 Site-RealWorld                 (1) | Train Loss: 0.5047 | Train Acc: 0.9104
 Site-RealWorld                 (0) | Train Loss: 0.3296 | Train Acc: 0.9070
 Site-RealWorld                 (1) | Train Loss: 0.3046 | Train Acc: 0.9279
 Site-RealWorld                 (6) | Train Loss: 0.2486 | Train Acc: 0.9722
 Site-Product                   (0) | Train Loss: 0.2868 | Train Acc: 0.8824
 Site-Product                   (1) | Train Loss: 0.4560 | Train Acc: 0.8750
 Site-Product                   (6) | Train Loss: 0.6070 | Train Acc: 0.8788
 Site-Product                   (3) | Train Loss: 0.4710 | Train Acc: 0.8913
 Site-Product                   (3) | Train Loss: 0.3879 | Train Acc: 0.9375
 Site-Product                   (3) | Train Loss: 0.3641 | Train Acc: 0.9213
 Site-Product                   (3) | Train Loss: 0.3756 | Train Acc: 0.9274
 Site-amazon                    (3) | Train Loss: 0.4103 | Train Acc: 0.8500
 Site-amazon                    (6) | Train Loss: 0.2974 | Train Acc: 0.9355
 Site-amazon                    (6) | Train Loss: 0.3912 | Train Acc: 0.9348
 Site-amazon                    (0) | Train Loss: 1.0325 | Train Acc: 0.8986
 Site-amazon                    (0) | Train Loss: 0.6518 | Train Acc: 0.8365
 Site-webcam                    (2) | Train Loss: 0.5173 | Train Acc: 0.8750
 Site-webcam                    (5) | Train Loss: 0.3325 | Train Acc: 0.9643
 Site-webcam                    (5) | Train Loss: 0.3771 | Train Acc: 0.9278
 Site-Art                       (5) | Train Loss: 0.7012 | Train Acc: 0.9048
 Site-Art                       (1) | Train Loss: 0.6223 | Train Acc: 0.8571
 Site-Clipart                   (5) | Train Loss: 0.8274 | Train Acc: 0.8000
 Site-dslr                      (2) | Train Loss: 0.3310 | Train Acc: 0.8966
Average Train Accuracy: 0.9037
 Site-RealWorld                 (4) | Val  Loss: 0.1528 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.2202 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1234 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2512 | Val  Acc: 0.9500
 Site-RealWorld                 (5) | Val  Loss: 0.3245 | Val  Acc: 0.9615
 Site-RealWorld                 (1) | Val  Loss: 0.3276 | Val  Acc: 0.9412
 Site-RealWorld                 (1) | Val  Loss: 0.3450 | Val  Acc: 0.9318
 Site-RealWorld                 (0) | Val  Loss: 0.5079 | Val  Acc: 0.8246
 Site-RealWorld                 (1) | Val  Loss: 0.3781 | Val  Acc: 0.9054
 Site-RealWorld                 (6) | Val  Loss: 0.4634 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.3177 | Val  Acc: 0.9091
 Site-Product                   (1) | Val  Loss: 0.3871 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.3240 | Val  Acc: 0.9545
 Site-Product                   (3) | Val  Loss: 0.2843 | Val  Acc: 0.9355
 Site-Product                   (3) | Val  Loss: 0.5081 | Val  Acc: 0.9070
 Site-Product                   (3) | Val  Loss: 0.3785 | Val  Acc: 0.9153
 Site-Product                   (3) | Val  Loss: 0.3995 | Val  Acc: 0.8659
 Site-amazon                    (3) | Val  Loss: 0.4224 | Val  Acc: 0.8462
 Site-amazon                    (6) | Val  Loss: 0.3973 | Val  Acc: 0.9000
 Site-amazon                    (6) | Val  Loss: 0.6203 | Val  Acc: 0.8387
 Site-amazon                    (0) | Val  Loss: 0.3242 | Val  Acc: 0.9783
 Site-amazon                    (0) | Val  Loss: 0.3070 | Val  Acc: 0.9275
 Site-webcam                    (2) | Val  Loss: 0.5726 | Val  Acc: 0.9048
 Site-webcam                    (5) | Val  Loss: 0.4591 | Val  Acc: 0.8919
 Site-webcam                    (5) | Val  Loss: 0.3131 | Val  Acc: 0.9375
 Site-Art                       (5) | Val  Loss: 0.5090 | Val  Acc: 0.8929
 Site-Art                       (1) | Val  Loss: 0.6137 | Val  Acc: 0.8750
 Site-Clipart                   (5) | Val  Loss: 0.7262 | Val  Acc: 0.8070
 Site-dslr                      (2) | Val  Loss: 0.3203 | Val  Acc: 0.8947
Average Valid Accuracy: 0.9162
 Test site-RealWorld                 (4)| Epoch:40 | Test Acc: 0.9361
 Test site-Product                   (0)| Epoch:40 | Test Acc: 0.9228
 Test site-amazon                    (3)| Epoch:40 | Test Acc: 0.8388
 Test site-webcam                    (2)| Epoch:40 | Test Acc: 0.9268
 Test site-Art                       (5)| Epoch:40 | Test Acc: 0.8744
 Test site-Clipart                   (5)| Epoch:40 | Test Acc: 0.7934
 Test site-dslr                      (2)| Epoch:40 | Test Acc: 0.9485
RealWorld: 0.9361, Product: 0.9228, amazon: 0.8388, webcam: 0.9268, Art: 0.8744, Clipart: 0.7934, dslr: 0.9485, 
Average Test Accuracy(group): 0.8915, Average Test Accuracy(individual): 0.9064,
domain std=0.0536, cluster std=0.0195, individual std=0.0421, 
Average Test Accuracy: 0.8915
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[8, 4, 1, 2, 1, 5, 8, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-RealWorld                 (1) | Train Loss: 0.4690 | Train Acc: 0.9286
 Site-RealWorld                 (5) | Train Loss: 0.5793 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 0.2708 | Train Acc: 0.9167
 Site-RealWorld                 (6) | Train Loss: 0.3051 | Train Acc: 0.9355
 Site-RealWorld                 (5) | Train Loss: 0.6059 | Train Acc: 0.8500
 Site-RealWorld                 (5) | Train Loss: 0.3845 | Train Acc: 0.9020
 Site-RealWorld                 (5) | Train Loss: 0.4723 | Train Acc: 0.9403
 Site-RealWorld                 (6) | Train Loss: 0.4056 | Train Acc: 0.8837
 Site-RealWorld                 (6) | Train Loss: 0.3048 | Train Acc: 0.9369
 Site-RealWorld                 (6) | Train Loss: 0.2589 | Train Acc: 0.9931
 Site-Product                   (6) | Train Loss: 0.4918 | Train Acc: 0.8824
 Site-Product                   (0) | Train Loss: 0.4932 | Train Acc: 0.8333
 Site-Product                   (0) | Train Loss: 0.5805 | Train Acc: 0.8485
 Site-Product                   (6) | Train Loss: 0.5428 | Train Acc: 0.9130
 Site-Product                   (0) | Train Loss: 0.4092 | Train Acc: 0.9062
 Site-Product                   (0) | Train Loss: 0.4395 | Train Acc: 0.8989
 Site-Product                   (0) | Train Loss: 0.4547 | Train Acc: 0.9032
 Site-amazon                    (3) | Train Loss: 0.4168 | Train Acc: 0.9000
 Site-amazon                    (0) | Train Loss: 0.3907 | Train Acc: 0.9032
 Site-amazon                    (3) | Train Loss: 0.3666 | Train Acc: 0.9348
 Site-amazon                    (0) | Train Loss: 0.3496 | Train Acc: 0.9130
 Site-amazon                    (0) | Train Loss: 0.5580 | Train Acc: 0.8654
 Site-webcam                    (4) | Train Loss: 0.4988 | Train Acc: 0.9062
 Site-webcam                    (5) | Train Loss: 0.3514 | Train Acc: 0.9464
 Site-webcam                    (1) | Train Loss: 0.3688 | Train Acc: 0.9175
 Site-Art                       (1) | Train Loss: 0.8039 | Train Acc: 0.8095
 Site-Art                       (6) | Train Loss: 0.6177 | Train Acc: 0.8452
 Site-Clipart                   (2) | Train Loss: 0.7541 | Train Acc: 0.7882
 Site-dslr                      (1) | Train Loss: 0.3381 | Train Acc: 0.8966
Average Train Accuracy: 0.8942
 Site-RealWorld                 (1) | Val  Loss: 0.2877 | Val  Acc: 0.8889
 Site-RealWorld                 (5) | Val  Loss: 0.2519 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1320 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2151 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.3248 | Val  Acc: 0.9615
 Site-RealWorld                 (5) | Val  Loss: 0.3033 | Val  Acc: 0.9412
 Site-RealWorld                 (5) | Val  Loss: 0.3974 | Val  Acc: 0.9091
 Site-RealWorld                 (6) | Val  Loss: 0.4366 | Val  Acc: 0.8421
 Site-RealWorld                 (6) | Val  Loss: 0.4124 | Val  Acc: 0.8784
 Site-RealWorld                 (6) | Val  Loss: 0.4731 | Val  Acc: 0.8854
 Site-Product                   (6) | Val  Loss: 0.3393 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.5579 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.4405 | Val  Acc: 0.9091
 Site-Product                   (6) | Val  Loss: 0.2188 | Val  Acc: 0.9677
 Site-Product                   (0) | Val  Loss: 0.4166 | Val  Acc: 0.9070
 Site-Product                   (0) | Val  Loss: 0.4251 | Val  Acc: 0.9492
 Site-Product                   (0) | Val  Loss: 0.3676 | Val  Acc: 0.9390
 Site-amazon                    (3) | Val  Loss: 0.4261 | Val  Acc: 0.7692
 Site-amazon                    (0) | Val  Loss: 0.4180 | Val  Acc: 0.9500
 Site-amazon                    (3) | Val  Loss: 0.5818 | Val  Acc: 0.8710
 Site-amazon                    (0) | Val  Loss: 0.3088 | Val  Acc: 0.9348
 Site-amazon                    (0) | Val  Loss: 0.3702 | Val  Acc: 0.9130
 Site-webcam                    (4) | Val  Loss: 0.6518 | Val  Acc: 0.8095
 Site-webcam                    (5) | Val  Loss: 0.4207 | Val  Acc: 0.8919
 Site-webcam                    (1) | Val  Loss: 0.3632 | Val  Acc: 0.9062
 Site-Art                       (1) | Val  Loss: 0.6163 | Val  Acc: 0.8214
 Site-Art                       (6) | Val  Loss: 0.6287 | Val  Acc: 0.8214
 Site-Clipart                   (2) | Val  Loss: 0.7968 | Val  Acc: 0.8070
 Site-dslr                      (1) | Val  Loss: 0.2955 | Val  Acc: 0.9737
Average Valid Accuracy: 0.9045
 Test site-RealWorld                 (1)| Epoch:41 | Test Acc: 0.9361
 Test site-Product                   (6)| Epoch:41 | Test Acc: 0.9228
 Test site-amazon                    (3)| Epoch:41 | Test Acc: 0.8388
 Test site-webcam                    (4)| Epoch:41 | Test Acc: 0.9329
 Test site-Art                       (1)| Epoch:41 | Test Acc: 0.8700
 Test site-Clipart                   (2)| Epoch:41 | Test Acc: 0.7955
 Test site-dslr                      (1)| Epoch:41 | Test Acc: 0.9485
RealWorld: 0.9361, Product: 0.9228, amazon: 0.8388, webcam: 0.9329, Art: 0.8700, Clipart: 0.7955, dslr: 0.9485, 
Average Test Accuracy(group): 0.8921, Average Test Accuracy(individual): 0.9068,
domain std=0.0540, cluster std=0.0502, individual std=0.0425, 
Average Test Accuracy: 0.8921
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[7, 7, 6, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-RealWorld                 (1) | Train Loss: 0.6076 | Train Acc: 0.8571
 Site-RealWorld                 (3) | Train Loss: 0.4696 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.3525 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.2479 | Train Acc: 0.9677
 Site-RealWorld                 (1) | Train Loss: 0.5904 | Train Acc: 0.8500
 Site-RealWorld                 (1) | Train Loss: 0.3160 | Train Acc: 0.9412
 Site-RealWorld                 (0) | Train Loss: 0.4349 | Train Acc: 0.8955
 Site-RealWorld                 (4) | Train Loss: 0.3914 | Train Acc: 0.8953
 Site-RealWorld                 (0) | Train Loss: 0.3198 | Train Acc: 0.9279
 Site-RealWorld                 (0) | Train Loss: 0.2230 | Train Acc: 0.9792
 Site-Product                   (4) | Train Loss: 0.3785 | Train Acc: 0.8824
 Site-Product                   (2) | Train Loss: 0.3776 | Train Acc: 0.9583
 Site-Product                   (5) | Train Loss: 0.5897 | Train Acc: 0.8485
 Site-Product                   (0) | Train Loss: 0.4536 | Train Acc: 0.9348
 Site-Product                   (2) | Train Loss: 0.4643 | Train Acc: 0.8438
 Site-Product                   (4) | Train Loss: 0.3142 | Train Acc: 0.9663
 Site-Product                   (4) | Train Loss: 0.4237 | Train Acc: 0.9194
 Site-amazon                    (4) | Train Loss: 0.4585 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.2910 | Train Acc: 0.9355
 Site-amazon                    (2) | Train Loss: 0.3883 | Train Acc: 0.8913
 Site-amazon                    (2) | Train Loss: 0.2870 | Train Acc: 0.8986
 Site-amazon                    (2) | Train Loss: 0.5616 | Train Acc: 0.8365
 Site-webcam                    (3) | Train Loss: 0.5212 | Train Acc: 0.8438
 Site-webcam                    (1) | Train Loss: 0.3532 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.3661 | Train Acc: 0.9381
 Site-Art                       (1) | Train Loss: 0.7369 | Train Acc: 0.8810
 Site-Art                       (0) | Train Loss: 0.5973 | Train Acc: 0.8810
 Site-Clipart                   (0) | Train Loss: 0.7998 | Train Acc: 0.8000
 Site-dslr                      (6) | Train Loss: 0.3344 | Train Acc: 0.8793
Average Train Accuracy: 0.8978
 Site-RealWorld                 (1) | Val  Loss: 0.2520 | Val  Acc: 0.8889
 Site-RealWorld                 (3) | Val  Loss: 0.2104 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1011 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2304 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3216 | Val  Acc: 0.9615
 Site-RealWorld                 (1) | Val  Loss: 0.3151 | Val  Acc: 0.9412
 Site-RealWorld                 (0) | Val  Loss: 0.3655 | Val  Acc: 0.9318
 Site-RealWorld                 (4) | Val  Loss: 0.4876 | Val  Acc: 0.8070
 Site-RealWorld                 (0) | Val  Loss: 0.4303 | Val  Acc: 0.9054
 Site-RealWorld                 (0) | Val  Loss: 0.4396 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.3206 | Val  Acc: 0.9091
 Site-Product                   (2) | Val  Loss: 0.4812 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.2746 | Val  Acc: 0.9545
 Site-Product                   (0) | Val  Loss: 0.2229 | Val  Acc: 0.9677
 Site-Product                   (2) | Val  Loss: 0.4186 | Val  Acc: 0.9070
 Site-Product                   (4) | Val  Loss: 0.4740 | Val  Acc: 0.9153
 Site-Product                   (4) | Val  Loss: 0.3701 | Val  Acc: 0.9024
 Site-amazon                    (4) | Val  Loss: 0.3814 | Val  Acc: 0.8462
 Site-amazon                    (2) | Val  Loss: 0.4049 | Val  Acc: 0.9500
 Site-amazon                    (2) | Val  Loss: 0.5664 | Val  Acc: 0.8710
 Site-amazon                    (2) | Val  Loss: 0.3014 | Val  Acc: 0.9565
 Site-amazon                    (2) | Val  Loss: 0.2780 | Val  Acc: 0.9130
 Site-webcam                    (3) | Val  Loss: 0.5611 | Val  Acc: 0.9048
 Site-webcam                    (1) | Val  Loss: 0.4850 | Val  Acc: 0.8919
 Site-webcam                    (1) | Val  Loss: 0.3335 | Val  Acc: 0.9219
 Site-Art                       (1) | Val  Loss: 0.4885 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6229 | Val  Acc: 0.8393
 Site-Clipart                   (0) | Val  Loss: 0.9082 | Val  Acc: 0.7719
 Site-dslr                      (6) | Val  Loss: 0.2617 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9099
 Test site-RealWorld                 (1)| Epoch:42 | Test Acc: 0.9384
 Test site-Product                   (4)| Epoch:42 | Test Acc: 0.9248
 Test site-amazon                    (4)| Epoch:42 | Test Acc: 0.8370
 Test site-webcam                    (3)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (1)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.7913
 Test site-dslr                      (6)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9384, Product: 0.9248, amazon: 0.8370, webcam: 0.9268, Art: 0.8700, Clipart: 0.7913, dslr: 0.9485, 
Average Test Accuracy(group): 0.8910, Average Test Accuracy(individual): 0.9070,
domain std=0.0551, cluster std=0.0242, individual std=0.0438, 
Average Test Accuracy: 0.8910
============ Train epoch 44 ============
cnt=[10, 5, 7, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-RealWorld                 (4) | Train Loss: 0.5059 | Train Acc: 0.8571
 Site-RealWorld                 (1) | Train Loss: 0.5531 | Train Acc: 0.8333
 Site-RealWorld                 (1) | Train Loss: 0.3596 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.2362 | Train Acc: 0.9677
 Site-RealWorld                 (1) | Train Loss: 0.5753 | Train Acc: 0.8500
 Site-RealWorld                 (2) | Train Loss: 0.2939 | Train Acc: 0.9216
 Site-RealWorld                 (2) | Train Loss: 0.4198 | Train Acc: 0.8955
 Site-RealWorld                 (2) | Train Loss: 0.3872 | Train Acc: 0.8953
 Site-RealWorld                 (2) | Train Loss: 0.3612 | Train Acc: 0.9189
 Site-RealWorld                 (2) | Train Loss: 0.2109 | Train Acc: 0.9861
 Site-Product                   (5) | Train Loss: 0.3428 | Train Acc: 0.8824
 Site-Product                   (0) | Train Loss: 0.4208 | Train Acc: 0.9167
 Site-Product                   (0) | Train Loss: 0.5542 | Train Acc: 0.8485
 Site-Product                   (0) | Train Loss: 0.4119 | Train Acc: 0.9348
 Site-Product                   (3) | Train Loss: 0.4023 | Train Acc: 0.9219
 Site-Product                   (0) | Train Loss: 0.3416 | Train Acc: 0.9213
 Site-Product                   (0) | Train Loss: 0.4381 | Train Acc: 0.9113
 Site-amazon                    (0) | Train Loss: 0.5271 | Train Acc: 0.9000
 Site-amazon                    (0) | Train Loss: 0.2689 | Train Acc: 0.9355
 Site-amazon                    (3) | Train Loss: 0.4259 | Train Acc: 0.8696
 Site-amazon                    (3) | Train Loss: 0.4598 | Train Acc: 0.9130
 Site-amazon                    (0) | Train Loss: 0.5505 | Train Acc: 0.8462
 Site-webcam                    (4) | Train Loss: 0.5104 | Train Acc: 0.9062
 Site-webcam                    (2) | Train Loss: 0.3447 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.3777 | Train Acc: 0.9278
 Site-Art                       (1) | Train Loss: 0.6892 | Train Acc: 0.8810
 Site-Art                       (0) | Train Loss: 0.5417 | Train Acc: 0.8810
 Site-Clipart                   (2) | Train Loss: 0.8904 | Train Acc: 0.7882
 Site-dslr                      (6) | Train Loss: 0.3484 | Train Acc: 0.8966
Average Train Accuracy: 0.8969
 Site-RealWorld                 (4) | Val  Loss: 0.2197 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1508 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1165 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2431 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3663 | Val  Acc: 0.9231
 Site-RealWorld                 (2) | Val  Loss: 0.2994 | Val  Acc: 0.9706
 Site-RealWorld                 (2) | Val  Loss: 0.2924 | Val  Acc: 0.9318
 Site-RealWorld                 (2) | Val  Loss: 0.4688 | Val  Acc: 0.8246
 Site-RealWorld                 (2) | Val  Loss: 0.3991 | Val  Acc: 0.8784
 Site-RealWorld                 (2) | Val  Loss: 0.4381 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.3652 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.3118 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3863 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.3251 | Val  Acc: 0.9355
 Site-Product                   (3) | Val  Loss: 0.4334 | Val  Acc: 0.9302
 Site-Product                   (0) | Val  Loss: 0.4515 | Val  Acc: 0.9153
 Site-Product                   (0) | Val  Loss: 0.3172 | Val  Acc: 0.9390
 Site-amazon                    (0) | Val  Loss: 0.3897 | Val  Acc: 0.8462
 Site-amazon                    (0) | Val  Loss: 0.5195 | Val  Acc: 0.8500
 Site-amazon                    (3) | Val  Loss: 0.5776 | Val  Acc: 0.8387
 Site-amazon                    (3) | Val  Loss: 0.3368 | Val  Acc: 0.9348
 Site-amazon                    (0) | Val  Loss: 0.3334 | Val  Acc: 0.9130
 Site-webcam                    (4) | Val  Loss: 0.5724 | Val  Acc: 0.8095
 Site-webcam                    (2) | Val  Loss: 0.4457 | Val  Acc: 0.8649
 Site-webcam                    (1) | Val  Loss: 0.3508 | Val  Acc: 0.9062
 Site-Art                       (1) | Val  Loss: 0.5371 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6249 | Val  Acc: 0.8571
 Site-Clipart                   (2) | Val  Loss: 0.7152 | Val  Acc: 0.8421
 Site-dslr                      (6) | Val  Loss: 0.2572 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9106
 Test site-RealWorld                 (4)| Epoch:42 | Test Acc: 0.9361
 Test site-Product                   (5)| Epoch:42 | Test Acc: 0.9228
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.8388
 Test site-webcam                    (4)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (1)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.7934
 Test site-dslr                      (6)| Epoch:42 | Test Acc: 0.9381
RealWorld: 0.9361, Product: 0.9228, amazon: 0.8388, webcam: 0.9268, Art: 0.8700, Clipart: 0.7934, dslr: 0.9381, 
Average Test Accuracy(group): 0.8894, Average Test Accuracy(individual): 0.9057,
domain std=0.0524, cluster std=0.0228, individual std=0.0420, 
Average Test Accuracy: 0.8894
============ Train epoch 45 ============
cnt=[6, 4, 2, 4, 6, 1, 6, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-RealWorld                 (2) | Train Loss: 0.3326 | Train Acc: 0.9286
 Site-RealWorld                 (4) | Train Loss: 0.4485 | Train Acc: 0.9444
 Site-RealWorld                 (6) | Train Loss: 0.2554 | Train Acc: 0.9583
 Site-RealWorld                 (0) | Train Loss: 0.2848 | Train Acc: 0.9032
 Site-RealWorld                 (0) | Train Loss: 0.5311 | Train Acc: 0.8750
 Site-RealWorld                 (4) | Train Loss: 0.3788 | Train Acc: 0.9216
 Site-RealWorld                 (4) | Train Loss: 0.2702 | Train Acc: 0.9254
 Site-RealWorld                 (0) | Train Loss: 0.4194 | Train Acc: 0.9302
 Site-RealWorld                 (0) | Train Loss: 0.3028 | Train Acc: 0.9550
 Site-RealWorld                 (1) | Train Loss: 0.2354 | Train Acc: 0.9861
 Site-Product                   (1) | Train Loss: 0.4508 | Train Acc: 0.8824
 Site-Product                   (6) | Train Loss: 0.3518 | Train Acc: 0.9167
 Site-Product                   (6) | Train Loss: 0.7583 | Train Acc: 0.6970
 Site-Product                   (1) | Train Loss: 0.4733 | Train Acc: 0.8913
 Site-Product                   (6) | Train Loss: 0.4215 | Train Acc: 0.9219
 Site-Product                   (1) | Train Loss: 0.3117 | Train Acc: 0.9551
 Site-Product                   (6) | Train Loss: 0.3880 | Train Acc: 0.9274
 Site-amazon                    (3) | Train Loss: 0.4042 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.2256 | Train Acc: 0.9355
 Site-amazon                    (3) | Train Loss: 0.4453 | Train Acc: 0.9130
 Site-amazon                    (3) | Train Loss: 0.4603 | Train Acc: 0.9275
 Site-amazon                    (6) | Train Loss: 0.5957 | Train Acc: 0.8173
 Site-webcam                    (5) | Train Loss: 0.5433 | Train Acc: 0.8438
 Site-webcam                    (4) | Train Loss: 0.3714 | Train Acc: 0.9286
 Site-webcam                    (4) | Train Loss: 0.3037 | Train Acc: 0.9485
 Site-Art                       (4) | Train Loss: 0.8317 | Train Acc: 0.8333
 Site-Art                       (0) | Train Loss: 0.6102 | Train Acc: 0.8690
 Site-Clipart                   (0) | Train Loss: 0.7100 | Train Acc: 0.7882
 Site-dslr                      (2) | Train Loss: 0.3293 | Train Acc: 0.8793
Average Train Accuracy: 0.9001
 Site-RealWorld                 (2) | Val  Loss: 0.2708 | Val  Acc: 0.8889
 Site-RealWorld                 (4) | Val  Loss: 0.1814 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1287 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2990 | Val  Acc: 0.9500
 Site-RealWorld                 (0) | Val  Loss: 0.3335 | Val  Acc: 0.9615
 Site-RealWorld                 (4) | Val  Loss: 0.2858 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.3341 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.4674 | Val  Acc: 0.8421
 Site-RealWorld                 (0) | Val  Loss: 0.4205 | Val  Acc: 0.8919
 Site-RealWorld                 (1) | Val  Loss: 0.4156 | Val  Acc: 0.8854
 Site-Product                   (1) | Val  Loss: 0.3176 | Val  Acc: 0.9091
 Site-Product                   (6) | Val  Loss: 0.4994 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 0.3655 | Val  Acc: 0.8636
 Site-Product                   (1) | Val  Loss: 0.2869 | Val  Acc: 0.9355
 Site-Product                   (6) | Val  Loss: 0.4060 | Val  Acc: 0.9070
 Site-Product                   (1) | Val  Loss: 0.4128 | Val  Acc: 0.9153
 Site-Product                   (6) | Val  Loss: 0.3830 | Val  Acc: 0.8780
 Site-amazon                    (3) | Val  Loss: 0.3613 | Val  Acc: 0.8462
 Site-amazon                    (3) | Val  Loss: 0.4831 | Val  Acc: 0.8500
 Site-amazon                    (3) | Val  Loss: 0.6063 | Val  Acc: 0.8387
 Site-amazon                    (3) | Val  Loss: 0.3015 | Val  Acc: 0.9348
 Site-amazon                    (6) | Val  Loss: 0.3355 | Val  Acc: 0.9275
 Site-webcam                    (5) | Val  Loss: 0.5539 | Val  Acc: 0.8095
 Site-webcam                    (4) | Val  Loss: 0.4464 | Val  Acc: 0.8649
 Site-webcam                    (4) | Val  Loss: 0.2830 | Val  Acc: 0.9688
 Site-Art                       (4) | Val  Loss: 0.5414 | Val  Acc: 0.8571
 Site-Art                       (0) | Val  Loss: 0.6540 | Val  Acc: 0.8214
 Site-Clipart                   (0) | Val  Loss: 0.7565 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.2876 | Val  Acc: 0.8947
Average Valid Accuracy: 0.8966
 Test site-RealWorld                 (2)| Epoch:42 | Test Acc: 0.9361
 Test site-Product                   (1)| Epoch:42 | Test Acc: 0.9228
 Test site-amazon                    (3)| Epoch:42 | Test Acc: 0.8370
 Test site-webcam                    (5)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (4)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (0)| Epoch:42 | Test Acc: 0.7934
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9361, Product: 0.9228, amazon: 0.8370, webcam: 0.9268, Art: 0.8700, Clipart: 0.7934, dslr: 0.9485, 
Average Test Accuracy(group): 0.8906, Average Test Accuracy(individual): 0.9058,
domain std=0.0541, cluster std=0.0319, individual std=0.0428, 
Average Test Accuracy: 0.8906
============ Train epoch 46 ============
cnt=[4, 6, 2, 8, 6, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-RealWorld                 (6) | Train Loss: 0.4325 | Train Acc: 0.8571
 Site-RealWorld                 (3) | Train Loss: 0.3853 | Train Acc: 0.9444
 Site-RealWorld                 (4) | Train Loss: 0.3145 | Train Acc: 0.9167
 Site-RealWorld                 (3) | Train Loss: 0.3087 | Train Acc: 0.9355
 Site-RealWorld                 (6) | Train Loss: 0.5255 | Train Acc: 0.8750
 Site-RealWorld                 (3) | Train Loss: 0.2981 | Train Acc: 0.9412
 Site-RealWorld                 (0) | Train Loss: 0.3008 | Train Acc: 0.9104
 Site-RealWorld                 (0) | Train Loss: 0.3559 | Train Acc: 0.8953
 Site-RealWorld                 (3) | Train Loss: 0.2666 | Train Acc: 0.9459
 Site-RealWorld                 (4) | Train Loss: 0.2327 | Train Acc: 0.9653
 Site-Product                   (1) | Train Loss: 0.4333 | Train Acc: 0.8824
 Site-Product                   (4) | Train Loss: 0.5084 | Train Acc: 0.9167
 Site-Product                   (1) | Train Loss: 0.6353 | Train Acc: 0.8182
 Site-Product                   (0) | Train Loss: 0.4747 | Train Acc: 0.9130
 Site-Product                   (1) | Train Loss: 0.4501 | Train Acc: 0.8750
 Site-Product                   (4) | Train Loss: 0.3517 | Train Acc: 0.9101
 Site-Product                   (4) | Train Loss: 0.3632 | Train Acc: 0.9274
 Site-amazon                    (5) | Train Loss: 0.3440 | Train Acc: 1.0000
 Site-amazon                    (1) | Train Loss: 0.3511 | Train Acc: 0.9032
 Site-amazon                    (1) | Train Loss: 0.4793 | Train Acc: 0.8913
 Site-amazon                    (1) | Train Loss: 0.3588 | Train Acc: 0.9130
 Site-amazon                    (4) | Train Loss: 0.5472 | Train Acc: 0.8462
 Site-webcam                    (2) | Train Loss: 0.4974 | Train Acc: 0.8438
 Site-webcam                    (3) | Train Loss: 0.2727 | Train Acc: 0.9643
 Site-webcam                    (3) | Train Loss: 0.3552 | Train Acc: 0.9175
 Site-Art                       (3) | Train Loss: 0.7538 | Train Acc: 0.7857
 Site-Art                       (0) | Train Loss: 0.5553 | Train Acc: 0.8810
 Site-Clipart                   (3) | Train Loss: 0.8732 | Train Acc: 0.7765
 Site-dslr                      (2) | Train Loss: 0.3208 | Train Acc: 0.9138
Average Train Accuracy: 0.8988
 Site-RealWorld                 (6) | Val  Loss: 0.2367 | Val  Acc: 0.8889
 Site-RealWorld                 (3) | Val  Loss: 0.2162 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.1165 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2306 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3367 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.2555 | Val  Acc: 0.9706
 Site-RealWorld                 (0) | Val  Loss: 0.3158 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.4836 | Val  Acc: 0.8421
 Site-RealWorld                 (3) | Val  Loss: 0.3703 | Val  Acc: 0.9189
 Site-RealWorld                 (4) | Val  Loss: 0.4082 | Val  Acc: 0.8958
 Site-Product                   (1) | Val  Loss: 0.2304 | Val  Acc: 0.9091
 Site-Product                   (4) | Val  Loss: 0.4199 | Val  Acc: 0.9375
 Site-Product                   (1) | Val  Loss: 0.3387 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.2274 | Val  Acc: 0.9677
 Site-Product                   (1) | Val  Loss: 0.4626 | Val  Acc: 0.9070
 Site-Product                   (4) | Val  Loss: 0.4389 | Val  Acc: 0.9153
 Site-Product                   (4) | Val  Loss: 0.3302 | Val  Acc: 0.9024
 Site-amazon                    (5) | Val  Loss: 0.4380 | Val  Acc: 0.8462
 Site-amazon                    (1) | Val  Loss: 0.3865 | Val  Acc: 0.9000
 Site-amazon                    (1) | Val  Loss: 0.5365 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.3482 | Val  Acc: 0.9130
 Site-amazon                    (4) | Val  Loss: 0.3397 | Val  Acc: 0.8696
 Site-webcam                    (2) | Val  Loss: 0.5109 | Val  Acc: 0.8571
 Site-webcam                    (3) | Val  Loss: 0.4497 | Val  Acc: 0.8378
 Site-webcam                    (3) | Val  Loss: 0.2897 | Val  Acc: 0.9531
 Site-Art                       (3) | Val  Loss: 0.4922 | Val  Acc: 0.9286
 Site-Art                       (0) | Val  Loss: 0.5733 | Val  Acc: 0.8571
 Site-Clipart                   (3) | Val  Loss: 0.8151 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.2650 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9108
 Test site-RealWorld                 (6)| Epoch:42 | Test Acc: 0.9384
 Test site-Product                   (1)| Epoch:42 | Test Acc: 0.9187
 Test site-amazon                    (5)| Epoch:42 | Test Acc: 0.8370
 Test site-webcam                    (2)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (3)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (3)| Epoch:42 | Test Acc: 0.7955
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9384, Product: 0.9187, amazon: 0.8370, webcam: 0.9268, Art: 0.8700, Clipart: 0.7955, dslr: 0.9485, 
Average Test Accuracy(group): 0.8907, Average Test Accuracy(individual): 0.9056,
domain std=0.0536, cluster std=0.0332, individual std=0.0429, 
Average Test Accuracy: 0.8907
============ Train epoch 47 ============
cnt=[6, 6, 3, 2, 5, 4, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-RealWorld                 (1) | Train Loss: 0.4570 | Train Acc: 0.9286
 Site-RealWorld                 (1) | Train Loss: 0.4146 | Train Acc: 0.9444
 Site-RealWorld                 (6) | Train Loss: 0.3071 | Train Acc: 0.9167
 Site-RealWorld                 (1) | Train Loss: 0.2533 | Train Acc: 0.9677
 Site-RealWorld                 (1) | Train Loss: 0.5551 | Train Acc: 0.8750
 Site-RealWorld                 (6) | Train Loss: 0.3007 | Train Acc: 0.9216
 Site-RealWorld                 (4) | Train Loss: 0.2409 | Train Acc: 0.9254
 Site-RealWorld                 (4) | Train Loss: 0.3285 | Train Acc: 0.9070
 Site-RealWorld                 (4) | Train Loss: 0.3061 | Train Acc: 0.9459
 Site-RealWorld                 (6) | Train Loss: 0.2114 | Train Acc: 0.9653
 Site-Product                   (5) | Train Loss: 0.3834 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 0.5245 | Train Acc: 0.9167
 Site-Product                   (2) | Train Loss: 0.5303 | Train Acc: 0.9091
 Site-Product                   (0) | Train Loss: 0.4963 | Train Acc: 0.9130
 Site-Product                   (0) | Train Loss: 0.3609 | Train Acc: 0.9062
 Site-Product                   (2) | Train Loss: 0.3293 | Train Acc: 0.9326
 Site-Product                   (0) | Train Loss: 0.3285 | Train Acc: 0.9435
 Site-amazon                    (0) | Train Loss: 0.4764 | Train Acc: 0.9000
 Site-amazon                    (0) | Train Loss: 0.3267 | Train Acc: 0.9355
 Site-amazon                    (5) | Train Loss: 0.4450 | Train Acc: 0.8913
 Site-amazon                    (5) | Train Loss: 0.2960 | Train Acc: 0.9130
 Site-amazon                    (0) | Train Loss: 0.5793 | Train Acc: 0.8462
 Site-webcam                    (3) | Train Loss: 0.4943 | Train Acc: 0.8750
 Site-webcam                    (1) | Train Loss: 0.3505 | Train Acc: 0.9286
 Site-webcam                    (1) | Train Loss: 0.3086 | Train Acc: 0.9278
 Site-Art                       (4) | Train Loss: 0.7511 | Train Acc: 0.7857
 Site-Art                       (2) | Train Loss: 0.6579 | Train Acc: 0.8690
 Site-Clipart                   (4) | Train Loss: 0.8807 | Train Acc: 0.7647
 Site-dslr                      (3) | Train Loss: 0.2757 | Train Acc: 0.9483
Average Train Accuracy: 0.9064
 Site-RealWorld                 (1) | Val  Loss: 0.2866 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 0.1812 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1028 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2106 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3982 | Val  Acc: 0.8846
 Site-RealWorld                 (6) | Val  Loss: 0.2783 | Val  Acc: 0.9412
 Site-RealWorld                 (4) | Val  Loss: 0.3344 | Val  Acc: 0.9545
 Site-RealWorld                 (4) | Val  Loss: 0.4891 | Val  Acc: 0.8421
 Site-RealWorld                 (4) | Val  Loss: 0.4107 | Val  Acc: 0.8919
 Site-RealWorld                 (6) | Val  Loss: 0.4501 | Val  Acc: 0.8854
 Site-Product                   (5) | Val  Loss: 0.3079 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.2221 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.3008 | Val  Acc: 0.9545
 Site-Product                   (0) | Val  Loss: 0.2731 | Val  Acc: 0.9355
 Site-Product                   (0) | Val  Loss: 0.4303 | Val  Acc: 0.8605
 Site-Product                   (2) | Val  Loss: 0.4340 | Val  Acc: 0.9153
 Site-Product                   (0) | Val  Loss: 0.3481 | Val  Acc: 0.9146
 Site-amazon                    (0) | Val  Loss: 0.5138 | Val  Acc: 0.7692
 Site-amazon                    (0) | Val  Loss: 0.3892 | Val  Acc: 0.9000
 Site-amazon                    (5) | Val  Loss: 0.5209 | Val  Acc: 0.8710
 Site-amazon                    (5) | Val  Loss: 0.3254 | Val  Acc: 0.9348
 Site-amazon                    (0) | Val  Loss: 0.3597 | Val  Acc: 0.9275
 Site-webcam                    (3) | Val  Loss: 0.6498 | Val  Acc: 0.8095
 Site-webcam                    (1) | Val  Loss: 0.3928 | Val  Acc: 0.8649
 Site-webcam                    (1) | Val  Loss: 0.2858 | Val  Acc: 0.9219
 Site-Art                       (4) | Val  Loss: 0.5286 | Val  Acc: 0.8571
 Site-Art                       (2) | Val  Loss: 0.5533 | Val  Acc: 0.8571
 Site-Clipart                   (4) | Val  Loss: 0.7555 | Val  Acc: 0.7895
 Site-dslr                      (3) | Val  Loss: 0.2988 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9035
 Test site-RealWorld                 (1)| Epoch:42 | Test Acc: 0.9384
 Test site-Product                   (5)| Epoch:42 | Test Acc: 0.9106
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.8388
 Test site-webcam                    (3)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (4)| Epoch:42 | Test Acc: 0.8655
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.7934
 Test site-dslr                      (3)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9384, Product: 0.9106, amazon: 0.8388, webcam: 0.9268, Art: 0.8655, Clipart: 0.7934, dslr: 0.9485, 
Average Test Accuracy(group): 0.8888, Average Test Accuracy(individual): 0.9036,
domain std=0.0536, cluster std=0.0268, individual std=0.0424, 
Average Test Accuracy: 0.8888
============ Train epoch 48 ============
cnt=[8, 3, 2, 1, 5, 4, 6, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-RealWorld                 (2) | Train Loss: 0.3202 | Train Acc: 0.9286
 Site-RealWorld                 (1) | Train Loss: 0.4380 | Train Acc: 0.7778
 Site-RealWorld                 (5) | Train Loss: 0.3150 | Train Acc: 0.9167
 Site-RealWorld                 (6) | Train Loss: 0.2377 | Train Acc: 0.9355
 Site-RealWorld                 (1) | Train Loss: 0.5450 | Train Acc: 0.8500
 Site-RealWorld                 (1) | Train Loss: 0.2904 | Train Acc: 0.9412
 Site-RealWorld                 (6) | Train Loss: 0.4374 | Train Acc: 0.9254
 Site-RealWorld                 (4) | Train Loss: 0.3090 | Train Acc: 0.9070
 Site-RealWorld                 (6) | Train Loss: 0.3167 | Train Acc: 0.9189
 Site-RealWorld                 (4) | Train Loss: 0.1989 | Train Acc: 0.9792
 Site-Product                   (6) | Train Loss: 0.5079 | Train Acc: 0.8824
 Site-Product                   (3) | Train Loss: 0.5534 | Train Acc: 0.8333
 Site-Product                   (0) | Train Loss: 0.6820 | Train Acc: 0.8485
 Site-Product                   (0) | Train Loss: 0.5417 | Train Acc: 0.8261
 Site-Product                   (0) | Train Loss: 0.3565 | Train Acc: 0.9375
 Site-Product                   (4) | Train Loss: 0.2749 | Train Acc: 0.9551
 Site-Product                   (4) | Train Loss: 0.3557 | Train Acc: 0.9194
 Site-amazon                    (0) | Train Loss: 0.4493 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.2821 | Train Acc: 0.9032
 Site-amazon                    (0) | Train Loss: 0.3644 | Train Acc: 0.9130
 Site-amazon                    (0) | Train Loss: 0.3761 | Train Acc: 0.9275
 Site-amazon                    (0) | Train Loss: 0.5588 | Train Acc: 0.8269
 Site-webcam                    (5) | Train Loss: 0.5069 | Train Acc: 0.9062
 Site-webcam                    (6) | Train Loss: 0.3233 | Train Acc: 0.9464
 Site-webcam                    (5) | Train Loss: 0.3534 | Train Acc: 0.9381
 Site-Art                       (5) | Train Loss: 0.6774 | Train Acc: 0.9048
 Site-Art                       (4) | Train Loss: 0.5689 | Train Acc: 0.8929
 Site-Clipart                   (6) | Train Loss: 0.7629 | Train Acc: 0.7882
 Site-dslr                      (2) | Train Loss: 0.3382 | Train Acc: 0.9310
Average Train Accuracy: 0.9004
 Site-RealWorld                 (2) | Val  Loss: 0.2410 | Val  Acc: 0.8889
 Site-RealWorld                 (1) | Val  Loss: 0.2284 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.1044 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2338 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3067 | Val  Acc: 0.9615
 Site-RealWorld                 (1) | Val  Loss: 0.3282 | Val  Acc: 0.9412
 Site-RealWorld                 (6) | Val  Loss: 0.3546 | Val  Acc: 0.9318
 Site-RealWorld                 (4) | Val  Loss: 0.4361 | Val  Acc: 0.8772
 Site-RealWorld                 (6) | Val  Loss: 0.3710 | Val  Acc: 0.9054
 Site-RealWorld                 (4) | Val  Loss: 0.4071 | Val  Acc: 0.9167
 Site-Product                   (6) | Val  Loss: 0.2964 | Val  Acc: 0.9091
 Site-Product                   (3) | Val  Loss: 0.2832 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3603 | Val  Acc: 0.9091
 Site-Product                   (0) | Val  Loss: 0.2746 | Val  Acc: 0.9032
 Site-Product                   (0) | Val  Loss: 0.4309 | Val  Acc: 0.9070
 Site-Product                   (4) | Val  Loss: 0.3891 | Val  Acc: 0.9322
 Site-Product                   (4) | Val  Loss: 0.3642 | Val  Acc: 0.9024
 Site-amazon                    (0) | Val  Loss: 0.4448 | Val  Acc: 0.8462
 Site-amazon                    (0) | Val  Loss: 0.4289 | Val  Acc: 0.8500
 Site-amazon                    (0) | Val  Loss: 0.5113 | Val  Acc: 0.8710
 Site-amazon                    (0) | Val  Loss: 0.3558 | Val  Acc: 0.8913
 Site-amazon                    (0) | Val  Loss: 0.3205 | Val  Acc: 0.8986
 Site-webcam                    (5) | Val  Loss: 0.6096 | Val  Acc: 0.8095
 Site-webcam                    (6) | Val  Loss: 0.4106 | Val  Acc: 0.8649
 Site-webcam                    (5) | Val  Loss: 0.3014 | Val  Acc: 0.9531
 Site-Art                       (5) | Val  Loss: 0.5503 | Val  Acc: 0.8571
 Site-Art                       (4) | Val  Loss: 0.5473 | Val  Acc: 0.8929
 Site-Clipart                   (6) | Val  Loss: 0.8220 | Val  Acc: 0.7895
 Site-dslr                      (2) | Val  Loss: 0.2437 | Val  Acc: 0.9474
Average Valid Accuracy: 0.9089
 Test site-RealWorld                 (2)| Epoch:42 | Test Acc: 0.9384
 Test site-Product                   (6)| Epoch:42 | Test Acc: 0.9106
 Test site-amazon                    (0)| Epoch:42 | Test Acc: 0.8388
 Test site-webcam                    (5)| Epoch:42 | Test Acc: 0.9268
 Test site-Art                       (5)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (6)| Epoch:42 | Test Acc: 0.7975
 Test site-dslr                      (2)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9384, Product: 0.9106, amazon: 0.8388, webcam: 0.9268, Art: 0.8700, Clipart: 0.7975, dslr: 0.9485, 
Average Test Accuracy(group): 0.8901, Average Test Accuracy(individual): 0.9041,
domain std=0.0522, cluster std=0.0234, individual std=0.0417, 
Average Test Accuracy: 0.8901
============ Train epoch 49 ============
cnt=[5, 5, 2, 2, 6, 4, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-RealWorld                 (0) | Train Loss: 0.3347 | Train Acc: 0.9286
 Site-RealWorld                 (0) | Train Loss: 0.3920 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.3473 | Train Acc: 0.8750
 Site-RealWorld                 (4) | Train Loss: 0.2899 | Train Acc: 0.9677
 Site-RealWorld                 (4) | Train Loss: 0.5889 | Train Acc: 0.8750
 Site-RealWorld                 (0) | Train Loss: 0.2776 | Train Acc: 0.9216
 Site-RealWorld                 (4) | Train Loss: 0.2162 | Train Acc: 0.9254
 Site-RealWorld                 (6) | Train Loss: 0.3004 | Train Acc: 0.9070
 Site-RealWorld                 (6) | Train Loss: 0.2965 | Train Acc: 0.9369
 Site-RealWorld                 (6) | Train Loss: 0.2333 | Train Acc: 0.9792
 Site-Product                   (4) | Train Loss: 0.4803 | Train Acc: 0.8824
 Site-Product                   (5) | Train Loss: 0.4342 | Train Acc: 0.9167
 Site-Product                   (2) | Train Loss: 0.5947 | Train Acc: 0.8182
 Site-Product                   (1) | Train Loss: 0.4958 | Train Acc: 0.8913
 Site-Product                   (5) | Train Loss: 0.2968 | Train Acc: 0.9531
 Site-Product                   (1) | Train Loss: 0.3368 | Train Acc: 0.9101
 Site-Product                   (6) | Train Loss: 0.3431 | Train Acc: 0.9274
 Site-amazon                    (1) | Train Loss: 0.3835 | Train Acc: 0.9500
 Site-amazon                    (5) | Train Loss: 0.2638 | Train Acc: 0.9355
 Site-amazon                    (5) | Train Loss: 0.3443 | Train Acc: 0.8913
 Site-amazon                    (1) | Train Loss: 0.4208 | Train Acc: 0.9130
 Site-amazon                    (2) | Train Loss: 0.5665 | Train Acc: 0.8462
 Site-webcam                    (3) | Train Loss: 0.4293 | Train Acc: 0.9062
 Site-webcam                    (0) | Train Loss: 0.3437 | Train Acc: 0.9286
 Site-webcam                    (0) | Train Loss: 0.2659 | Train Acc: 0.9485
 Site-Art                       (4) | Train Loss: 0.6639 | Train Acc: 0.8810
 Site-Art                       (6) | Train Loss: 0.6751 | Train Acc: 0.8452
 Site-Clipart                   (4) | Train Loss: 0.7537 | Train Acc: 0.7529
 Site-dslr                      (3) | Train Loss: 0.3353 | Train Acc: 0.9138
Average Train Accuracy: 0.9040
 Site-RealWorld                 (0) | Val  Loss: 0.1076 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2083 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.0999 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2278 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3130 | Val  Acc: 0.9231
 Site-RealWorld                 (0) | Val  Loss: 0.3049 | Val  Acc: 0.9706
 Site-RealWorld                 (4) | Val  Loss: 0.3231 | Val  Acc: 0.9318
 Site-RealWorld                 (6) | Val  Loss: 0.4774 | Val  Acc: 0.8596
 Site-RealWorld                 (6) | Val  Loss: 0.4419 | Val  Acc: 0.8784
 Site-RealWorld                 (6) | Val  Loss: 0.4077 | Val  Acc: 0.9062
 Site-Product                   (4) | Val  Loss: 0.1903 | Val  Acc: 0.9091
 Site-Product                   (5) | Val  Loss: 0.2997 | Val  Acc: 0.9375
 Site-Product                   (2) | Val  Loss: 0.3824 | Val  Acc: 0.8636
 Site-Product                   (1) | Val  Loss: 0.2599 | Val  Acc: 0.9355
 Site-Product                   (5) | Val  Loss: 0.4503 | Val  Acc: 0.8837
 Site-Product                   (1) | Val  Loss: 0.3643 | Val  Acc: 0.9153
 Site-Product                   (6) | Val  Loss: 0.4024 | Val  Acc: 0.9146
 Site-amazon                    (1) | Val  Loss: 0.3976 | Val  Acc: 0.9231
 Site-amazon                    (5) | Val  Loss: 0.4026 | Val  Acc: 0.8500
 Site-amazon                    (5) | Val  Loss: 0.5313 | Val  Acc: 0.8710
 Site-amazon                    (1) | Val  Loss: 0.2854 | Val  Acc: 0.9130
 Site-amazon                    (2) | Val  Loss: 0.3017 | Val  Acc: 0.9275
 Site-webcam                    (3) | Val  Loss: 0.5271 | Val  Acc: 0.8571
 Site-webcam                    (0) | Val  Loss: 0.4519 | Val  Acc: 0.8378
 Site-webcam                    (0) | Val  Loss: 0.2678 | Val  Acc: 0.9688
 Site-Art                       (4) | Val  Loss: 0.5383 | Val  Acc: 0.8571
 Site-Art                       (6) | Val  Loss: 0.5359 | Val  Acc: 0.8750
 Site-Clipart                   (4) | Val  Loss: 0.7623 | Val  Acc: 0.8246
 Site-dslr                      (3) | Val  Loss: 0.2704 | Val  Acc: 0.9211
Average Valid Accuracy: 0.9122
 Test site-RealWorld                 (0)| Epoch:42 | Test Acc: 0.9384
 Test site-Product                   (4)| Epoch:42 | Test Acc: 0.9126
 Test site-amazon                    (1)| Epoch:42 | Test Acc: 0.8388
 Test site-webcam                    (3)| Epoch:42 | Test Acc: 0.9207
 Test site-Art                       (4)| Epoch:42 | Test Acc: 0.8655
 Test site-Clipart                   (4)| Epoch:42 | Test Acc: 0.7975
 Test site-dslr                      (3)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9384, Product: 0.9126, amazon: 0.8388, webcam: 0.9207, Art: 0.8655, Clipart: 0.7975, dslr: 0.9485, 
Average Test Accuracy(group): 0.8889, Average Test Accuracy(individual): 0.9036,
domain std=0.0521, cluster std=0.0232, individual std=0.0418, 
Average Test Accuracy: 0.8889
===2023-08-06 02:44:58===
===2023-08-06 02:45:14===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,51,67,86,111,144,17,24,33,46,64,89,124,20,31,46,69,104,32,56,97,42,84,85,58,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[986,670,456,310,211,143,97,]
domain number = 7
Loading snapshots...
 Test site-RealWorld                 (1)| Epoch:42 | Test Acc: 0.9361
 Test site-Product                   (6)| Epoch:42 | Test Acc: 0.9228
 Test site-amazon                    (3)| Epoch:42 | Test Acc: 0.8388
 Test site-webcam                    (4)| Epoch:42 | Test Acc: 0.9329
 Test site-Art                       (1)| Epoch:42 | Test Acc: 0.8700
 Test site-Clipart                   (2)| Epoch:42 | Test Acc: 0.7955
 Test site-dslr                      (1)| Epoch:42 | Test Acc: 0.9485
RealWorld: 0.9361, Product: 0.9228, amazon: 0.8388, webcam: 0.9329, Art: 0.8700, Clipart: 0.7955, dslr: 0.9485, 
Average Test Accuracy(group): 0.8921, Average Test Accuracy(individual): 0.9068,
domain std=0.0540, cluster std=0.0502, individual std=0.0425, 
===2023-08-06 18:16:47===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[9,12,15,20,25,33,43,55,72,93,11,15,21,30,41,57,79,13,20,29,44,66,20,35,62,27,54,55,37,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[635,431,293,199,135,92,62,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 13, 10, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-RealWorld                 (6) | Train Loss: 2.3958 | Train Acc: 0.3333
 Site-RealWorld                 (5) | Train Loss: 2.4152 | Train Acc: 0.2500
 Site-RealWorld                 (1) | Train Loss: 2.5624 | Train Acc: 0.0667
 Site-RealWorld                 (1) | Train Loss: 2.3909 | Train Acc: 0.0000
 Site-RealWorld                 (1) | Train Loss: 2.4129 | Train Acc: 0.0400
 Site-RealWorld                 (1) | Train Loss: 2.4690 | Train Acc: 0.1818
 Site-RealWorld                 (1) | Train Loss: 2.3372 | Train Acc: 0.1628
 Site-RealWorld                 (1) | Train Loss: 2.3764 | Train Acc: 0.1818
 Site-RealWorld                 (1) | Train Loss: 2.4397 | Train Acc: 0.1944
 Site-RealWorld                 (1) | Train Loss: 2.3507 | Train Acc: 0.1720
 Site-caltech                   (3) | Train Loss: 2.4251 | Train Acc: 0.2727
 Site-caltech                   (0) | Train Loss: 2.3813 | Train Acc: 0.1333
 Site-caltech                   (1) | Train Loss: 2.3787 | Train Acc: 0.1905
 Site-caltech                   (1) | Train Loss: 2.4735 | Train Acc: 0.2333
 Site-caltech                   (2) | Train Loss: 2.3796 | Train Acc: 0.1463
 Site-caltech                   (1) | Train Loss: 2.4498 | Train Acc: 0.1930
 Site-caltech                   (1) | Train Loss: 2.4185 | Train Acc: 0.1519
 Site-Product                   (2) | Train Loss: 2.3244 | Train Acc: 0.3077
 Site-Product                   (2) | Train Loss: 2.5047 | Train Acc: 0.1000
 Site-Product                   (2) | Train Loss: 2.3569 | Train Acc: 0.1379
 Site-Product                   (2) | Train Loss: 2.3297 | Train Acc: 0.2727
 Site-Product                   (2) | Train Loss: 2.4137 | Train Acc: 0.1515
 Site-amazon                    (2) | Train Loss: 2.4158 | Train Acc: 0.1000
 Site-amazon                    (2) | Train Loss: 2.3472 | Train Acc: 0.2571
 Site-amazon                    (2) | Train Loss: 2.3962 | Train Acc: 0.1613
 Site-webcam                    (4) | Train Loss: 2.4455 | Train Acc: 0.1852
 Site-webcam                    (4) | Train Loss: 2.3737 | Train Acc: 0.1481
 Site-Art                       (1) | Train Loss: 2.4445 | Train Acc: 0.0727
 Site-Clipart                   (2) | Train Loss: 2.4930 | Train Acc: 0.1351
Average Train Accuracy: 0.1701
 Site-RealWorld                 (6) | Val  Loss: 2.3651 | Val  Acc: 0.0000
 Site-RealWorld                 (5) | Val  Loss: 2.4809 | Val  Acc: 0.0000
 Site-RealWorld                 (1) | Val  Loss: 2.3596 | Val  Acc: 0.3000
 Site-RealWorld                 (1) | Val  Loss: 2.3873 | Val  Acc: 0.0769
 Site-RealWorld                 (1) | Val  Loss: 2.5363 | Val  Acc: 0.1176
 Site-RealWorld                 (1) | Val  Loss: 2.3386 | Val  Acc: 0.3182
 Site-RealWorld                 (1) | Val  Loss: 2.3279 | Val  Acc: 0.2500
 Site-RealWorld                 (1) | Val  Loss: 2.4483 | Val  Acc: 0.1622
 Site-RealWorld                 (1) | Val  Loss: 2.3317 | Val  Acc: 0.2292
 Site-RealWorld                 (1) | Val  Loss: 2.4128 | Val  Acc: 0.1774
 Site-caltech                   (3) | Val  Loss: 2.3243 | Val  Acc: 0.4286
 Site-caltech                   (0) | Val  Loss: 2.5319 | Val  Acc: 0.1000
 Site-caltech                   (1) | Val  Loss: 2.5891 | Val  Acc: 0.0000
 Site-caltech                   (1) | Val  Loss: 2.4872 | Val  Acc: 0.1500
 Site-caltech                   (2) | Val  Loss: 2.3551 | Val  Acc: 0.3333
 Site-caltech                   (1) | Val  Loss: 2.4017 | Val  Acc: 0.1316
 Site-caltech                   (1) | Val  Loss: 2.3821 | Val  Acc: 0.2075
 Site-Product                   (2) | Val  Loss: 2.3914 | Val  Acc: 0.2500
 Site-Product                   (2) | Val  Loss: 2.3894 | Val  Acc: 0.0769
 Site-Product                   (2) | Val  Loss: 2.4323 | Val  Acc: 0.1500
 Site-Product                   (2) | Val  Loss: 2.3384 | Val  Acc: 0.2759
 Site-Product                   (2) | Val  Loss: 2.2814 | Val  Acc: 0.2727
 Site-amazon                    (2) | Val  Loss: 2.4159 | Val  Acc: 0.0769
 Site-amazon                    (2) | Val  Loss: 2.3633 | Val  Acc: 0.1739
 Site-amazon                    (2) | Val  Loss: 2.4323 | Val  Acc: 0.1220
 Site-webcam                    (4) | Val  Loss: 2.3747 | Val  Acc: 0.2222
 Site-webcam                    (4) | Val  Loss: 2.3779 | Val  Acc: 0.1667
 Site-Art                       (1) | Val  Loss: 2.4733 | Val  Acc: 0.0833
 Site-Clipart                   (2) | Val  Loss: 2.4648 | Val  Acc: 0.1250
Average Valid Accuracy: 0.1717
 Best site-RealWorld                (6)  | Epoch:0 | Val Acc: 0.0000
 Best site-RealWorld                (5)  | Epoch:0 | Val Acc: 0.0000
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.3000
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.0769
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1176
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.3182
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.2500
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1622
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.2292
 Best site-RealWorld                (1)  | Epoch:0 | Val Acc: 0.1774
 Best site-caltech                  (3)  | Epoch:0 | Val Acc: 0.4286
 Best site-caltech                  (0)  | Epoch:0 | Val Acc: 0.1000
 Best site-caltech                  (1)  | Epoch:0 | Val Acc: 0.0000
 Best site-caltech                  (1)  | Epoch:0 | Val Acc: 0.1500
 Best site-caltech                  (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-caltech                  (1)  | Epoch:0 | Val Acc: 0.1316
 Best site-caltech                  (1)  | Epoch:0 | Val Acc: 0.2075
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.2500
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.0769
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.1500
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.2759
 Best site-Product                  (2)  | Epoch:0 | Val Acc: 0.2727
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.0769
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1739
 Best site-amazon                   (2)  | Epoch:0 | Val Acc: 0.1220
 Best site-webcam                   (4)  | Epoch:0 | Val Acc: 0.2222
 Best site-webcam                   (4)  | Epoch:0 | Val Acc: 0.1667
 Best site-Art                      (1)  | Epoch:0 | Val Acc: 0.0833
 Best site-Clipart                  (2)  | Epoch:0 | Val Acc: 0.1250
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 21, 1, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-RealWorld                 (3) | Train Loss: 2.3595 | Train Acc: 0.3333
 Site-RealWorld                 (1) | Train Loss: 2.3496 | Train Acc: 0.3333
 Site-RealWorld                 (6) | Train Loss: 2.3149 | Train Acc: 0.2667
 Site-RealWorld                 (1) | Train Loss: 2.2160 | Train Acc: 0.2500
 Site-RealWorld                 (1) | Train Loss: 2.2365 | Train Acc: 0.3600
 Site-RealWorld                 (1) | Train Loss: 2.3236 | Train Acc: 0.2727
 Site-RealWorld                 (1) | Train Loss: 2.2179 | Train Acc: 0.2791
 Site-RealWorld                 (1) | Train Loss: 2.2343 | Train Acc: 0.4000
 Site-RealWorld                 (1) | Train Loss: 2.2638 | Train Acc: 0.2500
 Site-RealWorld                 (1) | Train Loss: 2.2001 | Train Acc: 0.3011
 Site-caltech                   (2) | Train Loss: 2.4971 | Train Acc: 0.1818
 Site-caltech                   (1) | Train Loss: 2.2542 | Train Acc: 0.2667
 Site-caltech                   (0) | Train Loss: 2.1942 | Train Acc: 0.3810
 Site-caltech                   (1) | Train Loss: 2.3403 | Train Acc: 0.2000
 Site-caltech                   (1) | Train Loss: 2.3385 | Train Acc: 0.1951
 Site-caltech                   (1) | Train Loss: 2.2746 | Train Acc: 0.3860
 Site-caltech                   (1) | Train Loss: 2.2383 | Train Acc: 0.2911
 Site-Product                   (4) | Train Loss: 2.1435 | Train Acc: 0.4615
 Site-Product                   (1) | Train Loss: 2.3244 | Train Acc: 0.2500
 Site-Product                   (1) | Train Loss: 2.2137 | Train Acc: 0.3448
 Site-Product                   (1) | Train Loss: 2.2890 | Train Acc: 0.3864
 Site-Product                   (1) | Train Loss: 2.2795 | Train Acc: 0.2273
 Site-amazon                    (1) | Train Loss: 2.2445 | Train Acc: 0.3500
 Site-amazon                    (4) | Train Loss: 2.2703 | Train Acc: 0.3429
 Site-amazon                    (1) | Train Loss: 2.2929 | Train Acc: 0.2742
 Site-webcam                    (5) | Train Loss: 2.2658 | Train Acc: 0.2963
 Site-webcam                    (5) | Train Loss: 2.3285 | Train Acc: 0.2593
 Site-Art                       (1) | Train Loss: 2.2758 | Train Acc: 0.2182
 Site-Clipart                   (1) | Train Loss: 2.4133 | Train Acc: 0.1081
Average Train Accuracy: 0.2920
 Site-RealWorld                 (3) | Val  Loss: 2.1938 | Val  Acc: 0.5000
 Site-RealWorld                 (1) | Val  Loss: 2.2801 | Val  Acc: 0.3750
 Site-RealWorld                 (6) | Val  Loss: 2.2099 | Val  Acc: 0.5000
 Site-RealWorld                 (1) | Val  Loss: 2.2028 | Val  Acc: 0.3846
 Site-RealWorld                 (1) | Val  Loss: 2.4393 | Val  Acc: 0.1176
 Site-RealWorld                 (1) | Val  Loss: 2.2768 | Val  Acc: 0.3182
 Site-RealWorld                 (1) | Val  Loss: 2.2046 | Val  Acc: 0.5000
 Site-RealWorld                 (1) | Val  Loss: 2.3042 | Val  Acc: 0.2973
 Site-RealWorld                 (1) | Val  Loss: 2.2175 | Val  Acc: 0.3750
 Site-RealWorld                 (1) | Val  Loss: 2.2744 | Val  Acc: 0.3387
 Site-caltech                   (2) | Val  Loss: 2.2414 | Val  Acc: 0.4286
 Site-caltech                   (1) | Val  Loss: 2.3063 | Val  Acc: 0.3000
 Site-caltech                   (0) | Val  Loss: 2.3696 | Val  Acc: 0.2857
 Site-caltech                   (1) | Val  Loss: 2.2984 | Val  Acc: 0.2500
 Site-caltech                   (1) | Val  Loss: 2.2294 | Val  Acc: 0.4815
 Site-caltech                   (1) | Val  Loss: 2.2841 | Val  Acc: 0.2632
 Site-caltech                   (1) | Val  Loss: 2.3445 | Val  Acc: 0.1887
 Site-Product                   (4) | Val  Loss: 2.3901 | Val  Acc: 0.1250
 Site-Product                   (1) | Val  Loss: 2.3525 | Val  Acc: 0.2308
 Site-Product                   (1) | Val  Loss: 2.3778 | Val  Acc: 0.2000
 Site-Product                   (1) | Val  Loss: 2.2645 | Val  Acc: 0.3793
 Site-Product                   (1) | Val  Loss: 2.2192 | Val  Acc: 0.3636
 Site-amazon                    (1) | Val  Loss: 2.3115 | Val  Acc: 0.3846
 Site-amazon                    (4) | Val  Loss: 2.3099 | Val  Acc: 0.2609
 Site-amazon                    (1) | Val  Loss: 2.2901 | Val  Acc: 0.3415
 Site-webcam                    (5) | Val  Loss: 2.3536 | Val  Acc: 0.1667
 Site-webcam                    (5) | Val  Loss: 2.3065 | Val  Acc: 0.1944
 Site-Art                       (1) | Val  Loss: 2.3578 | Val  Acc: 0.1667
 Site-Clipart                   (1) | Val  Loss: 2.4518 | Val  Acc: 0.1250
Average Valid Accuracy: 0.3049
 Best site-RealWorld                (3)  | Epoch:1 | Val Acc: 0.5000
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-RealWorld                (6)  | Epoch:1 | Val Acc: 0.5000
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.1176
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.3182
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.5000
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.2973
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.3750
 Best site-RealWorld                (1)  | Epoch:1 | Val Acc: 0.3387
 Best site-caltech                  (2)  | Epoch:1 | Val Acc: 0.4286
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.3000
 Best site-caltech                  (0)  | Epoch:1 | Val Acc: 0.2857
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.2500
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.4815
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.2632
 Best site-caltech                  (1)  | Epoch:1 | Val Acc: 0.1887
 Best site-Product                  (4)  | Epoch:1 | Val Acc: 0.1250
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2308
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.2000
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.3793
 Best site-Product                  (1)  | Epoch:1 | Val Acc: 0.3636
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.3846
 Best site-amazon                   (4)  | Epoch:1 | Val Acc: 0.2609
 Best site-amazon                   (1)  | Epoch:1 | Val Acc: 0.3415
 Best site-webcam                   (5)  | Epoch:1 | Val Acc: 0.1667
 Best site-webcam                   (5)  | Epoch:1 | Val Acc: 0.1944
 Best site-Art                      (1)  | Epoch:1 | Val Acc: 0.1667
 Best site-Clipart                  (1)  | Epoch:1 | Val Acc: 0.1250
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 3, 14, 2, 7, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-RealWorld                 (2) | Train Loss: 2.1811 | Train Acc: 0.4444
 Site-RealWorld                 (2) | Train Loss: 2.2433 | Train Acc: 0.3333
 Site-RealWorld                 (0) | Train Loss: 2.2144 | Train Acc: 0.2667
 Site-RealWorld                 (2) | Train Loss: 2.1781 | Train Acc: 0.3000
 Site-RealWorld                 (2) | Train Loss: 2.2224 | Train Acc: 0.2800
 Site-RealWorld                 (4) | Train Loss: 2.2344 | Train Acc: 0.3030
 Site-RealWorld                 (2) | Train Loss: 2.1160 | Train Acc: 0.4186
 Site-RealWorld                 (2) | Train Loss: 2.1097 | Train Acc: 0.4000
 Site-RealWorld                 (2) | Train Loss: 2.1420 | Train Acc: 0.3889
 Site-RealWorld                 (2) | Train Loss: 2.1066 | Train Acc: 0.4086
 Site-caltech                   (6) | Train Loss: 2.3352 | Train Acc: 0.2727
 Site-caltech                   (5) | Train Loss: 2.1728 | Train Acc: 0.4000
 Site-caltech                   (2) | Train Loss: 2.1533 | Train Acc: 0.3810
 Site-caltech                   (2) | Train Loss: 2.2591 | Train Acc: 0.2667
 Site-caltech                   (2) | Train Loss: 2.2255 | Train Acc: 0.2927
 Site-caltech                   (2) | Train Loss: 2.1780 | Train Acc: 0.2807
 Site-caltech                   (2) | Train Loss: 2.1191 | Train Acc: 0.3291
 Site-Product                   (1) | Train Loss: 2.0649 | Train Acc: 0.4615
 Site-Product                   (4) | Train Loss: 2.1458 | Train Acc: 0.4500
 Site-Product                   (4) | Train Loss: 2.1692 | Train Acc: 0.3448
 Site-Product                   (4) | Train Loss: 2.1538 | Train Acc: 0.4773
 Site-Product                   (4) | Train Loss: 2.4295 | Train Acc: 0.3030
 Site-amazon                    (1) | Train Loss: 2.1643 | Train Acc: 0.4000
 Site-amazon                    (1) | Train Loss: 2.2333 | Train Acc: 0.4000
 Site-amazon                    (4) | Train Loss: 2.1876 | Train Acc: 0.4355
 Site-webcam                    (3) | Train Loss: 2.1939 | Train Acc: 0.3333
 Site-webcam                    (3) | Train Loss: 2.1817 | Train Acc: 0.2963
 Site-Art                       (2) | Train Loss: 2.1803 | Train Acc: 0.2727
 Site-Clipart                   (4) | Train Loss: 2.3183 | Train Acc: 0.2432
Average Train Accuracy: 0.3512
 Site-RealWorld                 (2) | Val  Loss: 2.1540 | Val  Acc: 0.3333
 Site-RealWorld                 (2) | Val  Loss: 2.1059 | Val  Acc: 0.3750
 Site-RealWorld                 (0) | Val  Loss: 2.1355 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 2.1162 | Val  Acc: 0.4615
 Site-RealWorld                 (2) | Val  Loss: 2.3240 | Val  Acc: 0.2353
 Site-RealWorld                 (4) | Val  Loss: 2.0519 | Val  Acc: 0.5455
 Site-RealWorld                 (2) | Val  Loss: 2.0361 | Val  Acc: 0.5357
 Site-RealWorld                 (2) | Val  Loss: 2.1365 | Val  Acc: 0.3784
 Site-RealWorld                 (2) | Val  Loss: 2.1086 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 2.1339 | Val  Acc: 0.4194
 Site-caltech                   (6) | Val  Loss: 2.0715 | Val  Acc: 0.4286
 Site-caltech                   (5) | Val  Loss: 2.2113 | Val  Acc: 0.4000
 Site-caltech                   (2) | Val  Loss: 2.3143 | Val  Acc: 0.2143
 Site-caltech                   (2) | Val  Loss: 2.2324 | Val  Acc: 0.3000
 Site-caltech                   (2) | Val  Loss: 2.1196 | Val  Acc: 0.3704
 Site-caltech                   (2) | Val  Loss: 2.2019 | Val  Acc: 0.3421
 Site-caltech                   (2) | Val  Loss: 2.1918 | Val  Acc: 0.3585
 Site-Product                   (1) | Val  Loss: 2.3458 | Val  Acc: 0.2500
 Site-Product                   (4) | Val  Loss: 2.3868 | Val  Acc: 0.2308
 Site-Product                   (4) | Val  Loss: 2.3619 | Val  Acc: 0.2500
 Site-Product                   (4) | Val  Loss: 2.1574 | Val  Acc: 0.3793
 Site-Product                   (4) | Val  Loss: 2.1231 | Val  Acc: 0.4545
 Site-amazon                    (1) | Val  Loss: 2.2513 | Val  Acc: 0.3846
 Site-amazon                    (1) | Val  Loss: 2.2809 | Val  Acc: 0.2609
 Site-amazon                    (4) | Val  Loss: 2.2270 | Val  Acc: 0.2927
 Site-webcam                    (3) | Val  Loss: 2.2474 | Val  Acc: 0.2778
 Site-webcam                    (3) | Val  Loss: 2.1678 | Val  Acc: 0.3333
 Site-Art                       (2) | Val  Loss: 2.2785 | Val  Acc: 0.2222
 Site-Clipart                   (4) | Val  Loss: 2.3842 | Val  Acc: 0.2083
Average Valid Accuracy: 0.3532
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.3333
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.3750
 Best site-RealWorld                (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.4615
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.2353
 Best site-RealWorld                (4)  | Epoch:2 | Val Acc: 0.5455
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.5357
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.3784
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:2 | Val Acc: 0.4194
 Best site-caltech                  (6)  | Epoch:2 | Val Acc: 0.4286
 Best site-caltech                  (5)  | Epoch:2 | Val Acc: 0.4000
 Best site-caltech                  (2)  | Epoch:2 | Val Acc: 0.2143
 Best site-caltech                  (2)  | Epoch:2 | Val Acc: 0.3000
 Best site-caltech                  (2)  | Epoch:2 | Val Acc: 0.3704
 Best site-caltech                  (2)  | Epoch:2 | Val Acc: 0.3421
 Best site-caltech                  (2)  | Epoch:2 | Val Acc: 0.3585
 Best site-Product                  (1)  | Epoch:2 | Val Acc: 0.2500
 Best site-Product                  (4)  | Epoch:2 | Val Acc: 0.2308
 Best site-Product                  (4)  | Epoch:2 | Val Acc: 0.2500
 Best site-Product                  (4)  | Epoch:2 | Val Acc: 0.3793
 Best site-Product                  (4)  | Epoch:2 | Val Acc: 0.4545
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.3846
 Best site-amazon                   (1)  | Epoch:2 | Val Acc: 0.2609
 Best site-amazon                   (4)  | Epoch:2 | Val Acc: 0.2927
 Best site-webcam                   (3)  | Epoch:2 | Val Acc: 0.2778
 Best site-webcam                   (3)  | Epoch:2 | Val Acc: 0.3333
 Best site-Art                      (2)  | Epoch:2 | Val Acc: 0.2222
 Best site-Clipart                  (4)  | Epoch:2 | Val Acc: 0.2083
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 4, 14, 6, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-RealWorld                 (2) | Train Loss: 2.1059 | Train Acc: 0.5556
 Site-RealWorld                 (2) | Train Loss: 2.1355 | Train Acc: 0.3333
 Site-RealWorld                 (2) | Train Loss: 2.1487 | Train Acc: 0.2667
 Site-RealWorld                 (2) | Train Loss: 2.0446 | Train Acc: 0.3500
 Site-RealWorld                 (2) | Train Loss: 2.0018 | Train Acc: 0.6000
 Site-RealWorld                 (2) | Train Loss: 2.0561 | Train Acc: 0.5152
 Site-RealWorld                 (2) | Train Loss: 2.0019 | Train Acc: 0.5814
 Site-RealWorld                 (2) | Train Loss: 1.9976 | Train Acc: 0.4909
 Site-RealWorld                 (2) | Train Loss: 2.1023 | Train Acc: 0.5278
 Site-RealWorld                 (2) | Train Loss: 1.9453 | Train Acc: 0.5484
 Site-caltech                   (5) | Train Loss: 2.2525 | Train Acc: 0.4545
 Site-caltech                   (4) | Train Loss: 2.0802 | Train Acc: 0.4667
 Site-caltech                   (1) | Train Loss: 2.0235 | Train Acc: 0.5714
 Site-caltech                   (2) | Train Loss: 2.1518 | Train Acc: 0.3667
 Site-caltech                   (1) | Train Loss: 2.1470 | Train Acc: 0.3415
 Site-caltech                   (1) | Train Loss: 2.0989 | Train Acc: 0.4386
 Site-caltech                   (1) | Train Loss: 2.0319 | Train Acc: 0.4557
 Site-Product                   (0) | Train Loss: 1.8504 | Train Acc: 0.5385
 Site-Product                   (6) | Train Loss: 2.0419 | Train Acc: 0.5500
 Site-Product                   (3) | Train Loss: 2.0108 | Train Acc: 0.5862
 Site-Product                   (3) | Train Loss: 2.0767 | Train Acc: 0.5455
 Site-Product                   (3) | Train Loss: 2.1857 | Train Acc: 0.4242
 Site-amazon                    (3) | Train Loss: 2.0134 | Train Acc: 0.6000
 Site-amazon                    (0) | Train Loss: 2.0296 | Train Acc: 0.6000
 Site-amazon                    (3) | Train Loss: 2.1136 | Train Acc: 0.4677
 Site-webcam                    (2) | Train Loss: 2.0474 | Train Acc: 0.4815
 Site-webcam                    (2) | Train Loss: 2.1218 | Train Acc: 0.4259
 Site-Art                       (2) | Train Loss: 2.1244 | Train Acc: 0.3273
 Site-Clipart                   (3) | Train Loss: 2.2336 | Train Acc: 0.2973
Average Train Accuracy: 0.4727
 Site-RealWorld                 (2) | Val  Loss: 1.9471 | Val  Acc: 0.6667
 Site-RealWorld                 (2) | Val  Loss: 2.0107 | Val  Acc: 0.5000
 Site-RealWorld                 (2) | Val  Loss: 2.0135 | Val  Acc: 0.6000
 Site-RealWorld                 (2) | Val  Loss: 1.9920 | Val  Acc: 0.5385
 Site-RealWorld                 (2) | Val  Loss: 2.3049 | Val  Acc: 0.2941
 Site-RealWorld                 (2) | Val  Loss: 1.9796 | Val  Acc: 0.5455
 Site-RealWorld                 (2) | Val  Loss: 1.9354 | Val  Acc: 0.5714
 Site-RealWorld                 (2) | Val  Loss: 2.0956 | Val  Acc: 0.4595
 Site-RealWorld                 (2) | Val  Loss: 1.9513 | Val  Acc: 0.6042
 Site-RealWorld                 (2) | Val  Loss: 2.0170 | Val  Acc: 0.5323
 Site-caltech                   (5) | Val  Loss: 1.9662 | Val  Acc: 0.5714
 Site-caltech                   (4) | Val  Loss: 2.0708 | Val  Acc: 0.5000
 Site-caltech                   (1) | Val  Loss: 2.2395 | Val  Acc: 0.4286
 Site-caltech                   (2) | Val  Loss: 2.1295 | Val  Acc: 0.4000
 Site-caltech                   (1) | Val  Loss: 2.0644 | Val  Acc: 0.5556
 Site-caltech                   (1) | Val  Loss: 2.1223 | Val  Acc: 0.4211
 Site-caltech                   (1) | Val  Loss: 2.1332 | Val  Acc: 0.4906
 Site-Product                   (0) | Val  Loss: 2.1108 | Val  Acc: 0.5000
 Site-Product                   (6) | Val  Loss: 2.2133 | Val  Acc: 0.4615
 Site-Product                   (3) | Val  Loss: 2.2960 | Val  Acc: 0.3500
 Site-Product                   (3) | Val  Loss: 2.0409 | Val  Acc: 0.5172
 Site-Product                   (3) | Val  Loss: 1.9962 | Val  Acc: 0.6136
 Site-amazon                    (3) | Val  Loss: 2.1409 | Val  Acc: 0.6923
 Site-amazon                    (0) | Val  Loss: 2.1946 | Val  Acc: 0.3913
 Site-amazon                    (3) | Val  Loss: 2.1235 | Val  Acc: 0.4146
 Site-webcam                    (2) | Val  Loss: 2.1023 | Val  Acc: 0.4444
 Site-webcam                    (2) | Val  Loss: 2.0893 | Val  Acc: 0.3889
 Site-Art                       (2) | Val  Loss: 2.1458 | Val  Acc: 0.3333
 Site-Clipart                   (3) | Val  Loss: 2.2725 | Val  Acc: 0.4167
Average Valid Accuracy: 0.4898
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.6000
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5385
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.2941
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5455
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5714
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.4595
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.6042
 Best site-RealWorld                (2)  | Epoch:3 | Val Acc: 0.5323
 Best site-caltech                  (5)  | Epoch:3 | Val Acc: 0.5714
 Best site-caltech                  (4)  | Epoch:3 | Val Acc: 0.5000
 Best site-caltech                  (1)  | Epoch:3 | Val Acc: 0.4286
 Best site-caltech                  (2)  | Epoch:3 | Val Acc: 0.4000
 Best site-caltech                  (1)  | Epoch:3 | Val Acc: 0.5556
 Best site-caltech                  (1)  | Epoch:3 | Val Acc: 0.4211
 Best site-caltech                  (1)  | Epoch:3 | Val Acc: 0.4906
 Best site-Product                  (0)  | Epoch:3 | Val Acc: 0.5000
 Best site-Product                  (6)  | Epoch:3 | Val Acc: 0.4615
 Best site-Product                  (3)  | Epoch:3 | Val Acc: 0.3500
 Best site-Product                  (3)  | Epoch:3 | Val Acc: 0.5172
 Best site-Product                  (3)  | Epoch:3 | Val Acc: 0.6136
 Best site-amazon                   (3)  | Epoch:3 | Val Acc: 0.6923
 Best site-amazon                   (0)  | Epoch:3 | Val Acc: 0.3913
 Best site-amazon                   (3)  | Epoch:3 | Val Acc: 0.4146
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.4444
 Best site-webcam                   (2)  | Epoch:3 | Val Acc: 0.3889
 Best site-Art                      (2)  | Epoch:3 | Val Acc: 0.3333
 Best site-Clipart                  (3)  | Epoch:3 | Val Acc: 0.4167
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 8, 4, 1, 12, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-RealWorld                 (2) | Train Loss: 2.0055 | Train Acc: 0.6667
 Site-RealWorld                 (5) | Train Loss: 1.9935 | Train Acc: 0.6667
 Site-RealWorld                 (2) | Train Loss: 2.0017 | Train Acc: 0.6000
 Site-RealWorld                 (4) | Train Loss: 1.9253 | Train Acc: 0.6000
 Site-RealWorld                 (2) | Train Loss: 1.8598 | Train Acc: 0.7600
 Site-RealWorld                 (4) | Train Loss: 1.9820 | Train Acc: 0.5152
 Site-RealWorld                 (4) | Train Loss: 1.8809 | Train Acc: 0.5814
 Site-RealWorld                 (4) | Train Loss: 1.9226 | Train Acc: 0.5636
 Site-RealWorld                 (4) | Train Loss: 1.9225 | Train Acc: 0.6250
 Site-RealWorld                 (4) | Train Loss: 1.8571 | Train Acc: 0.6237
 Site-caltech                   (3) | Train Loss: 2.1531 | Train Acc: 0.4545
 Site-caltech                   (4) | Train Loss: 1.9111 | Train Acc: 0.6000
 Site-caltech                   (4) | Train Loss: 1.9196 | Train Acc: 0.6667
 Site-caltech                   (4) | Train Loss: 2.0292 | Train Acc: 0.4667
 Site-caltech                   (4) | Train Loss: 2.0107 | Train Acc: 0.5122
 Site-caltech                   (4) | Train Loss: 1.9768 | Train Acc: 0.5614
 Site-caltech                   (4) | Train Loss: 1.9181 | Train Acc: 0.6203
 Site-Product                   (1) | Train Loss: 1.7482 | Train Acc: 0.8462
 Site-Product                   (1) | Train Loss: 1.9254 | Train Acc: 0.5500
 Site-Product                   (1) | Train Loss: 1.9796 | Train Acc: 0.6207
 Site-Product                   (1) | Train Loss: 1.9221 | Train Acc: 0.5909
 Site-Product                   (1) | Train Loss: 2.3716 | Train Acc: 0.4545
 Site-amazon                    (1) | Train Loss: 1.8561 | Train Acc: 0.7500
 Site-amazon                    (1) | Train Loss: 1.9555 | Train Acc: 0.6000
 Site-amazon                    (1) | Train Loss: 1.9947 | Train Acc: 0.5323
 Site-webcam                    (0) | Train Loss: 1.9011 | Train Acc: 0.6296
 Site-webcam                    (0) | Train Loss: 1.9774 | Train Acc: 0.5556
 Site-Art                       (2) | Train Loss: 2.0352 | Train Acc: 0.4545
 Site-Clipart                   (6) | Train Loss: 2.1157 | Train Acc: 0.4054
Average Train Accuracy: 0.5887
 Site-RealWorld                 (2) | Val  Loss: 1.7949 | Val  Acc: 0.6667
 Site-RealWorld                 (5) | Val  Loss: 1.8302 | Val  Acc: 0.6250
 Site-RealWorld                 (2) | Val  Loss: 1.8220 | Val  Acc: 0.7000
 Site-RealWorld                 (4) | Val  Loss: 1.8522 | Val  Acc: 0.6923
 Site-RealWorld                 (2) | Val  Loss: 2.1990 | Val  Acc: 0.4706
 Site-RealWorld                 (4) | Val  Loss: 1.8802 | Val  Acc: 0.5909
 Site-RealWorld                 (4) | Val  Loss: 1.8453 | Val  Acc: 0.6429
 Site-RealWorld                 (4) | Val  Loss: 1.9639 | Val  Acc: 0.5676
 Site-RealWorld                 (4) | Val  Loss: 1.8465 | Val  Acc: 0.6458
 Site-RealWorld                 (4) | Val  Loss: 1.9397 | Val  Acc: 0.5645
 Site-caltech                   (3) | Val  Loss: 1.8330 | Val  Acc: 0.5714
 Site-caltech                   (4) | Val  Loss: 1.9042 | Val  Acc: 0.6000
 Site-caltech                   (4) | Val  Loss: 2.0712 | Val  Acc: 0.5000
 Site-caltech                   (4) | Val  Loss: 2.0127 | Val  Acc: 0.5500
 Site-caltech                   (4) | Val  Loss: 1.9214 | Val  Acc: 0.5926
 Site-caltech                   (4) | Val  Loss: 1.9679 | Val  Acc: 0.4737
 Site-caltech                   (4) | Val  Loss: 2.0106 | Val  Acc: 0.4717
 Site-Product                   (1) | Val  Loss: 2.0106 | Val  Acc: 0.5000
 Site-Product                   (1) | Val  Loss: 2.0381 | Val  Acc: 0.6154
 Site-Product                   (1) | Val  Loss: 2.0626 | Val  Acc: 0.5500
 Site-Product                   (1) | Val  Loss: 1.9024 | Val  Acc: 0.7241
 Site-Product                   (1) | Val  Loss: 1.9244 | Val  Acc: 0.6818
 Site-amazon                    (1) | Val  Loss: 2.0000 | Val  Acc: 0.6923
 Site-amazon                    (1) | Val  Loss: 2.1592 | Val  Acc: 0.4783
 Site-amazon                    (1) | Val  Loss: 2.0484 | Val  Acc: 0.5366
 Site-webcam                    (0) | Val  Loss: 1.9725 | Val  Acc: 0.6111
 Site-webcam                    (0) | Val  Loss: 1.9494 | Val  Acc: 0.5833
 Site-Art                       (2) | Val  Loss: 2.1323 | Val  Acc: 0.3056
 Site-Clipart                   (6) | Val  Loss: 2.1985 | Val  Acc: 0.3750
Average Valid Accuracy: 0.5717
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.6667
 Best site-RealWorld                (5)  | Epoch:4 | Val Acc: 0.6250
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.7000
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.6923
 Best site-RealWorld                (2)  | Epoch:4 | Val Acc: 0.4706
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.5909
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.6429
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.5676
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.6458
 Best site-RealWorld                (4)  | Epoch:4 | Val Acc: 0.5645
 Best site-caltech                  (3)  | Epoch:4 | Val Acc: 0.5714
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.6000
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.5000
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.5500
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.5926
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.4737
 Best site-caltech                  (4)  | Epoch:4 | Val Acc: 0.4717
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.5000
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.6154
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.5500
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.7241
 Best site-Product                  (1)  | Epoch:4 | Val Acc: 0.6818
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.6923
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.4783
 Best site-amazon                   (1)  | Epoch:4 | Val Acc: 0.5366
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.6111
 Best site-webcam                   (0)  | Epoch:4 | Val Acc: 0.5833
 Best site-Art                      (2)  | Epoch:4 | Val Acc: 0.3056
 Best site-Clipart                  (6)  | Epoch:4 | Val Acc: 0.3750
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 8, 4, 1, 12, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-RealWorld                 (3) | Train Loss: 1.8559 | Train Acc: 0.5556
 Site-RealWorld                 (6) | Train Loss: 1.9193 | Train Acc: 0.6667
 Site-RealWorld                 (4) | Train Loss: 1.8968 | Train Acc: 0.5333
 Site-RealWorld                 (2) | Train Loss: 1.7842 | Train Acc: 0.7000
 Site-RealWorld                 (4) | Train Loss: 1.8247 | Train Acc: 0.7200
 Site-RealWorld                 (4) | Train Loss: 1.8674 | Train Acc: 0.5758
 Site-RealWorld                 (4) | Train Loss: 1.7561 | Train Acc: 0.6744
 Site-RealWorld                 (4) | Train Loss: 1.8101 | Train Acc: 0.6000
 Site-RealWorld                 (4) | Train Loss: 1.8399 | Train Acc: 0.6667
 Site-RealWorld                 (4) | Train Loss: 1.7500 | Train Acc: 0.6882
 Site-caltech                   (5) | Train Loss: 1.9958 | Train Acc: 0.4545
 Site-caltech                   (1) | Train Loss: 1.8848 | Train Acc: 0.5333
 Site-caltech                   (2) | Train Loss: 1.8262 | Train Acc: 0.7143
 Site-caltech                   (4) | Train Loss: 1.9183 | Train Acc: 0.4333
 Site-caltech                   (1) | Train Loss: 1.8874 | Train Acc: 0.5610
 Site-caltech                   (2) | Train Loss: 1.8365 | Train Acc: 0.6140
 Site-caltech                   (2) | Train Loss: 1.7799 | Train Acc: 0.6709
 Site-Product                   (1) | Train Loss: 1.6337 | Train Acc: 0.8462
 Site-Product                   (4) | Train Loss: 1.8040 | Train Acc: 0.6500
 Site-Product                   (1) | Train Loss: 1.7982 | Train Acc: 0.7241
 Site-Product                   (1) | Train Loss: 1.8279 | Train Acc: 0.6591
 Site-Product                   (4) | Train Loss: 1.8270 | Train Acc: 0.6212
 Site-amazon                    (1) | Train Loss: 1.7156 | Train Acc: 0.7000
 Site-amazon                    (1) | Train Loss: 1.8361 | Train Acc: 0.6857
 Site-amazon                    (1) | Train Loss: 1.8912 | Train Acc: 0.6129
 Site-webcam                    (0) | Train Loss: 1.7898 | Train Acc: 0.7407
 Site-webcam                    (0) | Train Loss: 1.8607 | Train Acc: 0.5926
 Site-Art                       (4) | Train Loss: 1.9149 | Train Acc: 0.5818
 Site-Clipart                   (4) | Train Loss: 2.0265 | Train Acc: 0.4595
Average Train Accuracy: 0.6288
 Site-RealWorld                 (3) | Val  Loss: 1.6816 | Val  Acc: 0.6667
 Site-RealWorld                 (6) | Val  Loss: 1.8472 | Val  Acc: 0.6250
 Site-RealWorld                 (4) | Val  Loss: 1.7981 | Val  Acc: 0.8000
 Site-RealWorld                 (2) | Val  Loss: 1.7265 | Val  Acc: 0.7692
 Site-RealWorld                 (4) | Val  Loss: 2.1640 | Val  Acc: 0.3529
 Site-RealWorld                 (4) | Val  Loss: 1.7520 | Val  Acc: 0.6818
 Site-RealWorld                 (4) | Val  Loss: 1.7653 | Val  Acc: 0.6071
 Site-RealWorld                 (4) | Val  Loss: 1.8276 | Val  Acc: 0.5405
 Site-RealWorld                 (4) | Val  Loss: 1.7122 | Val  Acc: 0.7500
 Site-RealWorld                 (4) | Val  Loss: 1.8060 | Val  Acc: 0.6290
 Site-caltech                   (5) | Val  Loss: 1.7675 | Val  Acc: 0.7143
 Site-caltech                   (1) | Val  Loss: 1.7712 | Val  Acc: 0.7000
 Site-caltech                   (2) | Val  Loss: 1.9317 | Val  Acc: 0.5000
 Site-caltech                   (4) | Val  Loss: 1.8693 | Val  Acc: 0.5500
 Site-caltech                   (1) | Val  Loss: 1.8196 | Val  Acc: 0.6296
 Site-caltech                   (2) | Val  Loss: 1.7987 | Val  Acc: 0.6053
 Site-caltech                   (2) | Val  Loss: 1.9052 | Val  Acc: 0.5472
 Site-Product                   (1) | Val  Loss: 1.9135 | Val  Acc: 0.7500
 Site-Product                   (4) | Val  Loss: 1.9801 | Val  Acc: 0.6154
 Site-Product                   (1) | Val  Loss: 2.0061 | Val  Acc: 0.5000
 Site-Product                   (1) | Val  Loss: 1.7413 | Val  Acc: 0.6897
 Site-Product                   (4) | Val  Loss: 1.7537 | Val  Acc: 0.6818
 Site-amazon                    (1) | Val  Loss: 1.9683 | Val  Acc: 0.6923
 Site-amazon                    (1) | Val  Loss: 2.0169 | Val  Acc: 0.6087
 Site-amazon                    (1) | Val  Loss: 1.9472 | Val  Acc: 0.5122
 Site-webcam                    (0) | Val  Loss: 1.9124 | Val  Acc: 0.6111
 Site-webcam                    (0) | Val  Loss: 1.8179 | Val  Acc: 0.6944
 Site-Art                       (4) | Val  Loss: 1.9669 | Val  Acc: 0.4444
 Site-Clipart                   (4) | Val  Loss: 2.0553 | Val  Acc: 0.5000
Average Valid Accuracy: 0.6196
 Best site-RealWorld                (3)  | Epoch:5 | Val Acc: 0.6667
 Best site-RealWorld                (6)  | Epoch:5 | Val Acc: 0.6250
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.8000
 Best site-RealWorld                (2)  | Epoch:5 | Val Acc: 0.7692
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.3529
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.6818
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.6071
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.5405
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.7500
 Best site-RealWorld                (4)  | Epoch:5 | Val Acc: 0.6290
 Best site-caltech                  (5)  | Epoch:5 | Val Acc: 0.7143
 Best site-caltech                  (1)  | Epoch:5 | Val Acc: 0.7000
 Best site-caltech                  (2)  | Epoch:5 | Val Acc: 0.5000
 Best site-caltech                  (4)  | Epoch:5 | Val Acc: 0.5500
 Best site-caltech                  (1)  | Epoch:5 | Val Acc: 0.6296
 Best site-caltech                  (2)  | Epoch:5 | Val Acc: 0.6053
 Best site-caltech                  (2)  | Epoch:5 | Val Acc: 0.5472
 Best site-Product                  (1)  | Epoch:5 | Val Acc: 0.7500
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.6154
 Best site-Product                  (1)  | Epoch:5 | Val Acc: 0.5000
 Best site-Product                  (1)  | Epoch:5 | Val Acc: 0.6897
 Best site-Product                  (4)  | Epoch:5 | Val Acc: 0.6818
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.6923
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.6087
 Best site-amazon                   (1)  | Epoch:5 | Val Acc: 0.5122
 Best site-webcam                   (0)  | Epoch:5 | Val Acc: 0.6111
 Best site-webcam                   (0)  | Epoch:5 | Val Acc: 0.6944
 Best site-Art                      (4)  | Epoch:5 | Val Acc: 0.4444
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 8, 1, 2, 12, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-RealWorld                 (6) | Train Loss: 1.6827 | Train Acc: 0.6667
 Site-RealWorld                 (5) | Train Loss: 1.7288 | Train Acc: 0.7500
 Site-RealWorld                 (5) | Train Loss: 1.8516 | Train Acc: 0.6000
 Site-RealWorld                 (5) | Train Loss: 1.6593 | Train Acc: 0.8000
 Site-RealWorld                 (1) | Train Loss: 1.7085 | Train Acc: 0.7600
 Site-RealWorld                 (5) | Train Loss: 1.7199 | Train Acc: 0.6061
 Site-RealWorld                 (5) | Train Loss: 1.6316 | Train Acc: 0.6744
 Site-RealWorld                 (5) | Train Loss: 1.6687 | Train Acc: 0.7091
 Site-RealWorld                 (5) | Train Loss: 1.7125 | Train Acc: 0.7083
 Site-RealWorld                 (5) | Train Loss: 1.6281 | Train Acc: 0.7312
 Site-caltech                   (3) | Train Loss: 1.9651 | Train Acc: 0.4545
 Site-caltech                   (5) | Train Loss: 1.7224 | Train Acc: 0.6667
 Site-caltech                   (0) | Train Loss: 1.6248 | Train Acc: 0.7619
 Site-caltech                   (5) | Train Loss: 1.8609 | Train Acc: 0.5333
 Site-caltech                   (5) | Train Loss: 1.7284 | Train Acc: 0.5854
 Site-caltech                   (0) | Train Loss: 1.7316 | Train Acc: 0.5965
 Site-caltech                   (0) | Train Loss: 1.6483 | Train Acc: 0.6709
 Site-Product                   (2) | Train Loss: 1.4557 | Train Acc: 0.8462
 Site-Product                   (5) | Train Loss: 1.7340 | Train Acc: 0.7000
 Site-Product                   (2) | Train Loss: 1.7032 | Train Acc: 0.6552
 Site-Product                   (2) | Train Loss: 1.6750 | Train Acc: 0.6818
 Site-Product                   (2) | Train Loss: 1.7106 | Train Acc: 0.6970
 Site-amazon                    (2) | Train Loss: 1.5969 | Train Acc: 0.7000
 Site-amazon                    (2) | Train Loss: 1.7176 | Train Acc: 0.6857
 Site-amazon                    (2) | Train Loss: 1.7937 | Train Acc: 0.6613
 Site-webcam                    (4) | Train Loss: 1.6223 | Train Acc: 0.8148
 Site-webcam                    (4) | Train Loss: 1.7372 | Train Acc: 0.7222
 Site-Art                       (1) | Train Loss: 1.8222 | Train Acc: 0.6000
 Site-Clipart                   (2) | Train Loss: 1.9632 | Train Acc: 0.4865
Average Train Accuracy: 0.6733
 Site-RealWorld                 (6) | Val  Loss: 1.4885 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 1.6594 | Val  Acc: 0.6250
 Site-RealWorld                 (5) | Val  Loss: 1.6425 | Val  Acc: 0.8000
 Site-RealWorld                 (5) | Val  Loss: 1.5876 | Val  Acc: 0.9231
 Site-RealWorld                 (1) | Val  Loss: 2.0368 | Val  Acc: 0.5294
 Site-RealWorld                 (5) | Val  Loss: 1.5951 | Val  Acc: 0.7273
 Site-RealWorld                 (5) | Val  Loss: 1.6244 | Val  Acc: 0.6429
 Site-RealWorld                 (5) | Val  Loss: 1.7751 | Val  Acc: 0.5946
 Site-RealWorld                 (5) | Val  Loss: 1.5956 | Val  Acc: 0.6458
 Site-RealWorld                 (5) | Val  Loss: 1.6853 | Val  Acc: 0.6774
 Site-caltech                   (3) | Val  Loss: 1.6342 | Val  Acc: 0.5714
 Site-caltech                   (5) | Val  Loss: 1.6467 | Val  Acc: 0.8000
 Site-caltech                   (0) | Val  Loss: 1.9047 | Val  Acc: 0.5714
 Site-caltech                   (5) | Val  Loss: 1.7464 | Val  Acc: 0.7000
 Site-caltech                   (5) | Val  Loss: 1.6740 | Val  Acc: 0.7037
 Site-caltech                   (0) | Val  Loss: 1.7304 | Val  Acc: 0.6053
 Site-caltech                   (0) | Val  Loss: 1.7758 | Val  Acc: 0.5472
 Site-Product                   (2) | Val  Loss: 1.7463 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 1.9030 | Val  Acc: 0.6154
 Site-Product                   (2) | Val  Loss: 1.8206 | Val  Acc: 0.5500
 Site-Product                   (2) | Val  Loss: 1.6469 | Val  Acc: 0.6897
 Site-Product                   (2) | Val  Loss: 1.6786 | Val  Acc: 0.7045
 Site-amazon                    (2) | Val  Loss: 1.8429 | Val  Acc: 0.6154
 Site-amazon                    (2) | Val  Loss: 1.9430 | Val  Acc: 0.5652
 Site-amazon                    (2) | Val  Loss: 1.8127 | Val  Acc: 0.6585
 Site-webcam                    (4) | Val  Loss: 1.8384 | Val  Acc: 0.7222
 Site-webcam                    (4) | Val  Loss: 1.6671 | Val  Acc: 0.8333
 Site-Art                       (1) | Val  Loss: 1.9111 | Val  Acc: 0.5278
 Site-Clipart                   (2) | Val  Loss: 1.9786 | Val  Acc: 0.5417
Average Valid Accuracy: 0.6746
 Best site-RealWorld                (6)  | Epoch:6 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.6250
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.8000
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.9231
 Best site-RealWorld                (1)  | Epoch:6 | Val Acc: 0.5294
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.7273
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.6429
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.5946
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.6458
 Best site-RealWorld                (5)  | Epoch:6 | Val Acc: 0.6774
 Best site-caltech                  (3)  | Epoch:6 | Val Acc: 0.5714
 Best site-caltech                  (5)  | Epoch:6 | Val Acc: 0.8000
 Best site-caltech                  (0)  | Epoch:6 | Val Acc: 0.5714
 Best site-caltech                  (5)  | Epoch:6 | Val Acc: 0.7000
 Best site-caltech                  (5)  | Epoch:6 | Val Acc: 0.7037
 Best site-caltech                  (0)  | Epoch:6 | Val Acc: 0.6053
 Best site-caltech                  (0)  | Epoch:6 | Val Acc: 0.5472
 Best site-Product                  (2)  | Epoch:6 | Val Acc: 0.8750
 Best site-Product                  (5)  | Epoch:6 | Val Acc: 0.6154
 Best site-Product                  (2)  | Epoch:6 | Val Acc: 0.5500
 Best site-Product                  (2)  | Epoch:6 | Val Acc: 0.6897
 Best site-Product                  (2)  | Epoch:6 | Val Acc: 0.7045
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.6154
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.5652
 Best site-amazon                   (2)  | Epoch:6 | Val Acc: 0.6585
 Best site-webcam                   (4)  | Epoch:6 | Val Acc: 0.7222
 Best site-webcam                   (4)  | Epoch:6 | Val Acc: 0.8333
 Best site-Art                      (1)  | Epoch:6 | Val Acc: 0.5278
 Best site-Clipart                  (2)  | Epoch:6 | Val Acc: 0.5417
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 19, 1, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-RealWorld                 (1) | Train Loss: 1.6730 | Train Acc: 0.6667
 Site-RealWorld                 (2) | Train Loss: 1.6626 | Train Acc: 0.7500
 Site-RealWorld                 (1) | Train Loss: 1.8024 | Train Acc: 0.5333
 Site-RealWorld                 (1) | Train Loss: 1.5844 | Train Acc: 0.7500
 Site-RealWorld                 (1) | Train Loss: 1.5363 | Train Acc: 0.7600
 Site-RealWorld                 (1) | Train Loss: 1.6552 | Train Acc: 0.6970
 Site-RealWorld                 (1) | Train Loss: 1.4977 | Train Acc: 0.7442
 Site-RealWorld                 (1) | Train Loss: 1.6055 | Train Acc: 0.7091
 Site-RealWorld                 (1) | Train Loss: 1.6022 | Train Acc: 0.7639
 Site-RealWorld                 (1) | Train Loss: 1.5036 | Train Acc: 0.7849
 Site-caltech                   (3) | Train Loss: 1.7667 | Train Acc: 0.6364
 Site-caltech                   (1) | Train Loss: 1.5950 | Train Acc: 0.8000
 Site-caltech                   (1) | Train Loss: 1.5342 | Train Acc: 0.7619
 Site-caltech                   (1) | Train Loss: 1.7357 | Train Acc: 0.6000
 Site-caltech                   (1) | Train Loss: 1.6481 | Train Acc: 0.5854
 Site-caltech                   (1) | Train Loss: 1.6311 | Train Acc: 0.6667
 Site-caltech                   (1) | Train Loss: 1.5776 | Train Acc: 0.7595
 Site-Product                   (0) | Train Loss: 1.3414 | Train Acc: 0.8462
 Site-Product                   (1) | Train Loss: 1.6577 | Train Acc: 0.6500
 Site-Product                   (4) | Train Loss: 1.5778 | Train Acc: 0.7241
 Site-Product                   (1) | Train Loss: 1.5772 | Train Acc: 0.7727
 Site-Product                   (1) | Train Loss: 1.5452 | Train Acc: 0.7121
 Site-amazon                    (4) | Train Loss: 1.5091 | Train Acc: 0.7500
 Site-amazon                    (4) | Train Loss: 1.6190 | Train Acc: 0.6571
 Site-amazon                    (4) | Train Loss: 1.6895 | Train Acc: 0.7258
 Site-webcam                    (5) | Train Loss: 1.4971 | Train Acc: 0.8889
 Site-webcam                    (5) | Train Loss: 1.6424 | Train Acc: 0.7963
 Site-Art                       (1) | Train Loss: 1.7640 | Train Acc: 0.6000
 Site-Clipart                   (6) | Train Loss: 1.8616 | Train Acc: 0.5405
Average Train Accuracy: 0.7115
 Site-RealWorld                 (1) | Val  Loss: 1.3400 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 1.5442 | Val  Acc: 0.8750
 Site-RealWorld                 (1) | Val  Loss: 1.4105 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 1.5445 | Val  Acc: 0.9231
 Site-RealWorld                 (1) | Val  Loss: 1.8902 | Val  Acc: 0.6471
 Site-RealWorld                 (1) | Val  Loss: 1.5451 | Val  Acc: 0.8636
 Site-RealWorld                 (1) | Val  Loss: 1.5031 | Val  Acc: 0.7857
 Site-RealWorld                 (1) | Val  Loss: 1.6488 | Val  Acc: 0.6486
 Site-RealWorld                 (1) | Val  Loss: 1.4611 | Val  Acc: 0.7500
 Site-RealWorld                 (1) | Val  Loss: 1.5787 | Val  Acc: 0.7258
 Site-caltech                   (3) | Val  Loss: 1.6002 | Val  Acc: 0.7143
 Site-caltech                   (1) | Val  Loss: 1.5886 | Val  Acc: 0.7000
 Site-caltech                   (1) | Val  Loss: 1.7268 | Val  Acc: 0.5714
 Site-caltech                   (1) | Val  Loss: 1.6472 | Val  Acc: 0.6000
 Site-caltech                   (1) | Val  Loss: 1.5859 | Val  Acc: 0.6667
 Site-caltech                   (1) | Val  Loss: 1.6089 | Val  Acc: 0.5789
 Site-caltech                   (1) | Val  Loss: 1.6287 | Val  Acc: 0.6604
 Site-Product                   (0) | Val  Loss: 1.4415 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 1.6236 | Val  Acc: 0.7692
 Site-Product                   (4) | Val  Loss: 1.7855 | Val  Acc: 0.7000
 Site-Product                   (1) | Val  Loss: 1.4868 | Val  Acc: 0.8621
 Site-Product                   (1) | Val  Loss: 1.6003 | Val  Acc: 0.7045
 Site-amazon                    (4) | Val  Loss: 1.7273 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 1.8578 | Val  Acc: 0.6522
 Site-amazon                    (4) | Val  Loss: 1.7541 | Val  Acc: 0.6829
 Site-webcam                    (5) | Val  Loss: 1.6764 | Val  Acc: 0.7222
 Site-webcam                    (5) | Val  Loss: 1.6150 | Val  Acc: 0.7778
 Site-Art                       (1) | Val  Loss: 1.7985 | Val  Acc: 0.5833
 Site-Clipart                   (6) | Val  Loss: 1.8612 | Val  Acc: 0.5417
Average Valid Accuracy: 0.7362
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:7 | Val Acc: 0.8750
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.9231
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.6471
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.8636
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7857
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.6486
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7500
 Best site-RealWorld                (1)  | Epoch:7 | Val Acc: 0.7258
 Best site-caltech                  (3)  | Epoch:7 | Val Acc: 0.7143
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.7000
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.5714
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.6000
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.6667
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.5789
 Best site-caltech                  (1)  | Epoch:7 | Val Acc: 0.6604
 Best site-Product                  (0)  | Epoch:7 | Val Acc: 0.8750
 Best site-Product                  (1)  | Epoch:7 | Val Acc: 0.7692
 Best site-Product                  (4)  | Epoch:7 | Val Acc: 0.7000
 Best site-Product                  (1)  | Epoch:7 | Val Acc: 0.8621
 Best site-Product                  (1)  | Epoch:7 | Val Acc: 0.7045
 Best site-amazon                   (4)  | Epoch:7 | Val Acc: 0.7692
 Best site-amazon                   (4)  | Epoch:7 | Val Acc: 0.6522
 Best site-amazon                   (4)  | Epoch:7 | Val Acc: 0.6829
 Best site-webcam                   (5)  | Epoch:7 | Val Acc: 0.7222
 Best site-webcam                   (5)  | Epoch:7 | Val Acc: 0.7778
 Best site-Art                      (1)  | Epoch:7 | Val Acc: 0.5833
 Best site-Clipart                  (6)  | Epoch:7 | Val Acc: 0.5417
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 1, 7, 13, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-RealWorld                 (3) | Train Loss: 1.5811 | Train Acc: 0.6667
 Site-RealWorld                 (3) | Train Loss: 1.4657 | Train Acc: 0.8333
 Site-RealWorld                 (3) | Train Loss: 1.6982 | Train Acc: 0.5333
 Site-RealWorld                 (3) | Train Loss: 1.4303 | Train Acc: 0.8000
 Site-RealWorld                 (3) | Train Loss: 1.3944 | Train Acc: 0.8400
 Site-RealWorld                 (3) | Train Loss: 1.4565 | Train Acc: 0.7879
 Site-RealWorld                 (3) | Train Loss: 1.3958 | Train Acc: 0.7907
 Site-RealWorld                 (3) | Train Loss: 1.4632 | Train Acc: 0.7636
 Site-RealWorld                 (3) | Train Loss: 1.3917 | Train Acc: 0.8611
 Site-RealWorld                 (3) | Train Loss: 1.4025 | Train Acc: 0.8387
 Site-caltech                   (0) | Train Loss: 1.6224 | Train Acc: 0.7273
 Site-caltech                   (6) | Train Loss: 1.5347 | Train Acc: 0.7333
 Site-caltech                   (5) | Train Loss: 1.4650 | Train Acc: 0.7143
 Site-caltech                   (0) | Train Loss: 1.6336 | Train Acc: 0.6000
 Site-caltech                   (3) | Train Loss: 1.4979 | Train Acc: 0.6585
 Site-caltech                   (5) | Train Loss: 1.4780 | Train Acc: 0.7544
 Site-caltech                   (0) | Train Loss: 1.5595 | Train Acc: 0.8481
 Site-Product                   (1) | Train Loss: 1.2177 | Train Acc: 0.9231
 Site-Product                   (2) | Train Loss: 1.5303 | Train Acc: 0.7500
 Site-Product                   (2) | Train Loss: 1.4935 | Train Acc: 0.6897
 Site-Product                   (2) | Train Loss: 1.4466 | Train Acc: 0.8409
 Site-Product                   (2) | Train Loss: 1.7036 | Train Acc: 0.6970
 Site-amazon                    (2) | Train Loss: 1.4407 | Train Acc: 0.8000
 Site-amazon                    (2) | Train Loss: 1.5460 | Train Acc: 0.6857
 Site-amazon                    (2) | Train Loss: 1.5692 | Train Acc: 0.7581
 Site-webcam                    (4) | Train Loss: 1.4368 | Train Acc: 0.9259
 Site-webcam                    (4) | Train Loss: 1.4949 | Train Acc: 0.8519
 Site-Art                       (3) | Train Loss: 1.6699 | Train Acc: 0.6000
 Site-Clipart                   (3) | Train Loss: 1.8069 | Train Acc: 0.5946
Average Train Accuracy: 0.7541
 Site-RealWorld                 (3) | Val  Loss: 1.2654 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 1.4509 | Val  Acc: 0.8750
 Site-RealWorld                 (3) | Val  Loss: 1.3547 | Val  Acc: 0.9000
 Site-RealWorld                 (3) | Val  Loss: 1.3712 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 1.6397 | Val  Acc: 0.7647
 Site-RealWorld                 (3) | Val  Loss: 1.4930 | Val  Acc: 0.8636
 Site-RealWorld                 (3) | Val  Loss: 1.4147 | Val  Acc: 0.8571
 Site-RealWorld                 (3) | Val  Loss: 1.5352 | Val  Acc: 0.6757
 Site-RealWorld                 (3) | Val  Loss: 1.3646 | Val  Acc: 0.7917
 Site-RealWorld                 (3) | Val  Loss: 1.4414 | Val  Acc: 0.7903
 Site-caltech                   (0) | Val  Loss: 1.4297 | Val  Acc: 0.8571
 Site-caltech                   (6) | Val  Loss: 1.3873 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 1.6991 | Val  Acc: 0.6429
 Site-caltech                   (0) | Val  Loss: 1.5999 | Val  Acc: 0.7500
 Site-caltech                   (3) | Val  Loss: 1.4035 | Val  Acc: 0.7778
 Site-caltech                   (5) | Val  Loss: 1.4631 | Val  Acc: 0.6579
 Site-caltech                   (0) | Val  Loss: 1.5391 | Val  Acc: 0.6604
 Site-Product                   (1) | Val  Loss: 1.4600 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 1.5587 | Val  Acc: 0.8462
 Site-Product                   (2) | Val  Loss: 1.5411 | Val  Acc: 0.8000
 Site-Product                   (2) | Val  Loss: 1.3748 | Val  Acc: 0.9310
 Site-Product                   (2) | Val  Loss: 1.4604 | Val  Acc: 0.7727
 Site-amazon                    (2) | Val  Loss: 1.6671 | Val  Acc: 0.6923
 Site-amazon                    (2) | Val  Loss: 1.8500 | Val  Acc: 0.6087
 Site-amazon                    (2) | Val  Loss: 1.6315 | Val  Acc: 0.7073
 Site-webcam                    (4) | Val  Loss: 1.5084 | Val  Acc: 0.7222
 Site-webcam                    (4) | Val  Loss: 1.5740 | Val  Acc: 0.8333
 Site-Art                       (3) | Val  Loss: 1.7198 | Val  Acc: 0.6389
 Site-Clipart                   (3) | Val  Loss: 1.7653 | Val  Acc: 0.5833
Average Valid Accuracy: 0.7888
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.8750
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.9000
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.7647
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.8636
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.8571
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.6757
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.7917
 Best site-RealWorld                (3)  | Epoch:8 | Val Acc: 0.7903
 Best site-caltech                  (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-caltech                  (6)  | Epoch:8 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:8 | Val Acc: 0.6429
 Best site-caltech                  (0)  | Epoch:8 | Val Acc: 0.7500
 Best site-caltech                  (3)  | Epoch:8 | Val Acc: 0.7778
 Best site-caltech                  (5)  | Epoch:8 | Val Acc: 0.6579
 Best site-caltech                  (0)  | Epoch:8 | Val Acc: 0.6604
 Best site-Product                  (1)  | Epoch:8 | Val Acc: 0.8750
 Best site-Product                  (2)  | Epoch:8 | Val Acc: 0.8462
 Best site-Product                  (2)  | Epoch:8 | Val Acc: 0.8000
 Best site-Product                  (2)  | Epoch:8 | Val Acc: 0.9310
 Best site-Product                  (2)  | Epoch:8 | Val Acc: 0.7727
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.6923
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.6087
 Best site-amazon                   (2)  | Epoch:8 | Val Acc: 0.7073
 Best site-webcam                   (4)  | Epoch:8 | Val Acc: 0.7222
 Best site-webcam                   (4)  | Epoch:8 | Val Acc: 0.8333
 Best site-Art                      (3)  | Epoch:8 | Val Acc: 0.6389
 Best site-Clipart                  (3)  | Epoch:8 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[4, 2, 14, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-RealWorld                 (2) | Train Loss: 1.3842 | Train Acc: 0.7778
 Site-RealWorld                 (2) | Train Loss: 1.4171 | Train Acc: 0.8333
 Site-RealWorld                 (6) | Train Loss: 1.5800 | Train Acc: 0.6000
 Site-RealWorld                 (2) | Train Loss: 1.3483 | Train Acc: 0.7500
 Site-RealWorld                 (1) | Train Loss: 1.3082 | Train Acc: 0.8800
 Site-RealWorld                 (2) | Train Loss: 1.3381 | Train Acc: 0.8485
 Site-RealWorld                 (0) | Train Loss: 1.2745 | Train Acc: 0.8140
 Site-RealWorld                 (2) | Train Loss: 1.3189 | Train Acc: 0.8545
 Site-RealWorld                 (2) | Train Loss: 1.4347 | Train Acc: 0.8194
 Site-RealWorld                 (2) | Train Loss: 1.2570 | Train Acc: 0.8710
 Site-caltech                   (5) | Train Loss: 1.4490 | Train Acc: 0.6364
 Site-caltech                   (3) | Train Loss: 1.4236 | Train Acc: 0.8000
 Site-caltech                   (2) | Train Loss: 1.2621 | Train Acc: 0.8571
 Site-caltech                   (2) | Train Loss: 1.5413 | Train Acc: 0.6667
 Site-caltech                   (2) | Train Loss: 1.4244 | Train Acc: 0.7317
 Site-caltech                   (2) | Train Loss: 1.3850 | Train Acc: 0.8070
 Site-caltech                   (2) | Train Loss: 1.3714 | Train Acc: 0.8354
 Site-Product                   (3) | Train Loss: 1.1794 | Train Acc: 0.8462
 Site-Product                   (2) | Train Loss: 1.4056 | Train Acc: 0.7500
 Site-Product                   (3) | Train Loss: 1.4481 | Train Acc: 0.7241
 Site-Product                   (0) | Train Loss: 1.3637 | Train Acc: 0.8182
 Site-Product                   (0) | Train Loss: 1.5768 | Train Acc: 0.7727
 Site-amazon                    (2) | Train Loss: 1.3009 | Train Acc: 0.8000
 Site-amazon                    (3) | Train Loss: 1.4290 | Train Acc: 0.8286
 Site-amazon                    (3) | Train Loss: 1.4947 | Train Acc: 0.7419
 Site-webcam                    (4) | Train Loss: 1.3486 | Train Acc: 0.8519
 Site-webcam                    (4) | Train Loss: 1.4153 | Train Acc: 0.8704
 Site-Art                       (1) | Train Loss: 1.5494 | Train Acc: 0.6545
 Site-Clipart                   (0) | Train Loss: 1.6773 | Train Acc: 0.5676
Average Train Accuracy: 0.7796
 Site-RealWorld                 (2) | Val  Loss: 1.1125 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 1.3835 | Val  Acc: 0.8750
 Site-RealWorld                 (6) | Val  Loss: 1.3220 | Val  Acc: 0.9000
 Site-RealWorld                 (2) | Val  Loss: 1.2419 | Val  Acc: 0.9231
 Site-RealWorld                 (1) | Val  Loss: 1.5784 | Val  Acc: 0.8235
 Site-RealWorld                 (2) | Val  Loss: 1.2451 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 1.3311 | Val  Acc: 0.8929
 Site-RealWorld                 (2) | Val  Loss: 1.3994 | Val  Acc: 0.7568
 Site-RealWorld                 (2) | Val  Loss: 1.2501 | Val  Acc: 0.7917
 Site-RealWorld                 (2) | Val  Loss: 1.3748 | Val  Acc: 0.7419
 Site-caltech                   (5) | Val  Loss: 1.3722 | Val  Acc: 0.7143
 Site-caltech                   (3) | Val  Loss: 1.2615 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 1.5587 | Val  Acc: 0.7857
 Site-caltech                   (2) | Val  Loss: 1.4065 | Val  Acc: 0.8500
 Site-caltech                   (2) | Val  Loss: 1.3280 | Val  Acc: 0.7407
 Site-caltech                   (2) | Val  Loss: 1.3466 | Val  Acc: 0.7895
 Site-caltech                   (2) | Val  Loss: 1.4229 | Val  Acc: 0.6981
 Site-Product                   (3) | Val  Loss: 1.3507 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 1.4791 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 1.5219 | Val  Acc: 0.8000
 Site-Product                   (0) | Val  Loss: 1.2728 | Val  Acc: 0.9310
 Site-Product                   (0) | Val  Loss: 1.3195 | Val  Acc: 0.8182
 Site-amazon                    (2) | Val  Loss: 1.5557 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 1.6925 | Val  Acc: 0.6087
 Site-amazon                    (3) | Val  Loss: 1.5493 | Val  Acc: 0.6829
 Site-webcam                    (4) | Val  Loss: 1.4788 | Val  Acc: 0.8333
 Site-webcam                    (4) | Val  Loss: 1.3768 | Val  Acc: 0.8889
 Site-Art                       (1) | Val  Loss: 1.6225 | Val  Acc: 0.6667
 Site-Clipart                   (0) | Val  Loss: 1.6862 | Val  Acc: 0.6250
Average Valid Accuracy: 0.8143
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.8750
 Best site-RealWorld                (6)  | Epoch:9 | Val Acc: 0.9000
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.9231
 Best site-RealWorld                (1)  | Epoch:9 | Val Acc: 0.8235
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.9091
 Best site-RealWorld                (0)  | Epoch:9 | Val Acc: 0.8929
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.7568
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.7917
 Best site-RealWorld                (2)  | Epoch:9 | Val Acc: 0.7419
 Best site-caltech                  (5)  | Epoch:9 | Val Acc: 0.7143
 Best site-caltech                  (3)  | Epoch:9 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:9 | Val Acc: 0.7857
 Best site-caltech                  (2)  | Epoch:9 | Val Acc: 0.8500
 Best site-caltech                  (2)  | Epoch:9 | Val Acc: 0.7407
 Best site-caltech                  (2)  | Epoch:9 | Val Acc: 0.7895
 Best site-caltech                  (2)  | Epoch:9 | Val Acc: 0.6981
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.8750
 Best site-Product                  (2)  | Epoch:9 | Val Acc: 0.9231
 Best site-Product                  (3)  | Epoch:9 | Val Acc: 0.8000
 Best site-Product                  (0)  | Epoch:9 | Val Acc: 0.9310
 Best site-Product                  (0)  | Epoch:9 | Val Acc: 0.8182
 Best site-amazon                   (2)  | Epoch:9 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:9 | Val Acc: 0.6087
 Best site-amazon                   (3)  | Epoch:9 | Val Acc: 0.6829
 Best site-webcam                   (4)  | Epoch:9 | Val Acc: 0.8333
 Best site-webcam                   (4)  | Epoch:9 | Val Acc: 0.8889
 Best site-Art                      (1)  | Epoch:9 | Val Acc: 0.6667
 Best site-Clipart                  (0)  | Epoch:9 | Val Acc: 0.6250
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[8, 5, 4, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-RealWorld                 (0) | Train Loss: 1.3778 | Train Acc: 0.7778
 Site-RealWorld                 (1) | Train Loss: 1.3841 | Train Acc: 0.8333
 Site-RealWorld                 (0) | Train Loss: 1.4135 | Train Acc: 0.8000
 Site-RealWorld                 (6) | Train Loss: 1.2639 | Train Acc: 0.8000
 Site-RealWorld                 (2) | Train Loss: 1.2536 | Train Acc: 0.8400
 Site-RealWorld                 (0) | Train Loss: 1.2569 | Train Acc: 0.8182
 Site-RealWorld                 (0) | Train Loss: 1.1681 | Train Acc: 0.9070
 Site-RealWorld                 (0) | Train Loss: 1.2433 | Train Acc: 0.8545
 Site-RealWorld                 (0) | Train Loss: 1.2884 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 1.1708 | Train Acc: 0.8602
 Site-caltech                   (2) | Train Loss: 1.3497 | Train Acc: 0.7273
 Site-caltech                   (4) | Train Loss: 1.3166 | Train Acc: 0.8667
 Site-caltech                   (3) | Train Loss: 1.2863 | Train Acc: 0.8571
 Site-caltech                   (3) | Train Loss: 1.3435 | Train Acc: 0.7333
 Site-caltech                   (4) | Train Loss: 1.2903 | Train Acc: 0.7805
 Site-caltech                   (3) | Train Loss: 1.2780 | Train Acc: 0.8947
 Site-caltech                   (0) | Train Loss: 1.1737 | Train Acc: 0.8481
 Site-Product                   (5) | Train Loss: 1.0396 | Train Acc: 0.8462
 Site-Product                   (1) | Train Loss: 1.2915 | Train Acc: 0.8000
 Site-Product                   (3) | Train Loss: 1.2768 | Train Acc: 0.8276
 Site-Product                   (1) | Train Loss: 1.2807 | Train Acc: 0.8636
 Site-Product                   (1) | Train Loss: 1.0415 | Train Acc: 0.8485
 Site-amazon                    (4) | Train Loss: 1.2523 | Train Acc: 0.7500
 Site-amazon                    (5) | Train Loss: 1.3267 | Train Acc: 0.7714
 Site-amazon                    (4) | Train Loss: 1.3889 | Train Acc: 0.8065
 Site-webcam                    (0) | Train Loss: 1.1732 | Train Acc: 0.9259
 Site-webcam                    (2) | Train Loss: 1.2449 | Train Acc: 0.9259
 Site-Art                       (2) | Train Loss: 1.5056 | Train Acc: 0.7091
 Site-Clipart                   (3) | Train Loss: 1.6020 | Train Acc: 0.6216
Average Train Accuracy: 0.8201
 Site-RealWorld                 (0) | Val  Loss: 0.9919 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 1.3194 | Val  Acc: 0.8750
 Site-RealWorld                 (0) | Val  Loss: 1.2639 | Val  Acc: 0.9000
 Site-RealWorld                 (6) | Val  Loss: 1.1613 | Val  Acc: 0.8462
 Site-RealWorld                 (2) | Val  Loss: 1.5852 | Val  Acc: 0.7059
 Site-RealWorld                 (0) | Val  Loss: 1.2448 | Val  Acc: 0.8182
 Site-RealWorld                 (0) | Val  Loss: 1.1791 | Val  Acc: 0.8929
 Site-RealWorld                 (0) | Val  Loss: 1.3523 | Val  Acc: 0.7838
 Site-RealWorld                 (0) | Val  Loss: 1.1609 | Val  Acc: 0.8958
 Site-RealWorld                 (1) | Val  Loss: 1.2225 | Val  Acc: 0.8226
 Site-caltech                   (2) | Val  Loss: 1.3022 | Val  Acc: 0.8571
 Site-caltech                   (4) | Val  Loss: 1.2791 | Val  Acc: 0.9000
 Site-caltech                   (3) | Val  Loss: 1.4202 | Val  Acc: 0.7143
 Site-caltech                   (3) | Val  Loss: 1.3216 | Val  Acc: 0.9000
 Site-caltech                   (4) | Val  Loss: 1.2752 | Val  Acc: 0.7778
 Site-caltech                   (3) | Val  Loss: 1.2450 | Val  Acc: 0.8684
 Site-caltech                   (0) | Val  Loss: 1.3489 | Val  Acc: 0.7170
 Site-Product                   (5) | Val  Loss: 1.2487 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 1.3835 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 1.3452 | Val  Acc: 0.8500
 Site-Product                   (1) | Val  Loss: 1.1766 | Val  Acc: 0.9655
 Site-Product                   (1) | Val  Loss: 1.2298 | Val  Acc: 0.8636
 Site-amazon                    (4) | Val  Loss: 1.5205 | Val  Acc: 0.6923
 Site-amazon                    (5) | Val  Loss: 1.6174 | Val  Acc: 0.6957
 Site-amazon                    (4) | Val  Loss: 1.4137 | Val  Acc: 0.7561
 Site-webcam                    (0) | Val  Loss: 1.5018 | Val  Acc: 0.6667
 Site-webcam                    (2) | Val  Loss: 1.2527 | Val  Acc: 0.9167
 Site-Art                       (2) | Val  Loss: 1.5528 | Val  Acc: 0.7222
 Site-Clipart                   (3) | Val  Loss: 1.6333 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8230
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:10 | Val Acc: 0.8750
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 0.9000
 Best site-RealWorld                (6)  | Epoch:10 | Val Acc: 0.8462
 Best site-RealWorld                (2)  | Epoch:10 | Val Acc: 0.7059
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 0.8182
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 0.8929
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 0.7838
 Best site-RealWorld                (0)  | Epoch:10 | Val Acc: 0.8958
 Best site-RealWorld                (1)  | Epoch:10 | Val Acc: 0.8226
 Best site-caltech                  (2)  | Epoch:10 | Val Acc: 0.8571
 Best site-caltech                  (4)  | Epoch:10 | Val Acc: 0.9000
 Best site-caltech                  (3)  | Epoch:10 | Val Acc: 0.7143
 Best site-caltech                  (3)  | Epoch:10 | Val Acc: 0.9000
 Best site-caltech                  (4)  | Epoch:10 | Val Acc: 0.7778
 Best site-caltech                  (3)  | Epoch:10 | Val Acc: 0.8684
 Best site-caltech                  (0)  | Epoch:10 | Val Acc: 0.7170
 Best site-Product                  (5)  | Epoch:10 | Val Acc: 0.8750
 Best site-Product                  (1)  | Epoch:10 | Val Acc: 0.9231
 Best site-Product                  (3)  | Epoch:10 | Val Acc: 0.8500
 Best site-Product                  (1)  | Epoch:10 | Val Acc: 0.9655
 Best site-Product                  (1)  | Epoch:10 | Val Acc: 0.8636
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.6923
 Best site-amazon                   (5)  | Epoch:10 | Val Acc: 0.6957
 Best site-amazon                   (4)  | Epoch:10 | Val Acc: 0.7561
 Best site-webcam                   (0)  | Epoch:10 | Val Acc: 0.6667
 Best site-webcam                   (2)  | Epoch:10 | Val Acc: 0.9167
 Best site-Art                      (2)  | Epoch:10 | Val Acc: 0.7222
 Best site-Clipart                  (3)  | Epoch:10 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[1, 2, 1, 12, 9, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-RealWorld                 (3) | Train Loss: 1.2141 | Train Acc: 0.7778
 Site-RealWorld                 (3) | Train Loss: 1.1805 | Train Acc: 0.9167
 Site-RealWorld                 (2) | Train Loss: 1.3290 | Train Acc: 0.8000
 Site-RealWorld                 (5) | Train Loss: 1.1181 | Train Acc: 0.9500
 Site-RealWorld                 (5) | Train Loss: 1.1209 | Train Acc: 0.8800
 Site-RealWorld                 (0) | Train Loss: 1.1484 | Train Acc: 0.9091
 Site-RealWorld                 (3) | Train Loss: 1.0768 | Train Acc: 0.9070
 Site-RealWorld                 (3) | Train Loss: 1.1206 | Train Acc: 0.8909
 Site-RealWorld                 (3) | Train Loss: 1.2633 | Train Acc: 0.9167
 Site-RealWorld                 (3) | Train Loss: 1.0536 | Train Acc: 0.9140
 Site-caltech                   (3) | Train Loss: 1.1693 | Train Acc: 0.9091
 Site-caltech                   (4) | Train Loss: 1.2203 | Train Acc: 0.8667
 Site-caltech                   (3) | Train Loss: 1.2045 | Train Acc: 0.8571
 Site-caltech                   (3) | Train Loss: 1.3474 | Train Acc: 0.7000
 Site-caltech                   (4) | Train Loss: 1.1624 | Train Acc: 0.9512
 Site-caltech                   (4) | Train Loss: 1.1973 | Train Acc: 0.9123
 Site-caltech                   (3) | Train Loss: 1.2054 | Train Acc: 0.8608
 Site-Product                   (6) | Train Loss: 1.0483 | Train Acc: 0.8462
 Site-Product                   (4) | Train Loss: 1.2357 | Train Acc: 0.8000
 Site-Product                   (1) | Train Loss: 1.2250 | Train Acc: 0.8621
 Site-Product                   (4) | Train Loss: 1.1393 | Train Acc: 0.8864
 Site-Product                   (4) | Train Loss: 1.2868 | Train Acc: 0.8485
 Site-amazon                    (4) | Train Loss: 1.0750 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 1.2803 | Train Acc: 0.7429
 Site-amazon                    (4) | Train Loss: 1.2937 | Train Acc: 0.7742
 Site-webcam                    (3) | Train Loss: 1.1680 | Train Acc: 0.8889
 Site-webcam                    (3) | Train Loss: 1.1387 | Train Acc: 0.9444
 Site-Art                       (5) | Train Loss: 1.3959 | Train Acc: 0.7818
 Site-Clipart                   (4) | Train Loss: 1.5411 | Train Acc: 0.7027
Average Train Accuracy: 0.8568
 Site-RealWorld                 (3) | Val  Loss: 0.9186 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 1.1344 | Val  Acc: 0.8750
 Site-RealWorld                 (2) | Val  Loss: 1.1876 | Val  Acc: 0.9000
 Site-RealWorld                 (5) | Val  Loss: 1.1194 | Val  Acc: 0.9231
 Site-RealWorld                 (5) | Val  Loss: 1.4068 | Val  Acc: 0.8824
 Site-RealWorld                 (0) | Val  Loss: 1.0540 | Val  Acc: 0.9545
 Site-RealWorld                 (3) | Val  Loss: 1.1263 | Val  Acc: 0.8929
 Site-RealWorld                 (3) | Val  Loss: 1.2028 | Val  Acc: 0.8649
 Site-RealWorld                 (3) | Val  Loss: 1.0265 | Val  Acc: 0.9167
 Site-RealWorld                 (3) | Val  Loss: 1.1588 | Val  Acc: 0.8387
 Site-caltech                   (3) | Val  Loss: 1.4344 | Val  Acc: 0.8571
 Site-caltech                   (4) | Val  Loss: 1.1685 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 1.3549 | Val  Acc: 0.9286
 Site-caltech                   (3) | Val  Loss: 1.1514 | Val  Acc: 0.9500
 Site-caltech                   (4) | Val  Loss: 1.1086 | Val  Acc: 0.8148
 Site-caltech                   (4) | Val  Loss: 1.1034 | Val  Acc: 0.8947
 Site-caltech                   (3) | Val  Loss: 1.2218 | Val  Acc: 0.8302
 Site-Product                   (6) | Val  Loss: 1.1016 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 1.2178 | Val  Acc: 0.9231
 Site-Product                   (1) | Val  Loss: 1.2719 | Val  Acc: 0.8500
 Site-Product                   (4) | Val  Loss: 1.0858 | Val  Acc: 0.8966
 Site-Product                   (4) | Val  Loss: 1.1609 | Val  Acc: 0.8409
 Site-amazon                    (4) | Val  Loss: 1.4056 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 1.5209 | Val  Acc: 0.6087
 Site-amazon                    (4) | Val  Loss: 1.3472 | Val  Acc: 0.7805
 Site-webcam                    (3) | Val  Loss: 1.1632 | Val  Acc: 0.8889
 Site-webcam                    (3) | Val  Loss: 1.1857 | Val  Acc: 0.9444
 Site-Art                       (5) | Val  Loss: 1.4887 | Val  Acc: 0.6944
 Site-Clipart                   (4) | Val  Loss: 1.4706 | Val  Acc: 0.7917
Average Valid Accuracy: 0.8685
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 0.8750
 Best site-RealWorld                (2)  | Epoch:11 | Val Acc: 0.9000
 Best site-RealWorld                (5)  | Epoch:11 | Val Acc: 0.9231
 Best site-RealWorld                (5)  | Epoch:11 | Val Acc: 0.8824
 Best site-RealWorld                (0)  | Epoch:11 | Val Acc: 0.9545
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 0.8929
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 0.8649
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 0.9167
 Best site-RealWorld                (3)  | Epoch:11 | Val Acc: 0.8387
 Best site-caltech                  (3)  | Epoch:11 | Val Acc: 0.8571
 Best site-caltech                  (4)  | Epoch:11 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:11 | Val Acc: 0.9286
 Best site-caltech                  (3)  | Epoch:11 | Val Acc: 0.9500
 Best site-caltech                  (4)  | Epoch:11 | Val Acc: 0.8148
 Best site-caltech                  (4)  | Epoch:11 | Val Acc: 0.8947
 Best site-caltech                  (3)  | Epoch:11 | Val Acc: 0.8302
 Best site-Product                  (6)  | Epoch:11 | Val Acc: 0.8750
 Best site-Product                  (4)  | Epoch:11 | Val Acc: 0.9231
 Best site-Product                  (1)  | Epoch:11 | Val Acc: 0.8500
 Best site-Product                  (4)  | Epoch:11 | Val Acc: 0.8966
 Best site-Product                  (4)  | Epoch:11 | Val Acc: 0.8409
 Best site-amazon                   (4)  | Epoch:11 | Val Acc: 0.7692
 Best site-amazon                   (1)  | Epoch:11 | Val Acc: 0.6087
 Best site-amazon                   (4)  | Epoch:11 | Val Acc: 0.7805
 Best site-webcam                   (3)  | Epoch:11 | Val Acc: 0.8889
 Best site-webcam                   (3)  | Epoch:11 | Val Acc: 0.9444
 Best site-Art                      (5)  | Epoch:11 | Val Acc: 0.6944
 Best site-Clipart                  (4)  | Epoch:11 | Val Acc: 0.7917
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[6, 1, 1, 10, 7, 3, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-RealWorld                 (2) | Train Loss: 1.2302 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 1.1205 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 1.2120 | Train Acc: 0.8000
 Site-RealWorld                 (3) | Train Loss: 1.0635 | Train Acc: 0.9000
 Site-RealWorld                 (5) | Train Loss: 1.1242 | Train Acc: 0.8400
 Site-RealWorld                 (3) | Train Loss: 1.0854 | Train Acc: 0.9091
 Site-RealWorld                 (0) | Train Loss: 0.9969 | Train Acc: 0.9070
 Site-RealWorld                 (3) | Train Loss: 1.0249 | Train Acc: 0.8727
 Site-RealWorld                 (3) | Train Loss: 1.1317 | Train Acc: 0.9028
 Site-RealWorld                 (3) | Train Loss: 0.9346 | Train Acc: 0.9247
 Site-caltech                   (6) | Train Loss: 1.1935 | Train Acc: 0.8182
 Site-caltech                   (4) | Train Loss: 1.0921 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 1.0644 | Train Acc: 0.8571
 Site-caltech                   (3) | Train Loss: 1.2969 | Train Acc: 0.6667
 Site-caltech                   (0) | Train Loss: 1.1405 | Train Acc: 0.8537
 Site-caltech                   (0) | Train Loss: 1.0431 | Train Acc: 0.8947
 Site-caltech                   (3) | Train Loss: 1.0586 | Train Acc: 0.8861
 Site-Product                   (4) | Train Loss: 0.8300 | Train Acc: 0.9231
 Site-Product                   (0) | Train Loss: 1.0857 | Train Acc: 0.8000
 Site-Product                   (4) | Train Loss: 1.1919 | Train Acc: 0.8621
 Site-Product                   (3) | Train Loss: 1.1330 | Train Acc: 0.8409
 Site-Product                   (4) | Train Loss: 1.0080 | Train Acc: 0.9091
 Site-amazon                    (0) | Train Loss: 1.0394 | Train Acc: 0.8500
 Site-amazon                    (4) | Train Loss: 1.1084 | Train Acc: 0.8857
 Site-amazon                    (4) | Train Loss: 1.1754 | Train Acc: 0.8387
 Site-webcam                    (5) | Train Loss: 1.0443 | Train Acc: 0.9259
 Site-webcam                    (5) | Train Loss: 1.0658 | Train Acc: 0.8889
 Site-Art                       (1) | Train Loss: 1.3831 | Train Acc: 0.7455
 Site-Clipart                   (4) | Train Loss: 1.4801 | Train Acc: 0.7027
Average Train Accuracy: 0.8653
 Site-RealWorld                 (2) | Val  Loss: 0.7676 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 1.0161 | Val  Acc: 0.8750
 Site-RealWorld                 (3) | Val  Loss: 1.0950 | Val  Acc: 0.9000
 Site-RealWorld                 (3) | Val  Loss: 0.9613 | Val  Acc: 0.9231
 Site-RealWorld                 (5) | Val  Loss: 1.2723 | Val  Acc: 0.8824
 Site-RealWorld                 (3) | Val  Loss: 0.9925 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.9457 | Val  Acc: 0.9643
 Site-RealWorld                 (3) | Val  Loss: 1.1220 | Val  Acc: 0.8108
 Site-RealWorld                 (3) | Val  Loss: 0.9664 | Val  Acc: 0.8958
 Site-RealWorld                 (3) | Val  Loss: 1.0599 | Val  Acc: 0.9032
 Site-caltech                   (6) | Val  Loss: 1.0197 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 1.0508 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 1.1530 | Val  Acc: 0.9286
 Site-caltech                   (3) | Val  Loss: 1.0678 | Val  Acc: 0.9000
 Site-caltech                   (0) | Val  Loss: 1.0420 | Val  Acc: 0.8148
 Site-caltech                   (0) | Val  Loss: 1.0397 | Val  Acc: 0.9211
 Site-caltech                   (3) | Val  Loss: 1.1543 | Val  Acc: 0.7736
 Site-Product                   (4) | Val  Loss: 1.0333 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 1.1312 | Val  Acc: 0.9231
 Site-Product                   (4) | Val  Loss: 1.0860 | Val  Acc: 0.9500
 Site-Product                   (3) | Val  Loss: 0.9517 | Val  Acc: 0.9655
 Site-Product                   (4) | Val  Loss: 1.1125 | Val  Acc: 0.7955
 Site-amazon                    (0) | Val  Loss: 1.3376 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 1.4636 | Val  Acc: 0.6957
 Site-amazon                    (4) | Val  Loss: 1.3112 | Val  Acc: 0.7561
 Site-webcam                    (5) | Val  Loss: 1.1239 | Val  Acc: 0.8889
 Site-webcam                    (5) | Val  Loss: 1.0334 | Val  Acc: 0.9444
 Site-Art                       (1) | Val  Loss: 1.3692 | Val  Acc: 0.8333
 Site-Clipart                   (4) | Val  Loss: 1.4070 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8795
 Best site-RealWorld                (2)  | Epoch:12 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.8750
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.9000
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.9231
 Best site-RealWorld                (5)  | Epoch:12 | Val Acc: 0.8824
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.9091
 Best site-RealWorld                (0)  | Epoch:12 | Val Acc: 0.9643
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.8108
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.8958
 Best site-RealWorld                (3)  | Epoch:12 | Val Acc: 0.9032
 Best site-caltech                  (6)  | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                  (4)  | Epoch:12 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:12 | Val Acc: 0.9286
 Best site-caltech                  (3)  | Epoch:12 | Val Acc: 0.9000
 Best site-caltech                  (0)  | Epoch:12 | Val Acc: 0.8148
 Best site-caltech                  (0)  | Epoch:12 | Val Acc: 0.9211
 Best site-caltech                  (3)  | Epoch:12 | Val Acc: 0.7736
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.8750
 Best site-Product                  (0)  | Epoch:12 | Val Acc: 0.9231
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.9500
 Best site-Product                  (3)  | Epoch:12 | Val Acc: 0.9655
 Best site-Product                  (4)  | Epoch:12 | Val Acc: 0.7955
 Best site-amazon                   (0)  | Epoch:12 | Val Acc: 0.7692
 Best site-amazon                   (4)  | Epoch:12 | Val Acc: 0.6957
 Best site-amazon                   (4)  | Epoch:12 | Val Acc: 0.7561
 Best site-webcam                   (5)  | Epoch:12 | Val Acc: 0.8889
 Best site-webcam                   (5)  | Epoch:12 | Val Acc: 0.9444
 Best site-Art                      (1)  | Epoch:12 | Val Acc: 0.8333
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.7083
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[6, 8, 3, 7, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-RealWorld                 (1) | Train Loss: 1.1616 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 1.0240 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 1.1868 | Train Acc: 0.8000
 Site-RealWorld                 (1) | Train Loss: 0.9896 | Train Acc: 0.9000
 Site-RealWorld                 (1) | Train Loss: 0.9965 | Train Acc: 0.9200
 Site-RealWorld                 (3) | Train Loss: 0.9996 | Train Acc: 0.8788
 Site-RealWorld                 (1) | Train Loss: 0.9068 | Train Acc: 0.9302
 Site-RealWorld                 (3) | Train Loss: 0.9761 | Train Acc: 0.8545
 Site-RealWorld                 (1) | Train Loss: 1.0390 | Train Acc: 0.9306
 Site-RealWorld                 (3) | Train Loss: 0.8990 | Train Acc: 0.9247
 Site-caltech                   (6) | Train Loss: 1.0733 | Train Acc: 0.8182
 Site-caltech                   (0) | Train Loss: 0.9950 | Train Acc: 0.9333
 Site-caltech                   (0) | Train Loss: 0.9576 | Train Acc: 0.8571
 Site-caltech                   (3) | Train Loss: 1.2194 | Train Acc: 0.7333
 Site-caltech                   (0) | Train Loss: 1.0435 | Train Acc: 0.8293
 Site-caltech                   (0) | Train Loss: 0.9842 | Train Acc: 0.9123
 Site-caltech                   (0) | Train Loss: 0.9499 | Train Acc: 0.9620
 Site-Product                   (5) | Train Loss: 0.8901 | Train Acc: 0.9231
 Site-Product                   (3) | Train Loss: 1.0307 | Train Acc: 0.9500
 Site-Product                   (2) | Train Loss: 1.1084 | Train Acc: 0.8966
 Site-Product                   (4) | Train Loss: 1.0318 | Train Acc: 0.9318
 Site-Product                   (4) | Train Loss: 0.9261 | Train Acc: 0.8939
 Site-amazon                    (2) | Train Loss: 0.9905 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 1.0739 | Train Acc: 0.8571
 Site-amazon                    (4) | Train Loss: 1.1411 | Train Acc: 0.8226
 Site-webcam                    (3) | Train Loss: 1.0127 | Train Acc: 0.9259
 Site-webcam                    (1) | Train Loss: 1.0201 | Train Acc: 0.9259
 Site-Art                       (1) | Train Loss: 1.2524 | Train Acc: 0.7455
 Site-Clipart                   (3) | Train Loss: 1.3345 | Train Acc: 0.7568
Average Train Accuracy: 0.8811
 Site-RealWorld                 (1) | Val  Loss: 0.6741 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.9599 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 1.0564 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.9252 | Val  Acc: 0.9231
 Site-RealWorld                 (1) | Val  Loss: 1.2485 | Val  Acc: 0.8235
 Site-RealWorld                 (3) | Val  Loss: 0.9508 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 1.0544 | Val  Acc: 0.8929
 Site-RealWorld                 (3) | Val  Loss: 1.0511 | Val  Acc: 0.8649
 Site-RealWorld                 (1) | Val  Loss: 0.8626 | Val  Acc: 0.9375
 Site-RealWorld                 (3) | Val  Loss: 1.0078 | Val  Acc: 0.8710
 Site-caltech                   (6) | Val  Loss: 1.0430 | Val  Acc: 0.8571
 Site-caltech                   (0) | Val  Loss: 0.9983 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 1.1760 | Val  Acc: 0.8571
 Site-caltech                   (3) | Val  Loss: 0.9830 | Val  Acc: 0.9500
 Site-caltech                   (0) | Val  Loss: 1.0394 | Val  Acc: 0.8519
 Site-caltech                   (0) | Val  Loss: 1.0234 | Val  Acc: 0.9211
 Site-caltech                   (0) | Val  Loss: 1.0330 | Val  Acc: 0.8679
 Site-Product                   (5) | Val  Loss: 0.9257 | Val  Acc: 0.8750
 Site-Product                   (3) | Val  Loss: 0.9915 | Val  Acc: 0.9231
 Site-Product                   (2) | Val  Loss: 1.1205 | Val  Acc: 0.9000
 Site-Product                   (4) | Val  Loss: 0.9367 | Val  Acc: 0.8966
 Site-Product                   (4) | Val  Loss: 0.9925 | Val  Acc: 0.8864
 Site-amazon                    (2) | Val  Loss: 1.1752 | Val  Acc: 0.7692
 Site-amazon                    (2) | Val  Loss: 1.3550 | Val  Acc: 0.7391
 Site-amazon                    (4) | Val  Loss: 1.1915 | Val  Acc: 0.8049
 Site-webcam                    (3) | Val  Loss: 1.0509 | Val  Acc: 0.8333
 Site-webcam                    (1) | Val  Loss: 1.0157 | Val  Acc: 0.8889
 Site-Art                       (1) | Val  Loss: 1.3378 | Val  Acc: 0.7500
 Site-Clipart                   (3) | Val  Loss: 1.3572 | Val  Acc: 0.7083
Average Valid Accuracy: 0.8794
============ Train epoch 14 ============
cnt=[4, 5, 6, 4, 8, 1, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-RealWorld                 (6) | Train Loss: 1.0312 | Train Acc: 0.7778
 Site-RealWorld                 (4) | Train Loss: 0.9719 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.9854 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.9412 | Train Acc: 0.9000
 Site-RealWorld                 (1) | Train Loss: 0.8902 | Train Acc: 0.8800
 Site-RealWorld                 (4) | Train Loss: 0.8882 | Train Acc: 0.9394
 Site-RealWorld                 (4) | Train Loss: 0.8436 | Train Acc: 0.9070
 Site-RealWorld                 (4) | Train Loss: 0.9137 | Train Acc: 0.8909
 Site-RealWorld                 (1) | Train Loss: 0.9589 | Train Acc: 0.9444
 Site-RealWorld                 (2) | Train Loss: 0.8421 | Train Acc: 0.9462
 Site-caltech                   (2) | Train Loss: 1.0685 | Train Acc: 0.8182
 Site-caltech                   (2) | Train Loss: 0.9556 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.8689 | Train Acc: 0.8571
 Site-caltech                   (2) | Train Loss: 1.0220 | Train Acc: 0.8000
 Site-caltech                   (4) | Train Loss: 0.9379 | Train Acc: 0.8780
 Site-caltech                   (4) | Train Loss: 0.9243 | Train Acc: 0.8947
 Site-caltech                   (2) | Train Loss: 0.9081 | Train Acc: 0.9367
 Site-Product                   (5) | Train Loss: 0.7548 | Train Acc: 0.8462
 Site-Product                   (0) | Train Loss: 0.9683 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.9793 | Train Acc: 0.9310
 Site-Product                   (0) | Train Loss: 0.9722 | Train Acc: 0.8636
 Site-Product                   (0) | Train Loss: 1.0646 | Train Acc: 0.8939
 Site-amazon                    (3) | Train Loss: 0.8664 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 1.0343 | Train Acc: 0.8857
 Site-amazon                    (3) | Train Loss: 1.0662 | Train Acc: 0.8548
 Site-webcam                    (4) | Train Loss: 0.8369 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.9180 | Train Acc: 0.9444
 Site-Art                       (1) | Train Loss: 1.2240 | Train Acc: 0.7636
 Site-Clipart                   (0) | Train Loss: 1.3090 | Train Acc: 0.7568
Average Train Accuracy: 0.8939
 Site-RealWorld                 (6) | Val  Loss: 0.6190 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.9037 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 1.0098 | Val  Acc: 0.9000
 Site-RealWorld                 (2) | Val  Loss: 0.8432 | Val  Acc: 0.8462
 Site-RealWorld                 (1) | Val  Loss: 1.0660 | Val  Acc: 0.8824
 Site-RealWorld                 (4) | Val  Loss: 0.8675 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.8536 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.9931 | Val  Acc: 0.8919
 Site-RealWorld                 (1) | Val  Loss: 0.8065 | Val  Acc: 0.9167
 Site-RealWorld                 (2) | Val  Loss: 0.9313 | Val  Acc: 0.8871
 Site-caltech                   (2) | Val  Loss: 1.0238 | Val  Acc: 0.8571
 Site-caltech                   (2) | Val  Loss: 0.8464 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 1.0484 | Val  Acc: 0.9286
 Site-caltech                   (2) | Val  Loss: 0.9498 | Val  Acc: 0.9500
 Site-caltech                   (4) | Val  Loss: 0.8886 | Val  Acc: 0.8889
 Site-caltech                   (4) | Val  Loss: 0.9100 | Val  Acc: 0.8947
 Site-caltech                   (2) | Val  Loss: 1.0551 | Val  Acc: 0.7736
 Site-Product                   (5) | Val  Loss: 0.8452 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.8949 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 1.0092 | Val  Acc: 0.9000
 Site-Product                   (0) | Val  Loss: 0.8701 | Val  Acc: 0.9310
 Site-Product                   (0) | Val  Loss: 0.9427 | Val  Acc: 0.9091
 Site-amazon                    (3) | Val  Loss: 1.1358 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 1.2606 | Val  Acc: 0.7391
 Site-amazon                    (3) | Val  Loss: 1.1271 | Val  Acc: 0.8049
 Site-webcam                    (4) | Val  Loss: 0.9568 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.9145 | Val  Acc: 0.9167
 Site-Art                       (1) | Val  Loss: 1.2495 | Val  Acc: 0.8056
 Site-Clipart                   (0) | Val  Loss: 1.3351 | Val  Acc: 0.7917
Average Valid Accuracy: 0.8890
 Best site-RealWorld                (6)  | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:14 | Val Acc: 0.9000
 Best site-RealWorld                (2)  | Epoch:14 | Val Acc: 0.8462
 Best site-RealWorld                (1)  | Epoch:14 | Val Acc: 0.8824
 Best site-RealWorld                (4)  | Epoch:14 | Val Acc: 0.9091
 Best site-RealWorld                (4)  | Epoch:14 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:14 | Val Acc: 0.8919
 Best site-RealWorld                (1)  | Epoch:14 | Val Acc: 0.9167
 Best site-RealWorld                (2)  | Epoch:14 | Val Acc: 0.8871
 Best site-caltech                  (2)  | Epoch:14 | Val Acc: 0.8571
 Best site-caltech                  (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-caltech                  (4)  | Epoch:14 | Val Acc: 0.9286
 Best site-caltech                  (2)  | Epoch:14 | Val Acc: 0.9500
 Best site-caltech                  (4)  | Epoch:14 | Val Acc: 0.8889
 Best site-caltech                  (4)  | Epoch:14 | Val Acc: 0.8947
 Best site-caltech                  (2)  | Epoch:14 | Val Acc: 0.7736
 Best site-Product                  (5)  | Epoch:14 | Val Acc: 0.8750
 Best site-Product                  (0)  | Epoch:14 | Val Acc: 0.9231
 Best site-Product                  (3)  | Epoch:14 | Val Acc: 0.9000
 Best site-Product                  (0)  | Epoch:14 | Val Acc: 0.9310
 Best site-Product                  (0)  | Epoch:14 | Val Acc: 0.9091
 Best site-amazon                   (3)  | Epoch:14 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:14 | Val Acc: 0.7391
 Best site-amazon                   (3)  | Epoch:14 | Val Acc: 0.8049
 Best site-webcam                   (4)  | Epoch:14 | Val Acc: 0.8889
 Best site-webcam                   (1)  | Epoch:14 | Val Acc: 0.9167
 Best site-Art                      (1)  | Epoch:14 | Val Acc: 0.8056
 Best site-Clipart                  (0)  | Epoch:14 | Val Acc: 0.7917
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 6, 4, 11, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-RealWorld                 (0) | Train Loss: 0.9131 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 0.8771 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.9249 | Train Acc: 0.8667
 Site-RealWorld                 (2) | Train Loss: 0.8235 | Train Acc: 0.9000
 Site-RealWorld                 (4) | Train Loss: 0.8490 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.7927 | Train Acc: 0.9394
 Site-RealWorld                 (3) | Train Loss: 0.7626 | Train Acc: 0.9070
 Site-RealWorld                 (3) | Train Loss: 0.8408 | Train Acc: 0.9455
 Site-RealWorld                 (3) | Train Loss: 0.8728 | Train Acc: 0.9167
 Site-RealWorld                 (3) | Train Loss: 0.7892 | Train Acc: 0.9462
 Site-caltech                   (0) | Train Loss: 0.8925 | Train Acc: 0.9091
 Site-caltech                   (1) | Train Loss: 0.8325 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.8125 | Train Acc: 0.9048
 Site-caltech                   (3) | Train Loss: 0.9739 | Train Acc: 0.9000
 Site-caltech                   (3) | Train Loss: 0.9111 | Train Acc: 0.8293
 Site-caltech                   (1) | Train Loss: 0.8504 | Train Acc: 0.9474
 Site-caltech                   (3) | Train Loss: 0.8534 | Train Acc: 0.9494
 Site-Product                   (2) | Train Loss: 0.7060 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.9045 | Train Acc: 0.9000
 Site-Product                   (3) | Train Loss: 0.9827 | Train Acc: 0.8276
 Site-Product                   (1) | Train Loss: 0.8161 | Train Acc: 1.0000
 Site-Product                   (1) | Train Loss: 0.8692 | Train Acc: 0.9091
 Site-amazon                    (3) | Train Loss: 0.8087 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.8842 | Train Acc: 0.8857
 Site-amazon                    (2) | Train Loss: 0.9925 | Train Acc: 0.8548
 Site-webcam                    (5) | Train Loss: 0.8641 | Train Acc: 0.9259
 Site-webcam                    (5) | Train Loss: 0.7789 | Train Acc: 0.9630
 Site-Art                       (4) | Train Loss: 1.1479 | Train Acc: 0.8182
 Site-Clipart                   (1) | Train Loss: 1.2998 | Train Acc: 0.7568
Average Train Accuracy: 0.9061
 Site-RealWorld                 (0) | Val  Loss: 0.5058 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.7508 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.9531 | Val  Acc: 0.9000
 Site-RealWorld                 (2) | Val  Loss: 0.7220 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 1.0016 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.8114 | Val  Acc: 0.9091
 Site-RealWorld                 (3) | Val  Loss: 0.8088 | Val  Acc: 0.9643
 Site-RealWorld                 (3) | Val  Loss: 0.8745 | Val  Acc: 0.9189
 Site-RealWorld                 (3) | Val  Loss: 0.7493 | Val  Acc: 0.9167
 Site-RealWorld                 (3) | Val  Loss: 0.8304 | Val  Acc: 0.9032
 Site-caltech                   (0) | Val  Loss: 0.9405 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.8321 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.9113 | Val  Acc: 0.9286
 Site-caltech                   (3) | Val  Loss: 0.8046 | Val  Acc: 0.9500
 Site-caltech                   (3) | Val  Loss: 0.8412 | Val  Acc: 0.8889
 Site-caltech                   (1) | Val  Loss: 0.8765 | Val  Acc: 0.8947
 Site-caltech                   (3) | Val  Loss: 0.9634 | Val  Acc: 0.8491
 Site-Product                   (2) | Val  Loss: 0.8274 | Val  Acc: 0.8750
 Site-Product                   (3) | Val  Loss: 0.8946 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.9389 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.7510 | Val  Acc: 0.9655
 Site-Product                   (1) | Val  Loss: 0.8269 | Val  Acc: 0.9545
 Site-amazon                    (3) | Val  Loss: 1.1620 | Val  Acc: 0.7692
 Site-amazon                    (2) | Val  Loss: 1.2088 | Val  Acc: 0.7391
 Site-amazon                    (2) | Val  Loss: 1.0530 | Val  Acc: 0.8293
 Site-webcam                    (5) | Val  Loss: 0.8968 | Val  Acc: 0.9444
 Site-webcam                    (5) | Val  Loss: 0.8171 | Val  Acc: 0.9167
 Site-Art                       (4) | Val  Loss: 1.2176 | Val  Acc: 0.8056
 Site-Clipart                   (1) | Val  Loss: 1.2321 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9058
 Best site-RealWorld                (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:15 | Val Acc: 0.9000
 Best site-RealWorld                (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:15 | Val Acc: 0.8235
 Best site-RealWorld                (1)  | Epoch:15 | Val Acc: 0.9091
 Best site-RealWorld                (3)  | Epoch:15 | Val Acc: 0.9643
 Best site-RealWorld                (3)  | Epoch:15 | Val Acc: 0.9189
 Best site-RealWorld                (3)  | Epoch:15 | Val Acc: 0.9167
 Best site-RealWorld                (3)  | Epoch:15 | Val Acc: 0.9032
 Best site-caltech                  (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:15 | Val Acc: 0.9286
 Best site-caltech                  (3)  | Epoch:15 | Val Acc: 0.9500
 Best site-caltech                  (3)  | Epoch:15 | Val Acc: 0.8889
 Best site-caltech                  (1)  | Epoch:15 | Val Acc: 0.8947
 Best site-caltech                  (3)  | Epoch:15 | Val Acc: 0.8491
 Best site-Product                  (2)  | Epoch:15 | Val Acc: 0.8750
 Best site-Product                  (3)  | Epoch:15 | Val Acc: 0.9231
 Best site-Product                  (3)  | Epoch:15 | Val Acc: 0.9500
 Best site-Product                  (1)  | Epoch:15 | Val Acc: 0.9655
 Best site-Product                  (1)  | Epoch:15 | Val Acc: 0.9545
 Best site-amazon                   (3)  | Epoch:15 | Val Acc: 0.7692
 Best site-amazon                   (2)  | Epoch:15 | Val Acc: 0.7391
 Best site-amazon                   (2)  | Epoch:15 | Val Acc: 0.8293
 Best site-webcam                   (5)  | Epoch:15 | Val Acc: 0.9444
 Best site-webcam                   (5)  | Epoch:15 | Val Acc: 0.9167
 Best site-Art                      (4)  | Epoch:15 | Val Acc: 0.8056
 Best site-Clipart                  (1)  | Epoch:15 | Val Acc: 0.7500
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 4, 1, 3, 10, 8, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-RealWorld                 (3) | Train Loss: 0.8178 | Train Acc: 0.8889
 Site-RealWorld                 (5) | Train Loss: 0.8058 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.9458 | Train Acc: 0.8667
 Site-RealWorld                 (4) | Train Loss: 0.8007 | Train Acc: 0.9500
 Site-RealWorld                 (3) | Train Loss: 0.7325 | Train Acc: 0.9600
 Site-RealWorld                 (5) | Train Loss: 0.7982 | Train Acc: 0.9091
 Site-RealWorld                 (4) | Train Loss: 0.7056 | Train Acc: 0.9535
 Site-RealWorld                 (5) | Train Loss: 0.7503 | Train Acc: 0.9455
 Site-RealWorld                 (5) | Train Loss: 0.7531 | Train Acc: 0.9444
 Site-RealWorld                 (4) | Train Loss: 0.7159 | Train Acc: 0.9247
 Site-caltech                   (5) | Train Loss: 0.9308 | Train Acc: 0.8182
 Site-caltech                   (2) | Train Loss: 0.8072 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.7616 | Train Acc: 0.8571
 Site-caltech                   (5) | Train Loss: 0.9508 | Train Acc: 0.8000
 Site-caltech                   (4) | Train Loss: 0.8249 | Train Acc: 0.8780
 Site-caltech                   (4) | Train Loss: 0.7794 | Train Acc: 0.9649
 Site-caltech                   (4) | Train Loss: 0.7871 | Train Acc: 0.9620
 Site-Product                   (1) | Train Loss: 0.6811 | Train Acc: 0.9231
 Site-Product                   (4) | Train Loss: 0.8316 | Train Acc: 0.9500
 Site-Product                   (1) | Train Loss: 0.9003 | Train Acc: 0.8966
 Site-Product                   (1) | Train Loss: 0.8138 | Train Acc: 0.9091
 Site-Product                   (4) | Train Loss: 0.9543 | Train Acc: 0.8939
 Site-amazon                    (4) | Train Loss: 0.7818 | Train Acc: 0.8500
 Site-amazon                    (6) | Train Loss: 0.8816 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.9042 | Train Acc: 0.8548
 Site-webcam                    (0) | Train Loss: 0.7592 | Train Acc: 0.9630
 Site-webcam                    (0) | Train Loss: 0.7395 | Train Acc: 0.9444
 Site-Art                       (3) | Train Loss: 1.0868 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 1.2396 | Train Acc: 0.7568
Average Train Accuracy: 0.9062
 Site-RealWorld                 (3) | Val  Loss: 0.4337 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.6672 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 1.0135 | Val  Acc: 0.9000
 Site-RealWorld                 (4) | Val  Loss: 0.7499 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.9720 | Val  Acc: 0.8824
 Site-RealWorld                 (5) | Val  Loss: 0.6838 | Val  Acc: 0.9545
 Site-RealWorld                 (4) | Val  Loss: 0.7958 | Val  Acc: 0.8929
 Site-RealWorld                 (5) | Val  Loss: 0.8012 | Val  Acc: 0.9459
 Site-RealWorld                 (5) | Val  Loss: 0.7002 | Val  Acc: 0.9375
 Site-RealWorld                 (4) | Val  Loss: 0.7759 | Val  Acc: 0.9194
 Site-caltech                   (5) | Val  Loss: 0.8607 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.7282 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.8707 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.7547 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.8397 | Val  Acc: 0.8889
 Site-caltech                   (4) | Val  Loss: 0.8137 | Val  Acc: 0.9211
 Site-caltech                   (4) | Val  Loss: 0.9015 | Val  Acc: 0.8491
 Site-Product                   (1) | Val  Loss: 0.7103 | Val  Acc: 0.8750
 Site-Product                   (4) | Val  Loss: 0.8133 | Val  Acc: 0.9231
 Site-Product                   (1) | Val  Loss: 0.8443 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.7083 | Val  Acc: 0.9655
 Site-Product                   (4) | Val  Loss: 0.8161 | Val  Acc: 0.8636
 Site-amazon                    (4) | Val  Loss: 1.0175 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 1.1245 | Val  Acc: 0.7391
 Site-amazon                    (1) | Val  Loss: 0.9768 | Val  Acc: 0.8293
 Site-webcam                    (0) | Val  Loss: 0.9369 | Val  Acc: 0.8333
 Site-webcam                    (0) | Val  Loss: 0.7921 | Val  Acc: 0.9444
 Site-Art                       (3) | Val  Loss: 1.1864 | Val  Acc: 0.8889
 Site-Clipart                   (4) | Val  Loss: 1.1534 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9099
 Best site-RealWorld                (3)  | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:16 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:16 | Val Acc: 0.9000
 Best site-RealWorld                (4)  | Epoch:16 | Val Acc: 0.9231
 Best site-RealWorld                (3)  | Epoch:16 | Val Acc: 0.8824
 Best site-RealWorld                (5)  | Epoch:16 | Val Acc: 0.9545
 Best site-RealWorld                (4)  | Epoch:16 | Val Acc: 0.8929
 Best site-RealWorld                (5)  | Epoch:16 | Val Acc: 0.9459
 Best site-RealWorld                (5)  | Epoch:16 | Val Acc: 0.9375
 Best site-RealWorld                (4)  | Epoch:16 | Val Acc: 0.9194
 Best site-caltech                  (5)  | Epoch:16 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:16 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:16 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:16 | Val Acc: 1.0000
 Best site-caltech                  (4)  | Epoch:16 | Val Acc: 0.8889
 Best site-caltech                  (4)  | Epoch:16 | Val Acc: 0.9211
 Best site-caltech                  (4)  | Epoch:16 | Val Acc: 0.8491
 Best site-Product                  (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-Product                  (4)  | Epoch:16 | Val Acc: 0.9231
 Best site-Product                  (1)  | Epoch:16 | Val Acc: 0.9500
 Best site-Product                  (1)  | Epoch:16 | Val Acc: 0.9655
 Best site-Product                  (4)  | Epoch:16 | Val Acc: 0.8636
 Best site-amazon                   (4)  | Epoch:16 | Val Acc: 0.7692
 Best site-amazon                   (6)  | Epoch:16 | Val Acc: 0.7391
 Best site-amazon                   (1)  | Epoch:16 | Val Acc: 0.8293
 Best site-webcam                   (0)  | Epoch:16 | Val Acc: 0.8333
 Best site-webcam                   (0)  | Epoch:16 | Val Acc: 0.9444
 Best site-Art                      (3)  | Epoch:16 | Val Acc: 0.8889
 Best site-Clipart                  (4)  | Epoch:16 | Val Acc: 0.7917
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 2, 2, 6, 1, 8, 9, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-RealWorld                 (6) | Train Loss: 0.8183 | Train Acc: 0.7778
 Site-RealWorld                 (6) | Train Loss: 0.6586 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.7641 | Train Acc: 0.9333
 Site-RealWorld                 (6) | Train Loss: 0.7024 | Train Acc: 0.8500
 Site-RealWorld                 (4) | Train Loss: 0.7078 | Train Acc: 0.9200
 Site-RealWorld                 (6) | Train Loss: 0.7040 | Train Acc: 0.9697
 Site-RealWorld                 (5) | Train Loss: 0.6037 | Train Acc: 0.9302
 Site-RealWorld                 (5) | Train Loss: 0.7028 | Train Acc: 0.9273
 Site-RealWorld                 (5) | Train Loss: 0.6482 | Train Acc: 0.9306
 Site-RealWorld                 (5) | Train Loss: 0.6407 | Train Acc: 0.9677
 Site-caltech                   (5) | Train Loss: 0.8674 | Train Acc: 0.9091
 Site-caltech                   (6) | Train Loss: 0.7632 | Train Acc: 0.9333
 Site-caltech                   (5) | Train Loss: 0.7497 | Train Acc: 0.9048
 Site-caltech                   (6) | Train Loss: 0.8563 | Train Acc: 0.8667
 Site-caltech                   (3) | Train Loss: 0.7775 | Train Acc: 0.8780
 Site-caltech                   (2) | Train Loss: 0.7029 | Train Acc: 0.9298
 Site-caltech                   (6) | Train Loss: 0.6944 | Train Acc: 0.9620
 Site-Product                   (3) | Train Loss: 0.5828 | Train Acc: 0.8462
 Site-Product                   (6) | Train Loss: 0.7536 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.8455 | Train Acc: 0.9310
 Site-Product                   (6) | Train Loss: 0.7309 | Train Acc: 0.9091
 Site-Product                   (3) | Train Loss: 0.8162 | Train Acc: 0.8636
 Site-amazon                    (0) | Train Loss: 0.7098 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.7919 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.8912 | Train Acc: 0.8710
 Site-webcam                    (5) | Train Loss: 0.6903 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.7017 | Train Acc: 0.9444
 Site-Art                       (1) | Train Loss: 1.0123 | Train Acc: 0.8000
 Site-Clipart                   (2) | Train Loss: 1.1330 | Train Acc: 0.7297
Average Train Accuracy: 0.9022
 Site-RealWorld                 (6) | Val  Loss: 0.4035 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.6704 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.8339 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.6646 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.8175 | Val  Acc: 0.8824
 Site-RealWorld                 (6) | Val  Loss: 0.6263 | Val  Acc: 0.9091
 Site-RealWorld                 (5) | Val  Loss: 0.6949 | Val  Acc: 0.8929
 Site-RealWorld                 (5) | Val  Loss: 0.7207 | Val  Acc: 0.9459
 Site-RealWorld                 (5) | Val  Loss: 0.6446 | Val  Acc: 0.9375
 Site-RealWorld                 (5) | Val  Loss: 0.7491 | Val  Acc: 0.9032
 Site-caltech                   (5) | Val  Loss: 0.7458 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.6212 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.7127 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.6624 | Val  Acc: 0.9500
 Site-caltech                   (3) | Val  Loss: 0.7011 | Val  Acc: 0.9259
 Site-caltech                   (2) | Val  Loss: 0.8314 | Val  Acc: 0.8947
 Site-caltech                   (6) | Val  Loss: 0.8365 | Val  Acc: 0.8491
 Site-Product                   (3) | Val  Loss: 0.7084 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 0.7047 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.8314 | Val  Acc: 0.9000
 Site-Product                   (6) | Val  Loss: 0.6726 | Val  Acc: 0.8966
 Site-Product                   (3) | Val  Loss: 0.7248 | Val  Acc: 0.9545
 Site-amazon                    (0) | Val  Loss: 1.0450 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 1.1564 | Val  Acc: 0.7391
 Site-amazon                    (3) | Val  Loss: 0.9594 | Val  Acc: 0.8293
 Site-webcam                    (5) | Val  Loss: 0.9322 | Val  Acc: 0.7778
 Site-webcam                    (1) | Val  Loss: 0.6918 | Val  Acc: 0.9444
 Site-Art                       (1) | Val  Loss: 1.0677 | Val  Acc: 0.8333
 Site-Clipart                   (2) | Val  Loss: 1.0931 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9092
============ Train epoch 18 ============
cnt=[3, 15, 5, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-RealWorld                 (1) | Train Loss: 0.9591 | Train Acc: 0.7778
 Site-RealWorld                 (1) | Train Loss: 0.6662 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.6936 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.6598 | Train Acc: 0.9000
 Site-RealWorld                 (6) | Train Loss: 0.6318 | Train Acc: 0.8800
 Site-RealWorld                 (1) | Train Loss: 0.5643 | Train Acc: 0.9697
 Site-RealWorld                 (1) | Train Loss: 0.6410 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.6435 | Train Acc: 0.9455
 Site-RealWorld                 (1) | Train Loss: 0.6302 | Train Acc: 0.9306
 Site-RealWorld                 (1) | Train Loss: 0.5809 | Train Acc: 0.9892
 Site-caltech                   (1) | Train Loss: 0.7713 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.7380 | Train Acc: 0.9333
 Site-caltech                   (0) | Train Loss: 0.6269 | Train Acc: 0.9048
 Site-caltech                   (1) | Train Loss: 0.8481 | Train Acc: 0.8667
 Site-caltech                   (2) | Train Loss: 0.7444 | Train Acc: 0.8780
 Site-caltech                   (0) | Train Loss: 0.7023 | Train Acc: 0.9474
 Site-caltech                   (1) | Train Loss: 0.7846 | Train Acc: 0.9747
 Site-Product                   (4) | Train Loss: 0.5075 | Train Acc: 1.0000
 Site-Product                   (2) | Train Loss: 0.7542 | Train Acc: 0.8500
 Site-Product                   (4) | Train Loss: 0.8162 | Train Acc: 0.8966
 Site-Product                   (2) | Train Loss: 0.6582 | Train Acc: 0.9318
 Site-Product                   (1) | Train Loss: 0.6033 | Train Acc: 0.8788
 Site-amazon                    (2) | Train Loss: 0.7469 | Train Acc: 0.8500
 Site-amazon                    (2) | Train Loss: 0.7618 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.8199 | Train Acc: 0.8548
 Site-webcam                    (1) | Train Loss: 0.7024 | Train Acc: 0.9259
 Site-webcam                    (1) | Train Loss: 0.6322 | Train Acc: 0.9259
 Site-Art                       (1) | Train Loss: 0.9878 | Train Acc: 0.8545
 Site-Clipart                   (5) | Train Loss: 1.1355 | Train Acc: 0.8108
Average Train Accuracy: 0.9153
 Site-RealWorld                 (1) | Val  Loss: 0.3745 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.4646 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.5917 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.6608 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.9302 | Val  Acc: 0.8824
 Site-RealWorld                 (1) | Val  Loss: 0.6682 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.6394 | Val  Acc: 0.8929
 Site-RealWorld                 (1) | Val  Loss: 0.6919 | Val  Acc: 0.9459
 Site-RealWorld                 (1) | Val  Loss: 0.5442 | Val  Acc: 0.9375
 Site-RealWorld                 (1) | Val  Loss: 0.6545 | Val  Acc: 0.9194
 Site-caltech                   (1) | Val  Loss: 0.7451 | Val  Acc: 0.8571
 Site-caltech                   (3) | Val  Loss: 0.6402 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.6927 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.6566 | Val  Acc: 0.9500
 Site-caltech                   (2) | Val  Loss: 0.7405 | Val  Acc: 0.9259
 Site-caltech                   (0) | Val  Loss: 0.6996 | Val  Acc: 0.8947
 Site-caltech                   (1) | Val  Loss: 0.8110 | Val  Acc: 0.8868
 Site-Product                   (4) | Val  Loss: 0.5983 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.6346 | Val  Acc: 0.9231
 Site-Product                   (4) | Val  Loss: 0.7293 | Val  Acc: 0.9000
 Site-Product                   (2) | Val  Loss: 0.6420 | Val  Acc: 0.8966
 Site-Product                   (1) | Val  Loss: 0.7738 | Val  Acc: 0.8409
 Site-amazon                    (2) | Val  Loss: 1.0265 | Val  Acc: 0.7692
 Site-amazon                    (2) | Val  Loss: 1.1055 | Val  Acc: 0.6957
 Site-amazon                    (0) | Val  Loss: 0.9096 | Val  Acc: 0.8537
 Site-webcam                    (1) | Val  Loss: 0.7840 | Val  Acc: 0.8333
 Site-webcam                    (1) | Val  Loss: 0.6596 | Val  Acc: 0.9444
 Site-Art                       (1) | Val  Loss: 1.0732 | Val  Acc: 0.8333
 Site-Clipart                   (5) | Val  Loss: 1.0300 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9037
============ Train epoch 19 ============
cnt=[1, 11, 5, 3, 1, 4, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-RealWorld                 (3) | Train Loss: 0.6135 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.5828 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.6035 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.6946 | Train Acc: 0.9000
 Site-RealWorld                 (6) | Train Loss: 0.6680 | Train Acc: 0.8800
 Site-RealWorld                 (1) | Train Loss: 0.5800 | Train Acc: 0.9697
 Site-RealWorld                 (1) | Train Loss: 0.5879 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.6393 | Train Acc: 0.9455
 Site-RealWorld                 (1) | Train Loss: 0.5831 | Train Acc: 0.9444
 Site-RealWorld                 (1) | Train Loss: 0.5353 | Train Acc: 0.9677
 Site-caltech                   (2) | Train Loss: 0.7218 | Train Acc: 0.9091
 Site-caltech                   (3) | Train Loss: 0.6381 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.5919 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.7597 | Train Acc: 0.9000
 Site-caltech                   (3) | Train Loss: 0.7027 | Train Acc: 0.8537
 Site-caltech                   (1) | Train Loss: 0.6519 | Train Acc: 0.8772
 Site-caltech                   (1) | Train Loss: 0.6515 | Train Acc: 0.9747
 Site-Product                   (2) | Train Loss: 0.5501 | Train Acc: 0.8462
 Site-Product                   (1) | Train Loss: 0.6417 | Train Acc: 0.9000
 Site-Product                   (2) | Train Loss: 0.7437 | Train Acc: 0.8966
 Site-Product                   (5) | Train Loss: 0.6484 | Train Acc: 0.9091
 Site-Product                   (5) | Train Loss: 1.0695 | Train Acc: 0.9242
 Site-amazon                    (5) | Train Loss: 0.5751 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.7254 | Train Acc: 0.8857
 Site-amazon                    (2) | Train Loss: 0.7740 | Train Acc: 0.8387
 Site-webcam                    (1) | Train Loss: 0.6234 | Train Acc: 0.9259
 Site-webcam                    (1) | Train Loss: 0.6410 | Train Acc: 0.9259
 Site-Art                       (6) | Train Loss: 1.0119 | Train Acc: 0.7455
 Site-Clipart                   (0) | Train Loss: 1.0300 | Train Acc: 0.8108
Average Train Accuracy: 0.9144
 Site-RealWorld                 (3) | Val  Loss: 0.2914 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.5138 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.6202 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.6488 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.7841 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.5877 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.5942 | Val  Acc: 0.9643
 Site-RealWorld                 (1) | Val  Loss: 0.7017 | Val  Acc: 0.9189
 Site-RealWorld                 (1) | Val  Loss: 0.5182 | Val  Acc: 0.9583
 Site-RealWorld                 (1) | Val  Loss: 0.5968 | Val  Acc: 0.9194
 Site-caltech                   (2) | Val  Loss: 0.7192 | Val  Acc: 0.8571
 Site-caltech                   (3) | Val  Loss: 0.5527 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.7314 | Val  Acc: 0.9286
 Site-caltech                   (6) | Val  Loss: 0.5837 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.6814 | Val  Acc: 0.9259
 Site-caltech                   (1) | Val  Loss: 0.6418 | Val  Acc: 0.9474
 Site-caltech                   (1) | Val  Loss: 0.7805 | Val  Acc: 0.8302
 Site-Product                   (2) | Val  Loss: 0.5445 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.5773 | Val  Acc: 0.9231
 Site-Product                   (2) | Val  Loss: 0.6789 | Val  Acc: 0.9000
 Site-Product                   (5) | Val  Loss: 0.5858 | Val  Acc: 0.9310
 Site-Product                   (5) | Val  Loss: 0.6419 | Val  Acc: 0.9545
 Site-amazon                    (5) | Val  Loss: 0.9084 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 1.0443 | Val  Acc: 0.7826
 Site-amazon                    (2) | Val  Loss: 0.8360 | Val  Acc: 0.8537
 Site-webcam                    (1) | Val  Loss: 0.7125 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.6638 | Val  Acc: 0.8889
 Site-Art                       (6) | Val  Loss: 1.0341 | Val  Acc: 0.8056
 Site-Clipart                   (0) | Val  Loss: 1.0221 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9059
============ Train epoch 20 ============
cnt=[4, 3, 5, 5, 9, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-RealWorld                 (1) | Train Loss: 0.6365 | Train Acc: 0.8889
 Site-RealWorld                 (2) | Train Loss: 0.5661 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.5380 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.5929 | Train Acc: 0.9500
 Site-RealWorld                 (1) | Train Loss: 0.5617 | Train Acc: 0.8400
 Site-RealWorld                 (4) | Train Loss: 0.5926 | Train Acc: 0.9697
 Site-RealWorld                 (4) | Train Loss: 0.5211 | Train Acc: 0.9302
 Site-RealWorld                 (2) | Train Loss: 0.5409 | Train Acc: 0.9818
 Site-RealWorld                 (4) | Train Loss: 0.5961 | Train Acc: 0.9306
 Site-RealWorld                 (4) | Train Loss: 0.5558 | Train Acc: 0.9677
 Site-caltech                   (0) | Train Loss: 0.6561 | Train Acc: 0.9091
 Site-caltech                   (5) | Train Loss: 0.7416 | Train Acc: 0.9333
 Site-caltech                   (6) | Train Loss: 0.5359 | Train Acc: 0.9524
 Site-caltech                   (4) | Train Loss: 0.7395 | Train Acc: 0.8333
 Site-caltech                   (0) | Train Loss: 0.7064 | Train Acc: 0.9268
 Site-caltech                   (4) | Train Loss: 0.6476 | Train Acc: 0.9123
 Site-caltech                   (2) | Train Loss: 0.6412 | Train Acc: 0.9367
 Site-Product                   (3) | Train Loss: 0.4717 | Train Acc: 1.0000
 Site-Product                   (1) | Train Loss: 0.5510 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.6578 | Train Acc: 0.8966
 Site-Product                   (0) | Train Loss: 0.5960 | Train Acc: 0.9318
 Site-Product                   (0) | Train Loss: 0.6831 | Train Acc: 0.9242
 Site-amazon                    (3) | Train Loss: 0.5853 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.6550 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.7256 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.5455 | Train Acc: 1.0000
 Site-webcam                    (2) | Train Loss: 0.5968 | Train Acc: 0.9630
 Site-Art                       (4) | Train Loss: 0.9779 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 1.0549 | Train Acc: 0.8108
Average Train Accuracy: 0.9233
 Site-RealWorld                 (1) | Val  Loss: 0.2651 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4571 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.6754 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.5808 | Val  Acc: 0.9231
 Site-RealWorld                 (1) | Val  Loss: 0.7791 | Val  Acc: 0.8824
 Site-RealWorld                 (4) | Val  Loss: 0.5065 | Val  Acc: 0.9545
 Site-RealWorld                 (4) | Val  Loss: 0.5312 | Val  Acc: 0.9643
 Site-RealWorld                 (2) | Val  Loss: 0.6632 | Val  Acc: 0.8919
 Site-RealWorld                 (4) | Val  Loss: 0.4930 | Val  Acc: 0.9583
 Site-RealWorld                 (4) | Val  Loss: 0.5460 | Val  Acc: 0.9355
 Site-caltech                   (0) | Val  Loss: 0.6401 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.5374 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.6811 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.5644 | Val  Acc: 0.9500
 Site-caltech                   (0) | Val  Loss: 0.6278 | Val  Acc: 0.9630
 Site-caltech                   (4) | Val  Loss: 0.7041 | Val  Acc: 0.8421
 Site-caltech                   (2) | Val  Loss: 0.7096 | Val  Acc: 0.8679
 Site-Product                   (3) | Val  Loss: 0.4864 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.5565 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.6279 | Val  Acc: 0.9500
 Site-Product                   (0) | Val  Loss: 0.5524 | Val  Acc: 0.9655
 Site-Product                   (0) | Val  Loss: 0.6530 | Val  Acc: 0.8864
 Site-amazon                    (3) | Val  Loss: 0.8272 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.9817 | Val  Acc: 0.7391
 Site-amazon                    (3) | Val  Loss: 0.8536 | Val  Acc: 0.8049
 Site-webcam                    (2) | Val  Loss: 0.6430 | Val  Acc: 0.9444
 Site-webcam                    (2) | Val  Loss: 0.6731 | Val  Acc: 0.8889
 Site-Art                       (4) | Val  Loss: 0.9336 | Val  Acc: 0.8889
 Site-Clipart                   (4) | Val  Loss: 1.0065 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9243
 Best site-RealWorld                (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:20 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:20 | Val Acc: 0.9231
 Best site-RealWorld                (1)  | Epoch:20 | Val Acc: 0.8824
 Best site-RealWorld                (4)  | Epoch:20 | Val Acc: 0.9545
 Best site-RealWorld                (4)  | Epoch:20 | Val Acc: 0.9643
 Best site-RealWorld                (2)  | Epoch:20 | Val Acc: 0.8919
 Best site-RealWorld                (4)  | Epoch:20 | Val Acc: 0.9583
 Best site-RealWorld                (4)  | Epoch:20 | Val Acc: 0.9355
 Best site-caltech                  (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                  (6)  | Epoch:20 | Val Acc: 1.0000
 Best site-caltech                  (4)  | Epoch:20 | Val Acc: 0.9500
 Best site-caltech                  (0)  | Epoch:20 | Val Acc: 0.9630
 Best site-caltech                  (4)  | Epoch:20 | Val Acc: 0.8421
 Best site-caltech                  (2)  | Epoch:20 | Val Acc: 0.8679
 Best site-Product                  (3)  | Epoch:20 | Val Acc: 1.0000
 Best site-Product                  (1)  | Epoch:20 | Val Acc: 1.0000
 Best site-Product                  (3)  | Epoch:20 | Val Acc: 0.9500
 Best site-Product                  (0)  | Epoch:20 | Val Acc: 0.9655
 Best site-Product                  (0)  | Epoch:20 | Val Acc: 0.8864
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.7391
 Best site-amazon                   (3)  | Epoch:20 | Val Acc: 0.8049
 Best site-webcam                   (2)  | Epoch:20 | Val Acc: 0.9444
 Best site-webcam                   (2)  | Epoch:20 | Val Acc: 0.8889
 Best site-Art                      (4)  | Epoch:20 | Val Acc: 0.8889
 Best site-Clipart                  (4)  | Epoch:20 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[5, 6, 4, 3, 2, 5, 4, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-RealWorld                 (3) | Train Loss: 0.6784 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.5316 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.6519 | Train Acc: 0.9333
 Site-RealWorld                 (0) | Train Loss: 0.6178 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.5182 | Train Acc: 0.9200
 Site-RealWorld                 (5) | Train Loss: 0.4937 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.4921 | Train Acc: 0.9767
 Site-RealWorld                 (5) | Train Loss: 0.5437 | Train Acc: 0.9273
 Site-RealWorld                 (0) | Train Loss: 0.4736 | Train Acc: 0.9583
 Site-RealWorld                 (0) | Train Loss: 0.4513 | Train Acc: 0.9785
 Site-caltech                   (6) | Train Loss: 0.5790 | Train Acc: 0.9091
 Site-caltech                   (5) | Train Loss: 0.6337 | Train Acc: 0.9333
 Site-caltech                   (6) | Train Loss: 0.5403 | Train Acc: 0.9524
 Site-caltech                   (2) | Train Loss: 0.7979 | Train Acc: 0.8333
 Site-caltech                   (3) | Train Loss: 0.5715 | Train Acc: 0.9268
 Site-caltech                   (5) | Train Loss: 0.5954 | Train Acc: 0.9474
 Site-caltech                   (6) | Train Loss: 0.5908 | Train Acc: 0.9494
 Site-Product                   (5) | Train Loss: 0.4347 | Train Acc: 1.0000
 Site-Product                   (0) | Train Loss: 0.5866 | Train Acc: 0.9500
 Site-Product                   (1) | Train Loss: 0.6716 | Train Acc: 0.8966
 Site-Product                   (1) | Train Loss: 0.5720 | Train Acc: 0.9545
 Site-Product                   (1) | Train Loss: 0.5147 | Train Acc: 0.9091
 Site-amazon                    (1) | Train Loss: 0.5429 | Train Acc: 0.9000
 Site-amazon                    (1) | Train Loss: 0.6311 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.7052 | Train Acc: 0.8710
 Site-webcam                    (4) | Train Loss: 0.5238 | Train Acc: 0.9259
 Site-webcam                    (4) | Train Loss: 0.4905 | Train Acc: 0.9444
 Site-Art                       (6) | Train Loss: 0.9183 | Train Acc: 0.8000
 Site-Clipart                   (2) | Train Loss: 0.9753 | Train Acc: 0.8108
Average Train Accuracy: 0.9245
 Site-RealWorld                 (3) | Val  Loss: 0.2159 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4415 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.6167 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.5544 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.6903 | Val  Acc: 0.8824
 Site-RealWorld                 (5) | Val  Loss: 0.5246 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.5759 | Val  Acc: 0.8929
 Site-RealWorld                 (5) | Val  Loss: 0.5715 | Val  Acc: 0.9459
 Site-RealWorld                 (0) | Val  Loss: 0.4132 | Val  Acc: 0.9583
 Site-RealWorld                 (0) | Val  Loss: 0.5203 | Val  Acc: 0.9194
 Site-caltech                   (6) | Val  Loss: 0.6679 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.4151 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.7025 | Val  Acc: 0.9286
 Site-caltech                   (2) | Val  Loss: 0.5458 | Val  Acc: 0.9500
 Site-caltech                   (3) | Val  Loss: 0.5466 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.6101 | Val  Acc: 0.9211
 Site-caltech                   (6) | Val  Loss: 0.6597 | Val  Acc: 0.9057
 Site-Product                   (5) | Val  Loss: 0.4624 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.5331 | Val  Acc: 0.9231
 Site-Product                   (1) | Val  Loss: 0.5653 | Val  Acc: 0.9000
 Site-Product                   (1) | Val  Loss: 0.4805 | Val  Acc: 0.9310
 Site-Product                   (1) | Val  Loss: 0.5637 | Val  Acc: 0.9545
 Site-amazon                    (1) | Val  Loss: 0.9058 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.9400 | Val  Acc: 0.7826
 Site-amazon                    (1) | Val  Loss: 0.7663 | Val  Acc: 0.8537
 Site-webcam                    (4) | Val  Loss: 0.6393 | Val  Acc: 0.9444
 Site-webcam                    (4) | Val  Loss: 0.5494 | Val  Acc: 0.9444
 Site-Art                       (6) | Val  Loss: 0.9204 | Val  Acc: 0.8611
 Site-Clipart                   (2) | Val  Loss: 0.9091 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9222
============ Train epoch 22 ============
cnt=[2, 11, 7, 2, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-RealWorld                 (1) | Train Loss: 0.7297 | Train Acc: 0.8889
 Site-RealWorld                 (4) | Train Loss: 0.4054 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.6150 | Train Acc: 0.9333
 Site-RealWorld                 (3) | Train Loss: 0.5398 | Train Acc: 0.9000
 Site-RealWorld                 (3) | Train Loss: 0.5867 | Train Acc: 0.8400
 Site-RealWorld                 (2) | Train Loss: 0.4376 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.4634 | Train Acc: 0.9535
 Site-RealWorld                 (2) | Train Loss: 0.5283 | Train Acc: 0.9273
 Site-RealWorld                 (2) | Train Loss: 0.5180 | Train Acc: 0.9306
 Site-RealWorld                 (2) | Train Loss: 0.4586 | Train Acc: 0.9570
 Site-caltech                   (0) | Train Loss: 0.5521 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.5720 | Train Acc: 0.9333
 Site-caltech                   (2) | Train Loss: 0.4775 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.7581 | Train Acc: 0.8000
 Site-caltech                   (1) | Train Loss: 0.5930 | Train Acc: 0.8780
 Site-caltech                   (1) | Train Loss: 0.5441 | Train Acc: 0.9649
 Site-caltech                   (2) | Train Loss: 0.5479 | Train Acc: 0.9620
 Site-Product                   (1) | Train Loss: 0.4752 | Train Acc: 0.9231
 Site-Product                   (5) | Train Loss: 0.5235 | Train Acc: 0.9500
 Site-Product                   (1) | Train Loss: 0.6107 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.5951 | Train Acc: 0.9091
 Site-Product                   (1) | Train Loss: 0.5121 | Train Acc: 0.9091
 Site-amazon                    (1) | Train Loss: 0.5054 | Train Acc: 0.9000
 Site-amazon                    (1) | Train Loss: 0.6297 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.6624 | Train Acc: 0.8548
 Site-webcam                    (6) | Train Loss: 0.4606 | Train Acc: 0.9259
 Site-webcam                    (6) | Train Loss: 0.5001 | Train Acc: 0.9630
 Site-Art                       (6) | Train Loss: 0.9117 | Train Acc: 0.8000
 Site-Clipart                   (2) | Train Loss: 0.9324 | Train Acc: 0.7838
Average Train Accuracy: 0.9184
 Site-RealWorld                 (1) | Val  Loss: 0.2344 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3844 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.5595 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4862 | Val  Acc: 0.8462
 Site-RealWorld                 (3) | Val  Loss: 0.6046 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.4345 | Val  Acc: 0.9545
 Site-RealWorld                 (1) | Val  Loss: 0.5230 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.5528 | Val  Acc: 0.9189
 Site-RealWorld                 (2) | Val  Loss: 0.3957 | Val  Acc: 0.9792
 Site-RealWorld                 (2) | Val  Loss: 0.4762 | Val  Acc: 0.9516
 Site-caltech                   (0) | Val  Loss: 0.6361 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.4383 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.5099 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.4133 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.5611 | Val  Acc: 0.8889
 Site-caltech                   (1) | Val  Loss: 0.5970 | Val  Acc: 0.8947
 Site-caltech                   (2) | Val  Loss: 0.6587 | Val  Acc: 0.8679
 Site-Product                   (1) | Val  Loss: 0.5232 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.4883 | Val  Acc: 0.9231
 Site-Product                   (1) | Val  Loss: 0.5235 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.5087 | Val  Acc: 0.8966
 Site-Product                   (1) | Val  Loss: 0.5693 | Val  Acc: 0.9318
 Site-amazon                    (1) | Val  Loss: 0.8480 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.9484 | Val  Acc: 0.7826
 Site-amazon                    (1) | Val  Loss: 0.7588 | Val  Acc: 0.8293
 Site-webcam                    (6) | Val  Loss: 0.6999 | Val  Acc: 0.7778
 Site-webcam                    (6) | Val  Loss: 0.5730 | Val  Acc: 0.8889
 Site-Art                       (6) | Val  Loss: 0.9046 | Val  Acc: 0.8056
 Site-Clipart                   (2) | Val  Loss: 0.9839 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9087
============ Train epoch 23 ============
cnt=[1, 2, 4, 8, 4, 1, 9, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-RealWorld                 (6) | Train Loss: 0.6470 | Train Acc: 0.8889
 Site-RealWorld                 (4) | Train Loss: 0.4468 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.5837 | Train Acc: 0.8667
 Site-RealWorld                 (6) | Train Loss: 0.6192 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.4202 | Train Acc: 0.9600
 Site-RealWorld                 (3) | Train Loss: 0.3960 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.3902 | Train Acc: 0.9535
 Site-RealWorld                 (3) | Train Loss: 0.5166 | Train Acc: 0.9091
 Site-RealWorld                 (6) | Train Loss: 0.4387 | Train Acc: 0.9028
 Site-RealWorld                 (6) | Train Loss: 0.4153 | Train Acc: 0.9785
 Site-caltech                   (5) | Train Loss: 0.6322 | Train Acc: 0.9091
 Site-caltech                   (4) | Train Loss: 0.6851 | Train Acc: 0.8667
 Site-caltech                   (2) | Train Loss: 0.4147 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.6290 | Train Acc: 0.9000
 Site-caltech                   (3) | Train Loss: 0.4688 | Train Acc: 0.9512
 Site-caltech                   (6) | Train Loss: 0.4776 | Train Acc: 0.9474
 Site-caltech                   (6) | Train Loss: 0.5462 | Train Acc: 0.9620
 Site-Product                   (6) | Train Loss: 0.4096 | Train Acc: 1.0000
 Site-Product                   (4) | Train Loss: 0.5417 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.5489 | Train Acc: 0.9310
 Site-Product                   (3) | Train Loss: 0.5837 | Train Acc: 0.9318
 Site-Product                   (3) | Train Loss: 0.8707 | Train Acc: 0.9242
 Site-amazon                    (0) | Train Loss: 0.5412 | Train Acc: 0.9000
 Site-amazon                    (4) | Train Loss: 0.5856 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.6453 | Train Acc: 0.8871
 Site-webcam                    (1) | Train Loss: 0.4671 | Train Acc: 0.9630
 Site-webcam                    (2) | Train Loss: 0.4764 | Train Acc: 0.9444
 Site-Art                       (6) | Train Loss: 0.8474 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.9355 | Train Acc: 0.7838
Average Train Accuracy: 0.9256
 Site-RealWorld                 (6) | Val  Loss: 0.1872 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3012 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4269 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.5370 | Val  Acc: 0.8462
 Site-RealWorld                 (2) | Val  Loss: 0.6352 | Val  Acc: 0.8235
 Site-RealWorld                 (3) | Val  Loss: 0.4309 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.5051 | Val  Acc: 0.8929
 Site-RealWorld                 (3) | Val  Loss: 0.5448 | Val  Acc: 0.9459
 Site-RealWorld                 (6) | Val  Loss: 0.4275 | Val  Acc: 0.9583
 Site-RealWorld                 (6) | Val  Loss: 0.4509 | Val  Acc: 0.9355
 Site-caltech                   (5) | Val  Loss: 0.6496 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.4309 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.4777 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.4791 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.5457 | Val  Acc: 0.9630
 Site-caltech                   (6) | Val  Loss: 0.5700 | Val  Acc: 0.9211
 Site-caltech                   (6) | Val  Loss: 0.5392 | Val  Acc: 0.9245
 Site-Product                   (6) | Val  Loss: 0.4184 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.3786 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.4937 | Val  Acc: 0.9000
 Site-Product                   (3) | Val  Loss: 0.3718 | Val  Acc: 0.9310
 Site-Product                   (3) | Val  Loss: 0.5360 | Val  Acc: 0.9318
 Site-amazon                    (0) | Val  Loss: 0.8254 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.9458 | Val  Acc: 0.7826
 Site-amazon                    (3) | Val  Loss: 0.7052 | Val  Acc: 0.9024
 Site-webcam                    (1) | Val  Loss: 0.7028 | Val  Acc: 0.7778
 Site-webcam                    (2) | Val  Loss: 0.5675 | Val  Acc: 0.9167
 Site-Art                       (6) | Val  Loss: 0.8569 | Val  Acc: 0.8611
 Site-Clipart                   (3) | Val  Loss: 1.0247 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9201
============ Train epoch 24 ============
cnt=[7, 5, 7, 4, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-RealWorld                 (0) | Train Loss: 0.5773 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.4327 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.5162 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.4858 | Train Acc: 0.9000
 Site-RealWorld                 (0) | Train Loss: 0.4860 | Train Acc: 0.9200
 Site-RealWorld                 (3) | Train Loss: 0.3932 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.4087 | Train Acc: 0.9302
 Site-RealWorld                 (2) | Train Loss: 0.4304 | Train Acc: 0.9455
 Site-RealWorld                 (0) | Train Loss: 0.4032 | Train Acc: 0.9306
 Site-RealWorld                 (3) | Train Loss: 0.3739 | Train Acc: 0.9892
 Site-caltech                   (0) | Train Loss: 0.4316 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.5487 | Train Acc: 0.9333
 Site-caltech                   (2) | Train Loss: 0.4495 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.5909 | Train Acc: 0.9000
 Site-caltech                   (2) | Train Loss: 0.5022 | Train Acc: 0.8780
 Site-caltech                   (2) | Train Loss: 0.4418 | Train Acc: 0.9649
 Site-caltech                   (2) | Train Loss: 0.4453 | Train Acc: 0.9620
 Site-Product                   (3) | Train Loss: 0.4329 | Train Acc: 0.8462
 Site-Product                   (4) | Train Loss: 0.4400 | Train Acc: 0.9500
 Site-Product                   (4) | Train Loss: 0.5361 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.5336 | Train Acc: 0.8864
 Site-Product                   (1) | Train Loss: 0.3896 | Train Acc: 0.9394
 Site-amazon                    (1) | Train Loss: 0.4784 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.5354 | Train Acc: 0.9143
 Site-amazon                    (4) | Train Loss: 0.6463 | Train Acc: 0.8871
 Site-webcam                    (5) | Train Loss: 0.3743 | Train Acc: 0.9630
 Site-webcam                    (5) | Train Loss: 0.4417 | Train Acc: 0.9630
 Site-Art                       (0) | Train Loss: 0.8213 | Train Acc: 0.8182
 Site-Clipart                   (2) | Train Loss: 0.9074 | Train Acc: 0.7838
Average Train Accuracy: 0.9267
 Site-RealWorld                 (0) | Val  Loss: 0.1471 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.3528 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.6207 | Val  Acc: 0.9000
 Site-RealWorld                 (6) | Val  Loss: 0.4804 | Val  Acc: 0.8462
 Site-RealWorld                 (0) | Val  Loss: 0.5764 | Val  Acc: 0.8235
 Site-RealWorld                 (3) | Val  Loss: 0.3875 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.4686 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.4478 | Val  Acc: 0.9730
 Site-RealWorld                 (0) | Val  Loss: 0.3928 | Val  Acc: 0.9583
 Site-RealWorld                 (3) | Val  Loss: 0.4421 | Val  Acc: 0.9032
 Site-caltech                   (0) | Val  Loss: 0.6383 | Val  Acc: 0.8571
 Site-caltech                   (1) | Val  Loss: 0.3518 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.4376 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3640 | Val  Acc: 0.9500
 Site-caltech                   (2) | Val  Loss: 0.5353 | Val  Acc: 0.9630
 Site-caltech                   (2) | Val  Loss: 0.5175 | Val  Acc: 0.8947
 Site-caltech                   (2) | Val  Loss: 0.5233 | Val  Acc: 0.9434
 Site-Product                   (3) | Val  Loss: 0.3776 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.3667 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.4032 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.4226 | Val  Acc: 0.9310
 Site-Product                   (1) | Val  Loss: 0.5313 | Val  Acc: 0.9318
 Site-amazon                    (1) | Val  Loss: 0.7663 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.9404 | Val  Acc: 0.7826
 Site-amazon                    (4) | Val  Loss: 0.7091 | Val  Acc: 0.8293
 Site-webcam                    (5) | Val  Loss: 0.7031 | Val  Acc: 0.7222
 Site-webcam                    (5) | Val  Loss: 0.4702 | Val  Acc: 0.9444
 Site-Art                       (0) | Val  Loss: 0.8285 | Val  Acc: 0.8611
 Site-Clipart                   (2) | Val  Loss: 0.8825 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9138
============ Train epoch 25 ============
cnt=[9, 7, 1, 1, 3, 2, 6, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-RealWorld                 (1) | Train Loss: 0.5724 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 0.4313 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.4147 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.4110 | Train Acc: 0.9500
 Site-RealWorld                 (0) | Train Loss: 0.4231 | Train Acc: 0.9200
 Site-RealWorld                 (0) | Train Loss: 0.3780 | Train Acc: 0.9697
 Site-RealWorld                 (0) | Train Loss: 0.3745 | Train Acc: 0.9535
 Site-RealWorld                 (6) | Train Loss: 0.4720 | Train Acc: 0.9455
 Site-RealWorld                 (0) | Train Loss: 0.5290 | Train Acc: 0.9444
 Site-RealWorld                 (6) | Train Loss: 0.3708 | Train Acc: 0.9892
 Site-caltech                   (4) | Train Loss: 0.4411 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.4907 | Train Acc: 0.9333
 Site-caltech                   (0) | Train Loss: 0.3825 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.5545 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.5496 | Train Acc: 0.8537
 Site-caltech                   (4) | Train Loss: 0.4350 | Train Acc: 0.9649
 Site-caltech                   (6) | Train Loss: 0.4714 | Train Acc: 0.9494
 Site-Product                   (2) | Train Loss: 0.3330 | Train Acc: 0.9231
 Site-Product                   (6) | Train Loss: 0.4165 | Train Acc: 0.9500
 Site-Product                   (1) | Train Loss: 0.5424 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.4591 | Train Acc: 0.9091
 Site-Product                   (1) | Train Loss: 0.3218 | Train Acc: 0.9242
 Site-amazon                    (1) | Train Loss: 0.4983 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.5945 | Train Acc: 0.9143
 Site-amazon                    (4) | Train Loss: 0.5944 | Train Acc: 0.8710
 Site-webcam                    (5) | Train Loss: 0.4666 | Train Acc: 0.9259
 Site-webcam                    (5) | Train Loss: 0.4414 | Train Acc: 0.9259
 Site-Art                       (0) | Train Loss: 0.7613 | Train Acc: 0.8545
 Site-Clipart                   (0) | Train Loss: 0.8724 | Train Acc: 0.7838
Average Train Accuracy: 0.9296
 Site-RealWorld                 (1) | Val  Loss: 0.1606 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3956 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.4814 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.4448 | Val  Acc: 0.8462
 Site-RealWorld                 (0) | Val  Loss: 0.5141 | Val  Acc: 0.9412
 Site-RealWorld                 (0) | Val  Loss: 0.4564 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.4677 | Val  Acc: 0.9286
 Site-RealWorld                 (6) | Val  Loss: 0.4247 | Val  Acc: 0.9459
 Site-RealWorld                 (0) | Val  Loss: 0.3411 | Val  Acc: 0.9583
 Site-RealWorld                 (6) | Val  Loss: 0.4274 | Val  Acc: 0.9355
 Site-caltech                   (4) | Val  Loss: 0.5503 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.3711 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.5464 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.3878 | Val  Acc: 0.9500
 Site-caltech                   (1) | Val  Loss: 0.3949 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.5230 | Val  Acc: 0.8947
 Site-caltech                   (6) | Val  Loss: 0.5525 | Val  Acc: 0.8868
 Site-Product                   (2) | Val  Loss: 0.3800 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 0.3472 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.4149 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.3784 | Val  Acc: 0.9310
 Site-Product                   (1) | Val  Loss: 0.4280 | Val  Acc: 0.9773
 Site-amazon                    (1) | Val  Loss: 0.7860 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.9046 | Val  Acc: 0.7391
 Site-amazon                    (4) | Val  Loss: 0.6530 | Val  Acc: 0.8537
 Site-webcam                    (5) | Val  Loss: 0.7038 | Val  Acc: 0.7778
 Site-webcam                    (5) | Val  Loss: 0.4701 | Val  Acc: 0.8889
 Site-Art                       (0) | Val  Loss: 0.8298 | Val  Acc: 0.8611
 Site-Clipart                   (0) | Val  Loss: 0.8769 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9176
============ Train epoch 26 ============
cnt=[2, 1, 6, 1, 6, 8, 5, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-RealWorld                 (2) | Train Loss: 0.5857 | Train Acc: 0.8889
 Site-RealWorld                 (5) | Train Loss: 0.3988 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.3950 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.4118 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.4537 | Train Acc: 0.8800
 Site-RealWorld                 (6) | Train Loss: 0.3324 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.3499 | Train Acc: 0.9767
 Site-RealWorld                 (2) | Train Loss: 0.4010 | Train Acc: 0.9636
 Site-RealWorld                 (0) | Train Loss: 0.3244 | Train Acc: 0.9583
 Site-RealWorld                 (6) | Train Loss: 0.3251 | Train Acc: 0.9677
 Site-caltech                   (6) | Train Loss: 0.4320 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.5498 | Train Acc: 0.8667
 Site-caltech                   (4) | Train Loss: 0.3842 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.5643 | Train Acc: 0.9333
 Site-caltech                   (6) | Train Loss: 0.4474 | Train Acc: 0.9512
 Site-caltech                   (6) | Train Loss: 0.4657 | Train Acc: 0.9474
 Site-caltech                   (4) | Train Loss: 0.4899 | Train Acc: 0.9620
 Site-Product                   (5) | Train Loss: 0.3667 | Train Acc: 0.9231
 Site-Product                   (5) | Train Loss: 0.4074 | Train Acc: 0.9500
 Site-Product                   (5) | Train Loss: 0.5241 | Train Acc: 0.9310
 Site-Product                   (5) | Train Loss: 0.4993 | Train Acc: 0.9318
 Site-Product                   (5) | Train Loss: 0.3569 | Train Acc: 0.9242
 Site-amazon                    (0) | Train Loss: 0.4596 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.5165 | Train Acc: 0.9429
 Site-amazon                    (5) | Train Loss: 0.5874 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.3407 | Train Acc: 1.0000
 Site-webcam                    (2) | Train Loss: 0.4182 | Train Acc: 0.9444
 Site-Art                       (4) | Train Loss: 0.8134 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 0.8347 | Train Acc: 0.7838
Average Train Accuracy: 0.9344
 Site-RealWorld                 (2) | Val  Loss: 0.1310 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.3225 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.4796 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3672 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.6079 | Val  Acc: 0.8824
 Site-RealWorld                 (6) | Val  Loss: 0.3944 | Val  Acc: 0.9545
 Site-RealWorld                 (1) | Val  Loss: 0.4192 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.5022 | Val  Acc: 0.9189
 Site-RealWorld                 (0) | Val  Loss: 0.3386 | Val  Acc: 0.9167
 Site-RealWorld                 (6) | Val  Loss: 0.3958 | Val  Acc: 0.9355
 Site-caltech                   (6) | Val  Loss: 0.4455 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2712 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.4018 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3724 | Val  Acc: 0.9500
 Site-caltech                   (6) | Val  Loss: 0.4357 | Val  Acc: 0.9630
 Site-caltech                   (6) | Val  Loss: 0.4205 | Val  Acc: 0.9737
 Site-caltech                   (4) | Val  Loss: 0.5650 | Val  Acc: 0.9057
 Site-Product                   (5) | Val  Loss: 0.4827 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.4353 | Val  Acc: 0.9231
 Site-Product                   (5) | Val  Loss: 0.4220 | Val  Acc: 1.0000
 Site-Product                   (5) | Val  Loss: 0.3537 | Val  Acc: 0.9655
 Site-Product                   (5) | Val  Loss: 0.4484 | Val  Acc: 0.9545
 Site-amazon                    (0) | Val  Loss: 0.8708 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.8195 | Val  Acc: 0.7826
 Site-amazon                    (5) | Val  Loss: 0.6458 | Val  Acc: 0.8780
 Site-webcam                    (2) | Val  Loss: 0.5295 | Val  Acc: 0.8889
 Site-webcam                    (2) | Val  Loss: 0.4245 | Val  Acc: 0.9722
 Site-Art                       (4) | Val  Loss: 0.7168 | Val  Acc: 0.8889
 Site-Clipart                   (4) | Val  Loss: 0.7745 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9331
 Best site-RealWorld                (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:26 | Val Acc: 1.0000
 Best site-RealWorld                (2)  | Epoch:26 | Val Acc: 0.8824
 Best site-RealWorld                (6)  | Epoch:26 | Val Acc: 0.9545
 Best site-RealWorld                (1)  | Epoch:26 | Val Acc: 0.9286
 Best site-RealWorld                (2)  | Epoch:26 | Val Acc: 0.9189
 Best site-RealWorld                (0)  | Epoch:26 | Val Acc: 0.9167
 Best site-RealWorld                (6)  | Epoch:26 | Val Acc: 0.9355
 Best site-caltech                  (6)  | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                  (4)  | Epoch:26 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:26 | Val Acc: 0.9500
 Best site-caltech                  (6)  | Epoch:26 | Val Acc: 0.9630
 Best site-caltech                  (6)  | Epoch:26 | Val Acc: 0.9737
 Best site-caltech                  (4)  | Epoch:26 | Val Acc: 0.9057
 Best site-Product                  (5)  | Epoch:26 | Val Acc: 0.8750
 Best site-Product                  (5)  | Epoch:26 | Val Acc: 0.9231
 Best site-Product                  (5)  | Epoch:26 | Val Acc: 1.0000
 Best site-Product                  (5)  | Epoch:26 | Val Acc: 0.9655
 Best site-Product                  (5)  | Epoch:26 | Val Acc: 0.9545
 Best site-amazon                   (0)  | Epoch:26 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:26 | Val Acc: 0.7826
 Best site-amazon                   (5)  | Epoch:26 | Val Acc: 0.8780
 Best site-webcam                   (2)  | Epoch:26 | Val Acc: 0.8889
 Best site-webcam                   (2)  | Epoch:26 | Val Acc: 0.9722
 Best site-Art                      (4)  | Epoch:26 | Val Acc: 0.8889
 Best site-Clipart                  (4)  | Epoch:26 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 2, 3, 1, 10, 7, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-RealWorld                 (0) | Train Loss: 0.5184 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.2777 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.3920 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.4251 | Train Acc: 0.8500
 Site-RealWorld                 (2) | Train Loss: 0.3918 | Train Acc: 0.8800
 Site-RealWorld                 (4) | Train Loss: 0.3357 | Train Acc: 0.9697
 Site-RealWorld                 (4) | Train Loss: 0.3542 | Train Acc: 0.9302
 Site-RealWorld                 (4) | Train Loss: 0.3925 | Train Acc: 0.9273
 Site-RealWorld                 (5) | Train Loss: 0.3047 | Train Acc: 0.9444
 Site-RealWorld                 (4) | Train Loss: 0.2841 | Train Acc: 0.9892
 Site-caltech                   (4) | Train Loss: 0.3607 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.5415 | Train Acc: 0.8667
 Site-caltech                   (4) | Train Loss: 0.3728 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.6370 | Train Acc: 0.8667
 Site-caltech                   (5) | Train Loss: 0.4121 | Train Acc: 0.9024
 Site-caltech                   (5) | Train Loss: 0.3553 | Train Acc: 0.9649
 Site-caltech                   (4) | Train Loss: 0.4570 | Train Acc: 0.9747
 Site-Product                   (5) | Train Loss: 0.3083 | Train Acc: 1.0000
 Site-Product                   (4) | Train Loss: 0.3958 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.5006 | Train Acc: 0.9310
 Site-Product                   (0) | Train Loss: 0.4084 | Train Acc: 0.9318
 Site-Product                   (0) | Train Loss: 0.5032 | Train Acc: 0.9242
 Site-amazon                    (5) | Train Loss: 0.4234 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.5444 | Train Acc: 0.8857
 Site-amazon                    (6) | Train Loss: 0.5523 | Train Acc: 0.8871
 Site-webcam                    (1) | Train Loss: 0.3686 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.3625 | Train Acc: 0.9444
 Site-Art                       (2) | Train Loss: 0.6809 | Train Acc: 0.8364
 Site-Clipart                   (5) | Train Loss: 0.7983 | Train Acc: 0.8108
Average Train Accuracy: 0.9283
 Site-RealWorld                 (0) | Val  Loss: 0.1151 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2220 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3370 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4645 | Val  Acc: 0.9231
 Site-RealWorld                 (2) | Val  Loss: 0.5711 | Val  Acc: 0.8824
 Site-RealWorld                 (4) | Val  Loss: 0.4131 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.4435 | Val  Acc: 0.8929
 Site-RealWorld                 (4) | Val  Loss: 0.4372 | Val  Acc: 0.8919
 Site-RealWorld                 (5) | Val  Loss: 0.3127 | Val  Acc: 0.9583
 Site-RealWorld                 (4) | Val  Loss: 0.3662 | Val  Acc: 0.9194
 Site-caltech                   (4) | Val  Loss: 0.3970 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2944 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.3982 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.2839 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.4072 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.4633 | Val  Acc: 0.8947
 Site-caltech                   (4) | Val  Loss: 0.4712 | Val  Acc: 0.9245
 Site-Product                   (5) | Val  Loss: 0.3312 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.4018 | Val  Acc: 0.9231
 Site-Product                   (0) | Val  Loss: 0.3746 | Val  Acc: 0.9500
 Site-Product                   (0) | Val  Loss: 0.3675 | Val  Acc: 0.9310
 Site-Product                   (0) | Val  Loss: 0.4414 | Val  Acc: 0.9318
 Site-amazon                    (5) | Val  Loss: 0.6964 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.8276 | Val  Acc: 0.7391
 Site-amazon                    (6) | Val  Loss: 0.6581 | Val  Acc: 0.8537
 Site-webcam                    (1) | Val  Loss: 0.6122 | Val  Acc: 0.8333
 Site-webcam                    (1) | Val  Loss: 0.3788 | Val  Acc: 0.9444
 Site-Art                       (2) | Val  Loss: 0.6636 | Val  Acc: 0.9444
 Site-Clipart                   (5) | Val  Loss: 0.8244 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9244
============ Train epoch 28 ============
cnt=[1, 11, 6, 2, 1, 6, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-RealWorld                 (1) | Train Loss: 0.6739 | Train Acc: 0.7778
 Site-RealWorld                 (5) | Train Loss: 0.3220 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.4602 | Train Acc: 0.8667
 Site-RealWorld                 (2) | Train Loss: 0.4369 | Train Acc: 0.9000
 Site-RealWorld                 (3) | Train Loss: 0.3337 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.3566 | Train Acc: 0.9394
 Site-RealWorld                 (1) | Train Loss: 0.3220 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.3060 | Train Acc: 0.9818
 Site-RealWorld                 (1) | Train Loss: 0.3272 | Train Acc: 0.9444
 Site-RealWorld                 (1) | Train Loss: 0.2690 | Train Acc: 0.9892
 Site-caltech                   (1) | Train Loss: 0.3173 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.4303 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.3912 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.5450 | Train Acc: 0.9000
 Site-caltech                   (5) | Train Loss: 0.4602 | Train Acc: 0.9268
 Site-caltech                   (1) | Train Loss: 0.3156 | Train Acc: 0.9825
 Site-caltech                   (5) | Train Loss: 0.4147 | Train Acc: 0.9747
 Site-Product                   (2) | Train Loss: 0.2657 | Train Acc: 1.0000
 Site-Product                   (2) | Train Loss: 0.3868 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.4520 | Train Acc: 0.9310
 Site-Product                   (2) | Train Loss: 0.4510 | Train Acc: 0.9318
 Site-Product                   (2) | Train Loss: 0.5580 | Train Acc: 0.9242
 Site-amazon                    (6) | Train Loss: 0.4023 | Train Acc: 0.8500
 Site-amazon                    (6) | Train Loss: 0.5305 | Train Acc: 0.9143
 Site-amazon                    (2) | Train Loss: 0.5296 | Train Acc: 0.8871
 Site-webcam                    (1) | Train Loss: 0.4361 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.3739 | Train Acc: 0.9259
 Site-Art                       (3) | Train Loss: 0.6965 | Train Acc: 0.8364
 Site-Clipart                   (1) | Train Loss: 0.8366 | Train Acc: 0.7838
Average Train Accuracy: 0.9295
 Site-RealWorld                 (1) | Val  Loss: 0.1050 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.1828 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.5383 | Val  Acc: 0.9000
 Site-RealWorld                 (2) | Val  Loss: 0.3238 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4468 | Val  Acc: 0.9412
 Site-RealWorld                 (1) | Val  Loss: 0.3662 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.4159 | Val  Acc: 0.9643
 Site-RealWorld                 (1) | Val  Loss: 0.3285 | Val  Acc: 0.9459
 Site-RealWorld                 (1) | Val  Loss: 0.3039 | Val  Acc: 0.9375
 Site-RealWorld                 (1) | Val  Loss: 0.4321 | Val  Acc: 0.8710
 Site-caltech                   (1) | Val  Loss: 0.3545 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.2366 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.3650 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2592 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.4335 | Val  Acc: 0.9259
 Site-caltech                   (1) | Val  Loss: 0.4603 | Val  Acc: 0.9211
 Site-caltech                   (5) | Val  Loss: 0.5036 | Val  Acc: 0.8679
 Site-Product                   (2) | Val  Loss: 0.3955 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.2904 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3836 | Val  Acc: 0.9500
 Site-Product                   (2) | Val  Loss: 0.3000 | Val  Acc: 0.9655
 Site-Product                   (2) | Val  Loss: 0.4049 | Val  Acc: 0.9318
 Site-amazon                    (6) | Val  Loss: 0.6926 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 0.7416 | Val  Acc: 0.7826
 Site-amazon                    (2) | Val  Loss: 0.6157 | Val  Acc: 0.8537
 Site-webcam                    (1) | Val  Loss: 0.4265 | Val  Acc: 0.8333
 Site-webcam                    (1) | Val  Loss: 0.4351 | Val  Acc: 0.9167
 Site-Art                       (3) | Val  Loss: 0.7197 | Val  Acc: 0.8889
 Site-Clipart                   (1) | Val  Loss: 0.9165 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9207
============ Train epoch 29 ============
cnt=[5, 7, 2, 9, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-RealWorld                 (3) | Train Loss: 0.4078 | Train Acc: 0.8889
 Site-RealWorld                 (2) | Train Loss: 0.3448 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.3500 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.3903 | Train Acc: 0.8500
 Site-RealWorld                 (6) | Train Loss: 0.3062 | Train Acc: 0.9200
 Site-RealWorld                 (3) | Train Loss: 0.2981 | Train Acc: 0.9697
 Site-RealWorld                 (3) | Train Loss: 0.3139 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.3421 | Train Acc: 0.9636
 Site-RealWorld                 (1) | Train Loss: 0.2609 | Train Acc: 0.9306
 Site-RealWorld                 (1) | Train Loss: 0.3077 | Train Acc: 0.9785
 Site-caltech                   (4) | Train Loss: 0.2852 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.4902 | Train Acc: 0.9333
 Site-caltech                   (3) | Train Loss: 0.2616 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.5383 | Train Acc: 0.9000
 Site-caltech                   (3) | Train Loss: 0.3590 | Train Acc: 0.9512
 Site-caltech                   (0) | Train Loss: 0.3026 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.3382 | Train Acc: 0.9367
 Site-Product                   (5) | Train Loss: 0.2947 | Train Acc: 1.0000
 Site-Product                   (1) | Train Loss: 0.3274 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.4293 | Train Acc: 0.9310
 Site-Product                   (0) | Train Loss: 0.4377 | Train Acc: 0.9091
 Site-Product                   (0) | Train Loss: 0.3325 | Train Acc: 0.9242
 Site-amazon                    (5) | Train Loss: 0.3850 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.4911 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.5437 | Train Acc: 0.8548
 Site-webcam                    (3) | Train Loss: 0.3446 | Train Acc: 0.9259
 Site-webcam                    (1) | Train Loss: 0.2979 | Train Acc: 0.9444
 Site-Art                       (6) | Train Loss: 0.7850 | Train Acc: 0.7818
 Site-Clipart                   (1) | Train Loss: 0.7528 | Train Acc: 0.8108
Average Train Accuracy: 0.9318
 Site-RealWorld                 (3) | Val  Loss: 0.1363 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.2178 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.4704 | Val  Acc: 0.9000
 Site-RealWorld                 (3) | Val  Loss: 0.3636 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.4161 | Val  Acc: 0.9412
 Site-RealWorld                 (3) | Val  Loss: 0.3504 | Val  Acc: 0.9091
 Site-RealWorld                 (3) | Val  Loss: 0.3846 | Val  Acc: 0.9286
 Site-RealWorld                 (1) | Val  Loss: 0.4235 | Val  Acc: 0.9189
 Site-RealWorld                 (1) | Val  Loss: 0.2880 | Val  Acc: 0.9792
 Site-RealWorld                 (1) | Val  Loss: 0.3104 | Val  Acc: 0.9677
 Site-caltech                   (4) | Val  Loss: 0.4296 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2406 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.3320 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.3085 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.4478 | Val  Acc: 0.9259
 Site-caltech                   (0) | Val  Loss: 0.4023 | Val  Acc: 0.8684
 Site-caltech                   (3) | Val  Loss: 0.4512 | Val  Acc: 0.9057
 Site-Product                   (5) | Val  Loss: 0.3143 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.3183 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3664 | Val  Acc: 0.9500
 Site-Product                   (0) | Val  Loss: 0.2748 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.4035 | Val  Acc: 0.9545
 Site-amazon                    (5) | Val  Loss: 0.7158 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.8102 | Val  Acc: 0.7826
 Site-amazon                    (0) | Val  Loss: 0.5725 | Val  Acc: 0.8293
 Site-webcam                    (3) | Val  Loss: 0.4751 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.3310 | Val  Acc: 0.9444
 Site-Art                       (6) | Val  Loss: 0.6506 | Val  Acc: 0.9167
 Site-Clipart                   (1) | Val  Loss: 0.8889 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9266
============ Train epoch 30 ============
cnt=[2, 7, 6, 3, 5, 3, 3, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-RealWorld                 (0) | Train Loss: 0.4438 | Train Acc: 0.7778
 Site-RealWorld                 (1) | Train Loss: 0.3265 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.3150 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.3375 | Train Acc: 0.9500
 Site-RealWorld                 (6) | Train Loss: 0.3228 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.2528 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.3150 | Train Acc: 0.9535
 Site-RealWorld                 (2) | Train Loss: 0.3338 | Train Acc: 0.9273
 Site-RealWorld                 (4) | Train Loss: 0.2767 | Train Acc: 0.9583
 Site-RealWorld                 (2) | Train Loss: 0.2758 | Train Acc: 0.9785
 Site-caltech                   (1) | Train Loss: 0.3674 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.4195 | Train Acc: 0.9333
 Site-caltech                   (2) | Train Loss: 0.3110 | Train Acc: 0.9524
 Site-caltech                   (4) | Train Loss: 0.5633 | Train Acc: 0.9000
 Site-caltech                   (4) | Train Loss: 0.4827 | Train Acc: 0.9024
 Site-caltech                   (4) | Train Loss: 0.3589 | Train Acc: 0.9298
 Site-caltech                   (2) | Train Loss: 0.3579 | Train Acc: 0.9747
 Site-Product                   (0) | Train Loss: 0.2936 | Train Acc: 0.9231
 Site-Product                   (5) | Train Loss: 0.3766 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.3826 | Train Acc: 0.8966
 Site-Product                   (1) | Train Loss: 0.4409 | Train Acc: 0.9091
 Site-Product                   (1) | Train Loss: 0.3183 | Train Acc: 0.9394
 Site-amazon                    (1) | Train Loss: 0.4128 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.4552 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.4945 | Train Acc: 0.8871
 Site-webcam                    (2) | Train Loss: 0.3144 | Train Acc: 1.0000
 Site-webcam                    (5) | Train Loss: 0.3539 | Train Acc: 0.9444
 Site-Art                       (5) | Train Loss: 0.6382 | Train Acc: 0.8364
 Site-Clipart                   (2) | Train Loss: 0.8226 | Train Acc: 0.7838
Average Train Accuracy: 0.9273
 Site-RealWorld                 (0) | Val  Loss: 0.1095 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2252 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3321 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.3439 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.4274 | Val  Acc: 0.9412
 Site-RealWorld                 (1) | Val  Loss: 0.4123 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.3541 | Val  Acc: 0.8929
 Site-RealWorld                 (2) | Val  Loss: 0.3833 | Val  Acc: 0.9189
 Site-RealWorld                 (4) | Val  Loss: 0.3169 | Val  Acc: 0.9375
 Site-RealWorld                 (2) | Val  Loss: 0.3081 | Val  Acc: 0.9355
 Site-caltech                   (1) | Val  Loss: 0.3795 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2682 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3004 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.2527 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.4757 | Val  Acc: 0.8889
 Site-caltech                   (4) | Val  Loss: 0.3863 | Val  Acc: 0.9474
 Site-caltech                   (2) | Val  Loss: 0.3998 | Val  Acc: 0.9245
 Site-Product                   (0) | Val  Loss: 0.3709 | Val  Acc: 0.8750
 Site-Product                   (5) | Val  Loss: 0.3580 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.3077 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.2531 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.4211 | Val  Acc: 0.9545
 Site-amazon                    (1) | Val  Loss: 0.7333 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.7335 | Val  Acc: 0.7826
 Site-amazon                    (3) | Val  Loss: 0.5641 | Val  Acc: 0.8537
 Site-webcam                    (2) | Val  Loss: 0.5614 | Val  Acc: 0.8333
 Site-webcam                    (5) | Val  Loss: 0.3649 | Val  Acc: 0.9444
 Site-Art                       (5) | Val  Loss: 0.6252 | Val  Acc: 0.8889
 Site-Clipart                   (2) | Val  Loss: 0.7857 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9277
============ Train epoch 31 ============
cnt=[1, 7, 8, 2, 1, 3, 7, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-RealWorld                 (1) | Train Loss: 0.4921 | Train Acc: 0.7778
 Site-RealWorld                 (0) | Train Loss: 0.2723 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2680 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.3802 | Train Acc: 0.9500
 Site-RealWorld                 (2) | Train Loss: 0.3291 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.2163 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.3090 | Train Acc: 0.9302
 Site-RealWorld                 (6) | Train Loss: 0.3150 | Train Acc: 0.9455
 Site-RealWorld                 (6) | Train Loss: 0.3813 | Train Acc: 0.9306
 Site-RealWorld                 (1) | Train Loss: 0.2274 | Train Acc: 0.9892
 Site-caltech                   (6) | Train Loss: 0.4306 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.4670 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.3419 | Train Acc: 0.9524
 Site-caltech                   (2) | Train Loss: 0.5098 | Train Acc: 0.8667
 Site-caltech                   (1) | Train Loss: 0.4157 | Train Acc: 0.8537
 Site-caltech                   (6) | Train Loss: 0.3248 | Train Acc: 0.9649
 Site-caltech                   (2) | Train Loss: 0.3342 | Train Acc: 0.9620
 Site-Product                   (6) | Train Loss: 0.3363 | Train Acc: 0.9231
 Site-Product                   (1) | Train Loss: 0.3182 | Train Acc: 0.9500
 Site-Product                   (5) | Train Loss: 0.4289 | Train Acc: 0.8966
 Site-Product                   (1) | Train Loss: 0.4266 | Train Acc: 0.9318
 Site-Product                   (5) | Train Loss: 0.4515 | Train Acc: 0.9394
 Site-amazon                    (3) | Train Loss: 0.4082 | Train Acc: 0.8500
 Site-amazon                    (5) | Train Loss: 0.4508 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.5020 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.2649 | Train Acc: 1.0000
 Site-webcam                    (2) | Train Loss: 0.2887 | Train Acc: 0.9630
 Site-Art                       (2) | Train Loss: 0.7420 | Train Acc: 0.8000
 Site-Clipart                   (4) | Train Loss: 0.7885 | Train Acc: 0.8378
Average Train Accuracy: 0.9283
 Site-RealWorld                 (1) | Val  Loss: 0.0877 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1335 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3359 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3007 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4939 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.3480 | Val  Acc: 0.9091
 Site-RealWorld                 (6) | Val  Loss: 0.3468 | Val  Acc: 0.9643
 Site-RealWorld                 (6) | Val  Loss: 0.3800 | Val  Acc: 0.9189
 Site-RealWorld                 (6) | Val  Loss: 0.2556 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3257 | Val  Acc: 0.9516
 Site-caltech                   (6) | Val  Loss: 0.3511 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2495 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.3265 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.3829 | Val  Acc: 0.9259
 Site-caltech                   (6) | Val  Loss: 0.3167 | Val  Acc: 0.9474
 Site-caltech                   (2) | Val  Loss: 0.4322 | Val  Acc: 0.9434
 Site-Product                   (6) | Val  Loss: 0.4083 | Val  Acc: 0.8750
 Site-Product                   (1) | Val  Loss: 0.2762 | Val  Acc: 1.0000
 Site-Product                   (5) | Val  Loss: 0.3024 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.3491 | Val  Acc: 0.8966
 Site-Product                   (5) | Val  Loss: 0.3971 | Val  Acc: 0.9545
 Site-amazon                    (3) | Val  Loss: 0.6524 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.7088 | Val  Acc: 0.7826
 Site-amazon                    (3) | Val  Loss: 0.5826 | Val  Acc: 0.8537
 Site-webcam                    (2) | Val  Loss: 0.4205 | Val  Acc: 0.8889
 Site-webcam                    (2) | Val  Loss: 0.4003 | Val  Acc: 0.8889
 Site-Art                       (2) | Val  Loss: 0.6295 | Val  Acc: 0.9167
 Site-Clipart                   (4) | Val  Loss: 0.7999 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9311
============ Train epoch 32 ============
cnt=[5, 2, 6, 8, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-RealWorld                 (3) | Train Loss: 0.4189 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.2851 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.3847 | Train Acc: 0.9333
 Site-RealWorld                 (3) | Train Loss: 0.3399 | Train Acc: 0.9500
 Site-RealWorld                 (1) | Train Loss: 0.2717 | Train Acc: 0.9600
 Site-RealWorld                 (3) | Train Loss: 0.2434 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.2293 | Train Acc: 0.9767
 Site-RealWorld                 (5) | Train Loss: 0.2919 | Train Acc: 0.9636
 Site-RealWorld                 (3) | Train Loss: 0.2182 | Train Acc: 0.9306
 Site-RealWorld                 (5) | Train Loss: 0.2190 | Train Acc: 0.9892
 Site-caltech                   (2) | Train Loss: 0.3225 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.3324 | Train Acc: 0.9333
 Site-caltech                   (5) | Train Loss: 0.2259 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.5817 | Train Acc: 0.8000
 Site-caltech                   (2) | Train Loss: 0.3508 | Train Acc: 0.9756
 Site-caltech                   (0) | Train Loss: 0.3084 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.3860 | Train Acc: 0.9620
 Site-Product                   (4) | Train Loss: 0.3638 | Train Acc: 0.9231
 Site-Product                   (3) | Train Loss: 0.2987 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.4218 | Train Acc: 0.8966
 Site-Product                   (0) | Train Loss: 0.3986 | Train Acc: 0.9318
 Site-Product                   (2) | Train Loss: 0.2284 | Train Acc: 0.9545
 Site-amazon                    (2) | Train Loss: 0.3458 | Train Acc: 0.9000
 Site-amazon                    (6) | Train Loss: 0.5015 | Train Acc: 0.8857
 Site-amazon                    (2) | Train Loss: 0.4791 | Train Acc: 0.8710
 Site-webcam                    (5) | Train Loss: 0.3392 | Train Acc: 0.9630
 Site-webcam                    (3) | Train Loss: 0.2709 | Train Acc: 0.9815
 Site-Art                       (1) | Train Loss: 0.6301 | Train Acc: 0.8364
 Site-Clipart                   (0) | Train Loss: 0.7647 | Train Acc: 0.8108
Average Train Accuracy: 0.9406
 Site-RealWorld                 (3) | Val  Loss: 0.0750 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.3178 | Val  Acc: 0.8750
 Site-RealWorld                 (3) | Val  Loss: 0.3182 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2967 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.4304 | Val  Acc: 0.8824
 Site-RealWorld                 (3) | Val  Loss: 0.3362 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.3632 | Val  Acc: 0.9286
 Site-RealWorld                 (5) | Val  Loss: 0.3568 | Val  Acc: 0.9459
 Site-RealWorld                 (3) | Val  Loss: 0.2320 | Val  Acc: 0.9792
 Site-RealWorld                 (5) | Val  Loss: 0.2905 | Val  Acc: 0.9516
 Site-caltech                   (2) | Val  Loss: 0.3666 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2247 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2514 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2015 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.4236 | Val  Acc: 0.9630
 Site-caltech                   (0) | Val  Loss: 0.4017 | Val  Acc: 0.8947
 Site-caltech                   (5) | Val  Loss: 0.4321 | Val  Acc: 0.9434
 Site-Product                   (4) | Val  Loss: 0.2533 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2054 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2994 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2032 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.3148 | Val  Acc: 0.9545
 Site-amazon                    (2) | Val  Loss: 0.7617 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 0.7368 | Val  Acc: 0.7826
 Site-amazon                    (2) | Val  Loss: 0.5166 | Val  Acc: 0.8780
 Site-webcam                    (5) | Val  Loss: 0.4789 | Val  Acc: 0.8333
 Site-webcam                    (3) | Val  Loss: 0.3098 | Val  Acc: 0.9167
 Site-Art                       (1) | Val  Loss: 0.5770 | Val  Acc: 0.9722
 Site-Clipart                   (0) | Val  Loss: 0.7373 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9384
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 0.8750
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:32 | Val Acc: 0.8824
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 0.9091
 Best site-RealWorld                (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-RealWorld                (5)  | Epoch:32 | Val Acc: 0.9459
 Best site-RealWorld                (3)  | Epoch:32 | Val Acc: 0.9792
 Best site-RealWorld                (5)  | Epoch:32 | Val Acc: 0.9516
 Best site-caltech                  (2)  | Epoch:32 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:32 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:32 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:32 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:32 | Val Acc: 0.9630
 Best site-caltech                  (0)  | Epoch:32 | Val Acc: 0.8947
 Best site-caltech                  (5)  | Epoch:32 | Val Acc: 0.9434
 Best site-Product                  (4)  | Epoch:32 | Val Acc: 1.0000
 Best site-Product                  (3)  | Epoch:32 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-Product                  (2)  | Epoch:32 | Val Acc: 0.9545
 Best site-amazon                   (2)  | Epoch:32 | Val Acc: 0.7692
 Best site-amazon                   (6)  | Epoch:32 | Val Acc: 0.7826
 Best site-amazon                   (2)  | Epoch:32 | Val Acc: 0.8780
 Best site-webcam                   (5)  | Epoch:32 | Val Acc: 0.8333
 Best site-webcam                   (3)  | Epoch:32 | Val Acc: 0.9167
 Best site-Art                      (1)  | Epoch:32 | Val Acc: 0.9722
 Best site-Clipart                  (0)  | Epoch:32 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 33 ============
cnt=[5, 13, 2, 1, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-RealWorld                 (0) | Train Loss: 0.4592 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.2372 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.3918 | Train Acc: 0.8667
 Site-RealWorld                 (3) | Train Loss: 0.3597 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.2636 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.2156 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.2584 | Train Acc: 0.9302
 Site-RealWorld                 (1) | Train Loss: 0.2850 | Train Acc: 0.9636
 Site-RealWorld                 (1) | Train Loss: 0.2187 | Train Acc: 0.9444
 Site-RealWorld                 (1) | Train Loss: 0.2365 | Train Acc: 0.9785
 Site-caltech                   (1) | Train Loss: 0.3818 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.3557 | Train Acc: 0.8667
 Site-caltech                   (1) | Train Loss: 0.2618 | Train Acc: 0.9524
 Site-caltech                   (1) | Train Loss: 0.4729 | Train Acc: 0.9000
 Site-caltech                   (4) | Train Loss: 0.3934 | Train Acc: 0.9268
 Site-caltech                   (1) | Train Loss: 0.3089 | Train Acc: 0.9649
 Site-caltech                   (1) | Train Loss: 0.3090 | Train Acc: 0.9747
 Site-Product                   (0) | Train Loss: 0.2938 | Train Acc: 0.9231
 Site-Product                   (6) | Train Loss: 0.3120 | Train Acc: 1.0000
 Site-Product                   (0) | Train Loss: 0.4858 | Train Acc: 0.9310
 Site-Product                   (4) | Train Loss: 0.3216 | Train Acc: 0.9318
 Site-Product                   (6) | Train Loss: 0.2572 | Train Acc: 0.9242
 Site-amazon                    (4) | Train Loss: 0.3987 | Train Acc: 0.9000
 Site-amazon                    (4) | Train Loss: 0.4366 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.4693 | Train Acc: 0.8871
 Site-webcam                    (1) | Train Loss: 0.2648 | Train Acc: 0.9259
 Site-webcam                    (5) | Train Loss: 0.2946 | Train Acc: 0.9630
 Site-Art                       (1) | Train Loss: 0.6672 | Train Acc: 0.8364
 Site-Clipart                   (1) | Train Loss: 0.7903 | Train Acc: 0.8378
Average Train Accuracy: 0.9294
 Site-RealWorld                 (0) | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2472 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3102 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2762 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.4638 | Val  Acc: 0.8824
 Site-RealWorld                 (1) | Val  Loss: 0.2860 | Val  Acc: 0.9545
 Site-RealWorld                 (5) | Val  Loss: 0.4259 | Val  Acc: 0.8571
 Site-RealWorld                 (1) | Val  Loss: 0.3472 | Val  Acc: 0.9459
 Site-RealWorld                 (1) | Val  Loss: 0.2408 | Val  Acc: 0.9583
 Site-RealWorld                 (1) | Val  Loss: 0.3028 | Val  Acc: 0.9194
 Site-caltech                   (1) | Val  Loss: 0.3253 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2009 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2632 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2267 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.3296 | Val  Acc: 0.9630
 Site-caltech                   (1) | Val  Loss: 0.3890 | Val  Acc: 0.8947
 Site-caltech                   (1) | Val  Loss: 0.4779 | Val  Acc: 0.8491
 Site-Product                   (0) | Val  Loss: 0.2830 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.2539 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.3014 | Val  Acc: 0.9000
 Site-Product                   (4) | Val  Loss: 0.2578 | Val  Acc: 0.9655
 Site-Product                   (6) | Val  Loss: 0.3690 | Val  Acc: 0.9318
 Site-amazon                    (4) | Val  Loss: 0.6367 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.6981 | Val  Acc: 0.7826
 Site-amazon                    (0) | Val  Loss: 0.5485 | Val  Acc: 0.8780
 Site-webcam                    (1) | Val  Loss: 0.4258 | Val  Acc: 0.8333
 Site-webcam                    (5) | Val  Loss: 0.3227 | Val  Acc: 0.9444
 Site-Art                       (1) | Val  Loss: 0.6227 | Val  Acc: 0.8889
 Site-Clipart                   (1) | Val  Loss: 0.6889 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9294
============ Train epoch 34 ============
cnt=[2, 7, 5, 1, 2, 9, 3, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-RealWorld                 (1) | Train Loss: 0.4011 | Train Acc: 0.7778
 Site-RealWorld                 (4) | Train Loss: 0.2136 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2030 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2836 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.2764 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.2412 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2585 | Train Acc: 0.9535
 Site-RealWorld                 (1) | Train Loss: 0.2652 | Train Acc: 0.9636
 Site-RealWorld                 (1) | Train Loss: 0.3935 | Train Acc: 0.9306
 Site-RealWorld                 (6) | Train Loss: 0.2002 | Train Acc: 0.9785
 Site-caltech                   (5) | Train Loss: 0.3681 | Train Acc: 0.9091
 Site-caltech                   (5) | Train Loss: 0.3666 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.2387 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.5494 | Train Acc: 0.8333
 Site-caltech                   (5) | Train Loss: 0.4046 | Train Acc: 0.9268
 Site-caltech                   (5) | Train Loss: 0.3177 | Train Acc: 0.9474
 Site-caltech                   (1) | Train Loss: 0.2509 | Train Acc: 0.9747
 Site-Product                   (4) | Train Loss: 0.2387 | Train Acc: 1.0000
 Site-Product                   (0) | Train Loss: 0.3311 | Train Acc: 0.9000
 Site-Product                   (5) | Train Loss: 0.3737 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.2853 | Train Acc: 0.9545
 Site-Product                   (5) | Train Loss: 0.1943 | Train Acc: 0.9394
 Site-amazon                    (5) | Train Loss: 0.4400 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.4550 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.4592 | Train Acc: 0.8548
 Site-webcam                    (5) | Train Loss: 0.2339 | Train Acc: 1.0000
 Site-webcam                    (2) | Train Loss: 0.2446 | Train Acc: 0.9259
 Site-Art                       (2) | Train Loss: 0.5690 | Train Acc: 0.8545
 Site-Clipart                   (3) | Train Loss: 0.7190 | Train Acc: 0.8378
Average Train Accuracy: 0.9320
 Site-RealWorld                 (1) | Val  Loss: 0.0742 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2522 | Val  Acc: 0.8750
 Site-RealWorld                 (2) | Val  Loss: 0.4236 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3196 | Val  Acc: 0.9231
 Site-RealWorld                 (2) | Val  Loss: 0.3752 | Val  Acc: 0.8824
 Site-RealWorld                 (1) | Val  Loss: 0.2417 | Val  Acc: 0.9545
 Site-RealWorld                 (1) | Val  Loss: 0.3083 | Val  Acc: 0.8929
 Site-RealWorld                 (1) | Val  Loss: 0.3356 | Val  Acc: 0.9459
 Site-RealWorld                 (1) | Val  Loss: 0.2239 | Val  Acc: 0.9792
 Site-RealWorld                 (6) | Val  Loss: 0.3081 | Val  Acc: 0.9194
 Site-caltech                   (5) | Val  Loss: 0.3876 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.1889 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.2001 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.1969 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.3208 | Val  Acc: 0.9630
 Site-caltech                   (5) | Val  Loss: 0.3404 | Val  Acc: 0.8947
 Site-caltech                   (1) | Val  Loss: 0.4281 | Val  Acc: 0.9057
 Site-Product                   (4) | Val  Loss: 0.2513 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2390 | Val  Acc: 1.0000
 Site-Product                   (5) | Val  Loss: 0.2718 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.2707 | Val  Acc: 0.9310
 Site-Product                   (5) | Val  Loss: 0.3223 | Val  Acc: 0.9773
 Site-amazon                    (5) | Val  Loss: 0.6378 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.6751 | Val  Acc: 0.8261
 Site-amazon                    (0) | Val  Loss: 0.5039 | Val  Acc: 0.8537
 Site-webcam                    (5) | Val  Loss: 0.4003 | Val  Acc: 0.8333
 Site-webcam                    (2) | Val  Loss: 0.2757 | Val  Acc: 0.9444
 Site-Art                       (2) | Val  Loss: 0.5807 | Val  Acc: 0.9167
 Site-Clipart                   (3) | Val  Loss: 0.7678 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9317
============ Train epoch 35 ============
cnt=[1, 3, 9, 6, 1, 4, 5, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-RealWorld                 (4) | Train Loss: 0.5261 | Train Acc: 0.8889
 Site-RealWorld                 (6) | Train Loss: 0.2149 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.3291 | Train Acc: 0.9333
 Site-RealWorld                 (3) | Train Loss: 0.2858 | Train Acc: 0.9500
 Site-RealWorld                 (3) | Train Loss: 0.2900 | Train Acc: 0.9200
 Site-RealWorld                 (2) | Train Loss: 0.1909 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2829 | Train Acc: 0.9302
 Site-RealWorld                 (2) | Train Loss: 0.3081 | Train Acc: 0.9455
 Site-RealWorld                 (2) | Train Loss: 0.1769 | Train Acc: 0.9167
 Site-RealWorld                 (2) | Train Loss: 0.1937 | Train Acc: 0.9892
 Site-caltech                   (0) | Train Loss: 0.2066 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.3236 | Train Acc: 0.9333
 Site-caltech                   (3) | Train Loss: 0.1973 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.4564 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.3687 | Train Acc: 0.9024
 Site-caltech                   (5) | Train Loss: 0.2540 | Train Acc: 0.9825
 Site-caltech                   (2) | Train Loss: 0.3571 | Train Acc: 0.9620
 Site-Product                   (1) | Train Loss: 0.1926 | Train Acc: 1.0000
 Site-Product                   (2) | Train Loss: 0.3078 | Train Acc: 0.9500
 Site-Product                   (6) | Train Loss: 0.3920 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.3412 | Train Acc: 0.9318
 Site-Product                   (6) | Train Loss: 0.2154 | Train Acc: 0.9545
 Site-amazon                    (6) | Train Loss: 0.3084 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.4055 | Train Acc: 0.9429
 Site-amazon                    (6) | Train Loss: 0.4610 | Train Acc: 0.8710
 Site-webcam                    (3) | Train Loss: 0.2395 | Train Acc: 0.9630
 Site-webcam                    (3) | Train Loss: 0.2477 | Train Acc: 0.9444
 Site-Art                       (2) | Train Loss: 0.5725 | Train Acc: 0.8545
 Site-Clipart                   (2) | Train Loss: 0.7795 | Train Acc: 0.8378
Average Train Accuracy: 0.9403
 Site-RealWorld                 (4) | Val  Loss: 0.0599 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1829 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2269 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2478 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.4217 | Val  Acc: 0.8824
 Site-RealWorld                 (2) | Val  Loss: 0.3090 | Val  Acc: 0.9091
 Site-RealWorld                 (2) | Val  Loss: 0.2637 | Val  Acc: 0.9643
 Site-RealWorld                 (2) | Val  Loss: 0.2419 | Val  Acc: 0.9459
 Site-RealWorld                 (2) | Val  Loss: 0.2332 | Val  Acc: 0.9583
 Site-RealWorld                 (2) | Val  Loss: 0.2991 | Val  Acc: 0.9194
 Site-caltech                   (0) | Val  Loss: 0.3157 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2097 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2121 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2365 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.3092 | Val  Acc: 0.9630
 Site-caltech                   (5) | Val  Loss: 0.3893 | Val  Acc: 0.9211
 Site-caltech                   (2) | Val  Loss: 0.3915 | Val  Acc: 0.9057
 Site-Product                   (1) | Val  Loss: 0.2521 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.1960 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.2394 | Val  Acc: 0.9500
 Site-Product                   (1) | Val  Loss: 0.1989 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.3641 | Val  Acc: 0.9545
 Site-amazon                    (6) | Val  Loss: 0.6959 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.7038 | Val  Acc: 0.7826
 Site-amazon                    (6) | Val  Loss: 0.4853 | Val  Acc: 0.8537
 Site-webcam                    (3) | Val  Loss: 0.5376 | Val  Acc: 0.8333
 Site-webcam                    (3) | Val  Loss: 0.3217 | Val  Acc: 0.9167
 Site-Art                       (2) | Val  Loss: 0.5324 | Val  Acc: 0.9444
 Site-Clipart                   (2) | Val  Loss: 0.6102 | Val  Acc: 0.8750
Average Valid Accuracy: 0.9396
 Best site-RealWorld                (4)  | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                (6)  | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:35 | Val Acc: 1.0000
 Best site-RealWorld                (3)  | Epoch:35 | Val Acc: 0.8824
 Best site-RealWorld                (2)  | Epoch:35 | Val Acc: 0.9091
 Best site-RealWorld                (2)  | Epoch:35 | Val Acc: 0.9643
 Best site-RealWorld                (2)  | Epoch:35 | Val Acc: 0.9459
 Best site-RealWorld                (2)  | Epoch:35 | Val Acc: 0.9583
 Best site-RealWorld                (2)  | Epoch:35 | Val Acc: 0.9194
 Best site-caltech                  (0)  | Epoch:35 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:35 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:35 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:35 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:35 | Val Acc: 0.9630
 Best site-caltech                  (5)  | Epoch:35 | Val Acc: 0.9211
 Best site-caltech                  (2)  | Epoch:35 | Val Acc: 0.9057
 Best site-Product                  (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-Product                  (2)  | Epoch:35 | Val Acc: 1.0000
 Best site-Product                  (6)  | Epoch:35 | Val Acc: 0.9500
 Best site-Product                  (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-Product                  (6)  | Epoch:35 | Val Acc: 0.9545
 Best site-amazon                   (6)  | Epoch:35 | Val Acc: 0.7692
 Best site-amazon                   (5)  | Epoch:35 | Val Acc: 0.7826
 Best site-amazon                   (6)  | Epoch:35 | Val Acc: 0.8537
 Best site-webcam                   (3)  | Epoch:35 | Val Acc: 0.8333
 Best site-webcam                   (3)  | Epoch:35 | Val Acc: 0.9167
 Best site-Art                      (2)  | Epoch:35 | Val Acc: 0.9444
 Best site-Clipart                  (2)  | Epoch:35 | Val Acc: 0.8750
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 36 ============
cnt=[10, 7, 3, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-RealWorld                 (5) | Train Loss: 0.4301 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.1525 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.3112 | Train Acc: 0.9333
 Site-RealWorld                 (6) | Train Loss: 0.3075 | Train Acc: 0.9000
 Site-RealWorld                 (6) | Train Loss: 0.3136 | Train Acc: 0.8800
 Site-RealWorld                 (1) | Train Loss: 0.2129 | Train Acc: 0.9697
 Site-RealWorld                 (0) | Train Loss: 0.2253 | Train Acc: 0.9535
 Site-RealWorld                 (0) | Train Loss: 0.2531 | Train Acc: 0.9636
 Site-RealWorld                 (0) | Train Loss: 0.3339 | Train Acc: 0.9306
 Site-RealWorld                 (0) | Train Loss: 0.2064 | Train Acc: 0.9785
 Site-caltech                   (4) | Train Loss: 0.2427 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.2612 | Train Acc: 0.9333
 Site-caltech                   (0) | Train Loss: 0.2415 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.4886 | Train Acc: 0.8667
 Site-caltech                   (1) | Train Loss: 0.3739 | Train Acc: 0.8780
 Site-caltech                   (1) | Train Loss: 0.2521 | Train Acc: 0.9825
 Site-caltech                   (1) | Train Loss: 0.2929 | Train Acc: 0.9620
 Site-Product                   (1) | Train Loss: 0.2537 | Train Acc: 0.9231
 Site-Product                   (2) | Train Loss: 0.2846 | Train Acc: 0.9500
 Site-Product                   (4) | Train Loss: 0.3591 | Train Acc: 0.9310
 Site-Product                   (1) | Train Loss: 0.2171 | Train Acc: 1.0000
 Site-Product                   (1) | Train Loss: 0.2473 | Train Acc: 0.9394
 Site-amazon                    (0) | Train Loss: 0.3360 | Train Acc: 0.9000
 Site-amazon                    (2) | Train Loss: 0.4176 | Train Acc: 0.9143
 Site-amazon                    (4) | Train Loss: 0.4783 | Train Acc: 0.8710
 Site-webcam                    (0) | Train Loss: 0.2768 | Train Acc: 0.9630
 Site-webcam                    (6) | Train Loss: 0.2650 | Train Acc: 0.9444
 Site-Art                       (6) | Train Loss: 0.5831 | Train Acc: 0.9091
 Site-Clipart                   (0) | Train Loss: 0.6814 | Train Acc: 0.8378
Average Train Accuracy: 0.9346
 Site-RealWorld                 (5) | Val  Loss: 0.0702 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2040 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.3488 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.2741 | Val  Acc: 0.9231
 Site-RealWorld                 (6) | Val  Loss: 0.3932 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.2382 | Val  Acc: 0.9545
 Site-RealWorld                 (0) | Val  Loss: 0.2935 | Val  Acc: 0.9286
 Site-RealWorld                 (0) | Val  Loss: 0.2766 | Val  Acc: 0.9189
 Site-RealWorld                 (0) | Val  Loss: 0.2156 | Val  Acc: 0.9792
 Site-RealWorld                 (0) | Val  Loss: 0.2733 | Val  Acc: 0.9355
 Site-caltech                   (4) | Val  Loss: 0.3347 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2093 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2871 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1766 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2589 | Val  Acc: 0.9630
 Site-caltech                   (1) | Val  Loss: 0.3428 | Val  Acc: 0.9211
 Site-caltech                   (1) | Val  Loss: 0.3818 | Val  Acc: 0.9245
 Site-Product                   (1) | Val  Loss: 0.2760 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.3023 | Val  Acc: 0.9231
 Site-Product                   (4) | Val  Loss: 0.2412 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.2429 | Val  Acc: 0.9310
 Site-Product                   (1) | Val  Loss: 0.3201 | Val  Acc: 0.9318
 Site-amazon                    (0) | Val  Loss: 0.6991 | Val  Acc: 0.7692
 Site-amazon                    (2) | Val  Loss: 0.6780 | Val  Acc: 0.8261
 Site-amazon                    (4) | Val  Loss: 0.4506 | Val  Acc: 0.8780
 Site-webcam                    (0) | Val  Loss: 0.4062 | Val  Acc: 0.8889
 Site-webcam                    (6) | Val  Loss: 0.3478 | Val  Acc: 0.9444
 Site-Art                       (6) | Val  Loss: 0.5798 | Val  Acc: 0.9444
 Site-Clipart                   (0) | Val  Loss: 0.7100 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9316
============ Train epoch 37 ============
cnt=[7, 3, 3, 5, 2, 1, 8, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-RealWorld                 (0) | Train Loss: 0.2718 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2065 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.3185 | Train Acc: 0.9333
 Site-RealWorld                 (6) | Train Loss: 0.2870 | Train Acc: 0.9500
 Site-RealWorld                 (5) | Train Loss: 0.2734 | Train Acc: 0.8800
 Site-RealWorld                 (0) | Train Loss: 0.2225 | Train Acc: 0.9697
 Site-RealWorld                 (6) | Train Loss: 0.2069 | Train Acc: 0.9535
 Site-RealWorld                 (0) | Train Loss: 0.3207 | Train Acc: 0.9273
 Site-RealWorld                 (3) | Train Loss: 0.1682 | Train Acc: 0.9444
 Site-RealWorld                 (6) | Train Loss: 0.1984 | Train Acc: 0.9785
 Site-caltech                   (6) | Train Loss: 0.3484 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.3334 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.1720 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.4549 | Train Acc: 0.9000
 Site-caltech                   (6) | Train Loss: 0.3440 | Train Acc: 0.9268
 Site-caltech                   (6) | Train Loss: 0.2584 | Train Acc: 0.9825
 Site-caltech                   (6) | Train Loss: 0.3013 | Train Acc: 0.9747
 Site-Product                   (2) | Train Loss: 0.2600 | Train Acc: 0.9231
 Site-Product                   (3) | Train Loss: 0.2978 | Train Acc: 0.9500
 Site-Product                   (1) | Train Loss: 0.3229 | Train Acc: 0.9655
 Site-Product                   (2) | Train Loss: 0.2632 | Train Acc: 0.9545
 Site-Product                   (4) | Train Loss: 0.2005 | Train Acc: 0.9394
 Site-amazon                    (1) | Train Loss: 0.2732 | Train Acc: 0.9000
 Site-amazon                    (1) | Train Loss: 0.3999 | Train Acc: 0.9143
 Site-amazon                    (4) | Train Loss: 0.4498 | Train Acc: 0.8387
 Site-webcam                    (0) | Train Loss: 0.3112 | Train Acc: 0.9630
 Site-webcam                    (0) | Train Loss: 0.2100 | Train Acc: 0.9630
 Site-Art                       (3) | Train Loss: 0.5327 | Train Acc: 0.9273
 Site-Clipart                   (0) | Train Loss: 0.7310 | Train Acc: 0.7838
Average Train Accuracy: 0.9429
 Site-RealWorld                 (0) | Val  Loss: 0.0688 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.2565 | Val  Acc: 0.8750
 Site-RealWorld                 (3) | Val  Loss: 0.3924 | Val  Acc: 0.9000
 Site-RealWorld                 (6) | Val  Loss: 0.3417 | Val  Acc: 0.8462
 Site-RealWorld                 (5) | Val  Loss: 0.3945 | Val  Acc: 0.8235
 Site-RealWorld                 (0) | Val  Loss: 0.3251 | Val  Acc: 0.9091
 Site-RealWorld                 (6) | Val  Loss: 0.3028 | Val  Acc: 0.9643
 Site-RealWorld                 (0) | Val  Loss: 0.3985 | Val  Acc: 0.8649
 Site-RealWorld                 (3) | Val  Loss: 0.2203 | Val  Acc: 0.9583
 Site-RealWorld                 (6) | Val  Loss: 0.2664 | Val  Acc: 0.9355
 Site-caltech                   (6) | Val  Loss: 0.3347 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.1894 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1835 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2078 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.2781 | Val  Acc: 0.9259
 Site-caltech                   (6) | Val  Loss: 0.3031 | Val  Acc: 0.9737
 Site-caltech                   (6) | Val  Loss: 0.4375 | Val  Acc: 0.9057
 Site-Product                   (2) | Val  Loss: 0.2874 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.1844 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.2732 | Val  Acc: 0.9500
 Site-Product                   (2) | Val  Loss: 0.2638 | Val  Acc: 0.9655
 Site-Product                   (4) | Val  Loss: 0.2752 | Val  Acc: 0.9773
 Site-amazon                    (1) | Val  Loss: 0.7151 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.6148 | Val  Acc: 0.7826
 Site-amazon                    (4) | Val  Loss: 0.4658 | Val  Acc: 0.8780
 Site-webcam                    (0) | Val  Loss: 0.3726 | Val  Acc: 0.8333
 Site-webcam                    (0) | Val  Loss: 0.2529 | Val  Acc: 0.9722
 Site-Art                       (3) | Val  Loss: 0.5014 | Val  Acc: 0.9722
 Site-Clipart                   (0) | Val  Loss: 0.7398 | Val  Acc: 0.7500
Average Valid Accuracy: 0.9218
============ Train epoch 38 ============
cnt=[3, 10, 8, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-RealWorld                 (5) | Train Loss: 0.3355 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.1783 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2059 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.3140 | Train Acc: 0.9000
 Site-RealWorld                 (1) | Train Loss: 0.2467 | Train Acc: 0.9200
 Site-RealWorld                 (1) | Train Loss: 0.1948 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2041 | Train Acc: 0.9767
 Site-RealWorld                 (1) | Train Loss: 0.3088 | Train Acc: 0.9273
 Site-RealWorld                 (1) | Train Loss: 0.2074 | Train Acc: 0.9444
 Site-RealWorld                 (2) | Train Loss: 0.2045 | Train Acc: 0.9892
 Site-caltech                   (2) | Train Loss: 0.2346 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.3419 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.1662 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.4207 | Train Acc: 0.9000
 Site-caltech                   (0) | Train Loss: 0.2725 | Train Acc: 0.9268
 Site-caltech                   (2) | Train Loss: 0.2611 | Train Acc: 0.9825
 Site-caltech                   (2) | Train Loss: 0.2594 | Train Acc: 0.9620
 Site-Product                   (3) | Train Loss: 0.2324 | Train Acc: 1.0000
 Site-Product                   (2) | Train Loss: 0.2092 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.3423 | Train Acc: 0.9310
 Site-Product                   (3) | Train Loss: 0.3005 | Train Acc: 0.9545
 Site-Product                   (0) | Train Loss: 0.4803 | Train Acc: 0.9545
 Site-amazon                    (2) | Train Loss: 0.3390 | Train Acc: 0.8500
 Site-amazon                    (3) | Train Loss: 0.4363 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.4535 | Train Acc: 0.8710
 Site-webcam                    (1) | Train Loss: 0.2345 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.2375 | Train Acc: 0.9444
 Site-Art                       (1) | Train Loss: 0.5105 | Train Acc: 0.8909
 Site-Clipart                   (5) | Train Loss: 0.6505 | Train Acc: 0.8378
Average Train Accuracy: 0.9474
 Site-RealWorld                 (5) | Val  Loss: 0.0626 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1493 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3215 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3898 | Val  Acc: 0.8462
 Site-RealWorld                 (1) | Val  Loss: 0.4380 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.2569 | Val  Acc: 0.9091
 Site-RealWorld                 (2) | Val  Loss: 0.2289 | Val  Acc: 0.9286
 Site-RealWorld                 (1) | Val  Loss: 0.2120 | Val  Acc: 0.9459
 Site-RealWorld                 (1) | Val  Loss: 0.1750 | Val  Acc: 0.9792
 Site-RealWorld                 (2) | Val  Loss: 0.2604 | Val  Acc: 0.9355
 Site-caltech                   (2) | Val  Loss: 0.2555 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1879 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2004 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1896 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2260 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3520 | Val  Acc: 0.9211
 Site-caltech                   (2) | Val  Loss: 0.3811 | Val  Acc: 0.8491
 Site-Product                   (3) | Val  Loss: 0.2893 | Val  Acc: 0.8750
 Site-Product                   (2) | Val  Loss: 0.2630 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2111 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2031 | Val  Acc: 0.9655
 Site-Product                   (0) | Val  Loss: 0.2826 | Val  Acc: 0.9545
 Site-amazon                    (2) | Val  Loss: 0.5741 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.7195 | Val  Acc: 0.7826
 Site-amazon                    (0) | Val  Loss: 0.4793 | Val  Acc: 0.8780
 Site-webcam                    (1) | Val  Loss: 0.3607 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.2485 | Val  Acc: 0.9444
 Site-Art                       (1) | Val  Loss: 0.5650 | Val  Acc: 0.9722
 Site-Clipart                   (5) | Val  Loss: 0.6152 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9311
============ Train epoch 39 ============
cnt=[2, 4, 9, 3, 3, 4, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-RealWorld                 (3) | Train Loss: 0.3590 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.2017 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.1582 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2865 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.2197 | Train Acc: 0.9600
 Site-RealWorld                 (1) | Train Loss: 0.1619 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.1909 | Train Acc: 0.9535
 Site-RealWorld                 (2) | Train Loss: 0.2276 | Train Acc: 0.9818
 Site-RealWorld                 (3) | Train Loss: 0.3655 | Train Acc: 0.9583
 Site-RealWorld                 (2) | Train Loss: 0.1778 | Train Acc: 0.9892
 Site-caltech                   (2) | Train Loss: 0.2593 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.3872 | Train Acc: 0.8667
 Site-caltech                   (2) | Train Loss: 0.2521 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.4264 | Train Acc: 0.9333
 Site-caltech                   (2) | Train Loss: 0.2916 | Train Acc: 0.9268
 Site-caltech                   (6) | Train Loss: 0.2584 | Train Acc: 0.9649
 Site-caltech                   (2) | Train Loss: 0.2520 | Train Acc: 0.9620
 Site-Product                   (5) | Train Loss: 0.1799 | Train Acc: 1.0000
 Site-Product                   (6) | Train Loss: 0.2586 | Train Acc: 0.9500
 Site-Product                   (5) | Train Loss: 0.3248 | Train Acc: 0.9310
 Site-Product                   (5) | Train Loss: 0.3339 | Train Acc: 0.9091
 Site-Product                   (2) | Train Loss: 0.1892 | Train Acc: 0.9545
 Site-amazon                    (0) | Train Loss: 0.2711 | Train Acc: 0.9000
 Site-amazon                    (5) | Train Loss: 0.4297 | Train Acc: 0.9143
 Site-amazon                    (2) | Train Loss: 0.4392 | Train Acc: 0.8548
 Site-webcam                    (1) | Train Loss: 0.2154 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.2941 | Train Acc: 0.9259
 Site-Art                       (4) | Train Loss: 0.5201 | Train Acc: 0.8727
 Site-Clipart                   (2) | Train Loss: 0.7047 | Train Acc: 0.8108
Average Train Accuracy: 0.9439
 Site-RealWorld                 (3) | Val  Loss: 0.0684 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1185 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2717 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2098 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3816 | Val  Acc: 0.8235
 Site-RealWorld                 (1) | Val  Loss: 0.2453 | Val  Acc: 0.9545
 Site-RealWorld                 (6) | Val  Loss: 0.2708 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.2794 | Val  Acc: 0.9730
 Site-RealWorld                 (3) | Val  Loss: 0.2216 | Val  Acc: 0.9583
 Site-RealWorld                 (2) | Val  Loss: 0.2362 | Val  Acc: 0.9355
 Site-caltech                   (2) | Val  Loss: 0.3142 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.1867 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1904 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2150 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3071 | Val  Acc: 0.9630
 Site-caltech                   (6) | Val  Loss: 0.3065 | Val  Acc: 0.9474
 Site-caltech                   (2) | Val  Loss: 0.4000 | Val  Acc: 0.9057
 Site-Product                   (5) | Val  Loss: 0.1933 | Val  Acc: 1.0000
 Site-Product                   (6) | Val  Loss: 0.1974 | Val  Acc: 1.0000
 Site-Product                   (5) | Val  Loss: 0.2935 | Val  Acc: 0.9000
 Site-Product                   (5) | Val  Loss: 0.1470 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.2746 | Val  Acc: 0.9773
 Site-amazon                    (0) | Val  Loss: 0.6927 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.6523 | Val  Acc: 0.7826
 Site-amazon                    (2) | Val  Loss: 0.4539 | Val  Acc: 0.8537
 Site-webcam                    (1) | Val  Loss: 0.3326 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.2524 | Val  Acc: 0.9444
 Site-Art                       (4) | Val  Loss: 0.5820 | Val  Acc: 0.9167
 Site-Clipart                   (2) | Val  Loss: 0.6315 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9398
 Best site-RealWorld                (3)  | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:39 | Val Acc: 0.8235
 Best site-RealWorld                (1)  | Epoch:39 | Val Acc: 0.9545
 Best site-RealWorld                (6)  | Epoch:39 | Val Acc: 0.9286
 Best site-RealWorld                (2)  | Epoch:39 | Val Acc: 0.9730
 Best site-RealWorld                (3)  | Epoch:39 | Val Acc: 0.9583
 Best site-RealWorld                (2)  | Epoch:39 | Val Acc: 0.9355
 Best site-caltech                  (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                  (6)  | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:39 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:39 | Val Acc: 0.9630
 Best site-caltech                  (6)  | Epoch:39 | Val Acc: 0.9474
 Best site-caltech                  (2)  | Epoch:39 | Val Acc: 0.9057
 Best site-Product                  (5)  | Epoch:39 | Val Acc: 1.0000
 Best site-Product                  (6)  | Epoch:39 | Val Acc: 1.0000
 Best site-Product                  (5)  | Epoch:39 | Val Acc: 0.9000
 Best site-Product                  (5)  | Epoch:39 | Val Acc: 1.0000
 Best site-Product                  (2)  | Epoch:39 | Val Acc: 0.9773
 Best site-amazon                   (0)  | Epoch:39 | Val Acc: 0.7692
 Best site-amazon                   (5)  | Epoch:39 | Val Acc: 0.7826
 Best site-amazon                   (2)  | Epoch:39 | Val Acc: 0.8537
 Best site-webcam                   (1)  | Epoch:39 | Val Acc: 0.8889
 Best site-webcam                   (1)  | Epoch:39 | Val Acc: 0.9444
 Best site-Art                      (4)  | Epoch:39 | Val Acc: 0.9167
 Best site-Clipart                  (2)  | Epoch:39 | Val Acc: 0.8333
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 40 ============
cnt=[7, 1, 6, 5, 4, 1, 5, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-RealWorld                 (0) | Train Loss: 0.4152 | Train Acc: 0.7778
 Site-RealWorld                 (6) | Train Loss: 0.1838 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2598 | Train Acc: 0.9333
 Site-RealWorld                 (0) | Train Loss: 0.2626 | Train Acc: 0.9500
 Site-RealWorld                 (0) | Train Loss: 0.3482 | Train Acc: 0.8400
 Site-RealWorld                 (2) | Train Loss: 0.1390 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.2386 | Train Acc: 0.9535
 Site-RealWorld                 (2) | Train Loss: 0.2598 | Train Acc: 0.9455
 Site-RealWorld                 (4) | Train Loss: 0.2605 | Train Acc: 0.9306
 Site-RealWorld                 (4) | Train Loss: 0.1864 | Train Acc: 0.9570
 Site-caltech                   (0) | Train Loss: 0.2631 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.3348 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.2591 | Train Acc: 0.9524
 Site-caltech                   (0) | Train Loss: 0.3837 | Train Acc: 0.9667
 Site-caltech                   (6) | Train Loss: 0.3840 | Train Acc: 0.8537
 Site-caltech                   (6) | Train Loss: 0.2579 | Train Acc: 0.9649
 Site-caltech                   (6) | Train Loss: 0.2137 | Train Acc: 0.9873
 Site-Product                   (3) | Train Loss: 0.2780 | Train Acc: 0.9231
 Site-Product                   (2) | Train Loss: 0.3042 | Train Acc: 0.9000
 Site-Product                   (1) | Train Loss: 0.4077 | Train Acc: 0.8966
 Site-Product                   (4) | Train Loss: 0.3006 | Train Acc: 0.9773
 Site-Product                   (3) | Train Loss: 0.5143 | Train Acc: 0.9242
 Site-amazon                    (3) | Train Loss: 0.2946 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.3647 | Train Acc: 0.8857
 Site-amazon                    (3) | Train Loss: 0.3869 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.2379 | Train Acc: 0.9259
 Site-webcam                    (0) | Train Loss: 0.2050 | Train Acc: 0.9630
 Site-Art                       (0) | Train Loss: 0.5377 | Train Acc: 0.8545
 Site-Clipart                   (2) | Train Loss: 0.6824 | Train Acc: 0.8108
Average Train Accuracy: 0.9257
 Site-RealWorld                 (0) | Val  Loss: 0.0610 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1123 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.2619 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2222 | Val  Acc: 0.9231
 Site-RealWorld                 (0) | Val  Loss: 0.4364 | Val  Acc: 0.7647
 Site-RealWorld                 (2) | Val  Loss: 0.2768 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.2722 | Val  Acc: 0.9643
 Site-RealWorld                 (2) | Val  Loss: 0.3028 | Val  Acc: 0.9459
 Site-RealWorld                 (4) | Val  Loss: 0.2101 | Val  Acc: 0.9583
 Site-RealWorld                 (4) | Val  Loss: 0.2218 | Val  Acc: 0.9677
 Site-caltech                   (0) | Val  Loss: 0.2450 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.1869 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.2364 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1966 | Val  Acc: 0.9500
 Site-caltech                   (6) | Val  Loss: 0.2829 | Val  Acc: 0.9630
 Site-caltech                   (6) | Val  Loss: 0.3084 | Val  Acc: 0.9211
 Site-caltech                   (6) | Val  Loss: 0.3972 | Val  Acc: 0.9057
 Site-Product                   (3) | Val  Loss: 0.2288 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.2372 | Val  Acc: 0.9231
 Site-Product                   (1) | Val  Loss: 0.2440 | Val  Acc: 0.9500
 Site-Product                   (4) | Val  Loss: 0.2222 | Val  Acc: 0.9310
 Site-Product                   (3) | Val  Loss: 0.3461 | Val  Acc: 0.9545
 Site-amazon                    (3) | Val  Loss: 0.6229 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.6687 | Val  Acc: 0.8261
 Site-amazon                    (3) | Val  Loss: 0.4383 | Val  Acc: 0.8780
 Site-webcam                    (2) | Val  Loss: 0.3415 | Val  Acc: 0.8889
 Site-webcam                    (0) | Val  Loss: 0.4096 | Val  Acc: 0.8611
 Site-Art                       (0) | Val  Loss: 0.4915 | Val  Acc: 0.9444
 Site-Clipart                   (2) | Val  Loss: 0.7004 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9273
 Test site-RealWorld                 (0)| Epoch:39 | Test Acc: 0.9643
 Test site-caltech                   (0)| Epoch:39 | Test Acc: 0.9490
 Test site-Product                   (3)| Epoch:39 | Test Acc: 0.9344
 Test site-amazon                    (3)| Epoch:39 | Test Acc: 0.9091
 Test site-webcam                    (2)| Epoch:39 | Test Acc: 0.9811
 Test site-Art                       (0)| Epoch:39 | Test Acc: 0.9036
 Test site-Clipart                   (2)| Epoch:39 | Test Acc: 0.8274
RealWorld: 0.9643, caltech: 0.9490, Product: 0.9344, amazon: 0.9091, webcam: 0.9811, Art: 0.9036, Clipart: 0.8274, 
Average Test Accuracy(group): 0.9241, Average Test Accuracy(individual): 0.9441,
domain std=0.0472, cluster std=0.0124, individual std=0.0302, 
Average Test Accuracy: 0.9241
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[3, 9, 3, 5, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-RealWorld                 (1) | Train Loss: 0.3732 | Train Acc: 0.8889
 Site-RealWorld                 (3) | Train Loss: 0.1193 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.1531 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.2710 | Train Acc: 0.9000
 Site-RealWorld                 (6) | Train Loss: 0.2783 | Train Acc: 0.9200
 Site-RealWorld                 (5) | Train Loss: 0.1527 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2065 | Train Acc: 0.9535
 Site-RealWorld                 (4) | Train Loss: 0.2161 | Train Acc: 0.9818
 Site-RealWorld                 (5) | Train Loss: 0.2331 | Train Acc: 0.9583
 Site-RealWorld                 (1) | Train Loss: 0.1893 | Train Acc: 0.9785
 Site-caltech                   (4) | Train Loss: 0.1623 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.2229 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.1572 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.3749 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.3666 | Train Acc: 0.9268
 Site-caltech                   (1) | Train Loss: 0.2043 | Train Acc: 0.9825
 Site-caltech                   (0) | Train Loss: 0.2193 | Train Acc: 0.9747
 Site-Product                   (1) | Train Loss: 0.2313 | Train Acc: 0.9231
 Site-Product                   (3) | Train Loss: 0.2522 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.3930 | Train Acc: 0.9310
 Site-Product                   (3) | Train Loss: 0.2971 | Train Acc: 0.9545
 Site-Product                   (1) | Train Loss: 0.1939 | Train Acc: 0.9697
 Site-amazon                    (0) | Train Loss: 0.2575 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.3674 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.3860 | Train Acc: 0.8548
 Site-webcam                    (2) | Train Loss: 0.2041 | Train Acc: 0.9630
 Site-webcam                    (4) | Train Loss: 0.2271 | Train Acc: 0.9630
 Site-Art                       (4) | Train Loss: 0.5125 | Train Acc: 0.9091
 Site-Clipart                   (5) | Train Loss: 0.7698 | Train Acc: 0.7568
Average Train Accuracy: 0.9444
 Site-RealWorld                 (1) | Val  Loss: 0.0517 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.1769 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.1737 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.2525 | Val  Acc: 0.8462
 Site-RealWorld                 (6) | Val  Loss: 0.3512 | Val  Acc: 0.8824
 Site-RealWorld                 (5) | Val  Loss: 0.3411 | Val  Acc: 0.9091
 Site-RealWorld                 (1) | Val  Loss: 0.2713 | Val  Acc: 0.9643
 Site-RealWorld                 (4) | Val  Loss: 0.3995 | Val  Acc: 0.8919
 Site-RealWorld                 (5) | Val  Loss: 0.1743 | Val  Acc: 0.9583
 Site-RealWorld                 (1) | Val  Loss: 0.2729 | Val  Acc: 0.9032
 Site-caltech                   (4) | Val  Loss: 0.2232 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1849 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2662 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1401 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2958 | Val  Acc: 0.9630
 Site-caltech                   (1) | Val  Loss: 0.3266 | Val  Acc: 0.9211
 Site-caltech                   (0) | Val  Loss: 0.3405 | Val  Acc: 0.9057
 Site-Product                   (1) | Val  Loss: 0.3305 | Val  Acc: 0.8750
 Site-Product                   (3) | Val  Loss: 0.2340 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.2381 | Val  Acc: 0.9500
 Site-Product                   (3) | Val  Loss: 0.2861 | Val  Acc: 0.9310
 Site-Product                   (1) | Val  Loss: 0.2642 | Val  Acc: 0.9773
 Site-amazon                    (0) | Val  Loss: 0.6383 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.6805 | Val  Acc: 0.7826
 Site-amazon                    (1) | Val  Loss: 0.4780 | Val  Acc: 0.9024
 Site-webcam                    (2) | Val  Loss: 0.3110 | Val  Acc: 0.8889
 Site-webcam                    (4) | Val  Loss: 0.2957 | Val  Acc: 0.9444
 Site-Art                       (4) | Val  Loss: 0.5160 | Val  Acc: 0.9167
 Site-Clipart                   (5) | Val  Loss: 0.6232 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9255
 Test site-RealWorld                 (1)| Epoch:40 | Test Acc: 0.9643
 Test site-caltech                   (4)| Epoch:40 | Test Acc: 0.9518
 Test site-Product                   (1)| Epoch:40 | Test Acc: 0.9344
 Test site-amazon                    (0)| Epoch:40 | Test Acc: 0.9121
 Test site-webcam                    (2)| Epoch:40 | Test Acc: 0.9906
 Test site-Art                       (4)| Epoch:40 | Test Acc: 0.8976
 Test site-Clipart                   (5)| Epoch:40 | Test Acc: 0.8274
RealWorld: 0.9643, caltech: 0.9518, Product: 0.9344, amazon: 0.9121, webcam: 0.9906, Art: 0.8976, Clipart: 0.8274, 
Average Test Accuracy(group): 0.9255, Average Test Accuracy(individual): 0.9455,
domain std=0.0494, cluster std=0.0135, individual std=0.0311, 
Average Test Accuracy: 0.9255
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[7, 1, 5, 9, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-RealWorld                 (2) | Train Loss: 0.2936 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.2373 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.2529 | Train Acc: 0.9333
 Site-RealWorld                 (3) | Train Loss: 0.3511 | Train Acc: 0.8500
 Site-RealWorld                 (2) | Train Loss: 0.3107 | Train Acc: 0.8800
 Site-RealWorld                 (5) | Train Loss: 0.1418 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.1988 | Train Acc: 0.9535
 Site-RealWorld                 (0) | Train Loss: 0.2471 | Train Acc: 0.9455
 Site-RealWorld                 (5) | Train Loss: 0.2285 | Train Acc: 0.9444
 Site-RealWorld                 (0) | Train Loss: 0.1703 | Train Acc: 0.9892
 Site-caltech                   (5) | Train Loss: 0.2217 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.3032 | Train Acc: 0.8667
 Site-caltech                   (3) | Train Loss: 0.1952 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.4465 | Train Acc: 0.9000
 Site-caltech                   (3) | Train Loss: 0.3180 | Train Acc: 0.9268
 Site-caltech                   (3) | Train Loss: 0.2670 | Train Acc: 0.9649
 Site-caltech                   (0) | Train Loss: 0.2204 | Train Acc: 0.9747
 Site-Product                   (1) | Train Loss: 0.2236 | Train Acc: 0.9231
 Site-Product                   (3) | Train Loss: 0.2218 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.3505 | Train Acc: 0.8966
 Site-Product                   (3) | Train Loss: 0.2572 | Train Acc: 0.9545
 Site-Product                   (3) | Train Loss: 0.4158 | Train Acc: 0.9545
 Site-amazon                    (4) | Train Loss: 0.3457 | Train Acc: 0.8500
 Site-amazon                    (4) | Train Loss: 0.3586 | Train Acc: 0.9143
 Site-amazon                    (3) | Train Loss: 0.3977 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.1932 | Train Acc: 0.9630
 Site-webcam                    (2) | Train Loss: 0.2566 | Train Acc: 0.9259
 Site-Art                       (2) | Train Loss: 0.5311 | Train Acc: 0.9273
 Site-Clipart                   (6) | Train Loss: 0.6060 | Train Acc: 0.8378
Average Train Accuracy: 0.9361
 Site-RealWorld                 (2) | Val  Loss: 0.0586 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.0805 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2516 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.2202 | Val  Acc: 0.9231
 Site-RealWorld                 (2) | Val  Loss: 0.3770 | Val  Acc: 0.8235
 Site-RealWorld                 (5) | Val  Loss: 0.2586 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.2131 | Val  Acc: 0.9643
 Site-RealWorld                 (0) | Val  Loss: 0.2307 | Val  Acc: 0.9189
 Site-RealWorld                 (5) | Val  Loss: 0.1903 | Val  Acc: 0.9583
 Site-RealWorld                 (0) | Val  Loss: 0.1956 | Val  Acc: 0.9194
 Site-caltech                   (5) | Val  Loss: 0.3228 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.1462 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1913 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1593 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2871 | Val  Acc: 0.9259
 Site-caltech                   (3) | Val  Loss: 0.2570 | Val  Acc: 0.9737
 Site-caltech                   (0) | Val  Loss: 0.3615 | Val  Acc: 0.9245
 Site-Product                   (1) | Val  Loss: 0.2097 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2088 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.2366 | Val  Acc: 0.9000
 Site-Product                   (3) | Val  Loss: 0.1942 | Val  Acc: 0.9655
 Site-Product                   (3) | Val  Loss: 0.3478 | Val  Acc: 0.9318
 Site-amazon                    (4) | Val  Loss: 0.5967 | Val  Acc: 0.7692
 Site-amazon                    (4) | Val  Loss: 0.7041 | Val  Acc: 0.7391
 Site-amazon                    (3) | Val  Loss: 0.4422 | Val  Acc: 0.8780
 Site-webcam                    (2) | Val  Loss: 0.3396 | Val  Acc: 0.8333
 Site-webcam                    (2) | Val  Loss: 0.3175 | Val  Acc: 0.9167
 Site-Art                       (2) | Val  Loss: 0.4881 | Val  Acc: 0.9444
 Site-Clipart                   (6) | Val  Loss: 0.6292 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9267
 Test site-RealWorld                 (2)| Epoch:41 | Test Acc: 0.9607
 Test site-caltech                   (5)| Epoch:41 | Test Acc: 0.9547
 Test site-Product                   (1)| Epoch:41 | Test Acc: 0.9279
 Test site-amazon                    (4)| Epoch:41 | Test Acc: 0.9152
 Test site-webcam                    (2)| Epoch:41 | Test Acc: 0.9906
 Test site-Art                       (2)| Epoch:41 | Test Acc: 0.8976
 Test site-Clipart                   (6)| Epoch:41 | Test Acc: 0.8339
RealWorld: 0.9607, caltech: 0.9547, Product: 0.9279, amazon: 0.9152, webcam: 0.9906, Art: 0.8976, Clipart: 0.8339, 
Average Test Accuracy(group): 0.9258, Average Test Accuracy(individual): 0.9444,
domain std=0.0472, cluster std=0.0412, individual std=0.0299, 
Average Test Accuracy: 0.9258
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[3, 2, 5, 8, 2, 2, 7, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-RealWorld                 (1) | Train Loss: 0.3561 | Train Acc: 0.7778
 Site-RealWorld                 (6) | Train Loss: 0.1480 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.1529 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.2665 | Train Acc: 0.8500
 Site-RealWorld                 (4) | Train Loss: 0.3431 | Train Acc: 0.8800
 Site-RealWorld                 (6) | Train Loss: 0.1570 | Train Acc: 1.0000
 Site-RealWorld                 (3) | Train Loss: 0.1856 | Train Acc: 0.9535
 Site-RealWorld                 (3) | Train Loss: 0.2249 | Train Acc: 0.9636
 Site-RealWorld                 (3) | Train Loss: 0.1404 | Train Acc: 0.9444
 Site-RealWorld                 (6) | Train Loss: 0.1611 | Train Acc: 0.9892
 Site-caltech                   (6) | Train Loss: 0.2172 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.2437 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.1389 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.4100 | Train Acc: 0.9333
 Site-caltech                   (6) | Train Loss: 0.3062 | Train Acc: 0.9512
 Site-caltech                   (2) | Train Loss: 0.1833 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.2582 | Train Acc: 0.9620
 Site-Product                   (2) | Train Loss: 0.2720 | Train Acc: 0.9231
 Site-Product                   (2) | Train Loss: 0.2740 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.3839 | Train Acc: 0.9310
 Site-Product                   (3) | Train Loss: 0.2861 | Train Acc: 0.9773
 Site-Product                   (2) | Train Loss: 0.2677 | Train Acc: 0.9242
 Site-amazon                    (5) | Train Loss: 0.3165 | Train Acc: 0.8500
 Site-amazon                    (5) | Train Loss: 0.3838 | Train Acc: 0.9143
 Site-amazon                    (2) | Train Loss: 0.4389 | Train Acc: 0.8548
 Site-webcam                    (0) | Train Loss: 0.2146 | Train Acc: 0.9630
 Site-webcam                    (0) | Train Loss: 0.2575 | Train Acc: 0.9259
 Site-Art                       (6) | Train Loss: 0.5490 | Train Acc: 0.8545
 Site-Clipart                   (6) | Train Loss: 0.6866 | Train Acc: 0.8108
Average Train Accuracy: 0.9339
 Site-RealWorld                 (1) | Val  Loss: 0.0611 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.2833 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2072 | Val  Acc: 0.9231
 Site-RealWorld                 (4) | Val  Loss: 0.3242 | Val  Acc: 0.8824
 Site-RealWorld                 (6) | Val  Loss: 0.2480 | Val  Acc: 0.9545
 Site-RealWorld                 (3) | Val  Loss: 0.2260 | Val  Acc: 0.9643
 Site-RealWorld                 (3) | Val  Loss: 0.2634 | Val  Acc: 0.9459
 Site-RealWorld                 (3) | Val  Loss: 0.1622 | Val  Acc: 0.9583
 Site-RealWorld                 (6) | Val  Loss: 0.2263 | Val  Acc: 0.9355
 Site-caltech                   (6) | Val  Loss: 0.2354 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1666 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1674 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1710 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.2876 | Val  Acc: 0.9630
 Site-caltech                   (2) | Val  Loss: 0.3076 | Val  Acc: 0.8947
 Site-caltech                   (3) | Val  Loss: 0.3970 | Val  Acc: 0.9245
 Site-Product                   (2) | Val  Loss: 0.1275 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.1774 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.2202 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2530 | Val  Acc: 0.9310
 Site-Product                   (2) | Val  Loss: 0.2865 | Val  Acc: 0.9545
 Site-amazon                    (5) | Val  Loss: 0.6785 | Val  Acc: 0.7692
 Site-amazon                    (5) | Val  Loss: 0.6344 | Val  Acc: 0.8261
 Site-amazon                    (2) | Val  Loss: 0.4506 | Val  Acc: 0.8780
 Site-webcam                    (0) | Val  Loss: 0.4243 | Val  Acc: 0.8333
 Site-webcam                    (0) | Val  Loss: 0.1958 | Val  Acc: 0.9444
 Site-Art                       (6) | Val  Loss: 0.5072 | Val  Acc: 0.8889
 Site-Clipart                   (6) | Val  Loss: 0.5895 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9355
 Test site-RealWorld                 (1)| Epoch:42 | Test Acc: 0.9607
 Test site-caltech                   (6)| Epoch:42 | Test Acc: 0.9547
 Test site-Product                   (2)| Epoch:42 | Test Acc: 0.9279
 Test site-amazon                    (5)| Epoch:42 | Test Acc: 0.9152
 Test site-webcam                    (0)| Epoch:42 | Test Acc: 0.9906
 Test site-Art                       (6)| Epoch:42 | Test Acc: 0.8976
 Test site-Clipart                   (6)| Epoch:42 | Test Acc: 0.8371
RealWorld: 0.9607, caltech: 0.9547, Product: 0.9279, amazon: 0.9152, webcam: 0.9906, Art: 0.8976, Clipart: 0.8371, 
Average Test Accuracy(group): 0.9262, Average Test Accuracy(individual): 0.9445,
domain std=0.0463, cluster std=0.0205, individual std=0.0295, 
Average Test Accuracy: 0.9262
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 44 ============
cnt=[1, 1, 8, 3, 9, 4, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-RealWorld                 (6) | Train Loss: 0.3254 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2004 | Train Acc: 0.9333
 Site-RealWorld                 (5) | Train Loss: 0.2570 | Train Acc: 0.9500
 Site-RealWorld                 (3) | Train Loss: 0.2260 | Train Acc: 0.9200
 Site-RealWorld                 (4) | Train Loss: 0.1275 | Train Acc: 1.0000
 Site-RealWorld                 (4) | Train Loss: 0.1807 | Train Acc: 0.9535
 Site-RealWorld                 (4) | Train Loss: 0.1813 | Train Acc: 0.9818
 Site-RealWorld                 (5) | Train Loss: 0.3397 | Train Acc: 0.9583
 Site-RealWorld                 (4) | Train Loss: 0.1766 | Train Acc: 0.9892
 Site-caltech                   (4) | Train Loss: 0.2248 | Train Acc: 1.0000
 Site-caltech                   (6) | Train Loss: 0.2011 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.1953 | Train Acc: 0.9524
 Site-caltech                   (4) | Train Loss: 0.4663 | Train Acc: 0.9000
 Site-caltech                   (2) | Train Loss: 0.3055 | Train Acc: 0.9268
 Site-caltech                   (4) | Train Loss: 0.2131 | Train Acc: 0.9649
 Site-caltech                   (4) | Train Loss: 0.2368 | Train Acc: 0.9620
 Site-Product                   (2) | Train Loss: 0.1798 | Train Acc: 1.0000
 Site-Product                   (4) | Train Loss: 0.2553 | Train Acc: 0.9500
 Site-Product                   (2) | Train Loss: 0.3427 | Train Acc: 0.9310
 Site-Product                   (2) | Train Loss: 0.2653 | Train Acc: 0.9545
 Site-Product                   (2) | Train Loss: 0.3775 | Train Acc: 0.9394
 Site-amazon                    (2) | Train Loss: 0.2691 | Train Acc: 0.8500
 Site-amazon                    (6) | Train Loss: 0.3917 | Train Acc: 0.9143
 Site-amazon                    (2) | Train Loss: 0.3929 | Train Acc: 0.8710
 Site-webcam                    (5) | Train Loss: 0.2254 | Train Acc: 0.9259
 Site-webcam                    (3) | Train Loss: 0.1839 | Train Acc: 0.9444
 Site-Art                       (3) | Train Loss: 0.4869 | Train Acc: 0.9455
 Site-Clipart                   (5) | Train Loss: 0.5527 | Train Acc: 0.8378
Average Train Accuracy: 0.9429
 Site-RealWorld                 (6) | Val  Loss: 0.0583 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1051 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2466 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.2997 | Val  Acc: 0.9231
 Site-RealWorld                 (3) | Val  Loss: 0.3931 | Val  Acc: 0.8235
 Site-RealWorld                 (4) | Val  Loss: 0.2531 | Val  Acc: 0.9091
 Site-RealWorld                 (4) | Val  Loss: 0.2901 | Val  Acc: 0.9643
 Site-RealWorld                 (4) | Val  Loss: 0.2400 | Val  Acc: 0.9459
 Site-RealWorld                 (5) | Val  Loss: 0.1751 | Val  Acc: 0.9792
 Site-RealWorld                 (4) | Val  Loss: 0.2378 | Val  Acc: 0.9355
 Site-caltech                   (4) | Val  Loss: 0.2956 | Val  Acc: 1.0000
 Site-caltech                   (6) | Val  Loss: 0.1469 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.2085 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.1592 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.3055 | Val  Acc: 0.9259
 Site-caltech                   (4) | Val  Loss: 0.2163 | Val  Acc: 0.9737
 Site-caltech                   (4) | Val  Loss: 0.3673 | Val  Acc: 0.9245
 Site-Product                   (2) | Val  Loss: 0.1961 | Val  Acc: 1.0000
 Site-Product                   (4) | Val  Loss: 0.1319 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.2408 | Val  Acc: 1.0000
 Site-Product                   (2) | Val  Loss: 0.2122 | Val  Acc: 0.9310
 Site-Product                   (2) | Val  Loss: 0.3678 | Val  Acc: 0.8864
 Site-amazon                    (2) | Val  Loss: 0.5726 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 0.6477 | Val  Acc: 0.7826
 Site-amazon                    (2) | Val  Loss: 0.4546 | Val  Acc: 0.8293
 Site-webcam                    (5) | Val  Loss: 0.4594 | Val  Acc: 0.8333
 Site-webcam                    (3) | Val  Loss: 0.2945 | Val  Acc: 0.9444
 Site-Art                       (3) | Val  Loss: 0.4780 | Val  Acc: 0.9722
 Site-Clipart                   (5) | Val  Loss: 0.6389 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9340
 Test site-RealWorld                 (6)| Epoch:43 | Test Acc: 0.9643
 Test site-caltech                   (4)| Epoch:43 | Test Acc: 0.9547
 Test site-Product                   (2)| Epoch:43 | Test Acc: 0.9279
 Test site-amazon                    (2)| Epoch:43 | Test Acc: 0.9152
 Test site-webcam                    (5)| Epoch:43 | Test Acc: 0.9906
 Test site-Art                       (3)| Epoch:43 | Test Acc: 0.8916
 Test site-Clipart                   (5)| Epoch:43 | Test Acc: 0.8371
RealWorld: 0.9643, caltech: 0.9547, Product: 0.9279, amazon: 0.9152, webcam: 0.9906, Art: 0.8916, Clipart: 0.8371, 
Average Test Accuracy(group): 0.9259, Average Test Accuracy(individual): 0.9455,
domain std=0.0473, cluster std=0.0116, individual std=0.0306, 
Average Test Accuracy: 0.9259
============ Train epoch 45 ============
cnt=[12, 3, 4, 1, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-RealWorld                 (2) | Train Loss: 0.3838 | Train Acc: 0.7778
 Site-RealWorld                 (0) | Train Loss: 0.0998 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.1934 | Train Acc: 0.9333
 Site-RealWorld                 (2) | Train Loss: 0.3006 | Train Acc: 0.9000
 Site-RealWorld                 (2) | Train Loss: 0.2563 | Train Acc: 0.9200
 Site-RealWorld                 (0) | Train Loss: 0.1395 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.1819 | Train Acc: 0.9767
 Site-RealWorld                 (0) | Train Loss: 0.3013 | Train Acc: 0.9273
 Site-RealWorld                 (0) | Train Loss: 0.1739 | Train Acc: 0.9167
 Site-RealWorld                 (0) | Train Loss: 0.1556 | Train Acc: 0.9785
 Site-caltech                   (1) | Train Loss: 0.2054 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.3654 | Train Acc: 0.8667
 Site-caltech                   (5) | Train Loss: 0.1404 | Train Acc: 1.0000
 Site-caltech                   (5) | Train Loss: 0.4251 | Train Acc: 0.8667
 Site-caltech                   (0) | Train Loss: 0.2403 | Train Acc: 0.9512
 Site-caltech                   (0) | Train Loss: 0.2360 | Train Acc: 0.9825
 Site-caltech                   (0) | Train Loss: 0.2562 | Train Acc: 0.9620
 Site-Product                   (4) | Train Loss: 0.2239 | Train Acc: 0.9231
 Site-Product                   (0) | Train Loss: 0.2267 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.2883 | Train Acc: 0.9655
 Site-Product                   (0) | Train Loss: 0.2814 | Train Acc: 0.9545
 Site-Product                   (6) | Train Loss: 0.2381 | Train Acc: 0.9394
 Site-amazon                    (6) | Train Loss: 0.4577 | Train Acc: 0.8500
 Site-amazon                    (6) | Train Loss: 0.3154 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.4134 | Train Acc: 0.8548
 Site-webcam                    (5) | Train Loss: 0.2024 | Train Acc: 0.9259
 Site-webcam                    (5) | Train Loss: 0.1887 | Train Acc: 0.9259
 Site-Art                       (5) | Train Loss: 0.5966 | Train Acc: 0.8182
 Site-Clipart                   (3) | Train Loss: 0.6560 | Train Acc: 0.8378
Average Train Accuracy: 0.9248
 Site-RealWorld                 (2) | Val  Loss: 0.0449 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1648 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3063 | Val  Acc: 0.9000
 Site-RealWorld                 (2) | Val  Loss: 0.2120 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.3545 | Val  Acc: 0.8824
 Site-RealWorld                 (0) | Val  Loss: 0.2947 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.2491 | Val  Acc: 0.9286
 Site-RealWorld                 (0) | Val  Loss: 0.1867 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1504 | Val  Acc: 0.9792
 Site-RealWorld                 (0) | Val  Loss: 0.2640 | Val  Acc: 0.9032
 Site-caltech                   (1) | Val  Loss: 0.1966 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1967 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.1580 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.1657 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1981 | Val  Acc: 0.9630
 Site-caltech                   (0) | Val  Loss: 0.2685 | Val  Acc: 0.9474
 Site-caltech                   (0) | Val  Loss: 0.4236 | Val  Acc: 0.8868
 Site-Product                   (4) | Val  Loss: 0.1562 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1488 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1639 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2348 | Val  Acc: 0.9310
 Site-Product                   (6) | Val  Loss: 0.2461 | Val  Acc: 0.9318
 Site-amazon                    (6) | Val  Loss: 0.6058 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 0.5797 | Val  Acc: 0.8261
 Site-amazon                    (1) | Val  Loss: 0.3961 | Val  Acc: 0.8780
 Site-webcam                    (5) | Val  Loss: 0.4038 | Val  Acc: 0.8889
 Site-webcam                    (5) | Val  Loss: 0.3223 | Val  Acc: 0.9444
 Site-Art                       (5) | Val  Loss: 0.4981 | Val  Acc: 0.8889
 Site-Clipart                   (3) | Val  Loss: 0.5958 | Val  Acc: 0.7917
Average Valid Accuracy: 0.9362
 Test site-RealWorld                 (2)| Epoch:43 | Test Acc: 0.9643
 Test site-caltech                   (1)| Epoch:43 | Test Acc: 0.9547
 Test site-Product                   (4)| Epoch:43 | Test Acc: 0.9246
 Test site-amazon                    (6)| Epoch:43 | Test Acc: 0.9152
 Test site-webcam                    (5)| Epoch:43 | Test Acc: 0.9906
 Test site-Art                       (5)| Epoch:43 | Test Acc: 0.8916
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8371
RealWorld: 0.9643, caltech: 0.9547, Product: 0.9246, amazon: 0.9152, webcam: 0.9906, Art: 0.8916, Clipart: 0.8371, 
Average Test Accuracy(group): 0.9254, Average Test Accuracy(individual): 0.9450,
domain std=0.0473, cluster std=0.0401, individual std=0.0309, 
Average Test Accuracy: 0.9254
============ Train epoch 46 ============
cnt=[4, 7, 7, 6, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-RealWorld                 (6) | Train Loss: 0.4587 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.1270 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.1481 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.3051 | Train Acc: 0.9000
 Site-RealWorld                 (0) | Train Loss: 0.2136 | Train Acc: 0.9600
 Site-RealWorld                 (2) | Train Loss: 0.1499 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.1954 | Train Acc: 0.9767
 Site-RealWorld                 (2) | Train Loss: 0.2108 | Train Acc: 0.9636
 Site-RealWorld                 (2) | Train Loss: 0.2097 | Train Acc: 0.9722
 Site-RealWorld                 (3) | Train Loss: 0.1683 | Train Acc: 0.9785
 Site-caltech                   (3) | Train Loss: 0.3170 | Train Acc: 1.0000
 Site-caltech                   (4) | Train Loss: 0.3011 | Train Acc: 0.9333
 Site-caltech                   (3) | Train Loss: 0.1435 | Train Acc: 1.0000
 Site-caltech                   (0) | Train Loss: 0.3918 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.2621 | Train Acc: 0.9756
 Site-caltech                   (3) | Train Loss: 0.2069 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.3064 | Train Acc: 0.9747
 Site-Product                   (1) | Train Loss: 0.2471 | Train Acc: 0.9231
 Site-Product                   (6) | Train Loss: 0.1925 | Train Acc: 0.9500
 Site-Product                   (3) | Train Loss: 0.3442 | Train Acc: 0.8966
 Site-Product                   (1) | Train Loss: 0.2803 | Train Acc: 0.9545
 Site-Product                   (1) | Train Loss: 0.2158 | Train Acc: 0.9697
 Site-amazon                    (5) | Train Loss: 0.3928 | Train Acc: 0.8500
 Site-amazon                    (1) | Train Loss: 0.3508 | Train Acc: 0.9143
 Site-amazon                    (1) | Train Loss: 0.4268 | Train Acc: 0.8387
 Site-webcam                    (2) | Train Loss: 0.1650 | Train Acc: 0.9630
 Site-webcam                    (2) | Train Loss: 0.2253 | Train Acc: 0.9259
 Site-Art                       (6) | Train Loss: 0.5176 | Train Acc: 0.9091
 Site-Clipart                   (3) | Train Loss: 0.6326 | Train Acc: 0.7838
Average Train Accuracy: 0.9426
 Site-RealWorld                 (6) | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1452 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.1407 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2976 | Val  Acc: 0.8462
 Site-RealWorld                 (0) | Val  Loss: 0.3177 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.1982 | Val  Acc: 0.9545
 Site-RealWorld                 (2) | Val  Loss: 0.3308 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.1799 | Val  Acc: 0.9730
 Site-RealWorld                 (2) | Val  Loss: 0.1837 | Val  Acc: 0.9375
 Site-RealWorld                 (3) | Val  Loss: 0.2149 | Val  Acc: 0.9516
 Site-caltech                   (3) | Val  Loss: 0.1780 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.1482 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1793 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1537 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.2286 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.3477 | Val  Acc: 0.9211
 Site-caltech                   (2) | Val  Loss: 0.3538 | Val  Acc: 0.8868
 Site-Product                   (1) | Val  Loss: 0.2824 | Val  Acc: 0.8750
 Site-Product                   (6) | Val  Loss: 0.2306 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.2349 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1950 | Val  Acc: 0.9655
 Site-Product                   (1) | Val  Loss: 0.3366 | Val  Acc: 0.9318
 Site-amazon                    (5) | Val  Loss: 0.5818 | Val  Acc: 0.7692
 Site-amazon                    (1) | Val  Loss: 0.5597 | Val  Acc: 0.8261
 Site-amazon                    (1) | Val  Loss: 0.4349 | Val  Acc: 0.8537
 Site-webcam                    (2) | Val  Loss: 0.4150 | Val  Acc: 0.8889
 Site-webcam                    (2) | Val  Loss: 0.2181 | Val  Acc: 0.9167
 Site-Art                       (6) | Val  Loss: 0.5170 | Val  Acc: 0.9167
 Site-Clipart                   (3) | Val  Loss: 0.6167 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9324
 Test site-RealWorld                 (6)| Epoch:43 | Test Acc: 0.9679
 Test site-caltech                   (3)| Epoch:43 | Test Acc: 0.9547
 Test site-Product                   (1)| Epoch:43 | Test Acc: 0.9344
 Test site-amazon                    (5)| Epoch:43 | Test Acc: 0.9152
 Test site-webcam                    (2)| Epoch:43 | Test Acc: 0.9906
 Test site-Art                       (6)| Epoch:43 | Test Acc: 0.8916
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8339
RealWorld: 0.9679, caltech: 0.9547, Product: 0.9344, amazon: 0.9152, webcam: 0.9906, Art: 0.8916, Clipart: 0.8339, 
Average Test Accuracy(group): 0.9269, Average Test Accuracy(individual): 0.9478,
domain std=0.0487, cluster std=0.0189, individual std=0.0312, 
Average Test Accuracy: 0.9269
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 47 ============
cnt=[8, 1, 7, 5, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-RealWorld                 (2) | Train Loss: 0.4684 | Train Acc: 0.7778
 Site-RealWorld                 (3) | Train Loss: 0.1366 | Train Acc: 1.0000
 Site-RealWorld                 (2) | Train Loss: 0.1256 | Train Acc: 1.0000
 Site-RealWorld                 (6) | Train Loss: 0.2602 | Train Acc: 0.9500
 Site-RealWorld                 (1) | Train Loss: 0.2267 | Train Acc: 0.9600
 Site-RealWorld                 (4) | Train Loss: 0.1132 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.1918 | Train Acc: 0.9767
 Site-RealWorld                 (0) | Train Loss: 0.2059 | Train Acc: 0.9636
 Site-RealWorld                 (2) | Train Loss: 0.1884 | Train Acc: 0.9167
 Site-RealWorld                 (4) | Train Loss: 0.1538 | Train Acc: 0.9785
 Site-caltech                   (5) | Train Loss: 0.1737 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.2409 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.2048 | Train Acc: 0.9524
 Site-caltech                   (4) | Train Loss: 0.3363 | Train Acc: 0.9333
 Site-caltech                   (3) | Train Loss: 0.2690 | Train Acc: 0.9268
 Site-caltech                   (0) | Train Loss: 0.2084 | Train Acc: 0.9825
 Site-caltech                   (4) | Train Loss: 0.1747 | Train Acc: 0.9620
 Site-Product                   (0) | Train Loss: 0.1545 | Train Acc: 1.0000
 Site-Product                   (0) | Train Loss: 0.1735 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.3467 | Train Acc: 0.9310
 Site-Product                   (0) | Train Loss: 0.2774 | Train Acc: 0.9318
 Site-Product                   (2) | Train Loss: 0.7341 | Train Acc: 0.9242
 Site-amazon                    (3) | Train Loss: 0.2729 | Train Acc: 0.9500
 Site-amazon                    (0) | Train Loss: 0.3439 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.3645 | Train Acc: 0.8710
 Site-webcam                    (2) | Train Loss: 0.1961 | Train Acc: 0.9630
 Site-webcam                    (2) | Train Loss: 0.1704 | Train Acc: 0.9444
 Site-Art                       (6) | Train Loss: 0.4669 | Train Acc: 0.8727
 Site-Clipart                   (4) | Train Loss: 0.6819 | Train Acc: 0.8378
Average Train Accuracy: 0.9455
 Site-RealWorld                 (2) | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-RealWorld                 (3) | Val  Loss: 0.0807 | Val  Acc: 1.0000
 Site-RealWorld                 (2) | Val  Loss: 0.1571 | Val  Acc: 1.0000
 Site-RealWorld                 (6) | Val  Loss: 0.1907 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.2751 | Val  Acc: 0.8824
 Site-RealWorld                 (4) | Val  Loss: 0.1943 | Val  Acc: 0.9091
 Site-RealWorld                 (0) | Val  Loss: 0.2202 | Val  Acc: 0.9643
 Site-RealWorld                 (0) | Val  Loss: 0.1864 | Val  Acc: 0.9730
 Site-RealWorld                 (2) | Val  Loss: 0.1924 | Val  Acc: 0.9583
 Site-RealWorld                 (4) | Val  Loss: 0.1862 | Val  Acc: 0.9677
 Site-caltech                   (5) | Val  Loss: 0.2780 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1581 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1369 | Val  Acc: 1.0000
 Site-caltech                   (4) | Val  Loss: 0.1097 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.2086 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2806 | Val  Acc: 0.9474
 Site-caltech                   (4) | Val  Loss: 0.3293 | Val  Acc: 0.9057
 Site-Product                   (0) | Val  Loss: 0.3256 | Val  Acc: 0.8750
 Site-Product                   (0) | Val  Loss: 0.2021 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.1835 | Val  Acc: 0.9500
 Site-Product                   (0) | Val  Loss: 0.1841 | Val  Acc: 0.9655
 Site-Product                   (2) | Val  Loss: 0.3069 | Val  Acc: 0.9545
 Site-amazon                    (3) | Val  Loss: 0.5481 | Val  Acc: 0.7692
 Site-amazon                    (0) | Val  Loss: 0.6216 | Val  Acc: 0.7826
 Site-amazon                    (0) | Val  Loss: 0.4878 | Val  Acc: 0.8293
 Site-webcam                    (2) | Val  Loss: 0.3711 | Val  Acc: 0.8333
 Site-webcam                    (2) | Val  Loss: 0.3019 | Val  Acc: 0.9167
 Site-Art                       (6) | Val  Loss: 0.4008 | Val  Acc: 1.0000
 Site-Clipart                   (4) | Val  Loss: 0.5533 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9359
 Test site-RealWorld                 (2)| Epoch:46 | Test Acc: 0.9714
 Test site-caltech                   (5)| Epoch:46 | Test Acc: 0.9547
 Test site-Product                   (0)| Epoch:46 | Test Acc: 0.9344
 Test site-amazon                    (3)| Epoch:46 | Test Acc: 0.9152
 Test site-webcam                    (2)| Epoch:46 | Test Acc: 0.9906
 Test site-Art                       (6)| Epoch:46 | Test Acc: 0.8976
 Test site-Clipart                   (4)| Epoch:46 | Test Acc: 0.8404
RealWorld: 0.9714, caltech: 0.9547, Product: 0.9344, amazon: 0.9152, webcam: 0.9906, Art: 0.8976, Clipart: 0.8404, 
Average Test Accuracy(group): 0.9292, Average Test Accuracy(individual): 0.9494,
domain std=0.0468, cluster std=0.0137, individual std=0.0309, 
Average Test Accuracy: 0.9292
 Saving the gmap checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_officecaltechhome_uneven_1.47_1/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 8, 6, 2, 1, 7, 3, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-RealWorld                 (2) | Train Loss: 0.3737 | Train Acc: 0.8889
 Site-RealWorld                 (1) | Train Loss: 0.1346 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.1391 | Train Acc: 1.0000
 Site-RealWorld                 (5) | Train Loss: 0.2760 | Train Acc: 0.9000
 Site-RealWorld                 (1) | Train Loss: 0.2718 | Train Acc: 0.9200
 Site-RealWorld                 (2) | Train Loss: 0.1094 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2210 | Train Acc: 0.9535
 Site-RealWorld                 (2) | Train Loss: 0.2170 | Train Acc: 0.9636
 Site-RealWorld                 (5) | Train Loss: 0.2597 | Train Acc: 0.9583
 Site-RealWorld                 (2) | Train Loss: 0.1176 | Train Acc: 0.9785
 Site-caltech                   (1) | Train Loss: 0.3199 | Train Acc: 1.0000
 Site-caltech                   (3) | Train Loss: 0.2377 | Train Acc: 0.9333
 Site-caltech                   (1) | Train Loss: 0.1310 | Train Acc: 1.0000
 Site-caltech                   (2) | Train Loss: 0.3965 | Train Acc: 0.9333
 Site-caltech                   (0) | Train Loss: 0.2842 | Train Acc: 0.9024
 Site-caltech                   (5) | Train Loss: 0.1820 | Train Acc: 0.9649
 Site-caltech                   (2) | Train Loss: 0.1970 | Train Acc: 0.9747
 Site-Product                   (6) | Train Loss: 0.2551 | Train Acc: 0.9231
 Site-Product                   (0) | Train Loss: 0.1666 | Train Acc: 1.0000
 Site-Product                   (3) | Train Loss: 0.2499 | Train Acc: 1.0000
 Site-Product                   (5) | Train Loss: 0.2653 | Train Acc: 0.9773
 Site-Product                   (5) | Train Loss: 0.1901 | Train Acc: 0.9545
 Site-amazon                    (1) | Train Loss: 0.3623 | Train Acc: 0.9000
 Site-amazon                    (6) | Train Loss: 0.2985 | Train Acc: 0.9143
 Site-amazon                    (6) | Train Loss: 0.3617 | Train Acc: 0.8710
 Site-webcam                    (1) | Train Loss: 0.1684 | Train Acc: 0.9630
 Site-webcam                    (1) | Train Loss: 0.2217 | Train Acc: 0.9630
 Site-Art                       (5) | Train Loss: 0.4511 | Train Acc: 0.8727
 Site-Clipart                   (4) | Train Loss: 0.6784 | Train Acc: 0.8378
Average Train Accuracy: 0.9465
 Site-RealWorld                 (2) | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1367 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.2733 | Val  Acc: 0.9000
 Site-RealWorld                 (5) | Val  Loss: 0.2150 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.3123 | Val  Acc: 0.9412
 Site-RealWorld                 (2) | Val  Loss: 0.2031 | Val  Acc: 0.9545
 Site-RealWorld                 (1) | Val  Loss: 0.2373 | Val  Acc: 0.9286
 Site-RealWorld                 (2) | Val  Loss: 0.2152 | Val  Acc: 0.9459
 Site-RealWorld                 (5) | Val  Loss: 0.1608 | Val  Acc: 0.9792
 Site-RealWorld                 (2) | Val  Loss: 0.2223 | Val  Acc: 0.9516
 Site-caltech                   (1) | Val  Loss: 0.3507 | Val  Acc: 1.0000
 Site-caltech                   (3) | Val  Loss: 0.1767 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1517 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1093 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.1774 | Val  Acc: 1.0000
 Site-caltech                   (5) | Val  Loss: 0.2869 | Val  Acc: 0.9474
 Site-caltech                   (2) | Val  Loss: 0.3360 | Val  Acc: 0.9434
 Site-Product                   (6) | Val  Loss: 0.1811 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.2755 | Val  Acc: 0.9231
 Site-Product                   (3) | Val  Loss: 0.2070 | Val  Acc: 0.9500
 Site-Product                   (5) | Val  Loss: 0.1794 | Val  Acc: 0.9655
 Site-Product                   (5) | Val  Loss: 0.2598 | Val  Acc: 0.9773
 Site-amazon                    (1) | Val  Loss: 0.5820 | Val  Acc: 0.7692
 Site-amazon                    (6) | Val  Loss: 0.5992 | Val  Acc: 0.7826
 Site-amazon                    (6) | Val  Loss: 0.4565 | Val  Acc: 0.8293
 Site-webcam                    (1) | Val  Loss: 0.3422 | Val  Acc: 0.8889
 Site-webcam                    (1) | Val  Loss: 0.2077 | Val  Acc: 0.8889
 Site-Art                       (5) | Val  Loss: 0.5011 | Val  Acc: 0.9722
 Site-Clipart                   (4) | Val  Loss: 0.5917 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9404
 Best site-RealWorld                (2)  | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:48 | Val Acc: 0.9000
 Best site-RealWorld                (5)  | Epoch:48 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:48 | Val Acc: 0.9412
 Best site-RealWorld                (2)  | Epoch:48 | Val Acc: 0.9545
 Best site-RealWorld                (1)  | Epoch:48 | Val Acc: 0.9286
 Best site-RealWorld                (2)  | Epoch:48 | Val Acc: 0.9459
 Best site-RealWorld                (5)  | Epoch:48 | Val Acc: 0.9792
 Best site-RealWorld                (2)  | Epoch:48 | Val Acc: 0.9516
 Best site-caltech                  (1)  | Epoch:48 | Val Acc: 1.0000
 Best site-caltech                  (3)  | Epoch:48 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:48 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:48 | Val Acc: 1.0000
 Best site-caltech                  (0)  | Epoch:48 | Val Acc: 1.0000
 Best site-caltech                  (5)  | Epoch:48 | Val Acc: 0.9474
 Best site-caltech                  (2)  | Epoch:48 | Val Acc: 0.9434
 Best site-Product                  (6)  | Epoch:48 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:48 | Val Acc: 0.9231
 Best site-Product                  (3)  | Epoch:48 | Val Acc: 0.9500
 Best site-Product                  (5)  | Epoch:48 | Val Acc: 0.9655
 Best site-Product                  (5)  | Epoch:48 | Val Acc: 0.9773
 Best site-amazon                   (1)  | Epoch:48 | Val Acc: 0.7692
 Best site-amazon                   (6)  | Epoch:48 | Val Acc: 0.7826
 Best site-amazon                   (6)  | Epoch:48 | Val Acc: 0.8293
 Best site-webcam                   (1)  | Epoch:48 | Val Acc: 0.8889
 Best site-webcam                   (1)  | Epoch:48 | Val Acc: 0.8889
 Best site-Art                      (5)  | Epoch:48 | Val Acc: 0.9722
 Best site-Clipart                  (4)  | Epoch:48 | Val Acc: 0.8333
 Test site-RealWorld                 (2)| Epoch:48 | Test Acc: 0.9679
 Test site-caltech                   (1)| Epoch:48 | Test Acc: 0.9547
 Test site-Product                   (6)| Epoch:48 | Test Acc: 0.9344
 Test site-amazon                    (1)| Epoch:48 | Test Acc: 0.9182
 Test site-webcam                    (1)| Epoch:48 | Test Acc: 0.9906
 Test site-Art                       (5)| Epoch:48 | Test Acc: 0.8916
 Test site-Clipart                   (4)| Epoch:48 | Test Acc: 0.8404
RealWorld: 0.9679, caltech: 0.9547, Product: 0.9344, amazon: 0.9182, webcam: 0.9906, Art: 0.8916, Clipart: 0.8404, 
Average Test Accuracy(group): 0.9282, Average Test Accuracy(individual): 0.9483,
domain std=0.0468, cluster std=0.0396, individual std=0.0301, 
Average Test Accuracy: 0.9282
============ Train epoch 49 ============
cnt=[6, 9, 2, 4, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-RealWorld                 (1) | Train Loss: 0.2453 | Train Acc: 0.8889
 Site-RealWorld                 (0) | Train Loss: 0.1234 | Train Acc: 1.0000
 Site-RealWorld                 (0) | Train Loss: 0.1425 | Train Acc: 1.0000
 Site-RealWorld                 (1) | Train Loss: 0.2972 | Train Acc: 0.9000
 Site-RealWorld                 (4) | Train Loss: 0.2801 | Train Acc: 0.8800
 Site-RealWorld                 (5) | Train Loss: 0.1529 | Train Acc: 0.9697
 Site-RealWorld                 (5) | Train Loss: 0.1726 | Train Acc: 0.9767
 Site-RealWorld                 (5) | Train Loss: 0.1513 | Train Acc: 0.9818
 Site-RealWorld                 (1) | Train Loss: 0.2687 | Train Acc: 0.9444
 Site-RealWorld                 (5) | Train Loss: 0.1298 | Train Acc: 0.9892
 Site-caltech                   (1) | Train Loss: 0.2540 | Train Acc: 0.9091
 Site-caltech                   (2) | Train Loss: 0.2394 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.1912 | Train Acc: 1.0000
 Site-caltech                   (1) | Train Loss: 0.4308 | Train Acc: 0.8667
 Site-caltech                   (0) | Train Loss: 0.3184 | Train Acc: 0.9024
 Site-caltech                   (3) | Train Loss: 0.1968 | Train Acc: 0.9825
 Site-caltech                   (5) | Train Loss: 0.2311 | Train Acc: 0.9747
 Site-Product                   (3) | Train Loss: 0.2942 | Train Acc: 0.9231
 Site-Product                   (1) | Train Loss: 0.2015 | Train Acc: 0.9500
 Site-Product                   (0) | Train Loss: 0.3131 | Train Acc: 0.9655
 Site-Product                   (3) | Train Loss: 0.2040 | Train Acc: 1.0000
 Site-Product                   (0) | Train Loss: 0.1665 | Train Acc: 0.9091
 Site-amazon                    (2) | Train Loss: 0.2507 | Train Acc: 0.9000
 Site-amazon                    (3) | Train Loss: 0.3785 | Train Acc: 0.9143
 Site-amazon                    (0) | Train Loss: 0.3537 | Train Acc: 0.8548
 Site-webcam                    (6) | Train Loss: 0.1512 | Train Acc: 1.0000
 Site-webcam                    (1) | Train Loss: 0.1855 | Train Acc: 0.9630
 Site-Art                       (5) | Train Loss: 0.4825 | Train Acc: 0.9091
 Site-Clipart                   (1) | Train Loss: 0.5886 | Train Acc: 0.8649
Average Train Accuracy: 0.9421
 Site-RealWorld                 (1) | Val  Loss: 0.0503 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.0893 | Val  Acc: 1.0000
 Site-RealWorld                 (0) | Val  Loss: 0.2744 | Val  Acc: 1.0000
 Site-RealWorld                 (1) | Val  Loss: 0.1677 | Val  Acc: 1.0000
 Site-RealWorld                 (4) | Val  Loss: 0.3242 | Val  Acc: 0.8235
 Site-RealWorld                 (5) | Val  Loss: 0.3025 | Val  Acc: 0.9091
 Site-RealWorld                 (5) | Val  Loss: 0.1476 | Val  Acc: 1.0000
 Site-RealWorld                 (5) | Val  Loss: 0.2354 | Val  Acc: 0.9730
 Site-RealWorld                 (1) | Val  Loss: 0.1515 | Val  Acc: 0.9792
 Site-RealWorld                 (5) | Val  Loss: 0.1915 | Val  Acc: 0.9516
 Site-caltech                   (1) | Val  Loss: 0.2601 | Val  Acc: 1.0000
 Site-caltech                   (2) | Val  Loss: 0.1599 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1415 | Val  Acc: 1.0000
 Site-caltech                   (1) | Val  Loss: 0.1046 | Val  Acc: 1.0000
 Site-caltech                   (0) | Val  Loss: 0.2805 | Val  Acc: 0.8889
 Site-caltech                   (3) | Val  Loss: 0.2419 | Val  Acc: 0.9211
 Site-caltech                   (5) | Val  Loss: 0.3068 | Val  Acc: 0.9245
 Site-Product                   (3) | Val  Loss: 0.1492 | Val  Acc: 1.0000
 Site-Product                   (1) | Val  Loss: 0.1439 | Val  Acc: 1.0000
 Site-Product                   (0) | Val  Loss: 0.1889 | Val  Acc: 1.0000
 Site-Product                   (3) | Val  Loss: 0.2390 | Val  Acc: 0.9310
 Site-Product                   (0) | Val  Loss: 0.1945 | Val  Acc: 1.0000
 Site-amazon                    (2) | Val  Loss: 0.5576 | Val  Acc: 0.7692
 Site-amazon                    (3) | Val  Loss: 0.6151 | Val  Acc: 0.8261
 Site-amazon                    (0) | Val  Loss: 0.4143 | Val  Acc: 0.9024
 Site-webcam                    (6) | Val  Loss: 0.4259 | Val  Acc: 0.8333
 Site-webcam                    (1) | Val  Loss: 0.2796 | Val  Acc: 0.9444
 Site-Art                       (5) | Val  Loss: 0.4535 | Val  Acc: 1.0000
 Site-Clipart                   (1) | Val  Loss: 0.5051 | Val  Acc: 0.8333
Average Valid Accuracy: 0.9452
 Best site-RealWorld                (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                (4)  | Epoch:49 | Val Acc: 0.8235
 Best site-RealWorld                (5)  | Epoch:49 | Val Acc: 0.9091
 Best site-RealWorld                (5)  | Epoch:49 | Val Acc: 1.0000
 Best site-RealWorld                (5)  | Epoch:49 | Val Acc: 0.9730
 Best site-RealWorld                (1)  | Epoch:49 | Val Acc: 0.9792
 Best site-RealWorld                (5)  | Epoch:49 | Val Acc: 0.9516
 Best site-caltech                  (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-caltech                  (2)  | Epoch:49 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-caltech                  (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-caltech                  (0)  | Epoch:49 | Val Acc: 0.8889
 Best site-caltech                  (3)  | Epoch:49 | Val Acc: 0.9211
 Best site-caltech                  (5)  | Epoch:49 | Val Acc: 0.9245
 Best site-Product                  (3)  | Epoch:49 | Val Acc: 1.0000
 Best site-Product                  (1)  | Epoch:49 | Val Acc: 1.0000
 Best site-Product                  (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-Product                  (3)  | Epoch:49 | Val Acc: 0.9310
 Best site-Product                  (0)  | Epoch:49 | Val Acc: 1.0000
 Best site-amazon                   (2)  | Epoch:49 | Val Acc: 0.7692
 Best site-amazon                   (3)  | Epoch:49 | Val Acc: 0.8261
 Best site-amazon                   (0)  | Epoch:49 | Val Acc: 0.9024
 Best site-webcam                   (6)  | Epoch:49 | Val Acc: 0.8333
 Best site-webcam                   (1)  | Epoch:49 | Val Acc: 0.9444
 Best site-Art                      (5)  | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart                  (1)  | Epoch:49 | Val Acc: 0.8333
 Test site-RealWorld                 (1)| Epoch:49 | Test Acc: 0.9679
 Test site-caltech                   (1)| Epoch:49 | Test Acc: 0.9575
 Test site-Product                   (3)| Epoch:49 | Test Acc: 0.9279
 Test site-amazon                    (2)| Epoch:49 | Test Acc: 0.9182
 Test site-webcam                    (6)| Epoch:49 | Test Acc: 0.9906
 Test site-Art                       (5)| Epoch:49 | Test Acc: 0.8916
 Test site-Clipart                   (1)| Epoch:49 | Test Acc: 0.8371
RealWorld: 0.9679, caltech: 0.9575, Product: 0.9279, amazon: 0.9182, webcam: 0.9906, Art: 0.8916, Clipart: 0.8371, 
Average Test Accuracy(group): 0.9272, Average Test Accuracy(individual): 0.9478,
domain std=0.0479, cluster std=0.0184, individual std=0.0313, 
Average Test Accuracy: 0.9272
===2023-08-06 20:34:06===
===2023-08-06 20:34:15===
===Setting===
    dataset: officecaltechhome
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[9,12,15,20,25,33,43,55,72,93,11,15,21,30,41,57,79,13,20,29,44,66,20,35,62,27,54,55,37,
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[635,431,293,199,135,92,62,]
domain number = 7
Loading snapshots...
 Test site-RealWorld                 (2)| Epoch:47 | Test Acc: 0.9714
 Test site-caltech                   (5)| Epoch:47 | Test Acc: 0.9547
 Test site-Product                   (0)| Epoch:47 | Test Acc: 0.9344
 Test site-amazon                    (3)| Epoch:47 | Test Acc: 0.9152
 Test site-webcam                    (2)| Epoch:47 | Test Acc: 0.9906
 Test site-Art                       (6)| Epoch:47 | Test Acc: 0.8976
 Test site-Clipart                   (4)| Epoch:47 | Test Acc: 0.8404
RealWorld: 0.9714, caltech: 0.9547, Product: 0.9344, amazon: 0.9152, webcam: 0.9906, Art: 0.8976, Clipart: 0.8404, 
Average Test Accuracy(group): 0.9292, Average Test Accuracy(individual): 0.9494,
domain std=0.0468, cluster std=0.0137, individual std=0.0309, 
