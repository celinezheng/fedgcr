===2023-05-26 21:08:45===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 10
    std_rw: False
data_number=[18,27,40,58,87,127,188,276,406,442,42,61,91,134,197,290,418,67,99,146,215,316,124,182,268,158,232,266,181,]
client_nums=[10,7,5,3,2,1,1,]
domain number = 10
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 6, 6, 5, 1, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.9185 | Train Acc: 0.2778
 Site-White_Female             | Train Loss: 1.8471 | Train Acc: 0.4074
 Site-White_Male               | Train Loss: 2.0289 | Train Acc: 0.3250
 Site-White_Female             | Train Loss: 1.6882 | Train Acc: 0.4483
 Site-White_Male               | Train Loss: 2.1077 | Train Acc: 0.2644
 Site-White_Female             | Train Loss: 1.8080 | Train Acc: 0.3622
 Site-White_Male               | Train Loss: 2.0383 | Train Acc: 0.2447
 Site-White_Female             | Train Loss: 1.8313 | Train Acc: 0.3696
 Site-White_Male               | Train Loss: 2.0890 | Train Acc: 0.2438
 Site-White_Female             | Train Loss: 1.8086 | Train Acc: 0.3710
 Site-Latino_Hispanic_Male     | Train Loss: 1.8719 | Train Acc: 0.2143
 Site-Latino_Hispanic_Female   | Train Loss: 2.0144 | Train Acc: 0.2951
 Site-Latino_Hispanic_Male     | Train Loss: 2.1447 | Train Acc: 0.2308
 Site-Latino_Hispanic_Female   | Train Loss: 1.9331 | Train Acc: 0.2910
 Site-Latino_Hispanic_Male     | Train Loss: 2.1391 | Train Acc: 0.2234
 Site-Latino_Hispanic_Female   | Train Loss: 1.9923 | Train Acc: 0.2759
 Site-Latino_Hispanic_Male     | Train Loss: 2.0346 | Train Acc: 0.2321
 Site-Black_Female             | Train Loss: 1.7318 | Train Acc: 0.3134
 Site-Black_Male               | Train Loss: 2.0054 | Train Acc: 0.2323
 Site-Black_Female             | Train Loss: 1.9131 | Train Acc: 0.3630
 Site-Black_Male               | Train Loss: 1.9916 | Train Acc: 0.2419
 Site-Black_Female             | Train Loss: 1.9259 | Train Acc: 0.2911
 Site-East_Asian_Male          | Train Loss: 1.9257 | Train Acc: 0.3306
 Site-East_Asian_Female        | Train Loss: 1.7283 | Train Acc: 0.4725
 Site-East_Asian_Male          | Train Loss: 1.8937 | Train Acc: 0.3209
 Site-Indian_Female            | Train Loss: 2.2397 | Train Acc: 0.2532
 Site-Indian_Male              | Train Loss: 2.0559 | Train Acc: 0.2241
 Site-Southeast_Asian_Female   | Train Loss: 2.1564 | Train Acc: 0.3271
 Site-Middle_Eastern_Male      | Train Loss: 2.2610 | Train Acc: 0.1713
 Site-White_Male                (6) | Val  Loss: 1.7643 | Val  Acc: 0.5000
 Site-White_Female              (8) | Val  Loss: 2.0021 | Val  Acc: 0.2778
 Site-White_Male                (4) | Val  Loss: 2.1548 | Val  Acc: 0.1923
 Site-White_Female              (0) | Val  Loss: 1.7357 | Val  Acc: 0.4103
 Site-White_Male                (1) | Val  Loss: 2.0757 | Val  Acc: 0.2414
 Site-White_Female              (0) | Val  Loss: 1.8194 | Val  Acc: 0.3765
 Site-White_Male                (1) | Val  Loss: 2.0301 | Val  Acc: 0.2720
 Site-White_Female              (0) | Val  Loss: 1.7890 | Val  Acc: 0.3913
 Site-White_Male                (1) | Val  Loss: 1.9523 | Val  Acc: 0.2620
 Site-White_Female              (0) | Val  Loss: 1.8054 | Val  Acc: 0.3810
 Site-Latino_Hispanic_Male      (5) | Val  Loss: 2.1855 | Val  Acc: 0.3571
 Site-Latino_Hispanic_Female    (9) | Val  Loss: 2.0360 | Val  Acc: 0.2195
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.9121 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (3) | Val  Loss: 2.0053 | Val  Acc: 0.2472
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.8464 | Val  Acc: 0.2137
 Site-Latino_Hispanic_Female    (3) | Val  Loss: 1.7529 | Val  Acc: 0.2591
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 2.0626 | Val  Acc: 0.2266
 Site-Black_Female              (2) | Val  Loss: 2.0388 | Val  Acc: 0.2889
 Site-Black_Male                (2) | Val  Loss: 2.2202 | Val  Acc: 0.1818
 Site-Black_Female              (2) | Val  Loss: 2.0346 | Val  Acc: 0.2990
 Site-Black_Male                (2) | Val  Loss: 1.7166 | Val  Acc: 0.2797
 Site-Black_Female              (2) | Val  Loss: 1.8677 | Val  Acc: 0.3175
 Site-East_Asian_Male           (7) | Val  Loss: 2.1038 | Val  Acc: 0.2683
 Site-East_Asian_Female         (3) | Val  Loss: 1.6981 | Val  Acc: 0.4545
 Site-East_Asian_Male           (7) | Val  Loss: 1.9440 | Val  Acc: 0.2921
 Site-Indian_Female             (3) | Val  Loss: 2.1600 | Val  Acc: 0.2762
 Site-Indian_Male               (2) | Val  Loss: 2.1073 | Val  Acc: 0.1871
 Site-Southeast_Asian_Female    (3) | Val  Loss: 2.1657 | Val  Acc: 0.3164
 Site-Middle_Eastern_Male       (1) | Val  Loss: 2.2901 | Val  Acc: 0.1333
Average Valid Accuracy: 0.2893
Aggregated Acc | Val Acc: 0.3000
 Best site-White_Male               (6)  | Epoch:0 | Val Acc: 0.5000
 Best site-White_Female             (8)  | Epoch:0 | Val Acc: 0.2778
 Best site-White_Male               (4)  | Epoch:0 | Val Acc: 0.1923
 Best site-White_Female             (0)  | Epoch:0 | Val Acc: 0.4103
 Best site-White_Male               (1)  | Epoch:0 | Val Acc: 0.2414
 Best site-White_Female             (0)  | Epoch:0 | Val Acc: 0.3765
 Best site-White_Male               (1)  | Epoch:0 | Val Acc: 0.2720
 Best site-White_Female             (0)  | Epoch:0 | Val Acc: 0.3913
 Best site-White_Male               (1)  | Epoch:0 | Val Acc: 0.2620
 Best site-White_Female             (0)  | Epoch:0 | Val Acc: 0.3810
 Best site-Latino_Hispanic_Male     (5)  | Epoch:0 | Val Acc: 0.3571
 Best site-Latino_Hispanic_Female   (9)  | Epoch:0 | Val Acc: 0.2195
 Best site-Latino_Hispanic_Male     (1)  | Epoch:0 | Val Acc: 0.2667
 Best site-Latino_Hispanic_Female   (3)  | Epoch:0 | Val Acc: 0.2472
 Best site-Latino_Hispanic_Male     (1)  | Epoch:0 | Val Acc: 0.2137
 Best site-Latino_Hispanic_Female   (3)  | Epoch:0 | Val Acc: 0.2591
 Best site-Latino_Hispanic_Male     (7)  | Epoch:0 | Val Acc: 0.2266
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2889
 Best site-Black_Male               (2)  | Epoch:0 | Val Acc: 0.1818
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.2990
 Best site-Black_Male               (2)  | Epoch:0 | Val Acc: 0.2797
 Best site-Black_Female             (2)  | Epoch:0 | Val Acc: 0.3175
 Best site-East_Asian_Male          (7)  | Epoch:0 | Val Acc: 0.2683
 Best site-East_Asian_Female        (3)  | Epoch:0 | Val Acc: 0.4545
 Best site-East_Asian_Male          (7)  | Epoch:0 | Val Acc: 0.2921
 Best site-Indian_Female            (3)  | Epoch:0 | Val Acc: 0.2762
 Best site-Indian_Male              (2)  | Epoch:0 | Val Acc: 0.1871
 Best site-Southeast_Asian_Female   (3)  | Epoch:0 | Val Acc: 0.3164
 Best site-Middle_Eastern_Male      (1)  | Epoch:0 | Val Acc: 0.1333
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 5, 4, 4, 1, 1, 4, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.8336 | Train Acc: 0.2778
 Site-White_Female             | Train Loss: 1.8215 | Train Acc: 0.3704
 Site-White_Male               | Train Loss: 1.9371 | Train Acc: 0.2750
 Site-White_Female             | Train Loss: 1.7147 | Train Acc: 0.3966
 Site-White_Male               | Train Loss: 1.9584 | Train Acc: 0.2529
 Site-White_Female             | Train Loss: 1.8028 | Train Acc: 0.3622
 Site-White_Male               | Train Loss: 1.9425 | Train Acc: 0.2447
 Site-White_Female             | Train Loss: 1.8321 | Train Acc: 0.3623
 Site-White_Male               | Train Loss: 1.9726 | Train Acc: 0.2709
 Site-White_Female             | Train Loss: 1.7893 | Train Acc: 0.3756
 Site-Latino_Hispanic_Male     | Train Loss: 1.8575 | Train Acc: 0.1905
 Site-Latino_Hispanic_Female   | Train Loss: 1.9363 | Train Acc: 0.2787
 Site-Latino_Hispanic_Male     | Train Loss: 2.0440 | Train Acc: 0.2308
 Site-Latino_Hispanic_Female   | Train Loss: 1.8451 | Train Acc: 0.2537
 Site-Latino_Hispanic_Male     | Train Loss: 1.9166 | Train Acc: 0.2437
 Site-Latino_Hispanic_Female   | Train Loss: 1.9016 | Train Acc: 0.2828
 Site-Latino_Hispanic_Male     | Train Loss: 1.9445 | Train Acc: 0.2368
 Site-Black_Female             | Train Loss: 2.0187 | Train Acc: 0.3284
 Site-Black_Male               | Train Loss: 1.9997 | Train Acc: 0.2121
 Site-Black_Female             | Train Loss: 1.8590 | Train Acc: 0.3562
 Site-Black_Male               | Train Loss: 1.9897 | Train Acc: 0.2279
 Site-Black_Female             | Train Loss: 1.8797 | Train Acc: 0.3038
 Site-East_Asian_Male          | Train Loss: 1.8730 | Train Acc: 0.2984
 Site-East_Asian_Female        | Train Loss: 1.7057 | Train Acc: 0.4670
 Site-East_Asian_Male          | Train Loss: 1.8642 | Train Acc: 0.3022
 Site-Indian_Female            | Train Loss: 2.0863 | Train Acc: 0.2722
 Site-Indian_Male              | Train Loss: 1.9970 | Train Acc: 0.2414
 Site-Southeast_Asian_Female   | Train Loss: 2.0989 | Train Acc: 0.3008
 Site-Middle_Eastern_Male      | Train Loss: 2.1501 | Train Acc: 0.1768
 Site-White_Male                (4) | Val  Loss: 1.7558 | Val  Acc: 0.4167
 Site-White_Female              (5) | Val  Loss: 2.0345 | Val  Acc: 0.2778
 Site-White_Male                (1) | Val  Loss: 2.0276 | Val  Acc: 0.1923
 Site-White_Female              (2) | Val  Loss: 1.7508 | Val  Acc: 0.4103
 Site-White_Male                (8) | Val  Loss: 1.9503 | Val  Acc: 0.2759
 Site-White_Female              (2) | Val  Loss: 1.7948 | Val  Acc: 0.4000
 Site-White_Male                (1) | Val  Loss: 1.9623 | Val  Acc: 0.2240
 Site-White_Female              (2) | Val  Loss: 1.7861 | Val  Acc: 0.3913
 Site-White_Male                (1) | Val  Loss: 1.8810 | Val  Acc: 0.2583
 Site-White_Female              (2) | Val  Loss: 1.8039 | Val  Acc: 0.3707
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 2.0429 | Val  Acc: 0.3571
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.9641 | Val  Acc: 0.2195
 Site-Latino_Hispanic_Male      (8) | Val  Loss: 1.8585 | Val  Acc: 0.3000
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.9339 | Val  Acc: 0.2472
 Site-Latino_Hispanic_Male      (8) | Val  Loss: 1.8243 | Val  Acc: 0.2137
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.7524 | Val  Acc: 0.2746
 Site-Latino_Hispanic_Male      (8) | Val  Loss: 1.9358 | Val  Acc: 0.2338
 Site-Black_Female              (9) | Val  Loss: 2.0367 | Val  Acc: 0.2667
 Site-Black_Male                (0) | Val  Loss: 2.2778 | Val  Acc: 0.1970
 Site-Black_Female              (3) | Val  Loss: 1.9702 | Val  Acc: 0.2474
 Site-Black_Male                (0) | Val  Loss: 1.7533 | Val  Acc: 0.2587
 Site-Black_Female              (3) | Val  Loss: 1.8421 | Val  Acc: 0.3128
 Site-East_Asian_Male           (1) | Val  Loss: 2.0250 | Val  Acc: 0.2927
 Site-East_Asian_Female         (6) | Val  Loss: 1.6992 | Val  Acc: 0.4545
 Site-East_Asian_Male           (1) | Val  Loss: 1.9177 | Val  Acc: 0.3034
 Site-Indian_Female             (3) | Val  Loss: 2.0585 | Val  Acc: 0.2952
 Site-Indian_Male               (0) | Val  Loss: 2.0286 | Val  Acc: 0.2323
 Site-Southeast_Asian_Female    (3) | Val  Loss: 2.0827 | Val  Acc: 0.3107
 Site-Middle_Eastern_Male       (8) | Val  Loss: 2.1610 | Val  Acc: 0.1583
Average Valid Accuracy: 0.2894
Aggregated Acc | Val Acc: 0.3022
 Best site-White_Male               (4)  | Epoch:1 | Val Acc: 0.4167
 Best site-White_Female             (5)  | Epoch:1 | Val Acc: 0.2778
 Best site-White_Male               (1)  | Epoch:1 | Val Acc: 0.1923
 Best site-White_Female             (2)  | Epoch:1 | Val Acc: 0.4103
 Best site-White_Male               (8)  | Epoch:1 | Val Acc: 0.2759
 Best site-White_Female             (2)  | Epoch:1 | Val Acc: 0.4000
 Best site-White_Male               (1)  | Epoch:1 | Val Acc: 0.2240
 Best site-White_Female             (2)  | Epoch:1 | Val Acc: 0.3913
 Best site-White_Male               (1)  | Epoch:1 | Val Acc: 0.2583
 Best site-White_Female             (2)  | Epoch:1 | Val Acc: 0.3707
 Best site-Latino_Hispanic_Male     (7)  | Epoch:1 | Val Acc: 0.3571
 Best site-Latino_Hispanic_Female   (6)  | Epoch:1 | Val Acc: 0.2195
 Best site-Latino_Hispanic_Male     (8)  | Epoch:1 | Val Acc: 0.3000
 Best site-Latino_Hispanic_Female   (6)  | Epoch:1 | Val Acc: 0.2472
 Best site-Latino_Hispanic_Male     (8)  | Epoch:1 | Val Acc: 0.2137
 Best site-Latino_Hispanic_Female   (6)  | Epoch:1 | Val Acc: 0.2746
 Best site-Latino_Hispanic_Male     (8)  | Epoch:1 | Val Acc: 0.2338
 Best site-Black_Female             (9)  | Epoch:1 | Val Acc: 0.2667
 Best site-Black_Male               (0)  | Epoch:1 | Val Acc: 0.1970
 Best site-Black_Female             (3)  | Epoch:1 | Val Acc: 0.2474
 Best site-Black_Male               (0)  | Epoch:1 | Val Acc: 0.2587
 Best site-Black_Female             (3)  | Epoch:1 | Val Acc: 0.3128
 Best site-East_Asian_Male          (1)  | Epoch:1 | Val Acc: 0.2927
 Best site-East_Asian_Female        (6)  | Epoch:1 | Val Acc: 0.4545
 Best site-East_Asian_Male          (1)  | Epoch:1 | Val Acc: 0.3034
 Best site-Indian_Female            (3)  | Epoch:1 | Val Acc: 0.2952
 Best site-Indian_Male              (0)  | Epoch:1 | Val Acc: 0.2323
 Best site-Southeast_Asian_Female   (3)  | Epoch:1 | Val Acc: 0.3107
 Best site-Middle_Eastern_Male      (8)  | Epoch:1 | Val Acc: 0.1583
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 6, 1, 2, 3, 6, 4, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.8248 | Train Acc: 0.2778
 Site-White_Female             | Train Loss: 1.8119 | Train Acc: 0.3704
 Site-White_Male               | Train Loss: 1.9216 | Train Acc: 0.3000
 Site-White_Female             | Train Loss: 1.6762 | Train Acc: 0.3966
 Site-White_Male               | Train Loss: 1.9907 | Train Acc: 0.2874
 Site-White_Female             | Train Loss: 1.7790 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.9126 | Train Acc: 0.2340
 Site-White_Female             | Train Loss: 1.8004 | Train Acc: 0.3587
 Site-White_Male               | Train Loss: 1.9324 | Train Acc: 0.2611
 Site-White_Female             | Train Loss: 1.7721 | Train Acc: 0.3756
 Site-Latino_Hispanic_Male     | Train Loss: 1.7991 | Train Acc: 0.1905
 Site-Latino_Hispanic_Female   | Train Loss: 1.9532 | Train Acc: 0.3115
 Site-Latino_Hispanic_Male     | Train Loss: 1.9647 | Train Acc: 0.2418
 Site-Latino_Hispanic_Female   | Train Loss: 1.7976 | Train Acc: 0.2836
 Site-Latino_Hispanic_Male     | Train Loss: 1.8136 | Train Acc: 0.2335
 Site-Latino_Hispanic_Female   | Train Loss: 1.8950 | Train Acc: 0.2966
 Site-Latino_Hispanic_Male     | Train Loss: 1.8915 | Train Acc: 0.2416
 Site-Black_Female             | Train Loss: 1.8240 | Train Acc: 0.3134
 Site-Black_Male               | Train Loss: 2.0096 | Train Acc: 0.1919
 Site-Black_Female             | Train Loss: 1.8143 | Train Acc: 0.3562
 Site-Black_Male               | Train Loss: 1.9651 | Train Acc: 0.2186
 Site-Black_Female             | Train Loss: 1.8719 | Train Acc: 0.3133
 Site-East_Asian_Male          | Train Loss: 1.8757 | Train Acc: 0.3306
 Site-East_Asian_Female        | Train Loss: 1.6824 | Train Acc: 0.4615
 Site-East_Asian_Male          | Train Loss: 1.8278 | Train Acc: 0.3246
 Site-Indian_Female            | Train Loss: 2.0647 | Train Acc: 0.2468
 Site-Indian_Male              | Train Loss: 1.9744 | Train Acc: 0.2241
 Site-Southeast_Asian_Female   | Train Loss: 2.0035 | Train Acc: 0.3158
 Site-Middle_Eastern_Male      | Train Loss: 2.0909 | Train Acc: 0.2099
 Site-White_Male                (8) | Val  Loss: 1.7516 | Val  Acc: 0.5000
 Site-White_Female              (7) | Val  Loss: 1.9534 | Val  Acc: 0.2222
 Site-White_Male                (5) | Val  Loss: 1.9678 | Val  Acc: 0.1923
 Site-White_Female              (1) | Val  Loss: 1.7256 | Val  Acc: 0.3590
 Site-White_Male                (5) | Val  Loss: 1.9651 | Val  Acc: 0.2241
 Site-White_Female              (1) | Val  Loss: 1.7943 | Val  Acc: 0.4000
 Site-White_Male                (5) | Val  Loss: 1.9362 | Val  Acc: 0.2400
 Site-White_Female              (1) | Val  Loss: 1.7794 | Val  Acc: 0.3804
 Site-White_Male                (5) | Val  Loss: 1.8610 | Val  Acc: 0.2694
 Site-White_Female              (1) | Val  Loss: 1.7802 | Val  Acc: 0.3605
 Site-Latino_Hispanic_Male      (5) | Val  Loss: 2.0452 | Val  Acc: 0.3571
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.9617 | Val  Acc: 0.2439
 Site-Latino_Hispanic_Male      (9) | Val  Loss: 1.8405 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (6) | Val  Loss: 1.9308 | Val  Acc: 0.2584
 Site-Latino_Hispanic_Male      (9) | Val  Loss: 1.7844 | Val  Acc: 0.2290
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.7317 | Val  Acc: 0.2642
 Site-Latino_Hispanic_Male      (2) | Val  Loss: 1.9137 | Val  Acc: 0.2266
 Site-Black_Female              (4) | Val  Loss: 2.0005 | Val  Acc: 0.2667
 Site-Black_Male                (0) | Val  Loss: 2.3703 | Val  Acc: 0.2576
 Site-Black_Female              (4) | Val  Loss: 1.9298 | Val  Acc: 0.3196
 Site-Black_Male                (0) | Val  Loss: 1.7368 | Val  Acc: 0.2657
 Site-Black_Female              (4) | Val  Loss: 1.8355 | Val  Acc: 0.3081
 Site-East_Asian_Male           (3) | Val  Loss: 1.9674 | Val  Acc: 0.3171
 Site-East_Asian_Female         (6) | Val  Loss: 1.6869 | Val  Acc: 0.4545
 Site-East_Asian_Male           (3) | Val  Loss: 1.8821 | Val  Acc: 0.3371
 Site-Indian_Female             (6) | Val  Loss: 2.0465 | Val  Acc: 0.2762
 Site-Indian_Male               (9) | Val  Loss: 2.0009 | Val  Acc: 0.2323
 Site-Southeast_Asian_Female    (6) | Val  Loss: 2.0808 | Val  Acc: 0.2938
 Site-Middle_Eastern_Male       (5) | Val  Loss: 2.1457 | Val  Acc: 0.1667
Average Valid Accuracy: 0.2927
Aggregated Acc | Val Acc: 0.2975
 Best site-White_Male               (8)  | Epoch:2 | Val Acc: 0.5000
 Best site-White_Female             (7)  | Epoch:2 | Val Acc: 0.2222
 Best site-White_Male               (5)  | Epoch:2 | Val Acc: 0.1923
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.3590
 Best site-White_Male               (5)  | Epoch:2 | Val Acc: 0.2241
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.4000
 Best site-White_Male               (5)  | Epoch:2 | Val Acc: 0.2400
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.3804
 Best site-White_Male               (5)  | Epoch:2 | Val Acc: 0.2694
 Best site-White_Female             (1)  | Epoch:2 | Val Acc: 0.3605
 Best site-Latino_Hispanic_Male     (5)  | Epoch:2 | Val Acc: 0.3571
 Best site-Latino_Hispanic_Female   (1)  | Epoch:2 | Val Acc: 0.2439
 Best site-Latino_Hispanic_Male     (9)  | Epoch:2 | Val Acc: 0.2667
 Best site-Latino_Hispanic_Female   (6)  | Epoch:2 | Val Acc: 0.2584
 Best site-Latino_Hispanic_Male     (9)  | Epoch:2 | Val Acc: 0.2290
 Best site-Latino_Hispanic_Female   (1)  | Epoch:2 | Val Acc: 0.2642
 Best site-Latino_Hispanic_Male     (2)  | Epoch:2 | Val Acc: 0.2266
 Best site-Black_Female             (4)  | Epoch:2 | Val Acc: 0.2667
 Best site-Black_Male               (0)  | Epoch:2 | Val Acc: 0.2576
 Best site-Black_Female             (4)  | Epoch:2 | Val Acc: 0.3196
 Best site-Black_Male               (0)  | Epoch:2 | Val Acc: 0.2657
 Best site-Black_Female             (4)  | Epoch:2 | Val Acc: 0.3081
 Best site-East_Asian_Male          (3)  | Epoch:2 | Val Acc: 0.3171
 Best site-East_Asian_Female        (6)  | Epoch:2 | Val Acc: 0.4545
 Best site-East_Asian_Male          (3)  | Epoch:2 | Val Acc: 0.3371
 Best site-Indian_Female            (6)  | Epoch:2 | Val Acc: 0.2762
 Best site-Indian_Male              (9)  | Epoch:2 | Val Acc: 0.2323
 Best site-Southeast_Asian_Female   (6)  | Epoch:2 | Val Acc: 0.2938
 Best site-Middle_Eastern_Male      (5)  | Epoch:2 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 6, 1, 1, 6, 5, 1, 2, 3, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.8391 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.7453 | Train Acc: 0.4074
 Site-White_Male               | Train Loss: 1.8533 | Train Acc: 0.3750
 Site-White_Female             | Train Loss: 1.6862 | Train Acc: 0.4138
 Site-White_Male               | Train Loss: 1.9888 | Train Acc: 0.2644
 Site-White_Female             | Train Loss: 1.7262 | Train Acc: 0.3780
 Site-White_Male               | Train Loss: 1.8931 | Train Acc: 0.2660
 Site-White_Female             | Train Loss: 1.7951 | Train Acc: 0.3587
 Site-White_Male               | Train Loss: 1.9139 | Train Acc: 0.2808
 Site-White_Female             | Train Loss: 1.7566 | Train Acc: 0.3756
 Site-Latino_Hispanic_Male     | Train Loss: 1.8320 | Train Acc: 0.1905
 Site-Latino_Hispanic_Female   | Train Loss: 1.9085 | Train Acc: 0.2623
 Site-Latino_Hispanic_Male     | Train Loss: 1.9068 | Train Acc: 0.2088
 Site-Latino_Hispanic_Female   | Train Loss: 1.9653 | Train Acc: 0.2910
 Site-Latino_Hispanic_Male     | Train Loss: 1.9735 | Train Acc: 0.2690
 Site-Latino_Hispanic_Female   | Train Loss: 1.8599 | Train Acc: 0.2862
 Site-Latino_Hispanic_Male     | Train Loss: 1.9018 | Train Acc: 0.2440
 Site-Black_Female             | Train Loss: 2.1269 | Train Acc: 0.2388
 Site-Black_Male               | Train Loss: 1.9285 | Train Acc: 0.2222
 Site-Black_Female             | Train Loss: 1.8567 | Train Acc: 0.3288
 Site-Black_Male               | Train Loss: 1.9233 | Train Acc: 0.2605
 Site-Black_Female             | Train Loss: 1.8398 | Train Acc: 0.3133
 Site-East_Asian_Male          | Train Loss: 1.8133 | Train Acc: 0.2984
 Site-East_Asian_Female        | Train Loss: 1.6661 | Train Acc: 0.4505
 Site-East_Asian_Male          | Train Loss: 1.8548 | Train Acc: 0.3060
 Site-Indian_Female            | Train Loss: 2.0227 | Train Acc: 0.2595
 Site-Indian_Male              | Train Loss: 1.9078 | Train Acc: 0.2284
 Site-Southeast_Asian_Female   | Train Loss: 1.9536 | Train Acc: 0.3271
 Site-Middle_Eastern_Male      | Train Loss: 2.0351 | Train Acc: 0.2155
 Site-White_Male                (0) | Val  Loss: 1.7070 | Val  Acc: 0.4167
 Site-White_Female              (6) | Val  Loss: 1.9317 | Val  Acc: 0.2778
 Site-White_Male                (4) | Val  Loss: 1.9721 | Val  Acc: 0.2308
 Site-White_Female              (3) | Val  Loss: 1.7167 | Val  Acc: 0.4103
 Site-White_Male                (4) | Val  Loss: 1.9013 | Val  Acc: 0.2414
 Site-White_Female              (9) | Val  Loss: 1.7592 | Val  Acc: 0.3882
 Site-White_Male                (4) | Val  Loss: 1.8946 | Val  Acc: 0.2720
 Site-White_Female              (9) | Val  Loss: 1.7832 | Val  Acc: 0.3804
 Site-White_Male                (4) | Val  Loss: 1.8352 | Val  Acc: 0.2731
 Site-White_Female              (9) | Val  Loss: 1.7703 | Val  Acc: 0.3741
 Site-Latino_Hispanic_Male      (4) | Val  Loss: 1.9818 | Val  Acc: 0.2500
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.9595 | Val  Acc: 0.2683
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.8161 | Val  Acc: 0.3500
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.8950 | Val  Acc: 0.2584
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.7707 | Val  Acc: 0.1832
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.7379 | Val  Acc: 0.2228
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.8890 | Val  Acc: 0.2158
 Site-Black_Female              (8) | Val  Loss: 1.9885 | Val  Acc: 0.2889
 Site-Black_Male                (1) | Val  Loss: 2.1687 | Val  Acc: 0.2576
 Site-Black_Female              (8) | Val  Loss: 1.9045 | Val  Acc: 0.2887
 Site-Black_Male                (1) | Val  Loss: 1.7142 | Val  Acc: 0.2867
 Site-Black_Female              (8) | Val  Loss: 1.8059 | Val  Acc: 0.2986
 Site-East_Asian_Male           (7) | Val  Loss: 1.9035 | Val  Acc: 0.3537
 Site-East_Asian_Female         (5) | Val  Loss: 1.6572 | Val  Acc: 0.4545
 Site-East_Asian_Male           (7) | Val  Loss: 1.8478 | Val  Acc: 0.3090
 Site-Indian_Female             (2) | Val  Loss: 2.0282 | Val  Acc: 0.2952
 Site-Indian_Male               (1) | Val  Loss: 1.9643 | Val  Acc: 0.2387
 Site-Southeast_Asian_Female    (5) | Val  Loss: 2.0439 | Val  Acc: 0.2712
 Site-Middle_Eastern_Male       (4) | Val  Loss: 2.0952 | Val  Acc: 0.1750
Average Valid Accuracy: 0.2942
Aggregated Acc | Val Acc: 0.3195
 Best site-White_Male               (0)  | Epoch:3 | Val Acc: 0.4167
 Best site-White_Female             (6)  | Epoch:3 | Val Acc: 0.2778
 Best site-White_Male               (4)  | Epoch:3 | Val Acc: 0.2308
 Best site-White_Female             (3)  | Epoch:3 | Val Acc: 0.4103
 Best site-White_Male               (4)  | Epoch:3 | Val Acc: 0.2414
 Best site-White_Female             (9)  | Epoch:3 | Val Acc: 0.3882
 Best site-White_Male               (4)  | Epoch:3 | Val Acc: 0.2720
 Best site-White_Female             (9)  | Epoch:3 | Val Acc: 0.3804
 Best site-White_Male               (4)  | Epoch:3 | Val Acc: 0.2731
 Best site-White_Female             (9)  | Epoch:3 | Val Acc: 0.3741
 Best site-Latino_Hispanic_Male     (4)  | Epoch:3 | Val Acc: 0.2500
 Best site-Latino_Hispanic_Female   (5)  | Epoch:3 | Val Acc: 0.2683
 Best site-Latino_Hispanic_Male     (1)  | Epoch:3 | Val Acc: 0.3500
 Best site-Latino_Hispanic_Female   (5)  | Epoch:3 | Val Acc: 0.2584
 Best site-Latino_Hispanic_Male     (1)  | Epoch:3 | Val Acc: 0.1832
 Best site-Latino_Hispanic_Female   (5)  | Epoch:3 | Val Acc: 0.2228
 Best site-Latino_Hispanic_Male     (1)  | Epoch:3 | Val Acc: 0.2158
 Best site-Black_Female             (8)  | Epoch:3 | Val Acc: 0.2889
 Best site-Black_Male               (1)  | Epoch:3 | Val Acc: 0.2576
 Best site-Black_Female             (8)  | Epoch:3 | Val Acc: 0.2887
 Best site-Black_Male               (1)  | Epoch:3 | Val Acc: 0.2867
 Best site-Black_Female             (8)  | Epoch:3 | Val Acc: 0.2986
 Best site-East_Asian_Male          (7)  | Epoch:3 | Val Acc: 0.3537
 Best site-East_Asian_Female        (5)  | Epoch:3 | Val Acc: 0.4545
 Best site-East_Asian_Male          (7)  | Epoch:3 | Val Acc: 0.3090
 Best site-Indian_Female            (2)  | Epoch:3 | Val Acc: 0.2952
 Best site-Indian_Male              (1)  | Epoch:3 | Val Acc: 0.2387
 Best site-Southeast_Asian_Female   (5)  | Epoch:3 | Val Acc: 0.2712
 Best site-Middle_Eastern_Male      (4)  | Epoch:3 | Val Acc: 0.1750
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 10, 1, 5, 3, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.8422 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.7627 | Train Acc: 0.4074
 Site-White_Male               | Train Loss: 1.8244 | Train Acc: 0.2750
 Site-White_Female             | Train Loss: 1.6572 | Train Acc: 0.3966
 Site-White_Male               | Train Loss: 1.9509 | Train Acc: 0.2874
 Site-White_Female             | Train Loss: 1.7388 | Train Acc: 0.3701
 Site-White_Male               | Train Loss: 1.8411 | Train Acc: 0.2660
 Site-White_Female             | Train Loss: 1.7825 | Train Acc: 0.3732
 Site-White_Male               | Train Loss: 1.8658 | Train Acc: 0.2882
 Site-White_Female             | Train Loss: 1.7256 | Train Acc: 0.3778
 Site-Latino_Hispanic_Male     | Train Loss: 1.7456 | Train Acc: 0.2857
 Site-Latino_Hispanic_Female   | Train Loss: 1.8934 | Train Acc: 0.2459
 Site-Latino_Hispanic_Male     | Train Loss: 1.8796 | Train Acc: 0.2418
 Site-Latino_Hispanic_Female   | Train Loss: 1.8708 | Train Acc: 0.2985
 Site-Latino_Hispanic_Male     | Train Loss: 1.8096 | Train Acc: 0.2741
 Site-Latino_Hispanic_Female   | Train Loss: 1.8335 | Train Acc: 0.3172
 Site-Latino_Hispanic_Male     | Train Loss: 1.8376 | Train Acc: 0.2632
 Site-Black_Female             | Train Loss: 1.6509 | Train Acc: 0.3433
 Site-Black_Male               | Train Loss: 1.9282 | Train Acc: 0.2222
 Site-Black_Female             | Train Loss: 1.7520 | Train Acc: 0.3630
 Site-Black_Male               | Train Loss: 1.8586 | Train Acc: 0.2512
 Site-Black_Female             | Train Loss: 1.8070 | Train Acc: 0.3196
 Site-East_Asian_Male          | Train Loss: 1.7899 | Train Acc: 0.2581
 Site-East_Asian_Female        | Train Loss: 1.6411 | Train Acc: 0.4560
 Site-East_Asian_Male          | Train Loss: 1.8228 | Train Acc: 0.3022
 Site-Indian_Female            | Train Loss: 1.9315 | Train Acc: 0.2658
 Site-Indian_Male              | Train Loss: 1.8770 | Train Acc: 0.2241
 Site-Southeast_Asian_Female   | Train Loss: 1.9123 | Train Acc: 0.2932
 Site-Middle_Eastern_Male      | Train Loss: 2.0025 | Train Acc: 0.1934
 Site-White_Male                (9) | Val  Loss: 1.7523 | Val  Acc: 0.3333
 Site-White_Female              (7) | Val  Loss: 1.9223 | Val  Acc: 0.3333
 Site-White_Male                (8) | Val  Loss: 1.9146 | Val  Acc: 0.1923
 Site-White_Female              (1) | Val  Loss: 1.7368 | Val  Acc: 0.3846
 Site-White_Male                (2) | Val  Loss: 1.8946 | Val  Acc: 0.2759
 Site-White_Female              (1) | Val  Loss: 1.7814 | Val  Acc: 0.3412
 Site-White_Male                (3) | Val  Loss: 1.8654 | Val  Acc: 0.2880
 Site-White_Female              (1) | Val  Loss: 1.7632 | Val  Acc: 0.3533
 Site-White_Male                (3) | Val  Loss: 1.7912 | Val  Acc: 0.3210
 Site-White_Female              (1) | Val  Loss: 1.7651 | Val  Acc: 0.3435
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.9209 | Val  Acc: 0.2857
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.9044 | Val  Acc: 0.2195
 Site-Latino_Hispanic_Male      (5) | Val  Loss: 1.8250 | Val  Acc: 0.2667
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.8683 | Val  Acc: 0.2697
 Site-Latino_Hispanic_Male      (5) | Val  Loss: 1.7312 | Val  Acc: 0.1450
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.6936 | Val  Acc: 0.2487
 Site-Latino_Hispanic_Male      (5) | Val  Loss: 1.8625 | Val  Acc: 0.2518
 Site-Black_Female              (4) | Val  Loss: 1.9260 | Val  Acc: 0.2444
 Site-Black_Male                (0) | Val  Loss: 2.1919 | Val  Acc: 0.3030
 Site-Black_Female              (4) | Val  Loss: 1.8884 | Val  Acc: 0.2577
 Site-Black_Male                (0) | Val  Loss: 1.7124 | Val  Acc: 0.2797
 Site-Black_Female              (4) | Val  Loss: 1.7829 | Val  Acc: 0.3081
 Site-East_Asian_Male           (3) | Val  Loss: 1.8515 | Val  Acc: 0.3293
 Site-East_Asian_Female         (1) | Val  Loss: 1.6166 | Val  Acc: 0.4463
 Site-East_Asian_Male           (3) | Val  Loss: 1.7881 | Val  Acc: 0.3146
 Site-Indian_Female             (1) | Val  Loss: 1.9879 | Val  Acc: 0.2952
 Site-Indian_Male               (0) | Val  Loss: 1.9145 | Val  Acc: 0.2194
 Site-Southeast_Asian_Female    (1) | Val  Loss: 2.0155 | Val  Acc: 0.3107
 Site-Middle_Eastern_Male       (3) | Val  Loss: 2.0283 | Val  Acc: 0.2000
Average Valid Accuracy: 0.2883
Aggregated Acc | Val Acc: 0.2791
============ Train epoch 5 ============
cnt=[6, 5, 6, 3, 1, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.7066 | Train Acc: 0.3889
 Site-White_Female             | Train Loss: 1.6657 | Train Acc: 0.4444
 Site-White_Male               | Train Loss: 1.7978 | Train Acc: 0.4000
 Site-White_Female             | Train Loss: 1.6305 | Train Acc: 0.4483
 Site-White_Male               | Train Loss: 1.8287 | Train Acc: 0.3563
 Site-White_Female             | Train Loss: 1.6855 | Train Acc: 0.3858
 Site-White_Male               | Train Loss: 1.8308 | Train Acc: 0.2979
 Site-White_Female             | Train Loss: 1.7154 | Train Acc: 0.3768
 Site-White_Male               | Train Loss: 1.8117 | Train Acc: 0.3030
 Site-White_Female             | Train Loss: 1.6940 | Train Acc: 0.3869
 Site-Latino_Hispanic_Male     | Train Loss: 1.7568 | Train Acc: 0.2381
 Site-Latino_Hispanic_Female   | Train Loss: 1.8484 | Train Acc: 0.2787
 Site-Latino_Hispanic_Male     | Train Loss: 1.9020 | Train Acc: 0.2418
 Site-Latino_Hispanic_Female   | Train Loss: 1.7285 | Train Acc: 0.2910
 Site-Latino_Hispanic_Male     | Train Loss: 1.8520 | Train Acc: 0.2792
 Site-Latino_Hispanic_Female   | Train Loss: 1.7877 | Train Acc: 0.3034
 Site-Latino_Hispanic_Male     | Train Loss: 1.8123 | Train Acc: 0.2990
 Site-Black_Female             | Train Loss: 1.8253 | Train Acc: 0.2687
 Site-Black_Male               | Train Loss: 1.9291 | Train Acc: 0.2121
 Site-Black_Female             | Train Loss: 1.8176 | Train Acc: 0.3904
 Site-Black_Male               | Train Loss: 1.8632 | Train Acc: 0.2605
 Site-Black_Female             | Train Loss: 1.7901 | Train Acc: 0.2816
 Site-East_Asian_Male          | Train Loss: 1.7372 | Train Acc: 0.3145
 Site-East_Asian_Female        | Train Loss: 1.6249 | Train Acc: 0.4451
 Site-East_Asian_Male          | Train Loss: 1.6878 | Train Acc: 0.3657
 Site-Indian_Female            | Train Loss: 1.9198 | Train Acc: 0.2785
 Site-Indian_Male              | Train Loss: 1.8342 | Train Acc: 0.3017
 Site-Southeast_Asian_Female   | Train Loss: 1.7855 | Train Acc: 0.3271
 Site-Middle_Eastern_Male      | Train Loss: 1.8918 | Train Acc: 0.2320
 Site-White_Male                (4) | Val  Loss: 1.6935 | Val  Acc: 0.4167
 Site-White_Female              (9) | Val  Loss: 1.9901 | Val  Acc: 0.2778
 Site-White_Male                (8) | Val  Loss: 1.9113 | Val  Acc: 0.2308
 Site-White_Female              (1) | Val  Loss: 1.7104 | Val  Acc: 0.3333
 Site-White_Male                (0) | Val  Loss: 1.8180 | Val  Acc: 0.2931
 Site-White_Female              (1) | Val  Loss: 1.7112 | Val  Acc: 0.4000
 Site-White_Male                (0) | Val  Loss: 1.7929 | Val  Acc: 0.3120
 Site-White_Female              (1) | Val  Loss: 1.7552 | Val  Acc: 0.3261
 Site-White_Male                (0) | Val  Loss: 1.7691 | Val  Acc: 0.3542
 Site-White_Female              (1) | Val  Loss: 1.7333 | Val  Acc: 0.3844
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.9554 | Val  Acc: 0.1786
 Site-Latino_Hispanic_Female    (7) | Val  Loss: 1.8601 | Val  Acc: 0.3171
 Site-Latino_Hispanic_Male      (2) | Val  Loss: 1.8309 | Val  Acc: 0.3500
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.7952 | Val  Acc: 0.2697
 Site-Latino_Hispanic_Male      (2) | Val  Loss: 1.7393 | Val  Acc: 0.2519
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.6796 | Val  Acc: 0.2694
 Site-Latino_Hispanic_Male      (2) | Val  Loss: 1.8335 | Val  Acc: 0.2626
 Site-Black_Female              (3) | Val  Loss: 1.9453 | Val  Acc: 0.2000
 Site-Black_Male                (2) | Val  Loss: 2.1418 | Val  Acc: 0.3030
 Site-Black_Female              (3) | Val  Loss: 1.8452 | Val  Acc: 0.3505
 Site-Black_Male                (2) | Val  Loss: 1.7266 | Val  Acc: 0.2937
 Site-Black_Female              (3) | Val  Loss: 1.7770 | Val  Acc: 0.3128
 Site-East_Asian_Male           (0) | Val  Loss: 1.7623 | Val  Acc: 0.3902
 Site-East_Asian_Female         (1) | Val  Loss: 1.6282 | Val  Acc: 0.4380
 Site-East_Asian_Male           (0) | Val  Loss: 1.7588 | Val  Acc: 0.3652
 Site-Indian_Female             (5) | Val  Loss: 1.8967 | Val  Acc: 0.2857
 Site-Indian_Male               (2) | Val  Loss: 1.8556 | Val  Acc: 0.2194
 Site-Southeast_Asian_Female    (5) | Val  Loss: 1.9717 | Val  Acc: 0.2655
 Site-Middle_Eastern_Male       (0) | Val  Loss: 1.9374 | Val  Acc: 0.2417
Average Valid Accuracy: 0.3067
Aggregated Acc | Val Acc: 0.2964
 Best site-White_Male               (4)  | Epoch:5 | Val Acc: 0.4167
 Best site-White_Female             (9)  | Epoch:5 | Val Acc: 0.2778
 Best site-White_Male               (8)  | Epoch:5 | Val Acc: 0.2308
 Best site-White_Female             (1)  | Epoch:5 | Val Acc: 0.3333
 Best site-White_Male               (0)  | Epoch:5 | Val Acc: 0.2931
 Best site-White_Female             (1)  | Epoch:5 | Val Acc: 0.4000
 Best site-White_Male               (0)  | Epoch:5 | Val Acc: 0.3120
 Best site-White_Female             (1)  | Epoch:5 | Val Acc: 0.3261
 Best site-White_Male               (0)  | Epoch:5 | Val Acc: 0.3542
 Best site-White_Female             (1)  | Epoch:5 | Val Acc: 0.3844
 Best site-Latino_Hispanic_Male     (6)  | Epoch:5 | Val Acc: 0.1786
 Best site-Latino_Hispanic_Female   (7)  | Epoch:5 | Val Acc: 0.3171
 Best site-Latino_Hispanic_Male     (2)  | Epoch:5 | Val Acc: 0.3500
 Best site-Latino_Hispanic_Female   (5)  | Epoch:5 | Val Acc: 0.2697
 Best site-Latino_Hispanic_Male     (2)  | Epoch:5 | Val Acc: 0.2519
 Best site-Latino_Hispanic_Female   (5)  | Epoch:5 | Val Acc: 0.2694
 Best site-Latino_Hispanic_Male     (2)  | Epoch:5 | Val Acc: 0.2626
 Best site-Black_Female             (3)  | Epoch:5 | Val Acc: 0.2000
 Best site-Black_Male               (2)  | Epoch:5 | Val Acc: 0.3030
 Best site-Black_Female             (3)  | Epoch:5 | Val Acc: 0.3505
 Best site-Black_Male               (2)  | Epoch:5 | Val Acc: 0.2937
 Best site-Black_Female             (3)  | Epoch:5 | Val Acc: 0.3128
 Best site-East_Asian_Male          (0)  | Epoch:5 | Val Acc: 0.3902
 Best site-East_Asian_Female        (1)  | Epoch:5 | Val Acc: 0.4380
 Best site-East_Asian_Male          (0)  | Epoch:5 | Val Acc: 0.3652
 Best site-Indian_Female            (5)  | Epoch:5 | Val Acc: 0.2857
 Best site-Indian_Male              (2)  | Epoch:5 | Val Acc: 0.2194
 Best site-Southeast_Asian_Female   (5)  | Epoch:5 | Val Acc: 0.2655
 Best site-Middle_Eastern_Male      (0)  | Epoch:5 | Val Acc: 0.2417
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 4, 3, 1, 7, 4, 2, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.7830 | Train Acc: 0.3889
 Site-White_Female             | Train Loss: 1.6444 | Train Acc: 0.4074
 Site-White_Male               | Train Loss: 1.7089 | Train Acc: 0.4750
 Site-White_Female             | Train Loss: 1.5928 | Train Acc: 0.4828
 Site-White_Male               | Train Loss: 1.7984 | Train Acc: 0.3448
 Site-White_Female             | Train Loss: 1.6664 | Train Acc: 0.4173
 Site-White_Male               | Train Loss: 1.8036 | Train Acc: 0.2979
 Site-White_Female             | Train Loss: 1.6767 | Train Acc: 0.3659
 Site-White_Male               | Train Loss: 1.7394 | Train Acc: 0.2980
 Site-White_Female             | Train Loss: 1.6447 | Train Acc: 0.4095
 Site-Latino_Hispanic_Male     | Train Loss: 1.7961 | Train Acc: 0.2619
 Site-Latino_Hispanic_Female   | Train Loss: 1.8113 | Train Acc: 0.2951
 Site-Latino_Hispanic_Male     | Train Loss: 1.8264 | Train Acc: 0.3077
 Site-Latino_Hispanic_Female   | Train Loss: 1.8776 | Train Acc: 0.3134
 Site-Latino_Hispanic_Male     | Train Loss: 1.6963 | Train Acc: 0.3198
 Site-Latino_Hispanic_Female   | Train Loss: 1.7333 | Train Acc: 0.3310
 Site-Latino_Hispanic_Male     | Train Loss: 1.7713 | Train Acc: 0.2943
 Site-Black_Female             | Train Loss: 1.7488 | Train Acc: 0.3582
 Site-Black_Male               | Train Loss: 1.9221 | Train Acc: 0.2323
 Site-Black_Female             | Train Loss: 1.7759 | Train Acc: 0.3836
 Site-Black_Male               | Train Loss: 1.7878 | Train Acc: 0.2837
 Site-Black_Female             | Train Loss: 1.7534 | Train Acc: 0.3165
 Site-East_Asian_Male          | Train Loss: 1.6987 | Train Acc: 0.3468
 Site-East_Asian_Female        | Train Loss: 1.5831 | Train Acc: 0.4615
 Site-East_Asian_Male          | Train Loss: 1.6695 | Train Acc: 0.3545
 Site-Indian_Female            | Train Loss: 1.8915 | Train Acc: 0.2532
 Site-Indian_Male              | Train Loss: 1.7611 | Train Acc: 0.3405
 Site-Southeast_Asian_Female   | Train Loss: 1.8661 | Train Acc: 0.3421
 Site-Middle_Eastern_Male      | Train Loss: 1.8650 | Train Acc: 0.2486
 Site-White_Male                (9) | Val  Loss: 1.5941 | Val  Acc: 0.4167
 Site-White_Female              (5) | Val  Loss: 1.9165 | Val  Acc: 0.3333
 Site-White_Male                (4) | Val  Loss: 1.8632 | Val  Acc: 0.1538
 Site-White_Female              (8) | Val  Loss: 1.6832 | Val  Acc: 0.3846
 Site-White_Male                (4) | Val  Loss: 1.7689 | Val  Acc: 0.2931
 Site-White_Female              (5) | Val  Loss: 1.6856 | Val  Acc: 0.4471
 Site-White_Male                (4) | Val  Loss: 1.7809 | Val  Acc: 0.2880
 Site-White_Female              (5) | Val  Loss: 1.7390 | Val  Acc: 0.3804
 Site-White_Male                (4) | Val  Loss: 1.7068 | Val  Acc: 0.3358
 Site-White_Female              (5) | Val  Loss: 1.6858 | Val  Acc: 0.4048
 Site-Latino_Hispanic_Male      (3) | Val  Loss: 1.9144 | Val  Acc: 0.3214
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.8939 | Val  Acc: 0.2927
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.8300 | Val  Acc: 0.2500
 Site-Latino_Hispanic_Female    (8) | Val  Loss: 1.7859 | Val  Acc: 0.2584
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.6507 | Val  Acc: 0.2595
 Site-Latino_Hispanic_Female    (8) | Val  Loss: 1.5993 | Val  Acc: 0.3057
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.7997 | Val  Acc: 0.3022
 Site-Black_Female              (6) | Val  Loss: 1.9227 | Val  Acc: 0.2667
 Site-Black_Male                (7) | Val  Loss: 2.3576 | Val  Acc: 0.2576
 Site-Black_Female              (2) | Val  Loss: 1.8130 | Val  Acc: 0.3196
 Site-Black_Male                (7) | Val  Loss: 1.7116 | Val  Acc: 0.2797
 Site-Black_Female              (6) | Val  Loss: 1.7170 | Val  Acc: 0.3223
 Site-East_Asian_Male           (4) | Val  Loss: 1.7222 | Val  Acc: 0.3537
 Site-East_Asian_Female         (8) | Val  Loss: 1.5463 | Val  Acc: 0.4628
 Site-East_Asian_Male           (4) | Val  Loss: 1.7243 | Val  Acc: 0.3708
 Site-Indian_Female             (2) | Val  Loss: 1.8364 | Val  Acc: 0.2952
 Site-Indian_Male               (1) | Val  Loss: 1.8329 | Val  Acc: 0.2258
 Site-Southeast_Asian_Female    (2) | Val  Loss: 1.9242 | Val  Acc: 0.2938
 Site-Middle_Eastern_Male       (4) | Val  Loss: 1.9176 | Val  Acc: 0.2833
Average Valid Accuracy: 0.3158
Aggregated Acc | Val Acc: 0.3197
 Best site-White_Male               (9)  | Epoch:6 | Val Acc: 0.4167
 Best site-White_Female             (5)  | Epoch:6 | Val Acc: 0.3333
 Best site-White_Male               (4)  | Epoch:6 | Val Acc: 0.1538
 Best site-White_Female             (8)  | Epoch:6 | Val Acc: 0.3846
 Best site-White_Male               (4)  | Epoch:6 | Val Acc: 0.2931
 Best site-White_Female             (5)  | Epoch:6 | Val Acc: 0.4471
 Best site-White_Male               (4)  | Epoch:6 | Val Acc: 0.2880
 Best site-White_Female             (5)  | Epoch:6 | Val Acc: 0.3804
 Best site-White_Male               (4)  | Epoch:6 | Val Acc: 0.3358
 Best site-White_Female             (5)  | Epoch:6 | Val Acc: 0.4048
 Best site-Latino_Hispanic_Male     (3)  | Epoch:6 | Val Acc: 0.3214
 Best site-Latino_Hispanic_Female   (0)  | Epoch:6 | Val Acc: 0.2927
 Best site-Latino_Hispanic_Male     (1)  | Epoch:6 | Val Acc: 0.2500
 Best site-Latino_Hispanic_Female   (8)  | Epoch:6 | Val Acc: 0.2584
 Best site-Latino_Hispanic_Male     (1)  | Epoch:6 | Val Acc: 0.2595
 Best site-Latino_Hispanic_Female   (8)  | Epoch:6 | Val Acc: 0.3057
 Best site-Latino_Hispanic_Male     (1)  | Epoch:6 | Val Acc: 0.3022
 Best site-Black_Female             (6)  | Epoch:6 | Val Acc: 0.2667
 Best site-Black_Male               (7)  | Epoch:6 | Val Acc: 0.2576
 Best site-Black_Female             (2)  | Epoch:6 | Val Acc: 0.3196
 Best site-Black_Male               (7)  | Epoch:6 | Val Acc: 0.2797
 Best site-Black_Female             (6)  | Epoch:6 | Val Acc: 0.3223
 Best site-East_Asian_Male          (4)  | Epoch:6 | Val Acc: 0.3537
 Best site-East_Asian_Female        (8)  | Epoch:6 | Val Acc: 0.4628
 Best site-East_Asian_Male          (4)  | Epoch:6 | Val Acc: 0.3708
 Best site-Indian_Female            (2)  | Epoch:6 | Val Acc: 0.2952
 Best site-Indian_Male              (1)  | Epoch:6 | Val Acc: 0.2258
 Best site-Southeast_Asian_Female   (2)  | Epoch:6 | Val Acc: 0.2938
 Best site-Middle_Eastern_Male      (4)  | Epoch:6 | Val Acc: 0.2833
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 6, 3, 5, 5, 1, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.7259 | Train Acc: 0.2222
 Site-White_Female             | Train Loss: 1.6009 | Train Acc: 0.4815
 Site-White_Male               | Train Loss: 1.7417 | Train Acc: 0.4000
 Site-White_Female             | Train Loss: 1.5679 | Train Acc: 0.4138
 Site-White_Male               | Train Loss: 1.6842 | Train Acc: 0.3563
 Site-White_Female             | Train Loss: 1.6336 | Train Acc: 0.4252
 Site-White_Male               | Train Loss: 1.7544 | Train Acc: 0.3191
 Site-White_Female             | Train Loss: 1.6507 | Train Acc: 0.3913
 Site-White_Male               | Train Loss: 1.7050 | Train Acc: 0.3128
 Site-White_Female             | Train Loss: 1.6052 | Train Acc: 0.4163
 Site-Latino_Hispanic_Male     | Train Loss: 1.7512 | Train Acc: 0.2381
 Site-Latino_Hispanic_Female   | Train Loss: 1.7563 | Train Acc: 0.3443
 Site-Latino_Hispanic_Male     | Train Loss: 1.7807 | Train Acc: 0.2418
 Site-Latino_Hispanic_Female   | Train Loss: 1.6082 | Train Acc: 0.3657
 Site-Latino_Hispanic_Male     | Train Loss: 1.6875 | Train Acc: 0.3249
 Site-Latino_Hispanic_Female   | Train Loss: 1.7083 | Train Acc: 0.3345
 Site-Latino_Hispanic_Male     | Train Loss: 1.7356 | Train Acc: 0.2990
 Site-Black_Female             | Train Loss: 1.8028 | Train Acc: 0.3433
 Site-Black_Male               | Train Loss: 1.8853 | Train Acc: 0.2323
 Site-Black_Female             | Train Loss: 1.7102 | Train Acc: 0.3356
 Site-Black_Male               | Train Loss: 1.8249 | Train Acc: 0.2791
 Site-Black_Female             | Train Loss: 1.7215 | Train Acc: 0.3101
 Site-East_Asian_Male          | Train Loss: 1.6531 | Train Acc: 0.3306
 Site-East_Asian_Female        | Train Loss: 1.5387 | Train Acc: 0.4835
 Site-East_Asian_Male          | Train Loss: 1.6112 | Train Acc: 0.3433
 Site-Indian_Female            | Train Loss: 1.8647 | Train Acc: 0.2911
 Site-Indian_Male              | Train Loss: 1.7520 | Train Acc: 0.3276
 Site-Southeast_Asian_Female   | Train Loss: 1.8331 | Train Acc: 0.3684
 Site-Middle_Eastern_Male      | Train Loss: 1.8095 | Train Acc: 0.2762
 Site-White_Male                (4) | Val  Loss: 1.5740 | Val  Acc: 0.3333
 Site-White_Female              (3) | Val  Loss: 1.9315 | Val  Acc: 0.3889
 Site-White_Male                (8) | Val  Loss: 1.7584 | Val  Acc: 0.2308
 Site-White_Female              (3) | Val  Loss: 1.6456 | Val  Acc: 0.3333
 Site-White_Male                (4) | Val  Loss: 1.7249 | Val  Acc: 0.3276
 Site-White_Female              (3) | Val  Loss: 1.6021 | Val  Acc: 0.4353
 Site-White_Male                (4) | Val  Loss: 1.7486 | Val  Acc: 0.3360
 Site-White_Female              (3) | Val  Loss: 1.6790 | Val  Acc: 0.4130
 Site-White_Male                (4) | Val  Loss: 1.6654 | Val  Acc: 0.3432
 Site-White_Female              (3) | Val  Loss: 1.6454 | Val  Acc: 0.3946
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.8779 | Val  Acc: 0.2857
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.9118 | Val  Acc: 0.2683
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 1.7693 | Val  Acc: 0.3833
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.7666 | Val  Acc: 0.2809
 Site-Latino_Hispanic_Male      (7) | Val  Loss: 1.6593 | Val  Acc: 0.2519
 Site-Latino_Hispanic_Female    (1) | Val  Loss: 1.5870 | Val  Acc: 0.3109
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.7650 | Val  Acc: 0.2662
 Site-Black_Female              (2) | Val  Loss: 1.8801 | Val  Acc: 0.2667
 Site-Black_Male                (7) | Val  Loss: 2.4308 | Val  Acc: 0.3333
 Site-Black_Female              (2) | Val  Loss: 1.7952 | Val  Acc: 0.3196
 Site-Black_Male                (5) | Val  Loss: 1.6552 | Val  Acc: 0.3147
 Site-Black_Female              (2) | Val  Loss: 1.6985 | Val  Acc: 0.3412
 Site-East_Asian_Male           (9) | Val  Loss: 1.6950 | Val  Acc: 0.3902
 Site-East_Asian_Female         (1) | Val  Loss: 1.5116 | Val  Acc: 0.5041
 Site-East_Asian_Male           (9) | Val  Loss: 1.6781 | Val  Acc: 0.3652
 Site-Indian_Female             (1) | Val  Loss: 1.8373 | Val  Acc: 0.3143
 Site-Indian_Male               (7) | Val  Loss: 1.8078 | Val  Acc: 0.2581
 Site-Southeast_Asian_Female    (1) | Val  Loss: 1.9331 | Val  Acc: 0.2994
 Site-Middle_Eastern_Male       (4) | Val  Loss: 1.8926 | Val  Acc: 0.2417
Average Valid Accuracy: 0.3287
Aggregated Acc | Val Acc: 0.3130
 Best site-White_Male               (4)  | Epoch:7 | Val Acc: 0.3333
 Best site-White_Female             (3)  | Epoch:7 | Val Acc: 0.3889
 Best site-White_Male               (8)  | Epoch:7 | Val Acc: 0.2308
 Best site-White_Female             (3)  | Epoch:7 | Val Acc: 0.3333
 Best site-White_Male               (4)  | Epoch:7 | Val Acc: 0.3276
 Best site-White_Female             (3)  | Epoch:7 | Val Acc: 0.4353
 Best site-White_Male               (4)  | Epoch:7 | Val Acc: 0.3360
 Best site-White_Female             (3)  | Epoch:7 | Val Acc: 0.4130
 Best site-White_Male               (4)  | Epoch:7 | Val Acc: 0.3432
 Best site-White_Female             (3)  | Epoch:7 | Val Acc: 0.3946
 Best site-Latino_Hispanic_Male     (6)  | Epoch:7 | Val Acc: 0.2857
 Best site-Latino_Hispanic_Female   (1)  | Epoch:7 | Val Acc: 0.2683
 Best site-Latino_Hispanic_Male     (7)  | Epoch:7 | Val Acc: 0.3833
 Best site-Latino_Hispanic_Female   (1)  | Epoch:7 | Val Acc: 0.2809
 Best site-Latino_Hispanic_Male     (7)  | Epoch:7 | Val Acc: 0.2519
 Best site-Latino_Hispanic_Female   (1)  | Epoch:7 | Val Acc: 0.3109
 Best site-Latino_Hispanic_Male     (0)  | Epoch:7 | Val Acc: 0.2662
 Best site-Black_Female             (2)  | Epoch:7 | Val Acc: 0.2667
 Best site-Black_Male               (7)  | Epoch:7 | Val Acc: 0.3333
 Best site-Black_Female             (2)  | Epoch:7 | Val Acc: 0.3196
 Best site-Black_Male               (5)  | Epoch:7 | Val Acc: 0.3147
 Best site-Black_Female             (2)  | Epoch:7 | Val Acc: 0.3412
 Best site-East_Asian_Male          (9)  | Epoch:7 | Val Acc: 0.3902
 Best site-East_Asian_Female        (1)  | Epoch:7 | Val Acc: 0.5041
 Best site-East_Asian_Male          (9)  | Epoch:7 | Val Acc: 0.3652
 Best site-Indian_Female            (1)  | Epoch:7 | Val Acc: 0.3143
 Best site-Indian_Male              (7)  | Epoch:7 | Val Acc: 0.2581
 Best site-Southeast_Asian_Female   (1)  | Epoch:7 | Val Acc: 0.2994
 Best site-Middle_Eastern_Male      (4)  | Epoch:7 | Val Acc: 0.2417
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 2, 4, 1, 3, 3, 7, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.7277 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.5742 | Train Acc: 0.4444
 Site-White_Male               | Train Loss: 1.6279 | Train Acc: 0.5250
 Site-White_Female             | Train Loss: 1.5330 | Train Acc: 0.4310
 Site-White_Male               | Train Loss: 1.7249 | Train Acc: 0.3103
 Site-White_Female             | Train Loss: 1.5880 | Train Acc: 0.4331
 Site-White_Male               | Train Loss: 1.7142 | Train Acc: 0.3351
 Site-White_Female             | Train Loss: 1.5987 | Train Acc: 0.4094
 Site-White_Male               | Train Loss: 1.6766 | Train Acc: 0.3645
 Site-White_Female             | Train Loss: 1.5835 | Train Acc: 0.4005
 Site-Latino_Hispanic_Male     | Train Loss: 1.6665 | Train Acc: 0.2381
 Site-Latino_Hispanic_Female   | Train Loss: 1.7721 | Train Acc: 0.3279
 Site-Latino_Hispanic_Male     | Train Loss: 1.7287 | Train Acc: 0.2967
 Site-Latino_Hispanic_Female   | Train Loss: 1.5840 | Train Acc: 0.3358
 Site-Latino_Hispanic_Male     | Train Loss: 1.6605 | Train Acc: 0.3553
 Site-Latino_Hispanic_Female   | Train Loss: 1.7313 | Train Acc: 0.3345
 Site-Latino_Hispanic_Male     | Train Loss: 1.7096 | Train Acc: 0.3278
 Site-Black_Female             | Train Loss: 1.7268 | Train Acc: 0.3731
 Site-Black_Male               | Train Loss: 1.9279 | Train Acc: 0.2323
 Site-Black_Female             | Train Loss: 1.6792 | Train Acc: 0.4041
 Site-Black_Male               | Train Loss: 1.7948 | Train Acc: 0.2837
 Site-Black_Female             | Train Loss: 1.6915 | Train Acc: 0.3449
 Site-East_Asian_Male          | Train Loss: 1.6316 | Train Acc: 0.3952
 Site-East_Asian_Female        | Train Loss: 1.5100 | Train Acc: 0.5000
 Site-East_Asian_Male          | Train Loss: 1.5778 | Train Acc: 0.3731
 Site-Indian_Female            | Train Loss: 1.8267 | Train Acc: 0.3354
 Site-Indian_Male              | Train Loss: 1.7088 | Train Acc: 0.3405
 Site-Southeast_Asian_Female   | Train Loss: 1.7525 | Train Acc: 0.3684
 Site-Middle_Eastern_Male      | Train Loss: 1.7689 | Train Acc: 0.3094
 Site-White_Male                (4) | Val  Loss: 1.5722 | Val  Acc: 0.5000
 Site-White_Female              (3) | Val  Loss: 1.8905 | Val  Acc: 0.2778
 Site-White_Male                (8) | Val  Loss: 1.7661 | Val  Acc: 0.2692
 Site-White_Female              (2) | Val  Loss: 1.6571 | Val  Acc: 0.3846
 Site-White_Male                (6) | Val  Loss: 1.6818 | Val  Acc: 0.3103
 Site-White_Female              (2) | Val  Loss: 1.6221 | Val  Acc: 0.4235
 Site-White_Male                (6) | Val  Loss: 1.6873 | Val  Acc: 0.3200
 Site-White_Female              (2) | Val  Loss: 1.6732 | Val  Acc: 0.3750
 Site-White_Male                (6) | Val  Loss: 1.6309 | Val  Acc: 0.3690
 Site-White_Female              (2) | Val  Loss: 1.6303 | Val  Acc: 0.3912
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.8272 | Val  Acc: 0.2857
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.8605 | Val  Acc: 0.2439
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.7444 | Val  Acc: 0.3000
 Site-Latino_Hispanic_Female    (5) | Val  Loss: 1.7229 | Val  Acc: 0.3034
 Site-Latino_Hispanic_Male      (6) | Val  Loss: 1.6130 | Val  Acc: 0.2595
 Site-Latino_Hispanic_Female    (0) | Val  Loss: 1.5468 | Val  Acc: 0.3109
 Site-Latino_Hispanic_Male      (1) | Val  Loss: 1.7332 | Val  Acc: 0.2734
 Site-Black_Female              (9) | Val  Loss: 1.8964 | Val  Acc: 0.2444
 Site-Black_Male                (7) | Val  Loss: 2.5232 | Val  Acc: 0.3182
 Site-Black_Female              (9) | Val  Loss: 1.7707 | Val  Acc: 0.3299
 Site-Black_Male                (7) | Val  Loss: 1.6600 | Val  Acc: 0.3217
 Site-Black_Female              (9) | Val  Loss: 1.6850 | Val  Acc: 0.3555
 Site-East_Asian_Male           (4) | Val  Loss: 1.6841 | Val  Acc: 0.3293
 Site-East_Asian_Female         (5) | Val  Loss: 1.4539 | Val  Acc: 0.4959
 Site-East_Asian_Male           (4) | Val  Loss: 1.6429 | Val  Acc: 0.3820
 Site-Indian_Female             (0) | Val  Loss: 1.7852 | Val  Acc: 0.3714
 Site-Indian_Male               (1) | Val  Loss: 1.7399 | Val  Acc: 0.2581
 Site-Southeast_Asian_Female    (0) | Val  Loss: 1.8935 | Val  Acc: 0.2938
 Site-Middle_Eastern_Male       (6) | Val  Loss: 1.8187 | Val  Acc: 0.2250
Average Valid Accuracy: 0.3284
Aggregated Acc | Val Acc: 0.3209
============ Train epoch 9 ============
cnt=[3, 1, 10, 2, 3, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-White_Male               | Train Loss: 1.6122 | Train Acc: 0.3333
 Site-White_Female             | Train Loss: 1.5701 | Train Acc: 0.4074
 Site-White_Male               | Train Loss: 1.6533 | Train Acc: 0.5000
 Site-White_Female             | Train Loss: 1.5076 | Train Acc: 0.4483
 Site-White_Male               | Train Loss: 1.6790 | Train Acc: 0.2989
 Site-White_Female             | Train Loss: 1.5606 | Train Acc: 0.4567
 Site-White_Male               | Train Loss: 1.7021 | Train Acc: 0.3191
 Site-White_Female             | Train Loss: 1.5599 | Train Acc: 0.4312
 Site-White_Male               | Train Loss: 1.6429 | Train Acc: 0.3645
 Site-White_Female             | Train Loss: 1.5555 | Train Acc: 0.4050
 Site-Latino_Hispanic_Male     | Train Loss: 1.7162 | Train Acc: 0.2857
 Site-Latino_Hispanic_Female   | Train Loss: 1.7177 | Train Acc: 0.3607
 Site-Latino_Hispanic_Male     | Train Loss: 1.7942 | Train Acc: 0.2527
 Site-Latino_Hispanic_Female   | Train Loss: 1.4497 | Train Acc: 0.3134
 Site-Latino_Hispanic_Male     | Train Loss: 1.7311 | Train Acc: 0.3249
 Site-Latino_Hispanic_Female   | Train Loss: 1.6433 | Train Acc: 0.3724
 Site-Latino_Hispanic_Male     | Train Loss: 1.6690 | Train Acc: 0.3254
 Site-Black_Female             | Train Loss: 1.6989 | Train Acc: 0.3582
 Site-Black_Male               | Train Loss: 1.8691 | Train Acc: 0.2525
 Site-Black_Female             | Train Loss: 1.7229 | Train Acc: 0.4247
 Site-Black_Male               | Train Loss: 1.7534 | Train Acc: 0.3163
 Site-Black_Female             | Train Loss: 1.6627 | Train Acc: 0.3323
 Site-East_Asian_Male          | Train Loss: 1.5877 | Train Acc: 0.3548
 Site-East_Asian_Female        | Train Loss: 1.4841 | Train Acc: 0.4890
 Site-East_Asian_Male          | Train Loss: 1.6172 | Train Acc: 0.4030
 Site-Indian_Female            | Train Loss: 1.8094 | Train Acc: 0.3354
 Site-Indian_Male              | Train Loss: 1.6600 | Train Acc: 0.3664
 Site-Southeast_Asian_Female   | Train Loss: 1.8247 | Train Acc: 0.3910
 Site-Middle_Eastern_Male      | Train Loss: 1.7439 | Train Acc: 0.3039
 Site-White_Male                (6) | Val  Loss: 1.5129 | Val  Acc: 0.5000
 Site-White_Female              (2) | Val  Loss: 1.9060 | Val  Acc: 0.3889
 Site-White_Male                (9) | Val  Loss: 1.7423 | Val  Acc: 0.3077
 Site-White_Female              (1) | Val  Loss: 1.5893 | Val  Acc: 0.3846
 Site-White_Male                (7) | Val  Loss: 1.6238 | Val  Acc: 0.4310
 Site-White_Female              (2) | Val  Loss: 1.6184 | Val  Acc: 0.4235
 Site-White_Male                (7) | Val  Loss: 1.6641 | Val  Acc: 0.3120
 Site-White_Female              (2) | Val  Loss: 1.6550 | Val  Acc: 0.4022
 Site-White_Male                (7) | Val  Loss: 1.5869 | Val  Acc: 0.3542
 Site-White_Female              (2) | Val  Loss: 1.6256 | Val  Acc: 0.3844
 Site-Latino_Hispanic_Male      (8) | Val  Loss: 1.7677 | Val  Acc: 0.3214
 Site-Latino_Hispanic_Female    (2) | Val  Loss: 1.8211 | Val  Acc: 0.2439
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.7466 | Val  Acc: 0.2833
 Site-Latino_Hispanic_Female    (2) | Val  Loss: 1.7178 | Val  Acc: 0.3034
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.5773 | Val  Acc: 0.3282
 Site-Latino_Hispanic_Female    (2) | Val  Loss: 1.5191 | Val  Acc: 0.3264
 Site-Latino_Hispanic_Male      (0) | Val  Loss: 1.7102 | Val  Acc: 0.2986
 Site-Black_Female              (4) | Val  Loss: 1.9077 | Val  Acc: 0.2444
 Site-Black_Male                (5) | Val  Loss: 2.3999 | Val  Acc: 0.2727
 Site-Black_Female              (4) | Val  Loss: 1.7469 | Val  Acc: 0.2577
 Site-Black_Male                (5) | Val  Loss: 1.6509 | Val  Acc: 0.3357
 Site-Black_Female              (4) | Val  Loss: 1.6673 | Val  Acc: 0.3460
 Site-East_Asian_Male           (3) | Val  Loss: 1.6548 | Val  Acc: 0.4268
 Site-East_Asian_Female         (2) | Val  Loss: 1.4695 | Val  Acc: 0.4793
 Site-East_Asian_Male           (3) | Val  Loss: 1.6247 | Val  Acc: 0.3820
 Site-Indian_Female             (2) | Val  Loss: 1.7941 | Val  Acc: 0.3238
 Site-Indian_Male               (5) | Val  Loss: 1.7268 | Val  Acc: 0.3032
 Site-Southeast_Asian_Female    (2) | Val  Loss: 1.8523 | Val  Acc: 0.3051
 Site-Middle_Eastern_Male       (7) | Val  Loss: 1.8090 | Val  Acc: 0.2500
Average Valid Accuracy: 0.3421
Aggregated Acc | Val Acc: 0.3503
 Best site-White_Male               (6)  | Epoch:9 | Val Acc: 0.5000
 Best site-White_Female             (2)  | Epoch:9 | Val Acc: 0.3889
 Best site-White_Male               (9)  | Epoch:9 | Val Acc: 0.3077
 Best site-White_Female             (1)  | Epoch:9 | Val Acc: 0.3846
 Best site-White_Male               (7)  | Epoch:9 | Val Acc: 0.4310
 Best site-White_Female             (2)  | Epoch:9 | Val Acc: 0.4235
 Best site-White_Male               (7)  | Epoch:9 | Val Acc: 0.3120
 Best site-White_Female             (2)  | Epoch:9 | Val Acc: 0.4022
 Best site-White_Male               (7)  | Epoch:9 | Val Acc: 0.3542
 Best site-White_Female             (2)  | Epoch:9 | Val Acc: 0.3844
 Best site-Latino_Hispanic_Male     (8)  | Epoch:9 | Val Acc: 0.3214
 Best site-Latino_Hispanic_Female   (2)  | Epoch:9 | Val Acc: 0.2439
 Best site-Latino_Hispanic_Male     (0)  | Epoch:9 | Val Acc: 0.2833
 Best site-Latino_Hispanic_Female   (2)  | Epoch:9 | Val Acc: 0.3034
 Best site-Latino_Hispanic_Male     (0)  | Epoch:9 | Val Acc: 0.3282
 Best site-Latino_Hispanic_Female   (2)  | Epoch:9 | Val Acc: 0.3264
 Best site-Latino_Hispanic_Male     (0)  | Epoch:9 | Val Acc: 0.2986
 Best site-Black_Female             (4)  | Epoch:9 | Val Acc: 0.2444
 Best site-Black_Male               (5)  | Epoch:9 | Val Acc: 0.2727
 Best site-Black_Female             (4)  | Epoch:9 | Val Acc: 0.2577
 Best site-Black_Male               (5)  | Epoch:9 | Val Acc: 0.3357
 Best site-Black_Female             (4)  | Epoch:9 | Val Acc: 0.3460
 Best site-East_Asian_Male          (3)  | Epoch:9 | Val Acc: 0.4268
 Best site-East_Asian_Female        (2)  | Epoch:9 | Val Acc: 0.4793
 Best site-East_Asian_Male          (3)  | Epoch:9 | Val Acc: 0.3820
 Best site-Indian_Female            (2)  | Epoch:9 | Val Acc: 0.3238
 Best site-Indian_Male              (5)  | Epoch:9 | Val Acc: 0.3032
 Best site-Southeast_Asian_Female   (2)  | Epoch:9 | Val Acc: 0.3051
 Best site-Middle_Eastern_Male      (7)  | Epoch:9 | Val Acc: 0.2500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_gender_cluster_10/ccop_q=1...
 Test site-White_Male               | Epoch:9 | Test Acc: 0.4254
 Test site-White_Female             | Epoch:9 | Test Acc: 0.3684
 Test site-Latino_Hispanic_Male     | Epoch:9 | Test Acc: 0.3354
 Test site-Latino_Hispanic_Female   | Epoch:9 | Test Acc: 0.3226
 Test site-Black_Female             | Epoch:9 | Test Acc: 0.3072
 Test site-Black_Male               | Epoch:9 | Test Acc: 0.3289
 Test site-East_Asian_Male          | Epoch:9 | Test Acc: 0.4510
 Test site-East_Asian_Female        | Epoch:9 | Test Acc: 0.4029
 Test site-Indian_Female            | Epoch:9 | Test Acc: 0.3028
 Test site-Indian_Male              | Epoch:9 | Test Acc: 0.3704
 Test site-Southeast_Asian_Female   | Epoch:9 | Test Acc: 0.3650
 Test site-Middle_Eastern_Male      | Epoch:9 | Test Acc: 0.3986
Average Test Accuracy: 0.3649, domain std=0.0455, individual std=0.0459
===2023-05-26 21:48:04===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 10
    std_rw: False
data_number=[18,27,40,58,87,127,188,276,406,442,42,61,91,134,197,290,418,67,99,146,215,316,124,182,268,158,232,266,181,]
client_nums=[10,7,5,3,2,1,1,]
domain number = 10
Loading snapshots...
 Test site-White_Male               | Epoch:7 | Test Acc: 0.4309
 Test site-White_Female             | Epoch:7 | Test Acc: 0.3301
 Test site-Latino_Hispanic_Male     | Epoch:7 | Test Acc: 0.3291
 Test site-Latino_Hispanic_Female   | Epoch:7 | Test Acc: 0.3161
 Test site-Black_Female             | Epoch:7 | Test Acc: 0.3007
 Test site-Black_Male               | Epoch:7 | Test Acc: 0.2895
 Test site-East_Asian_Male          | Epoch:7 | Test Acc: 0.4444
 Test site-East_Asian_Female        | Epoch:7 | Test Acc: 0.3813
 Test site-Indian_Female            | Epoch:7 | Test Acc: 0.2661
 Test site-Indian_Male              | Epoch:7 | Test Acc: 0.3519
 Test site-Southeast_Asian_Female   | Epoch:7 | Test Acc: 0.3650
 Test site-Middle_Eastern_Male      | Epoch:7 | Test Acc: 0.4054
Average Test Accuracy: 0.3509, domain std=0.0539, individual std=0.0537
