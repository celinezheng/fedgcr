===2023-03-25 14:25:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6613 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.6868 | Train Acc: 0.5676
 Site-MNIST     | Train Loss: 1.5898 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.6450 | Train Acc: 0.6486
 Site-SVHN      | Train Loss: 2.2045 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2105 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.1039 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.6775 | Train Acc: 0.6667
 Site-SynthDigits| Train Loss: 2.0814 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.1974 | Train Acc: 0.1712
 Site-MNIST     | Val  Loss: 1.5825 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.5819 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.6806 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6210 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.0861 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 2.2653 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.1612 | Val  Acc: 0.2432
 Site-USPS      | Val  Loss: 1.7178 | Val  Acc: 0.6216
 Site-SynthDigits| Val  Loss: 2.1007 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.2247 | Val  Acc: 0.1486
Average Valid Accuracy: 0.4243
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2432
 Best site-USPS       | Epoch:0 | Val Acc: 0.6216
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.0829 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 1.1548 | Train Acc: 0.7477
 Site-MNIST     | Train Loss: 1.0057 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 1.0689 | Train Acc: 0.8018
 Site-SVHN      | Train Loss: 2.1476 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.0959 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 2.0005 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 1.2083 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.8775 | Train Acc: 0.4054
 Site-MNIST-M   | Train Loss: 2.0544 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 0.9908 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 1.0012 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 1.1404 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 1.0711 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 1.9936 | Val  Acc: 0.3243
 Site-SVHN      | Val  Loss: 2.1646 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0641 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.2939 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 1.8635 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 2.1528 | Val  Acc: 0.2432
Average Valid Accuracy: 0.5541
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3243
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7050 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.7826 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 0.6347 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.7128 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 2.0627 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 2.0423 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.8921 | Train Acc: 0.3604
 Site-USPS      | Train Loss: 0.8424 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.6574 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 1.9074 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 0.6580 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6225 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.7646 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.7131 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.9055 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 2.1578 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.9757 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 0.9566 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 1.6988 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 2.0783 | Val  Acc: 0.2973
Average Valid Accuracy: 0.6014
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3108
 Best site-USPS       | Epoch:2 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4726 | Train Acc: 0.8649
 Site-MNIST     | Train Loss: 0.5497 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4183 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.5040 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.9050 | Train Acc: 0.3063
 Site-SVHN      | Train Loss: 1.8882 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.6317 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.6387 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.3999 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.7833 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.4611 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4065 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5363 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5051 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.6611 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 2.0035 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.7696 | Val  Acc: 0.3919
 Site-USPS      | Val  Loss: 0.7541 | Val  Acc: 0.8108
 Site-SynthDigits| Val  Loss: 1.5806 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 2.0268 | Val  Acc: 0.3108
Average Valid Accuracy: 0.6365
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3919
 Best site-USPS       | Epoch:3 | Val Acc: 0.8108
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2719 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.3525 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2529 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.3120 | Train Acc: 0.9369
 Site-SVHN      | Train Loss: 1.7374 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.7100 | Train Acc: 0.4505
 Site-SVHN      | Train Loss: 1.4669 | Train Acc: 0.5495
 Site-USPS      | Train Loss: 0.4676 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.1908 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.5648 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.2787 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2525 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.3246 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.3225 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.5169 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.8675 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 1.5815 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.6094 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.3870 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.9783 | Val  Acc: 0.3243
Average Valid Accuracy: 0.6851
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4459
 Best site-USPS       | Epoch:4 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1999 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.2616 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1867 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.2201 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 1.4649 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 1.4642 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 1.2391 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 0.3854 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.0303 | Train Acc: 0.6306
 Site-MNIST-M   | Train Loss: 1.2841 | Train Acc: 0.5676
 Site-MNIST     | Val  Loss: 0.1887 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1924 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2349 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2432 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 1.2858 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.6080 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.3300 | Val  Acc: 0.5405
 Site-USPS      | Val  Loss: 0.5482 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.2864 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.8331 | Val  Acc: 0.4189
Average Valid Accuracy: 0.7243
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5405
 Best site-USPS       | Epoch:5 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1421 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1910 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1238 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1499 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.3144 | Train Acc: 0.5405
 Site-SVHN      | Train Loss: 1.2624 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 1.0735 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.3294 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.8548 | Train Acc: 0.7207
 Site-MNIST-M   | Train Loss: 0.9876 | Train Acc: 0.7477
 Site-MNIST     | Val  Loss: 0.1200 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1314 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1643 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1815 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 1.0987 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 1.3795 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 1.1640 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.5018 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.1277 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.7181 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7824
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1091 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1404 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0842 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1073 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 1.1615 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 1.0890 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 0.9597 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.2952 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.7351 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.7738 | Train Acc: 0.8018
 Site-MNIST     | Val  Loss: 0.0839 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0902 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1413 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.9897 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 1.2121 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.0033 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.5062 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.0972 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.6379 | Val  Acc: 0.5676
Average Valid Accuracy: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-USPS       | Epoch:7 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0950 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1132 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0705 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0823 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.9162 | Train Acc: 0.6937
 Site-SVHN      | Train Loss: 0.8453 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 0.7931 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 0.2388 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.6736 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 0.5681 | Train Acc: 0.9099
 Site-MNIST     | Val  Loss: 0.0638 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0758 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.0823 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1190 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.8088 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 0.9243 | Val  Acc: 0.6892
 Site-SVHN      | Val  Loss: 0.8163 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 0.4555 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.1046 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.5402 | Val  Acc: 0.5676
Average Valid Accuracy: 0.8216
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6892
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7297
 Best site-USPS       | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0569 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0786 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0408 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0490 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.8043 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 0.7026 | Train Acc: 0.7838
 Site-SVHN      | Train Loss: 0.7128 | Train Acc: 0.7928
 Site-USPS      | Train Loss: 0.1730 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.5591 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.4549 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0429 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0613 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.7106 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 0.7932 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 0.6685 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 0.4151 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.0711 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 1.5576 | Val  Acc: 0.6081
Average Valid Accuracy: 0.8514
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-USPS       | Epoch:9 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP...
===2023-03-25 15:06:34===
===2023-03-25 15:06:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8836
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3123
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5357
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3357
Average Test Accuracy: 0.5834
