===2023-03-25 14:25:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
===2023-03-25 14:25:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
===2023-03-25 15:40:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
===2023-03-25 15:40:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
===2023-03-25 15:41:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6896 | Train Acc: 0.5495
 Site-MNIST     | Train Loss: 1.7053 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.6150 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.6557 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 2.2125 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2200 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.0876 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 1.7205 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.1001 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.1959 | Train Acc: 0.1802
 Site-MNIST     | Val  Loss: 1.5969 | Val  Acc: 0.6351
 Site-MNIST     | Val  Loss: 1.6107 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.7045 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.6351 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.0744 | Val  Acc: 0.3243
 Site-SVHN      | Val  Loss: 2.2890 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.1589 | Val  Acc: 0.2432
 Site-USPS      | Val  Loss: 1.7575 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 2.1276 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2139 | Val  Acc: 0.1757
Average Valid Accuracy: 0.3959
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3243
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2432
 Best site-USPS       | Epoch:0 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2735 | Train Acc: 0.7117
 Site-MNIST     | Train Loss: 1.3244 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.2172 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 1.2570 | Train Acc: 0.7658
 Site-SVHN      | Train Loss: 2.1423 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.1412 | Train Acc: 0.2523
 Site-SVHN      | Train Loss: 1.9723 | Train Acc: 0.3694
 Site-USPS      | Train Loss: 1.3736 | Train Acc: 0.7027
 Site-SynthDigits| Train Loss: 1.9336 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.0747 | Train Acc: 0.2252
 Site-MNIST     | Val  Loss: 1.1776 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 1.2223 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 1.3261 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.2318 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 1.9603 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 2.2312 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.0672 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.4188 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 1.9803 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 2.1222 | Val  Acc: 0.1892
Average Valid Accuracy: 0.5054
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2703
 Best site-USPS       | Epoch:1 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0170 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.0836 | Train Acc: 0.7568
 Site-MNIST     | Train Loss: 0.9684 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 1.0034 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 2.0987 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.0896 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8941 | Train Acc: 0.4234
 Site-USPS      | Train Loss: 1.1472 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.8152 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 1.9798 | Train Acc: 0.2703
 Site-MNIST     | Val  Loss: 0.9219 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.9766 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.0857 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.9924 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.8811 | Val  Acc: 0.4324
 Site-SVHN      | Val  Loss: 2.1862 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.0050 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.1907 | Val  Acc: 0.7973
 Site-SynthDigits| Val  Loss: 1.8797 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 2.0554 | Val  Acc: 0.2297
Average Valid Accuracy: 0.5527
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4324
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-USPS       | Epoch:2 | Val Acc: 0.7973
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8371 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.9114 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 0.7962 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.8349 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0532 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0416 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.8336 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.9874 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.7300 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.9009 | Train Acc: 0.2793
 Site-MNIST     | Val  Loss: 0.7603 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8041 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.9099 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 0.8335 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.8201 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 2.1402 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 1.9563 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.0323 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.8070 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 2.0004 | Val  Acc: 0.2432
Average Valid Accuracy: 0.5973
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2838
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7128 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.7889 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.6733 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.7182 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 2.0174 | Train Acc: 0.2613
 Site-SVHN      | Train Loss: 1.9999 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.7928 | Train Acc: 0.4775
 Site-USPS      | Train Loss: 0.8840 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.6641 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.8325 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 0.6458 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6788 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7830 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7261 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.7765 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 2.1026 | Val  Acc: 0.2162
 Site-SVHN      | Val  Loss: 1.9172 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 0.9261 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.7541 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.9546 | Val  Acc: 0.2838
Average Valid Accuracy: 0.6189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2162
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3108
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6161 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.6966 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.5866 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.6238 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.9824 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.9596 | Train Acc: 0.3333
 Site-SVHN      | Train Loss: 1.7409 | Train Acc: 0.5045
 Site-USPS      | Train Loss: 0.7957 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.6056 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 1.7673 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 0.5619 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5848 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6878 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6447 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.7259 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 2.0687 | Val  Acc: 0.2568
 Site-SVHN      | Val  Loss: 1.8709 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.8436 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.6982 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 1.9153 | Val  Acc: 0.3243
Average Valid Accuracy: 0.6446
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2568
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3514
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5418 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.6216 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.5168 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5515 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.9530 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.9312 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7033 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.7468 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.5544 | Train Acc: 0.4775
 Site-MNIST-M   | Train Loss: 1.7049 | Train Acc: 0.4234
 Site-MNIST     | Val  Loss: 0.4937 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5155 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.6116 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.5810 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.6939 | Val  Acc: 0.5405
 Site-SVHN      | Val  Loss: 2.0448 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.8369 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.7918 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.6606 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.8747 | Val  Acc: 0.3649
Average Valid Accuracy: 0.6554
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5405
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3514
 Best site-USPS       | Epoch:6 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4864 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.5679 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.4614 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.5004 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.9281 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 1.9067 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.6751 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.7040 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.5066 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.6451 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.4426 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4591 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.5564 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.5322 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.6609 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.0210 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.8078 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.7501 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.6247 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.8331 | Val  Acc: 0.3784
Average Valid Accuracy: 0.6608
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3649
 Best site-USPS       | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4425 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.5202 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.4208 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.4560 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 1.9040 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8820 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.6454 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.6644 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.4480 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.5881 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.4060 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4170 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.5075 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.4934 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.6365 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.9987 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 1.7877 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.7103 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5822 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.7971 | Val  Acc: 0.3919
Average Valid Accuracy: 0.6676
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3649
 Best site-USPS       | Epoch:8 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4035 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4878 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.3833 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.4221 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 1.8749 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 1.8549 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.6257 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 0.6346 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.4010 | Train Acc: 0.5586
 Site-MNIST-M   | Train Loss: 1.5361 | Train Acc: 0.4685
 Site-MNIST     | Val  Loss: 0.3696 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.3786 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.4719 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.4604 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.6097 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.9745 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.7589 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.6820 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.5462 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.7593 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6770
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3784
 Best site-USPS       | Epoch:9 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/DoPrompt...
===2023-03-25 16:23:28===
===2023-03-25 16:29:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8471
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2806
 Test site-USPS      | Epoch:9 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4531
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3636
Average Test Accuracy: 0.5556
