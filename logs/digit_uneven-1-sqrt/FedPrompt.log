===2023-03-25 13:38:23===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6517 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6729 | Train Acc: 0.5676
 Site-MNIST     | Train Loss: 1.5764 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6257 | Train Acc: 0.6577
 Site-SVHN      | Train Loss: 2.2166 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2107 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.1118 | Train Acc: 0.2883
 Site-USPS      | Train Loss: 1.6880 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 2.0898 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.2025 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 1.5569 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.5740 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6758 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.5967 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.0922 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 2.2672 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.1642 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7214 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1090 | Val  Acc: 0.2703
 Site-MNIST-M   | Val  Loss: 2.2263 | Val  Acc: 0.1622
Average Valid Accuracy: 0.4243
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2703
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1803 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 1.2282 | Train Acc: 0.7207
 Site-MNIST     | Train Loss: 1.1048 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 1.1585 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 2.1234 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.1081 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9825 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 1.2414 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.8693 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.0601 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.0659 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.1091 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 1.2379 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 1.1249 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.9654 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 2.1975 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.0136 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.2829 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 1.8956 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 2.1255 | Val  Acc: 0.1757
Average Valid Accuracy: 0.5311
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7653 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.8411 | Train Acc: 0.8018
 Site-MNIST     | Train Loss: 0.6952 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.7619 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 1.9846 | Train Acc: 0.2523
 Site-SVHN      | Train Loss: 1.9633 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.8193 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.9070 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 1.7275 | Train Acc: 0.3964
 Site-MNIST-M   | Train Loss: 1.9102 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 0.6652 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7060 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.8388 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.7414 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 1.8189 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 2.0968 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 1.8312 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.9742 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7302 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 1.9934 | Val  Acc: 0.3649
Average Valid Accuracy: 0.5811
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3243
 Best site-USPS       | Epoch:2 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6201 | Train Acc: 0.8288
 Site-MNIST     | Train Loss: 0.7061 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 0.5677 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6003 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.8884 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.8024 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.6759 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 0.6821 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.4825 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.7388 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 0.5337 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.5672 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.7148 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.6277 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 1.6697 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.9210 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.7059 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.7351 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.5804 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.9214 | Val  Acc: 0.3243
Average Valid Accuracy: 0.6095
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3378
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4423 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.5244 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.4077 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.4599 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.7656 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 1.7759 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.6117 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.6123 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 1.4845 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.5683 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.3826 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4221 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5057 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.4760 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.6187 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.9146 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.6368 | Val  Acc: 0.3919
 Site-USPS      | Val  Loss: 0.6665 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.5849 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 1.7441 | Val  Acc: 0.4459
Average Valid Accuracy: 0.6554
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3919
 Best site-USPS       | Epoch:4 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3371 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.3752 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.2976 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.3386 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.5803 | Train Acc: 0.4144
 Site-SVHN      | Train Loss: 1.5147 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.4657 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.4428 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 1.2420 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 1.2127 | Train Acc: 0.6937
 Site-MNIST     | Val  Loss: 0.2969 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.2894 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.3640 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3563 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.4839 | Val  Acc: 0.5541
 Site-SVHN      | Val  Loss: 1.5842 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.4453 | Val  Acc: 0.4865
 Site-USPS      | Val  Loss: 0.5235 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.4295 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.6341 | Val  Acc: 0.5405
Average Valid Accuracy: 0.7203
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5541
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4865
 Best site-USPS       | Epoch:5 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2101 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2171 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1540 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1862 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.3669 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.2687 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 1.2052 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3475 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 1.0497 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 0.9450 | Train Acc: 0.7387
 Site-MNIST     | Val  Loss: 0.1549 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1498 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1908 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.2245 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.2308 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 1.3528 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.1985 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 0.4183 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.3038 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4357 | Val  Acc: 0.6351
Average Valid Accuracy: 0.7757
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6216
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1783 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1809 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1260 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1422 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.1439 | Train Acc: 0.6306
 Site-SVHN      | Train Loss: 1.1211 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 0.9918 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 0.2959 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.8193 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 0.7618 | Train Acc: 0.8288
 Site-MNIST     | Val  Loss: 0.1282 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1232 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1572 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1853 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.0390 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 1.2033 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 1.0177 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.3965 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1452 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.4765 | Val  Acc: 0.6081
Average Valid Accuracy: 0.8027
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6757
 Best site-USPS       | Epoch:7 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1118 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1093 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0758 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0804 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.9171 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 0.8611 | Train Acc: 0.7748
 Site-SVHN      | Train Loss: 0.6924 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 0.2459 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6788 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 0.5572 | Train Acc: 0.9009
 Site-MNIST     | Val  Loss: 0.0729 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0750 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0912 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1146 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.7256 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 0.9578 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 0.7561 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.3832 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.0938 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2833 | Val  Acc: 0.6351
Average Valid Accuracy: 0.8432
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8108
 Best site-USPS       | Epoch:8 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0899 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0868 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0604 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0554 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6782 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 0.7334 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 0.6350 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.1778 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5305 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.4168 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0824 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0834 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.6772 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.7950 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 0.6156 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3304 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.9786 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 1.3092 | Val  Acc: 0.6486
Average Valid Accuracy: 0.8730
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8919
 Best site-USPS       | Epoch:9 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt...
===2023-03-25 14:21:36===
===2023-03-25 14:21:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 300
    wk_iters: 1
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8893
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3652
 Test site-USPS      | Epoch:9 | Test Acc: 0.8602
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5832
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3836
Average Test Accuracy: 0.6163
===2023-03-25 15:39:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 3
============ Train epoch 0 ============
