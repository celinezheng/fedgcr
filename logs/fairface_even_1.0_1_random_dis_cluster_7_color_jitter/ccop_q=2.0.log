===2023-06-08 13:39:45===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[139,417,139,417,139,417,139,417,139,417,139,417,139,417,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[1856,1856,1856,1856,1856,1856,1856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 2, 2, 6, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.03571, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White                    | Train Loss: 1.8325 | Train Acc: 0.3453
 Site-White                    | Train Loss: 1.8419 | Train Acc: 0.3525
 Site-Latino_Hispanic          | Train Loss: 1.9722 | Train Acc: 0.2734
 Site-Latino_Hispanic          | Train Loss: 1.9798 | Train Acc: 0.2662
 Site-Black                    | Train Loss: 2.0195 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 2.0074 | Train Acc: 0.2446
 Site-East_Asian               | Train Loss: 1.8718 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8230 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 2.0780 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.1162 | Train Acc: 0.2374
 Site-Southeast_Asian          | Train Loss: 2.0724 | Train Acc: 0.3165
 Site-Southeast_Asian          | Train Loss: 2.0796 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.9754 | Train Acc: 0.2590
 Site-Middle_Eastern           | Train Loss: 2.0199 | Train Acc: 0.2446
 Site-White                     (2) | Val  Loss: 1.9834 | Val  Acc: 0.3043
 Site-White                     (5) | Val  Loss: 1.8550 | Val  Acc: 0.3561
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9893 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9604 | Val  Acc: 0.2842
 Site-Black                     (3) | Val  Loss: 1.9548 | Val  Acc: 0.2500
 Site-Black                     (0) | Val  Loss: 1.9661 | Val  Acc: 0.2482
 Site-East_Asian                (4) | Val  Loss: 1.7442 | Val  Acc: 0.4239
 Site-East_Asian                (6) | Val  Loss: 1.8550 | Val  Acc: 0.3705
 Site-Indian                    (3) | Val  Loss: 2.0872 | Val  Acc: 0.2500
 Site-Indian                    (3) | Val  Loss: 2.0965 | Val  Acc: 0.2374
 Site-Southeast_Asian           (3) | Val  Loss: 2.0348 | Val  Acc: 0.3478
 Site-Southeast_Asian           (3) | Val  Loss: 2.0593 | Val  Acc: 0.2878
 Site-Middle_Eastern            (1) | Val  Loss: 1.9250 | Val  Acc: 0.2935
 Site-Middle_Eastern            (1) | Val  Loss: 2.0107 | Val  Acc: 0.2590
Average Valid Accuracy: 0.2997
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.3043
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3561
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.2826
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2842
 Best site-Black                    (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-Black                    (0)  | Epoch:0 | Val Acc: 0.2482
 Best site-East_Asian               (4)  | Epoch:0 | Val Acc: 0.4239
 Best site-East_Asian               (6)  | Epoch:0 | Val Acc: 0.3705
 Best site-Indian                   (3)  | Epoch:0 | Val Acc: 0.2500
 Best site-Indian                   (3)  | Epoch:0 | Val Acc: 0.2374
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.3478
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.2878
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2935
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2590
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 1 ============
cnt=[2, 3, 2, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.22681, quan_i=2.05, quan_c=2.04
minimize weight of clients:[0, 1, 2, 6, 7, 12, 13, ]
 Site-White                    | Train Loss: 1.8873 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8281 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.8812 | Train Acc: 0.2590
 Site-Latino_Hispanic          | Train Loss: 1.9236 | Train Acc: 0.2902
 Site-Black                    | Train Loss: 2.0746 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.9505 | Train Acc: 0.2638
 Site-East_Asian               | Train Loss: 1.8080 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8240 | Train Acc: 0.3765
 Site-Indian                   | Train Loss: 2.1405 | Train Acc: 0.2374
 Site-Indian                   | Train Loss: 2.0706 | Train Acc: 0.2374
 Site-Southeast_Asian          | Train Loss: 1.9811 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 2.0434 | Train Acc: 0.2974
 Site-Middle_Eastern           | Train Loss: 1.9828 | Train Acc: 0.2662
 Site-Middle_Eastern           | Train Loss: 1.9708 | Train Acc: 0.2758
 Site-White                     (0) | Val  Loss: 1.9135 | Val  Acc: 0.2826
 Site-White                     (0) | Val  Loss: 1.8373 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9326 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9196 | Val  Acc: 0.2698
 Site-Black                     (5) | Val  Loss: 1.9313 | Val  Acc: 0.3152
 Site-Black                     (5) | Val  Loss: 1.9083 | Val  Acc: 0.2698
 Site-East_Asian                (4) | Val  Loss: 1.7463 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.8307 | Val  Acc: 0.3741
 Site-Indian                    (1) | Val  Loss: 2.0613 | Val  Acc: 0.2283
 Site-Indian                    (1) | Val  Loss: 2.0364 | Val  Acc: 0.2302
 Site-Southeast_Asian           (3) | Val  Loss: 2.0073 | Val  Acc: 0.3043
 Site-Southeast_Asian           (3) | Val  Loss: 1.9938 | Val  Acc: 0.2950
 Site-Middle_Eastern            (2) | Val  Loss: 1.9034 | Val  Acc: 0.2935
 Site-Middle_Eastern            (2) | Val  Loss: 1.9466 | Val  Acc: 0.2770
Average Valid Accuracy: 0.3015
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.2826
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (6)  | Epoch:1 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.2698
 Best site-Black                    (5)  | Epoch:1 | Val Acc: 0.3152
 Best site-Black                    (5)  | Epoch:1 | Val Acc: 0.2698
 Best site-East_Asian               (4)  | Epoch:1 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:1 | Val Acc: 0.3741
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2283
 Best site-Indian                   (1)  | Epoch:1 | Val Acc: 0.2302
 Best site-Southeast_Asian          (3)  | Epoch:1 | Val Acc: 0.3043
 Best site-Southeast_Asian          (3)  | Epoch:1 | Val Acc: 0.2950
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2935
 Best site-Middle_Eastern           (2)  | Epoch:1 | Val Acc: 0.2770
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 2 ============
cnt=[1, 2, 2, 6, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.22126, quan_i=2.01, quan_c=1.96
minimize weight of clients:[0, 1, 2, 3, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.8169 | Train Acc: 0.3381
 Site-White                    | Train Loss: 1.8270 | Train Acc: 0.3453
 Site-Latino_Hispanic          | Train Loss: 1.8542 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.9081 | Train Acc: 0.2830
 Site-Black                    | Train Loss: 1.8754 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.9330 | Train Acc: 0.2470
 Site-East_Asian               | Train Loss: 1.7790 | Train Acc: 0.3813
 Site-East_Asian               | Train Loss: 1.8066 | Train Acc: 0.3837
 Site-Indian                   | Train Loss: 2.0233 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 2.0100 | Train Acc: 0.2302
 Site-Southeast_Asian          | Train Loss: 1.9359 | Train Acc: 0.3525
 Site-Southeast_Asian          | Train Loss: 1.9744 | Train Acc: 0.2998
 Site-Middle_Eastern           | Train Loss: 2.0417 | Train Acc: 0.2374
 Site-Middle_Eastern           | Train Loss: 1.9188 | Train Acc: 0.2614
 Site-White                     (0) | Val  Loss: 1.9131 | Val  Acc: 0.3152
 Site-White                     (1) | Val  Loss: 1.8279 | Val  Acc: 0.3489
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9413 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8977 | Val  Acc: 0.2950
 Site-Black                     (5) | Val  Loss: 1.8900 | Val  Acc: 0.2935
 Site-Black                     (6) | Val  Loss: 1.8928 | Val  Acc: 0.2734
 Site-East_Asian                (3) | Val  Loss: 1.7429 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.8169 | Val  Acc: 0.3777
 Site-Indian                    (2) | Val  Loss: 2.0242 | Val  Acc: 0.2500
 Site-Indian                    (2) | Val  Loss: 1.9796 | Val  Acc: 0.2518
 Site-Southeast_Asian           (3) | Val  Loss: 1.9460 | Val  Acc: 0.2935
 Site-Southeast_Asian           (3) | Val  Loss: 1.9522 | Val  Acc: 0.3273
 Site-Middle_Eastern            (3) | Val  Loss: 1.9043 | Val  Acc: 0.2935
 Site-Middle_Eastern            (1) | Val  Loss: 1.9319 | Val  Acc: 0.2590
Average Valid Accuracy: 0.3069
 Best site-White                    (0)  | Epoch:2 | Val Acc: 0.3152
 Best site-White                    (1)  | Epoch:2 | Val Acc: 0.3489
 Best site-Latino_Hispanic          (4)  | Epoch:2 | Val Acc: 0.2826
 Best site-Latino_Hispanic          (3)  | Epoch:2 | Val Acc: 0.2950
 Best site-Black                    (5)  | Epoch:2 | Val Acc: 0.2935
 Best site-Black                    (6)  | Epoch:2 | Val Acc: 0.2734
 Best site-East_Asian               (3)  | Epoch:2 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:2 | Val Acc: 0.3777
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2500
 Best site-Indian                   (2)  | Epoch:2 | Val Acc: 0.2518
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.2935
 Best site-Southeast_Asian          (3)  | Epoch:2 | Val Acc: 0.3273
 Best site-Middle_Eastern           (3)  | Epoch:2 | Val Acc: 0.2935
 Best site-Middle_Eastern           (1)  | Epoch:2 | Val Acc: 0.2590
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 3 ============
cnt=[4, 2, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.20337, quan_i=1.96, quan_c=1.97
minimize weight of clients:[0, 1, 2, 4, 5, 6, 7, 10, 13, ]
 Site-White                    | Train Loss: 1.8148 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.8022 | Train Acc: 0.3645
 Site-Latino_Hispanic          | Train Loss: 1.8630 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8985 | Train Acc: 0.2806
 Site-Black                    | Train Loss: 2.0008 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.9538 | Train Acc: 0.2614
 Site-East_Asian               | Train Loss: 1.7935 | Train Acc: 0.3525
 Site-East_Asian               | Train Loss: 1.7839 | Train Acc: 0.3813
 Site-Indian                   | Train Loss: 1.9000 | Train Acc: 0.2446
 Site-Indian                   | Train Loss: 1.9634 | Train Acc: 0.2470
 Site-Southeast_Asian          | Train Loss: 1.8449 | Train Acc: 0.3309
 Site-Southeast_Asian          | Train Loss: 1.9351 | Train Acc: 0.3022
 Site-Middle_Eastern           | Train Loss: 1.8972 | Train Acc: 0.2806
 Site-Middle_Eastern           | Train Loss: 1.9022 | Train Acc: 0.2566
 Site-White                     (4) | Val  Loss: 1.8629 | Val  Acc: 0.2717
 Site-White                     (4) | Val  Loss: 1.8148 | Val  Acc: 0.3525
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9107 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8872 | Val  Acc: 0.2842
 Site-Black                     (6) | Val  Loss: 1.8709 | Val  Acc: 0.3587
 Site-Black                     (5) | Val  Loss: 1.8979 | Val  Acc: 0.2590
 Site-East_Asian                (2) | Val  Loss: 1.7041 | Val  Acc: 0.4565
 Site-East_Asian                (3) | Val  Loss: 1.7988 | Val  Acc: 0.3885
 Site-Indian                    (0) | Val  Loss: 1.9622 | Val  Acc: 0.2174
 Site-Indian                    (0) | Val  Loss: 1.9520 | Val  Acc: 0.2266
 Site-Southeast_Asian           (3) | Val  Loss: 1.9082 | Val  Acc: 0.3152
 Site-Southeast_Asian           (0) | Val  Loss: 1.9198 | Val  Acc: 0.3094
 Site-Middle_Eastern            (1) | Val  Loss: 1.8327 | Val  Acc: 0.2826
 Site-Middle_Eastern            (1) | Val  Loss: 1.9025 | Val  Acc: 0.2662
Average Valid Accuracy: 0.3066
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.21289, quan_i=1.93, quan_c=1.94
minimize weight of clients:[0, 1, 2, 3, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.7880 | Train Acc: 0.3525
 Site-White                    | Train Loss: 1.7804 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8748 | Train Acc: 0.3309
 Site-Latino_Hispanic          | Train Loss: 1.8962 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 2.0162 | Train Acc: 0.2446
 Site-Black                    | Train Loss: 1.9315 | Train Acc: 0.2710
 Site-East_Asian               | Train Loss: 1.8077 | Train Acc: 0.4029
 Site-East_Asian               | Train Loss: 1.7536 | Train Acc: 0.3933
 Site-Indian                   | Train Loss: 1.8494 | Train Acc: 0.2518
 Site-Indian                   | Train Loss: 1.9422 | Train Acc: 0.2518
 Site-Southeast_Asian          | Train Loss: 1.9790 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.9182 | Train Acc: 0.3165
 Site-Middle_Eastern           | Train Loss: 1.8590 | Train Acc: 0.2734
 Site-Middle_Eastern           | Train Loss: 1.8768 | Train Acc: 0.2998
 Site-White                     (6) | Val  Loss: 1.9042 | Val  Acc: 0.2826
 Site-White                     (4) | Val  Loss: 1.7863 | Val  Acc: 0.3669
 Site-Latino_Hispanic           (3) | Val  Loss: 1.9041 | Val  Acc: 0.2826
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8719 | Val  Acc: 0.2878
 Site-Black                     (1) | Val  Loss: 1.8349 | Val  Acc: 0.2826
 Site-Black                     (1) | Val  Loss: 1.8795 | Val  Acc: 0.2626
 Site-East_Asian                (0) | Val  Loss: 1.7233 | Val  Acc: 0.4457
 Site-East_Asian                (0) | Val  Loss: 1.7780 | Val  Acc: 0.3849
 Site-Indian                    (5) | Val  Loss: 1.9376 | Val  Acc: 0.2065
 Site-Indian                    (5) | Val  Loss: 1.9430 | Val  Acc: 0.2446
 Site-Southeast_Asian           (2) | Val  Loss: 1.9037 | Val  Acc: 0.3370
 Site-Southeast_Asian           (2) | Val  Loss: 1.8988 | Val  Acc: 0.3381
 Site-Middle_Eastern            (4) | Val  Loss: 1.8503 | Val  Acc: 0.2935
 Site-Middle_Eastern            (4) | Val  Loss: 1.8806 | Val  Acc: 0.2734
Average Valid Accuracy: 0.3063
============ Train epoch 5 ============
cnt=[2, 3, 3, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.21466, quan_i=1.93, quan_c=1.93
minimize weight of clients:[0, 1, 2, 6, 7, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.6957 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.7688 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8457 | Train Acc: 0.2878
 Site-Latino_Hispanic          | Train Loss: 1.8388 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.9577 | Train Acc: 0.2374
 Site-Black                    | Train Loss: 1.8715 | Train Acc: 0.2758
 Site-East_Asian               | Train Loss: 1.7600 | Train Acc: 0.3381
 Site-East_Asian               | Train Loss: 1.7334 | Train Acc: 0.3909
 Site-Indian                   | Train Loss: 1.9889 | Train Acc: 0.2950
 Site-Indian                   | Train Loss: 1.9333 | Train Acc: 0.2422
 Site-Southeast_Asian          | Train Loss: 1.8473 | Train Acc: 0.2878
 Site-Southeast_Asian          | Train Loss: 1.9187 | Train Acc: 0.3213
 Site-Middle_Eastern           | Train Loss: 1.7743 | Train Acc: 0.3237
 Site-Middle_Eastern           | Train Loss: 1.8503 | Train Acc: 0.3237
 Site-White                     (0) | Val  Loss: 1.8859 | Val  Acc: 0.3152
 Site-White                     (1) | Val  Loss: 1.7932 | Val  Acc: 0.3453
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8568 | Val  Acc: 0.3587
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8219 | Val  Acc: 0.2842
 Site-Black                     (5) | Val  Loss: 1.8138 | Val  Acc: 0.3804
 Site-Black                     (6) | Val  Loss: 1.8352 | Val  Acc: 0.2986
 Site-East_Asian                (3) | Val  Loss: 1.6884 | Val  Acc: 0.4022
 Site-East_Asian                (4) | Val  Loss: 1.7488 | Val  Acc: 0.3849
 Site-Indian                    (2) | Val  Loss: 1.9513 | Val  Acc: 0.1957
 Site-Indian                    (2) | Val  Loss: 1.9195 | Val  Acc: 0.2482
 Site-Southeast_Asian           (4) | Val  Loss: 1.8384 | Val  Acc: 0.2826
 Site-Southeast_Asian           (4) | Val  Loss: 1.8840 | Val  Acc: 0.2950
 Site-Middle_Eastern            (1) | Val  Loss: 1.7898 | Val  Acc: 0.3696
 Site-Middle_Eastern            (1) | Val  Loss: 1.8530 | Val  Acc: 0.3058
Average Valid Accuracy: 0.3190
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.3152
 Best site-White                    (1)  | Epoch:5 | Val Acc: 0.3453
 Best site-Latino_Hispanic          (0)  | Epoch:5 | Val Acc: 0.3587
 Best site-Latino_Hispanic          (2)  | Epoch:5 | Val Acc: 0.2842
 Best site-Black                    (5)  | Epoch:5 | Val Acc: 0.3804
 Best site-Black                    (6)  | Epoch:5 | Val Acc: 0.2986
 Best site-East_Asian               (3)  | Epoch:5 | Val Acc: 0.4022
 Best site-East_Asian               (4)  | Epoch:5 | Val Acc: 0.3849
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.1957
 Best site-Indian                   (2)  | Epoch:5 | Val Acc: 0.2482
 Best site-Southeast_Asian          (4)  | Epoch:5 | Val Acc: 0.2826
 Best site-Southeast_Asian          (4)  | Epoch:5 | Val Acc: 0.2950
 Best site-Middle_Eastern           (1)  | Epoch:5 | Val Acc: 0.3696
 Best site-Middle_Eastern           (1)  | Epoch:5 | Val Acc: 0.3058
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 6 ============
cnt=[1, 3, 3, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.19039, quan_i=1.89, quan_c=1.89
minimize weight of clients:[0, 1, 2, 5, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.7460 | Train Acc: 0.3957
 Site-White                    | Train Loss: 1.7720 | Train Acc: 0.3741
 Site-Latino_Hispanic          | Train Loss: 1.8644 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.8191 | Train Acc: 0.3070
 Site-Black                    | Train Loss: 1.8961 | Train Acc: 0.2230
 Site-Black                    | Train Loss: 1.8802 | Train Acc: 0.2806
 Site-East_Asian               | Train Loss: 1.6640 | Train Acc: 0.4245
 Site-East_Asian               | Train Loss: 1.6918 | Train Acc: 0.4077
 Site-Indian                   | Train Loss: 1.8690 | Train Acc: 0.3237
 Site-Indian                   | Train Loss: 1.8591 | Train Acc: 0.2758
 Site-Southeast_Asian          | Train Loss: 1.8110 | Train Acc: 0.3237
 Site-Southeast_Asian          | Train Loss: 1.8530 | Train Acc: 0.3405
 Site-Middle_Eastern           | Train Loss: 1.8013 | Train Acc: 0.3381
 Site-Middle_Eastern           | Train Loss: 1.8255 | Train Acc: 0.3141
 Site-White                     (2) | Val  Loss: 1.8722 | Val  Acc: 0.3261
 Site-White                     (0) | Val  Loss: 1.7632 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8170 | Val  Acc: 0.3261
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8160 | Val  Acc: 0.3165
 Site-Black                     (4) | Val  Loss: 1.8200 | Val  Acc: 0.3261
 Site-Black                     (6) | Val  Loss: 1.8288 | Val  Acc: 0.3022
 Site-East_Asian                (5) | Val  Loss: 1.6777 | Val  Acc: 0.3913
 Site-East_Asian                (5) | Val  Loss: 1.7218 | Val  Acc: 0.3885
 Site-Indian                    (1) | Val  Loss: 1.9303 | Val  Acc: 0.1848
 Site-Indian                    (1) | Val  Loss: 1.8658 | Val  Acc: 0.2698
 Site-Southeast_Asian           (5) | Val  Loss: 1.8399 | Val  Acc: 0.3370
 Site-Southeast_Asian           (5) | Val  Loss: 1.8409 | Val  Acc: 0.3309
 Site-Middle_Eastern            (2) | Val  Loss: 1.7526 | Val  Acc: 0.3370
 Site-Middle_Eastern            (2) | Val  Loss: 1.8369 | Val  Acc: 0.3094
Average Valid Accuracy: 0.3205
 Best site-White                    (2)  | Epoch:6 | Val Acc: 0.3261
 Best site-White                    (0)  | Epoch:6 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (3)  | Epoch:6 | Val Acc: 0.3261
 Best site-Latino_Hispanic          (1)  | Epoch:6 | Val Acc: 0.3165
 Best site-Black                    (4)  | Epoch:6 | Val Acc: 0.3261
 Best site-Black                    (6)  | Epoch:6 | Val Acc: 0.3022
 Best site-East_Asian               (5)  | Epoch:6 | Val Acc: 0.3913
 Best site-East_Asian               (5)  | Epoch:6 | Val Acc: 0.3885
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.1848
 Best site-Indian                   (1)  | Epoch:6 | Val Acc: 0.2698
 Best site-Southeast_Asian          (5)  | Epoch:6 | Val Acc: 0.3370
 Best site-Southeast_Asian          (5)  | Epoch:6 | Val Acc: 0.3309
 Best site-Middle_Eastern           (2)  | Epoch:6 | Val Acc: 0.3370
 Best site-Middle_Eastern           (2)  | Epoch:6 | Val Acc: 0.3094
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 7 ============
cnt=[2, 1, 2, 2, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.17416, quan_i=1.89, quan_c=1.87
minimize weight of clients:[0, 1, 3, 6, 7, 10, 12, 13, ]
 Site-White                    | Train Loss: 1.8447 | Train Acc: 0.3669
 Site-White                    | Train Loss: 1.7276 | Train Acc: 0.3549
 Site-Latino_Hispanic          | Train Loss: 1.9266 | Train Acc: 0.3237
 Site-Latino_Hispanic          | Train Loss: 1.8104 | Train Acc: 0.3022
 Site-Black                    | Train Loss: 1.8854 | Train Acc: 0.2734
 Site-Black                    | Train Loss: 1.8756 | Train Acc: 0.2806
 Site-East_Asian               | Train Loss: 1.6437 | Train Acc: 0.3741
 Site-East_Asian               | Train Loss: 1.6821 | Train Acc: 0.3957
 Site-Indian                   | Train Loss: 1.8162 | Train Acc: 0.3309
 Site-Indian                   | Train Loss: 1.7951 | Train Acc: 0.3022
 Site-Southeast_Asian          | Train Loss: 1.7336 | Train Acc: 0.3669
 Site-Southeast_Asian          | Train Loss: 1.8100 | Train Acc: 0.3645
 Site-Middle_Eastern           | Train Loss: 1.7850 | Train Acc: 0.3525
 Site-Middle_Eastern           | Train Loss: 1.7471 | Train Acc: 0.3621
 Site-White                     (6) | Val  Loss: 1.7869 | Val  Acc: 0.3478
 Site-White                     (5) | Val  Loss: 1.7872 | Val  Acc: 0.3669
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8247 | Val  Acc: 0.3043
 Site-Latino_Hispanic           (0) | Val  Loss: 1.7873 | Val  Acc: 0.3165
 Site-Black                     (4) | Val  Loss: 1.7352 | Val  Acc: 0.4022
 Site-Black                     (1) | Val  Loss: 1.8367 | Val  Acc: 0.2986
 Site-East_Asian                (5) | Val  Loss: 1.6271 | Val  Acc: 0.4239
 Site-East_Asian                (5) | Val  Loss: 1.6597 | Val  Acc: 0.4137
 Site-Indian                    (3) | Val  Loss: 1.8415 | Val  Acc: 0.2065
 Site-Indian                    (3) | Val  Loss: 1.8074 | Val  Acc: 0.2878
 Site-Southeast_Asian           (2) | Val  Loss: 1.7689 | Val  Acc: 0.2935
 Site-Southeast_Asian           (2) | Val  Loss: 1.7616 | Val  Acc: 0.3597
 Site-Middle_Eastern            (5) | Val  Loss: 1.7482 | Val  Acc: 0.3913
 Site-Middle_Eastern            (5) | Val  Loss: 1.7679 | Val  Acc: 0.3381
Average Valid Accuracy: 0.3393
 Best site-White                    (6)  | Epoch:7 | Val Acc: 0.3478
 Best site-White                    (5)  | Epoch:7 | Val Acc: 0.3669
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3043
 Best site-Latino_Hispanic          (0)  | Epoch:7 | Val Acc: 0.3165
 Best site-Black                    (4)  | Epoch:7 | Val Acc: 0.4022
 Best site-Black                    (1)  | Epoch:7 | Val Acc: 0.2986
 Best site-East_Asian               (5)  | Epoch:7 | Val Acc: 0.4239
 Best site-East_Asian               (5)  | Epoch:7 | Val Acc: 0.4137
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.2065
 Best site-Indian                   (3)  | Epoch:7 | Val Acc: 0.2878
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.2935
 Best site-Southeast_Asian          (2)  | Epoch:7 | Val Acc: 0.3597
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.3913
 Best site-Middle_Eastern           (5)  | Epoch:7 | Val Acc: 0.3381
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 8 ============
cnt=[1, 1, 3, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.17429, quan_i=1.82, quan_c=1.83
minimize weight of clients:[1, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White                    | Train Loss: 1.7141 | Train Acc: 0.3885
 Site-White                    | Train Loss: 1.6921 | Train Acc: 0.3621
 Site-Latino_Hispanic          | Train Loss: 1.8013 | Train Acc: 0.2950
 Site-Latino_Hispanic          | Train Loss: 1.7531 | Train Acc: 0.3357
 Site-Black                    | Train Loss: 1.8012 | Train Acc: 0.3094
 Site-Black                    | Train Loss: 1.8311 | Train Acc: 0.2998
 Site-East_Asian               | Train Loss: 1.5936 | Train Acc: 0.4101
 Site-East_Asian               | Train Loss: 1.6629 | Train Acc: 0.4077
 Site-Indian                   | Train Loss: 1.7223 | Train Acc: 0.3094
 Site-Indian                   | Train Loss: 1.7481 | Train Acc: 0.3213
 Site-Southeast_Asian          | Train Loss: 1.8529 | Train Acc: 0.3525
 Site-Southeast_Asian          | Train Loss: 1.7828 | Train Acc: 0.3813
 Site-Middle_Eastern           | Train Loss: 1.8141 | Train Acc: 0.3094
 Site-Middle_Eastern           | Train Loss: 1.6887 | Train Acc: 0.3885
 Site-White                     (0) | Val  Loss: 1.8240 | Val  Acc: 0.3261
 Site-White                     (6) | Val  Loss: 1.7249 | Val  Acc: 0.3417
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8068 | Val  Acc: 0.3152
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7340 | Val  Acc: 0.3129
 Site-Black                     (2) | Val  Loss: 1.7337 | Val  Acc: 0.3913
 Site-Black                     (5) | Val  Loss: 1.7961 | Val  Acc: 0.3417
 Site-East_Asian                (3) | Val  Loss: 1.5891 | Val  Acc: 0.4348
 Site-East_Asian                (3) | Val  Loss: 1.5954 | Val  Acc: 0.4281
 Site-Indian                    (2) | Val  Loss: 1.7472 | Val  Acc: 0.2500
 Site-Indian                    (2) | Val  Loss: 1.7732 | Val  Acc: 0.2950
 Site-Southeast_Asian           (3) | Val  Loss: 1.7111 | Val  Acc: 0.3478
 Site-Southeast_Asian           (3) | Val  Loss: 1.7128 | Val  Acc: 0.3921
 Site-Middle_Eastern            (4) | Val  Loss: 1.6796 | Val  Acc: 0.3696
 Site-Middle_Eastern            (4) | Val  Loss: 1.7347 | Val  Acc: 0.3489
Average Valid Accuracy: 0.3497
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.3261
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.3417
 Best site-Latino_Hispanic          (1)  | Epoch:8 | Val Acc: 0.3152
 Best site-Latino_Hispanic          (3)  | Epoch:8 | Val Acc: 0.3129
 Best site-Black                    (2)  | Epoch:8 | Val Acc: 0.3913
 Best site-Black                    (5)  | Epoch:8 | Val Acc: 0.3417
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4348
 Best site-East_Asian               (3)  | Epoch:8 | Val Acc: 0.4281
 Best site-Indian                   (2)  | Epoch:8 | Val Acc: 0.2500
 Best site-Indian                   (2)  | Epoch:8 | Val Acc: 0.2950
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3478
 Best site-Southeast_Asian          (3)  | Epoch:8 | Val Acc: 0.3921
 Best site-Middle_Eastern           (4)  | Epoch:8 | Val Acc: 0.3696
 Best site-Middle_Eastern           (4)  | Epoch:8 | Val Acc: 0.3489
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even_1.0_1_random_dis_cluster_7_color_jitter/ccop_q=2.0...
============ Train epoch 9 ============
