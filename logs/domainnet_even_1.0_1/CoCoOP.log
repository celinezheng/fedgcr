===2023-05-12 18:30:33===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[315,945,315,945,315,945,315,945,315,945,315,945,
client_nums=[2,2,2,2,2,2,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart         | Train Loss: 1.7665 | Train Acc: 0.5524
 Site-Clipart         | Train Loss: 1.7998 | Train Acc: 0.5291
 Site-Real            | Train Loss: 1.6480 | Train Acc: 0.7079
 Site-Real            | Train Loss: 1.6672 | Train Acc: 0.6688
 Site-Painting        | Train Loss: 1.7449 | Train Acc: 0.5683
 Site-Painting        | Train Loss: 1.7116 | Train Acc: 0.6222
 Site-Sketch          | Train Loss: 1.7073 | Train Acc: 0.6127
 Site-Sketch          | Train Loss: 1.7337 | Train Acc: 0.5894
 Site-QuickDraw       | Train Loss: 2.1976 | Train Acc: 0.2000
 Site-QuickDraw       | Train Loss: 2.1681 | Train Acc: 0.2487
 Site-Infograph       | Train Loss: 2.1267 | Train Acc: 0.3048
 Site-Infograph       | Train Loss: 2.0692 | Train Acc: 0.3259
 Site-Clipart         | Val  Loss: 1.8271 | Val  Acc: 0.5381
 Site-Clipart         | Val  Loss: 1.7966 | Val  Acc: 0.5381
 Site-Real            | Val  Loss: 1.7398 | Val  Acc: 0.6762
 Site-Real            | Val  Loss: 1.6953 | Val  Acc: 0.6444
 Site-Painting        | Val  Loss: 1.7474 | Val  Acc: 0.6095
 Site-Painting        | Val  Loss: 1.7211 | Val  Acc: 0.6175
 Site-Sketch          | Val  Loss: 1.7827 | Val  Acc: 0.6143
 Site-Sketch          | Val  Loss: 1.7329 | Val  Acc: 0.5841
 Site-QuickDraw       | Val  Loss: 2.1555 | Val  Acc: 0.2667
 Site-QuickDraw       | Val  Loss: 2.1714 | Val  Acc: 0.2206
 Site-Infograph       | Val  Loss: 2.0556 | Val  Acc: 0.3048
 Site-Infograph       | Val  Loss: 2.0658 | Val  Acc: 0.3095
Average Valid Accuracy: 0.4937
 Best site-Clipart          | Epoch:0 | Val Acc: 0.5381
 Best site-Clipart          | Epoch:0 | Val Acc: 0.5381
 Best site-Real             | Epoch:0 | Val Acc: 0.6762
 Best site-Real             | Epoch:0 | Val Acc: 0.6444
 Best site-Painting         | Epoch:0 | Val Acc: 0.6095
 Best site-Painting         | Epoch:0 | Val Acc: 0.6175
 Best site-Sketch           | Epoch:0 | Val Acc: 0.6143
 Best site-Sketch           | Epoch:0 | Val Acc: 0.5841
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.2667
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.2206
 Best site-Infograph        | Epoch:0 | Val Acc: 0.3048
 Best site-Infograph        | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 1 ============
 Site-Clipart         | Train Loss: 1.1073 | Train Acc: 0.7746
 Site-Clipart         | Train Loss: 1.1620 | Train Acc: 0.7376
 Site-Real            | Train Loss: 0.8434 | Train Acc: 0.8857
 Site-Real            | Train Loss: 0.8548 | Train Acc: 0.9048
 Site-Painting        | Train Loss: 1.0098 | Train Acc: 0.7905
 Site-Painting        | Train Loss: 0.9483 | Train Acc: 0.8190
 Site-Sketch          | Train Loss: 1.0168 | Train Acc: 0.7746
 Site-Sketch          | Train Loss: 1.0705 | Train Acc: 0.7492
 Site-QuickDraw       | Train Loss: 2.0372 | Train Acc: 0.2825
 Site-QuickDraw       | Train Loss: 2.0034 | Train Acc: 0.2921
 Site-Infograph       | Train Loss: 1.7088 | Train Acc: 0.4698
 Site-Infograph       | Train Loss: 1.7378 | Train Acc: 0.4497
 Site-Clipart         | Val  Loss: 1.2131 | Val  Acc: 0.7286
 Site-Clipart         | Val  Loss: 1.1498 | Val  Acc: 0.7476
 Site-Real            | Val  Loss: 0.9552 | Val  Acc: 0.8714
 Site-Real            | Val  Loss: 0.8777 | Val  Acc: 0.9016
 Site-Painting        | Val  Loss: 0.9655 | Val  Acc: 0.7810
 Site-Painting        | Val  Loss: 0.9395 | Val  Acc: 0.8302
 Site-Sketch          | Val  Loss: 1.1027 | Val  Acc: 0.7190
 Site-Sketch          | Val  Loss: 1.0530 | Val  Acc: 0.7492
 Site-QuickDraw       | Val  Loss: 1.9776 | Val  Acc: 0.2905
 Site-QuickDraw       | Val  Loss: 1.9925 | Val  Acc: 0.2810
 Site-Infograph       | Val  Loss: 1.6960 | Val  Acc: 0.4810
 Site-Infograph       | Val  Loss: 1.7272 | Val  Acc: 0.4635
Average Valid Accuracy: 0.6537
 Best site-Clipart          | Epoch:1 | Val Acc: 0.7286
 Best site-Clipart          | Epoch:1 | Val Acc: 0.7476
 Best site-Real             | Epoch:1 | Val Acc: 0.8714
 Best site-Real             | Epoch:1 | Val Acc: 0.9016
 Best site-Painting         | Epoch:1 | Val Acc: 0.7810
 Best site-Painting         | Epoch:1 | Val Acc: 0.8302
 Best site-Sketch           | Epoch:1 | Val Acc: 0.7190
 Best site-Sketch           | Epoch:1 | Val Acc: 0.7492
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.2905
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.2810
 Best site-Infograph        | Epoch:1 | Val Acc: 0.4810
 Best site-Infograph        | Epoch:1 | Val Acc: 0.4635
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 2 ============
 Site-Clipart         | Train Loss: 0.7889 | Train Acc: 0.7937
 Site-Clipart         | Train Loss: 0.8513 | Train Acc: 0.7937
 Site-Real            | Train Loss: 0.4998 | Train Acc: 0.9206
 Site-Real            | Train Loss: 0.5193 | Train Acc: 0.9333
 Site-Painting        | Train Loss: 0.7047 | Train Acc: 0.8381
 Site-Painting        | Train Loss: 0.6678 | Train Acc: 0.8392
 Site-Sketch          | Train Loss: 0.7735 | Train Acc: 0.7841
 Site-Sketch          | Train Loss: 0.8106 | Train Acc: 0.7757
 Site-QuickDraw       | Train Loss: 1.8668 | Train Acc: 0.3175
 Site-QuickDraw       | Train Loss: 1.8462 | Train Acc: 0.3217
 Site-Infograph       | Train Loss: 1.4995 | Train Acc: 0.5492
 Site-Infograph       | Train Loss: 1.5657 | Train Acc: 0.4942
 Site-Clipart         | Val  Loss: 0.8573 | Val  Acc: 0.8000
 Site-Clipart         | Val  Loss: 0.8441 | Val  Acc: 0.7905
 Site-Real            | Val  Loss: 0.5773 | Val  Acc: 0.9381
 Site-Real            | Val  Loss: 0.5399 | Val  Acc: 0.9397
 Site-Painting        | Val  Loss: 0.6910 | Val  Acc: 0.8381
 Site-Painting        | Val  Loss: 0.6727 | Val  Acc: 0.8429
 Site-Sketch          | Val  Loss: 0.8595 | Val  Acc: 0.7857
 Site-Sketch          | Val  Loss: 0.8023 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 1.8104 | Val  Acc: 0.3333
 Site-QuickDraw       | Val  Loss: 1.8446 | Val  Acc: 0.3190
 Site-Infograph       | Val  Loss: 1.4364 | Val  Acc: 0.5381
 Site-Infograph       | Val  Loss: 1.5519 | Val  Acc: 0.4714
Average Valid Accuracy: 0.6989
 Best site-Clipart          | Epoch:2 | Val Acc: 0.8000
 Best site-Clipart          | Epoch:2 | Val Acc: 0.7905
 Best site-Real             | Epoch:2 | Val Acc: 0.9381
 Best site-Real             | Epoch:2 | Val Acc: 0.9397
 Best site-Painting         | Epoch:2 | Val Acc: 0.8381
 Best site-Painting         | Epoch:2 | Val Acc: 0.8429
 Best site-Sketch           | Epoch:2 | Val Acc: 0.7857
 Best site-Sketch           | Epoch:2 | Val Acc: 0.7905
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.3333
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.3190
 Best site-Infograph        | Epoch:2 | Val Acc: 0.5381
 Best site-Infograph        | Epoch:2 | Val Acc: 0.4714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 3 ============
 Site-Clipart         | Train Loss: 0.6800 | Train Acc: 0.8254
 Site-Clipart         | Train Loss: 0.7107 | Train Acc: 0.8095
 Site-Real            | Train Loss: 0.3689 | Train Acc: 0.9429
 Site-Real            | Train Loss: 0.3841 | Train Acc: 0.9439
 Site-Painting        | Train Loss: 0.5833 | Train Acc: 0.8381
 Site-Painting        | Train Loss: 0.5266 | Train Acc: 0.8677
 Site-Sketch          | Train Loss: 0.6322 | Train Acc: 0.8254
 Site-Sketch          | Train Loss: 0.6414 | Train Acc: 0.8307
 Site-QuickDraw       | Train Loss: 1.7652 | Train Acc: 0.3587
 Site-QuickDraw       | Train Loss: 1.6992 | Train Acc: 0.4116
 Site-Infograph       | Train Loss: 1.4669 | Train Acc: 0.5333
 Site-Infograph       | Train Loss: 1.5176 | Train Acc: 0.4910
 Site-Clipart         | Val  Loss: 0.7404 | Val  Acc: 0.8429
 Site-Clipart         | Val  Loss: 0.7066 | Val  Acc: 0.8095
 Site-Real            | Val  Loss: 0.4429 | Val  Acc: 0.9381
 Site-Real            | Val  Loss: 0.3767 | Val  Acc: 0.9476
 Site-Painting        | Val  Loss: 0.6045 | Val  Acc: 0.8429
 Site-Painting        | Val  Loss: 0.5400 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.6802 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.6615 | Val  Acc: 0.8175
 Site-QuickDraw       | Val  Loss: 1.7064 | Val  Acc: 0.3952
 Site-QuickDraw       | Val  Loss: 1.7121 | Val  Acc: 0.3873
 Site-Infograph       | Val  Loss: 1.3884 | Val  Acc: 0.5238
 Site-Infograph       | Val  Loss: 1.5210 | Val  Acc: 0.4937
Average Valid Accuracy: 0.7269
 Best site-Clipart          | Epoch:3 | Val Acc: 0.8429
 Best site-Clipart          | Epoch:3 | Val Acc: 0.8095
 Best site-Real             | Epoch:3 | Val Acc: 0.9381
 Best site-Real             | Epoch:3 | Val Acc: 0.9476
 Best site-Painting         | Epoch:3 | Val Acc: 0.8429
 Best site-Painting         | Epoch:3 | Val Acc: 0.8667
 Best site-Sketch           | Epoch:3 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:3 | Val Acc: 0.8175
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.3952
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.3873
 Best site-Infograph        | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph        | Epoch:3 | Val Acc: 0.4937
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 4 ============
 Site-Clipart         | Train Loss: 0.5911 | Train Acc: 0.8349
 Site-Clipart         | Train Loss: 0.6528 | Train Acc: 0.8127
 Site-Real            | Train Loss: 0.3080 | Train Acc: 0.9333
 Site-Real            | Train Loss: 0.3043 | Train Acc: 0.9429
 Site-Painting        | Train Loss: 0.4633 | Train Acc: 0.8730
 Site-Painting        | Train Loss: 0.4434 | Train Acc: 0.8952
 Site-Sketch          | Train Loss: 0.5825 | Train Acc: 0.8349
 Site-Sketch          | Train Loss: 0.5741 | Train Acc: 0.8402
 Site-QuickDraw       | Train Loss: 1.6199 | Train Acc: 0.4730
 Site-QuickDraw       | Train Loss: 1.5737 | Train Acc: 0.4889
 Site-Infograph       | Train Loss: 1.3848 | Train Acc: 0.5492
 Site-Infograph       | Train Loss: 1.4405 | Train Acc: 0.5164
 Site-Clipart         | Val  Loss: 0.7160 | Val  Acc: 0.8238
 Site-Clipart         | Val  Loss: 0.6556 | Val  Acc: 0.8190
 Site-Real            | Val  Loss: 0.3849 | Val  Acc: 0.9286
 Site-Real            | Val  Loss: 0.3043 | Val  Acc: 0.9476
 Site-Painting        | Val  Loss: 0.5361 | Val  Acc: 0.8619
 Site-Painting        | Val  Loss: 0.4336 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.6217 | Val  Acc: 0.8381
 Site-Sketch          | Val  Loss: 0.5803 | Val  Acc: 0.8286
 Site-QuickDraw       | Val  Loss: 1.5739 | Val  Acc: 0.4762
 Site-QuickDraw       | Val  Loss: 1.5784 | Val  Acc: 0.4714
 Site-Infograph       | Val  Loss: 1.3537 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.4247 | Val  Acc: 0.5175
Average Valid Accuracy: 0.7451
 Best site-Clipart          | Epoch:4 | Val Acc: 0.8238
 Best site-Clipart          | Epoch:4 | Val Acc: 0.8190
 Best site-Real             | Epoch:4 | Val Acc: 0.9286
 Best site-Real             | Epoch:4 | Val Acc: 0.9476
 Best site-Painting         | Epoch:4 | Val Acc: 0.8619
 Best site-Painting         | Epoch:4 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:4 | Val Acc: 0.8381
 Best site-Sketch           | Epoch:4 | Val Acc: 0.8286
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.4762
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.4714
 Best site-Infograph        | Epoch:4 | Val Acc: 0.5333
 Best site-Infograph        | Epoch:4 | Val Acc: 0.5175
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 5 ============
 Site-Clipart         | Train Loss: 0.5243 | Train Acc: 0.8603
 Site-Clipart         | Train Loss: 0.5992 | Train Acc: 0.8254
 Site-Real            | Train Loss: 0.2587 | Train Acc: 0.9333
 Site-Real            | Train Loss: 0.2528 | Train Acc: 0.9545
 Site-Painting        | Train Loss: 0.4467 | Train Acc: 0.8635
 Site-Painting        | Train Loss: 0.4062 | Train Acc: 0.8878
 Site-Sketch          | Train Loss: 0.5517 | Train Acc: 0.8381
 Site-Sketch          | Train Loss: 0.5317 | Train Acc: 0.8413
 Site-QuickDraw       | Train Loss: 1.4956 | Train Acc: 0.4984
 Site-QuickDraw       | Train Loss: 1.4451 | Train Acc: 0.5386
 Site-Infograph       | Train Loss: 1.3578 | Train Acc: 0.5651
 Site-Infograph       | Train Loss: 1.4104 | Train Acc: 0.5344
 Site-Clipart         | Val  Loss: 0.6327 | Val  Acc: 0.8333
 Site-Clipart         | Val  Loss: 0.5855 | Val  Acc: 0.8381
 Site-Real            | Val  Loss: 0.3236 | Val  Acc: 0.9571
 Site-Real            | Val  Loss: 0.2528 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.4899 | Val  Acc: 0.8810
 Site-Painting        | Val  Loss: 0.4047 | Val  Acc: 0.9032
 Site-Sketch          | Val  Loss: 0.5667 | Val  Acc: 0.8429
 Site-Sketch          | Val  Loss: 0.5477 | Val  Acc: 0.8365
 Site-QuickDraw       | Val  Loss: 1.4558 | Val  Acc: 0.5524
 Site-QuickDraw       | Val  Loss: 1.4570 | Val  Acc: 0.5413
 Site-Infograph       | Val  Loss: 1.2413 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.3908 | Val  Acc: 0.5381
Average Valid Accuracy: 0.7698
 Best site-Clipart          | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart          | Epoch:5 | Val Acc: 0.8381
 Best site-Real             | Epoch:5 | Val Acc: 0.9571
 Best site-Real             | Epoch:5 | Val Acc: 0.9524
 Best site-Painting         | Epoch:5 | Val Acc: 0.8810
 Best site-Painting         | Epoch:5 | Val Acc: 0.9032
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8429
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8365
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.5524
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.5413
 Best site-Infograph        | Epoch:5 | Val Acc: 0.5619
 Best site-Infograph        | Epoch:5 | Val Acc: 0.5381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 6 ============
 Site-Clipart         | Train Loss: 0.4982 | Train Acc: 0.8889
 Site-Clipart         | Train Loss: 0.5202 | Train Acc: 0.8593
 Site-Real            | Train Loss: 0.2304 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.2336 | Train Acc: 0.9524
 Site-Painting        | Train Loss: 0.3958 | Train Acc: 0.8762
 Site-Painting        | Train Loss: 0.3740 | Train Acc: 0.8931
 Site-Sketch          | Train Loss: 0.5010 | Train Acc: 0.8603
 Site-Sketch          | Train Loss: 0.5130 | Train Acc: 0.8519
 Site-QuickDraw       | Train Loss: 1.3959 | Train Acc: 0.5302
 Site-QuickDraw       | Train Loss: 1.3340 | Train Acc: 0.5683
 Site-Infograph       | Train Loss: 1.3675 | Train Acc: 0.5587
 Site-Infograph       | Train Loss: 1.3933 | Train Acc: 0.5312
 Site-Clipart         | Val  Loss: 0.5689 | Val  Acc: 0.8571
 Site-Clipart         | Val  Loss: 0.5385 | Val  Acc: 0.8460
 Site-Real            | Val  Loss: 0.2636 | Val  Acc: 0.9571
 Site-Real            | Val  Loss: 0.2238 | Val  Acc: 0.9571
 Site-Painting        | Val  Loss: 0.3799 | Val  Acc: 0.8905
 Site-Painting        | Val  Loss: 0.3621 | Val  Acc: 0.8984
 Site-Sketch          | Val  Loss: 0.5756 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.5126 | Val  Acc: 0.8524
 Site-QuickDraw       | Val  Loss: 1.3237 | Val  Acc: 0.6143
 Site-QuickDraw       | Val  Loss: 1.3337 | Val  Acc: 0.5651
 Site-Infograph       | Val  Loss: 1.2427 | Val  Acc: 0.5952
 Site-Infograph       | Val  Loss: 1.3933 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7845
 Best site-Clipart          | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart          | Epoch:6 | Val Acc: 0.8460
 Best site-Real             | Epoch:6 | Val Acc: 0.9571
 Best site-Real             | Epoch:6 | Val Acc: 0.9571
 Best site-Painting         | Epoch:6 | Val Acc: 0.8905
 Best site-Painting         | Epoch:6 | Val Acc: 0.8984
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8524
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.6143
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.5651
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 7 ============
 Site-Clipart         | Train Loss: 0.4642 | Train Acc: 0.8635
 Site-Clipart         | Train Loss: 0.5024 | Train Acc: 0.8487
 Site-Real            | Train Loss: 0.2373 | Train Acc: 0.9429
 Site-Real            | Train Loss: 0.2080 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.3743 | Train Acc: 0.8857
 Site-Painting        | Train Loss: 0.3600 | Train Acc: 0.9048
 Site-Sketch          | Train Loss: 0.4929 | Train Acc: 0.8571
 Site-Sketch          | Train Loss: 0.4664 | Train Acc: 0.8635
 Site-QuickDraw       | Train Loss: 1.3348 | Train Acc: 0.5714
 Site-QuickDraw       | Train Loss: 1.2662 | Train Acc: 0.5937
 Site-Infograph       | Train Loss: 1.2826 | Train Acc: 0.5937
 Site-Infograph       | Train Loss: 1.3790 | Train Acc: 0.5249
 Site-Clipart         | Val  Loss: 0.5221 | Val  Acc: 0.8714
 Site-Clipart         | Val  Loss: 0.5069 | Val  Acc: 0.8524
 Site-Real            | Val  Loss: 0.2926 | Val  Acc: 0.9476
 Site-Real            | Val  Loss: 0.2048 | Val  Acc: 0.9603
 Site-Painting        | Val  Loss: 0.4061 | Val  Acc: 0.9000
 Site-Painting        | Val  Loss: 0.3485 | Val  Acc: 0.9127
 Site-Sketch          | Val  Loss: 0.4820 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.4664 | Val  Acc: 0.8492
 Site-QuickDraw       | Val  Loss: 1.1854 | Val  Acc: 0.6429
 Site-QuickDraw       | Val  Loss: 1.2524 | Val  Acc: 0.6016
 Site-Infograph       | Val  Loss: 1.2243 | Val  Acc: 0.5952
 Site-Infograph       | Val  Loss: 1.3521 | Val  Acc: 0.5365
Average Valid Accuracy: 0.7947
 Best site-Clipart          | Epoch:7 | Val Acc: 0.8714
 Best site-Clipart          | Epoch:7 | Val Acc: 0.8524
 Best site-Real             | Epoch:7 | Val Acc: 0.9476
 Best site-Real             | Epoch:7 | Val Acc: 0.9603
 Best site-Painting         | Epoch:7 | Val Acc: 0.9000
 Best site-Painting         | Epoch:7 | Val Acc: 0.9127
 Best site-Sketch           | Epoch:7 | Val Acc: 0.8667
 Best site-Sketch           | Epoch:7 | Val Acc: 0.8492
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.6429
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.6016
 Best site-Infograph        | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph        | Epoch:7 | Val Acc: 0.5365
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 8 ============
 Site-Clipart         | Train Loss: 0.4210 | Train Acc: 0.8889
 Site-Clipart         | Train Loss: 0.4792 | Train Acc: 0.8635
 Site-Real            | Train Loss: 0.2152 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1995 | Train Acc: 0.9566
 Site-Painting        | Train Loss: 0.3615 | Train Acc: 0.9048
 Site-Painting        | Train Loss: 0.3312 | Train Acc: 0.9196
 Site-Sketch          | Train Loss: 0.4781 | Train Acc: 0.8444
 Site-Sketch          | Train Loss: 0.4618 | Train Acc: 0.8614
 Site-QuickDraw       | Train Loss: 1.2324 | Train Acc: 0.5873
 Site-QuickDraw       | Train Loss: 1.1900 | Train Acc: 0.6212
 Site-Infograph       | Train Loss: 1.2993 | Train Acc: 0.5746
 Site-Infograph       | Train Loss: 1.3622 | Train Acc: 0.5492
 Site-Clipart         | Val  Loss: 0.5032 | Val  Acc: 0.8714
 Site-Clipart         | Val  Loss: 0.4533 | Val  Acc: 0.8762
 Site-Real            | Val  Loss: 0.2693 | Val  Acc: 0.9476
 Site-Real            | Val  Loss: 0.1924 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.3649 | Val  Acc: 0.8905
 Site-Painting        | Val  Loss: 0.3274 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.5843 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.4833 | Val  Acc: 0.8492
 Site-QuickDraw       | Val  Loss: 1.1262 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 1.1562 | Val  Acc: 0.6206
 Site-Infograph       | Val  Loss: 1.2398 | Val  Acc: 0.5857
 Site-Infograph       | Val  Loss: 1.3456 | Val  Acc: 0.5476
Average Valid Accuracy: 0.7985
 Best site-Clipart          | Epoch:8 | Val Acc: 0.8714
 Best site-Clipart          | Epoch:8 | Val Acc: 0.8762
 Best site-Real             | Epoch:8 | Val Acc: 0.9476
 Best site-Real             | Epoch:8 | Val Acc: 0.9651
 Best site-Painting         | Epoch:8 | Val Acc: 0.8905
 Best site-Painting         | Epoch:8 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:8 | Val Acc: 0.8492
 Best site-QuickDraw        | Epoch:8 | Val Acc: 0.6571
 Best site-QuickDraw        | Epoch:8 | Val Acc: 0.6206
 Best site-Infograph        | Epoch:8 | Val Acc: 0.5857
 Best site-Infograph        | Epoch:8 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 9 ============
 Site-Clipart         | Train Loss: 0.4200 | Train Acc: 0.9016
 Site-Clipart         | Train Loss: 0.4576 | Train Acc: 0.8698
 Site-Real            | Train Loss: 0.2107 | Train Acc: 0.9397
 Site-Real            | Train Loss: 0.1828 | Train Acc: 0.9598
 Site-Painting        | Train Loss: 0.3392 | Train Acc: 0.8984
 Site-Painting        | Train Loss: 0.3080 | Train Acc: 0.9111
 Site-Sketch          | Train Loss: 0.4446 | Train Acc: 0.8794
 Site-Sketch          | Train Loss: 0.4489 | Train Acc: 0.8667
 Site-QuickDraw       | Train Loss: 1.1667 | Train Acc: 0.6222
 Site-QuickDraw       | Train Loss: 1.1353 | Train Acc: 0.6466
 Site-Infograph       | Train Loss: 1.3236 | Train Acc: 0.5683
 Site-Infograph       | Train Loss: 1.3267 | Train Acc: 0.5354
 Site-Clipart         | Val  Loss: 0.4493 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.4397 | Val  Acc: 0.8714
 Site-Real            | Val  Loss: 0.2445 | Val  Acc: 0.9476
 Site-Real            | Val  Loss: 0.1881 | Val  Acc: 0.9571
 Site-Painting        | Val  Loss: 0.3715 | Val  Acc: 0.9000
 Site-Painting        | Val  Loss: 0.3416 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.5066 | Val  Acc: 0.8714
 Site-Sketch          | Val  Loss: 0.4634 | Val  Acc: 0.8571
 Site-QuickDraw       | Val  Loss: 1.1014 | Val  Acc: 0.6429
 Site-QuickDraw       | Val  Loss: 1.1356 | Val  Acc: 0.6444
 Site-Infograph       | Val  Loss: 1.1719 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.3160 | Val  Acc: 0.5571
Average Valid Accuracy: 0.8001
 Best site-Clipart          | Epoch:9 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:9 | Val Acc: 0.8714
 Best site-Real             | Epoch:9 | Val Acc: 0.9476
 Best site-Real             | Epoch:9 | Val Acc: 0.9571
 Best site-Painting         | Epoch:9 | Val Acc: 0.9000
 Best site-Painting         | Epoch:9 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:9 | Val Acc: 0.8714
 Best site-Sketch           | Epoch:9 | Val Acc: 0.8571
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.6429
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.6444
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5810
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
 Test site-Clipart         | Epoch:9 | Test Acc: 0.8707
 Test site-Real            | Epoch:9 | Test Acc: 0.9491
 Test site-Painting        | Epoch:9 | Test Acc: 0.9354
 Test site-Sketch          | Epoch:9 | Test Acc: 0.8917
 Test site-QuickDraw       | Epoch:9 | Test Acc: 0.6690
 Test site-Infograph       | Epoch:9 | Test Acc: 0.5921
Average Test Accuracy: 0.8180
============ Train epoch 10 ============
 Site-Clipart         | Train Loss: 0.4310 | Train Acc: 0.8698
 Site-Clipart         | Train Loss: 0.4264 | Train Acc: 0.8751
 Site-Real            | Train Loss: 0.2010 | Train Acc: 0.9429
 Site-Real            | Train Loss: 0.1793 | Train Acc: 0.9566
 Site-Painting        | Train Loss: 0.3514 | Train Acc: 0.8857
 Site-Painting        | Train Loss: 0.3054 | Train Acc: 0.9132
 Site-Sketch          | Train Loss: 0.4455 | Train Acc: 0.8667
 Site-Sketch          | Train Loss: 0.4314 | Train Acc: 0.8614
 Site-QuickDraw       | Train Loss: 1.1068 | Train Acc: 0.6349
 Site-QuickDraw       | Train Loss: 1.0570 | Train Acc: 0.6825
 Site-Infograph       | Train Loss: 1.2971 | Train Acc: 0.5873
 Site-Infograph       | Train Loss: 1.3235 | Train Acc: 0.5280
 Site-Clipart         | Val  Loss: 0.4704 | Val  Acc: 0.9095
 Site-Clipart         | Val  Loss: 0.4161 | Val  Acc: 0.8794
 Site-Real            | Val  Loss: 0.2286 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1791 | Val  Acc: 0.9571
 Site-Painting        | Val  Loss: 0.3310 | Val  Acc: 0.9286
 Site-Painting        | Val  Loss: 0.3030 | Val  Acc: 0.9111
 Site-Sketch          | Val  Loss: 0.4061 | Val  Acc: 0.8714
 Site-Sketch          | Val  Loss: 0.4753 | Val  Acc: 0.8476
 Site-QuickDraw       | Val  Loss: 1.0143 | Val  Acc: 0.6667
 Site-QuickDraw       | Val  Loss: 1.0582 | Val  Acc: 0.6714
 Site-Infograph       | Val  Loss: 1.1737 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.2957 | Val  Acc: 0.5603
Average Valid Accuracy: 0.8126
 Best site-Clipart          | Epoch:10 | Val Acc: 0.9095
 Best site-Clipart          | Epoch:10 | Val Acc: 0.8794
 Best site-Real             | Epoch:10 | Val Acc: 0.9667
 Best site-Real             | Epoch:10 | Val Acc: 0.9571
 Best site-Painting         | Epoch:10 | Val Acc: 0.9286
 Best site-Painting         | Epoch:10 | Val Acc: 0.9111
 Best site-Sketch           | Epoch:10 | Val Acc: 0.8714
 Best site-Sketch           | Epoch:10 | Val Acc: 0.8476
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.6667
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.6714
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5810
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5603
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 11 ============
 Site-Clipart         | Train Loss: 0.3744 | Train Acc: 0.9143
 Site-Clipart         | Train Loss: 0.4189 | Train Acc: 0.8825
 Site-Real            | Train Loss: 0.1945 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1801 | Train Acc: 0.9566
 Site-Painting        | Train Loss: 0.3342 | Train Acc: 0.8921
 Site-Painting        | Train Loss: 0.3026 | Train Acc: 0.9132
 Site-Sketch          | Train Loss: 0.4400 | Train Acc: 0.8667
 Site-Sketch          | Train Loss: 0.4178 | Train Acc: 0.8635
 Site-QuickDraw       | Train Loss: 1.0700 | Train Acc: 0.6762
 Site-QuickDraw       | Train Loss: 0.9988 | Train Acc: 0.6889
 Site-Infograph       | Train Loss: 1.2578 | Train Acc: 0.6095
 Site-Infograph       | Train Loss: 1.3257 | Train Acc: 0.5450
 Site-Clipart         | Val  Loss: 0.4295 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.3871 | Val  Acc: 0.8905
 Site-Real            | Val  Loss: 0.2378 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1694 | Val  Acc: 0.9667
 Site-Painting        | Val  Loss: 0.2850 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2929 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.4885 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.4138 | Val  Acc: 0.8667
 Site-QuickDraw       | Val  Loss: 0.9582 | Val  Acc: 0.7381
 Site-QuickDraw       | Val  Loss: 1.0196 | Val  Acc: 0.6810
 Site-Infograph       | Val  Loss: 1.1944 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.2891 | Val  Acc: 0.5794
Average Valid Accuracy: 0.8245
 Best site-Clipart          | Epoch:11 | Val Acc: 0.8952
 Best site-Clipart          | Epoch:11 | Val Acc: 0.8905
 Best site-Real             | Epoch:11 | Val Acc: 0.9524
 Best site-Real             | Epoch:11 | Val Acc: 0.9667
 Best site-Painting         | Epoch:11 | Val Acc: 0.9333
 Best site-Painting         | Epoch:11 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:11 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:11 | Val Acc: 0.8667
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.7381
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.6810
 Best site-Infograph        | Epoch:11 | Val Acc: 0.6190
 Best site-Infograph        | Epoch:11 | Val Acc: 0.5794
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 12 ============
 Site-Clipart         | Train Loss: 0.3747 | Train Acc: 0.9016
 Site-Clipart         | Train Loss: 0.3965 | Train Acc: 0.8847
 Site-Real            | Train Loss: 0.1922 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1662 | Train Acc: 0.9566
 Site-Painting        | Train Loss: 0.3037 | Train Acc: 0.9206
 Site-Painting        | Train Loss: 0.2710 | Train Acc: 0.9259
 Site-Sketch          | Train Loss: 0.4298 | Train Acc: 0.8540
 Site-Sketch          | Train Loss: 0.3885 | Train Acc: 0.8889
 Site-QuickDraw       | Train Loss: 1.0549 | Train Acc: 0.6730
 Site-QuickDraw       | Train Loss: 0.9578 | Train Acc: 0.7101
 Site-Infograph       | Train Loss: 1.2726 | Train Acc: 0.6000
 Site-Infograph       | Train Loss: 1.2791 | Train Acc: 0.5630
 Site-Clipart         | Val  Loss: 0.4659 | Val  Acc: 0.9000
 Site-Clipart         | Val  Loss: 0.3890 | Val  Acc: 0.8921
 Site-Real            | Val  Loss: 0.2160 | Val  Acc: 0.9571
 Site-Real            | Val  Loss: 0.1732 | Val  Acc: 0.9587
 Site-Painting        | Val  Loss: 0.3106 | Val  Acc: 0.9286
 Site-Painting        | Val  Loss: 0.2954 | Val  Acc: 0.9175
 Site-Sketch          | Val  Loss: 0.4685 | Val  Acc: 0.8762
 Site-Sketch          | Val  Loss: 0.4228 | Val  Acc: 0.8619
 Site-QuickDraw       | Val  Loss: 0.9043 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.9647 | Val  Acc: 0.6952
 Site-Infograph       | Val  Loss: 1.1518 | Val  Acc: 0.6000
 Site-Infograph       | Val  Loss: 1.2834 | Val  Acc: 0.5667
Average Valid Accuracy: 0.8239
============ Train epoch 13 ============
 Site-Clipart         | Train Loss: 0.3603 | Train Acc: 0.8984
 Site-Clipart         | Train Loss: 0.3920 | Train Acc: 0.8868
 Site-Real            | Train Loss: 0.1840 | Train Acc: 0.9429
 Site-Real            | Train Loss: 0.1603 | Train Acc: 0.9608
 Site-Painting        | Train Loss: 0.3059 | Train Acc: 0.9016
 Site-Painting        | Train Loss: 0.2647 | Train Acc: 0.9249
 Site-Sketch          | Train Loss: 0.3873 | Train Acc: 0.8825
 Site-Sketch          | Train Loss: 0.3793 | Train Acc: 0.8889
 Site-QuickDraw       | Train Loss: 1.0310 | Train Acc: 0.6571
 Site-QuickDraw       | Train Loss: 0.9482 | Train Acc: 0.7206
 Site-Infograph       | Train Loss: 1.2202 | Train Acc: 0.6095
 Site-Infograph       | Train Loss: 1.2584 | Train Acc: 0.5788
 Site-Clipart         | Val  Loss: 0.3847 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.3798 | Val  Acc: 0.8810
 Site-Real            | Val  Loss: 0.2142 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1551 | Val  Acc: 0.9635
 Site-Painting        | Val  Loss: 0.3099 | Val  Acc: 0.8952
 Site-Painting        | Val  Loss: 0.2835 | Val  Acc: 0.9190
 Site-Sketch          | Val  Loss: 0.4213 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.4103 | Val  Acc: 0.8556
 Site-QuickDraw       | Val  Loss: 0.9232 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.9023 | Val  Acc: 0.7254
 Site-Infograph       | Val  Loss: 1.1603 | Val  Acc: 0.6000
 Site-Infograph       | Val  Loss: 1.2641 | Val  Acc: 0.5889
Average Valid Accuracy: 0.8266
 Best site-Clipart          | Epoch:13 | Val Acc: 0.8952
 Best site-Clipart          | Epoch:13 | Val Acc: 0.8810
 Best site-Real             | Epoch:13 | Val Acc: 0.9667
 Best site-Real             | Epoch:13 | Val Acc: 0.9635
 Best site-Painting         | Epoch:13 | Val Acc: 0.8952
 Best site-Painting         | Epoch:13 | Val Acc: 0.9190
 Best site-Sketch           | Epoch:13 | Val Acc: 0.8857
 Best site-Sketch           | Epoch:13 | Val Acc: 0.8556
 Best site-QuickDraw        | Epoch:13 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:13 | Val Acc: 0.7254
 Best site-Infograph        | Epoch:13 | Val Acc: 0.6000
 Best site-Infograph        | Epoch:13 | Val Acc: 0.5889
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 14 ============
 Site-Clipart         | Train Loss: 0.3603 | Train Acc: 0.9111
 Site-Clipart         | Train Loss: 0.3817 | Train Acc: 0.8921
 Site-Real            | Train Loss: 0.1808 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1596 | Train Acc: 0.9587
 Site-Painting        | Train Loss: 0.2647 | Train Acc: 0.9270
 Site-Painting        | Train Loss: 0.2593 | Train Acc: 0.9354
 Site-Sketch          | Train Loss: 0.3877 | Train Acc: 0.8857
 Site-Sketch          | Train Loss: 0.4026 | Train Acc: 0.8667
 Site-QuickDraw       | Train Loss: 0.9368 | Train Acc: 0.6762
 Site-QuickDraw       | Train Loss: 0.8928 | Train Acc: 0.7206
 Site-Infograph       | Train Loss: 1.2731 | Train Acc: 0.5905
 Site-Infograph       | Train Loss: 1.2707 | Train Acc: 0.5693
 Site-Clipart         | Val  Loss: 0.3919 | Val  Acc: 0.9048
 Site-Clipart         | Val  Loss: 0.3675 | Val  Acc: 0.8968
 Site-Real            | Val  Loss: 0.1871 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1563 | Val  Acc: 0.9603
 Site-Painting        | Val  Loss: 0.3123 | Val  Acc: 0.9095
 Site-Painting        | Val  Loss: 0.2634 | Val  Acc: 0.9317
 Site-Sketch          | Val  Loss: 0.4121 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3793 | Val  Acc: 0.8746
 Site-QuickDraw       | Val  Loss: 0.8350 | Val  Acc: 0.7571
 Site-QuickDraw       | Val  Loss: 0.9312 | Val  Acc: 0.7048
 Site-Infograph       | Val  Loss: 1.1907 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.2450 | Val  Acc: 0.5698
Average Valid Accuracy: 0.8306
 Best site-Clipart          | Epoch:14 | Val Acc: 0.9048
 Best site-Clipart          | Epoch:14 | Val Acc: 0.8968
 Best site-Real             | Epoch:14 | Val Acc: 0.9714
 Best site-Real             | Epoch:14 | Val Acc: 0.9603
 Best site-Painting         | Epoch:14 | Val Acc: 0.9095
 Best site-Painting         | Epoch:14 | Val Acc: 0.9317
 Best site-Sketch           | Epoch:14 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:14 | Val Acc: 0.8746
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.7571
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.7048
 Best site-Infograph        | Epoch:14 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:14 | Val Acc: 0.5698
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 15 ============
 Site-Clipart         | Train Loss: 0.3575 | Train Acc: 0.9048
 Site-Clipart         | Train Loss: 0.3717 | Train Acc: 0.8889
 Site-Real            | Train Loss: 0.1717 | Train Acc: 0.9460
 Site-Real            | Train Loss: 0.1545 | Train Acc: 0.9598
 Site-Painting        | Train Loss: 0.2688 | Train Acc: 0.9270
 Site-Painting        | Train Loss: 0.2692 | Train Acc: 0.9270
 Site-Sketch          | Train Loss: 0.3967 | Train Acc: 0.8857
 Site-Sketch          | Train Loss: 0.3770 | Train Acc: 0.8825
 Site-QuickDraw       | Train Loss: 0.9573 | Train Acc: 0.6794
 Site-QuickDraw       | Train Loss: 0.8943 | Train Acc: 0.7048
 Site-Infograph       | Train Loss: 1.2253 | Train Acc: 0.6063
 Site-Infograph       | Train Loss: 1.2307 | Train Acc: 0.5735
 Site-Clipart         | Val  Loss: 0.3694 | Val  Acc: 0.8905
 Site-Clipart         | Val  Loss: 0.3460 | Val  Acc: 0.8968
 Site-Real            | Val  Loss: 0.2016 | Val  Acc: 0.9571
 Site-Real            | Val  Loss: 0.1540 | Val  Acc: 0.9603
 Site-Painting        | Val  Loss: 0.2995 | Val  Acc: 0.9095
 Site-Painting        | Val  Loss: 0.2674 | Val  Acc: 0.9254
 Site-Sketch          | Val  Loss: 0.4684 | Val  Acc: 0.8714
 Site-Sketch          | Val  Loss: 0.3520 | Val  Acc: 0.8984
 Site-QuickDraw       | Val  Loss: 0.7993 | Val  Acc: 0.7524
 Site-QuickDraw       | Val  Loss: 0.8787 | Val  Acc: 0.7270
 Site-Infograph       | Val  Loss: 1.1142 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.2454 | Val  Acc: 0.5762
Average Valid Accuracy: 0.8312
 Best site-Clipart          | Epoch:15 | Val Acc: 0.8905
 Best site-Clipart          | Epoch:15 | Val Acc: 0.8968
 Best site-Real             | Epoch:15 | Val Acc: 0.9571
 Best site-Real             | Epoch:15 | Val Acc: 0.9603
 Best site-Painting         | Epoch:15 | Val Acc: 0.9095
 Best site-Painting         | Epoch:15 | Val Acc: 0.9254
 Best site-Sketch           | Epoch:15 | Val Acc: 0.8714
 Best site-Sketch           | Epoch:15 | Val Acc: 0.8984
 Best site-QuickDraw        | Epoch:15 | Val Acc: 0.7524
 Best site-QuickDraw        | Epoch:15 | Val Acc: 0.7270
 Best site-Infograph        | Epoch:15 | Val Acc: 0.6095
 Best site-Infograph        | Epoch:15 | Val Acc: 0.5762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 16 ============
 Site-Clipart         | Train Loss: 0.3334 | Train Acc: 0.8857
 Site-Clipart         | Train Loss: 0.3533 | Train Acc: 0.8952
 Site-Real            | Train Loss: 0.1551 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1387 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.3170 | Train Acc: 0.8952
 Site-Painting        | Train Loss: 0.2488 | Train Acc: 0.9376
 Site-Sketch          | Train Loss: 0.3466 | Train Acc: 0.8952
 Site-Sketch          | Train Loss: 0.3717 | Train Acc: 0.8804
 Site-QuickDraw       | Train Loss: 0.9525 | Train Acc: 0.6889
 Site-QuickDraw       | Train Loss: 0.8478 | Train Acc: 0.7249
 Site-Infograph       | Train Loss: 1.2533 | Train Acc: 0.6095
 Site-Infograph       | Train Loss: 1.2025 | Train Acc: 0.5884
 Site-Clipart         | Val  Loss: 0.3889 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.3476 | Val  Acc: 0.8984
 Site-Real            | Val  Loss: 0.2092 | Val  Acc: 0.9476
 Site-Real            | Val  Loss: 0.1402 | Val  Acc: 0.9667
 Site-Painting        | Val  Loss: 0.3151 | Val  Acc: 0.8857
 Site-Painting        | Val  Loss: 0.2502 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.4135 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.4006 | Val  Acc: 0.8730
 Site-QuickDraw       | Val  Loss: 0.7753 | Val  Acc: 0.7762
 Site-QuickDraw       | Val  Loss: 0.8289 | Val  Acc: 0.7302
 Site-Infograph       | Val  Loss: 1.0706 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.2529 | Val  Acc: 0.5762
Average Valid Accuracy: 0.8323
 Best site-Clipart          | Epoch:16 | Val Acc: 0.8952
 Best site-Clipart          | Epoch:16 | Val Acc: 0.8984
 Best site-Real             | Epoch:16 | Val Acc: 0.9476
 Best site-Real             | Epoch:16 | Val Acc: 0.9667
 Best site-Painting         | Epoch:16 | Val Acc: 0.8857
 Best site-Painting         | Epoch:16 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:16 | Val Acc: 0.8667
 Best site-Sketch           | Epoch:16 | Val Acc: 0.8730
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.7762
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.7302
 Best site-Infograph        | Epoch:16 | Val Acc: 0.6381
 Best site-Infograph        | Epoch:16 | Val Acc: 0.5762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 17 ============
 Site-Clipart         | Train Loss: 0.3227 | Train Acc: 0.9079
 Site-Clipart         | Train Loss: 0.3381 | Train Acc: 0.9037
 Site-Real            | Train Loss: 0.1643 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1505 | Train Acc: 0.9556
 Site-Painting        | Train Loss: 0.2752 | Train Acc: 0.9079
 Site-Painting        | Train Loss: 0.2400 | Train Acc: 0.9407
 Site-Sketch          | Train Loss: 0.3519 | Train Acc: 0.8952
 Site-Sketch          | Train Loss: 0.3719 | Train Acc: 0.8889
 Site-QuickDraw       | Train Loss: 0.9497 | Train Acc: 0.6635
 Site-QuickDraw       | Train Loss: 0.8649 | Train Acc: 0.7280
 Site-Infograph       | Train Loss: 1.2730 | Train Acc: 0.5841
 Site-Infograph       | Train Loss: 1.2139 | Train Acc: 0.5841
 Site-Clipart         | Val  Loss: 0.3213 | Val  Acc: 0.9476
 Site-Clipart         | Val  Loss: 0.3372 | Val  Acc: 0.9016
 Site-Real            | Val  Loss: 0.1706 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1403 | Val  Acc: 0.9683
 Site-Painting        | Val  Loss: 0.2902 | Val  Acc: 0.9286
 Site-Painting        | Val  Loss: 0.2665 | Val  Acc: 0.9302
 Site-Sketch          | Val  Loss: 0.3675 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.3692 | Val  Acc: 0.8825
 Site-QuickDraw       | Val  Loss: 0.7501 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.7993 | Val  Acc: 0.7556
 Site-Infograph       | Val  Loss: 1.0867 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.2344 | Val  Acc: 0.5810
Average Valid Accuracy: 0.8425
 Best site-Clipart          | Epoch:17 | Val Acc: 0.9476
 Best site-Clipart          | Epoch:17 | Val Acc: 0.9016
 Best site-Real             | Epoch:17 | Val Acc: 0.9667
 Best site-Real             | Epoch:17 | Val Acc: 0.9683
 Best site-Painting         | Epoch:17 | Val Acc: 0.9286
 Best site-Painting         | Epoch:17 | Val Acc: 0.9302
 Best site-Sketch           | Epoch:17 | Val Acc: 0.8857
 Best site-Sketch           | Epoch:17 | Val Acc: 0.8825
 Best site-QuickDraw        | Epoch:17 | Val Acc: 0.7714
 Best site-QuickDraw        | Epoch:17 | Val Acc: 0.7556
 Best site-Infograph        | Epoch:17 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:17 | Val Acc: 0.5810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 18 ============
 Site-Clipart         | Train Loss: 0.2843 | Train Acc: 0.9238
 Site-Clipart         | Train Loss: 0.3394 | Train Acc: 0.9037
 Site-Real            | Train Loss: 0.1648 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1450 | Train Acc: 0.9630
 Site-Painting        | Train Loss: 0.2442 | Train Acc: 0.9270
 Site-Painting        | Train Loss: 0.2353 | Train Acc: 0.9323
 Site-Sketch          | Train Loss: 0.3728 | Train Acc: 0.8635
 Site-Sketch          | Train Loss: 0.3631 | Train Acc: 0.8847
 Site-QuickDraw       | Train Loss: 0.8905 | Train Acc: 0.7079
 Site-QuickDraw       | Train Loss: 0.8567 | Train Acc: 0.7291
 Site-Infograph       | Train Loss: 1.2466 | Train Acc: 0.6095
 Site-Infograph       | Train Loss: 1.2216 | Train Acc: 0.5852
 Site-Clipart         | Val  Loss: 0.3385 | Val  Acc: 0.9000
 Site-Clipart         | Val  Loss: 0.3383 | Val  Acc: 0.8968
 Site-Real            | Val  Loss: 0.1796 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1305 | Val  Acc: 0.9698
 Site-Painting        | Val  Loss: 0.2654 | Val  Acc: 0.9095
 Site-Painting        | Val  Loss: 0.2239 | Val  Acc: 0.9349
 Site-Sketch          | Val  Loss: 0.4115 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.3578 | Val  Acc: 0.8952
 Site-QuickDraw       | Val  Loss: 0.7352 | Val  Acc: 0.7571
 Site-QuickDraw       | Val  Loss: 0.8052 | Val  Acc: 0.7571
 Site-Infograph       | Val  Loss: 1.1089 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.1994 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8396
============ Train epoch 19 ============
 Site-Clipart         | Train Loss: 0.3016 | Train Acc: 0.9302
 Site-Clipart         | Train Loss: 0.3211 | Train Acc: 0.9079
 Site-Real            | Train Loss: 0.1515 | Train Acc: 0.9556
 Site-Real            | Train Loss: 0.1367 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.2644 | Train Acc: 0.9079
 Site-Painting        | Train Loss: 0.2235 | Train Acc: 0.9354
 Site-Sketch          | Train Loss: 0.3665 | Train Acc: 0.8825
 Site-Sketch          | Train Loss: 0.3604 | Train Acc: 0.8868
 Site-QuickDraw       | Train Loss: 0.8639 | Train Acc: 0.7079
 Site-QuickDraw       | Train Loss: 0.7836 | Train Acc: 0.7503
 Site-Infograph       | Train Loss: 1.2111 | Train Acc: 0.6286
 Site-Infograph       | Train Loss: 1.1950 | Train Acc: 0.5926
 Site-Clipart         | Val  Loss: 0.3478 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.3285 | Val  Acc: 0.8937
 Site-Real            | Val  Loss: 0.1748 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1341 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2776 | Val  Acc: 0.9143
 Site-Painting        | Val  Loss: 0.2292 | Val  Acc: 0.9444
 Site-Sketch          | Val  Loss: 0.3730 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.3675 | Val  Acc: 0.8714
 Site-QuickDraw       | Val  Loss: 0.7814 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.7831 | Val  Acc: 0.7524
 Site-Infograph       | Val  Loss: 1.0959 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.2035 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8402
============ Train epoch 20 ============
 Site-Clipart         | Train Loss: 0.3289 | Train Acc: 0.9079
 Site-Clipart         | Train Loss: 0.3220 | Train Acc: 0.8995
 Site-Real            | Train Loss: 0.1508 | Train Acc: 0.9556
 Site-Real            | Train Loss: 0.1441 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.2550 | Train Acc: 0.9238
 Site-Painting        | Train Loss: 0.2256 | Train Acc: 0.9397
 Site-Sketch          | Train Loss: 0.3375 | Train Acc: 0.8889
 Site-Sketch          | Train Loss: 0.3704 | Train Acc: 0.8783
 Site-QuickDraw       | Train Loss: 0.8565 | Train Acc: 0.7302
 Site-QuickDraw       | Train Loss: 0.7708 | Train Acc: 0.7661
 Site-Infograph       | Train Loss: 1.2176 | Train Acc: 0.6190
 Site-Infograph       | Train Loss: 1.1782 | Train Acc: 0.5915
 Site-Clipart         | Val  Loss: 0.3154 | Val  Acc: 0.9190
 Site-Clipart         | Val  Loss: 0.3294 | Val  Acc: 0.9032
 Site-Real            | Val  Loss: 0.1590 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1319 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2630 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2447 | Val  Acc: 0.9286
 Site-Sketch          | Val  Loss: 0.3507 | Val  Acc: 0.9000
 Site-Sketch          | Val  Loss: 0.3548 | Val  Acc: 0.8810
 Site-QuickDraw       | Val  Loss: 0.6643 | Val  Acc: 0.8000
 Site-QuickDraw       | Val  Loss: 0.7352 | Val  Acc: 0.7762
 Site-Infograph       | Val  Loss: 1.0393 | Val  Acc: 0.6143
 Site-Infograph       | Val  Loss: 1.2012 | Val  Acc: 0.5889
Average Valid Accuracy: 0.8489
 Best site-Clipart          | Epoch:20 | Val Acc: 0.9190
 Best site-Clipart          | Epoch:20 | Val Acc: 0.9032
 Best site-Real             | Epoch:20 | Val Acc: 0.9714
 Best site-Real             | Epoch:20 | Val Acc: 0.9714
 Best site-Painting         | Epoch:20 | Val Acc: 0.9333
 Best site-Painting         | Epoch:20 | Val Acc: 0.9286
 Best site-Sketch           | Epoch:20 | Val Acc: 0.9000
 Best site-Sketch           | Epoch:20 | Val Acc: 0.8810
 Best site-QuickDraw        | Epoch:20 | Val Acc: 0.8000
 Best site-QuickDraw        | Epoch:20 | Val Acc: 0.7762
 Best site-Infograph        | Epoch:20 | Val Acc: 0.6143
 Best site-Infograph        | Epoch:20 | Val Acc: 0.5889
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 21 ============
 Site-Clipart         | Train Loss: 0.3154 | Train Acc: 0.9175
 Site-Clipart         | Train Loss: 0.3076 | Train Acc: 0.9090
 Site-Real            | Train Loss: 0.1499 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1248 | Train Acc: 0.9704
 Site-Painting        | Train Loss: 0.2211 | Train Acc: 0.9270
 Site-Painting        | Train Loss: 0.2183 | Train Acc: 0.9429
 Site-Sketch          | Train Loss: 0.3423 | Train Acc: 0.8952
 Site-Sketch          | Train Loss: 0.3442 | Train Acc: 0.8984
 Site-QuickDraw       | Train Loss: 0.8093 | Train Acc: 0.7397
 Site-QuickDraw       | Train Loss: 0.7619 | Train Acc: 0.7630
 Site-Infograph       | Train Loss: 1.2195 | Train Acc: 0.6222
 Site-Infograph       | Train Loss: 1.1761 | Train Acc: 0.6011
 Site-Clipart         | Val  Loss: 0.3172 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.3218 | Val  Acc: 0.9000
 Site-Real            | Val  Loss: 0.1698 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1151 | Val  Acc: 0.9762
 Site-Painting        | Val  Loss: 0.2426 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2177 | Val  Acc: 0.9254
 Site-Sketch          | Val  Loss: 0.4129 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.3468 | Val  Acc: 0.8937
 Site-QuickDraw       | Val  Loss: 0.7153 | Val  Acc: 0.7762
 Site-QuickDraw       | Val  Loss: 0.7430 | Val  Acc: 0.7603
 Site-Infograph       | Val  Loss: 1.1001 | Val  Acc: 0.6143
 Site-Infograph       | Val  Loss: 1.1878 | Val  Acc: 0.5905
Average Valid Accuracy: 0.8451
============ Train epoch 22 ============
 Site-Clipart         | Train Loss: 0.3290 | Train Acc: 0.9175
 Site-Clipart         | Train Loss: 0.3057 | Train Acc: 0.9058
 Site-Real            | Train Loss: 0.1616 | Train Acc: 0.9460
 Site-Real            | Train Loss: 0.1356 | Train Acc: 0.9630
 Site-Painting        | Train Loss: 0.2395 | Train Acc: 0.9397
 Site-Painting        | Train Loss: 0.2174 | Train Acc: 0.9407
 Site-Sketch          | Train Loss: 0.3562 | Train Acc: 0.8889
 Site-Sketch          | Train Loss: 0.3570 | Train Acc: 0.8910
 Site-QuickDraw       | Train Loss: 0.8379 | Train Acc: 0.7175
 Site-QuickDraw       | Train Loss: 0.7558 | Train Acc: 0.7513
 Site-Infograph       | Train Loss: 1.1696 | Train Acc: 0.6413
 Site-Infograph       | Train Loss: 1.1813 | Train Acc: 0.6011
 Site-Clipart         | Val  Loss: 0.3260 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.3075 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.1861 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1261 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2430 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2075 | Val  Acc: 0.9476
 Site-Sketch          | Val  Loss: 0.4211 | Val  Acc: 0.8714
 Site-Sketch          | Val  Loss: 0.3264 | Val  Acc: 0.8873
 Site-QuickDraw       | Val  Loss: 0.7113 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.7366 | Val  Acc: 0.7825
 Site-Infograph       | Val  Loss: 1.0545 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.1900 | Val  Acc: 0.5952
Average Valid Accuracy: 0.8512
 Best site-Clipart          | Epoch:22 | Val Acc: 0.9143
 Best site-Clipart          | Epoch:22 | Val Acc: 0.9111
 Best site-Real             | Epoch:22 | Val Acc: 0.9714
 Best site-Real             | Epoch:22 | Val Acc: 0.9714
 Best site-Painting         | Epoch:22 | Val Acc: 0.9333
 Best site-Painting         | Epoch:22 | Val Acc: 0.9476
 Best site-Sketch           | Epoch:22 | Val Acc: 0.8714
 Best site-Sketch           | Epoch:22 | Val Acc: 0.8873
 Best site-QuickDraw        | Epoch:22 | Val Acc: 0.8095
 Best site-QuickDraw        | Epoch:22 | Val Acc: 0.7825
 Best site-Infograph        | Epoch:22 | Val Acc: 0.6190
 Best site-Infograph        | Epoch:22 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 23 ============
 Site-Clipart         | Train Loss: 0.2949 | Train Acc: 0.9270
 Site-Clipart         | Train Loss: 0.3169 | Train Acc: 0.9048
 Site-Real            | Train Loss: 0.1581 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1250 | Train Acc: 0.9693
 Site-Painting        | Train Loss: 0.2475 | Train Acc: 0.9429
 Site-Painting        | Train Loss: 0.2152 | Train Acc: 0.9376
 Site-Sketch          | Train Loss: 0.3624 | Train Acc: 0.8889
 Site-Sketch          | Train Loss: 0.3317 | Train Acc: 0.8952
 Site-QuickDraw       | Train Loss: 0.8003 | Train Acc: 0.7460
 Site-QuickDraw       | Train Loss: 0.7589 | Train Acc: 0.7651
 Site-Infograph       | Train Loss: 1.1983 | Train Acc: 0.6286
 Site-Infograph       | Train Loss: 1.1824 | Train Acc: 0.5968
 Site-Clipart         | Val  Loss: 0.2949 | Val  Acc: 0.9286
 Site-Clipart         | Val  Loss: 0.3173 | Val  Acc: 0.9000
 Site-Real            | Val  Loss: 0.1743 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1173 | Val  Acc: 0.9730
 Site-Painting        | Val  Loss: 0.2566 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2232 | Val  Acc: 0.9413
 Site-Sketch          | Val  Loss: 0.3814 | Val  Acc: 0.8714
 Site-Sketch          | Val  Loss: 0.3673 | Val  Acc: 0.8825
 Site-QuickDraw       | Val  Loss: 0.6641 | Val  Acc: 0.7952
 Site-QuickDraw       | Val  Loss: 0.7282 | Val  Acc: 0.7683
 Site-Infograph       | Val  Loss: 1.0592 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 1.1610 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8487
============ Train epoch 24 ============
 Site-Clipart         | Train Loss: 0.2755 | Train Acc: 0.9397
 Site-Clipart         | Train Loss: 0.3025 | Train Acc: 0.9090
 Site-Real            | Train Loss: 0.1490 | Train Acc: 0.9556
 Site-Real            | Train Loss: 0.1306 | Train Acc: 0.9608
 Site-Painting        | Train Loss: 0.2402 | Train Acc: 0.9333
 Site-Painting        | Train Loss: 0.2162 | Train Acc: 0.9460
 Site-Sketch          | Train Loss: 0.3538 | Train Acc: 0.8794
 Site-Sketch          | Train Loss: 0.3528 | Train Acc: 0.8783
 Site-QuickDraw       | Train Loss: 0.8072 | Train Acc: 0.7460
 Site-QuickDraw       | Train Loss: 0.7529 | Train Acc: 0.7608
 Site-Infograph       | Train Loss: 1.2245 | Train Acc: 0.6000
 Site-Infograph       | Train Loss: 1.1825 | Train Acc: 0.5894
 Site-Clipart         | Val  Loss: 0.3149 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3040 | Val  Acc: 0.9095
 Site-Real            | Val  Loss: 0.1473 | Val  Acc: 0.9762
 Site-Real            | Val  Loss: 0.1204 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2684 | Val  Acc: 0.9048
 Site-Painting        | Val  Loss: 0.2151 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.4399 | Val  Acc: 0.8905
 Site-Sketch          | Val  Loss: 0.3322 | Val  Acc: 0.8905
 Site-QuickDraw       | Val  Loss: 0.6894 | Val  Acc: 0.7524
 Site-QuickDraw       | Val  Loss: 0.7546 | Val  Acc: 0.7460
 Site-Infograph       | Val  Loss: 0.9856 | Val  Acc: 0.6619
 Site-Infograph       | Val  Loss: 1.1863 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8497
============ Train epoch 25 ============
 Site-Clipart         | Train Loss: 0.2995 | Train Acc: 0.9143
 Site-Clipart         | Train Loss: 0.2935 | Train Acc: 0.9048
 Site-Real            | Train Loss: 0.1535 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1187 | Train Acc: 0.9704
 Site-Painting        | Train Loss: 0.2279 | Train Acc: 0.9302
 Site-Painting        | Train Loss: 0.2121 | Train Acc: 0.9460
 Site-Sketch          | Train Loss: 0.3589 | Train Acc: 0.8984
 Site-Sketch          | Train Loss: 0.3222 | Train Acc: 0.8952
 Site-QuickDraw       | Train Loss: 0.8027 | Train Acc: 0.7270
 Site-QuickDraw       | Train Loss: 0.7239 | Train Acc: 0.7661
 Site-Infograph       | Train Loss: 1.2058 | Train Acc: 0.6476
 Site-Infograph       | Train Loss: 1.1467 | Train Acc: 0.6074
 Site-Clipart         | Val  Loss: 0.3328 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.2750 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.1616 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1097 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.2212 | Val  Acc: 0.9571
 Site-Painting        | Val  Loss: 0.2289 | Val  Acc: 0.9286
 Site-Sketch          | Val  Loss: 0.3232 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3180 | Val  Acc: 0.8952
 Site-QuickDraw       | Val  Loss: 0.6604 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.6955 | Val  Acc: 0.7730
 Site-Infograph       | Val  Loss: 1.0790 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.1273 | Val  Acc: 0.6079
Average Valid Accuracy: 0.8569
 Best site-Clipart          | Epoch:25 | Val Acc: 0.9143
 Best site-Clipart          | Epoch:25 | Val Acc: 0.9111
 Best site-Real             | Epoch:25 | Val Acc: 0.9714
 Best site-Real             | Epoch:25 | Val Acc: 0.9810
 Best site-Painting         | Epoch:25 | Val Acc: 0.9571
 Best site-Painting         | Epoch:25 | Val Acc: 0.9286
 Best site-Sketch           | Epoch:25 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:25 | Val Acc: 0.8952
 Best site-QuickDraw        | Epoch:25 | Val Acc: 0.8095
 Best site-QuickDraw        | Epoch:25 | Val Acc: 0.7730
 Best site-Infograph        | Epoch:25 | Val Acc: 0.6381
 Best site-Infograph        | Epoch:25 | Val Acc: 0.6079
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 26 ============
 Site-Clipart         | Train Loss: 0.3056 | Train Acc: 0.9111
 Site-Clipart         | Train Loss: 0.2964 | Train Acc: 0.9122
 Site-Real            | Train Loss: 0.1560 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1241 | Train Acc: 0.9630
 Site-Painting        | Train Loss: 0.2262 | Train Acc: 0.9302
 Site-Painting        | Train Loss: 0.2133 | Train Acc: 0.9397
 Site-Sketch          | Train Loss: 0.3490 | Train Acc: 0.8889
 Site-Sketch          | Train Loss: 0.3248 | Train Acc: 0.8942
 Site-QuickDraw       | Train Loss: 0.7604 | Train Acc: 0.7714
 Site-QuickDraw       | Train Loss: 0.7151 | Train Acc: 0.7693
 Site-Infograph       | Train Loss: 1.2000 | Train Acc: 0.6444
 Site-Infograph       | Train Loss: 1.1621 | Train Acc: 0.6095
 Site-Clipart         | Val  Loss: 0.2913 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.2816 | Val  Acc: 0.9143
 Site-Real            | Val  Loss: 0.1517 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1159 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2284 | Val  Acc: 0.9286
 Site-Painting        | Val  Loss: 0.2240 | Val  Acc: 0.9254
 Site-Sketch          | Val  Loss: 0.3535 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.3402 | Val  Acc: 0.8841
 Site-QuickDraw       | Val  Loss: 0.6779 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 0.7092 | Val  Acc: 0.7571
 Site-Infograph       | Val  Loss: 1.0407 | Val  Acc: 0.6429
 Site-Infograph       | Val  Loss: 1.1359 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8503
============ Train epoch 27 ============
 Site-Clipart         | Train Loss: 0.3205 | Train Acc: 0.8889
 Site-Clipart         | Train Loss: 0.2868 | Train Acc: 0.9079
 Site-Real            | Train Loss: 0.1458 | Train Acc: 0.9524
 Site-Real            | Train Loss: 0.1119 | Train Acc: 0.9683
 Site-Painting        | Train Loss: 0.2248 | Train Acc: 0.9365
 Site-Painting        | Train Loss: 0.2014 | Train Acc: 0.9418
 Site-Sketch          | Train Loss: 0.3081 | Train Acc: 0.9048
 Site-Sketch          | Train Loss: 0.3220 | Train Acc: 0.8984
 Site-QuickDraw       | Train Loss: 0.7750 | Train Acc: 0.7302
 Site-QuickDraw       | Train Loss: 0.7235 | Train Acc: 0.7587
 Site-Infograph       | Train Loss: 1.1548 | Train Acc: 0.6286
 Site-Infograph       | Train Loss: 1.1573 | Train Acc: 0.5926
 Site-Clipart         | Val  Loss: 0.3473 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.2600 | Val  Acc: 0.9302
 Site-Real            | Val  Loss: 0.1473 | Val  Acc: 0.9667
 Site-Real            | Val  Loss: 0.1109 | Val  Acc: 0.9762
 Site-Painting        | Val  Loss: 0.2074 | Val  Acc: 0.9381
 Site-Painting        | Val  Loss: 0.2113 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.3801 | Val  Acc: 0.8905
 Site-Sketch          | Val  Loss: 0.3249 | Val  Acc: 0.8968
 Site-QuickDraw       | Val  Loss: 0.6419 | Val  Acc: 0.8000
 Site-QuickDraw       | Val  Loss: 0.7202 | Val  Acc: 0.7667
 Site-Infograph       | Val  Loss: 1.0362 | Val  Acc: 0.6333
 Site-Infograph       | Val  Loss: 1.1778 | Val  Acc: 0.6238
Average Valid Accuracy: 0.8579
 Best site-Clipart          | Epoch:27 | Val Acc: 0.9238
 Best site-Clipart          | Epoch:27 | Val Acc: 0.9302
 Best site-Real             | Epoch:27 | Val Acc: 0.9667
 Best site-Real             | Epoch:27 | Val Acc: 0.9762
 Best site-Painting         | Epoch:27 | Val Acc: 0.9381
 Best site-Painting         | Epoch:27 | Val Acc: 0.9492
 Best site-Sketch           | Epoch:27 | Val Acc: 0.8905
 Best site-Sketch           | Epoch:27 | Val Acc: 0.8968
 Best site-QuickDraw        | Epoch:27 | Val Acc: 0.8000
 Best site-QuickDraw        | Epoch:27 | Val Acc: 0.7667
 Best site-Infograph        | Epoch:27 | Val Acc: 0.6333
 Best site-Infograph        | Epoch:27 | Val Acc: 0.6238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 28 ============
 Site-Clipart         | Train Loss: 0.2873 | Train Acc: 0.9238
 Site-Clipart         | Train Loss: 0.2866 | Train Acc: 0.9132
 Site-Real            | Train Loss: 0.1342 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1121 | Train Acc: 0.9672
 Site-Painting        | Train Loss: 0.2146 | Train Acc: 0.9365
 Site-Painting        | Train Loss: 0.1920 | Train Acc: 0.9503
 Site-Sketch          | Train Loss: 0.3518 | Train Acc: 0.8730
 Site-Sketch          | Train Loss: 0.3169 | Train Acc: 0.9058
 Site-QuickDraw       | Train Loss: 0.7718 | Train Acc: 0.7492
 Site-QuickDraw       | Train Loss: 0.6911 | Train Acc: 0.7704
 Site-Infograph       | Train Loss: 1.1825 | Train Acc: 0.6254
 Site-Infograph       | Train Loss: 1.1329 | Train Acc: 0.6212
 Site-Clipart         | Val  Loss: 0.2927 | Val  Acc: 0.9286
 Site-Clipart         | Val  Loss: 0.2753 | Val  Acc: 0.9238
 Site-Real            | Val  Loss: 0.1599 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1101 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2790 | Val  Acc: 0.9190
 Site-Painting        | Val  Loss: 0.2061 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.3843 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.3193 | Val  Acc: 0.8952
 Site-QuickDraw       | Val  Loss: 0.6607 | Val  Acc: 0.8143
 Site-QuickDraw       | Val  Loss: 0.6705 | Val  Acc: 0.7746
 Site-Infograph       | Val  Loss: 0.9834 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.1181 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8544
============ Train epoch 29 ============
===2023-05-13 00:03:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart         | Train Loss: 2.0132 | Train Acc: 0.3567
 Site-Clipart         | Train Loss: 2.0383 | Train Acc: 0.3517
 Site-Real            | Train Loss: 1.9859 | Train Acc: 0.3885
 Site-Real            | Train Loss: 1.9402 | Train Acc: 0.4322
 Site-Painting        | Train Loss: 1.9817 | Train Acc: 0.4076
 Site-Painting        | Train Loss: 1.9750 | Train Acc: 0.4280
 Site-Sketch          | Train Loss: 1.9384 | Train Acc: 0.4459
 Site-Sketch          | Train Loss: 1.9721 | Train Acc: 0.4153
 Site-QuickDraw       | Train Loss: 2.2427 | Train Acc: 0.2038
 Site-QuickDraw       | Train Loss: 2.2467 | Train Acc: 0.2500
 Site-Infograph       | Train Loss: 2.2075 | Train Acc: 0.2229
 Site-Infograph       | Train Loss: 2.1680 | Train Acc: 0.2479
 Site-Clipart         | Val  Loss: 2.0750 | Val  Acc: 0.3048
 Site-Clipart         | Val  Loss: 2.0305 | Val  Acc: 0.3556
 Site-Real            | Val  Loss: 1.9630 | Val  Acc: 0.4000
 Site-Real            | Val  Loss: 1.9403 | Val  Acc: 0.4286
 Site-Painting        | Val  Loss: 1.8967 | Val  Acc: 0.4571
 Site-Painting        | Val  Loss: 1.9473 | Val  Acc: 0.4476
 Site-Sketch          | Val  Loss: 1.9940 | Val  Acc: 0.4000
 Site-Sketch          | Val  Loss: 1.9679 | Val  Acc: 0.4413
 Site-QuickDraw       | Val  Loss: 2.2570 | Val  Acc: 0.2190
 Site-QuickDraw       | Val  Loss: 2.2343 | Val  Acc: 0.2603
 Site-Infograph       | Val  Loss: 2.1925 | Val  Acc: 0.2190
 Site-Infograph       | Val  Loss: 2.1608 | Val  Acc: 0.2286
Average Valid Accuracy: 0.3468
 Best site-Clipart          | Epoch:0 | Val Acc: 0.3048
 Best site-Clipart          | Epoch:0 | Val Acc: 0.3556
 Best site-Real             | Epoch:0 | Val Acc: 0.4000
 Best site-Real             | Epoch:0 | Val Acc: 0.4286
 Best site-Painting         | Epoch:0 | Val Acc: 0.4571
 Best site-Painting         | Epoch:0 | Val Acc: 0.4476
 Best site-Sketch           | Epoch:0 | Val Acc: 0.4000
 Best site-Sketch           | Epoch:0 | Val Acc: 0.4413
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.2190
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.2603
 Best site-Infograph        | Epoch:0 | Val Acc: 0.2190
 Best site-Infograph        | Epoch:0 | Val Acc: 0.2286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 1 ============
 Site-Clipart         | Train Loss: 1.6923 | Train Acc: 0.5541
 Site-Clipart         | Train Loss: 1.6935 | Train Acc: 0.5699
 Site-Real            | Train Loss: 1.5139 | Train Acc: 0.7197
 Site-Real            | Train Loss: 1.4484 | Train Acc: 0.7521
 Site-Painting        | Train Loss: 1.5261 | Train Acc: 0.6752
 Site-Painting        | Train Loss: 1.5415 | Train Acc: 0.6631
 Site-Sketch          | Train Loss: 1.6029 | Train Acc: 0.6242
 Site-Sketch          | Train Loss: 1.6010 | Train Acc: 0.5932
 Site-QuickDraw       | Train Loss: 2.1689 | Train Acc: 0.2866
 Site-QuickDraw       | Train Loss: 2.1523 | Train Acc: 0.2903
 Site-Infograph       | Train Loss: 2.0448 | Train Acc: 0.3694
 Site-Infograph       | Train Loss: 1.9842 | Train Acc: 0.3877
 Site-Clipart         | Val  Loss: 1.7585 | Val  Acc: 0.5048
 Site-Clipart         | Val  Loss: 1.7060 | Val  Acc: 0.5365
 Site-Real            | Val  Loss: 1.4877 | Val  Acc: 0.7619
 Site-Real            | Val  Loss: 1.4596 | Val  Acc: 0.7492
 Site-Painting        | Val  Loss: 1.4945 | Val  Acc: 0.7143
 Site-Painting        | Val  Loss: 1.5177 | Val  Acc: 0.6921
 Site-Sketch          | Val  Loss: 1.6492 | Val  Acc: 0.5619
 Site-Sketch          | Val  Loss: 1.5973 | Val  Acc: 0.6000
 Site-QuickDraw       | Val  Loss: 2.1660 | Val  Acc: 0.2667
 Site-QuickDraw       | Val  Loss: 2.1440 | Val  Acc: 0.3016
 Site-Infograph       | Val  Loss: 2.0029 | Val  Acc: 0.3810
 Site-Infograph       | Val  Loss: 1.9688 | Val  Acc: 0.4095
Average Valid Accuracy: 0.5399
 Best site-Clipart          | Epoch:1 | Val Acc: 0.5048
 Best site-Clipart          | Epoch:1 | Val Acc: 0.5365
 Best site-Real             | Epoch:1 | Val Acc: 0.7619
 Best site-Real             | Epoch:1 | Val Acc: 0.7492
 Best site-Painting         | Epoch:1 | Val Acc: 0.7143
 Best site-Painting         | Epoch:1 | Val Acc: 0.6921
 Best site-Sketch           | Epoch:1 | Val Acc: 0.5619
 Best site-Sketch           | Epoch:1 | Val Acc: 0.6000
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.2667
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.3016
 Best site-Infograph        | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph        | Epoch:1 | Val Acc: 0.4095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 2 ============
 Site-Clipart         | Train Loss: 1.3973 | Train Acc: 0.6815
 Site-Clipart         | Train Loss: 1.3808 | Train Acc: 0.6610
 Site-Real            | Train Loss: 1.1307 | Train Acc: 0.8217
 Site-Real            | Train Loss: 1.0370 | Train Acc: 0.8623
 Site-Painting        | Train Loss: 1.2317 | Train Acc: 0.7261
 Site-Painting        | Train Loss: 1.1893 | Train Acc: 0.7775
 Site-Sketch          | Train Loss: 1.2060 | Train Acc: 0.7134
 Site-Sketch          | Train Loss: 1.2644 | Train Acc: 0.6970
 Site-QuickDraw       | Train Loss: 2.0777 | Train Acc: 0.3248
 Site-QuickDraw       | Train Loss: 2.0667 | Train Acc: 0.3305
 Site-Infograph       | Train Loss: 1.9026 | Train Acc: 0.4331
 Site-Infograph       | Train Loss: 1.7969 | Train Acc: 0.4555
 Site-Clipart         | Val  Loss: 1.4109 | Val  Acc: 0.6571
 Site-Clipart         | Val  Loss: 1.3812 | Val  Acc: 0.6921
 Site-Real            | Val  Loss: 1.0739 | Val  Acc: 0.8286
 Site-Real            | Val  Loss: 1.0493 | Val  Acc: 0.8444
 Site-Painting        | Val  Loss: 1.0339 | Val  Acc: 0.8476
 Site-Painting        | Val  Loss: 1.1383 | Val  Acc: 0.7841
 Site-Sketch          | Val  Loss: 1.2414 | Val  Acc: 0.7143
 Site-Sketch          | Val  Loss: 1.2550 | Val  Acc: 0.7175
 Site-QuickDraw       | Val  Loss: 2.0781 | Val  Acc: 0.2857
 Site-QuickDraw       | Val  Loss: 2.0503 | Val  Acc: 0.3556
 Site-Infograph       | Val  Loss: 1.8576 | Val  Acc: 0.4476
 Site-Infograph       | Val  Loss: 1.8066 | Val  Acc: 0.4508
Average Valid Accuracy: 0.6354
 Best site-Clipart          | Epoch:2 | Val Acc: 0.6571
 Best site-Clipart          | Epoch:2 | Val Acc: 0.6921
 Best site-Real             | Epoch:2 | Val Acc: 0.8286
 Best site-Real             | Epoch:2 | Val Acc: 0.8444
 Best site-Painting         | Epoch:2 | Val Acc: 0.8476
 Best site-Painting         | Epoch:2 | Val Acc: 0.7841
 Best site-Sketch           | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch           | Epoch:2 | Val Acc: 0.7175
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.2857
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.3556
 Best site-Infograph        | Epoch:2 | Val Acc: 0.4476
 Best site-Infograph        | Epoch:2 | Val Acc: 0.4508
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 3 ============
 Site-Clipart         | Train Loss: 1.0697 | Train Acc: 0.7580
 Site-Clipart         | Train Loss: 1.0960 | Train Acc: 0.7648
 Site-Real            | Train Loss: 0.8527 | Train Acc: 0.8726
 Site-Real            | Train Loss: 0.7419 | Train Acc: 0.9047
 Site-Painting        | Train Loss: 0.9521 | Train Acc: 0.8025
 Site-Painting        | Train Loss: 0.9149 | Train Acc: 0.8199
 Site-Sketch          | Train Loss: 0.9223 | Train Acc: 0.7898
 Site-Sketch          | Train Loss: 1.0165 | Train Acc: 0.7415
 Site-QuickDraw       | Train Loss: 1.9832 | Train Acc: 0.3185
 Site-QuickDraw       | Train Loss: 1.9780 | Train Acc: 0.3453
 Site-Infograph       | Train Loss: 1.6864 | Train Acc: 0.4268
 Site-Infograph       | Train Loss: 1.6200 | Train Acc: 0.5127
 Site-Clipart         | Val  Loss: 1.2157 | Val  Acc: 0.6952
 Site-Clipart         | Val  Loss: 1.1246 | Val  Acc: 0.7587
 Site-Real            | Val  Loss: 0.8143 | Val  Acc: 0.8667
 Site-Real            | Val  Loss: 0.7708 | Val  Acc: 0.8794
 Site-Painting        | Val  Loss: 0.7723 | Val  Acc: 0.8667
 Site-Painting        | Val  Loss: 0.8618 | Val  Acc: 0.8286
 Site-Sketch          | Val  Loss: 1.0104 | Val  Acc: 0.7143
 Site-Sketch          | Val  Loss: 1.0088 | Val  Acc: 0.7587
 Site-QuickDraw       | Val  Loss: 1.9750 | Val  Acc: 0.2952
 Site-QuickDraw       | Val  Loss: 1.9558 | Val  Acc: 0.3524
 Site-Infograph       | Val  Loss: 1.6696 | Val  Acc: 0.4857
 Site-Infograph       | Val  Loss: 1.6513 | Val  Acc: 0.4921
Average Valid Accuracy: 0.6661
 Best site-Clipart          | Epoch:3 | Val Acc: 0.6952
 Best site-Clipart          | Epoch:3 | Val Acc: 0.7587
 Best site-Real             | Epoch:3 | Val Acc: 0.8667
 Best site-Real             | Epoch:3 | Val Acc: 0.8794
 Best site-Painting         | Epoch:3 | Val Acc: 0.8667
 Best site-Painting         | Epoch:3 | Val Acc: 0.8286
 Best site-Sketch           | Epoch:3 | Val Acc: 0.7143
 Best site-Sketch           | Epoch:3 | Val Acc: 0.7587
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.2952
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.3524
 Best site-Infograph        | Epoch:3 | Val Acc: 0.4857
 Best site-Infograph        | Epoch:3 | Val Acc: 0.4921
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 4 ============
 Site-Clipart         | Train Loss: 0.8962 | Train Acc: 0.7771
 Site-Clipart         | Train Loss: 0.9258 | Train Acc: 0.7860
 Site-Real            | Train Loss: 0.6389 | Train Acc: 0.8790
 Site-Real            | Train Loss: 0.5740 | Train Acc: 0.9301
 Site-Painting        | Train Loss: 0.8022 | Train Acc: 0.8025
 Site-Painting        | Train Loss: 0.7146 | Train Acc: 0.8686
 Site-Sketch          | Train Loss: 0.7863 | Train Acc: 0.8280
 Site-Sketch          | Train Loss: 0.8568 | Train Acc: 0.7669
 Site-QuickDraw       | Train Loss: 1.8819 | Train Acc: 0.4076
 Site-QuickDraw       | Train Loss: 1.8422 | Train Acc: 0.3729
 Site-Infograph       | Train Loss: 1.6538 | Train Acc: 0.5159
 Site-Infograph       | Train Loss: 1.5295 | Train Acc: 0.5085
 Site-Clipart         | Val  Loss: 1.0060 | Val  Acc: 0.7714
 Site-Clipart         | Val  Loss: 0.9197 | Val  Acc: 0.7746
 Site-Real            | Val  Loss: 0.6246 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.5797 | Val  Acc: 0.9270
 Site-Painting        | Val  Loss: 0.6309 | Val  Acc: 0.8476
 Site-Painting        | Val  Loss: 0.7204 | Val  Acc: 0.8635
 Site-Sketch          | Val  Loss: 0.8464 | Val  Acc: 0.8000
 Site-Sketch          | Val  Loss: 0.8626 | Val  Acc: 0.7841
 Site-QuickDraw       | Val  Loss: 1.8895 | Val  Acc: 0.3238
 Site-QuickDraw       | Val  Loss: 1.8130 | Val  Acc: 0.3873
 Site-Infograph       | Val  Loss: 1.6183 | Val  Acc: 0.4667
 Site-Infograph       | Val  Loss: 1.5816 | Val  Acc: 0.5048
Average Valid Accuracy: 0.6963
 Best site-Clipart          | Epoch:4 | Val Acc: 0.7714
 Best site-Clipart          | Epoch:4 | Val Acc: 0.7746
 Best site-Real             | Epoch:4 | Val Acc: 0.9048
 Best site-Real             | Epoch:4 | Val Acc: 0.9270
 Best site-Painting         | Epoch:4 | Val Acc: 0.8476
 Best site-Painting         | Epoch:4 | Val Acc: 0.8635
 Best site-Sketch           | Epoch:4 | Val Acc: 0.8000
 Best site-Sketch           | Epoch:4 | Val Acc: 0.7841
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.3238
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.3873
 Best site-Infograph        | Epoch:4 | Val Acc: 0.4667
 Best site-Infograph        | Epoch:4 | Val Acc: 0.5048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 5 ============
 Site-Clipart         | Train Loss: 0.7971 | Train Acc: 0.7962
 Site-Clipart         | Train Loss: 0.8052 | Train Acc: 0.8072
 Site-Real            | Train Loss: 0.5340 | Train Acc: 0.9108
 Site-Real            | Train Loss: 0.4421 | Train Acc: 0.9322
 Site-Painting        | Train Loss: 0.6469 | Train Acc: 0.8471
 Site-Painting        | Train Loss: 0.6134 | Train Acc: 0.8665
 Site-Sketch          | Train Loss: 0.6597 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.7285 | Train Acc: 0.8157
 Site-QuickDraw       | Train Loss: 1.7835 | Train Acc: 0.3885
 Site-QuickDraw       | Train Loss: 1.7727 | Train Acc: 0.3941
 Site-Infograph       | Train Loss: 1.6084 | Train Acc: 0.4904
 Site-Infograph       | Train Loss: 1.4718 | Train Acc: 0.5191
 Site-Clipart         | Val  Loss: 0.8678 | Val  Acc: 0.7810
 Site-Clipart         | Val  Loss: 0.8479 | Val  Acc: 0.7841
 Site-Real            | Val  Loss: 0.4961 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.4565 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.5031 | Val  Acc: 0.8857
 Site-Painting        | Val  Loss: 0.5917 | Val  Acc: 0.8794
 Site-Sketch          | Val  Loss: 0.6875 | Val  Acc: 0.8286
 Site-Sketch          | Val  Loss: 0.7210 | Val  Acc: 0.8222
 Site-QuickDraw       | Val  Loss: 1.8299 | Val  Acc: 0.3619
 Site-QuickDraw       | Val  Loss: 1.7715 | Val  Acc: 0.4095
 Site-Infograph       | Val  Loss: 1.5683 | Val  Acc: 0.5143
 Site-Infograph       | Val  Loss: 1.5126 | Val  Acc: 0.5206
Average Valid Accuracy: 0.7212
 Best site-Clipart          | Epoch:5 | Val Acc: 0.7810
 Best site-Clipart          | Epoch:5 | Val Acc: 0.7841
 Best site-Real             | Epoch:5 | Val Acc: 0.9333
 Best site-Real             | Epoch:5 | Val Acc: 0.9333
 Best site-Painting         | Epoch:5 | Val Acc: 0.8857
 Best site-Painting         | Epoch:5 | Val Acc: 0.8794
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8286
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8222
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.3619
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.4095
 Best site-Infograph        | Epoch:5 | Val Acc: 0.5143
 Best site-Infograph        | Epoch:5 | Val Acc: 0.5206
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 6 ============
 Site-Clipart         | Train Loss: 0.7145 | Train Acc: 0.8025
 Site-Clipart         | Train Loss: 0.7179 | Train Acc: 0.8051
 Site-Real            | Train Loss: 0.4422 | Train Acc: 0.8981
 Site-Real            | Train Loss: 0.3777 | Train Acc: 0.9386
 Site-Painting        | Train Loss: 0.5917 | Train Acc: 0.8535
 Site-Painting        | Train Loss: 0.5146 | Train Acc: 0.8941
 Site-Sketch          | Train Loss: 0.5995 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.6990 | Train Acc: 0.8030
 Site-QuickDraw       | Train Loss: 1.7378 | Train Acc: 0.4522
 Site-QuickDraw       | Train Loss: 1.6936 | Train Acc: 0.4322
 Site-Infograph       | Train Loss: 1.5652 | Train Acc: 0.5159
 Site-Infograph       | Train Loss: 1.4291 | Train Acc: 0.5530
 Site-Clipart         | Val  Loss: 0.8005 | Val  Acc: 0.8286
 Site-Clipart         | Val  Loss: 0.7777 | Val  Acc: 0.7873
 Site-Real            | Val  Loss: 0.4274 | Val  Acc: 0.9238
 Site-Real            | Val  Loss: 0.3839 | Val  Acc: 0.9460
 Site-Painting        | Val  Loss: 0.4620 | Val  Acc: 0.8952
 Site-Painting        | Val  Loss: 0.5566 | Val  Acc: 0.8540
 Site-Sketch          | Val  Loss: 0.6369 | Val  Acc: 0.8381
 Site-Sketch          | Val  Loss: 0.6397 | Val  Acc: 0.8222
 Site-QuickDraw       | Val  Loss: 1.8069 | Val  Acc: 0.3048
 Site-QuickDraw       | Val  Loss: 1.6515 | Val  Acc: 0.4794
 Site-Infograph       | Val  Loss: 1.5388 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.4766 | Val  Acc: 0.5175
Average Valid Accuracy: 0.7283
 Best site-Clipart          | Epoch:6 | Val Acc: 0.8286
 Best site-Clipart          | Epoch:6 | Val Acc: 0.7873
 Best site-Real             | Epoch:6 | Val Acc: 0.9238
 Best site-Real             | Epoch:6 | Val Acc: 0.9460
 Best site-Painting         | Epoch:6 | Val Acc: 0.8952
 Best site-Painting         | Epoch:6 | Val Acc: 0.8540
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8381
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8222
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.3048
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.4794
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5175
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 7 ============
 Site-Clipart         | Train Loss: 0.6740 | Train Acc: 0.8344
 Site-Clipart         | Train Loss: 0.6795 | Train Acc: 0.8284
 Site-Real            | Train Loss: 0.3773 | Train Acc: 0.9172
 Site-Real            | Train Loss: 0.2958 | Train Acc: 0.9555
 Site-Painting        | Train Loss: 0.5466 | Train Acc: 0.8599
 Site-Painting        | Train Loss: 0.5212 | Train Acc: 0.8898
 Site-Sketch          | Train Loss: 0.5305 | Train Acc: 0.8535
 Site-Sketch          | Train Loss: 0.5887 | Train Acc: 0.8242
 Site-QuickDraw       | Train Loss: 1.6140 | Train Acc: 0.5032
 Site-QuickDraw       | Train Loss: 1.5762 | Train Acc: 0.5021
 Site-Infograph       | Train Loss: 1.4666 | Train Acc: 0.5159
 Site-Infograph       | Train Loss: 1.4375 | Train Acc: 0.5212
 Site-Clipart         | Val  Loss: 0.7213 | Val  Acc: 0.8190
 Site-Clipart         | Val  Loss: 0.7161 | Val  Acc: 0.8159
 Site-Real            | Val  Loss: 0.3558 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.3125 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.4131 | Val  Acc: 0.9048
 Site-Painting        | Val  Loss: 0.4893 | Val  Acc: 0.8857
 Site-Sketch          | Val  Loss: 0.5423 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.6038 | Val  Acc: 0.8413
 Site-QuickDraw       | Val  Loss: 1.6568 | Val  Acc: 0.3905
 Site-QuickDraw       | Val  Loss: 1.5745 | Val  Acc: 0.4921
 Site-Infograph       | Val  Loss: 1.4850 | Val  Acc: 0.4952
 Site-Infograph       | Val  Loss: 1.4634 | Val  Acc: 0.5429
Average Valid Accuracy: 0.7476
 Best site-Clipart          | Epoch:7 | Val Acc: 0.8190
 Best site-Clipart          | Epoch:7 | Val Acc: 0.8159
 Best site-Real             | Epoch:7 | Val Acc: 0.9333
 Best site-Real             | Epoch:7 | Val Acc: 0.9556
 Best site-Painting         | Epoch:7 | Val Acc: 0.9048
 Best site-Painting         | Epoch:7 | Val Acc: 0.8857
 Best site-Sketch           | Epoch:7 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:7 | Val Acc: 0.8413
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.3905
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.4921
 Best site-Infograph        | Epoch:7 | Val Acc: 0.4952
 Best site-Infograph        | Epoch:7 | Val Acc: 0.5429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 8 ============
 Site-Clipart         | Train Loss: 0.6076 | Train Acc: 0.8471
 Site-Clipart         | Train Loss: 0.6274 | Train Acc: 0.8369
 Site-Real            | Train Loss: 0.3687 | Train Acc: 0.9172
 Site-Real            | Train Loss: 0.2742 | Train Acc: 0.9534
 Site-Painting        | Train Loss: 0.5481 | Train Acc: 0.8854
 Site-Painting        | Train Loss: 0.4742 | Train Acc: 0.8898
 Site-Sketch          | Train Loss: 0.5271 | Train Acc: 0.8471
 Site-Sketch          | Train Loss: 0.5811 | Train Acc: 0.8114
 Site-QuickDraw       | Train Loss: 1.4560 | Train Acc: 0.5605
 Site-QuickDraw       | Train Loss: 1.5187 | Train Acc: 0.5275
 Site-Infograph       | Train Loss: 1.4932 | Train Acc: 0.4841
 Site-Infograph       | Train Loss: 1.3493 | Train Acc: 0.5678
 Site-Clipart         | Val  Loss: 0.6458 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.6621 | Val  Acc: 0.8190
 Site-Real            | Val  Loss: 0.3205 | Val  Acc: 0.9238
 Site-Real            | Val  Loss: 0.2803 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.3881 | Val  Acc: 0.8952
 Site-Painting        | Val  Loss: 0.4382 | Val  Acc: 0.8889
 Site-Sketch          | Val  Loss: 0.5470 | Val  Acc: 0.8476
 Site-Sketch          | Val  Loss: 0.5529 | Val  Acc: 0.8286
 Site-QuickDraw       | Val  Loss: 1.5814 | Val  Acc: 0.4095
 Site-QuickDraw       | Val  Loss: 1.4809 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.4628 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.4516 | Val  Acc: 0.4952
Average Valid Accuracy: 0.7561
 Best site-Clipart          | Epoch:8 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:8 | Val Acc: 0.8190
 Best site-Real             | Epoch:8 | Val Acc: 0.9238
 Best site-Real             | Epoch:8 | Val Acc: 0.9556
 Best site-Painting         | Epoch:8 | Val Acc: 0.8952
 Best site-Painting         | Epoch:8 | Val Acc: 0.8889
 Best site-Sketch           | Epoch:8 | Val Acc: 0.8476
 Best site-Sketch           | Epoch:8 | Val Acc: 0.8286
 Best site-QuickDraw        | Epoch:8 | Val Acc: 0.4095
 Best site-QuickDraw        | Epoch:8 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:8 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:8 | Val Acc: 0.4952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 9 ============
 Site-Clipart         | Train Loss: 0.6028 | Train Acc: 0.8535
 Site-Clipart         | Train Loss: 0.5611 | Train Acc: 0.8708
 Site-Real            | Train Loss: 0.2842 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.2710 | Train Acc: 0.9534
 Site-Painting        | Train Loss: 0.4365 | Train Acc: 0.8790
 Site-Painting        | Train Loss: 0.4310 | Train Acc: 0.8962
 Site-Sketch          | Train Loss: 0.4670 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.5752 | Train Acc: 0.8284
 Site-QuickDraw       | Train Loss: 1.4336 | Train Acc: 0.5414
 Site-QuickDraw       | Train Loss: 1.4652 | Train Acc: 0.5360
 Site-Infograph       | Train Loss: 1.4657 | Train Acc: 0.5096
 Site-Infograph       | Train Loss: 1.3221 | Train Acc: 0.5636
 Site-Clipart         | Val  Loss: 0.6634 | Val  Acc: 0.8095
 Site-Clipart         | Val  Loss: 0.6072 | Val  Acc: 0.8413
 Site-Real            | Val  Loss: 0.2872 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.2719 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.3025 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.4190 | Val  Acc: 0.8794
 Site-Sketch          | Val  Loss: 0.4702 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.5042 | Val  Acc: 0.8794
 Site-QuickDraw       | Val  Loss: 1.5498 | Val  Acc: 0.4476
 Site-QuickDraw       | Val  Loss: 1.4425 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.5011 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.4310 | Val  Acc: 0.5111
Average Valid Accuracy: 0.7648
 Best site-Clipart          | Epoch:9 | Val Acc: 0.8095
 Best site-Clipart          | Epoch:9 | Val Acc: 0.8413
 Best site-Real             | Epoch:9 | Val Acc: 0.9524
 Best site-Real             | Epoch:9 | Val Acc: 0.9524
 Best site-Painting         | Epoch:9 | Val Acc: 0.9333
 Best site-Painting         | Epoch:9 | Val Acc: 0.8794
 Best site-Sketch           | Epoch:9 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:9 | Val Acc: 0.8794
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.4476
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5333
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5111
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
 Test site-Clipart         | Epoch:9 | Test Acc: 0.8403
 Test site-Real            | Epoch:9 | Test Acc: 0.9482
 Test site-Painting        | Epoch:9 | Test Acc: 0.9192
 Test site-Sketch          | Epoch:9 | Test Acc: 0.8827
 Test site-QuickDraw       | Epoch:9 | Test Acc: 0.5820
 Test site-Infograph       | Epoch:9 | Test Acc: 0.5510
Average Test Accuracy: 0.7872
============ Train epoch 10 ============
 Site-Clipart         | Train Loss: 0.6090 | Train Acc: 0.8408
 Site-Clipart         | Train Loss: 0.5485 | Train Acc: 0.8581
 Site-Real            | Train Loss: 0.2938 | Train Acc: 0.9236
 Site-Real            | Train Loss: 0.2346 | Train Acc: 0.9555
 Site-Painting        | Train Loss: 0.4520 | Train Acc: 0.8981
 Site-Painting        | Train Loss: 0.3953 | Train Acc: 0.9110
 Site-Sketch          | Train Loss: 0.4692 | Train Acc: 0.8535
 Site-Sketch          | Train Loss: 0.5081 | Train Acc: 0.8517
 Site-QuickDraw       | Train Loss: 1.3570 | Train Acc: 0.5796
 Site-QuickDraw       | Train Loss: 1.3751 | Train Acc: 0.5805
 Site-Infograph       | Train Loss: 1.4575 | Train Acc: 0.4777
 Site-Infograph       | Train Loss: 1.3293 | Train Acc: 0.5657
 Site-Clipart         | Val  Loss: 0.6322 | Val  Acc: 0.8286
 Site-Clipart         | Val  Loss: 0.6084 | Val  Acc: 0.8190
 Site-Real            | Val  Loss: 0.2821 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.2424 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.3018 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.4029 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.4787 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.4929 | Val  Acc: 0.8635
 Site-QuickDraw       | Val  Loss: 1.4795 | Val  Acc: 0.5238
 Site-QuickDraw       | Val  Loss: 1.3686 | Val  Acc: 0.5937
 Site-Infograph       | Val  Loss: 1.4218 | Val  Acc: 0.5238
 Site-Infograph       | Val  Loss: 1.4112 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7728
 Best site-Clipart          | Epoch:10 | Val Acc: 0.8286
 Best site-Clipart          | Epoch:10 | Val Acc: 0.8190
 Best site-Real             | Epoch:10 | Val Acc: 0.9524
 Best site-Real             | Epoch:10 | Val Acc: 0.9556
 Best site-Painting         | Epoch:10 | Val Acc: 0.9333
 Best site-Painting         | Epoch:10 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:10 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:10 | Val Acc: 0.8635
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.5238
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.5937
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5238
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 11 ============
 Site-Clipart         | Train Loss: 0.5413 | Train Acc: 0.8662
 Site-Clipart         | Train Loss: 0.5120 | Train Acc: 0.8644
 Site-Real            | Train Loss: 0.3071 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.2462 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.4089 | Train Acc: 0.8790
 Site-Painting        | Train Loss: 0.3917 | Train Acc: 0.8962
 Site-Sketch          | Train Loss: 0.4863 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.5168 | Train Acc: 0.8475
 Site-QuickDraw       | Train Loss: 1.2822 | Train Acc: 0.5669
 Site-QuickDraw       | Train Loss: 1.2724 | Train Acc: 0.6081
 Site-Infograph       | Train Loss: 1.5715 | Train Acc: 0.4904
 Site-Infograph       | Train Loss: 1.2606 | Train Acc: 0.5890
 Site-Clipart         | Val  Loss: 0.5388 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.5683 | Val  Acc: 0.8349
 Site-Real            | Val  Loss: 0.2251 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.2296 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2870 | Val  Acc: 0.9238
 Site-Painting        | Val  Loss: 0.3754 | Val  Acc: 0.9175
 Site-Sketch          | Val  Loss: 0.5033 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.4755 | Val  Acc: 0.8540
 Site-QuickDraw       | Val  Loss: 1.3618 | Val  Acc: 0.5333
 Site-QuickDraw       | Val  Loss: 1.2663 | Val  Acc: 0.6635
 Site-Infograph       | Val  Loss: 1.4038 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.3352 | Val  Acc: 0.5492
Average Valid Accuracy: 0.7897
 Best site-Clipart          | Epoch:11 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:11 | Val Acc: 0.8349
 Best site-Real             | Epoch:11 | Val Acc: 0.9714
 Best site-Real             | Epoch:11 | Val Acc: 0.9619
 Best site-Painting         | Epoch:11 | Val Acc: 0.9238
 Best site-Painting         | Epoch:11 | Val Acc: 0.9175
 Best site-Sketch           | Epoch:11 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:11 | Val Acc: 0.8540
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.5333
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.6635
 Best site-Infograph        | Epoch:11 | Val Acc: 0.5333
 Best site-Infograph        | Epoch:11 | Val Acc: 0.5492
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 12 ============
 Site-Clipart         | Train Loss: 0.5723 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.5152 | Train Acc: 0.8538
 Site-Real            | Train Loss: 0.2725 | Train Acc: 0.9236
 Site-Real            | Train Loss: 0.2220 | Train Acc: 0.9513
 Site-Painting        | Train Loss: 0.4095 | Train Acc: 0.8726
 Site-Painting        | Train Loss: 0.3565 | Train Acc: 0.8962
 Site-Sketch          | Train Loss: 0.3935 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.4862 | Train Acc: 0.8538
 Site-QuickDraw       | Train Loss: 1.2405 | Train Acc: 0.5924
 Site-QuickDraw       | Train Loss: 1.2313 | Train Acc: 0.6165
 Site-Infograph       | Train Loss: 1.5473 | Train Acc: 0.4650
 Site-Infograph       | Train Loss: 1.2915 | Train Acc: 0.5847
 Site-Clipart         | Val  Loss: 0.5776 | Val  Acc: 0.8476
 Site-Clipart         | Val  Loss: 0.5403 | Val  Acc: 0.8540
 Site-Real            | Val  Loss: 0.2709 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.2205 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.2478 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.3507 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.4274 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.4573 | Val  Acc: 0.8571
 Site-QuickDraw       | Val  Loss: 1.3509 | Val  Acc: 0.5238
 Site-QuickDraw       | Val  Loss: 1.2234 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.3474 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.3740 | Val  Acc: 0.5302
Average Valid Accuracy: 0.7847
============ Train epoch 13 ============
 Site-Clipart         | Train Loss: 0.5887 | Train Acc: 0.8535
 Site-Clipart         | Train Loss: 0.4697 | Train Acc: 0.8771
 Site-Real            | Train Loss: 0.2898 | Train Acc: 0.9236
 Site-Real            | Train Loss: 0.2188 | Train Acc: 0.9576
 Site-Painting        | Train Loss: 0.4009 | Train Acc: 0.9045
 Site-Painting        | Train Loss: 0.3673 | Train Acc: 0.8941
 Site-Sketch          | Train Loss: 0.4428 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.4499 | Train Acc: 0.8644
 Site-QuickDraw       | Train Loss: 1.1333 | Train Acc: 0.6242
 Site-QuickDraw       | Train Loss: 1.2299 | Train Acc: 0.6271
 Site-Infograph       | Train Loss: 1.4940 | Train Acc: 0.5159
 Site-Infograph       | Train Loss: 1.2564 | Train Acc: 0.5890
 Site-Clipart         | Val  Loss: 0.5117 | Val  Acc: 0.8857
 Site-Clipart         | Val  Loss: 0.5254 | Val  Acc: 0.8603
 Site-Real            | Val  Loss: 0.2252 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.2146 | Val  Acc: 0.9492
 Site-Painting        | Val  Loss: 0.2443 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.3310 | Val  Acc: 0.9175
 Site-Sketch          | Val  Loss: 0.4751 | Val  Acc: 0.8476
 Site-Sketch          | Val  Loss: 0.4540 | Val  Acc: 0.8730
 Site-QuickDraw       | Val  Loss: 1.3220 | Val  Acc: 0.5905
 Site-QuickDraw       | Val  Loss: 1.1703 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 1.4382 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.3261 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7974
 Best site-Clipart          | Epoch:13 | Val Acc: 0.8857
 Best site-Clipart          | Epoch:13 | Val Acc: 0.8603
 Best site-Real             | Epoch:13 | Val Acc: 0.9429
 Best site-Real             | Epoch:13 | Val Acc: 0.9492
 Best site-Painting         | Epoch:13 | Val Acc: 0.9429
 Best site-Painting         | Epoch:13 | Val Acc: 0.9175
 Best site-Sketch           | Epoch:13 | Val Acc: 0.8476
 Best site-Sketch           | Epoch:13 | Val Acc: 0.8730
 Best site-QuickDraw        | Epoch:13 | Val Acc: 0.5905
 Best site-QuickDraw        | Epoch:13 | Val Acc: 0.6476
 Best site-Infograph        | Epoch:13 | Val Acc: 0.5524
 Best site-Infograph        | Epoch:13 | Val Acc: 0.5587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 14 ============
 Site-Clipart         | Train Loss: 0.5188 | Train Acc: 0.8662
 Site-Clipart         | Train Loss: 0.4573 | Train Acc: 0.8814
 Site-Real            | Train Loss: 0.2473 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1807 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.3776 | Train Acc: 0.8981
 Site-Painting        | Train Loss: 0.3293 | Train Acc: 0.9153
 Site-Sketch          | Train Loss: 0.3636 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.4717 | Train Acc: 0.8708
 Site-QuickDraw       | Train Loss: 1.1462 | Train Acc: 0.6242
 Site-QuickDraw       | Train Loss: 1.1863 | Train Acc: 0.6441
 Site-Infograph       | Train Loss: 1.4211 | Train Acc: 0.5223
 Site-Infograph       | Train Loss: 1.2623 | Train Acc: 0.5763
 Site-Clipart         | Val  Loss: 0.4358 | Val  Acc: 0.9048
 Site-Clipart         | Val  Loss: 0.5292 | Val  Acc: 0.8635
 Site-Real            | Val  Loss: 0.2227 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.2039 | Val  Acc: 0.9587
 Site-Painting        | Val  Loss: 0.2386 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.3271 | Val  Acc: 0.9206
 Site-Sketch          | Val  Loss: 0.3696 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.4304 | Val  Acc: 0.8762
 Site-QuickDraw       | Val  Loss: 1.2306 | Val  Acc: 0.6000
 Site-QuickDraw       | Val  Loss: 1.1696 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 1.3991 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.3350 | Val  Acc: 0.5524
Average Valid Accuracy: 0.8063
 Best site-Clipart          | Epoch:14 | Val Acc: 0.9048
 Best site-Clipart          | Epoch:14 | Val Acc: 0.8635
 Best site-Real             | Epoch:14 | Val Acc: 0.9333
 Best site-Real             | Epoch:14 | Val Acc: 0.9587
 Best site-Painting         | Epoch:14 | Val Acc: 0.9429
 Best site-Painting         | Epoch:14 | Val Acc: 0.9206
 Best site-Sketch           | Epoch:14 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:14 | Val Acc: 0.8762
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.6000
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.6476
 Best site-Infograph        | Epoch:14 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:14 | Val Acc: 0.5524
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 15 ============
 Site-Clipart         | Train Loss: 0.4988 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.4456 | Train Acc: 0.8792
 Site-Real            | Train Loss: 0.2662 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1769 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.4019 | Train Acc: 0.8917
 Site-Painting        | Train Loss: 0.3192 | Train Acc: 0.9195
 Site-Sketch          | Train Loss: 0.4126 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.4044 | Train Acc: 0.8962
 Site-QuickDraw       | Train Loss: 1.1460 | Train Acc: 0.6242
 Site-QuickDraw       | Train Loss: 1.0960 | Train Acc: 0.6504
 Site-Infograph       | Train Loss: 1.3801 | Train Acc: 0.5032
 Site-Infograph       | Train Loss: 1.2327 | Train Acc: 0.5996
 Site-Clipart         | Val  Loss: 0.4715 | Val  Acc: 0.8857
 Site-Clipart         | Val  Loss: 0.5145 | Val  Acc: 0.8508
 Site-Real            | Val  Loss: 0.2337 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.1877 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.2466 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.3129 | Val  Acc: 0.9111
 Site-Sketch          | Val  Loss: 0.3872 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3959 | Val  Acc: 0.8921
 Site-QuickDraw       | Val  Loss: 1.2054 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 1.0877 | Val  Acc: 0.6762
 Site-Infograph       | Val  Loss: 1.3930 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.2812 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8124
 Best site-Clipart          | Epoch:15 | Val Acc: 0.8857
 Best site-Clipart          | Epoch:15 | Val Acc: 0.8508
 Best site-Real             | Epoch:15 | Val Acc: 0.9429
 Best site-Real             | Epoch:15 | Val Acc: 0.9651
 Best site-Painting         | Epoch:15 | Val Acc: 0.9333
 Best site-Painting         | Epoch:15 | Val Acc: 0.9111
 Best site-Sketch           | Epoch:15 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:15 | Val Acc: 0.8921
 Best site-QuickDraw        | Epoch:15 | Val Acc: 0.6571
 Best site-QuickDraw        | Epoch:15 | Val Acc: 0.6762
 Best site-Infograph        | Epoch:15 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:15 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 16 ============
 Site-Clipart         | Train Loss: 0.5029 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.4398 | Train Acc: 0.8729
 Site-Real            | Train Loss: 0.2479 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1771 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.3806 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.3055 | Train Acc: 0.9174
 Site-Sketch          | Train Loss: 0.4250 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.4200 | Train Acc: 0.8771
 Site-QuickDraw       | Train Loss: 1.0637 | Train Acc: 0.6561
 Site-QuickDraw       | Train Loss: 1.1047 | Train Acc: 0.6441
 Site-Infograph       | Train Loss: 1.4364 | Train Acc: 0.5096
 Site-Infograph       | Train Loss: 1.2352 | Train Acc: 0.6017
 Site-Clipart         | Val  Loss: 0.4564 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.5055 | Val  Acc: 0.8381
 Site-Real            | Val  Loss: 0.1870 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1831 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2405 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.3260 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3921 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3998 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.1593 | Val  Acc: 0.6667
 Site-QuickDraw       | Val  Loss: 1.0692 | Val  Acc: 0.7111
 Site-Infograph       | Val  Loss: 1.3475 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.2940 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8175
 Best site-Clipart          | Epoch:16 | Val Acc: 0.8952
 Best site-Clipart          | Epoch:16 | Val Acc: 0.8381
 Best site-Real             | Epoch:16 | Val Acc: 0.9619
 Best site-Real             | Epoch:16 | Val Acc: 0.9619
 Best site-Painting         | Epoch:16 | Val Acc: 0.9524
 Best site-Painting         | Epoch:16 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:16 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:16 | Val Acc: 0.8889
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.6667
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.7111
 Best site-Infograph        | Epoch:16 | Val Acc: 0.5619
 Best site-Infograph        | Epoch:16 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 17 ============
 Site-Clipart         | Train Loss: 0.4698 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.4548 | Train Acc: 0.8686
 Site-Real            | Train Loss: 0.2465 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1685 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.3491 | Train Acc: 0.9045
 Site-Painting        | Train Loss: 0.3021 | Train Acc: 0.9195
 Site-Sketch          | Train Loss: 0.3517 | Train Acc: 0.9172
 Site-Sketch          | Train Loss: 0.4000 | Train Acc: 0.8856
 Site-QuickDraw       | Train Loss: 1.0148 | Train Acc: 0.6624
 Site-QuickDraw       | Train Loss: 1.0405 | Train Acc: 0.6801
 Site-Infograph       | Train Loss: 1.4022 | Train Acc: 0.5032
 Site-Infograph       | Train Loss: 1.2262 | Train Acc: 0.5932
 Site-Clipart         | Val  Loss: 0.4615 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.4654 | Val  Acc: 0.8667
 Site-Real            | Val  Loss: 0.2158 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.1830 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.1873 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.3149 | Val  Acc: 0.9079
 Site-Sketch          | Val  Loss: 0.4332 | Val  Acc: 0.8476
 Site-Sketch          | Val  Loss: 0.4102 | Val  Acc: 0.8730
 Site-QuickDraw       | Val  Loss: 1.0941 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 1.0369 | Val  Acc: 0.6857
 Site-Infograph       | Val  Loss: 1.3124 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.2988 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8087
============ Train epoch 18 ============
 Site-Clipart         | Train Loss: 0.4511 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.4242 | Train Acc: 0.8856
 Site-Real            | Train Loss: 0.2038 | Train Acc: 0.9172
 Site-Real            | Train Loss: 0.1845 | Train Acc: 0.9576
 Site-Painting        | Train Loss: 0.3330 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.2950 | Train Acc: 0.9153
 Site-Sketch          | Train Loss: 0.3650 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.4302 | Train Acc: 0.8644
 Site-QuickDraw       | Train Loss: 1.0430 | Train Acc: 0.6815
 Site-QuickDraw       | Train Loss: 1.0209 | Train Acc: 0.6843
 Site-Infograph       | Train Loss: 1.4290 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1827 | Train Acc: 0.5953
 Site-Clipart         | Val  Loss: 0.3897 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.4728 | Val  Acc: 0.8667
 Site-Real            | Val  Loss: 0.2012 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1848 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.2152 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2774 | Val  Acc: 0.9270
 Site-Sketch          | Val  Loss: 0.3114 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3760 | Val  Acc: 0.8857
 Site-QuickDraw       | Val  Loss: 1.0674 | Val  Acc: 0.6667
 Site-QuickDraw       | Val  Loss: 1.0401 | Val  Acc: 0.7016
 Site-Infograph       | Val  Loss: 1.3161 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.2885 | Val  Acc: 0.5683
Average Valid Accuracy: 0.8238
 Best site-Clipart          | Epoch:18 | Val Acc: 0.9333
 Best site-Clipart          | Epoch:18 | Val Acc: 0.8667
 Best site-Real             | Epoch:18 | Val Acc: 0.9619
 Best site-Real             | Epoch:18 | Val Acc: 0.9556
 Best site-Painting         | Epoch:18 | Val Acc: 0.9333
 Best site-Painting         | Epoch:18 | Val Acc: 0.9270
 Best site-Sketch           | Epoch:18 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:18 | Val Acc: 0.8857
 Best site-QuickDraw        | Epoch:18 | Val Acc: 0.6667
 Best site-QuickDraw        | Epoch:18 | Val Acc: 0.7016
 Best site-Infograph        | Epoch:18 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:18 | Val Acc: 0.5683
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 19 ============
 Site-Clipart         | Train Loss: 0.4289 | Train Acc: 0.8662
 Site-Clipart         | Train Loss: 0.3847 | Train Acc: 0.8962
 Site-Real            | Train Loss: 0.2136 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1701 | Train Acc: 0.9597
 Site-Painting        | Train Loss: 0.3322 | Train Acc: 0.8854
 Site-Painting        | Train Loss: 0.3006 | Train Acc: 0.9047
 Site-Sketch          | Train Loss: 0.3735 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.4142 | Train Acc: 0.8686
 Site-QuickDraw       | Train Loss: 1.0086 | Train Acc: 0.7006
 Site-QuickDraw       | Train Loss: 1.0482 | Train Acc: 0.6822
 Site-Infograph       | Train Loss: 1.4932 | Train Acc: 0.4968
 Site-Infograph       | Train Loss: 1.2043 | Train Acc: 0.6038
 Site-Clipart         | Val  Loss: 0.4280 | Val  Acc: 0.8667
 Site-Clipart         | Val  Loss: 0.4618 | Val  Acc: 0.8762
 Site-Real            | Val  Loss: 0.1827 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1729 | Val  Acc: 0.9492
 Site-Painting        | Val  Loss: 0.1890 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2979 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.3939 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3835 | Val  Acc: 0.9016
 Site-QuickDraw       | Val  Loss: 1.1269 | Val  Acc: 0.5905
 Site-QuickDraw       | Val  Loss: 0.9708 | Val  Acc: 0.7238
 Site-Infograph       | Val  Loss: 1.3091 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.3098 | Val  Acc: 0.5206
Average Valid Accuracy: 0.8111
============ Train epoch 20 ============
 Site-Clipart         | Train Loss: 0.4053 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.3987 | Train Acc: 0.8983
 Site-Real            | Train Loss: 0.2145 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1562 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.3070 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.3025 | Train Acc: 0.9216
 Site-Sketch          | Train Loss: 0.4049 | Train Acc: 0.8662
 Site-Sketch          | Train Loss: 0.3763 | Train Acc: 0.8877
 Site-QuickDraw       | Train Loss: 0.9715 | Train Acc: 0.6624
 Site-QuickDraw       | Train Loss: 0.9891 | Train Acc: 0.7119
 Site-Infograph       | Train Loss: 1.4375 | Train Acc: 0.5223
 Site-Infograph       | Train Loss: 1.1889 | Train Acc: 0.6038
 Site-Clipart         | Val  Loss: 0.4342 | Val  Acc: 0.8857
 Site-Clipart         | Val  Loss: 0.4333 | Val  Acc: 0.8889
 Site-Real            | Val  Loss: 0.1629 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1834 | Val  Acc: 0.9587
 Site-Painting        | Val  Loss: 0.1777 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2602 | Val  Acc: 0.9460
 Site-Sketch          | Val  Loss: 0.3699 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.4068 | Val  Acc: 0.8794
 Site-QuickDraw       | Val  Loss: 1.0148 | Val  Acc: 0.6857
 Site-QuickDraw       | Val  Loss: 0.9307 | Val  Acc: 0.7238
 Site-Infograph       | Val  Loss: 1.3902 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.2668 | Val  Acc: 0.5587
Average Valid Accuracy: 0.8265
 Best site-Clipart          | Epoch:20 | Val Acc: 0.8857
 Best site-Clipart          | Epoch:20 | Val Acc: 0.8889
 Best site-Real             | Epoch:20 | Val Acc: 0.9619
 Best site-Real             | Epoch:20 | Val Acc: 0.9587
 Best site-Painting         | Epoch:20 | Val Acc: 0.9619
 Best site-Painting         | Epoch:20 | Val Acc: 0.9460
 Best site-Sketch           | Epoch:20 | Val Acc: 0.8952
 Best site-Sketch           | Epoch:20 | Val Acc: 0.8794
 Best site-QuickDraw        | Epoch:20 | Val Acc: 0.6857
 Best site-QuickDraw        | Epoch:20 | Val Acc: 0.7238
 Best site-Infograph        | Epoch:20 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:20 | Val Acc: 0.5587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 21 ============
 Site-Clipart         | Train Loss: 0.4616 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.3608 | Train Acc: 0.8983
 Site-Real            | Train Loss: 0.2052 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1726 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.3219 | Train Acc: 0.9045
 Site-Painting        | Train Loss: 0.2597 | Train Acc: 0.9301
 Site-Sketch          | Train Loss: 0.3250 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.3584 | Train Acc: 0.8877
 Site-QuickDraw       | Train Loss: 0.9938 | Train Acc: 0.6624
 Site-QuickDraw       | Train Loss: 0.9946 | Train Acc: 0.6949
 Site-Infograph       | Train Loss: 1.4150 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.2091 | Train Acc: 0.6038
 Site-Clipart         | Val  Loss: 0.3746 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.4284 | Val  Acc: 0.8762
 Site-Real            | Val  Loss: 0.1768 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1515 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2052 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2675 | Val  Acc: 0.9175
 Site-Sketch          | Val  Loss: 0.3143 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3860 | Val  Acc: 0.8857
 Site-QuickDraw       | Val  Loss: 1.0011 | Val  Acc: 0.6857
 Site-QuickDraw       | Val  Loss: 0.9560 | Val  Acc: 0.7016
 Site-Infograph       | Val  Loss: 1.3163 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.2806 | Val  Acc: 0.5587
Average Valid Accuracy: 0.8251
============ Train epoch 22 ============
 Site-Clipart         | Train Loss: 0.4172 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.3656 | Train Acc: 0.9004
 Site-Real            | Train Loss: 0.2552 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1527 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.3349 | Train Acc: 0.8981
 Site-Painting        | Train Loss: 0.3082 | Train Acc: 0.9258
 Site-Sketch          | Train Loss: 0.3610 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.3799 | Train Acc: 0.8750
 Site-QuickDraw       | Train Loss: 0.9342 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.9510 | Train Acc: 0.7331
 Site-Infograph       | Train Loss: 1.4307 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.1076 | Train Acc: 0.6144
 Site-Clipart         | Val  Loss: 0.3386 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.3923 | Val  Acc: 0.8825
 Site-Real            | Val  Loss: 0.1779 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1515 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1545 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2599 | Val  Acc: 0.9270
 Site-Sketch          | Val  Loss: 0.3249 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3460 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.0365 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 0.9407 | Val  Acc: 0.7143
 Site-Infograph       | Val  Loss: 1.2647 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.2511 | Val  Acc: 0.5746
Average Valid Accuracy: 0.8259
============ Train epoch 23 ============
 Site-Clipart         | Train Loss: 0.4365 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.3614 | Train Acc: 0.9004
 Site-Real            | Train Loss: 0.2195 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1414 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.2917 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.2545 | Train Acc: 0.9364
 Site-Sketch          | Train Loss: 0.3509 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.3484 | Train Acc: 0.8898
 Site-QuickDraw       | Train Loss: 0.9700 | Train Acc: 0.7134
 Site-QuickDraw       | Train Loss: 0.9379 | Train Acc: 0.7203
 Site-Infograph       | Train Loss: 1.4066 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.1784 | Train Acc: 0.6017
 Site-Clipart         | Val  Loss: 0.3428 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.4313 | Val  Acc: 0.8825
 Site-Real            | Val  Loss: 0.1835 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.1725 | Val  Acc: 0.9460
 Site-Painting        | Val  Loss: 0.1696 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2781 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3244 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3611 | Val  Acc: 0.9016
 Site-QuickDraw       | Val  Loss: 0.9196 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.9121 | Val  Acc: 0.7397
 Site-Infograph       | Val  Loss: 1.2599 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.2178 | Val  Acc: 0.5810
Average Valid Accuracy: 0.8407
 Best site-Clipart          | Epoch:23 | Val Acc: 0.9333
 Best site-Clipart          | Epoch:23 | Val Acc: 0.8825
 Best site-Real             | Epoch:23 | Val Acc: 0.9429
 Best site-Real             | Epoch:23 | Val Acc: 0.9460
 Best site-Painting         | Epoch:23 | Val Acc: 0.9524
 Best site-Painting         | Epoch:23 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:23 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:23 | Val Acc: 0.9016
 Best site-QuickDraw        | Epoch:23 | Val Acc: 0.7619
 Best site-QuickDraw        | Epoch:23 | Val Acc: 0.7397
 Best site-Infograph        | Epoch:23 | Val Acc: 0.6095
 Best site-Infograph        | Epoch:23 | Val Acc: 0.5810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 24 ============
 Site-Clipart         | Train Loss: 0.4313 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.3575 | Train Acc: 0.8983
 Site-Real            | Train Loss: 0.2055 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1360 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.2634 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.2513 | Train Acc: 0.9237
 Site-Sketch          | Train Loss: 0.3496 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.3355 | Train Acc: 0.9025
 Site-QuickDraw       | Train Loss: 0.9663 | Train Acc: 0.6879
 Site-QuickDraw       | Train Loss: 0.8778 | Train Acc: 0.7500
 Site-Infograph       | Train Loss: 1.3951 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1183 | Train Acc: 0.6229
 Site-Clipart         | Val  Loss: 0.3555 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.4107 | Val  Acc: 0.8857
 Site-Real            | Val  Loss: 0.1792 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1432 | Val  Acc: 0.9587
 Site-Painting        | Val  Loss: 0.1507 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2551 | Val  Acc: 0.9079
 Site-Sketch          | Val  Loss: 0.3230 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3458 | Val  Acc: 0.9048
 Site-QuickDraw       | Val  Loss: 0.9847 | Val  Acc: 0.6762
 Site-QuickDraw       | Val  Loss: 0.9224 | Val  Acc: 0.7270
 Site-Infograph       | Val  Loss: 1.2699 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.2100 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8302
============ Train epoch 25 ============
 Site-Clipart         | Train Loss: 0.4158 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.3588 | Train Acc: 0.9131
 Site-Real            | Train Loss: 0.1978 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1434 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.2875 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.2358 | Train Acc: 0.9428
 Site-Sketch          | Train Loss: 0.2939 | Train Acc: 0.9299
 Site-Sketch          | Train Loss: 0.3547 | Train Acc: 0.8792
 Site-QuickDraw       | Train Loss: 0.8477 | Train Acc: 0.7325
 Site-QuickDraw       | Train Loss: 0.8722 | Train Acc: 0.7436
 Site-Infograph       | Train Loss: 1.3842 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.1462 | Train Acc: 0.6377
 Site-Clipart         | Val  Loss: 0.3348 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3976 | Val  Acc: 0.8794
 Site-Real            | Val  Loss: 0.1476 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1529 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1546 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2500 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.3663 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3503 | Val  Acc: 0.8857
 Site-QuickDraw       | Val  Loss: 0.9048 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.8750 | Val  Acc: 0.7365
 Site-Infograph       | Val  Loss: 1.3146 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.1853 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8402
============ Train epoch 26 ============
 Site-Clipart         | Train Loss: 0.4175 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.3359 | Train Acc: 0.9047
 Site-Real            | Train Loss: 0.2095 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1311 | Train Acc: 0.9703
 Site-Painting        | Train Loss: 0.2868 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.2334 | Train Acc: 0.9428
 Site-Sketch          | Train Loss: 0.2954 | Train Acc: 0.9299
 Site-Sketch          | Train Loss: 0.3242 | Train Acc: 0.8941
 Site-QuickDraw       | Train Loss: 0.9303 | Train Acc: 0.7389
 Site-QuickDraw       | Train Loss: 0.8901 | Train Acc: 0.7331
 Site-Infograph       | Train Loss: 1.3422 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.0915 | Train Acc: 0.6504
 Site-Clipart         | Val  Loss: 0.3158 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3777 | Val  Acc: 0.8889
 Site-Real            | Val  Loss: 0.1465 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1518 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.1574 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2406 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.2839 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.3327 | Val  Acc: 0.9079
 Site-QuickDraw       | Val  Loss: 0.9868 | Val  Acc: 0.6952
 Site-QuickDraw       | Val  Loss: 0.8411 | Val  Acc: 0.7556
 Site-Infograph       | Val  Loss: 1.1598 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1902 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8458
 Best site-Clipart          | Epoch:26 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:26 | Val Acc: 0.8889
 Best site-Real             | Epoch:26 | Val Acc: 0.9524
 Best site-Real             | Epoch:26 | Val Acc: 0.9556
 Best site-Painting         | Epoch:26 | Val Acc: 0.9714
 Best site-Painting         | Epoch:26 | Val Acc: 0.9397
 Best site-Sketch           | Epoch:26 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:26 | Val Acc: 0.9079
 Best site-QuickDraw        | Epoch:26 | Val Acc: 0.6952
 Best site-QuickDraw        | Epoch:26 | Val Acc: 0.7556
 Best site-Infograph        | Epoch:26 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:26 | Val Acc: 0.6063
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 27 ============
 Site-Clipart         | Train Loss: 0.4278 | Train Acc: 0.8662
 Site-Clipart         | Train Loss: 0.3248 | Train Acc: 0.9174
 Site-Real            | Train Loss: 0.2062 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1212 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.2816 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.2455 | Train Acc: 0.9407
 Site-Sketch          | Train Loss: 0.3230 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.3160 | Train Acc: 0.8983
 Site-QuickDraw       | Train Loss: 0.8548 | Train Acc: 0.7516
 Site-QuickDraw       | Train Loss: 0.8383 | Train Acc: 0.7733
 Site-Infograph       | Train Loss: 1.3527 | Train Acc: 0.5669
 Site-Infograph       | Train Loss: 1.1096 | Train Acc: 0.6335
 Site-Clipart         | Val  Loss: 0.3487 | Val  Acc: 0.9048
 Site-Clipart         | Val  Loss: 0.3965 | Val  Acc: 0.8889
 Site-Real            | Val  Loss: 0.1333 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1504 | Val  Acc: 0.9556
 Site-Painting        | Val  Loss: 0.1579 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2169 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.2910 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3314 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 0.9556 | Val  Acc: 0.6952
 Site-QuickDraw       | Val  Loss: 0.8401 | Val  Acc: 0.7619
 Site-Infograph       | Val  Loss: 1.2514 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.2061 | Val  Acc: 0.5841
Average Valid Accuracy: 0.8357
============ Train epoch 28 ============
 Site-Clipart         | Train Loss: 0.4300 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.3344 | Train Acc: 0.9131
 Site-Real            | Train Loss: 0.2368 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1313 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.2799 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.2296 | Train Acc: 0.9449
 Site-Sketch          | Train Loss: 0.3057 | Train Acc: 0.9490
 Site-Sketch          | Train Loss: 0.3244 | Train Acc: 0.9047
 Site-QuickDraw       | Train Loss: 0.9115 | Train Acc: 0.6943
 Site-QuickDraw       | Train Loss: 0.8581 | Train Acc: 0.7521
 Site-Infograph       | Train Loss: 1.4479 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.1209 | Train Acc: 0.6356
 Site-Clipart         | Val  Loss: 0.3178 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.3752 | Val  Acc: 0.8825
 Site-Real            | Val  Loss: 0.1516 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1377 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.1754 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2482 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.3496 | Val  Acc: 0.8762
 Site-Sketch          | Val  Loss: 0.3059 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.8599 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.8205 | Val  Acc: 0.7619
 Site-Infograph       | Val  Loss: 1.3677 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.1741 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8365
============ Train epoch 29 ============
 Site-Clipart         | Train Loss: 0.3881 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.3311 | Train Acc: 0.9195
 Site-Real            | Train Loss: 0.2216 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1305 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.2388 | Train Acc: 0.9554
 Site-Painting        | Train Loss: 0.2168 | Train Acc: 0.9470
 Site-Sketch          | Train Loss: 0.3151 | Train Acc: 0.9299
 Site-Sketch          | Train Loss: 0.3192 | Train Acc: 0.8983
 Site-QuickDraw       | Train Loss: 0.8693 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.8418 | Train Acc: 0.7394
 Site-Infograph       | Train Loss: 1.3561 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1401 | Train Acc: 0.6356
 Site-Clipart         | Val  Loss: 0.2991 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.3751 | Val  Acc: 0.8762
 Site-Real            | Val  Loss: 0.1397 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1522 | Val  Acc: 0.9587
 Site-Painting        | Val  Loss: 0.1946 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.2023 | Val  Acc: 0.9556
 Site-Sketch          | Val  Loss: 0.3247 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.3257 | Val  Acc: 0.9016
 Site-QuickDraw       | Val  Loss: 0.9447 | Val  Acc: 0.6857
 Site-QuickDraw       | Val  Loss: 0.8376 | Val  Acc: 0.7746
 Site-Infograph       | Val  Loss: 1.2191 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.1599 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8365
============ Train epoch 30 ============
 Site-Clipart         | Train Loss: 0.4265 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.3300 | Train Acc: 0.9131
 Site-Real            | Train Loss: 0.2049 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1142 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.2772 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.2096 | Train Acc: 0.9470
 Site-Sketch          | Train Loss: 0.2832 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.3359 | Train Acc: 0.8941
 Site-QuickDraw       | Train Loss: 0.8792 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.8327 | Train Acc: 0.7733
 Site-Infograph       | Train Loss: 1.2929 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.1002 | Train Acc: 0.6356
 Site-Clipart         | Val  Loss: 0.2942 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3717 | Val  Acc: 0.8794
 Site-Real            | Val  Loss: 0.1497 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1669 | Val  Acc: 0.9492
 Site-Painting        | Val  Loss: 0.1288 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.2043 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2616 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.2984 | Val  Acc: 0.9175
 Site-QuickDraw       | Val  Loss: 0.9231 | Val  Acc: 0.7143
 Site-QuickDraw       | Val  Loss: 0.8089 | Val  Acc: 0.7841
 Site-Infograph       | Val  Loss: 1.1826 | Val  Acc: 0.6000
 Site-Infograph       | Val  Loss: 1.1932 | Val  Acc: 0.5968
Average Valid Accuracy: 0.8487
 Best site-Clipart          | Epoch:30 | Val Acc: 0.9333
 Best site-Clipart          | Epoch:30 | Val Acc: 0.8794
 Best site-Real             | Epoch:30 | Val Acc: 0.9524
 Best site-Real             | Epoch:30 | Val Acc: 0.9492
 Best site-Painting         | Epoch:30 | Val Acc: 0.9810
 Best site-Painting         | Epoch:30 | Val Acc: 0.9524
 Best site-Sketch           | Epoch:30 | Val Acc: 0.9238
 Best site-Sketch           | Epoch:30 | Val Acc: 0.9175
 Best site-QuickDraw        | Epoch:30 | Val Acc: 0.7143
 Best site-QuickDraw        | Epoch:30 | Val Acc: 0.7841
 Best site-Infograph        | Epoch:30 | Val Acc: 0.6000
 Best site-Infograph        | Epoch:30 | Val Acc: 0.5968
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 31 ============
 Site-Clipart         | Train Loss: 0.4107 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.2839 | Train Acc: 0.9174
 Site-Real            | Train Loss: 0.1675 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1223 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.2403 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.2432 | Train Acc: 0.9428
 Site-Sketch          | Train Loss: 0.3165 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.3309 | Train Acc: 0.8856
 Site-QuickDraw       | Train Loss: 0.8023 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.8159 | Train Acc: 0.7479
 Site-Infograph       | Train Loss: 1.4031 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.0905 | Train Acc: 0.6462
 Site-Clipart         | Val  Loss: 0.3205 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.3706 | Val  Acc: 0.8825
 Site-Real            | Val  Loss: 0.1274 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1311 | Val  Acc: 0.9683
 Site-Painting        | Val  Loss: 0.1677 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1883 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.3158 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3174 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.8587 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.8097 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.2282 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1589 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8503
 Best site-Clipart          | Epoch:31 | Val Acc: 0.9143
 Best site-Clipart          | Epoch:31 | Val Acc: 0.8825
 Best site-Real             | Epoch:31 | Val Acc: 0.9619
 Best site-Real             | Epoch:31 | Val Acc: 0.9683
 Best site-Painting         | Epoch:31 | Val Acc: 0.9619
 Best site-Painting         | Epoch:31 | Val Acc: 0.9587
 Best site-Sketch           | Epoch:31 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:31 | Val Acc: 0.9111
 Best site-QuickDraw        | Epoch:31 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:31 | Val Acc: 0.7810
 Best site-Infograph        | Epoch:31 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:31 | Val Acc: 0.6159
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 32 ============
 Site-Clipart         | Train Loss: 0.4626 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.2970 | Train Acc: 0.9089
 Site-Real            | Train Loss: 0.2012 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1502 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.3038 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1848 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.2954 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.3101 | Train Acc: 0.9004
 Site-QuickDraw       | Train Loss: 0.8737 | Train Acc: 0.7134
 Site-QuickDraw       | Train Loss: 0.7989 | Train Acc: 0.7542
 Site-Infograph       | Train Loss: 1.3047 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.0807 | Train Acc: 0.6123
 Site-Clipart         | Val  Loss: 0.3072 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3680 | Val  Acc: 0.8794
 Site-Real            | Val  Loss: 0.1201 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1302 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1473 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.2095 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.3474 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.2959 | Val  Acc: 0.9016
 Site-QuickDraw       | Val  Loss: 0.8637 | Val  Acc: 0.7143
 Site-QuickDraw       | Val  Loss: 0.8197 | Val  Acc: 0.7524
 Site-Infograph       | Val  Loss: 1.1988 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1552 | Val  Acc: 0.5905
Average Valid Accuracy: 0.8378
============ Train epoch 33 ============
 Site-Clipart         | Train Loss: 0.4076 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2863 | Train Acc: 0.9280
 Site-Real            | Train Loss: 0.1963 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1147 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.2781 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1911 | Train Acc: 0.9513
 Site-Sketch          | Train Loss: 0.3177 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.3188 | Train Acc: 0.8983
 Site-QuickDraw       | Train Loss: 0.8102 | Train Acc: 0.7771
 Site-QuickDraw       | Train Loss: 0.7782 | Train Acc: 0.7754
 Site-Infograph       | Train Loss: 1.3047 | Train Acc: 0.5669
 Site-Infograph       | Train Loss: 1.0759 | Train Acc: 0.6292
 Site-Clipart         | Val  Loss: 0.2353 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.3176 | Val  Acc: 0.9175
 Site-Real            | Val  Loss: 0.1027 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1255 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.1895 | Val  Acc: 0.9238
 Site-Painting        | Val  Loss: 0.2011 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.3166 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2832 | Val  Acc: 0.9302
 Site-QuickDraw       | Val  Loss: 0.8164 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.7804 | Val  Acc: 0.7841
 Site-Infograph       | Val  Loss: 1.2026 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1272 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8643
 Best site-Clipart          | Epoch:33 | Val Acc: 0.9714
 Best site-Clipart          | Epoch:33 | Val Acc: 0.9175
 Best site-Real             | Epoch:33 | Val Acc: 0.9905
 Best site-Real             | Epoch:33 | Val Acc: 0.9651
 Best site-Painting         | Epoch:33 | Val Acc: 0.9238
 Best site-Painting         | Epoch:33 | Val Acc: 0.9587
 Best site-Sketch           | Epoch:33 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:33 | Val Acc: 0.9302
 Best site-QuickDraw        | Epoch:33 | Val Acc: 0.8095
 Best site-QuickDraw        | Epoch:33 | Val Acc: 0.7841
 Best site-Infograph        | Epoch:33 | Val Acc: 0.5905
 Best site-Infograph        | Epoch:33 | Val Acc: 0.6159
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 34 ============
 Site-Clipart         | Train Loss: 0.3628 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2994 | Train Acc: 0.9216
 Site-Real            | Train Loss: 0.1920 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1174 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2533 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.2266 | Train Acc: 0.9470
 Site-Sketch          | Train Loss: 0.2607 | Train Acc: 0.9427
 Site-Sketch          | Train Loss: 0.2889 | Train Acc: 0.9131
 Site-QuickDraw       | Train Loss: 0.8006 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.7839 | Train Acc: 0.7669
 Site-Infograph       | Train Loss: 1.2998 | Train Acc: 0.5796
 Site-Infograph       | Train Loss: 1.0654 | Train Acc: 0.6504
 Site-Clipart         | Val  Loss: 0.2572 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3460 | Val  Acc: 0.8984
 Site-Real            | Val  Loss: 0.1274 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1166 | Val  Acc: 0.9778
 Site-Painting        | Val  Loss: 0.1327 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2138 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.2439 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2690 | Val  Acc: 0.9270
 Site-QuickDraw       | Val  Loss: 0.8471 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.7496 | Val  Acc: 0.7905
 Site-Infograph       | Val  Loss: 1.1742 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1908 | Val  Acc: 0.5905
Average Valid Accuracy: 0.8595
============ Train epoch 35 ============
 Site-Clipart         | Train Loss: 0.4781 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.2883 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.1938 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1263 | Train Acc: 0.9661
 Site-Painting        | Train Loss: 0.2907 | Train Acc: 0.8981
 Site-Painting        | Train Loss: 0.2068 | Train Acc: 0.9364
 Site-Sketch          | Train Loss: 0.3097 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.2936 | Train Acc: 0.9131
 Site-QuickDraw       | Train Loss: 0.7855 | Train Acc: 0.7580
 Site-QuickDraw       | Train Loss: 0.7718 | Train Acc: 0.7818
 Site-Infograph       | Train Loss: 1.2394 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 1.0649 | Train Acc: 0.6356
 Site-Clipart         | Val  Loss: 0.2757 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.3380 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.0973 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1176 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1384 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.1880 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2567 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.2840 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.8490 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.7445 | Val  Acc: 0.7905
 Site-Infograph       | Val  Loss: 1.2131 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.1434 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8556
============ Train epoch 36 ============
 Site-Clipart         | Train Loss: 0.3442 | Train Acc: 0.9427
 Site-Clipart         | Train Loss: 0.2910 | Train Acc: 0.9153
 Site-Real            | Train Loss: 0.2114 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1163 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.2353 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.2101 | Train Acc: 0.9470
 Site-Sketch          | Train Loss: 0.3283 | Train Acc: 0.8854
 Site-Sketch          | Train Loss: 0.3180 | Train Acc: 0.9089
 Site-QuickDraw       | Train Loss: 0.7868 | Train Acc: 0.7643
 Site-QuickDraw       | Train Loss: 0.8024 | Train Acc: 0.7669
 Site-Infograph       | Train Loss: 1.2774 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.0379 | Train Acc: 0.6335
 Site-Clipart         | Val  Loss: 0.3103 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.3319 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.1003 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1210 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1508 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2050 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2708 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3135 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.8043 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.7830 | Val  Acc: 0.7587
 Site-Infograph       | Val  Loss: 1.1585 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.0778 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8532
============ Train epoch 37 ============
 Site-Clipart         | Train Loss: 0.3820 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2791 | Train Acc: 0.9301
 Site-Real            | Train Loss: 0.1446 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1165 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2384 | Train Acc: 0.9490
 Site-Painting        | Train Loss: 0.1797 | Train Acc: 0.9555
 Site-Sketch          | Train Loss: 0.2495 | Train Acc: 0.9554
 Site-Sketch          | Train Loss: 0.3240 | Train Acc: 0.8983
 Site-QuickDraw       | Train Loss: 0.8486 | Train Acc: 0.7643
 Site-QuickDraw       | Train Loss: 0.7267 | Train Acc: 0.7648
 Site-Infograph       | Train Loss: 1.3100 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 1.0300 | Train Acc: 0.6483
 Site-Clipart         | Val  Loss: 0.2885 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3294 | Val  Acc: 0.8952
 Site-Real            | Val  Loss: 0.1214 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1219 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1140 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1806 | Val  Acc: 0.9556
 Site-Sketch          | Val  Loss: 0.2808 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2531 | Val  Acc: 0.9270
 Site-QuickDraw       | Val  Loss: 0.8100 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.7320 | Val  Acc: 0.7873
 Site-Infograph       | Val  Loss: 1.1549 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.1036 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8558
============ Train epoch 38 ============
 Site-Clipart         | Train Loss: 0.3325 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2867 | Train Acc: 0.9343
 Site-Real            | Train Loss: 0.1856 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.0993 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2429 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.1953 | Train Acc: 0.9407
 Site-Sketch          | Train Loss: 0.2458 | Train Acc: 0.9299
 Site-Sketch          | Train Loss: 0.2989 | Train Acc: 0.9237
 Site-QuickDraw       | Train Loss: 0.8495 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.7511 | Train Acc: 0.7903
 Site-Infograph       | Train Loss: 1.2351 | Train Acc: 0.5860
 Site-Infograph       | Train Loss: 1.0516 | Train Acc: 0.6356
 Site-Clipart         | Val  Loss: 0.3204 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.3165 | Val  Acc: 0.9270
 Site-Real            | Val  Loss: 0.1462 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.1004 | Val  Acc: 0.9746
 Site-Painting        | Val  Loss: 0.1224 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2052 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.2445 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2974 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.8215 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.7437 | Val  Acc: 0.7587
 Site-Infograph       | Val  Loss: 1.1660 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.0862 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8571
============ Train epoch 39 ============
 Site-Clipart         | Train Loss: 0.3663 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.3228 | Train Acc: 0.9131
 Site-Real            | Train Loss: 0.1983 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1122 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.2458 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.1804 | Train Acc: 0.9576
 Site-Sketch          | Train Loss: 0.3211 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2693 | Train Acc: 0.9089
 Site-QuickDraw       | Train Loss: 0.7464 | Train Acc: 0.7643
 Site-QuickDraw       | Train Loss: 0.7326 | Train Acc: 0.7924
 Site-Infograph       | Train Loss: 1.2716 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.0426 | Train Acc: 0.6589
 Site-Clipart         | Val  Loss: 0.3045 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3317 | Val  Acc: 0.9175
 Site-Real            | Val  Loss: 0.0998 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1130 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1105 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1805 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.2608 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.2433 | Val  Acc: 0.9429
 Site-QuickDraw       | Val  Loss: 0.8324 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.7407 | Val  Acc: 0.7968
 Site-Infograph       | Val  Loss: 1.1518 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.0988 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8611
============ Train epoch 40 ============
 Site-Clipart         | Train Loss: 0.3645 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2871 | Train Acc: 0.9280
 Site-Real            | Train Loss: 0.1512 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1006 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.2319 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1746 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.3392 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.2712 | Train Acc: 0.9110
 Site-QuickDraw       | Train Loss: 0.7522 | Train Acc: 0.7643
 Site-QuickDraw       | Train Loss: 0.7359 | Train Acc: 0.7839
 Site-Infograph       | Train Loss: 1.1962 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 1.0245 | Train Acc: 0.6525
 Site-Clipart         | Val  Loss: 0.2733 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.3246 | Val  Acc: 0.8984
 Site-Real            | Val  Loss: 0.1342 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.1076 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1252 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1828 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.2561 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.2699 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.7411 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.7414 | Val  Acc: 0.7714
 Site-Infograph       | Val  Loss: 1.1419 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1111 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8614
============ Train epoch 41 ============
 Site-Clipart         | Train Loss: 0.3279 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2761 | Train Acc: 0.9258
 Site-Real            | Train Loss: 0.1355 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.1066 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.2532 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1733 | Train Acc: 0.9534
 Site-Sketch          | Train Loss: 0.2818 | Train Acc: 0.9363
 Site-Sketch          | Train Loss: 0.2850 | Train Acc: 0.8983
 Site-QuickDraw       | Train Loss: 0.8203 | Train Acc: 0.7516
 Site-QuickDraw       | Train Loss: 0.7341 | Train Acc: 0.7987
 Site-Infograph       | Train Loss: 1.3893 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 1.0243 | Train Acc: 0.6653
 Site-Clipart         | Val  Loss: 0.2830 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3305 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.1055 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0944 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.0699 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.1695 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2291 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2794 | Val  Acc: 0.9175
 Site-QuickDraw       | Val  Loss: 0.7629 | Val  Acc: 0.7810
 Site-QuickDraw       | Val  Loss: 0.7403 | Val  Acc: 0.7968
 Site-Infograph       | Val  Loss: 1.1222 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.1100 | Val  Acc: 0.6254
Average Valid Accuracy: 0.8706
 Best site-Clipart          | Epoch:41 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:41 | Val Acc: 0.9111
 Best site-Real             | Epoch:41 | Val Acc: 0.9905
 Best site-Real             | Epoch:41 | Val Acc: 0.9714
 Best site-Painting         | Epoch:41 | Val Acc: 1.0000
 Best site-Painting         | Epoch:41 | Val Acc: 0.9587
 Best site-Sketch           | Epoch:41 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:41 | Val Acc: 0.9175
 Best site-QuickDraw        | Epoch:41 | Val Acc: 0.7810
 Best site-QuickDraw        | Epoch:41 | Val Acc: 0.7968
 Best site-Infograph        | Epoch:41 | Val Acc: 0.6095
 Best site-Infograph        | Epoch:41 | Val Acc: 0.6254
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 42 ============
 Site-Clipart         | Train Loss: 0.3514 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2735 | Train Acc: 0.9216
 Site-Real            | Train Loss: 0.2119 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1093 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.1876 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.1828 | Train Acc: 0.9513
 Site-Sketch          | Train Loss: 0.2395 | Train Acc: 0.9427
 Site-Sketch          | Train Loss: 0.3032 | Train Acc: 0.9068
 Site-QuickDraw       | Train Loss: 0.7524 | Train Acc: 0.7516
 Site-QuickDraw       | Train Loss: 0.7218 | Train Acc: 0.7966
 Site-Infograph       | Train Loss: 1.3196 | Train Acc: 0.5796
 Site-Infograph       | Train Loss: 0.9931 | Train Acc: 0.6758
 Site-Clipart         | Val  Loss: 0.2519 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.3196 | Val  Acc: 0.9206
 Site-Real            | Val  Loss: 0.1054 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1055 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.1030 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1847 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2745 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2473 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.7557 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.7169 | Val  Acc: 0.7937
 Site-Infograph       | Val  Loss: 1.1233 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.0884 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8709
 Best site-Clipart          | Epoch:42 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:42 | Val Acc: 0.9206
 Best site-Real             | Epoch:42 | Val Acc: 0.9810
 Best site-Real             | Epoch:42 | Val Acc: 0.9651
 Best site-Painting         | Epoch:42 | Val Acc: 0.9905
 Best site-Painting         | Epoch:42 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:42 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:42 | Val Acc: 0.9365
 Best site-QuickDraw        | Epoch:42 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:42 | Val Acc: 0.7937
 Best site-Infograph        | Epoch:42 | Val Acc: 0.6381
 Best site-Infograph        | Epoch:42 | Val Acc: 0.6349
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 43 ============
 Site-Clipart         | Train Loss: 0.3373 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.2615 | Train Acc: 0.9216
 Site-Real            | Train Loss: 0.1723 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.0966 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.2188 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1996 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.2626 | Train Acc: 0.9172
 Site-Sketch          | Train Loss: 0.2997 | Train Acc: 0.9216
 Site-QuickDraw       | Train Loss: 0.6736 | Train Acc: 0.7771
 Site-QuickDraw       | Train Loss: 0.6933 | Train Acc: 0.7860
 Site-Infograph       | Train Loss: 1.2777 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.0331 | Train Acc: 0.6695
 Site-Clipart         | Val  Loss: 0.2751 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3198 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.1234 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1122 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1044 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1917 | Val  Acc: 0.9556
 Site-Sketch          | Val  Loss: 0.2180 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2677 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.6918 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 0.7326 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.1424 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.0645 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8656
============ Train epoch 44 ============
 Site-Clipart         | Train Loss: 0.3526 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.2732 | Train Acc: 0.9258
 Site-Real            | Train Loss: 0.1697 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1099 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2162 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1707 | Train Acc: 0.9534
 Site-Sketch          | Train Loss: 0.2421 | Train Acc: 0.9299
 Site-Sketch          | Train Loss: 0.2719 | Train Acc: 0.9153
 Site-QuickDraw       | Train Loss: 0.6800 | Train Acc: 0.7834
 Site-QuickDraw       | Train Loss: 0.6843 | Train Acc: 0.7903
 Site-Infograph       | Train Loss: 1.2584 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 0.9996 | Train Acc: 0.6801
 Site-Clipart         | Val  Loss: 0.2205 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.3292 | Val  Acc: 0.8952
 Site-Real            | Val  Loss: 0.1250 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1064 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.1012 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1768 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2295 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2480 | Val  Acc: 0.9302
 Site-QuickDraw       | Val  Loss: 0.7545 | Val  Acc: 0.8000
 Site-QuickDraw       | Val  Loss: 0.7283 | Val  Acc: 0.7651
 Site-Infograph       | Val  Loss: 1.0716 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.0389 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8685
============ Train epoch 45 ============
 Site-Clipart         | Train Loss: 0.3387 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2513 | Train Acc: 0.9301
 Site-Real            | Train Loss: 0.1885 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.0974 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2316 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1635 | Train Acc: 0.9682
 Site-Sketch          | Train Loss: 0.2202 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.2826 | Train Acc: 0.9216
 Site-QuickDraw       | Train Loss: 0.6914 | Train Acc: 0.7389
 Site-QuickDraw       | Train Loss: 0.6908 | Train Acc: 0.8008
 Site-Infograph       | Train Loss: 1.3201 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.0220 | Train Acc: 0.6631
 Site-Clipart         | Val  Loss: 0.2179 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3010 | Val  Acc: 0.9079
 Site-Real            | Val  Loss: 0.1223 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 0.1018 | Val  Acc: 0.9746
 Site-Painting        | Val  Loss: 0.1101 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1750 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2177 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2460 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.6945 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.6830 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.1103 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.0475 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8680
============ Train epoch 46 ============
 Site-Clipart         | Train Loss: 0.2789 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.2642 | Train Acc: 0.9237
 Site-Real            | Train Loss: 0.1666 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.0986 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.2038 | Train Acc: 0.9554
 Site-Painting        | Train Loss: 0.1538 | Train Acc: 0.9597
 Site-Sketch          | Train Loss: 0.2825 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2406 | Train Acc: 0.9301
 Site-QuickDraw       | Train Loss: 0.7597 | Train Acc: 0.7580
 Site-QuickDraw       | Train Loss: 0.6942 | Train Acc: 0.7797
 Site-Infograph       | Train Loss: 1.2888 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 0.9894 | Train Acc: 0.6695
 Site-Clipart         | Val  Loss: 0.2639 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2846 | Val  Acc: 0.9143
 Site-Real            | Val  Loss: 0.1078 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1057 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.0932 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1671 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2184 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2116 | Val  Acc: 0.9397
 Site-QuickDraw       | Val  Loss: 0.7522 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 0.6962 | Val  Acc: 0.7968
 Site-Infograph       | Val  Loss: 1.0144 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 1.0506 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8725
 Best site-Clipart          | Epoch:46 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:46 | Val Acc: 0.9143
 Best site-Real             | Epoch:46 | Val Acc: 0.9714
 Best site-Real             | Epoch:46 | Val Acc: 0.9714
 Best site-Painting         | Epoch:46 | Val Acc: 0.9714
 Best site-Painting         | Epoch:46 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:46 | Val Acc: 0.9524
 Best site-Sketch           | Epoch:46 | Val Acc: 0.9397
 Best site-QuickDraw        | Epoch:46 | Val Acc: 0.7905
 Best site-QuickDraw        | Epoch:46 | Val Acc: 0.7968
 Best site-Infograph        | Epoch:46 | Val Acc: 0.6286
 Best site-Infograph        | Epoch:46 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 47 ============
 Site-Clipart         | Train Loss: 0.3632 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.2497 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.1582 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.0992 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.2416 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1629 | Train Acc: 0.9555
 Site-Sketch          | Train Loss: 0.3295 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2535 | Train Acc: 0.9258
 Site-QuickDraw       | Train Loss: 0.6911 | Train Acc: 0.7325
 Site-QuickDraw       | Train Loss: 0.6769 | Train Acc: 0.7966
 Site-Infograph       | Train Loss: 1.2104 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.0080 | Train Acc: 0.6737
 Site-Clipart         | Val  Loss: 0.2502 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3089 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.0732 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1013 | Val  Acc: 0.9778
 Site-Painting        | Val  Loss: 0.0894 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1679 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2457 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2596 | Val  Acc: 0.9079
 Site-QuickDraw       | Val  Loss: 0.7264 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.6981 | Val  Acc: 0.8000
 Site-Infograph       | Val  Loss: 1.1548 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.0513 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8664
============ Train epoch 48 ============
 Site-Clipart         | Train Loss: 0.3092 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.2434 | Train Acc: 0.9343
 Site-Real            | Train Loss: 0.1765 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.0963 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2461 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.1671 | Train Acc: 0.9555
 Site-Sketch          | Train Loss: 0.2682 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.2372 | Train Acc: 0.9237
 Site-QuickDraw       | Train Loss: 0.7227 | Train Acc: 0.7643
 Site-QuickDraw       | Train Loss: 0.6730 | Train Acc: 0.7924
 Site-Infograph       | Train Loss: 1.2299 | Train Acc: 0.6051
 Site-Infograph       | Train Loss: 1.0010 | Train Acc: 0.6758
 Site-Clipart         | Val  Loss: 0.2459 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2837 | Val  Acc: 0.9175
 Site-Real            | Val  Loss: 0.0886 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1057 | Val  Acc: 0.9651
 Site-Painting        | Val  Loss: 0.1196 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1829 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2443 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2428 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.7400 | Val  Acc: 0.8000
 Site-QuickDraw       | Val  Loss: 0.7080 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.1284 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.0547 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8730
 Best site-Clipart          | Epoch:48 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:48 | Val Acc: 0.9175
 Best site-Real             | Epoch:48 | Val Acc: 0.9810
 Best site-Real             | Epoch:48 | Val Acc: 0.9651
 Best site-Painting         | Epoch:48 | Val Acc: 0.9714
 Best site-Painting         | Epoch:48 | Val Acc: 0.9587
 Best site-Sketch           | Epoch:48 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:48 | Val Acc: 0.9365
 Best site-QuickDraw        | Epoch:48 | Val Acc: 0.8000
 Best site-QuickDraw        | Epoch:48 | Val Acc: 0.7810
 Best site-Infograph        | Epoch:48 | Val Acc: 0.6381
 Best site-Infograph        | Epoch:48 | Val Acc: 0.6413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/CoCoOP...
============ Train epoch 49 ============
 Site-Clipart         | Train Loss: 0.3737 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2550 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.1816 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.0905 | Train Acc: 0.9746
 Site-Painting        | Train Loss: 0.2429 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1648 | Train Acc: 0.9597
 Site-Sketch          | Train Loss: 0.2935 | Train Acc: 0.9363
 Site-Sketch          | Train Loss: 0.2551 | Train Acc: 0.9174
 Site-QuickDraw       | Train Loss: 0.6803 | Train Acc: 0.7898
 Site-QuickDraw       | Train Loss: 0.6953 | Train Acc: 0.7903
 Site-Infograph       | Train Loss: 1.2896 | Train Acc: 0.5987
 Site-Infograph       | Train Loss: 0.9827 | Train Acc: 0.6780
 Site-Clipart         | Val  Loss: 0.2556 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.2816 | Val  Acc: 0.9175
 Site-Real            | Val  Loss: 0.1007 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.0963 | Val  Acc: 0.9746
 Site-Painting        | Val  Loss: 0.0868 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1786 | Val  Acc: 0.9460
 Site-Sketch          | Val  Loss: 0.2251 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2555 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.6670 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.6960 | Val  Acc: 0.7873
 Site-Infograph       | Val  Loss: 1.0762 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 1.0101 | Val  Acc: 0.6508
Average Valid Accuracy: 0.8720
===2023-05-13 02:18:19===
===2023-05-13 02:18:30===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
domain number = 6
Loading snapshots...
 Test site-Clipart         | Epoch:48 | Test Acc: 0.9030
 Test site-Real            | Epoch:48 | Test Acc: 0.9556
 Test site-Painting        | Epoch:48 | Test Acc: 0.9435
 Test site-Sketch          | Epoch:48 | Test Acc: 0.9224
 Test site-QuickDraw       | Epoch:48 | Test Acc: 0.7820
 Test site-Infograph       | Epoch:48 | Test Acc: 0.6119
Average Test Accuracy: 0.8531
