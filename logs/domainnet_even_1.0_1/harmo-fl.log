===2023-05-13 02:20:37===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart         | Train Loss: 1.3568 | Train Acc: 0.7707
 Site-Clipart         | Train Loss: 1.3128 | Train Acc: 0.7797
 Site-Real            | Train Loss: 1.0916 | Train Acc: 0.8790
 Site-Real            | Train Loss: 0.9627 | Train Acc: 0.9322
 Site-Painting        | Train Loss: 1.1471 | Train Acc: 0.8344
 Site-Painting        | Train Loss: 1.1612 | Train Acc: 0.8093
 Site-Sketch          | Train Loss: 1.2973 | Train Acc: 0.6879
 Site-Sketch          | Train Loss: 1.2807 | Train Acc: 0.7415
 Site-QuickDraw       | Train Loss: 1.9623 | Train Acc: 0.4331
 Site-QuickDraw       | Train Loss: 1.9678 | Train Acc: 0.4407
 Site-Infograph       | Train Loss: 1.8470 | Train Acc: 0.4841
 Site-Infograph       | Train Loss: 1.8324 | Train Acc: 0.4703
 Site-Clipart         | Val  Loss: 1.3371 | Val  Acc: 0.8095
 Site-Clipart         | Val  Loss: 1.3281 | Val  Acc: 0.7778
 Site-Real            | Val  Loss: 0.9648 | Val  Acc: 0.9619
 Site-Real            | Val  Loss: 1.0018 | Val  Acc: 0.9270
 Site-Painting        | Val  Loss: 1.0797 | Val  Acc: 0.8381
 Site-Painting        | Val  Loss: 1.1777 | Val  Acc: 0.8159
 Site-Sketch          | Val  Loss: 1.2463 | Val  Acc: 0.7714
 Site-Sketch          | Val  Loss: 1.2545 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 1.9417 | Val  Acc: 0.4571
 Site-QuickDraw       | Val  Loss: 1.9428 | Val  Acc: 0.4667
 Site-Infograph       | Val  Loss: 1.9205 | Val  Acc: 0.4381
 Site-Infograph       | Val  Loss: 1.8471 | Val  Acc: 0.4571
Average Valid Accuracy: 0.7053
 Best site-Clipart          | Epoch:0 | Val Acc: 0.8095
 Best site-Clipart          | Epoch:0 | Val Acc: 0.7778
 Best site-Real             | Epoch:0 | Val Acc: 0.9619
 Best site-Real             | Epoch:0 | Val Acc: 0.9270
 Best site-Painting         | Epoch:0 | Val Acc: 0.8381
 Best site-Painting         | Epoch:0 | Val Acc: 0.8159
 Best site-Sketch           | Epoch:0 | Val Acc: 0.7714
 Best site-Sketch           | Epoch:0 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.4571
 Best site-QuickDraw        | Epoch:0 | Val Acc: 0.4667
 Best site-Infograph        | Epoch:0 | Val Acc: 0.4381
 Best site-Infograph        | Epoch:0 | Val Acc: 0.4571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart         | Train Loss: 0.8986 | Train Acc: 0.8217
 Site-Clipart         | Train Loss: 0.8996 | Train Acc: 0.8369
 Site-Real            | Train Loss: 0.5823 | Train Acc: 0.9236
 Site-Real            | Train Loss: 0.4840 | Train Acc: 0.9619
 Site-Painting        | Train Loss: 0.7278 | Train Acc: 0.8535
 Site-Painting        | Train Loss: 0.7154 | Train Acc: 0.8814
 Site-Sketch          | Train Loss: 0.9057 | Train Acc: 0.7389
 Site-Sketch          | Train Loss: 0.8333 | Train Acc: 0.7797
 Site-QuickDraw       | Train Loss: 1.7226 | Train Acc: 0.5032
 Site-QuickDraw       | Train Loss: 1.7314 | Train Acc: 0.5064
 Site-Infograph       | Train Loss: 1.6199 | Train Acc: 0.4968
 Site-Infograph       | Train Loss: 1.6103 | Train Acc: 0.5318
 Site-Clipart         | Val  Loss: 0.8715 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.9102 | Val  Acc: 0.8190
 Site-Real            | Val  Loss: 0.5029 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.4919 | Val  Acc: 0.9683
 Site-Painting        | Val  Loss: 0.5770 | Val  Acc: 0.9048
 Site-Painting        | Val  Loss: 0.7227 | Val  Acc: 0.8540
 Site-Sketch          | Val  Loss: 0.7484 | Val  Acc: 0.8476
 Site-Sketch          | Val  Loss: 0.8711 | Val  Acc: 0.7937
 Site-QuickDraw       | Val  Loss: 1.7230 | Val  Acc: 0.4571
 Site-QuickDraw       | Val  Loss: 1.7155 | Val  Acc: 0.5111
 Site-Infograph       | Val  Loss: 1.7038 | Val  Acc: 0.4952
 Site-Infograph       | Val  Loss: 1.6398 | Val  Acc: 0.5016
Average Valid Accuracy: 0.7500
 Best site-Clipart          | Epoch:1 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:1 | Val Acc: 0.8190
 Best site-Real             | Epoch:1 | Val Acc: 0.9714
 Best site-Real             | Epoch:1 | Val Acc: 0.9683
 Best site-Painting         | Epoch:1 | Val Acc: 0.9048
 Best site-Painting         | Epoch:1 | Val Acc: 0.8540
 Best site-Sketch           | Epoch:1 | Val Acc: 0.8476
 Best site-Sketch           | Epoch:1 | Val Acc: 0.7937
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.4571
 Best site-QuickDraw        | Epoch:1 | Val Acc: 0.5111
 Best site-Infograph        | Epoch:1 | Val Acc: 0.4952
 Best site-Infograph        | Epoch:1 | Val Acc: 0.5016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart         | Train Loss: 0.6758 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.6895 | Train Acc: 0.8708
 Site-Real            | Train Loss: 0.4098 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.3165 | Train Acc: 0.9640
 Site-Painting        | Train Loss: 0.5649 | Train Acc: 0.8662
 Site-Painting        | Train Loss: 0.5763 | Train Acc: 0.8941
 Site-Sketch          | Train Loss: 0.7229 | Train Acc: 0.8025
 Site-Sketch          | Train Loss: 0.6421 | Train Acc: 0.8263
 Site-QuickDraw       | Train Loss: 1.5810 | Train Acc: 0.4777
 Site-QuickDraw       | Train Loss: 1.5799 | Train Acc: 0.5339
 Site-Infograph       | Train Loss: 1.5920 | Train Acc: 0.4650
 Site-Infograph       | Train Loss: 1.5081 | Train Acc: 0.5339
 Site-Clipart         | Val  Loss: 0.6750 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.6984 | Val  Acc: 0.8540
 Site-Real            | Val  Loss: 0.3295 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.3390 | Val  Acc: 0.9746
 Site-Painting        | Val  Loss: 0.4509 | Val  Acc: 0.9048
 Site-Painting        | Val  Loss: 0.5772 | Val  Acc: 0.8698
 Site-Sketch          | Val  Loss: 0.6451 | Val  Acc: 0.8286
 Site-Sketch          | Val  Loss: 0.6654 | Val  Acc: 0.8286
 Site-QuickDraw       | Val  Loss: 1.5078 | Val  Acc: 0.5238
 Site-QuickDraw       | Val  Loss: 1.5842 | Val  Acc: 0.5460
 Site-Infograph       | Val  Loss: 1.5976 | Val  Acc: 0.4762
 Site-Infograph       | Val  Loss: 1.5542 | Val  Acc: 0.5016
Average Valid Accuracy: 0.7630
 Best site-Clipart          | Epoch:2 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:2 | Val Acc: 0.8540
 Best site-Real             | Epoch:2 | Val Acc: 0.9714
 Best site-Real             | Epoch:2 | Val Acc: 0.9746
 Best site-Painting         | Epoch:2 | Val Acc: 0.9048
 Best site-Painting         | Epoch:2 | Val Acc: 0.8698
 Best site-Sketch           | Epoch:2 | Val Acc: 0.8286
 Best site-Sketch           | Epoch:2 | Val Acc: 0.8286
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.5238
 Best site-QuickDraw        | Epoch:2 | Val Acc: 0.5460
 Best site-Infograph        | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph        | Epoch:2 | Val Acc: 0.5016
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart         | Train Loss: 0.6452 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.5707 | Train Acc: 0.8856
 Site-Real            | Train Loss: 0.2921 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.2332 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.5583 | Train Acc: 0.8344
 Site-Painting        | Train Loss: 0.4718 | Train Acc: 0.8835
 Site-Sketch          | Train Loss: 0.5856 | Train Acc: 0.8089
 Site-Sketch          | Train Loss: 0.6062 | Train Acc: 0.8347
 Site-QuickDraw       | Train Loss: 1.4704 | Train Acc: 0.5541
 Site-QuickDraw       | Train Loss: 1.4536 | Train Acc: 0.5805
 Site-Infograph       | Train Loss: 1.5821 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.4894 | Train Acc: 0.5403
 Site-Clipart         | Val  Loss: 0.5770 | Val  Acc: 0.8667
 Site-Clipart         | Val  Loss: 0.6297 | Val  Acc: 0.8508
 Site-Real            | Val  Loss: 0.2426 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.2777 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.3587 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.5038 | Val  Acc: 0.8698
 Site-Sketch          | Val  Loss: 0.5320 | Val  Acc: 0.8476
 Site-Sketch          | Val  Loss: 0.5672 | Val  Acc: 0.8286
 Site-QuickDraw       | Val  Loss: 1.5065 | Val  Acc: 0.4857
 Site-QuickDraw       | Val  Loss: 1.4426 | Val  Acc: 0.6222
 Site-Infograph       | Val  Loss: 1.5819 | Val  Acc: 0.5619
 Site-Infograph       | Val  Loss: 1.4945 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7786
 Best site-Clipart          | Epoch:3 | Val Acc: 0.8667
 Best site-Clipart          | Epoch:3 | Val Acc: 0.8508
 Best site-Real             | Epoch:3 | Val Acc: 0.9714
 Best site-Real             | Epoch:3 | Val Acc: 0.9619
 Best site-Painting         | Epoch:3 | Val Acc: 0.9524
 Best site-Painting         | Epoch:3 | Val Acc: 0.8698
 Best site-Sketch           | Epoch:3 | Val Acc: 0.8476
 Best site-Sketch           | Epoch:3 | Val Acc: 0.8286
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.4857
 Best site-QuickDraw        | Epoch:3 | Val Acc: 0.6222
 Best site-Infograph        | Epoch:3 | Val Acc: 0.5619
 Best site-Infograph        | Epoch:3 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 4 ============
 Site-Clipart         | Train Loss: 0.6193 | Train Acc: 0.8408
 Site-Clipart         | Train Loss: 0.5071 | Train Acc: 0.8771
 Site-Real            | Train Loss: 0.2483 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.1886 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.4024 | Train Acc: 0.8854
 Site-Painting        | Train Loss: 0.4339 | Train Acc: 0.8919
 Site-Sketch          | Train Loss: 0.5222 | Train Acc: 0.8344
 Site-Sketch          | Train Loss: 0.5378 | Train Acc: 0.8475
 Site-QuickDraw       | Train Loss: 1.4457 | Train Acc: 0.5669
 Site-QuickDraw       | Train Loss: 1.3572 | Train Acc: 0.6229
 Site-Infograph       | Train Loss: 1.4931 | Train Acc: 0.4968
 Site-Infograph       | Train Loss: 1.4235 | Train Acc: 0.5614
 Site-Clipart         | Val  Loss: 0.5204 | Val  Acc: 0.8857
 Site-Clipart         | Val  Loss: 0.5519 | Val  Acc: 0.8857
 Site-Real            | Val  Loss: 0.2025 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.2009 | Val  Acc: 0.9778
 Site-Painting        | Val  Loss: 0.3271 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.4391 | Val  Acc: 0.8794
 Site-Sketch          | Val  Loss: 0.4716 | Val  Acc: 0.8571
 Site-Sketch          | Val  Loss: 0.5302 | Val  Acc: 0.8413
 Site-QuickDraw       | Val  Loss: 1.4308 | Val  Acc: 0.5333
 Site-QuickDraw       | Val  Loss: 1.3308 | Val  Acc: 0.6317
 Site-Infograph       | Val  Loss: 1.5423 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.4601 | Val  Acc: 0.5238
Average Valid Accuracy: 0.7886
 Best site-Clipart          | Epoch:4 | Val Acc: 0.8857
 Best site-Clipart          | Epoch:4 | Val Acc: 0.8857
 Best site-Real             | Epoch:4 | Val Acc: 0.9714
 Best site-Real             | Epoch:4 | Val Acc: 0.9778
 Best site-Painting         | Epoch:4 | Val Acc: 0.9429
 Best site-Painting         | Epoch:4 | Val Acc: 0.8794
 Best site-Sketch           | Epoch:4 | Val Acc: 0.8571
 Best site-Sketch           | Epoch:4 | Val Acc: 0.8413
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.5333
 Best site-QuickDraw        | Epoch:4 | Val Acc: 0.6317
 Best site-Infograph        | Epoch:4 | Val Acc: 0.5333
 Best site-Infograph        | Epoch:4 | Val Acc: 0.5238
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart         | Train Loss: 0.5272 | Train Acc: 0.8662
 Site-Clipart         | Train Loss: 0.4767 | Train Acc: 0.8856
 Site-Real            | Train Loss: 0.2620 | Train Acc: 0.9299
 Site-Real            | Train Loss: 0.1795 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.4130 | Train Acc: 0.8726
 Site-Painting        | Train Loss: 0.3886 | Train Acc: 0.9110
 Site-Sketch          | Train Loss: 0.5773 | Train Acc: 0.8089
 Site-Sketch          | Train Loss: 0.4789 | Train Acc: 0.8538
 Site-QuickDraw       | Train Loss: 1.3200 | Train Acc: 0.5478
 Site-QuickDraw       | Train Loss: 1.3031 | Train Acc: 0.6059
 Site-Infograph       | Train Loss: 1.5190 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.3705 | Train Acc: 0.5614
 Site-Clipart         | Val  Loss: 0.5263 | Val  Acc: 0.8762
 Site-Clipart         | Val  Loss: 0.5201 | Val  Acc: 0.8635
 Site-Real            | Val  Loss: 0.1999 | Val  Acc: 0.9714
 Site-Real            | Val  Loss: 0.1845 | Val  Acc: 0.9778
 Site-Painting        | Val  Loss: 0.2476 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.4110 | Val  Acc: 0.8984
 Site-Sketch          | Val  Loss: 0.4675 | Val  Acc: 0.8667
 Site-Sketch          | Val  Loss: 0.5086 | Val  Acc: 0.8730
 Site-QuickDraw       | Val  Loss: 1.3243 | Val  Acc: 0.6095
 Site-QuickDraw       | Val  Loss: 1.3169 | Val  Acc: 0.6032
 Site-Infograph       | Val  Loss: 1.5549 | Val  Acc: 0.4952
 Site-Infograph       | Val  Loss: 1.4311 | Val  Acc: 0.5587
Average Valid Accuracy: 0.7955
 Best site-Clipart          | Epoch:5 | Val Acc: 0.8762
 Best site-Clipart          | Epoch:5 | Val Acc: 0.8635
 Best site-Real             | Epoch:5 | Val Acc: 0.9714
 Best site-Real             | Epoch:5 | Val Acc: 0.9778
 Best site-Painting         | Epoch:5 | Val Acc: 0.9524
 Best site-Painting         | Epoch:5 | Val Acc: 0.8984
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8667
 Best site-Sketch           | Epoch:5 | Val Acc: 0.8730
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.6095
 Best site-QuickDraw        | Epoch:5 | Val Acc: 0.6032
 Best site-Infograph        | Epoch:5 | Val Acc: 0.4952
 Best site-Infograph        | Epoch:5 | Val Acc: 0.5587
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 6 ============
 Site-Clipart         | Train Loss: 0.4716 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.4782 | Train Acc: 0.8877
 Site-Real            | Train Loss: 0.2154 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.1444 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.3584 | Train Acc: 0.8790
 Site-Painting        | Train Loss: 0.3774 | Train Acc: 0.8983
 Site-Sketch          | Train Loss: 0.5966 | Train Acc: 0.8217
 Site-Sketch          | Train Loss: 0.4721 | Train Acc: 0.8623
 Site-QuickDraw       | Train Loss: 1.2971 | Train Acc: 0.6115
 Site-QuickDraw       | Train Loss: 1.2262 | Train Acc: 0.6292
 Site-Infograph       | Train Loss: 1.4541 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.3539 | Train Acc: 0.5742
 Site-Clipart         | Val  Loss: 0.3985 | Val  Acc: 0.9238
 Site-Clipart         | Val  Loss: 0.4629 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.1601 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1523 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.2768 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.3935 | Val  Acc: 0.8984
 Site-Sketch          | Val  Loss: 0.4279 | Val  Acc: 0.8762
 Site-Sketch          | Val  Loss: 0.4221 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.2599 | Val  Acc: 0.5810
 Site-QuickDraw       | Val  Loss: 1.2278 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 1.4693 | Val  Acc: 0.5238
 Site-Infograph       | Val  Loss: 1.3887 | Val  Acc: 0.5460
Average Valid Accuracy: 0.8056
 Best site-Clipart          | Epoch:6 | Val Acc: 0.9238
 Best site-Clipart          | Epoch:6 | Val Acc: 0.9048
 Best site-Real             | Epoch:6 | Val Acc: 0.9810
 Best site-Real             | Epoch:6 | Val Acc: 0.9810
 Best site-Painting         | Epoch:6 | Val Acc: 0.9333
 Best site-Painting         | Epoch:6 | Val Acc: 0.8984
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8762
 Best site-Sketch           | Epoch:6 | Val Acc: 0.8889
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.5810
 Best site-QuickDraw        | Epoch:6 | Val Acc: 0.6286
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph        | Epoch:6 | Val Acc: 0.5460
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 7 ============
 Site-Clipart         | Train Loss: 0.4850 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.4559 | Train Acc: 0.9047
 Site-Real            | Train Loss: 0.2192 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.1439 | Train Acc: 0.9725
 Site-Painting        | Train Loss: 0.3762 | Train Acc: 0.8917
 Site-Painting        | Train Loss: 0.3588 | Train Acc: 0.9089
 Site-Sketch          | Train Loss: 0.5289 | Train Acc: 0.8471
 Site-Sketch          | Train Loss: 0.4342 | Train Acc: 0.8750
 Site-QuickDraw       | Train Loss: 1.2444 | Train Acc: 0.5860
 Site-QuickDraw       | Train Loss: 1.1642 | Train Acc: 0.6441
 Site-Infograph       | Train Loss: 1.4869 | Train Acc: 0.5096
 Site-Infograph       | Train Loss: 1.2526 | Train Acc: 0.6144
 Site-Clipart         | Val  Loss: 0.3949 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.4240 | Val  Acc: 0.9016
 Site-Real            | Val  Loss: 0.1316 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1362 | Val  Acc: 0.9873
 Site-Painting        | Val  Loss: 0.2087 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.3454 | Val  Acc: 0.8984
 Site-Sketch          | Val  Loss: 0.3513 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.4605 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.2789 | Val  Acc: 0.5524
 Site-QuickDraw       | Val  Loss: 1.1918 | Val  Acc: 0.6444
 Site-Infograph       | Val  Loss: 1.4113 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.3224 | Val  Acc: 0.6095
Average Valid Accuracy: 0.8164
 Best site-Clipart          | Epoch:7 | Val Acc: 0.9333
 Best site-Clipart          | Epoch:7 | Val Acc: 0.9016
 Best site-Real             | Epoch:7 | Val Acc: 0.9905
 Best site-Real             | Epoch:7 | Val Acc: 0.9873
 Best site-Painting         | Epoch:7 | Val Acc: 0.9429
 Best site-Painting         | Epoch:7 | Val Acc: 0.8984
 Best site-Sketch           | Epoch:7 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:7 | Val Acc: 0.8889
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.5524
 Best site-QuickDraw        | Epoch:7 | Val Acc: 0.6444
 Best site-Infograph        | Epoch:7 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:7 | Val Acc: 0.6095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart         | Train Loss: 0.4580 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.4079 | Train Acc: 0.8962
 Site-Real            | Train Loss: 0.2464 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.1386 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.3747 | Train Acc: 0.9045
 Site-Painting        | Train Loss: 0.3179 | Train Acc: 0.9068
 Site-Sketch          | Train Loss: 0.4548 | Train Acc: 0.8535
 Site-Sketch          | Train Loss: 0.4021 | Train Acc: 0.8771
 Site-QuickDraw       | Train Loss: 1.0937 | Train Acc: 0.6178
 Site-QuickDraw       | Train Loss: 1.1447 | Train Acc: 0.6568
 Site-Infograph       | Train Loss: 1.4812 | Train Acc: 0.5223
 Site-Infograph       | Train Loss: 1.3355 | Train Acc: 0.5869
 Site-Clipart         | Val  Loss: 0.3298 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.4194 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.1390 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1254 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.2318 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.3317 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3522 | Val  Acc: 0.8952
 Site-Sketch          | Val  Loss: 0.4283 | Val  Acc: 0.8667
 Site-QuickDraw       | Val  Loss: 1.2024 | Val  Acc: 0.6190
 Site-QuickDraw       | Val  Loss: 1.1337 | Val  Acc: 0.6444
 Site-Infograph       | Val  Loss: 1.4922 | Val  Acc: 0.4952
 Site-Infograph       | Val  Loss: 1.3543 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8119
============ Train epoch 9 ============
 Site-Clipart         | Train Loss: 0.4110 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.3759 | Train Acc: 0.8941
 Site-Real            | Train Loss: 0.1744 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.1232 | Train Acc: 0.9767
 Site-Painting        | Train Loss: 0.3797 | Train Acc: 0.9045
 Site-Painting        | Train Loss: 0.3432 | Train Acc: 0.9195
 Site-Sketch          | Train Loss: 0.4530 | Train Acc: 0.8471
 Site-Sketch          | Train Loss: 0.3686 | Train Acc: 0.8919
 Site-QuickDraw       | Train Loss: 1.0907 | Train Acc: 0.6815
 Site-QuickDraw       | Train Loss: 1.0771 | Train Acc: 0.6928
 Site-Infograph       | Train Loss: 1.3591 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.2599 | Train Acc: 0.5975
 Site-Clipart         | Val  Loss: 0.3186 | Val  Acc: 0.9143
 Site-Clipart         | Val  Loss: 0.3806 | Val  Acc: 0.8952
 Site-Real            | Val  Loss: 0.1263 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.1097 | Val  Acc: 0.9873
 Site-Painting        | Val  Loss: 0.1957 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.3308 | Val  Acc: 0.9175
 Site-Sketch          | Val  Loss: 0.3637 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3842 | Val  Acc: 0.8984
 Site-QuickDraw       | Val  Loss: 1.1227 | Val  Acc: 0.6381
 Site-QuickDraw       | Val  Loss: 1.1188 | Val  Acc: 0.6571
 Site-Infograph       | Val  Loss: 1.3680 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.2905 | Val  Acc: 0.5778
Average Valid Accuracy: 0.8246
 Best site-Clipart          | Epoch:9 | Val Acc: 0.9143
 Best site-Clipart          | Epoch:9 | Val Acc: 0.8952
 Best site-Real             | Epoch:9 | Val Acc: 0.9810
 Best site-Real             | Epoch:9 | Val Acc: 0.9873
 Best site-Painting         | Epoch:9 | Val Acc: 0.9714
 Best site-Painting         | Epoch:9 | Val Acc: 0.9175
 Best site-Sketch           | Epoch:9 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:9 | Val Acc: 0.8984
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.6381
 Best site-QuickDraw        | Epoch:9 | Val Acc: 0.6571
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5524
 Best site-Infograph        | Epoch:9 | Val Acc: 0.5778
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
 Test site-Clipart         | Epoch:9 | Test Acc: 0.9144
 Test site-Real            | Epoch:9 | Test Acc: 0.9573
 Test site-Painting        | Epoch:9 | Test Acc: 0.9192
 Test site-Sketch          | Epoch:9 | Test Acc: 0.9007
 Test site-QuickDraw       | Epoch:9 | Test Acc: 0.6420
 Test site-Infograph       | Epoch:9 | Test Acc: 0.5449
Average Test Accuracy: 0.8131
============ Train epoch 10 ============
 Site-Clipart         | Train Loss: 0.4188 | Train Acc: 0.8854
 Site-Clipart         | Train Loss: 0.3409 | Train Acc: 0.9195
 Site-Real            | Train Loss: 0.2036 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0976 | Train Acc: 0.9873
 Site-Painting        | Train Loss: 0.3566 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.2637 | Train Acc: 0.9258
 Site-Sketch          | Train Loss: 0.4473 | Train Acc: 0.8471
 Site-Sketch          | Train Loss: 0.3767 | Train Acc: 0.8835
 Site-QuickDraw       | Train Loss: 1.0680 | Train Acc: 0.6115
 Site-QuickDraw       | Train Loss: 1.0563 | Train Acc: 0.6886
 Site-Infograph       | Train Loss: 1.3552 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.2387 | Train Acc: 0.6017
 Site-Clipart         | Val  Loss: 0.3899 | Val  Acc: 0.9048
 Site-Clipart         | Val  Loss: 0.3507 | Val  Acc: 0.9143
 Site-Real            | Val  Loss: 0.1192 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1296 | Val  Acc: 0.9746
 Site-Painting        | Val  Loss: 0.1924 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.3042 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3415 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3747 | Val  Acc: 0.8698
 Site-QuickDraw       | Val  Loss: 1.0797 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 1.0303 | Val  Acc: 0.6984
 Site-Infograph       | Val  Loss: 1.4075 | Val  Acc: 0.5048
 Site-Infograph       | Val  Loss: 1.2919 | Val  Acc: 0.5873
Average Valid Accuracy: 0.8259
 Best site-Clipart          | Epoch:10 | Val Acc: 0.9048
 Best site-Clipart          | Epoch:10 | Val Acc: 0.9143
 Best site-Real             | Epoch:10 | Val Acc: 0.9905
 Best site-Real             | Epoch:10 | Val Acc: 0.9746
 Best site-Painting         | Epoch:10 | Val Acc: 0.9619
 Best site-Painting         | Epoch:10 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:10 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:10 | Val Acc: 0.8698
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.6571
 Best site-QuickDraw        | Epoch:10 | Val Acc: 0.6984
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5048
 Best site-Infograph        | Epoch:10 | Val Acc: 0.5873
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart         | Train Loss: 0.4011 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.3330 | Train Acc: 0.9174
 Site-Real            | Train Loss: 0.1589 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0964 | Train Acc: 0.9788
 Site-Painting        | Train Loss: 0.2986 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.2874 | Train Acc: 0.9195
 Site-Sketch          | Train Loss: 0.4519 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.3828 | Train Acc: 0.8877
 Site-QuickDraw       | Train Loss: 1.0617 | Train Acc: 0.6624
 Site-QuickDraw       | Train Loss: 1.0173 | Train Acc: 0.7013
 Site-Infograph       | Train Loss: 1.3931 | Train Acc: 0.5350
 Site-Infograph       | Train Loss: 1.1896 | Train Acc: 0.6186
 Site-Clipart         | Val  Loss: 0.3383 | Val  Acc: 0.9048
 Site-Clipart         | Val  Loss: 0.3315 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.0898 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.1107 | Val  Acc: 0.9841
 Site-Painting        | Val  Loss: 0.2272 | Val  Acc: 0.9333
 Site-Painting        | Val  Loss: 0.2838 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3284 | Val  Acc: 0.9048
 Site-Sketch          | Val  Loss: 0.3594 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.0608 | Val  Acc: 0.6762
 Site-QuickDraw       | Val  Loss: 1.0407 | Val  Acc: 0.6889
 Site-Infograph       | Val  Loss: 1.4015 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.2742 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8270
 Best site-Clipart          | Epoch:11 | Val Acc: 0.9048
 Best site-Clipart          | Epoch:11 | Val Acc: 0.9048
 Best site-Real             | Epoch:11 | Val Acc: 0.9905
 Best site-Real             | Epoch:11 | Val Acc: 0.9841
 Best site-Painting         | Epoch:11 | Val Acc: 0.9333
 Best site-Painting         | Epoch:11 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:11 | Val Acc: 0.9048
 Best site-Sketch           | Epoch:11 | Val Acc: 0.8889
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.6762
 Best site-QuickDraw        | Epoch:11 | Val Acc: 0.6889
 Best site-Infograph        | Epoch:11 | Val Acc: 0.5333
 Best site-Infograph        | Epoch:11 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 12 ============
 Site-Clipart         | Train Loss: 0.3211 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.3050 | Train Acc: 0.9280
 Site-Real            | Train Loss: 0.1670 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0924 | Train Acc: 0.9873
 Site-Painting        | Train Loss: 0.3125 | Train Acc: 0.8981
 Site-Painting        | Train Loss: 0.2730 | Train Acc: 0.9364
 Site-Sketch          | Train Loss: 0.4045 | Train Acc: 0.8726
 Site-Sketch          | Train Loss: 0.3454 | Train Acc: 0.8962
 Site-QuickDraw       | Train Loss: 1.1152 | Train Acc: 0.6115
 Site-QuickDraw       | Train Loss: 1.0302 | Train Acc: 0.6843
 Site-Infograph       | Train Loss: 1.3868 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.1914 | Train Acc: 0.6165
 Site-Clipart         | Val  Loss: 0.3341 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3461 | Val  Acc: 0.8984
 Site-Real            | Val  Loss: 0.0854 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0990 | Val  Acc: 0.9873
 Site-Painting        | Val  Loss: 0.1899 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.2660 | Val  Acc: 0.9302
 Site-Sketch          | Val  Loss: 0.2778 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3391 | Val  Acc: 0.9079
 Site-QuickDraw       | Val  Loss: 1.0748 | Val  Acc: 0.6571
 Site-QuickDraw       | Val  Loss: 1.0121 | Val  Acc: 0.6889
 Site-Infograph       | Val  Loss: 1.3118 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.2366 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8389
 Best site-Clipart          | Epoch:12 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:12 | Val Acc: 0.8984
 Best site-Real             | Epoch:12 | Val Acc: 0.9905
 Best site-Real             | Epoch:12 | Val Acc: 0.9873
 Best site-Painting         | Epoch:12 | Val Acc: 0.9619
 Best site-Painting         | Epoch:12 | Val Acc: 0.9302
 Best site-Sketch           | Epoch:12 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:12 | Val Acc: 0.9079
 Best site-QuickDraw        | Epoch:12 | Val Acc: 0.6571
 Best site-QuickDraw        | Epoch:12 | Val Acc: 0.6889
 Best site-Infograph        | Epoch:12 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:12 | Val Acc: 0.6159
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 13 ============
 Site-Clipart         | Train Loss: 0.3886 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.3038 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.1677 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0927 | Train Acc: 0.9809
 Site-Painting        | Train Loss: 0.3172 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.2646 | Train Acc: 0.9280
 Site-Sketch          | Train Loss: 0.4319 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.3511 | Train Acc: 0.8835
 Site-QuickDraw       | Train Loss: 1.0095 | Train Acc: 0.6688
 Site-QuickDraw       | Train Loss: 0.9930 | Train Acc: 0.6886
 Site-Infograph       | Train Loss: 1.4051 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1729 | Train Acc: 0.6398
 Site-Clipart         | Val  Loss: 0.2560 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.3192 | Val  Acc: 0.9111
 Site-Real            | Val  Loss: 0.0718 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0902 | Val  Acc: 0.9841
 Site-Painting        | Val  Loss: 0.1943 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2634 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.2955 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3432 | Val  Acc: 0.8889
 Site-QuickDraw       | Val  Loss: 1.0489 | Val  Acc: 0.6762
 Site-QuickDraw       | Val  Loss: 1.0066 | Val  Acc: 0.6921
 Site-Infograph       | Val  Loss: 1.3548 | Val  Acc: 0.5333
 Site-Infograph       | Val  Loss: 1.2530 | Val  Acc: 0.5905
Average Valid Accuracy: 0.8325
============ Train epoch 14 ============
 Site-Clipart         | Train Loss: 0.3435 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2864 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.2092 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.0794 | Train Acc: 0.9831
 Site-Painting        | Train Loss: 0.2586 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.2301 | Train Acc: 0.9428
 Site-Sketch          | Train Loss: 0.4120 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.3020 | Train Acc: 0.9089
 Site-QuickDraw       | Train Loss: 0.9926 | Train Acc: 0.6688
 Site-QuickDraw       | Train Loss: 0.9721 | Train Acc: 0.6716
 Site-Infograph       | Train Loss: 1.3771 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.2362 | Train Acc: 0.6102
 Site-Clipart         | Val  Loss: 0.2301 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2825 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0727 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0855 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1745 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2713 | Val  Acc: 0.9206
 Site-Sketch          | Val  Loss: 0.2714 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.3152 | Val  Acc: 0.9079
 Site-QuickDraw       | Val  Loss: 1.0561 | Val  Acc: 0.6762
 Site-QuickDraw       | Val  Loss: 0.9651 | Val  Acc: 0.7143
 Site-Infograph       | Val  Loss: 1.3130 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.2488 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8455
 Best site-Clipart          | Epoch:14 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:14 | Val Acc: 0.9365
 Best site-Real             | Epoch:14 | Val Acc: 0.9905
 Best site-Real             | Epoch:14 | Val Acc: 0.9937
 Best site-Painting         | Epoch:14 | Val Acc: 0.9714
 Best site-Painting         | Epoch:14 | Val Acc: 0.9206
 Best site-Sketch           | Epoch:14 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:14 | Val Acc: 0.9079
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.6762
 Best site-QuickDraw        | Epoch:14 | Val Acc: 0.7143
 Best site-Infograph        | Epoch:14 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:14 | Val Acc: 0.6063
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 15 ============
 Site-Clipart         | Train Loss: 0.3390 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2847 | Train Acc: 0.9280
 Site-Real            | Train Loss: 0.1656 | Train Acc: 0.9427
 Site-Real            | Train Loss: 0.0668 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2853 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.2199 | Train Acc: 0.9407
 Site-Sketch          | Train Loss: 0.4019 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.3356 | Train Acc: 0.9068
 Site-QuickDraw       | Train Loss: 0.9630 | Train Acc: 0.6752
 Site-QuickDraw       | Train Loss: 0.9415 | Train Acc: 0.7203
 Site-Infograph       | Train Loss: 1.3514 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1715 | Train Acc: 0.6441
 Site-Clipart         | Val  Loss: 0.2877 | Val  Acc: 0.8952
 Site-Clipart         | Val  Loss: 0.2976 | Val  Acc: 0.9143
 Site-Real            | Val  Loss: 0.0779 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0698 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1557 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2779 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.2674 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3471 | Val  Acc: 0.8857
 Site-QuickDraw       | Val  Loss: 0.9515 | Val  Acc: 0.6667
 Site-QuickDraw       | Val  Loss: 0.9540 | Val  Acc: 0.7238
 Site-Infograph       | Val  Loss: 1.2957 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.2350 | Val  Acc: 0.6032
Average Valid Accuracy: 0.8378
============ Train epoch 16 ============
 Site-Clipart         | Train Loss: 0.3695 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2625 | Train Acc: 0.9301
 Site-Real            | Train Loss: 0.1418 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0664 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2840 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.2554 | Train Acc: 0.9280
 Site-Sketch          | Train Loss: 0.3924 | Train Acc: 0.8854
 Site-Sketch          | Train Loss: 0.3425 | Train Acc: 0.8962
 Site-QuickDraw       | Train Loss: 0.9658 | Train Acc: 0.6752
 Site-QuickDraw       | Train Loss: 0.9309 | Train Acc: 0.7076
 Site-Infograph       | Train Loss: 1.4079 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.1909 | Train Acc: 0.6377
 Site-Clipart         | Val  Loss: 0.2977 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3248 | Val  Acc: 0.9175
 Site-Real            | Val  Loss: 0.0878 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0747 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1787 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2381 | Val  Acc: 0.9365
 Site-Sketch          | Val  Loss: 0.2625 | Val  Acc: 0.9238
 Site-Sketch          | Val  Loss: 0.3404 | Val  Acc: 0.8984
 Site-QuickDraw       | Val  Loss: 1.0095 | Val  Acc: 0.7048
 Site-QuickDraw       | Val  Loss: 0.9432 | Val  Acc: 0.7270
 Site-Infograph       | Val  Loss: 1.3344 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.1870 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8481
 Best site-Clipart          | Epoch:16 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:16 | Val Acc: 0.9175
 Best site-Real             | Epoch:16 | Val Acc: 0.9905
 Best site-Real             | Epoch:16 | Val Acc: 0.9937
 Best site-Painting         | Epoch:16 | Val Acc: 0.9714
 Best site-Painting         | Epoch:16 | Val Acc: 0.9365
 Best site-Sketch           | Epoch:16 | Val Acc: 0.9238
 Best site-Sketch           | Epoch:16 | Val Acc: 0.8984
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.7048
 Best site-QuickDraw        | Epoch:16 | Val Acc: 0.7270
 Best site-Infograph        | Epoch:16 | Val Acc: 0.5524
 Best site-Infograph        | Epoch:16 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart         | Train Loss: 0.3354 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.2561 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1637 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.0704 | Train Acc: 0.9873
 Site-Painting        | Train Loss: 0.2901 | Train Acc: 0.9108
 Site-Painting        | Train Loss: 0.1914 | Train Acc: 0.9576
 Site-Sketch          | Train Loss: 0.3984 | Train Acc: 0.8726
 Site-Sketch          | Train Loss: 0.2850 | Train Acc: 0.9216
 Site-QuickDraw       | Train Loss: 0.9119 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.9277 | Train Acc: 0.7267
 Site-Infograph       | Train Loss: 1.3829 | Train Acc: 0.5669
 Site-Infograph       | Train Loss: 1.1782 | Train Acc: 0.6165
 Site-Clipart         | Val  Loss: 0.2718 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.3006 | Val  Acc: 0.9143
 Site-Real            | Val  Loss: 0.0790 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0728 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1709 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.2735 | Val  Acc: 0.9270
 Site-Sketch          | Val  Loss: 0.2541 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2851 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.9583 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.9003 | Val  Acc: 0.7175
 Site-Infograph       | Val  Loss: 1.2493 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.1933 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8526
 Best site-Clipart          | Epoch:17 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:17 | Val Acc: 0.9143
 Best site-Real             | Epoch:17 | Val Acc: 0.9905
 Best site-Real             | Epoch:17 | Val Acc: 0.9937
 Best site-Painting         | Epoch:17 | Val Acc: 0.9524
 Best site-Painting         | Epoch:17 | Val Acc: 0.9270
 Best site-Sketch           | Epoch:17 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:17 | Val Acc: 0.9365
 Best site-QuickDraw        | Epoch:17 | Val Acc: 0.7714
 Best site-QuickDraw        | Epoch:17 | Val Acc: 0.7175
 Best site-Infograph        | Epoch:17 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:17 | Val Acc: 0.6000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 18 ============
 Site-Clipart         | Train Loss: 0.3473 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2560 | Train Acc: 0.9258
 Site-Real            | Train Loss: 0.1563 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.0666 | Train Acc: 0.9894
 Site-Painting        | Train Loss: 0.2284 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.2185 | Train Acc: 0.9364
 Site-Sketch          | Train Loss: 0.3697 | Train Acc: 0.8662
 Site-Sketch          | Train Loss: 0.3444 | Train Acc: 0.9047
 Site-QuickDraw       | Train Loss: 0.8808 | Train Acc: 0.6943
 Site-QuickDraw       | Train Loss: 0.9089 | Train Acc: 0.7309
 Site-Infograph       | Train Loss: 1.3761 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.1310 | Train Acc: 0.6441
 Site-Clipart         | Val  Loss: 0.2210 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.3060 | Val  Acc: 0.9048
 Site-Real            | Val  Loss: 0.0706 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0750 | Val  Acc: 0.9841
 Site-Painting        | Val  Loss: 0.1704 | Val  Acc: 0.9429
 Site-Painting        | Val  Loss: 0.2004 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2452 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.3030 | Val  Acc: 0.9016
 Site-QuickDraw       | Val  Loss: 0.8796 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.9217 | Val  Acc: 0.7111
 Site-Infograph       | Val  Loss: 1.3022 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.1499 | Val  Acc: 0.6063
Average Valid Accuracy: 0.8479
============ Train epoch 19 ============
 Site-Clipart         | Train Loss: 0.3809 | Train Acc: 0.8726
 Site-Clipart         | Train Loss: 0.2561 | Train Acc: 0.9301
 Site-Real            | Train Loss: 0.1806 | Train Acc: 0.9363
 Site-Real            | Train Loss: 0.0665 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2940 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.2035 | Train Acc: 0.9576
 Site-Sketch          | Train Loss: 0.4242 | Train Acc: 0.8662
 Site-Sketch          | Train Loss: 0.3000 | Train Acc: 0.9153
 Site-QuickDraw       | Train Loss: 0.8920 | Train Acc: 0.6688
 Site-QuickDraw       | Train Loss: 0.8978 | Train Acc: 0.7479
 Site-Infograph       | Train Loss: 1.3682 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 1.1411 | Train Acc: 0.6377
 Site-Clipart         | Val  Loss: 0.2660 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2920 | Val  Acc: 0.9238
 Site-Real            | Val  Loss: 0.0573 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0614 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1529 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2294 | Val  Acc: 0.9270
 Site-Sketch          | Val  Loss: 0.1937 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2796 | Val  Acc: 0.9175
 Site-QuickDraw       | Val  Loss: 0.8891 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.8520 | Val  Acc: 0.7492
 Site-Infograph       | Val  Loss: 1.1525 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.1585 | Val  Acc: 0.6317
Average Valid Accuracy: 0.8643
 Best site-Clipart          | Epoch:19 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:19 | Val Acc: 0.9238
 Best site-Real             | Epoch:19 | Val Acc: 0.9905
 Best site-Real             | Epoch:19 | Val Acc: 0.9937
 Best site-Painting         | Epoch:19 | Val Acc: 0.9714
 Best site-Painting         | Epoch:19 | Val Acc: 0.9270
 Best site-Sketch           | Epoch:19 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:19 | Val Acc: 0.9175
 Best site-QuickDraw        | Epoch:19 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:19 | Val Acc: 0.7492
 Best site-Infograph        | Epoch:19 | Val Acc: 0.6190
 Best site-Infograph        | Epoch:19 | Val Acc: 0.6317
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
 Test site-Clipart         | Epoch:19 | Test Acc: 0.9221
 Test site-Real            | Epoch:19 | Test Acc: 0.9581
 Test site-Painting        | Epoch:19 | Test Acc: 0.9305
 Test site-Sketch          | Epoch:19 | Test Acc: 0.9134
 Test site-QuickDraw       | Epoch:19 | Test Acc: 0.6980
 Test site-Infograph       | Epoch:19 | Test Acc: 0.5479
Average Test Accuracy: 0.8283
============ Train epoch 20 ============
 Site-Clipart         | Train Loss: 0.3260 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2479 | Train Acc: 0.9322
 Site-Real            | Train Loss: 0.1490 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0643 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.3351 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.1974 | Train Acc: 0.9492
 Site-Sketch          | Train Loss: 0.2811 | Train Acc: 0.9363
 Site-Sketch          | Train Loss: 0.2658 | Train Acc: 0.9301
 Site-QuickDraw       | Train Loss: 0.8533 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.8615 | Train Acc: 0.7521
 Site-Infograph       | Train Loss: 1.4009 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.0617 | Train Acc: 0.6504
 Site-Clipart         | Val  Loss: 0.2512 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2991 | Val  Acc: 0.9206
 Site-Real            | Val  Loss: 0.0718 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.0513 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.1618 | Val  Acc: 0.9524
 Site-Painting        | Val  Loss: 0.1824 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.2390 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.3141 | Val  Acc: 0.9111
 Site-QuickDraw       | Val  Loss: 0.9590 | Val  Acc: 0.6952
 Site-QuickDraw       | Val  Loss: 0.8270 | Val  Acc: 0.7460
 Site-Infograph       | Val  Loss: 1.3053 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.1802 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8503
============ Train epoch 21 ============
 Site-Clipart         | Train Loss: 0.3645 | Train Acc: 0.8790
 Site-Clipart         | Train Loss: 0.2220 | Train Acc: 0.9386
 Site-Real            | Train Loss: 0.1484 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0570 | Train Acc: 0.9873
 Site-Painting        | Train Loss: 0.2115 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.2043 | Train Acc: 0.9428
 Site-Sketch          | Train Loss: 0.3260 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.2475 | Train Acc: 0.9280
 Site-QuickDraw       | Train Loss: 0.8579 | Train Acc: 0.6752
 Site-QuickDraw       | Train Loss: 0.8769 | Train Acc: 0.7246
 Site-Infograph       | Train Loss: 1.3263 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.1176 | Train Acc: 0.6377
 Site-Clipart         | Val  Loss: 0.2147 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2682 | Val  Acc: 0.9270
 Site-Real            | Val  Loss: 0.0583 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0641 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1398 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1985 | Val  Acc: 0.9492
 Site-Sketch          | Val  Loss: 0.2144 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2541 | Val  Acc: 0.9238
 Site-QuickDraw       | Val  Loss: 0.9457 | Val  Acc: 0.6476
 Site-QuickDraw       | Val  Loss: 0.8447 | Val  Acc: 0.7492
 Site-Infograph       | Val  Loss: 1.2369 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.1285 | Val  Acc: 0.6159
Average Valid Accuracy: 0.8513
============ Train epoch 22 ============
 Site-Clipart         | Train Loss: 0.3099 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.2397 | Train Acc: 0.9386
 Site-Real            | Train Loss: 0.1536 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0586 | Train Acc: 0.9894
 Site-Painting        | Train Loss: 0.2923 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1772 | Train Acc: 0.9555
 Site-Sketch          | Train Loss: 0.2936 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.2490 | Train Acc: 0.9322
 Site-QuickDraw       | Train Loss: 0.8622 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.8486 | Train Acc: 0.7415
 Site-Infograph       | Train Loss: 1.3506 | Train Acc: 0.5860
 Site-Infograph       | Train Loss: 1.1292 | Train Acc: 0.6229
 Site-Clipart         | Val  Loss: 0.2297 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2574 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0384 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0652 | Val  Acc: 0.9873
 Site-Painting        | Val  Loss: 0.1429 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1681 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2358 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2716 | Val  Acc: 0.9143
 Site-QuickDraw       | Val  Loss: 0.8627 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.8566 | Val  Acc: 0.7492
 Site-Infograph       | Val  Loss: 1.2496 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.1532 | Val  Acc: 0.6222
Average Valid Accuracy: 0.8627
============ Train epoch 23 ============
 Site-Clipart         | Train Loss: 0.3040 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2166 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1470 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0608 | Train Acc: 0.9894
 Site-Painting        | Train Loss: 0.2694 | Train Acc: 0.9172
 Site-Painting        | Train Loss: 0.1702 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.3562 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.2897 | Train Acc: 0.9131
 Site-QuickDraw       | Train Loss: 0.8482 | Train Acc: 0.6815
 Site-QuickDraw       | Train Loss: 0.8265 | Train Acc: 0.7479
 Site-Infograph       | Train Loss: 1.4280 | Train Acc: 0.5414
 Site-Infograph       | Train Loss: 1.1385 | Train Acc: 0.6208
 Site-Clipart         | Val  Loss: 0.2416 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2459 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0682 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1080 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1850 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2331 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2480 | Val  Acc: 0.9302
 Site-QuickDraw       | Val  Loss: 0.8725 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.8020 | Val  Acc: 0.7683
 Site-Infograph       | Val  Loss: 1.3079 | Val  Acc: 0.5429
 Site-Infograph       | Val  Loss: 1.1218 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8643
 Best site-Clipart          | Epoch:23 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:23 | Val Acc: 0.9365
 Best site-Real             | Epoch:23 | Val Acc: 1.0000
 Best site-Real             | Epoch:23 | Val Acc: 0.9905
 Best site-Painting         | Epoch:23 | Val Acc: 0.9905
 Best site-Painting         | Epoch:23 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:23 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:23 | Val Acc: 0.9302
 Best site-QuickDraw        | Epoch:23 | Val Acc: 0.7238
 Best site-QuickDraw        | Epoch:23 | Val Acc: 0.7683
 Best site-Infograph        | Epoch:23 | Val Acc: 0.5429
 Best site-Infograph        | Epoch:23 | Val Acc: 0.6413
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart         | Train Loss: 0.3046 | Train Acc: 0.9172
 Site-Clipart         | Train Loss: 0.2196 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1557 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.0644 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2245 | Train Acc: 0.9490
 Site-Painting        | Train Loss: 0.1683 | Train Acc: 0.9555
 Site-Sketch          | Train Loss: 0.3730 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.2593 | Train Acc: 0.9216
 Site-QuickDraw       | Train Loss: 0.7732 | Train Acc: 0.6879
 Site-QuickDraw       | Train Loss: 0.8306 | Train Acc: 0.7352
 Site-Infograph       | Train Loss: 1.3692 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 1.0696 | Train Acc: 0.6653
 Site-Clipart         | Val  Loss: 0.1904 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.2346 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0543 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.1281 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.2233 | Val  Acc: 0.9397
 Site-Sketch          | Val  Loss: 0.2116 | Val  Acc: 0.9714
 Site-Sketch          | Val  Loss: 0.2554 | Val  Acc: 0.9238
 Site-QuickDraw       | Val  Loss: 0.9537 | Val  Acc: 0.6952
 Site-QuickDraw       | Val  Loss: 0.8447 | Val  Acc: 0.7206
 Site-Infograph       | Val  Loss: 1.1988 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.0652 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8643
============ Train epoch 25 ============
 Site-Clipart         | Train Loss: 0.2721 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.2262 | Train Acc: 0.9407
 Site-Real            | Train Loss: 0.1290 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0418 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.2229 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.1898 | Train Acc: 0.9640
 Site-Sketch          | Train Loss: 0.3704 | Train Acc: 0.8726
 Site-Sketch          | Train Loss: 0.2521 | Train Acc: 0.9195
 Site-QuickDraw       | Train Loss: 0.8767 | Train Acc: 0.7134
 Site-QuickDraw       | Train Loss: 0.8045 | Train Acc: 0.7648
 Site-Infograph       | Train Loss: 1.2821 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.0636 | Train Acc: 0.6589
 Site-Clipart         | Val  Loss: 0.2494 | Val  Acc: 0.9333
 Site-Clipart         | Val  Loss: 0.2385 | Val  Acc: 0.9270
 Site-Real            | Val  Loss: 0.0554 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0577 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1435 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1624 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2092 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2470 | Val  Acc: 0.9397
 Site-QuickDraw       | Val  Loss: 0.8399 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.8347 | Val  Acc: 0.7460
 Site-Infograph       | Val  Loss: 1.1575 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.1299 | Val  Acc: 0.6190
Average Valid Accuracy: 0.8582
============ Train epoch 26 ============
 Site-Clipart         | Train Loss: 0.3240 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2204 | Train Acc: 0.9301
 Site-Real            | Train Loss: 0.1528 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0435 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2485 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.1990 | Train Acc: 0.9364
 Site-Sketch          | Train Loss: 0.3755 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.2596 | Train Acc: 0.9153
 Site-QuickDraw       | Train Loss: 0.8606 | Train Acc: 0.6943
 Site-QuickDraw       | Train Loss: 0.8271 | Train Acc: 0.7479
 Site-Infograph       | Train Loss: 1.3357 | Train Acc: 0.5669
 Site-Infograph       | Train Loss: 1.1155 | Train Acc: 0.6547
 Site-Clipart         | Val  Loss: 0.2198 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2667 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0584 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1394 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1618 | Val  Acc: 0.9587
 Site-Sketch          | Val  Loss: 0.2120 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2413 | Val  Acc: 0.9302
 Site-QuickDraw       | Val  Loss: 0.8948 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.8504 | Val  Acc: 0.7365
 Site-Infograph       | Val  Loss: 1.2287 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.0937 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8635
============ Train epoch 27 ============
 Site-Clipart         | Train Loss: 0.3342 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.2273 | Train Acc: 0.9428
 Site-Real            | Train Loss: 0.1355 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0497 | Train Acc: 0.9894
 Site-Painting        | Train Loss: 0.2203 | Train Acc: 0.9490
 Site-Painting        | Train Loss: 0.1782 | Train Acc: 0.9513
 Site-Sketch          | Train Loss: 0.3908 | Train Acc: 0.8599
 Site-Sketch          | Train Loss: 0.2652 | Train Acc: 0.9343
 Site-QuickDraw       | Train Loss: 0.9299 | Train Acc: 0.6815
 Site-QuickDraw       | Train Loss: 0.7823 | Train Acc: 0.7691
 Site-Infograph       | Train Loss: 1.4083 | Train Acc: 0.5223
 Site-Infograph       | Train Loss: 1.0473 | Train Acc: 0.6525
 Site-Clipart         | Val  Loss: 0.2006 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2553 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.0447 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0535 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1244 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1592 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1967 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2549 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.8436 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.7479 | Val  Acc: 0.7683
 Site-Infograph       | Val  Loss: 1.2077 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.1010 | Val  Acc: 0.6349
Average Valid Accuracy: 0.8677
 Best site-Clipart          | Epoch:27 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:27 | Val Acc: 0.9333
 Best site-Real             | Epoch:27 | Val Acc: 0.9905
 Best site-Real             | Epoch:27 | Val Acc: 0.9937
 Best site-Painting         | Epoch:27 | Val Acc: 0.9810
 Best site-Painting         | Epoch:27 | Val Acc: 0.9810
 Best site-Sketch           | Epoch:27 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:27 | Val Acc: 0.9206
 Best site-QuickDraw        | Epoch:27 | Val Acc: 0.7333
 Best site-QuickDraw        | Epoch:27 | Val Acc: 0.7683
 Best site-Infograph        | Epoch:27 | Val Acc: 0.5810
 Best site-Infograph        | Epoch:27 | Val Acc: 0.6349
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 28 ============
 Site-Clipart         | Train Loss: 0.2844 | Train Acc: 0.9172
 Site-Clipart         | Train Loss: 0.2197 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1386 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0477 | Train Acc: 0.9894
 Site-Painting        | Train Loss: 0.2378 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.1519 | Train Acc: 0.9640
 Site-Sketch          | Train Loss: 0.2986 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2567 | Train Acc: 0.9237
 Site-QuickDraw       | Train Loss: 0.7197 | Train Acc: 0.7516
 Site-QuickDraw       | Train Loss: 0.7410 | Train Acc: 0.7627
 Site-Infograph       | Train Loss: 1.3715 | Train Acc: 0.5860
 Site-Infograph       | Train Loss: 1.0091 | Train Acc: 0.6780
 Site-Clipart         | Val  Loss: 0.1866 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2330 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0484 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1254 | Val  Acc: 0.9619
 Site-Painting        | Val  Loss: 0.1934 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2594 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2808 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.7629 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 0.7749 | Val  Acc: 0.7714
 Site-Infograph       | Val  Loss: 1.1397 | Val  Acc: 0.5714
 Site-Infograph       | Val  Loss: 1.0693 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8683
 Best site-Clipart          | Epoch:28 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:28 | Val Acc: 0.9429
 Best site-Real             | Epoch:28 | Val Acc: 1.0000
 Best site-Real             | Epoch:28 | Val Acc: 0.9937
 Best site-Painting         | Epoch:28 | Val Acc: 0.9619
 Best site-Painting         | Epoch:28 | Val Acc: 0.9524
 Best site-Sketch           | Epoch:28 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:28 | Val Acc: 0.9206
 Best site-QuickDraw        | Epoch:28 | Val Acc: 0.7905
 Best site-QuickDraw        | Epoch:28 | Val Acc: 0.7714
 Best site-Infograph        | Epoch:28 | Val Acc: 0.5714
 Best site-Infograph        | Epoch:28 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 29 ============
 Site-Clipart         | Train Loss: 0.2612 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.1850 | Train Acc: 0.9576
 Site-Real            | Train Loss: 0.1260 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0508 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2321 | Train Acc: 0.9554
 Site-Painting        | Train Loss: 0.1382 | Train Acc: 0.9661
 Site-Sketch          | Train Loss: 0.3541 | Train Acc: 0.8981
 Site-Sketch          | Train Loss: 0.2492 | Train Acc: 0.9131
 Site-QuickDraw       | Train Loss: 0.8072 | Train Acc: 0.6815
 Site-QuickDraw       | Train Loss: 0.7500 | Train Acc: 0.7564
 Site-Infograph       | Train Loss: 1.3170 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.0379 | Train Acc: 0.6547
 Site-Clipart         | Val  Loss: 0.1652 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2399 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.0372 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0548 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1002 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.2167 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2103 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2396 | Val  Acc: 0.9270
 Site-QuickDraw       | Val  Loss: 0.7676 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.7451 | Val  Acc: 0.7683
 Site-Infograph       | Val  Loss: 1.1772 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 1.0708 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8746
 Best site-Clipart          | Epoch:29 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:29 | Val Acc: 0.9333
 Best site-Real             | Epoch:29 | Val Acc: 1.0000
 Best site-Real             | Epoch:29 | Val Acc: 0.9905
 Best site-Painting         | Epoch:29 | Val Acc: 1.0000
 Best site-Painting         | Epoch:29 | Val Acc: 0.9524
 Best site-Sketch           | Epoch:29 | Val Acc: 0.9524
 Best site-Sketch           | Epoch:29 | Val Acc: 0.9270
 Best site-QuickDraw        | Epoch:29 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:29 | Val Acc: 0.7683
 Best site-Infograph        | Epoch:29 | Val Acc: 0.6286
 Best site-Infograph        | Epoch:29 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
 Test site-Clipart         | Epoch:29 | Test Acc: 0.9240
 Test site-Real            | Epoch:29 | Test Acc: 0.9532
 Test site-Painting        | Epoch:29 | Test Acc: 0.9354
 Test site-Sketch          | Epoch:29 | Test Acc: 0.9043
 Test site-QuickDraw       | Epoch:29 | Test Acc: 0.7260
 Test site-Infograph       | Epoch:29 | Test Acc: 0.5540
Average Test Accuracy: 0.8328
============ Train epoch 30 ============
 Site-Clipart         | Train Loss: 0.2736 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2049 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1480 | Train Acc: 0.9554
 Site-Real            | Train Loss: 0.0593 | Train Acc: 0.9831
 Site-Painting        | Train Loss: 0.2178 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1532 | Train Acc: 0.9682
 Site-Sketch          | Train Loss: 0.3068 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2019 | Train Acc: 0.9449
 Site-QuickDraw       | Train Loss: 0.8152 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.7830 | Train Acc: 0.7712
 Site-Infograph       | Train Loss: 1.3816 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.0268 | Train Acc: 0.6737
 Site-Clipart         | Val  Loss: 0.2185 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2206 | Val  Acc: 0.9238
 Site-Real            | Val  Loss: 0.0601 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.0518 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1152 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1529 | Val  Acc: 0.9683
 Site-Sketch          | Val  Loss: 0.1890 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2403 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.8140 | Val  Acc: 0.7238
 Site-QuickDraw       | Val  Loss: 0.7825 | Val  Acc: 0.7778
 Site-Infograph       | Val  Loss: 1.1158 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 1.0538 | Val  Acc: 0.6540
Average Valid Accuracy: 0.8714
============ Train epoch 31 ============
 Site-Clipart         | Train Loss: 0.2877 | Train Acc: 0.8917
 Site-Clipart         | Train Loss: 0.1950 | Train Acc: 0.9428
 Site-Real            | Train Loss: 0.1001 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0386 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2025 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1730 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.2739 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.2218 | Train Acc: 0.9343
 Site-QuickDraw       | Train Loss: 0.7573 | Train Acc: 0.7389
 Site-QuickDraw       | Train Loss: 0.7706 | Train Acc: 0.7627
 Site-Infograph       | Train Loss: 1.3365 | Train Acc: 0.5159
 Site-Infograph       | Train Loss: 1.0989 | Train Acc: 0.6716
 Site-Clipart         | Val  Loss: 0.2400 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.2316 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0404 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0490 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1346 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1705 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2000 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2527 | Val  Acc: 0.9143
 Site-QuickDraw       | Val  Loss: 0.7929 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.7059 | Val  Acc: 0.7937
 Site-Infograph       | Val  Loss: 1.1177 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.0708 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8762
 Best site-Clipart          | Epoch:31 | Val Acc: 0.9619
 Best site-Clipart          | Epoch:31 | Val Acc: 0.9460
 Best site-Real             | Epoch:31 | Val Acc: 1.0000
 Best site-Real             | Epoch:31 | Val Acc: 0.9937
 Best site-Painting         | Epoch:31 | Val Acc: 0.9714
 Best site-Painting         | Epoch:31 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:31 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:31 | Val Acc: 0.9143
 Best site-QuickDraw        | Epoch:31 | Val Acc: 0.7714
 Best site-QuickDraw        | Epoch:31 | Val Acc: 0.7937
 Best site-Infograph        | Epoch:31 | Val Acc: 0.5810
 Best site-Infograph        | Epoch:31 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 32 ============
 Site-Clipart         | Train Loss: 0.2423 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.2055 | Train Acc: 0.9513
 Site-Real            | Train Loss: 0.1253 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0512 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2633 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.1652 | Train Acc: 0.9597
 Site-Sketch          | Train Loss: 0.3267 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.2125 | Train Acc: 0.9407
 Site-QuickDraw       | Train Loss: 0.7687 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.7326 | Train Acc: 0.7839
 Site-Infograph       | Train Loss: 1.3509 | Train Acc: 0.5987
 Site-Infograph       | Train Loss: 1.0420 | Train Acc: 0.6483
 Site-Clipart         | Val  Loss: 0.1827 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.2247 | Val  Acc: 0.9333
 Site-Real            | Val  Loss: 0.0359 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0524 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1331 | Val  Acc: 0.9714
 Site-Painting        | Val  Loss: 0.1694 | Val  Acc: 0.9556
 Site-Sketch          | Val  Loss: 0.1552 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2399 | Val  Acc: 0.9175
 Site-QuickDraw       | Val  Loss: 0.7618 | Val  Acc: 0.7524
 Site-QuickDraw       | Val  Loss: 0.7685 | Val  Acc: 0.7714
 Site-Infograph       | Val  Loss: 1.1980 | Val  Acc: 0.6000
 Site-Infograph       | Val  Loss: 0.9886 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8749
============ Train epoch 33 ============
 Site-Clipart         | Train Loss: 0.2843 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.2007 | Train Acc: 0.9534
 Site-Real            | Train Loss: 0.1347 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0396 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2741 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1446 | Train Acc: 0.9725
 Site-Sketch          | Train Loss: 0.2753 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.1902 | Train Acc: 0.9428
 Site-QuickDraw       | Train Loss: 0.7136 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.7213 | Train Acc: 0.7797
 Site-Infograph       | Train Loss: 1.3138 | Train Acc: 0.5669
 Site-Infograph       | Train Loss: 1.0094 | Train Acc: 0.6568
 Site-Clipart         | Val  Loss: 0.1664 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2238 | Val  Acc: 0.9397
 Site-Real            | Val  Loss: 0.0477 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.0881 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1428 | Val  Acc: 0.9683
 Site-Sketch          | Val  Loss: 0.1883 | Val  Acc: 0.9333
 Site-Sketch          | Val  Loss: 0.2020 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.7396 | Val  Acc: 0.8000
 Site-QuickDraw       | Val  Loss: 0.7011 | Val  Acc: 0.8032
 Site-Infograph       | Val  Loss: 1.1698 | Val  Acc: 0.5524
 Site-Infograph       | Val  Loss: 1.0146 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8775
 Best site-Clipart          | Epoch:33 | Val Acc: 0.9524
 Best site-Clipart          | Epoch:33 | Val Acc: 0.9397
 Best site-Real             | Epoch:33 | Val Acc: 0.9810
 Best site-Real             | Epoch:33 | Val Acc: 1.0000
 Best site-Painting         | Epoch:33 | Val Acc: 0.9905
 Best site-Painting         | Epoch:33 | Val Acc: 0.9683
 Best site-Sketch           | Epoch:33 | Val Acc: 0.9333
 Best site-Sketch           | Epoch:33 | Val Acc: 0.9365
 Best site-QuickDraw        | Epoch:33 | Val Acc: 0.8000
 Best site-QuickDraw        | Epoch:33 | Val Acc: 0.8032
 Best site-Infograph        | Epoch:33 | Val Acc: 0.5524
 Best site-Infograph        | Epoch:33 | Val Acc: 0.6730
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 34 ============
 Site-Clipart         | Train Loss: 0.2669 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.1859 | Train Acc: 0.9534
 Site-Real            | Train Loss: 0.1515 | Train Acc: 0.9490
 Site-Real            | Train Loss: 0.0671 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.2315 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1225 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.3092 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.2163 | Train Acc: 0.9428
 Site-QuickDraw       | Train Loss: 0.8095 | Train Acc: 0.6752
 Site-QuickDraw       | Train Loss: 0.7317 | Train Acc: 0.7627
 Site-Infograph       | Train Loss: 1.3549 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 1.0201 | Train Acc: 0.6822
 Site-Clipart         | Val  Loss: 0.2212 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2158 | Val  Acc: 0.9397
 Site-Real            | Val  Loss: 0.0387 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0474 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.0956 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.1727 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2455 | Val  Acc: 0.9143
 Site-Sketch          | Val  Loss: 0.2157 | Val  Acc: 0.9524
 Site-QuickDraw       | Val  Loss: 0.8172 | Val  Acc: 0.7524
 Site-QuickDraw       | Val  Loss: 0.7184 | Val  Acc: 0.7841
 Site-Infograph       | Val  Loss: 1.1251 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 1.0331 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8778
 Best site-Clipart          | Epoch:34 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:34 | Val Acc: 0.9397
 Best site-Real             | Epoch:34 | Val Acc: 1.0000
 Best site-Real             | Epoch:34 | Val Acc: 0.9905
 Best site-Painting         | Epoch:34 | Val Acc: 1.0000
 Best site-Painting         | Epoch:34 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:34 | Val Acc: 0.9143
 Best site-Sketch           | Epoch:34 | Val Acc: 0.9524
 Best site-QuickDraw        | Epoch:34 | Val Acc: 0.7524
 Best site-QuickDraw        | Epoch:34 | Val Acc: 0.7841
 Best site-Infograph        | Epoch:34 | Val Acc: 0.6476
 Best site-Infograph        | Epoch:34 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 35 ============
 Site-Clipart         | Train Loss: 0.2909 | Train Acc: 0.9299
 Site-Clipart         | Train Loss: 0.1714 | Train Acc: 0.9513
 Site-Real            | Train Loss: 0.1586 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0465 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2054 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1548 | Train Acc: 0.9619
 Site-Sketch          | Train Loss: 0.3820 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.2179 | Train Acc: 0.9492
 Site-QuickDraw       | Train Loss: 0.7493 | Train Acc: 0.7452
 Site-QuickDraw       | Train Loss: 0.7055 | Train Acc: 0.7818
 Site-Infograph       | Train Loss: 1.3470 | Train Acc: 0.5541
 Site-Infograph       | Train Loss: 1.0069 | Train Acc: 0.6716
 Site-Clipart         | Val  Loss: 0.2214 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.2371 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.0521 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0435 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.0892 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1277 | Val  Acc: 0.9746
 Site-Sketch          | Val  Loss: 0.1890 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2478 | Val  Acc: 0.9238
 Site-QuickDraw       | Val  Loss: 0.7699 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.7448 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.0983 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 1.0131 | Val  Acc: 0.6698
Average Valid Accuracy: 0.8772
============ Train epoch 36 ============
 Site-Clipart         | Train Loss: 0.4018 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.1924 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1343 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0443 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.2390 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1452 | Train Acc: 0.9767
 Site-Sketch          | Train Loss: 0.3435 | Train Acc: 0.8854
 Site-Sketch          | Train Loss: 0.2389 | Train Acc: 0.9343
 Site-QuickDraw       | Train Loss: 0.8017 | Train Acc: 0.7070
 Site-QuickDraw       | Train Loss: 0.7662 | Train Acc: 0.7415
 Site-Infograph       | Train Loss: 1.2788 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 0.9805 | Train Acc: 0.6758
 Site-Clipart         | Val  Loss: 0.1706 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.2346 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.0409 | Val  Acc: 0.9810
 Site-Real            | Val  Loss: 0.0607 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.1422 | Val  Acc: 0.9714
 Site-Sketch          | Val  Loss: 0.1808 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2510 | Val  Acc: 0.9397
 Site-QuickDraw       | Val  Loss: 0.7620 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.7822 | Val  Acc: 0.7587
 Site-Infograph       | Val  Loss: 1.0683 | Val  Acc: 0.6571
 Site-Infograph       | Val  Loss: 1.0136 | Val  Acc: 0.6762
Average Valid Accuracy: 0.8812
 Best site-Clipart          | Epoch:36 | Val Acc: 0.9714
 Best site-Clipart          | Epoch:36 | Val Acc: 0.9429
 Best site-Real             | Epoch:36 | Val Acc: 0.9810
 Best site-Real             | Epoch:36 | Val Acc: 0.9905
 Best site-Painting         | Epoch:36 | Val Acc: 1.0000
 Best site-Painting         | Epoch:36 | Val Acc: 0.9714
 Best site-Sketch           | Epoch:36 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:36 | Val Acc: 0.9397
 Best site-QuickDraw        | Epoch:36 | Val Acc: 0.7429
 Best site-QuickDraw        | Epoch:36 | Val Acc: 0.7587
 Best site-Infograph        | Epoch:36 | Val Acc: 0.6571
 Best site-Infograph        | Epoch:36 | Val Acc: 0.6762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 37 ============
 Site-Clipart         | Train Loss: 0.3358 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.1730 | Train Acc: 0.9576
 Site-Real            | Train Loss: 0.1286 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0355 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2194 | Train Acc: 0.9427
 Site-Painting        | Train Loss: 0.1221 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.3545 | Train Acc: 0.8662
 Site-Sketch          | Train Loss: 0.2267 | Train Acc: 0.9322
 Site-QuickDraw       | Train Loss: 0.7329 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.7261 | Train Acc: 0.7648
 Site-Infograph       | Train Loss: 1.2463 | Train Acc: 0.5924
 Site-Infograph       | Train Loss: 0.9694 | Train Acc: 0.7034
 Site-Clipart         | Val  Loss: 0.2004 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2088 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0247 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0359 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1226 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1175 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1864 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2178 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.8027 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.7369 | Val  Acc: 0.7746
 Site-Infograph       | Val  Loss: 1.1488 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.0333 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8810
============ Train epoch 38 ============
 Site-Clipart         | Train Loss: 0.3171 | Train Acc: 0.8981
 Site-Clipart         | Train Loss: 0.1945 | Train Acc: 0.9576
 Site-Real            | Train Loss: 0.1238 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0535 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.2232 | Train Acc: 0.9490
 Site-Painting        | Train Loss: 0.1069 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.3342 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.2394 | Train Acc: 0.9153
 Site-QuickDraw       | Train Loss: 0.7357 | Train Acc: 0.7389
 Site-QuickDraw       | Train Loss: 0.7334 | Train Acc: 0.7648
 Site-Infograph       | Train Loss: 1.2749 | Train Acc: 0.5987
 Site-Infograph       | Train Loss: 0.9639 | Train Acc: 0.7182
 Site-Clipart         | Val  Loss: 0.2120 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2222 | Val  Acc: 0.9365
 Site-Real            | Val  Loss: 0.0221 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0476 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.0871 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1352 | Val  Acc: 0.9714
 Site-Sketch          | Val  Loss: 0.1907 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2056 | Val  Acc: 0.9460
 Site-QuickDraw       | Val  Loss: 0.8372 | Val  Acc: 0.7333
 Site-QuickDraw       | Val  Loss: 0.7063 | Val  Acc: 0.8095
 Site-Infograph       | Val  Loss: 1.0526 | Val  Acc: 0.6190
 Site-Infograph       | Val  Loss: 1.0319 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8796
============ Train epoch 39 ============
 Site-Clipart         | Train Loss: 0.2467 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.1858 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1174 | Train Acc: 0.9809
 Site-Real            | Train Loss: 0.0416 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2394 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1155 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.4095 | Train Acc: 0.8662
 Site-Sketch          | Train Loss: 0.2314 | Train Acc: 0.9386
 Site-QuickDraw       | Train Loss: 0.7503 | Train Acc: 0.7006
 Site-QuickDraw       | Train Loss: 0.7047 | Train Acc: 0.7797
 Site-Infograph       | Train Loss: 1.2052 | Train Acc: 0.6115
 Site-Infograph       | Train Loss: 0.9903 | Train Acc: 0.6843
 Site-Clipart         | Val  Loss: 0.2258 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2285 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0380 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.1010 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1478 | Val  Acc: 0.9651
 Site-Sketch          | Val  Loss: 0.1930 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2244 | Val  Acc: 0.9302
 Site-QuickDraw       | Val  Loss: 0.7926 | Val  Acc: 0.7810
 Site-QuickDraw       | Val  Loss: 0.6714 | Val  Acc: 0.8095
 Site-Infograph       | Val  Loss: 1.0519 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 1.0080 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8817
 Best site-Clipart          | Epoch:39 | Val Acc: 0.9429
 Best site-Clipart          | Epoch:39 | Val Acc: 0.9460
 Best site-Real             | Epoch:39 | Val Acc: 1.0000
 Best site-Real             | Epoch:39 | Val Acc: 0.9937
 Best site-Painting         | Epoch:39 | Val Acc: 0.9810
 Best site-Painting         | Epoch:39 | Val Acc: 0.9651
 Best site-Sketch           | Epoch:39 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:39 | Val Acc: 0.9302
 Best site-QuickDraw        | Epoch:39 | Val Acc: 0.7810
 Best site-QuickDraw        | Epoch:39 | Val Acc: 0.8095
 Best site-Infograph        | Epoch:39 | Val Acc: 0.6095
 Best site-Infograph        | Epoch:39 | Val Acc: 0.6794
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
 Test site-Clipart         | Epoch:39 | Test Acc: 0.9221
 Test site-Real            | Epoch:39 | Test Acc: 0.9532
 Test site-Painting        | Epoch:39 | Test Acc: 0.9354
 Test site-Sketch          | Epoch:39 | Test Acc: 0.9007
 Test site-QuickDraw       | Epoch:39 | Test Acc: 0.7250
 Test site-Infograph       | Epoch:39 | Test Acc: 0.5556
Average Test Accuracy: 0.8320
============ Train epoch 40 ============
 Site-Clipart         | Train Loss: 0.3015 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.1699 | Train Acc: 0.9576
 Site-Real            | Train Loss: 0.1326 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0370 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.2435 | Train Acc: 0.9236
 Site-Painting        | Train Loss: 0.1120 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.2950 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.1956 | Train Acc: 0.9492
 Site-QuickDraw       | Train Loss: 0.7005 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.7194 | Train Acc: 0.7775
 Site-Infograph       | Train Loss: 1.2459 | Train Acc: 0.5796
 Site-Infograph       | Train Loss: 1.0024 | Train Acc: 0.7034
 Site-Clipart         | Val  Loss: 0.1656 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.2109 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0306 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0461 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.1026 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1358 | Val  Acc: 0.9778
 Site-Sketch          | Val  Loss: 0.1599 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.2207 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.8251 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.7080 | Val  Acc: 0.7968
 Site-Infograph       | Val  Loss: 1.0232 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 0.9665 | Val  Acc: 0.7079
Average Valid Accuracy: 0.8881
 Best site-Clipart          | Epoch:40 | Val Acc: 0.9619
 Best site-Clipart          | Epoch:40 | Val Acc: 0.9460
 Best site-Real             | Epoch:40 | Val Acc: 1.0000
 Best site-Real             | Epoch:40 | Val Acc: 0.9968
 Best site-Painting         | Epoch:40 | Val Acc: 0.9810
 Best site-Painting         | Epoch:40 | Val Acc: 0.9778
 Best site-Sketch           | Epoch:40 | Val Acc: 0.9429
 Best site-Sketch           | Epoch:40 | Val Acc: 0.9365
 Best site-QuickDraw        | Epoch:40 | Val Acc: 0.7619
 Best site-QuickDraw        | Epoch:40 | Val Acc: 0.7968
 Best site-Infograph        | Epoch:40 | Val Acc: 0.6476
 Best site-Infograph        | Epoch:40 | Val Acc: 0.7079
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 41 ============
 Site-Clipart         | Train Loss: 0.2781 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.1898 | Train Acc: 0.9513
 Site-Real            | Train Loss: 0.1351 | Train Acc: 0.9809
 Site-Real            | Train Loss: 0.0448 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2410 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1358 | Train Acc: 0.9767
 Site-Sketch          | Train Loss: 0.3309 | Train Acc: 0.8790
 Site-Sketch          | Train Loss: 0.2195 | Train Acc: 0.9449
 Site-QuickDraw       | Train Loss: 0.6730 | Train Acc: 0.7452
 Site-QuickDraw       | Train Loss: 0.6739 | Train Acc: 0.7797
 Site-Infograph       | Train Loss: 1.2964 | Train Acc: 0.6115
 Site-Infograph       | Train Loss: 0.9462 | Train Acc: 0.7076
 Site-Clipart         | Val  Loss: 0.1968 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.2015 | Val  Acc: 0.9492
 Site-Real            | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0435 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.0623 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.1185 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1084 | Val  Acc: 0.9714
 Site-Sketch          | Val  Loss: 0.2399 | Val  Acc: 0.9206
 Site-QuickDraw       | Val  Loss: 0.7405 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.7212 | Val  Acc: 0.7778
 Site-Infograph       | Val  Loss: 1.1832 | Val  Acc: 0.5810
 Site-Infograph       | Val  Loss: 1.0033 | Val  Acc: 0.6794
Average Valid Accuracy: 0.8807
============ Train epoch 42 ============
 Site-Clipart         | Train Loss: 0.2689 | Train Acc: 0.9108
 Site-Clipart         | Train Loss: 0.1841 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1213 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0465 | Train Acc: 0.9915
 Site-Painting        | Train Loss: 0.1541 | Train Acc: 0.9682
 Site-Painting        | Train Loss: 0.1177 | Train Acc: 0.9682
 Site-Sketch          | Train Loss: 0.2819 | Train Acc: 0.9045
 Site-Sketch          | Train Loss: 0.1982 | Train Acc: 0.9322
 Site-QuickDraw       | Train Loss: 0.8468 | Train Acc: 0.6943
 Site-QuickDraw       | Train Loss: 0.6879 | Train Acc: 0.7818
 Site-Infograph       | Train Loss: 1.2890 | Train Acc: 0.5796
 Site-Infograph       | Train Loss: 0.9592 | Train Acc: 0.7034
 Site-Clipart         | Val  Loss: 0.2075 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.2015 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.0657 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1200 | Val  Acc: 0.9778
 Site-Sketch          | Val  Loss: 0.1753 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.2096 | Val  Acc: 0.9238
 Site-QuickDraw       | Val  Loss: 0.7405 | Val  Acc: 0.7905
 Site-QuickDraw       | Val  Loss: 0.7250 | Val  Acc: 0.7587
 Site-Infograph       | Val  Loss: 1.0768 | Val  Acc: 0.6381
 Site-Infograph       | Val  Loss: 0.9382 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8886
 Best site-Clipart          | Epoch:42 | Val Acc: 0.9619
 Best site-Clipart          | Epoch:42 | Val Acc: 0.9460
 Best site-Real             | Epoch:42 | Val Acc: 1.0000
 Best site-Real             | Epoch:42 | Val Acc: 1.0000
 Best site-Painting         | Epoch:42 | Val Acc: 0.9905
 Best site-Painting         | Epoch:42 | Val Acc: 0.9778
 Best site-Sketch           | Epoch:42 | Val Acc: 0.9619
 Best site-Sketch           | Epoch:42 | Val Acc: 0.9238
 Best site-QuickDraw        | Epoch:42 | Val Acc: 0.7905
 Best site-QuickDraw        | Epoch:42 | Val Acc: 0.7587
 Best site-Infograph        | Epoch:42 | Val Acc: 0.6381
 Best site-Infograph        | Epoch:42 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 43 ============
 Site-Clipart         | Train Loss: 0.2703 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.1757 | Train Acc: 0.9492
 Site-Real            | Train Loss: 0.1095 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0305 | Train Acc: 0.9979
 Site-Painting        | Train Loss: 0.2316 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.1100 | Train Acc: 0.9788
 Site-Sketch          | Train Loss: 0.3590 | Train Acc: 0.8726
 Site-Sketch          | Train Loss: 0.2179 | Train Acc: 0.9322
 Site-QuickDraw       | Train Loss: 0.7771 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.7147 | Train Acc: 0.7669
 Site-Infograph       | Train Loss: 1.2829 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 0.9828 | Train Acc: 0.7119
 Site-Clipart         | Val  Loss: 0.2140 | Val  Acc: 0.9524
 Site-Clipart         | Val  Loss: 0.1973 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0403 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-Painting        | Val  Loss: 0.1324 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1386 | Val  Acc: 0.9746
 Site-Sketch          | Val  Loss: 0.1746 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.1895 | Val  Acc: 0.9556
 Site-QuickDraw       | Val  Loss: 0.7757 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.7263 | Val  Acc: 0.7683
 Site-Infograph       | Val  Loss: 1.1500 | Val  Acc: 0.6000
 Site-Infograph       | Val  Loss: 0.9615 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8820
============ Train epoch 44 ============
 Site-Clipart         | Train Loss: 0.2151 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.2083 | Train Acc: 0.9534
 Site-Real            | Train Loss: 0.1135 | Train Acc: 0.9682
 Site-Real            | Train Loss: 0.0365 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2311 | Train Acc: 0.9363
 Site-Painting        | Train Loss: 0.1092 | Train Acc: 0.9809
 Site-Sketch          | Train Loss: 0.3036 | Train Acc: 0.8854
 Site-Sketch          | Train Loss: 0.2019 | Train Acc: 0.9428
 Site-QuickDraw       | Train Loss: 0.7936 | Train Acc: 0.7261
 Site-QuickDraw       | Train Loss: 0.6973 | Train Acc: 0.7860
 Site-Infograph       | Train Loss: 1.2907 | Train Acc: 0.5860
 Site-Infograph       | Train Loss: 0.9264 | Train Acc: 0.7055
 Site-Clipart         | Val  Loss: 0.1665 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.1933 | Val  Acc: 0.9524
 Site-Real            | Val  Loss: 0.0657 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0325 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.0895 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1245 | Val  Acc: 0.9651
 Site-Sketch          | Val  Loss: 0.1794 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.2213 | Val  Acc: 0.9460
 Site-QuickDraw       | Val  Loss: 0.7220 | Val  Acc: 0.7429
 Site-QuickDraw       | Val  Loss: 0.6570 | Val  Acc: 0.8095
 Site-Infograph       | Val  Loss: 1.0000 | Val  Acc: 0.6095
 Site-Infograph       | Val  Loss: 0.9701 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8833
============ Train epoch 45 ============
 Site-Clipart         | Train Loss: 0.2888 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.1682 | Train Acc: 0.9576
 Site-Real            | Train Loss: 0.0922 | Train Acc: 0.9809
 Site-Real            | Train Loss: 0.0414 | Train Acc: 0.9873
 Site-Painting        | Train Loss: 0.2286 | Train Acc: 0.9490
 Site-Painting        | Train Loss: 0.1316 | Train Acc: 0.9661
 Site-Sketch          | Train Loss: 0.2810 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.1678 | Train Acc: 0.9534
 Site-QuickDraw       | Train Loss: 0.7188 | Train Acc: 0.7325
 Site-QuickDraw       | Train Loss: 0.7065 | Train Acc: 0.7881
 Site-Infograph       | Train Loss: 1.3331 | Train Acc: 0.5605
 Site-Infograph       | Train Loss: 0.8986 | Train Acc: 0.7225
 Site-Clipart         | Val  Loss: 0.1545 | Val  Acc: 0.9619
 Site-Clipart         | Val  Loss: 0.1999 | Val  Acc: 0.9429
 Site-Real            | Val  Loss: 0.0340 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0404 | Val  Acc: 0.9937
 Site-Painting        | Val  Loss: 0.0667 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1258 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1329 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1767 | Val  Acc: 0.9524
 Site-QuickDraw       | Val  Loss: 0.6807 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.6809 | Val  Acc: 0.8032
 Site-Infograph       | Val  Loss: 1.0539 | Val  Acc: 0.6476
 Site-Infograph       | Val  Loss: 0.9728 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8960
 Best site-Clipart          | Epoch:45 | Val Acc: 0.9619
 Best site-Clipart          | Epoch:45 | Val Acc: 0.9429
 Best site-Real             | Epoch:45 | Val Acc: 0.9905
 Best site-Real             | Epoch:45 | Val Acc: 0.9937
 Best site-Painting         | Epoch:45 | Val Acc: 0.9905
 Best site-Painting         | Epoch:45 | Val Acc: 0.9810
 Best site-Sketch           | Epoch:45 | Val Acc: 0.9810
 Best site-Sketch           | Epoch:45 | Val Acc: 0.9524
 Best site-QuickDraw        | Epoch:45 | Val Acc: 0.8095
 Best site-QuickDraw        | Epoch:45 | Val Acc: 0.8032
 Best site-Infograph        | Epoch:45 | Val Acc: 0.6476
 Best site-Infograph        | Epoch:45 | Val Acc: 0.6984
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1/harmo-fl...
============ Train epoch 46 ============
 Site-Clipart         | Train Loss: 0.2320 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.2072 | Train Acc: 0.9449
 Site-Real            | Train Loss: 0.1102 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0298 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.1904 | Train Acc: 0.9618
 Site-Painting        | Train Loss: 0.1274 | Train Acc: 0.9703
 Site-Sketch          | Train Loss: 0.2569 | Train Acc: 0.9108
 Site-Sketch          | Train Loss: 0.2121 | Train Acc: 0.9364
 Site-QuickDraw       | Train Loss: 0.7960 | Train Acc: 0.6879
 Site-QuickDraw       | Train Loss: 0.7371 | Train Acc: 0.7627
 Site-Infograph       | Train Loss: 1.4854 | Train Acc: 0.5732
 Site-Infograph       | Train Loss: 0.9779 | Train Acc: 0.6886
 Site-Clipart         | Val  Loss: 0.1608 | Val  Acc: 0.9714
 Site-Clipart         | Val  Loss: 0.1926 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0188 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0290 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.0748 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1090 | Val  Acc: 0.9873
 Site-Sketch          | Val  Loss: 0.1583 | Val  Acc: 0.9619
 Site-Sketch          | Val  Loss: 0.1973 | Val  Acc: 0.9365
 Site-QuickDraw       | Val  Loss: 0.6969 | Val  Acc: 0.7619
 Site-QuickDraw       | Val  Loss: 0.6704 | Val  Acc: 0.7810
 Site-Infograph       | Val  Loss: 1.0181 | Val  Acc: 0.6667
 Site-Infograph       | Val  Loss: 0.9879 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8902
============ Train epoch 47 ============
 Site-Clipart         | Train Loss: 0.2795 | Train Acc: 0.9236
 Site-Clipart         | Train Loss: 0.1745 | Train Acc: 0.9597
 Site-Real            | Train Loss: 0.1050 | Train Acc: 0.9745
 Site-Real            | Train Loss: 0.0340 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2274 | Train Acc: 0.9554
 Site-Painting        | Train Loss: 0.1082 | Train Acc: 0.9746
 Site-Sketch          | Train Loss: 0.3022 | Train Acc: 0.9236
 Site-Sketch          | Train Loss: 0.1869 | Train Acc: 0.9407
 Site-QuickDraw       | Train Loss: 0.7878 | Train Acc: 0.7134
 Site-QuickDraw       | Train Loss: 0.6488 | Train Acc: 0.7903
 Site-Infograph       | Train Loss: 1.2474 | Train Acc: 0.6051
 Site-Infograph       | Train Loss: 0.9620 | Train Acc: 0.6907
 Site-Clipart         | Val  Loss: 0.1915 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.2136 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0303 | Val  Acc: 0.9905
 Site-Real            | Val  Loss: 0.0441 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.0808 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1205 | Val  Acc: 0.9873
 Site-Sketch          | Val  Loss: 0.1844 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.1964 | Val  Acc: 0.9429
 Site-QuickDraw       | Val  Loss: 0.7212 | Val  Acc: 0.7714
 Site-QuickDraw       | Val  Loss: 0.6327 | Val  Acc: 0.8032
 Site-Infograph       | Val  Loss: 1.0126 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 0.9946 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8849
============ Train epoch 48 ============
 Site-Clipart         | Train Loss: 0.2517 | Train Acc: 0.9172
 Site-Clipart         | Train Loss: 0.1692 | Train Acc: 0.9534
 Site-Real            | Train Loss: 0.1362 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0343 | Train Acc: 0.9958
 Site-Painting        | Train Loss: 0.1566 | Train Acc: 0.9618
 Site-Painting        | Train Loss: 0.1161 | Train Acc: 0.9746
 Site-Sketch          | Train Loss: 0.2654 | Train Acc: 0.8854
 Site-Sketch          | Train Loss: 0.2008 | Train Acc: 0.9470
 Site-QuickDraw       | Train Loss: 0.7591 | Train Acc: 0.6943
 Site-QuickDraw       | Train Loss: 0.6396 | Train Acc: 0.7966
 Site-Infograph       | Train Loss: 1.3593 | Train Acc: 0.5287
 Site-Infograph       | Train Loss: 0.9400 | Train Acc: 0.7161
 Site-Clipart         | Val  Loss: 0.1724 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.1890 | Val  Acc: 0.9460
 Site-Real            | Val  Loss: 0.0219 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0330 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.0855 | Val  Acc: 0.9810
 Site-Painting        | Val  Loss: 0.1226 | Val  Acc: 0.9746
 Site-Sketch          | Val  Loss: 0.1774 | Val  Acc: 0.9429
 Site-Sketch          | Val  Loss: 0.1893 | Val  Acc: 0.9524
 Site-QuickDraw       | Val  Loss: 0.6007 | Val  Acc: 0.8095
 Site-QuickDraw       | Val  Loss: 0.6666 | Val  Acc: 0.7937
 Site-Infograph       | Val  Loss: 1.0395 | Val  Acc: 0.5905
 Site-Infograph       | Val  Loss: 0.9003 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8870
============ Train epoch 49 ============
 Site-Clipart         | Train Loss: 0.2695 | Train Acc: 0.9045
 Site-Clipart         | Train Loss: 0.1598 | Train Acc: 0.9555
 Site-Real            | Train Loss: 0.1198 | Train Acc: 0.9618
 Site-Real            | Train Loss: 0.0388 | Train Acc: 0.9936
 Site-Painting        | Train Loss: 0.2010 | Train Acc: 0.9299
 Site-Painting        | Train Loss: 0.0949 | Train Acc: 0.9831
 Site-Sketch          | Train Loss: 0.3075 | Train Acc: 0.8917
 Site-Sketch          | Train Loss: 0.1946 | Train Acc: 0.9534
 Site-QuickDraw       | Train Loss: 0.7399 | Train Acc: 0.7197
 Site-QuickDraw       | Train Loss: 0.6736 | Train Acc: 0.8199
 Site-Infograph       | Train Loss: 1.3550 | Train Acc: 0.5478
 Site-Infograph       | Train Loss: 0.9385 | Train Acc: 0.7225
 Site-Clipart         | Val  Loss: 0.1880 | Val  Acc: 0.9429
 Site-Clipart         | Val  Loss: 0.1767 | Val  Acc: 0.9556
 Site-Real            | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-Real            | Val  Loss: 0.0417 | Val  Acc: 0.9968
 Site-Painting        | Val  Loss: 0.0954 | Val  Acc: 0.9905
 Site-Painting        | Val  Loss: 0.1113 | Val  Acc: 0.9810
 Site-Sketch          | Val  Loss: 0.1498 | Val  Acc: 0.9524
 Site-Sketch          | Val  Loss: 0.1817 | Val  Acc: 0.9587
 Site-QuickDraw       | Val  Loss: 0.6884 | Val  Acc: 0.8190
 Site-QuickDraw       | Val  Loss: 0.7137 | Val  Acc: 0.7873
 Site-Infograph       | Val  Loss: 1.0459 | Val  Acc: 0.6286
 Site-Infograph       | Val  Loss: 0.9702 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8918
===2023-05-13 06:19:16===
===2023-05-13 06:19:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
domain number = 6
Loading snapshots...
 Test site-Clipart         | Epoch:45 | Test Acc: 0.9278
 Test site-Real            | Epoch:45 | Test Acc: 0.9548
 Test site-Painting        | Epoch:45 | Test Acc: 0.9321
 Test site-Sketch          | Epoch:45 | Test Acc: 0.9097
 Test site-QuickDraw       | Epoch:45 | Test Acc: 0.7190
 Test site-Infograph       | Epoch:45 | Test Acc: 0.5525
Average Test Accuracy: 0.8327
