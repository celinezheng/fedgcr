===2023-03-26 12:25:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2213 | Train Acc: 0.2703
 Site-MNIST     | Train Loss: 2.2286 | Train Acc: 0.2072
 Site-USPS      | Train Loss: 2.2119 | Train Acc: 0.4234
 Site-USPS      | Train Loss: 2.2191 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2899 | Train Acc: 0.1712
 Site-SynthDigits| Train Loss: 2.2815 | Train Acc: 0.1171
 Site-MNIST-M   | Train Loss: 2.2925 | Train Acc: 0.1532
 Site-MNIST-M   | Train Loss: 2.2924 | Train Acc: 0.1351
 Site-MNIST     | Val  Loss: 2.2422 | Val  Acc: 0.1757
 Site-MNIST     | Val  Loss: 2.2020 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 2.2200 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 2.2192 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 2.2868 | Val  Acc: 0.0811
 Site-SynthDigits| Val  Loss: 2.2897 | Val  Acc: 0.1486
 Site-MNIST-M   | Val  Loss: 2.2865 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.3059 | Val  Acc: 0.1622
Average Valid Accuracy: 0.2297
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3378
 Best site-USPS       | Epoch:0 | Val Acc: 0.3243
 Best site-USPS       | Epoch:0 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0811
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1486
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1527 | Train Acc: 0.3874
 Site-MNIST     | Train Loss: 2.1579 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 2.1271 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 2.1340 | Train Acc: 0.3964
 Site-SynthDigits| Train Loss: 2.2740 | Train Acc: 0.1982
 Site-SynthDigits| Train Loss: 2.2601 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.2766 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.2742 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 2.1773 | Val  Acc: 0.3649
 Site-MNIST     | Val  Loss: 2.1197 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 2.1353 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 2.1341 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 2.2627 | Val  Acc: 0.1351
 Site-SynthDigits| Val  Loss: 2.2771 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2712 | Val  Acc: 0.1486
 Site-MNIST-M   | Val  Loss: 2.2838 | Val  Acc: 0.1892
Average Valid Accuracy: 0.2922
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3649
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5000
 Best site-USPS       | Epoch:1 | Val Acc: 0.3784
 Best site-USPS       | Epoch:1 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1351
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1486
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0872 | Train Acc: 0.4595
 Site-MNIST     | Train Loss: 2.0909 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 2.0467 | Train Acc: 0.5495
 Site-USPS      | Train Loss: 2.0548 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 2.2566 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.2389 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.2611 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.2574 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 2.1154 | Val  Acc: 0.3784
 Site-MNIST     | Val  Loss: 2.0431 | Val  Acc: 0.5541
 Site-USPS      | Val  Loss: 2.0554 | Val  Acc: 0.5135
 Site-USPS      | Val  Loss: 2.0539 | Val  Acc: 0.5270
 Site-SynthDigits| Val  Loss: 2.2394 | Val  Acc: 0.2027
 Site-SynthDigits| Val  Loss: 2.2619 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.2565 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2629 | Val  Acc: 0.2568
Average Valid Accuracy: 0.3530
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3784
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5541
 Best site-USPS       | Epoch:2 | Val Acc: 0.5135
 Best site-USPS       | Epoch:2 | Val Acc: 0.5270
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2027
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0234 | Train Acc: 0.4775
 Site-MNIST     | Train Loss: 2.0275 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 1.9707 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 1.9801 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 2.2374 | Train Acc: 0.2793
 Site-SynthDigits| Train Loss: 2.2165 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.2465 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.2416 | Train Acc: 0.2523
 Site-MNIST     | Val  Loss: 2.0556 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 1.9700 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.9810 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.9796 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 2.2162 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 2.2443 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.2432 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2431 | Val  Acc: 0.2838
Average Valid Accuracy: 0.4020
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5811
 Best site-USPS       | Epoch:3 | Val Acc: 0.5811
 Best site-USPS       | Epoch:3 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9631 | Train Acc: 0.5135
 Site-MNIST     | Train Loss: 1.9693 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 1.9003 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 1.9133 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 2.2168 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 2.1944 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.2328 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2260 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.9992 | Val  Acc: 0.4730
 Site-MNIST     | Val  Loss: 1.9010 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.9134 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.9118 | Val  Acc: 0.5811
 Site-SynthDigits| Val  Loss: 2.1932 | Val  Acc: 0.3514
 Site-SynthDigits| Val  Loss: 2.2252 | Val  Acc: 0.2703
 Site-MNIST-M   | Val  Loss: 2.2294 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.2251 | Val  Acc: 0.2973
Average Valid Accuracy: 0.4291
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6216
 Best site-USPS       | Epoch:4 | Val Acc: 0.5811
 Best site-USPS       | Epoch:4 | Val Acc: 0.5811
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3514
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2703
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.9073 | Train Acc: 0.5405
 Site-MNIST     | Train Loss: 1.9149 | Train Acc: 0.5315
 Site-USPS      | Train Loss: 1.8348 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 1.8478 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 2.1966 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1723 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 2.2207 | Train Acc: 0.2793
 Site-MNIST-M   | Train Loss: 2.2108 | Train Acc: 0.3153
 Site-MNIST     | Val  Loss: 1.9480 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.8378 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.8500 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.8492 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1705 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 2.2059 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.2143 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2087 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4510
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6216
 Best site-USPS       | Epoch:5 | Val Acc: 0.5811
 Best site-USPS       | Epoch:5 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8541 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.8650 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 1.7742 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.7928 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 2.1754 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.1497 | Train Acc: 0.3964
 Site-MNIST-M   | Train Loss: 2.2064 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.1955 | Train Acc: 0.3604
 Site-MNIST     | Val  Loss: 1.9005 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7801 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.7921 | Val  Acc: 0.5946
 Site-USPS      | Val  Loss: 1.7928 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.1484 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 2.1852 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.1984 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 2.1925 | Val  Acc: 0.3649
Average Valid Accuracy: 0.4764
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6486
 Best site-USPS       | Epoch:6 | Val Acc: 0.5946
 Best site-USPS       | Epoch:6 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8030 | Train Acc: 0.5856
 Site-MNIST     | Train Loss: 1.8171 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 1.7202 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 1.7377 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 2.1564 | Train Acc: 0.3874
 Site-SynthDigits| Train Loss: 2.1282 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1929 | Train Acc: 0.3153
 Site-MNIST-M   | Train Loss: 2.1808 | Train Acc: 0.3604
 Site-MNIST     | Val  Loss: 1.8541 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7255 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.7370 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.7397 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 2.1268 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 2.1647 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 2.1832 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 2.1759 | Val  Acc: 0.3649
Average Valid Accuracy: 0.4932
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6892
 Best site-USPS       | Epoch:7 | Val Acc: 0.6216
 Best site-USPS       | Epoch:7 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7510 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.7711 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.6673 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 1.6866 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 2.1364 | Train Acc: 0.3874
 Site-SynthDigits| Train Loss: 2.1072 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.1788 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1660 | Train Acc: 0.3964
 Site-MNIST     | Val  Loss: 1.8094 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.6737 | Val  Acc: 0.7027
 Site-USPS      | Val  Loss: 1.6852 | Val  Acc: 0.6216
 Site-USPS      | Val  Loss: 1.6900 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 2.1059 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 2.1430 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 2.1687 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 2.1599 | Val  Acc: 0.3919
Average Valid Accuracy: 0.5135
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7027
 Best site-USPS       | Epoch:8 | Val Acc: 0.6216
 Best site-USPS       | Epoch:8 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7076 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.7276 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 1.6168 | Train Acc: 0.7387
 Site-USPS      | Train Loss: 1.6380 | Train Acc: 0.6126
 Site-SynthDigits| Train Loss: 2.1155 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.0859 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 2.1655 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1515 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 1.7667 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.6250 | Val  Acc: 0.7297
 Site-USPS      | Val  Loss: 1.6360 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.6413 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 2.0859 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 2.1222 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.1536 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.1438 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5203
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7297
 Best site-USPS       | Epoch:9 | Val Acc: 0.6351
 Best site-USPS       | Epoch:9 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SVHN...
===2023-03-26 12:40:13===
===2023-03-26 12:40:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SVHN: 0.1693
Average Test Accuracy: 0.1693
