===2023-03-26 05:42:02===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7001 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.7073 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 1.6406 | Train Acc: 0.7117
 Site-USPS      | Train Loss: 1.6911 | Train Acc: 0.7297
 Site-SynthDigits| Train Loss: 2.0597 | Train Acc: 0.2523
 Site-SynthDigits| Train Loss: 2.0971 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1718 | Train Acc: 0.2072
 Site-MNIST-M   | Train Loss: 2.1601 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.7170 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.6428 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 1.6819 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 1.6645 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 2.0973 | Val  Acc: 0.2297
 Site-SynthDigits| Val  Loss: 2.0619 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.1737 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1452 | Val  Acc: 0.2162
Average Valid Accuracy: 0.4645
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6757
 Best site-USPS       | Epoch:0 | Val Acc: 0.7432
 Best site-USPS       | Epoch:0 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2297
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2844 | Train Acc: 0.7297
 Site-MNIST     | Train Loss: 1.3274 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 1.2272 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 1.2952 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.8737 | Train Acc: 0.3333
 Site-SynthDigits| Train Loss: 1.9222 | Train Acc: 0.3604
 Site-MNIST-M   | Train Loss: 2.0161 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 1.9989 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.3411 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 1.2415 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 1.2920 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 1.2585 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 1.9358 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 1.8655 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.0025 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 1.9855 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5591
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7703
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-USPS       | Epoch:1 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0207 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.0765 | Train Acc: 0.7928
 Site-USPS      | Train Loss: 0.9743 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 1.0451 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.7457 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 1.8062 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 1.8988 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 1.8732 | Train Acc: 0.3874
 Site-MNIST     | Val  Loss: 1.0873 | Val  Acc: 0.7973
 Site-MNIST     | Val  Loss: 0.9990 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.0443 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 1.0047 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.8257 | Val  Acc: 0.3514
 Site-SynthDigits| Val  Loss: 1.7365 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.8671 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 1.8591 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6216
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8108
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-USPS       | Epoch:2 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3514
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8380 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 0.9000 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 0.8174 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.8927 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.6415 | Train Acc: 0.4775
 Site-SynthDigits| Train Loss: 1.7048 | Train Acc: 0.4054
 Site-MNIST-M   | Train Loss: 1.7924 | Train Acc: 0.4054
 Site-MNIST-M   | Train Loss: 1.7620 | Train Acc: 0.4144
 Site-MNIST     | Val  Loss: 0.9116 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.8335 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 0.8936 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.8482 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.7257 | Val  Acc: 0.3514
 Site-SynthDigits| Val  Loss: 1.6376 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.7551 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.7426 | Val  Acc: 0.4595
Average Valid Accuracy: 0.6520
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-USPS       | Epoch:3 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3514
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7095 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.7771 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 0.7068 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.7775 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.5538 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.6169 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 1.6977 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.6661 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.7842 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.7245 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.7770 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.7327 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.6425 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.5502 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.6559 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 1.6433 | Val  Acc: 0.5270
Average Valid Accuracy: 0.6774
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5270
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6106 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6750 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.6209 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.6888 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.4753 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.5339 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 1.6107 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.5818 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.6773 | Val  Acc: 0.8784
 Site-MNIST     | Val  Loss: 0.6390 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.6848 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.6456 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.5623 | Val  Acc: 0.4324
 Site-SynthDigits| Val  Loss: 1.4638 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.5653 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5545 | Val  Acc: 0.5811
Average Valid Accuracy: 0.7162
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4324
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5354 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.5972 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.5704 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.6324 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.4126 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.4641 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.5308 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.4985 | Train Acc: 0.5495
 Site-MNIST     | Val  Loss: 0.5960 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5761 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.6296 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.5911 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.4949 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.4011 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.4834 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.4690 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7314
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8784
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4792 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.5438 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.5118 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.5690 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.3550 | Train Acc: 0.5495
 Site-SynthDigits| Train Loss: 1.4101 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 1.4528 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.4252 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.5365 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5287 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.5652 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.5320 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.4373 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 1.3473 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.4083 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.3915 | Val  Acc: 0.6216
Average Valid Accuracy: 0.7466
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8784
 Best site-USPS       | Epoch:7 | Val Acc: 0.9054
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4270 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4930 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4887 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.5427 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.3050 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.3453 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 1.3802 | Train Acc: 0.5856
 Site-MNIST-M   | Train Loss: 1.3535 | Train Acc: 0.6036
 Site-MNIST     | Val  Loss: 0.4786 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4815 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.5381 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.5051 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.3789 | Val  Acc: 0.5135
 Site-SynthDigits| Val  Loss: 1.2965 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.3359 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.3177 | Val  Acc: 0.6486
Average Valid Accuracy: 0.7534
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9054
 Best site-USPS       | Epoch:8 | Val Acc: 0.9054
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5135
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3947 | Train Acc: 0.9279
 Site-MNIST     | Train Loss: 0.4607 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.4305 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4725 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 1.2604 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 1.3097 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 1.3182 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.2925 | Train Acc: 0.6126
 Site-MNIST     | Val  Loss: 0.4506 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.4551 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.4707 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.4374 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.3355 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.2601 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 1.2747 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.2542 | Val  Acc: 0.6486
Average Valid Accuracy: 0.7568
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-USPS       | Epoch:9 | Val Acc: 0.9054
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SVHN...
===2023-03-26 06:15:06===
===2023-03-26 06:15:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8386
 Test site-USPS      | Epoch:9 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5030
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4129
Average Test Accuracy: 0.6590
===2023-03-26 12:03:40===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SVHN: 0.2494
Average Test Accuracy: 0.2494
