===2023-03-26 01:26:13===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:29:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 02:37:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6530 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.6821 | Train Acc: 0.5766
 Site-USPS      | Train Loss: 1.5979 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 1.6641 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 2.0436 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.0838 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.1653 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.1518 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 1.6957 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6010 | Val  Acc: 0.7027
 Site-USPS      | Val  Loss: 1.6511 | Val  Acc: 0.7703
 Site-USPS      | Val  Loss: 1.6282 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 2.0976 | Val  Acc: 0.2162
 Site-SynthDigits| Val  Loss: 2.0243 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1571 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1541 | Val  Acc: 0.2162
Average Valid Accuracy: 0.4747
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7027
 Best site-USPS       | Epoch:0 | Val Acc: 0.7703
 Best site-USPS       | Epoch:0 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2162
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2618 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.2932 | Train Acc: 0.5856
 Site-USPS      | Train Loss: 1.0935 | Train Acc: 0.8198
 Site-USPS      | Train Loss: 1.1656 | Train Acc: 0.8288
 Site-SynthDigits| Train Loss: 1.7928 | Train Acc: 0.3694
 Site-SynthDigits| Train Loss: 1.8509 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 2.0218 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 1.9938 | Train Acc: 0.2703
 Site-MNIST     | Val  Loss: 1.3432 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.1511 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.1570 | Val  Acc: 0.8243
 Site-USPS      | Val  Loss: 1.1236 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.8553 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.8223 | Val  Acc: 0.4054
 Site-MNIST-M   | Val  Loss: 2.0077 | Val  Acc: 0.2703
 Site-MNIST-M   | Val  Loss: 2.0020 | Val  Acc: 0.2703
Average Valid Accuracy: 0.5287
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6351
 Best site-USPS       | Epoch:1 | Val Acc: 0.8243
 Best site-USPS       | Epoch:1 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4054
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7775 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 0.8340 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.6176 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.6769 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.5869 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.6252 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 1.7646 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.6838 | Train Acc: 0.4505
 Site-MNIST     | Val  Loss: 0.8442 | Val  Acc: 0.7297
 Site-MNIST     | Val  Loss: 0.7413 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 0.6716 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.6476 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.6686 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.6045 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.6642 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.7080 | Val  Acc: 0.4324
Average Valid Accuracy: 0.6284
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7297
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7568
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4799 | Train Acc: 0.8198
 Site-MNIST     | Train Loss: 0.5638 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 0.4021 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.5191 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.2677 | Train Acc: 0.5856
 Site-SynthDigits| Train Loss: 1.2409 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.4345 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.4109 | Train Acc: 0.5225
 Site-MNIST     | Val  Loss: 0.5665 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 0.5110 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.5042 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.4545 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2551 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 1.2520 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.4240 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.3787 | Val  Acc: 0.5811
Average Valid Accuracy: 0.7145
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-USPS       | Epoch:3 | Val Acc: 0.8514
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3771 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.4525 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.2918 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3487 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 1.0051 | Train Acc: 0.6757
 Site-SynthDigits| Train Loss: 0.9988 | Train Acc: 0.6757
 Site-MNIST-M   | Train Loss: 1.1614 | Train Acc: 0.6216
 Site-MNIST-M   | Train Loss: 1.1170 | Train Acc: 0.6486
 Site-MNIST     | Val  Loss: 0.4637 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.4106 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.3130 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3452 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0472 | Val  Acc: 0.6622
 Site-SynthDigits| Val  Loss: 0.9556 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.1286 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.0503 | Val  Acc: 0.6892
Average Valid Accuracy: 0.7787
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6622
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2095 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2603 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.2609 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3054 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.8613 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.8151 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.8369 | Train Acc: 0.8018
 Site-MNIST-M   | Train Loss: 0.9083 | Train Acc: 0.7838
 Site-MNIST     | Val  Loss: 0.2333 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2532 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2690 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.3057 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.8694 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 0.7781 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.9184 | Val  Acc: 0.7838
 Site-MNIST-M   | Val  Loss: 0.8151 | Val  Acc: 0.8243
Average Valid Accuracy: 0.8598
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7838
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.8243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2859 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.3284 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.2932 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3457 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.6868 | Train Acc: 0.7928
 Site-SynthDigits| Train Loss: 0.7443 | Train Acc: 0.7838
 Site-MNIST-M   | Train Loss: 0.7197 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 0.8081 | Train Acc: 0.8198
 Site-MNIST     | Val  Loss: 0.3123 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.3370 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.3202 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3331 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.7883 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 0.6695 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 0.8415 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.6781 | Val  Acc: 0.8649
Average Valid Accuracy: 0.8514
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1509 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1746 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.2119 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2335 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5083 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.4696 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 0.4182 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.5006 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.1556 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1693 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1898 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2565 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.5166 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.4511 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.5330 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.3879 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9291
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-USPS       | Epoch:7 | Val Acc: 0.9595
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1477 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1623 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1632 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.1875 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.3853 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.3777 | Train Acc: 0.9369
 Site-MNIST-M   | Train Loss: 0.3398 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.4330 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.1604 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1647 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1478 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2068 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4199 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3513 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.4728 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.3073 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9392
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-USPS       | Epoch:8 | Val Acc: 0.9595
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0792 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.0897 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.1476 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.1537 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.2854 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.2456 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.1925 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2673 | Train Acc: 0.9550
 Site-MNIST     | Val  Loss: 0.0831 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0816 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1202 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.1674 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2781 | Val  Acc: 0.9865
 Site-SynthDigits| Val  Loss: 0.2426 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.2890 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.1895 | Val  Acc: 0.9730
Average Valid Accuracy: 0.9696
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-USPS       | Epoch:9 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9865
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SVHN...
===2023-03-26 03:11:36===
===2023-03-26 03:11:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8800
 Test site-USPS      | Epoch:9 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6468
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4450
Average Test Accuracy: 0.7134
===2023-03-26 11:58:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 11:59:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SVHN: 0.2932
Average Test Accuracy: 0.2932
===2023-03-29 17:47:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7735 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.7231 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.6968 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 1.6786 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 1.7632 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 1.6304 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 2.1259 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.0856 | Train Acc: 0.2614
 Site-SynthDigits| Train Loss: 2.0988 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.2020 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.1533 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.1878 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.7021 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7389 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.6830 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.6485 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.7795 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.6991 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1000 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 2.1200 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.0750 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1853 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1513 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2074 | Val  Acc: 0.2034
Average Valid Accuracy: 0.4393
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6949
 Best site-USPS       | Epoch:0 | Val Acc: 0.7119
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3700 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.2619 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.3092 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 1.1776 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.2306 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.1013 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8671 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.8548 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.9618 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.0749 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.9467 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.9780 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.3024 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.2939 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.2131 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.1327 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.2298 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.1941 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.9242 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 1.9202 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.8305 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0234 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 1.9547 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.0018 | Val  Acc: 0.3729
Average Valid Accuracy: 0.5339
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6780
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9019 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 0.7957 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 0.8501 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 0.7916 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7951 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.7509 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7443 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.6307 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7359 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9541 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.7912 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.8403 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 0.8904 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.8713 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 0.7985 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.7839 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.8032 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.7893 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7037 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.7244 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6557 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8814 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 1.7758 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8909 | Val  Acc: 0.4068
Average Valid Accuracy: 0.6130
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.9153
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7424 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.6455 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.6788 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.4929 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5150 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5299 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.4890 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.4154 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.5333 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.7316 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.5046 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.5330 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.7669 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.7099 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6197 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.5229 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5253 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5003 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6008 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.5138 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.4893 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.6280 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.5204 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5863 | Val  Acc: 0.4746
Average Valid Accuracy: 0.6554
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4274 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.4550 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4389 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3913 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4079 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4225 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3967 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.2366 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.4211 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.4912 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.2749 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.3610 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.4733 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4937 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3911 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.4255 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4211 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.4054 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.3833 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.3158 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.3089 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.4136 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.2476 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3976 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7189
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4304 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.3594 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4468 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.3007 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.3081 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.3253 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0910 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.9753 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.0899 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.2522 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 0.9918 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.1225 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.4710 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4294 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.3520 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3051 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3017 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2889 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1252 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 0.9962 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.0850 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.1934 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 0.9357 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 1.1064 | Val  Acc: 0.6271
Average Valid Accuracy: 0.7853
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2126 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2659 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2654 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2573 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2420 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2531 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9774 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.8922 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.9894 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 0.9545 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.7607 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.8715 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.2464 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2756 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2235 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2508 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2420 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2449 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.9984 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 0.9145 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 0.9588 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 0.9280 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.7664 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.8328 | Val  Acc: 0.7966
Average Valid Accuracy: 0.8319
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2347 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2346 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2690 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1951 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1606 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1657 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.7729 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 0.6290 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 0.7701 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.8305 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.5622 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.6789 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.2729 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2288 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.1972 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1673 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1583 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1858 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7878 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 0.6512 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.7751 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.7537 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.5836 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.6304 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8743
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1315 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1234 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1308 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1425 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1337 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1362 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6530 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.5209 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.6947 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.5619 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4852 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5174 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.1469 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1329 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1323 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1418 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1277 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1662 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6987 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.5372 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.6783 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.5830 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.4785 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.4429 | Val  Acc: 0.9492
Average Valid Accuracy: 0.9209
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-USPS       | Epoch:8 | Val Acc: 0.9831
 Best site-USPS       | Epoch:8 | Val Acc: 0.9831
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1185 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1010 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1713 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1170 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0860 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0864 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5285 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4233 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.5621 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.4355 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.3431 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3804 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.1647 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1174 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0941 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0845 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0804 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1179 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.6007 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.4382 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.5376 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.4379 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.3666 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3132 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9336
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SVHN...
===2023-03-29 18:28:03===
===2023-03-29 18:28:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.2549
Average Test Accuracy: 0.2549
