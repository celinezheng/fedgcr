===2023-03-26 08:42:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6736 | Train Acc: 0.6306
 Site-MNIST     | Train Loss: 1.6994 | Train Acc: 0.5586
 Site-USPS      | Train Loss: 1.6196 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 1.6707 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 2.0535 | Train Acc: 0.2793
 Site-SynthDigits| Train Loss: 2.0997 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.1645 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.1469 | Train Acc: 0.2342
 Site-MNIST     | Val  Loss: 1.7050 | Val  Acc: 0.5541
 Site-MNIST     | Val  Loss: 1.6322 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 1.6652 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 1.6424 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 2.1106 | Val  Acc: 0.1757
 Site-SynthDigits| Val  Loss: 2.0479 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.1452 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1549 | Val  Acc: 0.2297
Average Valid Accuracy: 0.4459
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5541
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6757
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1757
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.0883 | Train Acc: 0.7928
 Site-MNIST     | Train Loss: 1.1637 | Train Acc: 0.7658
 Site-USPS      | Train Loss: 1.0831 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 1.1765 | Train Acc: 0.7658
 Site-SynthDigits| Train Loss: 1.8308 | Train Acc: 0.3604
 Site-SynthDigits| Train Loss: 1.8632 | Train Acc: 0.3874
 Site-MNIST-M   | Train Loss: 1.9782 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 1.9660 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 1.1774 | Val  Acc: 0.7838
 Site-MNIST     | Val  Loss: 1.0607 | Val  Acc: 0.7838
 Site-USPS      | Val  Loss: 1.1876 | Val  Acc: 0.7568
 Site-USPS      | Val  Loss: 1.1434 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.9387 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 1.7415 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.9298 | Val  Acc: 0.3784
 Site-MNIST-M   | Val  Loss: 1.9727 | Val  Acc: 0.2838
Average Valid Accuracy: 0.5625
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7838
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7568
 Best site-USPS       | Epoch:1 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3784
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2838
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6927 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.7663 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.6251 | Train Acc: 0.8829
 Site-USPS      | Train Loss: 0.6909 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.5562 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.5759 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.7872 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 1.8526 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 0.7511 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7006 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 0.6953 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.6704 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.6326 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.4668 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.7910 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.8126 | Val  Acc: 0.4054
Average Valid Accuracy: 0.6622
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-USPS       | Epoch:2 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4767 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.5302 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.4017 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4423 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 1.3256 | Train Acc: 0.6216
 Site-SynthDigits| Train Loss: 1.2617 | Train Acc: 0.5856
 Site-MNIST-M   | Train Loss: 1.4915 | Train Acc: 0.5495
 Site-MNIST-M   | Train Loss: 1.6381 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 0.4977 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5051 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4364 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.4243 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.2696 | Val  Acc: 0.5405
 Site-SynthDigits| Val  Loss: 1.2410 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.6058 | Val  Acc: 0.5270
 Site-MNIST-M   | Val  Loss: 1.5324 | Val  Acc: 0.5405
Average Valid Accuracy: 0.7382
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.9324
 Best site-USPS       | Epoch:3 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5405
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5270
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5405
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2890 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.3488 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2929 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.3334 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 1.1378 | Train Acc: 0.6577
 Site-SynthDigits| Train Loss: 1.0759 | Train Acc: 0.6667
 Site-MNIST-M   | Train Loss: 1.2875 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.4563 | Train Acc: 0.5405
 Site-MNIST     | Val  Loss: 0.3175 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.3371 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.3217 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3123 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.1035 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 1.0255 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.4336 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.3426 | Val  Acc: 0.6081
Average Valid Accuracy: 0.7770
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1829 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.2483 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2162 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2257 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.9475 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 0.8573 | Train Acc: 0.7658
 Site-MNIST-M   | Train Loss: 0.9457 | Train Acc: 0.7387
 Site-MNIST-M   | Train Loss: 1.1210 | Train Acc: 0.6757
 Site-MNIST     | Val  Loss: 0.2324 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.2296 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2134 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.2166 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.8465 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 0.8641 | Val  Acc: 0.7027
 Site-MNIST-M   | Val  Loss: 1.1177 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 0.9927 | Val  Acc: 0.7297
Average Valid Accuracy: 0.8345
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9865
 Best site-USPS       | Epoch:5 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7027
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1286 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1642 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1731 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.1683 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.7855 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 0.7157 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 0.6762 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 0.8586 | Train Acc: 0.8198
 Site-MNIST     | Val  Loss: 0.1602 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.1497 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1531 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1673 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.7293 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.6951 | Val  Acc: 0.7432
 Site-MNIST-M   | Val  Loss: 0.8651 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.7233 | Val  Acc: 0.8514
Average Valid Accuracy: 0.8834
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-USPS       | Epoch:6 | Val Acc: 0.9730
 Best site-USPS       | Epoch:6 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7432
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0991 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1098 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.1495 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1260 | Train Acc: 0.9820
 Site-SynthDigits| Train Loss: 0.6102 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 0.5661 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 0.4913 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 0.6471 | Train Acc: 0.8739
 Site-MNIST     | Val  Loss: 0.1017 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1091 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1096 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1401 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5911 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 0.5457 | Val  Acc: 0.8108
 Site-MNIST-M   | Val  Loss: 0.6784 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 0.4979 | Val  Acc: 0.9189
Average Valid Accuracy: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 1.0000
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8108
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0680 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0808 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.0847 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0745 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.4891 | Train Acc: 0.8468
 Site-SynthDigits| Train Loss: 0.4614 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 0.3552 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.4406 | Train Acc: 0.9369
 Site-MNIST     | Val  Loss: 0.0760 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0845 | Val  Acc: 0.9730
 Site-SynthDigits| Val  Loss: 0.4728 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4488 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.4671 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.3433 | Val  Acc: 0.9730
Average Valid Accuracy: 0.9493
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 0.9730
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0587 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0724 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.1004 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.0658 | Train Acc: 0.9910
 Site-SynthDigits| Train Loss: 0.3946 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 0.3662 | Train Acc: 0.8919
 Site-MNIST-M   | Train Loss: 0.2582 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3409 | Train Acc: 0.9550
 Site-MNIST     | Val  Loss: 0.0630 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0715 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0906 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.3777 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.3580 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 0.3584 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.2575 | Val  Acc: 0.9865
Average Valid Accuracy: 0.9578
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SVHN...
===2023-03-26 09:14:23===
===2023-03-26 09:14:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8629
 Test site-USPS      | Epoch:9 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5928
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3743
Average Test Accuracy: 0.6860
===2023-03-26 12:07:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SVHN: 0.2610
Average Test Accuracy: 0.2610
===2023-03-29 21:13:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8260 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.7431 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.7638 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 1.7366 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 1.7831 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 1.6799 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.1127 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.0871 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.1288 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.2157 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.1747 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.2013 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.7637 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.7928 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7464 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 1.7025 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.8129 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.7409 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1141 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.1220 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 2.0854 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1894 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1610 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2076 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4336
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-USPS       | Epoch:0 | Val Acc: 0.7119
 Best site-USPS       | Epoch:0 | Val Acc: 0.6949
 Best site-USPS       | Epoch:0 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3933 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.3490 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3823 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.3224 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.3871 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.2978 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9397 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 1.9066 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9486 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.1037 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.0287 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 1.9838 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 1.3843 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.4143 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.3176 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.3087 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.4136 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.3555 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.9276 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 1.9575 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 1.8917 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0264 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0045 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.0708 | Val  Acc: 0.2712
Average Valid Accuracy: 0.5353
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-USPS       | Epoch:1 | Val Acc: 0.8136
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1269 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.0826 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1173 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.0709 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1278 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 1.0109 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8062 | Train Acc: 0.3750
 Site-SynthDigits| Train Loss: 1.7348 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.8237 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.9749 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.8932 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.8437 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.1162 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1336 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0309 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0352 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.1308 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0718 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.8026 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.8306 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.7401 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8995 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.8741 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 1.9457 | Val  Acc: 0.3898
Average Valid Accuracy: 0.6003
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3898
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8949 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.8802 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.9086 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.8082 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.8895 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.8322 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.6912 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.6105 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.7313 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.8658 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.7703 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.7427 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 0.9309 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.9440 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8417 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.8426 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.9151 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.8701 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6845 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.6997 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6197 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.7753 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7398 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.8508 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6540
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7631 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.7350 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.7794 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.7040 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.7409 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.6863 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6300 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.5180 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.6038 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7702 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.6781 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.5823 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.7978 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8103 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7029 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.7008 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7706 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7362 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.6175 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6103 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.5275 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6533 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6233 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.7560 | Val  Acc: 0.4576
Average Valid Accuracy: 0.6836
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8305
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6496 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.6573 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.7110 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6015 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6498 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5681 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5264 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.4921 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4917 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.6731 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.5779 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.4714 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.6994 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6991 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6037 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.6008 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6733 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6309 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.5276 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5141 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.4342 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.5515 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5275 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.6706 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6992
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8305
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5572 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5829 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6133 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5402 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5784 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5060 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.4427 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.3621 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.4165 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.5917 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.4794 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.4126 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.6137 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6075 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.5237 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.5319 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6007 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5663 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4399 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.4316 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.3594 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.4564 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.4447 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5622 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7189
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4902 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4984 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.5700 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4642 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5175 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4567 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3326 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3495 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.3369 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.4955 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.4104 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.2965 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.5530 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5396 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4592 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4679 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5307 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5023 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.3556 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.3478 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.2923 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3803 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3831 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4776 | Val  Acc: 0.6102
Average Valid Accuracy: 0.7429
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-USPS       | Epoch:7 | Val Acc: 0.8983
 Best site-USPS       | Epoch:7 | Val Acc: 0.8983
 Best site-USPS       | Epoch:7 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4262 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4554 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4962 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4534 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.4680 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.4001 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2514 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.1848 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 1.2530 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.4009 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.2779 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.3159 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.4979 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4746 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.4114 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4254 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4741 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4536 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2779 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.2484 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 1.2403 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3160 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3255 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3889 | Val  Acc: 0.6102
Average Valid Accuracy: 0.7599
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3932 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3730 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4334 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4018 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4211 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3892 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.2343 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.1377 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.1741 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.3568 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.2840 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.1836 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.4515 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4184 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3745 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3912 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.4219 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4124 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.1862 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.1708 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.1886 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.2615 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2871 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3211 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7712
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9153
 Best site-USPS       | Epoch:9 | Val Acc: 0.9322
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SVHN...
===2023-03-29 21:52:23===
===2023-03-29 21:52:25===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SVHN: 0.3395
Average Test Accuracy: 0.3395
