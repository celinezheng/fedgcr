===2023-04-19 08:31:32===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,14,29,44,32,38,77,35,]
label set of clients: [10, 10, 10, 10, 10, 9, 10, 10, 10, 10, 10, 9, ]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[2, 1, 3, 1, 1, 4, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 2.2880 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.4143 | Train Acc: 0.0800
 Site-Clipart   | Train Loss: 2.2600 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.2686 | Train Acc: 0.0900
 Site-Infograph | Train Loss: 2.3331 | Train Acc: 0.0968
 Site-Painting  | Train Loss: 2.4007 | Train Acc: 0.0714
 Site-Painting  | Train Loss: 2.2749 | Train Acc: 0.1379
 Site-Painting  | Train Loss: 2.3508 | Train Acc: 0.1136
 Site-QuickDraw | Train Loss: 2.3330 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.3657 | Train Acc: 0.0789
 Site-Real      | Train Loss: 2.2121 | Train Acc: 0.1558
 Site-Sketch    | Train Loss: 2.3062 | Train Acc: 0.0857
 Site-Clipart   | Val  Loss: 2.3231 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.3184 | Val  Acc: 0.1212
 Site-Clipart   | Val  Loss: 2.1699 | Val  Acc: 0.1400
 Site-Clipart   | Val  Loss: 2.2400 | Val  Acc: 0.1791
 Site-Infograph | Val  Loss: 2.3789 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.3837 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.4609 | Val  Acc: 0.1579
 Site-Painting  | Val  Loss: 2.3053 | Val  Acc: 0.1034
 Site-QuickDraw | Val  Loss: 2.5284 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1065 | Val  Acc: 0.2400
 Site-Real      | Val  Loss: 2.2065 | Val  Acc: 0.1569
 Site-Sketch    | Val  Loss: 2.2749 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1317
Aggregated Acc | Val Acc: 0.1252
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1212
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1400
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1791
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1579
 Best site-Painting   | Epoch:0 | Val Acc: 0.1034
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2400
 Best site-Real       | Epoch:0 | Val Acc: 0.1569
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-3
client-9 is in G-5
client-10 is in G-5
client-11 is in G-4
cnt=[1, 4, 2, 1, 1, 3, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 2.2102 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.3928 | Train Acc: 0.1000
 Site-Clipart   | Train Loss: 2.1204 | Train Acc: 0.2533
 Site-Clipart   | Train Loss: 2.1481 | Train Acc: 0.1600
 Site-Infograph | Train Loss: 2.2859 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.2449 | Train Acc: 0.1429
 Site-Painting  | Train Loss: 2.1525 | Train Acc: 0.2414
 Site-Painting  | Train Loss: 2.3300 | Train Acc: 0.0909
 Site-QuickDraw | Train Loss: 2.2889 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.2394 | Train Acc: 0.1842
 Site-Real      | Train Loss: 2.1151 | Train Acc: 0.2468
 Site-Sketch    | Train Loss: 2.1864 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.1398 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2029 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.1066 | Val  Acc: 0.1600
 Site-Clipart   | Val  Loss: 2.1586 | Val  Acc: 0.1791
 Site-Infograph | Val  Loss: 2.2296 | Val  Acc: 0.0000
 Site-Painting  | Val  Loss: 2.1750 | Val  Acc: 0.1111
 Site-Painting  | Val  Loss: 2.2842 | Val  Acc: 0.0526
 Site-Painting  | Val  Loss: 2.2366 | Val  Acc: 0.1034
 Site-QuickDraw | Val  Loss: 2.4804 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0765 | Val  Acc: 0.3200
 Site-Real      | Val  Loss: 2.1538 | Val  Acc: 0.1961
 Site-Sketch    | Val  Loss: 2.2484 | Val  Acc: 0.0870
Average Valid Accuracy: 0.1370
Aggregated Acc | Val Acc: 0.1067
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1791
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0000
 Best site-Painting   | Epoch:1 | Val Acc: 0.1111
 Best site-Painting   | Epoch:1 | Val Acc: 0.0526
 Best site-Painting   | Epoch:1 | Val Acc: 0.1034
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0952
 Best site-Real       | Epoch:1 | Val Acc: 0.3200
 Best site-Real       | Epoch:1 | Val Acc: 0.1961
 Best site-Sketch     | Epoch:1 | Val Acc: 0.0870
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 2 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[5, 1, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 2.1252 | Train Acc: 0.2400
 Site-Clipart   | Train Loss: 2.1013 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0713 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.0452 | Train Acc: 0.3100
 Site-Infograph | Train Loss: 2.2640 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 2.2057 | Train Acc: 0.0714
 Site-Painting  | Train Loss: 2.1060 | Train Acc: 0.3103
 Site-Painting  | Train Loss: 2.2466 | Train Acc: 0.1591
 Site-QuickDraw | Train Loss: 2.3127 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.0797 | Train Acc: 0.2368
 Site-Real      | Train Loss: 2.0076 | Train Acc: 0.3766
 Site-Sketch    | Train Loss: 2.1379 | Train Acc: 0.2571
 Site-Clipart   | Val  Loss: 2.0249 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.3300 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 2.0741 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0772 | Val  Acc: 0.2836
 Site-Infograph | Val  Loss: 2.3687 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 2.2043 | Val  Acc: 0.2222
 Site-Painting  | Val  Loss: 2.2153 | Val  Acc: 0.2105
 Site-Painting  | Val  Loss: 2.2249 | Val  Acc: 0.1724
 Site-QuickDraw | Val  Loss: 2.4117 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.0408 | Val  Acc: 0.3200
 Site-Real      | Val  Loss: 2.0187 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 2.0913 | Val  Acc: 0.2609
Average Valid Accuracy: 0.2584
Aggregated Acc | Val Acc: 0.2055
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2836
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1000
 Best site-Painting   | Epoch:2 | Val Acc: 0.2222
 Best site-Painting   | Epoch:2 | Val Acc: 0.2105
 Best site-Painting   | Epoch:2 | Val Acc: 0.1724
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0952
 Best site-Real       | Epoch:2 | Val Acc: 0.3200
 Best site-Real       | Epoch:2 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.2609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-4
client-7 is in G-3
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-0
cnt=[5, 1, 1, 1, 3, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 2.0233 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 2.0591 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0010 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.9074 | Train Acc: 0.4600
 Site-Infograph | Train Loss: 2.2247 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 2.2051 | Train Acc: 0.0714
 Site-Painting  | Train Loss: 2.1087 | Train Acc: 0.2414
 Site-Painting  | Train Loss: 2.2010 | Train Acc: 0.1818
 Site-QuickDraw | Train Loss: 2.2769 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0078 | Train Acc: 0.4737
 Site-Real      | Train Loss: 1.9217 | Train Acc: 0.4675
 Site-Sketch    | Train Loss: 2.1078 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.9688 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.2353 | Val  Acc: 0.3030
 Site-Clipart   | Val  Loss: 1.9635 | Val  Acc: 0.3600
 Site-Clipart   | Val  Loss: 1.9618 | Val  Acc: 0.4030
 Site-Infograph | Val  Loss: 2.3199 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.0969 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 2.0441 | Val  Acc: 0.2632
 Site-Painting  | Val  Loss: 2.1920 | Val  Acc: 0.2759
 Site-QuickDraw | Val  Loss: 2.4064 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.9223 | Val  Acc: 0.4000
 Site-Real      | Val  Loss: 1.9271 | Val  Acc: 0.5098
 Site-Sketch    | Val  Loss: 2.0453 | Val  Acc: 0.3043
Average Valid Accuracy: 0.3196
Aggregated Acc | Val Acc: 0.2678
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3030
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4030
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1500
 Best site-Painting   | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.2632
 Best site-Painting   | Epoch:3 | Val Acc: 0.2759
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0952
 Best site-Real       | Epoch:3 | Val Acc: 0.4000
 Best site-Real       | Epoch:3 | Val Acc: 0.5098
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 4 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-3
client-6 is in G-3
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[1, 1, 3, 2, 1, 4, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.9924 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.0235 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.9415 | Train Acc: 0.3733
 Site-Clipart   | Train Loss: 1.9105 | Train Acc: 0.4800
 Site-Infograph | Train Loss: 2.2284 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.1106 | Train Acc: 0.2857
 Site-Painting  | Train Loss: 1.9636 | Train Acc: 0.3793
 Site-Painting  | Train Loss: 2.1566 | Train Acc: 0.3182
 Site-QuickDraw | Train Loss: 2.3113 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.9486 | Train Acc: 0.4211
 Site-Real      | Train Loss: 1.8503 | Train Acc: 0.5325
 Site-Sketch    | Train Loss: 1.9428 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 1.8620 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0140 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 1.8585 | Val  Acc: 0.4600
 Site-Clipart   | Val  Loss: 1.8964 | Val  Acc: 0.4478
 Site-Infograph | Val  Loss: 2.2947 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.9898 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 2.0896 | Val  Acc: 0.3684
 Site-Painting  | Val  Loss: 2.1431 | Val  Acc: 0.3103
 Site-QuickDraw | Val  Loss: 2.3921 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.8278 | Val  Acc: 0.5200
 Site-Real      | Val  Loss: 1.9157 | Val  Acc: 0.5098
 Site-Sketch    | Val  Loss: 1.9544 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3991
Aggregated Acc | Val Acc: 0.3341
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4600
 Best site-Clipart    | Epoch:4 | Val Acc: 0.4478
 Best site-Infograph  | Epoch:4 | Val Acc: 0.1000
 Best site-Painting   | Epoch:4 | Val Acc: 0.5556
 Best site-Painting   | Epoch:4 | Val Acc: 0.3684
 Best site-Painting   | Epoch:4 | Val Acc: 0.3103
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.0952
 Best site-Real       | Epoch:4 | Val Acc: 0.5200
 Best site-Real       | Epoch:4 | Val Acc: 0.5098
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 5 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[3, 1, 3, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.9773 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.9204 | Train Acc: 0.3800
 Site-Clipart   | Train Loss: 1.8346 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7615 | Train Acc: 0.5700
 Site-Infograph | Train Loss: 2.2089 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 2.0574 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.9280 | Train Acc: 0.4483
 Site-Painting  | Train Loss: 2.1221 | Train Acc: 0.2727
 Site-QuickDraw | Train Loss: 2.3075 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.8827 | Train Acc: 0.5789
 Site-Real      | Train Loss: 1.7592 | Train Acc: 0.5974
 Site-Sketch    | Train Loss: 1.8641 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7829 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8291 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.7815 | Val  Acc: 0.5400
 Site-Clipart   | Val  Loss: 1.8136 | Val  Acc: 0.5224
 Site-Infograph | Val  Loss: 2.2983 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.0107 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 1.9889 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.0026 | Val  Acc: 0.3448
 Site-QuickDraw | Val  Loss: 2.3700 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.7884 | Val  Acc: 0.6400
 Site-Real      | Val  Loss: 1.8176 | Val  Acc: 0.4902
 Site-Sketch    | Val  Loss: 1.9407 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4484
Aggregated Acc | Val Acc: 0.3873
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5400
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5224
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Painting   | Epoch:5 | Val Acc: 0.4444
 Best site-Painting   | Epoch:5 | Val Acc: 0.4737
 Best site-Painting   | Epoch:5 | Val Acc: 0.3448
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0952
 Best site-Real       | Epoch:5 | Val Acc: 0.6400
 Best site-Real       | Epoch:5 | Val Acc: 0.4902
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 6 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-3
client-6 is in G-3
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[2, 5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.8332 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.7542 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.7758 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6817 | Train Acc: 0.6700
 Site-Infograph | Train Loss: 2.2061 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 1.8931 | Train Acc: 0.3571
 Site-Painting  | Train Loss: 1.8331 | Train Acc: 0.5517
 Site-Painting  | Train Loss: 2.0617 | Train Acc: 0.3182
 Site-QuickDraw | Train Loss: 2.2491 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.8220 | Train Acc: 0.5263
 Site-Real      | Train Loss: 1.7107 | Train Acc: 0.6883
 Site-Sketch    | Train Loss: 1.9288 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.7059 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.8743 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7058 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.7438 | Val  Acc: 0.5373
 Site-Infograph | Val  Loss: 2.2482 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 1.8695 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.9468 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 2.0641 | Val  Acc: 0.3103
 Site-QuickDraw | Val  Loss: 2.3091 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.7057 | Val  Acc: 0.7600
 Site-Real      | Val  Loss: 1.7116 | Val  Acc: 0.6863
 Site-Sketch    | Val  Loss: 1.7863 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4945
Aggregated Acc | Val Acc: 0.3823
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:6 | Val Acc: 0.5373
 Best site-Infograph  | Epoch:6 | Val Acc: 0.0500
 Best site-Painting   | Epoch:6 | Val Acc: 0.5556
 Best site-Painting   | Epoch:6 | Val Acc: 0.4737
 Best site-Painting   | Epoch:6 | Val Acc: 0.3103
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.0952
 Best site-Real       | Epoch:6 | Val Acc: 0.7600
 Best site-Real       | Epoch:6 | Val Acc: 0.6863
 Best site-Sketch     | Epoch:6 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[3, 4, 1, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.6433 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.7110 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.7068 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6090 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.2892 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 1.9430 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.7530 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.9557 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 2.2424 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.7322 | Train Acc: 0.6053
 Site-Real      | Train Loss: 1.6155 | Train Acc: 0.7922
 Site-Sketch    | Train Loss: 1.7087 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.6114 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.8060 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.6371 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.6711 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 2.2414 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.7530 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.9313 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 1.9863 | Val  Acc: 0.4138
 Site-QuickDraw | Val  Loss: 2.3059 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.6396 | Val  Acc: 0.7200
 Site-Real      | Val  Loss: 1.6218 | Val  Acc: 0.8039
 Site-Sketch    | Val  Loss: 1.8288 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5084
Aggregated Acc | Val Acc: 0.4166
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6269
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1000
 Best site-Painting   | Epoch:7 | Val Acc: 0.5556
 Best site-Painting   | Epoch:7 | Val Acc: 0.4737
 Best site-Painting   | Epoch:7 | Val Acc: 0.4138
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.0952
 Best site-Real       | Epoch:7 | Val Acc: 0.7200
 Best site-Real       | Epoch:7 | Val Acc: 0.8039
 Best site-Sketch     | Epoch:7 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 8 ============
gmm
client-0 is in G-3
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
cnt=[1, 1, 2, 4, 3, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.6682 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5921 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.6288 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.5324 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.2267 | Train Acc: 0.1290
 Site-Painting  | Train Loss: 1.8208 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.6863 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.9524 | Train Acc: 0.4545
 Site-QuickDraw | Train Loss: 2.2655 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6767 | Train Acc: 0.6579
 Site-Real      | Train Loss: 1.5338 | Train Acc: 0.8052
 Site-Sketch    | Train Loss: 1.6979 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5136 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.9069 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5346 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5770 | Val  Acc: 0.6567
 Site-Infograph | Val  Loss: 2.1691 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.7049 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7489 | Val  Acc: 0.4737
 Site-Painting  | Val  Loss: 1.8814 | Val  Acc: 0.4138
 Site-QuickDraw | Val  Loss: 2.2500 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.5518 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.5647 | Val  Acc: 0.7843
 Site-Sketch    | Val  Loss: 1.7454 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5715
Aggregated Acc | Val Acc: 0.4824
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6567
 Best site-Infograph  | Epoch:8 | Val Acc: 0.2000
 Best site-Painting   | Epoch:8 | Val Acc: 0.6667
 Best site-Painting   | Epoch:8 | Val Acc: 0.4737
 Best site-Painting   | Epoch:8 | Val Acc: 0.4138
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.0952
 Best site-Real       | Epoch:8 | Val Acc: 0.8800
 Best site-Real       | Epoch:8 | Val Acc: 0.7843
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-5
client-10 is in G-5
client-11 is in G-1
cnt=[1, 5, 1, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.5941 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6735 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.5662 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.4648 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.1805 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.7572 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.7266 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.8780 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 2.2196 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.5758 | Train Acc: 0.7105
 Site-Real      | Train Loss: 1.4948 | Train Acc: 0.7662
 Site-Sketch    | Train Loss: 1.4600 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.4504 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6297 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.4778 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.5066 | Val  Acc: 0.6567
 Site-Infograph | Val  Loss: 2.2568 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 1.6022 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7533 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.8494 | Val  Acc: 0.5172
 Site-QuickDraw | Val  Loss: 2.2915 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.5016 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.5137 | Val  Acc: 0.7843
 Site-Sketch    | Val  Loss: 1.6646 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5982
Aggregated Acc | Val Acc: 0.4795
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:9 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:9 | Val Acc: 0.6567
 Best site-Infograph  | Epoch:9 | Val Acc: 0.0500
 Best site-Painting   | Epoch:9 | Val Acc: 0.6667
 Best site-Painting   | Epoch:9 | Val Acc: 0.5789
 Best site-Painting   | Epoch:9 | Val Acc: 0.5172
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1429
 Best site-Real       | Epoch:9 | Val Acc: 0.8800
 Best site-Real       | Epoch:9 | Val Acc: 0.7843
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.6369
 Test site-Infograph | Epoch:9 | Test Acc: 0.2801
 Test site-Painting  | Epoch:9 | Test Acc: 0.6381
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2190
 Test site-Real      | Epoch:9 | Test Acc: 0.7683
 Test site-Sketch    | Epoch:9 | Test Acc: 0.5596
Average Test Accuracy: 0.5170
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
cnt=[3, 4, 1, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.5808 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.6878 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.4661 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.4388 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.2071 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.7433 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.5810 | Train Acc: 0.6207
 Site-Painting  | Train Loss: 1.8042 | Train Acc: 0.5000
 Site-QuickDraw | Train Loss: 2.2008 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.5377 | Train Acc: 0.7368
 Site-Real      | Train Loss: 1.3973 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.4552 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.4115 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.6955 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.3981 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.4594 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 2.1335 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.6496 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.7416 | Val  Acc: 0.5789
 Site-Painting  | Val  Loss: 1.8235 | Val  Acc: 0.5862
 Site-QuickDraw | Val  Loss: 2.2583 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.4994 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.3861 | Val  Acc: 0.8235
 Site-Sketch    | Val  Loss: 1.6318 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6146
Aggregated Acc | Val Acc: 0.5137
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:10 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:10 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:10 | Val Acc: 0.1500
 Best site-Painting   | Epoch:10 | Val Acc: 0.7778
 Best site-Painting   | Epoch:10 | Val Acc: 0.5789
 Best site-Painting   | Epoch:10 | Val Acc: 0.5862
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1429
 Best site-Real       | Epoch:10 | Val Acc: 0.8800
 Best site-Real       | Epoch:10 | Val Acc: 0.8235
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[4, 1, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.3918 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.5220 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4623 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.3488 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.1547 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.6121 | Train Acc: 0.6429
 Site-Painting  | Train Loss: 1.5276 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.7819 | Train Acc: 0.5227
 Site-QuickDraw | Train Loss: 2.2336 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.4446 | Train Acc: 0.7368
 Site-Real      | Train Loss: 1.3494 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.3902 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.3280 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.6207 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.3111 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.3686 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 2.1817 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.5787 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.5944 | Val  Acc: 0.6316
 Site-Painting  | Val  Loss: 1.8393 | Val  Acc: 0.5172
 Site-QuickDraw | Val  Loss: 2.2198 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.4333 | Val  Acc: 0.8800
 Site-Real      | Val  Loss: 1.3239 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5987 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6515
Aggregated Acc | Val Acc: 0.5969
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:11 | Val Acc: 0.2000
 Best site-Painting   | Epoch:11 | Val Acc: 0.6667
 Best site-Painting   | Epoch:11 | Val Acc: 0.6316
 Best site-Painting   | Epoch:11 | Val Acc: 0.5172
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.1429
 Best site-Real       | Epoch:11 | Val Acc: 0.8800
 Best site-Real       | Epoch:11 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 12 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-5
cnt=[3, 1, 4, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.3978 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.4408 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3607 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.2427 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0732 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.6547 | Train Acc: 0.6429
 Site-Painting  | Train Loss: 1.4906 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.7416 | Train Acc: 0.5455
 Site-QuickDraw | Train Loss: 2.1992 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.4543 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.2695 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.3256 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.3334 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4132 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.2270 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.3642 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 2.2094 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.4506 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.6014 | Val  Acc: 0.5263
 Site-Painting  | Val  Loss: 1.6417 | Val  Acc: 0.6552
 Site-QuickDraw | Val  Loss: 2.2247 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.2819 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.2892 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5349 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6534
Aggregated Acc | Val Acc: 0.5547
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:12 | Val Acc: 0.1500
 Best site-Painting   | Epoch:12 | Val Acc: 0.7778
 Best site-Painting   | Epoch:12 | Val Acc: 0.5263
 Best site-Painting   | Epoch:12 | Val Acc: 0.6552
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.1905
 Best site-Real       | Epoch:12 | Val Acc: 0.9200
 Best site-Real       | Epoch:12 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
cnt=[2, 1, 1, 3, 4, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.4406 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3132 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3554 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.2132 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0536 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5279 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.4392 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.6326 | Train Acc: 0.5682
 Site-QuickDraw | Train Loss: 2.1797 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.3294 | Train Acc: 0.7632
 Site-Real      | Train Loss: 1.2336 | Train Acc: 0.8701
 Site-Sketch    | Train Loss: 1.4435 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.2677 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.4530 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.2761 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.2920 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.0346 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.3876 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.5008 | Val  Acc: 0.6842
 Site-Painting  | Val  Loss: 1.7441 | Val  Acc: 0.5172
 Site-QuickDraw | Val  Loss: 2.1802 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.2797 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1672 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.5242 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6737
Aggregated Acc | Val Acc: 0.5622
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7612
 Best site-Infograph  | Epoch:13 | Val Acc: 0.2500
 Best site-Painting   | Epoch:13 | Val Acc: 0.7778
 Best site-Painting   | Epoch:13 | Val Acc: 0.6842
 Best site-Painting   | Epoch:13 | Val Acc: 0.5172
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.1905
 Best site-Real       | Epoch:13 | Val Acc: 0.9600
 Best site-Real       | Epoch:13 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-1
client-7 is in G-3
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
cnt=[4, 2, 1, 3, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.3302 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5052 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.2839 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2286 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.1381 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.3835 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 1.4852 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.5391 | Train Acc: 0.6591
 Site-QuickDraw | Train Loss: 2.1918 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.2695 | Train Acc: 0.7895
 Site-Real      | Train Loss: 1.1763 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.3543 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.1562 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2925 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.1236 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.2504 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 2.1947 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.4439 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.4808 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.6353 | Val  Acc: 0.5862
 Site-QuickDraw | Val  Loss: 2.1671 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1592 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.1828 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.4751 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7066
Aggregated Acc | Val Acc: 0.6000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3000
 Best site-Painting   | Epoch:14 | Val Acc: 0.7778
 Best site-Painting   | Epoch:14 | Val Acc: 0.7368
 Best site-Painting   | Epoch:14 | Val Acc: 0.5862
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.2857
 Best site-Real       | Epoch:14 | Val Acc: 0.9600
 Best site-Real       | Epoch:14 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[5, 1, 2, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.2258 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1652 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2440 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 1.1068 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0724 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.5361 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.3033 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.5884 | Train Acc: 0.5682
 Site-QuickDraw | Train Loss: 2.1478 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.1429 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.1335 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.3803 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1402 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.3748 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.1084 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.1652 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.1507 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.2848 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 1.4055 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.5557 | Val  Acc: 0.6552
 Site-QuickDraw | Val  Loss: 2.1651 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.1197 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.0769 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.4658 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7103
Aggregated Acc | Val Acc: 0.6129
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:15 | Val Acc: 0.2500
 Best site-Painting   | Epoch:15 | Val Acc: 0.8889
 Best site-Painting   | Epoch:15 | Val Acc: 0.7368
 Best site-Painting   | Epoch:15 | Val Acc: 0.6552
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2381
 Best site-Real       | Epoch:15 | Val Acc: 0.9600
 Best site-Real       | Epoch:15 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 16 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-5
cnt=[4, 1, 1, 3, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.2147 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3180 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2242 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0797 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 2.1053 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.3884 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.3383 | Train Acc: 0.6552
 Site-Painting  | Train Loss: 1.5537 | Train Acc: 0.6364
 Site-QuickDraw | Train Loss: 2.1142 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.1496 | Train Acc: 0.8158
 Site-Real      | Train Loss: 1.0750 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.2457 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.1611 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2911 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0851 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.1938 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 2.1169 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.2928 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.4675 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4257 | Val  Acc: 0.7586
 Site-QuickDraw | Val  Loss: 2.0731 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.1314 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 1.0851 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.4291 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7075
Aggregated Acc | Val Acc: 0.5975
============ Train epoch 17 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-5
client-5 is in G-1
client-6 is in G-1
client-7 is in G-4
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 5, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.1765 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1936 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2126 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0755 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 2.0590 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.3689 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.3015 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.4416 | Train Acc: 0.7045
 Site-QuickDraw | Train Loss: 2.1163 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.1815 | Train Acc: 0.8684
 Site-Real      | Train Loss: 1.0400 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.0926 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0649 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.4302 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0468 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.1418 | Val  Acc: 0.7612
 Site-Infograph | Val  Loss: 2.1556 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.3420 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.3584 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.5208 | Val  Acc: 0.7241
 Site-QuickDraw | Val  Loss: 2.1912 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.0637 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 1.0364 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.4493 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6900
Aggregated Acc | Val Acc: 0.5868
============ Train epoch 18 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-5
client-9 is in G-4
client-10 is in G-4
client-11 is in G-1
cnt=[1, 1, 4, 1, 4, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.2851 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0979 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1507 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0051 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 2.0009 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.3438 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 1.1971 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.5004 | Train Acc: 0.6818
 Site-QuickDraw | Train Loss: 2.0893 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.1782 | Train Acc: 0.8421
 Site-Real      | Train Loss: 1.0206 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.1373 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0692 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.1764 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.9014 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.1517 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.1157 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.1949 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.3538 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.4688 | Val  Acc: 0.7586
 Site-QuickDraw | Val  Loss: 2.0821 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0188 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.9668 | Val  Acc: 0.8824
 Site-Sketch    | Val  Loss: 1.3561 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7326
Aggregated Acc | Val Acc: 0.6055
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:18 | Val Acc: 0.3000
 Best site-Painting   | Epoch:18 | Val Acc: 0.7778
 Best site-Painting   | Epoch:18 | Val Acc: 0.7895
 Best site-Painting   | Epoch:18 | Val Acc: 0.7586
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.3333
 Best site-Real       | Epoch:18 | Val Acc: 0.9200
 Best site-Real       | Epoch:18 | Val Acc: 0.8824
 Best site-Sketch     | Epoch:18 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 19 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-3
client-5 is in G-5
client-6 is in G-5
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[1, 1, 2, 1, 4, 3, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.0926 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.2700 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0698 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.9578 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9992 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.2741 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.1876 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.3488 | Train Acc: 0.6818
 Site-QuickDraw | Train Loss: 2.0671 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.1458 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.9766 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.2344 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9539 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.2052 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.9383 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.1113 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 2.1684 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2372 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.2297 | Val  Acc: 0.7368
 Site-Painting  | Val  Loss: 1.4868 | Val  Acc: 0.6552
 Site-QuickDraw | Val  Loss: 2.0922 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 0.9652 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.8983 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3067 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7376
Aggregated Acc | Val Acc: 0.6310
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:19 | Val Acc: 0.3000
 Best site-Painting   | Epoch:19 | Val Acc: 0.7778
 Best site-Painting   | Epoch:19 | Val Acc: 0.7368
 Best site-Painting   | Epoch:19 | Val Acc: 0.6552
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.1905
 Best site-Real       | Epoch:19 | Val Acc: 0.9600
 Best site-Real       | Epoch:19 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:19 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.7757
 Test site-Infograph | Epoch:19 | Test Acc: 0.3531
 Test site-Painting  | Epoch:19 | Test Acc: 0.7690
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.3150
 Test site-Real      | Epoch:19 | Test Acc: 0.8718
 Test site-Sketch    | Epoch:19 | Test Acc: 0.6697
Average Test Accuracy: 0.6257
============ Train epoch 20 ============
gmm
client-0 is in G-1
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[3, 4, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.1613 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1296 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1229 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.9345 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9826 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.1064 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.2767 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.3225 | Train Acc: 0.7273
 Site-QuickDraw | Train Loss: 1.9961 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.9885 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.9461 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 1.2402 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0055 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.1438 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.9084 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0391 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.9664 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.1231 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 1.1157 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 1.4098 | Val  Acc: 0.7586
 Site-QuickDraw | Val  Loss: 2.0776 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 0.9233 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.8779 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3559 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7862
Aggregated Acc | Val Acc: 0.7021
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 1.0000
 Best site-Painting   | Epoch:20 | Val Acc: 0.9474
 Best site-Painting   | Epoch:20 | Val Acc: 0.7586
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.1905
 Best site-Real       | Epoch:20 | Val Acc: 0.9600
 Best site-Real       | Epoch:20 | Val Acc: 0.9216
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 21 ============
gmm
client-0 is in G-2
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-4
client-7 is in G-3
client-8 is in G-5
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
cnt=[1, 1, 4, 3, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.1204 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2618 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.0545 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.9442 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 2.0329 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.1237 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.1510 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2687 | Train Acc: 0.7273
 Site-QuickDraw | Train Loss: 1.9809 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.9884 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.9080 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 1.2318 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.0107 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2026 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8822 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 1.0215 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.9248 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 1.1660 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 1.1978 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.3990 | Val  Acc: 0.6897
 Site-QuickDraw | Val  Loss: 2.0541 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.9279 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.8480 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.2915 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7651
Aggregated Acc | Val Acc: 0.6932
============ Train epoch 22 ============
gmm
client-0 is in G-3
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-4
cnt=[3, 1, 2, 1, 4, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.1061 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 1.3152 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.0690 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8534 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9026 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.2334 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.0617 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.2527 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 2.0249 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.0173 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.9116 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.9629 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9756 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1247 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8119 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 1.0157 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.9292 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.0365 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 1.1838 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.2467 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 2.0279 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8315 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.7947 | Val  Acc: 0.9020
 Site-Sketch    | Val  Loss: 1.2934 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7646
Aggregated Acc | Val Acc: 0.6761
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-4
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[2, 5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9961 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.1148 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9961 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.8483 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9958 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.0019 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 1.0568 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.2945 | Train Acc: 0.7045
 Site-QuickDraw | Train Loss: 2.0199 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.9465 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.8650 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.0389 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.9085 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 1.0517 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.8387 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9720 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.9426 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.1427 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.1139 | Val  Acc: 0.7895
 Site-Painting  | Val  Loss: 1.2813 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 2.0231 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8044 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.7629 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.3549 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7620
Aggregated Acc | Val Acc: 0.6617
============ Train epoch 24 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[1, 1, 3, 5, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 1.0013 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9950 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.9634 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7713 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.9616 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.0988 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 0.9988 | Train Acc: 0.7586
 Site-Painting  | Train Loss: 1.2866 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 2.0050 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.8624 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.8204 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.8061 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9052 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0802 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.8287 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9556 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 2.0685 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.0969 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 1.0551 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.2291 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.9803 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8202 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.8095 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.3728 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7586
Aggregated Acc | Val Acc: 0.7053
============ Train epoch 25 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-5
cnt=[1, 3, 1, 2, 3, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9882 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8912 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9485 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.8053 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.9158 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.1368 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.0236 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.2382 | Train Acc: 0.6818
 Site-QuickDraw | Train Loss: 2.0115 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.8658 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.8246 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.0391 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8763 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0985 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7461 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9831 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 2.0877 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9284 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 1.0509 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.3613 | Val  Acc: 0.6897
 Site-QuickDraw | Val  Loss: 2.0267 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 0.8078 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.7517 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.3092 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7368
Aggregated Acc | Val Acc: 0.6303
============ Train epoch 26 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-4
client-4 is in G-3
client-5 is in G-2
client-6 is in G-5
client-7 is in G-5
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
cnt=[1, 1, 3, 1, 4, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9018 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8903 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9155 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7588 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8588 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.0868 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 1.0992 | Train Acc: 0.6897
 Site-Painting  | Train Loss: 1.2295 | Train Acc: 0.7045
 Site-QuickDraw | Train Loss: 1.8840 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.8827 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7582 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.0947 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.8898 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9950 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7231 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.9331 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.9176 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9815 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 1.0418 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.1831 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 2.0002 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7951 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.7061 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.3065 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7980
Aggregated Acc | Val Acc: 0.7172
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:26 | Val Acc: 0.4000
 Best site-Painting   | Epoch:26 | Val Acc: 0.8889
 Best site-Painting   | Epoch:26 | Val Acc: 0.8947
 Best site-Painting   | Epoch:26 | Val Acc: 0.7931
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.3333
 Best site-Real       | Epoch:26 | Val Acc: 0.9200
 Best site-Real       | Epoch:26 | Val Acc: 0.9804
 Best site-Sketch     | Epoch:26 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
cnt=[1, 6, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9318 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0677 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9555 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.8016 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8869 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.0799 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 1.0734 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 1.1031 | Train Acc: 0.7727
 Site-QuickDraw | Train Loss: 1.9320 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.8791 | Train Acc: 0.8421
 Site-Real      | Train Loss: 0.7561 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 1.1037 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8371 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0162 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7402 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.8409 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 2.0186 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.9748 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.9760 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.1572 | Val  Acc: 0.7586
 Site-QuickDraw | Val  Loss: 2.0328 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7255 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.6789 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.1952 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7785
Aggregated Acc | Val Acc: 0.7579
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-2
client-9 is in G-5
client-10 is in G-5
client-11 is in G-1
cnt=[1, 5, 1, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9047 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8873 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9474 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7508 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.9066 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.9407 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.9540 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 1.0758 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.8673 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.8397 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.7062 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.8775 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8268 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9227 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7127 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8989 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.9906 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.8729 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.9613 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0640 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.9346 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7371 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6483 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.1708 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7766
Aggregated Acc | Val Acc: 0.6870
============ Train epoch 29 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-5
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-1
cnt=[2, 1, 1, 5, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7991 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9369 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.8915 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.7187 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9271 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.0253 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 0.9780 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1741 | Train Acc: 0.7273
 Site-QuickDraw | Train Loss: 1.8594 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.7781 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.7013 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7977 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7996 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9658 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6431 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.8795 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 2.0085 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.8645 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.9456 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.1808 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.9872 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6839 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.6414 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1626 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8106
Aggregated Acc | Val Acc: 0.7753
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:29 | Val Acc: 0.4000
 Best site-Painting   | Epoch:29 | Val Acc: 0.8889
 Best site-Painting   | Epoch:29 | Val Acc: 0.8947
 Best site-Painting   | Epoch:29 | Val Acc: 0.7931
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.4762
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Real       | Epoch:29 | Val Acc: 0.9608
 Best site-Sketch     | Epoch:29 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8251
 Test site-Infograph | Epoch:29 | Test Acc: 0.4049
 Test site-Painting  | Epoch:29 | Test Acc: 0.8061
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.4250
 Test site-Real      | Epoch:29 | Test Acc: 0.8956
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7076
Average Test Accuracy: 0.6774
============ Train epoch 30 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-5
client-3 is in G-5
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 3, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.8110 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8973 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.9124 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.7280 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.7761 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.9873 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.9821 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 1.1243 | Train Acc: 0.7727
 Site-QuickDraw | Train Loss: 1.8711 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.7746 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.7045 | Train Acc: 0.8831
 Site-Sketch    | Train Loss: 0.8448 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8255 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8845 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6642 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.8133 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.9344 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9207 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 0.9869 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 1.0570 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.9850 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6931 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.6202 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.1351 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7777
Aggregated Acc | Val Acc: 0.6982
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[4, 1, 3, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.8467 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9710 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9015 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.7038 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.8259 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8800 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.9610 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.0680 | Train Acc: 0.8182
 Site-QuickDraw | Train Loss: 1.8031 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.6592 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.6529 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.7765 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8709 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8599 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6777 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.8035 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.8266 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8878 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8637 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 1.0106 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 2.0998 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.6578 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.6131 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1696 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7867
Aggregated Acc | Val Acc: 0.6631
============ Train epoch 32 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
cnt=[1, 1, 3, 4, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.8080 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.9389 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8792 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6788 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9301 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9055 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.9322 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.0479 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.8453 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.6479 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6547 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7207 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7594 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8413 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6525 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8372 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.8801 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.9513 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 0.8605 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.0897 | Val  Acc: 0.8621
 Site-QuickDraw | Val  Loss: 2.0348 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6514 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5854 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 1.1279 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7766
Aggregated Acc | Val Acc: 0.6995
============ Train epoch 33 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
cnt=[1, 1, 4, 3, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.9766 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7303 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8310 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.7833 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.7793 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.8155 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.9498 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 1.1140 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 1.7705 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.7274 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.6288 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.8899 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6876 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8869 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6630 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.8046 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.7960 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.8515 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.9162 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 1.0654 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.9841 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6085 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5596 | Val  Acc: 0.9804
 Site-Sketch    | Val  Loss: 1.1836 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7803
Aggregated Acc | Val Acc: 0.6864
============ Train epoch 34 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-3
client-5 is in G-1
client-6 is in G-1
client-7 is in G-5
client-8 is in G-0
client-9 is in G-4
client-10 is in G-4
client-11 is in G-2
cnt=[1, 2, 5, 1, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7912 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0268 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8546 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6664 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.8339 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 0.8420 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8577 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9581 | Train Acc: 0.8182
 Site-QuickDraw | Train Loss: 1.7563 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.7207 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.6813 | Train Acc: 0.9091
 Site-Sketch    | Train Loss: 1.0354 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.8525 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7550 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6069 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7749 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.8857 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9086 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8848 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 1.0837 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.9302 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6460 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5667 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1667 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8084
Aggregated Acc | Val Acc: 0.7404
============ Train epoch 35 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[2, 1, 4, 1, 3, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.8193 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8013 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8457 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.6058 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.7374 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.8096 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.9350 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.9843 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.7952 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.7205 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.6152 | Train Acc: 0.9481
 Site-Sketch    | Train Loss: 0.7479 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7134 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8543 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6330 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7653 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.8363 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8537 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8000 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.0461 | Val  Acc: 0.8621
 Site-QuickDraw | Val  Loss: 1.8600 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.6372 | Val  Acc: 0.9200
 Site-Real      | Val  Loss: 0.5230 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1162 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8033
Aggregated Acc | Val Acc: 0.7075
============ Train epoch 36 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-3
client-6 is in G-3
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[2, 5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.8261 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8992 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7779 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6937 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.7627 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7980 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.9438 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.9779 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 1.8093 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.6170 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6052 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.7298 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6255 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8000 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6550 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7587 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.7352 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.8040 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8180 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 1.0724 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.9695 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5788 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.5164 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.0081 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7925
Aggregated Acc | Val Acc: 0.7107
============ Train epoch 37 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-5
cnt=[4, 1, 1, 2, 3, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7869 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7912 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7799 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6471 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.6829 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.8685 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8347 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9411 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 1.7232 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.5939 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.6166 | Train Acc: 0.9221
 Site-Sketch    | Train Loss: 0.8726 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7222 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8423 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6062 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7576 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.7622 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8464 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.7688 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9370 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.9196 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5926 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.5178 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1342 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8085
Aggregated Acc | Val Acc: 0.7005
============ Train epoch 38 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-5
client-6 is in G-5
client-7 is in G-3
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-0
cnt=[1, 1, 5, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.6996 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.9156 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.8074 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6553 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.7065 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.9111 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7730 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9487 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.7182 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.6977 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5963 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7847 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7019 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7311 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5891 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6938 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.8023 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8089 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8657 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.9147 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.8570 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5836 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4972 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.2125 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8203
Aggregated Acc | Val Acc: 0.7778
 Best site-Clipart    | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:38 | Val Acc: 0.3500
 Best site-Painting   | Epoch:38 | Val Acc: 0.8889
 Best site-Painting   | Epoch:38 | Val Acc: 0.9474
 Best site-Painting   | Epoch:38 | Val Acc: 0.8276
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.4762
 Best site-Real       | Epoch:38 | Val Acc: 1.0000
 Best site-Real       | Epoch:38 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:38 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 39 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
cnt=[5, 1, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7587 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9254 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.8293 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.6020 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.7748 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.7691 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7567 | Train Acc: 0.7931
 Site-Painting  | Train Loss: 0.8856 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.7872 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.7232 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.5636 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7957 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6763 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9906 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5418 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.7605 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.7963 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6783 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8472 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9443 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.7944 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5393 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.5375 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.1572 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8067
Aggregated Acc | Val Acc: 0.7162
============ Train epoch 40 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-5
cnt=[1, 1, 2, 1, 3, 4, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7823 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8566 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.7198 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5941 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.7472 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.7614 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8144 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9269 | Train Acc: 0.8409
 Site-QuickDraw | Train Loss: 1.7367 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.6417 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.5524 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.8000 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6224 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8986 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5605 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7535 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.8432 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7805 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.7377 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9026 | Val  Acc: 0.8966
 Site-QuickDraw | Val  Loss: 1.8492 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5356 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.5433 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1850 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8121
Aggregated Acc | Val Acc: 0.7402
 Test site-Clipart   | Epoch:38 | Test Acc: 0.8555
 Test site-Infograph | Epoch:38 | Test Acc: 0.4231
 Test site-Painting  | Epoch:38 | Test Acc: 0.8255
 Test site-QuickDraw | Epoch:38 | Test Acc: 0.5050
 Test site-Real      | Epoch:38 | Test Acc: 0.9055
 Test site-Sketch    | Epoch:38 | Test Acc: 0.7401
Average Test Accuracy: 0.7091
============ Train epoch 41 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-5
client-6 is in G-5
client-7 is in G-3
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-0
cnt=[5, 1, 1, 1, 2, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.6650 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.9344 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7670 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.6317 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.7050 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7692 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.8187 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.9799 | Train Acc: 0.7500
 Site-QuickDraw | Train Loss: 1.5843 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.6504 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5379 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.6583 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6308 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6888 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6000 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.7002 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.9086 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7447 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.7273 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9434 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.8893 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5689 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.4890 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1135 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8070
Aggregated Acc | Val Acc: 0.7243
 Test site-Clipart   | Epoch:38 | Test Acc: 0.8555
 Test site-Infograph | Epoch:38 | Test Acc: 0.4216
 Test site-Painting  | Epoch:38 | Test Acc: 0.8271
 Test site-QuickDraw | Epoch:38 | Test Acc: 0.5090
 Test site-Real      | Epoch:38 | Test Acc: 0.9063
 Test site-Sketch    | Epoch:38 | Test Acc: 0.7419
Average Test Accuracy: 0.7102
============ Train epoch 42 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-5
cnt=[2, 5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7758 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7845 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7250 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5553 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.7187 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8123 | Train Acc: 0.7857
 Site-Painting  | Train Loss: 0.7067 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8379 | Train Acc: 0.8409
 Site-QuickDraw | Train Loss: 1.6639 | Train Acc: 0.5938
 Site-Real      | Train Loss: 0.6345 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5174 | Train Acc: 0.9870
 Site-Sketch    | Train Loss: 0.9820 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6659 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6798 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5381 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6773 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 1.7628 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7683 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.8029 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9367 | Val  Acc: 0.8966
 Site-QuickDraw | Val  Loss: 1.8520 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5106 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.5101 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1063 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8124
Aggregated Acc | Val Acc: 0.7776
 Test site-Clipart   | Epoch:38 | Test Acc: 0.8555
 Test site-Infograph | Epoch:38 | Test Acc: 0.4277
 Test site-Painting  | Epoch:38 | Test Acc: 0.8288
 Test site-QuickDraw | Epoch:38 | Test Acc: 0.5050
 Test site-Real      | Epoch:38 | Test Acc: 0.9071
 Test site-Sketch    | Epoch:38 | Test Acc: 0.7437
Average Test Accuracy: 0.7113
============ Train epoch 43 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-0
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
cnt=[1, 2, 1, 5, 2, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.6902 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7595 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7428 | Train Acc: 0.9467
 Site-Clipart   | Train Loss: 0.5622 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.6611 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7387 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.7934 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8494 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.6518 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.6740 | Train Acc: 0.8684
 Site-Real      | Train Loss: 0.5206 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 1.0187 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.6566 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8149 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5367 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6870 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.9197 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6878 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.6770 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.9055 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.8808 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5243 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4506 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.1700 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8206
Aggregated Acc | Val Acc: 0.7402
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9104
 Best site-Infograph  | Epoch:43 | Val Acc: 0.3500
 Best site-Painting   | Epoch:43 | Val Acc: 0.8889
 Best site-Painting   | Epoch:43 | Val Acc: 1.0000
 Best site-Painting   | Epoch:43 | Val Acc: 0.8276
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.4762
 Best site-Real       | Epoch:43 | Val Acc: 1.0000
 Best site-Real       | Epoch:43 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:43 | Val Acc: 0.6957
 Test site-Clipart   | Epoch:43 | Test Acc: 0.8555
 Test site-Infograph | Epoch:43 | Test Acc: 0.4277
 Test site-Painting  | Epoch:43 | Test Acc: 0.8304
 Test site-QuickDraw | Epoch:43 | Test Acc: 0.5170
 Test site-Real      | Epoch:43 | Test Acc: 0.9063
 Test site-Sketch    | Epoch:43 | Test Acc: 0.7455
Average Test Accuracy: 0.7137
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[4, 1, 2, 3, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7598 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7443 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6879 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.5886 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.6299 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.7133 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7027 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.9542 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.6248 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.5673 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5645 | Train Acc: 0.8961
 Site-Sketch    | Train Loss: 0.6300 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6001 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6260 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5517 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.6719 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 2.0019 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6951 | Val  Acc: 0.7778
 Site-Painting  | Val  Loss: 0.7535 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.9623 | Val  Acc: 0.7931
 Site-QuickDraw | Val  Loss: 1.8673 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5328 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4568 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.0850 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8011
Aggregated Acc | Val Acc: 0.7395
 Test site-Clipart   | Epoch:43 | Test Acc: 0.8593
 Test site-Infograph | Epoch:43 | Test Acc: 0.4292
 Test site-Painting  | Epoch:43 | Test Acc: 0.8336
 Test site-QuickDraw | Epoch:43 | Test Acc: 0.5200
 Test site-Real      | Epoch:43 | Test Acc: 0.9055
 Test site-Sketch    | Epoch:43 | Test Acc: 0.7455
Average Test Accuracy: 0.7155
============ Train epoch 45 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-4
client-5 is in G-5
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
cnt=[2, 1, 1, 5, 1, 2, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.6809 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.5817 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7488 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5824 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.6323 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.6997 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8226 | Train Acc: 0.8276
 Site-Painting  | Train Loss: 0.8416 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.6312 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.6141 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.5078 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 1.0160 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6718 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6955 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5668 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6727 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.7778 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7312 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6747 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.9205 | Val  Acc: 0.8276
 Site-QuickDraw | Val  Loss: 1.8576 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5236 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.4609 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.0334 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8264
Aggregated Acc | Val Acc: 0.7412
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:45 | Val Acc: 0.4000
 Best site-Painting   | Epoch:45 | Val Acc: 1.0000
 Best site-Painting   | Epoch:45 | Val Acc: 0.8947
 Best site-Painting   | Epoch:45 | Val Acc: 0.8276
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.4286
 Best site-Real       | Epoch:45 | Val Acc: 0.9600
 Best site-Real       | Epoch:45 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7391
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8612
 Test site-Infograph | Epoch:45 | Test Acc: 0.4277
 Test site-Painting  | Epoch:45 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.5240
 Test site-Real      | Epoch:45 | Test Acc: 0.9063
 Test site-Sketch    | Epoch:45 | Test Acc: 0.7491
Average Test Accuracy: 0.7173
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
============ Train epoch 46 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-3
client-8 is in G-4
client-9 is in G-3
client-10 is in G-3
client-11 is in G-5
cnt=[1, 2, 4, 3, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.6724 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7625 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7245 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5734 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.6562 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.6865 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.7938 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8713 | Train Acc: 0.8182
 Site-QuickDraw | Train Loss: 1.6123 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.6225 | Train Acc: 0.8947
 Site-Real      | Train Loss: 0.5048 | Train Acc: 0.9740
 Site-Sketch    | Train Loss: 0.8834 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6515 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8424 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5667 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.6802 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.9074 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6116 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.6521 | Val  Acc: 0.9474
 Site-Painting  | Val  Loss: 0.9577 | Val  Acc: 0.7586
 Site-QuickDraw | Val  Loss: 1.8443 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.4625 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.4564 | Val  Acc: 0.9216
 Site-Sketch    | Val  Loss: 0.9897 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7989
Aggregated Acc | Val Acc: 0.7739
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8574
 Test site-Infograph | Epoch:45 | Test Acc: 0.4262
 Test site-Painting  | Epoch:45 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.5230
 Test site-Real      | Epoch:45 | Test Acc: 0.9088
 Test site-Sketch    | Epoch:45 | Test Acc: 0.7563
Average Test Accuracy: 0.7178
============ Train epoch 47 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-2
client-6 is in G-2
client-7 is in G-1
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-5
cnt=[4, 3, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.7491 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6758 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6842 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5852 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.6456 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.7441 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7844 | Train Acc: 0.8966
 Site-Painting  | Train Loss: 0.7835 | Train Acc: 0.8409
 Site-QuickDraw | Train Loss: 1.5892 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.5328 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.5065 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.9515 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6676 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6014 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5209 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6398 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.8937 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6369 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.6917 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.7748 | Val  Acc: 0.8966
 Site-QuickDraw | Val  Loss: 1.8334 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4536 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4305 | Val  Acc: 0.9608
 Site-Sketch    | Val  Loss: 1.1683 | Val  Acc: 0.5652
Average Valid Accuracy: 0.8012
Aggregated Acc | Val Acc: 0.6829
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8593
 Test site-Infograph | Epoch:45 | Test Acc: 0.4262
 Test site-Painting  | Epoch:45 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.5270
 Test site-Real      | Epoch:45 | Test Acc: 0.9088
 Test site-Sketch    | Epoch:45 | Test Acc: 0.7599
Average Test Accuracy: 0.7194
============ Train epoch 48 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-5
cnt=[1, 1, 3, 1, 2, 4, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.5330 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.6616 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6580 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5610 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.5756 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7752 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.8233 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8298 | Train Acc: 0.7727
 Site-QuickDraw | Train Loss: 1.5406 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.4662 | Train Acc: 0.9474
 Site-Real      | Train Loss: 0.4878 | Train Acc: 0.9610
 Site-Sketch    | Train Loss: 0.6756 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5161 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5874 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5129 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6114 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.7003 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5017 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.6955 | Val  Acc: 0.8421
 Site-Painting  | Val  Loss: 0.8039 | Val  Acc: 0.8966
 Site-QuickDraw | Val  Loss: 1.9209 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4938 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4850 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 0.9874 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8161
Aggregated Acc | Val Acc: 0.7393
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8593
 Test site-Infograph | Epoch:45 | Test Acc: 0.4323
 Test site-Painting  | Epoch:45 | Test Acc: 0.8352
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.5340
 Test site-Real      | Epoch:45 | Test Acc: 0.9113
 Test site-Sketch    | Epoch:45 | Test Acc: 0.7599
Average Test Accuracy: 0.7220
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-3
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
cnt=[2, 1, 1, 3, 2, 3, ]
beta=0.9, beta_c=0.9
use CB, IB for Ea
 Site-Clipart   | Train Loss: 0.5761 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.5968 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6213 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5351 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.4864 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.7070 | Train Acc: 0.9286
 Site-Painting  | Train Loss: 0.7156 | Train Acc: 0.8621
 Site-Painting  | Train Loss: 0.8518 | Train Acc: 0.7955
 Site-QuickDraw | Train Loss: 1.5899 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.6614 | Train Acc: 0.9211
 Site-Real      | Train Loss: 0.4969 | Train Acc: 0.9351
 Site-Sketch    | Train Loss: 0.7272 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5987 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7409 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4537 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6636 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.9210 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7225 | Val  Acc: 0.8889
 Site-Painting  | Val  Loss: 0.6556 | Val  Acc: 0.8947
 Site-Painting  | Val  Loss: 0.8097 | Val  Acc: 0.8966
 Site-QuickDraw | Val  Loss: 1.7397 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4512 | Val  Acc: 0.9600
 Site-Real      | Val  Loss: 0.4093 | Val  Acc: 0.9412
 Site-Sketch    | Val  Loss: 1.0260 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8268
Aggregated Acc | Val Acc: 0.7540
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:49 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:49 | Val Acc: 0.4000
 Best site-Painting   | Epoch:49 | Val Acc: 0.8889
 Best site-Painting   | Epoch:49 | Val Acc: 0.8947
 Best site-Painting   | Epoch:49 | Val Acc: 0.8966
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.5714
 Best site-Real       | Epoch:49 | Val Acc: 0.9600
 Best site-Real       | Epoch:49 | Val Acc: 0.9412
 Best site-Sketch     | Epoch:49 | Val Acc: 0.6957
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8612
 Test site-Infograph | Epoch:49 | Test Acc: 0.4353
 Test site-Painting  | Epoch:49 | Test Acc: 0.8384
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.5370
 Test site-Real      | Epoch:49 | Test Acc: 0.9121
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7599
Average Test Accuracy: 0.7240
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/nova...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8612
 Test site-Infograph | Epoch:49 | Test Acc: 0.4353
 Test site-Painting  | Epoch:49 | Test Acc: 0.8384
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.5370
 Test site-Real      | Epoch:49 | Test Acc: 0.9121
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7599
Average Test Accuracy: 0.7240
===2023-04-19 09:39:11===
===2023-04-19 09:39:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,14,29,44,32,38,77,35,]
label set of clients: [10, 10, 10, 10, 10, 9, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8612
 Test site-Infograph | Epoch:49 | Test Acc: 0.4353
 Test site-Painting  | Epoch:49 | Test Acc: 0.8384
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.5370
 Test site-Real      | Epoch:49 | Test Acc: 0.9121
 Test site-Sketch    | Epoch:49 | Test Acc: 0.7599
Average Test Accuracy: 0.7240
