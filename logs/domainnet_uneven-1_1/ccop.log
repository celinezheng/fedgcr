===2023-04-26 06:31:14===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,63,59,64,48,97,145,53,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-0
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-2
client-7 is in G-1
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[3, 4, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.7130 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.0724 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.4093 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 1.5503 | Train Acc: 0.5208
 Site-Clipart   | Train Loss: 1.2521 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.1481 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 1.9290 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.2766 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.1804 | Train Acc: 0.2344
 Site-Real      | Train Loss: 0.8510 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.6671 | Train Acc: 0.9485
 Site-Real      | Train Loss: 0.7939 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.1629 | Train Acc: 0.7170
 Site-Clipart   | Val  Loss: 1.3891 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.1225 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.0459 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.2498 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.3813 | Val  Acc: 0.5750
 Site-Clipart   | Val  Loss: 1.5541 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9918 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.0778 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1659 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 0.7218 | Val  Acc: 0.9062
 Site-Real      | Val  Loss: 0.6570 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.6311 | Val  Acc: 0.9175
 Site-Sketch    | Val  Loss: 1.4760 | Val  Acc: 0.5143
Average Valid Accuracy: 0.6227
Aggregated Acc | Val Acc: 0.5267
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5750
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3571
 Best site-Painting   | Epoch:0 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-Real       | Epoch:0 | Val Acc: 0.9062
 Best site-Real       | Epoch:0 | Val Acc: 0.9688
 Best site-Real       | Epoch:0 | Val Acc: 0.9175
 Best site-Sketch     | Epoch:0 | Val Acc: 0.5143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-0
client-3 is in G-3
client-4 is in G-0
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[3, 1, 4, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.3207 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.8261 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8451 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 1.1206 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9256 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7558 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.8252 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 0.9566 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 1.9732 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.5361 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.4232 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.3512 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.7019 | Train Acc: 0.8491
 Site-Clipart   | Val  Loss: 0.8107 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7474 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.8404 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 0.9291 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 0.9451 | Val  Acc: 0.7750
 Site-Clipart   | Val  Loss: 1.0805 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.8070 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.7529 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 2.1311 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.3393 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.3522 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.3512 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.2471 | Val  Acc: 0.6857
Average Valid Accuracy: 0.7550
Aggregated Acc | Val Acc: 0.6832
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7917
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7750
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Painting   | Epoch:1 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3095
 Best site-Real       | Epoch:1 | Val Acc: 0.9688
 Best site-Real       | Epoch:1 | Val Acc: 0.9688
 Best site-Real       | Epoch:1 | Val Acc: 0.9691
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-3
client-3 is in G-0
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-5
cnt=[1, 1, 3, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1326 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.6512 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 0.6933 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.0413 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.7090 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.7173 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.5977 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.7429 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 1.6405 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.6060 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.3544 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.2949 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7139 | Train Acc: 0.7736
 Site-Clipart   | Val  Loss: 1.0683 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6475 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.6237 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9193 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 0.9337 | Val  Acc: 0.7750
 Site-Clipart   | Val  Loss: 0.9100 | Val  Acc: 0.7292
 Site-Infograph | Val  Loss: 1.7111 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.7748 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9361 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.2912 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.3086 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.3487 | Val  Acc: 0.9381
 Site-Sketch    | Val  Loss: 1.2543 | Val  Acc: 0.6286
Average Valid Accuracy: 0.7536
Aggregated Acc | Val Acc: 0.7073
============ Train epoch 3 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-0
client-4 is in G-5
client-5 is in G-5
client-6 is in G-1
client-7 is in G-3
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-5
cnt=[1, 4, 1, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9726 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6105 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6712 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.7720 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5935 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5635 | Train Acc: 0.8194
 Site-Infograph | Train Loss: 1.4035 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.6394 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 1.3690 | Train Acc: 0.5781
 Site-Real      | Train Loss: 0.4554 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2657 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.2029 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.5745 | Train Acc: 0.8302
 Site-Clipart   | Val  Loss: 0.6109 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5000 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.5870 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7654 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.6808 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7928 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 1.6566 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5913 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7826 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.1752 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.2316 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.2384 | Val  Acc: 0.9485
 Site-Sketch    | Val  Loss: 1.2485 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8054
Aggregated Acc | Val Acc: 0.7696
 Best site-Clipart    | Epoch:3 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7708
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Painting   | Epoch:3 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4286
 Best site-Real       | Epoch:3 | Val Acc: 0.9688
 Best site-Real       | Epoch:3 | Val Acc: 0.9688
 Best site-Real       | Epoch:3 | Val Acc: 0.9485
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-3
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
cnt=[4, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7930 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5227 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5615 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6811 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 0.6394 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.5384 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 1.1595 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.4500 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 1.4718 | Train Acc: 0.5469
 Site-Real      | Train Loss: 0.4655 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2710 | Train Acc: 0.9278
 Site-Real      | Train Loss: 0.2156 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.5602 | Train Acc: 0.8491
 Site-Clipart   | Val  Loss: 0.7588 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.4870 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4313 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.6506 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.6647 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7503 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.5571 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5894 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.8381 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.2829 | Val  Acc: 0.9375
 Site-Real      | Val  Loss: 0.2564 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.2597 | Val  Acc: 0.9381
 Site-Sketch    | Val  Loss: 1.0067 | Val  Acc: 0.7429
Average Valid Accuracy: 0.7869
Aggregated Acc | Val Acc: 0.7029
============ Train epoch 5 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[1, 4, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9822 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.3695 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6554 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.7271 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6191 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.4177 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.1464 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.5277 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 1.2512 | Train Acc: 0.4844
 Site-Real      | Train Loss: 0.3950 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2433 | Train Acc: 0.9485
 Site-Real      | Train Loss: 0.1986 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7576 | Train Acc: 0.8113
 Site-Clipart   | Val  Loss: 0.6875 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.6841 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.3981 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.5520 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.6534 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7120 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.7841 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5730 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.6096 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.2267 | Val  Acc: 0.9375
 Site-Real      | Val  Loss: 0.2026 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.2243 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 1.1403 | Val  Acc: 0.6286
Average Valid Accuracy: 0.7772
Aggregated Acc | Val Acc: 0.6688
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-5
cnt=[2, 4, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8851 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.3569 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4599 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5525 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.4752 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.3496 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.0876 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.4001 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 1.0572 | Train Acc: 0.7031
 Site-Real      | Train Loss: 0.4003 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2424 | Train Acc: 0.9278
 Site-Real      | Train Loss: 0.1662 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.5642 | Train Acc: 0.8679
 Site-Clipart   | Val  Loss: 0.5452 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.3687 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3735 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5453 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.4780 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5715 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.6677 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5154 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.7311 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.1852 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.2411 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.2172 | Val  Acc: 0.9485
 Site-Sketch    | Val  Loss: 0.9649 | Val  Acc: 0.6286
Average Valid Accuracy: 0.7913
Aggregated Acc | Val Acc: 0.6757
============ Train epoch 7 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-5
client-4 is in G-0
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
cnt=[3, 2, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8062 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.4951 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4031 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5953 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4035 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.4378 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 0.9229 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.4607 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 1.0226 | Train Acc: 0.6406
 Site-Real      | Train Loss: 0.3972 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2258 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.1707 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.7822 | Train Acc: 0.8113
 Site-Clipart   | Val  Loss: 0.4983 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4617 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.2917 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.6141 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 0.4825 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7302 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.6995 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5836 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4408 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1667 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1631 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.2002 | Val  Acc: 0.9485
 Site-Sketch    | Val  Loss: 1.0071 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8085
Aggregated Acc | Val Acc: 0.7617
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.4762
 Best site-Real       | Epoch:7 | Val Acc: 0.9688
 Best site-Real       | Epoch:7 | Val Acc: 0.9688
 Best site-Real       | Epoch:7 | Val Acc: 0.9485
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-1
cnt=[2, 5, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7725 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2247 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.6018 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.4935 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.4187 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.2862 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 0.9743 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.4616 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 0.8658 | Train Acc: 0.7812
 Site-Real      | Train Loss: 0.2746 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.1946 | Train Acc: 0.9381
 Site-Real      | Train Loss: 0.1664 | Train Acc: 0.9586
 Site-Sketch    | Train Loss: 0.4628 | Train Acc: 0.9057
 Site-Clipart   | Val  Loss: 0.6156 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3116 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.2560 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.4287 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.4540 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5407 | Val  Acc: 0.8542
 Site-Infograph | Val  Loss: 1.7762 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5246 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4432 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.1476 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1393 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1827 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.6955 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8258
Aggregated Acc | Val Acc: 0.7558
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8542
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5238
 Best site-Painting   | Epoch:8 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.4524
 Best site-Real       | Epoch:8 | Val Acc: 0.9688
 Best site-Real       | Epoch:8 | Val Acc: 0.9688
 Best site-Real       | Epoch:8 | Val Acc: 0.9588
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
cnt=[1, 5, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6362 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2974 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.3830 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.4712 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4375 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.3321 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 0.8256 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.4494 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 1.0012 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3471 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2122 | Train Acc: 0.9485
 Site-Real      | Train Loss: 0.1962 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4150 | Train Acc: 0.8679
 Site-Clipart   | Val  Loss: 0.2685 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2470 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.3688 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.3834 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5380 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7306 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.6075 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4121 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.1294 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1730 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.2242 | Val  Acc: 0.9381
 Site-Sketch    | Val  Loss: 1.0661 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8519
Aggregated Acc | Val Acc: 0.8117
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9062
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5476
 Best site-Painting   | Epoch:9 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5238
 Best site-Real       | Epoch:9 | Val Acc: 0.9688
 Best site-Real       | Epoch:9 | Val Acc: 0.9531
 Best site-Real       | Epoch:9 | Val Acc: 0.9381
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8403
 Test site-Infograph | Epoch:9 | Test Acc: 0.4916
 Test site-Painting  | Epoch:9 | Test Acc: 0.8546
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.5950
 Test site-Real      | Epoch:9 | Test Acc: 0.9277
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7834
Average Test Accuracy: 0.7488
============ Train epoch 10 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-2
cnt=[3, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4594 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3130 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2378 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.4081 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.3238 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.3365 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 0.7496 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.3613 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 0.8891 | Train Acc: 0.6562
 Site-Real      | Train Loss: 0.2863 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2028 | Train Acc: 0.9278
 Site-Real      | Train Loss: 0.1257 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.6392 | Train Acc: 0.8302
 Site-Clipart   | Val  Loss: 0.4014 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2625 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.2246 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.4970 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.4173 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.4771 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.9065 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.4251 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5567 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.1137 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1455 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1711 | Val  Acc: 0.9485
 Site-Sketch    | Val  Loss: 0.8542 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8271
Aggregated Acc | Val Acc: 0.7434
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-4
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-5
client-7 is in G-0
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[4, 3, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4297 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1919 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3629 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4442 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4081 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.2550 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 0.6422 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.3465 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.7116 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.2577 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1973 | Train Acc: 0.9485
 Site-Real      | Train Loss: 0.4619 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.4369 | Train Acc: 0.8491
 Site-Clipart   | Val  Loss: 0.4722 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.2565 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1998 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4013 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.3295 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5856 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.7303 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.4804 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4083 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.1501 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1777 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1708 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.9310 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8279
Aggregated Acc | Val Acc: 0.7629
============ Train epoch 12 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-3
cnt=[2, 4, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9809 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2264 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.3185 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4522 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.2263 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.2192 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 0.6637 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3454 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.7374 | Train Acc: 0.7812
 Site-Real      | Train Loss: 0.2407 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1493 | Train Acc: 0.9278
 Site-Real      | Train Loss: 0.1232 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.5015 | Train Acc: 0.9057
 Site-Clipart   | Val  Loss: 0.4087 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1967 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.2336 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.3832 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.3262 | Val  Acc: 0.9250
 Site-Clipart   | Val  Loss: 0.3983 | Val  Acc: 0.8542
 Site-Infograph | Val  Loss: 1.7959 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5296 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4187 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.1096 | Val  Acc: 0.9375
 Site-Real      | Val  Loss: 0.0982 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1360 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.9107 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8401
Aggregated Acc | Val Acc: 0.7659
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[3, 1, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4501 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1855 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2956 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2842 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2703 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.2408 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 0.6541 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3608 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 0.7343 | Train Acc: 0.7188
 Site-Real      | Train Loss: 0.2095 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1110 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0749 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.3413 | Train Acc: 0.8868
 Site-Clipart   | Val  Loss: 0.2595 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1092 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1797 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.3247 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.3488 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.3566 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 1.6442 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5114 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.6877 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1258 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1182 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.7757 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8369
Aggregated Acc | Val Acc: 0.7790
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-5
client-4 is in G-0
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-4
cnt=[5, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5922 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2669 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4311 | Train Acc: 0.8611
 Site-Clipart   | Train Loss: 0.4310 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3140 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.2249 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 0.5479 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.2901 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 0.7954 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.2790 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.3099 | Train Acc: 0.9381
 Site-Real      | Train Loss: 0.0752 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.3436 | Train Acc: 0.8679
 Site-Clipart   | Val  Loss: 0.4853 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.2875 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.2585 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.4130 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4738 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 0.4010 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.8654 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6267 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.3058 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0648 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1175 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1276 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.7492 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8184
Aggregated Acc | Val Acc: 0.7279
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-5
client-6 is in G-4
client-7 is in G-3
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-5
cnt=[1, 1, 1, 4, 1, 5, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5531 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.2778 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4376 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.2845 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2638 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2351 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 0.5339 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.2978 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.7887 | Train Acc: 0.7344
 Site-Real      | Train Loss: 0.2223 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1394 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0741 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.2267 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.3535 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.0985 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2440 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.2512 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.2511 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.3238 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.7703 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.4909 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6663 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0581 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.0985 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1500 | Val  Acc: 0.9381
 Site-Sketch    | Val  Loss: 0.7426 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8529
Aggregated Acc | Val Acc: 0.7778
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9500
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:15 | Val Acc: 0.4286
 Best site-Painting   | Epoch:15 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.5238
 Best site-Real       | Epoch:15 | Val Acc: 0.9688
 Best site-Real       | Epoch:15 | Val Acc: 0.9688
 Best site-Real       | Epoch:15 | Val Acc: 0.9381
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 16 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-3
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-2
cnt=[1, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8665 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 0.1949 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4112 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5132 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.3032 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2148 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 0.4473 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.2390 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.6591 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3451 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1136 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0780 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.3646 | Train Acc: 0.8679
 Site-Clipart   | Val  Loss: 0.5020 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.1203 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1587 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.3469 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3982 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.5363 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.9347 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5992 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.2714 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0667 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1243 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1422 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.7967 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8264
Aggregated Acc | Val Acc: 0.8121
============ Train epoch 17 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-5
client-8 is in G-0
client-9 is in G-3
client-10 is in G-5
client-11 is in G-5
client-12 is in G-4
cnt=[1, 4, 1, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2655 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1754 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1915 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.2526 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2138 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.2301 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 0.4767 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.2585 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.5517 | Train Acc: 0.8281
 Site-Real      | Train Loss: 0.1986 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1219 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0828 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.3872 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.3777 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1116 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2360 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1946 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.3367 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 1.7477 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5194 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.2561 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0877 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1545 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.1117 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.6800 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8561
Aggregated Acc | Val Acc: 0.7943
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8958
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5000
 Best site-Painting   | Epoch:17 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.5952
 Best site-Real       | Epoch:17 | Val Acc: 0.9688
 Best site-Real       | Epoch:17 | Val Acc: 0.9531
 Best site-Real       | Epoch:17 | Val Acc: 0.9588
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 18 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
cnt=[1, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5271 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.2554 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2911 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2608 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1746 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1687 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 0.4499 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.2729 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.4926 | Train Acc: 0.8281
 Site-Real      | Train Loss: 0.2095 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1215 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0958 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.4183 | Train Acc: 0.9623
 Site-Clipart   | Val  Loss: 0.0483 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1075 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1456 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2128 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.2923 | Val  Acc: 0.9250
 Site-Clipart   | Val  Loss: 0.2361 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.7428 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4755 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.2076 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.0798 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1516 | Val  Acc: 0.9531
 Site-Real      | Val  Loss: 0.1251 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.1544 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8563
Aggregated Acc | Val Acc: 0.8007
 Best site-Clipart    | Epoch:18 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9250
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5000
 Best site-Painting   | Epoch:18 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.4762
 Best site-Real       | Epoch:18 | Val Acc: 0.9688
 Best site-Real       | Epoch:18 | Val Acc: 0.9531
 Best site-Real       | Epoch:18 | Val Acc: 0.9691
 Best site-Sketch     | Epoch:18 | Val Acc: 0.7429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-5
cnt=[4, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2999 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.1323 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1967 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.3270 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2299 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1839 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 0.3948 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2703 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.5509 | Train Acc: 0.7969
 Site-Real      | Train Loss: 0.2213 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1215 | Train Acc: 0.9381
 Site-Real      | Train Loss: 0.1289 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.2534 | Train Acc: 0.8868
 Site-Clipart   | Val  Loss: 0.5574 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1874 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1469 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1117 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2510 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.3693 | Val  Acc: 0.8542
 Site-Infograph | Val  Loss: 1.8734 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6247 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4588 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0722 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.0901 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1041 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 1.1711 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8550
Aggregated Acc | Val Acc: 0.7678
============ Train epoch 20 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-2
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
cnt=[1, 5, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2854 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2203 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1846 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2457 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.2119 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.1191 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.4554 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.1912 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.4903 | Train Acc: 0.7969
 Site-Real      | Train Loss: 0.2014 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0696 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0710 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.3595 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.2977 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.0243 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1701 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.2374 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.2098 | Val  Acc: 0.9250
 Site-Clipart   | Val  Loss: 0.2690 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.9216 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6070 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.6301 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0500 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0790 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0915 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.6037 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8661
Aggregated Acc | Val Acc: 0.8041
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9250
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:20 | Val Acc: 0.5000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.5476
 Best site-Real       | Epoch:20 | Val Acc: 1.0000
 Best site-Real       | Epoch:20 | Val Acc: 0.9844
 Best site-Real       | Epoch:20 | Val Acc: 0.9588
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-4
client-3 is in G-4
client-4 is in G-0
client-5 is in G-4
client-6 is in G-0
client-7 is in G-5
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[2, 1, 2, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6321 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.1353 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1578 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.3234 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2573 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1248 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.2798 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2840 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.5435 | Train Acc: 0.7656
 Site-Real      | Train Loss: 0.2806 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.1183 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0632 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.2731 | Train Acc: 0.9057
 Site-Clipart   | Val  Loss: 0.1542 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1177 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1449 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2770 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1832 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2838 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 1.7933 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6088 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.5109 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0624 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.0793 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.8184 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8621
Aggregated Acc | Val Acc: 0.8157
============ Train epoch 22 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-4
client-4 is in G-2
client-5 is in G-2
client-6 is in G-5
client-7 is in G-0
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-2
cnt=[4, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3487 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2698 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1789 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2853 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.1735 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1608 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 0.4046 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.2803 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.6164 | Train Acc: 0.7812
 Site-Real      | Train Loss: 0.1902 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0651 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0586 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.2705 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.0802 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1992 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1373 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1528 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.2852 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 1.7481 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.4290 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8009 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0644 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0920 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0962 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.9060 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8704
Aggregated Acc | Val Acc: 0.8042
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8958
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5476
 Best site-Painting   | Epoch:22 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 0.9844
 Best site-Real       | Epoch:22 | Val Acc: 0.9588
 Best site-Sketch     | Epoch:22 | Val Acc: 0.7429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-5
client-7 is in G-4
client-8 is in G-2
client-9 is in G-0
client-10 is in G-4
client-11 is in G-4
client-12 is in G-1
cnt=[1, 5, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2921 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.1481 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1114 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2603 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1981 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1270 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 0.3221 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.2335 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.4429 | Train Acc: 0.8281
 Site-Real      | Train Loss: 0.2359 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.0770 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0589 | Train Acc: 0.9724
 Site-Sketch    | Train Loss: 0.2526 | Train Acc: 0.9057
 Site-Clipart   | Val  Loss: 0.2097 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1945 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1190 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2333 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1836 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.3047 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.0435 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6457 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.5683 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0505 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1044 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.7226 | Val  Acc: 0.8286
Average Valid Accuracy: 0.8585
Aggregated Acc | Val Acc: 0.7910
============ Train epoch 24 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-5
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[1, 3, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3200 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2026 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2332 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2595 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0891 | Train Acc: 0.9833
 Site-Clipart   | Train Loss: 0.1097 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.4602 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.2618 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.4565 | Train Acc: 0.8438
 Site-Real      | Train Loss: 0.1838 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0653 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0831 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.1477 | Train Acc: 0.9623
 Site-Clipart   | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1939 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1273 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1019 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1854 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2361 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.7460 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5877 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.5974 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1629 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0617 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.7522 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8679
Aggregated Acc | Val Acc: 0.8023
============ Train epoch 25 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-1
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
cnt=[1, 3, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3689 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.2088 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1519 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.3842 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2376 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1279 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 0.2606 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3101 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.3989 | Train Acc: 0.8438
 Site-Real      | Train Loss: 0.2240 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.0807 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0470 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.2155 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.6055 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3439 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1165 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2607 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.2395 | Val  Acc: 0.9250
 Site-Clipart   | Val  Loss: 0.2512 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 1.9270 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5666 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5017 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1483 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1119 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.9496 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8427
Aggregated Acc | Val Acc: 0.7453
============ Train epoch 26 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-4
client-3 is in G-1
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-3
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-5
cnt=[1, 1, 1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3249 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2940 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1870 | Train Acc: 0.8611
 Site-Clipart   | Train Loss: 0.2008 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1692 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1400 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 0.3050 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.1862 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 0.4173 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1585 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1001 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0912 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.1925 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.1015 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1429 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1322 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.3332 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.1638 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2090 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 1.9566 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6275 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.6023 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1055 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1306 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.6525 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8634
Aggregated Acc | Val Acc: 0.7776
============ Train epoch 27 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
cnt=[1, 1, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2772 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1962 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2936 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.2125 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2259 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1695 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 0.3182 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.1839 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.2995 | Train Acc: 0.8906
 Site-Real      | Train Loss: 0.1175 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0727 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0703 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.2278 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.1113 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0416 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1292 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.2474 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.1993 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2358 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 2.1845 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4031 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.5703 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0306 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0174 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0632 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.9773 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8675
Aggregated Acc | Val Acc: 0.8255
============ Train epoch 28 ============
gmm
client-0 is in G-2
client-1 is in G-3
client-2 is in G-3
client-3 is in G-5
client-4 is in G-3
client-5 is in G-3
client-6 is in G-5
client-7 is in G-0
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
cnt=[1, 1, 1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5464 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2140 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1494 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.1651 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1752 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0864 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.2776 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1377 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.2536 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1518 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0758 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0444 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.2393 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.1309 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.0659 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1389 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1872 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.1431 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2360 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 2.1449 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4824 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7190 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1085 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.7839 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8635
Aggregated Acc | Val Acc: 0.8100
============ Train epoch 29 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-4
cnt=[1, 1, 4, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2737 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4078 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1761 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1917 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2096 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1088 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.3144 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.2006 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.3927 | Train Acc: 0.8438
 Site-Real      | Train Loss: 0.2056 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1078 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0452 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.0841 | Train Acc: 0.9623
 Site-Clipart   | Val  Loss: 0.1480 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1300 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1558 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.1429 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1496 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.1504 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 2.0989 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3324 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.6521 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0146 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1436 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1244 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.2653 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8766
Aggregated Acc | Val Acc: 0.7829
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9500
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5000
 Best site-Painting   | Epoch:29 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.5476
 Best site-Real       | Epoch:29 | Val Acc: 1.0000
 Best site-Real       | Epoch:29 | Val Acc: 0.9688
 Best site-Real       | Epoch:29 | Val Acc: 0.9691
 Best site-Sketch     | Epoch:29 | Val Acc: 0.7714
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8555
 Test site-Infograph | Epoch:29 | Test Acc: 0.5084
 Test site-Painting  | Epoch:29 | Test Acc: 0.8611
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.5810
 Test site-Real      | Epoch:29 | Test Acc: 0.9367
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8087
Average Test Accuracy: 0.7586
============ Train epoch 30 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-5
client-7 is in G-2
client-8 is in G-4
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
cnt=[1, 4, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5782 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.0714 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1952 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2936 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1778 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0793 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 0.2476 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1409 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.2357 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1783 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0925 | Train Acc: 0.9485
 Site-Real      | Train Loss: 0.0696 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.2098 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.4107 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1293 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2655 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.2131 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.3512 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 1.9134 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6545 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4417 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1017 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0806 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 0.9584 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8608
Aggregated Acc | Val Acc: 0.7623
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8631
 Test site-Infograph | Epoch:29 | Test Acc: 0.5129
 Test site-Painting  | Epoch:29 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.6070
 Test site-Real      | Epoch:29 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8267
Average Test Accuracy: 0.7699
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-5
cnt=[2, 4, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3431 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0291 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2237 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.1780 | Train Acc: 0.9792
 Site-Clipart   | Train Loss: 0.1529 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0746 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.1838 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1720 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 0.3330 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1791 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0722 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0206 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.1236 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.2694 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.1651 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1065 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2052 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1656 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.1824 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.0419 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6861 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.4124 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0108 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0980 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1184 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.7260 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8607
Aggregated Acc | Val Acc: 0.7691
 Test site-Clipart   | Epoch:30 | Test Acc: 0.8593
 Test site-Infograph | Epoch:30 | Test Acc: 0.4962
 Test site-Painting  | Epoch:30 | Test Acc: 0.8643
 Test site-QuickDraw | Epoch:30 | Test Acc: 0.6240
 Test site-Real      | Epoch:30 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:30 | Test Acc: 0.8123
Average Test Accuracy: 0.7651
============ Train epoch 32 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-3
client-3 is in G-4
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-5
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-2
cnt=[1, 3, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3027 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.0711 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1072 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.1732 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1848 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0934 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.1817 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0966 | Train Acc: 0.9831
 Site-QuickDraw | Train Loss: 0.4036 | Train Acc: 0.8438
 Site-Real      | Train Loss: 0.2183 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0392 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.1706 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.0921 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.1603 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1372 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1786 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1908 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.2050 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5242 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.5346 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0312 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0571 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.7664 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8831
Aggregated Acc | Val Acc: 0.8527
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9375
 Best site-Infograph  | Epoch:32 | Val Acc: 0.5000
 Best site-Painting   | Epoch:32 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.5714
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Real       | Epoch:32 | Val Acc: 0.9844
 Best site-Real       | Epoch:32 | Val Acc: 0.9794
 Best site-Sketch     | Epoch:32 | Val Acc: 0.7429
 Test site-Clipart   | Epoch:32 | Test Acc: 0.8460
 Test site-Infograph | Epoch:32 | Test Acc: 0.5053
 Test site-Painting  | Epoch:32 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:32 | Test Acc: 0.6730
 Test site-Real      | Epoch:32 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:32 | Test Acc: 0.8141
Average Test Accuracy: 0.7727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 33 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[3, 2, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1294 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1340 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1995 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.1552 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1289 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0763 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.2217 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1653 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.3098 | Train Acc: 0.9062
 Site-Real      | Train Loss: 0.1272 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0587 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0371 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.1673 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.1663 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.0698 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1331 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2138 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.1170 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.2712 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 1.9453 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6487 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.0285 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0235 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1078 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0646 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.2050 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8651
Aggregated Acc | Val Acc: 0.8311
 Test site-Clipart   | Epoch:32 | Test Acc: 0.8593
 Test site-Infograph | Epoch:32 | Test Acc: 0.5023
 Test site-Painting  | Epoch:32 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:32 | Test Acc: 0.6510
 Test site-Real      | Epoch:32 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:32 | Test Acc: 0.8213
Average Test Accuracy: 0.7728
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-5
cnt=[2, 1, 3, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2163 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1894 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1846 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.2122 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1596 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0807 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.2780 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.1025 | Train Acc: 0.9831
 Site-QuickDraw | Train Loss: 0.1997 | Train Acc: 0.9688
 Site-Real      | Train Loss: 0.1531 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0690 | Train Acc: 0.9588
 Site-Real      | Train Loss: 0.0411 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.1111 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.0610 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0984 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1261 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1328 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.2286 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 2.1031 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3842 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4143 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0220 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0238 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0677 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.2121 | Val  Acc: 0.8286
Average Valid Accuracy: 0.8850
Aggregated Acc | Val Acc: 0.8498
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9500
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9167
 Best site-Infograph  | Epoch:34 | Val Acc: 0.5238
 Best site-Painting   | Epoch:34 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.5238
 Best site-Real       | Epoch:34 | Val Acc: 1.0000
 Best site-Real       | Epoch:34 | Val Acc: 0.9844
 Best site-Real       | Epoch:34 | Val Acc: 0.9794
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8286
 Test site-Clipart   | Epoch:34 | Test Acc: 0.8517
 Test site-Infograph | Epoch:34 | Test Acc: 0.4962
 Test site-Painting  | Epoch:34 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:34 | Test Acc: 0.6030
 Test site-Real      | Epoch:34 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:34 | Test Acc: 0.8249
Average Test Accuracy: 0.7640
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-4
client-8 is in G-2
client-9 is in G-3
client-10 is in G-4
client-11 is in G-4
client-12 is in G-0
cnt=[3, 1, 1, 1, 3, 4, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1643 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1345 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0291 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1289 | Train Acc: 0.9792
 Site-Clipart   | Train Loss: 0.1288 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1033 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.1793 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0922 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.2434 | Train Acc: 0.9219
 Site-Real      | Train Loss: 0.1306 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0566 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0687 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.1506 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0909 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2546 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1032 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1654 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.2237 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.4424 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.6775 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0826 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0764 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.5683 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8712
Aggregated Acc | Val Acc: 0.8591
 Test site-Clipart   | Epoch:34 | Test Acc: 0.8612
 Test site-Infograph | Epoch:34 | Test Acc: 0.5038
 Test site-Painting  | Epoch:34 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:34 | Test Acc: 0.6000
 Test site-Real      | Epoch:34 | Test Acc: 0.9367
 Test site-Sketch    | Epoch:34 | Test Acc: 0.8177
Average Test Accuracy: 0.7645
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
cnt=[2, 1, 3, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1533 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0938 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1504 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2372 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0787 | Train Acc: 0.9833
 Site-Clipart   | Train Loss: 0.0801 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 0.2724 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.0972 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.3220 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.0966 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0420 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0394 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.1339 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0345 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0853 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2420 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1341 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.2515 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 2.1100 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.2320 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.5154 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0220 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0221 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0287 | Val  Acc: 0.9897
 Site-Sketch    | Val  Loss: 0.7387 | Val  Acc: 0.8000
Average Valid Accuracy: 0.8906
Aggregated Acc | Val Acc: 0.8209
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9167
 Best site-Infograph  | Epoch:36 | Val Acc: 0.5238
 Best site-Painting   | Epoch:36 | Val Acc: 0.8974
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.5952
 Best site-Real       | Epoch:36 | Val Acc: 1.0000
 Best site-Real       | Epoch:36 | Val Acc: 0.9844
 Best site-Real       | Epoch:36 | Val Acc: 0.9897
 Best site-Sketch     | Epoch:36 | Val Acc: 0.8000
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8574
 Test site-Infograph | Epoch:36 | Test Acc: 0.5114
 Test site-Painting  | Epoch:36 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6240
 Test site-Real      | Epoch:36 | Test Acc: 0.9392
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8249
Average Test Accuracy: 0.7699
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 37 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-5
cnt=[2, 4, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1465 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1630 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1414 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.1722 | Train Acc: 0.9792
 Site-Clipart   | Train Loss: 0.1199 | Train Acc: 0.9667
 Site-Clipart   | Train Loss: 0.0880 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.1841 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1255 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.3329 | Train Acc: 0.8906
 Site-Real      | Train Loss: 0.1581 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1163 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0209 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.1310 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.0074 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0968 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1318 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.2733 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1374 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1759 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.2212 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5904 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.4957 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0648 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.3477 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8756
Aggregated Acc | Val Acc: 0.7782
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8517
 Test site-Infograph | Epoch:36 | Test Acc: 0.5084
 Test site-Painting  | Epoch:36 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6400
 Test site-Real      | Epoch:36 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8105
Average Test Accuracy: 0.7687
============ Train epoch 38 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-0
client-4 is in G-4
client-5 is in G-4
client-6 is in G-0
client-7 is in G-5
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[2, 1, 1, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1737 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1916 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1819 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.2278 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1127 | Train Acc: 0.9833
 Site-Clipart   | Train Loss: 0.0752 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.2267 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.0826 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.1599 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1129 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0577 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0214 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.1652 | Train Acc: 0.9245
 Site-Clipart   | Val  Loss: 0.0802 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0784 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1349 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1556 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.1213 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.3738 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5243 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7341 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0620 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.9745 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8799
Aggregated Acc | Val Acc: 0.8413
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8479
 Test site-Infograph | Epoch:36 | Test Acc: 0.4901
 Test site-Painting  | Epoch:36 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6300
 Test site-Real      | Epoch:36 | Test Acc: 0.9384
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8195
Average Test Accuracy: 0.7656
============ Train epoch 39 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-1
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-5
client-11 is in G-5
client-12 is in G-3
cnt=[1, 1, 1, 6, 1, 3, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4499 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.0589 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1289 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.1454 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0802 | Train Acc: 0.9833
 Site-Clipart   | Train Loss: 0.1348 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 0.1781 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1138 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.1884 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1361 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0479 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0727 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.1502 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.0449 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0926 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1220 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.1035 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1045 | Val  Acc: 0.9583
 Site-Infograph | Val  Loss: 1.9040 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5940 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.4002 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0345 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1049 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 0.9721 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8831
Aggregated Acc | Val Acc: 0.8174
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8536
 Test site-Infograph | Epoch:36 | Test Acc: 0.5053
 Test site-Painting  | Epoch:36 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6140
 Test site-Real      | Epoch:36 | Test Acc: 0.9384
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8159
Average Test Accuracy: 0.7658
============ Train epoch 40 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-5
cnt=[1, 4, 1, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2462 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0885 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0656 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.0893 | Train Acc: 0.9792
 Site-Clipart   | Train Loss: 0.1499 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0536 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.1998 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1745 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 0.1941 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1407 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0393 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0449 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1928 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0993 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.3031 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.1372 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.1661 | Val  Acc: 0.9375
 Site-Infograph | Val  Loss: 2.2601 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5318 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.6417 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1156 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0964 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.7067 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8748
Aggregated Acc | Val Acc: 0.8101
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8593
 Test site-Infograph | Epoch:36 | Test Acc: 0.4977
 Test site-Painting  | Epoch:36 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6410
 Test site-Real      | Epoch:36 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8267
Average Test Accuracy: 0.7714
============ Train epoch 41 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-1
cnt=[4, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4072, powerC: 0.5928
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3730 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.0223 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2077 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1369 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1542 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0651 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.1285 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1275 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.1856 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1701 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0570 | Train Acc: 0.9691
 Site-Real      | Train Loss: 0.0403 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.1029 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.1005 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0854 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1155 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.1186 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.0966 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1856 | Val  Acc: 0.9583
 Site-Infograph | Val  Loss: 2.0048 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.3748 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 2.0453 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0966 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0767 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.1011 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8759
Aggregated Acc | Val Acc: 0.8039
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8498
 Test site-Infograph | Epoch:36 | Test Acc: 0.4947
 Test site-Painting  | Epoch:36 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6480
 Test site-Real      | Epoch:36 | Test Acc: 0.9392
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8177
Average Test Accuracy: 0.7695
============ Train epoch 42 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-5
client-11 is in G-5
client-12 is in G-3
cnt=[1, 2, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.4065, powerC: 0.5935
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3234 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0556 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1392 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.1452 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1460 | Train Acc: 0.9667
 Site-Clipart   | Train Loss: 0.0490 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 0.2843 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.1099 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.2422 | Train Acc: 0.9219
 Site-Real      | Train Loss: 0.1176 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0384 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0644 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.1928 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1075 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.3140 | Val  Acc: 0.9062
 Site-Clipart   | Val  Loss: 0.1016 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1218 | Val  Acc: 0.9792
 Site-Infograph | Val  Loss: 2.1531 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3824 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7821 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0816 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0367 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 1.3124 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8800
Aggregated Acc | Val Acc: 0.8146
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8574
 Test site-Infograph | Epoch:36 | Test Acc: 0.4916
 Test site-Painting  | Epoch:36 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6200
 Test site-Real      | Epoch:36 | Test Acc: 0.9384
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8213
Average Test Accuracy: 0.7668
============ Train epoch 43 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-5
client-3 is in G-4
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[1, 4, 1, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.4058, powerC: 0.5942
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1753 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1878 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1386 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.1780 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1095 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0504 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1698 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1259 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.3455 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1278 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0400 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0156 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.1209 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0782 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1039 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.0883 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1445 | Val  Acc: 0.9167
 Site-Infograph | Val  Loss: 2.1040 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.7295 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9363 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0412 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0333 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.2838 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8783
Aggregated Acc | Val Acc: 0.8474
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8479
 Test site-Infograph | Epoch:36 | Test Acc: 0.4886
 Test site-Painting  | Epoch:36 | Test Acc: 0.8643
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6290
 Test site-Real      | Epoch:36 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8231
Average Test Accuracy: 0.7651
============ Train epoch 44 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-4
client-6 is in G-5
client-7 is in G-0
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
cnt=[1, 1, 2, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.4052, powerC: 0.5948
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5082 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.0637 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1820 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.1463 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1051 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1250 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 0.1366 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.0950 | Train Acc: 0.9831
 Site-QuickDraw | Train Loss: 0.2335 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1820 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.0628 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.0214 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0538 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1117 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0879 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.1212 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.0831 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1191 | Val  Acc: 0.9583
 Site-Infograph | Val  Loss: 2.7231 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.5466 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.7483 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1310 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.1121 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.1533 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8771
Aggregated Acc | Val Acc: 0.7911
 Test site-Clipart   | Epoch:36 | Test Acc: 0.8650
 Test site-Infograph | Epoch:36 | Test Acc: 0.4932
 Test site-Painting  | Epoch:36 | Test Acc: 0.8675
 Test site-QuickDraw | Epoch:36 | Test Acc: 0.6590
 Test site-Real      | Epoch:36 | Test Acc: 0.9417
 Test site-Sketch    | Epoch:36 | Test Acc: 0.8267
Average Test Accuracy: 0.7755
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 45 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-0
cnt=[1, 4, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4047, powerC: 0.5953
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1624 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3013 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0536 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.1463 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0962 | Train Acc: 0.9667
 Site-Clipart   | Train Loss: 0.0833 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.1925 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1097 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.1454 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.0949 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0451 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0183 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.0824 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.0145 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0722 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.0516 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0837 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.1873 | Val  Acc: 0.9583
 Site-Infograph | Val  Loss: 2.4803 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 0.7032 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.4741 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0751 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.2509 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8830
Aggregated Acc | Val Acc: 0.7819
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9583
 Best site-Infograph  | Epoch:45 | Val Acc: 0.4524
 Best site-Painting   | Epoch:45 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.5952
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 0.9794
 Best site-Sketch     | Epoch:45 | Val Acc: 0.7143
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8631
 Test site-Infograph | Epoch:45 | Test Acc: 0.4901
 Test site-Painting  | Epoch:45 | Test Acc: 0.8595
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6480
 Test site-Real      | Epoch:45 | Test Acc: 0.9392
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8267
Average Test Accuracy: 0.7711
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-5
cnt=[4, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4042, powerC: 0.5958
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3196 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.0147 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0587 | Train Acc: 0.9444
 Site-Clipart   | Train Loss: 0.1532 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0723 | Train Acc: 0.9833
 Site-Clipart   | Train Loss: 0.0405 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.0997 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1160 | Train Acc: 0.9831
 Site-QuickDraw | Train Loss: 0.1944 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1295 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0377 | Train Acc: 0.9897
 Site-Real      | Train Loss: 0.1041 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.2633 | Train Acc: 0.9623
 Site-Clipart   | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0887 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.1478 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1040 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.0789 | Val  Acc: 0.9792
 Site-Infograph | Val  Loss: 2.3438 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5886 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.1181 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0844 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.1060 | Val  Acc: 0.9794
 Site-Sketch    | Val  Loss: 1.1965 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8944
Aggregated Acc | Val Acc: 0.8130
 Best site-Clipart    | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9583
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9688
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9750
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9792
 Best site-Infograph  | Epoch:46 | Val Acc: 0.5476
 Best site-Painting   | Epoch:46 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.6429
 Best site-Real       | Epoch:46 | Val Acc: 1.0000
 Best site-Real       | Epoch:46 | Val Acc: 0.9844
 Best site-Real       | Epoch:46 | Val Acc: 0.9794
 Best site-Sketch     | Epoch:46 | Val Acc: 0.7714
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8555
 Test site-Infograph | Epoch:46 | Test Acc: 0.4992
 Test site-Painting  | Epoch:46 | Test Acc: 0.8659
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6550
 Test site-Real      | Epoch:46 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8213
Average Test Accuracy: 0.7724
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-2
client-12 is in G-5
cnt=[1, 2, 4, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4038, powerC: 0.5962
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6245 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1112 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0499 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0714 | Train Acc: 0.9792
 Site-Clipart   | Train Loss: 0.0930 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.0585 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.1648 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1661 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.1713 | Train Acc: 0.9531
 Site-Real      | Train Loss: 0.1118 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0467 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0458 | Train Acc: 0.9793
 Site-Sketch    | Train Loss: 0.0186 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0729 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.0795 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.1110 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.0862 | Val  Acc: 0.9583
 Site-Infograph | Val  Loss: 2.3327 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.3912 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 1.3906 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0539 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0867 | Val  Acc: 0.9588
 Site-Sketch    | Val  Loss: 1.1858 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8909
Aggregated Acc | Val Acc: 0.8010
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8612
 Test site-Infograph | Epoch:46 | Test Acc: 0.4916
 Test site-Painting  | Epoch:46 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6200
 Test site-Real      | Epoch:46 | Test Acc: 0.9359
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8213
Average Test Accuracy: 0.7671
============ Train epoch 48 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-5
client-6 is in G-5
client-7 is in G-3
client-8 is in G-4
client-9 is in G-1
client-10 is in G-1
client-11 is in G-1
client-12 is in G-5
cnt=[1, 3, 2, 1, 1, 5, ]
power_decay: 0.9, powerI: 0.4034, powerC: 0.5966
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2359 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.3331 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0776 | Train Acc: 0.9722
 Site-Clipart   | Train Loss: 0.1634 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.1248 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1136 | Train Acc: 0.9583
 Site-Infograph | Train Loss: 0.1002 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.1179 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 0.1054 | Train Acc: 0.9688
 Site-Real      | Train Loss: 0.0919 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0440 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0515 | Train Acc: 0.9862
 Site-Sketch    | Train Loss: 0.0351 | Train Acc: 0.9811
 Site-Clipart   | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0323 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0519 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.0870 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0845 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 2.2391 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5700 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.4068 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.0197 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0805 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0238 | Val  Acc: 0.9897
 Site-Sketch    | Val  Loss: 1.2279 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8841
Aggregated Acc | Val Acc: 0.8615
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8631
 Test site-Infograph | Epoch:46 | Test Acc: 0.4810
 Test site-Painting  | Epoch:46 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6360
 Test site-Real      | Epoch:46 | Test Acc: 0.9392
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8267
Average Test Accuracy: 0.7697
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-4
client-3 is in G-3
client-4 is in G-4
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
cnt=[3, 2, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.4031, powerC: 0.5969
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3001 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.0285 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0490 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1366 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.0970 | Train Acc: 0.9500
 Site-Clipart   | Train Loss: 0.1245 | Train Acc: 0.9722
 Site-Infograph | Train Loss: 0.1956 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.0904 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 0.1516 | Train Acc: 0.9219
 Site-Real      | Train Loss: 0.1076 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.1380 | Train Acc: 0.9794
 Site-Real      | Train Loss: 0.0252 | Train Acc: 0.9931
 Site-Sketch    | Train Loss: 0.0771 | Train Acc: 0.9434
 Site-Clipart   | Val  Loss: 0.0403 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1002 | Val  Acc: 0.9583
 Site-Clipart   | Val  Loss: 0.0985 | Val  Acc: 0.9688
 Site-Clipart   | Val  Loss: 0.0863 | Val  Acc: 0.9750
 Site-Clipart   | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 2.1503 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.4841 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.1945 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.0484 | Val  Acc: 0.9688
 Site-Real      | Val  Loss: 0.0864 | Val  Acc: 0.9844
 Site-Real      | Val  Loss: 0.0731 | Val  Acc: 0.9691
 Site-Sketch    | Val  Loss: 0.9811 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8887
Aggregated Acc | Val Acc: 0.8780
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8555
 Test site-Infograph | Epoch:46 | Test Acc: 0.4825
 Test site-Painting  | Epoch:46 | Test Acc: 0.8756
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6400
 Test site-Real      | Epoch:46 | Test Acc: 0.9384
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8339
Average Test Accuracy: 0.7710
===2023-04-26 08:24:55===
===2023-04-27 02:23:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-0
client-6 is in G-5
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.4413 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 1.9860 | Train Acc: 0.2121
 Site-Clipart   | Train Loss: 2.2519 | Train Acc: 0.0600
 Site-Clipart   | Train Loss: 2.3102 | Train Acc: 0.1791
 Site-Clipart   | Train Loss: 2.2541 | Train Acc: 0.1548
 Site-Infograph | Train Loss: 2.3091 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2097 | Train Acc: 0.1538
 Site-QuickDraw | Train Loss: 2.3008 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.0711 | Train Acc: 0.1897
 Site-Real      | Train Loss: 2.0631 | Train Acc: 0.1897
 Site-Sketch    | Train Loss: 2.1158 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2141 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.3498 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.1755 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.1913 | Val  Acc: 0.1591
 Site-Clipart   | Val  Loss: 2.3183 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.4650 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2424 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.2262 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.9631 | Val  Acc: 0.2105
 Site-Real      | Val  Loss: 2.0838 | Val  Acc: 0.1169
 Site-Sketch    | Val  Loss: 2.0852 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1505
Aggregated Acc | Val Acc: 0.1408
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1591
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1875
 Best site-Real       | Epoch:0 | Val Acc: 0.2105
 Best site-Real       | Epoch:0 | Val Acc: 0.1169
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.1703 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 1.9680 | Train Acc: 0.5455
 Site-Clipart   | Train Loss: 2.1541 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.0605 | Train Acc: 0.3284
 Site-Clipart   | Train Loss: 2.0094 | Train Acc: 0.4405
 Site-Infograph | Train Loss: 2.1905 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9389 | Train Acc: 0.4103
 Site-QuickDraw | Train Loss: 2.2678 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.8815 | Train Acc: 0.6034
 Site-Real      | Train Loss: 1.8479 | Train Acc: 0.6034
 Site-Sketch    | Train Loss: 2.0303 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0482 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.0403 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.9062 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 1.9364 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1271 | Val  Acc: 0.3214
 Site-Infograph | Val  Loss: 2.3456 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 1.9369 | Val  Acc: 0.4231
 Site-QuickDraw | Val  Loss: 2.2264 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 1.7810 | Val  Acc: 0.7105
 Site-Real      | Val  Loss: 1.8733 | Val  Acc: 0.5974
 Site-Sketch    | Val  Loss: 1.8892 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4060
Aggregated Acc | Val Acc: 0.4128
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3214
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0500
 Best site-Painting   | Epoch:1 | Val Acc: 0.4231
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2812
 Best site-Real       | Epoch:1 | Val Acc: 0.7105
 Best site-Real       | Epoch:1 | Val Acc: 0.5974
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.0646 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 1.4482 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 1.8914 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.7781 | Train Acc: 0.4627
 Site-Clipart   | Train Loss: 1.7678 | Train Acc: 0.5476
 Site-Infograph | Train Loss: 2.1929 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.7230 | Train Acc: 0.4615
 Site-QuickDraw | Train Loss: 2.2462 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.5646 | Train Acc: 0.6897
 Site-Real      | Train Loss: 1.5135 | Train Acc: 0.6983
 Site-Sketch    | Train Loss: 1.5634 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7384 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.7056 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5337 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.7382 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9643 | Val  Acc: 0.3393
 Site-Infograph | Val  Loss: 2.2837 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.6023 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2158 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.3713 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.5118 | Val  Acc: 0.7532
 Site-Sketch    | Val  Loss: 1.6221 | Val  Acc: 0.6522
Average Valid Accuracy: 0.4926
Aggregated Acc | Val Acc: 0.4380
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3393
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0938
 Best site-Real       | Epoch:2 | Val Acc: 0.8421
 Best site-Real       | Epoch:2 | Val Acc: 0.7532
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.8087 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3596 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 1.6995 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.6175 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 1.5760 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.1792 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.5474 | Train Acc: 0.6410
 Site-QuickDraw | Train Loss: 2.1783 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3820 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.2427 | Train Acc: 0.8621
 Site-Sketch    | Train Loss: 1.4106 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5132 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.4064 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.2527 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.5403 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7582 | Val  Acc: 0.5179
 Site-Infograph | Val  Loss: 2.1765 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4385 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1706 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 1.1759 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.2698 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.5615 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6284
Aggregated Acc | Val Acc: 0.5689
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5179
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2188
 Best site-Real       | Epoch:3 | Val Acc: 0.8947
 Best site-Real       | Epoch:3 | Val Acc: 0.8312
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.7403 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4768 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.3707 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.5077 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 1.2702 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1263 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.3941 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1088 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.1886 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.0429 | Train Acc: 0.8879
 Site-Sketch    | Train Loss: 1.4482 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.4394 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.3194 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.0875 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.3378 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.6121 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.1984 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.3257 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.1941 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.0130 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.0917 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.3530 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6719
Aggregated Acc | Val Acc: 0.6022
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3000
 Best site-Painting   | Epoch:4 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1250
 Best site-Real       | Epoch:4 | Val Acc: 0.9211
 Best site-Real       | Epoch:4 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.4285 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.0065 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.4884 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2641 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.2099 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.0435 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.2436 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 2.1226 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.0351 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.9468 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.0678 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 1.2417 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.0408 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.9406 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.2780 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.4856 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.0193 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2130 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.1320 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.8719 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.9620 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.2920 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6963
Aggregated Acc | Val Acc: 0.6156
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3438
 Best site-Real       | Epoch:5 | Val Acc: 0.9474
 Best site-Real       | Epoch:5 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[2, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.3345 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8455 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.2710 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1561 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.0171 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9627 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.1660 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 2.0363 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.9151 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.7631 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 0.9564 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 1.1041 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0062 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7980 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1053 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.3111 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.8515 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0149 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.0899 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.7405 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.8346 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.1551 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7504
Aggregated Acc | Val Acc: 0.6615
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2500
 Best site-Real       | Epoch:6 | Val Acc: 0.9737
 Best site-Real       | Epoch:6 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 1, 1, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2134 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.8177 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.0332 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0442 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 0.9095 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.9135 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.0473 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.0271 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.8165 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.6924 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 0.8592 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9603 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.8808 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7357 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0678 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.2399 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.7957 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9662 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.0804 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 0.6524 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.7337 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.0481 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7528
Aggregated Acc | Val Acc: 0.6828
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2188
 Best site-Real       | Epoch:7 | Val Acc: 0.9737
 Best site-Real       | Epoch:7 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-0
client-4 is in G-4
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1765 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.6515 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.3035 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.8601 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 0.8586 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.8328 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9451 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.9469 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8040 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.6632 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.8418 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9589 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7802 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6798 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0056 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.1419 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 1.8990 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9502 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.0072 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.5913 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6860 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.0070 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7644
Aggregated Acc | Val Acc: 0.6911
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Painting   | Epoch:8 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3125
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-5
client-9 is in G-5
client-10 is in G-2
cnt=[1, 3, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1126 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.6773 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.3357 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9285 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.8709 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.8097 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.9325 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.8381 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.7352 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.5785 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 0.6061 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8896 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7128 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8875 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.1299 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 1.8809 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9142 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9575 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.5514 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.6333 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 0.9729 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7624
Aggregated Acc | Val Acc: 0.7133
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8876 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6997 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.0542 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8346 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.7352 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7792 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8386 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7571 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.7108 | Train Acc: 0.8448
 Site-Real      | Train Loss: 0.5703 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 0.8960 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6790 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6655 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5354 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7072 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.9781 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.7905 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8885 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8988 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.4713 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5804 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.0966 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7782
Aggregated Acc | Val Acc: 0.6927
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5000
 Best site-Painting   | Epoch:10 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3750
 Best site-Real       | Epoch:10 | Val Acc: 0.9737
 Best site-Real       | Epoch:10 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8162 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5310 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.9126 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8015 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6836 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.6765 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.9042 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.6685 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.6678 | Train Acc: 0.8448
 Site-Real      | Train Loss: 0.5348 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 0.5829 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.6820 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5489 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5261 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7607 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.9487 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.6023 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8076 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.8136 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.4595 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5398 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9087 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7994
Aggregated Acc | Val Acc: 0.7382
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7679
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4375
 Best site-Real       | Epoch:11 | Val Acc: 0.9737
 Best site-Real       | Epoch:11 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 12 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9844 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5214 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.8703 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0172 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.6578 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7003 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8074 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.5580 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.6146 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.4622 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5579 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.7112 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.5102 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4698 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7158 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.9091 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.6240 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8485 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.7108 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.4453 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5291 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9776 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7910
Aggregated Acc | Val Acc: 0.7392
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-1
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8059 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6262 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6479 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7032 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.6420 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.5365 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7651 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.4903 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5865 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.4319 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4666 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5607 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5311 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4657 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6273 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.9057 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.8052 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6945 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7439 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3969 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4597 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9552 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7988
Aggregated Acc | Val Acc: 0.7490
============ Train epoch 14 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8587 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6168 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6422 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.8211 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6275 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.5393 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.7303 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.4482 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5440 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.4267 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5528 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5543 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4683 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4342 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6578 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.9417 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.6814 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6961 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.5553 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.3786 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4345 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8365 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8219
Aggregated Acc | Val Acc: 0.7618
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:14 | Val Acc: 0.4500
 Best site-Painting   | Epoch:14 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5938
 Best site-Real       | Epoch:14 | Val Acc: 0.9737
 Best site-Real       | Epoch:14 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 1, 1, 3, 4, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9353 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.4932 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.8118 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6682 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5840 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.5330 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7103 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.3838 | Train Acc: 0.7292
 Site-Real      | Train Loss: 0.5355 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3855 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.5227 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4697 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5204 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4295 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6245 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9088 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.7453 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7318 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.4814 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.3458 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4212 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8317 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8158
Aggregated Acc | Val Acc: 0.7946
============ Train epoch 16 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8229 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2975 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.8764 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6238 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5213 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.5595 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7297 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3410 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.4625 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.3519 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4517 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5978 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3864 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4284 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6226 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.7858 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6495 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6383 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5364 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.3216 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4007 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8102 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8082
Aggregated Acc | Val Acc: 0.7328
============ Train epoch 17 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 2, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7137 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5020 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6429 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6874 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5925 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.5451 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6987 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3072 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5024 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.3844 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7934 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.4879 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4064 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4216 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6109 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.7772 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.7183 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6850 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.4465 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2948 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3873 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8160 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8155
Aggregated Acc | Val Acc: 0.7638
============ Train epoch 18 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-2
client-4 is in G-4
client-5 is in G-5
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7991 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3980 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5234 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5840 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.4715 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.4299 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.6366 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2486 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4788 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.3425 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4461 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4715 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4095 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4183 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5769 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.8069 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 1.6568 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6725 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.5080 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2740 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3744 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.8568 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8159
Aggregated Acc | Val Acc: 0.7478
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-0
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7072 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3612 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5595 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5440 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.4366 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3937 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.6058 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2184 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.4369 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.3453 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5098 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3687 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3966 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3705 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5413 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7471 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5105 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6065 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3825 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.3000 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3441 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7346 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8293
Aggregated Acc | Val Acc: 0.7549
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4500
 Best site-Painting   | Epoch:19 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.6250
 Best site-Real       | Epoch:19 | Val Acc: 0.9737
 Best site-Real       | Epoch:19 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:19 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8327
 Test site-Infograph | Epoch:19 | Test Acc: 0.4916
 Test site-Painting  | Epoch:19 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.5720
 Test site-Real      | Epoch:19 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8032
Average Test Accuracy: 0.7510
============ Train epoch 20 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7688 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.4194 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.7429 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4791 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.4209 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.4621 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6115 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.1435 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.4307 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3545 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.3512 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.4814 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3503 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3889 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.5397 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7559 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.5144 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6175 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3886 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2368 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3295 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7269 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8171
Aggregated Acc | Val Acc: 0.7476
============ Train epoch 21 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
cnt=[5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7556 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2584 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.6629 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5307 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.4958 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.3297 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.6068 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.1486 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4278 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3041 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5646 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4484 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3259 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2986 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6035 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6766 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6610 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6225 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3384 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2320 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3207 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 0.8316 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8361
Aggregated Acc | Val Acc: 0.7963
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4500
 Best site-Painting   | Epoch:21 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.6562
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 22 ============
gmm
client-0 is in G-2
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7032 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2660 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5825 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5320 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3966 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.3823 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6295 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0648 | Train Acc: 0.7917
 Site-Real      | Train Loss: 0.4148 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2920 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.6620 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3551 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2953 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3321 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5130 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7109 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6593 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6341 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3608 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.2324 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3084 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6242 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8411
Aggregated Acc | Val Acc: 0.7890
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5000
 Best site-Painting   | Epoch:22 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5938
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7390 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4844 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6964 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5134 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.4847 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3017 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.4787 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.0609 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4494 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.2639 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4166 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4338 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2471 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3624 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5206 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.6693 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6248 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5350 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3268 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2438 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3083 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6574 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8436
Aggregated Acc | Val Acc: 0.7788
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4500
 Best site-Painting   | Epoch:23 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.6250
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 24 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-2
client-4 is in G-5
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
cnt=[1, 3, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7444 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6443 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5965 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6353 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.4209 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.2132 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.5961 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0220 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3902 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2607 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7338 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4294 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3316 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3219 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4965 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6591 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3253 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.5434 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2607 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2003 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2843 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6845 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8546
Aggregated Acc | Val Acc: 0.7827
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:24 | Val Acc: 0.5500
 Best site-Painting   | Epoch:24 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.6562
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Real       | Epoch:24 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:24 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 3, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6902 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2118 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6092 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4734 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3612 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.2395 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.4938 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.9902 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.4045 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2532 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3289 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3344 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2242 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3129 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5131 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.6843 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5293 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6412 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3258 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.2176 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2764 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6279 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8381
Aggregated Acc | Val Acc: 0.7822
============ Train epoch 26 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-0
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5886 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2764 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5879 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5573 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3953 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1968 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6383 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.9936 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3623 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2241 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3126 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3305 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2578 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2842 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4299 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.6313 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5330 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5042 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2966 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1822 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2709 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.7722 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8427
Aggregated Acc | Val Acc: 0.7520
============ Train epoch 27 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6876 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2663 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6203 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4237 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3302 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1580 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5297 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.9324 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.4118 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2263 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3208 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3292 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2982 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2806 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4876 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6852 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3221 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4054 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.1722 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1821 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2799 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6027 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8409
Aggregated Acc | Val Acc: 0.7830
============ Train epoch 28 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2897 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5945 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5645 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3122 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1041 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5009 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.9853 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3882 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2331 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.5880 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4334 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2338 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2940 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5155 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.7076 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4487 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4609 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1374 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1672 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2622 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6480 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8444
Aggregated Acc | Val Acc: 0.7993
============ Train epoch 29 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7790 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.8292 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4648 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4327 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3114 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1480 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.4835 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.8358 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3899 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2198 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3684 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3474 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3196 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2851 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5269 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6285 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.3923 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4329 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1527 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1613 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2518 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5767 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8363
Aggregated Acc | Val Acc: 0.7713
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7680 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2322 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4998 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4784 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.3037 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.1207 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5962 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.9101 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3534 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2211 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.4884 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2695 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2410 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2924 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4387 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5956 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.6279 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4694 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.2762 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.1930 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2342 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6435 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8549
Aggregated Acc | Val Acc: 0.7927
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:30 | Val Acc: 0.4500
 Best site-Painting   | Epoch:30 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.5625
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Real       | Epoch:30 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 31 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6223 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1988 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4934 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4862 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3385 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1052 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5659 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7716 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3199 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2349 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3740 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3431 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3250 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2196 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4223 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5727 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.4937 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4362 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1749 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 0.1781 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2520 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.7428 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8677
Aggregated Acc | Val Acc: 0.7973
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:31 | Val Acc: 0.5000
 Best site-Painting   | Epoch:31 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.7500
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 32 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
cnt=[4, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6891 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4835 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7375 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4312 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.0277 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5371 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.9008 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3404 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2276 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3885 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2204 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2931 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2824 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.3852 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.6012 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.6100 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5323 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0975 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1634 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2384 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7137 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8457
Aggregated Acc | Val Acc: 0.7924
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-5
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6381 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2182 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4613 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4009 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3531 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.0793 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.4330 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.8578 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3274 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2024 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4294 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3029 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2501 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2422 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4215 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6395 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.4781 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4919 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.2592 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2244 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2103 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6916 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8311
Aggregated Acc | Val Acc: 0.7481
============ Train epoch 34 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5326 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3285 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5580 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4083 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3148 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0463 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5115 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7538 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3237 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1874 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3341 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2581 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1774 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3008 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4203 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5541 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4157 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5019 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1126 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1673 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2183 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6379 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8429
Aggregated Acc | Val Acc: 0.8048
============ Train epoch 35 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5572 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2277 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4859 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4048 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.2811 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0014 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.4910 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7089 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3210 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2632 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.5139 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2336 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2831 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2843 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.3935 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5642 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5188 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4006 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1442 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1378 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2268 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7523 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8339
Aggregated Acc | Val Acc: 0.7626
============ Train epoch 36 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5064 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2300 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4488 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4811 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.2354 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.0006 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4707 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7492 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3195 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1939 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3259 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2624 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1836 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2467 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5175 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.5488 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3118 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.3820 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0853 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1630 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2107 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6817 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8552
Aggregated Acc | Val Acc: 0.8053
============ Train epoch 37 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 1, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6303 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3078 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4503 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3891 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2684 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9651 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4948 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6860 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3285 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1907 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7380 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2938 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1807 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2447 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3799 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5873 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3136 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4535 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1026 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1375 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2137 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7365 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8503
Aggregated Acc | Val Acc: 0.7748
============ Train epoch 38 ============
gmm
client-0 is in G-4
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-2
client-6 is in G-5
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5618 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1831 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5239 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4082 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2561 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.8686 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.4421 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6659 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2830 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1938 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3433 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2699 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2488 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2326 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4266 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5414 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5773 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5304 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1016 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1340 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2012 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5139 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8480
Aggregated Acc | Val Acc: 0.7933
============ Train epoch 39 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-4
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6507 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1808 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4778 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3866 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2415 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.8721 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.4194 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7219 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2803 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1730 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4035 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2742 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2270 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2401 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3724 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5766 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.3507 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4314 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9646 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1262 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2094 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7575 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8530
Aggregated Acc | Val Acc: 0.7836
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-5
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5231 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2769 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4520 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4177 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3152 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8755 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5055 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6861 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2799 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1642 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3241 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1952 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2133 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3637 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4939 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.3940 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4724 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0461 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1372 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1869 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6761 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8504
Aggregated Acc | Val Acc: 0.8350
 Test site-Clipart   | Epoch:31 | Test Acc: 0.8612
 Test site-Infograph | Epoch:31 | Test Acc: 0.5190
 Test site-Painting  | Epoch:31 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:31 | Test Acc: 0.6380
 Test site-Real      | Epoch:31 | Test Acc: 0.9458
 Test site-Sketch    | Epoch:31 | Test Acc: 0.8249
Average Test Accuracy: 0.7801
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 41 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4072, powerC: 0.5928
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6681 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2088 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5662 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3566 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2566 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.9087 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4983 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6226 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2837 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1955 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4043 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1849 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1978 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2283 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3627 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5434 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.2278 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3842 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0610 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1745 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.5791 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8614
Aggregated Acc | Val Acc: 0.8073
 Test site-Clipart   | Epoch:40 | Test Acc: 0.8631
 Test site-Infograph | Epoch:40 | Test Acc: 0.5205
 Test site-Painting  | Epoch:40 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:40 | Test Acc: 0.6320
 Test site-Real      | Epoch:40 | Test Acc: 0.9449
 Test site-Sketch    | Epoch:40 | Test Acc: 0.8339
Average Test Accuracy: 0.7811
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 42 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[2, 1, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.4065, powerC: 0.5935
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5467 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2188 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4872 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3492 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2987 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8456 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4117 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6480 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.2983 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1522 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2908 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1871 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2035 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3552 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4893 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.4492 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4247 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1147 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1420 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.1796 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5972 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8648
Aggregated Acc | Val Acc: 0.8018
 Test site-Clipart   | Epoch:41 | Test Acc: 0.8593
 Test site-Infograph | Epoch:41 | Test Acc: 0.5266
 Test site-Painting  | Epoch:41 | Test Acc: 0.8950
 Test site-QuickDraw | Epoch:41 | Test Acc: 0.6380
 Test site-Real      | Epoch:41 | Test Acc: 0.9474
 Test site-Sketch    | Epoch:41 | Test Acc: 0.8249
Average Test Accuracy: 0.7819
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
client-10 is in G-0
cnt=[6, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4058, powerC: 0.5942
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5471 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1600 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3588 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3181 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2704 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8005 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.3368 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6685 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2976 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1513 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.2577 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2443 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2171 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1753 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4130 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.4091 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4904 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9429 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1889 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6878 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8509
Aggregated Acc | Val Acc: 0.8149
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8536
 Test site-Infograph | Epoch:42 | Test Acc: 0.5342
 Test site-Painting  | Epoch:42 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6470
 Test site-Real      | Epoch:42 | Test Acc: 0.9466
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8213
Average Test Accuracy: 0.7827
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-1
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4052, powerC: 0.5948
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7057 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2846 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3379 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4126 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2552 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8178 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3668 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6392 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2929 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1707 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4494 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3206 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2115 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1989 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3735 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5201 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5092 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5172 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 0.9474 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1038 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1997 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6709 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8437
Aggregated Acc | Val Acc: 0.7919
 Test site-Clipart   | Epoch:43 | Test Acc: 0.8555
 Test site-Infograph | Epoch:43 | Test Acc: 0.5251
 Test site-Painting  | Epoch:43 | Test Acc: 0.8869
 Test site-QuickDraw | Epoch:43 | Test Acc: 0.6430
 Test site-Real      | Epoch:43 | Test Acc: 0.9441
 Test site-Sketch    | Epoch:43 | Test Acc: 0.8141
Average Test Accuracy: 0.7781
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4047, powerC: 0.5953
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6188 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2041 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4381 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2890 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2335 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.7721 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4078 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6012 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.3221 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1678 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3217 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1834 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2057 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3231 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5004 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4529 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3406 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0058 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1972 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5337 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8802
Aggregated Acc | Val Acc: 0.8143
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:45 | Val Acc: 0.5000
 Best site-Painting   | Epoch:45 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.6875
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:45 | Val Acc: 0.8696
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8498
 Test site-Infograph | Epoch:45 | Test Acc: 0.5160
 Test site-Painting  | Epoch:45 | Test Acc: 0.8885
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6310
 Test site-Real      | Epoch:45 | Test Acc: 0.9425
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8195
Average Test Accuracy: 0.7745
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.4042, powerC: 0.5958
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4609 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4831 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5717 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4076 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.2136 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7750 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4230 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.5217 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2686 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1915 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2878 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2526 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1812 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1827 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4195 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4803 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.2162 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4609 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.0057 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.1045 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1520 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6105 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8639
Aggregated Acc | Val Acc: 0.7909
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8555
 Test site-Infograph | Epoch:45 | Test Acc: 0.5145
 Test site-Painting  | Epoch:45 | Test Acc: 0.8853
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6290
 Test site-Real      | Epoch:45 | Test Acc: 0.9425
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8177
Average Test Accuracy: 0.7741
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-3
client-7 is in G-4
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4038, powerC: 0.5962
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5121 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1981 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4653 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3427 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2157 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7449 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3643 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6165 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2768 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1416 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2565 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1560 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1766 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1727 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2790 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5055 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.3518 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5523 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0515 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0878 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1547 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6515 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8694
Aggregated Acc | Val Acc: 0.8497
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8612
 Test site-Infograph | Epoch:45 | Test Acc: 0.5205
 Test site-Painting  | Epoch:45 | Test Acc: 0.8869
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6350
 Test site-Real      | Epoch:45 | Test Acc: 0.9449
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8267
Average Test Accuracy: 0.7792
============ Train epoch 48 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4034, powerC: 0.5966
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5772 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2120 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4747 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3075 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2238 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.7542 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.4948 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.5248 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2404 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1555 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3082 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1669 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1728 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1241 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3392 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4947 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5872 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5295 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0163 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1067 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1419 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5547 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8576
Aggregated Acc | Val Acc: 0.7912
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8669
 Test site-Infograph | Epoch:45 | Test Acc: 0.5266
 Test site-Painting  | Epoch:45 | Test Acc: 0.8901
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6410
 Test site-Real      | Epoch:45 | Test Acc: 0.9466
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8231
Average Test Accuracy: 0.7824
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4031, powerC: 0.5969
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5954 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4244 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3225 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3534 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2354 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.7203 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3795 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6140 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2734 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1539 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2155 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1489 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1746 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1658 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3066 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5235 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.4191 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.3792 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0361 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1372 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6209 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8762
Aggregated Acc | Val Acc: 0.8188
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8669
 Test site-Infograph | Epoch:45 | Test Acc: 0.5266
 Test site-Painting  | Epoch:45 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6490
 Test site-Real      | Epoch:45 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8669
 Test site-Infograph | Epoch:49 | Test Acc: 0.5266
 Test site-Painting  | Epoch:49 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6490
 Test site-Real      | Epoch:49 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
===2023-04-27 03:25:59===
===2023-04-27 03:26:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8669
 Test site-Infograph | Epoch:49 | Test Acc: 0.5266
 Test site-Painting  | Epoch:49 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6490
 Test site-Real      | Epoch:49 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
===2023-04-27 08:04:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-0
client-6 is in G-5
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.8515 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 0.8605 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.5362 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.4567 | Train Acc: 0.6567
 Site-Clipart   | Train Loss: 1.2853 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.0703 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.2539 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.2368 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.0022 | Train Acc: 0.8276
 Site-Real      | Train Loss: 0.8814 | Train Acc: 0.8707
 Site-Sketch    | Train Loss: 1.2526 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2152 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.1824 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.9056 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.1836 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.5401 | Val  Acc: 0.5357
 Site-Infograph | Val  Loss: 2.4990 | Val  Acc: 0.1000
 Site-Painting  | Val  Loss: 1.1828 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.2253 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 0.7644 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 0.8958 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.0863 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6161
Aggregated Acc | Val Acc: 0.5440
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7045
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5357
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1000
 Best site-Painting   | Epoch:0 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1250
 Best site-Real       | Epoch:0 | Val Acc: 0.9211
 Best site-Real       | Epoch:0 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:0 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.0823 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.6705 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.1804 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.8636 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 0.8021 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.8425 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.8754 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.9814 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6691 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.5529 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 0.9170 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8363 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.6995 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5345 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7296 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9968 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.0802 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8199 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 1.8502 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.4098 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5551 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 0.9770 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7378
Aggregated Acc | Val Acc: 0.7067
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3500
 Best site-Painting   | Epoch:1 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2812
 Best site-Real       | Epoch:1 | Val Acc: 0.9737
 Best site-Real       | Epoch:1 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2033 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.4069 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.9066 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.7015 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.6313 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.8574 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.7724 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7796 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.4074 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.4175 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.5645 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8290 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4330 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6982 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.8892 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.0843 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.6471 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8411 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.2572 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3346 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.7777 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7640
Aggregated Acc | Val Acc: 0.6739
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2812
 Best site-Real       | Epoch:2 | Val Acc: 0.9737
 Best site-Real       | Epoch:2 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:2 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8792 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5520 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7924 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8014 | Train Acc: 0.8060
 Site-Clipart   | Train Loss: 0.6679 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 1.4519 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.8329 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.3609 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.5208 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.4040 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.7963 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7882 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.4982 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3845 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5956 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.8567 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.7637 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5979 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5754 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3398 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3875 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9633 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7656
Aggregated Acc | Val Acc: 0.6979
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:3 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4500
 Best site-Painting   | Epoch:3 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.5000
 Best site-Real       | Epoch:3 | Val Acc: 0.9474
 Best site-Real       | Epoch:3 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1201 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 0.8635 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.8548 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6608 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.4273 | Train Acc: 0.8690
 Site-Infograph | Train Loss: 1.6151 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.7379 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.3336 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.3834 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2072 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 1.1253 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6462 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.4003 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3531 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 0.5523 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.8446 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 2.0834 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.7115 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 1.6100 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.1508 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2305 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8362 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7515
Aggregated Acc | Val Acc: 0.6935
============ Train epoch 5 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-0
client-3 is in G-5
client-4 is in G-4
client-5 is in G-4
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[1, 1, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7870 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2662 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6208 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5138 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.3935 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.3581 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.5852 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2992 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.3674 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2503 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.6199 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5335 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.2770 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3011 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5348 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.6007 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.8067 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.5978 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.5078 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.2157 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2903 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.9246 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7875
Aggregated Acc | Val Acc: 0.7713
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:5 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.5938
 Best site-Real       | Epoch:5 | Val Acc: 0.9737
 Best site-Real       | Epoch:5 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 1, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6257 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2520 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5133 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3853 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.3416 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.2022 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5941 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.0180 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.2864 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1958 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.5016 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3762 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2512 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2040 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3892 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5250 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7759 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.4336 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.2336 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1121 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1933 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8192 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8301
Aggregated Acc | Val Acc: 0.7361
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:6 | Val Acc: 0.3000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.5938
 Best site-Real       | Epoch:6 | Val Acc: 1.0000
 Best site-Real       | Epoch:6 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-3
client-2 is in G-3
client-3 is in G-2
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-0
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
cnt=[1, 1, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8069 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.3509 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3893 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4669 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3336 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.0445 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.5584 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.1732 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.3383 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2018 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4862 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.3470 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2610 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1896 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4793 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5804 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.6856 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4265 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.3458 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.1597 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1881 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.7564 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8328
Aggregated Acc | Val Acc: 0.7644
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.5625
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-5
client-6 is in G-3
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
cnt=[1, 1, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7157 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2058 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5042 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.2691 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2596 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.0768 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.4364 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.8773 | Train Acc: 0.7917
 Site-Real      | Train Loss: 0.2727 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1939 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4133 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.5036 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.3746 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1916 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3818 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.4946 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.2927 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3875 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1066 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0981 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1445 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7379 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8185
Aggregated Acc | Val Acc: 0.7661
============ Train epoch 9 ============
gmm
client-0 is in G-2
client-1 is in G-1
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[1, 1, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5101 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2127 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5591 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3339 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.2847 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 0.8969 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.3401 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.0104 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.3063 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1511 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3887 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.2545 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1424 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1611 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3946 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5168 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.5919 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.7512 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 1.4144 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.0906 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1904 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7668 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8257
Aggregated Acc | Val Acc: 0.7696
============ Train epoch 10 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
cnt=[1, 3, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5257 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3182 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4206 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3107 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2584 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 0.8881 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.3740 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7650 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3367 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.2628 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7903 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3292 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.3141 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1507 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3252 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.4243 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.2331 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5787 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1240 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1542 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.1563 | Val  Acc: 0.6087
Average Valid Accuracy: 0.8168
Aggregated Acc | Val Acc: 0.7333
============ Train epoch 11 ============
gmm
client-0 is in G-3
client-1 is in G-5
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[1, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4362 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2633 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.2260 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1979 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1677 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9592 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.4820 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.7038 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2145 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1235 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.2991 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2329 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1489 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1191 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2569 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3673 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.9100 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5005 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.4076 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0481 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1093 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6507 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8412
Aggregated Acc | Val Acc: 0.8347
 Best site-Clipart    | Epoch:11 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4500
 Best site-Painting   | Epoch:11 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.5000
 Best site-Real       | Epoch:11 | Val Acc: 1.0000
 Best site-Real       | Epoch:11 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 12 ============
gmm
client-0 is in G-2
client-1 is in G-5
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[1, 1, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6019 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1763 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4070 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4386 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1913 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7906 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.2736 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.7511 | Train Acc: 0.7917
 Site-Real      | Train Loss: 0.2358 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1284 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.3853 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.2133 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1573 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1272 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3470 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4275 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.4905 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7349 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 1.1759 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1160 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1175 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6152 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8379
Aggregated Acc | Val Acc: 0.7774
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-5
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-3
cnt=[1, 4, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4910 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2169 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.2152 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2019 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1490 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.5482 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.3401 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6750 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.2568 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.0975 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.2414 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1008 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1696 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0970 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2128 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3926 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.0159 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4592 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 0.9792 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1088 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1085 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7164 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8623
Aggregated Acc | Val Acc: 0.7866
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:13 | Val Acc: 0.3500
 Best site-Painting   | Epoch:13 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.6875
 Best site-Real       | Epoch:13 | Val Acc: 1.0000
 Best site-Real       | Epoch:13 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-0
client-5 is in G-5
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[3, 1, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2880 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.4413 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.2373 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2396 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2006 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.5824 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.2705 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.5359 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1989 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1162 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3175 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1495 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1387 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1203 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2405 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3825 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0290 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4630 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 0.9019 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0846 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0799 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6258 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8621
Aggregated Acc | Val Acc: 0.7877
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-5
client-4 is in G-4
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5018 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5634 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.2501 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2218 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1452 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.5940 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.2905 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.5045 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2100 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.0914 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4221 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1847 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1673 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1058 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2540 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3216 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 2.0708 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6833 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 0.9777 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0733 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1069 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6921 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8471
Aggregated Acc | Val Acc: 0.7946
============ Train epoch 16 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3342 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1329 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.2797 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1898 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2035 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.5802 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.2430 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.5134 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.1641 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.0990 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.2869 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4299 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0904 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2111 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2048 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.8371 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4777 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0286 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0682 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5733 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8563
Aggregated Acc | Val Acc: 0.7804
============ Train epoch 17 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-2
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2783 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1451 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2004 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1553 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0999 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.5404 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.2762 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.5093 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2289 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1138 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.6392 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0878 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1325 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0915 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1907 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2824 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.1921 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3890 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9636 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0809 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.5244 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8601
Aggregated Acc | Val Acc: 0.7745
============ Train epoch 18 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3846 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1635 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1505 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1669 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1135 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.4313 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1906 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.4190 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1851 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0758 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.1216 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1910 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2259 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1184 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2409 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3051 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7933 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6404 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.0563 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0775 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6798 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8613
Aggregated Acc | Val Acc: 0.7940
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-0
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3559 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1237 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1928 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2022 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0884 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.3505 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.1930 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.4863 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.1219 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0774 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2884 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1775 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1844 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0843 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1840 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2902 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.7154 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3963 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 0.9291 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0620 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6789 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8578
Aggregated Acc | Val Acc: 0.7842
============ Train epoch 20 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-5
client-7 is in G-0
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 5, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4068 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1541 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.1425 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1731 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0956 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.5230 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.1794 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.3644 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.1490 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.0658 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.1408 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2879 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3037 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0909 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1694 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2951 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9498 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3606 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1781 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.0576 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0519 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.4269 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8611
Aggregated Acc | Val Acc: 0.7873
============ Train epoch 21 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[1, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3242 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1300 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.1322 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1794 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1434 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.3898 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.1422 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.3919 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.1464 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1089 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.6787 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1913 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2300 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1188 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1918 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3075 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9519 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4945 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1701 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.0581 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0746 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7385 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8441
Aggregated Acc | Val Acc: 0.7784
============ Train epoch 22 ============
gmm
client-0 is in G-2
client-1 is in G-3
client-2 is in G-2
client-3 is in G-3
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-5
client-9 is in G-5
client-10 is in G-2
cnt=[1, 1, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3850 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1251 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2382 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1838 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1159 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.4919 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.2284 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.2986 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1117 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.1013 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0876 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0797 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0388 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0705 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2099 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2487 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.1720 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6518 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 0.9740 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0546 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.4502 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8723
Aggregated Acc | Val Acc: 0.7883
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4000
 Best site-Painting   | Epoch:22 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.6250
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:22 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-1
cnt=[1, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3349 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2391 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.1218 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1145 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0832 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.3044 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.2325 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.3902 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.1631 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0706 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.1320 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1424 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0691 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1485 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2651 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.2912 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5093 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.2258 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0685 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.5571 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8632
Aggregated Acc | Val Acc: 0.7961
============ Train epoch 24 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-3
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
cnt=[1, 3, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1973 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0855 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1759 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1442 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0902 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.3393 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1252 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.3219 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.1223 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0439 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.1892 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0173 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0796 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1418 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2256 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.2552 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4781 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0325 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0217 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0401 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6270 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8656
Aggregated Acc | Val Acc: 0.8089
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3314 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0885 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0984 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1333 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0901 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.2349 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1201 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.3683 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.1047 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0803 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.1920 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0214 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0781 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0633 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1327 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2267 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.9190 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.5459 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1682 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0266 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5694 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8723
Aggregated Acc | Val Acc: 0.7920
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2695 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1470 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.1362 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1313 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0642 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.2205 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.2844 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.1875 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.1535 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0508 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2277 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0441 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0651 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1493 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2149 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.2375 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3364 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.8718 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0247 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0468 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7757 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8782
Aggregated Acc | Val Acc: 0.7934
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:26 | Val Acc: 0.4000
 Best site-Painting   | Epoch:26 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.6875
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Real       | Epoch:26 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:26 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 27 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-5
client-4 is in G-4
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3152 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1286 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0862 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1127 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0580 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2807 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.1671 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.3752 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.0934 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0369 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0656 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1600 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2137 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.7969 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2651 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 0.9114 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0287 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6392 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8821
Aggregated Acc | Val Acc: 0.8719
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:27 | Val Acc: 0.4000
 Best site-Painting   | Epoch:27 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.6562
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 28 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4875 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1185 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1455 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1175 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0401 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2639 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1960 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.2139 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0991 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0543 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2435 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0797 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1198 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0567 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1848 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2215 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.1150 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5146 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1783 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0535 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6579 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8782
Aggregated Acc | Val Acc: 0.7976
============ Train epoch 29 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2298 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1144 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.0981 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0862 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0483 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.2547 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0957 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.2444 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0884 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0435 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.1135 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0674 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1056 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1218 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1785 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.9500 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.2369 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.2083 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0683 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.3702 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8845
Aggregated Acc | Val Acc: 0.8128
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:29 | Val Acc: 0.4500
 Best site-Painting   | Epoch:29 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.6250
 Best site-Real       | Epoch:29 | Val Acc: 1.0000
 Best site-Real       | Epoch:29 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:29 | Val Acc: 0.9130
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8650
 Test site-Infograph | Epoch:29 | Test Acc: 0.4673
 Test site-Painting  | Epoch:29 | Test Acc: 0.8514
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.6040
 Test site-Real      | Epoch:29 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7978
Average Test Accuracy: 0.7529
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-5
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2634 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1078 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.1098 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1029 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0728 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2487 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1936 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.2046 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0965 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1001 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1278 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1940 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.1465 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.2868 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.2595 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0264 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5156 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8814
Aggregated Acc | Val Acc: 0.8176
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8631
 Test site-Infograph | Epoch:29 | Test Acc: 0.4688
 Test site-Painting  | Epoch:29 | Test Acc: 0.8546
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.6000
 Test site-Real      | Epoch:29 | Test Acc: 0.9326
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7942
Average Test Accuracy: 0.7522
============ Train epoch 31 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2421 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0424 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.0566 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1375 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0590 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.1628 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.1089 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.3185 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.0790 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0314 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0889 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.1580 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0798 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0375 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1452 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2134 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 2.0930 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5194 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.5810 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0302 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5405 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8513
Aggregated Acc | Val Acc: 0.7737
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8631
 Test site-Infograph | Epoch:29 | Test Acc: 0.4703
 Test site-Painting  | Epoch:29 | Test Acc: 0.8578
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.6160
 Test site-Real      | Epoch:29 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7996
Average Test Accuracy: 0.7565
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 32 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-4
client-4 is in G-0
client-5 is in G-0
client-6 is in G-5
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
cnt=[5, 2, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3218 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0768 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1506 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1051 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0466 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2160 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.0563 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.2231 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.1043 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0756 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.1523 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0721 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0464 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1065 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1746 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7989 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6450 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1284 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0434 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6429 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8904
Aggregated Acc | Val Acc: 0.8810
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:32 | Val Acc: 0.4500
 Best site-Painting   | Epoch:32 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.6875
 Best site-Real       | Epoch:32 | Val Acc: 0.9737
 Best site-Real       | Epoch:32 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8696
 Test site-Clipart   | Epoch:32 | Test Acc: 0.8669
 Test site-Infograph | Epoch:32 | Test Acc: 0.4688
 Test site-Painting  | Epoch:32 | Test Acc: 0.8562
 Test site-QuickDraw | Epoch:32 | Test Acc: 0.5910
 Test site-Real      | Epoch:32 | Test Acc: 0.9310
 Test site-Sketch    | Epoch:32 | Test Acc: 0.7870
Average Test Accuracy: 0.7502
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-5
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2685 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1009 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0514 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.0928 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0660 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.1829 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0735 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.1676 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.1236 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.0334 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0395 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0758 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0240 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0957 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1937 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.0936 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4332 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 0.8636 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.0076 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0404 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5176 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8716
Aggregated Acc | Val Acc: 0.7919
 Test site-Clipart   | Epoch:32 | Test Acc: 0.8707
 Test site-Infograph | Epoch:32 | Test Acc: 0.4764
 Test site-Painting  | Epoch:32 | Test Acc: 0.8546
 Test site-QuickDraw | Epoch:32 | Test Acc: 0.6200
 Test site-Real      | Epoch:32 | Test Acc: 0.9293
 Test site-Sketch    | Epoch:32 | Test Acc: 0.8141
Average Test Accuracy: 0.7609
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[2, 1, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2910 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0833 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1734 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0795 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0520 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2694 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1222 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.0920 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0721 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0230 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0586 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1099 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1943 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.1735 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6292 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1083 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7050 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8780
Aggregated Acc | Val Acc: 0.8185
 Test site-Clipart   | Epoch:33 | Test Acc: 0.8707
 Test site-Infograph | Epoch:33 | Test Acc: 0.4749
 Test site-Painting  | Epoch:33 | Test Acc: 0.8595
 Test site-QuickDraw | Epoch:33 | Test Acc: 0.6250
 Test site-Real      | Epoch:33 | Test Acc: 0.9293
 Test site-Sketch    | Epoch:33 | Test Acc: 0.8069
Average Test Accuracy: 0.7610
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
cnt=[2, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0928 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1097 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0859 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0490 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1549 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0822 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.1725 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.0847 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0324 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.1820 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0458 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0699 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.0979 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1472 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.8180 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5990 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.2950 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0198 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6558 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8807
Aggregated Acc | Val Acc: 0.8140
 Test site-Clipart   | Epoch:34 | Test Acc: 0.8726
 Test site-Infograph | Epoch:34 | Test Acc: 0.4779
 Test site-Painting  | Epoch:34 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:34 | Test Acc: 0.6160
 Test site-Real      | Epoch:34 | Test Acc: 0.9293
 Test site-Sketch    | Epoch:34 | Test Acc: 0.7888
Average Test Accuracy: 0.7579
============ Train epoch 36 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1691 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0682 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.0532 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0928 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0621 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.1915 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.1271 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.2477 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0720 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0333 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.1004 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0676 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0469 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1144 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1984 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.8287 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5963 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0887 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0186 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3999 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8797
Aggregated Acc | Val Acc: 0.8116
 Test site-Clipart   | Epoch:34 | Test Acc: 0.8688
 Test site-Infograph | Epoch:34 | Test Acc: 0.4627
 Test site-Painting  | Epoch:34 | Test Acc: 0.8546
 Test site-QuickDraw | Epoch:34 | Test Acc: 0.6250
 Test site-Real      | Epoch:34 | Test Acc: 0.9302
 Test site-Sketch    | Epoch:34 | Test Acc: 0.7978
Average Test Accuracy: 0.7565
============ Train epoch 37 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-3
cnt=[1, 1, 1, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2038 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1332 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.0946 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1032 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0685 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1616 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0545 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.1416 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.1085 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0383 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.1115 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1541 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1958 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.2615 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3580 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.8035 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8468 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8771
Aggregated Acc | Val Acc: 0.8169
 Test site-Clipart   | Epoch:34 | Test Acc: 0.8707
 Test site-Infograph | Epoch:34 | Test Acc: 0.4718
 Test site-Painting  | Epoch:34 | Test Acc: 0.8530
 Test site-QuickDraw | Epoch:34 | Test Acc: 0.6620
 Test site-Real      | Epoch:34 | Test Acc: 0.9269
 Test site-Sketch    | Epoch:34 | Test Acc: 0.8123
Average Test Accuracy: 0.7661
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 38 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-5
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2123 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0531 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.0416 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.0860 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0399 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2263 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.1066 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.2248 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0627 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0247 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0510 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0128 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0342 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1106 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1857 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7236 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2271 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0248 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0140 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0160 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7521 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8669
Aggregated Acc | Val Acc: 0.7792
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8593
 Test site-Infograph | Epoch:37 | Test Acc: 0.4581
 Test site-Painting  | Epoch:37 | Test Acc: 0.8562
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.6420
 Test site-Real      | Epoch:37 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8032
Average Test Accuracy: 0.7585
============ Train epoch 39 ============
gmm
client-0 is in G-3
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0684 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0966 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0621 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1046 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0165 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1107 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1129 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.1231 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0936 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0396 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.0907 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0540 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0519 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1360 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1494 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 2.2478 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.5455 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.3417 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0122 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8919 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8585
Aggregated Acc | Val Acc: 0.7849
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8650
 Test site-Infograph | Epoch:37 | Test Acc: 0.4612
 Test site-Painting  | Epoch:37 | Test Acc: 0.8611
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.6530
 Test site-Real      | Epoch:37 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8051
Average Test Accuracy: 0.7629
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-1
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0351 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1083 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.0575 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.0916 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0229 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.1331 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0320 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.1224 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0768 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0525 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.0768 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0408 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0436 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0239 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1056 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1798 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.6401 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6416 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1583 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5967 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8892
Aggregated Acc | Val Acc: 0.8255
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8650
 Test site-Infograph | Epoch:37 | Test Acc: 0.4642
 Test site-Painting  | Epoch:37 | Test Acc: 0.8578
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.6680
 Test site-Real      | Epoch:37 | Test Acc: 0.9326
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8141
Average Test Accuracy: 0.7670
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 41 ============
gmm
client-0 is in G-1
client-1 is in G-3
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 1, 1, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.4072, powerC: 0.5928
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2359 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0841 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0670 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0963 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0515 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.2185 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.1147 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.0774 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0456 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0923 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0113 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0294 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1143 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2438 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.1423 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5909 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.4619 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4253 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8763
Aggregated Acc | Val Acc: 0.8707
 Test site-Clipart   | Epoch:40 | Test Acc: 0.8669
 Test site-Infograph | Epoch:40 | Test Acc: 0.4673
 Test site-Painting  | Epoch:40 | Test Acc: 0.8643
 Test site-QuickDraw | Epoch:40 | Test Acc: 0.6270
 Test site-Real      | Epoch:40 | Test Acc: 0.9334
 Test site-Sketch    | Epoch:40 | Test Acc: 0.8087
Average Test Accuracy: 0.7613
============ Train epoch 42 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4065, powerC: 0.5935
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0724 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0908 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0676 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0884 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0276 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1218 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.1327 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.0922 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.1024 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1232 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0226 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1179 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1879 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.0940 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9731 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 0.9588 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6808 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8714
Aggregated Acc | Val Acc: 0.8204
 Test site-Clipart   | Epoch:40 | Test Acc: 0.8688
 Test site-Infograph | Epoch:40 | Test Acc: 0.4749
 Test site-Painting  | Epoch:40 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:40 | Test Acc: 0.6470
 Test site-Real      | Epoch:40 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:40 | Test Acc: 0.8267
Average Test Accuracy: 0.7692
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-4
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
cnt=[5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4058, powerC: 0.5942
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0723 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0607 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0773 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0810 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0235 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1542 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0363 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.1787 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0541 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0122 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0464 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0091 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0056 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0508 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1046 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1713 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.9883 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4573 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1121 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4721 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8858
Aggregated Acc | Val Acc: 0.8134
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8764
 Test site-Infograph | Epoch:42 | Test Acc: 0.4795
 Test site-Painting  | Epoch:42 | Test Acc: 0.8611
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6470
 Test site-Real      | Epoch:42 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8159
Average Test Accuracy: 0.7692
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-1
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4052, powerC: 0.5948
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1328 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0481 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1295 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0658 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0495 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.1423 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.0376 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.1442 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.0643 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0058 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.1213 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0189 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0840 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1991 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8751 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5472 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 0.9171 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.8337 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8785
Aggregated Acc | Val Acc: 0.8367
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8726
 Test site-Infograph | Epoch:42 | Test Acc: 0.4642
 Test site-Painting  | Epoch:42 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6520
 Test site-Real      | Epoch:42 | Test Acc: 0.9334
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8105
Average Test Accuracy: 0.7659
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 4, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4047, powerC: 0.5953
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.1582 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0520 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.0974 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0229 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.0847 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1038 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.0602 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0855 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0260 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.1089 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0725 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0138 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0812 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2475 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.2094 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3120 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1764 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 1.0757 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8586
Aggregated Acc | Val Acc: 0.7739
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8688
 Test site-Infograph | Epoch:42 | Test Acc: 0.4795
 Test site-Painting  | Epoch:42 | Test Acc: 0.8562
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6420
 Test site-Real      | Epoch:42 | Test Acc: 0.9310
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8123
Average Test Accuracy: 0.7650
============ Train epoch 46 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
cnt=[1, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4042, powerC: 0.5958
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3302 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1116 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.0355 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0642 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0172 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.3244 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.0304 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.1107 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.0964 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0364 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1141 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.0270 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.0963 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1860 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.5644 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7344 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 1.1476 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.0137 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0210 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6167 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8642
Aggregated Acc | Val Acc: 0.7730
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8688
 Test site-Infograph | Epoch:42 | Test Acc: 0.4627
 Test site-Painting  | Epoch:42 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6250
 Test site-Real      | Epoch:42 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8105
Average Test Accuracy: 0.7602
============ Train epoch 47 ============
gmm
client-0 is in G-5
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
cnt=[3, 1, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4038, powerC: 0.5962
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0616 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0956 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1068 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0697 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0361 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.0865 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1167 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 0.1279 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0915 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0275 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0219 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1175 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1142 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2090 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 2.4907 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5936 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.2266 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0098 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7155 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8514
Aggregated Acc | Val Acc: 0.7582
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8688
 Test site-Infograph | Epoch:42 | Test Acc: 0.4673
 Test site-Painting  | Epoch:42 | Test Acc: 0.8546
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6300
 Test site-Real      | Epoch:42 | Test Acc: 0.9326
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8105
Average Test Accuracy: 0.7606
============ Train epoch 48 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4034, powerC: 0.5966
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.2194 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1509 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.0782 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0277 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1019 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0518 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.0759 | Train Acc: 0.9792
 Site-Real      | Train Loss: 0.0747 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0217 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0434 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1017 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1905 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 2.5723 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.9087 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 0.9700 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0212 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.3189 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8679
Aggregated Acc | Val Acc: 0.8007
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8745
 Test site-Infograph | Epoch:42 | Test Acc: 0.4551
 Test site-Painting  | Epoch:42 | Test Acc: 0.8595
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6460
 Test site-Real      | Epoch:42 | Test Acc: 0.9318
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8123
Average Test Accuracy: 0.7632
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4031, powerC: 0.5969
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0696 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0824 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0191 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.1111 | Train Acc: 0.9677
 Site-Painting  | Train Loss: 0.0877 | Train Acc: 0.9744
 Site-QuickDraw | Train Loss: 0.1585 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.0762 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.0856 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0303 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0229 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0899 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1488 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 2.3170 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4549 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3798 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0185 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7631 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8863
Aggregated Acc | Val Acc: 0.8180
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8707
 Test site-Infograph | Epoch:42 | Test Acc: 0.4734
 Test site-Painting  | Epoch:42 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6510
 Test site-Real      | Epoch:42 | Test Acc: 0.9326
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8159
Average Test Accuracy: 0.7677
===2023-04-27 09:38:24===
===2023-04-27 09:38:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8688
 Test site-Infograph | Epoch:42 | Test Acc: 0.4749
 Test site-Painting  | Epoch:42 | Test Acc: 0.8627
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6470
 Test site-Real      | Epoch:42 | Test Acc: 0.9351
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8267
Average Test Accuracy: 0.7692
