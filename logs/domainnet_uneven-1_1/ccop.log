===2023-04-27 02:23:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: True
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-0
client-6 is in G-5
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.4413 | Train Acc: 0.0625
 Site-Clipart   | Train Loss: 1.9860 | Train Acc: 0.2121
 Site-Clipart   | Train Loss: 2.2519 | Train Acc: 0.0600
 Site-Clipart   | Train Loss: 2.3102 | Train Acc: 0.1791
 Site-Clipart   | Train Loss: 2.2541 | Train Acc: 0.1548
 Site-Infograph | Train Loss: 2.3091 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 2.2097 | Train Acc: 0.1538
 Site-QuickDraw | Train Loss: 2.3008 | Train Acc: 0.1458
 Site-Real      | Train Loss: 2.0711 | Train Acc: 0.1897
 Site-Real      | Train Loss: 2.0631 | Train Acc: 0.1897
 Site-Sketch    | Train Loss: 2.1158 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.2141 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.3498 | Val  Acc: 0.1818
 Site-Clipart   | Val  Loss: 2.1755 | Val  Acc: 0.1515
 Site-Clipart   | Val  Loss: 2.1913 | Val  Acc: 0.1591
 Site-Clipart   | Val  Loss: 2.3183 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.4650 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 2.2424 | Val  Acc: 0.0000
 Site-QuickDraw | Val  Loss: 2.2262 | Val  Acc: 0.1875
 Site-Real      | Val  Loss: 1.9631 | Val  Acc: 0.2105
 Site-Real      | Val  Loss: 2.0838 | Val  Acc: 0.1169
 Site-Sketch    | Val  Loss: 2.0852 | Val  Acc: 0.1739
Average Valid Accuracy: 0.1505
Aggregated Acc | Val Acc: 0.1408
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1818
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1515
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1591
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1500
 Best site-Painting   | Epoch:0 | Val Acc: 0.0000
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1875
 Best site-Real       | Epoch:0 | Val Acc: 0.2105
 Best site-Real       | Epoch:0 | Val Acc: 0.1169
 Best site-Sketch     | Epoch:0 | Val Acc: 0.1739
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.1703 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 1.9680 | Train Acc: 0.5455
 Site-Clipart   | Train Loss: 2.1541 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.0605 | Train Acc: 0.3284
 Site-Clipart   | Train Loss: 2.0094 | Train Acc: 0.4405
 Site-Infograph | Train Loss: 2.1905 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.9389 | Train Acc: 0.4103
 Site-QuickDraw | Train Loss: 2.2678 | Train Acc: 0.1458
 Site-Real      | Train Loss: 1.8815 | Train Acc: 0.6034
 Site-Real      | Train Loss: 1.8479 | Train Acc: 0.6034
 Site-Sketch    | Train Loss: 2.0303 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0482 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.0403 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.9062 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 1.9364 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.1271 | Val  Acc: 0.3214
 Site-Infograph | Val  Loss: 2.3456 | Val  Acc: 0.0500
 Site-Painting  | Val  Loss: 1.9369 | Val  Acc: 0.4231
 Site-QuickDraw | Val  Loss: 2.2264 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 1.7810 | Val  Acc: 0.7105
 Site-Real      | Val  Loss: 1.8733 | Val  Acc: 0.5974
 Site-Sketch    | Val  Loss: 1.8892 | Val  Acc: 0.5217
Average Valid Accuracy: 0.4060
Aggregated Acc | Val Acc: 0.4128
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3214
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0500
 Best site-Painting   | Epoch:1 | Val Acc: 0.4231
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2812
 Best site-Real       | Epoch:1 | Val Acc: 0.7105
 Best site-Real       | Epoch:1 | Val Acc: 0.5974
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.0646 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 1.4482 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 1.8914 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.7781 | Train Acc: 0.4627
 Site-Clipart   | Train Loss: 1.7678 | Train Acc: 0.5476
 Site-Infograph | Train Loss: 2.1929 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.7230 | Train Acc: 0.4615
 Site-QuickDraw | Train Loss: 2.2462 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.5646 | Train Acc: 0.6897
 Site-Real      | Train Loss: 1.5135 | Train Acc: 0.6983
 Site-Sketch    | Train Loss: 1.5634 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7384 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.7056 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5337 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.7382 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9643 | Val  Acc: 0.3393
 Site-Infograph | Val  Loss: 2.2837 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.6023 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2158 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.3713 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.5118 | Val  Acc: 0.7532
 Site-Sketch    | Val  Loss: 1.6221 | Val  Acc: 0.6522
Average Valid Accuracy: 0.4926
Aggregated Acc | Val Acc: 0.4380
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3393
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2000
 Best site-Painting   | Epoch:2 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.0938
 Best site-Real       | Epoch:2 | Val Acc: 0.8421
 Best site-Real       | Epoch:2 | Val Acc: 0.7532
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.8087 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3596 | Train Acc: 0.6970
 Site-Clipart   | Train Loss: 1.6995 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.6175 | Train Acc: 0.6119
 Site-Clipart   | Train Loss: 1.5760 | Train Acc: 0.6548
 Site-Infograph | Train Loss: 2.1792 | Train Acc: 0.2581
 Site-Painting  | Train Loss: 1.5474 | Train Acc: 0.6410
 Site-QuickDraw | Train Loss: 2.1783 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3820 | Train Acc: 0.7414
 Site-Real      | Train Loss: 1.2427 | Train Acc: 0.8621
 Site-Sketch    | Train Loss: 1.4106 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5132 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.4064 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.2527 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.5403 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.7582 | Val  Acc: 0.5179
 Site-Infograph | Val  Loss: 2.1765 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.4385 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1706 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 1.1759 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.2698 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.5615 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6284
Aggregated Acc | Val Acc: 0.5689
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5179
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4000
 Best site-Painting   | Epoch:3 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2188
 Best site-Real       | Epoch:3 | Val Acc: 0.8947
 Best site-Real       | Epoch:3 | Val Acc: 0.8312
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.7403 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4768 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.3707 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.5077 | Train Acc: 0.6269
 Site-Clipart   | Train Loss: 1.2702 | Train Acc: 0.7857
 Site-Infograph | Train Loss: 2.1263 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.3941 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1088 | Train Acc: 0.2917
 Site-Real      | Train Loss: 1.1886 | Train Acc: 0.8621
 Site-Real      | Train Loss: 1.0429 | Train Acc: 0.8879
 Site-Sketch    | Train Loss: 1.4482 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.4394 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.3194 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.0875 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.3378 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.6121 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 2.1984 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.3257 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.1941 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.0130 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.0917 | Val  Acc: 0.8961
 Site-Sketch    | Val  Loss: 1.3530 | Val  Acc: 0.7826
Average Valid Accuracy: 0.6719
Aggregated Acc | Val Acc: 0.6022
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3000
 Best site-Painting   | Epoch:4 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1250
 Best site-Real       | Epoch:4 | Val Acc: 0.9211
 Best site-Real       | Epoch:4 | Val Acc: 0.8961
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.4285 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.0065 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.4884 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2641 | Train Acc: 0.7015
 Site-Clipart   | Train Loss: 1.2099 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 2.0435 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.2436 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 2.1226 | Train Acc: 0.2708
 Site-Real      | Train Loss: 1.0351 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.9468 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.0678 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 1.2417 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.0408 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.9406 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.2780 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.4856 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.0193 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.2130 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.1320 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.8719 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.9620 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.2920 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6963
Aggregated Acc | Val Acc: 0.6156
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3000
 Best site-Painting   | Epoch:5 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3438
 Best site-Real       | Epoch:5 | Val Acc: 0.9474
 Best site-Real       | Epoch:5 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[2, 5, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.3345 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8455 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 1.2710 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1561 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 1.0171 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.9627 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.1660 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 2.0363 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.9151 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.7631 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 0.9564 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 1.1041 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0062 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7980 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1053 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.3111 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.8515 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0149 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.0899 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.7405 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.8346 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.1551 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7504
Aggregated Acc | Val Acc: 0.6615
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4000
 Best site-Painting   | Epoch:6 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2500
 Best site-Real       | Epoch:6 | Val Acc: 0.9737
 Best site-Real       | Epoch:6 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:6 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 1, 1, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2134 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.8177 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.0332 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0442 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 0.9095 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.9135 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.0473 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.0271 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.8165 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.6924 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 0.8592 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9603 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.8808 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7357 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0678 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.2399 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.7957 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9662 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.0804 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 0.6524 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.7337 | Val  Acc: 0.9091
 Site-Sketch    | Val  Loss: 1.0481 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7528
Aggregated Acc | Val Acc: 0.6828
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2188
 Best site-Real       | Epoch:7 | Val Acc: 0.9737
 Best site-Real       | Epoch:7 | Val Acc: 0.9091
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-0
client-4 is in G-4
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1765 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.6515 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.3035 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.8601 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 0.8586 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.8328 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9451 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.9469 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8040 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.6632 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.8418 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9589 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7802 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6798 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0056 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.1419 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 1.8990 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9502 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.0072 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.5913 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.6860 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.0070 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7644
Aggregated Acc | Val Acc: 0.6911
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:8 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5000
 Best site-Painting   | Epoch:8 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3125
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-5
client-9 is in G-5
client-10 is in G-2
cnt=[1, 3, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1126 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.6773 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.3357 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9285 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.8709 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.8097 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.9325 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.8381 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.7352 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.5785 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 0.6061 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8896 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7128 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8875 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.1299 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 1.8809 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.9142 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9575 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.5514 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.6333 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 0.9729 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7624
Aggregated Acc | Val Acc: 0.7133
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8876 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6997 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 1.0542 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8346 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.7352 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7792 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8386 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7571 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.7108 | Train Acc: 0.8448
 Site-Real      | Train Loss: 0.5703 | Train Acc: 0.9224
 Site-Sketch    | Train Loss: 0.8960 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6790 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6655 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5354 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7072 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.9781 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.7905 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8885 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8988 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.4713 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5804 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.0966 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7782
Aggregated Acc | Val Acc: 0.6927
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5000
 Best site-Painting   | Epoch:10 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3750
 Best site-Real       | Epoch:10 | Val Acc: 0.9737
 Best site-Real       | Epoch:10 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[4, 1, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8162 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5310 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.9126 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8015 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6836 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.6765 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.9042 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.6685 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.6678 | Train Acc: 0.8448
 Site-Real      | Train Loss: 0.5348 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 0.5829 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.6820 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5489 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5261 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7607 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.9487 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.6023 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8076 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.8136 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.4595 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5398 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9087 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7994
Aggregated Acc | Val Acc: 0.7382
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7679
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5000
 Best site-Painting   | Epoch:11 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4375
 Best site-Real       | Epoch:11 | Val Acc: 0.9737
 Best site-Real       | Epoch:11 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 12 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9844 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5214 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.8703 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0172 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.6578 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.7003 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8074 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.5580 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.6146 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.4622 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5579 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.7112 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 0.5102 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4698 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7158 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.9091 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.6240 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.8485 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.7108 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.4453 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5291 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9776 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7910
Aggregated Acc | Val Acc: 0.7392
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-1
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8059 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6262 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6479 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7032 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.6420 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.5365 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.7651 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.4903 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5865 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.4319 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4666 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5607 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5311 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4657 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6273 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.9057 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.8052 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6945 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7439 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3969 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4597 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.9552 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7988
Aggregated Acc | Val Acc: 0.7490
============ Train epoch 14 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8587 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6168 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6422 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.8211 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6275 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.5393 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.7303 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.4482 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5440 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.4267 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5528 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5543 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4683 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4342 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6578 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.9417 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.6814 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6961 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.5553 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.3786 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4345 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8365 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8219
Aggregated Acc | Val Acc: 0.7618
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:14 | Val Acc: 0.4500
 Best site-Painting   | Epoch:14 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5938
 Best site-Real       | Epoch:14 | Val Acc: 0.9737
 Best site-Real       | Epoch:14 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 1, 1, 3, 4, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9353 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.4932 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.8118 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6682 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5840 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.5330 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7103 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.3838 | Train Acc: 0.7292
 Site-Real      | Train Loss: 0.5355 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3855 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.5227 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4697 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5204 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4295 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6245 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9088 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.7453 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7318 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.4814 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.3458 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4212 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8317 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8158
Aggregated Acc | Val Acc: 0.7946
============ Train epoch 16 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[2, 1, 3, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8229 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2975 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.8764 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6238 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.5213 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.5595 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.7297 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3410 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.4625 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.3519 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4517 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.5978 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3864 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4284 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.6226 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.7858 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6495 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6383 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5364 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.3216 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4007 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8102 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8082
Aggregated Acc | Val Acc: 0.7328
============ Train epoch 17 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 2, 1, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7137 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5020 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6429 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6874 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5925 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.5451 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6987 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3072 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5024 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.3844 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7934 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.4879 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4064 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4216 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6109 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.7772 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.7183 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6850 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.4465 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2948 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3873 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.8160 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8155
Aggregated Acc | Val Acc: 0.7638
============ Train epoch 18 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-2
client-4 is in G-4
client-5 is in G-5
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7991 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3980 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5234 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5840 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.4715 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.4299 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.6366 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2486 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4788 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.3425 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4461 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4715 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4095 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4183 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5769 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 0.8069 | Val  Acc: 0.7321
 Site-Infograph | Val  Loss: 1.6568 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6725 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.5080 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2740 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3744 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.8568 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8159
Aggregated Acc | Val Acc: 0.7478
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-0
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7072 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3612 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5595 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5440 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.4366 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3937 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.6058 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2184 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.4369 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.3453 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5098 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3687 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3966 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3705 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5413 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7471 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5105 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6065 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3825 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.3000 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3441 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7346 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8293
Aggregated Acc | Val Acc: 0.7549
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4500
 Best site-Painting   | Epoch:19 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.6250
 Best site-Real       | Epoch:19 | Val Acc: 0.9737
 Best site-Real       | Epoch:19 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:19 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8327
 Test site-Infograph | Epoch:19 | Test Acc: 0.4916
 Test site-Painting  | Epoch:19 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.5720
 Test site-Real      | Epoch:19 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8032
Average Test Accuracy: 0.7510
============ Train epoch 20 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7688 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.4194 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.7429 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4791 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.4209 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.4621 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6115 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.1435 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.4307 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3545 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.3512 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.4814 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3503 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3889 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.5397 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7559 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.5144 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6175 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3886 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2368 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3295 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7269 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8171
Aggregated Acc | Val Acc: 0.7476
============ Train epoch 21 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
cnt=[5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7556 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2584 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.6629 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5307 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.4958 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.3297 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.6068 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.1486 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4278 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3041 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5646 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4484 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3259 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2986 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6035 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6766 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6610 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6225 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3384 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2320 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3207 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 0.8316 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8361
Aggregated Acc | Val Acc: 0.7963
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4500
 Best site-Painting   | Epoch:21 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.6562
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 22 ============
gmm
client-0 is in G-2
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7032 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2660 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.5825 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5320 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3966 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.3823 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6295 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0648 | Train Acc: 0.7917
 Site-Real      | Train Loss: 0.4148 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2920 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.6620 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3551 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2953 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3321 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5130 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7109 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6593 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6341 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3608 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.2324 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3084 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6242 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8411
Aggregated Acc | Val Acc: 0.7890
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5000
 Best site-Painting   | Epoch:22 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.5938
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7390 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4844 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6964 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5134 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.4847 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3017 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.4787 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.0609 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4494 | Train Acc: 0.8621
 Site-Real      | Train Loss: 0.2639 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4166 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4338 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2471 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3624 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5206 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.6693 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.6248 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5350 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3268 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2438 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.3083 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6574 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8436
Aggregated Acc | Val Acc: 0.7788
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4500
 Best site-Painting   | Epoch:23 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.6250
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 24 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-2
client-4 is in G-5
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
cnt=[1, 3, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7444 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6443 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5965 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6353 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.4209 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.2132 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.5961 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0220 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3902 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2607 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7338 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4294 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3316 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3219 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4965 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6591 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3253 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.5434 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2607 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2003 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2843 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6845 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8546
Aggregated Acc | Val Acc: 0.7827
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:24 | Val Acc: 0.5500
 Best site-Painting   | Epoch:24 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.6562
 Best site-Real       | Epoch:24 | Val Acc: 1.0000
 Best site-Real       | Epoch:24 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:24 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 3, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6902 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2118 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.6092 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4734 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3612 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.2395 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.4938 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.9902 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.4045 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2532 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3289 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3344 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2242 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3129 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5131 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.6843 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5293 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6412 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3258 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.2176 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2764 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6279 | Val  Acc: 0.9130
Average Valid Accuracy: 0.8381
Aggregated Acc | Val Acc: 0.7822
============ Train epoch 26 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-0
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5886 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2764 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5879 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5573 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3953 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1968 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.6383 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.9936 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3623 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2241 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3126 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3305 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2578 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2842 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4299 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.6313 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.5330 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5042 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2966 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1822 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2709 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.7722 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8427
Aggregated Acc | Val Acc: 0.7520
============ Train epoch 27 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6876 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2663 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6203 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4237 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3302 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1580 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5297 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.9324 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.4118 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2263 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3208 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3292 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2982 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2806 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4876 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6852 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3221 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4054 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.1722 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1821 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2799 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6027 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8409
Aggregated Acc | Val Acc: 0.7830
============ Train epoch 28 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2897 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5945 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5645 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3122 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1041 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5009 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.9853 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3882 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.2331 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.5880 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4334 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2338 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2940 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5155 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.7076 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4487 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4609 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1374 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1672 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2622 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6480 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8444
Aggregated Acc | Val Acc: 0.7993
============ Train epoch 29 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7790 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.8292 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4648 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4327 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3114 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1480 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.4835 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.8358 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3899 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2198 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3684 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3474 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3196 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2851 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.5269 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6285 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.3923 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4329 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1527 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1613 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2518 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5767 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8363
Aggregated Acc | Val Acc: 0.7713
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7680 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2322 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4998 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4784 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.3037 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.1207 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5962 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.9101 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.3534 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2211 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.4884 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2695 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2410 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2924 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4387 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5956 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.6279 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4694 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.2762 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.1930 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2342 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6435 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8549
Aggregated Acc | Val Acc: 0.7927
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:30 | Val Acc: 0.4500
 Best site-Painting   | Epoch:30 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.5625
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Real       | Epoch:30 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 31 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6223 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1988 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4934 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4862 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3385 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.1052 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5659 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7716 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3199 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2349 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3740 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3431 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3250 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2196 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4223 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5727 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.4937 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4362 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1749 | Val  Acc: 0.7500
 Site-Real      | Val  Loss: 0.1781 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2520 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.7428 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8677
Aggregated Acc | Val Acc: 0.7973
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:31 | Val Acc: 0.5000
 Best site-Painting   | Epoch:31 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.7500
 Best site-Real       | Epoch:31 | Val Acc: 1.0000
 Best site-Real       | Epoch:31 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 32 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-3
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
cnt=[4, 3, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6891 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4835 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7375 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4312 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.0277 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5371 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.9008 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3404 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2276 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.3885 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2204 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2931 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2824 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.3852 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.6012 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.6100 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5323 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0975 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1634 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2384 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7137 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8457
Aggregated Acc | Val Acc: 0.7924
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-5
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6381 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2182 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4613 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4009 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3531 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.0793 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.4330 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.8578 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3274 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2024 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4294 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3029 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2501 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2422 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4215 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6395 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.4781 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4919 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.2592 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2244 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2103 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 0.6916 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8311
Aggregated Acc | Val Acc: 0.7481
============ Train epoch 34 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5326 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3285 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5580 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4083 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3148 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0463 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5115 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7538 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3237 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1874 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3341 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2581 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1774 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3008 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4203 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5541 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4157 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5019 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1126 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1673 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2183 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6379 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8429
Aggregated Acc | Val Acc: 0.8048
============ Train epoch 35 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5572 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2277 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4859 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4048 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.2811 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.0014 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.4910 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7089 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.3210 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2632 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.5139 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2336 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2831 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2843 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.3935 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5642 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5188 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4006 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1442 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1378 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2268 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7523 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8339
Aggregated Acc | Val Acc: 0.7626
============ Train epoch 36 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5064 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2300 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4488 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4811 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.2354 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.0006 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4707 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7492 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3195 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1939 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3259 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2624 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1836 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2467 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5175 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.5488 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.3118 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.3820 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0853 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1630 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2107 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6817 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8552
Aggregated Acc | Val Acc: 0.8053
============ Train epoch 37 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 1, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6303 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3078 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4503 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3891 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2684 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9651 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4948 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6860 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3285 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1907 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7380 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2938 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1807 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2447 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3799 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5873 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3136 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4535 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1026 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1375 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2137 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 0.7365 | Val  Acc: 0.6522
Average Valid Accuracy: 0.8503
Aggregated Acc | Val Acc: 0.7748
============ Train epoch 38 ============
gmm
client-0 is in G-4
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-2
client-6 is in G-5
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5618 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1831 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5239 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4082 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2561 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.8686 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.4421 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6659 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2830 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1938 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3433 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2699 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2488 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2326 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4266 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.5414 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5773 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5304 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1016 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1340 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2012 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5139 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8480
Aggregated Acc | Val Acc: 0.7933
============ Train epoch 39 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-4
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6507 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1808 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4778 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3866 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2415 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.8721 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.4194 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7219 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2803 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1730 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4035 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2742 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2270 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2401 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3724 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5766 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.3507 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4314 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9646 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1262 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2094 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7575 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8530
Aggregated Acc | Val Acc: 0.7836
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-2
client-2 is in G-5
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5231 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2769 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4520 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4177 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.3152 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8755 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5055 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6861 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2799 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1642 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3241 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1952 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2133 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3637 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4939 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.3940 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4724 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0461 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1372 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1869 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6761 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8504
Aggregated Acc | Val Acc: 0.8350
 Test site-Clipart   | Epoch:31 | Test Acc: 0.8612
 Test site-Infograph | Epoch:31 | Test Acc: 0.5190
 Test site-Painting  | Epoch:31 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:31 | Test Acc: 0.6380
 Test site-Real      | Epoch:31 | Test Acc: 0.9458
 Test site-Sketch    | Epoch:31 | Test Acc: 0.8249
Average Test Accuracy: 0.7801
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 41 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4072, powerC: 0.5928
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6681 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2088 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5662 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3566 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2566 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.9087 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4983 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6226 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2837 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1955 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.4043 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1849 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1978 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2283 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3627 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5434 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.2278 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3842 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0610 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1029 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1745 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.5791 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8614
Aggregated Acc | Val Acc: 0.8073
 Test site-Clipart   | Epoch:40 | Test Acc: 0.8631
 Test site-Infograph | Epoch:40 | Test Acc: 0.5205
 Test site-Painting  | Epoch:40 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:40 | Test Acc: 0.6320
 Test site-Real      | Epoch:40 | Test Acc: 0.9449
 Test site-Sketch    | Epoch:40 | Test Acc: 0.8339
Average Test Accuracy: 0.7811
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 42 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[2, 1, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.4065, powerC: 0.5935
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5467 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2188 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4872 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3492 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2987 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8456 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4117 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.6480 | Train Acc: 0.9583
 Site-Real      | Train Loss: 0.2983 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1522 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2908 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1871 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1506 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2035 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3552 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4893 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.4492 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4247 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1147 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1420 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.1796 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5972 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8648
Aggregated Acc | Val Acc: 0.8018
 Test site-Clipart   | Epoch:41 | Test Acc: 0.8593
 Test site-Infograph | Epoch:41 | Test Acc: 0.5266
 Test site-Painting  | Epoch:41 | Test Acc: 0.8950
 Test site-QuickDraw | Epoch:41 | Test Acc: 0.6380
 Test site-Real      | Epoch:41 | Test Acc: 0.9474
 Test site-Sketch    | Epoch:41 | Test Acc: 0.8249
Average Test Accuracy: 0.7819
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
client-10 is in G-0
cnt=[6, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4058, powerC: 0.5942
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5471 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1600 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3588 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3181 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2704 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8005 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.3368 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6685 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2976 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1513 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.2577 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2443 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2171 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1753 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4130 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.4091 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4904 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 0.9429 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1149 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1889 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6878 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8509
Aggregated Acc | Val Acc: 0.8149
 Test site-Clipart   | Epoch:42 | Test Acc: 0.8536
 Test site-Infograph | Epoch:42 | Test Acc: 0.5342
 Test site-Painting  | Epoch:42 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:42 | Test Acc: 0.6470
 Test site-Real      | Epoch:42 | Test Acc: 0.9466
 Test site-Sketch    | Epoch:42 | Test Acc: 0.8213
Average Test Accuracy: 0.7827
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-1
client-5 is in G-2
client-6 is in G-4
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-1
cnt=[1, 4, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4052, powerC: 0.5948
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7057 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2846 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3379 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4126 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2552 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8178 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3668 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6392 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2929 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1707 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4494 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.3206 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2115 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1989 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3735 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5201 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.5092 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5172 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 0.9474 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1038 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1997 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6709 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8437
Aggregated Acc | Val Acc: 0.7919
 Test site-Clipart   | Epoch:43 | Test Acc: 0.8555
 Test site-Infograph | Epoch:43 | Test Acc: 0.5251
 Test site-Painting  | Epoch:43 | Test Acc: 0.8869
 Test site-QuickDraw | Epoch:43 | Test Acc: 0.6430
 Test site-Real      | Epoch:43 | Test Acc: 0.9441
 Test site-Sketch    | Epoch:43 | Test Acc: 0.8141
Average Test Accuracy: 0.7781
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.4047, powerC: 0.5953
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6188 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2041 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4381 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2890 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2335 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.7721 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4078 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6012 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.3221 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1678 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3217 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1834 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2057 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3231 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5004 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4529 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3406 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0058 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1141 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1972 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.5337 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8802
Aggregated Acc | Val Acc: 0.8143
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:45 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:45 | Val Acc: 0.5000
 Best site-Painting   | Epoch:45 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.6875
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:45 | Val Acc: 0.8696
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8498
 Test site-Infograph | Epoch:45 | Test Acc: 0.5160
 Test site-Painting  | Epoch:45 | Test Acc: 0.8885
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6310
 Test site-Real      | Epoch:45 | Test Acc: 0.9425
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8195
Average Test Accuracy: 0.7745
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.4042, powerC: 0.5958
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4609 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4831 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5717 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4076 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.2136 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7750 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4230 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.5217 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2686 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1915 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2878 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2526 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1812 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1827 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4195 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4803 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.2162 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4609 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.0057 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.1045 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1520 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6105 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8639
Aggregated Acc | Val Acc: 0.7909
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8555
 Test site-Infograph | Epoch:45 | Test Acc: 0.5145
 Test site-Painting  | Epoch:45 | Test Acc: 0.8853
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6290
 Test site-Real      | Epoch:45 | Test Acc: 0.9425
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8177
Average Test Accuracy: 0.7741
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-2
client-6 is in G-3
client-7 is in G-4
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[2, 1, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4038, powerC: 0.5962
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5121 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1981 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4653 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3427 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2157 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7449 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3643 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6165 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2768 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1416 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2565 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1560 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1766 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1727 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2790 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5055 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.3518 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5523 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0515 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.0878 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1547 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6515 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8694
Aggregated Acc | Val Acc: 0.8497
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8612
 Test site-Infograph | Epoch:45 | Test Acc: 0.5205
 Test site-Painting  | Epoch:45 | Test Acc: 0.8869
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6350
 Test site-Real      | Epoch:45 | Test Acc: 0.9449
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8267
Average Test Accuracy: 0.7792
============ Train epoch 48 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4034, powerC: 0.5966
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5772 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2120 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.4747 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3075 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2238 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.7542 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.4948 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.5248 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2404 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1555 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3082 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1669 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1728 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1241 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3392 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4947 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5872 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5295 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0163 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1067 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1419 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5547 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8576
Aggregated Acc | Val Acc: 0.7912
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8669
 Test site-Infograph | Epoch:45 | Test Acc: 0.5266
 Test site-Painting  | Epoch:45 | Test Acc: 0.8901
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6410
 Test site-Real      | Epoch:45 | Test Acc: 0.9466
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8231
Average Test Accuracy: 0.7824
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4031, powerC: 0.5969
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5954 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4244 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3225 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3534 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.2354 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.7203 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3795 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6140 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2734 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1539 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.2155 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.1489 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1746 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1658 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3066 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5235 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.4191 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.3792 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.0361 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1372 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6209 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8762
Aggregated Acc | Val Acc: 0.8188
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8669
 Test site-Infograph | Epoch:45 | Test Acc: 0.5266
 Test site-Painting  | Epoch:45 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6490
 Test site-Real      | Epoch:45 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8669
 Test site-Infograph | Epoch:49 | Test Acc: 0.5266
 Test site-Painting  | Epoch:49 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6490
 Test site-Real      | Epoch:49 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
===2023-04-27 03:25:59===
===2023-04-27 03:26:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.8669
 Test site-Infograph | Epoch:49 | Test Acc: 0.5266
 Test site-Painting  | Epoch:49 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.6490
 Test site-Real      | Epoch:49 | Test Acc: 0.9491
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8213
Average Test Accuracy: 0.7844
===2023-05-03 01:09:40===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-1
client-4 is in G-4
client-5 is in G-0
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 2, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.2319 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2113 | Train Acc: 0.3636
 Site-Clipart   | Train Loss: 2.2143 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0648 | Train Acc: 0.3284
 Site-Clipart   | Train Loss: 2.0564 | Train Acc: 0.3929
 Site-Infograph | Train Loss: 2.2489 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 2.1764 | Train Acc: 0.3333
 Site-QuickDraw | Train Loss: 2.3742 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.0333 | Train Acc: 0.4138
 Site-Real      | Train Loss: 2.1167 | Train Acc: 0.3017
 Site-Sketch    | Train Loss: 2.0903 | Train Acc: 0.2286
 Site-Clipart   | Val  Loss: 2.0348 | Val  Acc: 0.2727
 Site-Clipart   | Val  Loss: 2.0461 | Val  Acc: 0.3182
 Site-Clipart   | Val  Loss: 2.1399 | Val  Acc: 0.2424
 Site-Clipart   | Val  Loss: 2.0607 | Val  Acc: 0.2955
 Site-Clipart   | Val  Loss: 2.1432 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.3992 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 2.2766 | Val  Acc: 0.1154
 Site-QuickDraw | Val  Loss: 2.3584 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 2.1115 | Val  Acc: 0.2895
 Site-Real      | Val  Loss: 2.0874 | Val  Acc: 0.3117
 Site-Sketch    | Val  Loss: 2.0005 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2481
Aggregated Acc | Val Acc: 0.2155
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3182
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2424
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2955
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.1154
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0938
 Best site-Real       | Epoch:0 | Val Acc: 0.2895
 Best site-Real       | Epoch:0 | Val Acc: 0.3117
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-5
client-6 is in G-3
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[5, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 2.0742 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 1.9060 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 2.0890 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.8996 | Train Acc: 0.4478
 Site-Clipart   | Train Loss: 1.8788 | Train Acc: 0.5357
 Site-Infograph | Train Loss: 2.1522 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 1.9932 | Train Acc: 0.4359
 Site-QuickDraw | Train Loss: 2.3052 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.8165 | Train Acc: 0.5517
 Site-Real      | Train Loss: 1.8022 | Train Acc: 0.5345
 Site-Sketch    | Train Loss: 1.9595 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8474 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.8564 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 1.8180 | Val  Acc: 0.4242
 Site-Clipart   | Val  Loss: 1.8619 | Val  Acc: 0.4773
 Site-Clipart   | Val  Loss: 2.0116 | Val  Acc: 0.3750
 Site-Infograph | Val  Loss: 2.4698 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.9698 | Val  Acc: 0.3846
 Site-QuickDraw | Val  Loss: 2.3333 | Val  Acc: 0.0938
 Site-Real      | Val  Loss: 1.7745 | Val  Acc: 0.6579
 Site-Real      | Val  Loss: 1.8106 | Val  Acc: 0.5844
 Site-Sketch    | Val  Loss: 1.9003 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4126
Aggregated Acc | Val Acc: 0.3494
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4242
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4773
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3750
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1500
 Best site-Painting   | Epoch:1 | Val Acc: 0.3846
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0938
 Best site-Real       | Epoch:1 | Val Acc: 0.6579
 Best site-Real       | Epoch:1 | Val Acc: 0.5844
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-5
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-3
client-5 is in G-4
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[1, 1, 3, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.9729 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8316 | Train Acc: 0.4545
 Site-Clipart   | Train Loss: 1.6847 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.7006 | Train Acc: 0.5373
 Site-Clipart   | Train Loss: 1.6582 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 2.1676 | Train Acc: 0.1613
 Site-Painting  | Train Loss: 1.7282 | Train Acc: 0.5897
 Site-QuickDraw | Train Loss: 2.3136 | Train Acc: 0.1042
 Site-Real      | Train Loss: 1.5719 | Train Acc: 0.6552
 Site-Real      | Train Loss: 1.5897 | Train Acc: 0.7328
 Site-Sketch    | Train Loss: 1.8701 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.6784 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.6510 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.5455 | Val  Acc: 0.5152
 Site-Clipart   | Val  Loss: 1.6581 | Val  Acc: 0.6136
 Site-Clipart   | Val  Loss: 1.8270 | Val  Acc: 0.4464
 Site-Infograph | Val  Loss: 2.3854 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.7938 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.2534 | Val  Acc: 0.1250
 Site-Real      | Val  Loss: 1.4596 | Val  Acc: 0.8421
 Site-Real      | Val  Loss: 1.5140 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.6415 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5284
Aggregated Acc | Val Acc: 0.4594
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5152
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6136
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4464
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1250
 Best site-Real       | Epoch:2 | Val Acc: 0.8421
 Best site-Real       | Epoch:2 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-0
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-3
cnt=[1, 1, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.7712 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.4076 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 1.6792 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.5815 | Train Acc: 0.6418
 Site-Clipart   | Train Loss: 1.5523 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.1427 | Train Acc: 0.1935
 Site-Painting  | Train Loss: 1.5492 | Train Acc: 0.6154
 Site-QuickDraw | Train Loss: 2.2253 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4029 | Train Acc: 0.7586
 Site-Real      | Train Loss: 1.3184 | Train Acc: 0.8793
 Site-Sketch    | Train Loss: 1.6038 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5504 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.4233 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.3272 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.4937 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.7109 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 2.3737 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.6265 | Val  Acc: 0.5769
 Site-QuickDraw | Val  Loss: 2.2858 | Val  Acc: 0.0625
 Site-Real      | Val  Loss: 1.2979 | Val  Acc: 0.8947
 Site-Real      | Val  Loss: 1.3434 | Val  Acc: 0.8312
 Site-Sketch    | Val  Loss: 1.5509 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6114
Aggregated Acc | Val Acc: 0.5268
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Painting   | Epoch:3 | Val Acc: 0.5769
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0625
 Best site-Real       | Epoch:3 | Val Acc: 0.8947
 Best site-Real       | Epoch:3 | Val Acc: 0.8312
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 2, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.6539 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3064 | Train Acc: 0.6061
 Site-Clipart   | Train Loss: 1.4015 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4095 | Train Acc: 0.6716
 Site-Clipart   | Train Loss: 1.2746 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.0607 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.4051 | Train Acc: 0.6923
 Site-QuickDraw | Train Loss: 2.1291 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.2161 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.1628 | Train Acc: 0.8966
 Site-Sketch    | Train Loss: 1.3693 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.3362 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.2780 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.1532 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.3981 | Val  Acc: 0.6818
 Site-Clipart   | Val  Loss: 1.5795 | Val  Acc: 0.5893
 Site-Infograph | Val  Loss: 2.3251 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.4506 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1760 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.1847 | Val  Acc: 0.9211
 Site-Real      | Val  Loss: 1.1850 | Val  Acc: 0.9221
 Site-Sketch    | Val  Loss: 1.4599 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6428
Aggregated Acc | Val Acc: 0.5844
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6818
 Best site-Clipart    | Epoch:4 | Val Acc: 0.5893
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2500
 Best site-Painting   | Epoch:4 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1562
 Best site-Real       | Epoch:4 | Val Acc: 0.9211
 Best site-Real       | Epoch:4 | Val Acc: 0.9221
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-0
client-3 is in G-4
client-4 is in G-4
client-5 is in G-4
client-6 is in G-5
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
cnt=[1, 1, 2, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.5992 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3941 | Train Acc: 0.6364
 Site-Clipart   | Train Loss: 1.5921 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.2765 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.1908 | Train Acc: 0.7976
 Site-Infograph | Train Loss: 2.0610 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.3113 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.0780 | Train Acc: 0.3542
 Site-Real      | Train Loss: 1.0767 | Train Acc: 0.8966
 Site-Real      | Train Loss: 1.0293 | Train Acc: 0.9138
 Site-Sketch    | Train Loss: 1.3077 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1235 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.0885 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.0112 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.2533 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.5111 | Val  Acc: 0.6607
 Site-Infograph | Val  Loss: 2.4061 | Val  Acc: 0.1500
 Site-Painting  | Val  Loss: 1.2115 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1535 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.9485 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 1.0310 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.3220 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7014
Aggregated Acc | Val Acc: 0.6756
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6607
 Best site-Infograph  | Epoch:5 | Val Acc: 0.1500
 Best site-Painting   | Epoch:5 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2812
 Best site-Real       | Epoch:5 | Val Acc: 0.9474
 Best site-Real       | Epoch:5 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 1, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2999 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.2249 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2351 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.2281 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 1.0195 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 2.0247 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.1381 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 2.0456 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.9789 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.8806 | Train Acc: 0.9310
 Site-Sketch    | Train Loss: 1.2543 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1317 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.0266 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.8209 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.2302 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4657 | Val  Acc: 0.6786
 Site-Infograph | Val  Loss: 2.2198 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.1594 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.1060 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.8570 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.8739 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.1893 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7251
Aggregated Acc | Val Acc: 0.6260
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:6 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6786
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2500
 Best site-Painting   | Epoch:6 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2500
 Best site-Real       | Epoch:6 | Val Acc: 0.9474
 Best site-Real       | Epoch:6 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-4
client-4 is in G-2
client-5 is in G-3
client-6 is in G-5
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
cnt=[1, 2, 5, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2264 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9593 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.1785 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0982 | Train Acc: 0.7761
 Site-Clipart   | Train Loss: 0.9384 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.9327 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.0927 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.9615 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.9337 | Train Acc: 0.8448
 Site-Real      | Train Loss: 0.8192 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.9475 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9241 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9463 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7854 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.1127 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3637 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2269 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 1.0893 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.0507 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.7148 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.7896 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.1376 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7363
Aggregated Acc | Val Acc: 0.6484
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2500
 Best site-Real       | Epoch:7 | Val Acc: 0.9737
 Best site-Real       | Epoch:7 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[2, 1, 3, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.2156 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.7539 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.1148 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0506 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.9200 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 1.8554 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.1100 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.8743 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.8445 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.7663 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 0.9952 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8851 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7966 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.6945 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.9919 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.2059 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 2.2199 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 1.0044 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.9774 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.6627 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.7055 | Val  Acc: 0.9481
 Site-Sketch    | Val  Loss: 1.1904 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7710
Aggregated Acc | Val Acc: 0.6887
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7679
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4000
 Best site-Painting   | Epoch:8 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3750
 Best site-Real       | Epoch:8 | Val Acc: 0.9737
 Best site-Real       | Epoch:8 | Val Acc: 0.9481
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-2
client-1 is in G-1
client-2 is in G-2
client-3 is in G-5
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 2, 3, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1468 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.1323 | Train Acc: 0.7273
 Site-Clipart   | Train Loss: 1.0311 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.8984 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.8932 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.8601 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 1.0113 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.8247 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.7857 | Train Acc: 0.8793
 Site-Real      | Train Loss: 0.6153 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 1.1194 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.8341 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8258 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6307 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.9720 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.1754 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1208 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.9459 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 1.9310 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.5951 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.6482 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.0323 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7782
Aggregated Acc | Val Acc: 0.7041
 Best site-Clipart    | Epoch:9 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:9 | Val Acc: 0.3500
 Best site-Painting   | Epoch:9 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.5000
 Best site-Real       | Epoch:9 | Val Acc: 0.9737
 Best site-Real       | Epoch:9 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7852
 Test site-Infograph | Epoch:9 | Test Acc: 0.4094
 Test site-Painting  | Epoch:9 | Test Acc: 0.8336
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4920
 Test site-Real      | Epoch:9 | Test Acc: 0.9252
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7653
Average Test Accuracy: 0.7018
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-5
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
cnt=[1, 5, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 1.1001 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.0054 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.9348 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0700 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 0.7274 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.8869 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 1.0064 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.7232 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.6398 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.5782 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.8335 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8437 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7377 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5891 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.9313 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.1643 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.2324 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.8808 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.8409 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.5422 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.6200 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.0443 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7769
Aggregated Acc | Val Acc: 0.6964
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-0
client-3 is in G-4
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-2
client-10 is in G-5
cnt=[3, 1, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9844 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6890 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.8503 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7820 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.6718 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.7339 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.9533 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.6402 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.6502 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.5305 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7199 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7742 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.6515 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5349 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.8415 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0742 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 2.1172 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.8387 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.7409 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.5373 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.5588 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.9845 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7842
Aggregated Acc | Val Acc: 0.7176
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4000
 Best site-Painting   | Epoch:11 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.5312
 Best site-Real       | Epoch:11 | Val Acc: 0.9474
 Best site-Real       | Epoch:11 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:11 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 12 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.9478 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5517 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.8973 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8445 | Train Acc: 0.7910
 Site-Clipart   | Train Loss: 0.6120 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.7522 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.7835 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.5918 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.6366 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.5210 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7699 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8107 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7019 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4865 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.8127 | Val  Acc: 0.7955
 Site-Clipart   | Val  Loss: 1.0865 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.0302 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7188 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6851 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.4971 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.5315 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.9603 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8116
Aggregated Acc | Val Acc: 0.7424
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:12 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:12 | Val Acc: 0.7955
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4000
 Best site-Painting   | Epoch:12 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.5000
 Best site-Real       | Epoch:12 | Val Acc: 0.9737
 Best site-Real       | Epoch:12 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:12 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 13 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-1
cnt=[1, 5, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8970 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6007 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6965 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7439 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.6747 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.6717 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.8306 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5172 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5757 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.5162 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 1.0632 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6994 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4921 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4539 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8008 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0102 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.9917 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.7923 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6168 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.4031 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4839 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.9564 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8258
Aggregated Acc | Val Acc: 0.7743
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4500
 Best site-Painting   | Epoch:13 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.5625
 Best site-Real       | Epoch:13 | Val Acc: 0.9737
 Best site-Real       | Epoch:13 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 14 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-3
client-4 is in G-3
client-5 is in G-1
client-6 is in G-5
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 1, 1, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7445 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9579 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.8765 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7751 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.5927 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.5382 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.8239 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.4594 | Train Acc: 0.7083
 Site-Real      | Train Loss: 0.6159 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.4113 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.8114 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6202 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5584 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4380 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7288 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0032 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.9330 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.7381 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6071 | Val  Acc: 0.5625
 Site-Real      | Val  Loss: 0.4843 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.4615 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.9550 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8299
Aggregated Acc | Val Acc: 0.7582
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5000
 Best site-Painting   | Epoch:14 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5625
 Best site-Real       | Epoch:14 | Val Acc: 0.9474
 Best site-Real       | Epoch:14 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:14 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-4
cnt=[1, 1, 1, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.8980 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.4684 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.8151 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6116 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.5946 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.5350 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.8025 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.4520 | Train Acc: 0.6875
 Site-Real      | Train Loss: 0.5993 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.4065 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.6847 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.6852 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4963 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4254 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6936 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.9534 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.9721 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.7205 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.5978 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3682 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4425 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.8627 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8161
Aggregated Acc | Val Acc: 0.7455
============ Train epoch 16 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7086 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3847 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.8766 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6076 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.5645 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.5671 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.6609 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3907 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.5360 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.4000 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.8986 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6112 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5017 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3988 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6799 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.9036 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.8292 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.6836 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5306 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.4064 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4050 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8640 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8421
Aggregated Acc | Val Acc: 0.7736
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:16 | Val Acc: 0.5000
 Best site-Painting   | Epoch:16 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.5938
 Best site-Real       | Epoch:16 | Val Acc: 0.9737
 Best site-Real       | Epoch:16 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 17 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 1, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7386 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4094 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.5562 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5599 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.5977 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.5473 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.5902 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.2944 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4495 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.3983 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.7439 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5124 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5433 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3916 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6493 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.8456 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.9021 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6805 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.3447 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.3269 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.4042 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8671 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8345
Aggregated Acc | Val Acc: 0.7879
============ Train epoch 18 ============
gmm
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7020 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5003 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.7187 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7105 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4463 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.5123 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.6267 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.1452 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.4439 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.3657 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5207 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6439 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.4554 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3335 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6354 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 0.8534 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 2.0540 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.6840 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.4262 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.3017 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3883 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8019 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8154
Aggregated Acc | Val Acc: 0.7418
============ Train epoch 19 ============
gmm
client-0 is in G-3
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-2
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
cnt=[1, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.7461 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.7265 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.7132 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6152 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.5295 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.4722 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.5700 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.0784 | Train Acc: 0.7292
 Site-Real      | Train Loss: 0.4650 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.3897 | Train Acc: 0.9569
 Site-Sketch    | Train Loss: 0.6279 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6233 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4612 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3721 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5890 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.8497 | Val  Acc: 0.7679
 Site-Infograph | Val  Loss: 1.9126 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.6212 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3494 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.3632 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3858 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.8946 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8173
Aggregated Acc | Val Acc: 0.7511
============ Train epoch 20 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-5
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6249 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.5910 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6869 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4941 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4380 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.3708 | Train Acc: 0.5161
 Site-Painting  | Train Loss: 0.6322 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.0764 | Train Acc: 0.7917
 Site-Real      | Train Loss: 0.4094 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.3895 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.4534 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4792 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4037 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3309 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.6108 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.7351 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.8495 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5932 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3665 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2917 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3620 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.8057 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8478
Aggregated Acc | Val Acc: 0.7691
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8409
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8393
 Best site-Infograph  | Epoch:20 | Val Acc: 0.4000
 Best site-Painting   | Epoch:20 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.6250
 Best site-Real       | Epoch:20 | Val Acc: 0.9737
 Best site-Real       | Epoch:20 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-5
client-1 is in G-5
client-2 is in G-0
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 1, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6522 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.7418 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.8578 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5579 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.4084 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.3344 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.5885 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.1308 | Train Acc: 0.7292
 Site-Real      | Train Loss: 0.3702 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.3054 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.4349 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5025 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3487 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3343 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5751 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7787 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.7555 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6125 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.3758 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2852 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3376 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6921 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8478
Aggregated Acc | Val Acc: 0.7907
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4500
 Best site-Painting   | Epoch:21 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.6250
 Best site-Real       | Epoch:21 | Val Acc: 0.9737
 Best site-Real       | Epoch:21 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 22 ============
gmm
client-0 is in G-2
client-1 is in G-4
client-2 is in G-4
client-3 is in G-3
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
cnt=[3, 1, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6006 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3470 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6814 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5729 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.4204 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.3650 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.6257 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0000 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.4344 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.3509 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 0.5560 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4688 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4305 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3356 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5098 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7401 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.8408 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5469 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.2459 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.3347 | Val  Acc: 0.9474
 Site-Real      | Val  Loss: 0.3261 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7494 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8551
Aggregated Acc | Val Acc: 0.8091
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4500
 Best site-Painting   | Epoch:22 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.6562
 Best site-Real       | Epoch:22 | Val Acc: 0.9474
 Best site-Real       | Epoch:22 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:22 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6426 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6206 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.7170 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5895 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.3746 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3209 | Train Acc: 0.5484
 Site-Painting  | Train Loss: 0.5870 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.9674 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3858 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.3123 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.4104 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.4046 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4586 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3135 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5405 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7753 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.9150 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5444 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2474 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2682 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3051 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7562 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8435
Aggregated Acc | Val Acc: 0.7772
============ Train epoch 24 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
cnt=[1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6406 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5242 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.7542 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4767 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.3977 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.2480 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5582 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.9863 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3665 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2866 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.6436 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3851 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3520 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2993 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5277 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.6661 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8148 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5613 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.2569 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.2636 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.3017 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6789 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8551
Aggregated Acc | Val Acc: 0.8004
============ Train epoch 25 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.6856 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.3397 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6659 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4453 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3761 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.2729 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5498 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.0193 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.4077 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.3176 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.6215 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.3988 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3604 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2575 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5345 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.6909 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.8234 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5374 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.3584 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2754 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2987 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.7469 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8369
Aggregated Acc | Val Acc: 0.7947
============ Train epoch 26 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 4, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5244 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4099 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5681 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4521 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.3405 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.2162 | Train Acc: 0.5806
 Site-Painting  | Train Loss: 0.6772 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.8686 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3606 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.2375 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5968 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4021 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3292 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2529 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5097 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6726 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.7913 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.5529 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.2007 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.2073 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2599 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6888 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8532
Aggregated Acc | Val Acc: 0.7907
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-4
client-6 is in G-3
client-7 is in G-2
client-8 is in G-3
client-9 is in G-3
client-10 is in G-0
cnt=[1, 2, 1, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5494 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3751 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5563 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4106 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3275 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.1841 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.7026 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.9105 | Train Acc: 0.8125
 Site-Real      | Train Loss: 0.3394 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2475 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4496 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3578 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3220 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2572 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5416 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.6976 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.7742 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4537 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.2636 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.2644 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2697 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6452 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8538
Aggregated Acc | Val Acc: 0.7873
============ Train epoch 28 ============
gmm
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-1
client-10 is in G-5
cnt=[1, 3, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5085 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4136 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.4889 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4509 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3659 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.1767 | Train Acc: 0.6129
 Site-Painting  | Train Loss: 0.5268 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.8837 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.3638 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2348 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.4540 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3757 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2528 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2815 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4655 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6030 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.6092 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.5249 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1964 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.2180 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2668 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6394 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8583
Aggregated Acc | Val Acc: 0.7906
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:28 | Val Acc: 0.5500
 Best site-Painting   | Epoch:28 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5312
 Best site-Real       | Epoch:28 | Val Acc: 0.9737
 Best site-Real       | Epoch:28 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 29 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5998 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2889 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.7865 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4521 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3662 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.0323 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.5140 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.8654 | Train Acc: 0.7708
 Site-Real      | Train Loss: 0.3591 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2243 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4128 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3732 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3288 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2568 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5181 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.6652 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6209 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.5799 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1704 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1872 | Val  Acc: 0.9737
 Site-Real      | Val  Loss: 0.2546 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6358 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8481
Aggregated Acc | Val Acc: 0.8010
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-4
client-5 is in G-5
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-2
client-10 is in G-4
cnt=[1, 1, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5303 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2654 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.5092 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4713 | Train Acc: 0.8507
 Site-Clipart   | Train Loss: 0.3922 | Train Acc: 0.9286
 Site-Infograph | Train Loss: 1.0644 | Train Acc: 0.6452
 Site-Painting  | Train Loss: 0.5290 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7759 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3205 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.2474 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.4503 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.2928 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2927 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3184 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.4365 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5858 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5346 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4259 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1894 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1955 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2628 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6715 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8609
Aggregated Acc | Val Acc: 0.8108
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8864
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:30 | Val Acc: 0.5000
 Best site-Painting   | Epoch:30 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.6562
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Real       | Epoch:30 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 31 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-3
client-5 is in G-2
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-4
client-10 is in G-5
cnt=[1, 1, 1, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5708 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3255 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4342 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4568 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3213 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.9775 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.5717 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.8441 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.3580 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.2127 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.6234 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4137 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4448 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2837 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4464 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6364 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.7135 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.5353 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2033 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1816 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2344 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7356 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8405
Aggregated Acc | Val Acc: 0.7676
============ Train epoch 32 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
cnt=[5, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4905 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2841 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.5056 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3964 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2672 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.0376 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.6015 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 0.7242 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2914 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.2360 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.3818 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3494 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1840 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2526 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4200 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.6150 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.5590 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5250 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1266 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1663 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2341 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6284 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8594
Aggregated Acc | Val Acc: 0.7891
============ Train epoch 33 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[4, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5952 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3571 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.4058 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4544 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.3600 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.0191 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4899 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.7765 | Train Acc: 0.8333
 Site-Real      | Train Loss: 0.2830 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2005 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.4048 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2751 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3592 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2413 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4201 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.6153 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.6127 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3900 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1923 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.1661 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2331 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6956 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8500
Aggregated Acc | Val Acc: 0.7807
============ Train epoch 34 ============
gmm
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-4
cnt=[1, 1, 1, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4754 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2626 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6557 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.3833 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2814 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9353 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.4464 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7671 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2958 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1899 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5898 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1972 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3214 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2414 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3665 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.6277 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.6547 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3166 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.1661 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1739 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1950 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6314 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8800
Aggregated Acc | Val Acc: 0.8294
 Best site-Clipart    | Epoch:34 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:34 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:34 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:34 | Val Acc: 0.5000
 Best site-Painting   | Epoch:34 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:34 | Val Acc: 0.6250
 Best site-Real       | Epoch:34 | Val Acc: 1.0000
 Best site-Real       | Epoch:34 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:34 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4893 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2250 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5165 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.3758 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2868 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9725 | Train Acc: 0.6774
 Site-Painting  | Train Loss: 0.4688 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6545 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.3229 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1961 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3069 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3264 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2697 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2147 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4442 | Val  Acc: 0.8409
 Site-Clipart   | Val  Loss: 0.5315 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6871 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4517 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.2098 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1679 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2190 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7765 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8484
Aggregated Acc | Val Acc: 0.7839
============ Train epoch 36 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-5
client-7 is in G-3
client-8 is in G-0
client-9 is in G-0
client-10 is in G-1
cnt=[2, 1, 1, 1, 5, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4450 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.3031 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6233 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4652 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2783 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9004 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.3823 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6057 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.3029 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1991 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4922 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2998 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2860 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2644 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3917 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.6087 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.6645 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5278 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1847 | Val  Acc: 0.5938
 Site-Real      | Val  Loss: 0.1875 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2208 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6185 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8384
Aggregated Acc | Val Acc: 0.7698
============ Train epoch 37 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-3
cnt=[1, 1, 1, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5795 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2963 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.6736 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3226 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2931 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.8909 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.3761 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.7122 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2589 | Train Acc: 0.8966
 Site-Real      | Train Loss: 0.1869 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.3360 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4308 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1944 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2074 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3698 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5026 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.4027 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.5869 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.1116 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.1690 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2248 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6605 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8812
Aggregated Acc | Val Acc: 0.8271
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:37 | Val Acc: 0.8929
 Best site-Infograph  | Epoch:37 | Val Acc: 0.5000
 Best site-Painting   | Epoch:37 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.7188
 Best site-Real       | Epoch:37 | Val Acc: 1.0000
 Best site-Real       | Epoch:37 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:37 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 38 ============
gmm
client-0 is in G-4
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-2
client-6 is in G-5
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[2, 1, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4966 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2077 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4055 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3974 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2333 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.9688 | Train Acc: 0.7097
 Site-Painting  | Train Loss: 0.4515 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.6928 | Train Acc: 0.8542
 Site-Real      | Train Loss: 0.2894 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.2249 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.4588 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2787 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2682 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2573 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3971 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.5739 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.7166 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.6547 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.0674 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.1501 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2472 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.6585 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8493
Aggregated Acc | Val Acc: 0.8114
============ Train epoch 39 ============
gmm
client-0 is in G-5
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5308 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4065 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4311 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2981 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2999 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.9455 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.4355 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.5794 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2734 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1832 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.3624 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2606 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1540 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1794 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3914 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6039 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6794 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.5140 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.1403 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1850 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2113 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6994 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8480
Aggregated Acc | Val Acc: 0.7974
============ Train epoch 40 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-3
client-10 is in G-1
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4691 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2181 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4017 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3080 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2320 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.8229 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.4089 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.6485 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2436 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1749 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.4180 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3385 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2074 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2296 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3439 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.6028 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6930 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3703 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.1207 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.1220 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1912 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7230 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8476
Aggregated Acc | Val Acc: 0.7739
============ Train epoch 41 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-5
client-9 is in G-5
client-10 is in G-3
cnt=[1, 1, 1, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.4072, powerC: 0.5928
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4441 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5805 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.3993 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5152 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 0.1991 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.9175 | Train Acc: 0.7419
 Site-Painting  | Train Loss: 0.3938 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.5869 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2563 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1646 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4212 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2800 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2431 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2286 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3213 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5386 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.4921 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4119 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0683 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1244 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1843 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5700 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8778
Aggregated Acc | Val Acc: 0.8950
============ Train epoch 42 ============
gmm
client-0 is in G-4
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-1
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 1, 1, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.4065, powerC: 0.5935
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3959 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2383 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3551 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3391 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.3147 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.8334 | Train Acc: 0.8710
 Site-Painting  | Train Loss: 0.3988 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.5085 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2875 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1739 | Train Acc: 0.9741
 Site-Sketch    | Train Loss: 0.4114 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1842 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2237 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2242 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3518 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4883 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6782 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4676 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 1.0774 | Val  Acc: 0.7188
 Site-Real      | Val  Loss: 0.1561 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1926 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6268 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8737
Aggregated Acc | Val Acc: 0.8303
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
client-10 is in G-0
cnt=[6, 1, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4058, powerC: 0.5942
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5171 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4117 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3781 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3094 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2503 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 0.8943 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.4245 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.5019 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2366 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.2081 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.3496 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2712 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2356 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1897 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3294 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5068 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6139 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4791 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0390 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1284 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1754 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5901 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8761
Aggregated Acc | Val Acc: 0.8273
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-5
client-7 is in G-3
client-8 is in G-4
client-9 is in G-4
client-10 is in G-1
cnt=[1, 5, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.4052, powerC: 0.5948
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4741 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.2421 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5541 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3202 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2417 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 0.7522 | Train Acc: 0.8065
 Site-Painting  | Train Loss: 0.4195 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.5927 | Train Acc: 0.8958
 Site-Real      | Train Loss: 0.2516 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.1748 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5545 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3074 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1654 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1798 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3475 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.4756 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.5496 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3315 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.1492 | Val  Acc: 0.6875
 Site-Real      | Val  Loss: 0.1179 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1682 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5575 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8795
Aggregated Acc | Val Acc: 0.8357
============ Train epoch 45 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-3
client-10 is in G-5
cnt=[1, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.4047, powerC: 0.5953
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.4648 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.3922 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3630 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3982 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.1731 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 0.7412 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.3453 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 0.4882 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2336 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1571 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.6223 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2268 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2087 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1974 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3288 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.3936 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6522 | Val  Acc: 0.5500
 Site-Painting  | Val  Loss: 0.4543 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.0499 | Val  Acc: 0.6562
 Site-Real      | Val  Loss: 0.1173 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1797 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.5231 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8811
Aggregated Acc | Val Acc: 0.8287
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8783
 Test site-Infograph | Epoch:37 | Test Acc: 0.4871
 Test site-Painting  | Epoch:37 | Test Acc: 0.8901
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.6660
 Test site-Real      | Epoch:37 | Test Acc: 0.9343
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8321
Average Test Accuracy: 0.7813
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 46 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-1
client-7 is in G-2
client-8 is in G-4
client-9 is in G-4
client-10 is in G-0
cnt=[1, 1, 1, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.4042, powerC: 0.5958
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.5359 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1946 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5661 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3921 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2741 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.8228 | Train Acc: 0.7742
 Site-Painting  | Train Loss: 0.3873 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 0.5571 | Train Acc: 0.8750
 Site-Real      | Train Loss: 0.2267 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1574 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.4225 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.2228 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1881 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1705 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2876 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5035 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7458 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3234 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.0984 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1234 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1561 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4983 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8758
Aggregated Acc | Val Acc: 0.8028
 Test site-Clipart   | Epoch:45 | Test Acc: 0.8840
 Test site-Infograph | Epoch:45 | Test Acc: 0.4825
 Test site-Painting  | Epoch:45 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:45 | Test Acc: 0.6680
 Test site-Real      | Epoch:45 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:45 | Test Acc: 0.8339
Average Test Accuracy: 0.7832
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/ccop_q=1...
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-4
client-8 is in G-0
client-9 is in G-0
client-10 is in G-5
cnt=[3, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4038, powerC: 0.5962
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3975 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2347 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.3923 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.4480 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.1747 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 0.7968 | Train Acc: 0.8387
 Site-Painting  | Train Loss: 0.5087 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 0.5800 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2437 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1332 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3074 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2312 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1976 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1731 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2788 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4374 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.5929 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4050 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 0.9992 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.1498 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1589 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6050 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8797
Aggregated Acc | Val Acc: 0.8130
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8764
 Test site-Infograph | Epoch:46 | Test Acc: 0.4886
 Test site-Painting  | Epoch:46 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6680
 Test site-Real      | Epoch:46 | Test Acc: 0.9408
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8303
Average Test Accuracy: 0.7827
============ Train epoch 48 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
cnt=[3, 4, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.4034, powerC: 0.5966
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3326 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.3052 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4114 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2644 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1899 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 0.7446 | Train Acc: 0.9032
 Site-Painting  | Train Loss: 0.3071 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.5716 | Train Acc: 0.9167
 Site-Real      | Train Loss: 0.2615 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1409 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3003 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.1781 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1172 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1671 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3156 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4489 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6880 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3391 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.2262 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.1219 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1523 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.6073 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8682
Aggregated Acc | Val Acc: 0.7947
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8764
 Test site-Infograph | Epoch:46 | Test Acc: 0.4901
 Test site-Painting  | Epoch:46 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6620
 Test site-Real      | Epoch:46 | Test Acc: 0.9392
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8249
Average Test Accuracy: 0.7810
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-2
client-6 is in G-1
client-7 is in G-5
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
cnt=[1, 3, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.4031, powerC: 0.5969
sum of wi : 1.0000
 Site-Clipart   | Train Loss: 0.3837 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2051 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5121 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2960 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.2084 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 0.6874 | Train Acc: 0.9355
 Site-Painting  | Train Loss: 0.3236 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 0.4803 | Train Acc: 0.9375
 Site-Real      | Train Loss: 0.2426 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.1417 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.6155 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1654 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2243 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.1819 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3268 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4595 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.5064 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.4092 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.1890 | Val  Acc: 0.6250
 Site-Real      | Val  Loss: 0.0989 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1498 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5351 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8712
Aggregated Acc | Val Acc: 0.8142
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8764
 Test site-Infograph | Epoch:46 | Test Acc: 0.4901
 Test site-Painting  | Epoch:46 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6590
 Test site-Real      | Epoch:46 | Test Acc: 0.9384
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8213
Average Test Accuracy: 0.7795
===2023-05-03 02:04:05===
===2023-05-03 02:04:07===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8840
 Test site-Infograph | Epoch:46 | Test Acc: 0.4825
 Test site-Painting  | Epoch:46 | Test Acc: 0.8934
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.6680
 Test site-Real      | Epoch:46 | Test Acc: 0.9376
 Test site-Sketch    | Epoch:46 | Test Acc: 0.8339
Average Test Accuracy: 0.7832
