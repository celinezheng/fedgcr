===2023-04-26 06:30:48===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,63,59,64,48,97,145,53,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 6
============ Train epoch 0 ============
===2023-04-26 06:30:56===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,63,59,64,48,97,145,53,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 6
Loading snapshots...
===2023-04-27 01:43:15===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.7926 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.6714 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 1.6371 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.5595 | Train Acc: 0.7612
 Site-Clipart   | Train Loss: 1.5230 | Train Acc: 0.7738
 Site-Infograph | Train Loss: 2.1446 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.6571 | Train Acc: 0.6667
 Site-QuickDraw | Train Loss: 2.1718 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.4285 | Train Acc: 0.8448
 Site-Real      | Train Loss: 1.3718 | Train Acc: 0.9483
 Site-Sketch    | Train Loss: 1.6627 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.6667 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.5671 | Val  Acc: 0.7727
 Site-Clipart   | Val  Loss: 1.4133 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.5688 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.6921 | Val  Acc: 0.6964
 Site-Infograph | Val  Loss: 2.3468 | Val  Acc: 0.2000
 Site-Painting  | Val  Loss: 1.4260 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 2.1378 | Val  Acc: 0.1562
 Site-Real      | Val  Loss: 1.2950 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.3641 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 1.5377 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6733
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7727
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:0 | Val Acc: 0.6964
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2000
 Best site-Painting   | Epoch:0 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1562
 Best site-Real       | Epoch:0 | Val Acc: 1.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:0 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.4971 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 1.0980 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.2798 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0635 | Train Acc: 0.8209
 Site-Clipart   | Train Loss: 1.0368 | Train Acc: 0.8214
 Site-Infograph | Train Loss: 1.9420 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 1.1241 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 2.0417 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8618 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.7456 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 1.2958 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.3059 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.0737 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8447 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.0288 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 1.1693 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 2.2589 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.9145 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0410 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.6409 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.7499 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.1391 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7678
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3000
 Best site-Painting   | Epoch:1 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.3750
 Best site-Real       | Epoch:1 | Val Acc: 1.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:1 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 1.1634 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.0761 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 1.0105 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.6971 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6791 | Train Acc: 0.8452
 Site-Infograph | Train Loss: 1.9330 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.9525 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 2.0028 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.5918 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.4001 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.7281 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9401 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.7660 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.5482 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8298 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.8953 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.1138 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.5470 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.9922 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.3746 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4403 | Val  Acc: 0.9610
 Site-Sketch    | Val  Loss: 0.9306 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7959
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:2 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8864
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3500
 Best site-Painting   | Epoch:2 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.3125
 Best site-Real       | Epoch:2 | Val Acc: 1.0000
 Best site-Real       | Epoch:2 | Val Acc: 0.9610
 Best site-Sketch     | Epoch:2 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 1.0073 | Train Acc: 0.5625
 Site-Clipart   | Train Loss: 0.4697 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.9157 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7430 | Train Acc: 0.8806
 Site-Clipart   | Train Loss: 0.5728 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 2.0270 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.8063 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.9351 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.4410 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.3108 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.7079 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8208 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6618 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.4377 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6667 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7039 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.0524 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.4047 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.9247 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.2180 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2725 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.8360 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7934
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.9427 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.8456 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.8063 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5582 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4843 | Train Acc: 0.8810
 Site-Infograph | Train Loss: 1.8638 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.7794 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 1.8932 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.3379 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.2027 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.6295 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6000 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5248 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3103 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5434 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.6867 | Val  Acc: 0.8036
 Site-Infograph | Val  Loss: 1.8150 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4206 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.9438 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.1464 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2057 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.7898 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8151
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8036
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4000
 Best site-Painting   | Epoch:4 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.2500
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Real       | Epoch:4 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.8513 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.7800 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.8396 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4135 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.4367 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.9235 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.6304 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.8156 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.2805 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.1642 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5218 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4379 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3878 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2922 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5396 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6874 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 2.2587 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4633 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8785 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.1511 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1490 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7225 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8132
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 1.0954 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2978 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6638 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4565 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.3981 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9547 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.6413 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 1.8155 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.2394 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.1578 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.9192 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4801 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2966 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2946 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4339 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.6164 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.9748 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2624 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7635 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.1073 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1240 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6273 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8059
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.8958 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.2750 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.7643 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5450 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3303 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.8966 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.6540 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 1.8186 | Train Acc: 0.4583
 Site-Real      | Train Loss: 0.2208 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0835 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4285 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.4591 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3472 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2869 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4667 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.6337 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.9299 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4013 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.9157 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0533 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0865 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6400 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8239
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8864
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3125
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.6540 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.2760 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5164 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.3908 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2692 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8545 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.5788 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7932 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.2140 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0759 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4707 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.2826 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2586 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2349 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4405 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5586 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.7687 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2877 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.9083 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0397 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0700 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7022 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8289
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:8 | Val Acc: 0.3500
 Best site-Painting   | Epoch:8 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3438
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Real       | Epoch:8 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.4999 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1932 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5068 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3669 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2636 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8936 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.5652 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7153 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.1939 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0599 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4291 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.3336 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1345 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2473 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3671 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5049 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8442 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3178 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.8474 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0326 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7017 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8224
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.7072 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.6342 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5231 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3558 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2916 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.8796 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.6280 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.6987 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.1567 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0677 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.3824 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3000 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1707 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1885 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2961 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4223 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8361 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4567 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8164 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0611 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5010 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8475
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:10 | Val Acc: 0.4000
 Best site-Painting   | Epoch:10 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3750
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.5655 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1881 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3791 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3100 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2151 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.9452 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4974 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7149 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.1483 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0474 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3981 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.2038 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1584 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1651 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3218 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4616 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.1594 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3094 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.8131 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0200 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6393 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8444
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.5780 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4342 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3779 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2719 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2410 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8956 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.5968 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.6927 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.1394 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0503 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.5588 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1368 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1841 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2083 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3042 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3803 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8242 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3911 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7709 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0182 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0335 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6057 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8405
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.6791 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1643 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3197 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2224 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.2212 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9704 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.5355 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.6297 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.1266 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0393 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 1.1476 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.2336 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1466 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1575 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2350 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4075 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8905 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2813 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7719 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6111 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8397
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.3960 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1740 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.5093 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2644 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.2728 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9232 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.5161 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.6491 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.1725 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0347 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4566 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1326 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2797 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1635 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2913 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4209 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8664 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2911 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6539 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0288 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5781 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8581
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:14 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:14 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:14 | Val Acc: 0.4000
 Best site-Painting   | Epoch:14 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.5000
 Best site-Real       | Epoch:14 | Val Acc: 1.0000
 Best site-Real       | Epoch:14 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:14 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.5014 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2212 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4336 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2657 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.1487 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.7487 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3871 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.5907 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.1026 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0247 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4467 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1387 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0954 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1309 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2214 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3688 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7779 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3967 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7051 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0188 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6909 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8468
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.5779 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.2749 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3006 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3850 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1604 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9014 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.5519 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.5414 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.1144 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0145 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4468 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1312 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0996 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1433 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2267 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4567 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7978 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3937 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5762 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0141 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6527 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8613
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4500
 Best site-Painting   | Epoch:16 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.4688
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Real       | Epoch:16 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:16 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.3849 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2675 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3913 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.2510 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2346 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8556 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4511 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.7366 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.0926 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0369 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4726 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1665 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0667 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1367 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2853 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3379 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6794 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3834 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7092 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5640 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8261
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.4073 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1276 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3537 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.1914 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1440 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8658 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3644 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.5968 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0960 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0162 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4192 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1668 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1346 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3130 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3933 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7169 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2401 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7639 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5822 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8435
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.4406 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1696 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4103 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2272 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1666 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9832 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4081 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.6412 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.1017 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0129 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7301 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1304 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1175 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1269 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2016 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3914 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7864 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2782 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7402 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0111 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5818 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8381
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.3376 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1272 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3783 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1893 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1143 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8672 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4406 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.6199 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.0882 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4570 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1355 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1234 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1412 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1438 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3831 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0337 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.2838 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6958 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4478 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8338
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.4825 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.4567 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3433 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2626 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1039 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7649 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3918 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5206 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0924 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5594 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1337 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1031 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1200 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1774 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3131 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.7520 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1535 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.5991 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0132 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5326 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8614
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4000
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.4688
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:21 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.3399 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1845 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3179 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1773 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1245 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9452 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.7129 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.4199 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0908 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3240 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1458 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0791 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1263 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1623 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3419 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.9497 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.1637 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6507 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0119 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5862 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8661
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4500
 Best site-Painting   | Epoch:22 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.4375
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Real       | Epoch:22 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.6550 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0822 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4909 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2154 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1296 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7618 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.3560 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.5294 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.1184 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3134 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.1165 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1001 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1519 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2227 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3514 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6730 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2074 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7050 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0078 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5459 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8456
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.4439 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0963 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3834 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1919 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1210 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8369 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3516 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.5656 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0741 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5903 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1335 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0600 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1308 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1939 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2749 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.0639 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2226 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.7268 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0095 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5514 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8518
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.4545 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0909 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2268 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2741 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1150 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9545 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3030 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4954 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0811 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3873 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1026 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1017 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2037 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2889 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.1837 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3863 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7311 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4999 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8388
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.3362 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.6203 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3240 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1722 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1877 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.7940 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4284 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.5188 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0715 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0072 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4658 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0971 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1069 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1669 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3199 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.7211 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4339 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5677 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5596 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8498
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.4089 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2620 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1317 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1112 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8189 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4139 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5081 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0680 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5340 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0938 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1147 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1829 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2571 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.9218 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4593 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7554 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4734 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8518
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.5764 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0958 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2855 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1562 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0869 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8454 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3291 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4611 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0741 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6571 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0708 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2144 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3376 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7229 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3946 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6912 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5798 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8550
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.3242 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0945 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3108 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1531 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1090 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8292 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.5740 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.5818 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0649 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4515 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.0935 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1120 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2377 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2539 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.7175 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3231 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5055 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5519 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8587
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.7265 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0926 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2773 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2536 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1369 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8667 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.4804 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5487 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0497 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4887 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0629 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0953 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2125 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2890 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8072 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1983 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6918 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5990 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8586
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.3046 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1378 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.5249 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1566 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0861 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8903 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4654 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.5305 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0760 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0086 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6407 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0387 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1007 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1777 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2469 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9588 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3083 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7398 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6102 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8536
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.2862 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1051 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2239 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1570 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0913 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7851 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4278 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5078 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0703 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3503 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0426 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1027 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1611 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2906 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6013 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.2310 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7141 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4819 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8613
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.4162 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0903 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2320 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2583 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0921 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8719 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3382 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3602 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0669 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4702 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.1109 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1281 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2277 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7436 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2972 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5746 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5717 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8538
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.2913 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0855 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2233 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1455 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0817 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8121 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4770 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.5154 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0632 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3082 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0854 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0573 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0975 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1221 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2677 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.5757 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.4465 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6490 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6567 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8395
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.4060 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1366 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3292 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1807 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0756 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9165 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3486 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4808 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0545 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4060 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0686 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0675 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1064 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1967 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2850 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6893 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.2622 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5620 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5344 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8703
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9107
 Best site-Infograph  | Epoch:35 | Val Acc: 0.4500
 Best site-Painting   | Epoch:35 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.5312
 Best site-Real       | Epoch:35 | Val Acc: 1.0000
 Best site-Real       | Epoch:35 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:35 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.6318 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.0926 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4369 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.2052 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1120 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8470 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.2752 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4838 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0681 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4120 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0615 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1065 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1625 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2558 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.8561 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3834 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5878 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6055 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8491
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.6142 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.0950 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2241 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1323 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1004 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.7752 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.3429 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4954 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0590 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3375 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0830 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1754 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2682 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.9032 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3110 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6333 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4469 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8587
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.4747 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0803 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4385 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1756 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1286 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7484 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4498 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.4048 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0507 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6442 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.1231 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0952 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1204 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2653 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7578 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1208 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6204 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5366 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8655
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.5075 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1697 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1854 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1634 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0737 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.9051 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3049 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.5254 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0444 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5288 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0365 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0976 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1149 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2657 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.5603 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2553 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5551 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5608 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8513
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.4627 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2359 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1373 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0760 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8567 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4552 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4711 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0486 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6597 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0529 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0893 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1894 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2452 | Val  Acc: 0.9107
 Site-Infograph | Val  Loss: 1.6587 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2760 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5604 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5970 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8340
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.6600 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0826 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4394 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1946 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1039 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8713 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4037 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.4305 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0497 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0096 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3241 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0536 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0979 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1363 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2944 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 2.0356 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3387 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5743 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6958 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8516
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.5000 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0895 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2123 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1271 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1219 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9031 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3896 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4459 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0354 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0075 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4163 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0680 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0773 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1598 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2222 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7058 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4079 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6387 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5649 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8448
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.2926 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1961 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2454 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1659 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0708 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7578 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4527 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4518 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0384 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3306 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0750 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0513 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0947 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1567 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2521 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7618 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3468 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5262 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5820 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8562
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.3943 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0774 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2141 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1311 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1079 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8384 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3609 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.3572 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0437 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3631 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0668 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0944 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2018 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2351 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6772 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3561 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5723 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4661 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8716
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:44 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:44 | Val Acc: 0.5000
 Best site-Painting   | Epoch:44 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:44 | Val Acc: 0.4375
 Best site-Real       | Epoch:44 | Val Acc: 1.0000
 Best site-Real       | Epoch:44 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:44 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.3132 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0786 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2512 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1170 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1021 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9015 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3994 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4205 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0422 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3244 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0619 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0658 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1074 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1725 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.1996 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8009 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.3497 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7451 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5085 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8344
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.2581 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3314 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2778 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1376 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0688 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8371 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4542 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.4264 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0469 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7297 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1292 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0612 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0915 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1286 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2467 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6093 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4089 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7613 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4694 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8527
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.3661 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0867 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2583 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2057 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0928 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9520 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2487 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.4593 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0405 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3039 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0894 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0669 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2008 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2329 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8048 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4104 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5710 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5800 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8505
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.2592 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0749 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2003 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1485 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0865 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.7163 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.4188 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.4779 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0530 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3131 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1473 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0386 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1302 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2140 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6793 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.4196 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7128 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5380 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8504
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2710 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2377 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1842 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1172 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.1510 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8633 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3508 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4510 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0499 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3499 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0962 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1509 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2001 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8239 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1923 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.7619 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4986 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8607
===2023-04-27 02:21:02===
===2023-04-27 02:21:04===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:44 | Test Acc: 0.8840
 Test site-Infograph | Epoch:44 | Test Acc: 0.4901
 Test site-Painting  | Epoch:44 | Test Acc: 0.8643
 Test site-QuickDraw | Epoch:44 | Test Acc: 0.5330
 Test site-Real      | Epoch:44 | Test Acc: 0.9671
 Test site-Sketch    | Epoch:44 | Test Acc: 0.8285
Average Test Accuracy: 0.7612
===2023-04-27 14:06:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 1.6772 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4570 | Train Acc: 0.7576
 Site-Clipart   | Train Loss: 1.7155 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.5109 | Train Acc: 0.7463
 Site-Clipart   | Train Loss: 1.5037 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 2.1655 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 1.4689 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 2.1342 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3848 | Train Acc: 0.9310
 Site-Real      | Train Loss: 1.2785 | Train Acc: 0.9397
 Site-Sketch    | Train Loss: 1.6354 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6658 | Val  Acc: 0.7273
 Site-Clipart   | Val  Loss: 1.5492 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.3314 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.5748 | Val  Acc: 0.7045
 Site-Clipart   | Val  Loss: 1.6385 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 2.2064 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 1.4227 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1396 | Val  Acc: 0.2188
 Site-Real      | Val  Loss: 1.2805 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 1.3213 | Val  Acc: 0.9351
 Site-Sketch    | Val  Loss: 1.4678 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7280
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7273
 Best site-Clipart    | Epoch:0 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:0 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7045
 Best site-Clipart    | Epoch:0 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2500
 Best site-Painting   | Epoch:0 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.2188
 Best site-Real       | Epoch:0 | Val Acc: 1.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.9351
 Best site-Sketch     | Epoch:0 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 1.2368 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.4213 | Train Acc: 0.7879
 Site-Clipart   | Train Loss: 1.0235 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9621 | Train Acc: 0.8358
 Site-Clipart   | Train Loss: 1.0090 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.0213 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 1.0456 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 2.0835 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8602 | Train Acc: 0.9310
 Site-Real      | Train Loss: 0.7047 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 1.0612 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1171 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9848 | Val  Acc: 0.8636
 Site-Clipart   | Val  Loss: 0.7770 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0085 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 1.1461 | Val  Acc: 0.8214
 Site-Infograph | Val  Loss: 1.9946 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.8334 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 2.0250 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.5958 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.7057 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 1.0854 | Val  Acc: 0.8696
Average Valid Accuracy: 0.7837
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8636
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:1 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:1 | Val Acc: 0.8214
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3500
 Best site-Painting   | Epoch:1 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2812
 Best site-Real       | Epoch:1 | Val Acc: 1.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.9740
 Best site-Sketch     | Epoch:1 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 1.1324 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.7977 | Train Acc: 0.8182
 Site-Clipart   | Train Loss: 0.9331 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9617 | Train Acc: 0.8657
 Site-Clipart   | Train Loss: 0.6925 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 2.0151 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 1.0327 | Train Acc: 0.7436
 Site-QuickDraw | Train Loss: 1.9951 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.5654 | Train Acc: 0.9138
 Site-Real      | Train Loss: 0.4470 | Train Acc: 0.9655
 Site-Sketch    | Train Loss: 0.9179 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8375 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5840 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4892 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7609 | Val  Acc: 0.8864
 Site-Clipart   | Val  Loss: 0.9557 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 2.1269 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.5734 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 2.0546 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.3782 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.4179 | Val  Acc: 0.9870
 Site-Sketch    | Val  Loss: 0.8251 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8132
 Best site-Clipart    | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:2 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8864
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3000
 Best site-Painting   | Epoch:2 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2812
 Best site-Real       | Epoch:2 | Val Acc: 1.0000
 Best site-Real       | Epoch:2 | Val Acc: 0.9870
 Best site-Sketch     | Epoch:2 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 0.9010 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.9695 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.6603 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6021 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.5321 | Train Acc: 0.8929
 Site-Infograph | Train Loss: 1.9223 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.7906 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.9217 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.3964 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.2515 | Train Acc: 0.9914
 Site-Sketch    | Train Loss: 0.8921 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7090 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5310 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4567 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.6857 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.8022 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 2.1154 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.4729 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.9628 | Val  Acc: 0.2500
 Site-Real      | Val  Loss: 0.2235 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2670 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.7192 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8052
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 0.6954 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.6870 | Train Acc: 0.8485
 Site-Clipart   | Train Loss: 0.9135 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6088 | Train Acc: 0.9104
 Site-Clipart   | Train Loss: 0.4569 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8710 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.8417 | Train Acc: 0.7179
 Site-QuickDraw | Train Loss: 1.8515 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.3045 | Train Acc: 0.9483
 Site-Real      | Train Loss: 0.1748 | Train Acc: 0.9828
 Site-Sketch    | Train Loss: 0.8149 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4709 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3917 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3041 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.6268 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8398 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3778 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.9350 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.1431 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.2241 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6636 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8327
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:4 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3500
 Best site-Painting   | Epoch:4 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3125
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Real       | Epoch:4 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 0.7972 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 0.3189 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6303 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5174 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.3296 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8244 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.6572 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.8580 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.2384 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.1258 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5403 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.5802 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.3608 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2934 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4704 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5942 | Val  Acc: 0.8393
 Site-Infograph | Val  Loss: 1.7853 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4137 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.8752 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0778 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1314 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.7205 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8026
============ Train epoch 6 ============
 Site-Clipart   | Train Loss: 0.5940 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.5797 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.4574 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4151 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.3656 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9199 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.5448 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.8359 | Train Acc: 0.3542
 Site-Real      | Train Loss: 0.2121 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.1007 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5086 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.3862 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2543 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2516 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4315 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.5944 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.9539 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3180 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.9024 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.1203 | Val  Acc: 0.9740
 Site-Sketch    | Val  Loss: 0.6368 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8158
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 0.5489 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2339 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4686 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.3775 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.3247 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.9534 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4958 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.7351 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1982 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0723 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5824 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.2516 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2772 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2213 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3587 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.5507 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.8164 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4222 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7575 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0815 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5713 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8398
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4000
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3438
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Real       | Epoch:7 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 8 ============
 Site-Clipart   | Train Loss: 0.6036 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.2187 | Train Acc: 0.8788
 Site-Clipart   | Train Loss: 0.6442 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.2857 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2905 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8020 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.5895 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.6853 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.1838 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0511 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.7242 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.2638 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2475 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2431 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3385 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4701 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.8644 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2489 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7821 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0552 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0709 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5448 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8393
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 0.4210 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2067 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3841 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.3005 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.2397 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 2.0266 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4987 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.5787 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.1799 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0377 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5880 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1734 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2352 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1918 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3833 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4764 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8971 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2805 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.8456 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0669 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4498 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8360
============ Train epoch 10 ============
 Site-Clipart   | Train Loss: 0.4586 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2433 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4562 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3174 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2404 | Train Acc: 0.9405
 Site-Infograph | Train Loss: 1.8248 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.5795 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.5881 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.1895 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4054 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.2340 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1270 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1566 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2870 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4057 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9263 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4181 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7901 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0520 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5229 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8494
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:10 | Val Acc: 0.4000
 Best site-Painting   | Epoch:10 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3438
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Real       | Epoch:10 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:10 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 0.6010 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1707 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4109 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3535 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2407 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.8506 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.4813 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.6651 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.1288 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0293 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6022 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2206 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1184 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1689 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2414 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4329 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0039 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2765 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7303 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0361 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6284 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8343
============ Train epoch 12 ============
 Site-Clipart   | Train Loss: 0.3735 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2879 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4234 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2948 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.2007 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8859 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.5045 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.5935 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.1126 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0225 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4357 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.1534 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0744 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1788 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2067 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.4676 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.9436 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3436 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6476 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0170 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5231 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8378
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 0.5745 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.1825 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.6292 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.4425 | Train Acc: 0.8955
 Site-Clipart   | Train Loss: 0.2436 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8739 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.4786 | Train Acc: 0.7692
 Site-QuickDraw | Train Loss: 1.6154 | Train Acc: 0.4792
 Site-Real      | Train Loss: 0.1252 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3361 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2535 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1676 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2142 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.4331 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.8115 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2163 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6689 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0210 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0252 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4660 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8348
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 0.3971 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2195 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.3860 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2940 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1334 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9678 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.5893 | Train Acc: 0.7949
 Site-QuickDraw | Train Loss: 1.6574 | Train Acc: 0.4167
 Site-Real      | Train Loss: 0.0896 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5557 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.1109 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1039 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1770 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2204 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3546 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.0333 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1422 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.7161 | Val  Acc: 0.2812
 Site-Real      | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5025 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8467
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 0.4176 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.1967 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2890 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.2320 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1501 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 2.0901 | Train Acc: 0.2903
 Site-Painting  | Train Loss: 0.3960 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.5927 | Train Acc: 0.3958
 Site-Real      | Train Loss: 0.1157 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5112 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1944 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0903 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1810 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.2554 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3684 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8578 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2082 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6838 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0142 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4193 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8381
============ Train epoch 16 ============
 Site-Clipart   | Train Loss: 0.4508 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1487 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4773 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1914 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1551 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.8546 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.6495 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.6189 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.1108 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0150 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3937 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1033 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1520 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2691 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.4407 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.8575 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3221 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6355 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0158 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5132 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8405
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 0.4496 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1057 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4354 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.2049 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1321 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9625 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4016 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.4435 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0977 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0153 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3374 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0910 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1373 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2408 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3906 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.6643 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3894 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7530 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4909 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8436
============ Train epoch 18 ============
 Site-Clipart   | Train Loss: 0.3320 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1080 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2842 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1851 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1188 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 2.0651 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3252 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.6241 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.0845 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5273 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.0720 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1348 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1202 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1964 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3391 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 2.0825 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3748 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.6424 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6041 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8439
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 0.2940 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1159 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3884 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.2663 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.1490 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.8810 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3780 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4855 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0815 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3730 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.0866 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0741 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1192 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2463 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2723 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6532 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2287 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6291 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5548 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8513
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4000
 Best site-Painting   | Epoch:19 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.4062
 Best site-Real       | Epoch:19 | Val Acc: 1.0000
 Best site-Real       | Epoch:19 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:19 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8916
 Test site-Infograph | Epoch:19 | Test Acc: 0.4855
 Test site-Painting  | Epoch:19 | Test Acc: 0.8724
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.5160
 Test site-Real      | Epoch:19 | Test Acc: 0.9647
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8375
Average Test Accuracy: 0.7613
============ Train epoch 20 ============
 Site-Clipart   | Train Loss: 0.2743 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1722 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3395 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1720 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0860 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9799 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4079 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.5211 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0801 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4555 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0820 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0491 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1122 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2124 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3035 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6687 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3003 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6860 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4031 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8413
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 0.4989 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.0968 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2597 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.1824 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1024 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9798 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.4666 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4327 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0959 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0075 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5266 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0669 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1191 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1797 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2874 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8063 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2312 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6457 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4609 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8521
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:21 | Val Acc: 0.3000
 Best site-Painting   | Epoch:21 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3750
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Real       | Epoch:21 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 22 ============
 Site-Clipart   | Train Loss: 0.3601 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1259 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3072 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.1393 | Train Acc: 0.9851
 Site-Clipart   | Train Loss: 0.0869 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8335 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3138 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4210 | Train Acc: 0.5833
 Site-Real      | Train Loss: 0.0812 | Train Acc: 0.9655
 Site-Real      | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2487 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0510 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0481 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1334 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1661 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2665 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.6601 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2990 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5929 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5653 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8506
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 0.4799 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1070 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.4076 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1482 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0943 | Train Acc: 0.9643
 Site-Infograph | Train Loss: 1.9122 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3515 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4867 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0635 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3480 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0718 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0917 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1403 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1672 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2810 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.6148 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4146 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.4746 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6714 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8551
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4500
 Best site-Painting   | Epoch:23 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.4688
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Real       | Epoch:23 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:23 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.6247 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.1210 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.3215 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1889 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1118 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8179 | Train Acc: 0.4839
 Site-Painting  | Train Loss: 0.2988 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.4477 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0744 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0044 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3067 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1229 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0670 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0771 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1767 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.3088 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.8333 | Val  Acc: 0.2500
 Site-Painting  | Val  Loss: 0.2027 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6554 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4360 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8452
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 0.2872 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1003 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2006 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2528 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0840 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8532 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2914 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4489 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0558 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4657 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0712 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1068 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2266 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.3188 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 2.0341 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3623 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5101 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.6990 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8492
============ Train epoch 26 ============
 Site-Clipart   | Train Loss: 0.3183 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0994 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.4511 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.1502 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1101 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8995 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3679 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4231 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0877 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.6241 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0618 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0922 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1579 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2656 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.9809 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3507 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5728 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0047 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5103 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8590
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:26 | Val Acc: 0.3500
 Best site-Painting   | Epoch:26 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.5312
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Real       | Epoch:26 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:26 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 0.2690 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0816 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1549 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1474 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0983 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.8310 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3509 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3861 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0612 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2937 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0812 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0903 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2020 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2554 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7225 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.3356 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5540 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5436 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8651
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9318
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9464
 Best site-Infograph  | Epoch:27 | Val Acc: 0.4500
 Best site-Painting   | Epoch:27 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.4688
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Real       | Epoch:27 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:27 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 28 ============
 Site-Clipart   | Train Loss: 0.3611 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0938 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1967 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1995 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.1327 | Train Acc: 0.9762
 Site-Infograph | Train Loss: 1.9325 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3823 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4285 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0575 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.4983 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0659 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0405 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1446 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1332 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2648 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8901 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.3667 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.7302 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5748 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8416
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.2776 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0869 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1802 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1472 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0715 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8716 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.3347 | Train Acc: 0.8462
 Site-QuickDraw | Train Loss: 1.4433 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.0507 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2734 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0521 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1306 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.1706 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2262 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.6734 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3431 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.6568 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5283 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8274
============ Train epoch 30 ============
 Site-Clipart   | Train Loss: 0.2773 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1008 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2011 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.3101 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0692 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8891 | Train Acc: 0.4194
 Site-Painting  | Train Loss: 0.3780 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3394 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.0453 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3194 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0614 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0758 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0787 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.2054 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2544 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.9450 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2294 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6990 | Val  Acc: 0.3125
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4268 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8422
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 0.3469 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1071 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1770 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1666 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0790 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9427 | Train Acc: 0.2258
 Site-Painting  | Train Loss: 0.4151 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3256 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.0394 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2812 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0432 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0831 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1331 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1112 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2446 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7497 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.4279 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.5968 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3706 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8634
============ Train epoch 32 ============
 Site-Clipart   | Train Loss: 0.2171 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1153 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1946 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1924 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.0960 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8764 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2596 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3277 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0654 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2499 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0444 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0936 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1860 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2972 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.6355 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1567 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.5039 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4526 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8618
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 0.4483 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1283 | Train Acc: 0.9091
 Site-Clipart   | Train Loss: 0.3008 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1484 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.1312 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8736 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2783 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.3661 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0643 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5472 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.0832 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1020 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1280 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.3210 | Val  Acc: 0.8929
 Site-Infograph | Val  Loss: 1.7271 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.1674 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5286 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4226 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8496
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.2467 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0671 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2701 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.2948 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0554 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8012 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3782 | Train Acc: 0.8205
 Site-QuickDraw | Train Loss: 1.3827 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0528 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3130 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0615 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0770 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1293 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2461 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8789 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.4046 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.6493 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4693 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8612
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 0.2198 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0602 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2025 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1323 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0630 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.7233 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2598 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.3179 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0630 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2641 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0538 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0821 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1615 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2281 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.5976 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1844 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.5230 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5300 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8555
============ Train epoch 36 ============
 Site-Clipart   | Train Loss: 0.3398 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0957 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2724 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1239 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0522 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8362 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3234 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.4531 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0500 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2553 | Train Acc: 0.8857
 Site-Clipart   | Val  Loss: 0.0570 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1178 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1898 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2061 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.8866 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.1843 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.5206 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4236 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8499
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 0.2818 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0898 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2270 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1267 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0494 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8088 | Train Acc: 0.4516
 Site-Painting  | Train Loss: 0.3678 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2952 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2798 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0656 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0469 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1200 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1590 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2070 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.6658 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3606 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5712 | Val  Acc: 0.5312
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4468 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8607
============ Train epoch 38 ============
 Site-Clipart   | Train Loss: 0.1981 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1572 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1861 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.2092 | Train Acc: 0.9403
 Site-Clipart   | Train Loss: 0.0605 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8894 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2376 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.4517 | Train Acc: 0.5417
 Site-Real      | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0045 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2574 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1407 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1814 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2413 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.6342 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2547 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5948 | Val  Acc: 0.3438
 Site-Real      | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5835 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8406
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.2239 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0883 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2005 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1330 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0898 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.6898 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3170 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 1.3262 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0414 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.5673 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0616 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0518 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1353 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1159 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2141 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.7533 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.2543 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.7685 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4015 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8443
============ Train epoch 40 ============
 Site-Clipart   | Train Loss: 0.3945 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0756 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.1761 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.2056 | Train Acc: 0.9254
 Site-Clipart   | Train Loss: 0.0891 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.8130 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2813 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.2630 | Train Acc: 0.7083
 Site-Real      | Train Loss: 0.0436 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2072 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1263 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.2156 | Val  Acc: 0.9318
 Site-Clipart   | Val  Loss: 0.2222 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.5901 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.2233 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6339 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4094 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8639
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.4622 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.0769 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2173 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1287 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0697 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9234 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2146 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3374 | Train Acc: 0.5625
 Site-Real      | Train Loss: 0.0460 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2951 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.0364 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0314 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1056 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1725 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2105 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7078 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2555 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5823 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3964 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8578
============ Train epoch 42 ============
 Site-Clipart   | Train Loss: 0.3073 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1235 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1855 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1690 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0503 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7707 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.3248 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.2389 | Train Acc: 0.7083
 Site-Real      | Train Loss: 0.0402 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2471 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0551 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0437 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1015 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1478 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2182 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.5490 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.1833 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.5977 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5180 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8652
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:42 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:42 | Val Acc: 0.4500
 Best site-Painting   | Epoch:42 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:42 | Val Acc: 0.4062
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Real       | Epoch:42 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:42 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.2902 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.2128 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1721 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.1288 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0897 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.9461 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2697 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.3242 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.0442 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2906 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0378 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0811 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0914 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1390 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2293 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.8865 | Val  Acc: 0.3000
 Site-Painting  | Val  Loss: 0.3436 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5786 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0093 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4262 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8589
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2995 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.1070 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.2252 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.0989 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0991 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.9524 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.2789 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.3623 | Train Acc: 0.5208
 Site-Real      | Train Loss: 0.0398 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2365 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0810 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0369 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0806 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1650 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2304 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.5457 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.1336 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.6148 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5190 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8559
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 0.4814 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.0860 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1597 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.2260 | Train Acc: 0.9552
 Site-Clipart   | Train Loss: 0.0635 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.6927 | Train Acc: 0.3871
 Site-Painting  | Train Loss: 0.2966 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.1858 | Train Acc: 0.7500
 Site-Real      | Train Loss: 0.0391 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2163 | Train Acc: 0.9714
 Site-Clipart   | Val  Loss: 0.0729 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0739 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1707 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2446 | Val  Acc: 0.9643
 Site-Infograph | Val  Loss: 1.6722 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.1934 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.5558 | Val  Acc: 0.4688
 Site-Real      | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3718 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8671
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9545
 Best site-Clipart    | Epoch:45 | Val Acc: 0.9643
 Best site-Infograph  | Epoch:45 | Val Acc: 0.3500
 Best site-Painting   | Epoch:45 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:45 | Val Acc: 0.4688
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Real       | Epoch:45 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:45 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
============ Train epoch 46 ============
 Site-Clipart   | Train Loss: 0.3004 | Train Acc: 0.9375
 Site-Clipart   | Train Loss: 0.3938 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1506 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1349 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.7658 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.3782 | Train Acc: 0.8718
 Site-QuickDraw | Train Loss: 1.2469 | Train Acc: 0.6458
 Site-Real      | Train Loss: 0.0342 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2419 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0315 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0988 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1604 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1959 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7477 | Val  Acc: 0.4000
 Site-Painting  | Val  Loss: 0.2882 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.5677 | Val  Acc: 0.4375
 Site-Real      | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.5486 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8576
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 0.2350 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4873 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1592 | Train Acc: 0.9800
 Site-Clipart   | Train Loss: 0.1157 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0531 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.9621 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2390 | Train Acc: 0.9231
 Site-QuickDraw | Train Loss: 1.3946 | Train Acc: 0.6250
 Site-Real      | Train Loss: 0.0557 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2184 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0479 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1119 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.1721 | Val  Acc: 0.9545
 Site-Clipart   | Val  Loss: 0.2012 | Val  Acc: 0.9464
 Site-Infograph | Val  Loss: 1.5478 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.2864 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7295 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4607 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8592
============ Train epoch 48 ============
 Site-Clipart   | Train Loss: 0.2539 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1887 | Train Acc: 0.9394
 Site-Clipart   | Train Loss: 0.1830 | Train Acc: 0.9400
 Site-Clipart   | Train Loss: 0.1795 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0845 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.8001 | Train Acc: 0.3548
 Site-Painting  | Train Loss: 0.4077 | Train Acc: 0.8974
 Site-QuickDraw | Train Loss: 1.3910 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0520 | Train Acc: 1.0000
 Site-Real      | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3227 | Train Acc: 0.9143
 Site-Clipart   | Val  Loss: 0.0420 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0882 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.1157 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.1906 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.7671 | Val  Acc: 0.3500
 Site-Painting  | Val  Loss: 0.3175 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 1.7735 | Val  Acc: 0.3750
 Site-Real      | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.4777 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8513
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2612 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.0785 | Train Acc: 0.9697
 Site-Clipart   | Train Loss: 0.2440 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1117 | Train Acc: 0.9701
 Site-Clipart   | Train Loss: 0.0650 | Train Acc: 0.9881
 Site-Infograph | Train Loss: 1.7850 | Train Acc: 0.3226
 Site-Painting  | Train Loss: 0.2122 | Train Acc: 0.9487
 Site-QuickDraw | Train Loss: 1.3202 | Train Acc: 0.6042
 Site-Real      | Train Loss: 0.0418 | Train Acc: 0.9828
 Site-Real      | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2067 | Train Acc: 0.9429
 Site-Clipart   | Val  Loss: 0.0708 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.0925 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1132 | Val  Acc: 0.9773
 Site-Clipart   | Val  Loss: 0.2153 | Val  Acc: 0.9821
 Site-Infograph | Val  Loss: 1.4171 | Val  Acc: 0.4500
 Site-Painting  | Val  Loss: 0.1840 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 1.6856 | Val  Acc: 0.4062
 Site-Real      | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-Real      | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-Sketch    | Val  Loss: 0.3564 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8735
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9773
 Best site-Clipart    | Epoch:49 | Val Acc: 0.9821
 Best site-Infograph  | Epoch:49 | Val Acc: 0.4500
 Best site-Painting   | Epoch:49 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:49 | Val Acc: 0.4062
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Real       | Epoch:49 | Val Acc: 1.0000
 Best site-Sketch     | Epoch:49 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/harmo-fl...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9011
 Test site-Infograph | Epoch:49 | Test Acc: 0.4932
 Test site-Painting  | Epoch:49 | Test Acc: 0.8772
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.5610
 Test site-Real      | Epoch:49 | Test Acc: 0.9630
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8502
Average Test Accuracy: 0.7743
===2023-04-27 14:55:36===
===2023-04-27 14:55:38===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[16,33,50,67,84,31,39,48,58,116,35,]
label set of clients: [10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:49 | Test Acc: 0.9011
 Test site-Infograph | Epoch:49 | Test Acc: 0.4932
 Test site-Painting  | Epoch:49 | Test Acc: 0.8772
 Test site-QuickDraw | Epoch:49 | Test Acc: 0.5610
 Test site-Real      | Epoch:49 | Test Acc: 0.9630
 Test site-Sketch    | Epoch:49 | Test Acc: 0.8502
Average Test Accuracy: 0.7743
