===2023-04-12 13:58:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1080 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2511 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.0855 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0803 | Train Acc: 0.2600
 Site-Infograph | Train Loss: 2.2500 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2798 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1998 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1711 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0999 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3950 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1753 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1416 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-4
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-0
client-11 is in G-2
cnt=[5, 1, 1, 2, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1117 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1269 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.9484 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.9508 | Train Acc: 0.4300
 Site-Infograph | Train Loss: 2.1687 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2553 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1193 | Train Acc: 0.3191
 Site-Painting  | Train Loss: 1.9923 | Train Acc: 0.3898
 Site-Painting  | Train Loss: 1.9514 | Train Acc: 0.4746
 Site-QuickDraw | Train Loss: 2.3663 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9892 | Train Acc: 0.3947
 Site-Sketch    | Train Loss: 1.9342 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.8662 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.8716 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 1.9820 | Val  Acc: 0.4179
 Site-Infograph | Val  Loss: 2.1004 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1316 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1923 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8521 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8888 | Val  Acc: 0.5128
 Site-QuickDraw | Val  Loss: 2.2623 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9014 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.8943 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4191
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5200
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4179
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5128
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-5
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
cnt=[6, 2, 2, 1, 0, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.9065 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8295 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.8217 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7993 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.1324 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1816 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0422 | Train Acc: 0.4043
 Site-Painting  | Train Loss: 1.9289 | Train Acc: 0.4576
 Site-Painting  | Train Loss: 1.8284 | Train Acc: 0.5678
 Site-QuickDraw | Train Loss: 2.3552 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.8941 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.7981 | Train Acc: 0.5429
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[4, 4, 2, 2, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.6907 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7620 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6909 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 1.6543 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.1235 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1452 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9078 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.6687 | Train Acc: 0.5763
 Site-Painting  | Train Loss: 1.6561 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.3285 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5944 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.6877 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5236 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7840 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5591 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.6839 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 1.8192 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8601 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0334 | Val  Acc: 0.3651
 Site-Painting  | Val  Loss: 1.5009 | Val  Acc: 0.6410
 Site-Painting  | Val  Loss: 1.5613 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1814 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6677 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6249 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5762
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6418
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3651
 Best site-Painting   | Epoch:3 | Val Acc: 0.6410
 Best site-Painting   | Epoch:3 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-3
client-11 is in G-0
cnt=[3, 3, 2, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.5664 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6562 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5697 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4570 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.0592 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0630 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8502 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.5586 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.4964 | Train Acc: 0.6949
 Site-QuickDraw | Train Loss: 2.3528 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.4950 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5151 | Train Acc: 0.7143
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[3, 6, 2, 0, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.5228 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.4891 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4197 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3323 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.0358 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0251 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.7791 | Train Acc: 0.4681
 Site-Painting  | Train Loss: 1.4423 | Train Acc: 0.6780
 Site-Painting  | Train Loss: 1.3035 | Train Acc: 0.7712
 Site-QuickDraw | Train Loss: 2.3510 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2283 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3225 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2252 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4896 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1189 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3637 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 1.6410 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7184 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8907 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.2111 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 1.2109 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.1274 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3446 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4419 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6539
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-Painting   | Epoch:5 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-3
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 6, 1, 1, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.3511 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2457 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3202 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1614 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 2.0405 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9300 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.6533 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.3316 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1892 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3528 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.1976 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3877 | Train Acc: 0.7429
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
cnt=[4, 2, 1, 5, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.2156 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3154 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1895 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0944 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9627 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9110 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5803 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.1816 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0536 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2998 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.1936 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3669 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.0742 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2581 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0075 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1709 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5132 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5458 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7352 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 0.8642 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9537 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1301 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1017 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2696 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7006
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4444
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.1822 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2486 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1116 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0161 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0334 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8378 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5250 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.0821 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9520 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.3656 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9640 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0666 | Train Acc: 0.7429
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-4
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-3
client-11 is in G-2
cnt=[2, 3, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0351 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3188 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0593 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8692 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9687 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7528 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4907 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.0070 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8848 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3867 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9242 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1167 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0182 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1187 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7895 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0091 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3704 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4869 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6276 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7578 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.7991 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1254 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9531 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1973 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7203
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.9231
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7433
 Test site-Infograph | Epoch:9 | Test Acc: 0.4338
 Test site-Painting  | Epoch:9 | Test Acc: 0.8288
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2650
 Test site-Real      | Epoch:9 | Test Acc: 0.8652
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7329
Average Test Accuracy: 0.6448
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-4
client-1 is in G-0
client-2 is in G-1
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-4
cnt=[5, 5, 0, 0, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0620 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9506 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.0366 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8712 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8731 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7122 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4666 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9442 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8460 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3461 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7517 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8437 | Train Acc: 0.7143
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[8, 4, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.1149 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2415 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9355 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8369 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9423 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7381 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3784 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 0.9109 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.7412 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3256 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7616 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9673 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9443 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9168 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7187 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9301 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.2360 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4348 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5830 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6494 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6542 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0438 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8298 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1240 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7416
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[3, 5, 2, 2, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0635 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0461 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9396 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7879 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9010 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6465 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3809 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8810 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.7270 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.2972 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8189 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0889 | Train Acc: 0.8000
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8734 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1273 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8340 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6754 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9557 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6683 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3227 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8001 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.6578 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2441 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7584 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7909 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7851 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8580 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7217 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7848 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1835 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3658 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5256 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5859 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5223 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0285 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7487 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0270 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7643
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5873
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-0
cnt=[5, 1, 1, 1, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8195 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0572 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8048 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6966 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8613 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6378 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2938 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8573 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.6269 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3251 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6195 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8948 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-3
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-5
client-6 is in G-3
client-7 is in G-4
client-8 is in G-0
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[2, 2, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7717 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9765 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7803 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6584 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9599 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6203 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2974 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7434 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5897 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.3281 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6509 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.1052 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7375 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7236 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5902 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7950 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0254 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2826 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4823 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 0.5021 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4715 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0668 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6638 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9607 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7710
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5556
 Best site-Painting   | Epoch:15 | Val Acc: 0.9231
 Best site-Painting   | Epoch:15 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-4
client-4 is in G-1
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-3
client-10 is in G-0
client-11 is in G-3
cnt=[2, 3, 1, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7618 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9030 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7474 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5759 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8493 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5034 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3108 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7234 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5699 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3035 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5790 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9462 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-1
client-1 is in G-5
client-2 is in G-3
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-5
client-10 is in G-2
client-11 is in G-5
cnt=[1, 1, 3, 2, 0, 5, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7509 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7867 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7382 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5543 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8665 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5903 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2335 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7140 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5636 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2830 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.6091 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9922 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6474 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6982 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5230 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7365 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0969 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2071 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4107 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4752 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4910 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0460 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6460 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8878 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7962
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
client-10 is in G-4
client-11 is in G-1
cnt=[5, 1, 4, 1, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6896 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9252 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6961 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.5857 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8930 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5785 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2277 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6786 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.5508 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3256 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4795 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8627 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-1
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
cnt=[1, 1, 4, 3, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7795 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8284 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7281 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4579 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9188 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4996 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1626 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.5988 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.5076 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2689 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5691 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7621 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5607 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6831 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5269 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6195 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.0413 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1733 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3545 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4085 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.4060 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 2.0205 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5927 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8537 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7819
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-4
client-11 is in G-1
cnt=[1, 4, 1, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6739 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7345 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6167 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5241 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9031 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4592 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1471 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5719 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4745 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1665 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.5566 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9318 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
cnt=[0, 6, 6, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6857 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6641 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6478 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4193 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8574 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4533 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1512 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5837 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4278 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2184 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4579 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0061 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5334 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6290 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4383 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.8976 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0952 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3293 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3567 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3895 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0139 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5461 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7834 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8120
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6349
 Best site-Painting   | Epoch:21 | Val Acc: 0.9487
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-0
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-1
client-6 is in G-3
client-7 is in G-5
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-4
cnt=[3, 1, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6968 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6550 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6273 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4650 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8762 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4854 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1533 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5856 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4637 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2490 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4060 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9930 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-4
cnt=[5, 2, 2, 2, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6063 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8168 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.5941 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4535 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8144 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4181 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0661 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5479 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3888 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1772 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4586 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7530 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5181 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5779 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4551 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5764 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9775 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0945 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2107 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3500 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3557 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9541 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5166 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8847 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7908
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.4968 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7495 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6031 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4422 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8704 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3527 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0815 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.5641 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3876 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1390 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4619 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6652 | Train Acc: 0.8000
============ Train epoch 50 ============
============ Train epoch 51 ============
client-0 is in G-4
client-1 is in G-2
client-2 is in G-0
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[2, 4, 1, 1, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5908 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5584 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5836 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4388 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9192 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4230 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0590 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5258 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3544 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.3047 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5228 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8428 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4160 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4926 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4408 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5616 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8713 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1462 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2235 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3260 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3312 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9239 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4397 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.6971 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8038
============ Train epoch 52 ============
============ Train epoch 53 ============
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-4
client-6 is in G-2
client-7 is in G-3
client-8 is in G-0
client-9 is in G-5
client-10 is in G-4
client-11 is in G-3
cnt=[2, 0, 1, 2, 4, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5134 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6266 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5451 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4013 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8651 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3547 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1178 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5194 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3558 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2026 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3847 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7366 | Train Acc: 0.8286
============ Train epoch 54 ============
============ Train epoch 55 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-2
client-3 is in G-4
client-4 is in G-0
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-3
cnt=[2, 2, 2, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5359 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8251 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5763 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4276 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8848 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3342 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0626 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5350 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3521 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.2339 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4102 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7291 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4896 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3594 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4036 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5073 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 0.9518 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0318 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2042 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.2807 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2671 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.9718 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4473 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7625 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7985
============ Train epoch 56 ============
============ Train epoch 57 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
cnt=[1, 4, 6, 0, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5708 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6032 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5089 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3727 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8324 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3432 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0571 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5027 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3309 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1841 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5763 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4755 | Train Acc: 0.8286
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[5, 4, 3, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5114 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5988 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4986 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.3749 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8677 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2745 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0363 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4607 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.3692 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2170 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4132 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5614 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3844 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4292 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4145 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5176 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 0.9360 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0424 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1895 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.3562 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2661 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8121 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4301 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7446 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8239
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6032
 Best site-Painting   | Epoch:29 | Val Acc: 0.9487
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8479
 Test site-Infograph | Epoch:29 | Test Acc: 0.5068
 Test site-Painting  | Epoch:29 | Test Acc: 0.9015
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3080
 Test site-Real      | Epoch:29 | Test Acc: 0.9178
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8087
Average Test Accuracy: 0.7151
===2023-04-12 14:42:59===
===2023-04-12 14:43:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8441
 Test site-Infograph | Epoch:29 | Test Acc: 0.5038
 Test site-Painting  | Epoch:29 | Test Acc: 0.9031
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3050
 Test site-Real      | Epoch:29 | Test Acc: 0.9178
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8105
Average Test Accuracy: 0.7140
