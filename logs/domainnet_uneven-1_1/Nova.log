===2023-04-12 13:58:49===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1080 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2511 | Train Acc: 0.1600
 Site-Clipart   | Train Loss: 2.0855 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.0803 | Train Acc: 0.2600
 Site-Infograph | Train Loss: 2.2500 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2798 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1998 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1711 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0999 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3950 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1753 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1416 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-4
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-0
client-11 is in G-2
cnt=[5, 1, 1, 2, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 2.1117 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1269 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.9484 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.9508 | Train Acc: 0.4300
 Site-Infograph | Train Loss: 2.1687 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.2553 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1193 | Train Acc: 0.3191
 Site-Painting  | Train Loss: 1.9923 | Train Acc: 0.3898
 Site-Painting  | Train Loss: 1.9514 | Train Acc: 0.4746
 Site-QuickDraw | Train Loss: 2.3663 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9892 | Train Acc: 0.3947
 Site-Sketch    | Train Loss: 1.9342 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.8662 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0149 | Val  Acc: 0.5455
 Site-Clipart   | Val  Loss: 1.8716 | Val  Acc: 0.5200
 Site-Clipart   | Val  Loss: 1.9820 | Val  Acc: 0.4179
 Site-Infograph | Val  Loss: 2.1004 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1316 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1923 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8521 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8888 | Val  Acc: 0.5128
 Site-QuickDraw | Val  Loss: 2.2623 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9014 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.8943 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4191
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5455
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5200
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4179
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5128
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-5
client-5 is in G-0
client-6 is in G-1
client-7 is in G-2
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
cnt=[6, 2, 2, 1, 0, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.9065 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8295 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.8217 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7993 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.1324 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1816 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0422 | Train Acc: 0.4043
 Site-Painting  | Train Loss: 1.9289 | Train Acc: 0.4576
 Site-Painting  | Train Loss: 1.8284 | Train Acc: 0.5678
 Site-QuickDraw | Train Loss: 2.3552 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.8941 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.7981 | Train Acc: 0.5429
============ Train epoch 6 ============
============ Train epoch 7 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[4, 4, 2, 2, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.6907 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7620 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6909 | Train Acc: 0.5733
 Site-Clipart   | Train Loss: 1.6543 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.1235 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1452 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9078 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.6687 | Train Acc: 0.5763
 Site-Painting  | Train Loss: 1.6561 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.3285 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5944 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.6877 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5236 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7840 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5591 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.6839 | Val  Acc: 0.6418
 Site-Infograph | Val  Loss: 1.8192 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8601 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0334 | Val  Acc: 0.3651
 Site-Painting  | Val  Loss: 1.5009 | Val  Acc: 0.6410
 Site-Painting  | Val  Loss: 1.5613 | Val  Acc: 0.6538
 Site-QuickDraw | Val  Loss: 2.1814 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6677 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6249 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5762
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6418
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3651
 Best site-Painting   | Epoch:3 | Val Acc: 0.6410
 Best site-Painting   | Epoch:3 | Val Acc: 0.6538
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-2
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-3
client-11 is in G-0
cnt=[3, 3, 2, 2, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.5664 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6562 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5697 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4570 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.0592 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0630 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8502 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.5586 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.4964 | Train Acc: 0.6949
 Site-QuickDraw | Train Loss: 2.3528 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.4950 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5151 | Train Acc: 0.7143
============ Train epoch 10 ============
============ Train epoch 11 ============
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[3, 6, 2, 0, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.5228 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.4891 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4197 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3323 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.0358 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0251 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.7791 | Train Acc: 0.4681
 Site-Painting  | Train Loss: 1.4423 | Train Acc: 0.6780
 Site-Painting  | Train Loss: 1.3035 | Train Acc: 0.7712
 Site-QuickDraw | Train Loss: 2.3510 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2283 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3225 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2252 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4896 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1189 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3637 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 1.6410 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7184 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8907 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.2111 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 1.2109 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.1274 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3446 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4419 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6539
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-Painting   | Epoch:5 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-3
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 6, 1, 1, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.3511 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2457 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3202 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1614 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 2.0405 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9300 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.6533 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.3316 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1892 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3528 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.1976 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3877 | Train Acc: 0.7429
============ Train epoch 14 ============
============ Train epoch 15 ============
client-0 is in G-0
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
cnt=[4, 2, 1, 5, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.2156 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3154 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1895 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0944 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9627 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9110 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5803 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.1816 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0536 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2998 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.1936 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3669 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.0742 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2581 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0075 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1709 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5132 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5458 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7352 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 0.8642 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9537 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1301 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1017 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2696 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7006
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4444
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.1822 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2486 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1116 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0161 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0334 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8378 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5250 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.0821 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9520 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.3656 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9640 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0666 | Train Acc: 0.7429
============ Train epoch 18 ============
============ Train epoch 19 ============
client-0 is in G-1
client-1 is in G-4
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-1
client-10 is in G-3
client-11 is in G-2
cnt=[2, 3, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0351 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3188 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0593 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8692 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9687 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7528 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4907 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.0070 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8848 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3867 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9242 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1167 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0182 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1187 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7895 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0091 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3704 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4869 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6276 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7578 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.7991 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1254 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9531 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1973 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7203
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.9231
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7433
 Test site-Infograph | Epoch:9 | Test Acc: 0.4338
 Test site-Painting  | Epoch:9 | Test Acc: 0.8288
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2650
 Test site-Real      | Epoch:9 | Test Acc: 0.8652
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7329
Average Test Accuracy: 0.6448
============ Train epoch 20 ============
============ Train epoch 21 ============
client-0 is in G-4
client-1 is in G-0
client-2 is in G-1
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-1
client-10 is in G-1
client-11 is in G-4
cnt=[5, 5, 0, 0, 2, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0620 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9506 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.0366 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8712 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8731 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7122 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4666 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9442 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8460 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3461 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7517 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8437 | Train Acc: 0.7143
============ Train epoch 22 ============
============ Train epoch 23 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-0
client-11 is in G-1
cnt=[8, 4, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.1149 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2415 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9355 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8369 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9423 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7381 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3784 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 0.9109 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.7412 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3256 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7616 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9673 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9443 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9168 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7187 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9301 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.2360 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4348 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5830 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6494 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6542 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0438 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8298 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1240 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7416
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[3, 5, 2, 2, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 1.0635 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0461 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9396 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7879 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9010 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6465 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3809 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8810 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.7270 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.2972 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8189 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0889 | Train Acc: 0.8000
============ Train epoch 26 ============
============ Train epoch 27 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8734 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1273 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8340 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6754 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9557 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6683 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3227 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8001 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.6578 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2441 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7584 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7909 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7851 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8580 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7217 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7848 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1835 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3658 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5256 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5859 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5223 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0285 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7487 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0270 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7643
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5873
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-4
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-0
cnt=[5, 1, 1, 1, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.8195 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0572 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8048 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6966 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8613 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6378 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.2938 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8573 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.6269 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3251 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6195 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8948 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
client-0 is in G-3
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-5
client-6 is in G-3
client-7 is in G-4
client-8 is in G-0
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[2, 2, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7717 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9765 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7803 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6584 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9599 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6203 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2974 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7434 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5897 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.3281 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6509 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.1052 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7375 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7236 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5902 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7950 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0254 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2826 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4823 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 0.5021 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4715 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0668 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6638 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9607 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7710
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5556
 Best site-Painting   | Epoch:15 | Val Acc: 0.9231
 Best site-Painting   | Epoch:15 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-4
client-4 is in G-1
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-3
client-10 is in G-0
client-11 is in G-3
cnt=[2, 3, 1, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7618 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9030 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7474 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5759 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8493 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5034 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3108 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7234 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5699 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3035 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5790 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9462 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
client-0 is in G-1
client-1 is in G-5
client-2 is in G-3
client-3 is in G-5
client-4 is in G-5
client-5 is in G-3
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-5
client-10 is in G-2
client-11 is in G-5
cnt=[1, 1, 3, 2, 0, 5, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7509 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7867 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7382 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5543 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8665 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5903 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2335 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7140 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5636 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2830 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.6091 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9922 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6474 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6982 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5230 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7365 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0969 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2071 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4107 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4752 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4910 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0460 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6460 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8878 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7962
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
client-0 is in G-0
client-1 is in G-2
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-2
client-8 is in G-0
client-9 is in G-3
client-10 is in G-4
client-11 is in G-1
cnt=[5, 1, 4, 1, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6896 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9252 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6961 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.5857 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8930 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5785 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2277 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6786 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.5508 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3256 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4795 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8627 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-1
client-7 is in G-3
client-8 is in G-4
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
cnt=[1, 1, 4, 3, 3, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.7795 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8284 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7281 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4579 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9188 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4996 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1626 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.5988 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.5076 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2689 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5691 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7621 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5607 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6831 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5269 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6195 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.0413 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1733 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3545 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4085 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.4060 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 2.0205 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5927 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8537 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7819
============ Train epoch 40 ============
============ Train epoch 41 ============
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-4
client-11 is in G-1
cnt=[1, 4, 1, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6739 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7345 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6167 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5241 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9031 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4592 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1471 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5719 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4745 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1665 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.5566 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9318 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
cnt=[0, 6, 6, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6857 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6641 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6478 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4193 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8574 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4533 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1512 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5837 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4278 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2184 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4579 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0061 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5334 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6290 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4383 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6465 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.8976 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0952 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3293 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3567 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3895 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0139 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5461 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7834 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8120
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6349
 Best site-Painting   | Epoch:21 | Val Acc: 0.9487
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
client-0 is in G-0
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-1
client-6 is in G-3
client-7 is in G-5
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-4
cnt=[3, 1, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6968 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6550 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6273 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4650 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8762 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4854 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1533 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5856 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4637 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2490 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4060 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9930 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-4
cnt=[5, 2, 2, 2, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.6063 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8168 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.5941 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4535 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8144 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4181 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0661 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5479 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3888 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1772 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4586 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7530 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5181 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5779 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4551 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5764 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9775 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0945 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2107 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3500 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3557 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9541 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5166 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8847 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7908
============ Train epoch 48 ============
============ Train epoch 49 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
cnt=[12, 0, 0, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.4968 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7495 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6031 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4422 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8704 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3527 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0815 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.5641 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3876 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1390 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4619 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6652 | Train Acc: 0.8000
============ Train epoch 50 ============
============ Train epoch 51 ============
client-0 is in G-4
client-1 is in G-2
client-2 is in G-0
client-3 is in G-1
client-4 is in G-1
client-5 is in G-1
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[2, 4, 1, 1, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5908 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5584 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5836 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.4388 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9192 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4230 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0590 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5258 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3544 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.3047 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5228 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8428 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4160 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4926 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4408 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5616 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8713 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1462 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2235 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3260 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3312 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9239 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4397 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.6971 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8038
============ Train epoch 52 ============
============ Train epoch 53 ============
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-4
client-6 is in G-2
client-7 is in G-3
client-8 is in G-0
client-9 is in G-5
client-10 is in G-4
client-11 is in G-3
cnt=[2, 0, 1, 2, 4, 3, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5134 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6266 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5451 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4013 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8651 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3547 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1178 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5194 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3558 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2026 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3847 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7366 | Train Acc: 0.8286
============ Train epoch 54 ============
============ Train epoch 55 ============
client-0 is in G-4
client-1 is in G-3
client-2 is in G-2
client-3 is in G-4
client-4 is in G-0
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-0
client-9 is in G-2
client-10 is in G-1
client-11 is in G-3
cnt=[2, 2, 2, 2, 4, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5359 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8251 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5763 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4276 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8848 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3342 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0626 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5350 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3521 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.2339 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4102 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7291 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4896 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3594 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4036 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5073 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 0.9518 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0318 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2042 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.2807 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2671 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.9718 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4473 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7625 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7985
============ Train epoch 56 ============
============ Train epoch 57 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-2
client-3 is in G-1
client-4 is in G-2
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
cnt=[1, 4, 6, 0, 1, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5708 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6032 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5089 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3727 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8324 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3432 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0571 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5027 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3309 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1841 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5763 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4755 | Train Acc: 0.8286
============ Train epoch 58 ============
============ Train epoch 59 ============
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
cnt=[5, 4, 3, 0, 0, 0, ]
beta=0.9, beta_c=0.9
 Site-Clipart   | Train Loss: 0.5114 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5988 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4986 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.3749 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8677 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2745 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0363 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4607 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.3692 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2170 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4132 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5614 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3844 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4292 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4145 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5176 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 0.9360 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0424 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1895 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.3562 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2661 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8121 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4301 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7446 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8239
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6032
 Best site-Painting   | Epoch:29 | Val Acc: 0.9487
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8479
 Test site-Infograph | Epoch:29 | Test Acc: 0.5068
 Test site-Painting  | Epoch:29 | Test Acc: 0.9015
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3080
 Test site-Real      | Epoch:29 | Test Acc: 0.9178
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8087
Average Test Accuracy: 0.7151
===2023-04-12 14:42:59===
===2023-04-12 14:43:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8441
 Test site-Infograph | Epoch:29 | Test Acc: 0.5038
 Test site-Painting  | Epoch:29 | Test Acc: 0.9031
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3050
 Test site-Real      | Epoch:29 | Test Acc: 0.9178
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8105
Average Test Accuracy: 0.7140
===2023-04-12 23:21:12===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-5
cnt=[2, 4, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1203 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1464 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9462 | Train Acc: 0.4533
 Site-Clipart   | Train Loss: 1.9488 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.1719 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2432 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.3085
 Site-Painting  | Train Loss: 1.9821 | Train Acc: 0.4237
 Site-Painting  | Train Loss: 1.9412 | Train Acc: 0.4661
 Site-QuickDraw | Train Loss: 2.3576 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9819 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9370 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8534 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0335 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8665 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9681 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.0752 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1135 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1885 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8425 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.8761 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.2609 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9090 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.9007 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4198
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.6154
 Best site-Painting   | Epoch:1 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[5, 2, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.9066 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8371 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.8056 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.8227 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.1361 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1566 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0248 | Train Acc: 0.3723
 Site-Painting  | Train Loss: 1.8842 | Train Acc: 0.4915
 Site-Painting  | Train Loss: 1.8220 | Train Acc: 0.5339
 Site-QuickDraw | Train Loss: 2.3197 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9079 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.7391 | Train Acc: 0.6000
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-4
client-1 is in G-1
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-5
client-10 is in G-0
client-11 is in G-0
cnt=[7, 1, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6896 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7571 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.6853 | Train Acc: 0.5867
 Site-Clipart   | Train Loss: 1.6606 | Train Acc: 0.6000
 Site-Infograph | Train Loss: 2.1245 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1530 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.8966 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.6795 | Train Acc: 0.5932
 Site-Painting  | Train Loss: 1.6620 | Train Acc: 0.6356
 Site-QuickDraw | Train Loss: 2.3264 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6165 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.6864 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5358 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7963 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5568 | Val  Acc: 0.6800
 Site-Clipart   | Val  Loss: 1.6889 | Val  Acc: 0.6119
 Site-Infograph | Val  Loss: 1.8143 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8585 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0296 | Val  Acc: 0.3492
 Site-Painting  | Val  Loss: 1.5061 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.5663 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1962 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.6569 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6231 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5615
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6800
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6119
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3492
 Best site-Painting   | Epoch:3 | Val Acc: 0.6154
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1905
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-2
client-6 is in G-5
client-7 is in G-5
client-8 is in G-1
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
cnt=[1, 3, 1, 1, 1, 5, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5527 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6623 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.5806 | Train Acc: 0.6267
 Site-Clipart   | Train Loss: 1.4560 | Train Acc: 0.6500
 Site-Infograph | Train Loss: 2.0685 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0552 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8443 | Train Acc: 0.5213
 Site-Painting  | Train Loss: 1.5626 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.4979 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.3399 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5159 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.5012 | Train Acc: 0.7429
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-2
client-3 is in G-0
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-5
client-11 is in G-5
cnt=[2, 1, 5, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5264 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.4873 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4219 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3333 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.0318 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0269 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7829 | Train Acc: 0.4681
 Site-Painting  | Train Loss: 1.4486 | Train Acc: 0.6780
 Site-Painting  | Train Loss: 1.3045 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3479 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2417 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.3323 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2280 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4476 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.1075 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3716 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 1.6345 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7107 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8931 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.2081 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 1.2137 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.1196 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3460 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4534 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6593
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-Painting   | Epoch:5 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-2
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
cnt=[3, 1, 3, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3466 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2498 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3217 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1661 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0414 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9223 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6492 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.3380 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1910 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3506 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2023 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3950 | Train Acc: 0.7429
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-3
client-1 is in G-2
client-2 is in G-4
client-3 is in G-4
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-5
client-10 is in G-3
client-11 is in G-3
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2112 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3185 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1933 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0947 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9756 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9079 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5782 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.1889 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0554 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2903 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1917 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3619 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.0823 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2561 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0155 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1806 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5063 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5432 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7336 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 0.8668 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9510 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1162 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1052 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2787 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7076
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4603
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1905 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2513 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1162 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0200 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0360 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8427 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5271 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.0797 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9554 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.3534 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9551 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0642 | Train Acc: 0.7143
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-4
cnt=[1, 4, 2, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0341 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3199 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.0630 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8740 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9793 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7496 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4920 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0089 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8845 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3749 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9264 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1214 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0283 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1100 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7927 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.0196 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3670 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5002 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6288 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7529 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.7945 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1063 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9503 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2132 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7163
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.8974
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7452
 Test site-Infograph | Epoch:9 | Test Acc: 0.4277
 Test site-Painting  | Epoch:9 | Test Acc: 0.8223
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2620
 Test site-Real      | Epoch:9 | Test Acc: 0.8636
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7292
Average Test Accuracy: 0.6417
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-2
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[2, 3, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0679 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9741 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.0398 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8723 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.8836 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7144 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4649 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9490 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8450 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3327 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7537 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8441 | Train Acc: 0.7429
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[2, 4, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1189 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2465 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9397 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8450 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9381 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7328 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3735 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9171 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.7408 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3130 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7670 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9758 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9520 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9143 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7162 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9371 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.2329 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4336 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5835 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6500 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6589 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0279 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8342 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1310 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7416
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-5
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-4
client-6 is in G-2
client-7 is in G-3
client-8 is in G-4
client-9 is in G-0
client-10 is in G-4
client-11 is in G-0
cnt=[2, 2, 2, 1, 3, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0685 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0524 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9435 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7891 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8986 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6457 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3739 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.8784 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7314 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.2908 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.8342 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0836 | Train Acc: 0.8571
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-5
client-3 is in G-5
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-3
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8838 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1374 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8430 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6763 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9601 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6683 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3172 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8069 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.6593 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2359 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7603 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7949 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7956 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8556 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7262 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7929 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1709 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3696 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5249 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5873 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5254 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0212 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7520 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0407 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7634
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[1, 2, 3, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8214 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0626 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8062 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6938 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8608 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6293 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.2874 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8523 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.6296 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.3280 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6233 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8890 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7711 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9807 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7826 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6599 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9557 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6177 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2949 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.7519 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5924 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3271 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6618 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0980 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7490 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7367 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5917 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7966 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0108 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2672 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4798 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 0.5064 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4751 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0504 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6691 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9699 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7697
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5397
 Best site-Painting   | Epoch:15 | Val Acc: 0.9231
 Best site-Painting   | Epoch:15 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 2, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7603 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9055 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7528 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5786 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8418 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5008 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3010 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7283 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5707 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2938 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5842 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9463 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-2
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[1, 3, 4, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7541 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7931 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7421 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5554 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8681 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5847 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2362 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7194 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5626 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2850 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.6085 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9933 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6617 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6634 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5240 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7447 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0921 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2056 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4070 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4752 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4878 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0309 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.6488 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8953 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8022
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4286
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
===2023-04-12 23:47:59===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-4
client-4 is in G-0
client-5 is in G-2
client-6 is in G-3
client-7 is in G-2
client-8 is in G-1
client-9 is in G-5
client-10 is in G-1
client-11 is in G-5
cnt=[2, 2, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7331 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8788 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6639 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5493 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 2.0009 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5067 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1768 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.7021 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5024 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.3263 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5723 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6431 | Train Acc: 0.8571
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-1
client-3 is in G-4
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 1, 3, 4, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8191 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8759 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.6897 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4558 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.7707 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5530 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1883 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6117 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.4374 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2884 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5319 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7784 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5440 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5832 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5126 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6886 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.0450 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2581 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.2782 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.3994 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.3665 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9587 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5411 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8509 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7955
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-4
client-4 is in G-2
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6532 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7217 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6308 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4347 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8315 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4353 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1453 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6364 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.4636 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2009 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.5534 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7177 | Train Acc: 0.8000
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-4
client-1 is in G-1
client-2 is in G-5
client-3 is in G-4
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6131 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7236 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5990 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4692 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9015 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4581 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0755 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.5563 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4294 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.2270 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4229 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8813 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4930 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6486 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5055 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6275 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 0.9031 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1088 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3061 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.3814 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3435 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9447 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4852 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7359 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8042
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6032
 Best site-Painting   | Epoch:21 | Val Acc: 0.9487
 Best site-Painting   | Epoch:21 | Val Acc: 0.9872
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[3, 3, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5046 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7653 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.5982 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3878 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8335 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4175 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1058 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5546 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.4052 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2692 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5068 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6609 | Train Acc: 0.8571
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6303 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7690 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5755 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4091 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.7841 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4376 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1236 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.4939 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3675 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2481 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.3436 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6177 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3954 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5412 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4149 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5654 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.1029 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0836 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2089 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3432 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2684 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.8508 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4554 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7412 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7953
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-4
client-4 is in G-2
client-5 is in G-1
client-6 is in G-0
client-7 is in G-1
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[3, 3, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5385 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5055 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5659 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.3644 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8848 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3547 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0430 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5325 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3697 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2452 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.3905 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7117 | Train Acc: 0.8286
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-3
client-4 is in G-0
client-5 is in G-5
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4377 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6075 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5209 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.3464 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.7983 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4345 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.0388 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.4747 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3262 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1926 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4247 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8069 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.3600 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5267 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4300 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5559 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.1209 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 0.9996 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1509 | Val  Acc: 0.6984
 Site-Painting  | Val  Loss: 0.2001 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2599 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 2.0121 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4109 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7435 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7945
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-1
client-1 is in G-1
client-2 is in G-4
client-3 is in G-1
client-4 is in G-0
client-5 is in G-3
client-6 is in G-3
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-0
cnt=[3, 3, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4873 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5801 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4912 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3770 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8819 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3384 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0160 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4297 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.2976 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2405 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3770 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.5650 | Train Acc: 0.8286
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 3, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4252 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7214 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4941 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.2861 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8477 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2974 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9800 | Train Acc: 0.7447
 Site-Painting  | Train Loss: 0.4688 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.2792 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.2266 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3471 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6394 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4711 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.4672 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3638 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.4771 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.0301 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0491 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1258 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.2235 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.2196 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.9206 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4369 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7216 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7927
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-5
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-5
client-6 is in G-1
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[1, 2, 2, 2, 3, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5163 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6120 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4892 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.3294 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8387 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3201 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0240 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.4206 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.2641 | Train Acc: 0.9915
 Site-QuickDraw | Train Loss: 2.1788 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3346 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7300 | Train Acc: 0.8000
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-0
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-4
client-8 is in G-3
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[2, 4, 1, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5542 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6943 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4661 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.2789 | Train Acc: 0.9900
 Site-Infograph | Train Loss: 1.8424 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.2240 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9821 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4310 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.2536 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.0917 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.4227 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5848 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.2737 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3544 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3611 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.4322 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8886 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9749 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1226 | Val  Acc: 0.6825
 Site-Painting  | Val  Loss: 0.1913 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.2097 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.8110 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4112 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7663 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8193
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9200
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8806
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6825
 Best site-Painting   | Epoch:29 | Val Acc: 0.9744
 Best site-Painting   | Epoch:29 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8422
 Test site-Infograph | Epoch:29 | Test Acc: 0.5114
 Test site-Painting  | Epoch:29 | Test Acc: 0.9031
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3130
 Test site-Real      | Epoch:29 | Test Acc: 0.9145
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8051
Average Test Accuracy: 0.7149
===2023-04-13 00:06:09===
===2023-04-13 00:06:10===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8498
 Test site-Infograph | Epoch:29 | Test Acc: 0.5160
 Test site-Painting  | Epoch:29 | Test Acc: 0.9015
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3140
 Test site-Real      | Epoch:29 | Test Acc: 0.9145
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8032
Average Test Accuracy: 0.7165
===2023-04-13 00:11:05===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
===2023-04-13 00:11:06===
===2023-04-13 00:11:08===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
===2023-04-13 00:11:42===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
include valid acc for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-5
cnt=[2, 4, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1203 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1464 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9462 | Train Acc: 0.4533
 Site-Clipart   | Train Loss: 1.9488 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.1719 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2432 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.3085
 Site-Painting  | Train Loss: 1.9821 | Train Acc: 0.4237
 Site-Painting  | Train Loss: 1.9412 | Train Acc: 0.4661
 Site-QuickDraw | Train Loss: 2.3576 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9819 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9370 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8534 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0335 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8665 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9681 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.0752 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1135 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1885 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8425 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.8761 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.2609 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9090 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.9007 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4198
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.6154
 Best site-Painting   | Epoch:1 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[5, 2, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.9011 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8288 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.8013 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.8101 | Train Acc: 0.5300
 Site-Infograph | Train Loss: 2.1381 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1568 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0199 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.8801 | Train Acc: 0.4915
 Site-Painting  | Train Loss: 1.8132 | Train Acc: 0.5254
 Site-QuickDraw | Train Loss: 2.3499 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9096 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.7431 | Train Acc: 0.5714
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
cnt=[1, 7, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6714 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7492 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.6793 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6571 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.1441 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1420 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8823 | Train Acc: 0.4681
 Site-Painting  | Train Loss: 1.6850 | Train Acc: 0.5763
 Site-Painting  | Train Loss: 1.6707 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.3289 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6175 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.6900 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.5439 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7955 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.5556 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6807 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 1.8044 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8583 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0326 | Val  Acc: 0.3651
 Site-Painting  | Val  Loss: 1.5117 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.5642 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.1861 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6517 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6338 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5637
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6269
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3651
 Best site-Painting   | Epoch:3 | Val Acc: 0.5897
 Best site-Painting   | Epoch:3 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-1
client-11 is in G-5
cnt=[1, 7, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5364 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.6380 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.5682 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4437 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.0640 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0623 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.8410 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.5594 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.5055 | Train Acc: 0.6864
 Site-QuickDraw | Train Loss: 2.3468 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.4922 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5093 | Train Acc: 0.7429
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-5
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[2, 1, 2, 5, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5172 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.4916 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4101 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.3266 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.0255 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0201 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7757 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.4316 | Train Acc: 0.6949
 Site-Painting  | Train Loss: 1.2955 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3439 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2328 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.3219 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2252 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4475 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0980 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3606 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.6397 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7093 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8902 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1895 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 1.2018 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.1271 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3410 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4452 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6587
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8462
 Best site-Painting   | Epoch:5 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
cnt=[1, 2, 1, 4, 1, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3389 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2460 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3210 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1614 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 2.0528 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9228 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6462 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.3284 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1813 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3485 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.1969 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3886 | Train Acc: 0.7143
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-3
client-4 is in G-3
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
cnt=[2, 2, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2122 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3185 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1905 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0903 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9763 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9076 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5757 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.1865 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0500 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2899 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1920 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3557 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.0754 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2492 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0079 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1785 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5061 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5446 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7301 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 0.8586 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9480 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1166 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.0997 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2749 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7076
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4603
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1869 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2477 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1134 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0174 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 2.0318 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8385 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5244 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 1.0801 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9517 | Train Acc: 0.8559
 Site-QuickDraw | Train Loss: 2.3524 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9546 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0633 | Train Acc: 0.7143
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-4
cnt=[1, 4, 2, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0280 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3165 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.0615 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8720 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9779 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7480 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4900 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0060 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.8812 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3720 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9268 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1216 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0300 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1085 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7888 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0177 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3625 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4961 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6256 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7499 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.7910 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1062 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9448 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2099 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7150
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.8974
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7490
 Test site-Infograph | Epoch:9 | Test Acc: 0.4338
 Test site-Painting  | Epoch:9 | Test Acc: 0.8239
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2640
 Test site-Real      | Epoch:9 | Test Acc: 0.8628
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7329
Average Test Accuracy: 0.6444
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-2
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[2, 3, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0672 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9663 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.0371 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8693 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8786 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7150 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4649 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9457 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8438 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3332 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7542 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8393 | Train Acc: 0.7429
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1187 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2447 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9351 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8391 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9364 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7331 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3729 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9132 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 0.7378 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3135 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7625 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9705 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9488 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9134 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7155 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9352 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.2280 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4358 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.5821 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6452 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6551 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0277 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8299 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1263 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7457
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-3
client-10 is in G-1
client-11 is in G-3
cnt=[2, 3, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0651 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0497 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9402 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7865 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9008 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6490 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3723 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.8773 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7299 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.2909 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8263 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0904 | Train Acc: 0.8571
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[2, 2, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8802 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1398 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8399 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6744 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9568 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6694 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3171 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.8048 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.6552 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2314 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7548 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7897 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7931 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8574 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7263 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7919 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1710 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3718 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5215 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5829 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5234 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0196 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7469 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0378 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7658
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5873
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[1, 2, 3, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8206 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0596 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8035 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6910 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8547 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6277 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2857 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8540 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.6271 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.3222 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6200 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8862 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7780 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9816 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7778 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6555 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9665 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6226 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2967 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7518 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.5846 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3219 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6529 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.1043 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7447 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7280 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5903 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7956 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0274 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2794 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4792 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 0.5014 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.4756 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0449 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6635 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9687 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7636
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 2, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7634 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9109 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7492 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5771 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.8419 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5069 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3044 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.7360 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5741 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2928 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5756 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9473 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-2
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[1, 3, 4, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7571 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7901 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7434 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5525 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8688 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5862 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2375 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7166 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5648 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2751 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6024 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9955 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6628 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6618 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5212 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7434 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0932 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2137 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4077 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4702 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4873 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0291 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6472 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8933 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8010
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-0
client-4 is in G-1
client-5 is in G-5
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[2, 3, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6883 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9288 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6985 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5844 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9033 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5724 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2329 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.6753 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.5429 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3116 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4684 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8640 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-4
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[2, 2, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7792 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8362 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7257 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4584 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9155 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4847 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1579 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5977 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.5026 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2643 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5685 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7682 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5603 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6671 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5242 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6189 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 1.0166 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1729 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3485 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4006 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.4035 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 2.0083 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5875 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8580 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7775
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-1
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-0
client-11 is in G-4
cnt=[2, 3, 3, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6658 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7397 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6197 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5179 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9041 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4562 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1440 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5779 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4766 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1534 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.5584 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9296 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-4
client-1 is in G-4
client-2 is in G-5
client-3 is in G-1
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-0
client-11 is in G-1
cnt=[4, 2, 2, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6753 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6656 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6583 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4155 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8692 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4460 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1378 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5916 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4246 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2204 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4585 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9932 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5339 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6193 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4353 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6562 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9079 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0742 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3345 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3478 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3821 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0199 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5487 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7867 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8131
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:21 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6667
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-3
client-3 is in G-3
client-4 is in G-4
client-5 is in G-2
client-6 is in G-1
client-7 is in G-5
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-0
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6854 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6528 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6253 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4551 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8846 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4827 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1484 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5838 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4562 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2432 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4063 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9950 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-4
client-9 is in G-3
client-10 is in G-4
client-11 is in G-3
cnt=[1, 2, 2, 3, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6070 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8199 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.5970 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4416 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8229 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4074 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0493 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5467 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3857 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1727 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4495 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7425 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5093 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5388 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4584 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5755 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9854 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0887 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2095 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3338 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3480 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9572 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5090 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8692 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7946
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-2
client-6 is in G-5
client-7 is in G-0
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 3, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4808 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7424 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5979 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4349 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8651 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3467 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0748 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.5616 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3844 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1401 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4555 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6503 | Train Acc: 0.7714
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-4
client-11 is in G-0
cnt=[2, 3, 3, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5834 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5689 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5956 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4299 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9191 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4069 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0454 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5214 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3518 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2918 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5027 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8207 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4130 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4626 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4334 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5686 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.8580 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1433 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2063 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3150 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3251 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9240 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4308 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.6915 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8011
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-2
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-3
client-10 is in G-5
client-11 is in G-4
cnt=[1, 2, 4, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5035 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6250 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5437 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.3899 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8742 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3624 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1085 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5231 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3401 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.1928 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3680 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7218 | Train Acc: 0.8000
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-2
client-1 is in G-3
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-3
client-7 is in G-0
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5290 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8189 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5791 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4213 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8921 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3253 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0521 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5306 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3434 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2284 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.3959 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7195 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4808 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3539 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3987 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5129 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9373 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0514 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1838 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.2842 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2627 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9585 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4669 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7555 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7943
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-2
client-1 is in G-3
client-2 is in G-5
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-0
client-8 is in G-4
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 2, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5469 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6159 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5003 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3608 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8343 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3350 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0408 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4963 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3224 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1623 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5527 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4636 | Train Acc: 0.8286
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-2
client-1 is in G-2
client-2 is in G-3
client-3 is in G-2
client-4 is in G-5
client-5 is in G-0
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 3, 3, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4919 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6123 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4880 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.3511 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8839 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.2786 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0078 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4480 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3548 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1929 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3883 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5422 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3866 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3815 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4002 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5094 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 0.9424 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0465 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1757 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.3314 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2624 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8398 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4289 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7284 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8225
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5873
 Best site-Painting   | Epoch:29 | Val Acc: 0.9487
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8384
 Test site-Infograph | Epoch:29 | Test Acc: 0.5160
 Test site-Painting  | Epoch:29 | Test Acc: 0.8982
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3050
 Test site-Real      | Epoch:29 | Test Acc: 0.9154
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8051
Average Test Accuracy: 0.7130
===2023-04-13 00:56:10===
===2023-04-13 00:56:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8403
 Test site-Infograph | Epoch:29 | Test Acc: 0.5099
 Test site-Painting  | Epoch:29 | Test Acc: 0.8998
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3020
 Test site-Real      | Epoch:29 | Test Acc: 0.9145
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8069
Average Test Accuracy: 0.7122
===2023-04-13 00:59:31===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
only valid acc for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-5
cnt=[2, 4, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1203 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1464 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9462 | Train Acc: 0.4533
 Site-Clipart   | Train Loss: 1.9488 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.1719 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2432 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.3085
 Site-Painting  | Train Loss: 1.9821 | Train Acc: 0.4237
 Site-Painting  | Train Loss: 1.9412 | Train Acc: 0.4661
 Site-QuickDraw | Train Loss: 2.3576 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9819 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9370 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8534 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0335 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8665 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9681 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.0752 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1135 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1885 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8425 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.8761 | Val  Acc: 0.5641
 Site-QuickDraw | Val  Loss: 2.2609 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9090 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.9007 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4198
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.6154
 Best site-Painting   | Epoch:1 | Val Acc: 0.5641
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[5, 2, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.9011 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8288 | Train Acc: 0.4600
 Site-Clipart   | Train Loss: 1.8013 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.8101 | Train Acc: 0.5300
 Site-Infograph | Train Loss: 2.1381 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1568 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0199 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.8801 | Train Acc: 0.4915
 Site-Painting  | Train Loss: 1.8132 | Train Acc: 0.5254
 Site-QuickDraw | Train Loss: 2.3499 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9096 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.7431 | Train Acc: 0.5714
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-1
cnt=[1, 7, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6904 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6803 | Train Acc: 0.5867
 Site-Clipart   | Train Loss: 1.6503 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.1441 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.1414 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.8770 | Train Acc: 0.4574
 Site-Painting  | Train Loss: 1.6846 | Train Acc: 0.5932
 Site-Painting  | Train Loss: 1.6676 | Train Acc: 0.6186
 Site-QuickDraw | Train Loss: 2.3322 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6015 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.6977 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5328 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7828 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5501 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6792 | Val  Acc: 0.6269
 Site-Infograph | Val  Loss: 1.7918 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8550 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0384 | Val  Acc: 0.3651
 Site-Painting  | Val  Loss: 1.5204 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.5604 | Val  Acc: 0.6154
 Site-QuickDraw | Val  Loss: 2.1861 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6474 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.6327 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5645
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6269
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3651
 Best site-Painting   | Epoch:3 | Val Acc: 0.5897
 Best site-Painting   | Epoch:3 | Val Acc: 0.6154
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-2
client-1 is in G-5
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-5
client-7 is in G-5
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[1, 2, 2, 1, 1, 5, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5327 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.6382 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5676 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 1.4436 | Train Acc: 0.7100
 Site-Infograph | Train Loss: 2.0640 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0634 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.8401 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.5573 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.5045 | Train Acc: 0.6780
 Site-QuickDraw | Train Loss: 2.3469 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.4891 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5093 | Train Acc: 0.7429
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-5
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-1
client-11 is in G-1
cnt=[5, 2, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5194 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.4914 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4090 | Train Acc: 0.6533
 Site-Clipart   | Train Loss: 1.3257 | Train Acc: 0.7400
 Site-Infograph | Train Loss: 2.0222 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0217 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7761 | Train Acc: 0.4787
 Site-Painting  | Train Loss: 1.4293 | Train Acc: 0.6780
 Site-Painting  | Train Loss: 1.2902 | Train Acc: 0.7542
 Site-QuickDraw | Train Loss: 2.3463 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2247 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3190 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2258 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4449 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 1.0952 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3588 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.6426 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7089 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8896 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.1794 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 1.1949 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.1330 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3398 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4439 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6598
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8462
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
cnt=[1, 2, 1, 4, 1, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3425 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2437 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3200 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1592 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 2.0568 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9251 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6435 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.3246 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1786 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3462 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.1915 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3887 | Train Acc: 0.7143
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-3
client-4 is in G-3
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-0
cnt=[2, 2, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2133 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3129 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1898 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0897 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9782 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9091 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5733 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.1835 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0465 | Train Acc: 0.8220
 Site-QuickDraw | Train Loss: 2.2896 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1891 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3533 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.0740 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2497 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0113 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1779 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5073 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5468 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7274 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 0.8571 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9452 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1143 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.0985 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2701 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7076
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4603
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1850 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2469 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1128 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0164 | Train Acc: 0.8200
 Site-Infograph | Train Loss: 2.0343 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8375 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5239 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 1.0774 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9502 | Train Acc: 0.8559
 Site-QuickDraw | Train Loss: 2.3529 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9549 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0606 | Train Acc: 0.7143
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-4
cnt=[1, 4, 2, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0297 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3144 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 1.0609 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8714 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9784 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7484 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4897 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0009 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.8794 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.3736 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9241 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1185 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0275 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1080 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7882 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0163 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3677 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4990 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6260 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7471 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.7915 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1053 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9411 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2065 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7189
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.8974
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7471
 Test site-Infograph | Epoch:9 | Test Acc: 0.4307
 Test site-Painting  | Epoch:9 | Test Acc: 0.8271
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2630
 Test site-Real      | Epoch:9 | Test Acc: 0.8644
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7310
Average Test Accuracy: 0.6439
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 3, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0696 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9635 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 1.0358 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 0.8688 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8829 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7152 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4653 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9409 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8403 | Train Acc: 0.9068
 Site-QuickDraw | Train Loss: 2.3379 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7512 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8381 | Train Acc: 0.7429
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1182 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2420 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9339 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8359 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9399 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7324 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.3742 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 0.9082 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 0.7348 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3182 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7592 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9674 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9486 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9136 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7161 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 0.9353 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 1.2309 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4411 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5828 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6416 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6516 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0300 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8273 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1220 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7425
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-5
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-5
client-5 is in G-4
client-6 is in G-2
client-7 is in G-3
client-8 is in G-4
client-9 is in G-0
client-10 is in G-4
client-11 is in G-0
cnt=[2, 2, 2, 1, 3, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0639 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0490 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9400 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7849 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9028 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6502 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3711 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.8781 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7274 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.2952 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8237 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0908 | Train Acc: 0.8571
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[2, 2, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8771 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1384 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8371 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6720 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9575 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6703 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3160 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8027 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.6544 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2365 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7558 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7865 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7924 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8596 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7225 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7914 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1688 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3705 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5201 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5824 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5220 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0210 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7450 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0358 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7605
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-4
client-8 is in G-3
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[1, 2, 3, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8176 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0585 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8020 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6887 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8615 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6302 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.2876 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.8527 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.6240 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3243 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6166 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8816 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7717 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9787 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7769 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6545 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9629 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6224 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2938 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7524 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5852 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3253 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6563 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0999 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7426 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7268 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5891 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.7922 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0195 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2749 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4779 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 0.4986 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4734 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0473 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6651 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9649 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7657
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5397
 Best site-Painting   | Epoch:15 | Val Acc: 0.9231
 Best site-Painting   | Epoch:15 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 2, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7579 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9063 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7469 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5754 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.8399 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5046 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3009 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.7322 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5730 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2992 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5767 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9448 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-2
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[1, 3, 4, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7506 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7906 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7415 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5497 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8688 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5861 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2359 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7159 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5617 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2770 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.6055 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9931 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.6585 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6628 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5211 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7412 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0873 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2118 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4039 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4687 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4851 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0293 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.6466 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8900 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8021
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4286
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-0
client-4 is in G-1
client-5 is in G-5
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[2, 3, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6852 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9297 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6974 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5833 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9016 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5734 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2304 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.6744 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.5427 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3182 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4694 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8587 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-4
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[2, 2, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7700 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8306 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7247 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.4559 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9165 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4871 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1518 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.5969 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.5011 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2702 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5681 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7667 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5579 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6672 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5244 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6183 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.0191 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1686 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3456 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4019 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4019 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 2.0119 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5861 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8557 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7766
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-1
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-0
client-11 is in G-4
cnt=[2, 3, 3, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6615 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7376 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6179 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5176 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9087 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4576 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1421 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5749 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4761 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1593 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.5573 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9272 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-2
client-3 is in G-3
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-4
cnt=[2, 5, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6760 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6617 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6550 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4144 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8663 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4456 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1366 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5897 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4243 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2256 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4574 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9978 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5323 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6180 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4331 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6538 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9098 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.0734 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3334 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3491 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3818 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0174 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5460 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7835 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8113
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:21 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6508
 Best site-Painting   | Epoch:21 | Val Acc: 0.9487
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-5
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-2
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 3, 1, 2, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6860 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6501 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6241 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4543 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8831 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4857 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1454 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5865 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.4543 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2456 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4073 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9922 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-0
client-8 is in G-4
client-9 is in G-3
client-10 is in G-4
client-11 is in G-3
cnt=[1, 2, 2, 3, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6002 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8134 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.5985 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4406 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8232 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4055 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0492 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.5463 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3840 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1809 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4489 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7427 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5066 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5374 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4580 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5749 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9861 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0882 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2073 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3337 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3470 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9542 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5091 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8715 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7936
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-2
client-6 is in G-5
client-7 is in G-0
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 3, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4814 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7376 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5967 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4337 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8723 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3499 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0754 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.5610 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3818 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1449 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4539 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6510 | Train Acc: 0.7714
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-1
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[4, 3, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5809 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5633 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5936 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4283 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9177 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4079 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0470 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5224 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3488 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.3042 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5038 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8128 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4081 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4564 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4327 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5656 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.8638 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1426 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2046 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3167 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3234 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9238 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4294 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.6877 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8036
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-5
client-9 is in G-3
client-10 is in G-5
client-11 is in G-4
cnt=[1, 3, 3, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5055 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6328 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5456 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.3924 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8717 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3583 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1073 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5243 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3390 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.1955 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3704 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7250 | Train Acc: 0.8286
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-2
client-1 is in G-3
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-3
client-7 is in G-0
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5276 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8159 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5786 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4220 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9008 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3228 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0493 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5309 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3409 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2306 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.3952 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7191 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4739 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3499 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3991 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5130 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.9405 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0476 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1808 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.2850 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 0.2644 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9536 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4653 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7580 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7892
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-1
client-3 is in G-0
client-4 is in G-5
client-5 is in G-4
client-6 is in G-3
client-7 is in G-4
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5469 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6113 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4973 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3600 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8420 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3346 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0403 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4972 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3219 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1637 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5494 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4667 | Train Acc: 0.8286
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-4
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-5
client-9 is in G-3
client-10 is in G-5
client-11 is in G-3
cnt=[3, 3, 1, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4911 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6077 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4875 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3509 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8850 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.2768 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0064 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.4487 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3536 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1971 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.3889 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5428 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3844 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3839 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3982 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5103 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 0.9496 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0435 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1729 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.3340 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2624 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8442 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4258 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7300 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8268
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5873
 Best site-Painting   | Epoch:29 | Val Acc: 0.9487
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.4286
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8384
 Test site-Infograph | Epoch:29 | Test Acc: 0.5160
 Test site-Painting  | Epoch:29 | Test Acc: 0.8982
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3000
 Test site-Real      | Epoch:29 | Test Acc: 0.9145
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8051
Average Test Accuracy: 0.7120
===2023-04-13 01:44:01===
===2023-04-13 01:44:02===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8384
 Test site-Infograph | Epoch:29 | Test Acc: 0.5068
 Test site-Painting  | Epoch:29 | Test Acc: 0.8998
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3010
 Test site-Real      | Epoch:29 | Test Acc: 0.9154
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8105
Average Test Accuracy: 0.7120
===2023-04-13 01:51:06===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
only train loss for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-1
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-5
cnt=[2, 4, 1, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1207 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1381 | Train Acc: 0.2600
 Site-Clipart   | Train Loss: 1.9417 | Train Acc: 0.4933
 Site-Clipart   | Train Loss: 1.9494 | Train Acc: 0.4100
 Site-Infograph | Train Loss: 2.1711 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.2497 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1121 | Train Acc: 0.3298
 Site-Painting  | Train Loss: 1.9860 | Train Acc: 0.3898
 Site-Painting  | Train Loss: 1.9422 | Train Acc: 0.4831
 Site-QuickDraw | Train Loss: 2.3642 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9828 | Train Acc: 0.3947
 Site-Sketch    | Train Loss: 1.9353 | Train Acc: 0.4000
 Site-Clipart   | Val  Loss: 1.8608 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0261 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8650 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9707 | Val  Acc: 0.3731
 Site-Infograph | Val  Loss: 2.0878 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1225 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1889 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8446 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8783 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2576 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9033 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.8977 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3731
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
cnt=[5, 2, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.9168 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8327 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.8022 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.8038 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.1373 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1668 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0272 | Train Acc: 0.4043
 Site-Painting  | Train Loss: 1.8974 | Train Acc: 0.4746
 Site-Painting  | Train Loss: 1.8134 | Train Acc: 0.5678
 Site-QuickDraw | Train Loss: 2.3557 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9099 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.7635 | Train Acc: 0.5429
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-2
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-2
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-1
cnt=[1, 5, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6850 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7590 | Train Acc: 0.5400
 Site-Clipart   | Train Loss: 1.6781 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6550 | Train Acc: 0.6100
 Site-Infograph | Train Loss: 2.1252 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.1558 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8875 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.6679 | Train Acc: 0.5763
 Site-Painting  | Train Loss: 1.6456 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.3298 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.5957 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.6848 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5184 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7684 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.5428 | Val  Acc: 0.6200
 Site-Clipart   | Val  Loss: 1.6845 | Val  Acc: 0.6119
 Site-Infograph | Val  Loss: 1.7941 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8579 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 2.0365 | Val  Acc: 0.3492
 Site-Painting  | Val  Loss: 1.4925 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.5487 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1966 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6441 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6175 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5698
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6200
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6119
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3492
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-Painting   | Epoch:3 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2381
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-2
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-0
client-9 is in G-5
client-10 is in G-0
client-11 is in G-0
cnt=[3, 4, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5415 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6589 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.5754 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.4538 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.0601 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0621 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.8366 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.5461 | Train Acc: 0.6949
 Site-Painting  | Train Loss: 1.4832 | Train Acc: 0.7119
 Site-QuickDraw | Train Loss: 2.3519 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5086 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.5000 | Train Acc: 0.7429
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-4
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-5
client-11 is in G-5
cnt=[5, 1, 1, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5132 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.4985 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4250 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3394 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.0221 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0219 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.7732 | Train Acc: 0.4681
 Site-Painting  | Train Loss: 1.4403 | Train Acc: 0.6949
 Site-Painting  | Train Loss: 1.3013 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3540 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2240 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3194 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2165 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4800 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.1194 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.3873 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.6414 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7188 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8863 | Val  Acc: 0.3968
 Site-Painting  | Val  Loss: 1.2061 | Val  Acc: 0.7949
 Site-Painting  | Val  Loss: 1.2115 | Val  Acc: 0.7821
 Site-QuickDraw | Val  Loss: 2.1175 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3380 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.4644 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6577
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3968
 Best site-Painting   | Epoch:5 | Val Acc: 0.7949
 Best site-Painting   | Epoch:5 | Val Acc: 0.7821
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-5
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
cnt=[1, 2, 1, 4, 1, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3283 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2439 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.3214 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1829 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0144 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9099 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.6468 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.3460 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.1988 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3495 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2258 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3946 | Train Acc: 0.7429
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-3
client-1 is in G-2
client-2 is in G-4
client-3 is in G-4
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-5
client-10 is in G-3
client-11 is in G-3
cnt=[2, 2, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1982 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3253 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.1846 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0948 | Train Acc: 0.8500
 Site-Infograph | Train Loss: 1.9548 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.8946 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5716 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.2001 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0765 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.2963 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.1896 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3738 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0750 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2742 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.0040 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.1781 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.4727 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5215 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7322 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8750 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.9611 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1089 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1136 | Val  Acc: 0.9600
 Site-Sketch    | Val  Loss: 1.2782 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7053
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9487
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9600
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1768 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2519 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1141 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 1.0169 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0377 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8325 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5196 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.0864 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9503 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.3626 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9640 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0762 | Train Acc: 0.7143
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-4
cnt=[1, 4, 2, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0312 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3192 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0608 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8675 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9743 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7471 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4825 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.0080 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8900 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.3872 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9233 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1206 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0227 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1088 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7856 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0157 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3516 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4824 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6182 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7587 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.7989 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1179 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.9495 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2081 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7191
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.9231
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2857
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7471
 Test site-Infograph | Epoch:9 | Test Acc: 0.4307
 Test site-Painting  | Epoch:9 | Test Acc: 0.8271
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2610
 Test site-Real      | Epoch:9 | Test Acc: 0.8644
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7238
Average Test Accuracy: 0.6424
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 3, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0349 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9547 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0324 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8684 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8526 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6909 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4567 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9496 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8479 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.3406 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7626 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8491 | Train Acc: 0.7429
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0971 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2413 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9280 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.8379 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9178 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7105 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3616 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.9121 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7535 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3209 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7812 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9664 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9169 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9468 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7165 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 0.9324 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.1804 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3983 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5677 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.6702 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6611 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0064 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8316 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1359 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7468
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5873
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-1
client-9 is in G-3
client-10 is in G-1
client-11 is in G-3
cnt=[2, 3, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0303 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0754 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9368 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7804 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.8834 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6215 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.3636 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.8795 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7368 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2984 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.8366 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0827 | Train Acc: 0.8286
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-5
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-3
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[2, 2, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8492 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.1181 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8285 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6685 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.9205 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6534 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3046 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8056 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.6555 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2501 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7751 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7993 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7946 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8879 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.7210 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7778 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.1381 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3618 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5138 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.5805 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.5242 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0201 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7562 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0397 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7808
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6349
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-Painting   | Epoch:13 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-3
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[3, 3, 2, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7892 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 1.0576 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.7849 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.6899 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.8260 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6043 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2810 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.8612 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.6307 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3343 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6313 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8999 | Train Acc: 0.8286
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-4
client-1 is in G-5
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-4
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7313 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9575 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7792 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6601 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.9365 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5825 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2740 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7370 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5960 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3367 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6446 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0997 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7336 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7794 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5973 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8284 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.9728 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2458 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4684 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 0.5127 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4731 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0443 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6765 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9750 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7688
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-2
client-1 is in G-3
client-2 is in G-3
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-5
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 2, 2, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7536 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9139 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7524 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5725 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8228 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4720 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2916 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7216 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.5706 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2949 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.5826 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9515 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-4
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-1
client-6 is in G-4
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 3, 3, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7424 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8022 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7297 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.5590 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8255 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5709 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2060 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.7167 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5562 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.3044 | Train Acc: 0.0938
 Site-Real      | Train Loss: 0.5985 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0152 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6523 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6578 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5132 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.7460 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0772 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2172 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3776 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4489 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4848 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0167 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6395 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9384 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7823
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3810
 Best site-Real       | Epoch:17 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-5
client-3 is in G-0
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 3, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6527 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9360 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7032 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.5860 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.8893 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5618 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1978 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.6673 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.5517 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3373 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4679 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8377 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-4
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[2, 2, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7216 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8362 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7203 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.4586 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8741 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4718 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1425 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.5902 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.5065 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2880 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5811 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7756 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5731 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6683 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5166 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.6247 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.0816 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1840 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3282 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4113 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3940 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9876 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5808 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8999 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7717
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-1
client-1 is in G-1
client-2 is in G-3
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-4
client-11 is in G-0
cnt=[3, 3, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6128 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7363 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6119 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5157 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8639 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4401 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1353 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5769 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.4823 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1640 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.5387 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9365 | Train Acc: 0.8571
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-4
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-2
client-10 is in G-1
client-11 is in G-3
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6212 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.6676 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6369 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4090 | Train Acc: 0.9900
 Site-Infograph | Train Loss: 1.8377 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4374 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1328 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5902 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.4241 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2367 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4365 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.0085 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5303 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6431 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4457 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6541 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8651 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0691 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3108 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3352 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3770 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9861 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5398 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8310 | Val  Acc: 0.8696
Average Valid Accuracy: 0.8075
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8806
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6667
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8696
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-2
client-1 is in G-3
client-2 is in G-5
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-4
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[3, 4, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6457 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6588 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6177 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4573 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8427 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4550 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1350 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5722 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4459 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2565 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3925 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0070 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-4
client-1 is in G-1
client-2 is in G-5
client-3 is in G-4
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5750 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.8225 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.5842 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4411 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.7963 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3833 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0457 | Train Acc: 0.7340
 Site-Painting  | Train Loss: 0.5352 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3770 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1961 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4478 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7367 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5145 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4623 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4493 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.5850 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.0102 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1097 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2012 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3391 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3487 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9635 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4846 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9045 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7986
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-3
client-6 is in G-2
client-7 is in G-4
client-8 is in G-3
client-9 is in G-0
client-10 is in G-3
client-11 is in G-0
cnt=[3, 3, 1, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4633 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7428 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6011 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4334 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8555 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3288 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0518 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5654 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3775 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1503 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4375 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6533 | Train Acc: 0.8000
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-4
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-3
client-8 is in G-5
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[1, 2, 3, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5482 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5500 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5805 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4194 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9244 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3915 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0331 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.5385 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3587 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.3366 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4861 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8425 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4114 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4205 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4224 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5804 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8971 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1551 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1970 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3186 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3271 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9095 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.4388 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7573 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7967
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-2
client-1 is in G-0
client-2 is in G-5
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-1
cnt=[3, 1, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4830 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6195 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5363 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4005 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8379 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3330 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0958 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5162 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3362 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.2125 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3667 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7308 | Train Acc: 0.8000
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-3
client-4 is in G-5
client-5 is in G-0
client-6 is in G-3
client-7 is in G-2
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 2, 3, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5088 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8035 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5616 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4230 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8631 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.2984 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0382 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5313 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3558 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2473 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.3979 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7393 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4917 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3974 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3986 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5237 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 0.9261 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0332 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1904 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2703 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2602 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9693 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4645 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7769 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7977
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-2
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[3, 2, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5246 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6176 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5070 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3718 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8173 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.3306 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0416 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5029 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3232 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.1943 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5384 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4495 | Train Acc: 0.8857
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-4
client-5 is in G-1
client-6 is in G-5
client-7 is in G-1
client-8 is in G-5
client-9 is in G-3
client-10 is in G-5
client-11 is in G-3
cnt=[3, 2, 1, 2, 1, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4764 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6034 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4787 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3627 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8283 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2635 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0055 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4733 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3636 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2198 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.3860 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5149 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3797 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.3451 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.3919 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5142 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 0.9511 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0481 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1951 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3421 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.2649 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8208 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4394 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.7700 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8172
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9254
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6190
 Best site-Painting   | Epoch:29 | Val Acc: 0.9744
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8479
 Test site-Infograph | Epoch:29 | Test Acc: 0.5114
 Test site-Painting  | Epoch:29 | Test Acc: 0.9031
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.2950
 Test site-Real      | Epoch:29 | Test Acc: 0.9211
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8069
Average Test Accuracy: 0.7142
===2023-04-13 02:35:25===
===2023-04-13 02:35:26===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8479
 Test site-Infograph | Epoch:29 | Test Acc: 0.5038
 Test site-Painting  | Epoch:29 | Test Acc: 0.9031
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.2980
 Test site-Real      | Epoch:29 | Test Acc: 0.9211
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8141
Average Test Accuracy: 0.7147
===2023-04-13 02:40:34===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
train acc for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0597 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.1425 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.0397 | Val  Acc: 0.2600
 Site-Clipart   | Val  Loss: 2.0882 | Val  Acc: 0.2985
 Site-Infograph | Val  Loss: 2.1781 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.1408 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.2459 | Val  Acc: 0.1587
 Site-Painting  | Val  Loss: 2.0185 | Val  Acc: 0.4615
 Site-Painting  | Val  Loss: 2.0810 | Val  Acc: 0.3718
 Site-QuickDraw | Val  Loss: 2.2523 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1080 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.0487 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2812
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2600
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2985
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1587
 Best site-Painting   | Epoch:0 | Val Acc: 0.4615
 Best site-Painting   | Epoch:0 | Val Acc: 0.3718
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-4
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.0461 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.9848 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9817 | Train Acc: 0.4267
 Site-Clipart   | Train Loss: 1.9762 | Train Acc: 0.3500
 Site-Infograph | Train Loss: 2.2034 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.2416 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.1077 | Train Acc: 0.3404
 Site-Painting  | Train Loss: 1.9667 | Train Acc: 0.4237
 Site-Painting  | Train Loss: 1.9574 | Train Acc: 0.4576
 Site-QuickDraw | Train Loss: 2.2899 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.9889 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.9292 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 1.8241 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0175 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.7780 | Val  Acc: 0.4600
 Site-Clipart   | Val  Loss: 1.9579 | Val  Acc: 0.4030
 Site-Infograph | Val  Loss: 2.0321 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0818 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1837 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8499 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8831 | Val  Acc: 0.5128
 Site-QuickDraw | Val  Loss: 2.2719 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 1.9046 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.9686 | Val  Acc: 0.4348
Average Valid Accuracy: 0.4168
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4030
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5128
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-Real       | Epoch:1 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-3
client-1 is in G-0
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
cnt=[1, 6, 1, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.8249 | Train Acc: 0.4400
 Site-Clipart   | Train Loss: 1.9367 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.7726 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.7879 | Train Acc: 0.4700
 Site-Infograph | Train Loss: 2.1728 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.1975 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.9913 | Train Acc: 0.3723
 Site-Painting  | Train Loss: 1.8384 | Train Acc: 0.4915
 Site-Painting  | Train Loss: 1.7685 | Train Acc: 0.5508
 Site-QuickDraw | Train Loss: 2.2923 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.8523 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.7311 | Train Acc: 0.5429
 Site-Clipart   | Val  Loss: 1.7153 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8995 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.6979 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.7941 | Val  Acc: 0.4776
 Site-Infograph | Val  Loss: 1.9614 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0238 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1073 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.6500 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.7318 | Val  Acc: 0.5513
 Site-QuickDraw | Val  Loss: 2.2615 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.7923 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.7903 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4911
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4776
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.6154
 Best site-Painting   | Epoch:2 | Val Acc: 0.5513
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-Real       | Epoch:2 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-5
client-10 is in G-1
client-11 is in G-0
cnt=[1, 7, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6775 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.8506 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.6534 | Train Acc: 0.6267
 Site-Clipart   | Train Loss: 1.6194 | Train Acc: 0.6400
 Site-Infograph | Train Loss: 2.1075 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1132 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9143 | Train Acc: 0.4362
 Site-Painting  | Train Loss: 1.6786 | Train Acc: 0.5932
 Site-Painting  | Train Loss: 1.6089 | Train Acc: 0.5932
 Site-QuickDraw | Train Loss: 2.3111 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6281 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.5593 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5082 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.7200 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.5047 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6847 | Val  Acc: 0.6119
 Site-Infograph | Val  Loss: 1.8571 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9212 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0653 | Val  Acc: 0.3175
 Site-Painting  | Val  Loss: 1.4751 | Val  Acc: 0.6410
 Site-Painting  | Val  Loss: 1.5158 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.2104 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6623 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.6214 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5938
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6119
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3175
 Best site-Painting   | Epoch:3 | Val Acc: 0.6410
 Best site-Painting   | Epoch:3 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-4
cnt=[2, 3, 1, 4, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5977 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.6986 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.5019 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5073 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.1151 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0667 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.8117 | Train Acc: 0.4362
 Site-Painting  | Train Loss: 1.5908 | Train Acc: 0.6271
 Site-Painting  | Train Loss: 1.4968 | Train Acc: 0.6864
 Site-QuickDraw | Train Loss: 2.2916 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.5346 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5462 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.4225 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4813 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.3600 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5150 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 1.7122 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8434 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9570 | Val  Acc: 0.4127
 Site-Painting  | Val  Loss: 1.3089 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 1.3395 | Val  Acc: 0.7308
 Site-QuickDraw | Val  Loss: 2.2292 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.4840 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.6244 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6220
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7313
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4127
 Best site-Painting   | Epoch:4 | Val Acc: 0.8462
 Best site-Painting   | Epoch:4 | Val Acc: 0.7308
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1905
 Best site-Real       | Epoch:4 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-4
client-1 is in G-4
client-2 is in G-0
client-3 is in G-4
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-5
client-9 is in G-3
client-10 is in G-5
client-11 is in G-0
cnt=[4, 1, 1, 1, 3, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.4728 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5596 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4525 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3319 | Train Acc: 0.7900
 Site-Infograph | Train Loss: 2.0273 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0231 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7473 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.4375 | Train Acc: 0.6949
 Site-Painting  | Train Loss: 1.3177 | Train Acc: 0.7034
 Site-QuickDraw | Train Loss: 2.3078 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.3404 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.5419 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3277 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4426 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.1423 | Val  Acc: 0.7200
 Site-Clipart   | Val  Loss: 1.3801 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5797 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.7505 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8600 | Val  Acc: 0.4127
 Site-Painting  | Val  Loss: 1.2201 | Val  Acc: 0.7949
 Site-Painting  | Val  Loss: 1.2271 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.1835 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3452 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3502 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6764
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7200
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4127
 Best site-Painting   | Epoch:5 | Val Acc: 0.7949
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-4
client-1 is in G-0
client-2 is in G-2
client-3 is in G-4
client-4 is in G-1
client-5 is in G-3
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-5
client-10 is in G-3
client-11 is in G-1
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3177 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3480 | Train Acc: 0.5800
 Site-Clipart   | Train Loss: 1.2813 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.2205 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.0115 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9608 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6728 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 1.3482 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.2001 | Train Acc: 0.7712
 Site-QuickDraw | Train Loss: 2.3089 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2305 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0970 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1680 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3843 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.0225 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.3191 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.5040 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6407 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8413 | Val  Acc: 0.3968
 Site-Painting  | Val  Loss: 1.0468 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 1.0591 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1167 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.2005 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3969 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6756
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-5
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-2
client-8 is in G-1
client-9 is in G-0
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 2, 2, 2, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2323 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.5148 | Train Acc: 0.6600
 Site-Clipart   | Train Loss: 1.2697 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 0.9844 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0095 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.8900 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5986 | Train Acc: 0.5213
 Site-Painting  | Train Loss: 1.2251 | Train Acc: 0.7458
 Site-Painting  | Train Loss: 1.0295 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.2858 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.1202 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3372 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1056 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2520 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 0.8921 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1629 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 1.4572 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5893 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7113 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 0.9598 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.9527 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 2.1022 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0803 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.3758 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6880
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4603
 Best site-Painting   | Epoch:7 | Val Acc: 0.8718
 Best site-Painting   | Epoch:7 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2381
 Best site-Real       | Epoch:7 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-5
client-8 is in G-0
client-9 is in G-1
client-10 is in G-0
client-11 is in G-1
cnt=[3, 3, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0630 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.1998 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.1988 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 0.9494 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 2.0769 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8321 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5703 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.0305 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.9810 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.3289 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1048 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0557 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0952 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1666 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8699 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1452 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.4303 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5824 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7161 | Val  Acc: 0.4921
 Site-Painting  | Val  Loss: 0.8899 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 0.8619 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0447 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0263 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1980 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7068
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:8 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4921
 Best site-Painting   | Epoch:8 | Val Acc: 0.8462
 Best site-Painting   | Epoch:8 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.2381
 Best site-Real       | Epoch:8 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:8 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 1, 2, 4, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2307 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.0956 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0772 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 0.9973 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 1.9714 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7822 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.4993 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 0.9895 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.8578 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.3121 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.9319 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.0772 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0269 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0821 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7590 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.0360 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 1.3787 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5159 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.6796 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.8129 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.7992 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 2.0443 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9488 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2221 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7220
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.8718
 Best site-Painting   | Epoch:9 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7338
 Test site-Infograph | Epoch:9 | Test Acc: 0.4216
 Test site-Painting  | Epoch:9 | Test Acc: 0.8223
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2530
 Test site-Real      | Epoch:9 | Test Acc: 0.8652
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7112
Average Test Accuracy: 0.6345
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-5
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.9469 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.2050 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.0005 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.8189 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8978 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7476 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.4347 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9506 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7795 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.2746 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.7798 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.3022 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9277 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9909 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7327 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9207 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.2276 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4564 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.6146 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 0.6623 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.7043 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0286 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8914 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1030 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7453
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:10 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5079
 Best site-Painting   | Epoch:10 | Val Acc: 0.9744
 Best site-Painting   | Epoch:10 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3333
 Best site-Real       | Epoch:10 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 3, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0444 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.2605 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9659 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 0.7674 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 2.0264 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.7553 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.4219 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8981 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.7290 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2862 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7012 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8761 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9163 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9837 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6648 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.9316 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.1902 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3997 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6243 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 0.6939 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6461 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0286 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8917 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1092 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7361
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-5
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-4
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 2, 2, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.9594 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.0064 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8783 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7013 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.9422 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6869 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3935 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.8928 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.6937 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.3220 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7630 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9509 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8132 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7942 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6673 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9143 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 1.2082 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3950 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5543 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.6360 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.6244 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0979 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7427 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0500 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7374
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-5
client-3 is in G-5
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8075 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0232 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 0.9533 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7519 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9990 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.6373 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3813 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.8182 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.6217 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.2524 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6928 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7999 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7372 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8230 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6347 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8483 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 1.1619 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3572 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4933 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5673 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.6131 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0136 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6864 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0141 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7803
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5873
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3810
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-5
client-3 is in G-1
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-4
client-11 is in G-3
cnt=[3, 2, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8545 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9924 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.8229 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.7042 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9415 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5785 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2826 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.7176 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.6600 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.2934 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7800 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8880 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8332 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8087 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5931 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.8094 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 1.0760 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3027 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4607 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4839 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.5056 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0439 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7298 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0051 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7681
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-2
client-3 is in G-5
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 2, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8212 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9710 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.7983 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6698 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9574 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6463 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2648 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.7590 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5779 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2601 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6161 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9827 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6386 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6880 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6504 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.7471 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.1135 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3077 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4384 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5370 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.5444 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.9690 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6733 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9574 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7818
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5873
 Best site-Painting   | Epoch:15 | Val Acc: 0.9487
 Best site-Painting   | Epoch:15 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.3333
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-5
client-1 is in G-4
client-2 is in G-2
client-3 is in G-4
client-4 is in G-5
client-5 is in G-0
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-1
client-10 is in G-3
client-11 is in G-1
cnt=[3, 2, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8898 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9999 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8019 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5885 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8457 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5819 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2148 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.6594 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5919 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.2244 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5504 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.7780 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6510 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7146 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5340 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6794 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.0405 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2284 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4497 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.5317 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.4580 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0156 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6362 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9712 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7767
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-4
cnt=[1, 2, 4, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7444 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8341 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.7671 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6279 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9298 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.5411 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1854 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.7190 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5709 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2255 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5204 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6435 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6388 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6221 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5384 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7004 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0682 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2280 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4070 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.4624 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4634 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 1.9773 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6069 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9116 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7776
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-4
client-3 is in G-5
client-4 is in G-3
client-5 is in G-2
client-6 is in G-1
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 3, 4, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6511 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7272 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7004 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.5188 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9223 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4330 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1612 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.6250 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.5445 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3050 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5682 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7122 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5669 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6106 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5765 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6767 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9891 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2027 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3744 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.3995 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4420 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9444 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6164 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9639 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7926
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8657
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:18 | Val Acc: 0.6032
 Best site-Painting   | Epoch:18 | Val Acc: 1.0000
 Best site-Painting   | Epoch:18 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.3333
 Best site-Real       | Epoch:18 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:18 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-0
client-4 is in G-5
client-5 is in G-1
client-6 is in G-3
client-7 is in G-2
client-8 is in G-1
client-9 is in G-5
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6287 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7771 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6623 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5120 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9197 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5224 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.1528 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.6668 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4720 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2644 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5455 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7701 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5298 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6883 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4731 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6699 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.1480 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1801 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3449 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.4059 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4433 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.8828 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5906 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8634 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7895
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-4
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-5
client-8 is in G-2
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[4, 2, 1, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7188 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8723 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6598 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4972 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9235 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4477 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1643 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.6807 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.4629 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1929 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.5296 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9158 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5927 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6211 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4774 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7120 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.9539 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1235 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2735 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3641 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3715 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9619 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5321 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9477 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7946
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6190
 Best site-Painting   | Epoch:20 | Val Acc: 1.0000
 Best site-Painting   | Epoch:20 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.2857
 Best site-Real       | Epoch:20 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-0
client-1 is in G-3
client-2 is in G-4
client-3 is in G-4
client-4 is in G-0
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-5
client-10 is in G-1
client-11 is in G-0
cnt=[3, 2, 3, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6132 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8110 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.6948 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4429 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8648 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.4176 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1112 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5956 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4424 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2588 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4749 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6855 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5123 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6120 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5120 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6325 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.8844 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1135 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.2375 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3586 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3682 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.8907 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5004 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8187 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8120
 Best site-Clipart    | Epoch:21 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6508
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3810
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-2
client-1 is in G-4
client-2 is in G-3
client-3 is in G-1
client-4 is in G-2
client-5 is in G-5
client-6 is in G-5
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-2
cnt=[1, 1, 4, 3, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5560 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7618 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6234 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4545 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8472 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.4109 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1168 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5678 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.4503 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2138 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.4723 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5906 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4955 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6452 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4491 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.6223 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.9710 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1918 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2586 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.3688 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3625 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9153 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5582 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8445 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7975
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-5
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-3
client-9 is in G-2
client-10 is in G-3
client-11 is in G-4
cnt=[1, 2, 3, 3, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5986 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7570 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6296 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5064 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9172 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4051 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1146 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6183 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4524 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.3151 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4130 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6541 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.4390 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4676 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4429 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5547 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.9736 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0958 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2960 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3257 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3515 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.8829 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4518 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8102 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7993
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-0
client-9 is in G-3
client-10 is in G-1
client-11 is in G-5
cnt=[3, 1, 2, 4, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6472 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6158 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5713 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4458 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8177 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.4348 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0762 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5335 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3561 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2207 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4901 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6462 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5052 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4790 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4329 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5731 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.9312 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1986 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2528 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3074 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3117 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9653 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5075 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.7851 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7964
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-0
client-5 is in G-5
client-6 is in G-4
client-7 is in G-1
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[3, 2, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4945 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6172 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5391 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3768 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8425 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3402 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9765 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.5763 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3485 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.1281 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4513 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6615 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4725 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4931 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4213 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5975 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.9509 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0934 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1456 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2917 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3231 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.8591 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4604 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9120 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8064
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-2
client-1 is in G-5
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-1
client-6 is in G-1
client-7 is in G-3
client-8 is in G-1
client-9 is in G-2
client-10 is in G-4
client-11 is in G-0
cnt=[3, 3, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4943 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6353 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5206 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4271 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.9094 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3634 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0641 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.4900 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3631 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.1766 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3981 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5756 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4566 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4741 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4474 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.5452 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.8122 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0199 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1460 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3083 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3208 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9152 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.4589 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8679 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7920
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-1
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-5
client-5 is in G-3
client-6 is in G-4
client-7 is in G-4
client-8 is in G-2
client-9 is in G-5
client-10 is in G-2
client-11 is in G-0
cnt=[2, 3, 2, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6277 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6624 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5162 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3540 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8132 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3563 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0012 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.4569 | Train Acc: 0.9492
 Site-Painting  | Train Loss: 0.3306 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1246 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.3887 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7520 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5064 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4170 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4000 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5578 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.7891 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9555 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1362 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2470 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2905 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9060 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5025 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8355 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8084
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-2
client-1 is in G-0
client-2 is in G-5
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[3, 1, 2, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5762 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6770 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5260 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.3514 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8836 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3186 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0411 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.4997 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3015 | Train Acc: 0.9746
 Site-QuickDraw | Train Loss: 2.1035 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.4730 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6874 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4338 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4087 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3855 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5537 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.8800 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 0.9815 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1777 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3129 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.2753 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.7868 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4665 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8342 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8166
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6667
 Best site-Painting   | Epoch:28 | Val Acc: 0.9744
 Best site-Painting   | Epoch:28 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.4286
 Best site-Real       | Epoch:28 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:28 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-5
client-7 is in G-0
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 1, 2, 1, 3, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4463 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.8806 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5118 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3293 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9277 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3662 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9730 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.4993 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.3837 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.0963 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3523 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6561 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4843 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4514 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4544 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4870 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 0.8050 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0802 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1334 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.2957 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2979 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 1.9125 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4277 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8182 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7900
===2023-04-13 03:25:49===
===2023-04-13 03:25:51===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:28 | Test Acc: 0.8422
 Test site-Infograph | Epoch:28 | Test Acc: 0.5068
 Test site-Painting  | Epoch:28 | Test Acc: 0.8918
 Test site-QuickDraw | Epoch:28 | Test Acc: 0.3010
 Test site-Real      | Epoch:28 | Test Acc: 0.9113
 Test site-Sketch    | Epoch:28 | Test Acc: 0.8032
Average Test Accuracy: 0.7094
===2023-04-13 03:27:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
val loss for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
kmeans
client-0 is in G-5
client-1 is in G-5
client-2 is in G-1
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 3, 1, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1097 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2525 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0848 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0804 | Train Acc: 0.2700
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2788 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1982 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1715 | Train Acc: 0.3729
 Site-Painting  | Train Loss: 2.0990 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3954 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1779 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1419 | Train Acc: 0.2857
 Site-Clipart   | Val  Loss: 2.0597 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.1425 | Val  Acc: 0.3636
 Site-Clipart   | Val  Loss: 2.0397 | Val  Acc: 0.2600
 Site-Clipart   | Val  Loss: 2.0882 | Val  Acc: 0.2985
 Site-Infograph | Val  Loss: 2.1781 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.1408 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.2459 | Val  Acc: 0.1587
 Site-Painting  | Val  Loss: 2.0185 | Val  Acc: 0.4615
 Site-Painting  | Val  Loss: 2.0810 | Val  Acc: 0.3718
 Site-QuickDraw | Val  Loss: 2.2523 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 2.1080 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.0487 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2812
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3636
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2600
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2985
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1587
 Best site-Painting   | Epoch:0 | Val Acc: 0.4615
 Best site-Painting   | Epoch:0 | Val Acc: 0.3718
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0952
 Best site-Real       | Epoch:0 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 2 ============
============ Train epoch 3 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-1
client-3 is in G-5
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-4
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.0519 | Train Acc: 0.3200
 Site-Clipart   | Train Loss: 1.9955 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 1.9809 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9792 | Train Acc: 0.3400
 Site-Infograph | Train Loss: 2.2039 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2533 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1110 | Train Acc: 0.3085
 Site-Painting  | Train Loss: 1.9696 | Train Acc: 0.4576
 Site-Painting  | Train Loss: 1.9578 | Train Acc: 0.4746
 Site-QuickDraw | Train Loss: 2.2937 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.9910 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9251 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 1.8140 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 2.0151 | Val  Acc: 0.4545
 Site-Clipart   | Val  Loss: 1.7792 | Val  Acc: 0.4600
 Site-Clipart   | Val  Loss: 1.9557 | Val  Acc: 0.4030
 Site-Infograph | Val  Loss: 2.0346 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.0899 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1907 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.8443 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8798 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.2553 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9140 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.9739 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4147
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4545
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4600
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4030
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1429
 Best site-Real       | Epoch:1 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
kmeans
client-0 is in G-3
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[1, 1, 6, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.8183 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9386 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 1.7717 | Train Acc: 0.5067
 Site-Clipart   | Train Loss: 1.7908 | Train Acc: 0.4700
 Site-Infograph | Train Loss: 2.1634 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2053 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.9969 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.8341 | Train Acc: 0.4915
 Site-Painting  | Train Loss: 1.7607 | Train Acc: 0.5593
 Site-QuickDraw | Train Loss: 2.2850 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.8376 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.7194 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.7170 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8960 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.7021 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.7886 | Val  Acc: 0.4478
 Site-Infograph | Val  Loss: 1.9672 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0323 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.1129 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.6334 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 1.7213 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2529 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.7888 | Val  Acc: 0.5200
 Site-Sketch    | Val  Loss: 1.8019 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4780
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:2 | Val Acc: 0.4478
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-Painting   | Epoch:2 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-Real       | Epoch:2 | Val Acc: 0.5200
 Best site-Sketch     | Epoch:2 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 6 ============
============ Train epoch 7 ============
kmeans
client-0 is in G-2
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-5
client-10 is in G-1
client-11 is in G-0
cnt=[1, 7, 1, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6734 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.8572 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.6554 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 1.6171 | Train Acc: 0.6400
 Site-Infograph | Train Loss: 2.1093 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1103 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9137 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.6785 | Train Acc: 0.6102
 Site-Painting  | Train Loss: 1.6074 | Train Acc: 0.6102
 Site-QuickDraw | Train Loss: 2.3070 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.6242 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.5539 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5164 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.7216 | Val  Acc: 0.7879
 Site-Clipart   | Val  Loss: 1.5016 | Val  Acc: 0.6600
 Site-Clipart   | Val  Loss: 1.6860 | Val  Acc: 0.6119
 Site-Infograph | Val  Loss: 1.8547 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9106 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 2.0631 | Val  Acc: 0.3175
 Site-Painting  | Val  Loss: 1.4693 | Val  Acc: 0.6154
 Site-Painting  | Val  Loss: 1.5088 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.2071 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6417 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.6246 | Val  Acc: 0.6522
Average Valid Accuracy: 0.5876
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7879
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6600
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6119
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3175
 Best site-Painting   | Epoch:3 | Val Acc: 0.6154
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2857
 Best site-Real       | Epoch:3 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-2
client-6 is in G-3
client-7 is in G-3
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-1
cnt=[2, 1, 3, 4, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5957 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7201 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.5047 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5084 | Train Acc: 0.7300
 Site-Infograph | Train Loss: 2.1271 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0479 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.8055 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.5843 | Train Acc: 0.6271
 Site-Painting  | Train Loss: 1.4759 | Train Acc: 0.6949
 Site-QuickDraw | Train Loss: 2.2882 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.5189 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5435 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.4129 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.4777 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.3529 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.5251 | Val  Acc: 0.7015
 Site-Infograph | Val  Loss: 1.7272 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8198 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9623 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.2981 | Val  Acc: 0.8462
 Site-Painting  | Val  Loss: 1.3301 | Val  Acc: 0.7051
 Site-QuickDraw | Val  Loss: 2.2244 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.4798 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.6277 | Val  Acc: 0.4783
Average Valid Accuracy: 0.6115
 Best site-Clipart    | Epoch:4 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7015
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-Painting   | Epoch:4 | Val Acc: 0.8462
 Best site-Painting   | Epoch:4 | Val Acc: 0.7051
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1905
 Best site-Real       | Epoch:4 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 10 ============
============ Train epoch 11 ============
kmeans
client-0 is in G-4
client-1 is in G-4
client-2 is in G-1
client-3 is in G-4
client-4 is in G-3
client-5 is in G-5
client-6 is in G-1
client-7 is in G-1
client-8 is in G-2
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
cnt=[1, 3, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.4616 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.5534 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.4606 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3376 | Train Acc: 0.7600
 Site-Infograph | Train Loss: 2.0233 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0109 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7492 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.4244 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.2959 | Train Acc: 0.7373
 Site-QuickDraw | Train Loss: 2.3077 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.3405 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.5522 | Train Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3273 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4505 | Val  Acc: 0.6970
 Site-Clipart   | Val  Loss: 1.1547 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3888 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.6007 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7360 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.8599 | Val  Acc: 0.4127
 Site-Painting  | Val  Loss: 1.2166 | Val  Acc: 0.7949
 Site-Painting  | Val  Loss: 1.2151 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.1842 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3438 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3434 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6560
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6970
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4127
 Best site-Painting   | Epoch:5 | Val Acc: 0.7949
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
kmeans
client-0 is in G-1
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-0
client-6 is in G-5
client-7 is in G-0
client-8 is in G-5
client-9 is in G-4
client-10 is in G-0
client-11 is in G-3
cnt=[3, 3, 1, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2805 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.3362 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.2788 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 1.2149 | Train Acc: 0.7700
 Site-Infograph | Train Loss: 2.0079 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9544 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6588 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.3398 | Train Acc: 0.7627
 Site-Painting  | Train Loss: 1.1864 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.3176 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.2339 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0795 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1740 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3975 | Val  Acc: 0.7576
 Site-Clipart   | Val  Loss: 1.0395 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.3353 | Val  Acc: 0.6716
 Site-Infograph | Val  Loss: 1.5438 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6174 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8466 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.0372 | Val  Acc: 0.8974
 Site-Painting  | Val  Loss: 1.0436 | Val  Acc: 0.8590
 Site-QuickDraw | Val  Loss: 2.1065 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.2081 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.4366 | Val  Acc: 0.4348
Average Valid Accuracy: 0.6704
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7576
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:6 | Val Acc: 0.6716
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.8974
 Best site-Painting   | Epoch:6 | Val Acc: 0.8590
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.2857
 Best site-Real       | Epoch:6 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 14 ============
============ Train epoch 15 ============
kmeans
client-0 is in G-4
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-5
client-5 is in G-2
client-6 is in G-2
client-7 is in G-1
client-8 is in G-2
client-9 is in G-3
client-10 is in G-1
client-11 is in G-3
cnt=[2, 2, 4, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2056 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.4951 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.2666 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 0.9812 | Train Acc: 0.8300
 Site-Infograph | Train Loss: 1.9671 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.8880 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.6045 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.2316 | Train Acc: 0.7627
 Site-Painting  | Train Loss: 1.0416 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2855 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.1479 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3139 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1108 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2786 | Val  Acc: 0.8182
 Site-Clipart   | Val  Loss: 0.9049 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.1937 | Val  Acc: 0.7463
 Site-Infograph | Val  Loss: 1.4351 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5893 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7380 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 0.9740 | Val  Acc: 0.8718
 Site-Painting  | Val  Loss: 0.9680 | Val  Acc: 0.8590
 Site-QuickDraw | Val  Loss: 2.0833 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1127 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3872 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7111
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8182
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7463
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4444
 Best site-Painting   | Epoch:7 | Val Acc: 0.8718
 Best site-Painting   | Epoch:7 | Val Acc: 0.8590
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2857
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-5
client-5 is in G-3
client-6 is in G-5
client-7 is in G-1
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[2, 1, 2, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0102 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1973 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2057 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.9464 | Train Acc: 0.8400
 Site-Infograph | Train Loss: 2.0885 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8578 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.5720 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.0434 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.9830 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3345 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1242 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0159 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0897 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1894 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.8729 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.1689 | Val  Acc: 0.7313
 Site-Infograph | Val  Loss: 1.4357 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5770 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7116 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 0.9034 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 0.8686 | Val  Acc: 0.8974
 Site-QuickDraw | Val  Loss: 2.0344 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0235 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2057 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7038
============ Train epoch 18 ============
============ Train epoch 19 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-4
client-3 is in G-4
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 1, 2, 4, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1913 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0937 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0966 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 0.9919 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9719 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7977 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4750 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9911 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.8595 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.3266 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.9613 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0554 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0260 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1070 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7640 | Val  Acc: 0.7800
 Site-Clipart   | Val  Loss: 1.0347 | Val  Acc: 0.7761
 Site-Infograph | Val  Loss: 1.3873 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5140 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7003 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 0.7979 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.8211 | Val  Acc: 0.8846
 Site-QuickDraw | Val  Loss: 2.0207 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.0088 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2405 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7377
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7800
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7761
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5397
 Best site-Painting   | Epoch:9 | Val Acc: 0.9231
 Best site-Painting   | Epoch:9 | Val Acc: 0.8846
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3810
 Best site-Real       | Epoch:9 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7338
 Test site-Infograph | Epoch:9 | Test Acc: 0.4110
 Test site-Painting  | Epoch:9 | Test Acc: 0.8126
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2460
 Test site-Real      | Epoch:9 | Test Acc: 0.8620
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7076
Average Test Accuracy: 0.6288
============ Train epoch 20 ============
============ Train epoch 21 ============
kmeans
client-0 is in G-5
client-1 is in G-2
client-2 is in G-1
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-2
client-7 is in G-0
client-8 is in G-3
client-9 is in G-4
client-10 is in G-3
client-11 is in G-4
cnt=[1, 2, 3, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.9134 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2326 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.0133 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8094 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8877 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7531 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4300 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.9453 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7913 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.2797 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.7888 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.2851 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9166 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9830 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7491 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9341 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.1972 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4272 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6122 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6920 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.7169 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0081 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9196 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1303 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7564
 Best site-Clipart    | Epoch:10 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:10 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:10 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:10 | Val Acc: 0.5714
 Best site-Painting   | Epoch:10 | Val Acc: 0.9744
 Best site-Painting   | Epoch:10 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.3333
 Best site-Real       | Epoch:10 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:10 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 22 ============
============ Train epoch 23 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-4
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 2, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.9937 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.2512 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9466 | Train Acc: 0.7733
 Site-Clipart   | Train Loss: 0.7511 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 2.0217 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.7559 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4108 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.8938 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7403 | Train Acc: 0.9068
 Site-QuickDraw | Train Loss: 2.2851 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7069 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8430 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9230 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0226 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6545 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9205 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.1816 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3970 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6035 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 0.7097 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6570 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0089 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8966 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1352 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7535
============ Train epoch 24 ============
============ Train epoch 25 ============
kmeans
client-0 is in G-0
client-1 is in G-2
client-2 is in G-5
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-5
client-9 is in G-3
client-10 is in G-1
client-11 is in G-3
cnt=[2, 2, 2, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8992 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0012 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.8790 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6859 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.9251 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6709 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3702 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.9034 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.7124 | Train Acc: 0.8729
 Site-QuickDraw | Train Loss: 2.3228 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7375 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9348 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8168 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8077 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6561 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.9018 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 1.2409 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3800 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5403 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 0.6227 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.6257 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0748 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7395 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0797 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7463
============ Train epoch 26 ============
============ Train epoch 27 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-5
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 2, 2, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7478 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0518 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.9451 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.7306 | Train Acc: 0.9200
 Site-Infograph | Train Loss: 1.9607 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6165 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3475 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.8059 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.6338 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2587 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6664 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8010 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.7477 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8716 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.6334 | Val  Acc: 0.8200
 Site-Clipart   | Val  Loss: 0.8539 | Val  Acc: 0.7910
 Site-Infograph | Val  Loss: 1.1440 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3311 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4872 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.5636 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.6013 | Val  Acc: 0.9231
 Site-QuickDraw | Val  Loss: 2.0109 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6812 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.0267 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7823
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8200
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7910
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6032
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3810
 Best site-Real       | Epoch:13 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-5
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[2, 3, 2, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7808 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9610 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 0.8175 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6993 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.9548 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5763 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2827 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7090 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.6505 | Train Acc: 0.9068
 Site-QuickDraw | Train Loss: 2.3026 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7413 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8483 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8268 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8526 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5929 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.8110 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 1.0766 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2782 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4402 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4843 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.5040 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 2.0265 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7151 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0308 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7818
============ Train epoch 30 ============
============ Train epoch 31 ============
kmeans
client-0 is in G-3
client-1 is in G-2
client-2 is in G-5
client-3 is in G-2
client-4 is in G-3
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 2, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7734 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9813 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.7884 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.6642 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.9383 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6351 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2461 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.7599 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5622 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2762 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5915 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9514 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.6366 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7664 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.6400 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.7492 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1070 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2957 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4311 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.5211 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.5281 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9479 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6514 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9646 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7881
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6032
 Best site-Painting   | Epoch:15 | Val Acc: 0.9744
 Best site-Painting   | Epoch:15 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.3810
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
kmeans
client-0 is in G-3
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-5
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 1, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8164 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.9702 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7961 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5942 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.8138 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5517 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1777 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.6518 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.5814 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2369 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5380 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.7713 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6615 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7652 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.5279 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6779 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 1.0571 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2263 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4487 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5228 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.4492 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0214 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6194 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9976 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7750
============ Train epoch 34 ============
============ Train epoch 35 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-1
client-3 is in G-5
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-0
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-4
cnt=[1, 2, 4, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7063 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8224 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.7481 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6105 | Train Acc: 0.8800
 Site-Infograph | Train Loss: 1.8966 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5305 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1684 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.7143 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.5562 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.2450 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4892 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6230 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6257 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6315 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5316 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7040 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 1.0603 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2165 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3979 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4429 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4689 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.9895 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5902 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8928 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7797
============ Train epoch 36 ============
============ Train epoch 37 ============
kmeans
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[4, 3, 1, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6537 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7145 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6780 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.5069 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8920 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4136 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1378 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.6269 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5381 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.3456 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5356 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.6841 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5813 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6291 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5444 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6754 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.0267 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1912 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3734 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.3748 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4371 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9505 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6129 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9913 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7814
============ Train epoch 38 ============
============ Train epoch 39 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-2
client-3 is in G-3
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-4
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[3, 3, 1, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5942 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7538 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6342 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5222 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8935 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.5122 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1560 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.6465 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.4684 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2948 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.5099 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7549 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5369 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7307 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.4564 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.6799 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1486 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1654 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3492 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.4071 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4344 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.8823 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5791 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8798 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7820
============ Train epoch 40 ============
============ Train epoch 41 ============
kmeans
client-0 is in G-1
client-1 is in G-2
client-2 is in G-4
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-5
client-9 is in G-1
client-10 is in G-0
client-11 is in G-1
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6355 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.8919 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6412 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.5015 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.9042 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4460 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1584 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.6654 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4576 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2218 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4930 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8609 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.5953 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6323 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4626 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7235 | Val  Acc: 0.8060
 Site-Infograph | Val  Loss: 0.9432 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0962 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2719 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3486 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3694 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9421 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5154 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9754 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7916
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.8060
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6349
 Best site-Painting   | Epoch:20 | Val Acc: 0.9744
 Best site-Painting   | Epoch:20 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.2857
 Best site-Real       | Epoch:20 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:20 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 42 ============
============ Train epoch 43 ============
kmeans
client-0 is in G-1
client-1 is in G-4
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-3
client-8 is in G-0
client-9 is in G-1
client-10 is in G-5
client-11 is in G-1
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5896 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7668 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6862 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4345 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8560 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.4155 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1131 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5886 | Train Acc: 0.8475
 Site-Painting  | Train Loss: 0.4350 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2773 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4301 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6672 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5127 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6613 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.5071 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6095 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.8325 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1161 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.2459 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3404 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3523 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.8916 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4881 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8382 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8065
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:21 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6349
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-Painting   | Epoch:21 | Val Acc: 0.9872
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3810
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-0
client-5 is in G-1
client-6 is in G-2
client-7 is in G-5
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 2, 1, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5379 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.7767 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.5922 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4544 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8303 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4052 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1237 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5343 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4397 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.2394 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.4418 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5986 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.4997 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7165 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4463 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.6228 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9320 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1806 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2648 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.3503 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3492 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9229 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.5493 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8740 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7852
============ Train epoch 46 ============
============ Train epoch 47 ============
kmeans
client-0 is in G-0
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-1
client-6 is in G-4
client-7 is in G-5
client-8 is in G-5
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 2, 3, 2, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5948 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.6005 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5022 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.9102 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4076 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1003 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.6177 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4486 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.3391 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.3963 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6347 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4333 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4676 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4351 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5468 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 0.9297 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0840 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2864 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.3121 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3414 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 1.9080 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4544 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8131 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8035
============ Train epoch 48 ============
============ Train epoch 49 ============
kmeans
client-0 is in G-0
client-1 is in G-0
client-2 is in G-3
client-3 is in G-3
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-2
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 1, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6200 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6094 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.5543 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4367 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.8194 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4489 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.0876 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5204 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3563 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.2551 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.4344 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6121 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5001 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4551 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4238 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5686 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.9568 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2048 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.2827 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.3074 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3178 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9327 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4958 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.7798 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7967
============ Train epoch 50 ============
============ Train epoch 51 ============
kmeans
client-0 is in G-3
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-0
client-7 is in G-5
client-8 is in G-0
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[3, 1, 2, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4861 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6064 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5296 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.3692 | Train Acc: 0.9800
 Site-Infograph | Train Loss: 1.8181 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3534 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9869 | Train Acc: 0.7340
 Site-Painting  | Train Loss: 0.5607 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3539 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1578 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.4149 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.6423 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4615 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4832 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4119 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5811 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.9554 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0841 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1626 | Val  Acc: 0.6825
 Site-Painting  | Val  Loss: 0.2782 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3176 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.8708 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4578 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9196 | Val  Acc: 0.6957
Average Valid Accuracy: 0.8048
============ Train epoch 52 ============
============ Train epoch 53 ============
kmeans
client-0 is in G-0
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-3
client-5 is in G-2
client-6 is in G-2
client-7 is in G-5
client-8 is in G-2
client-9 is in G-3
client-10 is in G-4
client-11 is in G-1
cnt=[1, 4, 3, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4935 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6161 | Train Acc: 0.7800
 Site-Clipart   | Train Loss: 0.5079 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4264 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9219 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3587 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0663 | Train Acc: 0.6489
 Site-Painting  | Train Loss: 0.4843 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3528 | Train Acc: 0.9831
 Site-QuickDraw | Train Loss: 2.2361 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3744 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5658 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4581 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4917 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4301 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5483 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.8083 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0294 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1733 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.2937 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3106 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9158 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.4538 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8753 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7966
============ Train epoch 54 ============
============ Train epoch 55 ============
kmeans
client-0 is in G-3
client-1 is in G-1
client-2 is in G-0
client-3 is in G-1
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-4
client-8 is in G-2
client-9 is in G-5
client-10 is in G-2
client-11 is in G-0
cnt=[2, 2, 2, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6131 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6502 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.5135 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.3583 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.8149 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.3400 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.9926 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.4816 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.3287 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1805 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.3574 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7435 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5136 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4085 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.3892 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5539 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.8069 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9635 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1399 | Val  Acc: 0.6825
 Site-Painting  | Val  Loss: 0.2431 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2983 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 1.9126 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5069 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.8644 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8118
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9394
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8955
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6825
 Best site-Painting   | Epoch:27 | Val Acc: 1.0000
 Best site-Painting   | Epoch:27 | Val Acc: 0.9872
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.2857
 Best site-Real       | Epoch:27 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:27 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 56 ============
============ Train epoch 57 ============
kmeans
client-0 is in G-2
client-1 is in G-0
client-2 is in G-4
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-0
client-8 is in G-1
client-9 is in G-5
client-10 is in G-3
client-11 is in G-5
cnt=[2, 2, 3, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5789 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6558 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5113 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.3558 | Train Acc: 0.9600
 Site-Infograph | Train Loss: 1.8701 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3238 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0321 | Train Acc: 0.7340
 Site-Painting  | Train Loss: 0.5025 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3062 | Train Acc: 0.9915
 Site-QuickDraw | Train Loss: 2.1631 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.4416 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7109 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.4372 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4129 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3770 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5555 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 0.8653 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9749 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1689 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.2910 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2691 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.8352 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4564 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8588 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8235
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:28 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6508
 Best site-Painting   | Epoch:28 | Val Acc: 1.0000
 Best site-Painting   | Epoch:28 | Val Acc: 0.9744
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.4286
 Best site-Real       | Epoch:28 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:28 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 58 ============
============ Train epoch 59 ============
kmeans
client-0 is in G-3
client-1 is in G-5
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-0
client-6 is in G-5
client-7 is in G-0
client-8 is in G-5
client-9 is in G-4
client-10 is in G-1
client-11 is in G-4
cnt=[2, 1, 2, 1, 3, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4276 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.8754 | Train Acc: 0.8600
 Site-Clipart   | Train Loss: 0.4808 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3324 | Train Acc: 0.9400
 Site-Infograph | Train Loss: 1.9094 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3539 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9783 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.4787 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3731 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1687 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3257 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6526 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4786 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4070 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4378 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.4856 | Val  Acc: 0.9254
 Site-Infograph | Val  Loss: 0.8039 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0958 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1325 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.2922 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2884 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 1.9364 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.4197 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8617 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7896
===2023-04-13 04:13:02===
===2023-04-13 04:13:03===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:28 | Test Acc: 0.8346
 Test site-Infograph | Epoch:28 | Test Acc: 0.5053
 Test site-Painting  | Epoch:28 | Test Acc: 0.9047
 Test site-QuickDraw | Epoch:28 | Test Acc: 0.2870
 Test site-Real      | Epoch:28 | Test Acc: 0.9162
 Test site-Sketch    | Epoch:28 | Test Acc: 0.8032
Average Test Accuracy: 0.7085
===2023-04-13 13:50:46===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
multiply acc by 100 for Ea!
train acc for Ea
============ Train epoch 0 ============
============ Train epoch 1 ============
gmm
client-0 is in G-2
client-1 is in G-5
client-2 is in G-2
client-3 is in G-3
client-4 is in G-3
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
cnt=[1, 1, 6, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1098 | Train Acc: 0.3600
 Site-Clipart   | Train Loss: 2.2528 | Train Acc: 0.1800
 Site-Clipart   | Train Loss: 2.0850 | Train Acc: 0.2933
 Site-Clipart   | Train Loss: 2.0808 | Train Acc: 0.2600
 Site-Infograph | Train Loss: 2.2486 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2789 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1985 | Train Acc: 0.1596
 Site-Painting  | Train Loss: 2.1717 | Train Acc: 0.3559
 Site-Painting  | Train Loss: 2.0989 | Train Acc: 0.3644
 Site-QuickDraw | Train Loss: 2.3946 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1781 | Train Acc: 0.2895
 Site-Sketch    | Train Loss: 2.1425 | Train Acc: 0.2857
============ Train epoch 2 ============
============ Train epoch 3 ============
gmm
client-0 is in G-4
client-1 is in G-4
client-2 is in G-2
client-3 is in G-5
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-2
client-8 is in G-2
client-9 is in G-5
client-10 is in G-2
client-11 is in G-3
cnt=[1, 2, 4, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 2.1151 | Train Acc: 0.2800
 Site-Clipart   | Train Loss: 2.1377 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 1.9487 | Train Acc: 0.4533
 Site-Clipart   | Train Loss: 1.9479 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 2.1698 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.2463 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1105 | Train Acc: 0.3085
 Site-Painting  | Train Loss: 1.9821 | Train Acc: 0.3898
 Site-Painting  | Train Loss: 1.9429 | Train Acc: 0.4576
 Site-QuickDraw | Train Loss: 2.3662 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9858 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9308 | Train Acc: 0.4571
 Site-Clipart   | Val  Loss: 1.8629 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0312 | Val  Acc: 0.6061
 Site-Clipart   | Val  Loss: 1.8677 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9746 | Val  Acc: 0.3881
 Site-Infograph | Val  Loss: 2.0821 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1181 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1897 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 1.8459 | Val  Acc: 0.5897
 Site-Painting  | Val  Loss: 1.8773 | Val  Acc: 0.5256
 Site-QuickDraw | Val  Loss: 2.2649 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9068 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.9005 | Val  Acc: 0.3913
Average Valid Accuracy: 0.4145
 Best site-Clipart    | Epoch:1 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6061
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3881
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2698
 Best site-Painting   | Epoch:1 | Val Acc: 0.5897
 Best site-Painting   | Epoch:1 | Val Acc: 0.5256
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 4 ============
============ Train epoch 5 ============
gmm
client-0 is in G-3
client-1 is in G-5
client-2 is in G-1
client-3 is in G-0
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
cnt=[2, 5, 2, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.9113 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8270 | Train Acc: 0.4200
 Site-Clipart   | Train Loss: 1.7999 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.8208 | Train Acc: 0.5100
 Site-Infograph | Train Loss: 2.1249 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1735 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.0406 | Train Acc: 0.3830
 Site-Painting  | Train Loss: 1.8842 | Train Acc: 0.4576
 Site-Painting  | Train Loss: 1.8083 | Train Acc: 0.5593
 Site-QuickDraw | Train Loss: 2.3271 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.9065 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.7359 | Train Acc: 0.6000
============ Train epoch 6 ============
============ Train epoch 7 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-2
client-3 is in G-0
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
cnt=[3, 1, 5, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.6806 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.7613 | Train Acc: 0.4800
 Site-Clipart   | Train Loss: 1.6845 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.6658 | Train Acc: 0.5800
 Site-Infograph | Train Loss: 2.1269 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.1387 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9053 | Train Acc: 0.4255
 Site-Painting  | Train Loss: 1.6802 | Train Acc: 0.5932
 Site-Painting  | Train Loss: 1.6492 | Train Acc: 0.6017
 Site-QuickDraw | Train Loss: 2.3074 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6198 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.6815 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.5379 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.8026 | Val  Acc: 0.6364
 Site-Clipart   | Val  Loss: 1.5638 | Val  Acc: 0.6400
 Site-Clipart   | Val  Loss: 1.6952 | Val  Acc: 0.5970
 Site-Infograph | Val  Loss: 1.8161 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8646 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0310 | Val  Acc: 0.3492
 Site-Painting  | Val  Loss: 1.4982 | Val  Acc: 0.6410
 Site-Painting  | Val  Loss: 1.5637 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1931 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.6675 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.6178 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5657
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6364
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6400
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5970
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3492
 Best site-Painting   | Epoch:3 | Val Acc: 0.6410
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1905
 Best site-Real       | Epoch:3 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 8 ============
============ Train epoch 9 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-5
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
cnt=[1, 1, 7, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5580 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.6555 | Train Acc: 0.5600
 Site-Clipart   | Train Loss: 1.5748 | Train Acc: 0.6133
 Site-Clipart   | Train Loss: 1.4525 | Train Acc: 0.6900
 Site-Infograph | Train Loss: 2.0713 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 2.0512 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8493 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.5665 | Train Acc: 0.7119
 Site-Painting  | Train Loss: 1.5012 | Train Acc: 0.6949
 Site-QuickDraw | Train Loss: 2.3426 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.5021 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5053 | Train Acc: 0.7714
============ Train epoch 10 ============
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-3
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-1
client-10 is in G-5
client-11 is in G-0
cnt=[4, 1, 1, 1, 4, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.5204 | Train Acc: 0.5200
 Site-Clipart   | Train Loss: 1.4978 | Train Acc: 0.6200
 Site-Clipart   | Train Loss: 1.4223 | Train Acc: 0.6400
 Site-Clipart   | Train Loss: 1.3361 | Train Acc: 0.7200
 Site-Infograph | Train Loss: 2.0309 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0201 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.7793 | Train Acc: 0.4787
 Site-Painting  | Train Loss: 1.4494 | Train Acc: 0.6780
 Site-Painting  | Train Loss: 1.3012 | Train Acc: 0.7542
 Site-QuickDraw | Train Loss: 2.3492 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2402 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3269 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2211 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4515 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 1.1089 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.3670 | Val  Acc: 0.6866
 Site-Infograph | Val  Loss: 1.6444 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7115 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8913 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 1.2042 | Val  Acc: 0.8205
 Site-Painting  | Val  Loss: 1.2067 | Val  Acc: 0.8077
 Site-QuickDraw | Val  Loss: 2.1231 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3477 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.4450 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6572
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6866
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3810
 Best site-Painting   | Epoch:5 | Val Acc: 0.8205
 Best site-Painting   | Epoch:5 | Val Acc: 0.8077
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:5 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 12 ============
============ Train epoch 13 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-4
client-5 is in G-2
client-6 is in G-5
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-1
client-11 is in G-3
cnt=[1, 5, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.3451 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2460 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.3260 | Train Acc: 0.7067
 Site-Clipart   | Train Loss: 1.1634 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 2.0445 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9268 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6528 | Train Acc: 0.5426
 Site-Painting  | Train Loss: 1.3342 | Train Acc: 0.7288
 Site-Painting  | Train Loss: 1.1924 | Train Acc: 0.7712
 Site-QuickDraw | Train Loss: 2.3499 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2029 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3925 | Train Acc: 0.7143
============ Train epoch 14 ============
============ Train epoch 15 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-4
client-6 is in G-4
client-7 is in G-0
client-8 is in G-0
client-9 is in G-5
client-10 is in G-0
client-11 is in G-3
cnt=[3, 2, 2, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.2156 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.3302 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1917 | Train Acc: 0.7467
 Site-Clipart   | Train Loss: 1.0945 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9739 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.9121 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5793 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.1914 | Train Acc: 0.7797
 Site-Painting  | Train Loss: 1.0525 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.2932 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.1959 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3659 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.0811 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.2542 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 1.0110 | Val  Acc: 0.7600
 Site-Clipart   | Val  Loss: 1.1775 | Val  Acc: 0.7164
 Site-Infograph | Val  Loss: 1.5133 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5468 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7344 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 0.8691 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.9512 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.1198 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.1040 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2741 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7076
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7600
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7164
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4603
 Best site-Painting   | Epoch:7 | Val Acc: 0.9231
 Best site-Painting   | Epoch:7 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1905
 Best site-Real       | Epoch:7 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 16 ============
============ Train epoch 17 ============
gmm
client-0 is in G-3
client-1 is in G-0
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-4
client-8 is in G-4
client-9 is in G-5
client-10 is in G-1
client-11 is in G-3
cnt=[2, 1, 3, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1838 | Train Acc: 0.7200
 Site-Clipart   | Train Loss: 1.2505 | Train Acc: 0.6800
 Site-Clipart   | Train Loss: 1.1161 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0196 | Train Acc: 0.8100
 Site-Infograph | Train Loss: 2.0380 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8421 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.5310 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.0840 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.9556 | Train Acc: 0.8559
 Site-QuickDraw | Train Loss: 2.3558 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.9630 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0654 | Train Acc: 0.7714
============ Train epoch 18 ============
============ Train epoch 19 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-3
client-6 is in G-3
client-7 is in G-0
client-8 is in G-3
client-9 is in G-5
client-10 is in G-3
client-11 is in G-4
cnt=[1, 2, 2, 4, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0311 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3224 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.0649 | Train Acc: 0.8133
 Site-Clipart   | Train Loss: 0.8744 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9749 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7485 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4923 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0127 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.8836 | Train Acc: 0.8390
 Site-QuickDraw | Train Loss: 2.3807 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9345 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1209 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0302 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1158 | Val  Acc: 0.8788
 Site-Clipart   | Val  Loss: 0.7892 | Val  Acc: 0.7400
 Site-Clipart   | Val  Loss: 1.0133 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.3620 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4912 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6268 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.7549 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.7934 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.1122 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.9536 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.2108 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7203
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8788
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7400
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.9231
 Best site-Painting   | Epoch:9 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.2381
 Best site-Real       | Epoch:9 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.7471
 Test site-Infograph | Epoch:9 | Test Acc: 0.4323
 Test site-Painting  | Epoch:9 | Test Acc: 0.8288
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2630
 Test site-Real      | Epoch:9 | Test Acc: 0.8636
 Test site-Sketch    | Epoch:9 | Test Acc: 0.7292
Average Test Accuracy: 0.6440
============ Train epoch 20 ============
============ Train epoch 21 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-2
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-5
client-8 is in G-3
client-9 is in G-1
client-10 is in G-0
client-11 is in G-1
cnt=[2, 4, 2, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0607 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9544 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.0381 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.8737 | Train Acc: 0.8900
 Site-Infograph | Train Loss: 1.8658 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7022 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4646 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9527 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.8499 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.3304 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.7644 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8442 | Train Acc: 0.7143
============ Train epoch 22 ============
============ Train epoch 23 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-0
client-3 is in G-5
client-4 is in G-3
client-5 is in G-4
client-6 is in G-4
client-7 is in G-1
client-8 is in G-4
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[1, 1, 2, 3, 4, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.1153 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 1.2478 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 0.9325 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.8494 | Train Acc: 0.8600
 Site-Infograph | Train Loss: 1.9275 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7304 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3771 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9185 | Train Acc: 0.7966
 Site-Painting  | Train Loss: 0.7428 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.3115 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.7747 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9735 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9482 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9201 | Val  Acc: 0.8485
 Site-Clipart   | Val  Loss: 0.7170 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9324 | Val  Acc: 0.8209
 Site-Infograph | Val  Loss: 1.2163 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4214 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5747 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6544 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.6595 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0199 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.8321 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1345 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7407
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8485
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8209
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5714
 Best site-Painting   | Epoch:11 | Val Acc: 0.9231
 Best site-Painting   | Epoch:11 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:11 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 24 ============
============ Train epoch 25 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-5
client-3 is in G-4
client-4 is in G-3
client-5 is in G-1
client-6 is in G-0
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-1
client-11 is in G-2
cnt=[1, 4, 2, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 1.0679 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0574 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.9419 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7902 | Train Acc: 0.9000
 Site-Infograph | Train Loss: 1.8913 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6413 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3754 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.8799 | Train Acc: 0.8136
 Site-Painting  | Train Loss: 0.7296 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.2925 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8375 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0862 | Train Acc: 0.8286
============ Train epoch 26 ============
============ Train epoch 27 ============
gmm
client-0 is in G-3
client-1 is in G-4
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-2
client-8 is in G-0
client-9 is in G-5
client-10 is in G-0
client-11 is in G-5
cnt=[3, 1, 1, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8804 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1372 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8410 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.6755 | Train Acc: 0.8700
 Site-Infograph | Train Loss: 1.9556 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6663 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3165 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.8059 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.6578 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 2.2418 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.7649 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7961 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7908 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8537 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.7256 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7855 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.1714 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3652 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5224 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.5856 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.5236 | Val  Acc: 0.9487
 Site-QuickDraw | Val  Loss: 2.0169 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.7484 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0367 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7670
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5714
 Best site-Painting   | Epoch:13 | Val Acc: 0.9231
 Best site-Painting   | Epoch:13 | Val Acc: 0.9487
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2857
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 28 ============
============ Train epoch 29 ============
gmm
client-0 is in G-1
client-1 is in G-4
client-2 is in G-0
client-3 is in G-0
client-4 is in G-1
client-5 is in G-3
client-6 is in G-5
client-7 is in G-3
client-8 is in G-5
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
cnt=[2, 4, 1, 2, 1, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.8155 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 1.0591 | Train Acc: 0.7400
 Site-Clipart   | Train Loss: 0.8061 | Train Acc: 0.7867
 Site-Clipart   | Train Loss: 0.6942 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8527 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6290 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.2905 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.8567 | Train Acc: 0.8305
 Site-Painting  | Train Loss: 0.6276 | Train Acc: 0.8898
 Site-QuickDraw | Train Loss: 2.3315 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.6222 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8880 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-1
client-8 is in G-4
client-9 is in G-2
client-10 is in G-4
client-11 is in G-2
cnt=[2, 1, 3, 2, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7587 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9680 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7827 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.6610 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.9477 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6121 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.2957 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 0.7467 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5921 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3233 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.6644 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.1029 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.7404 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7331 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5921 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.8009 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.9957 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2714 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4727 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 0.5044 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4764 | Val  Acc: 0.9359
 Site-QuickDraw | Val  Loss: 2.0355 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6756 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9639 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7675
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8400
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5556
 Best site-Painting   | Epoch:15 | Val Acc: 0.9231
 Best site-Painting   | Epoch:15 | Val Acc: 0.9359
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 32 ============
============ Train epoch 33 ============
gmm
client-0 is in G-2
client-1 is in G-4
client-2 is in G-4
client-3 is in G-0
client-4 is in G-5
client-5 is in G-3
client-6 is in G-3
client-7 is in G-4
client-8 is in G-1
client-9 is in G-5
client-10 is in G-1
client-11 is in G-5
cnt=[1, 2, 1, 2, 3, 3, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7591 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.9244 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.7618 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5793 | Train Acc: 0.9100
 Site-Infograph | Train Loss: 1.8281 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4837 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3030 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 0.7279 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5728 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2697 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.5910 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9474 | Train Acc: 0.8000
============ Train epoch 34 ============
============ Train epoch 35 ============
gmm
client-0 is in G-2
client-1 is in G-0
client-2 is in G-3
client-3 is in G-2
client-4 is in G-1
client-5 is in G-0
client-6 is in G-0
client-7 is in G-1
client-8 is in G-0
client-9 is in G-4
client-10 is in G-5
client-11 is in G-4
cnt=[4, 2, 2, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7431 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8120 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7394 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.5610 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8476 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5865 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2267 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.7105 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.5602 | Train Acc: 0.9237
 Site-QuickDraw | Train Loss: 2.2750 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.6180 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0037 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.6658 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7092 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.5226 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.7426 | Val  Acc: 0.8358
 Site-Infograph | Val  Loss: 1.0894 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2027 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.3971 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.4656 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.4855 | Val  Acc: 0.9103
 Site-QuickDraw | Val  Loss: 2.0026 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.6503 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.9096 | Val  Acc: 0.7391
Average Valid Accuracy: 0.8018
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8358
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Painting   | Epoch:17 | Val Acc: 0.9744
 Best site-Painting   | Epoch:17 | Val Acc: 0.9103
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4762
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 36 ============
============ Train epoch 37 ============
gmm
client-0 is in G-4
client-1 is in G-3
client-2 is in G-3
client-3 is in G-4
client-4 is in G-1
client-5 is in G-2
client-6 is in G-5
client-7 is in G-0
client-8 is in G-2
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
cnt=[1, 3, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6747 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.9405 | Train Acc: 0.8200
 Site-Clipart   | Train Loss: 0.7038 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5861 | Train Acc: 0.9300
 Site-Infograph | Train Loss: 1.8801 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.5718 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2129 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.6684 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.5523 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.3106 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.4784 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8647 | Train Acc: 0.8857
============ Train epoch 38 ============
============ Train epoch 39 ============
gmm
client-0 is in G-2
client-1 is in G-5
client-2 is in G-0
client-3 is in G-2
client-4 is in G-4
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-3
client-9 is in G-0
client-10 is in G-3
client-11 is in G-0
cnt=[3, 2, 2, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.7479 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8421 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.7250 | Train Acc: 0.8267
 Site-Clipart   | Train Loss: 0.4627 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8925 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4774 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1436 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5955 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.5106 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.2446 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5862 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7756 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.5600 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7369 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.5251 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6165 | Val  Acc: 0.9104
 Site-Infograph | Val  Loss: 1.0383 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1629 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3333 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.4046 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.4018 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9908 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5974 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8724 | Val  Acc: 0.7826
Average Valid Accuracy: 0.7802
============ Train epoch 40 ============
============ Train epoch 41 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-3
client-3 is in G-5
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-4
client-8 is in G-2
client-9 is in G-0
client-10 is in G-4
client-11 is in G-0
cnt=[3, 1, 3, 1, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6591 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.7424 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6178 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.5238 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.9136 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4435 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1389 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 0.5779 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.4785 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1571 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.5586 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9385 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
gmm
client-0 is in G-3
client-1 is in G-2
client-2 is in G-5
client-3 is in G-3
client-4 is in G-0
client-5 is in G-1
client-6 is in G-1
client-7 is in G-4
client-8 is in G-1
client-9 is in G-0
client-10 is in G-4
client-11 is in G-3
cnt=[2, 3, 1, 3, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6543 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6655 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.6515 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4194 | Train Acc: 0.9900
 Site-Infograph | Train Loss: 1.8422 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4361 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1384 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5833 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.4332 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2061 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4496 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0004 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 0.5418 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.6339 | Val  Acc: 0.9091
 Site-Clipart   | Val  Loss: 0.4419 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.6676 | Val  Acc: 0.8507
 Site-Infograph | Val  Loss: 0.8913 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0810 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3319 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3466 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3846 | Val  Acc: 0.9615
 Site-QuickDraw | Val  Loss: 2.0040 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.5414 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8042 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8053
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9091
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8800
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8507
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6667
 Best site-Painting   | Epoch:21 | Val Acc: 0.9744
 Best site-Painting   | Epoch:21 | Val Acc: 0.9615
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.2857
 Best site-Real       | Epoch:21 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
============ Train epoch 44 ============
============ Train epoch 45 ============
gmm
client-0 is in G-1
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-2
client-5 is in G-0
client-6 is in G-0
client-7 is in G-4
client-8 is in G-5
client-9 is in G-2
client-10 is in G-0
client-11 is in G-2
cnt=[3, 1, 3, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6639 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6564 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6263 | Train Acc: 0.8533
 Site-Clipart   | Train Loss: 0.4644 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8560 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4650 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.1455 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5794 | Train Acc: 0.8983
 Site-Painting  | Train Loss: 0.4593 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.2266 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4037 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0041 | Train Acc: 0.7714
============ Train epoch 46 ============
============ Train epoch 47 ============
gmm
client-0 is in G-2
client-1 is in G-3
client-2 is in G-2
client-3 is in G-2
client-4 is in G-0
client-5 is in G-1
client-6 is in G-5
client-7 is in G-4
client-8 is in G-1
client-9 is in G-0
client-10 is in G-1
client-11 is in G-0
cnt=[3, 3, 3, 1, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.6148 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.8235 | Train Acc: 0.7600
 Site-Clipart   | Train Loss: 0.5866 | Train Acc: 0.8933
 Site-Clipart   | Train Loss: 0.4487 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8051 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3851 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0558 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5432 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3822 | Train Acc: 0.9492
 Site-QuickDraw | Train Loss: 2.1725 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.4470 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7445 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5266 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5722 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4488 | Val  Acc: 0.9200
 Site-Clipart   | Val  Loss: 0.5806 | Val  Acc: 0.8657
 Site-Infograph | Val  Loss: 1.0136 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0931 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2094 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3493 | Val  Acc: 0.9744
 Site-Painting  | Val  Loss: 0.3496 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9701 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.5061 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8934 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7868
============ Train epoch 48 ============
============ Train epoch 49 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-3
client-3 is in G-3
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-4
client-8 is in G-2
client-9 is in G-1
client-10 is in G-2
client-11 is in G-1
cnt=[1, 4, 3, 2, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4779 | Train Acc: 0.9600
 Site-Clipart   | Train Loss: 0.7403 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.6055 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4371 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8507 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.3321 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.0607 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5635 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3866 | Train Acc: 0.9407
 Site-QuickDraw | Train Loss: 2.1129 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.4540 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6487 | Train Acc: 0.8000
============ Train epoch 50 ============
============ Train epoch 51 ============
gmm
client-0 is in G-5
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-0
client-5 is in G-2
client-6 is in G-2
client-7 is in G-3
client-8 is in G-2
client-9 is in G-4
client-10 is in G-2
client-11 is in G-4
cnt=[1, 3, 4, 1, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5653 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.5514 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5968 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.4341 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.9177 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4041 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0394 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 0.5281 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.3611 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.3003 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5047 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8521 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4184 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.5208 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4291 | Val  Acc: 0.8400
 Site-Clipart   | Val  Loss: 0.5703 | Val  Acc: 0.8806
 Site-Infograph | Val  Loss: 0.8875 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1428 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.1993 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3227 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.3321 | Val  Acc: 0.9744
 Site-QuickDraw | Val  Loss: 1.9144 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.4363 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7303 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7960
============ Train epoch 52 ============
============ Train epoch 53 ============
gmm
client-0 is in G-1
client-1 is in G-2
client-2 is in G-0
client-3 is in G-1
client-4 is in G-2
client-5 is in G-3
client-6 is in G-3
client-7 is in G-5
client-8 is in G-0
client-9 is in G-2
client-10 is in G-3
client-11 is in G-4
cnt=[2, 2, 3, 3, 1, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4952 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6366 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5476 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.4026 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8371 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.3402 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1031 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.5224 | Train Acc: 0.8644
 Site-Painting  | Train Loss: 0.3443 | Train Acc: 0.9661
 Site-QuickDraw | Train Loss: 2.1957 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.3704 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7198 | Train Acc: 0.8000
============ Train epoch 54 ============
============ Train epoch 55 ============
gmm
client-0 is in G-1
client-1 is in G-5
client-2 is in G-2
client-3 is in G-1
client-4 is in G-3
client-5 is in G-4
client-6 is in G-5
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-4
client-11 is in G-3
cnt=[1, 2, 2, 3, 2, 2, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5106 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.7978 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.5678 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.4263 | Train Acc: 0.9700
 Site-Infograph | Train Loss: 1.8732 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3125 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0474 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.5389 | Train Acc: 0.8814
 Site-Painting  | Train Loss: 0.3494 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2179 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.3981 | Train Acc: 0.9474
 Site-Sketch    | Train Loss: 0.7354 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.4933 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.3776 | Val  Acc: 0.9394
 Site-Clipart   | Val  Loss: 0.4019 | Val  Acc: 0.8800
 Site-Clipart   | Val  Loss: 0.5121 | Val  Acc: 0.8955
 Site-Infograph | Val  Loss: 0.9497 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0342 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1926 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.2740 | Val  Acc: 0.9487
 Site-Painting  | Val  Loss: 0.2670 | Val  Acc: 0.9872
 Site-QuickDraw | Val  Loss: 2.0070 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 0.4619 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7714 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7819
============ Train epoch 56 ============
============ Train epoch 57 ============
gmm
client-0 is in G-1
client-1 is in G-4
client-2 is in G-2
client-3 is in G-1
client-4 is in G-1
client-5 is in G-5
client-6 is in G-4
client-7 is in G-0
client-8 is in G-2
client-9 is in G-3
client-10 is in G-2
client-11 is in G-3
cnt=[1, 3, 3, 2, 2, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.5416 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.6139 | Train Acc: 0.8400
 Site-Clipart   | Train Loss: 0.5149 | Train Acc: 0.8800
 Site-Clipart   | Train Loss: 0.3698 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8166 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.3420 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0448 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.5051 | Train Acc: 0.9153
 Site-Painting  | Train Loss: 0.3228 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.1547 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.5501 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.4509 | Train Acc: 0.8857
============ Train epoch 58 ============
============ Train epoch 59 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-3
client-3 is in G-2
client-4 is in G-5
client-5 is in G-0
client-6 is in G-4
client-7 is in G-0
client-8 is in G-4
client-9 is in G-1
client-10 is in G-4
client-11 is in G-1
cnt=[2, 2, 3, 1, 3, 1, ]
beta=0.9, beta_c=0.9
Ea with train accs
 Site-Clipart   | Train Loss: 0.4683 | Train Acc: 0.9200
 Site-Clipart   | Train Loss: 0.6084 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4872 | Train Acc: 0.9067
 Site-Clipart   | Train Loss: 0.3674 | Train Acc: 0.9500
 Site-Infograph | Train Loss: 1.8346 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.2667 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0130 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 0.4546 | Train Acc: 0.9322
 Site-Painting  | Train Loss: 0.3676 | Train Acc: 0.9576
 Site-QuickDraw | Train Loss: 2.2009 | Train Acc: 0.1562
 Site-Real      | Train Loss: 0.3969 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5410 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.3875 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.4123 | Val  Acc: 0.9697
 Site-Clipart   | Val  Loss: 0.4027 | Val  Acc: 0.8600
 Site-Clipart   | Val  Loss: 0.5170 | Val  Acc: 0.9403
 Site-Infograph | Val  Loss: 0.9521 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0497 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1852 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.3528 | Val  Acc: 0.9231
 Site-Painting  | Val  Loss: 0.2612 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.8396 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.4247 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.7594 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8184
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9697
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8600
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9403
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5873
 Best site-Painting   | Epoch:29 | Val Acc: 0.9231
 Best site-Painting   | Epoch:29 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.3810
 Best site-Real       | Epoch:29 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/Nova...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8441
 Test site-Infograph | Epoch:29 | Test Acc: 0.5084
 Test site-Painting  | Epoch:29 | Test Acc: 0.8982
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3130
 Test site-Real      | Epoch:29 | Test Acc: 0.9154
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8069
Average Test Accuracy: 0.7143
===2023-04-13 14:39:06===
===2023-04-13 14:39:08===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[25,50,75,100,31,63,94,59,118,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.8441
 Test site-Infograph | Epoch:29 | Test Acc: 0.5053
 Test site-Painting  | Epoch:29 | Test Acc: 0.8966
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3240
 Test site-Real      | Epoch:29 | Test Acc: 0.9219
 Test site-Sketch    | Epoch:29 | Test Acc: 0.8087
Average Test Accuracy: 0.7168

