===2023-04-06 08:50:57===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0545 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9831 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.9191 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 1.9497 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 2.1694 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.1803 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1203 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 2.0787 | Train Acc: 0.3016
 Site-Painting  | Train Loss: 2.0495 | Train Acc: 0.3651
 Site-QuickDraw | Train Loss: 2.3257 | Train Acc: 0.1270
 Site-Real      | Train Loss: 1.9928 | Train Acc: 0.4444
 Site-Sketch    | Train Loss: 1.9128 | Train Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.8986 | Val  Acc: 0.4524
 Site-Clipart   | Val  Loss: 1.9351 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 1.9389 | Val  Acc: 0.5238
 Site-Clipart   | Val  Loss: 2.0665 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1181 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1800 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1805 | Val  Acc: 0.2143
 Site-Painting  | Val  Loss: 1.9585 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 2.0791 | Val  Acc: 0.3571
 Site-QuickDraw | Val  Loss: 2.2768 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1335 | Val  Acc: 0.3571
 Site-Sketch    | Val  Loss: 2.0357 | Val  Acc: 0.3095
Average Valid Accuracy: 0.3373
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4524
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5238
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2143
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-Painting   | Epoch:0 | Val Acc: 0.3571
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-Real       | Epoch:0 | Val Acc: 0.3571
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7498 | Train Acc: 0.4762
 Site-Clipart   | Train Loss: 1.6661 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.5672 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.6636 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.1131 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.9920 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9693 | Train Acc: 0.4286
 Site-Painting  | Train Loss: 1.7590 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.7654 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2461 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.6424 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6697 | Train Acc: 0.6508
 Site-Clipart   | Val  Loss: 1.5414 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.5790 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.6421 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7700 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9132 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9646 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0684 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.6071 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 1.8694 | Val  Acc: 0.4524
 Site-QuickDraw | Val  Loss: 2.2195 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.7447 | Val  Acc: 0.5714
 Site-Sketch    | Val  Loss: 1.8196 | Val  Acc: 0.5000
Average Valid Accuracy: 0.4841
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Painting   | Epoch:1 | Val Acc: 0.5952
 Best site-Painting   | Epoch:1 | Val Acc: 0.4524
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.5714
 Best site-Sketch     | Epoch:1 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.4840 | Train Acc: 0.5714
 Site-Clipart   | Train Loss: 1.4872 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3488 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.3983 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 2.0260 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9032 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7872 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.4340 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 1.4837 | Train Acc: 0.6508
 Site-QuickDraw | Train Loss: 2.1631 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.3402 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4126 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2731 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2646 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.5011 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4556 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.7865 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8320 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 2.0050 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 1.2601 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 1.5697 | Val  Acc: 0.5714
 Site-QuickDraw | Val  Loss: 2.1168 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.4430 | Val  Acc: 0.7143
 Site-Sketch    | Val  Loss: 1.6451 | Val  Acc: 0.5476
Average Valid Accuracy: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2857
 Best site-Painting   | Epoch:2 | Val Acc: 0.8095
 Best site-Painting   | Epoch:2 | Val Acc: 0.5714
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2619
 Best site-Real       | Epoch:2 | Val Acc: 0.7143
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5476
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.3093 | Train Acc: 0.6508
 Site-Clipart   | Train Loss: 1.2600 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1704 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2138 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.9379 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7696 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.6491 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.2397 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.2322 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.1085 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.1254 | Train Acc: 0.8413
 Site-Sketch    | Train Loss: 1.2382 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.1194 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.1225 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.2937 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3139 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.6980 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.7766 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9108 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.1790 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 1.3553 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0954 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.2663 | Val  Acc: 0.7857
 Site-Sketch    | Val  Loss: 1.4008 | Val  Acc: 0.6429
Average Valid Accuracy: 0.6111
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4524
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.7619
 Best site-Painting   | Epoch:3 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.2619
 Best site-Real       | Epoch:3 | Val Acc: 0.7857
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6429
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.1563 | Train Acc: 0.6984
 Site-Clipart   | Train Loss: 1.1285 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0588 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0337 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.7735 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6708 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5194 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 1.0603 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 1.0911 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0614 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.9447 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0573 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9265 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9712 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1770 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.1565 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6431 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6114 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8132 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.9440 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.2567 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0257 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.0846 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.3401 | Val  Acc: 0.6905
Average Valid Accuracy: 0.6587
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3810
 Best site-Painting   | Epoch:4 | Val Acc: 0.8571
 Best site-Painting   | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:4 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.0819 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.0149 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9166 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.9068 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.8359 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.5762 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4725 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.9820 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 1.0642 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 2.0325 | Train Acc: 0.2857
 Site-Real      | Train Loss: 0.8485 | Train Acc: 0.8254
 Site-Sketch    | Train Loss: 0.9744 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8683 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 0.8832 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.0477 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1051 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5521 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.5918 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7668 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.9187 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0750 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 2.0433 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 0.8887 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.2041 | Val  Acc: 0.7857
Average Valid Accuracy: 0.6885
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4048
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-Painting   | Epoch:5 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3095
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 1.0060 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 0.9494 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8556 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8116 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.7539 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5590 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3879 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.8137 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.8734 | Train Acc: 0.8254
 Site-QuickDraw | Train Loss: 1.9733 | Train Acc: 0.3016
 Site-Real      | Train Loss: 0.7574 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.9307 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7468 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7535 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9804 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9906 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3984 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4898 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7078 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7848 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.9846 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.9726 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7933 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.1572 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7063
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4286
 Best site-Painting   | Epoch:6 | Val Acc: 0.9048
 Best site-Painting   | Epoch:6 | Val Acc: 0.7857
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3810
 Best site-Real       | Epoch:6 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8363 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8642 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8122 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7381 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 1.7163 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4705 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3934 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.7931 | Train Acc: 0.8571
 Site-Painting  | Train Loss: 0.7988 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9174 | Train Acc: 0.3175
 Site-Real      | Train Loss: 0.6690 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.8327 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6708 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7266 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9009 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.8361 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4753 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4183 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6899 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.7297 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 0.8924 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.9361 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7240 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 1.1410 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7202
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.8810
 Best site-Painting   | Epoch:7 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7947 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.8356 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7033 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6508 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.6851 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4507 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.3327 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.6807 | Train Acc: 0.9048
 Site-Painting  | Train Loss: 0.7460 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.8179 | Train Acc: 0.3810
 Site-Real      | Train Loss: 0.6415 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7832 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.5662 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6009 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8327 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8210 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3747 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3691 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6249 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6742 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8027 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.8045 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.7132 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0778 | Val  Acc: 0.7381
Average Valid Accuracy: 0.7579
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5238
 Best site-Painting   | Epoch:8 | Val Acc: 0.9048
 Best site-Painting   | Epoch:8 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3810
 Best site-Real       | Epoch:8 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.7874 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7215 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6446 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5878 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.5932 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3580 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3033 | Train Acc: 0.6190
 Site-Painting  | Train Loss: 0.6530 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.7196 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7896 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.5549 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7143 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6182 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5754 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7817 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7819 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.3616 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3359 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6253 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.6226 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.8000 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8617 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6287 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 0.9982 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7341
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-Clipart   | Train Loss: 0.7055 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6956 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6151 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5541 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.6140 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3513 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2216 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.6388 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.6825 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7127 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.5368 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7395 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.5887 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5405 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7809 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7554 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3367 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.2876 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5635 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.5546 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.7862 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8101 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.5591 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9357 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7540
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.6170 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.7221 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5873 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5220 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.5775 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3332 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2278 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.5798 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5632 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.7070 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.5094 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6985 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5706 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4794 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7422 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7724 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2736 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1637 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4737 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.5601 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.7494 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.7889 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.5178 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9596 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7837
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:11 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5238
 Best site-Painting   | Epoch:11 | Val Acc: 0.9286
 Best site-Painting   | Epoch:11 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.4286
 Best site-Real       | Epoch:11 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:11 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-Clipart   | Train Loss: 0.6130 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6493 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5699 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5310 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.5642 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.3313 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.2372 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.5254 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.5487 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.6423 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.4751 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.6259 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4955 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.4815 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6826 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6627 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3384 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.1956 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5073 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3505 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.6670 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.6724 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.4828 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8597 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7599
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-Clipart   | Train Loss: 0.6345 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5825 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.4997 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.4571 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.5373 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2462 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 1.1642 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.5508 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.5140 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.5686 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.4350 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.6132 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3773 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5066 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6157 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6820 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2322 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2009 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.4057 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.4382 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.6312 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.6382 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.4838 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9095 | Val  Acc: 0.8095
Average Valid Accuracy: 0.7976
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5476
 Best site-Painting   | Epoch:13 | Val Acc: 0.9048
 Best site-Painting   | Epoch:13 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.4524
 Best site-Real       | Epoch:13 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-Clipart   | Train Loss: 0.5256 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6072 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4764 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4186 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.4944 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2434 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.1442 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4853 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.5370 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.4830 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.4371 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6807 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.3989 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4469 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6983 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.5893 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.2359 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1804 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3685 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.3996 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5570 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.6569 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.4765 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7779 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7877
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-Clipart   | Train Loss: 0.4797 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5313 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4706 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3360 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.5262 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1787 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.1563 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.4761 | Train Acc: 0.9206
 Site-Painting  | Train Loss: 0.4771 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.5222 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.3869 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.5460 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3779 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3773 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6212 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6096 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.2433 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.0372 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3896 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.3386 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5489 | Val  Acc: 0.9286
 Site-QuickDraw | Val  Loss: 1.6415 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.4075 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9496 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7996
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5476
 Best site-Painting   | Epoch:15 | Val Acc: 1.0000
 Best site-Painting   | Epoch:15 | Val Acc: 0.9286
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.5952
 Best site-Real       | Epoch:15 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-Clipart   | Train Loss: 0.5465 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5061 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4685 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3387 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4410 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.1480 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.0754 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4169 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.4450 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.4575 | Train Acc: 0.6190
 Site-Real      | Train Loss: 0.3450 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.4758 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3463 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3810 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6076 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5452 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.1072 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0410 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.4089 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 0.3444 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.5396 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.6116 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.4426 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8713 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8175
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:16 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:16 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:16 | Val Acc: 0.5000
 Best site-Painting   | Epoch:16 | Val Acc: 1.0000
 Best site-Painting   | Epoch:16 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.5238
 Best site-Real       | Epoch:16 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:16 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-Clipart   | Train Loss: 0.4577 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4790 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4057 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3338 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.4763 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1715 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0394 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.4285 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.4911 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.4591 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3453 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.5375 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.3938 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3455 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5280 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5165 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.1459 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.0440 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2665 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.3998 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5246 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.5844 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4332 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7431 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8294
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6905
 Best site-Painting   | Epoch:17 | Val Acc: 0.9524
 Best site-Painting   | Epoch:17 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.5714
 Best site-Real       | Epoch:17 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-Clipart   | Train Loss: 0.4284 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4920 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3797 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2564 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.4149 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.0536 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9475 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.4088 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3542 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.4031 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3379 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5327 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2743 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3852 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5702 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4789 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1992 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0159 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2618 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.3477 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.5092 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.4639 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4490 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7739 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8234
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-Clipart   | Train Loss: 0.3994 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.5251 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.3979 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2650 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.4287 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.0433 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.0789 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.3716 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.4132 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.3059 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.3113 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4653 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2683 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3389 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4899 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5222 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1701 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9934 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2448 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.2942 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4576 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.5065 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3018 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6351 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8452
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6667
 Best site-Painting   | Epoch:19 | Val Acc: 0.9762
 Best site-Painting   | Epoch:19 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.5714
 Best site-Real       | Epoch:19 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:19 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8498
 Test site-Infograph | Epoch:19 | Test Acc: 0.4992
 Test site-Painting  | Epoch:19 | Test Acc: 0.8578
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.5180
 Test site-Real      | Epoch:19 | Test Acc: 0.9228
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8249
Average Test Accuracy: 0.7454
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-Clipart   | Train Loss: 0.4282 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4617 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3679 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2556 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3093 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0024 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.9112 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3408 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.3164 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.3592 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.3487 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5150 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2319 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3658 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5297 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4095 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0223 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0056 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2223 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2898 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4533 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4297 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3638 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7281 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8472
 Best site-Clipart    | Epoch:20 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:20 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:20 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:20 | Val Acc: 0.6190
 Best site-Painting   | Epoch:20 | Val Acc: 1.0000
 Best site-Painting   | Epoch:20 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:20 | Val Acc: 0.5714
 Best site-Real       | Epoch:20 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:20 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-Clipart   | Train Loss: 0.3621 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4633 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3353 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2087 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.3439 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0265 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.9512 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.3519 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.3385 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2055 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2904 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4838 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2308 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3312 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4308 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4087 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.1219 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0600 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1470 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.3313 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.4495 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.4422 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3118 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7254 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8393
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-Clipart   | Train Loss: 0.3939 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3851 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3222 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2328 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3925 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9642 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8683 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.3704 | Train Acc: 0.8889
 Site-Painting  | Train Loss: 0.3277 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1806 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2609 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3820 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2289 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2923 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4846 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3945 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0304 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8950 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2128 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2331 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.4331 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.4074 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.3052 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6578 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8492
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:22 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:22 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:22 | Val Acc: 0.6190
 Best site-Painting   | Epoch:22 | Val Acc: 1.0000
 Best site-Painting   | Epoch:22 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.6429
 Best site-Real       | Epoch:22 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:22 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-Clipart   | Train Loss: 0.3653 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3919 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3245 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1916 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.3063 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.9782 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9029 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.3187 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2903 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.1835 | Train Acc: 0.6032
 Site-Real      | Train Loss: 0.3100 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5220 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.2679 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3441 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4449 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4159 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0635 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 0.9206 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.1398 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.2460 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3706 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.3589 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3702 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8757 | Val  Acc: 0.7857
Average Valid Accuracy: 0.8313
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-Clipart   | Train Loss: 0.3514 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4281 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2830 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1985 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2397 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.9681 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8431 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.2996 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3615 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1533 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.2812 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4673 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.2251 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2979 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4097 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3847 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.0239 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8433 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1182 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.2426 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3499 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.3856 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3008 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6451 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8611
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:24 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:24 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:24 | Val Acc: 0.6429
 Best site-Painting   | Epoch:24 | Val Acc: 0.9762
 Best site-Painting   | Epoch:24 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.6190
 Best site-Real       | Epoch:24 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:24 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-Clipart   | Train Loss: 0.2908 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3759 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2846 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1690 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2157 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8824 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 0.9448 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3032 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2753 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.0672 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.2514 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4789 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.2013 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2937 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3919 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3528 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9772 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.9290 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1017 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.2340 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3637 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.3638 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.4435 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6674 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8452
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-Clipart   | Train Loss: 0.3319 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3796 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3169 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1937 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2942 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9128 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.8081 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2898 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2534 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.0583 | Train Acc: 0.7778
 Site-Real      | Train Loss: 0.2029 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3648 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1867 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2495 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4194 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3318 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8283 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7716 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1010 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.2115 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3478 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.2818 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.3575 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6747 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8651
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:26 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:26 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:26 | Val Acc: 0.5952
 Best site-Painting   | Epoch:26 | Val Acc: 0.9762
 Best site-Painting   | Epoch:26 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.6905
 Best site-Real       | Epoch:26 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-Clipart   | Train Loss: 0.3168 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3485 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2803 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2008 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.2359 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9809 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.8310 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2860 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.3031 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0376 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2238 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.4975 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.2067 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3270 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4563 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3851 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9654 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8781 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9862 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.2021 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3314 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2413 | Val  Acc: 0.6190
 Site-Real      | Val  Loss: 0.3465 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6803 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8591
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-Clipart   | Train Loss: 0.2998 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3179 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2451 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1443 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.1672 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8635 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.8465 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.2666 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2535 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1340 | Train Acc: 0.6349
 Site-Real      | Train Loss: 0.2099 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3428 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1811 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2030 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3314 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3293 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9257 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.7971 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.0805 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.2123 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2969 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.3106 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3287 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7046 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8651
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-Clipart   | Train Loss: 0.2691 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3642 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2553 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1884 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.2203 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.8072 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.8522 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.2180 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.2477 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.9667 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.2338 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4221 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.1683 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1955 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3689 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3298 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9002 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.7025 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0125 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1836 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2829 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.4633 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.4204 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.5835 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8433
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-Clipart   | Train Loss: 0.2506 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3197 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2096 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1202 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.1942 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8541 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7961 | Train Acc: 0.7302
 Site-Painting  | Train Loss: 0.2656 | Train Acc: 0.9524
 Site-Painting  | Train Loss: 0.1985 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.9052 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1591 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3298 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1348 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2217 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3378 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2994 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9034 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8493 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9724 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.1813 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2504 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2236 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.2921 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5655 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8829
 Best site-Clipart    | Epoch:30 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:30 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:30 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:30 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:30 | Val Acc: 0.7381
 Best site-Painting   | Epoch:30 | Val Acc: 0.9762
 Best site-Painting   | Epoch:30 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.6429
 Best site-Real       | Epoch:30 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:30 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-Clipart   | Train Loss: 0.2726 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2931 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1995 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1329 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1681 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8179 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.7563 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2115 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2089 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.8125 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.2106 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3312 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.1911 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1847 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4717 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3175 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8322 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.7134 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0094 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1678 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3045 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.3288 | Val  Acc: 0.6429
 Site-Real      | Val  Loss: 0.2988 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6975 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8770
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-Clipart   | Train Loss: 0.2639 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2774 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2084 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1412 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.2040 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.7764 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.7567 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2059 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2052 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9058 | Train Acc: 0.8254
 Site-Real      | Train Loss: 0.1947 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3142 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1461 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2332 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3136 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3281 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8125 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.6505 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9702 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1570 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2662 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.2257 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.3247 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6302 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8889
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:32 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:32 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:32 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:32 | Val Acc: 0.7857
 Best site-Painting   | Epoch:32 | Val Acc: 1.0000
 Best site-Painting   | Epoch:32 | Val Acc: 0.9762
 Best site-QuickDraw  | Epoch:32 | Val Acc: 0.7143
 Best site-Real       | Epoch:32 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:32 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-Clipart   | Train Loss: 0.2152 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3101 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2153 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1309 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0798 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7838 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 0.7642 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.1787 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1876 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8213 | Train Acc: 0.7778
 Site-Real      | Train Loss: 0.1752 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3356 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1309 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2006 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3829 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3235 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8512 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6110 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9102 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3121 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.2815 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.4176 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5225 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8710
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-Clipart   | Train Loss: 0.2188 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2686 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2342 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1479 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1892 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.8014 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7197 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.1981 | Train Acc: 0.9683
 Site-Painting  | Train Loss: 0.2387 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 0.9843 | Train Acc: 0.7778
 Site-Real      | Train Loss: 0.1349 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3013 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1582 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1886 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3440 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2827 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.7301 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.6977 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.0326 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.1802 | Val  Acc: 0.9524
 Site-Painting  | Val  Loss: 0.2463 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.1436 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.3720 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6070 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8770
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-Clipart   | Train Loss: 0.1988 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3217 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2019 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.0844 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0598 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7021 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 0.7572 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.1770 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1736 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8622 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1488 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3474 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1108 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2139 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2588 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2718 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.8515 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.6732 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9292 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.1600 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2175 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.2009 | Val  Acc: 0.6905
 Site-Real      | Val  Loss: 0.3007 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6361 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8948
 Best site-Clipart    | Epoch:35 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:35 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7619
 Best site-Painting   | Epoch:35 | Val Acc: 1.0000
 Best site-Painting   | Epoch:35 | Val Acc: 1.0000
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.6905
 Best site-Real       | Epoch:35 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:35 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-Clipart   | Train Loss: 0.1824 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2471 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1622 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1035 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0011 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7350 | Train Acc: 0.8413
 Site-Infograph | Train Loss: 0.6873 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1398 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1983 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 0.9234 | Train Acc: 0.7143
 Site-Real      | Train Loss: 0.1733 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2537 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1285 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1627 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3456 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2220 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.7446 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6897 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8866 | Val  Acc: 0.7857
 Site-Painting  | Val  Loss: 0.1273 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2018 | Val  Acc: 1.0000
 Site-QuickDraw | Val  Loss: 1.3092 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3773 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5348 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8929
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-Clipart   | Train Loss: 0.2185 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2964 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1716 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0962 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.0286 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.7208 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 0.7071 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1284 | Train Acc: 1.0000
 Site-Painting  | Train Loss: 0.1819 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.8042 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1789 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3226 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1303 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1333 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2600 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2675 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.6919 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.6648 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9427 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.1770 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.2176 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.1896 | Val  Acc: 0.7143
 Site-Real      | Val  Loss: 0.2646 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.4697 | Val  Acc: 0.9048
Average Valid Accuracy: 0.9028
 Best site-Clipart    | Epoch:37 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:37 | Val Acc: 0.7381
 Best site-Painting   | Epoch:37 | Val Acc: 0.9762
 Best site-Painting   | Epoch:37 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.7143
 Best site-Real       | Epoch:37 | Val Acc: 0.9762
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1_1/DoPrompt...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-Clipart   | Train Loss: 0.1981 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2324 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1759 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1355 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 1.1059 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7341 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7382 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.1769 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1485 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.8042 | Train Acc: 0.7619
 Site-Real      | Train Loss: 0.1661 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2720 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1929 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3019 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2440 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.7117 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.6601 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.7541 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.1241 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.1954 | Val  Acc: 0.9762
 Site-QuickDraw | Val  Loss: 1.2975 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.3005 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5630 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8909
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-Clipart   | Train Loss: 0.1741 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2782 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1615 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1044 | Train Acc: 1.0000
 Site-Infograph | Train Loss: 1.0225 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.7042 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7144 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.1584 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.1863 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.7035 | Train Acc: 0.8413
 Site-Real      | Train Loss: 0.1269 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3024 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1227 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1630 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2838 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2001 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.6469 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.6089 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.9082 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.1193 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.2443 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.1341 | Val  Acc: 0.6667
 Site-Real      | Val  Loss: 0.3355 | Val  Acc: 0.9762
 Site-Sketch    | Val  Loss: 0.5564 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8948
===2023-04-06 11:04:08===
===2023-04-06 11:04:09===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:37 | Test Acc: 0.8726
 Test site-Infograph | Epoch:37 | Test Acc: 0.5236
 Test site-Painting  | Epoch:37 | Test Acc: 0.8885
 Test site-QuickDraw | Epoch:37 | Test Acc: 0.5540
 Test site-Real      | Epoch:37 | Test Acc: 0.9293
 Test site-Sketch    | Epoch:37 | Test Acc: 0.8321
Average Test Accuracy: 0.7667
