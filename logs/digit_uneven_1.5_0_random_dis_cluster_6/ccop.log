===2023-08-03 02:43:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[1, 3, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6424 | Train Acc: 0.6800
 Site-MNIST                     (2) | Train Loss: 1.6601 | Train Acc: 0.6568
 Site-MNIST                     (2) | Train Loss: 1.6874 | Train Acc: 0.5996
 Site-MNIST                     (2) | Train Loss: 1.6536 | Train Acc: 0.6636
 Site-MNIST                     (2) | Train Loss: 1.6537 | Train Acc: 0.6541
 Site-USPS                      (1) | Train Loss: 1.6635 | Train Acc: 0.5564
 Site-USPS                      (1) | Train Loss: 1.6740 | Train Acc: 0.5415
 Site-USPS                      (1) | Train Loss: 1.6605 | Train Acc: 0.5708
 Site-SynthDigits               (3) | Train Loss: 2.1259 | Train Acc: 0.2424
 Site-SynthDigits               (3) | Train Loss: 2.0929 | Train Acc: 0.2917
 Site-MNIST_M                   (5) | Train Loss: 2.1654 | Train Acc: 0.2244
 Site-MNIST_M                   (4) | Train Loss: 2.1833 | Train Acc: 0.2273
 Site-SVHN                      (0) | Train Loss: 2.2314 | Train Acc: 0.1840
Average Train Accuracy: 0.4687
 Site-MNIST                     (2) | Val  Loss: 1.7550 | Val  Acc: 0.5179
 Site-MNIST                     (2) | Val  Loss: 1.7378 | Val  Acc: 0.6429
 Site-MNIST                     (2) | Val  Loss: 1.6350 | Val  Acc: 0.6746
 Site-MNIST                     (2) | Val  Loss: 1.6797 | Val  Acc: 0.6053
 Site-MNIST                     (2) | Val  Loss: 1.6671 | Val  Acc: 0.6316
 Site-USPS                      (1) | Val  Loss: 1.6804 | Val  Acc: 0.5673
 Site-USPS                      (1) | Val  Loss: 1.7411 | Val  Acc: 0.4679
 Site-USPS                      (1) | Val  Loss: 1.6587 | Val  Acc: 0.5684
 Site-SynthDigits               (3) | Val  Loss: 2.2610 | Val  Acc: 0.2576
 Site-SynthDigits               (3) | Val  Loss: 2.0785 | Val  Acc: 0.2273
 Site-MNIST_M                   (5) | Val  Loss: 2.0568 | Val  Acc: 0.2841
 Site-MNIST_M                   (4) | Val  Loss: 2.1376 | Val  Acc: 0.2500
 Site-SVHN                      (0) | Val  Loss: 2.2363 | Val  Acc: 0.1644
Average Valid Accuracy: 0.4507
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5179
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6746
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6053
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6316
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5673
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.4679
 Best site-USPS                     (1)  | Epoch:0 | Val Acc: 0.5684
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2576
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2273
 Best site-MNIST_M                  (5)  | Epoch:0 | Val Acc: 0.2841
 Best site-MNIST_M                  (4)  | Epoch:0 | Val Acc: 0.2500
 Best site-SVHN                     (0)  | Epoch:0 | Val Acc: 0.1644
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (0) | Train Loss: 1.2242 | Train Acc: 0.7689
 Site-MNIST                     (0) | Train Loss: 1.2234 | Train Acc: 0.7988
 Site-MNIST                     (0) | Train Loss: 1.2621 | Train Acc: 0.7298
 Site-MNIST                     (0) | Train Loss: 1.2152 | Train Acc: 0.7490
 Site-MNIST                     (0) | Train Loss: 1.2202 | Train Acc: 0.7434
 Site-USPS                      (4) | Train Loss: 1.1575 | Train Acc: 0.7770
 Site-USPS                      (5) | Train Loss: 1.1763 | Train Acc: 0.7827
 Site-USPS                      (4) | Train Loss: 1.1685 | Train Acc: 0.7891
 Site-SynthDigits               (3) | Train Loss: 1.8873 | Train Acc: 0.3731
 Site-SynthDigits               (3) | Train Loss: 1.8646 | Train Acc: 0.3889
 Site-MNIST_M                   (2) | Train Loss: 2.0166 | Train Acc: 0.2784
 Site-MNIST_M                   (2) | Train Loss: 2.0551 | Train Acc: 0.2803
 Site-SVHN                      (1) | Train Loss: 2.0975 | Train Acc: 0.2368
Average Train Accuracy: 0.5920
 Site-MNIST                     (0) | Val  Loss: 1.3064 | Val  Acc: 0.6964
 Site-MNIST                     (0) | Val  Loss: 1.2867 | Val  Acc: 0.7738
 Site-MNIST                     (0) | Val  Loss: 1.2039 | Val  Acc: 0.7857
 Site-MNIST                     (0) | Val  Loss: 1.2679 | Val  Acc: 0.7474
 Site-MNIST                     (0) | Val  Loss: 1.2344 | Val  Acc: 0.7789
 Site-USPS                      (4) | Val  Loss: 1.1469 | Val  Acc: 0.8558
 Site-USPS                      (5) | Val  Loss: 1.2367 | Val  Acc: 0.7628
 Site-USPS                      (4) | Val  Loss: 1.1731 | Val  Acc: 0.7778
 Site-SynthDigits               (3) | Val  Loss: 2.0787 | Val  Acc: 0.3561
 Site-SynthDigits               (3) | Val  Loss: 1.8213 | Val  Acc: 0.3737
 Site-MNIST_M                   (2) | Val  Loss: 1.8952 | Val  Acc: 0.3864
 Site-MNIST_M                   (2) | Val  Loss: 2.0504 | Val  Acc: 0.2879
 Site-SVHN                      (1) | Val  Loss: 2.0768 | Val  Acc: 0.2466
Average Valid Accuracy: 0.6023
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.6964
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7738
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7474
 Best site-MNIST                    (0)  | Epoch:1 | Val Acc: 0.7789
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.8558
 Best site-USPS                     (5)  | Epoch:1 | Val Acc: 0.7628
 Best site-USPS                     (4)  | Epoch:1 | Val Acc: 0.7778
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3561
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.3737
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.3864
 Best site-MNIST_M                  (2)  | Epoch:1 | Val Acc: 0.2879
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.2466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (1) | Train Loss: 1.0165 | Train Acc: 0.7689
 Site-MNIST                     (1) | Train Loss: 1.0362 | Train Acc: 0.8136
 Site-MNIST                     (5) | Train Loss: 1.1005 | Train Acc: 0.7436
 Site-MNIST                     (5) | Train Loss: 1.0478 | Train Acc: 0.7727
 Site-MNIST                     (5) | Train Loss: 1.0382 | Train Acc: 0.7574
 Site-USPS                      (3) | Train Loss: 0.9706 | Train Acc: 0.7626
 Site-USPS                      (3) | Train Loss: 0.9764 | Train Acc: 0.7636
 Site-USPS                      (3) | Train Loss: 0.9581 | Train Acc: 0.7902
 Site-SynthDigits               (2) | Train Loss: 1.7086 | Train Acc: 0.4451
 Site-SynthDigits               (2) | Train Loss: 1.6180 | Train Acc: 0.4722
 Site-MNIST_M                   (0) | Train Loss: 1.8559 | Train Acc: 0.3580
 Site-MNIST_M                   (0) | Train Loss: 1.8955 | Train Acc: 0.3598
 Site-SVHN                      (4) | Train Loss: 2.0135 | Train Acc: 0.2692
Average Train Accuracy: 0.6213
 Site-MNIST                     (1) | Val  Loss: 1.1193 | Val  Acc: 0.7679
 Site-MNIST                     (1) | Val  Loss: 1.1188 | Val  Acc: 0.7738
 Site-MNIST                     (5) | Val  Loss: 1.0255 | Val  Acc: 0.7778
 Site-MNIST                     (5) | Val  Loss: 1.1084 | Val  Acc: 0.7579
 Site-MNIST                     (5) | Val  Loss: 1.0663 | Val  Acc: 0.8105
 Site-USPS                      (3) | Val  Loss: 0.9386 | Val  Acc: 0.8365
 Site-USPS                      (3) | Val  Loss: 1.0361 | Val  Acc: 0.7308
 Site-USPS                      (3) | Val  Loss: 0.9832 | Val  Acc: 0.7607
 Site-SynthDigits               (2) | Val  Loss: 1.8845 | Val  Acc: 0.4545
 Site-SynthDigits               (2) | Val  Loss: 1.6010 | Val  Acc: 0.4646
 Site-MNIST_M                   (0) | Val  Loss: 1.7403 | Val  Acc: 0.4545
 Site-MNIST_M                   (0) | Val  Loss: 1.9136 | Val  Acc: 0.3939
 Site-SVHN                      (4) | Val  Loss: 1.9691 | Val  Acc: 0.2671
Average Valid Accuracy: 0.6347
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7679
 Best site-MNIST                    (1)  | Epoch:2 | Val Acc: 0.7738
 Best site-MNIST                    (5)  | Epoch:2 | Val Acc: 0.7778
 Best site-MNIST                    (5)  | Epoch:2 | Val Acc: 0.7579
 Best site-MNIST                    (5)  | Epoch:2 | Val Acc: 0.8105
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.8365
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7308
 Best site-USPS                     (3)  | Epoch:2 | Val Acc: 0.7607
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4545
 Best site-SynthDigits              (2)  | Epoch:2 | Val Acc: 0.4646
 Best site-MNIST_M                  (0)  | Epoch:2 | Val Acc: 0.4545
 Best site-MNIST_M                  (0)  | Epoch:2 | Val Acc: 0.3939
 Best site-SVHN                     (4)  | Epoch:2 | Val Acc: 0.2671
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.9127 | Train Acc: 0.7822
 Site-MNIST                     (5) | Train Loss: 0.9126 | Train Acc: 0.8550
 Site-MNIST                     (0) | Train Loss: 0.9599 | Train Acc: 0.7653
 Site-MNIST                     (5) | Train Loss: 0.9139 | Train Acc: 0.7898
 Site-MNIST                     (5) | Train Loss: 0.9066 | Train Acc: 0.7863
 Site-USPS                      (3) | Train Loss: 0.8419 | Train Acc: 0.7938
 Site-USPS                      (3) | Train Loss: 0.8453 | Train Acc: 0.8051
 Site-USPS                      (3) | Train Loss: 0.8254 | Train Acc: 0.8253
 Site-SynthDigits               (2) | Train Loss: 1.5270 | Train Acc: 0.5170
 Site-SynthDigits               (2) | Train Loss: 1.4674 | Train Acc: 0.5492
 Site-MNIST_M                   (1) | Train Loss: 1.7238 | Train Acc: 0.4148
 Site-MNIST_M                   (1) | Train Loss: 1.7937 | Train Acc: 0.4299
 Site-SVHN                      (4) | Train Loss: 1.9287 | Train Acc: 0.3322
Average Train Accuracy: 0.6651
 Site-MNIST                     (0) | Val  Loss: 0.9636 | Val  Acc: 0.7679
 Site-MNIST                     (5) | Val  Loss: 0.9528 | Val  Acc: 0.8214
 Site-MNIST                     (0) | Val  Loss: 0.8814 | Val  Acc: 0.8016
 Site-MNIST                     (5) | Val  Loss: 0.9738 | Val  Acc: 0.7895
 Site-MNIST                     (5) | Val  Loss: 0.9278 | Val  Acc: 0.8386
 Site-USPS                      (3) | Val  Loss: 0.8021 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.8896 | Val  Acc: 0.7949
 Site-USPS                      (3) | Val  Loss: 0.8506 | Val  Acc: 0.7906
 Site-SynthDigits               (2) | Val  Loss: 1.7419 | Val  Acc: 0.5000
 Site-SynthDigits               (2) | Val  Loss: 1.4386 | Val  Acc: 0.5051
 Site-MNIST_M                   (1) | Val  Loss: 1.5947 | Val  Acc: 0.5000
 Site-MNIST_M                   (1) | Val  Loss: 1.8127 | Val  Acc: 0.4091
 Site-SVHN                      (4) | Val  Loss: 1.8566 | Val  Acc: 0.3288
Average Valid Accuracy: 0.6702
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7679
 Best site-MNIST                    (5)  | Epoch:3 | Val Acc: 0.8214
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8016
 Best site-MNIST                    (5)  | Epoch:3 | Val Acc: 0.7895
 Best site-MNIST                    (5)  | Epoch:3 | Val Acc: 0.8386
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7949
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7906
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5000
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5051
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.4091
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.3288
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 4 ============
cnt=[3, 1, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (2) | Train Loss: 0.7824 | Train Acc: 0.8267
 Site-MNIST                     (2) | Train Loss: 0.7832 | Train Acc: 0.8580
 Site-MNIST                     (2) | Train Loss: 0.8393 | Train Acc: 0.7870
 Site-MNIST                     (2) | Train Loss: 0.7971 | Train Acc: 0.8068
 Site-MNIST                     (5) | Train Loss: 0.7871 | Train Acc: 0.8205
 Site-USPS                      (0) | Train Loss: 0.7639 | Train Acc: 0.8082
 Site-USPS                      (0) | Train Loss: 0.7661 | Train Acc: 0.8083
 Site-USPS                      (0) | Train Loss: 0.7524 | Train Acc: 0.8285
 Site-SynthDigits               (4) | Train Loss: 1.3894 | Train Acc: 0.5644
 Site-SynthDigits               (4) | Train Loss: 1.3174 | Train Acc: 0.6124
 Site-MNIST_M                   (3) | Train Loss: 1.6403 | Train Acc: 0.4716
 Site-MNIST_M                   (3) | Train Loss: 1.6648 | Train Acc: 0.4621
 Site-SVHN                      (1) | Train Loss: 1.8187 | Train Acc: 0.3663
Average Train Accuracy: 0.6939
 Site-MNIST                     (2) | Val  Loss: 0.8204 | Val  Acc: 0.8036
 Site-MNIST                     (2) | Val  Loss: 0.8103 | Val  Acc: 0.8333
 Site-MNIST                     (2) | Val  Loss: 0.7615 | Val  Acc: 0.8254
 Site-MNIST                     (2) | Val  Loss: 0.8545 | Val  Acc: 0.7947
 Site-MNIST                     (5) | Val  Loss: 0.8036 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.7179 | Val  Acc: 0.8654
 Site-USPS                      (0) | Val  Loss: 0.8074 | Val  Acc: 0.7885
 Site-USPS                      (0) | Val  Loss: 0.7824 | Val  Acc: 0.7949
 Site-SynthDigits               (4) | Val  Loss: 1.6108 | Val  Acc: 0.5379
 Site-SynthDigits               (4) | Val  Loss: 1.3029 | Val  Acc: 0.5657
 Site-MNIST_M                   (3) | Val  Loss: 1.5231 | Val  Acc: 0.5341
 Site-MNIST_M                   (3) | Val  Loss: 1.7500 | Val  Acc: 0.4697
 Site-SVHN                      (1) | Val  Loss: 1.7675 | Val  Acc: 0.3973
Average Valid Accuracy: 0.6972
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8036
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.8254
 Best site-MNIST                    (2)  | Epoch:4 | Val Acc: 0.7947
 Best site-MNIST                    (5)  | Epoch:4 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8654
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7885
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7949
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.5379
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.5657
 Best site-MNIST_M                  (3)  | Epoch:4 | Val Acc: 0.5341
 Best site-MNIST_M                  (3)  | Epoch:4 | Val Acc: 0.4697
 Best site-SVHN                     (1)  | Epoch:4 | Val Acc: 0.3973
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 1, 1, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (5) | Train Loss: 0.7423 | Train Acc: 0.8000
 Site-MNIST                     (5) | Train Loss: 0.7027 | Train Acc: 0.8462
 Site-MNIST                     (2) | Train Loss: 0.7792 | Train Acc: 0.7890
 Site-MNIST                     (5) | Train Loss: 0.7475 | Train Acc: 0.8226
 Site-MNIST                     (5) | Train Loss: 0.7339 | Train Acc: 0.8249
 Site-USPS                      (0) | Train Loss: 0.7074 | Train Acc: 0.8010
 Site-USPS                      (0) | Train Loss: 0.7148 | Train Acc: 0.8211
 Site-USPS                      (0) | Train Loss: 0.6990 | Train Acc: 0.8424
 Site-SynthDigits               (4) | Train Loss: 1.2998 | Train Acc: 0.5909
 Site-SynthDigits               (4) | Train Loss: 1.2183 | Train Acc: 0.6376
 Site-MNIST_M                   (3) | Train Loss: 1.5534 | Train Acc: 0.5256
 Site-MNIST_M                   (3) | Train Loss: 1.5606 | Train Acc: 0.5303
 Site-SVHN                      (1) | Train Loss: 1.7405 | Train Acc: 0.4191
Average Train Accuracy: 0.7116
 Site-MNIST                     (5) | Val  Loss: 0.7559 | Val  Acc: 0.8036
 Site-MNIST                     (5) | Val  Loss: 0.7408 | Val  Acc: 0.8452
 Site-MNIST                     (2) | Val  Loss: 0.7210 | Val  Acc: 0.8175
 Site-MNIST                     (5) | Val  Loss: 0.8019 | Val  Acc: 0.7842
 Site-MNIST                     (5) | Val  Loss: 0.7412 | Val  Acc: 0.8386
 Site-USPS                      (0) | Val  Loss: 0.6800 | Val  Acc: 0.8558
 Site-USPS                      (0) | Val  Loss: 0.7601 | Val  Acc: 0.7949
 Site-USPS                      (0) | Val  Loss: 0.7369 | Val  Acc: 0.7991
 Site-SynthDigits               (4) | Val  Loss: 1.5297 | Val  Acc: 0.5379
 Site-SynthDigits               (4) | Val  Loss: 1.1872 | Val  Acc: 0.5808
 Site-MNIST_M                   (3) | Val  Loss: 1.4205 | Val  Acc: 0.5909
 Site-MNIST_M                   (3) | Val  Loss: 1.6468 | Val  Acc: 0.5379
 Site-SVHN                      (1) | Val  Loss: 1.6633 | Val  Acc: 0.4452
Average Valid Accuracy: 0.7101
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8036
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8452
 Best site-MNIST                    (2)  | Epoch:5 | Val Acc: 0.8175
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.7842
 Best site-MNIST                    (5)  | Epoch:5 | Val Acc: 0.8386
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8558
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7949
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7991
 Best site-SynthDigits              (4)  | Epoch:5 | Val Acc: 0.5379
 Best site-SynthDigits              (4)  | Epoch:5 | Val Acc: 0.5808
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.5909
 Best site-MNIST_M                  (3)  | Epoch:5 | Val Acc: 0.5379
 Best site-SVHN                     (1)  | Epoch:5 | Val Acc: 0.4452
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 2, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (2) | Train Loss: 0.6714 | Train Acc: 0.8444
 Site-MNIST                     (2) | Train Loss: 0.6039 | Train Acc: 0.8757
 Site-MNIST                     (2) | Train Loss: 0.6934 | Train Acc: 0.8284
 Site-MNIST                     (5) | Train Loss: 0.6627 | Train Acc: 0.8292
 Site-MNIST                     (2) | Train Loss: 0.6441 | Train Acc: 0.8468
 Site-USPS                      (0) | Train Loss: 0.6910 | Train Acc: 0.8201
 Site-USPS                      (0) | Train Loss: 0.6798 | Train Acc: 0.8243
 Site-USPS                      (0) | Train Loss: 0.6701 | Train Acc: 0.8371
 Site-SynthDigits               (3) | Train Loss: 1.1674 | Train Acc: 0.6553
 Site-SynthDigits               (3) | Train Loss: 1.0990 | Train Acc: 0.7045
 Site-MNIST_M                   (1) | Train Loss: 1.4305 | Train Acc: 0.5710
 Site-MNIST_M                   (1) | Train Loss: 1.4864 | Train Acc: 0.5530
 Site-SVHN                      (4) | Train Loss: 1.6617 | Train Acc: 0.4446
Average Train Accuracy: 0.7411
 Site-MNIST                     (2) | Val  Loss: 0.6511 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.6418 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.6290 | Val  Acc: 0.8730
 Site-MNIST                     (5) | Val  Loss: 0.7101 | Val  Acc: 0.8368
 Site-MNIST                     (2) | Val  Loss: 0.6557 | Val  Acc: 0.8667
 Site-USPS                      (0) | Val  Loss: 0.6238 | Val  Acc: 0.8654
 Site-USPS                      (0) | Val  Loss: 0.7187 | Val  Acc: 0.7885
 Site-USPS                      (0) | Val  Loss: 0.7129 | Val  Acc: 0.7991
 Site-SynthDigits               (3) | Val  Loss: 1.4216 | Val  Acc: 0.6136
 Site-SynthDigits               (3) | Val  Loss: 1.0840 | Val  Acc: 0.6414
 Site-MNIST_M                   (1) | Val  Loss: 1.3440 | Val  Acc: 0.6023
 Site-MNIST_M                   (1) | Val  Loss: 1.5997 | Val  Acc: 0.5758
 Site-SVHN                      (4) | Val  Loss: 1.6039 | Val  Acc: 0.4863
Average Valid Accuracy: 0.7474
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8730
 Best site-MNIST                    (5)  | Epoch:6 | Val Acc: 0.8368
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8667
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8654
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7885
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7991
 Best site-SynthDigits              (3)  | Epoch:6 | Val Acc: 0.6136
 Best site-SynthDigits              (3)  | Epoch:6 | Val Acc: 0.6414
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.6023
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.5758
 Best site-SVHN                     (4)  | Epoch:6 | Val Acc: 0.4863
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 3, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (2) | Train Loss: 0.6283 | Train Acc: 0.8133
 Site-MNIST                     (2) | Train Loss: 0.5723 | Train Acc: 0.8669
 Site-MNIST                     (2) | Train Loss: 0.6493 | Train Acc: 0.8225
 Site-MNIST                     (2) | Train Loss: 0.6202 | Train Acc: 0.8476
 Site-MNIST                     (2) | Train Loss: 0.6041 | Train Acc: 0.8520
 Site-USPS                      (1) | Train Loss: 0.6245 | Train Acc: 0.8273
 Site-USPS                      (1) | Train Loss: 0.6187 | Train Acc: 0.8514
 Site-USPS                      (1) | Train Loss: 0.6098 | Train Acc: 0.8552
 Site-SynthDigits               (4) | Train Loss: 1.0701 | Train Acc: 0.6629
 Site-SynthDigits               (4) | Train Loss: 1.0085 | Train Acc: 0.7273
 Site-MNIST_M                   (5) | Train Loss: 1.3918 | Train Acc: 0.6051
 Site-MNIST_M                   (3) | Train Loss: 1.4109 | Train Acc: 0.5720
 Site-SVHN                      (0) | Train Loss: 1.5753 | Train Acc: 0.4787
Average Train Accuracy: 0.7525
 Site-MNIST                     (2) | Val  Loss: 0.5969 | Val  Acc: 0.8750
 Site-MNIST                     (2) | Val  Loss: 0.5833 | Val  Acc: 0.8810
 Site-MNIST                     (2) | Val  Loss: 0.5994 | Val  Acc: 0.8492
 Site-MNIST                     (2) | Val  Loss: 0.6676 | Val  Acc: 0.8263
 Site-MNIST                     (2) | Val  Loss: 0.6081 | Val  Acc: 0.8667
 Site-USPS                      (1) | Val  Loss: 0.5666 | Val  Acc: 0.8942
 Site-USPS                      (1) | Val  Loss: 0.6587 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.6605 | Val  Acc: 0.8162
 Site-SynthDigits               (4) | Val  Loss: 1.3445 | Val  Acc: 0.6212
 Site-SynthDigits               (4) | Val  Loss: 0.9925 | Val  Acc: 0.6717
 Site-MNIST_M                   (5) | Val  Loss: 1.2876 | Val  Acc: 0.6818
 Site-MNIST_M                   (3) | Val  Loss: 1.5187 | Val  Acc: 0.5909
 Site-SVHN                      (0) | Val  Loss: 1.5348 | Val  Acc: 0.5000
Average Valid Accuracy: 0.7621
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8750
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8810
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8492
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8263
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8667
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8942
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8162
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6212
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6717
 Best site-MNIST_M                  (5)  | Epoch:7 | Val Acc: 0.6818
 Best site-MNIST_M                  (3)  | Epoch:7 | Val Acc: 0.5909
 Best site-SVHN                     (0)  | Epoch:7 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (0) | Train Loss: 0.5835 | Train Acc: 0.8222
 Site-MNIST                     (0) | Train Loss: 0.5676 | Train Acc: 0.8698
 Site-MNIST                     (0) | Train Loss: 0.6023 | Train Acc: 0.8304
 Site-MNIST                     (0) | Train Loss: 0.5823 | Train Acc: 0.8515
 Site-MNIST                     (0) | Train Loss: 0.5644 | Train Acc: 0.8634
 Site-USPS                      (3) | Train Loss: 0.6055 | Train Acc: 0.8297
 Site-USPS                      (3) | Train Loss: 0.5951 | Train Acc: 0.8514
 Site-USPS                      (3) | Train Loss: 0.5949 | Train Acc: 0.8520
 Site-SynthDigits               (5) | Train Loss: 1.0288 | Train Acc: 0.7102
 Site-SynthDigits               (2) | Train Loss: 0.9447 | Train Acc: 0.7576
 Site-MNIST_M                   (1) | Train Loss: 1.3081 | Train Acc: 0.6250
 Site-MNIST_M                   (1) | Train Loss: 1.3150 | Train Acc: 0.5947
 Site-SVHN                      (4) | Train Loss: 1.4848 | Train Acc: 0.5145
Average Train Accuracy: 0.7671
 Site-MNIST                     (0) | Val  Loss: 0.5437 | Val  Acc: 0.8750
 Site-MNIST                     (0) | Val  Loss: 0.5387 | Val  Acc: 0.8690
 Site-MNIST                     (0) | Val  Loss: 0.5617 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.6226 | Val  Acc: 0.8368
 Site-MNIST                     (0) | Val  Loss: 0.5679 | Val  Acc: 0.8667
 Site-USPS                      (3) | Val  Loss: 0.5396 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.6283 | Val  Acc: 0.8397
 Site-USPS                      (3) | Val  Loss: 0.6424 | Val  Acc: 0.8248
 Site-SynthDigits               (5) | Val  Loss: 1.2463 | Val  Acc: 0.6515
 Site-SynthDigits               (2) | Val  Loss: 0.9107 | Val  Acc: 0.7121
 Site-MNIST_M                   (1) | Val  Loss: 1.2216 | Val  Acc: 0.6818
 Site-MNIST_M                   (1) | Val  Loss: 1.4235 | Val  Acc: 0.6212
 Site-SVHN                      (4) | Val  Loss: 1.4408 | Val  Acc: 0.5137
Average Valid Accuracy: 0.7719
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8690
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8368
 Best site-MNIST                    (0)  | Epoch:8 | Val Acc: 0.8667
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8397
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8248
 Best site-SynthDigits              (5)  | Epoch:8 | Val Acc: 0.6515
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7121
 Best site-MNIST_M                  (1)  | Epoch:8 | Val Acc: 0.6818
 Best site-MNIST_M                  (1)  | Epoch:8 | Val Acc: 0.6212
 Best site-SVHN                     (4)  | Epoch:8 | Val Acc: 0.5137
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (0) | Train Loss: 0.5666 | Train Acc: 0.8222
 Site-MNIST                     (0) | Train Loss: 0.5154 | Train Acc: 0.8817
 Site-MNIST                     (0) | Train Loss: 0.5686 | Train Acc: 0.8442
 Site-MNIST                     (0) | Train Loss: 0.5446 | Train Acc: 0.8594
 Site-MNIST                     (0) | Train Loss: 0.5233 | Train Acc: 0.8687
 Site-USPS                      (3) | Train Loss: 0.5636 | Train Acc: 0.8393
 Site-USPS                      (3) | Train Loss: 0.5450 | Train Acc: 0.8610
 Site-USPS                      (3) | Train Loss: 0.5450 | Train Acc: 0.8626
 Site-SynthDigits               (2) | Train Loss: 0.9493 | Train Acc: 0.7216
 Site-SynthDigits               (2) | Train Loss: 0.8652 | Train Acc: 0.7652
 Site-MNIST_M                   (1) | Train Loss: 1.2578 | Train Acc: 0.6477
 Site-MNIST_M                   (5) | Train Loss: 1.2740 | Train Acc: 0.6174
 Site-SVHN                      (4) | Train Loss: 1.4318 | Train Acc: 0.5298
Average Train Accuracy: 0.7785
 Site-MNIST                     (0) | Val  Loss: 0.5001 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.4960 | Val  Acc: 0.8810
 Site-MNIST                     (0) | Val  Loss: 0.5235 | Val  Acc: 0.8651
 Site-MNIST                     (0) | Val  Loss: 0.5839 | Val  Acc: 0.8421
 Site-MNIST                     (0) | Val  Loss: 0.5266 | Val  Acc: 0.8737
 Site-USPS                      (3) | Val  Loss: 0.4891 | Val  Acc: 0.8750
 Site-USPS                      (3) | Val  Loss: 0.5779 | Val  Acc: 0.8397
 Site-USPS                      (3) | Val  Loss: 0.5967 | Val  Acc: 0.8162
 Site-SynthDigits               (2) | Val  Loss: 1.1766 | Val  Acc: 0.6894
 Site-SynthDigits               (2) | Val  Loss: 0.8491 | Val  Acc: 0.7222
 Site-MNIST_M                   (1) | Val  Loss: 1.1687 | Val  Acc: 0.7045
 Site-MNIST_M                   (5) | Val  Loss: 1.3658 | Val  Acc: 0.6288
 Site-SVHN                      (4) | Val  Loss: 1.4040 | Val  Acc: 0.5342
Average Valid Accuracy: 0.7819
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8810
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8651
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8421
 Best site-MNIST                    (0)  | Epoch:9 | Val Acc: 0.8737
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8750
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8397
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8162
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6894
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7222
 Best site-MNIST_M                  (1)  | Epoch:9 | Val Acc: 0.7045
 Best site-MNIST_M                  (5)  | Epoch:9 | Val Acc: 0.6288
 Best site-SVHN                     (4)  | Epoch:9 | Val Acc: 0.5342
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 2, 2, 3, 1, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (5) | Train Loss: 0.5432 | Train Acc: 0.8044
 Site-MNIST                     (5) | Train Loss: 0.4778 | Train Acc: 0.8876
 Site-MNIST                     (5) | Train Loss: 0.5631 | Train Acc: 0.8304
 Site-MNIST                     (0) | Train Loss: 0.5354 | Train Acc: 0.8463
 Site-MNIST                     (0) | Train Loss: 0.5151 | Train Acc: 0.8651
 Site-USPS                      (3) | Train Loss: 0.5275 | Train Acc: 0.8633
 Site-USPS                      (3) | Train Loss: 0.5086 | Train Acc: 0.8706
 Site-USPS                      (3) | Train Loss: 0.5034 | Train Acc: 0.8871
 Site-SynthDigits               (2) | Train Loss: 0.8925 | Train Acc: 0.7500
 Site-SynthDigits               (2) | Train Loss: 0.8210 | Train Acc: 0.7689
 Site-MNIST_M                   (1) | Train Loss: 1.2133 | Train Acc: 0.6619
 Site-MNIST_M                   (1) | Train Loss: 1.2174 | Train Acc: 0.6648
 Site-SVHN                      (4) | Train Loss: 1.4215 | Train Acc: 0.5468
Average Train Accuracy: 0.7883
 Site-MNIST                     (5) | Val  Loss: 0.4917 | Val  Acc: 0.8929
 Site-MNIST                     (5) | Val  Loss: 0.4830 | Val  Acc: 0.8333
 Site-MNIST                     (5) | Val  Loss: 0.5163 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.5754 | Val  Acc: 0.8474
 Site-MNIST                     (0) | Val  Loss: 0.5138 | Val  Acc: 0.8842
 Site-USPS                      (3) | Val  Loss: 0.4636 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.5422 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.5590 | Val  Acc: 0.8376
 Site-SynthDigits               (2) | Val  Loss: 1.0878 | Val  Acc: 0.6970
 Site-SynthDigits               (2) | Val  Loss: 0.7746 | Val  Acc: 0.7475
 Site-MNIST_M                   (1) | Val  Loss: 1.1113 | Val  Acc: 0.6818
 Site-MNIST_M                   (1) | Val  Loss: 1.3056 | Val  Acc: 0.6515
 Site-SVHN                      (4) | Val  Loss: 1.3602 | Val  Acc: 0.5205
Average Valid Accuracy: 0.7811
============ Train epoch 11 ============
cnt=[2, 2, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (2) | Train Loss: 0.4900 | Train Acc: 0.8489
 Site-MNIST                     (2) | Train Loss: 0.4446 | Train Acc: 0.9053
 Site-MNIST                     (2) | Train Loss: 0.4922 | Train Acc: 0.8738
 Site-MNIST                     (2) | Train Loss: 0.4729 | Train Acc: 0.8725
 Site-MNIST                     (2) | Train Loss: 0.4493 | Train Acc: 0.8975
 Site-USPS                      (0) | Train Loss: 0.5084 | Train Acc: 0.8465
 Site-USPS                      (5) | Train Loss: 0.4992 | Train Acc: 0.8706
 Site-USPS                      (0) | Train Loss: 0.4869 | Train Acc: 0.8807
 Site-SynthDigits               (3) | Train Loss: 0.8453 | Train Acc: 0.7500
 Site-SynthDigits               (3) | Train Loss: 0.7678 | Train Acc: 0.8131
 Site-MNIST_M                   (1) | Train Loss: 1.1678 | Train Acc: 0.6506
 Site-MNIST_M                   (1) | Train Loss: 1.1587 | Train Acc: 0.6553
 Site-SVHN                      (4) | Train Loss: 1.3158 | Train Acc: 0.5707
Average Train Accuracy: 0.8027
 Site-MNIST                     (2) | Val  Loss: 0.4186 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.4060 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.4503 | Val  Acc: 0.8810
 Site-MNIST                     (2) | Val  Loss: 0.5063 | Val  Acc: 0.8684
 Site-MNIST                     (2) | Val  Loss: 0.4483 | Val  Acc: 0.8912
 Site-USPS                      (0) | Val  Loss: 0.4364 | Val  Acc: 0.8942
 Site-USPS                      (5) | Val  Loss: 0.5181 | Val  Acc: 0.8526
 Site-USPS                      (0) | Val  Loss: 0.5479 | Val  Acc: 0.8291
 Site-SynthDigits               (3) | Val  Loss: 1.0251 | Val  Acc: 0.7424
 Site-SynthDigits               (3) | Val  Loss: 0.7379 | Val  Acc: 0.7576
 Site-MNIST_M                   (1) | Val  Loss: 1.1191 | Val  Acc: 0.7045
 Site-MNIST_M                   (1) | Val  Loss: 1.2468 | Val  Acc: 0.6364
 Site-SVHN                      (4) | Val  Loss: 1.2956 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8014
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8929
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8810
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8684
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8912
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8942
 Best site-USPS                     (5)  | Epoch:11 | Val Acc: 0.8526
 Best site-USPS                     (0)  | Epoch:11 | Val Acc: 0.8291
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7424
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7576
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.7045
 Best site-MNIST_M                  (1)  | Epoch:11 | Val Acc: 0.6364
 Best site-SVHN                     (4)  | Epoch:11 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 12 ============
cnt=[5, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.4571 | Train Acc: 0.8444
 Site-MNIST                     (0) | Train Loss: 0.3791 | Train Acc: 0.9053
 Site-MNIST                     (0) | Train Loss: 0.4678 | Train Acc: 0.8817
 Site-MNIST                     (0) | Train Loss: 0.4485 | Train Acc: 0.8739
 Site-MNIST                     (0) | Train Loss: 0.4275 | Train Acc: 0.8967
 Site-USPS                      (3) | Train Loss: 0.4850 | Train Acc: 0.8585
 Site-USPS                      (3) | Train Loss: 0.4677 | Train Acc: 0.8786
 Site-USPS                      (3) | Train Loss: 0.4621 | Train Acc: 0.8935
 Site-SynthDigits               (4) | Train Loss: 0.7874 | Train Acc: 0.7841
 Site-SynthDigits               (4) | Train Loss: 0.7187 | Train Acc: 0.8194
 Site-MNIST_M                   (2) | Train Loss: 1.1094 | Train Acc: 0.6648
 Site-MNIST_M                   (5) | Train Loss: 1.0824 | Train Acc: 0.6894
 Site-SVHN                      (1) | Train Loss: 1.2504 | Train Acc: 0.5860
Average Train Accuracy: 0.8136
 Site-MNIST                     (0) | Val  Loss: 0.3914 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.3806 | Val  Acc: 0.8929
 Site-MNIST                     (0) | Val  Loss: 0.4264 | Val  Acc: 0.8889
 Site-MNIST                     (0) | Val  Loss: 0.4819 | Val  Acc: 0.8842
 Site-MNIST                     (0) | Val  Loss: 0.4270 | Val  Acc: 0.9018
 Site-USPS                      (3) | Val  Loss: 0.4115 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4881 | Val  Acc: 0.8462
 Site-USPS                      (3) | Val  Loss: 0.5214 | Val  Acc: 0.8419
 Site-SynthDigits               (4) | Val  Loss: 0.9405 | Val  Acc: 0.7576
 Site-SynthDigits               (4) | Val  Loss: 0.6782 | Val  Acc: 0.7929
 Site-MNIST_M                   (2) | Val  Loss: 1.0550 | Val  Acc: 0.6932
 Site-MNIST_M                   (5) | Val  Loss: 1.1780 | Val  Acc: 0.6439
 Site-SVHN                      (1) | Val  Loss: 1.2600 | Val  Acc: 0.5616
Average Valid Accuracy: 0.8085
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8929
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8889
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8842
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9018
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8462
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8419
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7576
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7929
 Best site-MNIST_M                  (2)  | Epoch:12 | Val Acc: 0.6932
 Best site-MNIST_M                  (5)  | Epoch:12 | Val Acc: 0.6439
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.5616
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 5, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (1) | Train Loss: 0.4186 | Train Acc: 0.8533
 Site-MNIST                     (1) | Train Loss: 0.3840 | Train Acc: 0.9112
 Site-MNIST                     (1) | Train Loss: 0.4363 | Train Acc: 0.8876
 Site-MNIST                     (1) | Train Loss: 0.4236 | Train Acc: 0.8844
 Site-MNIST                     (1) | Train Loss: 0.3970 | Train Acc: 0.9054
 Site-USPS                      (3) | Train Loss: 0.4732 | Train Acc: 0.8681
 Site-USPS                      (3) | Train Loss: 0.4439 | Train Acc: 0.8866
 Site-USPS                      (3) | Train Loss: 0.4436 | Train Acc: 0.8956
 Site-SynthDigits               (5) | Train Loss: 0.7478 | Train Acc: 0.7992
 Site-SynthDigits               (0) | Train Loss: 0.6642 | Train Acc: 0.8220
 Site-MNIST_M                   (2) | Train Loss: 1.0535 | Train Acc: 0.6733
 Site-MNIST_M                   (2) | Train Loss: 1.0584 | Train Acc: 0.6875
 Site-SVHN                      (4) | Train Loss: 1.2180 | Train Acc: 0.6116
Average Train Accuracy: 0.8220
 Site-MNIST                     (1) | Val  Loss: 0.3495 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3441 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.4019 | Val  Acc: 0.9127
 Site-MNIST                     (1) | Val  Loss: 0.4529 | Val  Acc: 0.8895
 Site-MNIST                     (1) | Val  Loss: 0.3977 | Val  Acc: 0.9088
 Site-USPS                      (3) | Val  Loss: 0.3862 | Val  Acc: 0.8942
 Site-USPS                      (3) | Val  Loss: 0.4651 | Val  Acc: 0.8526
 Site-USPS                      (3) | Val  Loss: 0.5037 | Val  Acc: 0.8504
 Site-SynthDigits               (5) | Val  Loss: 0.9007 | Val  Acc: 0.7500
 Site-SynthDigits               (0) | Val  Loss: 0.6360 | Val  Acc: 0.7929
 Site-MNIST_M                   (2) | Val  Loss: 0.9914 | Val  Acc: 0.7273
 Site-MNIST_M                   (2) | Val  Loss: 1.1135 | Val  Acc: 0.6742
 Site-SVHN                      (4) | Val  Loss: 1.2422 | Val  Acc: 0.5685
Average Valid Accuracy: 0.8214
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.9127
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.8895
 Best site-MNIST                    (1)  | Epoch:13 | Val Acc: 0.9088
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8942
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8526
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8504
 Best site-SynthDigits              (5)  | Epoch:13 | Val Acc: 0.7500
 Best site-SynthDigits              (0)  | Epoch:13 | Val Acc: 0.7929
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.7273
 Best site-MNIST_M                  (2)  | Epoch:13 | Val Acc: 0.6742
 Best site-SVHN                     (4)  | Epoch:13 | Val Acc: 0.5685
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 3, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (2) | Train Loss: 0.4070 | Train Acc: 0.8667
 Site-MNIST                     (2) | Train Loss: 0.3377 | Train Acc: 0.9201
 Site-MNIST                     (2) | Train Loss: 0.4137 | Train Acc: 0.8915
 Site-MNIST                     (2) | Train Loss: 0.3973 | Train Acc: 0.8988
 Site-MNIST                     (2) | Train Loss: 0.3715 | Train Acc: 0.9177
 Site-USPS                      (1) | Train Loss: 0.4412 | Train Acc: 0.8753
 Site-USPS                      (1) | Train Loss: 0.4264 | Train Acc: 0.8802
 Site-USPS                      (1) | Train Loss: 0.4227 | Train Acc: 0.8946
 Site-SynthDigits               (4) | Train Loss: 0.6966 | Train Acc: 0.8125
 Site-SynthDigits               (4) | Train Loss: 0.6289 | Train Acc: 0.8434
 Site-MNIST_M                   (5) | Train Loss: 1.0200 | Train Acc: 0.6989
 Site-MNIST_M                   (0) | Train Loss: 0.9893 | Train Acc: 0.7083
 Site-SVHN                      (3) | Train Loss: 1.2062 | Train Acc: 0.6150
Average Train Accuracy: 0.8325
 Site-MNIST                     (2) | Val  Loss: 0.3348 | Val  Acc: 0.8929
 Site-MNIST                     (2) | Val  Loss: 0.3264 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.3723 | Val  Acc: 0.9048
 Site-MNIST                     (2) | Val  Loss: 0.4244 | Val  Acc: 0.9000
 Site-MNIST                     (2) | Val  Loss: 0.3740 | Val  Acc: 0.9193
 Site-USPS                      (1) | Val  Loss: 0.3704 | Val  Acc: 0.8846
 Site-USPS                      (1) | Val  Loss: 0.4435 | Val  Acc: 0.8590
 Site-USPS                      (1) | Val  Loss: 0.4816 | Val  Acc: 0.8547
 Site-SynthDigits               (4) | Val  Loss: 0.8331 | Val  Acc: 0.7803
 Site-SynthDigits               (4) | Val  Loss: 0.5999 | Val  Acc: 0.7980
 Site-MNIST_M                   (5) | Val  Loss: 0.9561 | Val  Acc: 0.7159
 Site-MNIST_M                   (0) | Val  Loss: 1.0473 | Val  Acc: 0.6970
 Site-SVHN                      (3) | Val  Loss: 1.2189 | Val  Acc: 0.5616
Average Valid Accuracy: 0.8210
============ Train epoch 15 ============
cnt=[3, 2, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (5) | Train Loss: 0.3701 | Train Acc: 0.8844
 Site-MNIST                     (5) | Train Loss: 0.3222 | Train Acc: 0.9320
 Site-MNIST                     (2) | Train Loss: 0.3869 | Train Acc: 0.8994
 Site-MNIST                     (5) | Train Loss: 0.3741 | Train Acc: 0.9014
 Site-MNIST                     (2) | Train Loss: 0.3440 | Train Acc: 0.9194
 Site-USPS                      (0) | Train Loss: 0.4342 | Train Acc: 0.8753
 Site-USPS                      (0) | Train Loss: 0.4203 | Train Acc: 0.8866
 Site-USPS                      (0) | Train Loss: 0.4121 | Train Acc: 0.8903
 Site-SynthDigits               (3) | Train Loss: 0.6806 | Train Acc: 0.8144
 Site-SynthDigits               (3) | Train Loss: 0.6163 | Train Acc: 0.8548
 Site-MNIST_M                   (1) | Train Loss: 0.9634 | Train Acc: 0.6932
 Site-MNIST_M                   (1) | Train Loss: 0.9891 | Train Acc: 0.7140
 Site-SVHN                      (4) | Train Loss: 1.1156 | Train Acc: 0.6320
Average Train Accuracy: 0.8383
 Site-MNIST                     (5) | Val  Loss: 0.3036 | Val  Acc: 0.9107
 Site-MNIST                     (5) | Val  Loss: 0.2964 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.3461 | Val  Acc: 0.9127
 Site-MNIST                     (5) | Val  Loss: 0.3981 | Val  Acc: 0.9105
 Site-MNIST                     (2) | Val  Loss: 0.3468 | Val  Acc: 0.9263
 Site-USPS                      (0) | Val  Loss: 0.3559 | Val  Acc: 0.8942
 Site-USPS                      (0) | Val  Loss: 0.4263 | Val  Acc: 0.8590
 Site-USPS                      (0) | Val  Loss: 0.4748 | Val  Acc: 0.8504
 Site-SynthDigits               (3) | Val  Loss: 0.8057 | Val  Acc: 0.7803
 Site-SynthDigits               (3) | Val  Loss: 0.5789 | Val  Acc: 0.7980
 Site-MNIST_M                   (1) | Val  Loss: 0.9506 | Val  Acc: 0.7273
 Site-MNIST_M                   (1) | Val  Loss: 1.0230 | Val  Acc: 0.7121
 Site-SVHN                      (4) | Val  Loss: 1.1685 | Val  Acc: 0.5753
Average Valid Accuracy: 0.8297
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9107
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9127
 Best site-MNIST                    (5)  | Epoch:15 | Val Acc: 0.9105
 Best site-MNIST                    (2)  | Epoch:15 | Val Acc: 0.9263
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8942
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8590
 Best site-USPS                     (0)  | Epoch:15 | Val Acc: 0.8504
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7803
 Best site-SynthDigits              (3)  | Epoch:15 | Val Acc: 0.7980
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7273
 Best site-MNIST_M                  (1)  | Epoch:15 | Val Acc: 0.7121
 Best site-SVHN                     (4)  | Epoch:15 | Val Acc: 0.5753
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 5, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (1) | Train Loss: 0.3754 | Train Acc: 0.8844
 Site-MNIST                     (1) | Train Loss: 0.3067 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3679 | Train Acc: 0.9014
 Site-MNIST                     (1) | Train Loss: 0.3555 | Train Acc: 0.9080
 Site-MNIST                     (1) | Train Loss: 0.3256 | Train Acc: 0.9238
 Site-USPS                      (3) | Train Loss: 0.4211 | Train Acc: 0.8825
 Site-USPS                      (3) | Train Loss: 0.4035 | Train Acc: 0.8786
 Site-USPS                      (3) | Train Loss: 0.4048 | Train Acc: 0.8956
 Site-SynthDigits               (2) | Train Loss: 0.6523 | Train Acc: 0.8239
 Site-SynthDigits               (2) | Train Loss: 0.5848 | Train Acc: 0.8598
 Site-MNIST_M                   (5) | Train Loss: 0.9459 | Train Acc: 0.7216
 Site-MNIST_M                   (0) | Train Loss: 0.9289 | Train Acc: 0.7367
 Site-SVHN                      (4) | Train Loss: 1.1260 | Train Acc: 0.6440
Average Train Accuracy: 0.8458
 Site-MNIST                     (1) | Val  Loss: 0.2893 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.2789 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3247 | Val  Acc: 0.9206
 Site-MNIST                     (1) | Val  Loss: 0.3811 | Val  Acc: 0.9105
 Site-MNIST                     (1) | Val  Loss: 0.3287 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.3416 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.4129 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.4603 | Val  Acc: 0.8547
 Site-SynthDigits               (2) | Val  Loss: 0.7626 | Val  Acc: 0.7803
 Site-SynthDigits               (2) | Val  Loss: 0.5473 | Val  Acc: 0.8081
 Site-MNIST_M                   (5) | Val  Loss: 0.9459 | Val  Acc: 0.7273
 Site-MNIST_M                   (0) | Val  Loss: 0.9944 | Val  Acc: 0.7348
 Site-SVHN                      (4) | Val  Loss: 1.1464 | Val  Acc: 0.5822
Average Valid Accuracy: 0.8337
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9206
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9105
 Best site-MNIST                    (1)  | Epoch:16 | Val Acc: 0.9298
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8547
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.7803
 Best site-SynthDigits              (2)  | Epoch:16 | Val Acc: 0.8081
 Best site-MNIST_M                  (5)  | Epoch:16 | Val Acc: 0.7273
 Best site-MNIST_M                  (0)  | Epoch:16 | Val Acc: 0.7348
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.5822
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 5, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (1) | Train Loss: 0.3555 | Train Acc: 0.8889
 Site-MNIST                     (1) | Train Loss: 0.2949 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3582 | Train Acc: 0.9073
 Site-MNIST                     (1) | Train Loss: 0.3453 | Train Acc: 0.9067
 Site-MNIST                     (1) | Train Loss: 0.3150 | Train Acc: 0.9264
 Site-USPS                      (0) | Train Loss: 0.4139 | Train Acc: 0.8825
 Site-USPS                      (5) | Train Loss: 0.3807 | Train Acc: 0.8850
 Site-USPS                      (0) | Train Loss: 0.3852 | Train Acc: 0.9020
 Site-SynthDigits               (3) | Train Loss: 0.6681 | Train Acc: 0.8239
 Site-SynthDigits               (3) | Train Loss: 0.5697 | Train Acc: 0.8586
 Site-MNIST_M                   (2) | Train Loss: 0.8901 | Train Acc: 0.7443
 Site-MNIST_M                   (2) | Train Loss: 0.8933 | Train Acc: 0.7405
 Site-SVHN                      (4) | Train Loss: 1.1453 | Train Acc: 0.6440
Average Train Accuracy: 0.8496
 Site-MNIST                     (1) | Val  Loss: 0.2747 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2691 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3175 | Val  Acc: 0.9206
 Site-MNIST                     (1) | Val  Loss: 0.3724 | Val  Acc: 0.9105
 Site-MNIST                     (1) | Val  Loss: 0.3186 | Val  Acc: 0.9333
 Site-USPS                      (0) | Val  Loss: 0.3225 | Val  Acc: 0.9038
 Site-USPS                      (5) | Val  Loss: 0.3916 | Val  Acc: 0.8590
 Site-USPS                      (0) | Val  Loss: 0.4401 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.7526 | Val  Acc: 0.7879
 Site-SynthDigits               (3) | Val  Loss: 0.5260 | Val  Acc: 0.8131
 Site-MNIST_M                   (2) | Val  Loss: 0.9206 | Val  Acc: 0.7386
 Site-MNIST_M                   (2) | Val  Loss: 0.9518 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 1.1465 | Val  Acc: 0.5890
Average Valid Accuracy: 0.8408
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9206
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9105
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9333
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.9038
 Best site-USPS                     (5)  | Epoch:17 | Val Acc: 0.8590
 Best site-USPS                     (0)  | Epoch:17 | Val Acc: 0.8675
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7879
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8131
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7386
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:17 | Val Acc: 0.5890
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 18 ============
cnt=[5, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (0) | Train Loss: 0.3183 | Train Acc: 0.8933
 Site-MNIST                     (0) | Train Loss: 0.3043 | Train Acc: 0.9320
 Site-MNIST                     (0) | Train Loss: 0.3458 | Train Acc: 0.9093
 Site-MNIST                     (0) | Train Loss: 0.3363 | Train Acc: 0.9067
 Site-MNIST                     (0) | Train Loss: 0.3046 | Train Acc: 0.9299
 Site-USPS                      (3) | Train Loss: 0.3975 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3695 | Train Acc: 0.8866
 Site-USPS                      (3) | Train Loss: 0.3677 | Train Acc: 0.9020
 Site-SynthDigits               (1) | Train Loss: 0.5798 | Train Acc: 0.8390
 Site-SynthDigits               (1) | Train Loss: 0.5306 | Train Acc: 0.8712
 Site-MNIST_M                   (5) | Train Loss: 0.9135 | Train Acc: 0.7585
 Site-MNIST_M                   (2) | Train Loss: 0.8873 | Train Acc: 0.7538
 Site-SVHN                      (4) | Train Loss: 1.0791 | Train Acc: 0.6474
Average Train Accuracy: 0.8559
 Site-MNIST                     (0) | Val  Loss: 0.2720 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2661 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.3070 | Val  Acc: 0.9206
 Site-MNIST                     (0) | Val  Loss: 0.3601 | Val  Acc: 0.9105
 Site-MNIST                     (0) | Val  Loss: 0.3074 | Val  Acc: 0.9333
 Site-USPS                      (3) | Val  Loss: 0.3115 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3776 | Val  Acc: 0.8654
 Site-USPS                      (3) | Val  Loss: 0.4275 | Val  Acc: 0.8590
 Site-SynthDigits               (1) | Val  Loss: 0.7053 | Val  Acc: 0.8030
 Site-SynthDigits               (1) | Val  Loss: 0.5029 | Val  Acc: 0.8283
 Site-MNIST_M                   (5) | Val  Loss: 0.9092 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.9290 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.1018 | Val  Acc: 0.5959
Average Valid Accuracy: 0.8450
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9167
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9105
 Best site-MNIST                    (0)  | Epoch:18 | Val Acc: 0.9333
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8654
 Best site-USPS                     (3)  | Epoch:18 | Val Acc: 0.8590
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8030
 Best site-SynthDigits              (1)  | Epoch:18 | Val Acc: 0.8283
 Best site-MNIST_M                  (5)  | Epoch:18 | Val Acc: 0.7500
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.5959
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.3084 | Train Acc: 0.8978
 Site-MNIST                     (0) | Train Loss: 0.2737 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.3325 | Train Acc: 0.9132
 Site-MNIST                     (0) | Train Loss: 0.3216 | Train Acc: 0.9133
 Site-MNIST                     (0) | Train Loss: 0.2897 | Train Acc: 0.9335
 Site-USPS                      (3) | Train Loss: 0.3781 | Train Acc: 0.8873
 Site-USPS                      (3) | Train Loss: 0.3562 | Train Acc: 0.8962
 Site-USPS                      (3) | Train Loss: 0.3544 | Train Acc: 0.9084
 Site-SynthDigits               (4) | Train Loss: 0.5763 | Train Acc: 0.8371
 Site-SynthDigits               (4) | Train Loss: 0.5269 | Train Acc: 0.8687
 Site-MNIST_M                   (5) | Train Loss: 0.8693 | Train Acc: 0.7727
 Site-MNIST_M                   (2) | Train Loss: 0.8305 | Train Acc: 0.7557
 Site-SVHN                      (1) | Train Loss: 1.0824 | Train Acc: 0.6576
Average Train Accuracy: 0.8602
 Site-MNIST                     (0) | Val  Loss: 0.2559 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2504 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2927 | Val  Acc: 0.9127
 Site-MNIST                     (0) | Val  Loss: 0.3469 | Val  Acc: 0.9053
 Site-MNIST                     (0) | Val  Loss: 0.2946 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.2919 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3642 | Val  Acc: 0.8590
 Site-USPS                      (3) | Val  Loss: 0.4182 | Val  Acc: 0.8632
 Site-SynthDigits               (4) | Val  Loss: 0.7152 | Val  Acc: 0.7955
 Site-SynthDigits               (4) | Val  Loss: 0.4873 | Val  Acc: 0.8232
 Site-MNIST_M                   (5) | Val  Loss: 0.8712 | Val  Acc: 0.7500
 Site-MNIST_M                   (2) | Val  Loss: 0.9004 | Val  Acc: 0.7652
 Site-SVHN                      (1) | Val  Loss: 1.1065 | Val  Acc: 0.6164
Average Valid Accuracy: 0.8447
============ Train epoch 20 ============
cnt=[2, 3, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (1) | Train Loss: 0.3343 | Train Acc: 0.8756
 Site-MNIST                     (1) | Train Loss: 0.3325 | Train Acc: 0.9290
 Site-MNIST                     (5) | Train Loss: 0.3399 | Train Acc: 0.8955
 Site-MNIST                     (1) | Train Loss: 0.3283 | Train Acc: 0.9080
 Site-MNIST                     (5) | Train Loss: 0.2990 | Train Acc: 0.9256
 Site-USPS                      (3) | Train Loss: 0.3808 | Train Acc: 0.8969
 Site-USPS                      (3) | Train Loss: 0.3482 | Train Acc: 0.9042
 Site-USPS                      (3) | Train Loss: 0.3494 | Train Acc: 0.9084
 Site-SynthDigits               (2) | Train Loss: 0.5918 | Train Acc: 0.8258
 Site-SynthDigits               (2) | Train Loss: 0.5244 | Train Acc: 0.8788
 Site-MNIST_M                   (0) | Train Loss: 0.8458 | Train Acc: 0.7727
 Site-MNIST_M                   (0) | Train Loss: 0.8308 | Train Acc: 0.7595
 Site-SVHN                      (4) | Train Loss: 1.0106 | Train Acc: 0.6661
Average Train Accuracy: 0.8574
 Site-MNIST                     (1) | Val  Loss: 0.2661 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2594 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.3022 | Val  Acc: 0.9048
 Site-MNIST                     (1) | Val  Loss: 0.3554 | Val  Acc: 0.9000
 Site-MNIST                     (5) | Val  Loss: 0.3006 | Val  Acc: 0.9228
 Site-USPS                      (3) | Val  Loss: 0.2876 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.3522 | Val  Acc: 0.8782
 Site-USPS                      (3) | Val  Loss: 0.4060 | Val  Acc: 0.8675
 Site-SynthDigits               (2) | Val  Loss: 0.7017 | Val  Acc: 0.7879
 Site-SynthDigits               (2) | Val  Loss: 0.4721 | Val  Acc: 0.8333
 Site-MNIST_M                   (0) | Val  Loss: 0.8543 | Val  Acc: 0.7500
 Site-MNIST_M                   (0) | Val  Loss: 0.8879 | Val  Acc: 0.7803
 Site-SVHN                      (4) | Val  Loss: 1.0647 | Val  Acc: 0.6233
Average Valid Accuracy: 0.8491
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:20 | Val Acc: 0.9048
 Best site-MNIST                    (1)  | Epoch:20 | Val Acc: 0.9000
 Best site-MNIST                    (5)  | Epoch:20 | Val Acc: 0.9228
 Best site-USPS                     (3)  | Epoch:20 | Val Acc: 0.9327
 Best site-USPS                     (3)  | Epoch:20 | Val Acc: 0.8782
 Best site-USPS                     (3)  | Epoch:20 | Val Acc: 0.8675
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.7879
 Best site-SynthDigits              (2)  | Epoch:20 | Val Acc: 0.8333
 Best site-MNIST_M                  (0)  | Epoch:20 | Val Acc: 0.7500
 Best site-MNIST_M                  (0)  | Epoch:20 | Val Acc: 0.7803
 Best site-SVHN                     (4)  | Epoch:20 | Val Acc: 0.6233
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 5, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (1) | Train Loss: 0.3173 | Train Acc: 0.8889
 Site-MNIST                     (1) | Train Loss: 0.2453 | Train Acc: 0.9349
 Site-MNIST                     (1) | Train Loss: 0.3214 | Train Acc: 0.9053
 Site-MNIST                     (1) | Train Loss: 0.3126 | Train Acc: 0.9120
 Site-MNIST                     (1) | Train Loss: 0.2832 | Train Acc: 0.9308
 Site-USPS                      (3) | Train Loss: 0.3621 | Train Acc: 0.8993
 Site-USPS                      (3) | Train Loss: 0.3382 | Train Acc: 0.9042
 Site-USPS                      (3) | Train Loss: 0.3383 | Train Acc: 0.9105
 Site-SynthDigits               (0) | Train Loss: 0.5774 | Train Acc: 0.8504
 Site-SynthDigits               (0) | Train Loss: 0.5036 | Train Acc: 0.8864
 Site-MNIST_M                   (5) | Train Loss: 0.8349 | Train Acc: 0.7699
 Site-MNIST_M                   (2) | Train Loss: 0.8173 | Train Acc: 0.7652
 Site-SVHN                      (4) | Train Loss: 0.9662 | Train Acc: 0.6746
Average Train Accuracy: 0.8640
 Site-MNIST                     (1) | Val  Loss: 0.2541 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2440 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2845 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3385 | Val  Acc: 0.9211
 Site-MNIST                     (1) | Val  Loss: 0.2837 | Val  Acc: 0.9298
 Site-USPS                      (3) | Val  Loss: 0.2884 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.3429 | Val  Acc: 0.8718
 Site-USPS                      (3) | Val  Loss: 0.3956 | Val  Acc: 0.8632
 Site-SynthDigits               (0) | Val  Loss: 0.6528 | Val  Acc: 0.8258
 Site-SynthDigits               (0) | Val  Loss: 0.4506 | Val  Acc: 0.8586
 Site-MNIST_M                   (5) | Val  Loss: 0.8760 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8836 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0413 | Val  Acc: 0.6370
Average Valid Accuracy: 0.8589
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9211
 Best site-MNIST                    (1)  | Epoch:21 | Val Acc: 0.9298
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8718
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8632
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8258
 Best site-SynthDigits              (0)  | Epoch:21 | Val Acc: 0.8586
 Best site-MNIST_M                  (5)  | Epoch:21 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:21 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:21 | Val Acc: 0.6370
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 22 ============
cnt=[1, 2, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (2) | Train Loss: 0.2916 | Train Acc: 0.8978
 Site-MNIST                     (2) | Train Loss: 0.2466 | Train Acc: 0.9379
 Site-MNIST                     (2) | Train Loss: 0.3013 | Train Acc: 0.9152
 Site-MNIST                     (2) | Train Loss: 0.2976 | Train Acc: 0.9185
 Site-MNIST                     (2) | Train Loss: 0.2678 | Train Acc: 0.9370
 Site-USPS                      (5) | Train Loss: 0.3553 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3241 | Train Acc: 0.9042
 Site-USPS                      (5) | Train Loss: 0.3226 | Train Acc: 0.9116
 Site-SynthDigits               (3) | Train Loss: 0.5589 | Train Acc: 0.8466
 Site-SynthDigits               (3) | Train Loss: 0.4795 | Train Acc: 0.8889
 Site-MNIST_M                   (1) | Train Loss: 0.7919 | Train Acc: 0.7898
 Site-MNIST_M                   (1) | Train Loss: 0.7898 | Train Acc: 0.7803
 Site-SVHN                      (4) | Train Loss: 0.9872 | Train Acc: 0.6593
Average Train Accuracy: 0.8678
 Site-MNIST                     (2) | Val  Loss: 0.2329 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2271 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2680 | Val  Acc: 0.9206
 Site-MNIST                     (2) | Val  Loss: 0.3204 | Val  Acc: 0.9158
 Site-MNIST                     (2) | Val  Loss: 0.2697 | Val  Acc: 0.9298
 Site-USPS                      (5) | Val  Loss: 0.2655 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3282 | Val  Acc: 0.8718
 Site-USPS                      (5) | Val  Loss: 0.3821 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.6551 | Val  Acc: 0.8182
 Site-SynthDigits               (3) | Val  Loss: 0.4429 | Val  Acc: 0.8535
 Site-MNIST_M                   (1) | Val  Loss: 0.8231 | Val  Acc: 0.7955
 Site-MNIST_M                   (1) | Val  Loss: 0.8465 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 1.0516 | Val  Acc: 0.6301
Average Valid Accuracy: 0.8604
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9206
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9158
 Best site-MNIST                    (2)  | Epoch:22 | Val Acc: 0.9298
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:22 | Val Acc: 0.8718
 Best site-USPS                     (5)  | Epoch:22 | Val Acc: 0.8718
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8182
 Best site-SynthDigits              (3)  | Epoch:22 | Val Acc: 0.8535
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.7955
 Best site-MNIST_M                  (1)  | Epoch:22 | Val Acc: 0.7879
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.6301
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 23 ============
cnt=[3, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (2) | Train Loss: 0.2828 | Train Acc: 0.9067
 Site-MNIST                     (2) | Train Loss: 0.2468 | Train Acc: 0.9467
 Site-MNIST                     (2) | Train Loss: 0.2917 | Train Acc: 0.9191
 Site-MNIST                     (2) | Train Loss: 0.2908 | Train Acc: 0.9212
 Site-MNIST                     (2) | Train Loss: 0.2562 | Train Acc: 0.9396
 Site-USPS                      (0) | Train Loss: 0.3552 | Train Acc: 0.8945
 Site-USPS                      (0) | Train Loss: 0.3265 | Train Acc: 0.9058
 Site-USPS                      (0) | Train Loss: 0.3196 | Train Acc: 0.9105
 Site-SynthDigits               (3) | Train Loss: 0.5287 | Train Acc: 0.8580
 Site-SynthDigits               (3) | Train Loss: 0.4638 | Train Acc: 0.8990
 Site-MNIST_M                   (1) | Train Loss: 0.7962 | Train Acc: 0.8068
 Site-MNIST_M                   (5) | Train Loss: 0.7978 | Train Acc: 0.7860
 Site-SVHN                      (4) | Train Loss: 0.9909 | Train Acc: 0.6882
Average Train Accuracy: 0.8755
 Site-MNIST                     (2) | Val  Loss: 0.2215 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.2176 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2615 | Val  Acc: 0.9365
 Site-MNIST                     (2) | Val  Loss: 0.3115 | Val  Acc: 0.9316
 Site-MNIST                     (2) | Val  Loss: 0.2611 | Val  Acc: 0.9474
 Site-USPS                      (0) | Val  Loss: 0.2600 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.3221 | Val  Acc: 0.8782
 Site-USPS                      (0) | Val  Loss: 0.3807 | Val  Acc: 0.8632
 Site-SynthDigits               (3) | Val  Loss: 0.5998 | Val  Acc: 0.8561
 Site-SynthDigits               (3) | Val  Loss: 0.4232 | Val  Acc: 0.8687
 Site-MNIST_M                   (1) | Val  Loss: 0.8322 | Val  Acc: 0.7614
 Site-MNIST_M                   (5) | Val  Loss: 0.8367 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 1.0079 | Val  Acc: 0.6438
Average Valid Accuracy: 0.8685
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9365
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9316
 Best site-MNIST                    (2)  | Epoch:23 | Val Acc: 0.9474
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9327
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8782
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8632
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8561
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8687
 Best site-MNIST_M                  (1)  | Epoch:23 | Val Acc: 0.7614
 Best site-MNIST_M                  (5)  | Epoch:23 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:23 | Val Acc: 0.6438
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 5, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.2905 | Train Acc: 0.9111
 Site-MNIST                     (1) | Train Loss: 0.2296 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2819 | Train Acc: 0.9231
 Site-MNIST                     (1) | Train Loss: 0.2823 | Train Acc: 0.9238
 Site-MNIST                     (1) | Train Loss: 0.2493 | Train Acc: 0.9422
 Site-USPS                      (3) | Train Loss: 0.3393 | Train Acc: 0.9065
 Site-USPS                      (3) | Train Loss: 0.3150 | Train Acc: 0.9121
 Site-USPS                      (3) | Train Loss: 0.3127 | Train Acc: 0.9159
 Site-SynthDigits               (0) | Train Loss: 0.5237 | Train Acc: 0.8561
 Site-SynthDigits               (5) | Train Loss: 0.4668 | Train Acc: 0.8864
 Site-MNIST_M                   (2) | Train Loss: 0.7716 | Train Acc: 0.7841
 Site-MNIST_M                   (2) | Train Loss: 0.7382 | Train Acc: 0.7822
 Site-SVHN                      (4) | Train Loss: 0.9551 | Train Acc: 0.6814
Average Train Accuracy: 0.8745
 Site-MNIST                     (1) | Val  Loss: 0.2149 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2120 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2557 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.3022 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2540 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.2485 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3136 | Val  Acc: 0.8846
 Site-USPS                      (3) | Val  Loss: 0.3710 | Val  Acc: 0.8718
 Site-SynthDigits               (0) | Val  Loss: 0.6004 | Val  Acc: 0.8636
 Site-SynthDigits               (5) | Val  Loss: 0.4176 | Val  Acc: 0.8687
 Site-MNIST_M                   (2) | Val  Loss: 0.8259 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.8265 | Val  Acc: 0.7955
 Site-SVHN                      (4) | Val  Loss: 0.9752 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8746
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9421
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9423
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8846
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8718
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8636
 Best site-SynthDigits              (5)  | Epoch:24 | Val Acc: 0.8687
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7614
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7955
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.6849
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 25 ============
cnt=[5, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.2801 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2175 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2780 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2788 | Train Acc: 0.9172
 Site-MNIST                     (0) | Train Loss: 0.2438 | Train Acc: 0.9448
 Site-USPS                      (3) | Train Loss: 0.3305 | Train Acc: 0.8993
 Site-USPS                      (3) | Train Loss: 0.3105 | Train Acc: 0.9137
 Site-USPS                      (5) | Train Loss: 0.3018 | Train Acc: 0.9201
 Site-SynthDigits               (1) | Train Loss: 0.5092 | Train Acc: 0.8598
 Site-SynthDigits               (1) | Train Loss: 0.4464 | Train Acc: 0.8977
 Site-MNIST_M                   (2) | Train Loss: 0.7497 | Train Acc: 0.7869
 Site-MNIST_M                   (2) | Train Loss: 0.7292 | Train Acc: 0.7822
 Site-SVHN                      (4) | Train Loss: 0.9523 | Train Acc: 0.6865
Average Train Accuracy: 0.8759
 Site-MNIST                     (0) | Val  Loss: 0.2195 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2152 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2513 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2964 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2503 | Val  Acc: 0.9404
 Site-USPS                      (3) | Val  Loss: 0.2450 | Val  Acc: 0.9423
 Site-USPS                      (3) | Val  Loss: 0.3039 | Val  Acc: 0.8782
 Site-USPS                      (5) | Val  Loss: 0.3589 | Val  Acc: 0.8718
 Site-SynthDigits               (1) | Val  Loss: 0.5892 | Val  Acc: 0.8485
 Site-SynthDigits               (1) | Val  Loss: 0.4046 | Val  Acc: 0.8788
 Site-MNIST_M                   (2) | Val  Loss: 0.8051 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.8030 | Val  Acc: 0.8182
 Site-SVHN                      (4) | Val  Loss: 0.9732 | Val  Acc: 0.6781
Average Valid Accuracy: 0.8728
============ Train epoch 26 ============
cnt=[5, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.2669 | Train Acc: 0.9111
 Site-MNIST                     (0) | Train Loss: 0.2235 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2753 | Train Acc: 0.9191
 Site-MNIST                     (0) | Train Loss: 0.2773 | Train Acc: 0.9198
 Site-MNIST                     (0) | Train Loss: 0.2441 | Train Acc: 0.9413
 Site-USPS                      (3) | Train Loss: 0.3265 | Train Acc: 0.9089
 Site-USPS                      (3) | Train Loss: 0.2986 | Train Acc: 0.9137
 Site-USPS                      (3) | Train Loss: 0.2948 | Train Acc: 0.9223
 Site-SynthDigits               (1) | Train Loss: 0.4845 | Train Acc: 0.8561
 Site-SynthDigits               (1) | Train Loss: 0.4410 | Train Acc: 0.8977
 Site-MNIST_M                   (2) | Train Loss: 0.7461 | Train Acc: 0.7898
 Site-MNIST_M                   (5) | Train Loss: 0.7351 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.9291 | Train Acc: 0.7019
Average Train Accuracy: 0.8780
 Site-MNIST                     (0) | Val  Loss: 0.2219 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.2176 | Val  Acc: 0.9167
 Site-MNIST                     (0) | Val  Loss: 0.2493 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2935 | Val  Acc: 0.9316
 Site-MNIST                     (0) | Val  Loss: 0.2492 | Val  Acc: 0.9368
 Site-USPS                      (3) | Val  Loss: 0.2432 | Val  Acc: 0.9327
 Site-USPS                      (3) | Val  Loss: 0.2953 | Val  Acc: 0.8910
 Site-USPS                      (3) | Val  Loss: 0.3473 | Val  Acc: 0.8718
 Site-SynthDigits               (1) | Val  Loss: 0.5669 | Val  Acc: 0.8485
 Site-SynthDigits               (1) | Val  Loss: 0.3914 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7957 | Val  Acc: 0.7500
 Site-MNIST_M                   (5) | Val  Loss: 0.8068 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9403 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8683
============ Train epoch 27 ============
cnt=[2, 5, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (1) | Train Loss: 0.2757 | Train Acc: 0.9067
 Site-MNIST                     (1) | Train Loss: 0.2327 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2758 | Train Acc: 0.9172
 Site-MNIST                     (1) | Train Loss: 0.2768 | Train Acc: 0.9212
 Site-MNIST                     (1) | Train Loss: 0.2404 | Train Acc: 0.9457
 Site-USPS                      (0) | Train Loss: 0.3133 | Train Acc: 0.9113
 Site-USPS                      (0) | Train Loss: 0.2979 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.2891 | Train Acc: 0.9148
 Site-SynthDigits               (3) | Train Loss: 0.4764 | Train Acc: 0.8674
 Site-SynthDigits               (3) | Train Loss: 0.4363 | Train Acc: 0.8990
 Site-MNIST_M                   (2) | Train Loss: 0.7340 | Train Acc: 0.7727
 Site-MNIST_M                   (2) | Train Loss: 0.7040 | Train Acc: 0.7879
 Site-SVHN                      (4) | Train Loss: 0.8654 | Train Acc: 0.7121
Average Train Accuracy: 0.8778
 Site-MNIST                     (1) | Val  Loss: 0.2145 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2163 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2540 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2957 | Val  Acc: 0.9316
 Site-MNIST                     (1) | Val  Loss: 0.2480 | Val  Acc: 0.9368
 Site-USPS                      (0) | Val  Loss: 0.2425 | Val  Acc: 0.9327
 Site-USPS                      (0) | Val  Loss: 0.2881 | Val  Acc: 0.8846
 Site-USPS                      (5) | Val  Loss: 0.3402 | Val  Acc: 0.8718
 Site-SynthDigits               (3) | Val  Loss: 0.5589 | Val  Acc: 0.8485
 Site-SynthDigits               (3) | Val  Loss: 0.3799 | Val  Acc: 0.8788
 Site-MNIST_M                   (2) | Val  Loss: 0.7701 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7868 | Val  Acc: 0.7879
 Site-SVHN                      (4) | Val  Loss: 0.9060 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8719
============ Train epoch 28 ============
cnt=[2, 1, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (2) | Train Loss: 0.2459 | Train Acc: 0.9156
 Site-MNIST                     (2) | Train Loss: 0.2376 | Train Acc: 0.9438
 Site-MNIST                     (2) | Train Loss: 0.2643 | Train Acc: 0.9211
 Site-MNIST                     (2) | Train Loss: 0.2671 | Train Acc: 0.9225
 Site-MNIST                     (2) | Train Loss: 0.2317 | Train Acc: 0.9466
 Site-USPS                      (1) | Train Loss: 0.3137 | Train Acc: 0.9041
 Site-USPS                      (5) | Train Loss: 0.2932 | Train Acc: 0.9121
 Site-USPS                      (5) | Train Loss: 0.2881 | Train Acc: 0.9159
 Site-SynthDigits               (3) | Train Loss: 0.4671 | Train Acc: 0.8731
 Site-SynthDigits               (3) | Train Loss: 0.4111 | Train Acc: 0.9066
 Site-MNIST_M                   (0) | Train Loss: 0.7140 | Train Acc: 0.8040
 Site-MNIST_M                   (0) | Train Loss: 0.6849 | Train Acc: 0.7992
 Site-SVHN                      (4) | Train Loss: 0.8786 | Train Acc: 0.7240
Average Train Accuracy: 0.8837
 Site-MNIST                     (2) | Val  Loss: 0.2042 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2046 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2449 | Val  Acc: 0.9365
 Site-MNIST                     (2) | Val  Loss: 0.2856 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.2378 | Val  Acc: 0.9404
 Site-USPS                      (1) | Val  Loss: 0.2412 | Val  Acc: 0.9327
 Site-USPS                      (5) | Val  Loss: 0.2837 | Val  Acc: 0.8910
 Site-USPS                      (5) | Val  Loss: 0.3370 | Val  Acc: 0.8675
 Site-SynthDigits               (3) | Val  Loss: 0.5414 | Val  Acc: 0.8636
 Site-SynthDigits               (3) | Val  Loss: 0.3679 | Val  Acc: 0.8889
 Site-MNIST_M                   (0) | Val  Loss: 0.7673 | Val  Acc: 0.7841
 Site-MNIST_M                   (0) | Val  Loss: 0.7779 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8973 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8775
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9365
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9368
 Best site-MNIST                    (2)  | Epoch:28 | Val Acc: 0.9404
 Best site-USPS                     (1)  | Epoch:28 | Val Acc: 0.9327
 Best site-USPS                     (5)  | Epoch:28 | Val Acc: 0.8910
 Best site-USPS                     (5)  | Epoch:28 | Val Acc: 0.8675
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8636
 Best site-SynthDigits              (3)  | Epoch:28 | Val Acc: 0.8889
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.7841
 Best site-MNIST_M                  (0)  | Epoch:28 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.6986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 29 ============
cnt=[5, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.2650 | Train Acc: 0.9200
 Site-MNIST                     (0) | Train Loss: 0.2260 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.2560 | Train Acc: 0.9231
 Site-MNIST                     (0) | Train Loss: 0.2582 | Train Acc: 0.9212
 Site-MNIST                     (0) | Train Loss: 0.2242 | Train Acc: 0.9457
 Site-USPS                      (3) | Train Loss: 0.3053 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2808 | Train Acc: 0.9249
 Site-USPS                      (5) | Train Loss: 0.2788 | Train Acc: 0.9191
 Site-SynthDigits               (1) | Train Loss: 0.4600 | Train Acc: 0.8636
 Site-SynthDigits               (1) | Train Loss: 0.4090 | Train Acc: 0.9028
 Site-MNIST_M                   (2) | Train Loss: 0.6803 | Train Acc: 0.8068
 Site-MNIST_M                   (2) | Train Loss: 0.6847 | Train Acc: 0.8011
 Site-SVHN                      (4) | Train Loss: 0.8443 | Train Acc: 0.7087
Average Train Accuracy: 0.8846
 Site-MNIST                     (0) | Val  Loss: 0.1962 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1973 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2360 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2748 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.2305 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.2302 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2795 | Val  Acc: 0.8910
 Site-USPS                      (5) | Val  Loss: 0.3300 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.5235 | Val  Acc: 0.8561
 Site-SynthDigits               (1) | Val  Loss: 0.3686 | Val  Acc: 0.8889
 Site-MNIST_M                   (2) | Val  Loss: 0.7435 | Val  Acc: 0.7727
 Site-MNIST_M                   (2) | Val  Loss: 0.7522 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8980 | Val  Acc: 0.6712
Average Valid Accuracy: 0.8778
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8910
 Best site-USPS                     (5)  | Epoch:29 | Val Acc: 0.8803
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8561
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8889
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.7727
 Best site-MNIST_M                  (2)  | Epoch:29 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.6712
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 30 ============
cnt=[1, 5, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.2582 | Train Acc: 0.9156
 Site-MNIST                     (1) | Train Loss: 0.2054 | Train Acc: 0.9408
 Site-MNIST                     (1) | Train Loss: 0.2502 | Train Acc: 0.9250
 Site-MNIST                     (1) | Train Loss: 0.2532 | Train Acc: 0.9277
 Site-MNIST                     (1) | Train Loss: 0.2227 | Train Acc: 0.9457
 Site-USPS                      (4) | Train Loss: 0.3024 | Train Acc: 0.9137
 Site-USPS                      (4) | Train Loss: 0.2812 | Train Acc: 0.9153
 Site-USPS                      (4) | Train Loss: 0.2769 | Train Acc: 0.9233
 Site-SynthDigits               (5) | Train Loss: 0.4422 | Train Acc: 0.8674
 Site-SynthDigits               (3) | Train Loss: 0.4020 | Train Acc: 0.9066
 Site-MNIST_M                   (2) | Train Loss: 0.7004 | Train Acc: 0.7955
 Site-MNIST_M                   (2) | Train Loss: 0.6641 | Train Acc: 0.8087
 Site-SVHN                      (0) | Train Loss: 0.8528 | Train Acc: 0.7291
Average Train Accuracy: 0.8857
 Site-MNIST                     (1) | Val  Loss: 0.1933 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1929 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2318 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2720 | Val  Acc: 0.9421
 Site-MNIST                     (1) | Val  Loss: 0.2257 | Val  Acc: 0.9439
 Site-USPS                      (4) | Val  Loss: 0.2328 | Val  Acc: 0.9519
 Site-USPS                      (4) | Val  Loss: 0.2752 | Val  Acc: 0.9103
 Site-USPS                      (4) | Val  Loss: 0.3271 | Val  Acc: 0.8846
 Site-SynthDigits               (5) | Val  Loss: 0.5121 | Val  Acc: 0.8485
 Site-SynthDigits               (3) | Val  Loss: 0.3522 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.7522 | Val  Acc: 0.7614
 Site-MNIST_M                   (2) | Val  Loss: 0.7625 | Val  Acc: 0.7955
 Site-SVHN                      (0) | Val  Loss: 0.8716 | Val  Acc: 0.6849
Average Valid Accuracy: 0.8777
============ Train epoch 31 ============
cnt=[2, 5, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.2405 | Train Acc: 0.9200
 Site-MNIST                     (1) | Train Loss: 0.2005 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.2425 | Train Acc: 0.9270
 Site-MNIST                     (1) | Train Loss: 0.2443 | Train Acc: 0.9304
 Site-MNIST                     (1) | Train Loss: 0.2150 | Train Acc: 0.9483
 Site-USPS                      (2) | Train Loss: 0.2999 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.2771 | Train Acc: 0.9249
 Site-USPS                      (5) | Train Loss: 0.2702 | Train Acc: 0.9223
 Site-SynthDigits               (0) | Train Loss: 0.4425 | Train Acc: 0.8655
 Site-SynthDigits               (0) | Train Loss: 0.3824 | Train Acc: 0.9141
 Site-MNIST_M                   (3) | Train Loss: 0.6790 | Train Acc: 0.8182
 Site-MNIST_M                   (3) | Train Loss: 0.6683 | Train Acc: 0.8144
 Site-SVHN                      (4) | Train Loss: 0.8051 | Train Acc: 0.7496
Average Train Accuracy: 0.8916
 Site-MNIST                     (1) | Val  Loss: 0.1901 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.1877 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.2267 | Val  Acc: 0.9365
 Site-MNIST                     (1) | Val  Loss: 0.2636 | Val  Acc: 0.9474
 Site-MNIST                     (1) | Val  Loss: 0.2190 | Val  Acc: 0.9474
 Site-USPS                      (2) | Val  Loss: 0.2176 | Val  Acc: 0.9519
 Site-USPS                      (5) | Val  Loss: 0.2672 | Val  Acc: 0.8974
 Site-USPS                      (5) | Val  Loss: 0.3230 | Val  Acc: 0.8718
 Site-SynthDigits               (0) | Val  Loss: 0.5029 | Val  Acc: 0.8561
 Site-SynthDigits               (0) | Val  Loss: 0.3475 | Val  Acc: 0.8939
 Site-MNIST_M                   (3) | Val  Loss: 0.7323 | Val  Acc: 0.7727
 Site-MNIST_M                   (3) | Val  Loss: 0.7383 | Val  Acc: 0.8106
 Site-SVHN                      (4) | Val  Loss: 0.8342 | Val  Acc: 0.6918
Average Valid Accuracy: 0.8796
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9365
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9474
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9474
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.9519
 Best site-USPS                     (5)  | Epoch:31 | Val Acc: 0.8974
 Best site-USPS                     (5)  | Epoch:31 | Val Acc: 0.8718
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8561
 Best site-SynthDigits              (0)  | Epoch:31 | Val Acc: 0.8939
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.7727
 Best site-MNIST_M                  (3)  | Epoch:31 | Val Acc: 0.8106
 Best site-SVHN                     (4)  | Epoch:31 | Val Acc: 0.6918
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 32 ============
cnt=[5, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.2645 | Train Acc: 0.9156
 Site-MNIST                     (0) | Train Loss: 0.2134 | Train Acc: 0.9379
 Site-MNIST                     (0) | Train Loss: 0.2472 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.2515 | Train Acc: 0.9212
 Site-MNIST                     (0) | Train Loss: 0.2184 | Train Acc: 0.9431
 Site-USPS                      (3) | Train Loss: 0.2808 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2640 | Train Acc: 0.9249
 Site-USPS                      (3) | Train Loss: 0.2621 | Train Acc: 0.9255
 Site-SynthDigits               (1) | Train Loss: 0.4509 | Train Acc: 0.8750
 Site-SynthDigits               (1) | Train Loss: 0.3756 | Train Acc: 0.9141
 Site-MNIST_M                   (2) | Train Loss: 0.6405 | Train Acc: 0.8239
 Site-MNIST_M                   (5) | Train Loss: 0.6266 | Train Acc: 0.8163
 Site-SVHN                      (4) | Train Loss: 0.7966 | Train Acc: 0.7479
Average Train Accuracy: 0.8910
 Site-MNIST                     (0) | Val  Loss: 0.2014 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1974 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2291 | Val  Acc: 0.9365
 Site-MNIST                     (0) | Val  Loss: 0.2633 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.2228 | Val  Acc: 0.9333
 Site-USPS                      (3) | Val  Loss: 0.2081 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2580 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.3086 | Val  Acc: 0.8846
 Site-SynthDigits               (1) | Val  Loss: 0.5086 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.3353 | Val  Acc: 0.8939
 Site-MNIST_M                   (2) | Val  Loss: 0.6826 | Val  Acc: 0.7727
 Site-MNIST_M                   (5) | Val  Loss: 0.7186 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.8476 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8831
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9365
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9333
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.9519
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.9038
 Best site-USPS                     (3)  | Epoch:32 | Val Acc: 0.8846
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.8939
 Best site-MNIST_M                  (2)  | Epoch:32 | Val Acc: 0.7727
 Best site-MNIST_M                  (5)  | Epoch:32 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:32 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 1, 2, 3, 2, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.2474 | Train Acc: 0.9333
 Site-MNIST                     (5) | Train Loss: 0.1964 | Train Acc: 0.9467
 Site-MNIST                     (5) | Train Loss: 0.2334 | Train Acc: 0.9270
 Site-MNIST                     (5) | Train Loss: 0.2411 | Train Acc: 0.9317
 Site-MNIST                     (0) | Train Loss: 0.2123 | Train Acc: 0.9431
 Site-USPS                      (3) | Train Loss: 0.2852 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2622 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2584 | Train Acc: 0.9286
 Site-SynthDigits               (4) | Train Loss: 0.4305 | Train Acc: 0.8655
 Site-SynthDigits               (4) | Train Loss: 0.3768 | Train Acc: 0.9179
 Site-MNIST_M                   (2) | Train Loss: 0.6410 | Train Acc: 0.8182
 Site-MNIST_M                   (2) | Train Loss: 0.6286 | Train Acc: 0.8220
 Site-SVHN                      (1) | Train Loss: 0.8062 | Train Acc: 0.7564
Average Train Accuracy: 0.8955
 Site-MNIST                     (0) | Val  Loss: 0.1837 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.1820 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.2241 | Val  Acc: 0.9365
 Site-MNIST                     (5) | Val  Loss: 0.2541 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.2113 | Val  Acc: 0.9439
 Site-USPS                      (3) | Val  Loss: 0.1979 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2533 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.3075 | Val  Acc: 0.8846
 Site-SynthDigits               (4) | Val  Loss: 0.5075 | Val  Acc: 0.8485
 Site-SynthDigits               (4) | Val  Loss: 0.3370 | Val  Acc: 0.8990
 Site-MNIST_M                   (2) | Val  Loss: 0.6904 | Val  Acc: 0.7841
 Site-MNIST_M                   (2) | Val  Loss: 0.7117 | Val  Acc: 0.8258
 Site-SVHN                      (1) | Val  Loss: 0.8091 | Val  Acc: 0.7123
Average Valid Accuracy: 0.8860
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 0.9286
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 0.9365
 Best site-MNIST                    (5)  | Epoch:33 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:33 | Val Acc: 0.9439
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.9167
 Best site-USPS                     (3)  | Epoch:33 | Val Acc: 0.8846
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8485
 Best site-SynthDigits              (4)  | Epoch:33 | Val Acc: 0.8990
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.7841
 Best site-MNIST_M                  (2)  | Epoch:33 | Val Acc: 0.8258
 Best site-SVHN                     (1)  | Epoch:33 | Val Acc: 0.7123
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (0) | Train Loss: 0.2449 | Train Acc: 0.9244
 Site-MNIST                     (0) | Train Loss: 0.1856 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.2338 | Train Acc: 0.9290
 Site-MNIST                     (0) | Train Loss: 0.2412 | Train Acc: 0.9264
 Site-MNIST                     (0) | Train Loss: 0.2078 | Train Acc: 0.9483
 Site-USPS                      (2) | Train Loss: 0.2795 | Train Acc: 0.9137
 Site-USPS                      (2) | Train Loss: 0.2575 | Train Acc: 0.9281
 Site-USPS                      (2) | Train Loss: 0.2559 | Train Acc: 0.9212
 Site-SynthDigits               (1) | Train Loss: 0.4028 | Train Acc: 0.8826
 Site-SynthDigits               (1) | Train Loss: 0.3599 | Train Acc: 0.9167
 Site-MNIST_M                   (5) | Train Loss: 0.6027 | Train Acc: 0.8295
 Site-MNIST_M                   (3) | Train Loss: 0.6402 | Train Acc: 0.8125
 Site-SVHN                      (4) | Train Loss: 0.8432 | Train Acc: 0.7598
Average Train Accuracy: 0.8958
 Site-MNIST                     (0) | Val  Loss: 0.1815 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1835 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2236 | Val  Acc: 0.9444
 Site-MNIST                     (0) | Val  Loss: 0.2529 | Val  Acc: 0.9474
 Site-MNIST                     (0) | Val  Loss: 0.2102 | Val  Acc: 0.9509
 Site-USPS                      (2) | Val  Loss: 0.2034 | Val  Acc: 0.9519
 Site-USPS                      (2) | Val  Loss: 0.2488 | Val  Acc: 0.9103
 Site-USPS                      (2) | Val  Loss: 0.3016 | Val  Acc: 0.8846
 Site-SynthDigits               (1) | Val  Loss: 0.4877 | Val  Acc: 0.8712
 Site-SynthDigits               (1) | Val  Loss: 0.3207 | Val  Acc: 0.9040
 Site-MNIST_M                   (5) | Val  Loss: 0.6591 | Val  Acc: 0.7841
 Site-MNIST_M                   (3) | Val  Loss: 0.6847 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.8227 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8875
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9444
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9474
 Best site-MNIST                    (0)  | Epoch:34 | Val Acc: 0.9509
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9519
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.9103
 Best site-USPS                     (2)  | Epoch:34 | Val Acc: 0.8846
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.8712
 Best site-SynthDigits              (1)  | Epoch:34 | Val Acc: 0.9040
 Best site-MNIST_M                  (5)  | Epoch:34 | Val Acc: 0.7841
 Best site-MNIST_M                  (3)  | Epoch:34 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:34 | Val Acc: 0.7055
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 35 ============
cnt=[1, 2, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (2) | Train Loss: 0.2156 | Train Acc: 0.9333
 Site-MNIST                     (2) | Train Loss: 0.1737 | Train Acc: 0.9556
 Site-MNIST                     (2) | Train Loss: 0.2236 | Train Acc: 0.9310
 Site-MNIST                     (2) | Train Loss: 0.2332 | Train Acc: 0.9277
 Site-MNIST                     (2) | Train Loss: 0.2017 | Train Acc: 0.9483
 Site-USPS                      (0) | Train Loss: 0.2844 | Train Acc: 0.9089
 Site-USPS                      (5) | Train Loss: 0.2486 | Train Acc: 0.9393
 Site-USPS                      (5) | Train Loss: 0.2528 | Train Acc: 0.9276
 Site-SynthDigits               (3) | Train Loss: 0.4604 | Train Acc: 0.8693
 Site-SynthDigits               (3) | Train Loss: 0.3588 | Train Acc: 0.9205
 Site-MNIST_M                   (1) | Train Loss: 0.6243 | Train Acc: 0.8267
 Site-MNIST_M                   (1) | Train Loss: 0.6121 | Train Acc: 0.8409
 Site-SVHN                      (4) | Train Loss: 0.7553 | Train Acc: 0.7649
Average Train Accuracy: 0.8995
 Site-MNIST                     (2) | Val  Loss: 0.1700 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.1733 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2152 | Val  Acc: 0.9444
 Site-MNIST                     (2) | Val  Loss: 0.2463 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.2038 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1928 | Val  Acc: 0.9615
 Site-USPS                      (5) | Val  Loss: 0.2462 | Val  Acc: 0.9038
 Site-USPS                      (5) | Val  Loss: 0.3012 | Val  Acc: 0.8803
 Site-SynthDigits               (3) | Val  Loss: 0.4888 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3195 | Val  Acc: 0.8990
 Site-MNIST_M                   (1) | Val  Loss: 0.6826 | Val  Acc: 0.7727
 Site-MNIST_M                   (1) | Val  Loss: 0.6993 | Val  Acc: 0.8030
 Site-SVHN                      (4) | Val  Loss: 0.7796 | Val  Acc: 0.6986
Average Valid Accuracy: 0.8848
============ Train epoch 36 ============
cnt=[2, 2, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (2) | Train Loss: 0.2154 | Train Acc: 0.9378
 Site-MNIST                     (2) | Train Loss: 0.1713 | Train Acc: 0.9527
 Site-MNIST                     (2) | Train Loss: 0.2183 | Train Acc: 0.9329
 Site-MNIST                     (2) | Train Loss: 0.2266 | Train Acc: 0.9330
 Site-MNIST                     (2) | Train Loss: 0.1942 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2684 | Train Acc: 0.9137
 Site-USPS                      (0) | Train Loss: 0.2432 | Train Acc: 0.9345
 Site-USPS                      (5) | Train Loss: 0.2455 | Train Acc: 0.9286
 Site-SynthDigits               (3) | Train Loss: 0.3892 | Train Acc: 0.8807
 Site-SynthDigits               (3) | Train Loss: 0.3462 | Train Acc: 0.9179
 Site-MNIST_M                   (1) | Train Loss: 0.5935 | Train Acc: 0.8523
 Site-MNIST_M                   (1) | Train Loss: 0.6137 | Train Acc: 0.8333
 Site-SVHN                      (4) | Train Loss: 0.8014 | Train Acc: 0.7581
Average Train Accuracy: 0.9020
 Site-MNIST                     (2) | Val  Loss: 0.1622 | Val  Acc: 0.9464
 Site-MNIST                     (2) | Val  Loss: 0.1693 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.2077 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2401 | Val  Acc: 0.9421
 Site-MNIST                     (2) | Val  Loss: 0.1985 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1891 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2391 | Val  Acc: 0.9038
 Site-USPS                      (5) | Val  Loss: 0.2888 | Val  Acc: 0.8846
 Site-SynthDigits               (3) | Val  Loss: 0.4667 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.3099 | Val  Acc: 0.9141
 Site-MNIST_M                   (1) | Val  Loss: 0.6607 | Val  Acc: 0.7955
 Site-MNIST_M                   (1) | Val  Loss: 0.6801 | Val  Acc: 0.8258
 Site-SVHN                      (4) | Val  Loss: 0.7808 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8920
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9464
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9524
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9421
 Best site-MNIST                    (2)  | Epoch:36 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.9615
 Best site-USPS                     (0)  | Epoch:36 | Val Acc: 0.9038
 Best site-USPS                     (5)  | Epoch:36 | Val Acc: 0.8846
 Best site-SynthDigits              (3)  | Epoch:36 | Val Acc: 0.8712
 Best site-SynthDigits              (3)  | Epoch:36 | Val Acc: 0.9141
 Best site-MNIST_M                  (1)  | Epoch:36 | Val Acc: 0.7955
 Best site-MNIST_M                  (1)  | Epoch:36 | Val Acc: 0.8258
 Best site-SVHN                     (4)  | Epoch:36 | Val Acc: 0.7192
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 37 ============
cnt=[3, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (3) | Train Loss: 0.2216 | Train Acc: 0.9378
 Site-MNIST                     (3) | Train Loss: 0.1879 | Train Acc: 0.9586
 Site-MNIST                     (3) | Train Loss: 0.2152 | Train Acc: 0.9369
 Site-MNIST                     (3) | Train Loss: 0.2245 | Train Acc: 0.9330
 Site-MNIST                     (3) | Train Loss: 0.1917 | Train Acc: 0.9501
 Site-USPS                      (0) | Train Loss: 0.2697 | Train Acc: 0.9113
 Site-USPS                      (0) | Train Loss: 0.2443 | Train Acc: 0.9329
 Site-USPS                      (0) | Train Loss: 0.2414 | Train Acc: 0.9297
 Site-SynthDigits               (2) | Train Loss: 0.4002 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.3416 | Train Acc: 0.9230
 Site-MNIST_M                   (1) | Train Loss: 0.5880 | Train Acc: 0.8551
 Site-MNIST_M                   (5) | Train Loss: 0.6061 | Train Acc: 0.8409
 Site-SVHN                      (4) | Train Loss: 0.7594 | Train Acc: 0.7666
Average Train Accuracy: 0.9048
 Site-MNIST                     (3) | Val  Loss: 0.1602 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1688 | Val  Acc: 0.9405
 Site-MNIST                     (3) | Val  Loss: 0.2036 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2347 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1957 | Val  Acc: 0.9544
 Site-USPS                      (0) | Val  Loss: 0.1851 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2340 | Val  Acc: 0.9038
 Site-USPS                      (0) | Val  Loss: 0.2813 | Val  Acc: 0.8803
 Site-SynthDigits               (2) | Val  Loss: 0.4698 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.3083 | Val  Acc: 0.9141
 Site-MNIST_M                   (1) | Val  Loss: 0.6662 | Val  Acc: 0.7841
 Site-MNIST_M                   (5) | Val  Loss: 0.6691 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.7619 | Val  Acc: 0.7329
Average Valid Accuracy: 0.8958
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9405
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:37 | Val Acc: 0.9544
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9615
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.9038
 Best site-USPS                     (0)  | Epoch:37 | Val Acc: 0.8803
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:37 | Val Acc: 0.9141
 Best site-MNIST_M                  (1)  | Epoch:37 | Val Acc: 0.7841
 Best site-MNIST_M                  (5)  | Epoch:37 | Val Acc: 0.8409
 Best site-SVHN                     (4)  | Epoch:37 | Val Acc: 0.7329
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 38 ============
cnt=[5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (0) | Train Loss: 0.1982 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.1671 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2109 | Train Acc: 0.9329
 Site-MNIST                     (0) | Train Loss: 0.2204 | Train Acc: 0.9277
 Site-MNIST                     (0) | Train Loss: 0.1868 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2473 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2411 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2303 | Train Acc: 0.9297
 Site-SynthDigits               (5) | Train Loss: 0.3979 | Train Acc: 0.8864
 Site-SynthDigits               (1) | Train Loss: 0.3382 | Train Acc: 0.9141
 Site-MNIST_M                   (2) | Train Loss: 0.5824 | Train Acc: 0.8466
 Site-MNIST_M                   (2) | Train Loss: 0.5721 | Train Acc: 0.8352
 Site-SVHN                      (4) | Train Loss: 0.7244 | Train Acc: 0.7632
Average Train Accuracy: 0.9031
 Site-MNIST                     (0) | Val  Loss: 0.1623 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1713 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.2003 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2324 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1941 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1831 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2329 | Val  Acc: 0.9038
 Site-USPS                      (3) | Val  Loss: 0.2756 | Val  Acc: 0.8761
 Site-SynthDigits               (5) | Val  Loss: 0.4461 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.3002 | Val  Acc: 0.9091
 Site-MNIST_M                   (2) | Val  Loss: 0.6535 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6576 | Val  Acc: 0.8333
 Site-SVHN                      (4) | Val  Loss: 0.7470 | Val  Acc: 0.7055
Average Valid Accuracy: 0.8907
============ Train epoch 39 ============
cnt=[4, 2, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.1959 | Train Acc: 0.9467
 Site-MNIST                     (5) | Train Loss: 0.1964 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.2070 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2191 | Train Acc: 0.9317
 Site-MNIST                     (0) | Train Loss: 0.1829 | Train Acc: 0.9518
 Site-USPS                      (3) | Train Loss: 0.2502 | Train Acc: 0.9161
 Site-USPS                      (3) | Train Loss: 0.2324 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2277 | Train Acc: 0.9329
 Site-SynthDigits               (1) | Train Loss: 0.3764 | Train Acc: 0.8883
 Site-SynthDigits               (1) | Train Loss: 0.3390 | Train Acc: 0.9268
 Site-MNIST_M                   (2) | Train Loss: 0.5847 | Train Acc: 0.8352
 Site-MNIST_M                   (2) | Train Loss: 0.5814 | Train Acc: 0.8466
 Site-SVHN                      (4) | Train Loss: 0.6943 | Train Acc: 0.7649
Average Train Accuracy: 0.9057
 Site-MNIST                     (0) | Val  Loss: 0.1572 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.1663 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1983 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2279 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1896 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1745 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2261 | Val  Acc: 0.9167
 Site-USPS                      (3) | Val  Loss: 0.2714 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4446 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2944 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6465 | Val  Acc: 0.7955
 Site-MNIST_M                   (2) | Val  Loss: 0.6501 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.7411 | Val  Acc: 0.7192
Average Valid Accuracy: 0.8949
============ Train epoch 40 ============
cnt=[5, 2, 3, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (0) | Train Loss: 0.2057 | Train Acc: 0.9422
 Site-MNIST                     (0) | Train Loss: 0.1914 | Train Acc: 0.9586
 Site-MNIST                     (0) | Train Loss: 0.2052 | Train Acc: 0.9369
 Site-MNIST                     (0) | Train Loss: 0.2150 | Train Acc: 0.9330
 Site-MNIST                     (0) | Train Loss: 0.1817 | Train Acc: 0.9527
 Site-USPS                      (2) | Train Loss: 0.2544 | Train Acc: 0.9137
 Site-USPS                      (2) | Train Loss: 0.2285 | Train Acc: 0.9393
 Site-USPS                      (2) | Train Loss: 0.2266 | Train Acc: 0.9350
 Site-SynthDigits               (1) | Train Loss: 0.3858 | Train Acc: 0.8958
 Site-SynthDigits               (1) | Train Loss: 0.3333 | Train Acc: 0.9293
 Site-MNIST_M                   (5) | Train Loss: 0.5817 | Train Acc: 0.8352
 Site-MNIST_M                   (3) | Train Loss: 0.5872 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.7135 | Train Acc: 0.7751
Average Train Accuracy: 0.9069
 Site-MNIST                     (0) | Val  Loss: 0.1569 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.1657 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.1962 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2260 | Val  Acc: 0.9421
 Site-MNIST                     (0) | Val  Loss: 0.1877 | Val  Acc: 0.9544
 Site-USPS                      (2) | Val  Loss: 0.1755 | Val  Acc: 0.9519
 Site-USPS                      (2) | Val  Loss: 0.2233 | Val  Acc: 0.9103
 Site-USPS                      (2) | Val  Loss: 0.2667 | Val  Acc: 0.8803
 Site-SynthDigits               (1) | Val  Loss: 0.4394 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2826 | Val  Acc: 0.9242
 Site-MNIST_M                   (5) | Val  Loss: 0.6235 | Val  Acc: 0.8182
 Site-MNIST_M                   (3) | Val  Loss: 0.6437 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.7372 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8998
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9421
 Best site-MNIST                    (0)  | Epoch:40 | Val Acc: 0.9544
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9519
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.9103
 Best site-USPS                     (2)  | Epoch:40 | Val Acc: 0.8803
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.8788
 Best site-SynthDigits              (1)  | Epoch:40 | Val Acc: 0.9242
 Best site-MNIST_M                  (5)  | Epoch:40 | Val Acc: 0.8182
 Best site-MNIST_M                  (3)  | Epoch:40 | Val Acc: 0.8636
 Best site-SVHN                     (4)  | Epoch:40 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 41 ============
cnt=[3, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (3) | Train Loss: 0.2118 | Train Acc: 0.9467
 Site-MNIST                     (3) | Train Loss: 0.1846 | Train Acc: 0.9556
 Site-MNIST                     (3) | Train Loss: 0.1998 | Train Acc: 0.9408
 Site-MNIST                     (3) | Train Loss: 0.2101 | Train Acc: 0.9356
 Site-MNIST                     (3) | Train Loss: 0.1760 | Train Acc: 0.9545
 Site-USPS                      (0) | Train Loss: 0.2407 | Train Acc: 0.9161
 Site-USPS                      (0) | Train Loss: 0.2240 | Train Acc: 0.9393
 Site-USPS                      (0) | Train Loss: 0.2251 | Train Acc: 0.9361
 Site-SynthDigits               (2) | Train Loss: 0.3955 | Train Acc: 0.8807
 Site-SynthDigits               (2) | Train Loss: 0.3199 | Train Acc: 0.9280
 Site-MNIST_M                   (5) | Train Loss: 0.5683 | Train Acc: 0.8466
 Site-MNIST_M                   (1) | Train Loss: 0.5558 | Train Acc: 0.8447
 Site-SVHN                      (4) | Train Loss: 0.7080 | Train Acc: 0.7922
Average Train Accuracy: 0.9090
 Site-MNIST                     (3) | Val  Loss: 0.1517 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1607 | Val  Acc: 0.9405
 Site-MNIST                     (3) | Val  Loss: 0.1910 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2221 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1830 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1718 | Val  Acc: 0.9519
 Site-USPS                      (0) | Val  Loss: 0.2220 | Val  Acc: 0.9103
 Site-USPS                      (0) | Val  Loss: 0.2665 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.4320 | Val  Acc: 0.8788
 Site-SynthDigits               (2) | Val  Loss: 0.2818 | Val  Acc: 0.9192
 Site-MNIST_M                   (5) | Val  Loss: 0.6164 | Val  Acc: 0.8295
 Site-MNIST_M                   (1) | Val  Loss: 0.6260 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7179 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9025
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9405
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:41 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.9519
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.9103
 Best site-USPS                     (0)  | Epoch:41 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.8788
 Best site-SynthDigits              (2)  | Epoch:41 | Val Acc: 0.9192
 Best site-MNIST_M                  (5)  | Epoch:41 | Val Acc: 0.8295
 Best site-MNIST_M                  (1)  | Epoch:41 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:41 | Val Acc: 0.7534
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.1921 | Train Acc: 0.9378
 Site-MNIST                     (0) | Train Loss: 0.1967 | Train Acc: 0.9527
 Site-MNIST                     (0) | Train Loss: 0.1986 | Train Acc: 0.9448
 Site-MNIST                     (0) | Train Loss: 0.2096 | Train Acc: 0.9343
 Site-MNIST                     (0) | Train Loss: 0.1748 | Train Acc: 0.9562
 Site-USPS                      (3) | Train Loss: 0.2551 | Train Acc: 0.9185
 Site-USPS                      (3) | Train Loss: 0.2235 | Train Acc: 0.9393
 Site-USPS                      (3) | Train Loss: 0.2220 | Train Acc: 0.9340
 Site-SynthDigits               (1) | Train Loss: 0.3643 | Train Acc: 0.8902
 Site-SynthDigits               (5) | Train Loss: 0.3063 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.5688 | Train Acc: 0.8580
 Site-MNIST_M                   (2) | Train Loss: 0.5651 | Train Acc: 0.8485
 Site-SVHN                      (4) | Train Loss: 0.7008 | Train Acc: 0.7871
Average Train Accuracy: 0.9097
 Site-MNIST                     (0) | Val  Loss: 0.1505 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1611 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1883 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2206 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1819 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1756 | Val  Acc: 0.9519
 Site-USPS                      (3) | Val  Loss: 0.2196 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2622 | Val  Acc: 0.8846
 Site-SynthDigits               (1) | Val  Loss: 0.4194 | Val  Acc: 0.8788
 Site-SynthDigits               (5) | Val  Loss: 0.2737 | Val  Acc: 0.9141
 Site-MNIST_M                   (2) | Val  Loss: 0.6140 | Val  Acc: 0.8068
 Site-MNIST_M                   (2) | Val  Loss: 0.6246 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.7076 | Val  Acc: 0.7534
Average Valid Accuracy: 0.9003
============ Train epoch 43 ============
cnt=[1, 2, 2, 3, 1, 4, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (5) | Train Loss: 0.1826 | Train Acc: 0.9511
 Site-MNIST                     (5) | Train Loss: 0.1550 | Train Acc: 0.9556
 Site-MNIST                     (5) | Train Loss: 0.1964 | Train Acc: 0.9408
 Site-MNIST                     (5) | Train Loss: 0.2071 | Train Acc: 0.9382
 Site-MNIST                     (0) | Train Loss: 0.1727 | Train Acc: 0.9545
 Site-USPS                      (3) | Train Loss: 0.2456 | Train Acc: 0.9257
 Site-USPS                      (3) | Train Loss: 0.2151 | Train Acc: 0.9361
 Site-USPS                      (3) | Train Loss: 0.2195 | Train Acc: 0.9372
 Site-SynthDigits               (1) | Train Loss: 0.3730 | Train Acc: 0.8920
 Site-SynthDigits               (1) | Train Loss: 0.3233 | Train Acc: 0.9255
 Site-MNIST_M                   (2) | Train Loss: 0.5608 | Train Acc: 0.8608
 Site-MNIST_M                   (2) | Train Loss: 0.5539 | Train Acc: 0.8561
 Site-SVHN                      (4) | Train Loss: 0.7058 | Train Acc: 0.7853
Average Train Accuracy: 0.9122
 Site-MNIST                     (5) | Val  Loss: 0.1502 | Val  Acc: 0.9464
 Site-MNIST                     (5) | Val  Loss: 0.1617 | Val  Acc: 0.9286
 Site-MNIST                     (5) | Val  Loss: 0.1874 | Val  Acc: 0.9524
 Site-MNIST                     (5) | Val  Loss: 0.2182 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1800 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1659 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2119 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2497 | Val  Acc: 0.8932
 Site-SynthDigits               (1) | Val  Loss: 0.4215 | Val  Acc: 0.8788
 Site-SynthDigits               (1) | Val  Loss: 0.2728 | Val  Acc: 0.9192
 Site-MNIST_M                   (2) | Val  Loss: 0.6133 | Val  Acc: 0.8182
 Site-MNIST_M                   (2) | Val  Loss: 0.6246 | Val  Acc: 0.8409
 Site-SVHN                      (4) | Val  Loss: 0.6957 | Val  Acc: 0.7534
Average Valid Accuracy: 0.8993
============ Train epoch 44 ============
cnt=[3, 1, 2, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (3) | Train Loss: 0.1881 | Train Acc: 0.9467
 Site-MNIST                     (3) | Train Loss: 0.1657 | Train Acc: 0.9556
 Site-MNIST                     (3) | Train Loss: 0.1951 | Train Acc: 0.9408
 Site-MNIST                     (3) | Train Loss: 0.2047 | Train Acc: 0.9369
 Site-MNIST                     (3) | Train Loss: 0.1697 | Train Acc: 0.9518
 Site-USPS                      (0) | Train Loss: 0.2419 | Train Acc: 0.9257
 Site-USPS                      (0) | Train Loss: 0.2219 | Train Acc: 0.9409
 Site-USPS                      (0) | Train Loss: 0.2172 | Train Acc: 0.9361
 Site-SynthDigits               (2) | Train Loss: 0.3515 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.3281 | Train Acc: 0.9268
 Site-MNIST_M                   (5) | Train Loss: 0.5285 | Train Acc: 0.8608
 Site-MNIST_M                   (1) | Train Loss: 0.5494 | Train Acc: 0.8371
 Site-SVHN                      (4) | Train Loss: 0.6966 | Train Acc: 0.7888
Average Train Accuracy: 0.9103
 Site-MNIST                     (3) | Val  Loss: 0.1491 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1606 | Val  Acc: 0.9405
 Site-MNIST                     (3) | Val  Loss: 0.1854 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2167 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1785 | Val  Acc: 0.9509
 Site-USPS                      (0) | Val  Loss: 0.1685 | Val  Acc: 0.9615
 Site-USPS                      (0) | Val  Loss: 0.2110 | Val  Acc: 0.9167
 Site-USPS                      (0) | Val  Loss: 0.2491 | Val  Acc: 0.8932
 Site-SynthDigits               (2) | Val  Loss: 0.4151 | Val  Acc: 0.8864
 Site-SynthDigits               (2) | Val  Loss: 0.2702 | Val  Acc: 0.9141
 Site-MNIST_M                   (5) | Val  Loss: 0.5978 | Val  Acc: 0.8295
 Site-MNIST_M                   (1) | Val  Loss: 0.6124 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.6879 | Val  Acc: 0.7466
Average Valid Accuracy: 0.9043
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9405
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:44 | Val Acc: 0.9509
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.9615
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.9167
 Best site-USPS                     (0)  | Epoch:44 | Val Acc: 0.8932
 Best site-SynthDigits              (2)  | Epoch:44 | Val Acc: 0.8864
 Best site-SynthDigits              (2)  | Epoch:44 | Val Acc: 0.9141
 Best site-MNIST_M                  (5)  | Epoch:44 | Val Acc: 0.8295
 Best site-MNIST_M                  (1)  | Epoch:44 | Val Acc: 0.8636
 Best site-SVHN                     (4)  | Epoch:44 | Val Acc: 0.7466
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 45 ============
cnt=[3, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (2) | Train Loss: 0.2171 | Train Acc: 0.9422
 Site-MNIST                     (2) | Train Loss: 0.1788 | Train Acc: 0.9527
 Site-MNIST                     (2) | Train Loss: 0.1945 | Train Acc: 0.9448
 Site-MNIST                     (2) | Train Loss: 0.2050 | Train Acc: 0.9343
 Site-MNIST                     (2) | Train Loss: 0.1720 | Train Acc: 0.9545
 Site-USPS                      (0) | Train Loss: 0.2250 | Train Acc: 0.9233
 Site-USPS                      (0) | Train Loss: 0.2143 | Train Acc: 0.9393
 Site-USPS                      (0) | Train Loss: 0.2096 | Train Acc: 0.9404
 Site-SynthDigits               (3) | Train Loss: 0.3671 | Train Acc: 0.8883
 Site-SynthDigits               (3) | Train Loss: 0.2988 | Train Acc: 0.9306
 Site-MNIST_M                   (1) | Train Loss: 0.5519 | Train Acc: 0.8523
 Site-MNIST_M                   (5) | Train Loss: 0.5094 | Train Acc: 0.8561
 Site-SVHN                      (4) | Train Loss: 0.6567 | Train Acc: 0.7990
Average Train Accuracy: 0.9121
 Site-MNIST                     (2) | Val  Loss: 0.1530 | Val  Acc: 0.9643
 Site-MNIST                     (2) | Val  Loss: 0.1615 | Val  Acc: 0.9167
 Site-MNIST                     (2) | Val  Loss: 0.1854 | Val  Acc: 0.9524
 Site-MNIST                     (2) | Val  Loss: 0.2173 | Val  Acc: 0.9368
 Site-MNIST                     (2) | Val  Loss: 0.1786 | Val  Acc: 0.9474
 Site-USPS                      (0) | Val  Loss: 0.1659 | Val  Acc: 0.9519
 Site-USPS                      (0) | Val  Loss: 0.2104 | Val  Acc: 0.9231
 Site-USPS                      (0) | Val  Loss: 0.2431 | Val  Acc: 0.8889
 Site-SynthDigits               (3) | Val  Loss: 0.4107 | Val  Acc: 0.8712
 Site-SynthDigits               (3) | Val  Loss: 0.2630 | Val  Acc: 0.9242
 Site-MNIST_M                   (1) | Val  Loss: 0.6028 | Val  Acc: 0.8068
 Site-MNIST_M                   (5) | Val  Loss: 0.6230 | Val  Acc: 0.8636
 Site-SVHN                      (4) | Val  Loss: 0.6794 | Val  Acc: 0.7466
Average Valid Accuracy: 0.8995
 Test site-MNIST                     (2)| Epoch:44 | Test Acc: 0.9367
 Test site-USPS                      (0)| Epoch:44 | Test Acc: 0.9473
 Test site-SynthDigits               (3)| Epoch:44 | Test Acc: 0.8989
 Test site-MNIST_M                   (1)| Epoch:44 | Test Acc: 0.7514
 Test site-SVHN                      (4)| Epoch:44 | Test Acc: 0.7038
MNIST: 0.9367, USPS: 0.9473, SynthDigits: 0.8989, MNIST_M: 0.7514, SVHN: 0.7038, 
Average Test Accuracy(group): 0.8476, Average Test Accuracy(individual): 0.8869,
domain std=0.1004, cluster std=0.0984, individual std=0.0850, 
Average Test Accuracy: 0.8476
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 46 ============
cnt=[1, 5, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                     (1) | Train Loss: 0.1911 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1563 | Train Acc: 0.9556
 Site-MNIST                     (1) | Train Loss: 0.1923 | Train Acc: 0.9428
 Site-MNIST                     (1) | Train Loss: 0.2021 | Train Acc: 0.9343
 Site-MNIST                     (1) | Train Loss: 0.1697 | Train Acc: 0.9536
 Site-USPS                      (5) | Train Loss: 0.2186 | Train Acc: 0.9233
 Site-USPS                      (5) | Train Loss: 0.2095 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2142 | Train Acc: 0.9382
 Site-SynthDigits               (4) | Train Loss: 0.3408 | Train Acc: 0.8939
 Site-SynthDigits               (4) | Train Loss: 0.3052 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5245 | Train Acc: 0.8693
 Site-MNIST_M                   (2) | Train Loss: 0.5384 | Train Acc: 0.8542
 Site-SVHN                      (0) | Train Loss: 0.6720 | Train Acc: 0.7956
Average Train Accuracy: 0.9131
 Site-MNIST                     (1) | Val  Loss: 0.1462 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1589 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1864 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2155 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1774 | Val  Acc: 0.9544
 Site-USPS                      (5) | Val  Loss: 0.1598 | Val  Acc: 0.9615
 Site-USPS                      (5) | Val  Loss: 0.2029 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2345 | Val  Acc: 0.8974
 Site-SynthDigits               (4) | Val  Loss: 0.4305 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.2638 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.5796 | Val  Acc: 0.8409
 Site-MNIST_M                   (2) | Val  Loss: 0.6068 | Val  Acc: 0.8409
 Site-SVHN                      (0) | Val  Loss: 0.6818 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9067
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9821
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9405
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9524
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9368
 Best site-MNIST                    (1)  | Epoch:46 | Val Acc: 0.9544
 Best site-USPS                     (5)  | Epoch:46 | Val Acc: 0.9615
 Best site-USPS                     (5)  | Epoch:46 | Val Acc: 0.9103
 Best site-USPS                     (3)  | Epoch:46 | Val Acc: 0.8974
 Best site-SynthDigits              (4)  | Epoch:46 | Val Acc: 0.8788
 Best site-SynthDigits              (4)  | Epoch:46 | Val Acc: 0.9242
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.8409
 Best site-MNIST_M                  (2)  | Epoch:46 | Val Acc: 0.8409
 Best site-SVHN                     (0)  | Epoch:46 | Val Acc: 0.7671
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9381
 Test site-USPS                      (5)| Epoch:46 | Test Acc: 0.9495
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.8961
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7544
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.7026
MNIST: 0.9381, USPS: 0.9495, SynthDigits: 0.8961, MNIST_M: 0.7544, SVHN: 0.7026, 
Average Test Accuracy(group): 0.8482, Average Test Accuracy(individual): 0.8879,
domain std=0.1006, cluster std=0.0993, individual std=0.0851, 
Average Test Accuracy: 0.8482
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 47 ============
cnt=[1, 5, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                     (1) | Train Loss: 0.1881 | Train Acc: 0.9467
 Site-MNIST                     (1) | Train Loss: 0.1500 | Train Acc: 0.9497
 Site-MNIST                     (1) | Train Loss: 0.1889 | Train Acc: 0.9428
 Site-MNIST                     (1) | Train Loss: 0.2005 | Train Acc: 0.9382
 Site-MNIST                     (1) | Train Loss: 0.1688 | Train Acc: 0.9553
 Site-USPS                      (3) | Train Loss: 0.2181 | Train Acc: 0.9209
 Site-USPS                      (3) | Train Loss: 0.2138 | Train Acc: 0.9345
 Site-USPS                      (3) | Train Loss: 0.2127 | Train Acc: 0.9382
 Site-SynthDigits               (4) | Train Loss: 0.3440 | Train Acc: 0.8977
 Site-SynthDigits               (4) | Train Loss: 0.3069 | Train Acc: 0.9242
 Site-MNIST_M                   (2) | Train Loss: 0.5316 | Train Acc: 0.8665
 Site-MNIST_M                   (5) | Train Loss: 0.5193 | Train Acc: 0.8485
 Site-SVHN                      (0) | Train Loss: 0.6316 | Train Acc: 0.7956
Average Train Accuracy: 0.9122
 Site-MNIST                     (1) | Val  Loss: 0.1402 | Val  Acc: 0.9821
 Site-MNIST                     (1) | Val  Loss: 0.1538 | Val  Acc: 0.9405
 Site-MNIST                     (1) | Val  Loss: 0.1878 | Val  Acc: 0.9524
 Site-MNIST                     (1) | Val  Loss: 0.2147 | Val  Acc: 0.9368
 Site-MNIST                     (1) | Val  Loss: 0.1755 | Val  Acc: 0.9509
 Site-USPS                      (3) | Val  Loss: 0.1654 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.2009 | Val  Acc: 0.9103
 Site-USPS                      (3) | Val  Loss: 0.2345 | Val  Acc: 0.8932
 Site-SynthDigits               (4) | Val  Loss: 0.4385 | Val  Acc: 0.8788
 Site-SynthDigits               (4) | Val  Loss: 0.2598 | Val  Acc: 0.9444
 Site-MNIST_M                   (2) | Val  Loss: 0.5908 | Val  Acc: 0.8295
 Site-MNIST_M                   (5) | Val  Loss: 0.6190 | Val  Acc: 0.8333
 Site-SVHN                      (0) | Val  Loss: 0.6719 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9062
 Test site-MNIST                     (1)| Epoch:46 | Test Acc: 0.9379
 Test site-USPS                      (3)| Epoch:46 | Test Acc: 0.9495
 Test site-SynthDigits               (4)| Epoch:46 | Test Acc: 0.8975
 Test site-MNIST_M                   (2)| Epoch:46 | Test Acc: 0.7537
 Test site-SVHN                      (0)| Epoch:46 | Test Acc: 0.7070
MNIST: 0.9379, USPS: 0.9495, SynthDigits: 0.8975, MNIST_M: 0.7537, SVHN: 0.7070, 
Average Test Accuracy(group): 0.8491, Average Test Accuracy(individual): 0.8882,
domain std=0.0996, cluster std=0.0976, individual std=0.0845, 
Average Test Accuracy: 0.8491
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 48 ============
cnt=[5, 2, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                     (0) | Train Loss: 0.1978 | Train Acc: 0.9467
 Site-MNIST                     (0) | Train Loss: 0.1522 | Train Acc: 0.9556
 Site-MNIST                     (0) | Train Loss: 0.1863 | Train Acc: 0.9408
 Site-MNIST                     (0) | Train Loss: 0.1963 | Train Acc: 0.9409
 Site-MNIST                     (0) | Train Loss: 0.1634 | Train Acc: 0.9545
 Site-USPS                      (3) | Train Loss: 0.2195 | Train Acc: 0.9233
 Site-USPS                      (3) | Train Loss: 0.2107 | Train Acc: 0.9409
 Site-USPS                      (3) | Train Loss: 0.1975 | Train Acc: 0.9436
 Site-SynthDigits               (1) | Train Loss: 0.3653 | Train Acc: 0.8958
 Site-SynthDigits               (1) | Train Loss: 0.2936 | Train Acc: 0.9280
 Site-MNIST_M                   (2) | Train Loss: 0.5169 | Train Acc: 0.8750
 Site-MNIST_M                   (5) | Train Loss: 0.4959 | Train Acc: 0.8428
 Site-SVHN                      (4) | Train Loss: 0.6472 | Train Acc: 0.7990
Average Train Accuracy: 0.9144
 Site-MNIST                     (0) | Val  Loss: 0.1362 | Val  Acc: 0.9821
 Site-MNIST                     (0) | Val  Loss: 0.1502 | Val  Acc: 0.9405
 Site-MNIST                     (0) | Val  Loss: 0.1816 | Val  Acc: 0.9524
 Site-MNIST                     (0) | Val  Loss: 0.2107 | Val  Acc: 0.9368
 Site-MNIST                     (0) | Val  Loss: 0.1724 | Val  Acc: 0.9544
 Site-USPS                      (3) | Val  Loss: 0.1554 | Val  Acc: 0.9615
 Site-USPS                      (3) | Val  Loss: 0.1996 | Val  Acc: 0.9231
 Site-USPS                      (3) | Val  Loss: 0.2293 | Val  Acc: 0.8974
 Site-SynthDigits               (1) | Val  Loss: 0.4013 | Val  Acc: 0.8939
 Site-SynthDigits               (1) | Val  Loss: 0.2503 | Val  Acc: 0.9242
 Site-MNIST_M                   (2) | Val  Loss: 0.5721 | Val  Acc: 0.8409
 Site-MNIST_M                   (5) | Val  Loss: 0.6144 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6564 | Val  Acc: 0.7671
Average Valid Accuracy: 0.9100
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9821
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9405
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9524
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9368
 Best site-MNIST                    (0)  | Epoch:48 | Val Acc: 0.9544
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9615
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.9231
 Best site-USPS                     (3)  | Epoch:48 | Val Acc: 0.8974
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.8939
 Best site-SynthDigits              (1)  | Epoch:48 | Val Acc: 0.9242
 Best site-MNIST_M                  (2)  | Epoch:48 | Val Acc: 0.8409
 Best site-MNIST_M                  (5)  | Epoch:48 | Val Acc: 0.8561
 Best site-SVHN                     (4)  | Epoch:48 | Val Acc: 0.7671
 Test site-MNIST                     (0)| Epoch:48 | Test Acc: 0.9396
 Test site-USPS                      (3)| Epoch:48 | Test Acc: 0.9495
 Test site-SynthDigits               (1)| Epoch:48 | Test Acc: 0.9004
 Test site-MNIST_M                   (2)| Epoch:48 | Test Acc: 0.7549
 Test site-SVHN                      (4)| Epoch:48 | Test Acc: 0.7052
MNIST: 0.9396, USPS: 0.9495, SynthDigits: 0.9004, MNIST_M: 0.7549, SVHN: 0.7052, 
Average Test Accuracy(group): 0.8499, Average Test Accuracy(individual): 0.8894,
domain std=0.1005, cluster std=0.0983, individual std=0.0849, 
Average Test Accuracy: 0.8499
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 3, 2, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                     (5) | Train Loss: 0.1768 | Train Acc: 0.9511
 Site-MNIST                     (3) | Train Loss: 0.1533 | Train Acc: 0.9586
 Site-MNIST                     (5) | Train Loss: 0.1835 | Train Acc: 0.9487
 Site-MNIST                     (3) | Train Loss: 0.1935 | Train Acc: 0.9382
 Site-MNIST                     (3) | Train Loss: 0.1600 | Train Acc: 0.9545
 Site-USPS                      (1) | Train Loss: 0.2238 | Train Acc: 0.9257
 Site-USPS                      (1) | Train Loss: 0.2022 | Train Acc: 0.9377
 Site-USPS                      (1) | Train Loss: 0.1992 | Train Acc: 0.9436
 Site-SynthDigits               (2) | Train Loss: 0.3918 | Train Acc: 0.9053
 Site-SynthDigits               (2) | Train Loss: 0.2919 | Train Acc: 0.9306
 Site-MNIST_M                   (0) | Train Loss: 0.4951 | Train Acc: 0.8693
 Site-MNIST_M                   (0) | Train Loss: 0.5221 | Train Acc: 0.8523
 Site-SVHN                      (4) | Train Loss: 0.6517 | Train Acc: 0.8058
Average Train Accuracy: 0.9170
 Site-MNIST                     (5) | Val  Loss: 0.1361 | Val  Acc: 0.9643
 Site-MNIST                     (3) | Val  Loss: 0.1503 | Val  Acc: 0.9405
 Site-MNIST                     (5) | Val  Loss: 0.1796 | Val  Acc: 0.9524
 Site-MNIST                     (3) | Val  Loss: 0.2076 | Val  Acc: 0.9368
 Site-MNIST                     (3) | Val  Loss: 0.1697 | Val  Acc: 0.9509
 Site-USPS                      (1) | Val  Loss: 0.1491 | Val  Acc: 0.9615
 Site-USPS                      (1) | Val  Loss: 0.1997 | Val  Acc: 0.9167
 Site-USPS                      (1) | Val  Loss: 0.2264 | Val  Acc: 0.9060
 Site-SynthDigits               (2) | Val  Loss: 0.3933 | Val  Acc: 0.8939
 Site-SynthDigits               (2) | Val  Loss: 0.2459 | Val  Acc: 0.9444
 Site-MNIST_M                   (0) | Val  Loss: 0.5524 | Val  Acc: 0.8409
 Site-MNIST_M                   (0) | Val  Loss: 0.6003 | Val  Acc: 0.8485
 Site-SVHN                      (4) | Val  Loss: 0.6488 | Val  Acc: 0.7877
Average Valid Accuracy: 0.9111
 Best site-MNIST                    (5)  | Epoch:49 | Val Acc: 0.9643
 Best site-MNIST                    (3)  | Epoch:49 | Val Acc: 0.9405
 Best site-MNIST                    (5)  | Epoch:49 | Val Acc: 0.9524
 Best site-MNIST                    (3)  | Epoch:49 | Val Acc: 0.9368
 Best site-MNIST                    (3)  | Epoch:49 | Val Acc: 0.9509
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.9615
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.9167
 Best site-USPS                     (1)  | Epoch:49 | Val Acc: 0.9060
 Best site-SynthDigits              (2)  | Epoch:49 | Val Acc: 0.8939
 Best site-SynthDigits              (2)  | Epoch:49 | Val Acc: 0.9444
 Best site-MNIST_M                  (0)  | Epoch:49 | Val Acc: 0.8409
 Best site-MNIST_M                  (0)  | Epoch:49 | Val Acc: 0.8485
 Best site-SVHN                     (4)  | Epoch:49 | Val Acc: 0.7877
 Test site-MNIST                     (5)| Epoch:49 | Test Acc: 0.9393
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (2)| Epoch:49 | Test Acc: 0.9001
 Test site-MNIST_M                   (0)| Epoch:49 | Test Acc: 0.7553
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7067
MNIST: 0.9393, USPS: 0.9495, SynthDigits: 0.9001, MNIST_M: 0.7553, SVHN: 0.7067, 
Average Test Accuracy(group): 0.8502, Average Test Accuracy(individual): 0.8894,
domain std=0.0999, cluster std=0.0970, individual std=0.0845, 
Average Test Accuracy: 0.8502
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.5_0_cluster_6/ccop_q=1...
===2023-08-03 07:59:09===
===2023-08-03 07:59:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[225,338,507,761,1142,417,626,939,528,792,352,528,587,
client_nums=[5,3,2,2,1,]
len_dataset=[3719,2479,1652,1101,734,]
domain number = 6
Loading snapshots...
 Test site-MNIST                     (5)| Epoch:49 | Test Acc: 0.9393
 Test site-USPS                      (1)| Epoch:49 | Test Acc: 0.9495
 Test site-SynthDigits               (2)| Epoch:49 | Test Acc: 0.9001
 Test site-MNIST_M                   (0)| Epoch:49 | Test Acc: 0.7553
 Test site-SVHN                      (4)| Epoch:49 | Test Acc: 0.7067
MNIST: 0.9393, USPS: 0.9495, SynthDigits: 0.9001, MNIST_M: 0.7553, SVHN: 0.7067, 
Average Test Accuracy(group): 0.8502, Average Test Accuracy(individual): 0.8894,
domain std=0.0999, cluster std=0.0970, individual std=0.0845, 
