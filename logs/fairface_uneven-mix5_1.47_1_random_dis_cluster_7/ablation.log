===2023-06-15 19:20:32===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[12,17,26,38,56,82,121,179,263,387,27,40,59,86,127,187,276,43,64,94,139,205,55,81,119,102,150,172,117,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[3952,2688,1828,856,846,575,391,]
domain number = 7
============ Train epoch 0 ============
cnt=[4, 1, 5, 8, 3, 6, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (0) | Train Loss: 2.2075 | Train Acc: 0.1667
 Site-White_utk                 (5) | Train Loss: 2.2160 | Train Acc: 0.0588
 Site-White_utk                 (0) | Train Loss: 2.2018 | Train Acc: 0.2308
 Site-White_utk                 (5) | Train Loss: 2.2162 | Train Acc: 0.1579
 Site-White_utk                 (5) | Train Loss: 2.2164 | Train Acc: 0.1429
 Site-White_utk                 (0) | Train Loss: 2.2053 | Train Acc: 0.1463
 Site-White_utk                 (0) | Train Loss: 2.2091 | Train Acc: 0.1488
 Site-White_utk                 (5) | Train Loss: 2.2145 | Train Acc: 0.1006
 Site-White_utk                 (5) | Train Loss: 2.2069 | Train Acc: 0.1027
 Site-White_utk                 (5) | Train Loss: 2.2134 | Train Acc: 0.1111
 Site-East_Asian                (1) | Train Loss: 2.1869 | Train Acc: 0.1111
 Site-East_Asian                (3) | Train Loss: 2.2095 | Train Acc: 0.0500
 Site-East_Asian                (3) | Train Loss: 2.2035 | Train Acc: 0.0339
 Site-East_Asian                (3) | Train Loss: 2.2019 | Train Acc: 0.0814
 Site-East_Asian                (3) | Train Loss: 2.2062 | Train Acc: 0.0394
 Site-East_Asian                (3) | Train Loss: 2.2056 | Train Acc: 0.0642
 Site-East_Asian                (3) | Train Loss: 2.2004 | Train Acc: 0.0652
 Site-Indian_utk                (2) | Train Loss: 2.1915 | Train Acc: 0.1163
 Site-Indian_utk                (2) | Train Loss: 2.1756 | Train Acc: 0.2031
 Site-Indian_utk                (2) | Train Loss: 2.1902 | Train Acc: 0.1915
 Site-Indian_utk                (2) | Train Loss: 2.1749 | Train Acc: 0.1439
 Site-Indian_utk                (2) | Train Loss: 2.1638 | Train Acc: 0.2146
 Site-Black_utk                 (4) | Train Loss: 2.1831 | Train Acc: 0.2182
 Site-Black_utk                 (4) | Train Loss: 2.1882 | Train Acc: 0.2099
 Site-Black_utk                 (4) | Train Loss: 2.1872 | Train Acc: 0.1345
 Site-Southeast_Asian           (3) | Train Loss: 2.2031 | Train Acc: 0.1275
 Site-Southeast_Asian           (3) | Train Loss: 2.1982 | Train Acc: 0.1000
 Site-Asian_ffhq                (6) | Train Loss: 2.1852 | Train Acc: 0.1279
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 2.1651 | Train Acc: 0.1624
Average Train Accuracy: 0.1297
 Site-White_utk                 (0) | Val  Loss: 2.2042 | Val  Acc: 0.0000
 Site-White_utk                 (5) | Val  Loss: 2.2108 | Val  Acc: 0.1818
 Site-White_utk                 (0) | Val  Loss: 2.2071 | Val  Acc: 0.2941
 Site-White_utk                 (5) | Val  Loss: 2.2106 | Val  Acc: 0.1200
 Site-White_utk                 (5) | Val  Loss: 2.2100 | Val  Acc: 0.1622
 Site-White_utk                 (0) | Val  Loss: 2.2044 | Val  Acc: 0.1273
 Site-White_utk                 (0) | Val  Loss: 2.2054 | Val  Acc: 0.0741
 Site-White_utk                 (5) | Val  Loss: 2.2214 | Val  Acc: 0.0672
 Site-White_utk                 (5) | Val  Loss: 2.2182 | Val  Acc: 0.1029
 Site-White_utk                 (5) | Val  Loss: 2.2091 | Val  Acc: 0.1395
 Site-East_Asian                (1) | Val  Loss: 2.1995 | Val  Acc: 0.0556
 Site-East_Asian                (3) | Val  Loss: 2.2018 | Val  Acc: 0.0000
 Site-East_Asian                (3) | Val  Loss: 2.1930 | Val  Acc: 0.1026
 Site-East_Asian                (3) | Val  Loss: 2.1972 | Val  Acc: 0.1053
 Site-East_Asian                (3) | Val  Loss: 2.2097 | Val  Acc: 0.0353
 Site-East_Asian                (3) | Val  Loss: 2.2037 | Val  Acc: 0.0640
 Site-East_Asian                (3) | Val  Loss: 2.2084 | Val  Acc: 0.0761
 Site-Indian_utk                (2) | Val  Loss: 2.1690 | Val  Acc: 0.1724
 Site-Indian_utk                (2) | Val  Loss: 2.1715 | Val  Acc: 0.2558
 Site-Indian_utk                (2) | Val  Loss: 2.1658 | Val  Acc: 0.1587
 Site-Indian_utk                (2) | Val  Loss: 2.1826 | Val  Acc: 0.1630
 Site-Indian_utk                (2) | Val  Loss: 2.1613 | Val  Acc: 0.1691
 Site-Black_utk                 (4) | Val  Loss: 2.2004 | Val  Acc: 0.0833
 Site-Black_utk                 (4) | Val  Loss: 2.1798 | Val  Acc: 0.2037
 Site-Black_utk                 (4) | Val  Loss: 2.1785 | Val  Acc: 0.1519
 Site-Southeast_Asian           (3) | Val  Loss: 2.1980 | Val  Acc: 0.0735
 Site-Southeast_Asian           (3) | Val  Loss: 2.1910 | Val  Acc: 0.1400
 Site-Asian_ffhq                (6) | Val  Loss: 2.1761 | Val  Acc: 0.1217
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.1851 | Val  Acc: 0.1026
Average Valid Accuracy: 0.1208
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.0000
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.1818
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.2941
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.1200
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.1622
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1273
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.0741
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.0672
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.1029
 Best site-White_utk                (5)  | Epoch:0 | Val Acc: 0.1395
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.0556
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.0000
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1026
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.1053
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.0353
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.0640
 Best site-East_Asian               (3)  | Epoch:0 | Val Acc: 0.0761
 Best site-Indian_utk               (2)  | Epoch:0 | Val Acc: 0.1724
 Best site-Indian_utk               (2)  | Epoch:0 | Val Acc: 0.2558
 Best site-Indian_utk               (2)  | Epoch:0 | Val Acc: 0.1587
 Best site-Indian_utk               (2)  | Epoch:0 | Val Acc: 0.1630
 Best site-Indian_utk               (2)  | Epoch:0 | Val Acc: 0.1691
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.0833
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.2037
 Best site-Black_utk                (4)  | Epoch:0 | Val Acc: 0.1519
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.0735
 Best site-Southeast_Asian          (3)  | Epoch:0 | Val Acc: 0.1400
 Best site-Asian_ffhq               (6)  | Epoch:0 | Val Acc: 0.1217
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:0 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7/ablation...
============ Train epoch 1 ============
cnt=[1, 4, 5, 9, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 2.1990 | Train Acc: 0.3333
 Site-White_utk                 (3) | Train Loss: 2.2122 | Train Acc: 0.2353
 Site-White_utk                 (3) | Train Loss: 2.2023 | Train Acc: 0.2308
 Site-White_utk                 (3) | Train Loss: 2.2086 | Train Acc: 0.1053
 Site-White_utk                 (3) | Train Loss: 2.2039 | Train Acc: 0.1429
 Site-White_utk                 (3) | Train Loss: 2.2070 | Train Acc: 0.1220
 Site-White_utk                 (3) | Train Loss: 2.2054 | Train Acc: 0.1653
 Site-White_utk                 (3) | Train Loss: 2.2060 | Train Acc: 0.1006
 Site-White_utk                 (3) | Train Loss: 2.2056 | Train Acc: 0.1369
 Site-White_utk                 (3) | Train Loss: 2.2030 | Train Acc: 0.1318
 Site-East_Asian                (1) | Train Loss: 2.1593 | Train Acc: 0.2963
 Site-East_Asian                (6) | Train Loss: 2.1811 | Train Acc: 0.1000
 Site-East_Asian                (6) | Train Loss: 2.1906 | Train Acc: 0.1017
 Site-East_Asian                (6) | Train Loss: 2.1954 | Train Acc: 0.1744
 Site-East_Asian                (1) | Train Loss: 2.1888 | Train Acc: 0.1260
 Site-East_Asian                (6) | Train Loss: 2.1807 | Train Acc: 0.1390
 Site-East_Asian                (6) | Train Loss: 2.1816 | Train Acc: 0.1232
 Site-Indian_utk                (2) | Train Loss: 2.1671 | Train Acc: 0.2093
 Site-Indian_utk                (2) | Train Loss: 2.1562 | Train Acc: 0.2656
 Site-Indian_utk                (2) | Train Loss: 2.1804 | Train Acc: 0.2234
 Site-Indian_utk                (2) | Train Loss: 2.1669 | Train Acc: 0.2158
 Site-Indian_utk                (2) | Train Loss: 2.1466 | Train Acc: 0.2976
 Site-Black_utk                 (4) | Train Loss: 2.1705 | Train Acc: 0.2364
 Site-Black_utk                 (4) | Train Loss: 2.1560 | Train Acc: 0.2346
 Site-Black_utk                 (4) | Train Loss: 2.1706 | Train Acc: 0.2101
 Site-Southeast_Asian           (1) | Train Loss: 2.1883 | Train Acc: 0.1863
 Site-Southeast_Asian           (1) | Train Loss: 2.1872 | Train Acc: 0.1600
 Site-Asian_ffhq                (5) | Train Loss: 2.1455 | Train Acc: 0.2849
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 2.1356 | Train Acc: 0.2650
Average Train Accuracy: 0.1915
 Site-White_utk                 (0) | Val  Loss: 2.2154 | Val  Acc: 0.1250
 Site-White_utk                 (3) | Val  Loss: 2.2141 | Val  Acc: 0.1818
 Site-White_utk                 (3) | Val  Loss: 2.2030 | Val  Acc: 0.1765
 Site-White_utk                 (3) | Val  Loss: 2.1962 | Val  Acc: 0.2000
 Site-White_utk                 (3) | Val  Loss: 2.2165 | Val  Acc: 0.1081
 Site-White_utk                 (3) | Val  Loss: 2.1993 | Val  Acc: 0.1273
 Site-White_utk                 (3) | Val  Loss: 2.1955 | Val  Acc: 0.0864
 Site-White_utk                 (3) | Val  Loss: 2.2156 | Val  Acc: 0.1008
 Site-White_utk                 (3) | Val  Loss: 2.2140 | Val  Acc: 0.1429
 Site-White_utk                 (3) | Val  Loss: 2.2011 | Val  Acc: 0.1822
 Site-East_Asian                (1) | Val  Loss: 2.1990 | Val  Acc: 0.1667
 Site-East_Asian                (6) | Val  Loss: 2.1765 | Val  Acc: 0.1538
 Site-East_Asian                (6) | Val  Loss: 2.1900 | Val  Acc: 0.1282
 Site-East_Asian                (6) | Val  Loss: 2.1942 | Val  Acc: 0.1228
 Site-East_Asian                (1) | Val  Loss: 2.1798 | Val  Acc: 0.1529
 Site-East_Asian                (6) | Val  Loss: 2.1782 | Val  Acc: 0.1120
 Site-East_Asian                (6) | Val  Loss: 2.1856 | Val  Acc: 0.1359
 Site-Indian_utk                (2) | Val  Loss: 2.1553 | Val  Acc: 0.2069
 Site-Indian_utk                (2) | Val  Loss: 2.1392 | Val  Acc: 0.3488
 Site-Indian_utk                (2) | Val  Loss: 2.1480 | Val  Acc: 0.2698
 Site-Indian_utk                (2) | Val  Loss: 2.1663 | Val  Acc: 0.2391
 Site-Indian_utk                (2) | Val  Loss: 2.1463 | Val  Acc: 0.2500
 Site-Black_utk                 (4) | Val  Loss: 2.1904 | Val  Acc: 0.1667
 Site-Black_utk                 (4) | Val  Loss: 2.1663 | Val  Acc: 0.2407
 Site-Black_utk                 (4) | Val  Loss: 2.1564 | Val  Acc: 0.2532
 Site-Southeast_Asian           (1) | Val  Loss: 2.1937 | Val  Acc: 0.1912
 Site-Southeast_Asian           (1) | Val  Loss: 2.1735 | Val  Acc: 0.2100
 Site-Asian_ffhq                (5) | Val  Loss: 2.1424 | Val  Acc: 0.2261
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 2.1782 | Val  Acc: 0.1667
Average Valid Accuracy: 0.1784
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1250
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1818
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1765
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.2000
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1081
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1273
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.0864
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1008
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1429
 Best site-White_utk                (3)  | Epoch:1 | Val Acc: 0.1822
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.1667
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.1538
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.1282
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.1228
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.1529
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.1120
 Best site-East_Asian               (6)  | Epoch:1 | Val Acc: 0.1359
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.2069
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.3488
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.2698
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.2391
 Best site-Indian_utk               (2)  | Epoch:1 | Val Acc: 0.2500
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.1667
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.2407
 Best site-Black_utk                (4)  | Epoch:1 | Val Acc: 0.2532
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.1912
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2100
 Best site-Asian_ffhq               (5)  | Epoch:1 | Val Acc: 0.2261
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:1 | Val Acc: 0.1667
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-mix5_1.47_1_random_dis_cluster_7/ablation...
============ Train epoch 2 ============
