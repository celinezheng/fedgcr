===2023-03-29 23:53:52===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2225 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1401 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.1959 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.1065 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.7403 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 1.7642 | Train Acc: 0.5795
 Site-USPS      | Train Loss: 1.6172 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 1.6550 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.1370 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2498 | Train Acc: 0.1591
 Site-SVHN      | Val  Loss: 2.0689 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.2545 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1264 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.2206 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.6036 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 1.6425 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.8140 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 1.7210 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1517 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.2849 | Val  Acc: 0.1017
Average Valid Accuracy: 0.3763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5932
 Best site-USPS       | Epoch:0 | Val Acc: 0.6441
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-USPS       | Epoch:0 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.1122 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0491 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0328 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 2.0191 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1391 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.1372 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.0932 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0613 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8811 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.1341 | Train Acc: 0.2273
 Site-SVHN      | Val  Loss: 1.9293 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.1003 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0917 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0652 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.0273 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0987 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.1798 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.1427 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9204 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2933 | Val  Acc: 0.1186
Average Valid Accuracy: 0.4763
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.8136
 Best site-USPS       | Epoch:1 | Val Acc: 0.8136
 Best site-USPS       | Epoch:1 | Val Acc: 0.7797
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 1.9179 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.8061 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8114 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.8516 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.6776 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.6880 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6627 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.6390 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.6009 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9693 | Train Acc: 0.2955
 Site-SVHN      | Val  Loss: 1.7094 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.8673 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9027 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8575 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6491 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6686 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.7001 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.7088 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.7957 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.1885 | Val  Acc: 0.1525
Average Valid Accuracy: 0.5475
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3220
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-USPS       | Epoch:2 | Val Acc: 0.8305
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 1.8101 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5950 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.6858 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.5626 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5197 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4913 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4879 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.4263 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.3711 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.8229 | Train Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.4921 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.7574 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.6532 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.7453 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.4725 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5016 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.4822 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4879 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.6759 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.1038 | Val  Acc: 0.2712
Average Valid Accuracy: 0.6085
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4407
 Best site-USPS       | Epoch:3 | Val Acc: 0.8983
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.4963 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.4943 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3783 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4699 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.3845 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2978 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3460 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2285 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.2284 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.5393 | Train Acc: 0.5227
 Site-SVHN      | Val  Loss: 1.3299 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.4607 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5154 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.5357 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.2663 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.3297 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3000 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3042 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.6000 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.9299 | Val  Acc: 0.3559
Average Valid Accuracy: 0.6508
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-USPS       | Epoch:4 | Val Acc: 0.9661
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.2169 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.1556 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.1140 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 1.1465 | Train Acc: 0.5909
 Site-USPS      | Train Loss: 0.2609 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2143 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2755 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1780 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 1.0686 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.2113 | Train Acc: 0.5795
 Site-SVHN      | Val  Loss: 1.0219 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.1890 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.2021 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.2287 | Val  Acc: 0.5932
 Site-USPS      | Val  Loss: 0.2180 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2669 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2226 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2216 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.4656 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.8683 | Val  Acc: 0.3729
Average Valid Accuracy: 0.7136
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.1272 | Train Acc: 0.6477
 Site-SVHN      | Train Loss: 1.1138 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.0309 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 1.2190 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.2088 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1554 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.2034 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0947 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.9651 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.0069 | Train Acc: 0.7159
 Site-SVHN      | Val  Loss: 1.0982 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.0988 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.1068 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.1674 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.1292 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1846 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1482 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1375 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.4082 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.8438 | Val  Acc: 0.4237
Average Valid Accuracy: 0.7339
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9831
 Best site-USPS       | Epoch:6 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 0.8124 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.7684 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 0.7412 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 0.7721 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 0.1450 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1346 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.2021 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1056 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.7586 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7793 | Train Acc: 0.7614
 Site-SVHN      | Val  Loss: 0.6994 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.8242 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.7517 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.8243 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.1535 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1977 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.1468 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1152 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.2585 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.7053 | Val  Acc: 0.4746
Average Valid Accuracy: 0.8102
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7797
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-USPS       | Epoch:7 | Val Acc: 1.0000
 Best site-USPS       | Epoch:7 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 0.8015 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.7273 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.7827 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.8718 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 0.1330 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0871 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1611 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.0525 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7499 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 0.6001 | Train Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.8451 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 0.7725 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 0.7263 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.8051 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 0.1058 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1616 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.0979 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0777 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.1945 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.6903 | Val  Acc: 0.5254
Average Valid Accuracy: 0.8017
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 0.6321 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 0.5624 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 0.5028 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.4873 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.0977 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1010 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1447 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.0816 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.6109 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.4761 | Train Acc: 0.9091
 Site-SVHN      | Val  Loss: 0.4377 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 0.5517 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.5530 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 0.5772 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.1186 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1236 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1039 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0772 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 1.1971 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5344 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8559
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-USPS       | Epoch:9 | Val Acc: 0.9661
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST...
===2023-03-30 00:27:55===
===2023-03-30 00:27:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.6536
Average Test Accuracy: 0.6536
