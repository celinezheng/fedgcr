===2023-03-30 02:47:03===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-SVHN      | Train Loss: 2.2052 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1491 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.2003 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1093 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7573 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 1.7976 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 1.6705 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 1.7095 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 2.1478 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.2523 | Train Acc: 0.1705
 Site-SVHN      | Val  Loss: 2.0752 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.2621 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1338 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.2366 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.6511 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.6871 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 1.8658 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 1.7695 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 2.1707 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.2803 | Val  Acc: 0.1017
Average Valid Accuracy: 0.3627
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-USPS       | Epoch:0 | Val Acc: 0.6102
 Best site-USPS       | Epoch:0 | Val Acc: 0.4746
 Best site-USPS       | Epoch:0 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-SVHN      | Train Loss: 2.1669 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.0421 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0805 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.9907 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 1.3907 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 1.4511 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 1.2846 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.3152 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.9885 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.1761 | Train Acc: 0.2273
 Site-SVHN      | Val  Loss: 1.9363 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 2.1730 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 2.0379 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.1262 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2725 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.3131 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.4777 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 1.4035 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 2.0307 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2156 | Val  Acc: 0.1356
Average Valid Accuracy: 0.4508
 Best site-SVHN       | Epoch:1 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.6102
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-SVHN      | Train Loss: 2.1064 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 1.9439 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.9760 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.9107 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 1.1025 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.1373 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.0412 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.0406 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8633 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0636 | Train Acc: 0.2500
 Site-SVHN      | Val  Loss: 1.8307 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 2.0876 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.9608 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.0571 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 0.9924 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.0410 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.1728 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.1163 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9293 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1757 | Val  Acc: 0.1525
Average Valid Accuracy: 0.4949
 Best site-SVHN       | Epoch:2 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1864
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.7797
 Best site-USPS       | Epoch:2 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1525
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-SVHN      | Train Loss: 2.0260 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9236 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8788 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.8696 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.8915 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.9443 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.8497 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 0.8366 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.7728 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9838 | Train Acc: 0.2841
 Site-SVHN      | Val  Loss: 1.7590 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.0086 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 1.9102 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.9804 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.7796 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.8386 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.9315 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.9043 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8490 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1350 | Val  Acc: 0.1356
Average Valid Accuracy: 0.5373
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-SVHN      | Train Loss: 1.9742 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8219 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.8253 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.7460 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.7407 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.7864 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.6930 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.6903 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.7017 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.9361 | Train Acc: 0.2955
 Site-SVHN      | Val  Loss: 1.6590 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.9447 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.8501 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.9138 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.6544 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7181 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.7887 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 0.7585 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.7671 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0917 | Val  Acc: 0.1864
Average Valid Accuracy: 0.5576
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2203
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.8136
 Best site-USPS       | Epoch:4 | Val Acc: 0.8305
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-SVHN      | Train Loss: 1.9264 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7733 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.7579 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.7090 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.6512 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6756 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.6257 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5812 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.5886 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.8704 | Train Acc: 0.3068
 Site-SVHN      | Val  Loss: 1.5879 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.8814 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8012 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.8582 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.5599 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6275 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.6781 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.6500 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6854 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0591 | Val  Acc: 0.1864
Average Valid Accuracy: 0.5831
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2881
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.8475
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-SVHN      | Train Loss: 1.8924 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6921 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.7237 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.6778 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.5998 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5648 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5329 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5224 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4723 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.7821 | Train Acc: 0.3409
 Site-SVHN      | Val  Loss: 1.5267 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.8346 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7578 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.8139 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.4757 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.5506 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5858 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5640 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.6405 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0002 | Val  Acc: 0.1864
Average Valid Accuracy: 0.6000
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3220
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-USPS       | Epoch:6 | Val Acc: 0.8644
 Best site-USPS       | Epoch:6 | Val Acc: 0.8644
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-SVHN      | Train Loss: 1.8420 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6802 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.6236 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.6426 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.4772 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5098 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4805 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4366 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.4671 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.7177 | Train Acc: 0.3977
 Site-SVHN      | Val  Loss: 1.4647 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.7813 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7109 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.7668 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.4098 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4940 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5099 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4891 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.5764 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9572 | Val  Acc: 0.2881
Average Valid Accuracy: 0.6203
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3390
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.8644
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-SVHN      | Train Loss: 1.7897 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.5856 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5805 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.5690 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.4314 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4177 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.4224 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.3644 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.3682 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.6621 | Train Acc: 0.4205
 Site-SVHN      | Val  Loss: 1.4207 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.7303 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6618 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.7104 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.3567 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.4448 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.4423 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.4266 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.5242 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.8985 | Val  Acc: 0.3051
Average Valid Accuracy: 0.6271
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3390
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-USPS       | Epoch:8 | Val Acc: 0.8644
 Best site-USPS       | Epoch:8 | Val Acc: 0.9322
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-SVHN      | Train Loss: 1.7546 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5801 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5287 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.5547 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.3815 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4027 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3963 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3400 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.3192 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.5809 | Train Acc: 0.4773
 Site-SVHN      | Val  Loss: 1.3734 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.6683 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6188 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6508 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.3109 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.4074 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.3901 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.3839 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.4690 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8609 | Val  Acc: 0.3390
Average Valid Accuracy: 0.6458
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3559
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-USPS       | Epoch:9 | Val Acc: 0.8814
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST...
===2023-03-30 03:19:28===
===2023-03-30 03:19:29===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST: 0.6457
Average Test Accuracy: 0.6457
