===2023-04-22 21:53:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.9309 | Train Acc: 0.5593
 Site-MNIST     | Train Loss: 1.8817 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.2172 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2006 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.8125 | Train Acc: 0.6154
 Site-USPS      | Train Loss: 1.8166 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1804 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.1331 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.2425 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 2.1700 | Train Acc: 0.2414
 Site-MNIST     | Val  Loss: 1.8713 | Val  Acc: 0.5641
 Site-MNIST     | Val  Loss: 1.8587 | Val  Acc: 0.5897
 Site-SVHN      | Val  Loss: 2.2390 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1992 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 1.8549 | Val  Acc: 0.6176
 Site-USPS      | Val  Loss: 1.8427 | Val  Acc: 0.5942
 Site-SynthDigits| Val  Loss: 2.0693 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.1112 | Val  Acc: 0.3276
 Site-MNIST-M   | Val  Loss: 2.2517 | Val  Acc: 0.3158
 Site-MNIST-M   | Val  Loss: 2.1847 | Val  Acc: 0.2308
Average Valid Accuracy: 0.4176
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5641
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5897
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2449
 Best site-USPS       | Epoch:0 | Val Acc: 0.6176
 Best site-USPS       | Epoch:0 | Val Acc: 0.5942
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3276
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3158
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.6482 | Train Acc: 0.5424
 Site-MNIST     | Train Loss: 1.5244 | Train Acc: 0.7712
 Site-SVHN      | Train Loss: 2.1986 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1097 | Train Acc: 0.2838
 Site-USPS      | Train Loss: 1.3900 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 1.4491 | Train Acc: 0.7404
 Site-SynthDigits| Train Loss: 2.0463 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.0095 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.2039 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 2.0793 | Train Acc: 0.3448
 Site-MNIST     | Val  Loss: 1.5710 | Val  Acc: 0.7179
 Site-MNIST     | Val  Loss: 1.5185 | Val  Acc: 0.7692
 Site-SVHN      | Val  Loss: 2.1583 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1239 | Val  Acc: 0.2653
 Site-USPS      | Val  Loss: 1.4694 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.4332 | Val  Acc: 0.7536
 Site-SynthDigits| Val  Loss: 1.9147 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9672 | Val  Acc: 0.3966
 Site-MNIST-M   | Val  Loss: 2.1729 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 2.1028 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5118
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7179
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7692
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2653
 Best site-USPS       | Epoch:1 | Val Acc: 0.7353
 Best site-USPS       | Epoch:1 | Val Acc: 0.7536
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3966
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4211
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.4356 | Train Acc: 0.6441
 Site-MNIST     | Train Loss: 1.2663 | Train Acc: 0.7881
 Site-SVHN      | Train Loss: 2.1431 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0610 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.0535 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.1822 | Train Acc: 0.7788
 Site-SynthDigits| Train Loss: 1.9390 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.8624 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1724 | Train Acc: 0.1034
 Site-MNIST-M   | Train Loss: 2.0112 | Train Acc: 0.3621
 Site-MNIST     | Val  Loss: 1.3189 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.2491 | Val  Acc: 0.7949
 Site-SVHN      | Val  Loss: 2.0968 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0835 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 1.1161 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.1150 | Val  Acc: 0.8116
 Site-SynthDigits| Val  Loss: 1.7592 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8193 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.0638 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 2.0359 | Val  Acc: 0.3846
Average Valid Accuracy: 0.5832
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7949
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3673
 Best site-USPS       | Epoch:2 | Val Acc: 0.7353
 Best site-USPS       | Epoch:2 | Val Acc: 0.8116
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.2455 | Train Acc: 0.7288
 Site-MNIST     | Train Loss: 1.1026 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1537 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0148 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.0302 | Train Acc: 0.7885
 Site-USPS      | Train Loss: 1.0154 | Train Acc: 0.7692
 Site-SynthDigits| Train Loss: 1.8938 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.7556 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.1151 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.9493 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.1438 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.0898 | Val  Acc: 0.8205
 Site-SVHN      | Val  Loss: 2.0732 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.0371 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.9515 | Val  Acc: 0.7059
 Site-USPS      | Val  Loss: 0.9843 | Val  Acc: 0.7681
 Site-SynthDigits| Val  Loss: 1.6728 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.7241 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.9887 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.9595 | Val  Acc: 0.4359
Average Valid Accuracy: 0.5775
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.0757 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.9649 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1105 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9483 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.9135 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 0.8702 | Train Acc: 0.7981
 Site-SynthDigits| Train Loss: 1.8626 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.7233 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0945 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.8974 | Train Acc: 0.4138
 Site-MNIST     | Val  Loss: 1.0120 | Val  Acc: 0.7949
 Site-MNIST     | Val  Loss: 0.9623 | Val  Acc: 0.8077
 Site-SVHN      | Val  Loss: 1.9921 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9738 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.8759 | Val  Acc: 0.7059
 Site-USPS      | Val  Loss: 0.8804 | Val  Acc: 0.7971
 Site-SynthDigits| Val  Loss: 1.6141 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.6614 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.9704 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.9019 | Val  Acc: 0.4359
Average Valid Accuracy: 0.5896
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7949
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8077
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3673
 Best site-USPS       | Epoch:4 | Val Acc: 0.7059
 Best site-USPS       | Epoch:4 | Val Acc: 0.7971
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.9759 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.8823 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1073 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9094 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.7683 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.7657 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7956 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.6850 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.0823 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 1.8576 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.9127 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.8546 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.9324 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9556 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.7515 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 0.7483 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.5458 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 1.5969 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.9300 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.8510 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6035
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3469
 Best site-USPS       | Epoch:5 | Val Acc: 0.7647
 Best site-USPS       | Epoch:5 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.9151 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.8030 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0776 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8582 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.6686 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.7079 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7575 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.6040 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 2.0568 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 1.7873 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.8695 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.7936 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.8739 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9176 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.6531 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 0.6572 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.5018 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.5464 | Val  Acc: 0.5345
 Site-MNIST-M   | Val  Loss: 1.8948 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.8036 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6112
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3673
 Best site-USPS       | Epoch:6 | Val Acc: 0.7647
 Best site-USPS       | Epoch:6 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5345
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.8459 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.7639 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.0585 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.8352 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.7193 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.6115 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.7465 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.5652 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0160 | Train Acc: 0.2414
 Site-MNIST-M   | Train Loss: 1.7287 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 0.7460 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 0.7201 | Val  Acc: 0.8205
 Site-SVHN      | Val  Loss: 1.8348 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.8942 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.5625 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 0.5862 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.4502 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.4868 | Val  Acc: 0.5690
 Site-MNIST-M   | Val  Loss: 1.8545 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.7581 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6173
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8205
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3673
 Best site-USPS       | Epoch:7 | Val Acc: 0.7941
 Best site-USPS       | Epoch:7 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5690
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.7997 | Train Acc: 0.7797
 Site-MNIST     | Train Loss: 0.6995 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1302 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.7703 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.6539 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.5851 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6912 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.5148 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.9908 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7145 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 0.6881 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.6704 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.7845 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8759 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.5117 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 0.5204 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.4117 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.4515 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.8532 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.7306 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6539
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3878
 Best site-USPS       | Epoch:8 | Val Acc: 0.7941
 Best site-USPS       | Epoch:8 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.7353 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 0.6324 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0488 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 1.7324 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 0.6085 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.5231 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.6462 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4638 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.9937 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.6320 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.6418 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.6264 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.7524 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8411 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.4699 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.4834 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.3657 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.4003 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7941 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.6760 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6779
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3878
 Best site-USPS       | Epoch:9 | Val Acc: 0.8529
 Best site-USPS       | Epoch:9 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7429
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2327
 Test site-USPS      | Epoch:9 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3929
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2500
Average Test Accuracy: 0.4904
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.7209 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.6433 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0503 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6903 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 0.5163 | Train Acc: 0.8269
 Site-USPS      | Train Loss: 0.4739 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.5904 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4075 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.9702 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.5911 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.6335 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.6085 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.6866 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.8441 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.4481 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 0.4531 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.3504 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.3695 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7754 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.6470 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6718
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.7161 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.5614 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0141 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.6647 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.5812 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.4404 | Train Acc: 0.8942
 Site-SynthDigits| Train Loss: 1.5971 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.4108 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.9470 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.5771 | Train Acc: 0.4138
 Site-MNIST     | Val  Loss: 0.5704 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.5739 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.6187 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.8139 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.4241 | Val  Acc: 0.8235
 Site-USPS      | Val  Loss: 0.4271 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.3327 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.3383 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7670 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.6113 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6808
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:11 | Val Acc: 0.4082
 Best site-USPS       | Epoch:11 | Val Acc: 0.8235
 Best site-USPS       | Epoch:11 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.6406 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.5525 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0321 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6339 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.4695 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4291 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5738 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3890 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.9320 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.5332 | Train Acc: 0.4655
 Site-MNIST     | Val  Loss: 0.5279 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.5272 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.6139 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7925 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.3806 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3741 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.3128 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.3056 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.6910 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.5475 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7007
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4082
 Best site-USPS       | Epoch:12 | Val Acc: 0.8824
 Best site-USPS       | Epoch:12 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.6426 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.5206 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0749 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.6152 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5317 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4048 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5404 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.2724 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.9132 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.5472 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.4990 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.5042 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.5708 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.7562 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.3630 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3666 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2685 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.2581 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.6591 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.5196 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7159
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:13 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:13 | Val Acc: 0.4082
 Best site-USPS       | Epoch:13 | Val Acc: 0.8824
 Best site-USPS       | Epoch:13 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7241
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.5817 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.4702 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.9563 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6025 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.4344 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3539 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5932 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2887 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.8861 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.5191 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.4686 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.4686 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.5804 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7463 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.3404 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3339 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2512 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.2382 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.6324 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.4833 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7249
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4286
 Best site-USPS       | Epoch:14 | Val Acc: 0.8824
 Best site-USPS       | Epoch:14 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7069
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.5849 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.4623 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0477 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5631 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.4782 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.3284 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5434 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2231 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.8978 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.4587 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.4856 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.4724 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.5380 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7438 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.3089 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3013 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2473 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1962 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.5539 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.4574 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7277
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4490
 Best site-USPS       | Epoch:15 | Val Acc: 0.8824
 Best site-USPS       | Epoch:15 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7241
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.5360 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.4442 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.1181 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.5546 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.3594 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3436 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5183 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.1719 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.8976 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.4486 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.4259 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4314 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.5378 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7320 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.3268 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3150 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2189 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1802 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.5505 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.4311 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7230
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.5129 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.4092 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0574 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5304 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.3452 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.3147 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.5143 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.1846 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.8950 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.4275 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.4084 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4160 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5202 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6796 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.2951 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2821 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1892 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1541 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.5029 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.4098 | Val  Acc: 0.4615
Average Valid Accuracy: 0.7204
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.5102 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.4403 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9540 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5138 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.4102 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3230 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5095 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2073 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8688 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.3729 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.3978 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.4108 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.4817 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6714 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2833 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.2678 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.2031 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.1481 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.4830 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.3782 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7288
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:18 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4898
 Best site-USPS       | Epoch:18 | Val Acc: 0.8529
 Best site-USPS       | Epoch:18 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4621 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3791 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.0065 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.4808 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.3657 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3078 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5138 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.1420 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.8957 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.3232 | Train Acc: 0.5345
 Site-MNIST     | Val  Loss: 0.3774 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3868 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4680 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6385 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.2731 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2559 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.1598 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1188 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4427 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.3338 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7202
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.4694 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3916 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.0200 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.4739 | Train Acc: 0.5541
 Site-USPS      | Train Loss: 0.3416 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2857 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.4872 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.1219 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.8814 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.3257 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3718 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.3869 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4303 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6173 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2681 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2575 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.1228 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0912 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.4384 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.3043 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7511
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4898
 Best site-USPS       | Epoch:20 | Val Acc: 0.8824
 Best site-USPS       | Epoch:20 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7241
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.4286 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3633 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9591 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.4359 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.3257 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2550 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4799 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.0751 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8689 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2770 | Train Acc: 0.5690
 Site-MNIST     | Val  Loss: 0.3610 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3704 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4224 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5750 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.2576 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2435 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.0913 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0479 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.4172 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2817 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7447
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.4236 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3633 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9536 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.4224 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3489 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2624 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5122 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.0332 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.9034 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2719 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3534 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3561 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.4197 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5540 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.2366 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2204 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.0867 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0267 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.3680 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2545 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7499
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.4341 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.3543 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8323 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.3983 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3449 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2453 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.4314 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0508 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8815 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2713 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3368 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3380 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3681 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5352 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.2397 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2161 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0946 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0323 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3691 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2420 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7526
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:23 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4694
 Best site-USPS       | Epoch:23 | Val Acc: 0.9118
 Best site-USPS       | Epoch:23 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4526 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3441 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9319 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.3738 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3880 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2289 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.4587 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0027 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.8505 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2221 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3248 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3375 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.3632 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.5071 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.2201 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.2051 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.0469 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9901 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 1.3035 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1876 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7766
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:24 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:24 | Val Acc: 0.4694
 Best site-USPS       | Epoch:24 | Val Acc: 0.9412
 Best site-USPS       | Epoch:24 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8103
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.4226 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.3095 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8900 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.3627 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2925 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2336 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4609 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.0036 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.8845 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.1812 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.3238 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3308 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3235 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5064 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.2230 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2075 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0482 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9857 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2918 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1662 | Val  Acc: 0.6410
Average Valid Accuracy: 0.7807
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:25 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:25 | Val Acc: 0.5102
 Best site-USPS       | Epoch:25 | Val Acc: 0.9118
 Best site-USPS       | Epoch:25 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.6410
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.4183 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3670 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.9072 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.3508 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.3353 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2389 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.4346 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.9862 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.8894 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.1409 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.3106 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3205 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3377 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5088 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.2195 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2034 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.0524 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9872 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.2764 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1486 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7754
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.4204 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.3235 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9454 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3016 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2850 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2024 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.3491 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 0.9387 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.8439 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.1192 | Train Acc: 0.6552
 Site-MNIST     | Val  Loss: 0.3052 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3236 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2942 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.4960 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2061 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1943 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.0291 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9684 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2776 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1245 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7903
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:27 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:27 | Val Acc: 0.4898
 Best site-USPS       | Epoch:27 | Val Acc: 0.9412
 Best site-USPS       | Epoch:27 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.3889 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3249 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9836 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.3089 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.2483 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.2235 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.3869 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.9376 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 1.9085 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.1235 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2991 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3099 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3015 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4927 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2137 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.1976 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0174 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9445 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 1.2371 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1010 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7813
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3901 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2978 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8894 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.3012 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2712 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.2224 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.3778 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.9235 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.8820 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.1036 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2917 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3117 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2531 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.4656 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2064 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1912 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.0028 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9308 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.2383 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.0821 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7786
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.3555 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2757 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.9721 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.2765 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.2564 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2116 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.3769 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.9103 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.9076 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.0710 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.2840 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2887 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2708 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.4547 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.1864 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.1649 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 0.9803 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9169 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2094 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 1.0629 | Val  Acc: 0.7179
Average Valid Accuracy: 0.7785
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.3747 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2807 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9433 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.2776 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.2801 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1987 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.4059 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.8765 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.8590 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.0638 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.2847 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2889 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2368 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.4184 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.1832 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1645 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9620 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9011 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 1.1772 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 1.0446 | Val  Acc: 0.7179
Average Valid Accuracy: 0.7868
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.3538 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2695 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7857 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.2614 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2200 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1917 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3767 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.8547 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.8471 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.0309 | Train Acc: 0.7241
 Site-MNIST     | Val  Loss: 0.2727 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2752 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2257 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4177 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.1816 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1601 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9666 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8932 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.1586 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 1.0242 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8006
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:32 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:32 | Val Acc: 0.4898
 Best site-USPS       | Epoch:32 | Val Acc: 0.9412
 Best site-USPS       | Epoch:32 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.3654 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2792 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9261 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.2530 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.2353 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1742 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3823 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.8345 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.8230 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.0471 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.3025 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.2903 | Val  Acc: 0.9231
 Site-SVHN      | Val  Loss: 1.2197 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4010 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.1588 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1414 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9451 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8627 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0959 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 0.9973 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7807
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3685 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.2984 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0113 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.2238 | Train Acc: 0.6351
 Site-USPS      | Train Loss: 0.2420 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1799 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3472 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.8657 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.8339 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.9955 | Train Acc: 0.7241
 Site-MNIST     | Val  Loss: 0.2945 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2902 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.1908 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.4084 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.1627 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1466 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9541 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8703 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0818 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9773 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8216
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:34 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:34 | Val Acc: 0.5510
 Best site-USPS       | Epoch:34 | Val Acc: 0.9706
 Best site-USPS       | Epoch:34 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.3572 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2581 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8010 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1928 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.2460 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1578 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3701 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.8561 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.8365 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.9753 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.2863 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2745 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1757 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.3888 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.1575 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1384 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9514 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8711 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0694 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 0.9536 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8026
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.3361 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.2416 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.9665 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1489 | Train Acc: 0.6351
 Site-USPS      | Train Loss: 0.2584 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1444 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.4041 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.8712 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.8136 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.9569 | Train Acc: 0.7241
 Site-MNIST     | Val  Loss: 0.2747 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2646 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1638 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.3923 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.1442 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1256 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9341 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8614 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0424 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9349 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8185
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.3450 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2422 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8993 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1535 | Train Acc: 0.6622
 Site-USPS      | Train Loss: 0.2305 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1415 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3399 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.8391 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.8389 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.9478 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2532 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1235 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.3817 | Val  Acc: 0.5918
 Site-USPS      | Val  Loss: 0.1373 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1246 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9280 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8514 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0351 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9208 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8270
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:37 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:37 | Val Acc: 0.5918
 Best site-USPS       | Epoch:37 | Val Acc: 0.9706
 Best site-USPS       | Epoch:37 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.3145 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2304 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8011 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1460 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.1911 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1784 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.3742 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.7940 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.8352 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.9330 | Train Acc: 0.7414
 Site-MNIST     | Val  Loss: 0.2509 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2563 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1361 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.4059 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.1602 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1463 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9036 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8296 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0080 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9041 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8256
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.3338 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2195 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7630 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.1390 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.1950 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1544 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3267 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.8150 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.8052 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.9012 | Train Acc: 0.7414
 Site-MNIST     | Val  Loss: 0.2412 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2428 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1302 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.3591 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.1404 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1244 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9174 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8332 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9907 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.8828 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8308
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:39 | Val Acc: 0.6250
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5714
 Best site-USPS       | Epoch:39 | Val Acc: 0.9706
 Best site-USPS       | Epoch:39 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8200
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2599
 Test site-USPS      | Epoch:39 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.4385
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.2379
Average Test Accuracy: 0.5276
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.3379 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2229 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8171 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.1301 | Train Acc: 0.6757
 Site-USPS      | Train Loss: 0.1817 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1438 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3339 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.7860 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 1.8072 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8981 | Train Acc: 0.7586
 Site-MNIST     | Val  Loss: 0.2420 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2458 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.0982 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3413 | Val  Acc: 0.5918
 Site-USPS      | Val  Loss: 0.1386 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1253 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8944 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8055 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9466 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8584 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8436
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:40 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:40 | Val Acc: 0.5918
 Best site-USPS       | Epoch:40 | Val Acc: 0.9706
 Best site-USPS       | Epoch:40 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.7692
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.3378 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2642 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7868 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.0871 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 0.1932 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1630 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3609 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.7550 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.8265 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8955 | Train Acc: 0.7586
 Site-MNIST     | Val  Loss: 0.2294 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2414 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.0956 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3403 | Val  Acc: 0.6122
 Site-USPS      | Val  Loss: 0.1462 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1351 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8576 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7861 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.9253 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8397 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8473
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:41 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:41 | Val Acc: 0.6122
 Best site-USPS       | Epoch:41 | Val Acc: 0.9706
 Best site-USPS       | Epoch:41 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.7692
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.3162 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2182 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.8174 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.0738 | Train Acc: 0.6757
 Site-USPS      | Train Loss: 0.2863 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1484 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3263 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.7547 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.7852 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8706 | Train Acc: 0.7759
 Site-MNIST     | Val  Loss: 0.2056 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2169 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.0580 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3162 | Val  Acc: 0.5918
 Site-USPS      | Val  Loss: 0.1356 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1215 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8674 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7939 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9293 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8179 | Val  Acc: 0.7949
Average Valid Accuracy: 0.8513
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9615
 Best site-SVHN       | Epoch:42 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:42 | Val Acc: 0.5918
 Best site-USPS       | Epoch:42 | Val Acc: 0.9706
 Best site-USPS       | Epoch:42 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.7949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.3025 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.2120 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8197 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.0647 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 0.2238 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1386 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3318 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.7612 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.8292 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.8579 | Train Acc: 0.7759
 Site-MNIST     | Val  Loss: 0.2034 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2107 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.0499 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3222 | Val  Acc: 0.6122
 Site-USPS      | Val  Loss: 0.1280 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1140 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8654 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7845 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.8895 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8022 | Val  Acc: 0.7949
Average Valid Accuracy: 0.8533
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9615
 Best site-SVHN       | Epoch:43 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:43 | Val Acc: 0.6122
 Best site-USPS       | Epoch:43 | Val Acc: 0.9706
 Best site-USPS       | Epoch:43 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.7949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.2932 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2181 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8096 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.0585 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.1821 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1487 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3411 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.7381 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.8247 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8390 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.1923 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2040 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0516 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3442 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 0.1282 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1154 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8588 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.7739 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.8550 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.7882 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8593
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9744
 Best site-SVHN       | Epoch:44 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:44 | Val Acc: 0.6327
 Best site-USPS       | Epoch:44 | Val Acc: 0.9706
 Best site-USPS       | Epoch:44 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.8205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.3376 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.1976 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8936 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.0447 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 0.1927 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1300 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3114 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.7944 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.8175 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.8103 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.1884 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2006 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0537 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3250 | Val  Acc: 0.6122
 Site-USPS      | Val  Loss: 0.1207 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1087 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8538 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7756 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.8650 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7769 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8571
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.3044 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.1932 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.7612 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.0408 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.1609 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1320 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3411 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.7311 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.7743 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.7897 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.1894 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2005 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0409 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.3043 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 0.1193 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1057 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8394 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7487 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.8476 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7628 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8651
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9744
 Best site-SVHN       | Epoch:46 | Val Acc: 0.7083
 Best site-SVHN       | Epoch:46 | Val Acc: 0.6327
 Best site-USPS       | Epoch:46 | Val Acc: 0.9706
 Best site-USPS       | Epoch:46 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.8205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.3138 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.1936 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8313 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.0408 | Train Acc: 0.7162
 Site-USPS      | Train Loss: 0.1597 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1252 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3416 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.8050 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.7849 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.7921 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.1855 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.1926 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.0179 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.2975 | Val  Acc: 0.6531
 Site-USPS      | Val  Loss: 0.1098 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0961 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8364 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7504 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.8377 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7507 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8615
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.2893 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.1857 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8620 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.0148 | Train Acc: 0.7162
 Site-USPS      | Train Loss: 0.1770 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1392 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3309 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.6897 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.8070 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.8086 | Train Acc: 0.8276
 Site-MNIST     | Val  Loss: 0.1863 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.1980 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.0038 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.2911 | Val  Acc: 0.6531
 Site-USPS      | Val  Loss: 0.1231 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1082 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8006 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7254 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.8386 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.7387 | Val  Acc: 0.8462
Average Valid Accuracy: 0.8694
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9615
 Best site-SVHN       | Epoch:48 | Val Acc: 0.7083
 Best site-SVHN       | Epoch:48 | Val Acc: 0.6531
 Best site-USPS       | Epoch:48 | Val Acc: 0.9706
 Best site-USPS       | Epoch:48 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.8462
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3373 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2430 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.6867 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.0101 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 0.1709 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.1255 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.3587 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.7179 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.8518 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.7626 | Train Acc: 0.8276
 Site-MNIST     | Val  Loss: 0.1989 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2055 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.0153 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.2629 | Val  Acc: 0.6122
 Site-USPS      | Val  Loss: 0.1211 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1090 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8065 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7169 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.7977 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.7226 | Val  Acc: 0.8462
Average Valid Accuracy: 0.8587
===2023-04-22 22:43:41===
===2023-04-22 22:43:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8264
 Test site-SVHN      | Epoch:48 | Test Acc: 0.2625
 Test site-USPS      | Epoch:48 | Test Acc: 0.8871
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.4371
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.2307
Average Test Accuracy: 0.5288
===2023-04-22 22:50:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.8983 | Train Acc: 0.7119
 Site-MNIST     | Train Loss: 1.8948 | Train Acc: 0.6525
 Site-SVHN      | Train Loss: 2.2642 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2163 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.7681 | Train Acc: 0.6346
 Site-USPS      | Train Loss: 1.7650 | Train Acc: 0.7019
 Site-SynthDigits| Train Loss: 2.2082 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.1422 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.2294 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 2.1917 | Train Acc: 0.2586
 Site-MNIST     | Val  Loss: 1.9416 | Val  Acc: 0.5897
 Site-MNIST     | Val  Loss: 1.8958 | Val  Acc: 0.6538
 Site-SVHN      | Val  Loss: 2.1977 | Val  Acc: 0.2917
 Site-SVHN      | Val  Loss: 2.2092 | Val  Acc: 0.2245
 Site-USPS      | Val  Loss: 1.7669 | Val  Acc: 0.6471
 Site-USPS      | Val  Loss: 1.7742 | Val  Acc: 0.7101
 Site-SynthDigits| Val  Loss: 2.0995 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1266 | Val  Acc: 0.3276
 Site-MNIST-M   | Val  Loss: 2.2726 | Val  Acc: 0.3158
 Site-MNIST-M   | Val  Loss: 2.1909 | Val  Acc: 0.3077
Average Valid Accuracy: 0.4447
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5897
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6538
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2917
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2245
 Best site-USPS       | Epoch:0 | Val Acc: 0.6471
 Best site-USPS       | Epoch:0 | Val Acc: 0.7101
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3276
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3158
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.4567 | Train Acc: 0.7458
 Site-MNIST     | Train Loss: 1.3780 | Train Acc: 0.7966
 Site-SVHN      | Train Loss: 2.2021 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 2.1562 | Train Acc: 0.2838
 Site-USPS      | Train Loss: 1.3101 | Train Acc: 0.7115
 Site-USPS      | Train Loss: 1.3245 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 2.0243 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.0075 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.2233 | Train Acc: 0.1724
 Site-MNIST-M   | Train Loss: 2.0911 | Train Acc: 0.3621
 Site-MNIST     | Val  Loss: 1.4346 | Val  Acc: 0.7179
 Site-MNIST     | Val  Loss: 1.3667 | Val  Acc: 0.7821
 Site-SVHN      | Val  Loss: 2.0999 | Val  Acc: 0.4167
 Site-SVHN      | Val  Loss: 2.1426 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.2628 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 1.2811 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.9571 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 1.9713 | Val  Acc: 0.4310
 Site-MNIST-M   | Val  Loss: 2.1490 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 2.1087 | Val  Acc: 0.3846
Average Valid Accuracy: 0.5600
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7179
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7821
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4167
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2857
 Best site-USPS       | Epoch:1 | Val Acc: 0.7941
 Best site-USPS       | Epoch:1 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4310
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4211
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.1157 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 1.0889 | Train Acc: 0.8305
 Site-SVHN      | Train Loss: 2.2264 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0393 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 1.0353 | Train Acc: 0.7885
 Site-USPS      | Train Loss: 1.0271 | Train Acc: 0.8269
 Site-SynthDigits| Train Loss: 1.8834 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.8746 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 2.1703 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.9909 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.0845 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 1.0322 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.9916 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0732 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.9673 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 1.0006 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.7729 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8258 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 2.1078 | Val  Acc: 0.3684
 Site-MNIST-M   | Val  Loss: 2.0189 | Val  Acc: 0.4103
Average Valid Accuracy: 0.5965
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4082
 Best site-USPS       | Epoch:2 | Val Acc: 0.7647
 Best site-USPS       | Epoch:2 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3684
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 0.9108 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 0.9027 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.1447 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.9712 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.8262 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 0.8123 | Train Acc: 0.9231
 Site-SynthDigits| Train Loss: 1.7728 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.7386 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.1160 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.8717 | Train Acc: 0.4310
 Site-MNIST     | Val  Loss: 0.9322 | Val  Acc: 0.7949
 Site-MNIST     | Val  Loss: 0.8594 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.8982 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0090 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.7553 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.8036 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.5948 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.6595 | Val  Acc: 0.5345
 Site-MNIST-M   | Val  Loss: 2.0455 | Val  Acc: 0.3684
 Site-MNIST-M   | Val  Loss: 1.9413 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6240
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7949
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4490
 Best site-USPS       | Epoch:3 | Val Acc: 0.9118
 Best site-USPS       | Epoch:3 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5345
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3684
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.7937 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.7429 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.1020 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.9177 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.7940 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.6689 | Train Acc: 0.8942
 Site-SynthDigits| Train Loss: 1.6828 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.6013 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.9908 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.8001 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.7472 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.7039 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.8095 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.9920 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.6471 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.6705 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.5056 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5770 | Val  Acc: 0.5172
 Site-MNIST-M   | Val  Loss: 1.9268 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.8399 | Val  Acc: 0.5128
Average Valid Accuracy: 0.6686
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4490
 Best site-USPS       | Epoch:4 | Val Acc: 0.8529
 Best site-USPS       | Epoch:4 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5172
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.6937 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.6220 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.1333 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8477 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.6959 | Train Acc: 0.8269
 Site-USPS      | Train Loss: 0.5735 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.5878 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.5447 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 2.0020 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7227 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.6622 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.6096 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.7052 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9615 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.5426 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.5736 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.4451 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.5003 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.9307 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.8008 | Val  Acc: 0.5385
Average Valid Accuracy: 0.6863
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4082
 Best site-USPS       | Epoch:5 | Val Acc: 0.8824
 Best site-USPS       | Epoch:5 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.5875 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.5382 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0180 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8082 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.5797 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 0.5081 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.5172 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.4876 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 2.0067 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.6587 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.5675 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.5286 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.6620 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.9160 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.4753 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.4979 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.3833 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4333 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.8825 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.7353 | Val  Acc: 0.5641
Average Valid Accuracy: 0.6833
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.5451 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.5186 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9305 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.7234 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.7167 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4736 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4975 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3986 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.9593 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.5808 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.5048 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4698 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5725 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.8861 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.4321 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.4587 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.3486 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3696 | Val  Acc: 0.5690
 Site-MNIST-M   | Val  Loss: 1.7883 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.6560 | Val  Acc: 0.5385
Average Valid Accuracy: 0.6952
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4490
 Best site-USPS       | Epoch:7 | Val Acc: 0.9118
 Best site-USPS       | Epoch:7 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5690
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.4982 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.4494 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 1.9988 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6588 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.5608 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4078 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4646 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3753 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 2.0050 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.5491 | Train Acc: 0.5517
 Site-MNIST     | Val  Loss: 0.4735 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 0.4373 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.5135 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.8443 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.3697 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.3891 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.3038 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.3282 | Val  Acc: 0.6724
 Site-MNIST-M   | Val  Loss: 1.7486 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.6111 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7212
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4898
 Best site-USPS       | Epoch:8 | Val Acc: 0.9412
 Best site-USPS       | Epoch:8 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6724
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.4373 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.4193 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9119 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6401 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.3969 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3744 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4620 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3200 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.9114 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.4262 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.4076 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.3932 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4482 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.8178 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.3709 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.3727 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.2774 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.2799 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.7040 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.5562 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7517
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6250
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5102
 Best site-USPS       | Epoch:9 | Val Acc: 0.9118
 Best site-USPS       | Epoch:9 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6923
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.3656 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.3526 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9179 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5606 | Train Acc: 0.5541
 Site-USPS      | Train Loss: 0.4519 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3559 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4063 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.2362 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.9125 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.4119 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.3750 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3577 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.4151 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.8003 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.3427 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.3481 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.2689 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.2448 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.6915 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.5089 | Val  Acc: 0.6410
Average Valid Accuracy: 0.7389
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.3403 | Train Acc: 0.9492
 Site-MNIST     | Train Loss: 0.3536 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.9006 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.4949 | Train Acc: 0.5541
 Site-USPS      | Train Loss: 0.5686 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3243 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.3774 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.2008 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.8957 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.3650 | Train Acc: 0.6207
 Site-MNIST     | Val  Loss: 0.3276 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3219 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.3278 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7312 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.3169 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.3255 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1994 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1927 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.6465 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.4644 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7414
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.3253 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2929 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8811 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.5252 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.3423 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.2828 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.3953 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.1753 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.8725 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.2889 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.3040 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2907 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.3361 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.7487 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.2772 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2655 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.2065 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1890 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.5618 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.3717 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7606
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5714
 Best site-USPS       | Epoch:12 | Val Acc: 0.9118
 Best site-USPS       | Epoch:12 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6923
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.2965 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2721 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.9032 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.4999 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.4482 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2635 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.4106 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.1170 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.8684 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.2343 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.2779 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2668 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.3292 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.7051 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.2529 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2547 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.1421 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1252 | Val  Acc: 0.6724
 Site-MNIST-M   | Val  Loss: 1.4877 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.3115 | Val  Acc: 0.7179
Average Valid Accuracy: 0.7886
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9615
 Best site-SVHN       | Epoch:13 | Val Acc: 0.6250
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5714
 Best site-USPS       | Epoch:13 | Val Acc: 0.9118
 Best site-USPS       | Epoch:13 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6724
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7179
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.3004 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2949 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8540 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.4089 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3706 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2368 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3759 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0881 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.8168 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.1923 | Train Acc: 0.6897
 Site-MNIST     | Val  Loss: 0.2604 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.2549 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2203 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.6365 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.2295 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.2365 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.0750 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0826 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.4950 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.2800 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7795
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.2775 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.2411 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7348 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.3517 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.3212 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2217 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.2795 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.0079 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.8651 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.2209 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2512 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2433 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1749 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5991 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2210 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.2216 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.0511 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0425 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.5123 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.2787 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7863
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.2334 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2052 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.8433 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.3388 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 0.2828 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1998 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.2915 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.0415 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8057 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.0730 | Train Acc: 0.7586
 Site-MNIST     | Val  Loss: 0.2193 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2122 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1458 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.5670 | Val  Acc: 0.6122
 Site-USPS      | Val  Loss: 0.2076 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.2026 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.0420 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0299 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4057 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1716 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8103
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:16 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:16 | Val Acc: 0.6122
 Best site-USPS       | Epoch:16 | Val Acc: 0.9412
 Best site-USPS       | Epoch:16 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7414
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.2425 | Train Acc: 0.9492
 Site-MNIST     | Train Loss: 0.2054 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8264 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.2623 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.2667 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1911 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.2776 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.0029 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8234 | Train Acc: 0.2414
 Site-MNIST-M   | Train Loss: 1.0637 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.2353 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.2097 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 1.1090 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.5252 | Val  Acc: 0.5918
 Site-USPS      | Val  Loss: 0.1806 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1731 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.0545 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0067 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.3206 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1452 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8080
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.1934 | Train Acc: 0.9492
 Site-MNIST     | Train Loss: 0.1690 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.8302 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.2624 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 0.2495 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1879 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.2004 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.9527 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.7668 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 0.9730 | Train Acc: 0.8448
 Site-MNIST     | Val  Loss: 0.1904 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1796 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0990 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.5175 | Val  Acc: 0.6939
 Site-USPS      | Val  Loss: 0.1809 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1727 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.0309 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9885 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.2999 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 1.1008 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8503
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9744
 Best site-SVHN       | Epoch:18 | Val Acc: 0.7083
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6939
 Best site-USPS       | Epoch:18 | Val Acc: 0.9412
 Best site-USPS       | Epoch:18 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.1933 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1609 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.8413 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.2495 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 0.4708 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1915 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.2148 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.8929 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.7942 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 0.9863 | Train Acc: 0.8276
 Site-MNIST     | Val  Loss: 0.1803 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1677 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0657 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.4674 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 0.1658 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1669 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9561 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9247 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.3139 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.0813 | Val  Acc: 0.7949
Average Valid Accuracy: 0.8376
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.1893 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1516 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.8028 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1946 | Train Acc: 0.6757
 Site-USPS      | Train Loss: 0.2400 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1578 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.2118 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.8899 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.7309 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.9510 | Train Acc: 0.8621
 Site-MNIST     | Val  Loss: 0.1748 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.1608 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0458 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.4097 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 0.1573 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1591 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9532 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9152 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.2475 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 1.0165 | Val  Acc: 0.8462
Average Valid Accuracy: 0.8402
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.1762 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1355 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.8877 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.1617 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.2286 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1398 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.1862 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.8631 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.7148 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8923 | Train Acc: 0.8621
 Site-MNIST     | Val  Loss: 0.1507 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1440 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.9956 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3420 | Val  Acc: 0.6939
 Site-USPS      | Val  Loss: 0.1444 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1376 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.9474 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9083 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.2164 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9643 | Val  Acc: 0.8718
Average Valid Accuracy: 0.8560
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9872
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:21 | Val Acc: 0.6939
 Best site-USPS       | Epoch:21 | Val Acc: 0.9412
 Best site-USPS       | Epoch:21 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8718
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.1643 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1403 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.6704 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.1202 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.2093 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1304 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.0997 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.8685 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.8342 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.9013 | Train Acc: 0.8103
 Site-MNIST     | Val  Loss: 0.1444 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.1304 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 0.9749 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 1.3201 | Val  Acc: 0.6735
 Site-USPS      | Val  Loss: 0.1268 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1246 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9483 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9038 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.2100 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 0.9762 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8234
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.1563 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1305 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.7405 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.1137 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 0.2054 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1363 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.1373 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.8331 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.7509 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.8286 | Train Acc: 0.8621
 Site-MNIST     | Val  Loss: 0.1393 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.1255 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.9256 | Val  Acc: 0.7917
 Site-SVHN      | Val  Loss: 1.2730 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 0.1335 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1312 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.8747 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8623 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.2004 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 0.9290 | Val  Acc: 0.8205
Average Valid Accuracy: 0.8599
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9872
 Best site-SVHN       | Epoch:23 | Val Acc: 0.7917
 Best site-SVHN       | Epoch:23 | Val Acc: 0.7551
 Best site-USPS       | Epoch:23 | Val Acc: 0.9412
 Best site-USPS       | Epoch:23 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7759
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.1358 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1018 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7304 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.0583 | Train Acc: 0.7703
 Site-USPS      | Train Loss: 0.2194 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1329 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.0779 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.8026 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.7159 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.7852 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.1156 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1088 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8750 | Val  Acc: 0.7917
 Site-SVHN      | Val  Loss: 1.2439 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 0.1284 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1288 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.8296 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8335 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.1537 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8902 | Val  Acc: 0.8974
Average Valid Accuracy: 0.8872
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7917
 Best site-SVHN       | Epoch:24 | Val Acc: 0.7551
 Best site-USPS       | Epoch:24 | Val Acc: 0.9412
 Best site-USPS       | Epoch:24 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.1572 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1117 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7664 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.0734 | Train Acc: 0.7973
 Site-USPS      | Train Loss: 0.1927 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1132 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.1308 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.7521 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6518 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.7723 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.1200 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1107 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8637 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.2304 | Val  Acc: 0.7755
 Site-USPS      | Val  Loss: 0.1131 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1123 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.8215 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8179 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.0742 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8288 | Val  Acc: 0.8974
Average Valid Accuracy: 0.8851
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.1363 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0969 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6723 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.0151 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 0.2575 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1400 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.0698 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.7331 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.7253 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.7871 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.1094 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0994 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8374 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.1947 | Val  Acc: 0.7755
 Site-USPS      | Val  Loss: 0.1190 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.1145 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 0.7807 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7894 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.0683 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.8422 | Val  Acc: 0.8974
Average Valid Accuracy: 0.8934
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:26 | Val Acc: 0.7755
 Best site-USPS       | Epoch:26 | Val Acc: 0.9412
 Best site-USPS       | Epoch:26 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.1241 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0948 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.6694 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 0.9996 | Train Acc: 0.7973
 Site-USPS      | Train Loss: 0.2173 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0963 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0748 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.7066 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6912 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.7107 | Train Acc: 0.8793
 Site-MNIST     | Val  Loss: 0.1087 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.0939 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.8342 | Val  Acc: 0.7917
 Site-SVHN      | Val  Loss: 1.1550 | Val  Acc: 0.7755
 Site-USPS      | Val  Loss: 0.1033 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0968 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.7812 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7752 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.9697 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7731 | Val  Acc: 0.8718
Average Valid Accuracy: 0.8872
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.1319 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0810 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6827 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.9517 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.1906 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1109 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0372 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.6676 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.7137 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.7048 | Train Acc: 0.9310
 Site-MNIST     | Val  Loss: 0.1010 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0862 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7857 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.0935 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.1029 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0997 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.7590 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7557 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.9841 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7641 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9059
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:28 | Val Acc: 0.8571
 Best site-USPS       | Epoch:28 | Val Acc: 0.9706
 Best site-USPS       | Epoch:28 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1266 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0735 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6328 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.9358 | Train Acc: 0.8243
 Site-USPS      | Train Loss: 0.2027 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0933 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0424 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.7023 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6752 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.6700 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0839 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0751 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7696 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.0457 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 0.0971 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0907 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.7379 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7325 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.9066 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7360 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9019
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.1112 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0667 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6125 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.9284 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.1883 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0950 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0242 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.6887 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.6567 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.6689 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0778 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0688 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7911 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.0474 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.0934 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0909 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7259 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.7165 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.9109 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7166 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9103
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:30 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:30 | Val Acc: 0.8571
 Best site-USPS       | Epoch:30 | Val Acc: 1.0000
 Best site-USPS       | Epoch:30 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.1006 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0670 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7350 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.8812 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.2230 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0861 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.0501 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.6348 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6304 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.6461 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0867 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0734 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7588 | Val  Acc: 0.7917
 Site-SVHN      | Val  Loss: 0.9971 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 0.0782 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0771 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7011 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6900 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.8736 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6924 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9021
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.1073 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0735 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7035 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.8483 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.1826 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0738 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.0257 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.6389 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6081 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.6140 | Train Acc: 0.8793
 Site-MNIST     | Val  Loss: 0.0821 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0689 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7176 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.9710 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.0691 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0675 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7052 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6912 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 0.8344 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.6593 | Val  Acc: 0.8718
Average Valid Accuracy: 0.9067
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.1023 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0592 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7865 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.8421 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.1631 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9612 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 0.6106 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.6607 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.5794 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0672 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0587 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7208 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.9500 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.0720 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0670 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7126 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6877 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 0.7774 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.6290 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9130
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:33 | Val Acc: 0.8750
 Best site-SVHN       | Epoch:33 | Val Acc: 0.8776
 Best site-USPS       | Epoch:33 | Val Acc: 1.0000
 Best site-USPS       | Epoch:33 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8103
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.0941 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0624 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5968 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 0.8244 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2411 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0811 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9757 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5605 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.7237 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.6224 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0631 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6925 | Val  Acc: 0.9167
 Site-SVHN      | Val  Loss: 0.9016 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0723 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0664 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6297 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6237 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.7827 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6614 | Val  Acc: 0.8718
Average Valid Accuracy: 0.9236
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9167
 Best site-SVHN       | Epoch:34 | Val Acc: 0.8980
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.8718
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.0983 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0467 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5875 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.8277 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.1443 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0773 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 0.9447 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.5818 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.7158 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.5576 | Train Acc: 0.9483
 Site-MNIST     | Val  Loss: 0.0564 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0496 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6804 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.9231 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0766 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0673 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.6360 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.6380 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.7889 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.6250 | Val  Acc: 0.9487
Average Valid Accuracy: 0.9315
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:35 | Val Acc: 0.8750
 Best site-SVHN       | Epoch:35 | Val Acc: 0.8980
 Best site-USPS       | Epoch:35 | Val Acc: 0.9706
 Best site-USPS       | Epoch:35 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9487
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.0905 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0475 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5741 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 0.8136 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.1546 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0645 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9418 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5864 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.6314 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.5171 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0528 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6743 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.8861 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0703 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0604 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6613 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6325 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.6570 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5447 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9350
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:36 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:36 | Val Acc: 0.8750
 Best site-SVHN       | Epoch:36 | Val Acc: 0.8980
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-USPS       | Epoch:36 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.0854 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0495 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6727 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 0.7809 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.1571 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0773 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8815 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5204 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.6479 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.5211 | Train Acc: 0.9655
 Site-MNIST     | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0447 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6628 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 0.8640 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.0736 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0653 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5919 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.5808 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.7089 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5807 | Val  Acc: 0.9487
Average Valid Accuracy: 0.9321
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.0702 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0460 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6277 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 0.7631 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.1410 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0768 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9321 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5762 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.6172 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4621 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0453 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6270 | Val  Acc: 0.9167
 Site-SVHN      | Val  Loss: 0.8312 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0758 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6110 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.6047 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.6568 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5206 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9412
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:38 | Val Acc: 0.9167
 Best site-SVHN       | Epoch:38 | Val Acc: 0.9184
 Best site-USPS       | Epoch:38 | Val Acc: 1.0000
 Best site-USPS       | Epoch:38 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0771 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0407 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4526 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.7265 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.1406 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0673 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 0.9041 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.5276 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.6439 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.5250 | Train Acc: 0.9655
 Site-MNIST     | Val  Loss: 0.0464 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0413 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5890 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.8156 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0709 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0628 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.5812 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5734 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.6964 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5606 | Val  Acc: 0.9487
Average Valid Accuracy: 0.9488
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:39 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:39 | Val Acc: 0.9184
 Best site-USPS       | Epoch:39 | Val Acc: 0.9706
 Best site-USPS       | Epoch:39 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9487
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8493
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2791
 Test site-USPS      | Epoch:39 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.5072
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3407
Average Test Accuracy: 0.5716
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0354 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6081 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.7199 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3118 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0613 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9148 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5293 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.6546 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.4890 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6053 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.8171 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0657 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0560 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5538 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5509 | Val  Acc: 0.8793
 Site-MNIST-M   | Val  Loss: 0.6875 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5355 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9574
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:40 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:40 | Val Acc: 0.9184
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-USPS       | Epoch:40 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8793
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.0736 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0345 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6708 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6927 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2037 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0512 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8740 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4999 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 1.6932 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 0.4702 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0376 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0338 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5806 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7796 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.0563 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0485 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5753 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5550 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.6373 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5191 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9640
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:41 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:41 | Val Acc: 0.9592
 Best site-USPS       | Epoch:41 | Val Acc: 1.0000
 Best site-USPS       | Epoch:41 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.0697 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0333 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5179 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.7121 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1467 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0542 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8473 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5149 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 1.6043 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4210 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0357 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0321 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5999 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.8018 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0590 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0507 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5601 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5409 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.5729 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4617 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9670
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9184
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.0674 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0318 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6111 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 0.6859 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1249 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8775 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4938 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.6367 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4196 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5762 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.7772 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0597 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0487 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5869 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.5540 | Val  Acc: 0.8793
 Site-MNIST-M   | Val  Loss: 0.5747 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4552 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9618
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0673 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0330 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5804 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6501 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1247 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0505 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8836 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4645 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 1.6127 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.3988 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0385 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5579 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7464 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0556 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5427 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5314 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.5774 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4475 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9732
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:44 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:44 | Val Acc: 0.9388
 Best site-USPS       | Epoch:44 | Val Acc: 1.0000
 Best site-USPS       | Epoch:44 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:44 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.0611 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0272 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5933 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6723 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1231 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0476 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7991 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4755 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.6570 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4064 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0323 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0286 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5454 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7601 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0452 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0394 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5569 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5337 | Val  Acc: 0.8793
 Site-MNIST-M   | Val  Loss: 0.5449 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.4487 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9636
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.0594 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0242 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5451 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 0.6381 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.1642 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0473 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8068 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4498 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 1.6259 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.3947 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0242 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5403 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7170 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0494 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5398 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5227 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.5663 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.4449 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9660
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.0542 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0301 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6178 | Train Acc: 0.4865
 Site-SVHN      | Train Loss: 0.6412 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2407 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0446 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8114 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4827 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.5458 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.3853 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0257 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5640 | Val  Acc: 0.9167
 Site-SVHN      | Val  Loss: 0.7272 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0400 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0355 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5602 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.5331 | Val  Acc: 0.8793
 Site-MNIST-M   | Val  Loss: 0.5237 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.4188 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9519
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.0538 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0235 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5457 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6363 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1059 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0489 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7619 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.4622 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 1.5744 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.3562 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0241 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5342 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.7280 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0429 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5748 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5354 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.4978 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3934 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9656
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0520 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0239 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5779 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 0.6072 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1520 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0379 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8019 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4626 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.5867 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.3732 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0224 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0218 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5016 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6936 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0372 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0349 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5595 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.5219 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.5290 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.4133 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9660
===2023-04-22 23:43:31===
===2023-04-22 23:43:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8514
 Test site-SVHN      | Epoch:44 | Test Acc: 0.2761
 Test site-USPS      | Epoch:44 | Test Acc: 0.8817
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.5101
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.3436
Average Test Accuracy: 0.5726
===2023-04-23 14:19:49===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.9309 | Train Acc: 0.5593
 Site-MNIST     | Train Loss: 1.8817 | Train Acc: 0.5424
 Site-SVHN      | Train Loss: 2.2172 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2006 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.8125 | Train Acc: 0.6154
 Site-USPS      | Train Loss: 1.8166 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 2.1804 | Train Acc: 0.1818
 Site-SynthDigits| Train Loss: 2.1331 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.2425 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 2.1700 | Train Acc: 0.2414
 Site-MNIST     | Val  Loss: 1.8713 | Val  Acc: 0.5641
 Site-MNIST     | Val  Loss: 1.8587 | Val  Acc: 0.5897
 Site-SVHN      | Val  Loss: 2.2390 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1992 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 1.8549 | Val  Acc: 0.6176
 Site-USPS      | Val  Loss: 1.8427 | Val  Acc: 0.5942
 Site-SynthDigits| Val  Loss: 2.0693 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 2.1112 | Val  Acc: 0.3276
 Site-MNIST-M   | Val  Loss: 2.2517 | Val  Acc: 0.3158
 Site-MNIST-M   | Val  Loss: 2.1847 | Val  Acc: 0.2308
Average Valid Accuracy: 0.4176
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5641
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5897
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2449
 Best site-USPS       | Epoch:0 | Val Acc: 0.6176
 Best site-USPS       | Epoch:0 | Val Acc: 0.5942
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3276
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.3158
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.6482 | Train Acc: 0.5424
 Site-MNIST     | Train Loss: 1.5244 | Train Acc: 0.7712
 Site-SVHN      | Train Loss: 2.1986 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.1097 | Train Acc: 0.2838
 Site-USPS      | Train Loss: 1.3900 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 1.4491 | Train Acc: 0.7404
 Site-SynthDigits| Train Loss: 2.0463 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.0095 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.2039 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 2.0793 | Train Acc: 0.3448
 Site-MNIST     | Val  Loss: 1.5710 | Val  Acc: 0.7179
 Site-MNIST     | Val  Loss: 1.5185 | Val  Acc: 0.7692
 Site-SVHN      | Val  Loss: 2.1583 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1239 | Val  Acc: 0.2653
 Site-USPS      | Val  Loss: 1.4694 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.4332 | Val  Acc: 0.7536
 Site-SynthDigits| Val  Loss: 1.9147 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9672 | Val  Acc: 0.3966
 Site-MNIST-M   | Val  Loss: 2.1729 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 2.1028 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5118
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7179
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7692
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2653
 Best site-USPS       | Epoch:1 | Val Acc: 0.7353
 Best site-USPS       | Epoch:1 | Val Acc: 0.7536
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3966
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4211
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.4356 | Train Acc: 0.6441
 Site-MNIST     | Train Loss: 1.2663 | Train Acc: 0.7881
 Site-SVHN      | Train Loss: 2.1431 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0610 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.0535 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.1822 | Train Acc: 0.7788
 Site-SynthDigits| Train Loss: 1.9390 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.8624 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1724 | Train Acc: 0.1034
 Site-MNIST-M   | Train Loss: 2.0112 | Train Acc: 0.3621
 Site-MNIST     | Val  Loss: 1.3189 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.2491 | Val  Acc: 0.7949
 Site-SVHN      | Val  Loss: 2.0968 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0835 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 1.1161 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.1150 | Val  Acc: 0.8116
 Site-SynthDigits| Val  Loss: 1.7592 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.8193 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.0638 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 2.0359 | Val  Acc: 0.3846
Average Valid Accuracy: 0.5832
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7949
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3673
 Best site-USPS       | Epoch:2 | Val Acc: 0.7353
 Best site-USPS       | Epoch:2 | Val Acc: 0.8116
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.2455 | Train Acc: 0.7288
 Site-MNIST     | Train Loss: 1.1026 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1537 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0148 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.0302 | Train Acc: 0.7885
 Site-USPS      | Train Loss: 1.0154 | Train Acc: 0.7692
 Site-SynthDigits| Train Loss: 1.8938 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.7556 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.1151 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.9493 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.1438 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.0898 | Val  Acc: 0.8205
 Site-SVHN      | Val  Loss: 2.0732 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.0371 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.9515 | Val  Acc: 0.7059
 Site-USPS      | Val  Loss: 0.9843 | Val  Acc: 0.7681
 Site-SynthDigits| Val  Loss: 1.6728 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.7241 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.9887 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.9595 | Val  Acc: 0.4359
Average Valid Accuracy: 0.5775
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.0757 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.9649 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1105 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9483 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.9135 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 0.8702 | Train Acc: 0.7981
 Site-SynthDigits| Train Loss: 1.8626 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.7233 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0945 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.8974 | Train Acc: 0.4138
 Site-MNIST     | Val  Loss: 1.0120 | Val  Acc: 0.7949
 Site-MNIST     | Val  Loss: 0.9623 | Val  Acc: 0.8077
 Site-SVHN      | Val  Loss: 1.9921 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9738 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.8759 | Val  Acc: 0.7059
 Site-USPS      | Val  Loss: 0.8804 | Val  Acc: 0.7971
 Site-SynthDigits| Val  Loss: 1.6141 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.6614 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.9704 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.9019 | Val  Acc: 0.4359
Average Valid Accuracy: 0.5896
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7949
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8077
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3673
 Best site-USPS       | Epoch:4 | Val Acc: 0.7059
 Best site-USPS       | Epoch:4 | Val Acc: 0.7971
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.9759 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.8823 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1073 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9094 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.7683 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.7657 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7956 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.6850 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.0823 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 1.8576 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.9127 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.8546 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.9324 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9556 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.7515 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 0.7483 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.5458 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 1.5969 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.9300 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.8510 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6035
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3469
 Best site-USPS       | Epoch:5 | Val Acc: 0.7647
 Best site-USPS       | Epoch:5 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.9151 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.8030 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0776 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8582 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.6686 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.7079 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7575 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.6040 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 2.0568 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 1.7873 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.8695 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.7936 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.8739 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9176 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.6531 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 0.6572 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.5018 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.5464 | Val  Acc: 0.5345
 Site-MNIST-M   | Val  Loss: 1.8948 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.8036 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6112
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3673
 Best site-USPS       | Epoch:6 | Val Acc: 0.7647
 Best site-USPS       | Epoch:6 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5345
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.8459 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 0.7639 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.0585 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.8352 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.7193 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.6115 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.7465 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.5652 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0160 | Train Acc: 0.2414
 Site-MNIST-M   | Train Loss: 1.7287 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 0.7460 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 0.7201 | Val  Acc: 0.8205
 Site-SVHN      | Val  Loss: 1.8348 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.8942 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.5625 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 0.5862 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.4502 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.4868 | Val  Acc: 0.5690
 Site-MNIST-M   | Val  Loss: 1.8545 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.7581 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6173
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8205
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3673
 Best site-USPS       | Epoch:7 | Val Acc: 0.7941
 Best site-USPS       | Epoch:7 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5690
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.7997 | Train Acc: 0.7797
 Site-MNIST     | Train Loss: 0.6995 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.1302 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.7703 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.6539 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.5851 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6912 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.5148 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.9908 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7145 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 0.6881 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.6704 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.7845 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8759 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.5117 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 0.5204 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.4117 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.4515 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.8532 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.7306 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6539
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3878
 Best site-USPS       | Epoch:8 | Val Acc: 0.7941
 Best site-USPS       | Epoch:8 | Val Acc: 0.8696
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.7353 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 0.6324 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0488 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 1.7324 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 0.6085 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.5231 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.6462 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4638 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.9937 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.6320 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.6418 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.6264 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.7524 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8411 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.4699 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.4834 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.3657 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.4003 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7941 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.6760 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6779
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3878
 Best site-USPS       | Epoch:9 | Val Acc: 0.8529
 Best site-USPS       | Epoch:9 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.7371 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.6023 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0172 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.7142 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.5991 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.4653 | Train Acc: 0.9135
 Site-SynthDigits| Train Loss: 1.6021 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.4353 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.9543 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.6098 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 0.6288 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.6073 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.7023 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8012 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.4232 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.4404 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.3197 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.3526 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.7688 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.6421 | Val  Acc: 0.3846
Average Valid Accuracy: 0.6603
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.7006 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.6171 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0515 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.6795 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.6160 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4350 | Train Acc: 0.9135
 Site-SynthDigits| Train Loss: 1.6112 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.3767 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.9649 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.5961 | Train Acc: 0.3621
 Site-MNIST     | Val  Loss: 0.5554 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.5647 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.6550 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.7823 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.4056 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.4104 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.2979 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.3250 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.7681 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.6123 | Val  Acc: 0.3333
Average Valid Accuracy: 0.6683
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.6586 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.5401 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.0019 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.6377 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 0.4466 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.4100 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5715 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3492 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.9151 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.5828 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 0.5280 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 0.5203 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.6197 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.7635 | Val  Acc: 0.3878
 Site-USPS      | Val  Loss: 0.3787 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3707 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.3055 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.3118 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7062 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.5688 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6902
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3878
 Best site-USPS       | Epoch:12 | Val Acc: 0.8824
 Best site-USPS       | Epoch:12 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.6342 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 0.5131 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.9087 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.6384 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.5259 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.4158 | Train Acc: 0.9231
 Site-SynthDigits| Train Loss: 1.6329 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.3501 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.9639 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.5274 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.5245 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.5183 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.5643 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7392 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.3821 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.3798 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.2618 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2693 | Val  Acc: 0.6552
 Site-MNIST-M   | Val  Loss: 1.6800 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.5390 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6826
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.5785 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.5175 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.0919 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5997 | Train Acc: 0.4459
 Site-USPS      | Train Loss: 0.4269 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3538 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.5555 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2526 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.9240 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.4899 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 0.5081 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4943 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.5312 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7124 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.3379 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3342 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2353 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2303 | Val  Acc: 0.6724
 Site-MNIST-M   | Val  Loss: 1.6635 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.5182 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6805
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.5691 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.4552 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0804 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.5745 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.4511 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3306 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5153 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2584 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.9083 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.4707 | Train Acc: 0.4655
 Site-MNIST     | Val  Loss: 0.4668 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.4597 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.5026 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7052 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.3096 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.3005 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2197 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.2088 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.6202 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.4857 | Val  Acc: 0.4359
Average Valid Accuracy: 0.7017
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:15 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4286
 Best site-USPS       | Epoch:15 | Val Acc: 0.8824
 Best site-USPS       | Epoch:15 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7069
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.5569 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.4575 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.9033 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.5324 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.4255 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3332 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5400 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.2227 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.8940 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.4337 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.4816 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.4534 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.4903 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.7181 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.2979 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2845 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.2092 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1795 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.5428 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.4424 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7300
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4490
 Best site-USPS       | Epoch:16 | Val Acc: 0.8824
 Best site-USPS       | Epoch:16 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.5364 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.4320 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.0082 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.4999 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.5457 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.3281 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4835 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2396 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 1.9058 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.4041 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.4751 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4472 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.4544 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7011 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.2889 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2736 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.2001 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.1732 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.5325 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.4210 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7375
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:17 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4490
 Best site-USPS       | Epoch:17 | Val Acc: 0.9118
 Best site-USPS       | Epoch:17 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.4921 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.4120 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.9882 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.5000 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.4505 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3309 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5229 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.1761 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.9005 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.4171 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.4049 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4098 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4585 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7042 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.2916 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2783 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.1662 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.1524 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.5370 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.3877 | Val  Acc: 0.4615
Average Valid Accuracy: 0.7203
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4766 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.4280 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.8637 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.4692 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.4694 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2925 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.5364 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0965 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.8751 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.3500 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.3968 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.4057 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4124 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6414 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.2716 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2599 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1426 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.1092 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.4792 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.3498 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7531
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:19 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:19 | Val Acc: 0.5102
 Best site-USPS       | Epoch:19 | Val Acc: 0.9118
 Best site-USPS       | Epoch:19 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.4730 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.4062 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9916 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.4479 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.3131 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2806 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5490 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.1487 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.8887 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.3409 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.3664 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.3811 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.3972 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6373 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2710 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2541 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1316 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.1038 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.4446 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.3164 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7560
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5306
 Best site-USPS       | Epoch:20 | Val Acc: 0.9118
 Best site-USPS       | Epoch:20 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7759
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.4607 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3827 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.9546 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.3901 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3309 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2755 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4633 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.1240 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.8533 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.3120 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.3581 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.3700 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.3681 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6175 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2496 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2315 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1200 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0914 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.4143 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2900 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7613
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:21 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:21 | Val Acc: 0.5306
 Best site-USPS       | Epoch:21 | Val Acc: 0.9118
 Best site-USPS       | Epoch:21 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7759
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.4117 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3779 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8564 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.3807 | Train Acc: 0.5541
 Site-USPS      | Train Loss: 0.3267 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2517 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4484 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0538 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.8989 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2752 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.3556 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.3515 | Val  Acc: 0.9231
 Site-SVHN      | Val  Loss: 1.3546 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6192 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.2433 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2250 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.1224 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0762 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3765 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.2612 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7434
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.4250 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3578 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9841 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3690 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3277 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2611 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4813 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.0750 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.8616 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.2535 | Train Acc: 0.5517
 Site-MNIST     | Val  Loss: 0.3581 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3592 | Val  Acc: 0.9231
 Site-SVHN      | Val  Loss: 1.3272 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.6188 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2473 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2334 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0865 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0393 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3461 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2380 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7676
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9231
 Best site-SVHN       | Epoch:23 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:23 | Val Acc: 0.5306
 Best site-USPS       | Epoch:23 | Val Acc: 0.9118
 Best site-USPS       | Epoch:23 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4313 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3522 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9265 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3390 | Train Acc: 0.6351
 Site-USPS      | Train Loss: 0.3292 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2378 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.4422 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0185 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.8928 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.2176 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3484 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3494 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3186 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.6305 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.2338 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.2206 | Val  Acc: 0.9275
 Site-SynthDigits| Val  Loss: 1.0704 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0290 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3319 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2114 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7753
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:24 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:24 | Val Acc: 0.5714
 Best site-USPS       | Epoch:24 | Val Acc: 0.8824
 Best site-USPS       | Epoch:24 | Val Acc: 0.9275
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.4086 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.3262 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8629 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.3028 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3031 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2447 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.3967 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.0176 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.8613 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2035 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.3472 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3421 | Val  Acc: 0.9231
 Site-SVHN      | Val  Loss: 1.2784 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5930 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2249 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2063 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0653 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0121 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.2948 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1889 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7693
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.4394 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3506 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.9554 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.3085 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3286 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2447 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4223 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.0090 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.9096 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.1584 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.3291 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3327 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2697 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.5911 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2184 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2051 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0568 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 1.0054 | Val  Acc: 0.7759
 Site-MNIST-M   | Val  Loss: 1.2961 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1742 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7774
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:26 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:26 | Val Acc: 0.5306
 Best site-USPS       | Epoch:26 | Val Acc: 0.9118
 Best site-USPS       | Epoch:26 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.7759
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.4108 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.3106 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0424 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.2893 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.5467 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2252 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.4491 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.0089 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.8281 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.1618 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.3174 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3252 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2827 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5748 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2168 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.2031 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0564 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9862 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2622 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1412 | Val  Acc: 0.6410
Average Valid Accuracy: 0.7768
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.3841 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3013 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8193 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.2727 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2620 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.2016 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4325 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.9818 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.9160 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.1304 | Train Acc: 0.6552
 Site-MNIST     | Val  Loss: 0.3024 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3117 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.2530 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5500 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.2019 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.1835 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0382 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9715 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2276 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1228 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7825
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:28 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:28 | Val Acc: 0.5102
 Best site-USPS       | Epoch:28 | Val Acc: 0.9118
 Best site-USPS       | Epoch:28 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4040 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.3167 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9890 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.2472 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2482 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1958 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.3917 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.9296 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.8383 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.1094 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2996 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3070 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2386 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5264 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.1963 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.1765 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.0214 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.9513 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2208 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.1093 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7926
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:29 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:29 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:29 | Val Acc: 0.5306
 Best site-USPS       | Epoch:29 | Val Acc: 0.9118
 Best site-USPS       | Epoch:29 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.6923
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:29 | Test Acc: 0.8114
 Test site-SVHN      | Epoch:29 | Test Acc: 0.2559
 Test site-USPS      | Epoch:29 | Test Acc: 0.8871
===2023-04-28 03:01:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 1.9554 | Train Acc: 0.5424
 Site-MNIST     | Train Loss: 1.9203 | Train Acc: 0.5847
 Site-SVHN      | Train Loss: 2.2629 | Train Acc: 0.1081
 Site-SVHN      | Train Loss: 2.2100 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.7521 | Train Acc: 0.6154
 Site-USPS      | Train Loss: 1.7621 | Train Acc: 0.7115
 Site-SynthDigits| Train Loss: 2.1696 | Train Acc: 0.1364
 Site-SynthDigits| Train Loss: 2.1741 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.2248 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 2.2333 | Train Acc: 0.2069
 Site-MNIST     | Val  Loss: 1.9551 | Val  Acc: 0.5641
 Site-MNIST     | Val  Loss: 1.9186 | Val  Acc: 0.6154
 Site-SVHN      | Val  Loss: 2.1718 | Val  Acc: 0.2500
 Site-SVHN      | Val  Loss: 2.1362 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.7557 | Val  Acc: 0.6176
 Site-USPS      | Val  Loss: 1.7692 | Val  Acc: 0.6957
 Site-SynthDigits| Val  Loss: 2.1168 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 2.1496 | Val  Acc: 0.2931
 Site-MNIST-M   | Val  Loss: 2.2882 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.2351 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3878
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5641
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6154
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2500
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2041
 Best site-USPS       | Epoch:0 | Val Acc: 0.6176
 Best site-USPS       | Epoch:0 | Val Acc: 0.6957
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2931
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1538
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 1.5275 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 1.4366 | Train Acc: 0.7797
 Site-SVHN      | Train Loss: 2.1799 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.1384 | Train Acc: 0.2568
 Site-USPS      | Train Loss: 1.2859 | Train Acc: 0.7885
 Site-USPS      | Train Loss: 1.3381 | Train Acc: 0.8077
 Site-SynthDigits| Train Loss: 2.0388 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 2.0291 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.1883 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 2.1149 | Train Acc: 0.4138
 Site-MNIST     | Val  Loss: 1.4803 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.4222 | Val  Acc: 0.8077
 Site-SVHN      | Val  Loss: 2.1087 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.1405 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 1.2839 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.3114 | Val  Acc: 0.8261
 Site-SynthDigits| Val  Loss: 1.9781 | Val  Acc: 0.5517
 Site-SynthDigits| Val  Loss: 2.0185 | Val  Acc: 0.4138
 Site-MNIST-M   | Val  Loss: 2.2283 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.1585 | Val  Acc: 0.3846
Average Valid Accuracy: 0.5330
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8077
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2449
 Best site-USPS       | Epoch:1 | Val Acc: 0.7353
 Best site-USPS       | Epoch:1 | Val Acc: 0.8261
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.5517
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4138
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 1.2048 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 1.1477 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.1168 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.0353 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 1.1943 | Train Acc: 0.8077
 Site-USPS      | Train Loss: 1.0652 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.8929 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.8785 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.1034 | Train Acc: 0.2414
 Site-MNIST-M   | Train Loss: 1.9779 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 1.1752 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.0994 | Val  Acc: 0.8205
 Site-SVHN      | Val  Loss: 1.9411 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0109 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.9672 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.0041 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.7602 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.8160 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 2.1058 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 2.0360 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6002
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8205
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3469
 Best site-USPS       | Epoch:2 | Val Acc: 0.8529
 Best site-USPS       | Epoch:2 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 0.9643 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.9148 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.0513 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.9410 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 0.9581 | Train Acc: 0.7885
 Site-USPS      | Train Loss: 0.9248 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.7883 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 1.7546 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.1230 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.8976 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 0.9327 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 0.8493 | Val  Acc: 0.8333
 Site-SVHN      | Val  Loss: 1.8983 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 2.0047 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.8106 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.8637 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.6758 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.7305 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1340 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 1.9998 | Val  Acc: 0.4359
Average Valid Accuracy: 0.6083
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8333
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3469
 Best site-USPS       | Epoch:3 | Val Acc: 0.8824
 Best site-USPS       | Epoch:3 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4211
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 0.8193 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.7300 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.0734 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8877 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.8014 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.7109 | Train Acc: 0.9038
 Site-SynthDigits| Train Loss: 1.7367 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.6541 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 2.0408 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7846 | Train Acc: 0.5517
 Site-MNIST     | Val  Loss: 0.7835 | Val  Acc: 0.7949
 Site-MNIST     | Val  Loss: 0.7159 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 1.7911 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.9005 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.6142 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6620 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.5689 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.6172 | Val  Acc: 0.4655
 Site-MNIST-M   | Val  Loss: 1.9918 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.8810 | Val  Acc: 0.5128
Average Valid Accuracy: 0.6517
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7949
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8462
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4898
 Best site-USPS       | Epoch:4 | Val Acc: 0.8824
 Best site-USPS       | Epoch:4 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4655
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 0.7102 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.6136 | Train Acc: 0.8729
 Site-SVHN      | Train Loss: 2.0357 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 1.7981 | Train Acc: 0.4459
 Site-USPS      | Train Loss: 0.6109 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.5893 | Train Acc: 0.9231
 Site-SynthDigits| Train Loss: 1.6459 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.5779 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.9716 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.7233 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.6635 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 0.6086 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.6553 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8230 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.5135 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.5436 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.5143 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.5455 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.9609 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.8224 | Val  Acc: 0.5128
Average Valid Accuracy: 0.6581
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4286
 Best site-USPS       | Epoch:5 | Val Acc: 0.9118
 Best site-USPS       | Epoch:5 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 0.5770 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.5827 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 1.9529 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.7632 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.5057 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.5055 | Train Acc: 0.9327
 Site-SynthDigits| Train Loss: 1.6022 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.4693 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 2.0068 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.6512 | Train Acc: 0.5345
 Site-MNIST     | Val  Loss: 0.5940 | Val  Acc: 0.8205
 Site-MNIST     | Val  Loss: 0.5260 | Val  Acc: 0.8718
 Site-SVHN      | Val  Loss: 1.6234 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7975 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.4654 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.4768 | Val  Acc: 0.9420
 Site-SynthDigits| Val  Loss: 1.4330 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.4764 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 1.8919 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.7487 | Val  Acc: 0.5385
Average Valid Accuracy: 0.6804
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8205
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8718
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4286
 Best site-USPS       | Epoch:6 | Val Acc: 0.8824
 Best site-USPS       | Epoch:6 | Val Acc: 0.9420
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 0.5333 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.4616 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.8957 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6698 | Train Acc: 0.4730
 Site-USPS      | Train Loss: 0.6496 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.4687 | Train Acc: 0.9423
 Site-SynthDigits| Train Loss: 1.5218 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.3792 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.9567 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.6109 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.4762 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.4476 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5220 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.7644 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.4147 | Val  Acc: 0.9118
 Site-USPS      | Val  Loss: 0.4456 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.3755 | Val  Acc: 0.6207
 Site-SynthDigits| Val  Loss: 1.4032 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.8714 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.6996 | Val  Acc: 0.4872
Average Valid Accuracy: 0.6911
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4082
 Best site-USPS       | Epoch:7 | Val Acc: 0.9118
 Best site-USPS       | Epoch:7 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6207
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6034
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 0.4333 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.4043 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8922 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.6162 | Train Acc: 0.5270
 Site-USPS      | Train Loss: 0.5611 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.4197 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.5192 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.3864 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.9441 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.4976 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.3875 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3764 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.4781 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7122 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.3744 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.4006 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.3044 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.3501 | Val  Acc: 0.6552
 Site-MNIST-M   | Val  Loss: 1.7905 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.6031 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7313
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4898
 Best site-USPS       | Epoch:8 | Val Acc: 0.9412
 Best site-USPS       | Epoch:8 | Val Acc: 0.9565
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6552
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 0.4049 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.3537 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9593 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.5816 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.4656 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3391 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.4802 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.2742 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.8603 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.4310 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.3633 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.3527 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.4232 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6495 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.3236 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.3241 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.2800 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2802 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.6668 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.5147 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7359
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:9 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4694
 Best site-USPS       | Epoch:9 | Val Acc: 0.9412
 Best site-USPS       | Epoch:9 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7971
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2736
 Test site-USPS      | Epoch:9 | Test Acc: 0.8978
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4504
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3379
Average Test Accuracy: 0.5514
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 0.3775 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.3293 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8494 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.5154 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.5160 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3278 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.4639 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.2300 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.9322 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.4330 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.3379 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.3260 | Val  Acc: 0.9359
 Site-SVHN      | Val  Loss: 1.3340 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6240 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.2984 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.3106 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.2667 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2652 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.6942 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.5220 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7406
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9359
 Best site-SVHN       | Epoch:10 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4898
 Best site-USPS       | Epoch:10 | Val Acc: 0.9412
 Best site-USPS       | Epoch:10 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 0.3248 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.3164 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9489 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.4604 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.3766 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.3053 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.4611 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.1721 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.8351 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.2972 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.3032 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2875 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.3175 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.5910 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.2732 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.2800 | Val  Acc: 0.9710
 Site-SynthDigits| Val  Loss: 1.2119 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2057 | Val  Acc: 0.6552
 Site-MNIST-M   | Val  Loss: 1.5752 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.4047 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7678
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:11 | Val Acc: 0.5714
 Best site-USPS       | Epoch:11 | Val Acc: 0.9412
 Best site-USPS       | Epoch:11 | Val Acc: 0.9710
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6552
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 0.2907 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2603 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.9723 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.4340 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.4756 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2716 | Train Acc: 0.9615
 Site-SynthDigits| Train Loss: 1.4261 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.1365 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.7793 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.2299 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2862 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2695 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2677 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.5490 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.2431 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.2524 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.1413 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1440 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.5175 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.3216 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7805
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:12 | Val Acc: 0.5510
 Best site-USPS       | Epoch:12 | Val Acc: 0.9706
 Best site-USPS       | Epoch:12 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 0.2655 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2330 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.9212 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3747 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.3384 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2357 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.3634 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.0641 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 1.8172 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.2444 | Train Acc: 0.6724
 Site-MNIST     | Val  Loss: 0.2501 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2407 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2120 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.5271 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.2284 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.2387 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.1250 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1004 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.5321 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.3372 | Val  Acc: 0.6667
Average Valid Accuracy: 0.7871
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:13 | Val Acc: 0.5306
 Best site-USPS       | Epoch:13 | Val Acc: 0.9706
 Best site-USPS       | Epoch:13 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7414
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.2436 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.2129 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.8391 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3271 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.2808 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.2234 | Train Acc: 0.9712
 Site-SynthDigits| Train Loss: 1.3801 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.0994 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.7615 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.1532 | Train Acc: 0.7241
 Site-MNIST     | Val  Loss: 0.2328 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.2238 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1736 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.4998 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.2009 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.2041 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.1255 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0950 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4782 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2614 | Val  Acc: 0.7179
Average Valid Accuracy: 0.7943
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5833
 Best site-SVHN       | Epoch:14 | Val Acc: 0.5510
 Best site-USPS       | Epoch:14 | Val Acc: 0.9706
 Best site-USPS       | Epoch:14 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7414
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7179
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 0.2197 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.2340 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.9020 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.2979 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3779 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.2301 | Train Acc: 0.9519
 Site-SynthDigits| Train Loss: 1.3617 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.0308 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.7294 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.1085 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.1911 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.1922 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.1450 | Val  Acc: 0.5833
 Site-SVHN      | Val  Loss: 1.4862 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.2140 | Val  Acc: 0.9412
 Site-USPS      | Val  Loss: 0.2196 | Val  Acc: 0.9565
 Site-SynthDigits| Val  Loss: 1.0712 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0450 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4589 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.2253 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7859
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 0.2058 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1748 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.8521 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.3094 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.2684 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1860 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3646 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 0.9902 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.7570 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.0740 | Train Acc: 0.7069
 Site-MNIST     | Val  Loss: 0.1858 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.1794 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.2065 | Val  Acc: 0.6250
 Site-SVHN      | Val  Loss: 1.4916 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.1744 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1759 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.0187 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9898 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.4128 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.1952 | Val  Acc: 0.6923
Average Valid Accuracy: 0.7976
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:16 | Val Acc: 0.6250
 Best site-SVHN       | Epoch:16 | Val Acc: 0.5510
 Best site-USPS       | Epoch:16 | Val Acc: 0.9706
 Best site-USPS       | Epoch:16 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7368
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.6923
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 0.1991 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1542 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.7859 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.2030 | Train Acc: 0.6622
 Site-USPS      | Train Loss: 0.3900 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.1908 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.2604 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.9231 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.7790 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.1085 | Train Acc: 0.6552
 Site-MNIST     | Val  Loss: 0.1689 | Val  Acc: 0.9487
 Site-MNIST     | Val  Loss: 0.1672 | Val  Acc: 0.9487
 Site-SVHN      | Val  Loss: 1.0977 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.4388 | Val  Acc: 0.6531
 Site-USPS      | Val  Loss: 0.1794 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1835 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 1.0066 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 0.9654 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.4265 | Val  Acc: 0.6842
 Site-MNIST-M   | Val  Loss: 1.1997 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8057
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9487
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9487
 Best site-SVHN       | Epoch:17 | Val Acc: 0.7083
 Best site-SVHN       | Epoch:17 | Val Acc: 0.6531
 Best site-USPS       | Epoch:17 | Val Acc: 0.9706
 Best site-USPS       | Epoch:17 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.6842
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.6410
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 0.2019 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.1576 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.8774 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.2121 | Train Acc: 0.6622
 Site-USPS      | Train Loss: 0.2509 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1645 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.3039 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.9284 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.6813 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.9597 | Train Acc: 0.7414
 Site-MNIST     | Val  Loss: 0.1639 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1550 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 1.0405 | Val  Acc: 0.7083
 Site-SVHN      | Val  Loss: 1.3564 | Val  Acc: 0.6531
 Site-USPS      | Val  Loss: 0.1470 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1496 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9936 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9385 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2847 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.0781 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8385
 Best site-MNIST      | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9744
 Best site-SVHN       | Epoch:18 | Val Acc: 0.7083
 Best site-SVHN       | Epoch:18 | Val Acc: 0.6531
 Best site-USPS       | Epoch:18 | Val Acc: 0.9706
 Best site-USPS       | Epoch:18 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7179
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.1852 | Train Acc: 0.9492
 Site-MNIST     | Train Loss: 0.1561 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.7927 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1601 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 0.2489 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.1401 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.2002 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.8604 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.6820 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.9790 | Train Acc: 0.7241
 Site-MNIST     | Val  Loss: 0.1629 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1503 | Val  Acc: 0.9744
 Site-SVHN      | Val  Loss: 0.9934 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.3404 | Val  Acc: 0.6939
 Site-USPS      | Val  Loss: 0.1300 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1292 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9883 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9397 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2781 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 1.0688 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8468
 Best site-MNIST      | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9744
 Best site-SVHN       | Epoch:19 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:19 | Val Acc: 0.6939
 Best site-USPS       | Epoch:19 | Val Acc: 0.9706
 Best site-USPS       | Epoch:19 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.7179
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.8357
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2816
 Test site-USPS      | Epoch:19 | Test Acc: 0.9032
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.4842
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.3650
Average Test Accuracy: 0.5740
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 0.1638 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.1378 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.7807 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.1017 | Train Acc: 0.7703
 Site-USPS      | Train Loss: 0.2216 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1473 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.2278 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 0.9092 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.7042 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.9186 | Train Acc: 0.7586
 Site-MNIST     | Val  Loss: 0.1470 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.1462 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 0.9751 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.3282 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 0.1294 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1247 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9666 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.9155 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2450 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 1.0205 | Val  Acc: 0.7436
Average Valid Accuracy: 0.8464
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 0.1702 | Train Acc: 0.9492
 Site-MNIST     | Train Loss: 0.1325 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6609 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.0956 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 0.2306 | Train Acc: 0.9038
 Site-USPS      | Train Loss: 0.1257 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.2255 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 0.8505 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 1.7162 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 0.9170 | Train Acc: 0.7414
 Site-MNIST     | Val  Loss: 0.1337 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1202 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.9350 | Val  Acc: 0.7500
 Site-SVHN      | Val  Loss: 1.2753 | Val  Acc: 0.7347
 Site-USPS      | Val  Loss: 0.1121 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1146 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.9511 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8935 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 1.1915 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 0.9958 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8603
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:21 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:21 | Val Acc: 0.7500
 Best site-SVHN       | Epoch:21 | Val Acc: 0.7347
 Best site-USPS       | Epoch:21 | Val Acc: 0.9706
 Best site-USPS       | Epoch:21 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8103
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.7692
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 0.1322 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.1263 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.7057 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.0455 | Train Acc: 0.7973
 Site-USPS      | Train Loss: 0.2020 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1323 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.1823 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 0.7863 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.6813 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.8831 | Train Acc: 0.8448
 Site-MNIST     | Val  Loss: 0.1311 | Val  Acc: 0.9744
 Site-MNIST     | Val  Loss: 0.1215 | Val  Acc: 0.9615
 Site-SVHN      | Val  Loss: 0.9033 | Val  Acc: 0.9167
 Site-SVHN      | Val  Loss: 1.2650 | Val  Acc: 0.7959
 Site-USPS      | Val  Loss: 0.1076 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1150 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.9213 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8552 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0883 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.9171 | Val  Acc: 0.8462
Average Valid Accuracy: 0.8957
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9744
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9615
 Best site-SVHN       | Epoch:22 | Val Acc: 0.9167
 Best site-SVHN       | Epoch:22 | Val Acc: 0.7959
 Best site-USPS       | Epoch:22 | Val Acc: 1.0000
 Best site-USPS       | Epoch:22 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.7931
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8462
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 0.1324 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0965 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.7940 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.0295 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 0.2746 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1221 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.1058 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.7459 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.7023 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 0.8989 | Train Acc: 0.7931
 Site-MNIST     | Val  Loss: 0.1061 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1023 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.8561 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 1.2406 | Val  Acc: 0.7755
 Site-USPS      | Val  Loss: 0.1108 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1157 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8841 | Val  Acc: 0.7931
 Site-SynthDigits| Val  Loss: 0.8310 | Val  Acc: 0.8103
 Site-MNIST-M   | Val  Loss: 1.1498 | Val  Acc: 0.7368
 Site-MNIST-M   | Val  Loss: 0.9593 | Val  Acc: 0.7692
Average Valid Accuracy: 0.8703
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.1183 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0971 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6458 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 0.9716 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 0.4205 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1188 | Train Acc: 0.9808
 Site-SynthDigits| Train Loss: 1.0945 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.7796 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.7366 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 0.8667 | Train Acc: 0.8276
 Site-MNIST     | Val  Loss: 0.0957 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0945 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8332 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 1.2264 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.1090 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.1120 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.8624 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 0.8093 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 1.1247 | Val  Acc: 0.7895
 Site-MNIST-M   | Val  Loss: 0.9306 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9049
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:24 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:24 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:24 | Val Acc: 0.8776
 Best site-USPS       | Epoch:24 | Val Acc: 0.9706
 Best site-USPS       | Epoch:24 | Val Acc: 0.9855
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7895
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.7949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 0.1328 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0884 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.7238 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 0.9564 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.2055 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.1102 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.1656 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 0.7301 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6293 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.7676 | Train Acc: 0.8621
 Site-MNIST     | Val  Loss: 0.0926 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0957 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.8094 | Val  Acc: 0.8750
 Site-SVHN      | Val  Loss: 1.1849 | Val  Acc: 0.8367
 Site-USPS      | Val  Loss: 0.0996 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1014 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.8462 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.7919 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.0114 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.8265 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9051
 Best site-MNIST      | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9872
 Best site-SVHN       | Epoch:25 | Val Acc: 0.8750
 Best site-SVHN       | Epoch:25 | Val Acc: 0.8367
 Best site-USPS       | Epoch:25 | Val Acc: 1.0000
 Best site-USPS       | Epoch:25 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.8205
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.1147 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.1014 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8312 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.9517 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 0.1931 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.1063 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.1208 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 0.7008 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.6064 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.7287 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.0892 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7813 | Val  Acc: 0.9167
 Site-SVHN      | Val  Loss: 1.1351 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.0924 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0928 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.8080 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.7549 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9762 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.8048 | Val  Acc: 0.8718
Average Valid Accuracy: 0.9195
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:26 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:26 | Val Acc: 0.9167
 Best site-SVHN       | Epoch:26 | Val Acc: 0.8571
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-USPS       | Epoch:26 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8421
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8718
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.1163 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0786 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.8081 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 0.9209 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.2393 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0901 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.0768 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 0.6824 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.6203 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.7073 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.0845 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0822 | Val  Acc: 0.9872
 Site-SVHN      | Val  Loss: 0.7626 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 1.1030 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.0825 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0844 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.8027 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.7542 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 0.9460 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7694 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9305
 Best site-MNIST      | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9872
 Best site-SVHN       | Epoch:27 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:27 | Val Acc: 0.8776
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.1130 | Train Acc: 0.9661
 Site-MNIST     | Train Loss: 0.0721 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7550 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.8842 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.1735 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0887 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0903 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.6588 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.6673 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.7091 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0738 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0741 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7578 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.1161 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0848 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0798 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7736 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.7336 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9301 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7595 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9417
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:28 | Val Acc: 0.9184
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8621
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8448
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1033 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0670 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8415 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.8687 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.1777 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0920 | Train Acc: 0.9904
 Site-SynthDigits| Train Loss: 1.0658 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.6218 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.6615 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.6868 | Train Acc: 0.8966
 Site-MNIST     | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0719 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7312 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 1.0719 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.0862 | Val  Acc: 0.9706
 Site-USPS      | Val  Loss: 0.0801 | Val  Acc: 0.9855
 Site-SynthDigits| Val  Loss: 0.7399 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.6967 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.9256 | Val  Acc: 0.8421
 Site-MNIST-M   | Val  Loss: 0.7506 | Val  Acc: 0.8718
Average Valid Accuracy: 0.9213
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.1070 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0683 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8587 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 0.8689 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.1775 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0778 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.0151 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.6449 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.6413 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.6639 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0677 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0645 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6921 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 1.0290 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.0779 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0742 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6830 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.6565 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.8814 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.7069 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9439
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:30 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:30 | Val Acc: 0.8776
 Best site-USPS       | Epoch:30 | Val Acc: 1.0000
 Best site-USPS       | Epoch:30 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9474
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.8974
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.0963 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0653 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6873 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.8452 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.1800 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 1.0035 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 0.6098 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.6975 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 0.6618 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0606 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7041 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 1.0103 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0746 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0665 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.7139 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.6767 | Val  Acc: 0.8448
 Site-MNIST-M   | Val  Loss: 0.8916 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.7183 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9355
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.0930 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0583 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8254 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.8225 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.1604 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9702 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5876 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.5970 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.6180 | Train Acc: 0.9310
 Site-MNIST     | Val  Loss: 0.0566 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0569 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6957 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.9885 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0676 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0591 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6691 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.6407 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.8275 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6624 | Val  Acc: 0.9231
Average Valid Accuracy: 0.9467
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:32 | Val Acc: 0.9583
 Best site-SVHN       | Epoch:32 | Val Acc: 0.8980
 Best site-USPS       | Epoch:32 | Val Acc: 1.0000
 Best site-USPS       | Epoch:32 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.9231
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.0793 | Train Acc: 0.9831
 Site-MNIST     | Train Loss: 0.0516 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6273 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.7919 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.1553 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0860 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9350 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.5396 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.6337 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 0.6098 | Train Acc: 0.9310
 Site-MNIST     | Val  Loss: 0.0497 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0539 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6665 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.9663 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0690 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0610 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6413 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.6178 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.8327 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6533 | Val  Acc: 0.9231
Average Valid Accuracy: 0.9509
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:33 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:33 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:33 | Val Acc: 0.8980
 Best site-USPS       | Epoch:33 | Val Acc: 1.0000
 Best site-USPS       | Epoch:33 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.8947
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.9231
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.0802 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0504 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7056 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.7590 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.2224 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0737 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9541 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5929 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.5962 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.5763 | Train Acc: 0.9655
 Site-MNIST     | Val  Loss: 0.0472 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0516 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6303 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.9501 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0634 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0569 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6429 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.6165 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.8055 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6158 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9706
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:34 | Val Acc: 0.9388
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-USPS       | Epoch:34 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8966
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.0713 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0464 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6173 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 0.7734 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.2531 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0568 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9171 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.5635 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.6023 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.5664 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0501 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0476 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6186 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.9042 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.0497 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0452 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6512 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.6143 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 0.8112 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6251 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9373
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.0717 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0374 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7311 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.7322 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1347 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0691 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9125 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5394 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.6285 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 0.5532 | Train Acc: 0.9483
 Site-MNIST     | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0398 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5955 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8626 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0524 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0508 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.6133 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5877 | Val  Acc: 0.8793
 Site-MNIST-M   | Val  Loss: 0.7883 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.6060 | Val  Acc: 0.9487
Average Valid Accuracy: 0.9611
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.0638 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0353 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6468 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.7092 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1203 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0542 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8810 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.5269 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.6536 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.5508 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0334 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0362 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5979 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8585 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0440 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5804 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5648 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.7925 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.6072 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9524
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.0630 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0288 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5180 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.7049 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1148 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0590 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8375 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4783 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 1.6771 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.5333 | Train Acc: 0.9138
 Site-MNIST     | Val  Loss: 0.0276 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5931 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8440 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0489 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5705 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5512 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.7327 | Val  Acc: 0.8947
 Site-MNIST-M   | Val  Loss: 0.5830 | Val  Acc: 0.8974
Average Valid Accuracy: 0.9538
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0598 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0264 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6150 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6800 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.1468 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0554 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8731 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.4879 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.6755 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.5102 | Train Acc: 0.9655
 Site-MNIST     | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5677 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8066 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0442 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0466 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5544 | Val  Acc: 0.9310
 Site-SynthDigits| Val  Loss: 0.5289 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.6936 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5438 | Val  Acc: 0.9744
Average Valid Accuracy: 0.9775
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:39 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:39 | Val Acc: 0.9388
 Best site-USPS       | Epoch:39 | Val Acc: 1.0000
 Best site-USPS       | Epoch:39 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9310
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9744
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8464
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2947
 Test site-USPS      | Epoch:39 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.5223
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3464
Average Test Accuracy: 0.5837
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.0570 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0260 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5800 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6756 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.1384 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0694 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8536 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.4808 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.5908 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.5035 | Train Acc: 0.9483
 Site-MNIST     | Val  Loss: 0.0262 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5388 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8167 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.0455 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5862 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.5430 | Val  Acc: 0.9138
 Site-MNIST-M   | Val  Loss: 0.6872 | Val  Acc: 0.9474
 Site-MNIST-M   | Val  Loss: 0.5376 | Val  Acc: 0.9487
Average Valid Accuracy: 0.9611
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.0498 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0298 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6420 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.6601 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.1769 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0573 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.9101 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.4725 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.6255 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4936 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0311 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0319 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5609 | Val  Acc: 0.9583
 Site-SVHN      | Val  Loss: 0.8198 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.0495 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0438 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5427 | Val  Acc: 0.9310
 Site-SynthDigits| Val  Loss: 0.5257 | Val  Acc: 0.9138
 Site-MNIST-M   | Val  Loss: 0.6810 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5184 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9722
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.0637 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0296 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7090 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.6619 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.1125 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0443 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8644 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.4634 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 1.6260 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 0.4517 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0298 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0280 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5135 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7755 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5465 | Val  Acc: 0.9310
 Site-SynthDigits| Val  Loss: 0.5115 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.6245 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4972 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9821
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:42 | Val Acc: 0.9592
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-USPS       | Epoch:42 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9310
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.0663 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0270 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.4990 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.6202 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.1079 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0407 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8866 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4417 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.5429 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.4386 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0318 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0274 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4975 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7472 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.0340 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5285 | Val  Acc: 0.9310
 Site-SynthDigits| Val  Loss: 0.4966 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.5707 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4636 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9821
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0466 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0209 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6124 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.6014 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1511 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0470 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8366 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4596 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 1.5648 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.4271 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0211 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4994 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7594 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0356 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0350 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5334 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.5098 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.5717 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4534 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9807
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.0474 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0192 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6122 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.6007 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0930 | Train Acc: 0.9615
 Site-USPS      | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8353 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.4448 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 1.5330 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.4118 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0195 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4892 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7381 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0331 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0333 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5331 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.4970 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.5310 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4334 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9807
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.0550 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0204 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.5522 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.5768 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1084 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0378 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8138 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4310 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 1.6084 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.4196 | Train Acc: 0.9828
 Site-MNIST     | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4774 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7157 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0295 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0293 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5145 | Val  Acc: 0.9310
 Site-SynthDigits| Val  Loss: 0.4731 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.5340 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4366 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9842
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:46 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:46 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:46 | Val Acc: 0.9796
 Best site-USPS       | Epoch:46 | Val Acc: 1.0000
 Best site-USPS       | Epoch:46 | Val Acc: 1.0000
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.9310
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:46 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:46 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/harmo-fl...
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.0478 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.8025 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 0.5774 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0988 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0356 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7804 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.4264 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.5856 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 0.3968 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4644 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.7040 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.5198 | Val  Acc: 0.8621
 Site-SynthDigits| Val  Loss: 0.4751 | Val  Acc: 0.9138
 Site-MNIST-M   | Val  Loss: 0.5147 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4210 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9735
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.0537 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0218 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.7466 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 0.5779 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.0891 | Train Acc: 0.9423
 Site-USPS      | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.8190 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.4133 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 1.6163 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.4029 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0199 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4502 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6962 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0253 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.4951 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.4599 | Val  Acc: 0.9138
 Site-MNIST-M   | Val  Loss: 0.4938 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4045 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9790
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0517 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0206 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.6565 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 0.5732 | Train Acc: 0.9865
 Site-USPS      | Train Loss: 0.1140 | Train Acc: 0.9231
 Site-USPS      | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-SynthDigits| Train Loss: 0.7788 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.3823 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 1.6496 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 0.3932 | Train Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0163 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.4480 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6890 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0271 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0277 | Val  Acc: 1.0000
 Site-SynthDigits| Val  Loss: 0.4878 | Val  Acc: 0.8966
 Site-SynthDigits| Val  Loss: 0.4529 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.4925 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4062 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9828
===2023-04-28 04:04:50===
===2023-04-28 04:04:51===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:46 | Test Acc: 0.8507
 Test site-SVHN      | Epoch:46 | Test Acc: 0.2912
 Test site-USPS      | Epoch:46 | Test Acc: 0.8925
 Test site-SynthDigits| Epoch:46 | Test Acc: 0.5265
 Test site-MNIST-M   | Epoch:46 | Test Acc: 0.3479
Average Test Accuracy: 0.5818
