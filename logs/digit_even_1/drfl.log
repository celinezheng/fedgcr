===2023-04-18 19:50:42===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
============ Train epoch 0 ============
 Site-MNIST     | Train Loss: 2.2853 | Train Acc: 0.0508
 Site-MNIST     | Train Loss: 2.2909 | Train Acc: 0.0932
 Site-SVHN      | Train Loss: 2.3853 | Train Acc: 0.0541
 Site-SVHN      | Train Loss: 2.3341 | Train Acc: 0.0946
 Site-USPS      | Train Loss: 2.3426 | Train Acc: 0.0577
 Site-USPS      | Train Loss: 2.2894 | Train Acc: 0.0865
 Site-SynthDigits| Train Loss: 2.3232 | Train Acc: 0.0682
 Site-SynthDigits| Train Loss: 2.2693 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.4633 | Train Acc: 0.0000
 Site-MNIST-M   | Train Loss: 2.3969 | Train Acc: 0.0690
 Site-MNIST     | Val  Loss: 2.3161 | Val  Acc: 0.1026
 Site-MNIST     | Val  Loss: 2.2956 | Val  Acc: 0.0897
 Site-SVHN      | Val  Loss: 2.3306 | Val  Acc: 0.0000
 Site-SVHN      | Val  Loss: 2.3812 | Val  Acc: 0.0816
 Site-USPS      | Val  Loss: 2.2963 | Val  Acc: 0.0882
 Site-USPS      | Val  Loss: 2.3097 | Val  Acc: 0.0725
 Site-SynthDigits| Val  Loss: 2.2576 | Val  Acc: 0.0690
 Site-SynthDigits| Val  Loss: 2.2899 | Val  Acc: 0.1034
 Site-MNIST-M   | Val  Loss: 2.4063 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.3921 | Val  Acc: 0.1026
Average Valid Accuracy: 0.0815
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1026
 Best site-MNIST      | Epoch:0 | Val Acc: 0.0897
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0000
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0816
 Best site-USPS       | Epoch:0 | Val Acc: 0.0882
 Best site-USPS       | Epoch:0 | Val Acc: 0.0725
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0690
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1034
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 1 ============
 Site-MNIST     | Train Loss: 2.1707 | Train Acc: 0.1356
 Site-MNIST     | Train Loss: 2.1587 | Train Acc: 0.2034
 Site-SVHN      | Train Loss: 2.3650 | Train Acc: 0.0541
 Site-SVHN      | Train Loss: 2.2867 | Train Acc: 0.1757
 Site-USPS      | Train Loss: 2.1976 | Train Acc: 0.2885
 Site-USPS      | Train Loss: 2.1525 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.2752 | Train Acc: 0.1136
 Site-SynthDigits| Train Loss: 2.2456 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.4314 | Train Acc: 0.0000
 Site-MNIST-M   | Train Loss: 2.3700 | Train Acc: 0.0862
 Site-MNIST     | Val  Loss: 2.1759 | Val  Acc: 0.2051
 Site-MNIST     | Val  Loss: 2.1549 | Val  Acc: 0.2051
 Site-SVHN      | Val  Loss: 2.2876 | Val  Acc: 0.1250
 Site-SVHN      | Val  Loss: 2.3606 | Val  Acc: 0.1633
 Site-USPS      | Val  Loss: 2.1992 | Val  Acc: 0.1765
 Site-USPS      | Val  Loss: 2.1752 | Val  Acc: 0.2464
 Site-SynthDigits| Val  Loss: 2.2293 | Val  Acc: 0.1379
 Site-SynthDigits| Val  Loss: 2.2585 | Val  Acc: 0.1552
 Site-MNIST-M   | Val  Loss: 2.4057 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.3662 | Val  Acc: 0.1026
Average Valid Accuracy: 0.1622
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2051
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1250
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1633
 Best site-USPS       | Epoch:1 | Val Acc: 0.1765
 Best site-USPS       | Epoch:1 | Val Acc: 0.2464
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1379
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1552
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 2 ============
 Site-MNIST     | Train Loss: 2.0690 | Train Acc: 0.2373
 Site-MNIST     | Train Loss: 2.0189 | Train Acc: 0.3220
 Site-SVHN      | Train Loss: 2.2630 | Train Acc: 0.0811
 Site-SVHN      | Train Loss: 2.2516 | Train Acc: 0.2027
 Site-USPS      | Train Loss: 2.0921 | Train Acc: 0.3462
 Site-USPS      | Train Loss: 2.0557 | Train Acc: 0.3654
 Site-SynthDigits| Train Loss: 2.2253 | Train Acc: 0.1364
 Site-SynthDigits| Train Loss: 2.1985 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.4088 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.3328 | Train Acc: 0.1379
 Site-MNIST     | Val  Loss: 2.0731 | Val  Acc: 0.3077
 Site-MNIST     | Val  Loss: 2.0413 | Val  Acc: 0.3590
 Site-SVHN      | Val  Loss: 2.2575 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 2.3415 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 2.1069 | Val  Acc: 0.3824
 Site-USPS      | Val  Loss: 2.0644 | Val  Acc: 0.3913
 Site-SynthDigits| Val  Loss: 2.1772 | Val  Acc: 0.2414
 Site-SynthDigits| Val  Loss: 2.2079 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 2.4002 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.3428 | Val  Acc: 0.1026
Average Valid Accuracy: 0.2447
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3077
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3590
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1837
 Best site-USPS       | Epoch:2 | Val Acc: 0.3824
 Best site-USPS       | Epoch:2 | Val Acc: 0.3913
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2414
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2069
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 3 ============
 Site-MNIST     | Train Loss: 1.9629 | Train Acc: 0.3220
 Site-MNIST     | Train Loss: 1.9128 | Train Acc: 0.4237
 Site-SVHN      | Train Loss: 2.2955 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.2203 | Train Acc: 0.2027
 Site-USPS      | Train Loss: 2.0097 | Train Acc: 0.3846
 Site-USPS      | Train Loss: 1.9482 | Train Acc: 0.4231
 Site-SynthDigits| Train Loss: 2.1912 | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: 2.1563 | Train Acc: 0.2159
 Site-MNIST-M   | Train Loss: 2.3959 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.2951 | Train Acc: 0.1379
 Site-MNIST     | Val  Loss: 1.9811 | Val  Acc: 0.3846
 Site-MNIST     | Val  Loss: 1.9422 | Val  Acc: 0.4231
 Site-SVHN      | Val  Loss: 2.2304 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 2.3189 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 2.0330 | Val  Acc: 0.4412
 Site-USPS      | Val  Loss: 1.9756 | Val  Acc: 0.4348
 Site-SynthDigits| Val  Loss: 2.1289 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.1570 | Val  Acc: 0.2069
 Site-MNIST-M   | Val  Loss: 2.3879 | Val  Acc: 0.0526
 Site-MNIST-M   | Val  Loss: 2.3207 | Val  Acc: 0.0769
Average Valid Accuracy: 0.2646
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3846
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4231
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1837
 Best site-USPS       | Epoch:3 | Val Acc: 0.4412
 Best site-USPS       | Epoch:3 | Val Acc: 0.4348
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2069
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.0526
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9004 | Train Acc: 0.3559
 Site-MNIST     | Train Loss: 1.8235 | Train Acc: 0.4746
 Site-SVHN      | Train Loss: 2.2676 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.2021 | Train Acc: 0.2027
 Site-USPS      | Train Loss: 1.8354 | Train Acc: 0.5577
 Site-USPS      | Train Loss: 1.8894 | Train Acc: 0.4712
 Site-SynthDigits| Train Loss: 2.1610 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.1292 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.3657 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.2781 | Train Acc: 0.1379
 Site-MNIST     | Val  Loss: 1.8982 | Val  Acc: 0.4872
 Site-MNIST     | Val  Loss: 1.8508 | Val  Acc: 0.4872
 Site-SVHN      | Val  Loss: 2.2007 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 2.2921 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 1.9500 | Val  Acc: 0.4412
 Site-USPS      | Val  Loss: 1.8815 | Val  Acc: 0.4928
 Site-SynthDigits| Val  Loss: 2.0780 | Val  Acc: 0.2759
 Site-SynthDigits| Val  Loss: 2.1085 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.3773 | Val  Acc: 0.0526
 Site-MNIST-M   | Val  Loss: 2.2961 | Val  Acc: 0.0769
Average Valid Accuracy: 0.2905
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4872
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4872
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1837
 Best site-USPS       | Epoch:4 | Val Acc: 0.4412
 Best site-USPS       | Epoch:4 | Val Acc: 0.4928
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2759
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0526
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 5 ============
 Site-MNIST     | Train Loss: 1.8122 | Train Acc: 0.4407
 Site-MNIST     | Train Loss: 1.7440 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.2164 | Train Acc: 0.1351
 Site-SVHN      | Train Loss: 2.1590 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.7656 | Train Acc: 0.5577
 Site-USPS      | Train Loss: 1.7978 | Train Acc: 0.5481
 Site-SynthDigits| Train Loss: 2.1152 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.0619 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.3450 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.2575 | Train Acc: 0.1552
 Site-MNIST     | Val  Loss: 1.8240 | Val  Acc: 0.5641
 Site-MNIST     | Val  Loss: 1.7681 | Val  Acc: 0.5128
 Site-SVHN      | Val  Loss: 2.1786 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 2.2654 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 1.8561 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.7885 | Val  Acc: 0.5652
 Site-SynthDigits| Val  Loss: 2.0223 | Val  Acc: 0.3103
 Site-SynthDigits| Val  Loss: 2.0506 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.3629 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.2721 | Val  Acc: 0.1026
Average Valid Accuracy: 0.3252
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5641
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5128
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1837
 Best site-USPS       | Epoch:5 | Val Acc: 0.5000
 Best site-USPS       | Epoch:5 | Val Acc: 0.5652
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3103
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 6 ============
 Site-MNIST     | Train Loss: 1.7476 | Train Acc: 0.5424
 Site-MNIST     | Train Loss: 1.6714 | Train Acc: 0.5593
 Site-SVHN      | Train Loss: 2.2146 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.1474 | Train Acc: 0.2027
 Site-USPS      | Train Loss: 1.6568 | Train Acc: 0.5577
 Site-USPS      | Train Loss: 1.7199 | Train Acc: 0.5865
 Site-SynthDigits| Train Loss: 2.0750 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.0181 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.3355 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.2271 | Train Acc: 0.2241
 Site-MNIST     | Val  Loss: 1.7532 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.6905 | Val  Acc: 0.6026
 Site-SVHN      | Val  Loss: 2.1594 | Val  Acc: 0.1667
 Site-SVHN      | Val  Loss: 2.2385 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 1.7659 | Val  Acc: 0.6176
 Site-USPS      | Val  Loss: 1.7054 | Val  Acc: 0.6232
 Site-SynthDigits| Val  Loss: 1.9767 | Val  Acc: 0.3793
 Site-SynthDigits| Val  Loss: 1.9989 | Val  Acc: 0.2931
 Site-MNIST-M   | Val  Loss: 2.3422 | Val  Acc: 0.1053
 Site-MNIST-M   | Val  Loss: 2.2470 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3792
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6026
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1667
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1837
 Best site-USPS       | Epoch:6 | Val Acc: 0.6176
 Best site-USPS       | Epoch:6 | Val Acc: 0.6232
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3793
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2931
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1053
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.1538
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 7 ============
 Site-MNIST     | Train Loss: 1.6591 | Train Acc: 0.5763
 Site-MNIST     | Train Loss: 1.6126 | Train Acc: 0.6102
 Site-SVHN      | Train Loss: 2.2195 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.1289 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.6773 | Train Acc: 0.6154
 Site-USPS      | Train Loss: 1.6688 | Train Acc: 0.6346
 Site-SynthDigits| Train Loss: 2.0469 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 1.9583 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.3044 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.2018 | Train Acc: 0.2069
 Site-MNIST     | Val  Loss: 1.6852 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.6217 | Val  Acc: 0.6538
 Site-SVHN      | Val  Loss: 2.1385 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.2172 | Val  Acc: 0.1837
 Site-USPS      | Val  Loss: 1.6898 | Val  Acc: 0.6176
 Site-USPS      | Val  Loss: 1.6324 | Val  Acc: 0.6812
 Site-SynthDigits| Val  Loss: 1.9331 | Val  Acc: 0.4483
 Site-SynthDigits| Val  Loss: 1.9516 | Val  Acc: 0.3276
 Site-MNIST-M   | Val  Loss: 2.3208 | Val  Acc: 0.1579
 Site-MNIST-M   | Val  Loss: 2.2260 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4125
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6538
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1837
 Best site-USPS       | Epoch:7 | Val Acc: 0.6176
 Best site-USPS       | Epoch:7 | Val Acc: 0.6812
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4483
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3276
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1579
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.1795
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 8 ============
 Site-MNIST     | Train Loss: 1.6143 | Train Acc: 0.6271
 Site-MNIST     | Train Loss: 1.5490 | Train Acc: 0.6864
 Site-SVHN      | Train Loss: 2.1556 | Train Acc: 0.1351
 Site-SVHN      | Train Loss: 2.1123 | Train Acc: 0.2568
 Site-USPS      | Train Loss: 1.5566 | Train Acc: 0.6538
 Site-USPS      | Train Loss: 1.5763 | Train Acc: 0.7212
 Site-SynthDigits| Train Loss: 2.0067 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 1.9516 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.2871 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.1605 | Train Acc: 0.2414
 Site-MNIST     | Val  Loss: 1.6206 | Val  Acc: 0.7179
 Site-MNIST     | Val  Loss: 1.5519 | Val  Acc: 0.7179
 Site-SVHN      | Val  Loss: 2.1271 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.2056 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.6030 | Val  Acc: 0.7059
 Site-USPS      | Val  Loss: 1.5573 | Val  Acc: 0.7391
 Site-SynthDigits| Val  Loss: 1.8856 | Val  Acc: 0.5172
 Site-SynthDigits| Val  Loss: 1.9084 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.3043 | Val  Acc: 0.2105
 Site-MNIST-M   | Val  Loss: 2.2026 | Val  Acc: 0.1795
Average Valid Accuracy: 0.4545
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7179
 Best site-MNIST      | Epoch:8 | Val Acc: 0.7179
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2041
 Best site-USPS       | Epoch:8 | Val Acc: 0.7059
 Best site-USPS       | Epoch:8 | Val Acc: 0.7391
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5172
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.2105
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.1795
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5562 | Train Acc: 0.6441
 Site-MNIST     | Train Loss: 1.4908 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.2114 | Train Acc: 0.1351
 Site-SVHN      | Train Loss: 2.0858 | Train Acc: 0.2568
 Site-USPS      | Train Loss: 1.5122 | Train Acc: 0.6923
 Site-USPS      | Train Loss: 1.5291 | Train Acc: 0.7788
 Site-SynthDigits| Train Loss: 1.9902 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 1.8842 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.2629 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.1518 | Train Acc: 0.2759
 Site-MNIST     | Val  Loss: 1.5630 | Val  Acc: 0.7436
 Site-MNIST     | Val  Loss: 1.4937 | Val  Acc: 0.7308
 Site-SVHN      | Val  Loss: 2.1080 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1855 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.5360 | Val  Acc: 0.7353
 Site-USPS      | Val  Loss: 1.4917 | Val  Acc: 0.7681
 Site-SynthDigits| Val  Loss: 1.8501 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 1.8721 | Val  Acc: 0.3621
 Site-MNIST-M   | Val  Loss: 2.2855 | Val  Acc: 0.2105
 Site-MNIST-M   | Val  Loss: 2.1829 | Val  Acc: 0.2308
Average Valid Accuracy: 0.4676
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7436
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7308
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2041
 Best site-USPS       | Epoch:9 | Val Acc: 0.7353
 Best site-USPS       | Epoch:9 | Val Acc: 0.7681
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3621
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2105
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.5543
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2463
 Test site-USPS      | Epoch:9 | Test Acc: 0.6667
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.3346
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.2371
Average Test Accuracy: 0.4078
============ Train epoch 10 ============
 Site-MNIST     | Train Loss: 1.4961 | Train Acc: 0.6441
 Site-MNIST     | Train Loss: 1.4381 | Train Acc: 0.7203
 Site-SVHN      | Train Loss: 2.1563 | Train Acc: 0.1081
 Site-SVHN      | Train Loss: 2.0789 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.4860 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.4708 | Train Acc: 0.7692
 Site-SynthDigits| Train Loss: 1.9557 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 1.8947 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.2428 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.1161 | Train Acc: 0.2931
 Site-MNIST     | Val  Loss: 1.5085 | Val  Acc: 0.7436
 Site-MNIST     | Val  Loss: 1.4376 | Val  Acc: 0.7692
 Site-SVHN      | Val  Loss: 2.0925 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1656 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.4696 | Val  Acc: 0.7647
 Site-USPS      | Val  Loss: 1.4254 | Val  Acc: 0.7971
 Site-SynthDigits| Val  Loss: 1.8163 | Val  Acc: 0.4828
 Site-SynthDigits| Val  Loss: 1.8334 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.2664 | Val  Acc: 0.2105
 Site-MNIST-M   | Val  Loss: 2.1602 | Val  Acc: 0.2564
Average Valid Accuracy: 0.4816
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7436
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7692
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2041
 Best site-USPS       | Epoch:10 | Val Acc: 0.7647
 Best site-USPS       | Epoch:10 | Val Acc: 0.7971
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.4828
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3793
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.2105
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.2564
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 11 ============
 Site-MNIST     | Train Loss: 1.4494 | Train Acc: 0.6780
 Site-MNIST     | Train Loss: 1.3782 | Train Acc: 0.7542
 Site-SVHN      | Train Loss: 2.1721 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.0644 | Train Acc: 0.2838
 Site-USPS      | Train Loss: 1.4728 | Train Acc: 0.7692
 Site-USPS      | Train Loss: 1.4081 | Train Acc: 0.7885
 Site-SynthDigits| Train Loss: 1.9190 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 1.8274 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.2304 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.1053 | Train Acc: 0.2931
 Site-MNIST     | Val  Loss: 1.4584 | Val  Acc: 0.7692
 Site-MNIST     | Val  Loss: 1.3857 | Val  Acc: 0.7821
 Site-SVHN      | Val  Loss: 2.0718 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1441 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.4115 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 1.3720 | Val  Acc: 0.8116
 Site-SynthDigits| Val  Loss: 1.7747 | Val  Acc: 0.5862
 Site-SynthDigits| Val  Loss: 1.7900 | Val  Acc: 0.4483
 Site-MNIST-M   | Val  Loss: 2.2473 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.1389 | Val  Acc: 0.2564
Average Valid Accuracy: 0.5123
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7692
 Best site-MNIST      | Epoch:11 | Val Acc: 0.7821
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2041
 Best site-USPS       | Epoch:11 | Val Acc: 0.7941
 Best site-USPS       | Epoch:11 | Val Acc: 0.8116
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5862
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.4483
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.2564
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 12 ============
 Site-MNIST     | Train Loss: 1.3830 | Train Acc: 0.6949
 Site-MNIST     | Train Loss: 1.3456 | Train Acc: 0.7797
 Site-SVHN      | Train Loss: 2.1494 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.0378 | Train Acc: 0.3108
 Site-USPS      | Train Loss: 1.4234 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.3613 | Train Acc: 0.7981
 Site-SynthDigits| Train Loss: 1.8941 | Train Acc: 0.2955
 Site-SynthDigits| Train Loss: 1.7783 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.2096 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.0773 | Train Acc: 0.2931
 Site-MNIST     | Val  Loss: 1.4098 | Val  Acc: 0.7949
 Site-MNIST     | Val  Loss: 1.3367 | Val  Acc: 0.7821
 Site-SVHN      | Val  Loss: 2.0599 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1196 | Val  Acc: 0.2449
 Site-USPS      | Val  Loss: 1.3629 | Val  Acc: 0.7941
 Site-USPS      | Val  Loss: 1.3256 | Val  Acc: 0.8116
 Site-SynthDigits| Val  Loss: 1.7287 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.7475 | Val  Acc: 0.5345
 Site-MNIST-M   | Val  Loss: 2.2281 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.1145 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5371
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7949
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7821
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2449
 Best site-USPS       | Epoch:12 | Val Acc: 0.7941
 Best site-USPS       | Epoch:12 | Val Acc: 0.8116
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.5345
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 13 ============
 Site-MNIST     | Train Loss: 1.3629 | Train Acc: 0.7288
 Site-MNIST     | Train Loss: 1.2921 | Train Acc: 0.7881
 Site-SVHN      | Train Loss: 2.1347 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0122 | Train Acc: 0.3378
 Site-USPS      | Train Loss: 1.3276 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.3214 | Train Acc: 0.8269
 Site-SynthDigits| Train Loss: 1.8667 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.7729 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.1974 | Train Acc: 0.0345
 Site-MNIST-M   | Train Loss: 2.0714 | Train Acc: 0.3103
 Site-MNIST     | Val  Loss: 1.3677 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.2937 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 2.0337 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.1011 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.3234 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.2877 | Val  Acc: 0.8406
 Site-SynthDigits| Val  Loss: 1.7020 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.7201 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.2139 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.0918 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5524
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8462
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2083
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2041
 Best site-USPS       | Epoch:13 | Val Acc: 0.8529
 Best site-USPS       | Epoch:13 | Val Acc: 0.8406
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.2994 | Train Acc: 0.7119
 Site-MNIST     | Train Loss: 1.2897 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.1806 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 1.9951 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.2865 | Train Acc: 0.8269
 Site-USPS      | Train Loss: 1.2609 | Train Acc: 0.8269
 Site-SynthDigits| Train Loss: 1.8331 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.7492 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.1556 | Train Acc: 0.1034
 Site-MNIST-M   | Train Loss: 2.0573 | Train Acc: 0.2931
 Site-MNIST     | Val  Loss: 1.3297 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.2506 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 2.0193 | Val  Acc: 0.2500
 Site-SVHN      | Val  Loss: 2.0947 | Val  Acc: 0.2245
 Site-USPS      | Val  Loss: 1.2836 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.2454 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.6840 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.6965 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1913 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.0757 | Val  Acc: 0.2564
Average Valid Accuracy: 0.5610
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8462
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2500
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2245
 Best site-USPS       | Epoch:14 | Val Acc: 0.8529
 Best site-USPS       | Epoch:14 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.2564
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 15 ============
 Site-MNIST     | Train Loss: 1.3049 | Train Acc: 0.7119
 Site-MNIST     | Train Loss: 1.2223 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1363 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 1.9789 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.2299 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.2600 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7783 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.6958 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1535 | Train Acc: 0.1034
 Site-MNIST-M   | Train Loss: 2.0117 | Train Acc: 0.3103
 Site-MNIST     | Val  Loss: 1.2944 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.2146 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 2.0112 | Val  Acc: 0.2083
 Site-SVHN      | Val  Loss: 2.0806 | Val  Acc: 0.2041
 Site-USPS      | Val  Loss: 1.2450 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.2044 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.6476 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.6615 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.1800 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.0548 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5539
============ Train epoch 16 ============
 Site-MNIST     | Train Loss: 1.2372 | Train Acc: 0.7288
 Site-MNIST     | Train Loss: 1.1883 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0661 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 1.9705 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 1.2458 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.2006 | Train Acc: 0.8269
 Site-SynthDigits| Train Loss: 1.7727 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.6739 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.1151 | Train Acc: 0.1379
 Site-MNIST-M   | Train Loss: 1.9666 | Train Acc: 0.3103
 Site-MNIST     | Val  Loss: 1.2611 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 1.1809 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 1.9916 | Val  Acc: 0.2500
 Site-SVHN      | Val  Loss: 2.0598 | Val  Acc: 0.2245
 Site-USPS      | Val  Loss: 1.2024 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.1639 | Val  Acc: 0.8406
 Site-SynthDigits| Val  Loss: 1.6065 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.6191 | Val  Acc: 0.5172
 Site-MNIST-M   | Val  Loss: 2.1593 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 2.0242 | Val  Acc: 0.2821
Average Valid Accuracy: 0.5578
============ Train epoch 17 ============
 Site-MNIST     | Train Loss: 1.2184 | Train Acc: 0.7288
 Site-MNIST     | Train Loss: 1.1427 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0603 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.9564 | Train Acc: 0.3378
 Site-USPS      | Train Loss: 1.1760 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.1672 | Train Acc: 0.8462
 Site-SynthDigits| Train Loss: 1.7519 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.6494 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.0930 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.9338 | Train Acc: 0.3276
 Site-MNIST     | Val  Loss: 1.2353 | Val  Acc: 0.8462
 Site-MNIST     | Val  Loss: 1.1558 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 1.9829 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.0316 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.1676 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 1.1339 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.5784 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.5875 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 2.1297 | Val  Acc: 0.2105
 Site-MNIST-M   | Val  Loss: 2.0057 | Val  Acc: 0.3077
Average Valid Accuracy: 0.5808
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8462
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8462
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2857
 Best site-USPS       | Epoch:17 | Val Acc: 0.8824
 Best site-USPS       | Epoch:17 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.2105
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 18 ============
 Site-MNIST     | Train Loss: 1.1933 | Train Acc: 0.7458
 Site-MNIST     | Train Loss: 1.1126 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.1320 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9372 | Train Acc: 0.3243
 Site-USPS      | Train Loss: 1.1600 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.1621 | Train Acc: 0.8365
 Site-SynthDigits| Train Loss: 1.7285 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 1.6256 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 2.0957 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.9266 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.1871 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.1086 | Val  Acc: 0.8462
 Site-SVHN      | Val  Loss: 1.9496 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 2.0071 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.1385 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.1076 | Val  Acc: 0.8551
 Site-SynthDigits| Val  Loss: 1.5544 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5578 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 2.1027 | Val  Acc: 0.3158
 Site-MNIST-M   | Val  Loss: 1.9742 | Val  Acc: 0.3077
Average Valid Accuracy: 0.5944
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8462
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2857
 Best site-USPS       | Epoch:18 | Val Acc: 0.8529
 Best site-USPS       | Epoch:18 | Val Acc: 0.8551
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3158
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.1482 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 1.0667 | Train Acc: 0.8051
 Site-SVHN      | Train Loss: 2.0754 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.9225 | Train Acc: 0.3378
 Site-USPS      | Train Loss: 1.0135 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 1.1057 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.6947 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 1.5977 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0701 | Train Acc: 0.1724
 Site-MNIST-M   | Train Loss: 1.8980 | Train Acc: 0.3621
 Site-MNIST     | Val  Loss: 1.1556 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.0767 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.9346 | Val  Acc: 0.2917
 Site-SVHN      | Val  Loss: 1.9957 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 1.1100 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 1.0784 | Val  Acc: 0.8696
 Site-SynthDigits| Val  Loss: 1.5354 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5387 | Val  Acc: 0.5690
 Site-MNIST-M   | Val  Loss: 2.0764 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 1.9447 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5886
============ Train epoch 20 ============
 Site-MNIST     | Train Loss: 1.1119 | Train Acc: 0.7797
 Site-MNIST     | Train Loss: 1.1208 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.0562 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8971 | Train Acc: 0.3649
 Site-USPS      | Train Loss: 1.0823 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 1.0766 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6761 | Train Acc: 0.2955
 Site-SynthDigits| Train Loss: 1.5929 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 2.0702 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.8737 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.1515 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.0766 | Val  Acc: 0.8590
 Site-SVHN      | Val  Loss: 1.9043 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.9666 | Val  Acc: 0.3265
 Site-USPS      | Val  Loss: 1.0776 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 1.0401 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.5026 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.5091 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 2.0565 | Val  Acc: 0.2632
 Site-MNIST-M   | Val  Loss: 1.9208 | Val  Acc: 0.2821
Average Valid Accuracy: 0.6024
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8590
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:20 | Val Acc: 0.3265
 Best site-USPS       | Epoch:20 | Val Acc: 0.8824
 Best site-USPS       | Epoch:20 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.6034
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.2632
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 21 ============
 Site-MNIST     | Train Loss: 1.0920 | Train Acc: 0.7627
 Site-MNIST     | Train Loss: 1.0302 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.0755 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8874 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 1.0944 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 1.0608 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6299 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 1.5319 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0568 | Train Acc: 0.2069
 Site-MNIST-M   | Train Loss: 1.8566 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 1.1109 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.0388 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.8804 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.9545 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 1.0488 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 1.0092 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.4789 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4843 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 2.0249 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 1.8949 | Val  Acc: 0.3590
Average Valid Accuracy: 0.6273
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8718
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8846
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3333
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3469
 Best site-USPS       | Epoch:21 | Val Acc: 0.8824
 Best site-USPS       | Epoch:21 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4211
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.3590
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 22 ============
 Site-MNIST     | Train Loss: 1.0605 | Train Acc: 0.7797
 Site-MNIST     | Train Loss: 0.9823 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.1004 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8688 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 1.0541 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 1.0265 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.6156 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.5290 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0310 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.8501 | Train Acc: 0.3793
 Site-MNIST     | Val  Loss: 1.0829 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 1.0115 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.8765 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.9508 | Val  Acc: 0.3265
 Site-USPS      | Val  Loss: 1.0276 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.9829 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.4516 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4621 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 2.0153 | Val  Acc: 0.3684
 Site-MNIST-M   | Val  Loss: 1.8876 | Val  Acc: 0.3333
Average Valid Accuracy: 0.6131
============ Train epoch 23 ============
 Site-MNIST     | Train Loss: 1.0356 | Train Acc: 0.7797
 Site-MNIST     | Train Loss: 0.9845 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9430 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8468 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 1.0093 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 1.0101 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.5816 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.4894 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0076 | Train Acc: 0.2414
 Site-MNIST-M   | Train Loss: 1.8238 | Train Acc: 0.3966
 Site-MNIST     | Val  Loss: 1.0633 | Val  Acc: 0.8718
 Site-MNIST     | Val  Loss: 0.9937 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.8396 | Val  Acc: 0.3333
 Site-SVHN      | Val  Loss: 1.9295 | Val  Acc: 0.3265
 Site-USPS      | Val  Loss: 1.0087 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.9572 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.4290 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4360 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 1.9953 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 1.8542 | Val  Acc: 0.3590
Average Valid Accuracy: 0.6266
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.0134 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.9634 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9477 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.8140 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 0.9527 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.9952 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.5770 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.4962 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.9677 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7897 | Train Acc: 0.4310
 Site-MNIST     | Val  Loss: 1.0383 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.9702 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.8289 | Val  Acc: 0.3750
 Site-SVHN      | Val  Loss: 1.9081 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.9869 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.9354 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.4108 | Val  Acc: 0.6897
 Site-SynthDigits| Val  Loss: 1.4152 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.9724 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.8289 | Val  Acc: 0.4103
Average Valid Accuracy: 0.6495
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:24 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3750
 Best site-SVHN       | Epoch:24 | Val Acc: 0.3673
 Best site-USPS       | Epoch:24 | Val Acc: 0.8824
 Best site-USPS       | Epoch:24 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.6897
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.6034
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 25 ============
 Site-MNIST     | Train Loss: 1.0157 | Train Acc: 0.7966
 Site-MNIST     | Train Loss: 0.9326 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9912 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.8194 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.9795 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.9687 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.5473 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.4615 | Train Acc: 0.5795
 Site-MNIST-M   | Train Loss: 1.9697 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.7659 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 1.0124 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.9459 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.8162 | Val  Acc: 0.4167
 Site-SVHN      | Val  Loss: 1.8968 | Val  Acc: 0.3673
 Site-USPS      | Val  Loss: 0.9685 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.9157 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.3938 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3961 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.9499 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.8081 | Val  Acc: 0.4359
Average Valid Accuracy: 0.6528
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:25 | Val Acc: 0.4167
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3673
 Best site-USPS       | Epoch:25 | Val Acc: 0.8824
 Best site-USPS       | Epoch:25 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.6034
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 26 ============
 Site-MNIST     | Train Loss: 0.9826 | Train Acc: 0.8136
 Site-MNIST     | Train Loss: 0.9575 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 2.0360 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 1.8007 | Train Acc: 0.3919
 Site-USPS      | Train Loss: 0.8963 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.9416 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.5441 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4440 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.9656 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.7008 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.0067 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.9381 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.7991 | Val  Acc: 0.4167
 Site-SVHN      | Val  Loss: 1.8894 | Val  Acc: 0.3265
 Site-USPS      | Val  Loss: 0.9495 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.9003 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.3722 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3764 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.9179 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.7791 | Val  Acc: 0.4359
Average Valid Accuracy: 0.6489
============ Train epoch 27 ============
 Site-MNIST     | Train Loss: 0.9455 | Train Acc: 0.8305
 Site-MNIST     | Train Loss: 0.8915 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 1.9323 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.7960 | Train Acc: 0.4189
 Site-USPS      | Train Loss: 1.0043 | Train Acc: 0.8269
 Site-USPS      | Train Loss: 0.9281 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.5279 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.4137 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.9462 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.7022 | Train Acc: 0.4655
 Site-MNIST     | Val  Loss: 0.9771 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.9100 | Val  Acc: 0.8846
 Site-SVHN      | Val  Loss: 1.7789 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8725 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 0.9305 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.8790 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.3523 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3576 | Val  Acc: 0.6034
 Site-MNIST-M   | Val  Loss: 1.9024 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 1.7699 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6509
============ Train epoch 28 ============
 Site-MNIST     | Train Loss: 0.9517 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.8981 | Train Acc: 0.8390
 Site-SVHN      | Train Loss: 1.9274 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7665 | Train Acc: 0.4459
 Site-USPS      | Train Loss: 0.9333 | Train Acc: 0.8846
 Site-USPS      | Train Loss: 0.9232 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.5073 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.4071 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.9202 | Train Acc: 0.3103
 Site-MNIST-M   | Train Loss: 1.6732 | Train Acc: 0.4655
 Site-MNIST     | Val  Loss: 0.9541 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.8882 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.7481 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8535 | Val  Acc: 0.4286
 Site-USPS      | Val  Loss: 0.9158 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.8621 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.3399 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3407 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.8558 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.7338 | Val  Acc: 0.4359
Average Valid Accuracy: 0.6633
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8974
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4583
 Best site-SVHN       | Epoch:28 | Val Acc: 0.4286
 Best site-USPS       | Epoch:28 | Val Acc: 0.8529
 Best site-USPS       | Epoch:28 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.6207
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.9276 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.9155 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 1.8797 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.7543 | Train Acc: 0.4459
 Site-USPS      | Train Loss: 0.8459 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.9014 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.4687 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3689 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.9003 | Train Acc: 0.2759
 Site-MNIST-M   | Train Loss: 1.6899 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.9442 | Val  Acc: 0.8974
 Site-MNIST     | Val  Loss: 0.8783 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.7405 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.8313 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.8918 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.8361 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.3143 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3190 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.8498 | Val  Acc: 0.4211
 Site-MNIST-M   | Val  Loss: 1.7256 | Val  Acc: 0.4359
Average Valid Accuracy: 0.6616
============ Train epoch 30 ============
 Site-MNIST     | Train Loss: 0.8926 | Train Acc: 0.8475
 Site-MNIST     | Train Loss: 0.8728 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9220 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.7365 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.9243 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.8554 | Train Acc: 0.8654
 Site-SynthDigits| Train Loss: 1.4617 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3921 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.8817 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.6668 | Train Acc: 0.4483
 Site-MNIST     | Val  Loss: 0.9162 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.8524 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.7210 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.8183 | Val  Acc: 0.4490
 Site-USPS      | Val  Loss: 0.8787 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.8223 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.2964 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.3033 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.8178 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.7062 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6762
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:30 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:30 | Val Acc: 0.4490
 Best site-USPS       | Epoch:30 | Val Acc: 0.8529
 Best site-USPS       | Epoch:30 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.6552
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.6379
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 31 ============
 Site-MNIST     | Train Loss: 0.8829 | Train Acc: 0.8644
 Site-MNIST     | Train Loss: 0.8317 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.8194 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.7222 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.9117 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.8761 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.4499 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 1.3496 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.8462 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.6224 | Train Acc: 0.4828
 Site-MNIST     | Val  Loss: 0.9126 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.8511 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.7062 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7916 | Val  Acc: 0.4082
 Site-USPS      | Val  Loss: 0.8668 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.8117 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.2761 | Val  Acc: 0.6552
 Site-SynthDigits| Val  Loss: 1.2806 | Val  Acc: 0.6379
 Site-MNIST-M   | Val  Loss: 1.7748 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.6724 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6751
============ Train epoch 32 ============
 Site-MNIST     | Train Loss: 0.8569 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.8097 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.7977 | Train Acc: 0.3243
 Site-SVHN      | Train Loss: 1.7163 | Train Acc: 0.4459
 Site-USPS      | Train Loss: 0.8142 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.8456 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.4369 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 1.3506 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.8193 | Train Acc: 0.3448
 Site-MNIST-M   | Train Loss: 1.6233 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 0.8859 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.8255 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6854 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7820 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.8522 | Val  Acc: 0.8529
 Site-USPS      | Val  Loss: 0.7966 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.2606 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2640 | Val  Acc: 0.6724
 Site-MNIST-M   | Val  Loss: 1.7601 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.6577 | Val  Acc: 0.4615
Average Valid Accuracy: 0.6928
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:32 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:32 | Val Acc: 0.4694
 Best site-USPS       | Epoch:32 | Val Acc: 0.8529
 Best site-USPS       | Epoch:32 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.6724
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 33 ============
 Site-MNIST     | Train Loss: 0.8477 | Train Acc: 0.8814
 Site-MNIST     | Train Loss: 0.7928 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9491 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.6939 | Train Acc: 0.5270
 Site-USPS      | Train Loss: 0.7704 | Train Acc: 0.8462
 Site-USPS      | Train Loss: 0.8273 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3782 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.3390 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.8243 | Train Acc: 0.3793
 Site-MNIST-M   | Train Loss: 1.5978 | Train Acc: 0.5345
 Site-MNIST     | Val  Loss: 0.8632 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.8022 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.6795 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7662 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.8376 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7879 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.2433 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.2477 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.7245 | Val  Acc: 0.5789
 Site-MNIST-M   | Val  Loss: 1.6406 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7107
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:33 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:33 | Val Acc: 0.4694
 Best site-USPS       | Epoch:33 | Val Acc: 0.8824
 Best site-USPS       | Epoch:33 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.5789
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.7993 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.7859 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 1.9580 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.6550 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.8827 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.8448 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3816 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.2887 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.8101 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.5806 | Train Acc: 0.5172
 Site-MNIST     | Val  Loss: 0.8575 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7950 | Val  Acc: 0.8974
 Site-SVHN      | Val  Loss: 1.6863 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.7458 | Val  Acc: 0.4898
 Site-USPS      | Val  Loss: 0.8302 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7871 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.2232 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.2286 | Val  Acc: 0.6724
 Site-MNIST-M   | Val  Loss: 1.6865 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.6135 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7143
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8974
 Best site-SVHN       | Epoch:34 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:34 | Val Acc: 0.4898
 Best site-USPS       | Epoch:34 | Val Acc: 0.8824
 Best site-USPS       | Epoch:34 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.6724
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 35 ============
 Site-MNIST     | Train Loss: 0.7860 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.7635 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9194 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.6464 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.8117 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.8066 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3537 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.2757 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.7734 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.5314 | Train Acc: 0.5517
 Site-MNIST     | Val  Loss: 0.8478 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7838 | Val  Acc: 0.9231
 Site-SVHN      | Val  Loss: 1.6774 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7212 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.8179 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7717 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.2073 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.2144 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.6788 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5967 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7089
============ Train epoch 36 ============
 Site-MNIST     | Train Loss: 0.7893 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.7401 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8555 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.6451 | Train Acc: 0.4865
 Site-USPS      | Train Loss: 0.9147 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.8056 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3772 | Train Acc: 0.6591
 Site-SynthDigits| Train Loss: 1.2767 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.7769 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.5203 | Train Acc: 0.5517
 Site-MNIST     | Val  Loss: 0.8338 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7720 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6510 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.7020 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.8023 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7532 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.1898 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1985 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.6614 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5815 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7099
============ Train epoch 37 ============
 Site-MNIST     | Train Loss: 0.7816 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.7556 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.9021 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 1.6407 | Train Acc: 0.5000
 Site-USPS      | Train Loss: 0.7576 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7595 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3447 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.2560 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.7359 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.5361 | Train Acc: 0.5345
 Site-MNIST     | Val  Loss: 0.8257 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7653 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6353 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6815 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.7871 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7359 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.1748 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1828 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.6409 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5621 | Val  Acc: 0.5128
Average Valid Accuracy: 0.7074
============ Train epoch 38 ============
 Site-MNIST     | Train Loss: 0.7720 | Train Acc: 0.8983
 Site-MNIST     | Train Loss: 0.7599 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8027 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.5974 | Train Acc: 0.5270
 Site-USPS      | Train Loss: 0.8177 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7815 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.3241 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 1.2427 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.7100 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 1.5221 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.8117 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7525 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6205 | Val  Acc: 0.4583
 Site-SVHN      | Val  Loss: 1.6682 | Val  Acc: 0.4694
 Site-USPS      | Val  Loss: 0.7772 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7228 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.1608 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.1704 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.6336 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5480 | Val  Acc: 0.5128
Average Valid Accuracy: 0.6991
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.7395 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.7406 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7529 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.6062 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.7684 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7540 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3032 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 1.2171 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.7025 | Train Acc: 0.4138
 Site-MNIST-M   | Train Loss: 1.4898 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.7917 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7337 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6155 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6622 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.7620 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7148 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.1481 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1546 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.5899 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5290 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7154
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5306
 Best site-USPS       | Epoch:39 | Val Acc: 0.8824
 Best site-USPS       | Epoch:39 | Val Acc: 0.9130
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.7069
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.4737
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.7864
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3295
 Test site-USPS      | Epoch:39 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.5530
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.3850
Average Test Accuracy: 0.5807
============ Train epoch 40 ============
 Site-MNIST     | Train Loss: 0.7314 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.7446 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.8418 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.5842 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.7667 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7490 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.3308 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.1973 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.6885 | Train Acc: 0.4483
 Site-MNIST-M   | Train Loss: 1.4659 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.7810 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7227 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.6189 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6316 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.7529 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.7113 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.1365 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1429 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.5630 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.5157 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7175
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:40 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:40 | Val Acc: 0.5306
 Best site-USPS       | Epoch:40 | Val Acc: 0.8824
 Best site-USPS       | Epoch:40 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 41 ============
 Site-MNIST     | Train Loss: 0.7084 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.7409 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7913 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.5711 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.7669 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7442 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.2852 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.1975 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.6872 | Train Acc: 0.4828
 Site-MNIST-M   | Train Loss: 1.4408 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.7824 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7242 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5848 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6051 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.7466 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6990 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.1197 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1260 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.5669 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.5056 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7139
============ Train epoch 42 ============
 Site-MNIST     | Train Loss: 0.7198 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6981 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8172 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.5593 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 0.8159 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7372 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.2235 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.1569 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.6915 | Train Acc: 0.5172
 Site-MNIST-M   | Train Loss: 1.4413 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.7710 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.7112 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5709 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5913 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.7291 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6816 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.1019 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1142 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.5785 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.5040 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7242
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:42 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:42 | Val Acc: 0.5306
 Best site-USPS       | Epoch:42 | Val Acc: 0.8824
 Best site-USPS       | Epoch:42 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 43 ============
 Site-MNIST     | Train Loss: 0.6872 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.7183 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8525 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.5377 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.6747 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7101 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.2508 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.1455 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 1.6792 | Train Acc: 0.5172
 Site-MNIST-M   | Train Loss: 1.4097 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.7547 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6964 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5636 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5682 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.7073 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6657 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.0936 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.1075 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.5194 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.4754 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7131
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.6855 | Train Acc: 0.9153
 Site-MNIST     | Train Loss: 0.6719 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6060 | Train Acc: 0.4054
 Site-SVHN      | Train Loss: 1.5079 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.6897 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6992 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.2527 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 1.1363 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.6506 | Train Acc: 0.5517
 Site-MNIST-M   | Train Loss: 1.4119 | Train Acc: 0.6034
 Site-MNIST     | Val  Loss: 0.7417 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6838 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5643 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.5375 | Val  Acc: 0.5102
 Site-USPS      | Val  Loss: 0.6971 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6588 | Val  Acc: 0.9130
 Site-SynthDigits| Val  Loss: 1.0810 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0962 | Val  Acc: 0.7069
 Site-MNIST-M   | Val  Loss: 1.4609 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.4516 | Val  Acc: 0.5385
Average Valid Accuracy: 0.7082
============ Train epoch 45 ============
 Site-MNIST     | Train Loss: 0.6908 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6447 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6377 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 1.4870 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.6334 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.7172 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.1940 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.1389 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.6322 | Train Acc: 0.5517
 Site-MNIST-M   | Train Loss: 1.3810 | Train Acc: 0.6207
 Site-MNIST     | Val  Loss: 0.7261 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6709 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5417 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5395 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 0.6863 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6476 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.0568 | Val  Acc: 0.7241
 Site-SynthDigits| Val  Loss: 1.0752 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4635 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.4371 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7309
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:45 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:45 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:45 | Val Acc: 0.5714
 Best site-USPS       | Epoch:45 | Val Acc: 0.8824
 Best site-USPS       | Epoch:45 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.7241
 Best site-SynthDigits | Epoch:45 | Val Acc: 0.7414
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:45 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 46 ============
 Site-MNIST     | Train Loss: 0.6594 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6259 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.8664 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 1.4642 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 0.6848 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6816 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.1883 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1449 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.5867 | Train Acc: 0.6207
 Site-MNIST-M   | Train Loss: 1.3567 | Train Acc: 0.6379
 Site-MNIST     | Val  Loss: 0.7190 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6644 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5212 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5269 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.6848 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6443 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 1.0366 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0589 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.4448 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.4191 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7351
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:46 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:46 | Val Acc: 0.5417
 Best site-SVHN       | Epoch:46 | Val Acc: 0.5510
 Best site-USPS       | Epoch:46 | Val Acc: 0.8824
 Best site-USPS       | Epoch:46 | Val Acc: 0.8841
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.7586
 Best site-SynthDigits | Epoch:46 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.5263
 Best site-MNIST-M    | Epoch:46 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
============ Train epoch 47 ============
 Site-MNIST     | Train Loss: 0.6734 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6313 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7444 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 1.4526 | Train Acc: 0.6081
 Site-USPS      | Train Loss: 0.6746 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6727 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.1664 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.1129 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.5886 | Train Acc: 0.6552
 Site-MNIST-M   | Train Loss: 1.3691 | Train Acc: 0.5862
 Site-MNIST     | Val  Loss: 0.7071 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6528 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.5006 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.5084 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.6684 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6332 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 1.0150 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0401 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.4162 | Val  Acc: 0.5263
 Site-MNIST-M   | Val  Loss: 1.3957 | Val  Acc: 0.5897
Average Valid Accuracy: 0.7323
============ Train epoch 48 ============
 Site-MNIST     | Train Loss: 0.6404 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6503 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.6821 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.4385 | Train Acc: 0.5541
 Site-USPS      | Train Loss: 0.7593 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6429 | Train Acc: 0.8750
 Site-SynthDigits| Train Loss: 1.1541 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.0770 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 1.5611 | Train Acc: 0.6552
 Site-MNIST-M   | Train Loss: 1.3352 | Train Acc: 0.6207
 Site-MNIST     | Val  Loss: 0.7047 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6502 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4765 | Val  Acc: 0.5417
 Site-SVHN      | Val  Loss: 1.4791 | Val  Acc: 0.5510
 Site-USPS      | Val  Loss: 0.6563 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6196 | Val  Acc: 0.8841
 Site-SynthDigits| Val  Loss: 0.9964 | Val  Acc: 0.7586
 Site-SynthDigits| Val  Loss: 1.0253 | Val  Acc: 0.7414
 Site-MNIST-M   | Val  Loss: 1.3989 | Val  Acc: 0.4737
 Site-MNIST-M   | Val  Loss: 1.3817 | Val  Acc: 0.5641
Average Valid Accuracy: 0.7230
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.6186 | Train Acc: 0.9322
 Site-MNIST     | Train Loss: 0.6299 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.7630 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.4253 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.5979 | Train Acc: 0.8654
 Site-USPS      | Train Loss: 0.6469 | Train Acc: 0.8846
 Site-SynthDigits| Train Loss: 1.1528 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.0757 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 1.5947 | Train Acc: 0.5862
 Site-MNIST-M   | Train Loss: 1.3198 | Train Acc: 0.6207
 Site-MNIST     | Val  Loss: 0.6938 | Val  Acc: 0.9231
 Site-MNIST     | Val  Loss: 0.6409 | Val  Acc: 0.9103
 Site-SVHN      | Val  Loss: 1.4660 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.4403 | Val  Acc: 0.5306
 Site-USPS      | Val  Loss: 0.6413 | Val  Acc: 0.8824
 Site-USPS      | Val  Loss: 0.6067 | Val  Acc: 0.8986
 Site-SynthDigits| Val  Loss: 0.9935 | Val  Acc: 0.8276
 Site-SynthDigits| Val  Loss: 1.0201 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3590 | Val  Acc: 0.6316
 Site-MNIST-M   | Val  Loss: 1.3678 | Val  Acc: 0.6154
Average Valid Accuracy: 0.7478
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9231
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9103
 Best site-SVHN       | Epoch:49 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:49 | Val Acc: 0.5306
 Best site-USPS       | Epoch:49 | Val Acc: 0.8824
 Best site-USPS       | Epoch:49 | Val Acc: 0.8986
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.8276
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.6316
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.6154
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/drfl...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.7964
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3547
 Test site-USPS      | Epoch:49 | Test Acc: 0.8333
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.5924
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4186
Average Test Accuracy: 0.5991
===2023-04-18 20:39:41===
===2023-04-18 20:39:43===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[59,118,37,74,52,104,44,88,29,58,]
label set of clients: [10, 10, 9, 10, 10, 10, 10, 10, 10, 10, ]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8000
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3526
 Test site-USPS      | Epoch:49 | Test Acc: 0.8441
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.5908
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.4150
Average Test Accuracy: 0.6005
