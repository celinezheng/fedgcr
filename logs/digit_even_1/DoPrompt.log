===2023-04-05 23:28:08===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
===2023-04-05 23:28:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9134 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.7888 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.2402 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1890 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7903 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 1.8122 | Train Acc: 0.5682
 Site-SynthDigits| Train Loss: 2.1311 | Train Acc: 0.2841
 Site-SynthDigits| Train Loss: 2.1146 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2162 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.1677 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.8474 | Val  Acc: 0.4915
 Site-MNIST     | Val  Loss: 1.8052 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.2113 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2230 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.8482 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 1.7869 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.1313 | Val  Acc: 0.2203
 Site-SynthDigits| Val  Loss: 2.1094 | Val  Acc: 0.3220
 Site-MNIST-M   | Val  Loss: 2.1597 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1791 | Val  Acc: 0.1864
Average Valid Accuracy: 0.3559
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4915
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1864
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2203
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3220
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1864
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.5537 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.4877 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1468 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1038 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.4379 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 1.4779 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 1.9790 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 1.9445 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.1003 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.0323 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.5245 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4413 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1282 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1273 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.5075 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4458 | Val  Acc: 0.6780
 Site-SynthDigits| Val  Loss: 1.9798 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.9238 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.0263 | Val  Acc: 0.2712
 Site-MNIST-M   | Val  Loss: 2.0476 | Val  Acc: 0.2203
Average Valid Accuracy: 0.4593
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.6780
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.3206 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.2317 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1067 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0470 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1533 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2213 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8372 | Train Acc: 0.3977
 Site-SynthDigits| Train Loss: 1.8154 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 2.0065 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 1.8962 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.3036 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.1996 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.0785 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0619 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.2511 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1908 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8670 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.7803 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.9182 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9378 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5169
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2203
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.1167 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.0468 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0383 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9639 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.0372 | Train Acc: 0.8295
 Site-USPS      | Train Loss: 1.0417 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.7280 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 1.7158 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.9166 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.8183 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.1224 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.9984 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 2.0348 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0044 | Val  Acc: 0.2373
 Site-USPS      | Val  Loss: 1.0682 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0157 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7739 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 1.6697 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8207 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 1.8390 | Val  Acc: 0.4237
Average Valid Accuracy: 0.5559
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-USPS       | Epoch:3 | Val Acc: 0.8136
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.9231 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.8997 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9955 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.9233 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 0.8730 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.8878 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.6441 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.6370 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.8107 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.7330 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.9660 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.8139 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9892 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9530 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.9101 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.8549 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.6832 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.5727 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7404 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.7506 | Val  Acc: 0.5085
Average Valid Accuracy: 0.5966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.8283 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 0.7580 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.9822 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8890 | Train Acc: 0.3295
 Site-USPS      | Train Loss: 0.7567 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.8085 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.5779 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.5294 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.7595 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.6554 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.8385 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6941 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.9615 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9099 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.8161 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.7534 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.5765 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4906 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.6550 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.6585 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8644
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.7143 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6879 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.9112 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8600 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.6838 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.7029 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.4907 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.4483 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.6654 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.5678 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.7446 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.6005 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.8985 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.8776 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.7202 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6633 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.5078 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.4123 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.5808 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.5810 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6424
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3051
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.6417 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6145 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 1.9216 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8302 | Train Acc: 0.3523
 Site-USPS      | Train Loss: 0.6148 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6445 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.3900 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.3874 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.5759 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.4645 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.6745 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5391 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.8995 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8487 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.6767 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.6067 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.4315 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.3576 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.4802 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.4875 | Val  Acc: 0.6271
Average Valid Accuracy: 0.6559
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2881
 Best site-USPS       | Epoch:7 | Val Acc: 0.8814
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6271
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5527 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5107 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.8506 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.7928 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.5652 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.6023 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.3418 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 1.3114 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.5848 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.4433 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.5957 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4636 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.8617 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.8202 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.6039 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5425 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.3532 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.2978 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4513 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.4476 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6814
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3390
 Best site-USPS       | Epoch:8 | Val Acc: 0.8814
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.5479 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4983 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 1.8255 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7463 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.5480 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5657 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 1.2846 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 1.2183 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.4742 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.3036 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.5799 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.4481 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.8384 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8017 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.5967 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5223 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.2607 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.2271 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.3384 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.3392 | Val  Acc: 0.6780
Average Valid Accuracy: 0.6712
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 0.4515 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4365 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.8118 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7456 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.4771 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4899 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2616 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 1.1788 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.4576 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.2912 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.4969 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3755 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.8149 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7767 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.4996 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4576 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.2116 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.1911 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3246 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.3176 | Val  Acc: 0.7119
Average Valid Accuracy: 0.6983
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:10 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:10 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:10 | Val Acc: 0.3051
 Best site-USPS       | Epoch:10 | Val Acc: 0.8814
 Best site-USPS       | Epoch:10 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 0.4625 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4525 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.7680 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7296 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.4868 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5029 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.1940 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 1.1298 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.3739 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.1992 | Train Acc: 0.6705
 Site-MNIST     | Val  Loss: 0.4937 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.3694 | Val  Acc: 0.9153
 Site-SVHN      | Val  Loss: 1.7766 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7718 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.5122 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.4464 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.1655 | Val  Acc: 0.6102
 Site-SynthDigits| Val  Loss: 1.1388 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.2289 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.2291 | Val  Acc: 0.7119
Average Valid Accuracy: 0.7034
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:11 | Val Acc: 0.9153
 Best site-SVHN       | Epoch:11 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:11 | Val Acc: 0.3390
 Best site-USPS       | Epoch:11 | Val Acc: 0.8814
 Best site-USPS       | Epoch:11 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6102
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 0.3879 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3631 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.7633 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.7113 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4318 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4545 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.1607 | Train Acc: 0.6705
 Site-SynthDigits| Train Loss: 1.0277 | Train Acc: 0.7159
 Site-MNIST-M   | Train Loss: 1.3635 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.1993 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.4170 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3070 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7642 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.7407 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.4480 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4028 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0803 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 1.1065 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.2217 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.2245 | Val  Acc: 0.7119
Average Valid Accuracy: 0.7203
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:12 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:12 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:12 | Val Acc: 0.3220
 Best site-USPS       | Epoch:12 | Val Acc: 0.8983
 Best site-USPS       | Epoch:12 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7119
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 0.3892 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3775 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.7535 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7111 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.4102 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4262 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 1.0535 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.9929 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 1.2067 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.0791 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.4400 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3214 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.7151 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7146 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.4243 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3863 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0116 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.0544 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1046 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.0979 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7322
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:13 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:13 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:13 | Val Acc: 0.3051
 Best site-USPS       | Epoch:13 | Val Acc: 0.8983
 Best site-USPS       | Epoch:13 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 0.3334 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3125 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.7251 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.6501 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.3884 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.4060 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 1.0580 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.9160 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 1.2819 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.0831 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.3673 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2628 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.7076 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.7061 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.4249 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3678 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.9067 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.0261 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 1.1073 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.1125 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7492
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:14 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:14 | Val Acc: 0.3390
 Best site-USPS       | Epoch:14 | Val Acc: 0.9153
 Best site-USPS       | Epoch:14 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 0.3419 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3228 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.6446 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.6874 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.4118 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.3999 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9968 | Train Acc: 0.7045
 Site-SynthDigits| Train Loss: 0.9103 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.1406 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 0.9563 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.3722 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2778 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.6864 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6650 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.4034 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3597 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.9364 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 0.9953 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 0.9954 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.9860 | Val  Acc: 0.7458
Average Valid Accuracy: 0.7508
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:15 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3898
 Best site-USPS       | Epoch:15 | Val Acc: 0.8983
 Best site-USPS       | Epoch:15 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 0.2642 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2819 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.7271 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7016 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.3617 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.3344 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 1.0475 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.7948 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 1.2021 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.0197 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.3332 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2355 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.6572 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6882 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 0.3539 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.3183 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8025 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.9508 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 1.0260 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 1.0427 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7661
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:16 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:16 | Val Acc: 0.3390
 Best site-USPS       | Epoch:16 | Val Acc: 0.9322
 Best site-USPS       | Epoch:16 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 0.3180 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2842 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.5885 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6510 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.3618 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3454 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.9314 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.8329 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.0370 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.8727 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.3314 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2454 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.6521 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6355 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.3620 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3218 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.8594 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 0.9247 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 0.8948 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.8838 | Val  Acc: 0.8305
Average Valid Accuracy: 0.7712
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:17 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:17 | Val Acc: 0.3898
 Best site-USPS       | Epoch:17 | Val Acc: 0.8983
 Best site-USPS       | Epoch:17 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.8305
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 0.2536 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2517 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.6843 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.6393 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.3031 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2966 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9137 | Train Acc: 0.7614
 Site-SynthDigits| Train Loss: 0.7134 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 1.1153 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8413 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.2953 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2105 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.6519 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 1.6464 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.3132 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2804 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.7260 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.8783 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.8814 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.9139 | Val  Acc: 0.8475
Average Valid Accuracy: 0.7898
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:18 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:18 | Val Acc: 0.3729
 Best site-USPS       | Epoch:18 | Val Acc: 0.9492
 Best site-USPS       | Epoch:18 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8475
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 0.2515 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2533 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.5964 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.5465 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.3190 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3167 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9094 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 0.7635 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.9217 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.7727 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.2975 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2183 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.5719 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5838 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.3194 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2914 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.7936 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.8633 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.8020 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.8061 | Val  Acc: 0.8475
Average Valid Accuracy: 0.7797
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 0.2370 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2728 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.6252 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.4686 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.2814 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2924 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.8412 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.6929 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.9146 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.7369 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.2762 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1986 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.5552 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5803 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.2774 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2606 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.7058 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.8282 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.7674 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.7795 | Val  Acc: 0.8644
Average Valid Accuracy: 0.8119
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:20 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:20 | Val Acc: 0.4068
 Best site-USPS       | Epoch:20 | Val Acc: 0.9492
 Best site-USPS       | Epoch:20 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 0.2628 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2449 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.6222 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.4799 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.3072 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3046 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.8005 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.6807 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.9701 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7007 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.2915 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.1959 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.4946 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.5414 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.3071 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2771 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6920 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.7835 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.7272 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.7892 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8034
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 0.2182 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2127 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.5132 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.5719 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.2695 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2627 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.7676 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 0.7199 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.7914 | Train Acc: 0.7614
 Site-MNIST-M   | Train Loss: 0.6578 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2466 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1862 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.6025 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5431 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.2589 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2372 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.7083 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 0.7546 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.6885 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.6774 | Val  Acc: 0.8475
Average Valid Accuracy: 0.8102
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 0.2324 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2192 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.5717 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.4288 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.3209 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.3259 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.7440 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5916 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.9295 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.6173 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.2544 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1706 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4335 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 1.5094 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.3320 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.2784 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6257 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.7147 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.6513 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.7055 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8186
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:23 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:23 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:23 | Val Acc: 0.4407
 Best site-USPS       | Epoch:23 | Val Acc: 0.8983
 Best site-USPS       | Epoch:23 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 0.2169 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2097 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.5575 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5560 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.2349 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2437 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.7102 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.5992 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.7433 | Train Acc: 0.8523
 Site-MNIST-M   | Train Loss: 0.5676 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2457 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1814 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.5491 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.5343 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 0.2287 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2186 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.6181 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.7282 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 0.6182 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5994 | Val  Acc: 0.9322
Average Valid Accuracy: 0.8305
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:24 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:24 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:24 | Val Acc: 0.4576
 Best site-USPS       | Epoch:24 | Val Acc: 0.9661
 Best site-USPS       | Epoch:24 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:24 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:24 | Val Acc: 0.9322
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 0.2005 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2062 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.5161 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.4256 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2788 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.2885 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.7493 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5645 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.9169 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.6213 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2407 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1653 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.4527 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.5074 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.2804 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2431 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5965 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.6818 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.6742 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.6908 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8254
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 0.2114 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2401 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.4328 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.3944 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2181 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.2109 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.6928 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.5675 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.6735 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.5141 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.2455 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.1730 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.4261 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.4433 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.2090 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.2070 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.5894 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.6534 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.5873 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.5337 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8441
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:26 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:26 | Val Acc: 0.4746
 Best site-USPS       | Epoch:26 | Val Acc: 0.9661
 Best site-USPS       | Epoch:26 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 0.1676 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1947 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3939 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.4410 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2745 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.2546 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.6700 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.5191 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7861 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 0.4867 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.2353 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.1501 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.4678 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.4497 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.2616 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.2359 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5384 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.6407 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.5292 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.5852 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8390
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 0.1863 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1676 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.3330 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.4063 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.1904 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.2177 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6601 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.6050 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.6182 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.4931 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2037 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1620 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.3737 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3974 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.2027 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1981 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.6473 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 0.6276 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.5488 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.5002 | Val  Acc: 0.9661
Average Valid Accuracy: 0.8424
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 0.1669 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1946 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.4603 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 1.4567 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.2816 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.2652 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.6985 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4955 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.7796 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.4661 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2216 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.1469 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4642 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.4780 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 0.2706 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2465 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.4956 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.6832 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.4775 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5447 | Val  Acc: 0.9153
Average Valid Accuracy: 0.8373
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 0.1349 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1624 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.3042 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.2725 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2145 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.2223 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6556 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5252 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.5660 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4379 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1830 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1381 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.3062 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3270 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.2009 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.2165 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.6304 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 0.6042 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4966 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.4519 | Val  Acc: 0.9831
Average Valid Accuracy: 0.8559
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:30 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:30 | Val Acc: 0.4915
 Best site-USPS       | Epoch:30 | Val Acc: 0.9831
 Best site-USPS       | Epoch:30 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 0.2020 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1557 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3546 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.3327 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2523 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.2526 | Train Acc: 0.9205
 Site-SynthDigits| Train Loss: 0.6671 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4236 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.7356 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 0.4287 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1761 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1389 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.3349 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.4028 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.2476 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.2227 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.4367 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.6172 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.4522 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5091 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8492
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 0.1448 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1414 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3251 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.2423 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.2118 | Train Acc: 0.9205
 Site-USPS      | Train Loss: 0.1986 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.6077 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.5567 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.5407 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.3647 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1727 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1347 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.1966 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.3216 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.1983 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1842 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.6030 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.6055 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 0.4402 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3981 | Val  Acc: 0.9661
Average Valid Accuracy: 0.8593
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:32 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:32 | Val Acc: 0.5254
 Best site-USPS       | Epoch:32 | Val Acc: 0.9661
 Best site-USPS       | Epoch:32 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.9661
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 0.1571 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1458 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.2182 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.4241 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.1680 | Train Acc: 0.9659
 Site-USPS      | Train Loss: 0.1929 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5720 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.4302 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.7574 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4544 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1722 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1207 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.4471 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.3326 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.1849 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1822 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4500 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.5371 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.5044 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.5116 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8525
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 0.1317 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1549 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.2821 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.1554 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.2023 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1623 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5791 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4892 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.5048 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.3665 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1828 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1351 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.1417 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.2391 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.1597 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1695 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.5426 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 0.5460 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.4162 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3894 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8712
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:34 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:34 | Val Acc: 0.4915
 Best site-USPS       | Epoch:34 | Val Acc: 0.9831
 Best site-USPS       | Epoch:34 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 0.1523 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1335 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.2499 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 1.2889 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.1444 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1882 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5613 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.3763 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5154 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.3227 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1655 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1130 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.2592 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.2767 | Val  Acc: 0.4915
 Site-USPS      | Val  Loss: 0.1787 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1617 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3937 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5287 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.3941 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3695 | Val  Acc: 0.9661
Average Valid Accuracy: 0.8695
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 0.1304 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1355 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3859 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.1359 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.1990 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.1670 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5573 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.4452 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.4986 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.2880 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1595 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1267 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.1487 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.2361 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.1552 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.1732 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.5075 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.5157 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.3692 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.3402 | Val  Acc: 0.9831
Average Valid Accuracy: 0.8746
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:36 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:36 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:36 | Val Acc: 0.4746
 Best site-USPS       | Epoch:36 | Val Acc: 0.9831
 Best site-USPS       | Epoch:36 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:36 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:36 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 0.1551 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1284 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.2317 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.1526 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.1527 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.2132 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.5310 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 0.3755 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5528 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.3188 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1443 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1156 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.1934 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.2546 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.1912 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1707 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3963 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.4996 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 0.3631 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3727 | Val  Acc: 0.9831
Average Valid Accuracy: 0.8763
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:37 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:37 | Val Acc: 0.5085
 Best site-USPS       | Epoch:37 | Val Acc: 0.9661
 Best site-USPS       | Epoch:37 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 0.1215 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1469 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.1874 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 1.2709 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.1852 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1507 | Train Acc: 0.9886
 Site-SynthDigits| Train Loss: 0.4857 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 0.4737 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.4585 | Train Acc: 0.8977
 Site-MNIST-M   | Train Loss: 0.2515 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1793 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1101 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.2959 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.2367 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.1404 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1631 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4997 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 0.5053 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.3393 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3017 | Val  Acc: 0.9831
Average Valid Accuracy: 0.8729
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 0.1305 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1068 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.1881 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.0378 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.1244 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1689 | Train Acc: 0.9659
 Site-SynthDigits| Train Loss: 0.6359 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 0.3188 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.5091 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.2666 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1311 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0981 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 1.0529 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.1795 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 0.1550 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1520 | Val  Acc: 0.9831
 Site-SynthDigits| Val  Loss: 0.3640 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 0.5201 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.3387 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.3352 | Val  Acc: 0.9831
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:39 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:39 | Val Acc: 0.5424
 Best site-USPS       | Epoch:39 | Val Acc: 0.9661
 Best site-USPS       | Epoch:39 | Val Acc: 0.9831
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/DoPrompt...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8500
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2992
 Test site-USPS      | Epoch:39 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.6006
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.4579
Average Test Accuracy: 0.6168
===2023-04-06 01:49:24===
===2023-04-06 01:49:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8500
 Test site-SVHN      | Epoch:39 | Test Acc: 0.2992
 Test site-USPS      | Epoch:39 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.6006
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.4579
Average Test Accuracy: 0.6168
