===2023-04-06 13:34:19===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2512 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.2340 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2819 | Train Acc: 0.1477
 Site-SVHN      | Train Loss: 2.2800 | Train Acc: 0.1250
 Site-USPS      | Train Loss: 2.2341 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 2.2425 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 2.2965 | Train Acc: 0.1705
 Site-SynthDigits| Train Loss: 2.2862 | Train Acc: 0.0682
 Site-MNIST-M   | Train Loss: 2.2861 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.3037 | Train Acc: 0.1364
 Site-MNIST     | Val  Loss: 2.2478 | Val  Acc: 0.2203
 Site-MNIST     | Val  Loss: 2.2209 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2907 | Val  Acc: 0.0847
 Site-SVHN      | Val  Loss: 2.2695 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 2.2460 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 2.2494 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.2797 | Val  Acc: 0.0508
 Site-SynthDigits| Val  Loss: 2.2933 | Val  Acc: 0.1864
 Site-MNIST-M   | Val  Loss: 2.3041 | Val  Acc: 0.1017
 Site-MNIST-M   | Val  Loss: 2.2909 | Val  Acc: 0.1695
Average Valid Accuracy: 0.1983
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0847
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-USPS       | Epoch:0 | Val Acc: 0.3559
 Best site-USPS       | Epoch:0 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0508
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1864
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1017
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.2060 | Train Acc: 0.2045
 Site-MNIST     | Train Loss: 2.1703 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.2668 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.2703 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 2.1742 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 2.1996 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.2807 | Train Acc: 0.2159
 Site-SynthDigits| Train Loss: 2.2731 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.2747 | Train Acc: 0.1705
 Site-MNIST-M   | Train Loss: 2.2890 | Train Acc: 0.1705
 Site-MNIST     | Val  Loss: 2.1940 | Val  Acc: 0.3051
 Site-MNIST     | Val  Loss: 2.1643 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.2730 | Val  Acc: 0.1356
 Site-SVHN      | Val  Loss: 2.2579 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.1868 | Val  Acc: 0.3898
 Site-USPS      | Val  Loss: 2.1922 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.2654 | Val  Acc: 0.1186
 Site-SynthDigits| Val  Loss: 2.2859 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2866 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2735 | Val  Acc: 0.2034
Average Valid Accuracy: 0.2508
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1356
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2542
 Best site-USPS       | Epoch:1 | Val Acc: 0.3898
 Best site-USPS       | Epoch:1 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1186
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.1626 | Train Acc: 0.2841
 Site-MNIST     | Train Loss: 2.1216 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 2.2538 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2550 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 2.1232 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 2.1281 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.2699 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.2548 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2679 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.2736 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 2.1411 | Val  Acc: 0.3220
 Site-MNIST     | Val  Loss: 2.1091 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.2572 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2481 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 2.1290 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 2.1377 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 2.2508 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 2.2775 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2700 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2573 | Val  Acc: 0.2542
Average Valid Accuracy: 0.2983
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3220
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-USPS       | Epoch:2 | Val Acc: 0.4237
 Best site-USPS       | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.1115 | Train Acc: 0.3295
 Site-MNIST     | Train Loss: 2.0536 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 2.2423 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2396 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 2.0689 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 2.0707 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.2556 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.2447 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2531 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2561 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 2.0903 | Val  Acc: 0.3898
 Site-MNIST     | Val  Loss: 2.0563 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 2.2419 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2394 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0735 | Val  Acc: 0.4576
 Site-USPS      | Val  Loss: 2.0855 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 2.2354 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 2.2675 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.2543 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2421 | Val  Acc: 0.2881
Average Valid Accuracy: 0.3390
 Best site-MNIST      | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2542
 Best site-USPS       | Epoch:3 | Val Acc: 0.4576
 Best site-USPS       | Epoch:3 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2881
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 2.0798 | Train Acc: 0.3295
 Site-MNIST     | Train Loss: 2.0161 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 2.2314 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2267 | Train Acc: 0.2273
 Site-USPS      | Train Loss: 1.9920 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 2.0262 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 2.2490 | Train Acc: 0.3523
 Site-SynthDigits| Train Loss: 2.2306 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.2466 | Train Acc: 0.2273
 Site-MNIST-M   | Train Loss: 2.2338 | Train Acc: 0.3409
 Site-MNIST     | Val  Loss: 2.0433 | Val  Acc: 0.4068
 Site-MNIST     | Val  Loss: 2.0056 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 2.2274 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2317 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 2.0197 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 2.0349 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.2194 | Val  Acc: 0.2712
 Site-SynthDigits| Val  Loss: 2.2550 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.2393 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.2277 | Val  Acc: 0.3051
Average Valid Accuracy: 0.3610
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4068
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2881
 Best site-USPS       | Epoch:4 | Val Acc: 0.5254
 Best site-USPS       | Epoch:4 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2712
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 2.0241 | Train Acc: 0.3750
 Site-MNIST     | Train Loss: 1.9375 | Train Acc: 0.5000
 Site-SVHN      | Train Loss: 2.2160 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.2185 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.9598 | Train Acc: 0.5795
 Site-USPS      | Train Loss: 1.9804 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 2.2208 | Train Acc: 0.3182
 Site-SynthDigits| Train Loss: 2.2084 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2327 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 2.2121 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.9998 | Val  Acc: 0.4407
 Site-MNIST     | Val  Loss: 1.9585 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2148 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2248 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.9699 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.9867 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 2.2023 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 2.2408 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.2250 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.2141 | Val  Acc: 0.3220
Average Valid Accuracy: 0.3780
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4407
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2881
 Best site-USPS       | Epoch:5 | Val Acc: 0.5593
 Best site-USPS       | Epoch:5 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 2.0047 | Train Acc: 0.3864
 Site-MNIST     | Train Loss: 1.9008 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 2.2114 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2054 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.9152 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 1.9255 | Train Acc: 0.5455
 Site-SynthDigits| Train Loss: 2.2117 | Train Acc: 0.3409
 Site-SynthDigits| Train Loss: 2.1905 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.2302 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.2104 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.9570 | Val  Acc: 0.4576
 Site-MNIST     | Val  Loss: 1.9120 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.2034 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2180 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.9232 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 1.9420 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 2.1856 | Val  Acc: 0.3051
 Site-SynthDigits| Val  Loss: 2.2251 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2115 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.2018 | Val  Acc: 0.3559
Average Valid Accuracy: 0.3983
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4576
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2881
 Best site-USPS       | Epoch:6 | Val Acc: 0.5593
 Best site-USPS       | Epoch:6 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3051
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.9735 | Train Acc: 0.3977
 Site-MNIST     | Train Loss: 1.8722 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 2.1878 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.2050 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.8642 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 1.8691 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.2014 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 2.1757 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.2170 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.1943 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.9199 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.8707 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.1922 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2110 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.8761 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 1.8931 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 2.1704 | Val  Acc: 0.3390
 Site-SynthDigits| Val  Loss: 2.2100 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1978 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.1896 | Val  Acc: 0.4237
Average Valid Accuracy: 0.4237
 Best site-MNIST      | Epoch:7 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2712
 Best site-USPS       | Epoch:7 | Val Acc: 0.6271
 Best site-USPS       | Epoch:7 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3390
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.9155 | Train Acc: 0.4091
 Site-MNIST     | Train Loss: 1.8398 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1927 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1876 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.8230 | Train Acc: 0.6477
 Site-USPS      | Train Loss: 1.8261 | Train Acc: 0.5909
 Site-SynthDigits| Train Loss: 2.1889 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.1580 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.2091 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 2.1859 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.8796 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.8261 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1836 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2040 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.8315 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 1.8491 | Val  Acc: 0.5593
 Site-SynthDigits| Val  Loss: 2.1542 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 2.1949 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1852 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1760 | Val  Acc: 0.4237
Average Valid Accuracy: 0.4288
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2712
 Best site-USPS       | Epoch:8 | Val Acc: 0.6271
 Best site-USPS       | Epoch:8 | Val Acc: 0.5593
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.8954 | Train Acc: 0.4318
 Site-MNIST     | Train Loss: 1.8071 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 2.1746 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1858 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7677 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 1.7963 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.1657 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.1511 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.1975 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1730 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.8451 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7878 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1743 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1970 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 1.7900 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.8056 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1386 | Val  Acc: 0.3220
 Site-SynthDigits| Val  Loss: 2.1790 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1719 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1629 | Val  Acc: 0.4237
Average Valid Accuracy: 0.4305
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2712
 Best site-USPS       | Epoch:9 | Val Acc: 0.6441
 Best site-USPS       | Epoch:9 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3220
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-MNIST     | Train Loss: 1.8471 | Train Acc: 0.4545
 Site-MNIST     | Train Loss: 1.7553 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 2.1795 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1715 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.7288 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 1.7599 | Train Acc: 0.6136
 Site-SynthDigits| Train Loss: 2.1518 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 2.1268 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 2.1887 | Train Acc: 0.2955
 Site-MNIST-M   | Train Loss: 2.1528 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.8079 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.7470 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 2.1656 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1897 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.7505 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 1.7631 | Val  Acc: 0.5932
 Site-SynthDigits| Val  Loss: 2.1236 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 2.1642 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1596 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1500 | Val  Acc: 0.4407
Average Valid Accuracy: 0.4458
 Best site-MNIST      | Epoch:10 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:10 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:10 | Val Acc: 0.2881
 Best site-USPS       | Epoch:10 | Val Acc: 0.6441
 Best site-USPS       | Epoch:10 | Val Acc: 0.5932
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.4407
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-MNIST     | Train Loss: 1.8021 | Train Acc: 0.4773
 Site-MNIST     | Train Loss: 1.7223 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.1718 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1622 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.6708 | Train Acc: 0.7159
 Site-USPS      | Train Loss: 1.7246 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.1341 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.1054 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.1758 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.1545 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.7772 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.7093 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 2.1570 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1835 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.7122 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.7235 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1065 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 2.1460 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.1474 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1367 | Val  Acc: 0.4576
Average Valid Accuracy: 0.4661
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:11 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:11 | Val Acc: 0.2881
 Best site-USPS       | Epoch:11 | Val Acc: 0.6610
 Best site-USPS       | Epoch:11 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-MNIST     | Train Loss: 1.7891 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.6793 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 2.1584 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1412 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.6609 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.6720 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 2.1107 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 2.0951 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.1573 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.1264 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.7480 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6740 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1487 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1748 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.6753 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.6827 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0907 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 2.1281 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.1343 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1227 | Val  Acc: 0.4576
Average Valid Accuracy: 0.4712
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:12 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:12 | Val Acc: 0.2881
 Best site-USPS       | Epoch:12 | Val Acc: 0.6610
 Best site-USPS       | Epoch:12 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.4576
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-MNIST     | Train Loss: 1.7387 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.6499 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 2.1411 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1381 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.6111 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.6380 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 2.1067 | Train Acc: 0.4432
 Site-SynthDigits| Train Loss: 2.0869 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.1553 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 2.1200 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.7191 | Val  Acc: 0.6271
 Site-MNIST     | Val  Loss: 1.6440 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.1403 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1685 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.6394 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.6444 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.0758 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 2.1114 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.1196 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 2.1087 | Val  Acc: 0.4746
Average Valid Accuracy: 0.4763
 Best site-MNIST      | Epoch:13 | Val Acc: 0.6271
 Best site-MNIST      | Epoch:13 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2881
 Best site-USPS       | Epoch:13 | Val Acc: 0.6780
 Best site-USPS       | Epoch:13 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-MNIST     | Train Loss: 1.7259 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.6271 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.1474 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1415 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5871 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5769 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0943 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.0639 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.1413 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0884 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.6858 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6074 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1333 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1607 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.6077 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.6077 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 2.0635 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.0976 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.1060 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0936 | Val  Acc: 0.4915
Average Valid Accuracy: 0.4966
 Best site-MNIST      | Epoch:14 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:14 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2881
 Best site-USPS       | Epoch:14 | Val Acc: 0.6949
 Best site-USPS       | Epoch:14 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-MNIST     | Train Loss: 1.6823 | Train Acc: 0.5568
 Site-MNIST     | Train Loss: 1.6054 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.1279 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.1390 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.5565 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.5695 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 2.0809 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.0459 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.1460 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0886 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.6483 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.5693 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1301 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1586 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.5827 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.5823 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 2.0537 | Val  Acc: 0.3898
 Site-SynthDigits| Val  Loss: 2.0854 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.0951 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0850 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5034
 Best site-MNIST      | Epoch:15 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:15 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:15 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:15 | Val Acc: 0.3051
 Best site-USPS       | Epoch:15 | Val Acc: 0.6780
 Best site-USPS       | Epoch:15 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.3898
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-MNIST     | Train Loss: 1.6733 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.5738 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.1182 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1143 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.5051 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 1.5368 | Train Acc: 0.6818
 Site-SynthDigits| Train Loss: 2.0601 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.0289 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 2.1304 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 2.0733 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.6249 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.5400 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1192 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1499 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.5470 | Val  Acc: 0.6780
 Site-USPS      | Val  Loss: 1.5461 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 2.0309 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 2.0582 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 2.0835 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 2.0744 | Val  Acc: 0.4576
Average Valid Accuracy: 0.5000
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-MNIST     | Train Loss: 1.6149 | Train Acc: 0.6136
 Site-MNIST     | Train Loss: 1.5410 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 2.1174 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.1286 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4958 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.5184 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 2.0435 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 2.0157 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 2.1294 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 2.0635 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.6002 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.5143 | Val  Acc: 0.7288
 Site-SVHN      | Val  Loss: 2.1121 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1416 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.5161 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.5090 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 2.0148 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.0348 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.0658 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0659 | Val  Acc: 0.4746
Average Valid Accuracy: 0.5119
 Best site-MNIST      | Epoch:17 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:17 | Val Acc: 0.7288
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2881
 Best site-USPS       | Epoch:17 | Val Acc: 0.7288
 Best site-USPS       | Epoch:17 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.4746
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-MNIST     | Train Loss: 1.6033 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.4958 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1040 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1283 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4869 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.4708 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 2.0313 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.9834 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.1150 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 2.0447 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.5904 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.4924 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1048 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1331 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.4879 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.4830 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9933 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 2.0084 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.0532 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0524 | Val  Acc: 0.4407
Average Valid Accuracy: 0.5119
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-MNIST     | Train Loss: 1.5640 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.4839 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.0984 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0978 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4244 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.4485 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 2.0135 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.9694 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 2.1130 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0426 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.5511 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4635 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0990 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1241 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.4592 | Val  Acc: 0.6949
 Site-USPS      | Val  Loss: 1.4437 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9863 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.9985 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.0363 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0410 | Val  Acc: 0.5085
Average Valid Accuracy: 0.5305
 Best site-MNIST      | Epoch:19 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:19 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2881
 Best site-USPS       | Epoch:19 | Val Acc: 0.6949
 Best site-USPS       | Epoch:19 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.5671
 Test site-SVHN      | Epoch:19 | Test Acc: 0.2055
 Test site-USPS      | Epoch:19 | Test Acc: 0.7903
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.3679
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.2079
Average Test Accuracy: 0.4278
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-MNIST     | Train Loss: 1.5422 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.4464 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 2.1011 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0807 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.4042 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.3999 | Train Acc: 0.7386
 Site-SynthDigits| Train Loss: 2.0025 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.9694 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.1022 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 2.0317 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.5233 | Val  Acc: 0.6780
 Site-MNIST     | Val  Loss: 1.4333 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.0926 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1204 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.4292 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 1.4143 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.9798 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.9913 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.0272 | Val  Acc: 0.3729
 Site-MNIST-M   | Val  Loss: 2.0278 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5339
 Best site-MNIST      | Epoch:20 | Val Acc: 0.6780
 Best site-MNIST      | Epoch:20 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2881
 Best site-USPS       | Epoch:20 | Val Acc: 0.7119
 Best site-USPS       | Epoch:20 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.3729
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-MNIST     | Train Loss: 1.4994 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.4233 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.0993 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.1045 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.3594 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.3956 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9917 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.9457 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.0853 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0027 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 1.5041 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.4133 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0879 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1124 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.4050 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 1.3861 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9590 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.9667 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 2.0118 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 2.0171 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5458
 Best site-MNIST      | Epoch:21 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:21 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:21 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:21 | Val Acc: 0.3051
 Best site-USPS       | Epoch:21 | Val Acc: 0.7458
 Best site-USPS       | Epoch:21 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-MNIST     | Train Loss: 1.5070 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.4148 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 2.0803 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0842 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.3579 | Train Acc: 0.7841
 Site-USPS      | Train Loss: 1.3685 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 1.9667 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9293 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0838 | Train Acc: 0.4091
 Site-MNIST-M   | Train Loss: 2.0111 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 1.4809 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.3864 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0811 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1102 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3792 | Val  Acc: 0.7458
 Site-USPS      | Val  Loss: 1.3615 | Val  Acc: 0.8136
 Site-SynthDigits| Val  Loss: 1.9468 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.9515 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9978 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.0077 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5475
 Best site-MNIST      | Epoch:22 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:22 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2881
 Best site-USPS       | Epoch:22 | Val Acc: 0.7458
 Best site-USPS       | Epoch:22 | Val Acc: 0.8136
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-MNIST     | Train Loss: 1.4356 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.3820 | Train Acc: 0.7614
 Site-SVHN      | Train Loss: 2.0710 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0764 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.3247 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.3423 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9714 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9314 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0726 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.9698 | Train Acc: 0.5114
 Site-MNIST     | Val  Loss: 1.4518 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.3596 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0780 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1036 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.3529 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.3357 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.9478 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.9555 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.9880 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.9918 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5644
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:23 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:23 | Val Acc: 0.3220
 Best site-USPS       | Epoch:23 | Val Acc: 0.7627
 Best site-USPS       | Epoch:23 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-MNIST     | Train Loss: 1.4549 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.3558 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0818 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0726 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.3207 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.3311 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.9455 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.8918 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 2.0732 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.9909 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.4382 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.3408 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0704 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.1001 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.3303 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.3068 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.9162 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.9151 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9814 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 1.9929 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5627
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-MNIST     | Train Loss: 1.4242 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.3580 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0414 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0637 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.2614 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.2800 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.9496 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.9108 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0624 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.9430 | Train Acc: 0.4773
 Site-MNIST     | Val  Loss: 1.4155 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.3182 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0653 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.0951 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.3039 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.2826 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.9140 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.9182 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.9629 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.9824 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5695
 Best site-MNIST      | Epoch:25 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:25 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:25 | Val Acc: 0.3220
 Best site-USPS       | Epoch:25 | Val Acc: 0.7797
 Best site-USPS       | Epoch:25 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-MNIST     | Train Loss: 1.4088 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.3335 | Train Acc: 0.7727
 Site-SVHN      | Train Loss: 2.0610 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0729 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2630 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.2647 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.9228 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.8979 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 2.0350 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9469 | Train Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.4004 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.2973 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0587 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0891 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.2829 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.2598 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.9024 | Val  Acc: 0.5254
 Site-SynthDigits| Val  Loss: 1.9065 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9452 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.9646 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5763
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:26 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:26 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:26 | Val Acc: 0.3220
 Best site-USPS       | Epoch:26 | Val Acc: 0.7966
 Best site-USPS       | Epoch:26 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.5254
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-MNIST     | Train Loss: 1.3779 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.2922 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0453 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0767 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2573 | Train Acc: 0.7955
 Site-USPS      | Train Loss: 1.2579 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 1.9055 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.8548 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 2.0439 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9424 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.3867 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.2818 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0504 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0851 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.2643 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.2419 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.8781 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.8780 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9368 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.9615 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5746
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-MNIST     | Train Loss: 1.3584 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2938 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0567 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0330 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.2197 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2532 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.9068 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 1.8624 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 2.0288 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9417 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 1.3616 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.2586 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0476 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0786 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.2462 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 1.2207 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8773 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.8767 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9279 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.9480 | Val  Acc: 0.5763
Average Valid Accuracy: 0.5814
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:28 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:28 | Val Acc: 0.3220
 Best site-USPS       | Epoch:28 | Val Acc: 0.7797
 Best site-USPS       | Epoch:28 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-MNIST     | Train Loss: 1.3417 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2705 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0302 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 2.0343 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1674 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.2094 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8715 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.8480 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 2.0260 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9383 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.3484 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.2425 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0400 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0771 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.2226 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1959 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8538 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.8519 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.9168 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.9424 | Val  Acc: 0.5424
Average Valid Accuracy: 0.5864
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:29 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:29 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:29 | Val Acc: 0.3220
 Best site-USPS       | Epoch:29 | Val Acc: 0.7966
 Best site-USPS       | Epoch:29 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:29 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:29 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-MNIST     | Train Loss: 1.2869 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.2429 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0345 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0351 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1674 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1743 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8860 | Train Acc: 0.4773
 Site-SynthDigits| Train Loss: 1.8082 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 2.0115 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.8949 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 1.3307 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2256 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 2.0359 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0705 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1983 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1713 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8497 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.8510 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.9021 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.9321 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5898
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:30 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:30 | Val Acc: 0.3220
 Best site-USPS       | Epoch:30 | Val Acc: 0.7966
 Best site-USPS       | Epoch:30 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-MNIST     | Train Loss: 1.2864 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2658 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0464 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0072 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1597 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1710 | Train Acc: 0.8068
 Site-SynthDigits| Train Loss: 1.8686 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.8103 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 2.0125 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.9126 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.3246 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.2119 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0268 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0688 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 1.1798 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1558 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8206 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.8184 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.8978 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.9229 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5932
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:31 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:31 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:31 | Val Acc: 0.3051
 Best site-USPS       | Epoch:31 | Val Acc: 0.7966
 Best site-USPS       | Epoch:31 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:31 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:31 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-MNIST     | Train Loss: 1.2746 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.2016 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 2.0255 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0192 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1173 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1340 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8600 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.7913 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 2.0014 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9022 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.3063 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1987 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0216 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0560 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1601 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.1327 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8039 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.8031 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.8861 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.9079 | Val  Acc: 0.5593
Average Valid Accuracy: 0.5949
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:32 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:32 | Val Acc: 0.3220
 Best site-USPS       | Epoch:32 | Val Acc: 0.8136
 Best site-USPS       | Epoch:32 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-MNIST     | Train Loss: 1.2354 | Train Acc: 0.7386
 Site-MNIST     | Train Loss: 1.2214 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0170 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0118 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1203 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1223 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8398 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7762 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.9924 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.8880 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.2877 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1757 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0165 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0579 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1390 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.1156 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.8004 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.8000 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.8767 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.9034 | Val  Acc: 0.5254
Average Valid Accuracy: 0.5983
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:33 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:33 | Val Acc: 0.3220
 Best site-USPS       | Epoch:33 | Val Acc: 0.8136
 Best site-USPS       | Epoch:33 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.5593
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-MNIST     | Train Loss: 1.2276 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.2033 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9908 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 2.0120 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1158 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.1153 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8488 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7950 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.9798 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.8689 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 1.2594 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1556 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0131 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0474 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.1230 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0983 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.7932 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.7896 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.8664 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.8883 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6034
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:34 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:34 | Val Acc: 0.3390
 Best site-USPS       | Epoch:34 | Val Acc: 0.8136
 Best site-USPS       | Epoch:34 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.5424
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-MNIST     | Train Loss: 1.2152 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1721 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0099 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0019 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.1004 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0864 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 1.8316 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.7400 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.9783 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.8536 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 1.2534 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1478 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 2.0065 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0428 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.1034 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.0795 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.7720 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.7709 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.8566 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.8767 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6034
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-MNIST     | Train Loss: 1.2060 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.1752 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.0020 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 2.0113 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 1.1017 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 1.0937 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8290 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7591 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.9800 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.8961 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 1.2591 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.1433 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.0234 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0688 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 1.1045 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0835 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.7724 | Val  Acc: 0.5424
 Site-SynthDigits| Val  Loss: 1.7788 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8960 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.8766 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6000
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-MNIST     | Train Loss: 1.1774 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1369 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 1.9653 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9916 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0537 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0640 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.8226 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.7258 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.9467 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.8577 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 1.2129 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1131 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9990 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0333 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.0683 | Val  Acc: 0.8305
 Site-USPS      | Val  Loss: 1.0457 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7642 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.7646 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.8394 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.8701 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6051
 Best site-MNIST      | Epoch:37 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:37 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:37 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:37 | Val Acc: 0.3390
 Best site-USPS       | Epoch:37 | Val Acc: 0.8305
 Best site-USPS       | Epoch:37 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-MNIST     | Train Loss: 1.1935 | Train Acc: 0.7727
 Site-MNIST     | Train Loss: 1.1225 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9804 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.9951 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0693 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0412 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.7781 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.7291 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.9403 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.8374 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 1.2045 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.1018 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9942 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0303 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 1.0489 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.0276 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.7441 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.7471 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.8247 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.8577 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6136
 Best site-MNIST      | Epoch:38 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:38 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:38 | Val Acc: 0.3220
 Best site-USPS       | Epoch:38 | Val Acc: 0.8475
 Best site-USPS       | Epoch:38 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5085
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1/PromptFL...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-MNIST     | Train Loss: 1.1610 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1176 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 1.9782 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.9897 | Train Acc: 0.2841
 Site-USPS      | Train Loss: 1.0271 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 0.9900 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.7616 | Train Acc: 0.4886
 Site-SynthDigits| Train Loss: 1.7050 | Train Acc: 0.5341
 Site-MNIST-M   | Train Loss: 1.9432 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.8371 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 1.1981 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.0940 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.9903 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0233 | Val  Acc: 0.3390
 Site-USPS      | Val  Loss: 1.0357 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 1.0161 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.7194 | Val  Acc: 0.5085
 Site-SynthDigits| Val  Loss: 1.7240 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.8266 | Val  Acc: 0.5593
 Site-MNIST-M   | Val  Loss: 1.8439 | Val  Acc: 0.5763
Average Valid Accuracy: 0.6034
===2023-04-06 14:34:57===
===2023-04-06 14:34:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:38 | Test Acc: 0.6821
 Test site-SVHN      | Epoch:38 | Test Acc: 0.2232
 Test site-USPS      | Epoch:38 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:38 | Test Acc: 0.4214
 Test site-MNIST-M   | Epoch:38 | Test Acc: 0.2400
Average Test Accuracy: 0.4832
