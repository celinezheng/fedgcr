===2023-03-26 06:55:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7228 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.7218 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 2.2034 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2352 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.6860 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 1.7513 | Train Acc: 0.6667
 Site-MNIST-M   | Train Loss: 2.1618 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.1493 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.7247 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6664 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2758 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.1878 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7391 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.7180 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 2.1497 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1362 | Val  Acc: 0.2162
Average Valid Accuracy: 0.4223
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.6486
 Best site-USPS       | Epoch:0 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2162
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3360 | Train Acc: 0.6757
 Site-MNIST     | Train Loss: 1.3609 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 2.1296 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.1481 | Train Acc: 0.2613
 Site-USPS      | Train Loss: 1.3125 | Train Acc: 0.7748
 Site-USPS      | Train Loss: 1.3761 | Train Acc: 0.7748
 Site-MNIST-M   | Train Loss: 2.0114 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 1.9938 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.3689 | Val  Acc: 0.7432
 Site-MNIST     | Val  Loss: 1.2859 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.2004 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1090 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.3773 | Val  Acc: 0.7838
 Site-USPS      | Val  Loss: 1.3438 | Val  Acc: 0.7568
 Site-MNIST-M   | Val  Loss: 1.9813 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 1.9781 | Val  Acc: 0.2973
Average Valid Accuracy: 0.5135
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7432
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7838
 Best site-USPS       | Epoch:1 | Val Acc: 0.7568
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0709 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.1106 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 2.0821 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.0889 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 1.0590 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 1.1142 | Train Acc: 0.8288
 Site-MNIST-M   | Train Loss: 1.8921 | Train Acc: 0.3784
 Site-MNIST-M   | Train Loss: 1.8715 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 1.1236 | Val  Acc: 0.8514
 Site-MNIST     | Val  Loss: 1.0367 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 2.1375 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 2.0611 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.1230 | Val  Acc: 0.8378
 Site-USPS      | Val  Loss: 1.0813 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 1.8494 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.8558 | Val  Acc: 0.4054
Average Valid Accuracy: 0.5861
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8890 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.9318 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 2.0384 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.0281 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.8893 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.9406 | Train Acc: 0.8468
 Site-MNIST-M   | Train Loss: 1.7897 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 1.7652 | Train Acc: 0.4414
 Site-MNIST     | Val  Loss: 0.9448 | Val  Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.8679 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 2.0776 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.0089 | Val  Acc: 0.3108
 Site-USPS      | Val  Loss: 0.9477 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.9082 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 1.7392 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 1.7456 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6250
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8919
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3108
 Best site-USPS       | Epoch:3 | Val Acc: 0.8514
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7490 | Train Acc: 0.8559
 Site-MNIST     | Train Loss: 0.7994 | Train Acc: 0.9009
 Site-SVHN      | Train Loss: 1.9980 | Train Acc: 0.2523
 Site-SVHN      | Train Loss: 1.9802 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.7712 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.8176 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 1.6996 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.6738 | Train Acc: 0.4775
 Site-MNIST     | Val  Loss: 0.8079 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.7471 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 2.0333 | Val  Acc: 0.3108
 Site-SVHN      | Val  Loss: 1.9658 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.8235 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.7840 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 1.6411 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.6532 | Val  Acc: 0.5135
Average Valid Accuracy: 0.6486
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3108
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3243
 Best site-USPS       | Epoch:4 | Val Acc: 0.8649
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5135
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6483 | Train Acc: 0.8739
 Site-MNIST     | Train Loss: 0.6940 | Train Acc: 0.9099
 Site-SVHN      | Train Loss: 1.9628 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.9331 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.6895 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.7294 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 1.6168 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.5952 | Train Acc: 0.5495
 Site-MNIST     | Val  Loss: 0.6991 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6570 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.9880 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.9271 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.7355 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.6983 | Val  Acc: 0.8784
 Site-MNIST-M   | Val  Loss: 1.5574 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.5685 | Val  Acc: 0.5811
Average Valid Accuracy: 0.6791
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3649
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5661 | Train Acc: 0.9009
 Site-MNIST     | Train Loss: 0.6124 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.9343 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.9010 | Train Acc: 0.3964
 Site-USPS      | Train Loss: 0.6194 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.6556 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 1.5424 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.5208 | Train Acc: 0.5586
 Site-MNIST     | Val  Loss: 0.6153 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5892 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.9574 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.8923 | Val  Acc: 0.3649
 Site-USPS      | Val  Loss: 0.6624 | Val  Acc: 0.9054
 Site-USPS      | Val  Loss: 0.6264 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 1.4820 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.4910 | Val  Acc: 0.6081
Average Valid Accuracy: 0.6926
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3649
 Best site-USPS       | Epoch:6 | Val Acc: 0.9054
 Best site-USPS       | Epoch:6 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5012 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.5485 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.9030 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8693 | Train Acc: 0.4234
 Site-USPS      | Train Loss: 0.5767 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.6045 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 1.4743 | Train Acc: 0.5315
 Site-MNIST-M   | Train Loss: 1.4579 | Train Acc: 0.5676
 Site-MNIST     | Val  Loss: 0.5447 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.5328 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.9250 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.8672 | Val  Acc: 0.3919
 Site-USPS      | Val  Loss: 0.6137 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.5766 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 1.4165 | Val  Acc: 0.5811
 Site-MNIST-M   | Val  Loss: 1.4214 | Val  Acc: 0.6216
Average Valid Accuracy: 0.7044
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3919
 Best site-USPS       | Epoch:7 | Val Acc: 0.9324
 Best site-USPS       | Epoch:7 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5811
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6216
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4550 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5031 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.8823 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8409 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.5201 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.5491 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 1.4105 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.3924 | Train Acc: 0.5856
 Site-MNIST     | Val  Loss: 0.4941 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4920 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.8938 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.8504 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 0.5565 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.5233 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 1.3516 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.3574 | Val  Acc: 0.6622
Average Valid Accuracy: 0.7095
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3514
 Best site-USPS       | Epoch:8 | Val Acc: 0.9324
 Best site-USPS       | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4091 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.4579 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.8599 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.8180 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 0.5029 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.5278 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 1.3433 | Train Acc: 0.5766
 Site-MNIST-M   | Train Loss: 1.3336 | Train Acc: 0.6126
 Site-MNIST     | Val  Loss: 0.4543 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.4489 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.8682 | Val  Acc: 0.3784
 Site-SVHN      | Val  Loss: 1.8349 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.5329 | Val  Acc: 0.9189
 Site-USPS      | Val  Loss: 0.5025 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 1.2932 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 1.2943 | Val  Acc: 0.6757
Average Valid Accuracy: 0.7179
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3784
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-USPS       | Epoch:9 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6757
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_SynthDigits...
===2023-03-26 07:28:30===
===2023-03-26 07:28:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8293
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2610
 Test site-USPS      | Epoch:9 | Test Acc: 0.8871
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3936
Average Test Accuracy: 0.5927
===2023-03-26 12:04:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SynthDigits: 0.3265
Average Test Accuracy: 0.3265
