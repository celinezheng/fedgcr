===2023-03-26 12:55:02===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2225 | Train Acc: 0.2432
 Site-MNIST     | Train Loss: 2.2270 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2755 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2867 | Train Acc: 0.1171
 Site-USPS      | Train Loss: 2.2157 | Train Acc: 0.3874
 Site-USPS      | Train Loss: 2.2236 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 2.2914 | Train Acc: 0.1441
 Site-MNIST-M   | Train Loss: 2.2900 | Train Acc: 0.1351
 Site-MNIST     | Val  Loss: 2.2402 | Val  Acc: 0.1757
 Site-MNIST     | Val  Loss: 2.2025 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 2.2870 | Val  Acc: 0.1081
 Site-SVHN      | Val  Loss: 2.2832 | Val  Acc: 0.1892
 Site-USPS      | Val  Loss: 2.2234 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 2.2242 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 2.2838 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.3040 | Val  Acc: 0.1486
Average Valid Accuracy: 0.2331
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1081
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-USPS       | Epoch:0 | Val Acc: 0.3378
 Best site-USPS       | Epoch:0 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1560 | Train Acc: 0.3784
 Site-MNIST     | Train Loss: 2.1564 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 2.2581 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.2704 | Train Acc: 0.1622
 Site-USPS      | Train Loss: 2.1346 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 2.1446 | Train Acc: 0.3604
 Site-MNIST-M   | Train Loss: 2.2743 | Train Acc: 0.2072
 Site-MNIST-M   | Train Loss: 2.2695 | Train Acc: 0.1892
 Site-MNIST     | Val  Loss: 2.1756 | Val  Acc: 0.3108
 Site-MNIST     | Val  Loss: 2.1217 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 2.2739 | Val  Acc: 0.0946
 Site-SVHN      | Val  Loss: 2.2666 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 2.1432 | Val  Acc: 0.3514
 Site-USPS      | Val  Loss: 2.1441 | Val  Acc: 0.4324
 Site-MNIST-M   | Val  Loss: 2.2658 | Val  Acc: 0.1622
 Site-MNIST-M   | Val  Loss: 2.2799 | Val  Acc: 0.2297
Average Valid Accuracy: 0.2889
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3108
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0946
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-USPS       | Epoch:1 | Val Acc: 0.3514
 Best site-USPS       | Epoch:1 | Val Acc: 0.4324
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1622
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.0940 | Train Acc: 0.4054
 Site-MNIST     | Train Loss: 2.0912 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 2.2434 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2567 | Train Acc: 0.1712
 Site-USPS      | Train Loss: 2.0582 | Train Acc: 0.4685
 Site-USPS      | Train Loss: 2.0703 | Train Acc: 0.3964
 Site-MNIST-M   | Train Loss: 2.2587 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.2507 | Train Acc: 0.2432
 Site-MNIST     | Val  Loss: 2.1160 | Val  Acc: 0.3514
 Site-MNIST     | Val  Loss: 2.0476 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 2.2627 | Val  Acc: 0.1081
 Site-SVHN      | Val  Loss: 2.2525 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 2.0683 | Val  Acc: 0.4054
 Site-USPS      | Val  Loss: 2.0689 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 2.2488 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2581 | Val  Acc: 0.2973
Average Valid Accuracy: 0.3226
 Best site-MNIST      | Epoch:2 | Val Acc: 0.3514
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1081
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-USPS       | Epoch:2 | Val Acc: 0.4054
 Best site-USPS       | Epoch:2 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.0351 | Train Acc: 0.4144
 Site-MNIST     | Train Loss: 2.0317 | Train Acc: 0.4414
 Site-SVHN      | Train Loss: 2.2302 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2448 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.9865 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 2.0007 | Train Acc: 0.4595
 Site-MNIST-M   | Train Loss: 2.2438 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.2325 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 2.0608 | Val  Acc: 0.4189
 Site-MNIST     | Val  Loss: 1.9797 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 2.2525 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2406 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.9984 | Val  Acc: 0.4730
 Site-USPS      | Val  Loss: 1.9991 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 2.2324 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.2381 | Val  Acc: 0.3514
Average Valid Accuracy: 0.3666
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4189
 Best site-MNIST      | Epoch:3 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2568
 Best site-USPS       | Epoch:3 | Val Acc: 0.4730
 Best site-USPS       | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 1.9793 | Train Acc: 0.4685
 Site-MNIST     | Train Loss: 1.9774 | Train Acc: 0.4685
 Site-SVHN      | Train Loss: 2.2190 | Train Acc: 0.2252
 Site-SVHN      | Train Loss: 2.2333 | Train Acc: 0.1892
 Site-USPS      | Train Loss: 1.9191 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 1.9336 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 2.2290 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.2148 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 2.0086 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 1.9163 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.2434 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2300 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.9328 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 1.9334 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 2.2160 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.2185 | Val  Acc: 0.3649
Average Valid Accuracy: 0.3750
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:4 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2568
 Best site-USPS       | Epoch:4 | Val Acc: 0.4459
 Best site-USPS       | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 1.9261 | Train Acc: 0.4955
 Site-MNIST     | Train Loss: 1.9233 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 2.2082 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2244 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.8553 | Train Acc: 0.6036
 Site-USPS      | Train Loss: 1.8745 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 2.2166 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1984 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 1.9583 | Val  Acc: 0.4459
 Site-MNIST     | Val  Loss: 1.8563 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2353 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.2218 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.8713 | Val  Acc: 0.4730
 Site-USPS      | Val  Loss: 1.8721 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 2.2004 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2003 | Val  Acc: 0.3514
Average Valid Accuracy: 0.3936
 Best site-MNIST      | Epoch:5 | Val Acc: 0.4459
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2703
 Best site-USPS       | Epoch:5 | Val Acc: 0.4730
 Best site-USPS       | Epoch:5 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.8761 | Train Acc: 0.5045
 Site-MNIST     | Train Loss: 1.8751 | Train Acc: 0.5135
 Site-SVHN      | Train Loss: 2.1986 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2153 | Train Acc: 0.1982
 Site-USPS      | Train Loss: 1.7963 | Train Acc: 0.6577
 Site-USPS      | Train Loss: 1.8167 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 2.2017 | Train Acc: 0.3153
 Site-MNIST-M   | Train Loss: 2.1831 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.9117 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 1.8023 | Val  Acc: 0.5946
 Site-SVHN      | Val  Loss: 2.2275 | Val  Acc: 0.1486
 Site-SVHN      | Val  Loss: 2.2119 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.8121 | Val  Acc: 0.5135
 Site-USPS      | Val  Loss: 1.8135 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 2.1856 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.1825 | Val  Acc: 0.3378
Average Valid Accuracy: 0.4071
 Best site-MNIST      | Epoch:6 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5946
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1486
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2703
 Best site-USPS       | Epoch:6 | Val Acc: 0.5135
 Best site-USPS       | Epoch:6 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.8266 | Train Acc: 0.5315
 Site-MNIST     | Train Loss: 1.8264 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 2.1887 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2069 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.7396 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 1.7604 | Train Acc: 0.5405
 Site-MNIST-M   | Train Loss: 2.1883 | Train Acc: 0.3243
 Site-MNIST-M   | Train Loss: 2.1683 | Train Acc: 0.3243
 Site-MNIST     | Val  Loss: 1.8647 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7492 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 2.2204 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2031 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.7567 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 1.7588 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 2.1708 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1649 | Val  Acc: 0.3514
Average Valid Accuracy: 0.4274
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2703
 Best site-USPS       | Epoch:7 | Val Acc: 0.5811
 Best site-USPS       | Epoch:7 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.7770 | Train Acc: 0.5676
 Site-MNIST     | Train Loss: 1.7822 | Train Acc: 0.5856
 Site-SVHN      | Train Loss: 2.1797 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1994 | Train Acc: 0.2252
 Site-USPS      | Train Loss: 1.6864 | Train Acc: 0.6847
 Site-USPS      | Train Loss: 1.7075 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 2.1751 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1525 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 1.8209 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.7000 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.2133 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1952 | Val  Acc: 0.2703
 Site-USPS      | Val  Loss: 1.7040 | Val  Acc: 0.6081
 Site-USPS      | Val  Loss: 1.7066 | Val  Acc: 0.6216
 Site-MNIST-M   | Val  Loss: 2.1563 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 2.1481 | Val  Acc: 0.3649
Average Valid Accuracy: 0.4527
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2703
 Best site-USPS       | Epoch:8 | Val Acc: 0.6081
 Best site-USPS       | Epoch:8 | Val Acc: 0.6216
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.7336 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.7378 | Train Acc: 0.5946
 Site-SVHN      | Train Loss: 2.1710 | Train Acc: 0.2432
 Site-SVHN      | Train Loss: 2.1910 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.6386 | Train Acc: 0.6937
 Site-USPS      | Train Loss: 1.6581 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 2.1619 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 2.1386 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 1.7772 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.6522 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 2.2069 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1874 | Val  Acc: 0.2838
 Site-USPS      | Val  Loss: 1.6541 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.6566 | Val  Acc: 0.6486
 Site-MNIST-M   | Val  Loss: 2.1419 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1321 | Val  Acc: 0.3784
Average Valid Accuracy: 0.4645
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:9 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2838
 Best site-USPS       | Epoch:9 | Val Acc: 0.6486
 Best site-USPS       | Epoch:9 | Val Acc: 0.6486
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_SynthDigits...
===2023-03-26 13:09:19===
===2023-03-26 13:09:20===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SynthDigits: 0.2269
Average Test Accuracy: 0.2269
