===2023-03-26 09:53:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6904 | Train Acc: 0.5766
 Site-MNIST     | Train Loss: 1.7135 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 2.1934 | Train Acc: 0.1982
 Site-SVHN      | Train Loss: 2.2283 | Train Acc: 0.2342
 Site-USPS      | Train Loss: 1.6586 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 1.7223 | Train Acc: 0.6577
 Site-MNIST-M   | Train Loss: 2.1651 | Train Acc: 0.2162
 Site-MNIST-M   | Train Loss: 2.1394 | Train Acc: 0.2523
 Site-MNIST     | Val  Loss: 1.7112 | Val  Acc: 0.5811
 Site-MNIST     | Val  Loss: 1.6622 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 2.2590 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1992 | Val  Acc: 0.2162
 Site-USPS      | Val  Loss: 1.7164 | Val  Acc: 0.6351
 Site-USPS      | Val  Loss: 1.6891 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 2.1336 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.1459 | Val  Acc: 0.2027
Average Valid Accuracy: 0.4206
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5811
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-USPS       | Epoch:0 | Val Acc: 0.6351
 Best site-USPS       | Epoch:0 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1210 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 1.1620 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 2.0664 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 2.1247 | Train Acc: 0.2703
 Site-USPS      | Train Loss: 1.0611 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 1.1326 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 1.9621 | Train Acc: 0.3604
 Site-MNIST-M   | Train Loss: 1.9153 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 1.1634 | Val  Acc: 0.8243
 Site-MNIST     | Val  Loss: 1.1033 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 2.1700 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0678 | Val  Acc: 0.2973
 Site-USPS      | Val  Loss: 1.1397 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 1.1052 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 1.8808 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 1.9361 | Val  Acc: 0.3514
Average Valid Accuracy: 0.5861
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8243
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2973
 Best site-USPS       | Epoch:1 | Val Acc: 0.8919
 Best site-USPS       | Epoch:1 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.6917 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.7471 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 2.0279 | Train Acc: 0.3153
 Site-SVHN      | Train Loss: 2.0659 | Train Acc: 0.2973
 Site-USPS      | Train Loss: 0.6439 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.6972 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 1.6951 | Train Acc: 0.4865
 Site-MNIST-M   | Train Loss: 1.7688 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 0.7410 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.6862 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 2.1190 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 2.0387 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 0.7234 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.6684 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 1.7080 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.7470 | Val  Acc: 0.4865
Average Valid Accuracy: 0.6503
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2568
 Best site-USPS       | Epoch:2 | Val Acc: 0.8919
 Best site-USPS       | Epoch:2 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.4615 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5161 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.7896 | Train Acc: 0.4234
 Site-SVHN      | Train Loss: 1.8667 | Train Acc: 0.4144
 Site-USPS      | Train Loss: 0.4283 | Train Acc: 0.9279
 Site-USPS      | Train Loss: 0.4668 | Train Acc: 0.9099
 Site-MNIST-M   | Train Loss: 1.3631 | Train Acc: 0.6396
 Site-MNIST-M   | Train Loss: 1.4702 | Train Acc: 0.5676
 Site-MNIST     | Val  Loss: 0.5058 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.4763 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 1.9183 | Val  Acc: 0.4189
 Site-SVHN      | Val  Loss: 1.8375 | Val  Acc: 0.3919
 Site-USPS      | Val  Loss: 0.4878 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.4373 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 1.4292 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 1.3947 | Val  Acc: 0.5946
Average Valid Accuracy: 0.7179
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4189
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3919
 Best site-USPS       | Epoch:3 | Val Acc: 0.8919
 Best site-USPS       | Epoch:3 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3063 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.3504 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.5232 | Train Acc: 0.4505
 Site-SVHN      | Train Loss: 1.6606 | Train Acc: 0.5225
 Site-USPS      | Train Loss: 0.3263 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.3383 | Train Acc: 0.9369
 Site-MNIST-M   | Train Loss: 1.1418 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 1.1340 | Train Acc: 0.6486
 Site-MNIST     | Val  Loss: 0.3435 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.3206 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.6947 | Val  Acc: 0.5000
 Site-SVHN      | Val  Loss: 1.6402 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.3422 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.3270 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 1.1267 | Val  Acc: 0.6757
 Site-MNIST-M   | Val  Loss: 1.0809 | Val  Acc: 0.6486
Average Valid Accuracy: 0.7635
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5000
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-USPS       | Epoch:4 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6757
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.1638 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.2143 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.5285 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 1.5508 | Train Acc: 0.5135
 Site-USPS      | Train Loss: 0.2145 | Train Acc: 0.9640
 Site-USPS      | Train Loss: 0.2434 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.9213 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 1.0405 | Train Acc: 0.6757
 Site-MNIST     | Val  Loss: 0.2084 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1870 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 1.6428 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.5576 | Val  Acc: 0.4595
 Site-USPS      | Val  Loss: 0.2600 | Val  Acc: 0.9595
 Site-USPS      | Val  Loss: 0.2161 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 1.0267 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 0.9367 | Val  Acc: 0.7297
Average Valid Accuracy: 0.7855
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4595
 Best site-USPS       | Epoch:5 | Val Acc: 0.9595
 Best site-USPS       | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1054 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1452 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 1.2233 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 1.2632 | Train Acc: 0.6126
 Site-USPS      | Train Loss: 0.1593 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1705 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.6853 | Train Acc: 0.8198
 Site-MNIST-M   | Train Loss: 0.7673 | Train Acc: 0.7748
 Site-MNIST     | Val  Loss: 0.1480 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.1226 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 1.3162 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 1.2963 | Val  Acc: 0.5676
 Site-USPS      | Val  Loss: 0.1800 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1551 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.7405 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 0.7046 | Val  Acc: 0.7973
Average Valid Accuracy: 0.8345
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-USPS       | Epoch:6 | Val Acc: 0.9865
 Best site-USPS       | Epoch:6 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0731 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0989 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.9789 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 0.9905 | Train Acc: 0.6306
 Site-USPS      | Train Loss: 0.1204 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.1143 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.4788 | Train Acc: 0.9189
 Site-MNIST-M   | Train Loss: 0.5355 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1078 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.0828 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 1.0222 | Val  Acc: 0.6081
 Site-SVHN      | Val  Loss: 1.0404 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.1185 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1113 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.5369 | Val  Acc: 0.8649
 Site-MNIST-M   | Val  Loss: 0.4702 | Val  Acc: 0.9189
Average Valid Accuracy: 0.8750
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6081
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6757
 Best site-USPS       | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8649
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0569 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0633 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7862 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.8574 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.0889 | Train Acc: 0.9730
 Site-USPS      | Train Loss: 0.0835 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.3781 | Train Acc: 0.9550
 Site-MNIST-M   | Train Loss: 0.3947 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0655 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0572 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8688 | Val  Acc: 0.7162
 Site-SVHN      | Val  Loss: 0.9177 | Val  Acc: 0.6892
 Site-USPS      | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0818 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.3854 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.3673 | Val  Acc: 0.9595
Average Valid Accuracy: 0.9122
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7162
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6892
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0472 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.0456 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6247 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 0.6453 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.0603 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2753 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.2860 | Train Acc: 0.9640
 Site-MNIST     | Val  Loss: 0.0461 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0410 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6386 | Val  Acc: 0.8108
 Site-SVHN      | Val  Loss: 0.7371 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.0601 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0523 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.2786 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.2625 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9426
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8108
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7973
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/CoCoOP_SynthDigits...
===2023-03-26 10:25:58===
===2023-03-26 10:26:00===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8729
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2746
 Test site-USPS      | Epoch:9 | Test Acc: 0.9194
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3607
Average Test Accuracy: 0.6069
===2023-03-26 12:08:26===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SynthDigits: 0.4262
Average Test Accuracy: 0.4262
===2023-03-29 22:32:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8593 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.7770 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.7842 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 2.2163 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1741 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.2110 | Train Acc: 0.2045
 Site-USPS      | Train Loss: 1.7654 | Train Acc: 0.5682
 Site-USPS      | Train Loss: 1.8073 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 1.7016 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 2.2268 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.1722 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.2024 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.7840 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.8214 | Val  Acc: 0.5085
 Site-MNIST     | Val  Loss: 1.7787 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 2.2606 | Val  Acc: 0.1186
 Site-SVHN      | Val  Loss: 2.1764 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2366 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7090 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.8801 | Val  Acc: 0.5424
 Site-USPS      | Val  Loss: 1.7810 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 2.1970 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.1562 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2027 | Val  Acc: 0.1356
Average Valid Accuracy: 0.3729
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1186
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.5424
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1356
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4545 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.4050 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.4301 | Train Acc: 0.7386
 Site-SVHN      | Train Loss: 2.1740 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1084 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1231 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.4004 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 1.4583 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 1.3129 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 2.1122 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.0396 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 1.9858 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 1.4248 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.4615 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.3770 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 2.1899 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.0935 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1673 | Val  Acc: 0.1525
 Site-USPS      | Val  Loss: 1.3298 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.4963 | Val  Acc: 0.7288
 Site-USPS      | Val  Loss: 1.4103 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 2.0426 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0076 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.0786 | Val  Acc: 0.2373
Average Valid Accuracy: 0.4845
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1525
 Best site-USPS       | Epoch:1 | Val Acc: 0.7966
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-USPS       | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2373
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1985 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.1484 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.1734 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1114 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0606 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0195 | Train Acc: 0.3182
 Site-USPS      | Train Loss: 1.0552 | Train Acc: 0.8068
 Site-USPS      | Train Loss: 1.1434 | Train Acc: 0.8182
 Site-USPS      | Train Loss: 1.0062 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 1.9880 | Train Acc: 0.3295
 Site-MNIST-M   | Train Loss: 1.8793 | Train Acc: 0.3523
 Site-MNIST-M   | Train Loss: 1.8203 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.1704 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.1992 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.0963 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 2.1269 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0580 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 2.1047 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.0460 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 1.1667 | Val  Acc: 0.7966
 Site-USPS      | Val  Loss: 1.1017 | Val  Acc: 0.8136
 Site-MNIST-M   | Val  Loss: 1.9017 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.8633 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 1.9588 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5650
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1695
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.7966
 Best site-USPS       | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9539 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.9325 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.9551 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 2.0642 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0356 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9576 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 0.8572 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.9350 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.8224 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.8612 | Train Acc: 0.3977
 Site-MNIST-M   | Train Loss: 1.7578 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.7244 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.9664 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.9929 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.8891 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 2.0668 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0503 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0468 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.8480 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.9385 | Val  Acc: 0.8475
 Site-USPS      | Val  Loss: 0.9028 | Val  Acc: 0.8644
 Site-MNIST-M   | Val  Loss: 1.7646 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.7278 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.8460 | Val  Acc: 0.3729
Average Valid Accuracy: 0.6059
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.9153
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3729
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7904 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.7620 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.8029 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 2.0409 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.9684 | Train Acc: 0.2955
 Site-SVHN      | Train Loss: 1.8878 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.7233 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.7803 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.6874 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.7470 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.6733 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.5575 | Train Acc: 0.5795
 Site-MNIST     | Val  Loss: 0.8147 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8337 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.7383 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 2.0011 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.9981 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.9875 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 0.7114 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.7789 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.7481 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 1.6355 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.6164 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.7502 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6427
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2034
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-USPS       | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6826 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6826 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.7326 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0040 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8867 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.8096 | Train Acc: 0.3864
 Site-USPS      | Train Loss: 0.6241 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.6691 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.5777 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.6401 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.5479 | Train Acc: 0.5568
 Site-MNIST-M   | Train Loss: 1.4512 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.7185 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.7181 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6374 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.9644 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.9152 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9669 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 0.6097 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6719 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.6522 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 1.5404 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.5120 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.6436 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6568
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2203
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.8983
 Best site-USPS       | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5921 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5970 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.6460 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.9775 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8669 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.7977 | Train Acc: 0.4205
 Site-USPS      | Train Loss: 0.5457 | Train Acc: 0.8636
 Site-USPS      | Train Loss: 0.5699 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.5315 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.5718 | Train Acc: 0.5114
 Site-MNIST-M   | Train Loss: 1.4762 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.4051 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.6370 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6253 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5599 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.9257 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.8809 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9303 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.5403 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5817 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5696 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 1.4521 | Val  Acc: 0.5932
 Site-MNIST-M   | Val  Loss: 1.4328 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.5466 | Val  Acc: 0.5593
Average Valid Accuracy: 0.6695
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2542
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-USPS       | Epoch:6 | Val Acc: 0.8983
 Best site-USPS       | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5932
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5207 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5074 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5857 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.9097 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8629 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.7421 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.4527 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.5447 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.4613 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.4665 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.3939 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.2828 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.5671 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5437 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4981 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8891 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 1.8710 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.8782 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.4859 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.5004 | Val  Acc: 0.9322
 Site-USPS      | Val  Loss: 0.4995 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 1.3766 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3731 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.4650 | Val  Acc: 0.5932
Average Valid Accuracy: 0.6766
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2712
 Best site-USPS       | Epoch:7 | Val Acc: 0.8983
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4663 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.4540 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5208 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.8941 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.8115 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7157 | Train Acc: 0.4886
 Site-USPS      | Train Loss: 0.4120 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.4543 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.4208 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 1.3820 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.2594 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 1.2935 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.5187 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4773 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4494 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8414 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8225 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.8423 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.4388 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.4419 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.4635 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 1.3091 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2894 | Val  Acc: 0.6102
 Site-MNIST-M   | Val  Loss: 1.3664 | Val  Acc: 0.6949
Average Valid Accuracy: 0.7006
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3051
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-USPS       | Epoch:8 | Val Acc: 0.9492
 Best site-USPS       | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6102
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4438 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.3683 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4496 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.8676 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.7749 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.6747 | Train Acc: 0.4432
 Site-USPS      | Train Loss: 0.3790 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.4078 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.3756 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.3151 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.2314 | Train Acc: 0.6705
 Site-MNIST-M   | Train Loss: 1.1339 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.4732 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4204 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3966 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8094 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.7781 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8148 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.4011 | Val  Acc: 0.8983
 Site-USPS      | Val  Loss: 0.3780 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.4281 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 1.2346 | Val  Acc: 0.6780
 Site-MNIST-M   | Val  Loss: 1.2318 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.2578 | Val  Acc: 0.6949
Average Valid Accuracy: 0.7105
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3051
 Best site-USPS       | Epoch:9 | Val Acc: 0.8983
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6780
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/CoCoOP_SynthDigits...
===2023-03-29 23:11:30===
===2023-03-29 23:11:31===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.3767
Average Test Accuracy: 0.3767
