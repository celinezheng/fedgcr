===2023-03-26 01:32:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:35:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 03:52:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.6990 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.7121 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 2.2063 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2229 | Train Acc: 0.2523
 Site-USPS      | Train Loss: 1.6481 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 1.7130 | Train Acc: 0.7117
 Site-MNIST-M   | Train Loss: 2.1661 | Train Acc: 0.1892
 Site-MNIST-M   | Train Loss: 2.1484 | Train Acc: 0.2523
 Site-MNIST     | Val  Loss: 1.7178 | Val  Acc: 0.6081
 Site-MNIST     | Val  Loss: 1.6498 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.2600 | Val  Acc: 0.2027
 Site-SVHN      | Val  Loss: 2.1893 | Val  Acc: 0.2297
 Site-USPS      | Val  Loss: 1.7022 | Val  Acc: 0.7162
 Site-USPS      | Val  Loss: 1.6738 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 2.1426 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.1475 | Val  Acc: 0.2027
Average Valid Accuracy: 0.4459
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6081
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2297
 Best site-USPS       | Epoch:0 | Val Acc: 0.7162
 Best site-USPS       | Epoch:0 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2583 | Train Acc: 0.6396
 Site-MNIST     | Train Loss: 1.2566 | Train Acc: 0.6396
 Site-SVHN      | Train Loss: 2.1753 | Train Acc: 0.1802
 Site-SVHN      | Train Loss: 2.1005 | Train Acc: 0.2613
 Site-USPS      | Train Loss: 1.0970 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 1.1147 | Train Acc: 0.8378
 Site-MNIST-M   | Train Loss: 2.0109 | Train Acc: 0.3153
 Site-MNIST-M   | Train Loss: 1.9514 | Train Acc: 0.3874
 Site-MNIST     | Val  Loss: 1.2995 | Val  Acc: 0.5946
 Site-MNIST     | Val  Loss: 1.1418 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 2.1171 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0991 | Val  Acc: 0.2297
 Site-USPS      | Val  Loss: 1.1051 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 1.1109 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 1.9371 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.9875 | Val  Acc: 0.3378
Average Valid Accuracy: 0.5253
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5946
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2297
 Best site-USPS       | Epoch:1 | Val Acc: 0.8514
 Best site-USPS       | Epoch:1 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8684 | Train Acc: 0.7387
 Site-MNIST     | Train Loss: 0.8827 | Train Acc: 0.7387
 Site-SVHN      | Train Loss: 1.9838 | Train Acc: 0.2793
 Site-SVHN      | Train Loss: 1.9239 | Train Acc: 0.3874
 Site-USPS      | Train Loss: 0.6858 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 0.6947 | Train Acc: 0.8468
 Site-MNIST-M   | Train Loss: 1.7249 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.6334 | Train Acc: 0.4955
 Site-MNIST     | Val  Loss: 0.9100 | Val  Acc: 0.7162
 Site-MNIST     | Val  Loss: 0.7815 | Val  Acc: 0.7703
 Site-SVHN      | Val  Loss: 1.9321 | Val  Acc: 0.3919
 Site-SVHN      | Val  Loss: 1.9354 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.7047 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.6755 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 1.6117 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.6669 | Val  Acc: 0.4730
Average Valid Accuracy: 0.6098
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7162
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3919
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3243
 Best site-USPS       | Epoch:2 | Val Acc: 0.8514
 Best site-USPS       | Epoch:2 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5412 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.5683 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.8581 | Train Acc: 0.3063
 Site-SVHN      | Train Loss: 1.7229 | Train Acc: 0.4414
 Site-USPS      | Train Loss: 0.4155 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4765 | Train Acc: 0.8739
 Site-MNIST-M   | Train Loss: 1.3900 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.3934 | Train Acc: 0.5405
 Site-MNIST     | Val  Loss: 0.5787 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.5139 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 1.7155 | Val  Acc: 0.4595
 Site-SVHN      | Val  Loss: 1.8300 | Val  Acc: 0.3243
 Site-USPS      | Val  Loss: 0.4893 | Val  Acc: 0.8649
 Site-USPS      | Val  Loss: 0.4331 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 1.3689 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.3903 | Val  Acc: 0.5946
Average Valid Accuracy: 0.6774
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4595
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3243
 Best site-USPS       | Epoch:3 | Val Acc: 0.8649
 Best site-USPS       | Epoch:3 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5946
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.5445 | Train Acc: 0.8378
 Site-MNIST     | Train Loss: 0.5853 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.7250 | Train Acc: 0.3514
 Site-SVHN      | Train Loss: 1.7121 | Train Acc: 0.3784
 Site-USPS      | Train Loss: 0.3742 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.3868 | Train Acc: 0.9009
 Site-MNIST-M   | Train Loss: 1.2199 | Train Acc: 0.6036
 Site-MNIST-M   | Train Loss: 1.0955 | Train Acc: 0.6937
 Site-MNIST     | Val  Loss: 0.6101 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.5277 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 1.7354 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.7237 | Val  Acc: 0.3378
 Site-USPS      | Val  Loss: 0.3865 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.3655 | Val  Acc: 0.9054
 Site-MNIST-M   | Val  Loss: 1.1378 | Val  Acc: 0.6892
 Site-MNIST-M   | Val  Loss: 1.0414 | Val  Acc: 0.7432
Average Valid Accuracy: 0.7027
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3378
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-USPS       | Epoch:4 | Val Acc: 0.9054
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6892
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2398 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2491 | Train Acc: 0.9640
 Site-SVHN      | Train Loss: 1.5264 | Train Acc: 0.4324
 Site-SVHN      | Train Loss: 1.4669 | Train Acc: 0.4955
 Site-USPS      | Train Loss: 0.2127 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.2544 | Train Acc: 0.9279
 Site-MNIST-M   | Train Loss: 0.8100 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 0.9647 | Train Acc: 0.7027
 Site-MNIST     | Val  Loss: 0.2405 | Val  Acc: 0.9730
 Site-MNIST     | Val  Loss: 0.2306 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.5129 | Val  Acc: 0.4730
 Site-SVHN      | Val  Loss: 1.5379 | Val  Acc: 0.4459
 Site-USPS      | Val  Loss: 0.2660 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2272 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.9114 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 0.8772 | Val  Acc: 0.7703
Average Valid Accuracy: 0.7787
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9730
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4730
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4459
 Best site-USPS       | Epoch:5 | Val Acc: 0.9324
 Best site-USPS       | Epoch:5 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1979 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.2137 | Train Acc: 0.9550
 Site-SVHN      | Train Loss: 1.2661 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 1.3655 | Train Acc: 0.5676
 Site-USPS      | Train Loss: 0.1923 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2008 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.5935 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.6097 | Train Acc: 0.8468
 Site-MNIST     | Val  Loss: 0.1989 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.2063 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 1.4107 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.3453 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 0.1931 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.2044 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.6315 | Val  Acc: 0.8378
 Site-MNIST-M   | Val  Loss: 0.5163 | Val  Acc: 0.9054
Average Valid Accuracy: 0.8361
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5000
 Best site-USPS       | Epoch:6 | Val Acc: 1.0000
 Best site-USPS       | Epoch:6 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8378
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1287 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.1352 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 1.0059 | Train Acc: 0.6667
 Site-SVHN      | Train Loss: 0.9787 | Train Acc: 0.7207
 Site-USPS      | Train Loss: 0.1091 | Train Acc: 0.9820
 Site-USPS      | Train Loss: 0.1173 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.3464 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.4880 | Train Acc: 0.8919
 Site-MNIST     | Val  Loss: 0.1230 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1371 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 1.0200 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 1.0123 | Val  Acc: 0.6622
 Site-USPS      | Val  Loss: 0.1218 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.1019 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4927 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.3644 | Val  Acc: 0.9459
Average Valid Accuracy: 0.8986
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6622
 Best site-USPS       | Epoch:7 | Val Acc: 0.9865
 Best site-USPS       | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0903 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0913 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.8169 | Train Acc: 0.7477
 Site-SVHN      | Train Loss: 0.8209 | Train Acc: 0.8018
 Site-USPS      | Train Loss: 0.0723 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.0725 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.2442 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.3403 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.0803 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0941 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.8212 | Val  Acc: 0.7838
 Site-SVHN      | Val  Loss: 0.8750 | Val  Acc: 0.7432
 Site-USPS      | Val  Loss: 0.0740 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0645 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3448 | Val  Acc: 0.9189
 Site-MNIST-M   | Val  Loss: 0.2548 | Val  Acc: 0.9730
Average Valid Accuracy: 0.9257
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7838
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7432
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9189
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9730
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0608 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.6168 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 0.6377 | Train Acc: 0.8288
 Site-USPS      | Train Loss: 0.0494 | Train Acc: 0.9910
 Site-USPS      | Train Loss: 0.0549 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.1686 | Train Acc: 0.9820
 Site-MNIST-M   | Train Loss: 0.2394 | Train Acc: 0.9640
 Site-MNIST     | Val  Loss: 0.0482 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0593 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6697 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.6296 | Val  Acc: 0.8514
 Site-USPS      | Val  Loss: 0.0601 | Val  Acc: 0.9865
 Site-USPS      | Val  Loss: 0.0415 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.2380 | Val  Acc: 0.9459
 Site-MNIST-M   | Val  Loss: 0.1815 | Val  Acc: 1.0000
Average Valid Accuracy: 0.9510
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8514
 Best site-USPS       | Epoch:9 | Val Acc: 0.9865
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9459
 Best site-MNIST-M    | Epoch:9 | Val Acc: 1.0000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_SynthDigits...
===2023-03-26 04:26:39===
===2023-03-26 04:26:41===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8850
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3013
 Test site-USPS      | Epoch:9 | Test Acc: 0.9032
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4079
Average Test Accuracy: 0.6243
===2023-03-26 12:00:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of SynthDigits: 0.4423
Average Test Accuracy: 0.4423
===2023-03-29 19:09:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8264 | Train Acc: 0.5341
 Site-MNIST     | Train Loss: 1.7746 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7451 | Train Acc: 0.5341
 Site-SVHN      | Train Loss: 2.2257 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.1863 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.1946 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.7533 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 1.8250 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 1.6690 | Train Acc: 0.6477
 Site-MNIST-M   | Train Loss: 2.2010 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.1606 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1803 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.7504 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7802 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7362 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 2.2515 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1691 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.2279 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.6854 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.8594 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 1.7602 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 2.1798 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.1605 | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: 2.2078 | Val  Acc: 0.1695
Average Valid Accuracy: 0.3842
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.6610
 Best site-USPS       | Epoch:0 | Val Acc: 0.5085
 Best site-USPS       | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4520 | Train Acc: 0.5909
 Site-MNIST     | Train Loss: 1.3209 | Train Acc: 0.6023
 Site-MNIST     | Train Loss: 1.3821 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 2.1651 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0983 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0775 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 1.1721 | Train Acc: 0.7500
 Site-USPS      | Train Loss: 1.2514 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 1.1428 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 2.0890 | Train Acc: 0.2955
 Site-MNIST-M   | Train Loss: 2.0222 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.9856 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.3873 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.3521 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.2782 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1330 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.1004 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1467 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.1355 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 1.2451 | Val  Acc: 0.7627
 Site-USPS      | Val  Loss: 1.2324 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 2.0344 | Val  Acc: 0.2542
 Site-MNIST-M   | Val  Loss: 2.0088 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0760 | Val  Acc: 0.2542
Average Valid Accuracy: 0.4718
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.8136
 Best site-USPS       | Epoch:1 | Val Acc: 0.7627
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2542
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9473 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 0.8092 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 0.9367 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 2.0462 | Train Acc: 0.3523
 Site-SVHN      | Train Loss: 1.9039 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.9282 | Train Acc: 0.4091
 Site-USPS      | Train Loss: 0.7735 | Train Acc: 0.8523
 Site-USPS      | Train Loss: 0.7387 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.7608 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 1.9282 | Train Acc: 0.3750
 Site-MNIST-M   | Train Loss: 1.8645 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.8176 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 0.9735 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.9064 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 0.8069 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9582 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.9342 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 1.9909 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 0.7789 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.7745 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.7772 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 1.8995 | Val  Acc: 0.3559
 Site-MNIST-M   | Val  Loss: 1.8460 | Val  Acc: 0.4407
 Site-MNIST-M   | Val  Loss: 1.9007 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5932
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-USPS       | Epoch:2 | Val Acc: 0.8814
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-USPS       | Epoch:2 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3559
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4407
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7031 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.5799 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6348 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.8885 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.8901 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.7676 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.4895 | Train Acc: 0.8864
 Site-USPS      | Train Loss: 0.5055 | Train Acc: 0.8977
 Site-USPS      | Train Loss: 0.5323 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 1.6233 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.5208 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.5851 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.7032 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.6648 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.5784 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 1.8053 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.9447 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8976 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.5662 | Val  Acc: 0.8814
 Site-USPS      | Val  Loss: 0.5275 | Val  Acc: 0.8644
 Site-USPS      | Val  Loss: 0.5148 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 1.7246 | Val  Acc: 0.4237
 Site-MNIST-M   | Val  Loss: 1.5092 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.6340 | Val  Acc: 0.5085
Average Valid Accuracy: 0.6455
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3051
 Best site-USPS       | Epoch:3 | Val Acc: 0.8814
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-USPS       | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4237
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5085
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.5143 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.3956 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.4948 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 1.6893 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.5966 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.4971 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.3824 | Train Acc: 0.9091
 Site-USPS      | Train Loss: 0.3364 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.3928 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 1.3229 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.1090 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.3014 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.5393 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.4573 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.3839 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.5956 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.6352 | Val  Acc: 0.4407
 Site-SVHN      | Val  Loss: 1.6743 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.3876 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3616 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.3335 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 1.4143 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.0991 | Val  Acc: 0.7288
 Site-MNIST-M   | Val  Loss: 1.2299 | Val  Acc: 0.6949
Average Valid Accuracy: 0.7105
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4407
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3220
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9153
 Best site-USPS       | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.7288
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6949
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4317 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3135 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4373 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 1.6776 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.6647 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.4233 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.2705 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.2451 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.3025 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 1.0849 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 0.9160 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.1746 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.4917 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.3831 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3234 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.5046 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.7529 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.6616 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.2839 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2480 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.2176 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 1.2513 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 0.9121 | Val  Acc: 0.7797
 Site-MNIST-M   | Val  Loss: 1.0072 | Val  Acc: 0.7288
Average Valid Accuracy: 0.7331
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4068
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-USPS       | Epoch:5 | Val Acc: 0.9492
 Best site-USPS       | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7797
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2578 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2222 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.3012 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.4244 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.3666 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.4121 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.2094 | Train Acc: 0.9432
 Site-USPS      | Train Loss: 0.1736 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.2263 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.8572 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6265 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.8498 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.2960 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.2447 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2077 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.4263 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.4218 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.4338 | Val  Acc: 0.4407
 Site-USPS      | Val  Loss: 0.2134 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1850 | Val  Acc: 0.9492
 Site-USPS      | Val  Loss: 0.1617 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.8932 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.6334 | Val  Acc: 0.8814
 Site-MNIST-M   | Val  Loss: 0.7077 | Val  Acc: 0.8644
Average Valid Accuracy: 0.7952
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4407
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9492
 Best site-USPS       | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8814
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2061 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2029 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.2341 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.3616 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.2785 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.2273 | Train Acc: 0.6136
 Site-USPS      | Train Loss: 0.1412 | Train Acc: 0.9545
 Site-USPS      | Train Loss: 0.1188 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.1726 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.6716 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5287 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.7293 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.2656 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.2021 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1732 | Val  Acc: 0.9492
 Site-SVHN      | Val  Loss: 1.2100 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.3405 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.3533 | Val  Acc: 0.5085
 Site-USPS      | Val  Loss: 0.1440 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.1172 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.1166 | Val  Acc: 0.9661
 Site-MNIST-M   | Val  Loss: 0.8011 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.5632 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.5948 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8319
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5085
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-USPS       | Epoch:7 | Val Acc: 1.0000
 Best site-USPS       | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1614 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1202 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1638 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.0769 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 0.9596 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.0037 | Train Acc: 0.6705
 Site-USPS      | Train Loss: 0.1071 | Train Acc: 0.9773
 Site-USPS      | Train Loss: 0.0919 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.1270 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.4833 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3726 | Train Acc: 0.9432
 Site-MNIST-M   | Train Loss: 0.5236 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2013 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1388 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1452 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.0458 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 0.9792 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.0538 | Val  Acc: 0.5763
 Site-USPS      | Val  Loss: 0.1063 | Val  Acc: 0.9661
 Site-USPS      | Val  Loss: 0.0960 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0741 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5647 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.3715 | Val  Acc: 0.9153
 Site-MNIST-M   | Val  Loss: 0.3902 | Val  Acc: 0.9492
Average Valid Accuracy: 0.8771
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5763
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-USPS       | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9153
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9492
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1332 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0803 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1318 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.9273 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 1.0092 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.8174 | Train Acc: 0.7386
 Site-USPS      | Train Loss: 0.0791 | Train Acc: 0.9886
 Site-USPS      | Train Loss: 0.0529 | Train Acc: 1.0000
 Site-USPS      | Train Loss: 0.0792 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.3336 | Train Acc: 0.9886
 Site-MNIST-M   | Train Loss: 0.2783 | Train Acc: 0.9659
 Site-MNIST-M   | Train Loss: 0.4067 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1610 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.0949 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1009 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.8274 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.9227 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.0081 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.0715 | Val  Acc: 0.9831
 Site-USPS      | Val  Loss: 0.0541 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.0526 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4432 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.2994 | Val  Acc: 0.9492
 Site-MNIST-M   | Val  Loss: 0.2918 | Val  Acc: 0.9831
Average Valid Accuracy: 0.9040
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6441
 Best site-USPS       | Epoch:9 | Val Acc: 0.9831
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-USPS       | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9492
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9831
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_SynthDigits...
===2023-03-29 19:49:56===
===2023-03-29 19:49:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of SynthDigits: 0.4414
Average Test Accuracy: 0.4414
