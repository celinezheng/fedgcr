===2023-03-26 15:58:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 4
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7066 | Train Acc: 0.5586
 Site-MNIST     | Train Loss: 1.7236 | Train Acc: 0.5766
 Site-SVHN      | Train Loss: 2.2086 | Train Acc: 0.1892
 Site-SVHN      | Train Loss: 2.2197 | Train Acc: 0.2162
 Site-USPS      | Train Loss: 1.6125 | Train Acc: 0.6396
 Site-USPS      | Train Loss: 1.6871 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 2.0541 | Train Acc: 0.2883
 Site-SynthDigits| Train Loss: 2.0785 | Train Acc: 0.3063
 Site-MNIST     | Val  Loss: 1.7204 | Val  Acc: 0.5676
 Site-MNIST     | Val  Loss: 1.6596 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2592 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1837 | Val  Acc: 0.2027
 Site-USPS      | Val  Loss: 1.6621 | Val  Acc: 0.6486
 Site-USPS      | Val  Loss: 1.6413 | Val  Acc: 0.6892
 Site-SynthDigits| Val  Loss: 2.0646 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 2.0714 | Val  Acc: 0.2703
Average Valid Accuracy: 0.4392
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-USPS       | Epoch:0 | Val Acc: 0.6486
 Best site-USPS       | Epoch:0 | Val Acc: 0.6892
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2869 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.3413 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 2.1009 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.0858 | Train Acc: 0.3063
 Site-USPS      | Train Loss: 1.1522 | Train Acc: 0.8468
 Site-USPS      | Train Loss: 1.2243 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 1.7950 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.8514 | Train Acc: 0.3784
 Site-MNIST     | Val  Loss: 1.3427 | Val  Acc: 0.6892
 Site-MNIST     | Val  Loss: 1.2559 | Val  Acc: 0.7432
 Site-SVHN      | Val  Loss: 2.1385 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 2.0286 | Val  Acc: 0.2568
 Site-USPS      | Val  Loss: 1.2058 | Val  Acc: 0.8108
 Site-USPS      | Val  Loss: 1.1736 | Val  Acc: 0.8514
 Site-SynthDigits| Val  Loss: 1.8484 | Val  Acc: 0.3378
 Site-SynthDigits| Val  Loss: 1.8164 | Val  Acc: 0.4865
Average Valid Accuracy: 0.5557
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6892
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-USPS       | Epoch:1 | Val Acc: 0.8108
 Best site-USPS       | Epoch:1 | Val Acc: 0.8514
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3378
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9270 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 1.0102 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.9586 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 1.9313 | Train Acc: 0.3514
 Site-USPS      | Train Loss: 0.7994 | Train Acc: 0.8559
 Site-USPS      | Train Loss: 0.8697 | Train Acc: 0.8198
 Site-SynthDigits| Train Loss: 1.5574 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.5825 | Train Acc: 0.4685
 Site-MNIST     | Val  Loss: 1.0234 | Val  Acc: 0.7568
 Site-MNIST     | Val  Loss: 0.9060 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 2.0483 | Val  Acc: 0.2838
 Site-SVHN      | Val  Loss: 1.7904 | Val  Acc: 0.3784
 Site-USPS      | Val  Loss: 0.8671 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.8389 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.5986 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.5679 | Val  Acc: 0.4865
Average Valid Accuracy: 0.5980
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7568
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2838
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3784
 Best site-USPS       | Epoch:2 | Val Acc: 0.7973
 Best site-USPS       | Epoch:2 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.7255 | Train Acc: 0.7748
 Site-MNIST     | Train Loss: 0.8189 | Train Acc: 0.8108
 Site-SVHN      | Train Loss: 1.8236 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.7785 | Train Acc: 0.4054
 Site-USPS      | Train Loss: 0.5965 | Train Acc: 0.9009
 Site-USPS      | Train Loss: 0.6660 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.3291 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 1.3765 | Train Acc: 0.5856
 Site-MNIST     | Val  Loss: 0.8325 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.7437 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 1.8702 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.6634 | Val  Acc: 0.4189
 Site-USPS      | Val  Loss: 0.6601 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.6265 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.3919 | Val  Acc: 0.5541
 Site-SynthDigits| Val  Loss: 1.3718 | Val  Acc: 0.5676
Average Valid Accuracy: 0.6622
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4189
 Best site-USPS       | Epoch:3 | Val Acc: 0.8784
 Best site-USPS       | Epoch:3 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5541
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.5079 | Train Acc: 0.8829
 Site-MNIST     | Train Loss: 0.6064 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 1.6828 | Train Acc: 0.4595
 Site-SVHN      | Train Loss: 1.6375 | Train Acc: 0.4595
 Site-USPS      | Train Loss: 0.4576 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.5161 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.2405 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 1.2371 | Train Acc: 0.6126
 Site-MNIST     | Val  Loss: 0.5980 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.5590 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.7325 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.5589 | Val  Acc: 0.4865
 Site-USPS      | Val  Loss: 0.5129 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.4856 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2753 | Val  Acc: 0.6081
 Site-SynthDigits| Val  Loss: 1.2665 | Val  Acc: 0.5541
Average Valid Accuracy: 0.6943
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-USPS       | Epoch:4 | Val Acc: 0.8784
 Best site-USPS       | Epoch:4 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6081
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4138 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.5064 | Train Acc: 0.8649
 Site-SVHN      | Train Loss: 1.4667 | Train Acc: 0.4955
 Site-SVHN      | Train Loss: 1.4028 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 0.3245 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3693 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.0281 | Train Acc: 0.6126
 Site-SynthDigits| Train Loss: 1.0190 | Train Acc: 0.6486
 Site-MNIST     | Val  Loss: 0.5101 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.4738 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 1.5157 | Val  Acc: 0.5270
 Site-SVHN      | Val  Loss: 1.3165 | Val  Acc: 0.5811
 Site-USPS      | Val  Loss: 0.3573 | Val  Acc: 0.8784
 Site-USPS      | Val  Loss: 0.3372 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.0559 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.0633 | Val  Acc: 0.5676
Average Valid Accuracy: 0.7331
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5270
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5811
 Best site-USPS       | Epoch:5 | Val Acc: 0.8784
 Best site-USPS       | Epoch:5 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5676
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2620 | Train Acc: 0.9459
 Site-MNIST     | Train Loss: 0.3189 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.2118 | Train Acc: 0.6036
 Site-SVHN      | Train Loss: 1.2526 | Train Acc: 0.6216
 Site-USPS      | Train Loss: 0.2890 | Train Acc: 0.9099
 Site-USPS      | Train Loss: 0.3093 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.8948 | Train Acc: 0.7207
 Site-SynthDigits| Train Loss: 0.8280 | Train Acc: 0.7387
 Site-MNIST     | Val  Loss: 0.2965 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3156 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 1.3853 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 1.0711 | Val  Acc: 0.6757
 Site-USPS      | Val  Loss: 0.3092 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.2767 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.8835 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 0.8746 | Val  Acc: 0.6892
Average Valid Accuracy: 0.7990
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6757
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-USPS       | Epoch:6 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2479 | Train Acc: 0.9550
 Site-MNIST     | Train Loss: 0.3090 | Train Acc: 0.9459
 Site-SVHN      | Train Loss: 1.0154 | Train Acc: 0.7207
 Site-SVHN      | Train Loss: 0.9506 | Train Acc: 0.7477
 Site-USPS      | Train Loss: 0.2314 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.2411 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7312 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 0.7328 | Train Acc: 0.7748
 Site-MNIST     | Val  Loss: 0.2922 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.3032 | Val  Acc: 0.9459
 Site-SVHN      | Val  Loss: 1.0408 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.9079 | Val  Acc: 0.7973
 Site-USPS      | Val  Loss: 0.2361 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.2258 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.7936 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 0.7173 | Val  Acc: 0.7432
Average Valid Accuracy: 0.8463
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9459
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7973
 Best site-USPS       | Epoch:7 | Val Acc: 0.9459
 Best site-USPS       | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1364 | Train Acc: 0.9640
 Site-MNIST     | Train Loss: 0.1659 | Train Acc: 0.9910
 Site-SVHN      | Train Loss: 0.7675 | Train Acc: 0.8288
 Site-SVHN      | Train Loss: 0.8322 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 0.2011 | Train Acc: 0.9369
 Site-USPS      | Train Loss: 0.1969 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5408 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.4762 | Train Acc: 0.8829
 Site-MNIST     | Val  Loss: 0.1487 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1657 | Val  Acc: 0.9730
 Site-SVHN      | Val  Loss: 0.9467 | Val  Acc: 0.7027
 Site-SVHN      | Val  Loss: 0.6734 | Val  Acc: 0.8919
 Site-USPS      | Val  Loss: 0.1939 | Val  Acc: 0.9459
 Site-USPS      | Val  Loss: 0.1799 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5347 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 0.4728 | Val  Acc: 0.8919
Average Valid Accuracy: 0.9020
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9730
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7027
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8919
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-USPS       | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1338 | Train Acc: 0.9820
 Site-MNIST     | Train Loss: 0.1624 | Train Acc: 0.9730
 Site-SVHN      | Train Loss: 0.5890 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 0.5636 | Train Acc: 0.8739
 Site-USPS      | Train Loss: 0.1560 | Train Acc: 0.9550
 Site-USPS      | Train Loss: 0.1414 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.4104 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.4190 | Train Acc: 0.9279
 Site-MNIST     | Val  Loss: 0.1457 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1676 | Val  Acc: 0.9595
 Site-SVHN      | Val  Loss: 0.6401 | Val  Acc: 0.8378
 Site-SVHN      | Val  Loss: 0.4862 | Val  Acc: 0.9324
 Site-USPS      | Val  Loss: 0.1365 | Val  Acc: 0.9730
 Site-USPS      | Val  Loss: 0.1425 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4797 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.3706 | Val  Acc: 0.9324
Average Valid Accuracy: 0.9341
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8378
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9324
 Best site-USPS       | Epoch:9 | Val Acc: 0.9730
 Best site-USPS       | Epoch:9 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even/FedPrompt_MNIST-M...
===2023-03-26 16:32:38===
===2023-03-26 16:32:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 4
Loading snapshots...
Test Accuracy of MNIST-M: 0.3164
Average Test Accuracy: 0.3164
