===2023-03-30 12:02:48===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7463 | Train Acc: 0.4762
 Site-MNIST     | Train Loss: 1.6265 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.6705 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.6860 | Train Acc: 0.5397
 Site-MNIST     | Train Loss: 1.5660 | Train Acc: 0.5714
 Site-MNIST     | Train Loss: 1.6720 | Train Acc: 0.6032
 Site-MNIST     | Train Loss: 1.6672 | Train Acc: 0.5873
 Site-SVHN      | Train Loss: 2.2233 | Train Acc: 0.1746
 Site-USPS      | Train Loss: 1.7814 | Train Acc: 0.4762
 Site-SynthDigits| Train Loss: 2.1731 | Train Acc: 0.2222
 Site-MNIST     | Val  Loss: 1.6199 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.5991 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6589 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.7249 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.6436 | Val  Acc: 0.5714
 Site-MNIST     | Val  Loss: 1.5518 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.8048 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.2893 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.8280 | Val  Acc: 0.3810
 Site-SynthDigits| Val  Loss: 2.1977 | Val  Acc: 0.2381
Average Valid Accuracy: 0.4738
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1429
 Best site-USPS       | Epoch:0 | Val Acc: 0.3810
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2953 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.1429 | Train Acc: 0.6667
 Site-MNIST     | Train Loss: 1.2004 | Train Acc: 0.6349
 Site-MNIST     | Train Loss: 1.2336 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.0776 | Train Acc: 0.7143
 Site-MNIST     | Train Loss: 1.1837 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 1.2068 | Train Acc: 0.6984
 Site-SVHN      | Train Loss: 2.1895 | Train Acc: 0.2381
 Site-USPS      | Train Loss: 1.3468 | Train Acc: 0.6190
 Site-SynthDigits| Train Loss: 1.9827 | Train Acc: 0.3651
 Site-MNIST     | Val  Loss: 1.0987 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.1268 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.2060 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2476 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.1633 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.0976 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.3357 | Val  Acc: 0.5714
 Site-SVHN      | Val  Loss: 2.3365 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.4121 | Val  Acc: 0.5952
 Site-SynthDigits| Val  Loss: 2.0711 | Val  Acc: 0.2143
Average Valid Accuracy: 0.5714
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5714
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1429
 Best site-USPS       | Epoch:1 | Val Acc: 0.5952
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2143
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8830 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 0.7517 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 0.8360 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.8142 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.6889 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7591 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.8218 | Train Acc: 0.7937
 Site-SVHN      | Train Loss: 2.1398 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 0.9812 | Train Acc: 0.7937
 Site-SynthDigits| Train Loss: 1.8154 | Train Acc: 0.3810
 Site-MNIST     | Val  Loss: 0.6987 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7192 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.7808 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.8589 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 0.8348 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 0.7086 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.9269 | Val  Acc: 0.7143
 Site-SVHN      | Val  Loss: 2.3712 | Val  Acc: 0.1190
 Site-USPS      | Val  Loss: 1.0298 | Val  Acc: 0.7381
 Site-SynthDigits| Val  Loss: 1.9667 | Val  Acc: 0.2619
Average Valid Accuracy: 0.6833
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1190
 Best site-USPS       | Epoch:2 | Val Acc: 0.7381
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5239 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.4477 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.4915 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4640 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3838 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4405 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5169 | Train Acc: 0.8571
 Site-SVHN      | Train Loss: 1.9976 | Train Acc: 0.3175
 Site-USPS      | Train Loss: 0.7305 | Train Acc: 0.8413
 Site-SynthDigits| Train Loss: 1.6225 | Train Acc: 0.4762
 Site-MNIST     | Val  Loss: 0.3849 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3948 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4332 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5162 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.4786 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4302 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5578 | Val  Acc: 0.8095
 Site-SVHN      | Val  Loss: 2.2890 | Val  Acc: 0.2143
 Site-USPS      | Val  Loss: 0.7652 | Val  Acc: 0.8810
 Site-SynthDigits| Val  Loss: 1.9344 | Val  Acc: 0.3333
Average Valid Accuracy: 0.7762
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8095
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2143
 Best site-USPS       | Epoch:3 | Val Acc: 0.8810
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3191 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.2701 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.2848 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.2580 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.2098 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.2313 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.3015 | Train Acc: 0.9206
 Site-SVHN      | Train Loss: 1.9319 | Train Acc: 0.3175
 Site-USPS      | Train Loss: 0.5613 | Train Acc: 0.8413
 Site-SynthDigits| Train Loss: 1.4250 | Train Acc: 0.5079
 Site-MNIST     | Val  Loss: 0.2112 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2195 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.2386 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2771 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2852 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2757 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3205 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.3051 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 0.5669 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.8111 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8024
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1905
 Best site-USPS       | Epoch:4 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2132 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.1718 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1991 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1676 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1247 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1320 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1731 | Train Acc: 0.9683
 Site-SVHN      | Train Loss: 1.7680 | Train Acc: 0.3651
 Site-USPS      | Train Loss: 0.4059 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 1.1004 | Train Acc: 0.6984
 Site-MNIST     | Val  Loss: 0.1221 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1307 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1552 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1817 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1987 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1828 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.2034 | Val  Acc: 0.9524
 Site-SVHN      | Val  Loss: 2.2279 | Val  Acc: 0.2381
 Site-USPS      | Val  Loss: 0.4731 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.5871 | Val  Acc: 0.4762
Average Valid Accuracy: 0.8333
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2381
 Best site-USPS       | Epoch:5 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1533 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.1256 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.1278 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.1092 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0824 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0891 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1246 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.6223 | Train Acc: 0.4127
 Site-USPS      | Train Loss: 0.3653 | Train Acc: 0.8730
 Site-SynthDigits| Train Loss: 0.9276 | Train Acc: 0.7460
 Site-MNIST     | Val  Loss: 0.0814 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0852 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1195 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1252 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.1333 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.1345 | Val  Acc: 0.9762
 Site-SVHN      | Val  Loss: 2.1822 | Val  Acc: 0.2857
 Site-USPS      | Val  Loss: 0.4328 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.5666 | Val  Acc: 0.4762
Average Valid Accuracy: 0.8524
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2857
 Best site-USPS       | Epoch:6 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.0949 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.0821 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1221 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0852 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0634 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0624 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0969 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.4024 | Train Acc: 0.4762
 Site-USPS      | Train Loss: 0.2773 | Train Acc: 0.9048
 Site-SynthDigits| Train Loss: 0.8034 | Train Acc: 0.7302
 Site-MNIST     | Val  Loss: 0.0636 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0628 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0790 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1096 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0859 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0853 | Val  Acc: 0.9762
 Site-SVHN      | Val  Loss: 2.0915 | Val  Acc: 0.3333
 Site-USPS      | Val  Loss: 0.4023 | Val  Acc: 0.8095
 Site-SynthDigits| Val  Loss: 1.4888 | Val  Acc: 0.4762
Average Valid Accuracy: 0.8571
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3333
 Best site-USPS       | Epoch:7 | Val Acc: 0.8095
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0880 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0623 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0781 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0727 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0463 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0501 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0771 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.1754 | Train Acc: 0.5873
 Site-USPS      | Train Loss: 0.2115 | Train Acc: 0.9841
 Site-SynthDigits| Train Loss: 0.6402 | Train Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.0471 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0468 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0703 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0659 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0798 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0637 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0872 | Val  Acc: 0.9762
 Site-SVHN      | Val  Loss: 1.9916 | Val  Acc: 0.3810
 Site-USPS      | Val  Loss: 0.3322 | Val  Acc: 0.8810
 Site-SynthDigits| Val  Loss: 1.5032 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8714
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3810
 Best site-USPS       | Epoch:8 | Val Acc: 0.8810
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0515 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0477 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0608 | Train Acc: 0.9841
 Site-MNIST     | Train Loss: 0.0553 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0334 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0334 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0555 | Train Acc: 0.9841
 Site-SVHN      | Train Loss: 1.0672 | Train Acc: 0.6032
 Site-USPS      | Train Loss: 0.1563 | Train Acc: 0.9683
 Site-SynthDigits| Train Loss: 0.5535 | Train Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0336 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0506 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0534 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0594 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.0513 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0477 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 2.0161 | Val  Acc: 0.3810
 Site-USPS      | Val  Loss: 0.2777 | Val  Acc: 0.8571
 Site-SynthDigits| Val  Loss: 1.4437 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8786
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3810
 Best site-USPS       | Epoch:9 | Val Acc: 0.8571
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5714
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/FedPrompt_MNIST-M...
===2023-03-30 12:27:22===
===2023-03-30 12:27:24===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.3114
Average Test Accuracy: 0.3114
