===2023-03-30 14:05:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7955 | Train Acc: 0.4921
 Site-MNIST     | Train Loss: 1.6719 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.6997 | Train Acc: 0.5556
 Site-MNIST     | Train Loss: 1.7430 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.6038 | Train Acc: 0.5873
 Site-MNIST     | Train Loss: 1.7191 | Train Acc: 0.6032
 Site-MNIST     | Train Loss: 1.7071 | Train Acc: 0.6032
 Site-SVHN      | Train Loss: 2.2167 | Train Acc: 0.1905
 Site-USPS      | Train Loss: 1.8055 | Train Acc: 0.4762
 Site-SynthDigits| Train Loss: 2.1683 | Train Acc: 0.2698
 Site-MNIST     | Val  Loss: 1.6621 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.6396 | Val  Acc: 0.5238
 Site-MNIST     | Val  Loss: 1.7132 | Val  Acc: 0.6429
 Site-MNIST     | Val  Loss: 1.7804 | Val  Acc: 0.4762
 Site-MNIST     | Val  Loss: 1.6702 | Val  Acc: 0.5952
 Site-MNIST     | Val  Loss: 1.5966 | Val  Acc: 0.6905
 Site-MNIST     | Val  Loss: 1.8507 | Val  Acc: 0.5238
 Site-SVHN      | Val  Loss: 2.2708 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.8527 | Val  Acc: 0.3571
 Site-SynthDigits| Val  Loss: 2.1939 | Val  Acc: 0.2381
Average Valid Accuracy: 0.4833
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5238
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6429
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4762
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5952
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6905
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5238
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1429
 Best site-USPS       | Epoch:0 | Val Acc: 0.3571
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3765 | Train Acc: 0.6825
 Site-MNIST     | Train Loss: 1.2580 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 1.3137 | Train Acc: 0.6508
 Site-MNIST     | Train Loss: 1.3348 | Train Acc: 0.7460
 Site-MNIST     | Train Loss: 1.1924 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 1.2933 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.2980 | Train Acc: 0.7143
 Site-SVHN      | Train Loss: 2.1468 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 1.4723 | Train Acc: 0.6349
 Site-SynthDigits| Train Loss: 2.0173 | Train Acc: 0.2857
 Site-MNIST     | Val  Loss: 1.2425 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.2278 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.2921 | Val  Acc: 0.7619
 Site-MNIST     | Val  Loss: 1.3905 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2758 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.1940 | Val  Acc: 0.7857
 Site-MNIST     | Val  Loss: 1.4300 | Val  Acc: 0.6667
 Site-SVHN      | Val  Loss: 2.2437 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 1.5289 | Val  Acc: 0.6190
 Site-SynthDigits| Val  Loss: 2.0633 | Val  Acc: 0.2619
Average Valid Accuracy: 0.6286
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7619
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7857
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6667
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1667
 Best site-USPS       | Epoch:1 | Val Acc: 0.6190
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.0789 | Train Acc: 0.7619
 Site-MNIST     | Train Loss: 0.9791 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 1.0520 | Train Acc: 0.8095
 Site-MNIST     | Train Loss: 1.0345 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.9360 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.9975 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 1.0145 | Train Acc: 0.7778
 Site-SVHN      | Train Loss: 2.0832 | Train Acc: 0.2222
 Site-USPS      | Train Loss: 1.2348 | Train Acc: 0.7937
 Site-SynthDigits| Train Loss: 1.9098 | Train Acc: 0.3492
 Site-MNIST     | Val  Loss: 0.9616 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.9546 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.9966 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 1.1161 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.0168 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9275 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 1.1241 | Val  Acc: 0.7381
 Site-SVHN      | Val  Loss: 2.2238 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 1.2989 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.9742 | Val  Acc: 0.2619
Average Valid Accuracy: 0.6833
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:2 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7381
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1667
 Best site-USPS       | Epoch:2 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.2619
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8668 | Train Acc: 0.7937
 Site-MNIST     | Train Loss: 0.7894 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.8623 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.8364 | Train Acc: 0.8254
 Site-MNIST     | Train Loss: 0.7541 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.7925 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.8146 | Train Acc: 0.7937
 Site-SVHN      | Train Loss: 2.0507 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 1.0542 | Train Acc: 0.8254
 Site-SynthDigits| Train Loss: 1.8128 | Train Acc: 0.4286
 Site-MNIST     | Val  Loss: 0.7686 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7589 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7943 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.9077 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.8270 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7489 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.9189 | Val  Acc: 0.7619
 Site-SVHN      | Val  Loss: 2.2074 | Val  Acc: 0.1429
 Site-USPS      | Val  Loss: 1.1303 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.8992 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7143
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7619
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1429
 Best site-USPS       | Epoch:3 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2857
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7146 | Train Acc: 0.8413
 Site-MNIST     | Train Loss: 0.6618 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.7173 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.6916 | Train Acc: 0.8730
 Site-MNIST     | Train Loss: 0.6225 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.6540 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.6813 | Train Acc: 0.8413
 Site-SVHN      | Train Loss: 2.0261 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 0.9503 | Train Acc: 0.8095
 Site-SynthDigits| Train Loss: 1.7427 | Train Acc: 0.4444
 Site-MNIST     | Val  Loss: 0.6390 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.6130 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.6548 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7553 | Val  Acc: 0.8333
 Site-MNIST     | Val  Loss: 0.6889 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.6205 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.7704 | Val  Acc: 0.7857
 Site-SVHN      | Val  Loss: 2.2126 | Val  Acc: 0.1905
 Site-USPS      | Val  Loss: 1.0417 | Val  Acc: 0.7143
 Site-SynthDigits| Val  Loss: 1.8450 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7429
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8333
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7857
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1905
 Best site-USPS       | Epoch:4 | Val Acc: 0.7143
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6116 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5635 | Train Acc: 0.8571
 Site-MNIST     | Train Loss: 0.6041 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5896 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5211 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.5536 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5821 | Train Acc: 0.8730
 Site-SVHN      | Train Loss: 1.9903 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 0.8482 | Train Acc: 0.8254
 Site-SynthDigits| Train Loss: 1.6631 | Train Acc: 0.4921
 Site-MNIST     | Val  Loss: 0.5352 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5071 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.5521 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.6407 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5837 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5303 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.6641 | Val  Acc: 0.8571
 Site-SVHN      | Val  Loss: 2.1985 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 0.9470 | Val  Acc: 0.7381
 Site-SynthDigits| Val  Loss: 1.7859 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7595
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8571
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1667
 Best site-USPS       | Epoch:5 | Val Acc: 0.7381
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.3571
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5306 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.5000 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5281 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.5123 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.4498 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4834 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.5169 | Train Acc: 0.8889
 Site-SVHN      | Train Loss: 1.9489 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 0.7753 | Train Acc: 0.8254
 Site-SynthDigits| Train Loss: 1.5988 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.4634 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4303 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4781 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.5563 | Val  Acc: 0.8810
 Site-MNIST     | Val  Loss: 0.5148 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4656 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5855 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.1727 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 0.8856 | Val  Acc: 0.7381
 Site-SynthDigits| Val  Loss: 1.7417 | Val  Acc: 0.4048
Average Valid Accuracy: 0.7786
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8810
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1667
 Best site-USPS       | Epoch:6 | Val Acc: 0.7381
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4663 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.4406 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4595 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.4515 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3836 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4169 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4439 | Train Acc: 0.9206
 Site-SVHN      | Train Loss: 1.9095 | Train Acc: 0.2063
 Site-USPS      | Train Loss: 0.7032 | Train Acc: 0.8413
 Site-SynthDigits| Train Loss: 1.5417 | Train Acc: 0.5238
 Site-MNIST     | Val  Loss: 0.4026 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.3633 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4187 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4891 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.4480 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4086 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.5202 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.1596 | Val  Acc: 0.1667
 Site-USPS      | Val  Loss: 0.8202 | Val  Acc: 0.7619
 Site-SynthDigits| Val  Loss: 1.6930 | Val  Acc: 0.4524
Average Valid Accuracy: 0.7929
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1667
 Best site-USPS       | Epoch:7 | Val Acc: 0.7619
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.4524
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4087 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3918 | Train Acc: 0.8889
 Site-MNIST     | Train Loss: 0.4032 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.4025 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3377 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3632 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3891 | Train Acc: 0.9524
 Site-SVHN      | Train Loss: 1.8797 | Train Acc: 0.2698
 Site-USPS      | Train Loss: 0.6389 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 1.4679 | Train Acc: 0.5397
 Site-MNIST     | Val  Loss: 0.3523 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3130 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3689 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.4322 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3899 | Val  Acc: 0.9286
 Site-MNIST     | Val  Loss: 0.3579 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4698 | Val  Acc: 0.8810
 Site-SVHN      | Val  Loss: 2.1558 | Val  Acc: 0.2381
 Site-USPS      | Val  Loss: 0.7631 | Val  Acc: 0.7857
 Site-SynthDigits| Val  Loss: 1.6532 | Val  Acc: 0.4048
Average Valid Accuracy: 0.8024
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9286
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8810
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2381
 Best site-USPS       | Epoch:8 | Val Acc: 0.7857
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3572 | Train Acc: 0.9048
 Site-MNIST     | Train Loss: 0.3572 | Train Acc: 0.9206
 Site-MNIST     | Train Loss: 0.3512 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3551 | Train Acc: 0.9683
 Site-MNIST     | Train Loss: 0.3003 | Train Acc: 0.9524
 Site-MNIST     | Train Loss: 0.3160 | Train Acc: 0.9365
 Site-MNIST     | Train Loss: 0.3416 | Train Acc: 0.9365
 Site-SVHN      | Train Loss: 1.8425 | Train Acc: 0.3492
 Site-USPS      | Train Loss: 0.5941 | Train Acc: 0.8571
 Site-SynthDigits| Train Loss: 1.4130 | Train Acc: 0.5556
 Site-MNIST     | Val  Loss: 0.3116 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2696 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3238 | Val  Acc: 0.9762
 Site-MNIST     | Val  Loss: 0.3831 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3374 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3219 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4234 | Val  Acc: 0.9048
 Site-SVHN      | Val  Loss: 2.1451 | Val  Acc: 0.3095
 Site-USPS      | Val  Loss: 0.7117 | Val  Acc: 0.8333
 Site-SynthDigits| Val  Loss: 1.6414 | Val  Acc: 0.4048
Average Valid Accuracy: 0.8214
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9762
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9048
 Best site-SVHN       | Epoch:9 | Val Acc: 0.3095
 Best site-USPS       | Epoch:9 | Val Acc: 0.8333
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.4048
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt/CoCoOP_MNIST-M...
===2023-03-30 14:28:45===
===2023-03-30 14:28:46===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.3486
Average Test Accuracy: 0.3486
