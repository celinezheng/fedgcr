===2023-08-08 14:44:36===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-08 15:10:05===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-08 15:14:22===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
===2023-08-08 15:14:55===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 2
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[116,173,259,387,580,155,269,466,25,50,308,
client_nums=[5,3,2,1,]
len_dataset=[2529,1487,126,514,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-expw                      (0) | Train Loss: 1.5246 | Train Acc: 0.2759
 Site-expw                      (0) | Train Loss: 1.6349 | Train Acc: 0.2312
 Site-expw                      (0) | Train Loss: 1.6005 | Train Acc: 0.3205
 Site-expw                      (0) | Train Loss: 1.6603 | Train Acc: 0.2584
 Site-expw                      (0) | Train Loss: 1.5466 | Train Acc: 0.3224
 Site-youngAffectNetHQ          (2) | Train Loss: 2.3358 | Train Acc: 0.1613
 Site-youngAffectNetHQ          (2) | Train Loss: 2.4028 | Train Acc: 0.1190
 Site-youngAffectNetHQ          (2) | Train Loss: 2.3622 | Train Acc: 0.1352
 Site-jpWoman                   (1) | Train Loss: 1.9792 | Train Acc: 0.2400
 Site-jpWoman                   (1) | Train Loss: 2.2433 | Train Acc: 0.1200
 Site-FER                       (3) | Train Loss: 2.4122 | Train Acc: 0.1591
Average Train Accuracy: 0.2130
 Site-expw                      (0) | Val  Loss: 1.5159 | Val  Acc: 0.3117
 Site-expw                      (0) | Val  Loss: 1.5297 | Val  Acc: 0.3391
 Site-expw                      (0) | Val  Loss: 1.5192 | Val  Acc: 0.3488
 Site-expw                      (0) | Val  Loss: 1.6318 | Val  Acc: 0.2713
 Site-expw                      (0) | Val  Loss: 1.5956 | Val  Acc: 0.2953
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.5707 | Val  Acc: 0.1165
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.4048 | Val  Acc: 0.1229
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.3684 | Val  Acc: 0.1258
 Site-jpWoman                   (1) | Val  Loss: 2.2131 | Val  Acc: 0.1250
 Site-jpWoman                   (1) | Val  Loss: 2.2664 | Val  Acc: 0.1212
 Site-FER                       (3) | Val  Loss: 2.4019 | Val  Acc: 0.1463
Average Valid Accuracy: 0.2113
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3117
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3391
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3488
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2713
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2953
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1165
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1229
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1258
 Best site-jpWoman                  (1)  | Epoch:0 | Val Acc: 0.1250
 Best site-jpWoman                  (1)  | Epoch:0 | Val Acc: 0.1212
 Best site-FER                      (3)  | Epoch:0 | Val Acc: 0.1463
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-expw                      (1) | Train Loss: 1.6694 | Train Acc: 0.3103
 Site-expw                      (1) | Train Loss: 1.6990 | Train Acc: 0.3121
 Site-expw                      (1) | Train Loss: 1.7086 | Train Acc: 0.2819
 Site-expw                      (1) | Train Loss: 1.7328 | Train Acc: 0.3101
 Site-expw                      (1) | Train Loss: 1.6975 | Train Acc: 0.2690
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9871 | Train Acc: 0.1290
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9631 | Train Acc: 0.1636
 Site-youngAffectNetHQ          (2) | Train Loss: 2.0195 | Train Acc: 0.1395
 Site-jpWoman                   (0) | Train Loss: 1.8917 | Train Acc: 0.0800
 Site-jpWoman                   (0) | Train Loss: 1.9832 | Train Acc: 0.2200
 Site-FER                       (3) | Train Loss: 2.0276 | Train Acc: 0.1461
Average Train Accuracy: 0.2147
 Site-expw                      (1) | Val  Loss: 1.6872 | Val  Acc: 0.3117
 Site-expw                      (1) | Val  Loss: 1.6509 | Val  Acc: 0.3217
 Site-expw                      (1) | Val  Loss: 1.6642 | Val  Acc: 0.3198
 Site-expw                      (1) | Val  Loss: 1.6520 | Val  Acc: 0.2752
 Site-expw                      (1) | Val  Loss: 1.7076 | Val  Acc: 0.2772
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0661 | Val  Acc: 0.1262
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0137 | Val  Acc: 0.1508
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0128 | Val  Acc: 0.1355
 Site-jpWoman                   (0) | Val  Loss: 2.0101 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 2.0107 | Val  Acc: 0.2121
 Site-FER                       (3) | Val  Loss: 2.0001 | Val  Acc: 0.1561
Average Valid Accuracy: 0.2306
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3117
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3217
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3198
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.2752
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.2772
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1262
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1508
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1355
 Best site-jpWoman                  (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-jpWoman                  (0)  | Epoch:1 | Val Acc: 0.2121
 Best site-FER                      (3)  | Epoch:1 | Val Acc: 0.1561
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
===2023-08-08 15:50:05===
===2023-08-08 19:25:50===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[116,173,259,387,580,155,269,466,25,50,308,
client_nums=[5,3,2,1,]
len_dataset=[2529,1487,126,514,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-expw                      (0) | Train Loss: 1.5246 | Train Acc: 0.2759
 Site-expw                      (0) | Train Loss: 1.6349 | Train Acc: 0.2312
 Site-expw                      (0) | Train Loss: 1.6005 | Train Acc: 0.3205
 Site-expw                      (0) | Train Loss: 1.6603 | Train Acc: 0.2584
 Site-expw                      (0) | Train Loss: 1.5466 | Train Acc: 0.3224
 Site-youngAffectNetHQ          (2) | Train Loss: 2.3358 | Train Acc: 0.1613
 Site-youngAffectNetHQ          (2) | Train Loss: 2.4028 | Train Acc: 0.1190
 Site-youngAffectNetHQ          (2) | Train Loss: 2.3622 | Train Acc: 0.1352
 Site-jpWoman                   (1) | Train Loss: 1.9792 | Train Acc: 0.2400
 Site-jpWoman                   (1) | Train Loss: 2.2433 | Train Acc: 0.1200
 Site-FER                       (3) | Train Loss: 2.4122 | Train Acc: 0.1591
Average Train Accuracy: 0.2130
 Site-expw                      (0) | Val  Loss: 1.5159 | Val  Acc: 0.3117
 Site-expw                      (0) | Val  Loss: 1.5297 | Val  Acc: 0.3391
 Site-expw                      (0) | Val  Loss: 1.5192 | Val  Acc: 0.3488
 Site-expw                      (0) | Val  Loss: 1.6318 | Val  Acc: 0.2713
 Site-expw                      (0) | Val  Loss: 1.5956 | Val  Acc: 0.2953
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.5707 | Val  Acc: 0.1165
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.4048 | Val  Acc: 0.1229
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.3684 | Val  Acc: 0.1258
 Site-jpWoman                   (1) | Val  Loss: 2.2131 | Val  Acc: 0.1250
 Site-jpWoman                   (1) | Val  Loss: 2.2664 | Val  Acc: 0.1212
 Site-FER                       (3) | Val  Loss: 2.4019 | Val  Acc: 0.1463
Average Valid Accuracy: 0.2113
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3117
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3391
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.3488
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2713
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2953
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1165
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1229
 Best site-youngAffectNetHQ         (2)  | Epoch:0 | Val Acc: 0.1258
 Best site-jpWoman                  (1)  | Epoch:0 | Val Acc: 0.1250
 Best site-jpWoman                  (1)  | Epoch:0 | Val Acc: 0.1212
 Best site-FER                      (3)  | Epoch:0 | Val Acc: 0.1463
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-expw                      (1) | Train Loss: 1.6691 | Train Acc: 0.3103
 Site-expw                      (1) | Train Loss: 1.6987 | Train Acc: 0.3121
 Site-expw                      (1) | Train Loss: 1.7079 | Train Acc: 0.2819
 Site-expw                      (1) | Train Loss: 1.7326 | Train Acc: 0.3075
 Site-expw                      (1) | Train Loss: 1.6971 | Train Acc: 0.2690
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9873 | Train Acc: 0.1290
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9633 | Train Acc: 0.1636
 Site-youngAffectNetHQ          (2) | Train Loss: 2.0197 | Train Acc: 0.1395
 Site-jpWoman                   (0) | Train Loss: 1.8918 | Train Acc: 0.0800
 Site-jpWoman                   (0) | Train Loss: 1.9833 | Train Acc: 0.2200
 Site-FER                       (3) | Train Loss: 2.0278 | Train Acc: 0.1461
Average Train Accuracy: 0.2145
 Site-expw                      (1) | Val  Loss: 1.6870 | Val  Acc: 0.3117
 Site-expw                      (1) | Val  Loss: 1.6506 | Val  Acc: 0.3217
 Site-expw                      (1) | Val  Loss: 1.6638 | Val  Acc: 0.3140
 Site-expw                      (1) | Val  Loss: 1.6517 | Val  Acc: 0.2752
 Site-expw                      (1) | Val  Loss: 1.7072 | Val  Acc: 0.2798
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0663 | Val  Acc: 0.1262
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0138 | Val  Acc: 0.1508
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0131 | Val  Acc: 0.1355
 Site-jpWoman                   (0) | Val  Loss: 2.0103 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 2.0107 | Val  Acc: 0.2121
 Site-FER                       (3) | Val  Loss: 2.0003 | Val  Acc: 0.1561
Average Valid Accuracy: 0.2303
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3117
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3217
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.3140
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.2752
 Best site-expw                     (1)  | Epoch:1 | Val Acc: 0.2798
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1262
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1508
 Best site-youngAffectNetHQ         (2)  | Epoch:1 | Val Acc: 0.1355
 Best site-jpWoman                  (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-jpWoman                  (0)  | Epoch:1 | Val Acc: 0.2121
 Best site-FER                      (3)  | Epoch:1 | Val Acc: 0.1561
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-expw                      (1) | Train Loss: 1.6382 | Train Acc: 0.3362
 Site-expw                      (1) | Train Loss: 1.6922 | Train Acc: 0.2428
 Site-expw                      (1) | Train Loss: 1.6541 | Train Acc: 0.3012
 Site-expw                      (1) | Train Loss: 1.6565 | Train Acc: 0.2997
 Site-expw                      (1) | Train Loss: 1.6393 | Train Acc: 0.3121
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9676 | Train Acc: 0.1613
 Site-youngAffectNetHQ          (2) | Train Loss: 2.0140 | Train Acc: 0.1599
 Site-youngAffectNetHQ          (2) | Train Loss: 2.0109 | Train Acc: 0.1502
 Site-jpWoman                   (0) | Train Loss: 1.8805 | Train Acc: 0.2800
 Site-jpWoman                   (0) | Train Loss: 1.9949 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 2.0050 | Train Acc: 0.1429
Average Train Accuracy: 0.2387
 Site-expw                      (1) | Val  Loss: 1.6590 | Val  Acc: 0.3506
 Site-expw                      (1) | Val  Loss: 1.6245 | Val  Acc: 0.3739
 Site-expw                      (1) | Val  Loss: 1.6178 | Val  Acc: 0.3721
 Site-expw                      (1) | Val  Loss: 1.6649 | Val  Acc: 0.2597
 Site-expw                      (1) | Val  Loss: 1.6619 | Val  Acc: 0.3057
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0387 | Val  Acc: 0.1359
 Site-youngAffectNetHQ          (2) | Val  Loss: 2.0020 | Val  Acc: 0.1173
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.9998 | Val  Acc: 0.1581
 Site-jpWoman                   (0) | Val  Loss: 1.9766 | Val  Acc: 0.1875
 Site-jpWoman                   (0) | Val  Loss: 2.0498 | Val  Acc: 0.1515
 Site-FER                       (3) | Val  Loss: 1.9961 | Val  Acc: 0.1756
Average Valid Accuracy: 0.2353
 Best site-expw                     (1)  | Epoch:2 | Val Acc: 0.3506
 Best site-expw                     (1)  | Epoch:2 | Val Acc: 0.3739
 Best site-expw                     (1)  | Epoch:2 | Val Acc: 0.3721
 Best site-expw                     (1)  | Epoch:2 | Val Acc: 0.2597
 Best site-expw                     (1)  | Epoch:2 | Val Acc: 0.3057
 Best site-youngAffectNetHQ         (2)  | Epoch:2 | Val Acc: 0.1359
 Best site-youngAffectNetHQ         (2)  | Epoch:2 | Val Acc: 0.1173
 Best site-youngAffectNetHQ         (2)  | Epoch:2 | Val Acc: 0.1581
 Best site-jpWoman                  (0)  | Epoch:2 | Val Acc: 0.1875
 Best site-jpWoman                  (0)  | Epoch:2 | Val Acc: 0.1515
 Best site-FER                      (3)  | Epoch:2 | Val Acc: 0.1756
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 2, 5, 3, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-expw                      (2) | Train Loss: 1.6128 | Train Acc: 0.3534
 Site-expw                      (2) | Train Loss: 1.6573 | Train Acc: 0.2254
 Site-expw                      (2) | Train Loss: 1.5993 | Train Acc: 0.2973
 Site-expw                      (2) | Train Loss: 1.6073 | Train Acc: 0.3282
 Site-expw                      (2) | Train Loss: 1.5929 | Train Acc: 0.3397
 Site-youngAffectNetHQ          (3) | Train Loss: 1.9766 | Train Acc: 0.2000
 Site-youngAffectNetHQ          (3) | Train Loss: 1.9353 | Train Acc: 0.1859
 Site-youngAffectNetHQ          (3) | Train Loss: 1.9944 | Train Acc: 0.2103
 Site-jpWoman                   (1) | Train Loss: 1.8818 | Train Acc: 0.2400
 Site-jpWoman                   (1) | Train Loss: 1.9649 | Train Acc: 0.2400
 Site-FER                       (0) | Train Loss: 2.0120 | Train Acc: 0.1656
Average Train Accuracy: 0.2533
 Site-expw                      (2) | Val  Loss: 1.6065 | Val  Acc: 0.4156
 Site-expw                      (2) | Val  Loss: 1.5791 | Val  Acc: 0.3826
 Site-expw                      (2) | Val  Loss: 1.5791 | Val  Acc: 0.3721
 Site-expw                      (2) | Val  Loss: 1.5945 | Val  Acc: 0.3101
 Site-expw                      (2) | Val  Loss: 1.6365 | Val  Acc: 0.3135
 Site-youngAffectNetHQ          (3) | Val  Loss: 2.0367 | Val  Acc: 0.1942
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.9910 | Val  Acc: 0.2011
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.9823 | Val  Acc: 0.2194
 Site-jpWoman                   (1) | Val  Loss: 2.0953 | Val  Acc: 0.0625
 Site-jpWoman                   (1) | Val  Loss: 2.0197 | Val  Acc: 0.1212
 Site-FER                       (0) | Val  Loss: 2.0094 | Val  Acc: 0.1805
Average Valid Accuracy: 0.2521
 Best site-expw                     (2)  | Epoch:3 | Val Acc: 0.4156
 Best site-expw                     (2)  | Epoch:3 | Val Acc: 0.3826
 Best site-expw                     (2)  | Epoch:3 | Val Acc: 0.3721
 Best site-expw                     (2)  | Epoch:3 | Val Acc: 0.3101
 Best site-expw                     (2)  | Epoch:3 | Val Acc: 0.3135
 Best site-youngAffectNetHQ         (3)  | Epoch:3 | Val Acc: 0.1942
 Best site-youngAffectNetHQ         (3)  | Epoch:3 | Val Acc: 0.2011
 Best site-youngAffectNetHQ         (3)  | Epoch:3 | Val Acc: 0.2194
 Best site-jpWoman                  (1)  | Epoch:3 | Val Acc: 0.0625
 Best site-jpWoman                  (1)  | Epoch:3 | Val Acc: 0.1212
 Best site-FER                      (0)  | Epoch:3 | Val Acc: 0.1805
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-expw                      (1) | Train Loss: 1.6169 | Train Acc: 0.3534
 Site-expw                      (1) | Train Loss: 1.6446 | Train Acc: 0.2486
 Site-expw                      (1) | Train Loss: 1.5598 | Train Acc: 0.3282
 Site-expw                      (1) | Train Loss: 1.6032 | Train Acc: 0.3307
 Site-expw                      (1) | Train Loss: 1.5799 | Train Acc: 0.3362
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9486 | Train Acc: 0.2129
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8918 | Train Acc: 0.2454
 Site-youngAffectNetHQ          (2) | Train Loss: 1.9451 | Train Acc: 0.2210
 Site-jpWoman                   (0) | Train Loss: 1.8550 | Train Acc: 0.2400
 Site-jpWoman                   (0) | Train Loss: 1.9624 | Train Acc: 0.1800
 Site-FER                       (3) | Train Loss: 1.9973 | Train Acc: 0.1623
Average Train Accuracy: 0.2599
 Site-expw                      (1) | Val  Loss: 1.5939 | Val  Acc: 0.4805
 Site-expw                      (1) | Val  Loss: 1.5662 | Val  Acc: 0.4174
 Site-expw                      (1) | Val  Loss: 1.5640 | Val  Acc: 0.4012
 Site-expw                      (1) | Val  Loss: 1.5847 | Val  Acc: 0.3217
 Site-expw                      (1) | Val  Loss: 1.6140 | Val  Acc: 0.3083
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.9714 | Val  Acc: 0.1942
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.9346 | Val  Acc: 0.2235
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.9370 | Val  Acc: 0.2581
 Site-jpWoman                   (0) | Val  Loss: 2.0673 | Val  Acc: 0.1875
 Site-jpWoman                   (0) | Val  Loss: 1.9725 | Val  Acc: 0.1818
 Site-FER                       (3) | Val  Loss: 1.9671 | Val  Acc: 0.1854
Average Valid Accuracy: 0.2872
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.4805
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.4174
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.4012
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.3217
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.3083
 Best site-youngAffectNetHQ         (2)  | Epoch:4 | Val Acc: 0.1942
 Best site-youngAffectNetHQ         (2)  | Epoch:4 | Val Acc: 0.2235
 Best site-youngAffectNetHQ         (2)  | Epoch:4 | Val Acc: 0.2581
 Best site-jpWoman                  (0)  | Epoch:4 | Val Acc: 0.1875
 Best site-jpWoman                  (0)  | Epoch:4 | Val Acc: 0.1818
 Best site-FER                      (3)  | Epoch:4 | Val Acc: 0.1854
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-expw                      (1) | Train Loss: 1.5445 | Train Acc: 0.3276
 Site-expw                      (1) | Train Loss: 1.6028 | Train Acc: 0.3179
 Site-expw                      (1) | Train Loss: 1.5379 | Train Acc: 0.3205
 Site-expw                      (1) | Train Loss: 1.5429 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.5263 | Train Acc: 0.3603
 Site-youngAffectNetHQ          (0) | Train Loss: 1.9560 | Train Acc: 0.2065
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8652 | Train Acc: 0.2714
 Site-youngAffectNetHQ          (0) | Train Loss: 1.9458 | Train Acc: 0.2275
 Site-jpWoman                   (2) | Train Loss: 1.8848 | Train Acc: 0.1200
 Site-jpWoman                   (2) | Train Loss: 1.9416 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 2.0099 | Train Acc: 0.1786
Average Train Accuracy: 0.2675
 Site-expw                      (1) | Val  Loss: 1.5215 | Val  Acc: 0.3636
 Site-expw                      (1) | Val  Loss: 1.5097 | Val  Acc: 0.3913
 Site-expw                      (1) | Val  Loss: 1.5095 | Val  Acc: 0.3895
 Site-expw                      (1) | Val  Loss: 1.5058 | Val  Acc: 0.3295
 Site-expw                      (1) | Val  Loss: 1.5763 | Val  Acc: 0.3212
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9763 | Val  Acc: 0.1748
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9288 | Val  Acc: 0.2458
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9312 | Val  Acc: 0.2710
 Site-jpWoman                   (2) | Val  Loss: 2.0243 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 2.0148 | Val  Acc: 0.2424
 Site-FER                       (3) | Val  Loss: 1.9861 | Val  Acc: 0.1756
Average Valid Accuracy: 0.2754
============ Train epoch 6 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-expw                      (1) | Train Loss: 1.5148 | Train Acc: 0.3534
 Site-expw                      (1) | Train Loss: 1.5729 | Train Acc: 0.3237
 Site-expw                      (1) | Train Loss: 1.5397 | Train Acc: 0.3514
 Site-expw                      (1) | Train Loss: 1.5275 | Train Acc: 0.3152
 Site-expw                      (1) | Train Loss: 1.5187 | Train Acc: 0.3586
 Site-youngAffectNetHQ          (0) | Train Loss: 1.9527 | Train Acc: 0.2387
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8834 | Train Acc: 0.2639
 Site-youngAffectNetHQ          (0) | Train Loss: 1.9360 | Train Acc: 0.2339
 Site-jpWoman                   (2) | Train Loss: 1.8836 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 2.0460 | Train Acc: 0.2000
 Site-FER                       (3) | Train Loss: 2.0184 | Train Acc: 0.1818
Average Train Accuracy: 0.2746
 Site-expw                      (1) | Val  Loss: 1.5065 | Val  Acc: 0.3896
 Site-expw                      (1) | Val  Loss: 1.4767 | Val  Acc: 0.3826
 Site-expw                      (1) | Val  Loss: 1.4491 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.4687 | Val  Acc: 0.3682
 Site-expw                      (1) | Val  Loss: 1.5322 | Val  Acc: 0.3316
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9685 | Val  Acc: 0.1650
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9197 | Val  Acc: 0.2067
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.9069 | Val  Acc: 0.2935
 Site-jpWoman                   (2) | Val  Loss: 2.0907 | Val  Acc: 0.0625
 Site-jpWoman                   (2) | Val  Loss: 2.0123 | Val  Acc: 0.1818
 Site-FER                       (3) | Val  Loss: 1.9752 | Val  Acc: 0.1854
Average Valid Accuracy: 0.2756
============ Train epoch 7 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-expw                      (0) | Train Loss: 1.4877 | Train Acc: 0.3793
 Site-expw                      (0) | Train Loss: 1.5533 | Train Acc: 0.3584
 Site-expw                      (0) | Train Loss: 1.5148 | Train Acc: 0.3668
 Site-expw                      (0) | Train Loss: 1.5290 | Train Acc: 0.3669
 Site-expw                      (0) | Train Loss: 1.4461 | Train Acc: 0.3724
 Site-youngAffectNetHQ          (1) | Train Loss: 1.8922 | Train Acc: 0.1935
 Site-youngAffectNetHQ          (1) | Train Loss: 1.8288 | Train Acc: 0.2862
 Site-youngAffectNetHQ          (1) | Train Loss: 1.8710 | Train Acc: 0.2403
 Site-jpWoman                   (2) | Train Loss: 1.8778 | Train Acc: 0.1600
 Site-jpWoman                   (2) | Train Loss: 2.0040 | Train Acc: 0.2600
 Site-FER                       (3) | Train Loss: 1.9908 | Train Acc: 0.2045
Average Train Accuracy: 0.2899
 Site-expw                      (0) | Val  Loss: 1.5353 | Val  Acc: 0.4416
 Site-expw                      (0) | Val  Loss: 1.4292 | Val  Acc: 0.4348
 Site-expw                      (0) | Val  Loss: 1.4564 | Val  Acc: 0.4477
 Site-expw                      (0) | Val  Loss: 1.4686 | Val  Acc: 0.3372
 Site-expw                      (0) | Val  Loss: 1.5270 | Val  Acc: 0.3679
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.8800 | Val  Acc: 0.2136
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.8636 | Val  Acc: 0.2067
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.8741 | Val  Acc: 0.2613
 Site-jpWoman                   (2) | Val  Loss: 2.0426 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 1.9827 | Val  Acc: 0.2121
 Site-FER                       (3) | Val  Loss: 1.9371 | Val  Acc: 0.2049
Average Valid Accuracy: 0.2957
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.4416
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.4348
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.4477
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.3372
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.3679
 Best site-youngAffectNetHQ         (1)  | Epoch:7 | Val Acc: 0.2136
 Best site-youngAffectNetHQ         (1)  | Epoch:7 | Val Acc: 0.2067
 Best site-youngAffectNetHQ         (1)  | Epoch:7 | Val Acc: 0.2613
 Best site-jpWoman                  (2)  | Epoch:7 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:7 | Val Acc: 0.2121
 Best site-FER                      (3)  | Epoch:7 | Val Acc: 0.2049
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-expw                      (1) | Train Loss: 1.5066 | Train Acc: 0.3707
 Site-expw                      (1) | Train Loss: 1.5558 | Train Acc: 0.3295
 Site-expw                      (1) | Train Loss: 1.5215 | Train Acc: 0.3745
 Site-expw                      (1) | Train Loss: 1.4977 | Train Acc: 0.3643
 Site-expw                      (1) | Train Loss: 1.4579 | Train Acc: 0.3845
 Site-youngAffectNetHQ          (0) | Train Loss: 1.9272 | Train Acc: 0.1935
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8264 | Train Acc: 0.3011
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8665 | Train Acc: 0.2639
 Site-jpWoman                   (2) | Train Loss: 1.8637 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 2.0125 | Train Acc: 0.1600
 Site-FER                       (3) | Train Loss: 1.9859 | Train Acc: 0.2110
Average Train Accuracy: 0.2867
 Site-expw                      (1) | Val  Loss: 1.4556 | Val  Acc: 0.3896
 Site-expw                      (1) | Val  Loss: 1.4301 | Val  Acc: 0.3826
 Site-expw                      (1) | Val  Loss: 1.4252 | Val  Acc: 0.4244
 Site-expw                      (1) | Val  Loss: 1.4034 | Val  Acc: 0.3682
 Site-expw                      (1) | Val  Loss: 1.4879 | Val  Acc: 0.3860
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8581 | Val  Acc: 0.2136
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8623 | Val  Acc: 0.2235
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8213 | Val  Acc: 0.2871
 Site-jpWoman                   (2) | Val  Loss: 2.1770 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 2.0300 | Val  Acc: 0.2424
 Site-FER                       (3) | Val  Loss: 1.9376 | Val  Acc: 0.1854
Average Valid Accuracy: 0.2934
============ Train epoch 9 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-expw                      (1) | Train Loss: 1.4623 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.5455 | Train Acc: 0.3699
 Site-expw                      (1) | Train Loss: 1.4753 | Train Acc: 0.3938
 Site-expw                      (1) | Train Loss: 1.5168 | Train Acc: 0.3747
 Site-expw                      (1) | Train Loss: 1.4162 | Train Acc: 0.3931
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8486 | Train Acc: 0.2581
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8021 | Train Acc: 0.3086
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8478 | Train Acc: 0.2918
 Site-jpWoman                   (2) | Train Loss: 1.8296 | Train Acc: 0.1600
 Site-jpWoman                   (2) | Train Loss: 1.9403 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 1.9701 | Train Acc: 0.1948
Average Train Accuracy: 0.3105
 Site-expw                      (1) | Val  Loss: 1.4693 | Val  Acc: 0.4675
 Site-expw                      (1) | Val  Loss: 1.4244 | Val  Acc: 0.4261
 Site-expw                      (1) | Val  Loss: 1.4052 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.3753 | Val  Acc: 0.3953
 Site-expw                      (1) | Val  Loss: 1.4492 | Val  Acc: 0.3705
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8437 | Val  Acc: 0.2427
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8218 | Val  Acc: 0.2402
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8236 | Val  Acc: 0.3032
 Site-jpWoman                   (2) | Val  Loss: 2.0403 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 2.0152 | Val  Acc: 0.2121
 Site-FER                       (3) | Val  Loss: 1.9121 | Val  Acc: 0.1951
Average Valid Accuracy: 0.3187
 Best site-expw                     (1)  | Epoch:9 | Val Acc: 0.4675
 Best site-expw                     (1)  | Epoch:9 | Val Acc: 0.4261
 Best site-expw                     (1)  | Epoch:9 | Val Acc: 0.4651
 Best site-expw                     (1)  | Epoch:9 | Val Acc: 0.3953
 Best site-expw                     (1)  | Epoch:9 | Val Acc: 0.3705
 Best site-youngAffectNetHQ         (0)  | Epoch:9 | Val Acc: 0.2427
 Best site-youngAffectNetHQ         (0)  | Epoch:9 | Val Acc: 0.2402
 Best site-youngAffectNetHQ         (0)  | Epoch:9 | Val Acc: 0.3032
 Best site-jpWoman                  (2)  | Epoch:9 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:9 | Val Acc: 0.2121
 Best site-FER                      (3)  | Epoch:9 | Val Acc: 0.1951
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-expw                      (1) | Train Loss: 1.4435 | Train Acc: 0.4052
 Site-expw                      (1) | Train Loss: 1.5511 | Train Acc: 0.3410
 Site-expw                      (1) | Train Loss: 1.6064 | Train Acc: 0.3745
 Site-expw                      (1) | Train Loss: 1.4097 | Train Acc: 0.4031
 Site-expw                      (1) | Train Loss: 1.3881 | Train Acc: 0.4069
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8788 | Train Acc: 0.2194
 Site-youngAffectNetHQ          (2) | Train Loss: 1.7476 | Train Acc: 0.3234
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8065 | Train Acc: 0.2811
 Site-jpWoman                   (0) | Train Loss: 1.8398 | Train Acc: 0.2000
 Site-jpWoman                   (0) | Train Loss: 1.9902 | Train Acc: 0.1800
 Site-FER                       (3) | Train Loss: 1.9713 | Train Acc: 0.2240
Average Train Accuracy: 0.3053
 Site-expw                      (1) | Val  Loss: 1.4397 | Val  Acc: 0.3896
 Site-expw                      (1) | Val  Loss: 1.3801 | Val  Acc: 0.4348
 Site-expw                      (1) | Val  Loss: 1.3892 | Val  Acc: 0.4244
 Site-expw                      (1) | Val  Loss: 1.3992 | Val  Acc: 0.3953
 Site-expw                      (1) | Val  Loss: 1.4474 | Val  Acc: 0.3653
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.8305 | Val  Acc: 0.2427
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.7811 | Val  Acc: 0.2905
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.8010 | Val  Acc: 0.3000
 Site-jpWoman                   (0) | Val  Loss: 2.1619 | Val  Acc: 0.1875
 Site-jpWoman                   (0) | Val  Loss: 2.0526 | Val  Acc: 0.1818
 Site-FER                       (3) | Val  Loss: 1.8831 | Val  Acc: 0.2244
Average Valid Accuracy: 0.3124
============ Train epoch 11 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-expw                      (1) | Train Loss: 1.4336 | Train Acc: 0.3793
 Site-expw                      (1) | Train Loss: 1.5231 | Train Acc: 0.3584
 Site-expw                      (1) | Train Loss: 1.3951 | Train Acc: 0.4015
 Site-expw                      (1) | Train Loss: 1.5546 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.4187 | Train Acc: 0.4293
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8562 | Train Acc: 0.2710
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8188 | Train Acc: 0.3271
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8079 | Train Acc: 0.2833
 Site-jpWoman                   (3) | Train Loss: 1.8704 | Train Acc: 0.1200
 Site-jpWoman                   (3) | Train Loss: 1.9465 | Train Acc: 0.2200
 Site-FER                       (0) | Train Loss: 1.9358 | Train Acc: 0.2435
Average Train Accuracy: 0.3117
 Site-expw                      (1) | Val  Loss: 1.4355 | Val  Acc: 0.4286
 Site-expw                      (1) | Val  Loss: 1.3642 | Val  Acc: 0.4522
 Site-expw                      (1) | Val  Loss: 1.3540 | Val  Acc: 0.4535
 Site-expw                      (1) | Val  Loss: 1.3657 | Val  Acc: 0.3643
 Site-expw                      (1) | Val  Loss: 1.4277 | Val  Acc: 0.3912
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.8429 | Val  Acc: 0.2233
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.7868 | Val  Acc: 0.2961
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.7764 | Val  Acc: 0.3226
 Site-jpWoman                   (3) | Val  Loss: 1.9963 | Val  Acc: 0.1250
 Site-jpWoman                   (3) | Val  Loss: 1.9921 | Val  Acc: 0.2121
 Site-FER                       (0) | Val  Loss: 1.9028 | Val  Acc: 0.2537
Average Valid Accuracy: 0.3202
 Best site-expw                     (1)  | Epoch:11 | Val Acc: 0.4286
 Best site-expw                     (1)  | Epoch:11 | Val Acc: 0.4522
 Best site-expw                     (1)  | Epoch:11 | Val Acc: 0.4535
 Best site-expw                     (1)  | Epoch:11 | Val Acc: 0.3643
 Best site-expw                     (1)  | Epoch:11 | Val Acc: 0.3912
 Best site-youngAffectNetHQ         (2)  | Epoch:11 | Val Acc: 0.2233
 Best site-youngAffectNetHQ         (2)  | Epoch:11 | Val Acc: 0.2961
 Best site-youngAffectNetHQ         (2)  | Epoch:11 | Val Acc: 0.3226
 Best site-jpWoman                  (3)  | Epoch:11 | Val Acc: 0.1250
 Best site-jpWoman                  (3)  | Epoch:11 | Val Acc: 0.2121
 Best site-FER                      (0)  | Epoch:11 | Val Acc: 0.2537
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-expw                      (1) | Train Loss: 1.4234 | Train Acc: 0.3966
 Site-expw                      (1) | Train Loss: 1.5082 | Train Acc: 0.3526
 Site-expw                      (1) | Train Loss: 1.3394 | Train Acc: 0.4054
 Site-expw                      (1) | Train Loss: 1.4345 | Train Acc: 0.3928
 Site-expw                      (1) | Train Loss: 1.4022 | Train Acc: 0.4293
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8666 | Train Acc: 0.1935
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7765 | Train Acc: 0.3494
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7500 | Train Acc: 0.3197
 Site-jpWoman                   (2) | Train Loss: 1.8626 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 1.9872 | Train Acc: 0.1800
 Site-FER                       (3) | Train Loss: 1.8855 | Train Acc: 0.2208
Average Train Accuracy: 0.3127
 Site-expw                      (1) | Val  Loss: 1.3920 | Val  Acc: 0.4935
 Site-expw                      (1) | Val  Loss: 1.3410 | Val  Acc: 0.4522
 Site-expw                      (1) | Val  Loss: 1.3550 | Val  Acc: 0.4709
 Site-expw                      (1) | Val  Loss: 1.3911 | Val  Acc: 0.3992
 Site-expw                      (1) | Val  Loss: 1.4396 | Val  Acc: 0.3756
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8114 | Val  Acc: 0.2233
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7561 | Val  Acc: 0.3073
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7743 | Val  Acc: 0.3194
 Site-jpWoman                   (2) | Val  Loss: 2.0419 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 1.9875 | Val  Acc: 0.1515
 Site-FER                       (3) | Val  Loss: 1.8261 | Val  Acc: 0.2244
Average Valid Accuracy: 0.3220
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.4935
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.4522
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.4709
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.3992
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.3756
 Best site-youngAffectNetHQ         (0)  | Epoch:12 | Val Acc: 0.2233
 Best site-youngAffectNetHQ         (0)  | Epoch:12 | Val Acc: 0.3073
 Best site-youngAffectNetHQ         (0)  | Epoch:12 | Val Acc: 0.3194
 Best site-jpWoman                  (2)  | Epoch:12 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:12 | Val Acc: 0.1515
 Best site-FER                      (3)  | Epoch:12 | Val Acc: 0.2244
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-expw                      (1) | Train Loss: 1.4629 | Train Acc: 0.3621
 Site-expw                      (1) | Train Loss: 1.5040 | Train Acc: 0.3353
 Site-expw                      (1) | Train Loss: 1.3908 | Train Acc: 0.4015
 Site-expw                      (1) | Train Loss: 1.4248 | Train Acc: 0.4031
 Site-expw                      (1) | Train Loss: 1.3877 | Train Acc: 0.4379
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8370 | Train Acc: 0.2710
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7254 | Train Acc: 0.3569
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7656 | Train Acc: 0.2940
 Site-jpWoman                   (2) | Train Loss: 1.8382 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 1.9929 | Train Acc: 0.1800
 Site-FER                       (3) | Train Loss: 1.8525 | Train Acc: 0.2305
Average Train Accuracy: 0.3157
 Site-expw                      (1) | Val  Loss: 1.3971 | Val  Acc: 0.5455
 Site-expw                      (1) | Val  Loss: 1.3394 | Val  Acc: 0.4696
 Site-expw                      (1) | Val  Loss: 1.3452 | Val  Acc: 0.4767
 Site-expw                      (1) | Val  Loss: 1.3510 | Val  Acc: 0.4109
 Site-expw                      (1) | Val  Loss: 1.4048 | Val  Acc: 0.3912
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.8005 | Val  Acc: 0.2039
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7561 | Val  Acc: 0.2961
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7406 | Val  Acc: 0.3097
 Site-jpWoman                   (2) | Val  Loss: 1.9941 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 1.9723 | Val  Acc: 0.1818
 Site-FER                       (3) | Val  Loss: 1.8616 | Val  Acc: 0.2585
Average Valid Accuracy: 0.3335
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.5455
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4696
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4767
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4109
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.3912
 Best site-youngAffectNetHQ         (0)  | Epoch:13 | Val Acc: 0.2039
 Best site-youngAffectNetHQ         (0)  | Epoch:13 | Val Acc: 0.2961
 Best site-youngAffectNetHQ         (0)  | Epoch:13 | Val Acc: 0.3097
 Best site-jpWoman                  (2)  | Epoch:13 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:13 | Val Acc: 0.1818
 Best site-FER                      (3)  | Epoch:13 | Val Acc: 0.2585
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-expw                      (1) | Train Loss: 1.4108 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.5129 | Train Acc: 0.3353
 Site-expw                      (1) | Train Loss: 1.3355 | Train Acc: 0.3977
 Site-expw                      (1) | Train Loss: 1.3428 | Train Acc: 0.3928
 Site-expw                      (1) | Train Loss: 1.3704 | Train Acc: 0.4397
 Site-youngAffectNetHQ          (0) | Train Loss: 1.8584 | Train Acc: 0.2774
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7699 | Train Acc: 0.3494
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7654 | Train Acc: 0.3240
 Site-jpWoman                   (2) | Train Loss: 1.8733 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 1.9626 | Train Acc: 0.1600
 Site-FER                       (3) | Train Loss: 1.8963 | Train Acc: 0.2435
Average Train Accuracy: 0.3228
 Site-expw                      (1) | Val  Loss: 1.3818 | Val  Acc: 0.5195
 Site-expw                      (1) | Val  Loss: 1.3545 | Val  Acc: 0.4435
 Site-expw                      (1) | Val  Loss: 1.3062 | Val  Acc: 0.4535
 Site-expw                      (1) | Val  Loss: 1.3466 | Val  Acc: 0.3876
 Site-expw                      (1) | Val  Loss: 1.4112 | Val  Acc: 0.3990
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7779 | Val  Acc: 0.2427
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7482 | Val  Acc: 0.3017
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7560 | Val  Acc: 0.3161
 Site-jpWoman                   (2) | Val  Loss: 2.0094 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.9658 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.8528 | Val  Acc: 0.2390
Average Valid Accuracy: 0.3421
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.5195
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4435
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4535
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.3876
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.3990
 Best site-youngAffectNetHQ         (0)  | Epoch:14 | Val Acc: 0.2427
 Best site-youngAffectNetHQ         (0)  | Epoch:14 | Val Acc: 0.3017
 Best site-youngAffectNetHQ         (0)  | Epoch:14 | Val Acc: 0.3161
 Best site-jpWoman                  (2)  | Epoch:14 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:14 | Val Acc: 0.2727
 Best site-FER                      (3)  | Epoch:14 | Val Acc: 0.2390
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-expw                      (0) | Train Loss: 1.4216 | Train Acc: 0.3621
 Site-expw                      (3) | Train Loss: 1.4644 | Train Acc: 0.3353
 Site-expw                      (0) | Train Loss: 1.4611 | Train Acc: 0.4015
 Site-expw                      (0) | Train Loss: 1.3331 | Train Acc: 0.4289
 Site-expw                      (3) | Train Loss: 1.3085 | Train Acc: 0.4621
 Site-youngAffectNetHQ          (1) | Train Loss: 1.8168 | Train Acc: 0.2839
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7167 | Train Acc: 0.3569
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7332 | Train Acc: 0.3112
 Site-jpWoman                   (2) | Train Loss: 1.7648 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.9769 | Train Acc: 0.2600
 Site-FER                       (1) | Train Loss: 1.8850 | Train Acc: 0.2240
Average Train Accuracy: 0.3333
 Site-expw                      (0) | Val  Loss: 1.3730 | Val  Acc: 0.5195
 Site-expw                      (3) | Val  Loss: 1.3364 | Val  Acc: 0.5043
 Site-expw                      (0) | Val  Loss: 1.3076 | Val  Acc: 0.4884
 Site-expw                      (0) | Val  Loss: 1.3036 | Val  Acc: 0.3992
 Site-expw                      (3) | Val  Loss: 1.3939 | Val  Acc: 0.4067
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.7873 | Val  Acc: 0.2621
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.7491 | Val  Acc: 0.3240
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.7185 | Val  Acc: 0.3581
 Site-jpWoman                   (2) | Val  Loss: 2.0476 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.9649 | Val  Acc: 0.1818
 Site-FER                       (1) | Val  Loss: 1.8423 | Val  Acc: 0.2585
Average Valid Accuracy: 0.3537
 Best site-expw                     (0)  | Epoch:15 | Val Acc: 0.5195
 Best site-expw                     (3)  | Epoch:15 | Val Acc: 0.5043
 Best site-expw                     (0)  | Epoch:15 | Val Acc: 0.4884
 Best site-expw                     (0)  | Epoch:15 | Val Acc: 0.3992
 Best site-expw                     (3)  | Epoch:15 | Val Acc: 0.4067
 Best site-youngAffectNetHQ         (1)  | Epoch:15 | Val Acc: 0.2621
 Best site-youngAffectNetHQ         (1)  | Epoch:15 | Val Acc: 0.3240
 Best site-youngAffectNetHQ         (1)  | Epoch:15 | Val Acc: 0.3581
 Best site-jpWoman                  (2)  | Epoch:15 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:15 | Val Acc: 0.1818
 Best site-FER                      (1)  | Epoch:15 | Val Acc: 0.2585
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-expw                      (1) | Train Loss: 1.4376 | Train Acc: 0.3534
 Site-expw                      (1) | Train Loss: 1.5085 | Train Acc: 0.3410
 Site-expw                      (1) | Train Loss: 1.4168 | Train Acc: 0.4595
 Site-expw                      (1) | Train Loss: 1.3776 | Train Acc: 0.4083
 Site-expw                      (1) | Train Loss: 1.3398 | Train Acc: 0.4603
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7817 | Train Acc: 0.3032
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7087 | Train Acc: 0.3680
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6989 | Train Acc: 0.3498
 Site-jpWoman                   (2) | Train Loss: 1.8125 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.9251 | Train Acc: 0.2000
 Site-FER                       (3) | Train Loss: 1.8244 | Train Acc: 0.2825
Average Train Accuracy: 0.3424
 Site-expw                      (1) | Val  Loss: 1.3960 | Val  Acc: 0.5584
 Site-expw                      (1) | Val  Loss: 1.3157 | Val  Acc: 0.4522
 Site-expw                      (1) | Val  Loss: 1.3103 | Val  Acc: 0.4826
 Site-expw                      (1) | Val  Loss: 1.3388 | Val  Acc: 0.4147
 Site-expw                      (1) | Val  Loss: 1.4118 | Val  Acc: 0.4119
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6968 | Val  Acc: 0.2913
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7194 | Val  Acc: 0.3352
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7148 | Val  Acc: 0.3645
 Site-jpWoman                   (2) | Val  Loss: 2.0339 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.8958 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.8355 | Val  Acc: 0.2878
Average Valid Accuracy: 0.3690
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.5584
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4522
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4826
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4147
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4119
 Best site-youngAffectNetHQ         (0)  | Epoch:16 | Val Acc: 0.2913
 Best site-youngAffectNetHQ         (0)  | Epoch:16 | Val Acc: 0.3352
 Best site-youngAffectNetHQ         (0)  | Epoch:16 | Val Acc: 0.3645
 Best site-jpWoman                  (2)  | Epoch:16 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:16 | Val Acc: 0.2727
 Best site-FER                      (3)  | Epoch:16 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-expw                      (1) | Train Loss: 1.3814 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.4521 | Train Acc: 0.3873
 Site-expw                      (1) | Train Loss: 1.4396 | Train Acc: 0.4363
 Site-expw                      (1) | Train Loss: 1.2662 | Train Acc: 0.4160
 Site-expw                      (1) | Train Loss: 1.3432 | Train Acc: 0.4466
 Site-youngAffectNetHQ          (2) | Train Loss: 1.8580 | Train Acc: 0.2516
 Site-youngAffectNetHQ          (2) | Train Loss: 1.7759 | Train Acc: 0.3792
 Site-youngAffectNetHQ          (2) | Train Loss: 1.7051 | Train Acc: 0.3498
 Site-jpWoman                   (3) | Train Loss: 1.8363 | Train Acc: 0.1600
 Site-jpWoman                   (3) | Train Loss: 1.9242 | Train Acc: 0.2000
 Site-FER                       (0) | Train Loss: 1.8668 | Train Acc: 0.2695
Average Train Accuracy: 0.3388
 Site-expw                      (1) | Val  Loss: 1.3577 | Val  Acc: 0.4935
 Site-expw                      (1) | Val  Loss: 1.3115 | Val  Acc: 0.4783
 Site-expw                      (1) | Val  Loss: 1.3140 | Val  Acc: 0.4884
 Site-expw                      (1) | Val  Loss: 1.2818 | Val  Acc: 0.4419
 Site-expw                      (1) | Val  Loss: 1.4340 | Val  Acc: 0.3834
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.7067 | Val  Acc: 0.3010
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.7056 | Val  Acc: 0.3184
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.6795 | Val  Acc: 0.3806
 Site-jpWoman                   (3) | Val  Loss: 1.9979 | Val  Acc: 0.1250
 Site-jpWoman                   (3) | Val  Loss: 1.9248 | Val  Acc: 0.2727
 Site-FER                       (0) | Val  Loss: 1.8220 | Val  Acc: 0.2585
Average Valid Accuracy: 0.3583
============ Train epoch 18 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-expw                      (1) | Train Loss: 1.3924 | Train Acc: 0.4224
 Site-expw                      (1) | Train Loss: 1.4972 | Train Acc: 0.3699
 Site-expw                      (1) | Train Loss: 1.3514 | Train Acc: 0.4479
 Site-expw                      (1) | Train Loss: 1.3207 | Train Acc: 0.4393
 Site-expw                      (1) | Train Loss: 1.3430 | Train Acc: 0.4621
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7905 | Train Acc: 0.3097
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7010 | Train Acc: 0.3792
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7147 | Train Acc: 0.3326
 Site-jpWoman                   (2) | Train Loss: 1.8012 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 1.8453 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 1.8473 | Train Acc: 0.2532
Average Train Accuracy: 0.3506
 Site-expw                      (1) | Val  Loss: 1.3526 | Val  Acc: 0.5325
 Site-expw                      (1) | Val  Loss: 1.2832 | Val  Acc: 0.4522
 Site-expw                      (1) | Val  Loss: 1.2861 | Val  Acc: 0.4477
 Site-expw                      (1) | Val  Loss: 1.2672 | Val  Acc: 0.4070
 Site-expw                      (1) | Val  Loss: 1.4316 | Val  Acc: 0.4352
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7064 | Val  Acc: 0.3010
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6897 | Val  Acc: 0.3352
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6846 | Val  Acc: 0.3710
 Site-jpWoman                   (2) | Val  Loss: 1.8992 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 2.0283 | Val  Acc: 0.2121
 Site-FER                       (3) | Val  Loss: 1.8369 | Val  Acc: 0.2829
Average Valid Accuracy: 0.3604
============ Train epoch 19 ============
cnt=[1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-expw                      (3) | Train Loss: 1.3801 | Train Acc: 0.3793
 Site-expw                      (0) | Train Loss: 1.4867 | Train Acc: 0.3642
 Site-expw                      (3) | Train Loss: 1.2511 | Train Acc: 0.4517
 Site-expw                      (3) | Train Loss: 1.3576 | Train Acc: 0.4315
 Site-expw                      (3) | Train Loss: 1.3374 | Train Acc: 0.4845
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7716 | Train Acc: 0.2645
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7014 | Train Acc: 0.3792
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6813 | Train Acc: 0.3562
 Site-jpWoman                   (2) | Train Loss: 1.7137 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.9163 | Train Acc: 0.2200
 Site-FER                       (1) | Train Loss: 1.8316 | Train Acc: 0.2435
Average Train Accuracy: 0.3468
 Site-expw                      (3) | Val  Loss: 1.3541 | Val  Acc: 0.5325
 Site-expw                      (0) | Val  Loss: 1.2755 | Val  Acc: 0.5130
 Site-expw                      (3) | Val  Loss: 1.2741 | Val  Acc: 0.4942
 Site-expw                      (3) | Val  Loss: 1.3198 | Val  Acc: 0.4419
 Site-expw                      (3) | Val  Loss: 1.4281 | Val  Acc: 0.4352
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6974 | Val  Acc: 0.2816
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6846 | Val  Acc: 0.3520
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6498 | Val  Acc: 0.3903
 Site-jpWoman                   (2) | Val  Loss: 2.0390 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9150 | Val  Acc: 0.2424
 Site-FER                       (1) | Val  Loss: 1.8153 | Val  Acc: 0.2927
Average Valid Accuracy: 0.3842
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.5325
 Best site-expw                     (0)  | Epoch:19 | Val Acc: 0.5130
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.4942
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.4419
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.4352
 Best site-youngAffectNetHQ         (1)  | Epoch:19 | Val Acc: 0.2816
 Best site-youngAffectNetHQ         (1)  | Epoch:19 | Val Acc: 0.3520
 Best site-youngAffectNetHQ         (1)  | Epoch:19 | Val Acc: 0.3903
 Best site-jpWoman                  (2)  | Epoch:19 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:19 | Val Acc: 0.2424
 Best site-FER                      (1)  | Epoch:19 | Val Acc: 0.2927
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-expw                      (3) | Train Loss: 1.3879 | Train Acc: 0.3793
 Site-expw                      (3) | Train Loss: 1.4508 | Train Acc: 0.3931
 Site-expw                      (1) | Train Loss: 1.3492 | Train Acc: 0.4015
 Site-expw                      (1) | Train Loss: 1.3135 | Train Acc: 0.4289
 Site-expw                      (1) | Train Loss: 1.3130 | Train Acc: 0.4690
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7782 | Train Acc: 0.2839
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6923 | Train Acc: 0.4126
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6758 | Train Acc: 0.3240
 Site-jpWoman                   (2) | Train Loss: 1.8768 | Train Acc: 0.1600
 Site-jpWoman                   (2) | Train Loss: 1.9326 | Train Acc: 0.2200
 Site-FER                       (0) | Train Loss: 1.7998 | Train Acc: 0.2825
Average Train Accuracy: 0.3413
 Site-expw                      (3) | Val  Loss: 1.3542 | Val  Acc: 0.5584
 Site-expw                      (3) | Val  Loss: 1.2890 | Val  Acc: 0.4522
 Site-expw                      (1) | Val  Loss: 1.2812 | Val  Acc: 0.5116
 Site-expw                      (1) | Val  Loss: 1.2832 | Val  Acc: 0.4109
 Site-expw                      (1) | Val  Loss: 1.3375 | Val  Acc: 0.4145
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.7251 | Val  Acc: 0.2718
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6748 | Val  Acc: 0.3464
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6550 | Val  Acc: 0.4065
 Site-jpWoman                   (2) | Val  Loss: 1.9680 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.9410 | Val  Acc: 0.1515
 Site-FER                       (0) | Val  Loss: 1.7743 | Val  Acc: 0.3024
Average Valid Accuracy: 0.3649
============ Train epoch 21 ============
cnt=[1, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-expw                      (3) | Train Loss: 1.3652 | Train Acc: 0.4052
 Site-expw                      (0) | Train Loss: 1.4286 | Train Acc: 0.3699
 Site-expw                      (3) | Train Loss: 1.3027 | Train Acc: 0.4015
 Site-expw                      (3) | Train Loss: 1.4412 | Train Acc: 0.4367
 Site-expw                      (3) | Train Loss: 1.2699 | Train Acc: 0.4810
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7954 | Train Acc: 0.2968
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6382 | Train Acc: 0.3829
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6710 | Train Acc: 0.3562
 Site-jpWoman                   (2) | Train Loss: 1.7589 | Train Acc: 0.2000
 Site-jpWoman                   (2) | Train Loss: 1.8412 | Train Acc: 0.2600
 Site-FER                       (1) | Train Loss: 1.8055 | Train Acc: 0.2890
Average Train Accuracy: 0.3527
 Site-expw                      (3) | Val  Loss: 1.3071 | Val  Acc: 0.5325
 Site-expw                      (0) | Val  Loss: 1.2685 | Val  Acc: 0.5043
 Site-expw                      (3) | Val  Loss: 1.2332 | Val  Acc: 0.5291
 Site-expw                      (3) | Val  Loss: 1.2264 | Val  Acc: 0.4419
 Site-expw                      (3) | Val  Loss: 1.3298 | Val  Acc: 0.4326
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.7154 | Val  Acc: 0.2621
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6589 | Val  Acc: 0.3631
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6705 | Val  Acc: 0.3871
 Site-jpWoman                   (2) | Val  Loss: 1.8176 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.9867 | Val  Acc: 0.2424
 Site-FER                       (1) | Val  Loss: 1.7781 | Val  Acc: 0.3561
Average Valid Accuracy: 0.3853
 Best site-expw                     (3)  | Epoch:21 | Val Acc: 0.5325
 Best site-expw                     (0)  | Epoch:21 | Val Acc: 0.5043
 Best site-expw                     (3)  | Epoch:21 | Val Acc: 0.5291
 Best site-expw                     (3)  | Epoch:21 | Val Acc: 0.4419
 Best site-expw                     (3)  | Epoch:21 | Val Acc: 0.4326
 Best site-youngAffectNetHQ         (1)  | Epoch:21 | Val Acc: 0.2621
 Best site-youngAffectNetHQ         (1)  | Epoch:21 | Val Acc: 0.3631
 Best site-youngAffectNetHQ         (1)  | Epoch:21 | Val Acc: 0.3871
 Best site-jpWoman                  (2)  | Epoch:21 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:21 | Val Acc: 0.2424
 Best site-FER                      (1)  | Epoch:21 | Val Acc: 0.3561
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-expw                      (3) | Train Loss: 1.3641 | Train Acc: 0.4224
 Site-expw                      (0) | Train Loss: 1.4527 | Train Acc: 0.4162
 Site-expw                      (3) | Train Loss: 1.3086 | Train Acc: 0.4363
 Site-expw                      (3) | Train Loss: 1.3488 | Train Acc: 0.4574
 Site-expw                      (0) | Train Loss: 1.3050 | Train Acc: 0.4879
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7520 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6598 | Train Acc: 0.3978
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6439 | Train Acc: 0.3648
 Site-jpWoman                   (2) | Train Loss: 1.7864 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.9616 | Train Acc: 0.1400
 Site-FER                       (1) | Train Loss: 1.7850 | Train Acc: 0.3117
Average Train Accuracy: 0.3651
 Site-expw                      (3) | Val  Loss: 1.3275 | Val  Acc: 0.5325
 Site-expw                      (0) | Val  Loss: 1.2758 | Val  Acc: 0.5043
 Site-expw                      (3) | Val  Loss: 1.2880 | Val  Acc: 0.5058
 Site-expw                      (3) | Val  Loss: 1.2758 | Val  Acc: 0.4419
 Site-expw                      (0) | Val  Loss: 1.3660 | Val  Acc: 0.4119
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6515 | Val  Acc: 0.3592
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6186 | Val  Acc: 0.4413
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6226 | Val  Acc: 0.3839
 Site-jpWoman                   (2) | Val  Loss: 1.8659 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.9827 | Val  Acc: 0.2424
 Site-FER                       (1) | Val  Loss: 1.7814 | Val  Acc: 0.2878
Average Valid Accuracy: 0.3908
 Best site-expw                     (3)  | Epoch:22 | Val Acc: 0.5325
 Best site-expw                     (0)  | Epoch:22 | Val Acc: 0.5043
 Best site-expw                     (3)  | Epoch:22 | Val Acc: 0.5058
 Best site-expw                     (3)  | Epoch:22 | Val Acc: 0.4419
 Best site-expw                     (0)  | Epoch:22 | Val Acc: 0.4119
 Best site-youngAffectNetHQ         (1)  | Epoch:22 | Val Acc: 0.3592
 Best site-youngAffectNetHQ         (1)  | Epoch:22 | Val Acc: 0.4413
 Best site-youngAffectNetHQ         (1)  | Epoch:22 | Val Acc: 0.3839
 Best site-jpWoman                  (2)  | Epoch:22 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:22 | Val Acc: 0.2424
 Best site-FER                      (1)  | Epoch:22 | Val Acc: 0.2878
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 23 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-expw                      (0) | Train Loss: 1.3628 | Train Acc: 0.4052
 Site-expw                      (0) | Train Loss: 1.4569 | Train Acc: 0.3584
 Site-expw                      (3) | Train Loss: 1.3776 | Train Acc: 0.4440
 Site-expw                      (3) | Train Loss: 1.3585 | Train Acc: 0.4496
 Site-expw                      (0) | Train Loss: 1.2366 | Train Acc: 0.4845
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7776 | Train Acc: 0.2710
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6928 | Train Acc: 0.3494
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6322 | Train Acc: 0.3369
 Site-jpWoman                   (2) | Train Loss: 1.6857 | Train Acc: 0.4000
 Site-jpWoman                   (2) | Train Loss: 1.9263 | Train Acc: 0.2400
 Site-FER                       (1) | Train Loss: 1.7652 | Train Acc: 0.3247
Average Train Accuracy: 0.3694
 Site-expw                      (0) | Val  Loss: 1.2979 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.2799 | Val  Acc: 0.4696
 Site-expw                      (3) | Val  Loss: 1.2525 | Val  Acc: 0.4826
 Site-expw                      (3) | Val  Loss: 1.2645 | Val  Acc: 0.4380
 Site-expw                      (0) | Val  Loss: 1.3344 | Val  Acc: 0.3964
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6624 | Val  Acc: 0.3107
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6383 | Val  Acc: 0.3799
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6215 | Val  Acc: 0.4032
 Site-jpWoman                   (2) | Val  Loss: 1.8485 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9296 | Val  Acc: 0.3030
 Site-FER                       (1) | Val  Loss: 1.7449 | Val  Acc: 0.3122
Average Valid Accuracy: 0.3924
 Best site-expw                     (0)  | Epoch:23 | Val Acc: 0.5714
 Best site-expw                     (0)  | Epoch:23 | Val Acc: 0.4696
 Best site-expw                     (3)  | Epoch:23 | Val Acc: 0.4826
 Best site-expw                     (3)  | Epoch:23 | Val Acc: 0.4380
 Best site-expw                     (0)  | Epoch:23 | Val Acc: 0.3964
 Best site-youngAffectNetHQ         (1)  | Epoch:23 | Val Acc: 0.3107
 Best site-youngAffectNetHQ         (1)  | Epoch:23 | Val Acc: 0.3799
 Best site-youngAffectNetHQ         (1)  | Epoch:23 | Val Acc: 0.4032
 Best site-jpWoman                  (2)  | Epoch:23 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:23 | Val Acc: 0.3030
 Best site-FER                      (1)  | Epoch:23 | Val Acc: 0.3122
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 24 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-expw                      (0) | Train Loss: 1.3312 | Train Acc: 0.3966
 Site-expw                      (3) | Train Loss: 1.4292 | Train Acc: 0.4162
 Site-expw                      (0) | Train Loss: 1.2711 | Train Acc: 0.4595
 Site-expw                      (0) | Train Loss: 1.2714 | Train Acc: 0.4496
 Site-expw                      (3) | Train Loss: 1.2274 | Train Acc: 0.4862
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7427 | Train Acc: 0.2968
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6614 | Train Acc: 0.4052
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6341 | Train Acc: 0.3755
 Site-jpWoman                   (2) | Train Loss: 1.7198 | Train Acc: 0.3600
 Site-jpWoman                   (2) | Train Loss: 1.9056 | Train Acc: 0.2600
 Site-FER                       (1) | Train Loss: 1.7863 | Train Acc: 0.2890
Average Train Accuracy: 0.3813
 Site-expw                      (0) | Val  Loss: 1.2736 | Val  Acc: 0.5584
 Site-expw                      (3) | Val  Loss: 1.2508 | Val  Acc: 0.4696
 Site-expw                      (0) | Val  Loss: 1.2286 | Val  Acc: 0.4651
 Site-expw                      (0) | Val  Loss: 1.3079 | Val  Acc: 0.4264
 Site-expw                      (3) | Val  Loss: 1.3066 | Val  Acc: 0.4352
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6793 | Val  Acc: 0.3107
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6371 | Val  Acc: 0.3966
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.6384 | Val  Acc: 0.3806
 Site-jpWoman                   (2) | Val  Loss: 1.9781 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.9046 | Val  Acc: 0.3636
 Site-FER                       (1) | Val  Loss: 1.7659 | Val  Acc: 0.2927
Average Valid Accuracy: 0.4067
 Best site-expw                     (0)  | Epoch:24 | Val Acc: 0.5584
 Best site-expw                     (3)  | Epoch:24 | Val Acc: 0.4696
 Best site-expw                     (0)  | Epoch:24 | Val Acc: 0.4651
 Best site-expw                     (0)  | Epoch:24 | Val Acc: 0.4264
 Best site-expw                     (3)  | Epoch:24 | Val Acc: 0.4352
 Best site-youngAffectNetHQ         (1)  | Epoch:24 | Val Acc: 0.3107
 Best site-youngAffectNetHQ         (1)  | Epoch:24 | Val Acc: 0.3966
 Best site-youngAffectNetHQ         (1)  | Epoch:24 | Val Acc: 0.3806
 Best site-jpWoman                  (2)  | Epoch:24 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:24 | Val Acc: 0.3636
 Best site-FER                      (1)  | Epoch:24 | Val Acc: 0.2927
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-expw                      (0) | Train Loss: 1.3548 | Train Acc: 0.4052
 Site-expw                      (0) | Train Loss: 1.4240 | Train Acc: 0.3815
 Site-expw                      (0) | Train Loss: 1.2936 | Train Acc: 0.4517
 Site-expw                      (0) | Train Loss: 1.2748 | Train Acc: 0.4341
 Site-expw                      (0) | Train Loss: 1.2322 | Train Acc: 0.4707
 Site-youngAffectNetHQ          (2) | Train Loss: 1.7301 | Train Acc: 0.3032
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6601 | Train Acc: 0.4201
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6022 | Train Acc: 0.4056
 Site-jpWoman                   (1) | Train Loss: 1.7334 | Train Acc: 0.2000
 Site-jpWoman                   (1) | Train Loss: 1.8203 | Train Acc: 0.2800
 Site-FER                       (3) | Train Loss: 1.7267 | Train Acc: 0.3084
Average Train Accuracy: 0.3691
 Site-expw                      (0) | Val  Loss: 1.2871 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.2477 | Val  Acc: 0.5130
 Site-expw                      (0) | Val  Loss: 1.2336 | Val  Acc: 0.5174
 Site-expw                      (0) | Val  Loss: 1.2430 | Val  Acc: 0.4341
 Site-expw                      (0) | Val  Loss: 1.3303 | Val  Acc: 0.4093
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.6281 | Val  Acc: 0.3786
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.6346 | Val  Acc: 0.4022
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.6197 | Val  Acc: 0.4161
 Site-jpWoman                   (1) | Val  Loss: 1.8978 | Val  Acc: 0.2500
 Site-jpWoman                   (1) | Val  Loss: 1.9099 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.7673 | Val  Acc: 0.3171
Average Valid Accuracy: 0.4075
 Best site-expw                     (0)  | Epoch:25 | Val Acc: 0.5714
 Best site-expw                     (0)  | Epoch:25 | Val Acc: 0.5130
 Best site-expw                     (0)  | Epoch:25 | Val Acc: 0.5174
 Best site-expw                     (0)  | Epoch:25 | Val Acc: 0.4341
 Best site-expw                     (0)  | Epoch:25 | Val Acc: 0.4093
 Best site-youngAffectNetHQ         (2)  | Epoch:25 | Val Acc: 0.3786
 Best site-youngAffectNetHQ         (2)  | Epoch:25 | Val Acc: 0.4022
 Best site-youngAffectNetHQ         (2)  | Epoch:25 | Val Acc: 0.4161
 Best site-jpWoman                  (1)  | Epoch:25 | Val Acc: 0.2500
 Best site-jpWoman                  (1)  | Epoch:25 | Val Acc: 0.2727
 Best site-FER                      (3)  | Epoch:25 | Val Acc: 0.3171
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 26 ============
cnt=[4, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-expw                      (1) | Train Loss: 1.3846 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.4460 | Train Acc: 0.3642
 Site-expw                      (1) | Train Loss: 1.2238 | Train Acc: 0.4556
 Site-expw                      (1) | Train Loss: 1.2996 | Train Acc: 0.4419
 Site-expw                      (1) | Train Loss: 1.2674 | Train Acc: 0.4931
 Site-youngAffectNetHQ          (0) | Train Loss: 1.7116 | Train Acc: 0.3161
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6124 | Train Acc: 0.3457
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5880 | Train Acc: 0.3970
 Site-jpWoman                   (3) | Train Loss: 1.8091 | Train Acc: 0.2800
 Site-jpWoman                   (2) | Train Loss: 1.8149 | Train Acc: 0.3400
 Site-FER                       (0) | Train Loss: 1.7248 | Train Acc: 0.3474
Average Train Accuracy: 0.3829
 Site-expw                      (1) | Val  Loss: 1.2781 | Val  Acc: 0.5974
 Site-expw                      (1) | Val  Loss: 1.2284 | Val  Acc: 0.5391
 Site-expw                      (1) | Val  Loss: 1.2364 | Val  Acc: 0.4942
 Site-expw                      (1) | Val  Loss: 1.2534 | Val  Acc: 0.4535
 Site-expw                      (1) | Val  Loss: 1.3364 | Val  Acc: 0.4404
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6522 | Val  Acc: 0.2913
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5950 | Val  Acc: 0.4246
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6063 | Val  Acc: 0.4194
 Site-jpWoman                   (3) | Val  Loss: 1.9694 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.8427 | Val  Acc: 0.3030
 Site-FER                       (0) | Val  Loss: 1.7393 | Val  Acc: 0.2976
Average Valid Accuracy: 0.4044
============ Train epoch 27 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-expw                      (3) | Train Loss: 1.3384 | Train Acc: 0.4052
 Site-expw                      (0) | Train Loss: 1.4401 | Train Acc: 0.3815
 Site-expw                      (3) | Train Loss: 1.3282 | Train Acc: 0.4402
 Site-expw                      (3) | Train Loss: 1.3363 | Train Acc: 0.4677
 Site-expw                      (0) | Train Loss: 1.2148 | Train Acc: 0.4879
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7237 | Train Acc: 0.3290
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6848 | Train Acc: 0.3792
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5786 | Train Acc: 0.4056
 Site-jpWoman                   (2) | Train Loss: 1.8168 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.8815 | Train Acc: 0.3000
 Site-FER                       (1) | Train Loss: 1.7474 | Train Acc: 0.3247
Average Train Accuracy: 0.3783
 Site-expw                      (3) | Val  Loss: 1.2854 | Val  Acc: 0.5195
 Site-expw                      (0) | Val  Loss: 1.2320 | Val  Acc: 0.5217
 Site-expw                      (3) | Val  Loss: 1.1869 | Val  Acc: 0.5174
 Site-expw                      (3) | Val  Loss: 1.2613 | Val  Acc: 0.4341
 Site-expw                      (0) | Val  Loss: 1.3017 | Val  Acc: 0.4275
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5858 | Val  Acc: 0.4078
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5848 | Val  Acc: 0.3966
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5934 | Val  Acc: 0.4161
 Site-jpWoman                   (2) | Val  Loss: 2.0483 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9038 | Val  Acc: 0.2727
 Site-FER                       (1) | Val  Loss: 1.7392 | Val  Acc: 0.3073
Average Valid Accuracy: 0.4064
============ Train epoch 28 ============
cnt=[2, 4, 4, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-expw                      (1) | Train Loss: 1.2932 | Train Acc: 0.4138
 Site-expw                      (3) | Train Loss: 1.4188 | Train Acc: 0.3699
 Site-expw                      (1) | Train Loss: 1.3248 | Train Acc: 0.4517
 Site-expw                      (1) | Train Loss: 1.2598 | Train Acc: 0.4729
 Site-expw                      (1) | Train Loss: 1.1895 | Train Acc: 0.5034
 Site-youngAffectNetHQ          (2) | Train Loss: 1.7537 | Train Acc: 0.3032
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6166 | Train Acc: 0.3829
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5827 | Train Acc: 0.4013
 Site-jpWoman                   (0) | Train Loss: 1.8096 | Train Acc: 0.2400
 Site-jpWoman                   (0) | Train Loss: 1.8822 | Train Acc: 0.2200
 Site-FER                       (2) | Train Loss: 1.7072 | Train Acc: 0.3312
Average Train Accuracy: 0.3719
 Site-expw                      (1) | Val  Loss: 1.2790 | Val  Acc: 0.5195
 Site-expw                      (3) | Val  Loss: 1.2038 | Val  Acc: 0.5391
 Site-expw                      (1) | Val  Loss: 1.2093 | Val  Acc: 0.5000
 Site-expw                      (1) | Val  Loss: 1.2582 | Val  Acc: 0.4380
 Site-expw                      (1) | Val  Loss: 1.2998 | Val  Acc: 0.4249
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.6149 | Val  Acc: 0.3786
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5978 | Val  Acc: 0.4246
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5881 | Val  Acc: 0.4226
 Site-jpWoman                   (0) | Val  Loss: 1.7839 | Val  Acc: 0.3125
 Site-jpWoman                   (0) | Val  Loss: 1.7981 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.7270 | Val  Acc: 0.3756
Average Valid Accuracy: 0.4244
 Best site-expw                     (1)  | Epoch:28 | Val Acc: 0.5195
 Best site-expw                     (3)  | Epoch:28 | Val Acc: 0.5391
 Best site-expw                     (1)  | Epoch:28 | Val Acc: 0.5000
 Best site-expw                     (1)  | Epoch:28 | Val Acc: 0.4380
 Best site-expw                     (1)  | Epoch:28 | Val Acc: 0.4249
 Best site-youngAffectNetHQ         (2)  | Epoch:28 | Val Acc: 0.3786
 Best site-youngAffectNetHQ         (2)  | Epoch:28 | Val Acc: 0.4246
 Best site-youngAffectNetHQ         (2)  | Epoch:28 | Val Acc: 0.4226
 Best site-jpWoman                  (0)  | Epoch:28 | Val Acc: 0.3125
 Best site-jpWoman                  (0)  | Epoch:28 | Val Acc: 0.3333
 Best site-FER                      (2)  | Epoch:28 | Val Acc: 0.3756
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-expw                      (1) | Train Loss: 1.3152 | Train Acc: 0.4138
 Site-expw                      (3) | Train Loss: 1.4386 | Train Acc: 0.3988
 Site-expw                      (1) | Train Loss: 1.3255 | Train Acc: 0.4556
 Site-expw                      (1) | Train Loss: 1.2653 | Train Acc: 0.4419
 Site-expw                      (3) | Train Loss: 1.2159 | Train Acc: 0.5103
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6776 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6563 | Train Acc: 0.3903
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5547 | Train Acc: 0.4120
 Site-jpWoman                   (2) | Train Loss: 1.7416 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.8877 | Train Acc: 0.2400
 Site-FER                       (0) | Train Loss: 1.7239 | Train Acc: 0.3312
Average Train Accuracy: 0.3796
 Site-expw                      (1) | Val  Loss: 1.2319 | Val  Acc: 0.5455
 Site-expw                      (3) | Val  Loss: 1.1851 | Val  Acc: 0.5652
 Site-expw                      (1) | Val  Loss: 1.1664 | Val  Acc: 0.5698
 Site-expw                      (1) | Val  Loss: 1.2413 | Val  Acc: 0.4341
 Site-expw                      (3) | Val  Loss: 1.2932 | Val  Acc: 0.4275
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.6095 | Val  Acc: 0.3689
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5821 | Val  Acc: 0.4302
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5794 | Val  Acc: 0.4065
 Site-jpWoman                   (2) | Val  Loss: 1.9586 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9321 | Val  Acc: 0.2424
 Site-FER                       (0) | Val  Loss: 1.7516 | Val  Acc: 0.3024
Average Valid Accuracy: 0.4129
============ Train epoch 30 ============
cnt=[5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-expw                      (0) | Train Loss: 1.3181 | Train Acc: 0.4310
 Site-expw                      (0) | Train Loss: 1.3862 | Train Acc: 0.4220
 Site-expw                      (0) | Train Loss: 1.1764 | Train Acc: 0.4749
 Site-expw                      (0) | Train Loss: 1.2638 | Train Acc: 0.4496
 Site-expw                      (0) | Train Loss: 1.2000 | Train Acc: 0.5086
 Site-youngAffectNetHQ          (3) | Train Loss: 1.6906 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (3) | Train Loss: 1.6110 | Train Acc: 0.4015
 Site-youngAffectNetHQ          (3) | Train Loss: 1.5591 | Train Acc: 0.4206
 Site-jpWoman                   (1) | Train Loss: 1.7539 | Train Acc: 0.2800
 Site-jpWoman                   (1) | Train Loss: 1.8902 | Train Acc: 0.2600
 Site-FER                       (2) | Train Loss: 1.7182 | Train Acc: 0.3701
Average Train Accuracy: 0.3964
 Site-expw                      (0) | Val  Loss: 1.2225 | Val  Acc: 0.5325
 Site-expw                      (0) | Val  Loss: 1.1814 | Val  Acc: 0.5130
 Site-expw                      (0) | Val  Loss: 1.1885 | Val  Acc: 0.5058
 Site-expw                      (0) | Val  Loss: 1.1904 | Val  Acc: 0.4922
 Site-expw                      (0) | Val  Loss: 1.3412 | Val  Acc: 0.4637
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5676 | Val  Acc: 0.4175
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5608 | Val  Acc: 0.4246
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5658 | Val  Acc: 0.4097
 Site-jpWoman                   (1) | Val  Loss: 2.1520 | Val  Acc: 0.1250
 Site-jpWoman                   (1) | Val  Loss: 1.9107 | Val  Acc: 0.3636
 Site-FER                       (2) | Val  Loss: 1.6845 | Val  Acc: 0.3463
Average Valid Accuracy: 0.4176
============ Train epoch 31 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-expw                      (0) | Train Loss: 1.3391 | Train Acc: 0.4483
 Site-expw                      (0) | Train Loss: 1.3961 | Train Acc: 0.3699
 Site-expw                      (0) | Train Loss: 1.2211 | Train Acc: 0.4749
 Site-expw                      (0) | Train Loss: 1.3145 | Train Acc: 0.4729
 Site-expw                      (0) | Train Loss: 1.2325 | Train Acc: 0.5086
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6756 | Train Acc: 0.3226
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6023 | Train Acc: 0.4498
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5841 | Train Acc: 0.4292
 Site-jpWoman                   (3) | Train Loss: 1.7413 | Train Acc: 0.3200
 Site-jpWoman                   (3) | Train Loss: 1.8803 | Train Acc: 0.2000
 Site-FER                       (2) | Train Loss: 1.7018 | Train Acc: 0.3409
Average Train Accuracy: 0.3943
 Site-expw                      (0) | Val  Loss: 1.2520 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.1798 | Val  Acc: 0.5565
 Site-expw                      (0) | Val  Loss: 1.1902 | Val  Acc: 0.5174
 Site-expw                      (0) | Val  Loss: 1.1900 | Val  Acc: 0.4690
 Site-expw                      (0) | Val  Loss: 1.3256 | Val  Acc: 0.4145
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5571 | Val  Acc: 0.4078
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5289 | Val  Acc: 0.4637
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5503 | Val  Acc: 0.4387
 Site-jpWoman                   (3) | Val  Loss: 1.7408 | Val  Acc: 0.2500
 Site-jpWoman                   (3) | Val  Loss: 1.8163 | Val  Acc: 0.3030
 Site-FER                       (2) | Val  Loss: 1.7245 | Val  Acc: 0.3122
Average Valid Accuracy: 0.4277
 Best site-expw                     (0)  | Epoch:31 | Val Acc: 0.5714
 Best site-expw                     (0)  | Epoch:31 | Val Acc: 0.5565
 Best site-expw                     (0)  | Epoch:31 | Val Acc: 0.5174
 Best site-expw                     (0)  | Epoch:31 | Val Acc: 0.4690
 Best site-expw                     (0)  | Epoch:31 | Val Acc: 0.4145
 Best site-youngAffectNetHQ         (1)  | Epoch:31 | Val Acc: 0.4078
 Best site-youngAffectNetHQ         (1)  | Epoch:31 | Val Acc: 0.4637
 Best site-youngAffectNetHQ         (1)  | Epoch:31 | Val Acc: 0.4387
 Best site-jpWoman                  (3)  | Epoch:31 | Val Acc: 0.2500
 Best site-jpWoman                  (3)  | Epoch:31 | Val Acc: 0.3030
 Best site-FER                      (2)  | Epoch:31 | Val Acc: 0.3122
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 32 ============
cnt=[2, 3, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-expw                      (1) | Train Loss: 1.2946 | Train Acc: 0.4914
 Site-expw                      (1) | Train Loss: 1.3985 | Train Acc: 0.3931
 Site-expw                      (3) | Train Loss: 1.3999 | Train Acc: 0.4517
 Site-expw                      (1) | Train Loss: 1.2289 | Train Acc: 0.4574
 Site-expw                      (3) | Train Loss: 1.1576 | Train Acc: 0.5190
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6799 | Train Acc: 0.3484
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6304 | Train Acc: 0.3978
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5508 | Train Acc: 0.4313
 Site-jpWoman                   (0) | Train Loss: 1.7286 | Train Acc: 0.2400
 Site-jpWoman                   (0) | Train Loss: 1.8599 | Train Acc: 0.2400
 Site-FER                       (2) | Train Loss: 1.7152 | Train Acc: 0.3214
Average Train Accuracy: 0.3901
 Site-expw                      (1) | Val  Loss: 1.2955 | Val  Acc: 0.5325
 Site-expw                      (1) | Val  Loss: 1.1582 | Val  Acc: 0.5304
 Site-expw                      (3) | Val  Loss: 1.1874 | Val  Acc: 0.4884
 Site-expw                      (1) | Val  Loss: 1.2305 | Val  Acc: 0.4496
 Site-expw                      (3) | Val  Loss: 1.2821 | Val  Acc: 0.4534
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5846 | Val  Acc: 0.4466
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5547 | Val  Acc: 0.4190
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5356 | Val  Acc: 0.4419
 Site-jpWoman                   (0) | Val  Loss: 1.8502 | Val  Acc: 0.1875
 Site-jpWoman                   (0) | Val  Loss: 1.7871 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.7026 | Val  Acc: 0.3415
Average Valid Accuracy: 0.4204
============ Train epoch 33 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-expw                      (1) | Train Loss: 1.3049 | Train Acc: 0.4224
 Site-expw                      (1) | Train Loss: 1.4241 | Train Acc: 0.3526
 Site-expw                      (1) | Train Loss: 1.2673 | Train Acc: 0.5174
 Site-expw                      (1) | Train Loss: 1.3187 | Train Acc: 0.4703
 Site-expw                      (1) | Train Loss: 1.1751 | Train Acc: 0.5155
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6883 | Train Acc: 0.3355
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6005 | Train Acc: 0.3903
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5417 | Train Acc: 0.4549
 Site-jpWoman                   (2) | Train Loss: 1.7271 | Train Acc: 0.4000
 Site-jpWoman                   (2) | Train Loss: 1.8747 | Train Acc: 0.2800
 Site-FER                       (3) | Train Loss: 1.7088 | Train Acc: 0.3377
Average Train Accuracy: 0.4070
 Site-expw                      (1) | Val  Loss: 1.2644 | Val  Acc: 0.5455
 Site-expw                      (1) | Val  Loss: 1.1934 | Val  Acc: 0.5391
 Site-expw                      (1) | Val  Loss: 1.1615 | Val  Acc: 0.5581
 Site-expw                      (1) | Val  Loss: 1.2378 | Val  Acc: 0.4690
 Site-expw                      (1) | Val  Loss: 1.3300 | Val  Acc: 0.4663
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5912 | Val  Acc: 0.3689
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5195 | Val  Acc: 0.4134
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5076 | Val  Acc: 0.4645
 Site-jpWoman                   (2) | Val  Loss: 1.7886 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.7866 | Val  Acc: 0.3030
 Site-FER                       (3) | Val  Loss: 1.7082 | Val  Acc: 0.3805
Average Valid Accuracy: 0.4326
 Best site-expw                     (1)  | Epoch:33 | Val Acc: 0.5455
 Best site-expw                     (1)  | Epoch:33 | Val Acc: 0.5391
 Best site-expw                     (1)  | Epoch:33 | Val Acc: 0.5581
 Best site-expw                     (1)  | Epoch:33 | Val Acc: 0.4690
 Best site-expw                     (1)  | Epoch:33 | Val Acc: 0.4663
 Best site-youngAffectNetHQ         (0)  | Epoch:33 | Val Acc: 0.3689
 Best site-youngAffectNetHQ         (0)  | Epoch:33 | Val Acc: 0.4134
 Best site-youngAffectNetHQ         (0)  | Epoch:33 | Val Acc: 0.4645
 Best site-jpWoman                  (2)  | Epoch:33 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:33 | Val Acc: 0.3030
 Best site-FER                      (3)  | Epoch:33 | Val Acc: 0.3805
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 34 ============
cnt=[4, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-expw                      (0) | Train Loss: 1.2652 | Train Acc: 0.4655
 Site-expw                      (0) | Train Loss: 1.4036 | Train Acc: 0.4162
 Site-expw                      (3) | Train Loss: 1.2802 | Train Acc: 0.4208
 Site-expw                      (0) | Train Loss: 1.2630 | Train Acc: 0.4755
 Site-expw                      (0) | Train Loss: 1.1756 | Train Acc: 0.5069
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6802 | Train Acc: 0.3742
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5840 | Train Acc: 0.3903
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5765 | Train Acc: 0.4142
 Site-jpWoman                   (2) | Train Loss: 1.7184 | Train Acc: 0.4000
 Site-jpWoman                   (2) | Train Loss: 1.8352 | Train Acc: 0.3400
 Site-FER                       (1) | Train Loss: 1.6745 | Train Acc: 0.3636
Average Train Accuracy: 0.4152
 Site-expw                      (0) | Val  Loss: 1.2865 | Val  Acc: 0.5584
 Site-expw                      (0) | Val  Loss: 1.1736 | Val  Acc: 0.5391
 Site-expw                      (3) | Val  Loss: 1.1661 | Val  Acc: 0.5291
 Site-expw                      (0) | Val  Loss: 1.2229 | Val  Acc: 0.4806
 Site-expw                      (0) | Val  Loss: 1.3496 | Val  Acc: 0.4585
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5783 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5451 | Val  Acc: 0.4525
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5681 | Val  Acc: 0.4290
 Site-jpWoman                   (2) | Val  Loss: 1.8937 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.7161 | Val  Acc: 0.4242
 Site-FER                       (1) | Val  Loss: 1.6798 | Val  Acc: 0.3366
Average Valid Accuracy: 0.4384
 Best site-expw                     (0)  | Epoch:34 | Val Acc: 0.5584
 Best site-expw                     (0)  | Epoch:34 | Val Acc: 0.5391
 Best site-expw                     (3)  | Epoch:34 | Val Acc: 0.5291
 Best site-expw                     (0)  | Epoch:34 | Val Acc: 0.4806
 Best site-expw                     (0)  | Epoch:34 | Val Acc: 0.4585
 Best site-youngAffectNetHQ         (1)  | Epoch:34 | Val Acc: 0.4272
 Best site-youngAffectNetHQ         (1)  | Epoch:34 | Val Acc: 0.4525
 Best site-youngAffectNetHQ         (1)  | Epoch:34 | Val Acc: 0.4290
 Best site-jpWoman                  (2)  | Epoch:34 | Val Acc: 0.1875
 Best site-jpWoman                  (2)  | Epoch:34 | Val Acc: 0.4242
 Best site-FER                      (1)  | Epoch:34 | Val Acc: 0.3366
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 35 ============
cnt=[4, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-expw                      (1) | Train Loss: 1.2996 | Train Acc: 0.4569
 Site-expw                      (1) | Train Loss: 1.3671 | Train Acc: 0.3931
 Site-expw                      (3) | Train Loss: 1.2989 | Train Acc: 0.4556
 Site-expw                      (3) | Train Loss: 1.2356 | Train Acc: 0.4651
 Site-expw                      (1) | Train Loss: 1.2001 | Train Acc: 0.5207
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6495 | Train Acc: 0.3097
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5518 | Train Acc: 0.3941
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5382 | Train Acc: 0.4421
 Site-jpWoman                   (2) | Train Loss: 1.8084 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.8565 | Train Acc: 0.2200
 Site-FER                       (0) | Train Loss: 1.6619 | Train Acc: 0.3669
Average Train Accuracy: 0.3876
 Site-expw                      (1) | Val  Loss: 1.2971 | Val  Acc: 0.5714
 Site-expw                      (1) | Val  Loss: 1.1767 | Val  Acc: 0.5304
 Site-expw                      (3) | Val  Loss: 1.2058 | Val  Acc: 0.4826
 Site-expw                      (3) | Val  Loss: 1.2289 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.2612 | Val  Acc: 0.4482
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5544 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5516 | Val  Acc: 0.4358
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5257 | Val  Acc: 0.4226
 Site-jpWoman                   (2) | Val  Loss: 1.8190 | Val  Acc: 0.3125
 Site-jpWoman                   (2) | Val  Loss: 1.7801 | Val  Acc: 0.3030
 Site-FER                       (0) | Val  Loss: 1.6892 | Val  Acc: 0.3659
Average Valid Accuracy: 0.4331
============ Train epoch 36 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-expw                      (1) | Train Loss: 1.2943 | Train Acc: 0.4483
 Site-expw                      (1) | Train Loss: 1.3828 | Train Acc: 0.3757
 Site-expw                      (1) | Train Loss: 1.2303 | Train Acc: 0.4903
 Site-expw                      (1) | Train Loss: 1.2834 | Train Acc: 0.4651
 Site-expw                      (1) | Train Loss: 1.1408 | Train Acc: 0.5207
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6975 | Train Acc: 0.3097
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5148 | Train Acc: 0.4201
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5238 | Train Acc: 0.4163
 Site-jpWoman                   (2) | Train Loss: 1.7796 | Train Acc: 0.3200
 Site-jpWoman                   (2) | Train Loss: 1.7632 | Train Acc: 0.3200
 Site-FER                       (3) | Train Loss: 1.6482 | Train Acc: 0.3636
Average Train Accuracy: 0.4045
 Site-expw                      (1) | Val  Loss: 1.2715 | Val  Acc: 0.5714
 Site-expw                      (1) | Val  Loss: 1.1562 | Val  Acc: 0.5652
 Site-expw                      (1) | Val  Loss: 1.1538 | Val  Acc: 0.5174
 Site-expw                      (1) | Val  Loss: 1.2424 | Val  Acc: 0.4612
 Site-expw                      (1) | Val  Loss: 1.3376 | Val  Acc: 0.4585
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5910 | Val  Acc: 0.4175
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5024 | Val  Acc: 0.4469
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5189 | Val  Acc: 0.4613
 Site-jpWoman                   (2) | Val  Loss: 1.7911 | Val  Acc: 0.3125
 Site-jpWoman                   (2) | Val  Loss: 1.8838 | Val  Acc: 0.3030
 Site-FER                       (3) | Val  Loss: 1.7045 | Val  Acc: 0.3610
Average Valid Accuracy: 0.4433
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.5714
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.5652
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.5174
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.4612
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.4585
 Best site-youngAffectNetHQ         (0)  | Epoch:36 | Val Acc: 0.4175
 Best site-youngAffectNetHQ         (0)  | Epoch:36 | Val Acc: 0.4469
 Best site-youngAffectNetHQ         (0)  | Epoch:36 | Val Acc: 0.4613
 Best site-jpWoman                  (2)  | Epoch:36 | Val Acc: 0.3125
 Best site-jpWoman                  (2)  | Epoch:36 | Val Acc: 0.3030
 Best site-FER                      (3)  | Epoch:36 | Val Acc: 0.3610
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-expw                      (3) | Train Loss: 1.3236 | Train Acc: 0.3879
 Site-expw                      (0) | Train Loss: 1.3809 | Train Acc: 0.4104
 Site-expw                      (3) | Train Loss: 1.1890 | Train Acc: 0.4826
 Site-expw                      (3) | Train Loss: 1.2381 | Train Acc: 0.4832
 Site-expw                      (0) | Train Loss: 1.1259 | Train Acc: 0.5086
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6663 | Train Acc: 0.2903
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5678 | Train Acc: 0.4275
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5332 | Train Acc: 0.4378
 Site-jpWoman                   (2) | Train Loss: 1.7046 | Train Acc: 0.2400
 Site-jpWoman                   (2) | Train Loss: 1.8031 | Train Acc: 0.3600
 Site-FER                       (1) | Train Loss: 1.6331 | Train Acc: 0.3961
Average Train Accuracy: 0.4022
 Site-expw                      (3) | Val  Loss: 1.2219 | Val  Acc: 0.5455
 Site-expw                      (0) | Val  Loss: 1.1424 | Val  Acc: 0.5130
 Site-expw                      (3) | Val  Loss: 1.1852 | Val  Acc: 0.5058
 Site-expw                      (3) | Val  Loss: 1.2438 | Val  Acc: 0.4729
 Site-expw                      (0) | Val  Loss: 1.2341 | Val  Acc: 0.4741
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5522 | Val  Acc: 0.3883
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5154 | Val  Acc: 0.4413
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5113 | Val  Acc: 0.4387
 Site-jpWoman                   (2) | Val  Loss: 1.7264 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8609 | Val  Acc: 0.4242
 Site-FER                       (1) | Val  Loss: 1.6997 | Val  Acc: 0.3610
Average Valid Accuracy: 0.4491
 Best site-expw                     (3)  | Epoch:37 | Val Acc: 0.5455
 Best site-expw                     (0)  | Epoch:37 | Val Acc: 0.5130
 Best site-expw                     (3)  | Epoch:37 | Val Acc: 0.5058
 Best site-expw                     (3)  | Epoch:37 | Val Acc: 0.4729
 Best site-expw                     (0)  | Epoch:37 | Val Acc: 0.4741
 Best site-youngAffectNetHQ         (1)  | Epoch:37 | Val Acc: 0.3883
 Best site-youngAffectNetHQ         (1)  | Epoch:37 | Val Acc: 0.4413
 Best site-youngAffectNetHQ         (1)  | Epoch:37 | Val Acc: 0.4387
 Best site-jpWoman                  (2)  | Epoch:37 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:37 | Val Acc: 0.4242
 Best site-FER                      (1)  | Epoch:37 | Val Acc: 0.3610
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 38 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-expw                      (0) | Train Loss: 1.2822 | Train Acc: 0.4569
 Site-expw                      (0) | Train Loss: 1.3809 | Train Acc: 0.4162
 Site-expw                      (0) | Train Loss: 1.1821 | Train Acc: 0.4672
 Site-expw                      (0) | Train Loss: 1.1800 | Train Acc: 0.4780
 Site-expw                      (0) | Train Loss: 1.1702 | Train Acc: 0.5259
 Site-youngAffectNetHQ          (3) | Train Loss: 1.7191 | Train Acc: 0.3290
 Site-youngAffectNetHQ          (3) | Train Loss: 1.5748 | Train Acc: 0.4164
 Site-youngAffectNetHQ          (3) | Train Loss: 1.4851 | Train Acc: 0.4549
 Site-jpWoman                   (2) | Train Loss: 1.8086 | Train Acc: 0.2800
 Site-jpWoman                   (2) | Train Loss: 1.8417 | Train Acc: 0.2800
 Site-FER                       (1) | Train Loss: 1.6603 | Train Acc: 0.3539
Average Train Accuracy: 0.4053
 Site-expw                      (0) | Val  Loss: 1.2544 | Val  Acc: 0.4935
 Site-expw                      (0) | Val  Loss: 1.2005 | Val  Acc: 0.5217
 Site-expw                      (0) | Val  Loss: 1.1943 | Val  Acc: 0.4826
 Site-expw                      (0) | Val  Loss: 1.1609 | Val  Acc: 0.4884
 Site-expw                      (0) | Val  Loss: 1.2930 | Val  Acc: 0.4637
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5821 | Val  Acc: 0.3981
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5056 | Val  Acc: 0.4358
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5309 | Val  Acc: 0.4355
 Site-jpWoman                   (2) | Val  Loss: 1.8350 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.8345 | Val  Acc: 0.3333
 Site-FER                       (1) | Val  Loss: 1.6264 | Val  Acc: 0.3902
Average Valid Accuracy: 0.4266
============ Train epoch 39 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-expw                      (1) | Train Loss: 1.2989 | Train Acc: 0.3879
 Site-expw                      (1) | Train Loss: 1.3858 | Train Acc: 0.3815
 Site-expw                      (1) | Train Loss: 1.2807 | Train Acc: 0.5019
 Site-expw                      (1) | Train Loss: 1.3223 | Train Acc: 0.4755
 Site-expw                      (1) | Train Loss: 1.1131 | Train Acc: 0.5414
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6913 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (0) | Train Loss: 1.5859 | Train Acc: 0.4089
 Site-youngAffectNetHQ          (0) | Train Loss: 1.4972 | Train Acc: 0.4657
 Site-jpWoman                   (2) | Train Loss: 1.8184 | Train Acc: 0.3600
 Site-jpWoman                   (2) | Train Loss: 1.8158 | Train Acc: 0.2800
 Site-FER                       (3) | Train Loss: 1.6518 | Train Acc: 0.4091
Average Train Accuracy: 0.4140
 Site-expw                      (1) | Val  Loss: 1.2117 | Val  Acc: 0.5065
 Site-expw                      (1) | Val  Loss: 1.1283 | Val  Acc: 0.5565
 Site-expw                      (1) | Val  Loss: 1.1705 | Val  Acc: 0.5233
 Site-expw                      (1) | Val  Loss: 1.2389 | Val  Acc: 0.4922
 Site-expw                      (1) | Val  Loss: 1.2626 | Val  Acc: 0.4793
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5198 | Val  Acc: 0.4369
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.4837 | Val  Acc: 0.4693
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.4933 | Val  Acc: 0.4419
 Site-jpWoman                   (2) | Val  Loss: 1.9199 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.8234 | Val  Acc: 0.3333
 Site-FER                       (3) | Val  Loss: 1.6516 | Val  Acc: 0.3805
Average Valid Accuracy: 0.4427
============ Train epoch 40 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-expw                      (0) | Train Loss: 1.2943 | Train Acc: 0.4397
 Site-expw                      (0) | Train Loss: 1.3854 | Train Acc: 0.3931
 Site-expw                      (0) | Train Loss: 1.1505 | Train Acc: 0.4981
 Site-expw                      (0) | Train Loss: 1.3521 | Train Acc: 0.4780
 Site-expw                      (0) | Train Loss: 1.1724 | Train Acc: 0.5431
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6800 | Train Acc: 0.3677
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5647 | Train Acc: 0.4164
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5129 | Train Acc: 0.4528
 Site-jpWoman                   (2) | Train Loss: 1.7320 | Train Acc: 0.3600
 Site-jpWoman                   (2) | Train Loss: 1.8248 | Train Acc: 0.2600
 Site-FER                       (3) | Train Loss: 1.6371 | Train Acc: 0.4286
Average Train Accuracy: 0.4216
 Site-expw                      (0) | Val  Loss: 1.2075 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.1585 | Val  Acc: 0.5478
 Site-expw                      (0) | Val  Loss: 1.1512 | Val  Acc: 0.5000
 Site-expw                      (0) | Val  Loss: 1.1879 | Val  Acc: 0.4806
 Site-expw                      (0) | Val  Loss: 1.2609 | Val  Acc: 0.4611
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5296 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4774 | Val  Acc: 0.4972
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4753 | Val  Acc: 0.4806
 Site-jpWoman                   (2) | Val  Loss: 1.9064 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.8205 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.6657 | Val  Acc: 0.4293
Average Valid Accuracy: 0.4414
 Test site-expw                      (0)| Epoch:37 | Test Acc: 0.3860
 Test site-youngAffectNetHQ          (1)| Epoch:37 | Test Acc: 0.3079
 Test site-jpWoman                   (2)| Epoch:37 | Test Acc: 0.2989
 Test site-FER                       (3)| Epoch:37 | Test Acc: 0.2982
expw: 0.3860, youngAffectNetHQ: 0.3079, jpWoman: 0.2989, FER: 0.2982, 
Average Test Accuracy(group): 0.3227, Average Test Accuracy(individual): 0.3409,
domain std=0.0367, cluster std=0.0367, individual std=0.0413, 
Average Test Accuracy: 0.3227
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-expw                      (0) | Train Loss: 1.2845 | Train Acc: 0.4483
 Site-expw                      (0) | Train Loss: 1.3655 | Train Acc: 0.4104
 Site-expw                      (0) | Train Loss: 1.3925 | Train Acc: 0.4903
 Site-expw                      (0) | Train Loss: 1.3663 | Train Acc: 0.4780
 Site-expw                      (0) | Train Loss: 1.1473 | Train Acc: 0.5224
 Site-youngAffectNetHQ          (3) | Train Loss: 1.6475 | Train Acc: 0.3613
 Site-youngAffectNetHQ          (3) | Train Loss: 1.5045 | Train Acc: 0.4164
 Site-youngAffectNetHQ          (3) | Train Loss: 1.4581 | Train Acc: 0.4506
 Site-jpWoman                   (2) | Train Loss: 1.8432 | Train Acc: 0.3600
 Site-jpWoman                   (2) | Train Loss: 1.8496 | Train Acc: 0.2400
 Site-FER                       (1) | Train Loss: 1.6530 | Train Acc: 0.4091
Average Train Accuracy: 0.4170
 Site-expw                      (0) | Val  Loss: 1.2340 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.1694 | Val  Acc: 0.5652
 Site-expw                      (0) | Val  Loss: 1.1557 | Val  Acc: 0.5698
 Site-expw                      (0) | Val  Loss: 1.2488 | Val  Acc: 0.4961
 Site-expw                      (0) | Val  Loss: 1.2580 | Val  Acc: 0.4741
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.5389 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.4642 | Val  Acc: 0.4637
 Site-youngAffectNetHQ          (3) | Val  Loss: 1.4913 | Val  Acc: 0.4677
 Site-jpWoman                   (2) | Val  Loss: 1.8126 | Val  Acc: 0.3125
 Site-jpWoman                   (2) | Val  Loss: 1.8531 | Val  Acc: 0.3030
 Site-FER                       (1) | Val  Loss: 1.6777 | Val  Acc: 0.3951
Average Valid Accuracy: 0.4587
 Best site-expw                     (0)  | Epoch:41 | Val Acc: 0.5714
 Best site-expw                     (0)  | Epoch:41 | Val Acc: 0.5652
 Best site-expw                     (0)  | Epoch:41 | Val Acc: 0.5698
 Best site-expw                     (0)  | Epoch:41 | Val Acc: 0.4961
 Best site-expw                     (0)  | Epoch:41 | Val Acc: 0.4741
 Best site-youngAffectNetHQ         (3)  | Epoch:41 | Val Acc: 0.4272
 Best site-youngAffectNetHQ         (3)  | Epoch:41 | Val Acc: 0.4637
 Best site-youngAffectNetHQ         (3)  | Epoch:41 | Val Acc: 0.4677
 Best site-jpWoman                  (2)  | Epoch:41 | Val Acc: 0.3125
 Best site-jpWoman                  (2)  | Epoch:41 | Val Acc: 0.3030
 Best site-FER                      (1)  | Epoch:41 | Val Acc: 0.3951
 Test site-expw                      (0)| Epoch:41 | Test Acc: 0.3804
 Test site-youngAffectNetHQ          (3)| Epoch:41 | Test Acc: 0.3036
 Test site-jpWoman                   (2)| Epoch:41 | Test Acc: 0.2759
 Test site-FER                       (1)| Epoch:41 | Test Acc: 0.3043
expw: 0.3804, youngAffectNetHQ: 0.3036, jpWoman: 0.2759, FER: 0.3043, 
Average Test Accuracy(group): 0.3160, Average Test Accuracy(individual): 0.3335,
domain std=0.0389, cluster std=0.0389, individual std=0.0439, 
Average Test Accuracy: 0.3160
============ Train epoch 42 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-expw                      (1) | Train Loss: 1.2758 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.3971 | Train Acc: 0.4162
 Site-expw                      (1) | Train Loss: 1.2139 | Train Acc: 0.4749
 Site-expw                      (1) | Train Loss: 1.2715 | Train Acc: 0.4832
 Site-expw                      (1) | Train Loss: 1.1443 | Train Acc: 0.5397
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6310 | Train Acc: 0.3290
 Site-youngAffectNetHQ          (0) | Train Loss: 1.6141 | Train Acc: 0.4238
 Site-youngAffectNetHQ          (0) | Train Loss: 1.4806 | Train Acc: 0.4657
 Site-jpWoman                   (2) | Train Loss: 1.6445 | Train Acc: 0.4000
 Site-jpWoman                   (2) | Train Loss: 1.7243 | Train Acc: 0.3400
 Site-FER                       (3) | Train Loss: 1.6467 | Train Acc: 0.3961
Average Train Accuracy: 0.4272
 Site-expw                      (1) | Val  Loss: 1.2132 | Val  Acc: 0.5584
 Site-expw                      (1) | Val  Loss: 1.1482 | Val  Acc: 0.5217
 Site-expw                      (1) | Val  Loss: 1.1574 | Val  Acc: 0.5640
 Site-expw                      (1) | Val  Loss: 1.1796 | Val  Acc: 0.5078
 Site-expw                      (1) | Val  Loss: 1.3040 | Val  Acc: 0.4637
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.5085 | Val  Acc: 0.4563
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.4698 | Val  Acc: 0.4302
 Site-youngAffectNetHQ          (0) | Val  Loss: 1.4992 | Val  Acc: 0.4581
 Site-jpWoman                   (2) | Val  Loss: 1.8761 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.8892 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.6390 | Val  Acc: 0.3756
Average Valid Accuracy: 0.4360
 Test site-expw                      (1)| Epoch:41 | Test Acc: 0.3837
 Test site-youngAffectNetHQ          (0)| Epoch:41 | Test Acc: 0.2993
 Test site-jpWoman                   (2)| Epoch:41 | Test Acc: 0.2759
 Test site-FER                       (3)| Epoch:41 | Test Acc: 0.3043
expw: 0.3837, youngAffectNetHQ: 0.2993, jpWoman: 0.2759, FER: 0.3043, 
Average Test Accuracy(group): 0.3158, Average Test Accuracy(individual): 0.3339,
domain std=0.0407, cluster std=0.0407, individual std=0.0463, 
Average Test Accuracy: 0.3158
============ Train epoch 43 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-expw                      (0) | Train Loss: 1.3102 | Train Acc: 0.4397
 Site-expw                      (0) | Train Loss: 1.3933 | Train Acc: 0.4104
 Site-expw                      (0) | Train Loss: 1.2406 | Train Acc: 0.4595
 Site-expw                      (0) | Train Loss: 1.3325 | Train Acc: 0.4935
 Site-expw                      (0) | Train Loss: 1.1362 | Train Acc: 0.5293
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6639 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5343 | Train Acc: 0.4089
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4779 | Train Acc: 0.4399
 Site-jpWoman                   (2) | Train Loss: 1.8060 | Train Acc: 0.3200
 Site-jpWoman                   (2) | Train Loss: 1.8308 | Train Acc: 0.2600
 Site-FER                       (3) | Train Loss: 1.6136 | Train Acc: 0.4188
Average Train Accuracy: 0.4111
 Site-expw                      (0) | Val  Loss: 1.2220 | Val  Acc: 0.5325
 Site-expw                      (0) | Val  Loss: 1.2262 | Val  Acc: 0.5043
 Site-expw                      (0) | Val  Loss: 1.1794 | Val  Acc: 0.5465
 Site-expw                      (0) | Val  Loss: 1.2673 | Val  Acc: 0.4612
 Site-expw                      (0) | Val  Loss: 1.2395 | Val  Acc: 0.4663
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5066 | Val  Acc: 0.3981
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4644 | Val  Acc: 0.4581
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4675 | Val  Acc: 0.4581
 Site-jpWoman                   (2) | Val  Loss: 1.7464 | Val  Acc: 0.3125
 Site-jpWoman                   (2) | Val  Loss: 1.7843 | Val  Acc: 0.3636
 Site-FER                       (3) | Val  Loss: 1.6416 | Val  Acc: 0.3951
Average Valid Accuracy: 0.4451
 Test site-expw                      (0)| Epoch:41 | Test Acc: 0.3916
 Test site-youngAffectNetHQ          (1)| Epoch:41 | Test Acc: 0.3136
 Test site-jpWoman                   (2)| Epoch:41 | Test Acc: 0.2759
 Test site-FER                       (3)| Epoch:41 | Test Acc: 0.3120
expw: 0.3916, youngAffectNetHQ: 0.3136, jpWoman: 0.2759, FER: 0.3120, 
Average Test Accuracy(group): 0.3233, Average Test Accuracy(individual): 0.3421,
domain std=0.0423, cluster std=0.0423, individual std=0.0471, 
Average Test Accuracy: 0.3233
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 3, 4, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-expw                      (1) | Train Loss: 1.2863 | Train Acc: 0.4397
 Site-expw                      (3) | Train Loss: 1.3982 | Train Acc: 0.3815
 Site-expw                      (1) | Train Loss: 1.3199 | Train Acc: 0.4710
 Site-expw                      (1) | Train Loss: 1.2647 | Train Acc: 0.4987
 Site-expw                      (3) | Train Loss: 1.1094 | Train Acc: 0.5517
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6873 | Train Acc: 0.3548
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5699 | Train Acc: 0.4461
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5138 | Train Acc: 0.4657
 Site-jpWoman                   (0) | Train Loss: 1.6888 | Train Acc: 0.3600
 Site-jpWoman                   (0) | Train Loss: 1.7754 | Train Acc: 0.2800
 Site-FER                       (2) | Train Loss: 1.6275 | Train Acc: 0.4253
Average Train Accuracy: 0.4250
 Site-expw                      (1) | Val  Loss: 1.2077 | Val  Acc: 0.5455
 Site-expw                      (3) | Val  Loss: 1.1603 | Val  Acc: 0.5739
 Site-expw                      (1) | Val  Loss: 1.1782 | Val  Acc: 0.4942
 Site-expw                      (1) | Val  Loss: 1.2208 | Val  Acc: 0.5116
 Site-expw                      (3) | Val  Loss: 1.3102 | Val  Acc: 0.4663
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5401 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4843 | Val  Acc: 0.4469
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4942 | Val  Acc: 0.4484
 Site-jpWoman                   (0) | Val  Loss: 1.6929 | Val  Acc: 0.4375
 Site-jpWoman                   (0) | Val  Loss: 1.7168 | Val  Acc: 0.3939
 Site-FER                       (2) | Val  Loss: 1.6287 | Val  Acc: 0.3951
Average Valid Accuracy: 0.4673
 Best site-expw                     (1)  | Epoch:44 | Val Acc: 0.5455
 Best site-expw                     (3)  | Epoch:44 | Val Acc: 0.5739
 Best site-expw                     (1)  | Epoch:44 | Val Acc: 0.4942
 Best site-expw                     (1)  | Epoch:44 | Val Acc: 0.5116
 Best site-expw                     (3)  | Epoch:44 | Val Acc: 0.4663
 Best site-youngAffectNetHQ         (2)  | Epoch:44 | Val Acc: 0.4272
 Best site-youngAffectNetHQ         (2)  | Epoch:44 | Val Acc: 0.4469
 Best site-youngAffectNetHQ         (2)  | Epoch:44 | Val Acc: 0.4484
 Best site-jpWoman                  (0)  | Epoch:44 | Val Acc: 0.4375
 Best site-jpWoman                  (0)  | Epoch:44 | Val Acc: 0.3939
 Best site-FER                      (2)  | Epoch:44 | Val Acc: 0.3951
 Test site-expw                      (1)| Epoch:44 | Test Acc: 0.3916
 Test site-youngAffectNetHQ          (2)| Epoch:44 | Test Acc: 0.3136
 Test site-jpWoman                   (0)| Epoch:44 | Test Acc: 0.2874
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.3089
expw: 0.3916, youngAffectNetHQ: 0.3136, jpWoman: 0.2874, FER: 0.3089, 
Average Test Accuracy(group): 0.3254, Average Test Accuracy(individual): 0.3439,
domain std=0.0395, cluster std=0.0467, individual std=0.0445, 
Average Test Accuracy: 0.3254
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-expw                      (0) | Train Loss: 1.2791 | Train Acc: 0.4483
 Site-expw                      (0) | Train Loss: 1.3645 | Train Acc: 0.3988
 Site-expw                      (0) | Train Loss: 1.3272 | Train Acc: 0.4903
 Site-expw                      (0) | Train Loss: 1.2961 | Train Acc: 0.4729
 Site-expw                      (0) | Train Loss: 1.1773 | Train Acc: 0.5500
 Site-youngAffectNetHQ          (1) | Train Loss: 1.7057 | Train Acc: 0.3097
 Site-youngAffectNetHQ          (1) | Train Loss: 1.5285 | Train Acc: 0.4164
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4840 | Train Acc: 0.4721
 Site-jpWoman                   (2) | Train Loss: 1.6324 | Train Acc: 0.3600
 Site-jpWoman                   (2) | Train Loss: 1.8003 | Train Acc: 0.3200
 Site-FER                       (3) | Train Loss: 1.6067 | Train Acc: 0.4026
Average Train Accuracy: 0.4219
 Site-expw                      (0) | Val  Loss: 1.1946 | Val  Acc: 0.5844
 Site-expw                      (0) | Val  Loss: 1.1230 | Val  Acc: 0.5913
 Site-expw                      (0) | Val  Loss: 1.1557 | Val  Acc: 0.5756
 Site-expw                      (0) | Val  Loss: 1.2436 | Val  Acc: 0.4767
 Site-expw                      (0) | Val  Loss: 1.2531 | Val  Acc: 0.4845
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.5206 | Val  Acc: 0.4272
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4513 | Val  Acc: 0.4804
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4680 | Val  Acc: 0.4645
 Site-jpWoman                   (2) | Val  Loss: 1.7852 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8258 | Val  Acc: 0.3333
 Site-FER                       (3) | Val  Loss: 1.6289 | Val  Acc: 0.3805
Average Valid Accuracy: 0.4703
 Best site-expw                     (0)  | Epoch:45 | Val Acc: 0.5844
 Best site-expw                     (0)  | Epoch:45 | Val Acc: 0.5913
 Best site-expw                     (0)  | Epoch:45 | Val Acc: 0.5756
 Best site-expw                     (0)  | Epoch:45 | Val Acc: 0.4767
 Best site-expw                     (0)  | Epoch:45 | Val Acc: 0.4845
 Best site-youngAffectNetHQ         (1)  | Epoch:45 | Val Acc: 0.4272
 Best site-youngAffectNetHQ         (1)  | Epoch:45 | Val Acc: 0.4804
 Best site-youngAffectNetHQ         (1)  | Epoch:45 | Val Acc: 0.4645
 Best site-jpWoman                  (2)  | Epoch:45 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:45 | Val Acc: 0.3333
 Best site-FER                      (3)  | Epoch:45 | Val Acc: 0.3805
 Test site-expw                      (0)| Epoch:45 | Test Acc: 0.3894
 Test site-youngAffectNetHQ          (1)| Epoch:45 | Test Acc: 0.3121
 Test site-jpWoman                   (2)| Epoch:45 | Test Acc: 0.2759
 Test site-FER                       (3)| Epoch:45 | Test Acc: 0.3059
expw: 0.3894, youngAffectNetHQ: 0.3121, jpWoman: 0.2759, FER: 0.3059, 
Average Test Accuracy(group): 0.3208, Average Test Accuracy(individual): 0.3401,
domain std=0.0419, cluster std=0.0419, individual std=0.0466, 
Average Test Accuracy: 0.3208
============ Train epoch 46 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-expw                      (1) | Train Loss: 1.3087 | Train Acc: 0.3966
 Site-expw                      (1) | Train Loss: 1.3966 | Train Acc: 0.4162
 Site-expw                      (1) | Train Loss: 1.3320 | Train Acc: 0.4595
 Site-expw                      (1) | Train Loss: 1.2944 | Train Acc: 0.4780
 Site-expw                      (1) | Train Loss: 1.1767 | Train Acc: 0.5397
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6623 | Train Acc: 0.3226
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5620 | Train Acc: 0.4238
 Site-youngAffectNetHQ          (2) | Train Loss: 1.4716 | Train Acc: 0.4485
 Site-jpWoman                   (3) | Train Loss: 1.7020 | Train Acc: 0.3200
 Site-jpWoman                   (3) | Train Loss: 1.7406 | Train Acc: 0.3200
 Site-FER                       (0) | Train Loss: 1.6418 | Train Acc: 0.3799
Average Train Accuracy: 0.4095
 Site-expw                      (1) | Val  Loss: 1.2331 | Val  Acc: 0.5325
 Site-expw                      (1) | Val  Loss: 1.1521 | Val  Acc: 0.5565
 Site-expw                      (1) | Val  Loss: 1.1677 | Val  Acc: 0.5233
 Site-expw                      (1) | Val  Loss: 1.2388 | Val  Acc: 0.4922
 Site-expw                      (1) | Val  Loss: 1.2423 | Val  Acc: 0.4689
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4789 | Val  Acc: 0.4175
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4484 | Val  Acc: 0.4916
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4518 | Val  Acc: 0.4839
 Site-jpWoman                   (3) | Val  Loss: 1.7847 | Val  Acc: 0.2500
 Site-jpWoman                   (3) | Val  Loss: 1.8161 | Val  Acc: 0.3030
 Site-FER                       (0) | Val  Loss: 1.6350 | Val  Acc: 0.3756
Average Valid Accuracy: 0.4450
 Test site-expw                      (1)| Epoch:45 | Test Acc: 0.3962
 Test site-youngAffectNetHQ          (2)| Epoch:45 | Test Acc: 0.3064
 Test site-jpWoman                   (3)| Epoch:45 | Test Acc: 0.2529
 Test site-FER                       (0)| Epoch:45 | Test Acc: 0.3059
expw: 0.3962, youngAffectNetHQ: 0.3064, jpWoman: 0.2529, FER: 0.3059, 
Average Test Accuracy(group): 0.3153, Average Test Accuracy(individual): 0.3374,
domain std=0.0515, cluster std=0.0515, individual std=0.0568, 
Average Test Accuracy: 0.3153
============ Train epoch 47 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-expw                      (1) | Train Loss: 1.2599 | Train Acc: 0.4310
 Site-expw                      (1) | Train Loss: 1.3505 | Train Acc: 0.4104
 Site-expw                      (1) | Train Loss: 1.3072 | Train Acc: 0.4710
 Site-expw                      (1) | Train Loss: 1.2839 | Train Acc: 0.5039
 Site-expw                      (1) | Train Loss: 1.1495 | Train Acc: 0.5379
 Site-youngAffectNetHQ          (2) | Train Loss: 1.6274 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (2) | Train Loss: 1.5138 | Train Acc: 0.4684
 Site-youngAffectNetHQ          (2) | Train Loss: 1.4762 | Train Acc: 0.4850
 Site-jpWoman                   (0) | Train Loss: 1.7647 | Train Acc: 0.3200
 Site-jpWoman                   (0) | Train Loss: 1.8487 | Train Acc: 0.2600
 Site-FER                       (3) | Train Loss: 1.6247 | Train Acc: 0.4221
Average Train Accuracy: 0.4229
 Site-expw                      (1) | Val  Loss: 1.2408 | Val  Acc: 0.5455
 Site-expw                      (1) | Val  Loss: 1.1473 | Val  Acc: 0.5217
 Site-expw                      (1) | Val  Loss: 1.1655 | Val  Acc: 0.5349
 Site-expw                      (1) | Val  Loss: 1.1521 | Val  Acc: 0.4961
 Site-expw                      (1) | Val  Loss: 1.2536 | Val  Acc: 0.4819
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5217 | Val  Acc: 0.4078
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.5030 | Val  Acc: 0.4525
 Site-youngAffectNetHQ          (2) | Val  Loss: 1.4681 | Val  Acc: 0.5032
 Site-jpWoman                   (0) | Val  Loss: 1.7837 | Val  Acc: 0.1875
 Site-jpWoman                   (0) | Val  Loss: 1.8177 | Val  Acc: 0.3030
 Site-FER                       (3) | Val  Loss: 1.6389 | Val  Acc: 0.3951
Average Valid Accuracy: 0.4390
 Test site-expw                      (1)| Epoch:45 | Test Acc: 0.3916
 Test site-youngAffectNetHQ          (2)| Epoch:45 | Test Acc: 0.3157
 Test site-jpWoman                   (0)| Epoch:45 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:45 | Test Acc: 0.3059
expw: 0.3916, youngAffectNetHQ: 0.3157, jpWoman: 0.2644, FER: 0.3059, 
Average Test Accuracy(group): 0.3194, Average Test Accuracy(individual): 0.3400,
domain std=0.0459, cluster std=0.0459, individual std=0.0502, 
Average Test Accuracy: 0.3194
============ Train epoch 48 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-expw                      (0) | Train Loss: 1.3165 | Train Acc: 0.4052
 Site-expw                      (0) | Train Loss: 1.3552 | Train Acc: 0.4220
 Site-expw                      (0) | Train Loss: 1.1011 | Train Acc: 0.5058
 Site-expw                      (0) | Train Loss: 1.2609 | Train Acc: 0.4935
 Site-expw                      (0) | Train Loss: 1.1104 | Train Acc: 0.5655
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6744 | Train Acc: 0.3548
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4894 | Train Acc: 0.4349
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4405 | Train Acc: 0.4807
 Site-jpWoman                   (2) | Train Loss: 1.7192 | Train Acc: 0.3200
 Site-jpWoman                   (2) | Train Loss: 1.8534 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 1.5940 | Train Acc: 0.4156
Average Train Accuracy: 0.4216
 Site-expw                      (0) | Val  Loss: 1.2156 | Val  Acc: 0.5584
 Site-expw                      (0) | Val  Loss: 1.1059 | Val  Acc: 0.5826
 Site-expw                      (0) | Val  Loss: 1.1668 | Val  Acc: 0.5407
 Site-expw                      (0) | Val  Loss: 1.1469 | Val  Acc: 0.4767
 Site-expw                      (0) | Val  Loss: 1.2016 | Val  Acc: 0.4689
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4959 | Val  Acc: 0.4369
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4619 | Val  Acc: 0.4749
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4577 | Val  Acc: 0.4677
 Site-jpWoman                   (2) | Val  Loss: 1.7109 | Val  Acc: 0.3125
 Site-jpWoman                   (2) | Val  Loss: 1.9196 | Val  Acc: 0.2727
 Site-FER                       (3) | Val  Loss: 1.6071 | Val  Acc: 0.4195
Average Valid Accuracy: 0.4556
 Test site-expw                      (0)| Epoch:45 | Test Acc: 0.3916
 Test site-youngAffectNetHQ          (1)| Epoch:45 | Test Acc: 0.3064
 Test site-jpWoman                   (2)| Epoch:45 | Test Acc: 0.2414
 Test site-FER                       (3)| Epoch:45 | Test Acc: 0.3074
expw: 0.3916, youngAffectNetHQ: 0.3064, jpWoman: 0.2414, FER: 0.3074, 
Average Test Accuracy(group): 0.3117, Average Test Accuracy(individual): 0.3334,
domain std=0.0533, cluster std=0.0533, individual std=0.0578, 
Average Test Accuracy: 0.3117
============ Train epoch 49 ============
cnt=[2, 4, 2, 3, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-expw                      (3) | Train Loss: 1.2404 | Train Acc: 0.4741
 Site-expw                      (0) | Train Loss: 1.3516 | Train Acc: 0.3988
 Site-expw                      (3) | Train Loss: 1.1812 | Train Acc: 0.5058
 Site-expw                      (3) | Train Loss: 1.2482 | Train Acc: 0.4961
 Site-expw                      (0) | Train Loss: 1.1415 | Train Acc: 0.5500
 Site-youngAffectNetHQ          (1) | Train Loss: 1.6495 | Train Acc: 0.3419
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4718 | Train Acc: 0.4238
 Site-youngAffectNetHQ          (1) | Train Loss: 1.4376 | Train Acc: 0.5021
 Site-jpWoman                   (2) | Train Loss: 1.6517 | Train Acc: 0.3200
 Site-jpWoman                   (2) | Train Loss: 1.8409 | Train Acc: 0.3000
 Site-FER                       (1) | Train Loss: 1.5804 | Train Acc: 0.4481
Average Train Accuracy: 0.4328
 Site-expw                      (3) | Val  Loss: 1.2141 | Val  Acc: 0.5714
 Site-expw                      (0) | Val  Loss: 1.1290 | Val  Acc: 0.5217
 Site-expw                      (3) | Val  Loss: 1.1253 | Val  Acc: 0.5698
 Site-expw                      (3) | Val  Loss: 1.2152 | Val  Acc: 0.4961
 Site-expw                      (0) | Val  Loss: 1.2468 | Val  Acc: 0.4741
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4594 | Val  Acc: 0.4951
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4312 | Val  Acc: 0.5251
 Site-youngAffectNetHQ          (1) | Val  Loss: 1.4405 | Val  Acc: 0.4806
 Site-jpWoman                   (2) | Val  Loss: 1.8934 | Val  Acc: 0.1875
 Site-jpWoman                   (2) | Val  Loss: 1.7985 | Val  Acc: 0.3030
 Site-FER                       (1) | Val  Loss: 1.5985 | Val  Acc: 0.4049
Average Valid Accuracy: 0.4572
 Test site-expw                      (3)| Epoch:45 | Test Acc: 0.3826
 Test site-youngAffectNetHQ          (1)| Epoch:45 | Test Acc: 0.3093
 Test site-jpWoman                   (2)| Epoch:45 | Test Acc: 0.2644
 Test site-FER                       (1)| Epoch:45 | Test Acc: 0.3059
expw: 0.3826, youngAffectNetHQ: 0.3093, jpWoman: 0.2644, FER: 0.3059, 
Average Test Accuracy(group): 0.3155, Average Test Accuracy(individual): 0.3341,
domain std=0.0426, cluster std=0.0506, individual std=0.0468, 
Average Test Accuracy: 0.3155
===2023-08-08 23:19:15===
===2023-08-08 23:19:31===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[116,173,259,387,580,155,269,466,25,50,308,
client_nums=[5,3,2,1,]
len_dataset=[2529,1487,126,514,]
domain number = 4
Loading snapshots...
 Test site-expw                      (1)| Epoch:44 | Test Acc: 0.3916
 Test site-youngAffectNetHQ          (2)| Epoch:44 | Test Acc: 0.3136
 Test site-jpWoman                   (0)| Epoch:44 | Test Acc: 0.2874
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.3089
expw: 0.3916, youngAffectNetHQ: 0.3136, jpWoman: 0.2874, FER: 0.3089, 
Average Test Accuracy(group): 0.3254, Average Test Accuracy(individual): 0.3439,
domain std=0.0395, cluster std=0.0467, individual std=0.0445, 
===2023-08-09 02:55:39===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 0
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[57,86,129,193,289,42,74,128,12,24,154,
client_nums=[5,3,2,1,]
len_dataset=[2529,821,126,514,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
===2023-08-09 02:55:43===
===2023-08-09 04:16:55===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[57,86,129,193,289,42,74,128,12,24,154,
client_nums=[5,3,2,1,]
len_dataset=[2529,821,126,514,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-expw                      (1) | Train Loss: 1.5073 | Train Acc: 0.4035
 Site-expw                      (1) | Train Loss: 1.7028 | Train Acc: 0.1977
 Site-expw                      (1) | Train Loss: 1.4763 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.6204 | Train Acc: 0.2539
 Site-expw                      (1) | Train Loss: 1.6390 | Train Acc: 0.2803
 Site-FERG_DB_256               (0) | Train Loss: 2.2222 | Train Acc: 0.1429
 Site-FERG_DB_256               (0) | Train Loss: 2.0010 | Train Acc: 0.1757
 Site-FERG_DB_256               (0) | Train Loss: 2.2950 | Train Acc: 0.1016
 Site-jpWoman                   (2) | Train Loss: 2.2383 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.2452 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 2.0945 | Train Acc: 0.1169
Average Train Accuracy: 0.2051
 Site-expw                      (1) | Val  Loss: 1.6425 | Val  Acc: 0.2895
 Site-expw                      (1) | Val  Loss: 1.6346 | Val  Acc: 0.3158
 Site-expw                      (1) | Val  Loss: 1.5738 | Val  Acc: 0.2907
 Site-expw                      (1) | Val  Loss: 1.7449 | Val  Acc: 0.2713
 Site-expw                      (1) | Val  Loss: 1.4807 | Val  Acc: 0.2694
 Site-FERG_DB_256               (0) | Val  Loss: 2.2927 | Val  Acc: 0.0714
 Site-FERG_DB_256               (0) | Val  Loss: 2.4221 | Val  Acc: 0.0408
 Site-FERG_DB_256               (0) | Val  Loss: 2.3175 | Val  Acc: 0.1294
 Site-jpWoman                   (2) | Val  Loss: 2.3805 | Val  Acc: 0.0000
 Site-jpWoman                   (2) | Val  Loss: 2.2722 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 2.1534 | Val  Acc: 0.1471
Average Valid Accuracy: 0.1830
 Best site-expw                     (1)  | Epoch:0 | Val Acc: 0.2895
 Best site-expw                     (1)  | Epoch:0 | Val Acc: 0.3158
 Best site-expw                     (1)  | Epoch:0 | Val Acc: 0.2907
 Best site-expw                     (1)  | Epoch:0 | Val Acc: 0.2713
 Best site-expw                     (1)  | Epoch:0 | Val Acc: 0.2694
 Best site-FERG_DB_256              (0)  | Epoch:0 | Val Acc: 0.0714
 Best site-FERG_DB_256              (0)  | Epoch:0 | Val Acc: 0.0408
 Best site-FERG_DB_256              (0)  | Epoch:0 | Val Acc: 0.1294
 Best site-jpWoman                  (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-jpWoman                  (2)  | Epoch:0 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:0 | Val Acc: 0.1471
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 3, 2, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-expw                      (0) | Train Loss: 1.5686 | Train Acc: 0.2807
 Site-expw                      (3) | Train Loss: 1.6379 | Train Acc: 0.2907
 Site-expw                      (3) | Train Loss: 1.6206 | Train Acc: 0.3488
 Site-expw                      (3) | Train Loss: 1.5843 | Train Acc: 0.3005
 Site-expw                      (3) | Train Loss: 1.6498 | Train Acc: 0.2595
 Site-FERG_DB_256               (1) | Train Loss: 2.1212 | Train Acc: 0.0952
 Site-FERG_DB_256               (1) | Train Loss: 2.1067 | Train Acc: 0.1351
 Site-FERG_DB_256               (1) | Train Loss: 2.1862 | Train Acc: 0.1328
 Site-jpWoman                   (2) | Train Loss: 2.1257 | Train Acc: 0.3333
 Site-jpWoman                   (2) | Train Loss: 2.2408 | Train Acc: 0.0417
 Site-FER                       (3) | Train Loss: 2.0479 | Train Acc: 0.1688
Average Train Accuracy: 0.2170
 Site-expw                      (0) | Val  Loss: 1.6759 | Val  Acc: 0.2368
 Site-expw                      (3) | Val  Loss: 1.6400 | Val  Acc: 0.2281
 Site-expw                      (3) | Val  Loss: 1.6042 | Val  Acc: 0.3023
 Site-expw                      (3) | Val  Loss: 1.6125 | Val  Acc: 0.3411
 Site-expw                      (3) | Val  Loss: 1.6475 | Val  Acc: 0.3109
 Site-FERG_DB_256               (1) | Val  Loss: 2.1592 | Val  Acc: 0.1429
 Site-FERG_DB_256               (1) | Val  Loss: 2.2104 | Val  Acc: 0.1020
 Site-FERG_DB_256               (1) | Val  Loss: 2.2158 | Val  Acc: 0.1176
 Site-jpWoman                   (2) | Val  Loss: 2.3054 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 2.2537 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 2.0915 | Val  Acc: 0.1765
Average Valid Accuracy: 0.2007
 Best site-expw                     (0)  | Epoch:1 | Val Acc: 0.2368
 Best site-expw                     (3)  | Epoch:1 | Val Acc: 0.2281
 Best site-expw                     (3)  | Epoch:1 | Val Acc: 0.3023
 Best site-expw                     (3)  | Epoch:1 | Val Acc: 0.3411
 Best site-expw                     (3)  | Epoch:1 | Val Acc: 0.3109
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1429
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1020
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1176
 Best site-jpWoman                  (2)  | Epoch:1 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:1 | Val Acc: 0.1250
 Best site-FER                      (3)  | Epoch:1 | Val Acc: 0.1765
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-expw                      (3) | Train Loss: 1.5862 | Train Acc: 0.3509
 Site-expw                      (0) | Train Loss: 1.6518 | Train Acc: 0.2907
 Site-expw                      (0) | Train Loss: 1.5368 | Train Acc: 0.3178
 Site-expw                      (0) | Train Loss: 1.7429 | Train Acc: 0.3161
 Site-expw                      (0) | Train Loss: 1.6173 | Train Acc: 0.2872
 Site-FERG_DB_256               (2) | Train Loss: 2.0706 | Train Acc: 0.1667
 Site-FERG_DB_256               (2) | Train Loss: 1.9349 | Train Acc: 0.1216
 Site-FERG_DB_256               (2) | Train Loss: 2.1013 | Train Acc: 0.1172
 Site-jpWoman                   (1) | Train Loss: 2.1166 | Train Acc: 0.4167
 Site-jpWoman                   (1) | Train Loss: 2.1485 | Train Acc: 0.1667
 Site-FER                       (0) | Train Loss: 2.0482 | Train Acc: 0.1623
Average Train Accuracy: 0.2467
 Site-expw                      (3) | Val  Loss: 1.6799 | Val  Acc: 0.2368
 Site-expw                      (0) | Val  Loss: 1.6270 | Val  Acc: 0.2456
 Site-expw                      (0) | Val  Loss: 1.5857 | Val  Acc: 0.2558
 Site-expw                      (0) | Val  Loss: 1.6919 | Val  Acc: 0.3643
 Site-expw                      (0) | Val  Loss: 1.5952 | Val  Acc: 0.3109
 Site-FERG_DB_256               (2) | Val  Loss: 2.0601 | Val  Acc: 0.2143
 Site-FERG_DB_256               (2) | Val  Loss: 2.1269 | Val  Acc: 0.1020
 Site-FERG_DB_256               (2) | Val  Loss: 2.1273 | Val  Acc: 0.1412
 Site-jpWoman                   (1) | Val  Loss: 2.1725 | Val  Acc: 0.1250
 Site-jpWoman                   (1) | Val  Loss: 2.2485 | Val  Acc: 0.2500
 Site-FER                       (0) | Val  Loss: 2.0629 | Val  Acc: 0.1765
Average Valid Accuracy: 0.2202
 Best site-expw                     (3)  | Epoch:2 | Val Acc: 0.2368
 Best site-expw                     (0)  | Epoch:2 | Val Acc: 0.2456
 Best site-expw                     (0)  | Epoch:2 | Val Acc: 0.2558
 Best site-expw                     (0)  | Epoch:2 | Val Acc: 0.3643
 Best site-expw                     (0)  | Epoch:2 | Val Acc: 0.3109
 Best site-FERG_DB_256              (2)  | Epoch:2 | Val Acc: 0.2143
 Best site-FERG_DB_256              (2)  | Epoch:2 | Val Acc: 0.1020
 Best site-FERG_DB_256              (2)  | Epoch:2 | Val Acc: 0.1412
 Best site-jpWoman                  (1)  | Epoch:2 | Val Acc: 0.1250
 Best site-jpWoman                  (1)  | Epoch:2 | Val Acc: 0.2500
 Best site-FER                      (0)  | Epoch:2 | Val Acc: 0.1765
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 3 ============
cnt=[1, 3, 5, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-expw                      (0) | Train Loss: 1.5361 | Train Acc: 0.2632
 Site-expw                      (2) | Train Loss: 1.6312 | Train Acc: 0.2907
 Site-expw                      (2) | Train Loss: 1.6265 | Train Acc: 0.3023
 Site-expw                      (2) | Train Loss: 1.6105 | Train Acc: 0.3523
 Site-expw                      (2) | Train Loss: 1.5912 | Train Acc: 0.2872
 Site-FERG_DB_256               (1) | Train Loss: 2.0385 | Train Acc: 0.2381
 Site-FERG_DB_256               (1) | Train Loss: 1.8389 | Train Acc: 0.2568
 Site-FERG_DB_256               (1) | Train Loss: 2.0665 | Train Acc: 0.1328
 Site-jpWoman                   (3) | Train Loss: 2.0697 | Train Acc: 0.3333
 Site-jpWoman                   (3) | Train Loss: 2.1555 | Train Acc: 0.2083
 Site-FER                       (2) | Train Loss: 2.0262 | Train Acc: 0.1429
Average Train Accuracy: 0.2553
 Site-expw                      (0) | Val  Loss: 1.6423 | Val  Acc: 0.3158
 Site-expw                      (2) | Val  Loss: 1.6029 | Val  Acc: 0.2456
 Site-expw                      (2) | Val  Loss: 1.5629 | Val  Acc: 0.3140
 Site-expw                      (2) | Val  Loss: 1.5980 | Val  Acc: 0.3488
 Site-expw                      (2) | Val  Loss: 1.5908 | Val  Acc: 0.3057
 Site-FERG_DB_256               (1) | Val  Loss: 2.0664 | Val  Acc: 0.1071
 Site-FERG_DB_256               (1) | Val  Loss: 2.1201 | Val  Acc: 0.1020
 Site-FERG_DB_256               (1) | Val  Loss: 2.0996 | Val  Acc: 0.2000
 Site-jpWoman                   (3) | Val  Loss: 2.3020 | Val  Acc: 0.0000
 Site-jpWoman                   (3) | Val  Loss: 2.2650 | Val  Acc: 0.1250
 Site-FER                       (2) | Val  Loss: 2.0584 | Val  Acc: 0.1765
Average Valid Accuracy: 0.2037
============ Train epoch 4 ============
cnt=[2, 1, 4, 4, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-expw                      (1) | Train Loss: 1.5046 | Train Acc: 0.2807
 Site-expw                      (3) | Train Loss: 1.6091 | Train Acc: 0.2674
 Site-expw                      (3) | Train Loss: 1.6182 | Train Acc: 0.3488
 Site-expw                      (3) | Train Loss: 1.5244 | Train Acc: 0.2850
 Site-expw                      (3) | Train Loss: 1.5654 | Train Acc: 0.2837
 Site-FERG_DB_256               (2) | Train Loss: 2.0036 | Train Acc: 0.1905
 Site-FERG_DB_256               (2) | Train Loss: 1.8767 | Train Acc: 0.1892
 Site-FERG_DB_256               (2) | Train Loss: 2.0555 | Train Acc: 0.1562
 Site-jpWoman                   (0) | Train Loss: 2.0985 | Train Acc: 0.2500
 Site-jpWoman                   (0) | Train Loss: 2.0880 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.9884 | Train Acc: 0.2013
Average Train Accuracy: 0.2381
 Site-expw                      (1) | Val  Loss: 1.6309 | Val  Acc: 0.2632
 Site-expw                      (3) | Val  Loss: 1.5341 | Val  Acc: 0.2632
 Site-expw                      (3) | Val  Loss: 1.5162 | Val  Acc: 0.3372
 Site-expw                      (3) | Val  Loss: 1.5908 | Val  Acc: 0.3566
 Site-expw                      (3) | Val  Loss: 1.5509 | Val  Acc: 0.2902
 Site-FERG_DB_256               (2) | Val  Loss: 2.0278 | Val  Acc: 0.1786
 Site-FERG_DB_256               (2) | Val  Loss: 2.0758 | Val  Acc: 0.1224
 Site-FERG_DB_256               (2) | Val  Loss: 2.0670 | Val  Acc: 0.1765
 Site-jpWoman                   (0) | Val  Loss: 2.0973 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 2.1606 | Val  Acc: 0.1875
 Site-FER                       (2) | Val  Loss: 2.0381 | Val  Acc: 0.1667
Average Valid Accuracy: 0.2356
 Best site-expw                     (1)  | Epoch:4 | Val Acc: 0.2632
 Best site-expw                     (3)  | Epoch:4 | Val Acc: 0.2632
 Best site-expw                     (3)  | Epoch:4 | Val Acc: 0.3372
 Best site-expw                     (3)  | Epoch:4 | Val Acc: 0.3566
 Best site-expw                     (3)  | Epoch:4 | Val Acc: 0.2902
 Best site-FERG_DB_256              (2)  | Epoch:4 | Val Acc: 0.1786
 Best site-FERG_DB_256              (2)  | Epoch:4 | Val Acc: 0.1224
 Best site-FERG_DB_256              (2)  | Epoch:4 | Val Acc: 0.1765
 Best site-jpWoman                  (0)  | Epoch:4 | Val Acc: 0.2500
 Best site-jpWoman                  (0)  | Epoch:4 | Val Acc: 0.1875
 Best site-FER                      (2)  | Epoch:4 | Val Acc: 0.1667
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 3, 4, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-expw                      (0) | Train Loss: 1.4854 | Train Acc: 0.2982
 Site-expw                      (2) | Train Loss: 1.5906 | Train Acc: 0.2791
 Site-expw                      (2) | Train Loss: 1.6189 | Train Acc: 0.3333
 Site-expw                      (2) | Train Loss: 1.4622 | Train Acc: 0.2953
 Site-expw                      (2) | Train Loss: 1.5448 | Train Acc: 0.3010
 Site-FERG_DB_256               (3) | Train Loss: 2.0111 | Train Acc: 0.2143
 Site-FERG_DB_256               (3) | Train Loss: 1.8037 | Train Acc: 0.2432
 Site-FERG_DB_256               (3) | Train Loss: 2.0222 | Train Acc: 0.2031
 Site-jpWoman                   (1) | Train Loss: 2.0773 | Train Acc: 0.1667
 Site-jpWoman                   (1) | Train Loss: 2.1151 | Train Acc: 0.0833
 Site-FER                       (1) | Train Loss: 1.9789 | Train Acc: 0.1948
Average Train Accuracy: 0.2375
 Site-expw                      (0) | Val  Loss: 1.5620 | Val  Acc: 0.2895
 Site-expw                      (2) | Val  Loss: 1.5342 | Val  Acc: 0.3158
 Site-expw                      (2) | Val  Loss: 1.4629 | Val  Acc: 0.3837
 Site-expw                      (2) | Val  Loss: 1.5347 | Val  Acc: 0.3333
 Site-expw                      (2) | Val  Loss: 1.4987 | Val  Acc: 0.3472
 Site-FERG_DB_256               (3) | Val  Loss: 2.0202 | Val  Acc: 0.1429
 Site-FERG_DB_256               (3) | Val  Loss: 2.0810 | Val  Acc: 0.1020
 Site-FERG_DB_256               (3) | Val  Loss: 2.0388 | Val  Acc: 0.1765
 Site-jpWoman                   (1) | Val  Loss: 2.2377 | Val  Acc: 0.1250
 Site-jpWoman                   (1) | Val  Loss: 2.1170 | Val  Acc: 0.1875
 Site-FER                       (1) | Val  Loss: 2.0444 | Val  Acc: 0.1863
Average Valid Accuracy: 0.2354
============ Train epoch 6 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-expw                      (0) | Train Loss: 1.4854 | Train Acc: 0.3860
 Site-expw                      (0) | Train Loss: 1.5588 | Train Acc: 0.2907
 Site-expw                      (0) | Train Loss: 1.5153 | Train Acc: 0.3333
 Site-expw                      (0) | Train Loss: 1.5351 | Train Acc: 0.3472
 Site-expw                      (0) | Train Loss: 1.5276 | Train Acc: 0.3149
 Site-FERG_DB_256               (1) | Train Loss: 1.9768 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.7858 | Train Acc: 0.2432
 Site-FERG_DB_256               (1) | Train Loss: 1.9795 | Train Acc: 0.2188
 Site-jpWoman                   (2) | Train Loss: 2.1290 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 2.1080 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.9742 | Train Acc: 0.2143
Average Train Accuracy: 0.2627
 Site-expw                      (0) | Val  Loss: 1.5728 | Val  Acc: 0.3158
 Site-expw                      (0) | Val  Loss: 1.5035 | Val  Acc: 0.3509
 Site-expw                      (0) | Val  Loss: 1.4687 | Val  Acc: 0.3140
 Site-expw                      (0) | Val  Loss: 1.5899 | Val  Acc: 0.3643
 Site-expw                      (0) | Val  Loss: 1.4910 | Val  Acc: 0.3627
 Site-FERG_DB_256               (1) | Val  Loss: 1.9823 | Val  Acc: 0.1786
 Site-FERG_DB_256               (1) | Val  Loss: 2.0059 | Val  Acc: 0.1633
 Site-FERG_DB_256               (1) | Val  Loss: 1.9846 | Val  Acc: 0.2588
 Site-jpWoman                   (2) | Val  Loss: 2.2285 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 2.1683 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 2.0276 | Val  Acc: 0.1961
Average Valid Accuracy: 0.2561
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.3158
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.3509
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.3140
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.3643
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.3627
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.1786
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.1633
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.2588
 Best site-jpWoman                  (2)  | Epoch:6 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:6 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:6 | Val Acc: 0.1961
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-expw                      (1) | Train Loss: 1.5017 | Train Acc: 0.3158
 Site-expw                      (1) | Train Loss: 1.5319 | Train Acc: 0.3372
 Site-expw                      (1) | Train Loss: 1.5339 | Train Acc: 0.3411
 Site-expw                      (1) | Train Loss: 1.4733 | Train Acc: 0.3368
 Site-expw                      (1) | Train Loss: 1.4842 | Train Acc: 0.3391
 Site-FERG_DB_256               (0) | Train Loss: 1.9696 | Train Acc: 0.1905
 Site-FERG_DB_256               (0) | Train Loss: 1.8461 | Train Acc: 0.2568
 Site-FERG_DB_256               (0) | Train Loss: 1.9500 | Train Acc: 0.2188
 Site-jpWoman                   (2) | Train Loss: 2.1039 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 2.1071 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.9749 | Train Acc: 0.2338
Average Train Accuracy: 0.2715
 Site-expw                      (1) | Val  Loss: 1.4951 | Val  Acc: 0.3158
 Site-expw                      (1) | Val  Loss: 1.4752 | Val  Acc: 0.3509
 Site-expw                      (1) | Val  Loss: 1.4504 | Val  Acc: 0.3372
 Site-expw                      (1) | Val  Loss: 1.4461 | Val  Acc: 0.4031
 Site-expw                      (1) | Val  Loss: 1.4861 | Val  Acc: 0.3679
 Site-FERG_DB_256               (0) | Val  Loss: 1.9376 | Val  Acc: 0.1429
 Site-FERG_DB_256               (0) | Val  Loss: 1.9444 | Val  Acc: 0.2245
 Site-FERG_DB_256               (0) | Val  Loss: 1.9805 | Val  Acc: 0.2353
 Site-jpWoman                   (2) | Val  Loss: 2.2264 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.1441 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 2.0170 | Val  Acc: 0.1961
Average Valid Accuracy: 0.2737
 Best site-expw                     (1)  | Epoch:7 | Val Acc: 0.3158
 Best site-expw                     (1)  | Epoch:7 | Val Acc: 0.3509
 Best site-expw                     (1)  | Epoch:7 | Val Acc: 0.3372
 Best site-expw                     (1)  | Epoch:7 | Val Acc: 0.4031
 Best site-expw                     (1)  | Epoch:7 | Val Acc: 0.3679
 Best site-FERG_DB_256              (0)  | Epoch:7 | Val Acc: 0.1429
 Best site-FERG_DB_256              (0)  | Epoch:7 | Val Acc: 0.2245
 Best site-FERG_DB_256              (0)  | Epoch:7 | Val Acc: 0.2353
 Best site-jpWoman                  (2)  | Epoch:7 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:7 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:7 | Val Acc: 0.1961
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-expw                      (1) | Train Loss: 1.4621 | Train Acc: 0.4035
 Site-expw                      (1) | Train Loss: 1.5146 | Train Acc: 0.3605
 Site-expw                      (1) | Train Loss: 1.4267 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.4204 | Train Acc: 0.3938
 Site-expw                      (1) | Train Loss: 1.4614 | Train Acc: 0.3668
 Site-FERG_DB_256               (0) | Train Loss: 1.9347 | Train Acc: 0.1905
 Site-FERG_DB_256               (0) | Train Loss: 1.7595 | Train Acc: 0.2568
 Site-FERG_DB_256               (0) | Train Loss: 1.8984 | Train Acc: 0.2188
 Site-jpWoman                   (2) | Train Loss: 2.1571 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.0628 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.8910 | Train Acc: 0.2662
Average Train Accuracy: 0.2764
 Site-expw                      (1) | Val  Loss: 1.4946 | Val  Acc: 0.3421
 Site-expw                      (1) | Val  Loss: 1.4849 | Val  Acc: 0.2807
 Site-expw                      (1) | Val  Loss: 1.3769 | Val  Acc: 0.3837
 Site-expw                      (1) | Val  Loss: 1.5106 | Val  Acc: 0.4031
 Site-expw                      (1) | Val  Loss: 1.4546 | Val  Acc: 0.3575
 Site-FERG_DB_256               (0) | Val  Loss: 1.9147 | Val  Acc: 0.2143
 Site-FERG_DB_256               (0) | Val  Loss: 1.8881 | Val  Acc: 0.1633
 Site-FERG_DB_256               (0) | Val  Loss: 1.9076 | Val  Acc: 0.2353
 Site-jpWoman                   (2) | Val  Loss: 2.0226 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.1348 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.9615 | Val  Acc: 0.2549
Average Valid Accuracy: 0.2736
============ Train epoch 9 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-expw                      (0) | Train Loss: 1.4687 | Train Acc: 0.3333
 Site-expw                      (0) | Train Loss: 1.5293 | Train Acc: 0.3488
 Site-expw                      (0) | Train Loss: 1.8458 | Train Acc: 0.3178
 Site-expw                      (0) | Train Loss: 1.5170 | Train Acc: 0.3834
 Site-expw                      (0) | Train Loss: 1.4468 | Train Acc: 0.3875
 Site-FERG_DB_256               (1) | Train Loss: 1.9004 | Train Acc: 0.1905
 Site-FERG_DB_256               (1) | Train Loss: 1.8725 | Train Acc: 0.2973
 Site-FERG_DB_256               (1) | Train Loss: 1.8657 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 2.1268 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.0351 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.8880 | Train Acc: 0.2662
Average Train Accuracy: 0.2788
 Site-expw                      (0) | Val  Loss: 1.4650 | Val  Acc: 0.3947
 Site-expw                      (0) | Val  Loss: 1.4415 | Val  Acc: 0.4035
 Site-expw                      (0) | Val  Loss: 1.4005 | Val  Acc: 0.3837
 Site-expw                      (0) | Val  Loss: 1.5262 | Val  Acc: 0.4186
 Site-expw                      (0) | Val  Loss: 1.5166 | Val  Acc: 0.3368
 Site-FERG_DB_256               (1) | Val  Loss: 1.8348 | Val  Acc: 0.2143
 Site-FERG_DB_256               (1) | Val  Loss: 1.8679 | Val  Acc: 0.1837
 Site-FERG_DB_256               (1) | Val  Loss: 1.8646 | Val  Acc: 0.1882
 Site-jpWoman                   (2) | Val  Loss: 1.9193 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0610 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.9800 | Val  Acc: 0.2451
Average Valid Accuracy: 0.2915
 Best site-expw                     (0)  | Epoch:9 | Val Acc: 0.3947
 Best site-expw                     (0)  | Epoch:9 | Val Acc: 0.4035
 Best site-expw                     (0)  | Epoch:9 | Val Acc: 0.3837
 Best site-expw                     (0)  | Epoch:9 | Val Acc: 0.4186
 Best site-expw                     (0)  | Epoch:9 | Val Acc: 0.3368
 Best site-FERG_DB_256              (1)  | Epoch:9 | Val Acc: 0.2143
 Best site-FERG_DB_256              (1)  | Epoch:9 | Val Acc: 0.1837
 Best site-FERG_DB_256              (1)  | Epoch:9 | Val Acc: 0.1882
 Best site-jpWoman                  (2)  | Epoch:9 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:9 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:9 | Val Acc: 0.2451
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 10 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-expw                      (0) | Train Loss: 1.3678 | Train Acc: 0.4211
 Site-expw                      (0) | Train Loss: 1.5495 | Train Acc: 0.3140
 Site-expw                      (0) | Train Loss: 1.4740 | Train Acc: 0.3411
 Site-expw                      (0) | Train Loss: 1.4254 | Train Acc: 0.4093
 Site-expw                      (0) | Train Loss: 1.4121 | Train Acc: 0.4152
 Site-FERG_DB_256               (1) | Train Loss: 1.8713 | Train Acc: 0.1905
 Site-FERG_DB_256               (1) | Train Loss: 1.7918 | Train Acc: 0.2703
 Site-FERG_DB_256               (1) | Train Loss: 1.8533 | Train Acc: 0.2422
 Site-jpWoman                   (2) | Train Loss: 2.1282 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 2.1096 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.8643 | Train Acc: 0.2792
Average Train Accuracy: 0.2924
 Site-expw                      (0) | Val  Loss: 1.4895 | Val  Acc: 0.2368
 Site-expw                      (0) | Val  Loss: 1.4097 | Val  Acc: 0.3684
 Site-expw                      (0) | Val  Loss: 1.3523 | Val  Acc: 0.3953
 Site-expw                      (0) | Val  Loss: 1.3843 | Val  Acc: 0.4109
 Site-expw                      (0) | Val  Loss: 1.4537 | Val  Acc: 0.3575
 Site-FERG_DB_256               (1) | Val  Loss: 1.8237 | Val  Acc: 0.2857
 Site-FERG_DB_256               (1) | Val  Loss: 1.8257 | Val  Acc: 0.2245
 Site-FERG_DB_256               (1) | Val  Loss: 1.8592 | Val  Acc: 0.2706
 Site-jpWoman                   (2) | Val  Loss: 2.1648 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.1130 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.9625 | Val  Acc: 0.2353
Average Valid Accuracy: 0.2873
============ Train epoch 11 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-expw                      (0) | Train Loss: 1.3966 | Train Acc: 0.3333
 Site-expw                      (0) | Train Loss: 1.4458 | Train Acc: 0.3372
 Site-expw                      (0) | Train Loss: 1.5571 | Train Acc: 0.3566
 Site-expw                      (0) | Train Loss: 1.2934 | Train Acc: 0.4249
 Site-expw                      (0) | Train Loss: 1.4023 | Train Acc: 0.4187
 Site-FERG_DB_256               (1) | Train Loss: 1.8283 | Train Acc: 0.2143
 Site-FERG_DB_256               (1) | Train Loss: 1.8248 | Train Acc: 0.3108
 Site-FERG_DB_256               (1) | Train Loss: 1.8285 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 2.1692 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 2.0298 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.8567 | Train Acc: 0.2727
Average Train Accuracy: 0.2956
 Site-expw                      (0) | Val  Loss: 1.4088 | Val  Acc: 0.3421
 Site-expw                      (0) | Val  Loss: 1.4149 | Val  Acc: 0.3158
 Site-expw                      (0) | Val  Loss: 1.3199 | Val  Acc: 0.4070
 Site-expw                      (0) | Val  Loss: 1.3517 | Val  Acc: 0.4109
 Site-expw                      (0) | Val  Loss: 1.4017 | Val  Acc: 0.3834
 Site-FERG_DB_256               (1) | Val  Loss: 1.7523 | Val  Acc: 0.3571
 Site-FERG_DB_256               (1) | Val  Loss: 1.7699 | Val  Acc: 0.3469
 Site-FERG_DB_256               (1) | Val  Loss: 1.8073 | Val  Acc: 0.2706
 Site-jpWoman                   (2) | Val  Loss: 1.9896 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.1577 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.9835 | Val  Acc: 0.2255
Average Valid Accuracy: 0.3179
 Best site-expw                     (0)  | Epoch:11 | Val Acc: 0.3421
 Best site-expw                     (0)  | Epoch:11 | Val Acc: 0.3158
 Best site-expw                     (0)  | Epoch:11 | Val Acc: 0.4070
 Best site-expw                     (0)  | Epoch:11 | Val Acc: 0.4109
 Best site-expw                     (0)  | Epoch:11 | Val Acc: 0.3834
 Best site-FERG_DB_256              (1)  | Epoch:11 | Val Acc: 0.3571
 Best site-FERG_DB_256              (1)  | Epoch:11 | Val Acc: 0.3469
 Best site-FERG_DB_256              (1)  | Epoch:11 | Val Acc: 0.2706
 Best site-jpWoman                  (2)  | Epoch:11 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:11 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:11 | Val Acc: 0.2255
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-expw                      (1) | Train Loss: 1.3866 | Train Acc: 0.3158
 Site-expw                      (1) | Train Loss: 1.4249 | Train Acc: 0.3140
 Site-expw                      (1) | Train Loss: 1.6780 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.2669 | Train Acc: 0.4249
 Site-expw                      (1) | Train Loss: 1.3659 | Train Acc: 0.4498
 Site-FERG_DB_256               (0) | Train Loss: 1.8164 | Train Acc: 0.2143
 Site-FERG_DB_256               (0) | Train Loss: 1.7548 | Train Acc: 0.2973
 Site-FERG_DB_256               (0) | Train Loss: 1.7783 | Train Acc: 0.3359
 Site-jpWoman                   (2) | Train Loss: 2.0720 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.0153 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.8427 | Train Acc: 0.2662
Average Train Accuracy: 0.2910
 Site-expw                      (1) | Val  Loss: 1.4004 | Val  Acc: 0.3421
 Site-expw                      (1) | Val  Loss: 1.3481 | Val  Acc: 0.3684
 Site-expw                      (1) | Val  Loss: 1.2985 | Val  Acc: 0.4419
 Site-expw                      (1) | Val  Loss: 1.4476 | Val  Acc: 0.5039
 Site-expw                      (1) | Val  Loss: 1.4321 | Val  Acc: 0.3627
 Site-FERG_DB_256               (0) | Val  Loss: 1.7700 | Val  Acc: 0.3571
 Site-FERG_DB_256               (0) | Val  Loss: 1.7296 | Val  Acc: 0.3673
 Site-FERG_DB_256               (0) | Val  Loss: 1.7613 | Val  Acc: 0.2588
 Site-jpWoman                   (2) | Val  Loss: 1.9000 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9964 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.9480 | Val  Acc: 0.2059
Average Valid Accuracy: 0.3257
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.3421
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.3684
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.4419
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.5039
 Best site-expw                     (1)  | Epoch:12 | Val Acc: 0.3627
 Best site-FERG_DB_256              (0)  | Epoch:12 | Val Acc: 0.3571
 Best site-FERG_DB_256              (0)  | Epoch:12 | Val Acc: 0.3673
 Best site-FERG_DB_256              (0)  | Epoch:12 | Val Acc: 0.2588
 Best site-jpWoman                  (2)  | Epoch:12 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:12 | Val Acc: 0.1250
 Best site-FER                      (3)  | Epoch:12 | Val Acc: 0.2059
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-expw                      (1) | Train Loss: 1.3660 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.4408 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.3589 | Train Acc: 0.3023
 Site-expw                      (1) | Train Loss: 1.3295 | Train Acc: 0.4145
 Site-expw                      (1) | Train Loss: 1.3761 | Train Acc: 0.4048
 Site-FERG_DB_256               (2) | Train Loss: 1.8197 | Train Acc: 0.1905
 Site-FERG_DB_256               (2) | Train Loss: 1.7652 | Train Acc: 0.2297
 Site-FERG_DB_256               (2) | Train Loss: 1.7370 | Train Acc: 0.3594
 Site-jpWoman                   (3) | Train Loss: 2.0681 | Train Acc: 0.1667
 Site-jpWoman                   (3) | Train Loss: 1.9937 | Train Acc: 0.1667
 Site-FER                       (0) | Train Loss: 1.8097 | Train Acc: 0.2857
Average Train Accuracy: 0.2911
 Site-expw                      (1) | Val  Loss: 1.3919 | Val  Acc: 0.4474
 Site-expw                      (1) | Val  Loss: 1.3789 | Val  Acc: 0.4211
 Site-expw                      (1) | Val  Loss: 1.2867 | Val  Acc: 0.3721
 Site-expw                      (1) | Val  Loss: 1.4266 | Val  Acc: 0.4264
 Site-expw                      (1) | Val  Loss: 1.4310 | Val  Acc: 0.3731
 Site-FERG_DB_256               (2) | Val  Loss: 1.7262 | Val  Acc: 0.3571
 Site-FERG_DB_256               (2) | Val  Loss: 1.7406 | Val  Acc: 0.2857
 Site-FERG_DB_256               (2) | Val  Loss: 1.7368 | Val  Acc: 0.2824
 Site-jpWoman                   (3) | Val  Loss: 1.9339 | Val  Acc: 0.2500
 Site-jpWoman                   (3) | Val  Loss: 2.1334 | Val  Acc: 0.1250
 Site-FER                       (0) | Val  Loss: 1.9379 | Val  Acc: 0.2647
Average Valid Accuracy: 0.3277
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4474
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4211
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.3721
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.4264
 Best site-expw                     (1)  | Epoch:13 | Val Acc: 0.3731
 Best site-FERG_DB_256              (2)  | Epoch:13 | Val Acc: 0.3571
 Best site-FERG_DB_256              (2)  | Epoch:13 | Val Acc: 0.2857
 Best site-FERG_DB_256              (2)  | Epoch:13 | Val Acc: 0.2824
 Best site-jpWoman                  (3)  | Epoch:13 | Val Acc: 0.2500
 Best site-jpWoman                  (3)  | Epoch:13 | Val Acc: 0.1250
 Best site-FER                      (0)  | Epoch:13 | Val Acc: 0.2647
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 5, 2, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-expw                      (1) | Train Loss: 1.3533 | Train Acc: 0.4386
 Site-expw                      (1) | Train Loss: 1.4490 | Train Acc: 0.4070
 Site-expw                      (1) | Train Loss: 1.2509 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.5078 | Train Acc: 0.3731
 Site-expw                      (1) | Train Loss: 1.3579 | Train Acc: 0.4118
 Site-FERG_DB_256               (3) | Train Loss: 1.7908 | Train Acc: 0.2857
 Site-FERG_DB_256               (3) | Train Loss: 1.6742 | Train Acc: 0.2703
 Site-FERG_DB_256               (3) | Train Loss: 1.7631 | Train Acc: 0.3516
 Site-jpWoman                   (2) | Train Loss: 2.2501 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.0199 | Train Acc: 0.1667
 Site-FER                       (0) | Train Loss: 1.8187 | Train Acc: 0.2727
Average Train Accuracy: 0.3142
 Site-expw                      (1) | Val  Loss: 1.3416 | Val  Acc: 0.4211
 Site-expw                      (1) | Val  Loss: 1.3048 | Val  Acc: 0.4912
 Site-expw                      (1) | Val  Loss: 1.3053 | Val  Acc: 0.4070
 Site-expw                      (1) | Val  Loss: 1.3192 | Val  Acc: 0.4341
 Site-expw                      (1) | Val  Loss: 1.4296 | Val  Acc: 0.3679
 Site-FERG_DB_256               (3) | Val  Loss: 1.7258 | Val  Acc: 0.3214
 Site-FERG_DB_256               (3) | Val  Loss: 1.7140 | Val  Acc: 0.3673
 Site-FERG_DB_256               (3) | Val  Loss: 1.7391 | Val  Acc: 0.3059
 Site-jpWoman                   (2) | Val  Loss: 2.0137 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9642 | Val  Acc: 0.1250
 Site-FER                       (0) | Val  Loss: 1.9206 | Val  Acc: 0.2451
Average Valid Accuracy: 0.3396
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4211
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4912
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4070
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.4341
 Best site-expw                     (1)  | Epoch:14 | Val Acc: 0.3679
 Best site-FERG_DB_256              (3)  | Epoch:14 | Val Acc: 0.3214
 Best site-FERG_DB_256              (3)  | Epoch:14 | Val Acc: 0.3673
 Best site-FERG_DB_256              (3)  | Epoch:14 | Val Acc: 0.3059
 Best site-jpWoman                  (2)  | Epoch:14 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:14 | Val Acc: 0.1250
 Best site-FER                      (0)  | Epoch:14 | Val Acc: 0.2451
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 15 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-expw                      (1) | Train Loss: 1.3447 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.4870 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.6444 | Train Acc: 0.3876
 Site-expw                      (1) | Train Loss: 1.2869 | Train Acc: 0.3782
 Site-expw                      (1) | Train Loss: 1.3176 | Train Acc: 0.4740
 Site-FERG_DB_256               (0) | Train Loss: 1.8298 | Train Acc: 0.1905
 Site-FERG_DB_256               (0) | Train Loss: 1.6677 | Train Acc: 0.2703
 Site-FERG_DB_256               (0) | Train Loss: 1.7302 | Train Acc: 0.3438
 Site-jpWoman                   (2) | Train Loss: 2.1606 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 2.0292 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.8263 | Train Acc: 0.2987
Average Train Accuracy: 0.3129
 Site-expw                      (1) | Val  Loss: 1.3600 | Val  Acc: 0.3947
 Site-expw                      (1) | Val  Loss: 1.3109 | Val  Acc: 0.4561
 Site-expw                      (1) | Val  Loss: 1.2637 | Val  Acc: 0.4302
 Site-expw                      (1) | Val  Loss: 1.4724 | Val  Acc: 0.4729
 Site-expw                      (1) | Val  Loss: 1.3874 | Val  Acc: 0.3731
 Site-FERG_DB_256               (0) | Val  Loss: 1.7059 | Val  Acc: 0.3571
 Site-FERG_DB_256               (0) | Val  Loss: 1.6581 | Val  Acc: 0.3878
 Site-FERG_DB_256               (0) | Val  Loss: 1.6997 | Val  Acc: 0.2706
 Site-jpWoman                   (2) | Val  Loss: 1.9728 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0591 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.9851 | Val  Acc: 0.2745
Average Valid Accuracy: 0.3504
 Best site-expw                     (1)  | Epoch:15 | Val Acc: 0.3947
 Best site-expw                     (1)  | Epoch:15 | Val Acc: 0.4561
 Best site-expw                     (1)  | Epoch:15 | Val Acc: 0.4302
 Best site-expw                     (1)  | Epoch:15 | Val Acc: 0.4729
 Best site-expw                     (1)  | Epoch:15 | Val Acc: 0.3731
 Best site-FERG_DB_256              (0)  | Epoch:15 | Val Acc: 0.3571
 Best site-FERG_DB_256              (0)  | Epoch:15 | Val Acc: 0.3878
 Best site-FERG_DB_256              (0)  | Epoch:15 | Val Acc: 0.2706
 Best site-jpWoman                  (2)  | Epoch:15 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:15 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:15 | Val Acc: 0.2745
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-expw                      (1) | Train Loss: 1.3733 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.4424 | Train Acc: 0.3605
 Site-expw                      (1) | Train Loss: 1.3696 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.2058 | Train Acc: 0.4508
 Site-expw                      (1) | Train Loss: 1.3025 | Train Acc: 0.4567
 Site-FERG_DB_256               (0) | Train Loss: 1.8221 | Train Acc: 0.2619
 Site-FERG_DB_256               (0) | Train Loss: 1.6361 | Train Acc: 0.3108
 Site-FERG_DB_256               (0) | Train Loss: 1.6976 | Train Acc: 0.3750
 Site-jpWoman                   (2) | Train Loss: 2.1770 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9530 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.8012 | Train Acc: 0.2727
Average Train Accuracy: 0.3148
 Site-expw                      (1) | Val  Loss: 1.3168 | Val  Acc: 0.4474
 Site-expw                      (1) | Val  Loss: 1.3217 | Val  Acc: 0.4211
 Site-expw                      (1) | Val  Loss: 1.2587 | Val  Acc: 0.5116
 Site-expw                      (1) | Val  Loss: 1.3132 | Val  Acc: 0.4574
 Site-expw                      (1) | Val  Loss: 1.4060 | Val  Acc: 0.3731
 Site-FERG_DB_256               (0) | Val  Loss: 1.6467 | Val  Acc: 0.4643
 Site-FERG_DB_256               (0) | Val  Loss: 1.6534 | Val  Acc: 0.3673
 Site-FERG_DB_256               (0) | Val  Loss: 1.6700 | Val  Acc: 0.4000
 Site-jpWoman                   (2) | Val  Loss: 2.2354 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.1160 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.9319 | Val  Acc: 0.2745
Average Valid Accuracy: 0.3776
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4474
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4211
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.5116
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.4574
 Best site-expw                     (1)  | Epoch:16 | Val Acc: 0.3731
 Best site-FERG_DB_256              (0)  | Epoch:16 | Val Acc: 0.4643
 Best site-FERG_DB_256              (0)  | Epoch:16 | Val Acc: 0.3673
 Best site-FERG_DB_256              (0)  | Epoch:16 | Val Acc: 0.4000
 Best site-jpWoman                  (2)  | Epoch:16 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:16 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:16 | Val Acc: 0.2745
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[3, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-expw                      (3) | Train Loss: 1.3681 | Train Acc: 0.3684
 Site-expw                      (0) | Train Loss: 1.4749 | Train Acc: 0.3837
 Site-expw                      (3) | Train Loss: 1.2896 | Train Acc: 0.3643
 Site-expw                      (0) | Train Loss: 1.4626 | Train Acc: 0.4041
 Site-expw                      (0) | Train Loss: 1.3116 | Train Acc: 0.4464
 Site-FERG_DB_256               (1) | Train Loss: 1.7934 | Train Acc: 0.2143
 Site-FERG_DB_256               (1) | Train Loss: 1.6631 | Train Acc: 0.3378
 Site-FERG_DB_256               (1) | Train Loss: 1.7105 | Train Acc: 0.3750
 Site-jpWoman                   (2) | Train Loss: 1.9908 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.9312 | Train Acc: 0.2083
 Site-FER                       (1) | Train Loss: 1.8231 | Train Acc: 0.2857
Average Train Accuracy: 0.3232
 Site-expw                      (3) | Val  Loss: 1.3146 | Val  Acc: 0.3421
 Site-expw                      (0) | Val  Loss: 1.2763 | Val  Acc: 0.5088
 Site-expw                      (3) | Val  Loss: 1.2555 | Val  Acc: 0.5116
 Site-expw                      (0) | Val  Loss: 1.2220 | Val  Acc: 0.4729
 Site-expw                      (0) | Val  Loss: 1.3969 | Val  Acc: 0.3627
 Site-FERG_DB_256               (1) | Val  Loss: 1.6239 | Val  Acc: 0.4286
 Site-FERG_DB_256               (1) | Val  Loss: 1.6475 | Val  Acc: 0.4286
 Site-FERG_DB_256               (1) | Val  Loss: 1.6602 | Val  Acc: 0.3412
 Site-jpWoman                   (2) | Val  Loss: 1.9120 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0453 | Val  Acc: 0.1875
 Site-FER                       (1) | Val  Loss: 1.9538 | Val  Acc: 0.2353
Average Valid Accuracy: 0.3699
============ Train epoch 18 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-expw                      (1) | Train Loss: 1.3663 | Train Acc: 0.3509
 Site-expw                      (1) | Train Loss: 1.4084 | Train Acc: 0.4419
 Site-expw                      (1) | Train Loss: 1.3426 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.2819 | Train Acc: 0.4301
 Site-expw                      (1) | Train Loss: 1.3242 | Train Acc: 0.4879
 Site-FERG_DB_256               (0) | Train Loss: 1.7560 | Train Acc: 0.2619
 Site-FERG_DB_256               (0) | Train Loss: 1.6545 | Train Acc: 0.3108
 Site-FERG_DB_256               (0) | Train Loss: 1.6742 | Train Acc: 0.3906
 Site-jpWoman                   (2) | Train Loss: 2.1019 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9641 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.7616 | Train Acc: 0.3766
Average Train Accuracy: 0.3356
 Site-expw                      (1) | Val  Loss: 1.2707 | Val  Acc: 0.4474
 Site-expw                      (1) | Val  Loss: 1.2688 | Val  Acc: 0.4912
 Site-expw                      (1) | Val  Loss: 1.2184 | Val  Acc: 0.4884
 Site-expw                      (1) | Val  Loss: 1.2392 | Val  Acc: 0.4574
 Site-expw                      (1) | Val  Loss: 1.3386 | Val  Acc: 0.3990
 Site-FERG_DB_256               (0) | Val  Loss: 1.6268 | Val  Acc: 0.4643
 Site-FERG_DB_256               (0) | Val  Loss: 1.5971 | Val  Acc: 0.4694
 Site-FERG_DB_256               (0) | Val  Loss: 1.6764 | Val  Acc: 0.3647
 Site-jpWoman                   (2) | Val  Loss: 1.9294 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 2.0222 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.9105 | Val  Acc: 0.2549
Average Valid Accuracy: 0.3715
============ Train epoch 19 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-expw                      (0) | Train Loss: 1.3212 | Train Acc: 0.4035
 Site-expw                      (3) | Train Loss: 1.4429 | Train Acc: 0.3023
 Site-expw                      (0) | Train Loss: 1.4455 | Train Acc: 0.4031
 Site-expw                      (3) | Train Loss: 1.2220 | Train Acc: 0.4456
 Site-expw                      (3) | Train Loss: 1.2810 | Train Acc: 0.4913
 Site-FERG_DB_256               (1) | Train Loss: 1.7390 | Train Acc: 0.3333
 Site-FERG_DB_256               (1) | Train Loss: 1.5215 | Train Acc: 0.4054
 Site-FERG_DB_256               (1) | Train Loss: 1.6618 | Train Acc: 0.4297
 Site-jpWoman                   (2) | Train Loss: 2.0906 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.8412 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.8185 | Train Acc: 0.2597
Average Train Accuracy: 0.3461
 Site-expw                      (0) | Val  Loss: 1.2512 | Val  Acc: 0.4737
 Site-expw                      (3) | Val  Loss: 1.2570 | Val  Acc: 0.5439
 Site-expw                      (0) | Val  Loss: 1.2482 | Val  Acc: 0.4884
 Site-expw                      (3) | Val  Loss: 1.3032 | Val  Acc: 0.4496
 Site-expw                      (3) | Val  Loss: 1.3327 | Val  Acc: 0.4145
 Site-FERG_DB_256               (1) | Val  Loss: 1.6172 | Val  Acc: 0.5357
 Site-FERG_DB_256               (1) | Val  Loss: 1.5741 | Val  Acc: 0.5306
 Site-FERG_DB_256               (1) | Val  Loss: 1.6834 | Val  Acc: 0.3412
 Site-jpWoman                   (2) | Val  Loss: 2.0297 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0020 | Val  Acc: 0.2500
 Site-FER                       (2) | Val  Loss: 1.8937 | Val  Acc: 0.2647
Average Valid Accuracy: 0.4129
 Best site-expw                     (0)  | Epoch:19 | Val Acc: 0.4737
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.5439
 Best site-expw                     (0)  | Epoch:19 | Val Acc: 0.4884
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.4496
 Best site-expw                     (3)  | Epoch:19 | Val Acc: 0.4145
 Best site-FERG_DB_256              (1)  | Epoch:19 | Val Acc: 0.5357
 Best site-FERG_DB_256              (1)  | Epoch:19 | Val Acc: 0.5306
 Best site-FERG_DB_256              (1)  | Epoch:19 | Val Acc: 0.3412
 Best site-jpWoman                  (2)  | Epoch:19 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:19 | Val Acc: 0.2500
 Best site-FER                      (2)  | Epoch:19 | Val Acc: 0.2647
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 20 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-expw                      (0) | Train Loss: 1.3584 | Train Acc: 0.2982
 Site-expw                      (0) | Train Loss: 1.4631 | Train Acc: 0.3256
 Site-expw                      (0) | Train Loss: 1.6372 | Train Acc: 0.3566
 Site-expw                      (0) | Train Loss: 1.2472 | Train Acc: 0.4611
 Site-expw                      (0) | Train Loss: 1.2788 | Train Acc: 0.5156
 Site-FERG_DB_256               (1) | Train Loss: 1.7407 | Train Acc: 0.2857
 Site-FERG_DB_256               (1) | Train Loss: 1.5772 | Train Acc: 0.4459
 Site-FERG_DB_256               (1) | Train Loss: 1.6201 | Train Acc: 0.4609
 Site-jpWoman                   (2) | Train Loss: 1.9347 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.8747 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.7750 | Train Acc: 0.3377
Average Train Accuracy: 0.3398
 Site-expw                      (0) | Val  Loss: 1.1771 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.2309 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.2299 | Val  Acc: 0.5116
 Site-expw                      (0) | Val  Loss: 1.2517 | Val  Acc: 0.4884
 Site-expw                      (0) | Val  Loss: 1.3349 | Val  Acc: 0.4041
 Site-FERG_DB_256               (1) | Val  Loss: 1.5598 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.5518 | Val  Acc: 0.5510
 Site-FERG_DB_256               (1) | Val  Loss: 1.5905 | Val  Acc: 0.4353
 Site-jpWoman                   (2) | Val  Loss: 1.8856 | Val  Acc: 0.1250
 Site-jpWoman                   (2) | Val  Loss: 1.8996 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.8756 | Val  Acc: 0.3235
Average Valid Accuracy: 0.4259
 Best site-expw                     (0)  | Epoch:20 | Val Acc: 0.5789
 Best site-expw                     (0)  | Epoch:20 | Val Acc: 0.5789
 Best site-expw                     (0)  | Epoch:20 | Val Acc: 0.5116
 Best site-expw                     (0)  | Epoch:20 | Val Acc: 0.4884
 Best site-expw                     (0)  | Epoch:20 | Val Acc: 0.4041
 Best site-FERG_DB_256              (1)  | Epoch:20 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:20 | Val Acc: 0.5510
 Best site-FERG_DB_256              (1)  | Epoch:20 | Val Acc: 0.4353
 Best site-jpWoman                  (2)  | Epoch:20 | Val Acc: 0.1250
 Best site-jpWoman                  (2)  | Epoch:20 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:20 | Val Acc: 0.3235
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-expw                      (1) | Train Loss: 1.4111 | Train Acc: 0.3158
 Site-expw                      (1) | Train Loss: 1.4370 | Train Acc: 0.3256
 Site-expw                      (1) | Train Loss: 1.3469 | Train Acc: 0.3566
 Site-expw                      (1) | Train Loss: 1.2477 | Train Acc: 0.4404
 Site-expw                      (1) | Train Loss: 1.2391 | Train Acc: 0.5087
 Site-FERG_DB_256               (2) | Train Loss: 1.6984 | Train Acc: 0.3571
 Site-FERG_DB_256               (2) | Train Loss: 1.6425 | Train Acc: 0.3514
 Site-FERG_DB_256               (2) | Train Loss: 1.6266 | Train Acc: 0.4844
 Site-jpWoman                   (0) | Train Loss: 2.0990 | Train Acc: 0.0833
 Site-jpWoman                   (0) | Train Loss: 1.9756 | Train Acc: 0.1250
 Site-FER                       (3) | Train Loss: 1.7814 | Train Acc: 0.3117
Average Train Accuracy: 0.3327
 Site-expw                      (1) | Val  Loss: 1.2520 | Val  Acc: 0.4737
 Site-expw                      (1) | Val  Loss: 1.2390 | Val  Acc: 0.5263
 Site-expw                      (1) | Val  Loss: 1.2127 | Val  Acc: 0.5930
 Site-expw                      (1) | Val  Loss: 1.1313 | Val  Acc: 0.4574
 Site-expw                      (1) | Val  Loss: 1.3222 | Val  Acc: 0.4508
 Site-FERG_DB_256               (2) | Val  Loss: 1.6055 | Val  Acc: 0.4643
 Site-FERG_DB_256               (2) | Val  Loss: 1.5629 | Val  Acc: 0.4490
 Site-FERG_DB_256               (2) | Val  Loss: 1.5769 | Val  Acc: 0.3882
 Site-jpWoman                   (0) | Val  Loss: 1.7678 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 2.0201 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.9367 | Val  Acc: 0.2745
Average Valid Accuracy: 0.4047
============ Train epoch 22 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-expw                      (0) | Train Loss: 1.4304 | Train Acc: 0.2105
 Site-expw                      (0) | Train Loss: 1.3121 | Train Acc: 0.3721
 Site-expw                      (0) | Train Loss: 1.2806 | Train Acc: 0.3566
 Site-expw                      (3) | Train Loss: 1.1888 | Train Acc: 0.4145
 Site-expw                      (3) | Train Loss: 1.2440 | Train Acc: 0.5467
 Site-FERG_DB_256               (1) | Train Loss: 1.6600 | Train Acc: 0.4048
 Site-FERG_DB_256               (1) | Train Loss: 1.6316 | Train Acc: 0.4324
 Site-FERG_DB_256               (1) | Train Loss: 1.6220 | Train Acc: 0.4375
 Site-jpWoman                   (2) | Train Loss: 2.0781 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 2.0475 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.7172 | Train Acc: 0.3052
Average Train Accuracy: 0.3391
 Site-expw                      (0) | Val  Loss: 1.2479 | Val  Acc: 0.4474
 Site-expw                      (0) | Val  Loss: 1.2343 | Val  Acc: 0.5439
 Site-expw                      (0) | Val  Loss: 1.2232 | Val  Acc: 0.5581
 Site-expw                      (3) | Val  Loss: 1.1221 | Val  Acc: 0.4651
 Site-expw                      (3) | Val  Loss: 1.3515 | Val  Acc: 0.3990
 Site-FERG_DB_256               (1) | Val  Loss: 1.5761 | Val  Acc: 0.4643
 Site-FERG_DB_256               (1) | Val  Loss: 1.5743 | Val  Acc: 0.4082
 Site-FERG_DB_256               (1) | Val  Loss: 1.5685 | Val  Acc: 0.5294
 Site-jpWoman                   (2) | Val  Loss: 2.0175 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9725 | Val  Acc: 0.1250
 Site-FER                       (2) | Val  Loss: 1.8949 | Val  Acc: 0.3039
Average Valid Accuracy: 0.4086
============ Train epoch 23 ============
cnt=[3, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-expw                      (3) | Train Loss: 1.3936 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.3790 | Train Acc: 0.4070
 Site-expw                      (1) | Train Loss: 1.2538 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.8645 | Train Acc: 0.4611
 Site-expw                      (1) | Train Loss: 1.2640 | Train Acc: 0.5225
 Site-FERG_DB_256               (0) | Train Loss: 1.6514 | Train Acc: 0.4048
 Site-FERG_DB_256               (0) | Train Loss: 1.5482 | Train Acc: 0.4054
 Site-FERG_DB_256               (0) | Train Loss: 1.5755 | Train Acc: 0.5547
 Site-jpWoman                   (2) | Train Loss: 1.9413 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9653 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.7490 | Train Acc: 0.3636
Average Train Accuracy: 0.3669
 Site-expw                      (3) | Val  Loss: 1.2192 | Val  Acc: 0.5000
 Site-expw                      (1) | Val  Loss: 1.2029 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.1608 | Val  Acc: 0.5814
 Site-expw                      (1) | Val  Loss: 1.1351 | Val  Acc: 0.4961
 Site-expw                      (1) | Val  Loss: 1.3903 | Val  Acc: 0.3782
 Site-FERG_DB_256               (0) | Val  Loss: 1.5001 | Val  Acc: 0.5714
 Site-FERG_DB_256               (0) | Val  Loss: 1.5295 | Val  Acc: 0.4898
 Site-FERG_DB_256               (0) | Val  Loss: 1.5791 | Val  Acc: 0.4824
 Site-jpWoman                   (2) | Val  Loss: 1.8103 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0919 | Val  Acc: 0.1875
 Site-FER                       (2) | Val  Loss: 1.8789 | Val  Acc: 0.2451
Average Valid Accuracy: 0.4328
 Best site-expw                     (3)  | Epoch:23 | Val Acc: 0.5000
 Best site-expw                     (1)  | Epoch:23 | Val Acc: 0.5789
 Best site-expw                     (1)  | Epoch:23 | Val Acc: 0.5814
 Best site-expw                     (1)  | Epoch:23 | Val Acc: 0.4961
 Best site-expw                     (1)  | Epoch:23 | Val Acc: 0.3782
 Best site-FERG_DB_256              (0)  | Epoch:23 | Val Acc: 0.5714
 Best site-FERG_DB_256              (0)  | Epoch:23 | Val Acc: 0.4898
 Best site-FERG_DB_256              (0)  | Epoch:23 | Val Acc: 0.4824
 Best site-jpWoman                  (2)  | Epoch:23 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:23 | Val Acc: 0.1875
 Best site-FER                      (2)  | Epoch:23 | Val Acc: 0.2451
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 24 ============
cnt=[1, 3, 3, 4, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-expw                      (0) | Train Loss: 1.3633 | Train Acc: 0.2807
 Site-expw                      (3) | Train Loss: 1.3677 | Train Acc: 0.4070
 Site-expw                      (3) | Train Loss: 1.5035 | Train Acc: 0.3876
 Site-expw                      (3) | Train Loss: 1.6010 | Train Acc: 0.4560
 Site-expw                      (3) | Train Loss: 1.2218 | Train Acc: 0.5398
 Site-FERG_DB_256               (1) | Train Loss: 1.6681 | Train Acc: 0.3810
 Site-FERG_DB_256               (1) | Train Loss: 1.5338 | Train Acc: 0.3919
 Site-FERG_DB_256               (1) | Train Loss: 1.5616 | Train Acc: 0.4766
 Site-jpWoman                   (2) | Train Loss: 2.0712 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.9405 | Train Acc: 0.1250
 Site-FER                       (2) | Train Loss: 1.7138 | Train Acc: 0.3312
Average Train Accuracy: 0.3585
 Site-expw                      (0) | Val  Loss: 1.2135 | Val  Acc: 0.5789
 Site-expw                      (3) | Val  Loss: 1.2180 | Val  Acc: 0.5263
 Site-expw                      (3) | Val  Loss: 1.2022 | Val  Acc: 0.5349
 Site-expw                      (3) | Val  Loss: 1.1397 | Val  Acc: 0.4186
 Site-expw                      (3) | Val  Loss: 1.3245 | Val  Acc: 0.3938
 Site-FERG_DB_256               (1) | Val  Loss: 1.5542 | Val  Acc: 0.5357
 Site-FERG_DB_256               (1) | Val  Loss: 1.4747 | Val  Acc: 0.6122
 Site-FERG_DB_256               (1) | Val  Loss: 1.5639 | Val  Acc: 0.4706
 Site-jpWoman                   (2) | Val  Loss: 1.8244 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9950 | Val  Acc: 0.0625
 Site-FER                       (2) | Val  Loss: 1.8751 | Val  Acc: 0.3137
Average Valid Accuracy: 0.4270
============ Train epoch 25 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-expw                      (1) | Train Loss: 1.3711 | Train Acc: 0.3509
 Site-expw                      (1) | Train Loss: 1.3468 | Train Acc: 0.4186
 Site-expw                      (1) | Train Loss: 1.1598 | Train Acc: 0.3798
 Site-expw                      (1) | Train Loss: 1.2225 | Train Acc: 0.4197
 Site-expw                      (1) | Train Loss: 1.2359 | Train Acc: 0.4775
 Site-FERG_DB_256               (2) | Train Loss: 1.6632 | Train Acc: 0.3571
 Site-FERG_DB_256               (2) | Train Loss: 1.6012 | Train Acc: 0.3919
 Site-FERG_DB_256               (2) | Train Loss: 1.5741 | Train Acc: 0.5469
 Site-jpWoman                   (3) | Train Loss: 2.0550 | Train Acc: 0.0833
 Site-jpWoman                   (3) | Train Loss: 2.0225 | Train Acc: 0.1250
 Site-FER                       (0) | Train Loss: 1.7017 | Train Acc: 0.3636
Average Train Accuracy: 0.3559
 Site-expw                      (1) | Val  Loss: 1.1675 | Val  Acc: 0.5263
 Site-expw                      (1) | Val  Loss: 1.1418 | Val  Acc: 0.6140
 Site-expw                      (1) | Val  Loss: 1.1695 | Val  Acc: 0.5233
 Site-expw                      (1) | Val  Loss: 1.1395 | Val  Acc: 0.4496
 Site-expw                      (1) | Val  Loss: 1.3231 | Val  Acc: 0.4145
 Site-FERG_DB_256               (2) | Val  Loss: 1.4463 | Val  Acc: 0.5714
 Site-FERG_DB_256               (2) | Val  Loss: 1.5315 | Val  Acc: 0.5714
 Site-FERG_DB_256               (2) | Val  Loss: 1.5175 | Val  Acc: 0.5647
 Site-jpWoman                   (3) | Val  Loss: 1.8326 | Val  Acc: 0.2500
 Site-jpWoman                   (3) | Val  Loss: 2.0030 | Val  Acc: 0.1875
 Site-FER                       (0) | Val  Loss: 1.8936 | Val  Acc: 0.3137
Average Valid Accuracy: 0.4533
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.5263
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.6140
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.5233
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.4496
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.4145
 Best site-FERG_DB_256              (2)  | Epoch:25 | Val Acc: 0.5714
 Best site-FERG_DB_256              (2)  | Epoch:25 | Val Acc: 0.5714
 Best site-FERG_DB_256              (2)  | Epoch:25 | Val Acc: 0.5647
 Best site-jpWoman                  (3)  | Epoch:25 | Val Acc: 0.2500
 Best site-jpWoman                  (3)  | Epoch:25 | Val Acc: 0.1875
 Best site-FER                      (0)  | Epoch:25 | Val Acc: 0.3137
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 26 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-expw                      (1) | Train Loss: 1.3411 | Train Acc: 0.3509
 Site-expw                      (1) | Train Loss: 1.3821 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.3731 | Train Acc: 0.4341
 Site-expw                      (1) | Train Loss: 1.2433 | Train Acc: 0.4560
 Site-expw                      (1) | Train Loss: 1.2095 | Train Acc: 0.5571
 Site-FERG_DB_256               (0) | Train Loss: 1.6586 | Train Acc: 0.3810
 Site-FERG_DB_256               (0) | Train Loss: 1.5187 | Train Acc: 0.4459
 Site-FERG_DB_256               (0) | Train Loss: 1.5572 | Train Acc: 0.5312
 Site-jpWoman                   (2) | Train Loss: 2.1683 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9266 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.7111 | Train Acc: 0.3182
Average Train Accuracy: 0.3783
 Site-expw                      (1) | Val  Loss: 1.1578 | Val  Acc: 0.5263
 Site-expw                      (1) | Val  Loss: 1.1886 | Val  Acc: 0.6140
 Site-expw                      (1) | Val  Loss: 1.1829 | Val  Acc: 0.5698
 Site-expw                      (1) | Val  Loss: 1.1666 | Val  Acc: 0.5039
 Site-expw                      (1) | Val  Loss: 1.2411 | Val  Acc: 0.4145
 Site-FERG_DB_256               (0) | Val  Loss: 1.4952 | Val  Acc: 0.5357
 Site-FERG_DB_256               (0) | Val  Loss: 1.4707 | Val  Acc: 0.5510
 Site-FERG_DB_256               (0) | Val  Loss: 1.5686 | Val  Acc: 0.5412
 Site-jpWoman                   (2) | Val  Loss: 1.8385 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0598 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.8179 | Val  Acc: 0.3137
Average Valid Accuracy: 0.4496
============ Train epoch 27 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-expw                      (0) | Train Loss: 1.3325 | Train Acc: 0.3509
 Site-expw                      (0) | Train Loss: 1.4236 | Train Acc: 0.3953
 Site-expw                      (0) | Train Loss: 1.4997 | Train Acc: 0.3333
 Site-expw                      (0) | Train Loss: 1.3779 | Train Acc: 0.5130
 Site-expw                      (0) | Train Loss: 1.2183 | Train Acc: 0.5052
 Site-FERG_DB_256               (1) | Train Loss: 1.6115 | Train Acc: 0.4286
 Site-FERG_DB_256               (1) | Train Loss: 1.3972 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.5567 | Train Acc: 0.5000
 Site-jpWoman                   (2) | Train Loss: 1.9946 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9132 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.7286 | Train Acc: 0.3312
Average Train Accuracy: 0.3772
 Site-expw                      (0) | Val  Loss: 1.1320 | Val  Acc: 0.5526
 Site-expw                      (0) | Val  Loss: 1.1661 | Val  Acc: 0.4912
 Site-expw                      (0) | Val  Loss: 1.1721 | Val  Acc: 0.5698
 Site-expw                      (0) | Val  Loss: 1.2446 | Val  Acc: 0.4419
 Site-expw                      (0) | Val  Loss: 1.3082 | Val  Acc: 0.4352
 Site-FERG_DB_256               (1) | Val  Loss: 1.4758 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.4608 | Val  Acc: 0.6735
 Site-FERG_DB_256               (1) | Val  Loss: 1.5426 | Val  Acc: 0.5294
 Site-jpWoman                   (2) | Val  Loss: 1.6452 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.8747 | Val  Acc: 0.2500
 Site-FER                       (3) | Val  Loss: 1.8582 | Val  Acc: 0.2647
Average Valid Accuracy: 0.4508
============ Train epoch 28 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-expw                      (0) | Train Loss: 1.3577 | Train Acc: 0.3860
 Site-expw                      (0) | Train Loss: 1.4125 | Train Acc: 0.4302
 Site-expw                      (0) | Train Loss: 1.0769 | Train Acc: 0.3953
 Site-expw                      (0) | Train Loss: 1.2039 | Train Acc: 0.5026
 Site-expw                      (0) | Train Loss: 1.1891 | Train Acc: 0.5536
 Site-FERG_DB_256               (1) | Train Loss: 1.6483 | Train Acc: 0.3333
 Site-FERG_DB_256               (1) | Train Loss: 1.5441 | Train Acc: 0.4189
 Site-FERG_DB_256               (1) | Train Loss: 1.5277 | Train Acc: 0.5312
 Site-jpWoman                   (2) | Train Loss: 1.9785 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9787 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.7031 | Train Acc: 0.3506
Average Train Accuracy: 0.3774
 Site-expw                      (0) | Val  Loss: 1.1538 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.1476 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.1403 | Val  Acc: 0.6279
 Site-expw                      (0) | Val  Loss: 1.1064 | Val  Acc: 0.5194
 Site-expw                      (0) | Val  Loss: 1.2870 | Val  Acc: 0.4093
 Site-FERG_DB_256               (1) | Val  Loss: 1.4327 | Val  Acc: 0.6786
 Site-FERG_DB_256               (1) | Val  Loss: 1.4303 | Val  Acc: 0.5918
 Site-FERG_DB_256               (1) | Val  Loss: 1.5420 | Val  Acc: 0.5412
 Site-jpWoman                   (2) | Val  Loss: 1.8184 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9561 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.8656 | Val  Acc: 0.3039
Average Valid Accuracy: 0.4732
 Best site-expw                     (0)  | Epoch:28 | Val Acc: 0.5789
 Best site-expw                     (0)  | Epoch:28 | Val Acc: 0.5789
 Best site-expw                     (0)  | Epoch:28 | Val Acc: 0.6279
 Best site-expw                     (0)  | Epoch:28 | Val Acc: 0.5194
 Best site-expw                     (0)  | Epoch:28 | Val Acc: 0.4093
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.6786
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5918
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5412
 Best site-jpWoman                  (2)  | Epoch:28 | Val Acc: 0.2500
 Best site-jpWoman                  (2)  | Epoch:28 | Val Acc: 0.1250
 Best site-FER                      (3)  | Epoch:28 | Val Acc: 0.3039
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-expw                      (3) | Train Loss: 1.3212 | Train Acc: 0.3860
 Site-expw                      (0) | Train Loss: 1.3067 | Train Acc: 0.4535
 Site-expw                      (0) | Train Loss: 1.1836 | Train Acc: 0.3798
 Site-expw                      (0) | Train Loss: 1.1238 | Train Acc: 0.4404
 Site-expw                      (0) | Train Loss: 1.2019 | Train Acc: 0.5467
 Site-FERG_DB_256               (1) | Train Loss: 1.5996 | Train Acc: 0.3810
 Site-FERG_DB_256               (1) | Train Loss: 1.5480 | Train Acc: 0.4054
 Site-FERG_DB_256               (1) | Train Loss: 1.5280 | Train Acc: 0.5312
 Site-jpWoman                   (2) | Train Loss: 2.0902 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9725 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.6607 | Train Acc: 0.3442
Average Train Accuracy: 0.3744
 Site-expw                      (3) | Val  Loss: 1.1285 | Val  Acc: 0.5526
 Site-expw                      (0) | Val  Loss: 1.1523 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.1449 | Val  Acc: 0.5349
 Site-expw                      (0) | Val  Loss: 1.1879 | Val  Acc: 0.5039
 Site-expw                      (0) | Val  Loss: 1.2586 | Val  Acc: 0.3990
 Site-FERG_DB_256               (1) | Val  Loss: 1.4937 | Val  Acc: 0.6071
 Site-FERG_DB_256               (1) | Val  Loss: 1.4329 | Val  Acc: 0.5918
 Site-FERG_DB_256               (1) | Val  Loss: 1.5425 | Val  Acc: 0.4706
 Site-jpWoman                   (2) | Val  Loss: 1.9251 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0911 | Val  Acc: 0.0625
 Site-FER                       (2) | Val  Loss: 1.8842 | Val  Acc: 0.2647
Average Valid Accuracy: 0.4378
============ Train epoch 30 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-expw                      (1) | Train Loss: 1.3770 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.2753 | Train Acc: 0.4419
 Site-expw                      (1) | Train Loss: 1.3716 | Train Acc: 0.4109
 Site-expw                      (1) | Train Loss: 1.3399 | Train Acc: 0.4404
 Site-expw                      (1) | Train Loss: 1.2048 | Train Acc: 0.5225
 Site-FERG_DB_256               (0) | Train Loss: 1.5458 | Train Acc: 0.3810
 Site-FERG_DB_256               (0) | Train Loss: 1.4141 | Train Acc: 0.4189
 Site-FERG_DB_256               (0) | Train Loss: 1.5150 | Train Acc: 0.5625
 Site-jpWoman                   (2) | Train Loss: 2.1093 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.9667 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.6442 | Train Acc: 0.3571
Average Train Accuracy: 0.3858
 Site-expw                      (1) | Val  Loss: 1.0913 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.1527 | Val  Acc: 0.5614
 Site-expw                      (1) | Val  Loss: 1.1479 | Val  Acc: 0.6279
 Site-expw                      (1) | Val  Loss: 1.1640 | Val  Acc: 0.4961
 Site-expw                      (1) | Val  Loss: 1.2512 | Val  Acc: 0.4145
 Site-FERG_DB_256               (0) | Val  Loss: 1.4301 | Val  Acc: 0.6071
 Site-FERG_DB_256               (0) | Val  Loss: 1.4384 | Val  Acc: 0.5306
 Site-FERG_DB_256               (0) | Val  Loss: 1.4737 | Val  Acc: 0.5294
 Site-jpWoman                   (2) | Val  Loss: 1.8044 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9440 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.8630 | Val  Acc: 0.3235
Average Valid Accuracy: 0.4586
============ Train epoch 31 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-expw                      (1) | Train Loss: 1.3179 | Train Acc: 0.3684
 Site-expw                      (1) | Train Loss: 1.3284 | Train Acc: 0.3605
 Site-expw                      (1) | Train Loss: 1.2848 | Train Acc: 0.4186
 Site-expw                      (1) | Train Loss: 1.0913 | Train Acc: 0.4404
 Site-expw                      (1) | Train Loss: 1.1812 | Train Acc: 0.5433
 Site-FERG_DB_256               (2) | Train Loss: 1.5837 | Train Acc: 0.4048
 Site-FERG_DB_256               (2) | Train Loss: 1.3777 | Train Acc: 0.5405
 Site-FERG_DB_256               (2) | Train Loss: 1.5010 | Train Acc: 0.5469
 Site-jpWoman                   (0) | Train Loss: 2.0704 | Train Acc: 0.0833
 Site-jpWoman                   (0) | Train Loss: 1.9597 | Train Acc: 0.2083
 Site-FER                       (3) | Train Loss: 1.6638 | Train Acc: 0.3701
Average Train Accuracy: 0.3896
 Site-expw                      (1) | Val  Loss: 1.0925 | Val  Acc: 0.5526
 Site-expw                      (1) | Val  Loss: 1.1558 | Val  Acc: 0.5614
 Site-expw                      (1) | Val  Loss: 1.1247 | Val  Acc: 0.5116
 Site-expw                      (1) | Val  Loss: 1.1705 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.2906 | Val  Acc: 0.3834
 Site-FERG_DB_256               (2) | Val  Loss: 1.4440 | Val  Acc: 0.6786
 Site-FERG_DB_256               (2) | Val  Loss: 1.4480 | Val  Acc: 0.6122
 Site-FERG_DB_256               (2) | Val  Loss: 1.4144 | Val  Acc: 0.6471
 Site-jpWoman                   (0) | Val  Loss: 1.9686 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 1.9978 | Val  Acc: 0.0625
 Site-FER                       (3) | Val  Loss: 1.8287 | Val  Acc: 0.2843
Average Valid Accuracy: 0.4554
============ Train epoch 32 ============
cnt=[5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-expw                      (0) | Train Loss: 1.3490 | Train Acc: 0.3684
 Site-expw                      (0) | Train Loss: 1.4293 | Train Acc: 0.3837
 Site-expw                      (0) | Train Loss: 1.1278 | Train Acc: 0.4031
 Site-expw                      (0) | Train Loss: 1.1361 | Train Acc: 0.4611
 Site-expw                      (0) | Train Loss: 1.1607 | Train Acc: 0.5467
 Site-FERG_DB_256               (2) | Train Loss: 1.5356 | Train Acc: 0.4762
 Site-FERG_DB_256               (2) | Train Loss: 1.4549 | Train Acc: 0.5405
 Site-FERG_DB_256               (2) | Train Loss: 1.4735 | Train Acc: 0.5547
 Site-jpWoman                   (3) | Train Loss: 2.0211 | Train Acc: 0.1667
 Site-jpWoman                   (3) | Train Loss: 1.8162 | Train Acc: 0.1667
 Site-FER                       (1) | Train Loss: 1.6728 | Train Acc: 0.3831
Average Train Accuracy: 0.4046
 Site-expw                      (0) | Val  Loss: 1.0851 | Val  Acc: 0.5000
 Site-expw                      (0) | Val  Loss: 1.1098 | Val  Acc: 0.5789
 Site-expw                      (0) | Val  Loss: 1.1477 | Val  Acc: 0.5814
 Site-expw                      (0) | Val  Loss: 1.0558 | Val  Acc: 0.4651
 Site-expw                      (0) | Val  Loss: 1.2391 | Val  Acc: 0.3886
 Site-FERG_DB_256               (2) | Val  Loss: 1.3847 | Val  Acc: 0.6429
 Site-FERG_DB_256               (2) | Val  Loss: 1.4388 | Val  Acc: 0.5918
 Site-FERG_DB_256               (2) | Val  Loss: 1.4142 | Val  Acc: 0.6000
 Site-jpWoman                   (3) | Val  Loss: 1.6181 | Val  Acc: 0.2500
 Site-jpWoman                   (3) | Val  Loss: 1.9105 | Val  Acc: 0.1250
 Site-FER                       (1) | Val  Loss: 1.8174 | Val  Acc: 0.3922
Average Valid Accuracy: 0.4651
============ Train epoch 33 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-expw                      (3) | Train Loss: 1.3450 | Train Acc: 0.3860
 Site-expw                      (3) | Train Loss: 1.3289 | Train Acc: 0.4302
 Site-expw                      (3) | Train Loss: 1.2088 | Train Acc: 0.4109
 Site-expw                      (0) | Train Loss: 1.4185 | Train Acc: 0.4663
 Site-expw                      (0) | Train Loss: 1.1531 | Train Acc: 0.5675
 Site-FERG_DB_256               (1) | Train Loss: 1.5788 | Train Acc: 0.4286
 Site-FERG_DB_256               (1) | Train Loss: 1.3304 | Train Acc: 0.5405
 Site-FERG_DB_256               (1) | Train Loss: 1.4688 | Train Acc: 0.6016
 Site-jpWoman                   (2) | Train Loss: 1.9534 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9008 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.6716 | Train Acc: 0.3896
Average Train Accuracy: 0.4065
 Site-expw                      (3) | Val  Loss: 1.0573 | Val  Acc: 0.6053
 Site-expw                      (3) | Val  Loss: 1.1228 | Val  Acc: 0.5614
 Site-expw                      (3) | Val  Loss: 1.1015 | Val  Acc: 0.6395
 Site-expw                      (0) | Val  Loss: 1.1024 | Val  Acc: 0.5039
 Site-expw                      (0) | Val  Loss: 1.2481 | Val  Acc: 0.3990
 Site-FERG_DB_256               (1) | Val  Loss: 1.4132 | Val  Acc: 0.6071
 Site-FERG_DB_256               (1) | Val  Loss: 1.3660 | Val  Acc: 0.6735
 Site-FERG_DB_256               (1) | Val  Loss: 1.4437 | Val  Acc: 0.6235
 Site-jpWoman                   (2) | Val  Loss: 1.6552 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.9559 | Val  Acc: 0.1250
 Site-FER                       (2) | Val  Loss: 1.8093 | Val  Acc: 0.3333
Average Valid Accuracy: 0.4951
 Best site-expw                     (3)  | Epoch:33 | Val Acc: 0.6053
 Best site-expw                     (3)  | Epoch:33 | Val Acc: 0.5614
 Best site-expw                     (3)  | Epoch:33 | Val Acc: 0.6395
 Best site-expw                     (0)  | Epoch:33 | Val Acc: 0.5039
 Best site-expw                     (0)  | Epoch:33 | Val Acc: 0.3990
 Best site-FERG_DB_256              (1)  | Epoch:33 | Val Acc: 0.6071
 Best site-FERG_DB_256              (1)  | Epoch:33 | Val Acc: 0.6735
 Best site-FERG_DB_256              (1)  | Epoch:33 | Val Acc: 0.6235
 Best site-jpWoman                  (2)  | Epoch:33 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:33 | Val Acc: 0.1250
 Best site-FER                      (2)  | Epoch:33 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 34 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-expw                      (0) | Train Loss: 1.3358 | Train Acc: 0.3684
 Site-expw                      (0) | Train Loss: 1.3187 | Train Acc: 0.4302
 Site-expw                      (0) | Train Loss: 1.4760 | Train Acc: 0.3798
 Site-expw                      (0) | Train Loss: 1.3668 | Train Acc: 0.4870
 Site-expw                      (0) | Train Loss: 1.1524 | Train Acc: 0.6021
 Site-FERG_DB_256               (1) | Train Loss: 1.5493 | Train Acc: 0.4762
 Site-FERG_DB_256               (1) | Train Loss: 1.3973 | Train Acc: 0.5405
 Site-FERG_DB_256               (1) | Train Loss: 1.4762 | Train Acc: 0.5312
 Site-jpWoman                   (2) | Train Loss: 2.0597 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.9556 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.6262 | Train Acc: 0.3896
Average Train Accuracy: 0.4126
 Site-expw                      (0) | Val  Loss: 1.0440 | Val  Acc: 0.6316
 Site-expw                      (0) | Val  Loss: 1.1074 | Val  Acc: 0.5614
 Site-expw                      (0) | Val  Loss: 1.1405 | Val  Acc: 0.5814
 Site-expw                      (0) | Val  Loss: 1.0204 | Val  Acc: 0.5039
 Site-expw                      (0) | Val  Loss: 1.2116 | Val  Acc: 0.4093
 Site-FERG_DB_256               (1) | Val  Loss: 1.3572 | Val  Acc: 0.6071
 Site-FERG_DB_256               (1) | Val  Loss: 1.3710 | Val  Acc: 0.7143
 Site-FERG_DB_256               (1) | Val  Loss: 1.4528 | Val  Acc: 0.6471
 Site-jpWoman                   (2) | Val  Loss: 1.9081 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0326 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.8095 | Val  Acc: 0.3431
Average Valid Accuracy: 0.4942
============ Train epoch 35 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-expw                      (1) | Train Loss: 1.3526 | Train Acc: 0.3860
 Site-expw                      (1) | Train Loss: 1.3693 | Train Acc: 0.4302
 Site-expw                      (1) | Train Loss: 1.3035 | Train Acc: 0.4031
 Site-expw                      (1) | Train Loss: 1.1695 | Train Acc: 0.4611
 Site-expw                      (1) | Train Loss: 1.1537 | Train Acc: 0.5744
 Site-FERG_DB_256               (2) | Train Loss: 1.5466 | Train Acc: 0.4524
 Site-FERG_DB_256               (2) | Train Loss: 1.3637 | Train Acc: 0.5946
 Site-FERG_DB_256               (2) | Train Loss: 1.4212 | Train Acc: 0.6016
 Site-jpWoman                   (0) | Train Loss: 1.9131 | Train Acc: 0.0833
 Site-jpWoman                   (0) | Train Loss: 1.8984 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.6263 | Train Acc: 0.4351
Average Train Accuracy: 0.4171
 Site-expw                      (1) | Val  Loss: 1.0549 | Val  Acc: 0.6316
 Site-expw                      (1) | Val  Loss: 1.1084 | Val  Acc: 0.6316
 Site-expw                      (1) | Val  Loss: 1.1135 | Val  Acc: 0.5698
 Site-expw                      (1) | Val  Loss: 0.9982 | Val  Acc: 0.5194
 Site-expw                      (1) | Val  Loss: 1.2444 | Val  Acc: 0.4197
 Site-FERG_DB_256               (2) | Val  Loss: 1.3309 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.3541 | Val  Acc: 0.6735
 Site-FERG_DB_256               (2) | Val  Loss: 1.4015 | Val  Acc: 0.5529
 Site-jpWoman                   (0) | Val  Loss: 1.8496 | Val  Acc: 0.2500
 Site-jpWoman                   (0) | Val  Loss: 2.0022 | Val  Acc: 0.2500
 Site-FER                       (3) | Val  Loss: 1.8076 | Val  Acc: 0.3824
Average Valid Accuracy: 0.5086
 Best site-expw                     (1)  | Epoch:35 | Val Acc: 0.6316
 Best site-expw                     (1)  | Epoch:35 | Val Acc: 0.6316
 Best site-expw                     (1)  | Epoch:35 | Val Acc: 0.5698
 Best site-expw                     (1)  | Epoch:35 | Val Acc: 0.5194
 Best site-expw                     (1)  | Epoch:35 | Val Acc: 0.4197
 Best site-FERG_DB_256              (2)  | Epoch:35 | Val Acc: 0.7143
 Best site-FERG_DB_256              (2)  | Epoch:35 | Val Acc: 0.6735
 Best site-FERG_DB_256              (2)  | Epoch:35 | Val Acc: 0.5529
 Best site-jpWoman                  (0)  | Epoch:35 | Val Acc: 0.2500
 Best site-jpWoman                  (0)  | Epoch:35 | Val Acc: 0.2500
 Best site-FER                      (3)  | Epoch:35 | Val Acc: 0.3824
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 36 ============
cnt=[3, 3, 3, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-expw                      (1) | Train Loss: 1.3305 | Train Acc: 0.4386
 Site-expw                      (1) | Train Loss: 1.3191 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.1714 | Train Acc: 0.3953
 Site-expw                      (3) | Train Loss: 1.3409 | Train Acc: 0.4922
 Site-expw                      (3) | Train Loss: 1.1551 | Train Acc: 0.6055
 Site-FERG_DB_256               (0) | Train Loss: 1.5728 | Train Acc: 0.4762
 Site-FERG_DB_256               (0) | Train Loss: 1.3867 | Train Acc: 0.5270
 Site-FERG_DB_256               (0) | Train Loss: 1.4066 | Train Acc: 0.5703
 Site-jpWoman                   (2) | Train Loss: 2.0138 | Train Acc: 0.1667
 Site-jpWoman                   (2) | Train Loss: 1.9199 | Train Acc: 0.2917
 Site-FER                       (2) | Train Loss: 1.6391 | Train Acc: 0.4026
Average Train Accuracy: 0.4308
 Site-expw                      (1) | Val  Loss: 1.0417 | Val  Acc: 0.6842
 Site-expw                      (1) | Val  Loss: 1.1022 | Val  Acc: 0.5965
 Site-expw                      (1) | Val  Loss: 1.1363 | Val  Acc: 0.5930
 Site-expw                      (3) | Val  Loss: 1.0513 | Val  Acc: 0.5039
 Site-expw                      (3) | Val  Loss: 1.2551 | Val  Acc: 0.4611
 Site-FERG_DB_256               (0) | Val  Loss: 1.3550 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.3335 | Val  Acc: 0.6735
 Site-FERG_DB_256               (0) | Val  Loss: 1.3630 | Val  Acc: 0.6235
 Site-jpWoman                   (2) | Val  Loss: 1.6977 | Val  Acc: 0.5000
 Site-jpWoman                   (2) | Val  Loss: 1.9255 | Val  Acc: 0.0625
 Site-FER                       (2) | Val  Loss: 1.7966 | Val  Acc: 0.3431
Average Valid Accuracy: 0.5232
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.6842
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.5965
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.5930
 Best site-expw                     (3)  | Epoch:36 | Val Acc: 0.5039
 Best site-expw                     (3)  | Epoch:36 | Val Acc: 0.4611
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.7143
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.6735
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.6235
 Best site-jpWoman                  (2)  | Epoch:36 | Val Acc: 0.5000
 Best site-jpWoman                  (2)  | Epoch:36 | Val Acc: 0.0625
 Best site-FER                      (2)  | Epoch:36 | Val Acc: 0.3431
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 37 ============
cnt=[2, 3, 3, 3, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-expw                      (3) | Train Loss: 1.3131 | Train Acc: 0.4211
 Site-expw                      (3) | Train Loss: 1.3252 | Train Acc: 0.4070
 Site-expw                      (3) | Train Loss: 1.0454 | Train Acc: 0.4109
 Site-expw                      (0) | Train Loss: 1.3898 | Train Acc: 0.4715
 Site-expw                      (0) | Train Loss: 1.1221 | Train Acc: 0.6055
 Site-FERG_DB_256               (1) | Train Loss: 1.5578 | Train Acc: 0.3810
 Site-FERG_DB_256               (1) | Train Loss: 1.4203 | Train Acc: 0.4865
 Site-FERG_DB_256               (1) | Train Loss: 1.3602 | Train Acc: 0.6719
 Site-jpWoman                   (2) | Train Loss: 1.9736 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.9789 | Train Acc: 0.1667
 Site-FER                       (2) | Train Loss: 1.6471 | Train Acc: 0.4026
Average Train Accuracy: 0.4098
 Site-expw                      (3) | Val  Loss: 1.0072 | Val  Acc: 0.7105
 Site-expw                      (3) | Val  Loss: 1.1095 | Val  Acc: 0.5614
 Site-expw                      (3) | Val  Loss: 1.0906 | Val  Acc: 0.5930
 Site-expw                      (0) | Val  Loss: 0.9762 | Val  Acc: 0.5271
 Site-expw                      (0) | Val  Loss: 1.1878 | Val  Acc: 0.4663
 Site-FERG_DB_256               (1) | Val  Loss: 1.2450 | Val  Acc: 0.7143
 Site-FERG_DB_256               (1) | Val  Loss: 1.3070 | Val  Acc: 0.7143
 Site-FERG_DB_256               (1) | Val  Loss: 1.3617 | Val  Acc: 0.6118
 Site-jpWoman                   (2) | Val  Loss: 1.7800 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 1.9033 | Val  Acc: 0.1250
 Site-FER                       (2) | Val  Loss: 1.8045 | Val  Acc: 0.3824
Average Valid Accuracy: 0.5142
============ Train epoch 38 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-expw                      (0) | Train Loss: 1.3248 | Train Acc: 0.4386
 Site-expw                      (0) | Train Loss: 1.3097 | Train Acc: 0.3721
 Site-expw                      (0) | Train Loss: 1.6072 | Train Acc: 0.4341
 Site-expw                      (0) | Train Loss: 1.1912 | Train Acc: 0.5078
 Site-expw                      (0) | Train Loss: 1.1226 | Train Acc: 0.6021
 Site-FERG_DB_256               (1) | Train Loss: 1.5248 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.3820 | Train Acc: 0.5405
 Site-FERG_DB_256               (1) | Train Loss: 1.3644 | Train Acc: 0.6484
 Site-jpWoman                   (2) | Train Loss: 1.8178 | Train Acc: 0.3333
 Site-jpWoman                   (2) | Train Loss: 1.8260 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.6602 | Train Acc: 0.4026
Average Train Accuracy: 0.4497
 Site-expw                      (0) | Val  Loss: 1.0422 | Val  Acc: 0.6579
 Site-expw                      (0) | Val  Loss: 1.1261 | Val  Acc: 0.5614
 Site-expw                      (0) | Val  Loss: 1.1071 | Val  Acc: 0.5698
 Site-expw                      (0) | Val  Loss: 1.0003 | Val  Acc: 0.5116
 Site-expw                      (0) | Val  Loss: 1.2151 | Val  Acc: 0.3886
 Site-FERG_DB_256               (1) | Val  Loss: 1.2705 | Val  Acc: 0.8214
 Site-FERG_DB_256               (1) | Val  Loss: 1.3311 | Val  Acc: 0.5918
 Site-FERG_DB_256               (1) | Val  Loss: 1.3980 | Val  Acc: 0.6000
 Site-jpWoman                   (2) | Val  Loss: 1.6841 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8296 | Val  Acc: 0.2500
 Site-FER                       (3) | Val  Loss: 1.7992 | Val  Acc: 0.3922
Average Valid Accuracy: 0.5200
============ Train epoch 39 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-expw                      (1) | Train Loss: 1.3756 | Train Acc: 0.3333
 Site-expw                      (1) | Train Loss: 1.3320 | Train Acc: 0.4302
 Site-expw                      (1) | Train Loss: 1.2197 | Train Acc: 0.4729
 Site-expw                      (1) | Train Loss: 1.1990 | Train Acc: 0.4663
 Site-expw                      (1) | Train Loss: 1.1089 | Train Acc: 0.5779
 Site-FERG_DB_256               (0) | Train Loss: 1.5449 | Train Acc: 0.3810
 Site-FERG_DB_256               (0) | Train Loss: 1.3682 | Train Acc: 0.5405
 Site-FERG_DB_256               (0) | Train Loss: 1.3858 | Train Acc: 0.6172
 Site-jpWoman                   (2) | Train Loss: 2.1303 | Train Acc: 0.0833
 Site-jpWoman                   (2) | Train Loss: 1.8904 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.5965 | Train Acc: 0.4221
Average Train Accuracy: 0.4159
 Site-expw                      (1) | Val  Loss: 1.0024 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.0929 | Val  Acc: 0.5965
 Site-expw                      (1) | Val  Loss: 1.0924 | Val  Acc: 0.6163
 Site-expw                      (1) | Val  Loss: 1.0176 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.1668 | Val  Acc: 0.4404
 Site-FERG_DB_256               (0) | Val  Loss: 1.2953 | Val  Acc: 0.6429
 Site-FERG_DB_256               (0) | Val  Loss: 1.3519 | Val  Acc: 0.5918
 Site-FERG_DB_256               (0) | Val  Loss: 1.3307 | Val  Acc: 0.5882
 Site-jpWoman                   (2) | Val  Loss: 1.9247 | Val  Acc: 0.2500
 Site-jpWoman                   (2) | Val  Loss: 2.0419 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.8275 | Val  Acc: 0.3725
Average Valid Accuracy: 0.4789
============ Train epoch 40 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-expw                      (1) | Train Loss: 1.3553 | Train Acc: 0.3509
 Site-expw                      (1) | Train Loss: 1.3563 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.1153 | Train Acc: 0.4574
 Site-expw                      (1) | Train Loss: 1.1036 | Train Acc: 0.4922
 Site-expw                      (1) | Train Loss: 1.0900 | Train Acc: 0.6125
 Site-FERG_DB_256               (2) | Train Loss: 1.5123 | Train Acc: 0.4524
 Site-FERG_DB_256               (2) | Train Loss: 1.4090 | Train Acc: 0.5405
 Site-FERG_DB_256               (2) | Train Loss: 1.3597 | Train Acc: 0.6250
 Site-jpWoman                   (0) | Train Loss: 1.9833 | Train Acc: 0.1667
 Site-jpWoman                   (0) | Train Loss: 1.8617 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.5929 | Train Acc: 0.3896
Average Train Accuracy: 0.4302
 Site-expw                      (1) | Val  Loss: 0.9681 | Val  Acc: 0.7632
 Site-expw                      (1) | Val  Loss: 1.0727 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.0869 | Val  Acc: 0.5814
 Site-expw                      (1) | Val  Loss: 1.0275 | Val  Acc: 0.5194
 Site-expw                      (1) | Val  Loss: 1.2068 | Val  Acc: 0.4456
 Site-FERG_DB_256               (2) | Val  Loss: 1.2905 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.2837 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.3394 | Val  Acc: 0.6353
 Site-jpWoman                   (0) | Val  Loss: 1.8409 | Val  Acc: 0.3750
 Site-jpWoman                   (0) | Val  Loss: 2.0790 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.7666 | Val  Acc: 0.4020
Average Valid Accuracy: 0.5379
 Best site-expw                     (1)  | Epoch:40 | Val Acc: 0.7632
 Best site-expw                     (1)  | Epoch:40 | Val Acc: 0.5789
 Best site-expw                     (1)  | Epoch:40 | Val Acc: 0.5814
 Best site-expw                     (1)  | Epoch:40 | Val Acc: 0.5194
 Best site-expw                     (1)  | Epoch:40 | Val Acc: 0.4456
 Best site-FERG_DB_256              (2)  | Epoch:40 | Val Acc: 0.7143
 Best site-FERG_DB_256              (2)  | Epoch:40 | Val Acc: 0.7143
 Best site-FERG_DB_256              (2)  | Epoch:40 | Val Acc: 0.6353
 Best site-jpWoman                  (0)  | Epoch:40 | Val Acc: 0.3750
 Best site-jpWoman                  (0)  | Epoch:40 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:40 | Val Acc: 0.4020
 Test site-expw                      (1)| Epoch:40 | Test Acc: 0.3465
 Test site-FERG_DB_256               (2)| Epoch:40 | Test Acc: 0.5018
 Test site-jpWoman                   (0)| Epoch:40 | Test Acc: 0.2529
 Test site-FER                       (3)| Epoch:40 | Test Acc: 0.2639
expw: 0.3465, FERG_DB_256: 0.5018, jpWoman: 0.2529, FER: 0.2639, 
Average Test Accuracy(group): 0.3413, Average Test Accuracy(individual): 0.3643,
domain std=0.0995, cluster std=0.0995, individual std=0.0921, 
Average Test Accuracy: 0.3413
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-expw                      (0) | Train Loss: 1.3524 | Train Acc: 0.3333
 Site-expw                      (0) | Train Loss: 1.4334 | Train Acc: 0.4535
 Site-expw                      (0) | Train Loss: 1.3205 | Train Acc: 0.4341
 Site-expw                      (0) | Train Loss: 1.1509 | Train Acc: 0.4922
 Site-expw                      (0) | Train Loss: 1.1194 | Train Acc: 0.5917
 Site-FERG_DB_256               (1) | Train Loss: 1.4407 | Train Acc: 0.5238
 Site-FERG_DB_256               (1) | Train Loss: 1.3457 | Train Acc: 0.5676
 Site-FERG_DB_256               (1) | Train Loss: 1.3506 | Train Acc: 0.6484
 Site-jpWoman                   (2) | Train Loss: 2.0768 | Train Acc: 0.0000
 Site-jpWoman                   (2) | Train Loss: 1.9170 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.5945 | Train Acc: 0.3896
Average Train Accuracy: 0.4258
 Site-expw                      (0) | Val  Loss: 1.0332 | Val  Acc: 0.6842
 Site-expw                      (0) | Val  Loss: 1.0560 | Val  Acc: 0.6316
 Site-expw                      (0) | Val  Loss: 1.0844 | Val  Acc: 0.5930
 Site-expw                      (0) | Val  Loss: 1.0656 | Val  Acc: 0.5581
 Site-expw                      (0) | Val  Loss: 1.1432 | Val  Acc: 0.4508
 Site-FERG_DB_256               (1) | Val  Loss: 1.2198 | Val  Acc: 0.6786
 Site-FERG_DB_256               (1) | Val  Loss: 1.3068 | Val  Acc: 0.6327
 Site-FERG_DB_256               (1) | Val  Loss: 1.3353 | Val  Acc: 0.6235
 Site-jpWoman                   (2) | Val  Loss: 1.8307 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8979 | Val  Acc: 0.2500
 Site-FER                       (3) | Val  Loss: 1.7727 | Val  Acc: 0.3137
Average Valid Accuracy: 0.5265
 Test site-expw                      (0)| Epoch:40 | Test Acc: 0.3544
 Test site-FERG_DB_256               (1)| Epoch:40 | Test Acc: 0.5145
 Test site-jpWoman                   (2)| Epoch:40 | Test Acc: 0.2529
 Test site-FER                       (3)| Epoch:40 | Test Acc: 0.2670
expw: 0.3544, FERG_DB_256: 0.5145, jpWoman: 0.2529, FER: 0.2670, 
Average Test Accuracy(group): 0.3472, Average Test Accuracy(individual): 0.3717,
domain std=0.1041, cluster std=0.1041, individual std=0.0962, 
Average Test Accuracy: 0.3472
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-expw                      (1) | Train Loss: 1.3001 | Train Acc: 0.5088
 Site-expw                      (1) | Train Loss: 1.3071 | Train Acc: 0.4651
 Site-expw                      (1) | Train Loss: 1.5998 | Train Acc: 0.4186
 Site-expw                      (1) | Train Loss: 1.0932 | Train Acc: 0.5026
 Site-expw                      (1) | Train Loss: 1.0879 | Train Acc: 0.6194
 Site-FERG_DB_256               (2) | Train Loss: 1.4484 | Train Acc: 0.5238
 Site-FERG_DB_256               (2) | Train Loss: 1.2382 | Train Acc: 0.6216
 Site-FERG_DB_256               (2) | Train Loss: 1.3106 | Train Acc: 0.6797
 Site-jpWoman                   (0) | Train Loss: 1.8702 | Train Acc: 0.2500
 Site-jpWoman                   (0) | Train Loss: 1.8583 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.5732 | Train Acc: 0.4675
Average Train Accuracy: 0.4825
 Site-expw                      (1) | Val  Loss: 0.9745 | Val  Acc: 0.5526
 Site-expw                      (1) | Val  Loss: 1.0724 | Val  Acc: 0.6140
 Site-expw                      (1) | Val  Loss: 1.1050 | Val  Acc: 0.5814
 Site-expw                      (1) | Val  Loss: 1.0021 | Val  Acc: 0.5194
 Site-expw                      (1) | Val  Loss: 1.1209 | Val  Acc: 0.4093
 Site-FERG_DB_256               (2) | Val  Loss: 1.2900 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.2590 | Val  Acc: 0.6939
 Site-FERG_DB_256               (2) | Val  Loss: 1.3168 | Val  Acc: 0.6824
 Site-jpWoman                   (0) | Val  Loss: 2.0739 | Val  Acc: 0.1250
 Site-jpWoman                   (0) | Val  Loss: 1.9445 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.8122 | Val  Acc: 0.3824
Average Valid Accuracy: 0.4966
 Test site-expw                      (1)| Epoch:41 | Test Acc: 0.3623
 Test site-FERG_DB_256               (2)| Epoch:41 | Test Acc: 0.5181
 Test site-jpWoman                   (0)| Epoch:41 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:41 | Test Acc: 0.2670
expw: 0.3623, FERG_DB_256: 0.5181, jpWoman: 0.2644, FER: 0.2670, 
Average Test Accuracy(group): 0.3529, Average Test Accuracy(individual): 0.3783,
domain std=0.1032, cluster std=0.1032, individual std=0.0945, 
Average Test Accuracy: 0.3529
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-expw                      (1) | Train Loss: 1.3123 | Train Acc: 0.3860
 Site-expw                      (1) | Train Loss: 1.1967 | Train Acc: 0.4767
 Site-expw                      (1) | Train Loss: 1.2749 | Train Acc: 0.3876
 Site-expw                      (1) | Train Loss: 1.1830 | Train Acc: 0.4456
 Site-expw                      (1) | Train Loss: 1.1143 | Train Acc: 0.5848
 Site-FERG_DB_256               (0) | Train Loss: 1.4541 | Train Acc: 0.5238
 Site-FERG_DB_256               (0) | Train Loss: 1.3666 | Train Acc: 0.5541
 Site-FERG_DB_256               (0) | Train Loss: 1.3232 | Train Acc: 0.6641
 Site-jpWoman                   (2) | Train Loss: 1.7720 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 1.8675 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.5749 | Train Acc: 0.4221
Average Train Accuracy: 0.4419
 Site-expw                      (1) | Val  Loss: 0.9946 | Val  Acc: 0.7105
 Site-expw                      (1) | Val  Loss: 1.0577 | Val  Acc: 0.6491
 Site-expw                      (1) | Val  Loss: 1.0760 | Val  Acc: 0.5581
 Site-expw                      (1) | Val  Loss: 0.9868 | Val  Acc: 0.5504
 Site-expw                      (1) | Val  Loss: 1.2542 | Val  Acc: 0.4352
 Site-FERG_DB_256               (0) | Val  Loss: 1.2209 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.3034 | Val  Acc: 0.6939
 Site-FERG_DB_256               (0) | Val  Loss: 1.2961 | Val  Acc: 0.6588
 Site-jpWoman                   (2) | Val  Loss: 1.7319 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.9360 | Val  Acc: 0.3125
 Site-FER                       (3) | Val  Loss: 1.8038 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5479
 Best site-expw                     (1)  | Epoch:43 | Val Acc: 0.7105
 Best site-expw                     (1)  | Epoch:43 | Val Acc: 0.6491
 Best site-expw                     (1)  | Epoch:43 | Val Acc: 0.5581
 Best site-expw                     (1)  | Epoch:43 | Val Acc: 0.5504
 Best site-expw                     (1)  | Epoch:43 | Val Acc: 0.4352
 Best site-FERG_DB_256              (0)  | Epoch:43 | Val Acc: 0.7500
 Best site-FERG_DB_256              (0)  | Epoch:43 | Val Acc: 0.6939
 Best site-FERG_DB_256              (0)  | Epoch:43 | Val Acc: 0.6588
 Best site-jpWoman                  (2)  | Epoch:43 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:43 | Val Acc: 0.3125
 Best site-FER                      (3)  | Epoch:43 | Val Acc: 0.3333
 Test site-expw                      (1)| Epoch:43 | Test Acc: 0.3736
 Test site-FERG_DB_256               (0)| Epoch:43 | Test Acc: 0.5507
 Test site-jpWoman                   (2)| Epoch:43 | Test Acc: 0.2184
 Test site-FER                       (3)| Epoch:43 | Test Acc: 0.2639
expw: 0.3736, FERG_DB_256: 0.5507, jpWoman: 0.2184, FER: 0.2639, 
Average Test Accuracy(group): 0.3517, Average Test Accuracy(individual): 0.3837,
domain std=0.1280, cluster std=0.1280, individual std=0.1180, 
Average Test Accuracy: 0.3517
============ Train epoch 44 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-expw                      (1) | Train Loss: 1.3153 | Train Acc: 0.3860
 Site-expw                      (1) | Train Loss: 1.3112 | Train Acc: 0.4535
 Site-expw                      (1) | Train Loss: 1.1857 | Train Acc: 0.3876
 Site-expw                      (1) | Train Loss: 1.0151 | Train Acc: 0.4922
 Site-expw                      (1) | Train Loss: 1.0927 | Train Acc: 0.6021
 Site-FERG_DB_256               (2) | Train Loss: 1.4250 | Train Acc: 0.5238
 Site-FERG_DB_256               (2) | Train Loss: 1.3159 | Train Acc: 0.6081
 Site-FERG_DB_256               (2) | Train Loss: 1.3446 | Train Acc: 0.6953
 Site-jpWoman                   (0) | Train Loss: 1.8701 | Train Acc: 0.3333
 Site-jpWoman                   (0) | Train Loss: 1.8628 | Train Acc: 0.1250
 Site-FER                       (3) | Train Loss: 1.5456 | Train Acc: 0.4805
Average Train Accuracy: 0.4625
 Site-expw                      (1) | Val  Loss: 0.9835 | Val  Acc: 0.6579
 Site-expw                      (1) | Val  Loss: 1.0574 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.0532 | Val  Acc: 0.6047
 Site-expw                      (1) | Val  Loss: 0.9502 | Val  Acc: 0.5426
 Site-expw                      (1) | Val  Loss: 1.2533 | Val  Acc: 0.4352
 Site-FERG_DB_256               (2) | Val  Loss: 1.3379 | Val  Acc: 0.6071
 Site-FERG_DB_256               (2) | Val  Loss: 1.2388 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.3031 | Val  Acc: 0.6118
 Site-jpWoman                   (0) | Val  Loss: 1.7285 | Val  Acc: 0.1250
 Site-jpWoman                   (0) | Val  Loss: 1.9759 | Val  Acc: 0.0625
 Site-FER                       (3) | Val  Loss: 1.7801 | Val  Acc: 0.3824
Average Valid Accuracy: 0.4839
 Test site-expw                      (1)| Epoch:43 | Test Acc: 0.3781
 Test site-FERG_DB_256               (2)| Epoch:43 | Test Acc: 0.5453
 Test site-jpWoman                   (0)| Epoch:43 | Test Acc: 0.2529
 Test site-FER                       (3)| Epoch:43 | Test Acc: 0.2624
expw: 0.3781, FERG_DB_256: 0.5453, jpWoman: 0.2529, FER: 0.2624, 
Average Test Accuracy(group): 0.3597, Average Test Accuracy(individual): 0.3904,
domain std=0.1180, cluster std=0.1180, individual std=0.1074, 
Average Test Accuracy: 0.3597
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-expw                      (0) | Train Loss: 1.3495 | Train Acc: 0.3509
 Site-expw                      (0) | Train Loss: 1.3602 | Train Acc: 0.4651
 Site-expw                      (0) | Train Loss: 1.4068 | Train Acc: 0.4651
 Site-expw                      (0) | Train Loss: 1.1079 | Train Acc: 0.4767
 Site-expw                      (0) | Train Loss: 1.0488 | Train Acc: 0.6263
 Site-FERG_DB_256               (1) | Train Loss: 1.4278 | Train Acc: 0.5238
 Site-FERG_DB_256               (1) | Train Loss: 1.2810 | Train Acc: 0.6216
 Site-FERG_DB_256               (1) | Train Loss: 1.3238 | Train Acc: 0.6719
 Site-jpWoman                   (2) | Train Loss: 1.9342 | Train Acc: 0.3333
 Site-jpWoman                   (2) | Train Loss: 1.9378 | Train Acc: 0.1250
 Site-FER                       (3) | Train Loss: 1.5115 | Train Acc: 0.4156
Average Train Accuracy: 0.4614
 Site-expw                      (0) | Val  Loss: 0.9478 | Val  Acc: 0.6842
 Site-expw                      (0) | Val  Loss: 1.0491 | Val  Acc: 0.5965
 Site-expw                      (0) | Val  Loss: 1.0512 | Val  Acc: 0.6163
 Site-expw                      (0) | Val  Loss: 0.9781 | Val  Acc: 0.4884
 Site-expw                      (0) | Val  Loss: 1.2372 | Val  Acc: 0.4352
 Site-FERG_DB_256               (1) | Val  Loss: 1.1685 | Val  Acc: 0.7857
 Site-FERG_DB_256               (1) | Val  Loss: 1.2758 | Val  Acc: 0.6939
 Site-FERG_DB_256               (1) | Val  Loss: 1.2806 | Val  Acc: 0.6353
 Site-jpWoman                   (2) | Val  Loss: 1.8054 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.9698 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.7560 | Val  Acc: 0.3627
Average Valid Accuracy: 0.5271
 Test site-expw                      (0)| Epoch:44 | Test Acc: 0.3612
 Test site-FERG_DB_256               (1)| Epoch:44 | Test Acc: 0.5344
 Test site-jpWoman                   (2)| Epoch:44 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:44 | Test Acc: 0.2677
expw: 0.3612, FERG_DB_256: 0.5344, jpWoman: 0.2644, FER: 0.2677, 
Average Test Accuracy(group): 0.3569, Average Test Accuracy(individual): 0.3823,
domain std=0.1096, cluster std=0.1096, individual std=0.1012, 
Average Test Accuracy: 0.3569
============ Train epoch 46 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-expw                      (0) | Train Loss: 1.3519 | Train Acc: 0.3509
 Site-expw                      (0) | Train Loss: 1.3726 | Train Acc: 0.4884
 Site-expw                      (0) | Train Loss: 1.2761 | Train Acc: 0.4419
 Site-expw                      (0) | Train Loss: 1.2971 | Train Acc: 0.4974
 Site-expw                      (0) | Train Loss: 1.0651 | Train Acc: 0.6090
 Site-FERG_DB_256               (1) | Train Loss: 1.4626 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.3778 | Train Acc: 0.5541
 Site-FERG_DB_256               (1) | Train Loss: 1.2887 | Train Acc: 0.7031
 Site-jpWoman                   (2) | Train Loss: 1.8545 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 1.7808 | Train Acc: 0.2917
 Site-FER                       (3) | Train Loss: 1.5561 | Train Acc: 0.4221
Average Train Accuracy: 0.4644
 Site-expw                      (0) | Val  Loss: 0.9358 | Val  Acc: 0.6579
 Site-expw                      (0) | Val  Loss: 1.0266 | Val  Acc: 0.6491
 Site-expw                      (0) | Val  Loss: 1.0546 | Val  Acc: 0.5698
 Site-expw                      (0) | Val  Loss: 0.9420 | Val  Acc: 0.4884
 Site-expw                      (0) | Val  Loss: 1.1773 | Val  Acc: 0.4611
 Site-FERG_DB_256               (1) | Val  Loss: 1.1866 | Val  Acc: 0.7857
 Site-FERG_DB_256               (1) | Val  Loss: 1.1908 | Val  Acc: 0.7959
 Site-FERG_DB_256               (1) | Val  Loss: 1.3044 | Val  Acc: 0.7059
 Site-jpWoman                   (2) | Val  Loss: 1.8870 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8984 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.7650 | Val  Acc: 0.3922
Average Valid Accuracy: 0.5517
 Best site-expw                     (0)  | Epoch:46 | Val Acc: 0.6579
 Best site-expw                     (0)  | Epoch:46 | Val Acc: 0.6491
 Best site-expw                     (0)  | Epoch:46 | Val Acc: 0.5698
 Best site-expw                     (0)  | Epoch:46 | Val Acc: 0.4884
 Best site-expw                     (0)  | Epoch:46 | Val Acc: 0.4611
 Best site-FERG_DB_256              (1)  | Epoch:46 | Val Acc: 0.7857
 Best site-FERG_DB_256              (1)  | Epoch:46 | Val Acc: 0.7959
 Best site-FERG_DB_256              (1)  | Epoch:46 | Val Acc: 0.7059
 Best site-jpWoman                  (2)  | Epoch:46 | Val Acc: 0.3750
 Best site-jpWoman                  (2)  | Epoch:46 | Val Acc: 0.1875
 Best site-FER                      (3)  | Epoch:46 | Val Acc: 0.3922
 Test site-expw                      (0)| Epoch:46 | Test Acc: 0.3589
 Test site-FERG_DB_256               (1)| Epoch:46 | Test Acc: 0.5272
 Test site-jpWoman                   (2)| Epoch:46 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:46 | Test Acc: 0.2677
expw: 0.3589, FERG_DB_256: 0.5272, jpWoman: 0.2644, FER: 0.2677, 
Average Test Accuracy(group): 0.3545, Average Test Accuracy(individual): 0.3793,
domain std=0.1066, cluster std=0.1066, individual std=0.0984, 
Average Test Accuracy: 0.3545
============ Train epoch 47 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-expw                      (1) | Train Loss: 1.3777 | Train Acc: 0.2982
 Site-expw                      (1) | Train Loss: 1.2796 | Train Acc: 0.4070
 Site-expw                      (1) | Train Loss: 1.2387 | Train Acc: 0.4496
 Site-expw                      (1) | Train Loss: 1.3352 | Train Acc: 0.4611
 Site-expw                      (1) | Train Loss: 1.0676 | Train Acc: 0.6194
 Site-FERG_DB_256               (2) | Train Loss: 1.4319 | Train Acc: 0.3571
 Site-FERG_DB_256               (2) | Train Loss: 1.2516 | Train Acc: 0.5811
 Site-FERG_DB_256               (2) | Train Loss: 1.2860 | Train Acc: 0.7188
 Site-jpWoman                   (0) | Train Loss: 1.7783 | Train Acc: 0.4167
 Site-jpWoman                   (0) | Train Loss: 1.9577 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.5182 | Train Acc: 0.4545
Average Train Accuracy: 0.4482
 Site-expw                      (1) | Val  Loss: 1.0248 | Val  Acc: 0.6842
 Site-expw                      (1) | Val  Loss: 0.9797 | Val  Acc: 0.6842
 Site-expw                      (1) | Val  Loss: 1.1002 | Val  Acc: 0.5930
 Site-expw                      (1) | Val  Loss: 1.0473 | Val  Acc: 0.4651
 Site-expw                      (1) | Val  Loss: 1.1773 | Val  Acc: 0.4404
 Site-FERG_DB_256               (2) | Val  Loss: 1.2548 | Val  Acc: 0.7143
 Site-FERG_DB_256               (2) | Val  Loss: 1.2079 | Val  Acc: 0.7755
 Site-FERG_DB_256               (2) | Val  Loss: 1.2962 | Val  Acc: 0.6353
 Site-jpWoman                   (0) | Val  Loss: 1.7939 | Val  Acc: 0.5000
 Site-jpWoman                   (0) | Val  Loss: 1.8966 | Val  Acc: 0.1250
 Site-FER                       (3) | Val  Loss: 1.8044 | Val  Acc: 0.3431
Average Valid Accuracy: 0.5418
 Test site-expw                      (1)| Epoch:46 | Test Acc: 0.3544
 Test site-FERG_DB_256               (2)| Epoch:46 | Test Acc: 0.5344
 Test site-jpWoman                   (0)| Epoch:46 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:46 | Test Acc: 0.2769
expw: 0.3544, FERG_DB_256: 0.5344, jpWoman: 0.2644, FER: 0.2769, 
Average Test Accuracy(group): 0.3575, Average Test Accuracy(individual): 0.3801,
domain std=0.1078, cluster std=0.1078, individual std=0.1010, 
Average Test Accuracy: 0.3575
============ Train epoch 48 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-expw                      (0) | Train Loss: 1.3007 | Train Acc: 0.4211
 Site-expw                      (0) | Train Loss: 1.3257 | Train Acc: 0.4767
 Site-expw                      (0) | Train Loss: 1.0284 | Train Acc: 0.4264
 Site-expw                      (0) | Train Loss: 1.2712 | Train Acc: 0.4715
 Site-expw                      (0) | Train Loss: 1.0471 | Train Acc: 0.6298
 Site-FERG_DB_256               (1) | Train Loss: 1.3882 | Train Acc: 0.5476
 Site-FERG_DB_256               (1) | Train Loss: 1.2656 | Train Acc: 0.5946
 Site-FERG_DB_256               (1) | Train Loss: 1.2816 | Train Acc: 0.6641
 Site-jpWoman                   (2) | Train Loss: 1.9475 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 1.9457 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.5589 | Train Acc: 0.4610
Average Train Accuracy: 0.4645
 Site-expw                      (0) | Val  Loss: 0.9510 | Val  Acc: 0.6053
 Site-expw                      (0) | Val  Loss: 1.0046 | Val  Acc: 0.6491
 Site-expw                      (0) | Val  Loss: 1.0428 | Val  Acc: 0.5930
 Site-expw                      (0) | Val  Loss: 0.9973 | Val  Acc: 0.5504
 Site-expw                      (0) | Val  Loss: 1.2502 | Val  Acc: 0.4352
 Site-FERG_DB_256               (1) | Val  Loss: 1.2210 | Val  Acc: 0.6786
 Site-FERG_DB_256               (1) | Val  Loss: 1.2389 | Val  Acc: 0.6939
 Site-FERG_DB_256               (1) | Val  Loss: 1.2278 | Val  Acc: 0.6706
 Site-jpWoman                   (2) | Val  Loss: 1.5433 | Val  Acc: 0.3750
 Site-jpWoman                   (2) | Val  Loss: 1.8612 | Val  Acc: 0.1875
 Site-FER                       (3) | Val  Loss: 1.7798 | Val  Acc: 0.4020
Average Valid Accuracy: 0.5310
 Test site-expw                      (0)| Epoch:46 | Test Acc: 0.3510
 Test site-FERG_DB_256               (1)| Epoch:46 | Test Acc: 0.5471
 Test site-jpWoman                   (2)| Epoch:46 | Test Acc: 0.2644
 Test site-FER                       (3)| Epoch:46 | Test Acc: 0.2777
expw: 0.3510, FERG_DB_256: 0.5471, jpWoman: 0.2644, FER: 0.2777, 
Average Test Accuracy(group): 0.3600, Average Test Accuracy(individual): 0.3821,
domain std=0.1129, cluster std=0.1129, individual std=0.1067, 
Average Test Accuracy: 0.3600
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-expw                      (1) | Train Loss: 1.3969 | Train Acc: 0.4035
 Site-expw                      (1) | Train Loss: 1.3155 | Train Acc: 0.4535
 Site-expw                      (1) | Train Loss: 1.2267 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.4208 | Train Acc: 0.5026
 Site-expw                      (1) | Train Loss: 1.0491 | Train Acc: 0.6678
 Site-FERG_DB_256               (2) | Train Loss: 1.4119 | Train Acc: 0.4524
 Site-FERG_DB_256               (2) | Train Loss: 1.2424 | Train Acc: 0.6351
 Site-FERG_DB_256               (2) | Train Loss: 1.2903 | Train Acc: 0.6641
 Site-jpWoman                   (0) | Train Loss: 1.8908 | Train Acc: 0.2500
 Site-jpWoman                   (0) | Train Loss: 1.9432 | Train Acc: 0.1667
 Site-FER                       (3) | Train Loss: 1.4956 | Train Acc: 0.4805
Average Train Accuracy: 0.4610
 Site-expw                      (1) | Val  Loss: 0.9584 | Val  Acc: 0.7105
 Site-expw                      (1) | Val  Loss: 1.0050 | Val  Acc: 0.5789
 Site-expw                      (1) | Val  Loss: 1.0847 | Val  Acc: 0.6047
 Site-expw                      (1) | Val  Loss: 0.9853 | Val  Acc: 0.5426
 Site-expw                      (1) | Val  Loss: 1.1974 | Val  Acc: 0.4249
 Site-FERG_DB_256               (2) | Val  Loss: 1.2402 | Val  Acc: 0.6786
 Site-FERG_DB_256               (2) | Val  Loss: 1.1705 | Val  Acc: 0.7551
 Site-FERG_DB_256               (2) | Val  Loss: 1.2774 | Val  Acc: 0.6353
 Site-jpWoman                   (0) | Val  Loss: 1.7183 | Val  Acc: 0.3750
 Site-jpWoman                   (0) | Val  Loss: 1.9515 | Val  Acc: 0.2500
 Site-FER                       (3) | Val  Loss: 1.8073 | Val  Acc: 0.3627
Average Valid Accuracy: 0.5380
 Test site-expw                      (1)| Epoch:48 | Test Acc: 0.3600
 Test site-FERG_DB_256               (2)| Epoch:48 | Test Acc: 0.5380
 Test site-jpWoman                   (0)| Epoch:48 | Test Acc: 0.2759
 Test site-FER                       (3)| Epoch:48 | Test Acc: 0.2708
expw: 0.3600, FERG_DB_256: 0.5380, jpWoman: 0.2759, FER: 0.2708, 
Average Test Accuracy(group): 0.3612, Average Test Accuracy(individual): 0.3852,
domain std=0.1081, cluster std=0.1081, individual std=0.1001, 
Average Test Accuracy: 0.3612
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
===2023-08-09 05:43:33===
===2023-08-09 05:43:40===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[57,86,129,193,289,42,74,128,12,24,154,
client_nums=[5,3,2,1,]
len_dataset=[2529,821,126,514,]
domain number = 4
Loading snapshots...
 Test site-expw                      (1)| Epoch:49 | Test Acc: 0.3600
 Test site-FERG_DB_256               (2)| Epoch:49 | Test Acc: 0.5380
 Test site-jpWoman                   (0)| Epoch:49 | Test Acc: 0.2759
 Test site-FER                       (3)| Epoch:49 | Test Acc: 0.2708
expw: 0.3600, FERG_DB_256: 0.5380, jpWoman: 0.2759, FER: 0.2708, 
Average Test Accuracy(group): 0.3612, Average Test Accuracy(individual): 0.3852,
domain std=0.1081, cluster std=0.1081, individual std=0.1001, 
===2023-08-09 11:19:54===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[18,28,42,62,94,25,43,75,28,56,37,
client_nums=[5,3,2,1,]
len_dataset=[821,482,284,126,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-FERG_DB_256               (1) | Train Loss: 2.0156 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.9453 | Train Acc: 0.1786
 Site-FERG_DB_256               (1) | Train Loss: 1.9283 | Train Acc: 0.1190
 Site-FERG_DB_256               (1) | Train Loss: 1.9789 | Train Acc: 0.1290
 Site-FERG_DB_256               (1) | Train Loss: 1.9541 | Train Acc: 0.2021
 Site-expw                      (0) | Train Loss: 1.7660 | Train Acc: 0.4000
 Site-expw                      (0) | Train Loss: 1.8160 | Train Acc: 0.3023
 Site-expw                      (0) | Train Loss: 1.9212 | Train Acc: 0.2000
 Site-FER                       (2) | Train Loss: 2.0262 | Train Acc: 0.1429
 Site-FER                       (2) | Train Loss: 1.9515 | Train Acc: 0.1607
 Site-jpWoman                   (3) | Train Loss: 2.0305 | Train Acc: 0.0811
Average Train Accuracy: 0.1893
 Site-FERG_DB_256               (1) | Val  Loss: 1.9266 | Val  Acc: 0.0833
 Site-FERG_DB_256               (1) | Val  Loss: 1.9231 | Val  Acc: 0.1667
 Site-FERG_DB_256               (1) | Val  Loss: 1.9881 | Val  Acc: 0.1071
 Site-FERG_DB_256               (1) | Val  Loss: 2.0307 | Val  Acc: 0.0976
 Site-FERG_DB_256               (1) | Val  Loss: 1.9475 | Val  Acc: 0.1290
 Site-expw                      (0) | Val  Loss: 1.9175 | Val  Acc: 0.1875
 Site-expw                      (0) | Val  Loss: 1.9345 | Val  Acc: 0.2069
 Site-expw                      (0) | Val  Loss: 1.8171 | Val  Acc: 0.2200
 Site-FER                       (2) | Val  Loss: 1.9530 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.9707 | Val  Acc: 0.1622
 Site-jpWoman                   (3) | Val  Loss: 1.9270 | Val  Acc: 0.1200
Average Valid Accuracy: 0.1447
 Best site-FERG_DB_256              (1)  | Epoch:0 | Val Acc: 0.0833
 Best site-FERG_DB_256              (1)  | Epoch:0 | Val Acc: 0.1667
 Best site-FERG_DB_256              (1)  | Epoch:0 | Val Acc: 0.1071
 Best site-FERG_DB_256              (1)  | Epoch:0 | Val Acc: 0.0976
 Best site-FERG_DB_256              (1)  | Epoch:0 | Val Acc: 0.1290
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.1875
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2069
 Best site-expw                     (0)  | Epoch:0 | Val Acc: 0.2200
 Best site-FER                      (2)  | Epoch:0 | Val Acc: 0.1111
 Best site-FER                      (2)  | Epoch:0 | Val Acc: 0.1622
 Best site-jpWoman                  (3)  | Epoch:0 | Val Acc: 0.1200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 1 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-FERG_DB_256               (1) | Train Loss: 1.9448 | Train Acc: 0.1111
 Site-FERG_DB_256               (1) | Train Loss: 1.9470 | Train Acc: 0.2143
 Site-FERG_DB_256               (1) | Train Loss: 1.9557 | Train Acc: 0.1429
 Site-FERG_DB_256               (1) | Train Loss: 1.9019 | Train Acc: 0.2581
 Site-FERG_DB_256               (1) | Train Loss: 1.9216 | Train Acc: 0.2340
 Site-expw                      (0) | Train Loss: 1.8470 | Train Acc: 0.2400
 Site-expw                      (0) | Train Loss: 1.8954 | Train Acc: 0.1395
 Site-expw                      (0) | Train Loss: 1.9698 | Train Acc: 0.1600
 Site-FER                       (2) | Train Loss: 1.9726 | Train Acc: 0.2143
 Site-FER                       (2) | Train Loss: 1.9513 | Train Acc: 0.1429
 Site-jpWoman                   (3) | Train Loss: 1.9425 | Train Acc: 0.1081
Average Train Accuracy: 0.1786
 Site-FERG_DB_256               (1) | Val  Loss: 1.7618 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.8907 | Val  Acc: 0.2778
 Site-FERG_DB_256               (1) | Val  Loss: 1.9394 | Val  Acc: 0.1786
 Site-FERG_DB_256               (1) | Val  Loss: 1.9520 | Val  Acc: 0.1707
 Site-FERG_DB_256               (1) | Val  Loss: 1.9263 | Val  Acc: 0.1935
 Site-expw                      (0) | Val  Loss: 1.9034 | Val  Acc: 0.2500
 Site-expw                      (0) | Val  Loss: 1.9197 | Val  Acc: 0.1034
 Site-expw                      (0) | Val  Loss: 1.8683 | Val  Acc: 0.2600
 Site-FER                       (2) | Val  Loss: 1.8394 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.9505 | Val  Acc: 0.2162
 Site-jpWoman                   (3) | Val  Loss: 1.9752 | Val  Acc: 0.1600
Average Valid Accuracy: 0.2201
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.2778
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1786
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1707
 Best site-FERG_DB_256              (1)  | Epoch:1 | Val Acc: 0.1935
 Best site-expw                     (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-expw                     (0)  | Epoch:1 | Val Acc: 0.1034
 Best site-expw                     (0)  | Epoch:1 | Val Acc: 0.2600
 Best site-FER                      (2)  | Epoch:1 | Val Acc: 0.1111
 Best site-FER                      (2)  | Epoch:1 | Val Acc: 0.2162
 Best site-jpWoman                  (3)  | Epoch:1 | Val Acc: 0.1600
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-FERG_DB_256               (1) | Train Loss: 1.9794 | Train Acc: 0.1111
 Site-FERG_DB_256               (1) | Train Loss: 1.9192 | Train Acc: 0.3214
 Site-FERG_DB_256               (1) | Train Loss: 1.8915 | Train Acc: 0.1429
 Site-FERG_DB_256               (1) | Train Loss: 1.9277 | Train Acc: 0.1774
 Site-FERG_DB_256               (1) | Train Loss: 1.9122 | Train Acc: 0.2447
 Site-expw                      (2) | Train Loss: 1.7664 | Train Acc: 0.3600
 Site-expw                      (2) | Train Loss: 1.7357 | Train Acc: 0.3256
 Site-expw                      (2) | Train Loss: 1.9258 | Train Acc: 0.1600
 Site-FER                       (0) | Train Loss: 1.9546 | Train Acc: 0.1429
 Site-FER                       (0) | Train Loss: 1.9857 | Train Acc: 0.1429
 Site-jpWoman                   (3) | Train Loss: 1.9640 | Train Acc: 0.1892
Average Train Accuracy: 0.2107
 Site-FERG_DB_256               (1) | Val  Loss: 1.8270 | Val  Acc: 0.2500
 Site-FERG_DB_256               (1) | Val  Loss: 1.8795 | Val  Acc: 0.2778
 Site-FERG_DB_256               (1) | Val  Loss: 1.9321 | Val  Acc: 0.2143
 Site-FERG_DB_256               (1) | Val  Loss: 1.9514 | Val  Acc: 0.1707
 Site-FERG_DB_256               (1) | Val  Loss: 1.9086 | Val  Acc: 0.1290
 Site-expw                      (2) | Val  Loss: 1.9541 | Val  Acc: 0.0625
 Site-expw                      (2) | Val  Loss: 1.8561 | Val  Acc: 0.1379
 Site-expw                      (2) | Val  Loss: 1.7987 | Val  Acc: 0.2400
 Site-FER                       (0) | Val  Loss: 1.9423 | Val  Acc: 0.2222
 Site-FER                       (0) | Val  Loss: 1.9729 | Val  Acc: 0.0811
 Site-jpWoman                   (3) | Val  Loss: 1.9484 | Val  Acc: 0.1600
Average Valid Accuracy: 0.1769
============ Train epoch 3 ============
cnt=[3, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-FERG_DB_256               (1) | Train Loss: 1.9116 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.9243 | Train Acc: 0.2500
 Site-FERG_DB_256               (1) | Train Loss: 1.9121 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.9038 | Train Acc: 0.2097
 Site-FERG_DB_256               (1) | Train Loss: 1.8843 | Train Acc: 0.2234
 Site-expw                      (0) | Train Loss: 1.7524 | Train Acc: 0.2800
 Site-expw                      (0) | Train Loss: 1.7541 | Train Acc: 0.3488
 Site-expw                      (0) | Train Loss: 1.8449 | Train Acc: 0.2000
 Site-FER                       (3) | Train Loss: 1.9034 | Train Acc: 0.2143
 Site-FER                       (3) | Train Loss: 2.0110 | Train Acc: 0.1250
 Site-jpWoman                   (2) | Train Loss: 1.9699 | Train Acc: 0.1081
Average Train Accuracy: 0.2084
 Site-FERG_DB_256               (1) | Val  Loss: 1.8541 | Val  Acc: 0.3333
 Site-FERG_DB_256               (1) | Val  Loss: 1.9401 | Val  Acc: 0.1667
 Site-FERG_DB_256               (1) | Val  Loss: 1.9493 | Val  Acc: 0.1786
 Site-FERG_DB_256               (1) | Val  Loss: 1.9646 | Val  Acc: 0.1463
 Site-FERG_DB_256               (1) | Val  Loss: 1.8667 | Val  Acc: 0.1935
 Site-expw                      (0) | Val  Loss: 1.8229 | Val  Acc: 0.1250
 Site-expw                      (0) | Val  Loss: 1.8439 | Val  Acc: 0.1379
 Site-expw                      (0) | Val  Loss: 1.7607 | Val  Acc: 0.3200
 Site-FER                       (3) | Val  Loss: 1.9034 | Val  Acc: 0.2222
 Site-FER                       (3) | Val  Loss: 1.9091 | Val  Acc: 0.2432
 Site-jpWoman                   (2) | Val  Loss: 1.9988 | Val  Acc: 0.1200
Average Valid Accuracy: 0.1988
============ Train epoch 4 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-FERG_DB_256               (1) | Train Loss: 1.9019 | Train Acc: 0.2222
 Site-FERG_DB_256               (1) | Train Loss: 1.9550 | Train Acc: 0.1429
 Site-FERG_DB_256               (1) | Train Loss: 1.9085 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.8984 | Train Acc: 0.1935
 Site-FERG_DB_256               (1) | Train Loss: 1.8645 | Train Acc: 0.2872
 Site-expw                      (0) | Train Loss: 1.7272 | Train Acc: 0.4000
 Site-expw                      (0) | Train Loss: 1.7178 | Train Acc: 0.2791
 Site-expw                      (0) | Train Loss: 1.7557 | Train Acc: 0.2267
 Site-FER                       (2) | Train Loss: 1.9229 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.9483 | Train Acc: 0.1964
 Site-jpWoman                   (3) | Train Loss: 1.9190 | Train Acc: 0.2432
Average Train Accuracy: 0.2371
 Site-FERG_DB_256               (1) | Val  Loss: 1.9167 | Val  Acc: 0.3333
 Site-FERG_DB_256               (1) | Val  Loss: 1.8334 | Val  Acc: 0.2778
 Site-FERG_DB_256               (1) | Val  Loss: 1.9331 | Val  Acc: 0.2857
 Site-FERG_DB_256               (1) | Val  Loss: 1.9784 | Val  Acc: 0.1220
 Site-FERG_DB_256               (1) | Val  Loss: 1.8919 | Val  Acc: 0.1774
 Site-expw                      (0) | Val  Loss: 1.8885 | Val  Acc: 0.0625
 Site-expw                      (0) | Val  Loss: 1.8843 | Val  Acc: 0.0690
 Site-expw                      (0) | Val  Loss: 1.7754 | Val  Acc: 0.2200
 Site-FER                       (2) | Val  Loss: 1.9300 | Val  Acc: 0.1667
 Site-FER                       (2) | Val  Loss: 1.9626 | Val  Acc: 0.1351
 Site-jpWoman                   (3) | Val  Loss: 1.9426 | Val  Acc: 0.1600
Average Valid Accuracy: 0.1827
============ Train epoch 5 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-FERG_DB_256               (0) | Train Loss: 1.8971 | Train Acc: 0.2222
 Site-FERG_DB_256               (0) | Train Loss: 1.9106 | Train Acc: 0.3214
 Site-FERG_DB_256               (0) | Train Loss: 1.8743 | Train Acc: 0.1667
 Site-FERG_DB_256               (0) | Train Loss: 1.8519 | Train Acc: 0.3226
 Site-FERG_DB_256               (0) | Train Loss: 1.8819 | Train Acc: 0.2021
 Site-expw                      (1) | Train Loss: 1.8186 | Train Acc: 0.3600
 Site-expw                      (1) | Train Loss: 1.7372 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.8299 | Train Acc: 0.2000
 Site-FER                       (3) | Train Loss: 1.9809 | Train Acc: 0.1429
 Site-FER                       (3) | Train Loss: 1.9807 | Train Acc: 0.1607
 Site-jpWoman                   (2) | Train Loss: 1.9224 | Train Acc: 0.1892
Average Train Accuracy: 0.2397
 Site-FERG_DB_256               (0) | Val  Loss: 1.8334 | Val  Acc: 0.1667
 Site-FERG_DB_256               (0) | Val  Loss: 1.8557 | Val  Acc: 0.2778
 Site-FERG_DB_256               (0) | Val  Loss: 1.8798 | Val  Acc: 0.2500
 Site-FERG_DB_256               (0) | Val  Loss: 1.9360 | Val  Acc: 0.1951
 Site-FERG_DB_256               (0) | Val  Loss: 1.8900 | Val  Acc: 0.1935
 Site-expw                      (1) | Val  Loss: 1.8489 | Val  Acc: 0.1875
 Site-expw                      (1) | Val  Loss: 1.8534 | Val  Acc: 0.0690
 Site-expw                      (1) | Val  Loss: 1.7704 | Val  Acc: 0.2200
 Site-FER                       (3) | Val  Loss: 1.9479 | Val  Acc: 0.2778
 Site-FER                       (3) | Val  Loss: 1.9573 | Val  Acc: 0.1081
 Site-jpWoman                   (2) | Val  Loss: 1.9012 | Val  Acc: 0.2400
Average Valid Accuracy: 0.1987
============ Train epoch 6 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-FERG_DB_256               (1) | Train Loss: 1.8731 | Train Acc: 0.2778
 Site-FERG_DB_256               (1) | Train Loss: 1.8253 | Train Acc: 0.3214
 Site-FERG_DB_256               (1) | Train Loss: 1.8481 | Train Acc: 0.2143
 Site-FERG_DB_256               (1) | Train Loss: 1.9057 | Train Acc: 0.2742
 Site-FERG_DB_256               (1) | Train Loss: 1.8721 | Train Acc: 0.2660
 Site-expw                      (0) | Train Loss: 1.8206 | Train Acc: 0.3200
 Site-expw                      (0) | Train Loss: 1.7882 | Train Acc: 0.3023
 Site-expw                      (0) | Train Loss: 1.7875 | Train Acc: 0.1333
 Site-FER                       (2) | Train Loss: 1.9359 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.9413 | Train Acc: 0.2143
 Site-jpWoman                   (3) | Train Loss: 1.8774 | Train Acc: 0.1622
Average Train Accuracy: 0.2487
 Site-FERG_DB_256               (1) | Val  Loss: 1.8493 | Val  Acc: 0.2500
 Site-FERG_DB_256               (1) | Val  Loss: 1.8754 | Val  Acc: 0.3889
 Site-FERG_DB_256               (1) | Val  Loss: 1.8233 | Val  Acc: 0.3214
 Site-FERG_DB_256               (1) | Val  Loss: 1.8844 | Val  Acc: 0.2439
 Site-FERG_DB_256               (1) | Val  Loss: 1.8512 | Val  Acc: 0.2258
 Site-expw                      (0) | Val  Loss: 1.8502 | Val  Acc: 0.1875
 Site-expw                      (0) | Val  Loss: 1.8375 | Val  Acc: 0.1034
 Site-expw                      (0) | Val  Loss: 1.7688 | Val  Acc: 0.2600
 Site-FER                       (2) | Val  Loss: 1.8776 | Val  Acc: 0.2778
 Site-FER                       (2) | Val  Loss: 1.9864 | Val  Acc: 0.1081
 Site-jpWoman                   (3) | Val  Loss: 1.9131 | Val  Acc: 0.0800
Average Valid Accuracy: 0.2224
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.2500
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.3889
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.3214
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.2439
 Best site-FERG_DB_256              (1)  | Epoch:6 | Val Acc: 0.2258
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.1875
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.1034
 Best site-expw                     (0)  | Epoch:6 | Val Acc: 0.2600
 Best site-FER                      (2)  | Epoch:6 | Val Acc: 0.2778
 Best site-FER                      (2)  | Epoch:6 | Val Acc: 0.1081
 Best site-jpWoman                  (3)  | Epoch:6 | Val Acc: 0.0800
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 7 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-FERG_DB_256               (1) | Train Loss: 1.8736 | Train Acc: 0.2222
 Site-FERG_DB_256               (1) | Train Loss: 1.8900 | Train Acc: 0.2857
 Site-FERG_DB_256               (1) | Train Loss: 1.8909 | Train Acc: 0.1667
 Site-FERG_DB_256               (1) | Train Loss: 1.8276 | Train Acc: 0.3065
 Site-FERG_DB_256               (1) | Train Loss: 1.8585 | Train Acc: 0.2234
 Site-expw                      (0) | Train Loss: 1.7393 | Train Acc: 0.2400
 Site-expw                      (0) | Train Loss: 1.7182 | Train Acc: 0.2791
 Site-expw                      (0) | Train Loss: 1.7771 | Train Acc: 0.2533
 Site-FER                       (2) | Train Loss: 1.9641 | Train Acc: 0.1786
 Site-FER                       (2) | Train Loss: 1.9767 | Train Acc: 0.1786
 Site-jpWoman                   (3) | Train Loss: 1.9753 | Train Acc: 0.1351
Average Train Accuracy: 0.2245
 Site-FERG_DB_256               (1) | Val  Loss: 1.8034 | Val  Acc: 0.2500
 Site-FERG_DB_256               (1) | Val  Loss: 1.7710 | Val  Acc: 0.3889
 Site-FERG_DB_256               (1) | Val  Loss: 1.8267 | Val  Acc: 0.3571
 Site-FERG_DB_256               (1) | Val  Loss: 1.8817 | Val  Acc: 0.2195
 Site-FERG_DB_256               (1) | Val  Loss: 1.8228 | Val  Acc: 0.2903
 Site-expw                      (0) | Val  Loss: 1.7921 | Val  Acc: 0.2500
 Site-expw                      (0) | Val  Loss: 1.8150 | Val  Acc: 0.1034
 Site-expw                      (0) | Val  Loss: 1.7205 | Val  Acc: 0.3000
 Site-FER                       (2) | Val  Loss: 1.8841 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.9793 | Val  Acc: 0.1351
 Site-jpWoman                   (3) | Val  Loss: 1.9749 | Val  Acc: 0.1200
Average Valid Accuracy: 0.2498
 Best site-FERG_DB_256              (1)  | Epoch:7 | Val Acc: 0.2500
 Best site-FERG_DB_256              (1)  | Epoch:7 | Val Acc: 0.3889
 Best site-FERG_DB_256              (1)  | Epoch:7 | Val Acc: 0.3571
 Best site-FERG_DB_256              (1)  | Epoch:7 | Val Acc: 0.2195
 Best site-FERG_DB_256              (1)  | Epoch:7 | Val Acc: 0.2903
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.2500
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.1034
 Best site-expw                     (0)  | Epoch:7 | Val Acc: 0.3000
 Best site-FER                      (2)  | Epoch:7 | Val Acc: 0.3333
 Best site-FER                      (2)  | Epoch:7 | Val Acc: 0.1351
 Best site-jpWoman                  (3)  | Epoch:7 | Val Acc: 0.1200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-FERG_DB_256               (0) | Train Loss: 1.8654 | Train Acc: 0.2778
 Site-FERG_DB_256               (0) | Train Loss: 1.8268 | Train Acc: 0.3571
 Site-FERG_DB_256               (0) | Train Loss: 1.7944 | Train Acc: 0.2619
 Site-FERG_DB_256               (0) | Train Loss: 1.8224 | Train Acc: 0.3065
 Site-FERG_DB_256               (0) | Train Loss: 1.8018 | Train Acc: 0.3298
 Site-expw                      (1) | Train Loss: 1.7710 | Train Acc: 0.3200
 Site-expw                      (1) | Train Loss: 1.7523 | Train Acc: 0.2791
 Site-expw                      (1) | Train Loss: 1.8102 | Train Acc: 0.2267
 Site-FER                       (3) | Train Loss: 1.9808 | Train Acc: 0.2143
 Site-FER                       (3) | Train Loss: 1.9699 | Train Acc: 0.1786
 Site-jpWoman                   (2) | Train Loss: 1.9788 | Train Acc: 0.2162
Average Train Accuracy: 0.2698
 Site-FERG_DB_256               (0) | Val  Loss: 1.7677 | Val  Acc: 0.4167
 Site-FERG_DB_256               (0) | Val  Loss: 1.7079 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.8421 | Val  Acc: 0.2857
 Site-FERG_DB_256               (0) | Val  Loss: 1.8777 | Val  Acc: 0.2683
 Site-FERG_DB_256               (0) | Val  Loss: 1.8043 | Val  Acc: 0.4032
 Site-expw                      (1) | Val  Loss: 1.7182 | Val  Acc: 0.3125
 Site-expw                      (1) | Val  Loss: 1.8114 | Val  Acc: 0.2414
 Site-expw                      (1) | Val  Loss: 1.7353 | Val  Acc: 0.2400
 Site-FER                       (3) | Val  Loss: 1.9555 | Val  Acc: 0.1667
 Site-FER                       (3) | Val  Loss: 1.9662 | Val  Acc: 0.1892
 Site-jpWoman                   (2) | Val  Loss: 1.8968 | Val  Acc: 0.2400
Average Valid Accuracy: 0.2967
 Best site-FERG_DB_256              (0)  | Epoch:8 | Val Acc: 0.4167
 Best site-FERG_DB_256              (0)  | Epoch:8 | Val Acc: 0.5000
 Best site-FERG_DB_256              (0)  | Epoch:8 | Val Acc: 0.2857
 Best site-FERG_DB_256              (0)  | Epoch:8 | Val Acc: 0.2683
 Best site-FERG_DB_256              (0)  | Epoch:8 | Val Acc: 0.4032
 Best site-expw                     (1)  | Epoch:8 | Val Acc: 0.3125
 Best site-expw                     (1)  | Epoch:8 | Val Acc: 0.2414
 Best site-expw                     (1)  | Epoch:8 | Val Acc: 0.2400
 Best site-FER                      (3)  | Epoch:8 | Val Acc: 0.1667
 Best site-FER                      (3)  | Epoch:8 | Val Acc: 0.1892
 Best site-jpWoman                  (2)  | Epoch:8 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 3, 4, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-FERG_DB_256               (1) | Train Loss: 1.8336 | Train Acc: 0.4444
 Site-FERG_DB_256               (3) | Train Loss: 1.8660 | Train Acc: 0.3214
 Site-FERG_DB_256               (1) | Train Loss: 1.8132 | Train Acc: 0.3333
 Site-FERG_DB_256               (3) | Train Loss: 1.8047 | Train Acc: 0.3710
 Site-FERG_DB_256               (1) | Train Loss: 1.7828 | Train Acc: 0.3723
 Site-expw                      (2) | Train Loss: 1.7914 | Train Acc: 0.3200
 Site-expw                      (2) | Train Loss: 1.7489 | Train Acc: 0.3488
 Site-expw                      (2) | Train Loss: 1.7448 | Train Acc: 0.3067
 Site-FER                       (0) | Train Loss: 1.9660 | Train Acc: 0.1786
 Site-FER                       (0) | Train Loss: 1.9273 | Train Acc: 0.2143
 Site-jpWoman                   (2) | Train Loss: 1.9694 | Train Acc: 0.1892
Average Train Accuracy: 0.3091
 Site-FERG_DB_256               (1) | Val  Loss: 1.7816 | Val  Acc: 0.2500
 Site-FERG_DB_256               (3) | Val  Loss: 1.6890 | Val  Acc: 0.6111
 Site-FERG_DB_256               (1) | Val  Loss: 1.7308 | Val  Acc: 0.3929
 Site-FERG_DB_256               (3) | Val  Loss: 1.8571 | Val  Acc: 0.2195
 Site-FERG_DB_256               (1) | Val  Loss: 1.8212 | Val  Acc: 0.3226
 Site-expw                      (2) | Val  Loss: 1.8573 | Val  Acc: 0.0625
 Site-expw                      (2) | Val  Loss: 1.7447 | Val  Acc: 0.2759
 Site-expw                      (2) | Val  Loss: 1.7924 | Val  Acc: 0.2000
 Site-FER                       (0) | Val  Loss: 1.9183 | Val  Acc: 0.2778
 Site-FER                       (0) | Val  Loss: 1.9877 | Val  Acc: 0.1351
 Site-jpWoman                   (2) | Val  Loss: 1.9347 | Val  Acc: 0.0800
Average Valid Accuracy: 0.2570
============ Train epoch 10 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-FERG_DB_256               (1) | Train Loss: 1.7930 | Train Acc: 0.2222
 Site-FERG_DB_256               (1) | Train Loss: 1.7982 | Train Acc: 0.3929
 Site-FERG_DB_256               (1) | Train Loss: 1.7529 | Train Acc: 0.3095
 Site-FERG_DB_256               (1) | Train Loss: 1.7371 | Train Acc: 0.3871
 Site-FERG_DB_256               (1) | Train Loss: 1.7525 | Train Acc: 0.3298
 Site-expw                      (2) | Train Loss: 1.8028 | Train Acc: 0.1600
 Site-expw                      (2) | Train Loss: 1.7984 | Train Acc: 0.1860
 Site-expw                      (2) | Train Loss: 1.7878 | Train Acc: 0.2000
 Site-FER                       (0) | Train Loss: 1.8941 | Train Acc: 0.1786
 Site-FER                       (0) | Train Loss: 1.9501 | Train Acc: 0.1607
 Site-jpWoman                   (3) | Train Loss: 1.9040 | Train Acc: 0.1351
Average Train Accuracy: 0.2420
 Site-FERG_DB_256               (1) | Val  Loss: 1.6710 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.6955 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.7196 | Val  Acc: 0.4286
 Site-FERG_DB_256               (1) | Val  Loss: 1.8124 | Val  Acc: 0.2683
 Site-FERG_DB_256               (1) | Val  Loss: 1.7418 | Val  Acc: 0.3871
 Site-expw                      (2) | Val  Loss: 1.8129 | Val  Acc: 0.1875
 Site-expw                      (2) | Val  Loss: 1.8007 | Val  Acc: 0.1034
 Site-expw                      (2) | Val  Loss: 1.7714 | Val  Acc: 0.1600
 Site-FER                       (0) | Val  Loss: 1.9410 | Val  Acc: 0.2222
 Site-FER                       (0) | Val  Loss: 1.9195 | Val  Acc: 0.2703
 Site-jpWoman                   (3) | Val  Loss: 1.9621 | Val  Acc: 0.1600
Average Valid Accuracy: 0.3049
 Best site-FERG_DB_256              (1)  | Epoch:10 | Val Acc: 0.6667
 Best site-FERG_DB_256              (1)  | Epoch:10 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:10 | Val Acc: 0.4286
 Best site-FERG_DB_256              (1)  | Epoch:10 | Val Acc: 0.2683
 Best site-FERG_DB_256              (1)  | Epoch:10 | Val Acc: 0.3871
 Best site-expw                     (2)  | Epoch:10 | Val Acc: 0.1875
 Best site-expw                     (2)  | Epoch:10 | Val Acc: 0.1034
 Best site-expw                     (2)  | Epoch:10 | Val Acc: 0.1600
 Best site-FER                      (0)  | Epoch:10 | Val Acc: 0.2222
 Best site-FER                      (0)  | Epoch:10 | Val Acc: 0.2703
 Best site-jpWoman                  (3)  | Epoch:10 | Val Acc: 0.1600
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-FERG_DB_256               (1) | Train Loss: 1.7676 | Train Acc: 0.3889
 Site-FERG_DB_256               (1) | Train Loss: 1.8373 | Train Acc: 0.1786
 Site-FERG_DB_256               (1) | Train Loss: 1.6837 | Train Acc: 0.5238
 Site-FERG_DB_256               (1) | Train Loss: 1.7216 | Train Acc: 0.4194
 Site-FERG_DB_256               (1) | Train Loss: 1.7596 | Train Acc: 0.4255
 Site-expw                      (0) | Train Loss: 1.8207 | Train Acc: 0.2400
 Site-expw                      (0) | Train Loss: 1.7871 | Train Acc: 0.2093
 Site-expw                      (0) | Train Loss: 1.7845 | Train Acc: 0.2667
 Site-FER                       (2) | Train Loss: 1.8934 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.8624 | Train Acc: 0.3036
 Site-jpWoman                   (3) | Train Loss: 1.9586 | Train Acc: 0.1081
Average Train Accuracy: 0.3013
 Site-FERG_DB_256               (1) | Val  Loss: 1.6973 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.7143 | Val  Acc: 0.3333
 Site-FERG_DB_256               (1) | Val  Loss: 1.6771 | Val  Acc: 0.4643
 Site-FERG_DB_256               (1) | Val  Loss: 1.7750 | Val  Acc: 0.3659
 Site-FERG_DB_256               (1) | Val  Loss: 1.7837 | Val  Acc: 0.3710
 Site-expw                      (0) | Val  Loss: 1.7823 | Val  Acc: 0.1875
 Site-expw                      (0) | Val  Loss: 1.7247 | Val  Acc: 0.2759
 Site-expw                      (0) | Val  Loss: 1.7504 | Val  Acc: 0.2600
 Site-FER                       (2) | Val  Loss: 1.9736 | Val  Acc: 0.0556
 Site-FER                       (2) | Val  Loss: 1.9781 | Val  Acc: 0.1622
 Site-jpWoman                   (3) | Val  Loss: 1.9125 | Val  Acc: 0.1200
Average Valid Accuracy: 0.2814
============ Train epoch 12 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-FERG_DB_256               (1) | Train Loss: 1.7173 | Train Acc: 0.3333
 Site-FERG_DB_256               (1) | Train Loss: 1.6930 | Train Acc: 0.4286
 Site-FERG_DB_256               (1) | Train Loss: 1.6867 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.7184 | Train Acc: 0.4194
 Site-FERG_DB_256               (1) | Train Loss: 1.7159 | Train Acc: 0.3723
 Site-expw                      (2) | Train Loss: 1.8343 | Train Acc: 0.1600
 Site-expw                      (2) | Train Loss: 1.7543 | Train Acc: 0.2326
 Site-expw                      (2) | Train Loss: 1.7298 | Train Acc: 0.2800
 Site-FER                       (0) | Train Loss: 1.9766 | Train Acc: 0.2500
 Site-FER                       (0) | Train Loss: 1.9263 | Train Acc: 0.1250
 Site-jpWoman                   (3) | Train Loss: 1.9279 | Train Acc: 0.1622
Average Train Accuracy: 0.2967
 Site-FERG_DB_256               (1) | Val  Loss: 1.5818 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.6339 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.7373 | Val  Acc: 0.3571
 Site-FERG_DB_256               (1) | Val  Loss: 1.7067 | Val  Acc: 0.4390
 Site-FERG_DB_256               (1) | Val  Loss: 1.7294 | Val  Acc: 0.3871
 Site-expw                      (2) | Val  Loss: 1.6857 | Val  Acc: 0.1875
 Site-expw                      (2) | Val  Loss: 1.7732 | Val  Acc: 0.1379
 Site-expw                      (2) | Val  Loss: 1.7269 | Val  Acc: 0.2400
 Site-FER                       (0) | Val  Loss: 1.9695 | Val  Acc: 0.1667
 Site-FER                       (0) | Val  Loss: 1.9859 | Val  Acc: 0.2162
 Site-jpWoman                   (3) | Val  Loss: 1.9302 | Val  Acc: 0.1200
Average Valid Accuracy: 0.3107
 Best site-FERG_DB_256              (1)  | Epoch:12 | Val Acc: 0.6667
 Best site-FERG_DB_256              (1)  | Epoch:12 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:12 | Val Acc: 0.3571
 Best site-FERG_DB_256              (1)  | Epoch:12 | Val Acc: 0.4390
 Best site-FERG_DB_256              (1)  | Epoch:12 | Val Acc: 0.3871
 Best site-expw                     (2)  | Epoch:12 | Val Acc: 0.1875
 Best site-expw                     (2)  | Epoch:12 | Val Acc: 0.1379
 Best site-expw                     (2)  | Epoch:12 | Val Acc: 0.2400
 Best site-FER                      (0)  | Epoch:12 | Val Acc: 0.1667
 Best site-FER                      (0)  | Epoch:12 | Val Acc: 0.2162
 Best site-jpWoman                  (3)  | Epoch:12 | Val Acc: 0.1200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-FERG_DB_256               (1) | Train Loss: 1.7007 | Train Acc: 0.4444
 Site-FERG_DB_256               (1) | Train Loss: 1.7223 | Train Acc: 0.3929
 Site-FERG_DB_256               (1) | Train Loss: 1.6595 | Train Acc: 0.4286
 Site-FERG_DB_256               (1) | Train Loss: 1.7273 | Train Acc: 0.3710
 Site-FERG_DB_256               (1) | Train Loss: 1.6930 | Train Acc: 0.4149
 Site-expw                      (2) | Train Loss: 1.7125 | Train Acc: 0.4000
 Site-expw                      (2) | Train Loss: 1.7103 | Train Acc: 0.2791
 Site-expw                      (2) | Train Loss: 1.6750 | Train Acc: 0.2800
 Site-FER                       (3) | Train Loss: 1.9377 | Train Acc: 0.1429
 Site-FER                       (3) | Train Loss: 1.9540 | Train Acc: 0.1786
 Site-jpWoman                   (0) | Train Loss: 1.9548 | Train Acc: 0.1351
Average Train Accuracy: 0.3152
 Site-FERG_DB_256               (1) | Val  Loss: 1.6001 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.6101 | Val  Acc: 0.4444
 Site-FERG_DB_256               (1) | Val  Loss: 1.6579 | Val  Acc: 0.3929
 Site-FERG_DB_256               (1) | Val  Loss: 1.8062 | Val  Acc: 0.2927
 Site-FERG_DB_256               (1) | Val  Loss: 1.6281 | Val  Acc: 0.4839
 Site-expw                      (2) | Val  Loss: 1.6722 | Val  Acc: 0.3750
 Site-expw                      (2) | Val  Loss: 1.6423 | Val  Acc: 0.2759
 Site-expw                      (2) | Val  Loss: 1.6754 | Val  Acc: 0.2400
 Site-FER                       (3) | Val  Loss: 1.9808 | Val  Acc: 0.1667
 Site-FER                       (3) | Val  Loss: 2.0057 | Val  Acc: 0.1622
 Site-jpWoman                   (0) | Val  Loss: 1.8556 | Val  Acc: 0.3200
Average Valid Accuracy: 0.3321
 Best site-FERG_DB_256              (1)  | Epoch:13 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:13 | Val Acc: 0.4444
 Best site-FERG_DB_256              (1)  | Epoch:13 | Val Acc: 0.3929
 Best site-FERG_DB_256              (1)  | Epoch:13 | Val Acc: 0.2927
 Best site-FERG_DB_256              (1)  | Epoch:13 | Val Acc: 0.4839
 Best site-expw                     (2)  | Epoch:13 | Val Acc: 0.3750
 Best site-expw                     (2)  | Epoch:13 | Val Acc: 0.2759
 Best site-expw                     (2)  | Epoch:13 | Val Acc: 0.2400
 Best site-FER                      (3)  | Epoch:13 | Val Acc: 0.1667
 Best site-FER                      (3)  | Epoch:13 | Val Acc: 0.1622
 Best site-jpWoman                  (0)  | Epoch:13 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-FERG_DB_256               (1) | Train Loss: 1.5931 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.7278 | Train Acc: 0.3571
 Site-FERG_DB_256               (1) | Train Loss: 1.7119 | Train Acc: 0.5714
 Site-FERG_DB_256               (1) | Train Loss: 1.6572 | Train Acc: 0.3871
 Site-FERG_DB_256               (1) | Train Loss: 1.6840 | Train Acc: 0.3723
 Site-expw                      (0) | Train Loss: 1.6921 | Train Acc: 0.2400
 Site-expw                      (0) | Train Loss: 1.7110 | Train Acc: 0.2791
 Site-expw                      (0) | Train Loss: 1.6032 | Train Acc: 0.2667
 Site-FER                       (2) | Train Loss: 1.8841 | Train Acc: 0.1786
 Site-FER                       (2) | Train Loss: 1.9698 | Train Acc: 0.2321
 Site-jpWoman                   (3) | Train Loss: 2.0058 | Train Acc: 0.1081
Average Train Accuracy: 0.3175
 Site-FERG_DB_256               (1) | Val  Loss: 1.6760 | Val  Acc: 0.4167
 Site-FERG_DB_256               (1) | Val  Loss: 1.5857 | Val  Acc: 0.4444
 Site-FERG_DB_256               (1) | Val  Loss: 1.7301 | Val  Acc: 0.3929
 Site-FERG_DB_256               (1) | Val  Loss: 1.6591 | Val  Acc: 0.4146
 Site-FERG_DB_256               (1) | Val  Loss: 1.6493 | Val  Acc: 0.4516
 Site-expw                      (0) | Val  Loss: 1.6960 | Val  Acc: 0.1875
 Site-expw                      (0) | Val  Loss: 1.5811 | Val  Acc: 0.2414
 Site-expw                      (0) | Val  Loss: 1.6619 | Val  Acc: 0.2400
 Site-FER                       (2) | Val  Loss: 1.9914 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.9665 | Val  Acc: 0.1892
 Site-jpWoman                   (3) | Val  Loss: 1.9570 | Val  Acc: 0.1200
Average Valid Accuracy: 0.3019
============ Train epoch 15 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-FERG_DB_256               (1) | Train Loss: 1.5567 | Train Acc: 0.6667
 Site-FERG_DB_256               (1) | Train Loss: 1.5966 | Train Acc: 0.4286
 Site-FERG_DB_256               (1) | Train Loss: 1.6805 | Train Acc: 0.5476
 Site-FERG_DB_256               (1) | Train Loss: 1.6647 | Train Acc: 0.4194
 Site-FERG_DB_256               (1) | Train Loss: 1.6489 | Train Acc: 0.4681
 Site-expw                      (2) | Train Loss: 1.7225 | Train Acc: 0.2800
 Site-expw                      (2) | Train Loss: 1.6969 | Train Acc: 0.1860
 Site-expw                      (2) | Train Loss: 1.6794 | Train Acc: 0.3067
 Site-FER                       (0) | Train Loss: 1.9919 | Train Acc: 0.2143
 Site-FER                       (0) | Train Loss: 1.9309 | Train Acc: 0.1964
 Site-jpWoman                   (3) | Train Loss: 1.9453 | Train Acc: 0.1351
Average Train Accuracy: 0.3499
 Site-FERG_DB_256               (1) | Val  Loss: 1.6227 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.6213 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.6514 | Val  Acc: 0.5000
 Site-FERG_DB_256               (1) | Val  Loss: 1.6851 | Val  Acc: 0.4146
 Site-FERG_DB_256               (1) | Val  Loss: 1.6626 | Val  Acc: 0.4516
 Site-expw                      (2) | Val  Loss: 1.6229 | Val  Acc: 0.2500
 Site-expw                      (2) | Val  Loss: 1.6290 | Val  Acc: 0.2069
 Site-expw                      (2) | Val  Loss: 1.6148 | Val  Acc: 0.3200
 Site-FER                       (0) | Val  Loss: 1.9569 | Val  Acc: 0.1667
 Site-FER                       (0) | Val  Loss: 1.9176 | Val  Acc: 0.2432
 Site-jpWoman                   (3) | Val  Loss: 1.8754 | Val  Acc: 0.2400
Average Valid Accuracy: 0.3448
 Best site-FERG_DB_256              (1)  | Epoch:15 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:15 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:15 | Val Acc: 0.5000
 Best site-FERG_DB_256              (1)  | Epoch:15 | Val Acc: 0.4146
 Best site-FERG_DB_256              (1)  | Epoch:15 | Val Acc: 0.4516
 Best site-expw                     (2)  | Epoch:15 | Val Acc: 0.2500
 Best site-expw                     (2)  | Epoch:15 | Val Acc: 0.2069
 Best site-expw                     (2)  | Epoch:15 | Val Acc: 0.3200
 Best site-FER                      (0)  | Epoch:15 | Val Acc: 0.1667
 Best site-FER                      (0)  | Epoch:15 | Val Acc: 0.2432
 Best site-jpWoman                  (3)  | Epoch:15 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 16 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-FERG_DB_256               (1) | Train Loss: 1.5851 | Train Acc: 0.5556
 Site-FERG_DB_256               (1) | Train Loss: 1.6254 | Train Acc: 0.3929
 Site-FERG_DB_256               (1) | Train Loss: 1.6809 | Train Acc: 0.4524
 Site-FERG_DB_256               (1) | Train Loss: 1.6304 | Train Acc: 0.4516
 Site-FERG_DB_256               (1) | Train Loss: 1.6310 | Train Acc: 0.4574
 Site-expw                      (2) | Train Loss: 1.7670 | Train Acc: 0.2400
 Site-expw                      (2) | Train Loss: 1.5927 | Train Acc: 0.3023
 Site-expw                      (2) | Train Loss: 1.7444 | Train Acc: 0.2400
 Site-FER                       (3) | Train Loss: 1.9667 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.8792 | Train Acc: 0.2500
 Site-jpWoman                   (0) | Train Loss: 1.9084 | Train Acc: 0.1622
Average Train Accuracy: 0.3413
 Site-FERG_DB_256               (1) | Val  Loss: 1.5131 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.4535 | Val  Acc: 0.6111
 Site-FERG_DB_256               (1) | Val  Loss: 1.6701 | Val  Acc: 0.4286
 Site-FERG_DB_256               (1) | Val  Loss: 1.6434 | Val  Acc: 0.3415
 Site-FERG_DB_256               (1) | Val  Loss: 1.6127 | Val  Acc: 0.4516
 Site-expw                      (2) | Val  Loss: 1.7098 | Val  Acc: 0.1250
 Site-expw                      (2) | Val  Loss: 1.5801 | Val  Acc: 0.3103
 Site-expw                      (2) | Val  Loss: 1.6009 | Val  Acc: 0.4000
 Site-FER                       (3) | Val  Loss: 1.9413 | Val  Acc: 0.2222
 Site-FER                       (3) | Val  Loss: 1.9160 | Val  Acc: 0.1892
 Site-jpWoman                   (0) | Val  Loss: 1.8787 | Val  Acc: 0.1600
Average Valid Accuracy: 0.3551
 Best site-FERG_DB_256              (1)  | Epoch:16 | Val Acc: 0.6667
 Best site-FERG_DB_256              (1)  | Epoch:16 | Val Acc: 0.6111
 Best site-FERG_DB_256              (1)  | Epoch:16 | Val Acc: 0.4286
 Best site-FERG_DB_256              (1)  | Epoch:16 | Val Acc: 0.3415
 Best site-FERG_DB_256              (1)  | Epoch:16 | Val Acc: 0.4516
 Best site-expw                     (2)  | Epoch:16 | Val Acc: 0.1250
 Best site-expw                     (2)  | Epoch:16 | Val Acc: 0.3103
 Best site-expw                     (2)  | Epoch:16 | Val Acc: 0.4000
 Best site-FER                      (3)  | Epoch:16 | Val Acc: 0.2222
 Best site-FER                      (3)  | Epoch:16 | Val Acc: 0.1892
 Best site-jpWoman                  (0)  | Epoch:16 | Val Acc: 0.1600
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 17 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-FERG_DB_256               (0) | Train Loss: 1.5910 | Train Acc: 0.5556
 Site-FERG_DB_256               (0) | Train Loss: 1.6570 | Train Acc: 0.5000
 Site-FERG_DB_256               (0) | Train Loss: 1.6604 | Train Acc: 0.4524
 Site-FERG_DB_256               (0) | Train Loss: 1.6394 | Train Acc: 0.4194
 Site-FERG_DB_256               (0) | Train Loss: 1.5573 | Train Acc: 0.5213
 Site-expw                      (1) | Train Loss: 1.6467 | Train Acc: 0.3600
 Site-expw                      (1) | Train Loss: 1.5505 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.5053 | Train Acc: 0.3067
 Site-FER                       (2) | Train Loss: 1.8810 | Train Acc: 0.3571
 Site-FER                       (2) | Train Loss: 1.9368 | Train Acc: 0.1786
 Site-jpWoman                   (3) | Train Loss: 1.8735 | Train Acc: 0.1351
Average Train Accuracy: 0.3780
 Site-FERG_DB_256               (0) | Val  Loss: 1.4768 | Val  Acc: 0.5833
 Site-FERG_DB_256               (0) | Val  Loss: 1.5347 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.5992 | Val  Acc: 0.4286
 Site-FERG_DB_256               (0) | Val  Loss: 1.6276 | Val  Acc: 0.4146
 Site-FERG_DB_256               (0) | Val  Loss: 1.6695 | Val  Acc: 0.3710
 Site-expw                      (1) | Val  Loss: 1.5975 | Val  Acc: 0.3750
 Site-expw                      (1) | Val  Loss: 1.5784 | Val  Acc: 0.2759
 Site-expw                      (1) | Val  Loss: 1.5448 | Val  Acc: 0.2600
 Site-FER                       (2) | Val  Loss: 1.9720 | Val  Acc: 0.2778
 Site-FER                       (2) | Val  Loss: 1.9101 | Val  Acc: 0.1892
 Site-jpWoman                   (3) | Val  Loss: 1.8453 | Val  Acc: 0.2400
Average Valid Accuracy: 0.3559
 Best site-FERG_DB_256              (0)  | Epoch:17 | Val Acc: 0.5833
 Best site-FERG_DB_256              (0)  | Epoch:17 | Val Acc: 0.5000
 Best site-FERG_DB_256              (0)  | Epoch:17 | Val Acc: 0.4286
 Best site-FERG_DB_256              (0)  | Epoch:17 | Val Acc: 0.4146
 Best site-FERG_DB_256              (0)  | Epoch:17 | Val Acc: 0.3710
 Best site-expw                     (1)  | Epoch:17 | Val Acc: 0.3750
 Best site-expw                     (1)  | Epoch:17 | Val Acc: 0.2759
 Best site-expw                     (1)  | Epoch:17 | Val Acc: 0.2600
 Best site-FER                      (2)  | Epoch:17 | Val Acc: 0.2778
 Best site-FER                      (2)  | Epoch:17 | Val Acc: 0.1892
 Best site-jpWoman                  (3)  | Epoch:17 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-FERG_DB_256               (1) | Train Loss: 1.5743 | Train Acc: 0.5000
 Site-FERG_DB_256               (1) | Train Loss: 1.6016 | Train Acc: 0.3571
 Site-FERG_DB_256               (1) | Train Loss: 1.6089 | Train Acc: 0.4762
 Site-FERG_DB_256               (1) | Train Loss: 1.5908 | Train Acc: 0.3871
 Site-FERG_DB_256               (1) | Train Loss: 1.5604 | Train Acc: 0.5106
 Site-expw                      (2) | Train Loss: 1.7701 | Train Acc: 0.3200
 Site-expw                      (2) | Train Loss: 1.5615 | Train Acc: 0.3953
 Site-expw                      (2) | Train Loss: 1.6665 | Train Acc: 0.3600
 Site-FER                       (3) | Train Loss: 1.9409 | Train Acc: 0.3214
 Site-FER                       (3) | Train Loss: 1.8620 | Train Acc: 0.2500
 Site-jpWoman                   (0) | Train Loss: 1.9390 | Train Acc: 0.0811
Average Train Accuracy: 0.3599
 Site-FERG_DB_256               (1) | Val  Loss: 1.4509 | Val  Acc: 0.5833
 Site-FERG_DB_256               (1) | Val  Loss: 1.4658 | Val  Acc: 0.6111
 Site-FERG_DB_256               (1) | Val  Loss: 1.5450 | Val  Acc: 0.4286
 Site-FERG_DB_256               (1) | Val  Loss: 1.6131 | Val  Acc: 0.4634
 Site-FERG_DB_256               (1) | Val  Loss: 1.5926 | Val  Acc: 0.4194
 Site-expw                      (2) | Val  Loss: 1.5716 | Val  Acc: 0.3125
 Site-expw                      (2) | Val  Loss: 1.5549 | Val  Acc: 0.3448
 Site-expw                      (2) | Val  Loss: 1.5576 | Val  Acc: 0.2600
 Site-FER                       (3) | Val  Loss: 1.9168 | Val  Acc: 0.3333
 Site-FER                       (3) | Val  Loss: 1.8995 | Val  Acc: 0.2703
 Site-jpWoman                   (0) | Val  Loss: 1.8890 | Val  Acc: 0.2400
Average Valid Accuracy: 0.3879
 Best site-FERG_DB_256              (1)  | Epoch:18 | Val Acc: 0.5833
 Best site-FERG_DB_256              (1)  | Epoch:18 | Val Acc: 0.6111
 Best site-FERG_DB_256              (1)  | Epoch:18 | Val Acc: 0.4286
 Best site-FERG_DB_256              (1)  | Epoch:18 | Val Acc: 0.4634
 Best site-FERG_DB_256              (1)  | Epoch:18 | Val Acc: 0.4194
 Best site-expw                     (2)  | Epoch:18 | Val Acc: 0.3125
 Best site-expw                     (2)  | Epoch:18 | Val Acc: 0.3448
 Best site-expw                     (2)  | Epoch:18 | Val Acc: 0.2600
 Best site-FER                      (3)  | Epoch:18 | Val Acc: 0.3333
 Best site-FER                      (3)  | Epoch:18 | Val Acc: 0.2703
 Best site-jpWoman                  (0)  | Epoch:18 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-FERG_DB_256               (0) | Train Loss: 1.4571 | Train Acc: 0.5556
 Site-FERG_DB_256               (0) | Train Loss: 1.6457 | Train Acc: 0.3571
 Site-FERG_DB_256               (0) | Train Loss: 1.5541 | Train Acc: 0.5238
 Site-FERG_DB_256               (0) | Train Loss: 1.5699 | Train Acc: 0.4677
 Site-FERG_DB_256               (0) | Train Loss: 1.5108 | Train Acc: 0.4894
 Site-expw                      (1) | Train Loss: 1.6263 | Train Acc: 0.3600
 Site-expw                      (3) | Train Loss: 1.4851 | Train Acc: 0.3256
 Site-expw                      (3) | Train Loss: 1.5545 | Train Acc: 0.3067
 Site-FER                       (2) | Train Loss: 1.8999 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.8699 | Train Acc: 0.2500
 Site-jpWoman                   (2) | Train Loss: 1.9183 | Train Acc: 0.2162
Average Train Accuracy: 0.3729
 Site-FERG_DB_256               (0) | Val  Loss: 1.5489 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.4889 | Val  Acc: 0.6111
 Site-FERG_DB_256               (0) | Val  Loss: 1.5959 | Val  Acc: 0.4643
 Site-FERG_DB_256               (0) | Val  Loss: 1.5684 | Val  Acc: 0.3902
 Site-FERG_DB_256               (0) | Val  Loss: 1.5974 | Val  Acc: 0.4355
 Site-expw                      (1) | Val  Loss: 1.5227 | Val  Acc: 0.3125
 Site-expw                      (3) | Val  Loss: 1.5659 | Val  Acc: 0.3103
 Site-expw                      (3) | Val  Loss: 1.5002 | Val  Acc: 0.3200
 Site-FER                       (2) | Val  Loss: 1.9262 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.9416 | Val  Acc: 0.3243
 Site-jpWoman                   (2) | Val  Loss: 1.8382 | Val  Acc: 0.2800
Average Valid Accuracy: 0.3690
============ Train epoch 20 ============
cnt=[2, 3, 5, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-FERG_DB_256               (2) | Train Loss: 1.5429 | Train Acc: 0.5556
 Site-FERG_DB_256               (2) | Train Loss: 1.5820 | Train Acc: 0.4643
 Site-FERG_DB_256               (2) | Train Loss: 1.5783 | Train Acc: 0.4762
 Site-FERG_DB_256               (2) | Train Loss: 1.5450 | Train Acc: 0.5000
 Site-FERG_DB_256               (2) | Train Loss: 1.5092 | Train Acc: 0.5213
 Site-expw                      (1) | Train Loss: 1.6818 | Train Acc: 0.3600
 Site-expw                      (1) | Train Loss: 1.5249 | Train Acc: 0.2791
 Site-expw                      (1) | Train Loss: 1.5253 | Train Acc: 0.2933
 Site-FER                       (0) | Train Loss: 1.8833 | Train Acc: 0.2857
 Site-FER                       (0) | Train Loss: 1.8415 | Train Acc: 0.2679
 Site-jpWoman                   (3) | Train Loss: 1.8363 | Train Acc: 0.3243
Average Train Accuracy: 0.3934
 Site-FERG_DB_256               (2) | Val  Loss: 1.3894 | Val  Acc: 0.5833
 Site-FERG_DB_256               (2) | Val  Loss: 1.4816 | Val  Acc: 0.6111
 Site-FERG_DB_256               (2) | Val  Loss: 1.5246 | Val  Acc: 0.5714
 Site-FERG_DB_256               (2) | Val  Loss: 1.6272 | Val  Acc: 0.4146
 Site-FERG_DB_256               (2) | Val  Loss: 1.5232 | Val  Acc: 0.5645
 Site-expw                      (1) | Val  Loss: 1.5699 | Val  Acc: 0.1875
 Site-expw                      (1) | Val  Loss: 1.5545 | Val  Acc: 0.2069
 Site-expw                      (1) | Val  Loss: 1.4812 | Val  Acc: 0.3400
 Site-FER                       (0) | Val  Loss: 1.9191 | Val  Acc: 0.2222
 Site-FER                       (0) | Val  Loss: 1.8893 | Val  Acc: 0.2973
 Site-jpWoman                   (3) | Val  Loss: 1.9028 | Val  Acc: 0.2000
Average Valid Accuracy: 0.3817
============ Train epoch 21 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-FERG_DB_256               (0) | Train Loss: 1.4624 | Train Acc: 0.5556
 Site-FERG_DB_256               (0) | Train Loss: 1.5485 | Train Acc: 0.3929
 Site-FERG_DB_256               (0) | Train Loss: 1.5687 | Train Acc: 0.5238
 Site-FERG_DB_256               (0) | Train Loss: 1.5905 | Train Acc: 0.4355
 Site-FERG_DB_256               (0) | Train Loss: 1.5155 | Train Acc: 0.5106
 Site-expw                      (1) | Train Loss: 1.7152 | Train Acc: 0.2000
 Site-expw                      (1) | Train Loss: 1.4890 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.4630 | Train Acc: 0.3600
 Site-FER                       (2) | Train Loss: 1.8491 | Train Acc: 0.3571
 Site-FER                       (2) | Train Loss: 1.8155 | Train Acc: 0.2857
 Site-jpWoman                   (3) | Train Loss: 1.9237 | Train Acc: 0.1622
Average Train Accuracy: 0.3778
 Site-FERG_DB_256               (0) | Val  Loss: 1.4542 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.3379 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.4882 | Val  Acc: 0.5714
 Site-FERG_DB_256               (0) | Val  Loss: 1.6258 | Val  Acc: 0.4146
 Site-FERG_DB_256               (0) | Val  Loss: 1.5515 | Val  Acc: 0.5000
 Site-expw                      (1) | Val  Loss: 1.5259 | Val  Acc: 0.3750
 Site-expw                      (1) | Val  Loss: 1.4922 | Val  Acc: 0.3793
 Site-expw                      (1) | Val  Loss: 1.4836 | Val  Acc: 0.3400
 Site-FER                       (2) | Val  Loss: 1.8566 | Val  Acc: 0.1667
 Site-FER                       (2) | Val  Loss: 1.9212 | Val  Acc: 0.2432
 Site-jpWoman                   (3) | Val  Loss: 1.8346 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4171
 Best site-FERG_DB_256              (0)  | Epoch:21 | Val Acc: 0.5000
 Best site-FERG_DB_256              (0)  | Epoch:21 | Val Acc: 0.7778
 Best site-FERG_DB_256              (0)  | Epoch:21 | Val Acc: 0.5714
 Best site-FERG_DB_256              (0)  | Epoch:21 | Val Acc: 0.4146
 Best site-FERG_DB_256              (0)  | Epoch:21 | Val Acc: 0.5000
 Best site-expw                     (1)  | Epoch:21 | Val Acc: 0.3750
 Best site-expw                     (1)  | Epoch:21 | Val Acc: 0.3793
 Best site-expw                     (1)  | Epoch:21 | Val Acc: 0.3400
 Best site-FER                      (2)  | Epoch:21 | Val Acc: 0.1667
 Best site-FER                      (2)  | Epoch:21 | Val Acc: 0.2432
 Best site-jpWoman                  (3)  | Epoch:21 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-FERG_DB_256               (0) | Train Loss: 1.3989 | Train Acc: 0.6667
 Site-FERG_DB_256               (0) | Train Loss: 1.5305 | Train Acc: 0.5000
 Site-FERG_DB_256               (0) | Train Loss: 1.5596 | Train Acc: 0.5476
 Site-FERG_DB_256               (0) | Train Loss: 1.4622 | Train Acc: 0.5806
 Site-FERG_DB_256               (0) | Train Loss: 1.5085 | Train Acc: 0.5000
 Site-expw                      (1) | Train Loss: 1.6404 | Train Acc: 0.2800
 Site-expw                      (1) | Train Loss: 1.4876 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.4740 | Train Acc: 0.3600
 Site-FER                       (2) | Train Loss: 1.7693 | Train Acc: 0.4286
 Site-FER                       (2) | Train Loss: 1.9532 | Train Acc: 0.2321
 Site-jpWoman                   (3) | Train Loss: 1.8896 | Train Acc: 0.2162
Average Train Accuracy: 0.4258
 Site-FERG_DB_256               (0) | Val  Loss: 1.3827 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.3421 | Val  Acc: 0.7222
 Site-FERG_DB_256               (0) | Val  Loss: 1.5510 | Val  Acc: 0.4286
 Site-FERG_DB_256               (0) | Val  Loss: 1.5520 | Val  Acc: 0.4634
 Site-FERG_DB_256               (0) | Val  Loss: 1.5106 | Val  Acc: 0.5806
 Site-expw                      (1) | Val  Loss: 1.5267 | Val  Acc: 0.1875
 Site-expw                      (1) | Val  Loss: 1.4637 | Val  Acc: 0.3103
 Site-expw                      (1) | Val  Loss: 1.4529 | Val  Acc: 0.4200
 Site-FER                       (2) | Val  Loss: 1.9473 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.9469 | Val  Acc: 0.1892
 Site-jpWoman                   (3) | Val  Loss: 1.7582 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4050
============ Train epoch 23 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-FERG_DB_256               (0) | Train Loss: 1.3862 | Train Acc: 0.6111
 Site-FERG_DB_256               (0) | Train Loss: 1.5437 | Train Acc: 0.5357
 Site-FERG_DB_256               (0) | Train Loss: 1.5281 | Train Acc: 0.5476
 Site-FERG_DB_256               (0) | Train Loss: 1.4825 | Train Acc: 0.5806
 Site-FERG_DB_256               (0) | Train Loss: 1.5055 | Train Acc: 0.5106
 Site-expw                      (1) | Train Loss: 1.6755 | Train Acc: 0.3200
 Site-expw                      (1) | Train Loss: 1.5190 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.4403 | Train Acc: 0.3467
 Site-FER                       (3) | Train Loss: 1.8281 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.9401 | Train Acc: 0.2143
 Site-jpWoman                   (2) | Train Loss: 1.8637 | Train Acc: 0.1892
Average Train Accuracy: 0.4071
 Site-FERG_DB_256               (0) | Val  Loss: 1.4161 | Val  Acc: 0.6667
 Site-FERG_DB_256               (0) | Val  Loss: 1.3687 | Val  Acc: 0.5556
 Site-FERG_DB_256               (0) | Val  Loss: 1.5314 | Val  Acc: 0.5714
 Site-FERG_DB_256               (0) | Val  Loss: 1.4971 | Val  Acc: 0.5122
 Site-FERG_DB_256               (0) | Val  Loss: 1.5028 | Val  Acc: 0.5484
 Site-expw                      (1) | Val  Loss: 1.5625 | Val  Acc: 0.2500
 Site-expw                      (1) | Val  Loss: 1.4360 | Val  Acc: 0.2759
 Site-expw                      (1) | Val  Loss: 1.4217 | Val  Acc: 0.4400
 Site-FER                       (3) | Val  Loss: 1.9520 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.8449 | Val  Acc: 0.2703
 Site-jpWoman                   (2) | Val  Loss: 1.8606 | Val  Acc: 0.2400
Average Valid Accuracy: 0.4038
============ Train epoch 24 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-FERG_DB_256               (0) | Train Loss: 1.3567 | Train Acc: 0.6111
 Site-FERG_DB_256               (0) | Train Loss: 1.4940 | Train Acc: 0.4643
 Site-FERG_DB_256               (0) | Train Loss: 1.4616 | Train Acc: 0.6190
 Site-FERG_DB_256               (0) | Train Loss: 1.5051 | Train Acc: 0.5968
 Site-FERG_DB_256               (0) | Train Loss: 1.4472 | Train Acc: 0.5638
 Site-expw                      (1) | Train Loss: 1.6787 | Train Acc: 0.2000
 Site-expw                      (1) | Train Loss: 1.4722 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.4042 | Train Acc: 0.3733
 Site-FER                       (2) | Train Loss: 1.8982 | Train Acc: 0.3571
 Site-FER                       (2) | Train Loss: 1.8439 | Train Acc: 0.3036
 Site-jpWoman                   (3) | Train Loss: 1.8194 | Train Acc: 0.2973
Average Train Accuracy: 0.4347
 Site-FERG_DB_256               (0) | Val  Loss: 1.4462 | Val  Acc: 0.3333
 Site-FERG_DB_256               (0) | Val  Loss: 1.2801 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.5089 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.5534 | Val  Acc: 0.5122
 Site-FERG_DB_256               (0) | Val  Loss: 1.4967 | Val  Acc: 0.5645
 Site-expw                      (1) | Val  Loss: 1.5441 | Val  Acc: 0.2500
 Site-expw                      (1) | Val  Loss: 1.4846 | Val  Acc: 0.3103
 Site-expw                      (1) | Val  Loss: 1.4431 | Val  Acc: 0.3800
 Site-FER                       (2) | Val  Loss: 1.8322 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.8584 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.8588 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4187
 Best site-FERG_DB_256              (0)  | Epoch:24 | Val Acc: 0.3333
 Best site-FERG_DB_256              (0)  | Epoch:24 | Val Acc: 0.7778
 Best site-FERG_DB_256              (0)  | Epoch:24 | Val Acc: 0.5000
 Best site-FERG_DB_256              (0)  | Epoch:24 | Val Acc: 0.5122
 Best site-FERG_DB_256              (0)  | Epoch:24 | Val Acc: 0.5645
 Best site-expw                     (1)  | Epoch:24 | Val Acc: 0.2500
 Best site-expw                     (1)  | Epoch:24 | Val Acc: 0.3103
 Best site-expw                     (1)  | Epoch:24 | Val Acc: 0.3800
 Best site-FER                      (2)  | Epoch:24 | Val Acc: 0.3333
 Best site-FER                      (2)  | Epoch:24 | Val Acc: 0.3243
 Best site-jpWoman                  (3)  | Epoch:24 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 25 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-FERG_DB_256               (0) | Train Loss: 1.3863 | Train Acc: 0.6111
 Site-FERG_DB_256               (0) | Train Loss: 1.5315 | Train Acc: 0.5000
 Site-FERG_DB_256               (0) | Train Loss: 1.4777 | Train Acc: 0.6667
 Site-FERG_DB_256               (0) | Train Loss: 1.4824 | Train Acc: 0.5323
 Site-FERG_DB_256               (0) | Train Loss: 1.4338 | Train Acc: 0.5957
 Site-expw                      (1) | Train Loss: 1.5785 | Train Acc: 0.2800
 Site-expw                      (1) | Train Loss: 1.4782 | Train Acc: 0.4419
 Site-expw                      (1) | Train Loss: 1.4954 | Train Acc: 0.3333
 Site-FER                       (2) | Train Loss: 1.8371 | Train Acc: 0.3929
 Site-FER                       (2) | Train Loss: 1.8587 | Train Acc: 0.2679
 Site-jpWoman                   (3) | Train Loss: 1.8156 | Train Acc: 0.2973
Average Train Accuracy: 0.4472
 Site-FERG_DB_256               (0) | Val  Loss: 1.3702 | Val  Acc: 0.8333
 Site-FERG_DB_256               (0) | Val  Loss: 1.3909 | Val  Acc: 0.5556
 Site-FERG_DB_256               (0) | Val  Loss: 1.4031 | Val  Acc: 0.5357
 Site-FERG_DB_256               (0) | Val  Loss: 1.5158 | Val  Acc: 0.4878
 Site-FERG_DB_256               (0) | Val  Loss: 1.4688 | Val  Acc: 0.4677
 Site-expw                      (1) | Val  Loss: 1.5887 | Val  Acc: 0.2500
 Site-expw                      (1) | Val  Loss: 1.4934 | Val  Acc: 0.3793
 Site-expw                      (1) | Val  Loss: 1.4708 | Val  Acc: 0.3600
 Site-FER                       (2) | Val  Loss: 1.9695 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.8809 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.8982 | Val  Acc: 0.2400
Average Valid Accuracy: 0.4233
 Best site-FERG_DB_256              (0)  | Epoch:25 | Val Acc: 0.8333
 Best site-FERG_DB_256              (0)  | Epoch:25 | Val Acc: 0.5556
 Best site-FERG_DB_256              (0)  | Epoch:25 | Val Acc: 0.5357
 Best site-FERG_DB_256              (0)  | Epoch:25 | Val Acc: 0.4878
 Best site-FERG_DB_256              (0)  | Epoch:25 | Val Acc: 0.4677
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.2500
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.3793
 Best site-expw                     (1)  | Epoch:25 | Val Acc: 0.3600
 Best site-FER                      (2)  | Epoch:25 | Val Acc: 0.2222
 Best site-FER                      (2)  | Epoch:25 | Val Acc: 0.3243
 Best site-jpWoman                  (3)  | Epoch:25 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 26 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-FERG_DB_256               (0) | Train Loss: 1.3358 | Train Acc: 0.6111
 Site-FERG_DB_256               (0) | Train Loss: 1.4464 | Train Acc: 0.5000
 Site-FERG_DB_256               (0) | Train Loss: 1.4556 | Train Acc: 0.6190
 Site-FERG_DB_256               (0) | Train Loss: 1.4441 | Train Acc: 0.5645
 Site-FERG_DB_256               (0) | Train Loss: 1.4149 | Train Acc: 0.6064
 Site-expw                      (3) | Train Loss: 1.5727 | Train Acc: 0.3600
 Site-expw                      (1) | Train Loss: 1.5623 | Train Acc: 0.2791
 Site-expw                      (1) | Train Loss: 1.5092 | Train Acc: 0.3600
 Site-FER                       (2) | Train Loss: 1.8843 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.8713 | Train Acc: 0.2857
 Site-jpWoman                   (2) | Train Loss: 1.9120 | Train Acc: 0.1892
Average Train Accuracy: 0.4205
 Site-FERG_DB_256               (0) | Val  Loss: 1.2880 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.2962 | Val  Acc: 0.7222
 Site-FERG_DB_256               (0) | Val  Loss: 1.4631 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.5418 | Val  Acc: 0.4146
 Site-FERG_DB_256               (0) | Val  Loss: 1.4403 | Val  Acc: 0.5968
 Site-expw                      (3) | Val  Loss: 1.5890 | Val  Acc: 0.1250
 Site-expw                      (1) | Val  Loss: 1.5294 | Val  Acc: 0.2414
 Site-expw                      (1) | Val  Loss: 1.4468 | Val  Acc: 0.4600
 Site-FER                       (2) | Val  Loss: 1.7767 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.9385 | Val  Acc: 0.1622
 Site-jpWoman                   (2) | Val  Loss: 1.7384 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4241
 Best site-FERG_DB_256              (0)  | Epoch:26 | Val Acc: 0.7500
 Best site-FERG_DB_256              (0)  | Epoch:26 | Val Acc: 0.7222
 Best site-FERG_DB_256              (0)  | Epoch:26 | Val Acc: 0.5000
 Best site-FERG_DB_256              (0)  | Epoch:26 | Val Acc: 0.4146
 Best site-FERG_DB_256              (0)  | Epoch:26 | Val Acc: 0.5968
 Best site-expw                     (3)  | Epoch:26 | Val Acc: 0.1250
 Best site-expw                     (1)  | Epoch:26 | Val Acc: 0.2414
 Best site-expw                     (1)  | Epoch:26 | Val Acc: 0.4600
 Best site-FER                      (2)  | Epoch:26 | Val Acc: 0.3333
 Best site-FER                      (2)  | Epoch:26 | Val Acc: 0.1622
 Best site-jpWoman                  (2)  | Epoch:26 | Val Acc: 0.3600
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-FERG_DB_256               (0) | Train Loss: 1.4767 | Train Acc: 0.5556
 Site-FERG_DB_256               (0) | Train Loss: 1.5042 | Train Acc: 0.5000
 Site-FERG_DB_256               (0) | Train Loss: 1.4409 | Train Acc: 0.6429
 Site-FERG_DB_256               (0) | Train Loss: 1.4976 | Train Acc: 0.4516
 Site-FERG_DB_256               (0) | Train Loss: 1.3935 | Train Acc: 0.6064
 Site-expw                      (2) | Train Loss: 1.5050 | Train Acc: 0.3600
 Site-expw                      (2) | Train Loss: 1.5041 | Train Acc: 0.3721
 Site-expw                      (2) | Train Loss: 1.5167 | Train Acc: 0.3200
 Site-FER                       (1) | Train Loss: 1.7765 | Train Acc: 0.3214
 Site-FER                       (1) | Train Loss: 1.8467 | Train Acc: 0.2321
 Site-jpWoman                   (3) | Train Loss: 1.7833 | Train Acc: 0.2973
Average Train Accuracy: 0.4236
 Site-FERG_DB_256               (0) | Val  Loss: 1.3157 | Val  Acc: 0.5833
 Site-FERG_DB_256               (0) | Val  Loss: 1.3632 | Val  Acc: 0.7222
 Site-FERG_DB_256               (0) | Val  Loss: 1.4492 | Val  Acc: 0.5714
 Site-FERG_DB_256               (0) | Val  Loss: 1.4305 | Val  Acc: 0.5610
 Site-FERG_DB_256               (0) | Val  Loss: 1.3976 | Val  Acc: 0.5968
 Site-expw                      (2) | Val  Loss: 1.4962 | Val  Acc: 0.3125
 Site-expw                      (2) | Val  Loss: 1.4914 | Val  Acc: 0.2414
 Site-expw                      (2) | Val  Loss: 1.4377 | Val  Acc: 0.4000
 Site-FER                       (1) | Val  Loss: 1.9098 | Val  Acc: 0.2222
 Site-FER                       (1) | Val  Loss: 1.8830 | Val  Acc: 0.2432
 Site-jpWoman                   (3) | Val  Loss: 1.8251 | Val  Acc: 0.2800
Average Valid Accuracy: 0.4304
 Best site-FERG_DB_256              (0)  | Epoch:27 | Val Acc: 0.5833
 Best site-FERG_DB_256              (0)  | Epoch:27 | Val Acc: 0.7222
 Best site-FERG_DB_256              (0)  | Epoch:27 | Val Acc: 0.5714
 Best site-FERG_DB_256              (0)  | Epoch:27 | Val Acc: 0.5610
 Best site-FERG_DB_256              (0)  | Epoch:27 | Val Acc: 0.5968
 Best site-expw                     (2)  | Epoch:27 | Val Acc: 0.3125
 Best site-expw                     (2)  | Epoch:27 | Val Acc: 0.2414
 Best site-expw                     (2)  | Epoch:27 | Val Acc: 0.4000
 Best site-FER                      (1)  | Epoch:27 | Val Acc: 0.2222
 Best site-FER                      (1)  | Epoch:27 | Val Acc: 0.2432
 Best site-jpWoman                  (3)  | Epoch:27 | Val Acc: 0.2800
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 28 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-FERG_DB_256               (1) | Train Loss: 1.2571 | Train Acc: 0.6111
 Site-FERG_DB_256               (1) | Train Loss: 1.4697 | Train Acc: 0.4643
 Site-FERG_DB_256               (1) | Train Loss: 1.4064 | Train Acc: 0.5952
 Site-FERG_DB_256               (1) | Train Loss: 1.3834 | Train Acc: 0.5806
 Site-FERG_DB_256               (1) | Train Loss: 1.3900 | Train Acc: 0.6170
 Site-expw                      (2) | Train Loss: 1.6193 | Train Acc: 0.3200
 Site-expw                      (2) | Train Loss: 1.4742 | Train Acc: 0.3256
 Site-expw                      (2) | Train Loss: 1.4302 | Train Acc: 0.4533
 Site-FER                       (3) | Train Loss: 1.8295 | Train Acc: 0.2500
 Site-FER                       (3) | Train Loss: 1.8138 | Train Acc: 0.3393
 Site-jpWoman                   (0) | Train Loss: 1.8087 | Train Acc: 0.2973
Average Train Accuracy: 0.4413
 Site-FERG_DB_256               (1) | Val  Loss: 1.3869 | Val  Acc: 0.5833
 Site-FERG_DB_256               (1) | Val  Loss: 1.3013 | Val  Acc: 0.6111
 Site-FERG_DB_256               (1) | Val  Loss: 1.4202 | Val  Acc: 0.5357
 Site-FERG_DB_256               (1) | Val  Loss: 1.4458 | Val  Acc: 0.5366
 Site-FERG_DB_256               (1) | Val  Loss: 1.4172 | Val  Acc: 0.5968
 Site-expw                      (2) | Val  Loss: 1.5165 | Val  Acc: 0.5000
 Site-expw                      (2) | Val  Loss: 1.4627 | Val  Acc: 0.3103
 Site-expw                      (2) | Val  Loss: 1.4818 | Val  Acc: 0.3400
 Site-FER                       (3) | Val  Loss: 1.8870 | Val  Acc: 0.1667
 Site-FER                       (3) | Val  Loss: 1.8846 | Val  Acc: 0.2432
 Site-jpWoman                   (0) | Val  Loss: 1.7480 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4313
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5833
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.6111
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5357
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5366
 Best site-FERG_DB_256              (1)  | Epoch:28 | Val Acc: 0.5968
 Best site-expw                     (2)  | Epoch:28 | Val Acc: 0.5000
 Best site-expw                     (2)  | Epoch:28 | Val Acc: 0.3103
 Best site-expw                     (2)  | Epoch:28 | Val Acc: 0.3400
 Best site-FER                      (3)  | Epoch:28 | Val Acc: 0.1667
 Best site-FER                      (3)  | Epoch:28 | Val Acc: 0.2432
 Best site-jpWoman                  (0)  | Epoch:28 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 29 ============
cnt=[4, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-FERG_DB_256               (3) | Train Loss: 1.2343 | Train Acc: 0.7778
 Site-FERG_DB_256               (0) | Train Loss: 1.4027 | Train Acc: 0.6786
 Site-FERG_DB_256               (0) | Train Loss: 1.3464 | Train Acc: 0.6190
 Site-FERG_DB_256               (0) | Train Loss: 1.3917 | Train Acc: 0.5323
 Site-FERG_DB_256               (0) | Train Loss: 1.3626 | Train Acc: 0.6170
 Site-expw                      (1) | Train Loss: 1.6142 | Train Acc: 0.3200
 Site-expw                      (1) | Train Loss: 1.4993 | Train Acc: 0.3023
 Site-expw                      (1) | Train Loss: 1.3625 | Train Acc: 0.4533
 Site-FER                       (2) | Train Loss: 1.7838 | Train Acc: 0.4286
 Site-FER                       (2) | Train Loss: 1.8129 | Train Acc: 0.3571
 Site-jpWoman                   (2) | Train Loss: 1.7903 | Train Acc: 0.2703
Average Train Accuracy: 0.4869
 Site-FERG_DB_256               (3) | Val  Loss: 1.2929 | Val  Acc: 0.6667
 Site-FERG_DB_256               (0) | Val  Loss: 1.4039 | Val  Acc: 0.4444
 Site-FERG_DB_256               (0) | Val  Loss: 1.4306 | Val  Acc: 0.5000
 Site-FERG_DB_256               (0) | Val  Loss: 1.4182 | Val  Acc: 0.6098
 Site-FERG_DB_256               (0) | Val  Loss: 1.3725 | Val  Acc: 0.6290
 Site-expw                      (1) | Val  Loss: 1.5579 | Val  Acc: 0.2500
 Site-expw                      (1) | Val  Loss: 1.4266 | Val  Acc: 0.3793
 Site-expw                      (1) | Val  Loss: 1.4645 | Val  Acc: 0.3600
 Site-FER                       (2) | Val  Loss: 2.0568 | Val  Acc: 0.1667
 Site-FER                       (2) | Val  Loss: 1.8627 | Val  Acc: 0.3243
 Site-jpWoman                   (2) | Val  Loss: 1.9097 | Val  Acc: 0.2400
Average Valid Accuracy: 0.4155
============ Train epoch 30 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-FERG_DB_256               (1) | Train Loss: 1.2159 | Train Acc: 0.7778
 Site-FERG_DB_256               (1) | Train Loss: 1.3403 | Train Acc: 0.6429
 Site-FERG_DB_256               (1) | Train Loss: 1.4433 | Train Acc: 0.5714
 Site-FERG_DB_256               (1) | Train Loss: 1.3682 | Train Acc: 0.5968
 Site-FERG_DB_256               (1) | Train Loss: 1.3994 | Train Acc: 0.6277
 Site-expw                      (2) | Train Loss: 1.5826 | Train Acc: 0.2400
 Site-expw                      (2) | Train Loss: 1.4335 | Train Acc: 0.2791
 Site-expw                      (2) | Train Loss: 1.3527 | Train Acc: 0.4800
 Site-FER                       (0) | Train Loss: 1.9310 | Train Acc: 0.2857
 Site-FER                       (0) | Train Loss: 1.7778 | Train Acc: 0.3036
 Site-jpWoman                   (3) | Train Loss: 1.8195 | Train Acc: 0.2162
Average Train Accuracy: 0.4565
 Site-FERG_DB_256               (1) | Val  Loss: 1.3125 | Val  Acc: 0.5833
 Site-FERG_DB_256               (1) | Val  Loss: 1.3852 | Val  Acc: 0.7222
 Site-FERG_DB_256               (1) | Val  Loss: 1.4031 | Val  Acc: 0.5714
 Site-FERG_DB_256               (1) | Val  Loss: 1.4773 | Val  Acc: 0.4390
 Site-FERG_DB_256               (1) | Val  Loss: 1.3257 | Val  Acc: 0.6774
 Site-expw                      (2) | Val  Loss: 1.3673 | Val  Acc: 0.3750
 Site-expw                      (2) | Val  Loss: 1.4262 | Val  Acc: 0.3448
 Site-expw                      (2) | Val  Loss: 1.4163 | Val  Acc: 0.4200
 Site-FER                       (0) | Val  Loss: 1.9845 | Val  Acc: 0.1111
 Site-FER                       (0) | Val  Loss: 1.8714 | Val  Acc: 0.2703
 Site-jpWoman                   (3) | Val  Loss: 1.8000 | Val  Acc: 0.2800
Average Valid Accuracy: 0.4359
 Best site-FERG_DB_256              (1)  | Epoch:30 | Val Acc: 0.5833
 Best site-FERG_DB_256              (1)  | Epoch:30 | Val Acc: 0.7222
 Best site-FERG_DB_256              (1)  | Epoch:30 | Val Acc: 0.5714
 Best site-FERG_DB_256              (1)  | Epoch:30 | Val Acc: 0.4390
 Best site-FERG_DB_256              (1)  | Epoch:30 | Val Acc: 0.6774
 Best site-expw                     (2)  | Epoch:30 | Val Acc: 0.3750
 Best site-expw                     (2)  | Epoch:30 | Val Acc: 0.3448
 Best site-expw                     (2)  | Epoch:30 | Val Acc: 0.4200
 Best site-FER                      (0)  | Epoch:30 | Val Acc: 0.1111
 Best site-FER                      (0)  | Epoch:30 | Val Acc: 0.2703
 Best site-jpWoman                  (3)  | Epoch:30 | Val Acc: 0.2800
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 31 ============
cnt=[5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-FERG_DB_256               (0) | Train Loss: 1.2913 | Train Acc: 0.8333
 Site-FERG_DB_256               (0) | Train Loss: 1.3653 | Train Acc: 0.7143
 Site-FERG_DB_256               (0) | Train Loss: 1.4092 | Train Acc: 0.6190
 Site-FERG_DB_256               (0) | Train Loss: 1.4078 | Train Acc: 0.6613
 Site-FERG_DB_256               (0) | Train Loss: 1.3758 | Train Acc: 0.5851
 Site-expw                      (1) | Train Loss: 1.4904 | Train Acc: 0.4400
 Site-expw                      (3) | Train Loss: 1.4408 | Train Acc: 0.4419
 Site-expw                      (3) | Train Loss: 1.3419 | Train Acc: 0.4533
 Site-FER                       (2) | Train Loss: 1.7842 | Train Acc: 0.3214
 Site-FER                       (2) | Train Loss: 1.8670 | Train Acc: 0.3214
 Site-jpWoman                   (2) | Train Loss: 1.8763 | Train Acc: 0.2703
Average Train Accuracy: 0.5147
 Site-FERG_DB_256               (0) | Val  Loss: 1.3300 | Val  Acc: 0.6667
 Site-FERG_DB_256               (0) | Val  Loss: 1.3613 | Val  Acc: 0.6111
 Site-FERG_DB_256               (0) | Val  Loss: 1.3549 | Val  Acc: 0.5714
 Site-FERG_DB_256               (0) | Val  Loss: 1.3733 | Val  Acc: 0.5366
 Site-FERG_DB_256               (0) | Val  Loss: 1.4079 | Val  Acc: 0.5484
 Site-expw                      (1) | Val  Loss: 1.4835 | Val  Acc: 0.3125
 Site-expw                      (3) | Val  Loss: 1.4115 | Val  Acc: 0.4828
 Site-expw                      (3) | Val  Loss: 1.3928 | Val  Acc: 0.3400
 Site-FER                       (2) | Val  Loss: 1.9070 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.9051 | Val  Acc: 0.2973
 Site-jpWoman                   (2) | Val  Loss: 1.7937 | Val  Acc: 0.2400
Average Valid Accuracy: 0.4390
 Best site-FERG_DB_256              (0)  | Epoch:31 | Val Acc: 0.6667
 Best site-FERG_DB_256              (0)  | Epoch:31 | Val Acc: 0.6111
 Best site-FERG_DB_256              (0)  | Epoch:31 | Val Acc: 0.5714
 Best site-FERG_DB_256              (0)  | Epoch:31 | Val Acc: 0.5366
 Best site-FERG_DB_256              (0)  | Epoch:31 | Val Acc: 0.5484
 Best site-expw                     (1)  | Epoch:31 | Val Acc: 0.3125
 Best site-expw                     (3)  | Epoch:31 | Val Acc: 0.4828
 Best site-expw                     (3)  | Epoch:31 | Val Acc: 0.3400
 Best site-FER                      (2)  | Epoch:31 | Val Acc: 0.2222
 Best site-FER                      (2)  | Epoch:31 | Val Acc: 0.2973
 Best site-jpWoman                  (2)  | Epoch:31 | Val Acc: 0.2400
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 32 ============
cnt=[5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-FERG_DB_256               (0) | Train Loss: 1.1960 | Train Acc: 0.8333
 Site-FERG_DB_256               (0) | Train Loss: 1.3979 | Train Acc: 0.4643
 Site-FERG_DB_256               (0) | Train Loss: 1.3685 | Train Acc: 0.6190
 Site-FERG_DB_256               (0) | Train Loss: 1.2952 | Train Acc: 0.6452
 Site-FERG_DB_256               (0) | Train Loss: 1.3255 | Train Acc: 0.6809
 Site-expw                      (1) | Train Loss: 1.5045 | Train Acc: 0.4400
 Site-expw                      (1) | Train Loss: 1.4420 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.3740 | Train Acc: 0.3867
 Site-FER                       (2) | Train Loss: 1.7876 | Train Acc: 0.3571
 Site-FER                       (3) | Train Loss: 1.7912 | Train Acc: 0.3750
 Site-jpWoman                   (3) | Train Loss: 1.7385 | Train Acc: 0.3784
Average Train Accuracy: 0.5068
 Site-FERG_DB_256               (0) | Val  Loss: 1.2574 | Val  Acc: 0.5833
 Site-FERG_DB_256               (0) | Val  Loss: 1.3452 | Val  Acc: 0.6111
 Site-FERG_DB_256               (0) | Val  Loss: 1.3723 | Val  Acc: 0.6786
 Site-FERG_DB_256               (0) | Val  Loss: 1.4179 | Val  Acc: 0.5610
 Site-FERG_DB_256               (0) | Val  Loss: 1.3293 | Val  Acc: 0.6774
 Site-expw                      (1) | Val  Loss: 1.4308 | Val  Acc: 0.4375
 Site-expw                      (1) | Val  Loss: 1.3305 | Val  Acc: 0.4138
 Site-expw                      (1) | Val  Loss: 1.3859 | Val  Acc: 0.5000
 Site-FER                       (2) | Val  Loss: 1.9431 | Val  Acc: 0.2222
 Site-FER                       (3) | Val  Loss: 1.8975 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.8225 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4845
 Best site-FERG_DB_256              (0)  | Epoch:32 | Val Acc: 0.5833
 Best site-FERG_DB_256              (0)  | Epoch:32 | Val Acc: 0.6111
 Best site-FERG_DB_256              (0)  | Epoch:32 | Val Acc: 0.6786
 Best site-FERG_DB_256              (0)  | Epoch:32 | Val Acc: 0.5610
 Best site-FERG_DB_256              (0)  | Epoch:32 | Val Acc: 0.6774
 Best site-expw                     (1)  | Epoch:32 | Val Acc: 0.4375
 Best site-expw                     (1)  | Epoch:32 | Val Acc: 0.4138
 Best site-expw                     (1)  | Epoch:32 | Val Acc: 0.5000
 Best site-FER                      (2)  | Epoch:32 | Val Acc: 0.2222
 Best site-FER                      (3)  | Epoch:32 | Val Acc: 0.3243
 Best site-jpWoman                  (3)  | Epoch:32 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 33 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-FERG_DB_256               (1) | Train Loss: 1.1958 | Train Acc: 0.6111
 Site-FERG_DB_256               (1) | Train Loss: 1.3285 | Train Acc: 0.6786
 Site-FERG_DB_256               (1) | Train Loss: 1.3497 | Train Acc: 0.6667
 Site-FERG_DB_256               (1) | Train Loss: 1.3212 | Train Acc: 0.6613
 Site-FERG_DB_256               (1) | Train Loss: 1.3052 | Train Acc: 0.6489
 Site-expw                      (2) | Train Loss: 1.5821 | Train Acc: 0.3600
 Site-expw                      (2) | Train Loss: 1.5029 | Train Acc: 0.2326
 Site-expw                      (2) | Train Loss: 1.4622 | Train Acc: 0.4267
 Site-FER                       (3) | Train Loss: 1.7228 | Train Acc: 0.4643
 Site-FER                       (3) | Train Loss: 1.7609 | Train Acc: 0.3571
 Site-jpWoman                   (0) | Train Loss: 1.7642 | Train Acc: 0.2973
Average Train Accuracy: 0.4913
 Site-FERG_DB_256               (1) | Val  Loss: 1.2231 | Val  Acc: 0.5833
 Site-FERG_DB_256               (1) | Val  Loss: 1.2224 | Val  Acc: 0.7778
 Site-FERG_DB_256               (1) | Val  Loss: 1.4007 | Val  Acc: 0.6071
 Site-FERG_DB_256               (1) | Val  Loss: 1.3674 | Val  Acc: 0.5854
 Site-FERG_DB_256               (1) | Val  Loss: 1.2580 | Val  Acc: 0.7419
 Site-expw                      (2) | Val  Loss: 1.4588 | Val  Acc: 0.1875
 Site-expw                      (2) | Val  Loss: 1.4566 | Val  Acc: 0.3793
 Site-expw                      (2) | Val  Loss: 1.3339 | Val  Acc: 0.5000
 Site-FER                       (3) | Val  Loss: 1.9432 | Val  Acc: 0.1111
 Site-FER                       (3) | Val  Loss: 1.8697 | Val  Acc: 0.2432
 Site-jpWoman                   (0) | Val  Loss: 1.7711 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4579
============ Train epoch 34 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-FERG_DB_256               (1) | Train Loss: 1.1782 | Train Acc: 0.7778
 Site-FERG_DB_256               (1) | Train Loss: 1.3656 | Train Acc: 0.4643
 Site-FERG_DB_256               (1) | Train Loss: 1.3043 | Train Acc: 0.7381
 Site-FERG_DB_256               (1) | Train Loss: 1.3660 | Train Acc: 0.5484
 Site-FERG_DB_256               (1) | Train Loss: 1.3737 | Train Acc: 0.6702
 Site-expw                      (0) | Train Loss: 1.5479 | Train Acc: 0.4800
 Site-expw                      (0) | Train Loss: 1.4808 | Train Acc: 0.3488
 Site-expw                      (0) | Train Loss: 1.2799 | Train Acc: 0.4667
 Site-FER                       (2) | Train Loss: 1.8343 | Train Acc: 0.2857
 Site-FER                       (2) | Train Loss: 1.7697 | Train Acc: 0.2857
 Site-jpWoman                   (3) | Train Loss: 1.7328 | Train Acc: 0.4054
Average Train Accuracy: 0.4974
 Site-FERG_DB_256               (1) | Val  Loss: 1.2180 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.2129 | Val  Acc: 0.7778
 Site-FERG_DB_256               (1) | Val  Loss: 1.4061 | Val  Acc: 0.5714
 Site-FERG_DB_256               (1) | Val  Loss: 1.3706 | Val  Acc: 0.5366
 Site-FERG_DB_256               (1) | Val  Loss: 1.3065 | Val  Acc: 0.6774
 Site-expw                      (0) | Val  Loss: 1.4763 | Val  Acc: 0.2500
 Site-expw                      (0) | Val  Loss: 1.4146 | Val  Acc: 0.3793
 Site-expw                      (0) | Val  Loss: 1.3533 | Val  Acc: 0.4600
 Site-FER                       (2) | Val  Loss: 1.9013 | Val  Acc: 0.1667
 Site-FER                       (2) | Val  Loss: 1.8432 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.8390 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4700
============ Train epoch 35 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-FERG_DB_256               (1) | Train Loss: 1.2777 | Train Acc: 0.5556
 Site-FERG_DB_256               (1) | Train Loss: 1.2890 | Train Acc: 0.7143
 Site-FERG_DB_256               (1) | Train Loss: 1.3615 | Train Acc: 0.6190
 Site-FERG_DB_256               (1) | Train Loss: 1.2778 | Train Acc: 0.6774
 Site-FERG_DB_256               (1) | Train Loss: 1.2371 | Train Acc: 0.7021
 Site-expw                      (0) | Train Loss: 1.4491 | Train Acc: 0.4800
 Site-expw                      (0) | Train Loss: 1.4407 | Train Acc: 0.4186
 Site-expw                      (0) | Train Loss: 1.3574 | Train Acc: 0.4000
 Site-FER                       (2) | Train Loss: 1.8368 | Train Acc: 0.2143
 Site-FER                       (2) | Train Loss: 1.7847 | Train Acc: 0.3571
 Site-jpWoman                   (3) | Train Loss: 1.7958 | Train Acc: 0.2432
Average Train Accuracy: 0.4892
 Site-FERG_DB_256               (1) | Val  Loss: 1.2869 | Val  Acc: 0.7500
 Site-FERG_DB_256               (1) | Val  Loss: 1.2180 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.3522 | Val  Acc: 0.6429
 Site-FERG_DB_256               (1) | Val  Loss: 1.3619 | Val  Acc: 0.6098
 Site-FERG_DB_256               (1) | Val  Loss: 1.3293 | Val  Acc: 0.6129
 Site-expw                      (0) | Val  Loss: 1.4646 | Val  Acc: 0.1875
 Site-expw                      (0) | Val  Loss: 1.3339 | Val  Acc: 0.4138
 Site-expw                      (0) | Val  Loss: 1.3900 | Val  Acc: 0.4200
 Site-FER                       (2) | Val  Loss: 1.9045 | Val  Acc: 0.1667
 Site-FER                       (2) | Val  Loss: 1.8771 | Val  Acc: 0.2973
 Site-jpWoman                   (3) | Val  Loss: 1.7638 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4661
============ Train epoch 36 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-FERG_DB_256               (0) | Train Loss: 1.0574 | Train Acc: 0.8333
 Site-FERG_DB_256               (0) | Train Loss: 1.2667 | Train Acc: 0.7857
 Site-FERG_DB_256               (0) | Train Loss: 1.2538 | Train Acc: 0.6667
 Site-FERG_DB_256               (0) | Train Loss: 1.2541 | Train Acc: 0.6935
 Site-FERG_DB_256               (0) | Train Loss: 1.2791 | Train Acc: 0.6170
 Site-expw                      (1) | Train Loss: 1.4869 | Train Acc: 0.4400
 Site-expw                      (1) | Train Loss: 1.4045 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.3046 | Train Acc: 0.4133
 Site-FER                       (2) | Train Loss: 1.8100 | Train Acc: 0.3929
 Site-FER                       (2) | Train Loss: 1.7950 | Train Acc: 0.3750
 Site-jpWoman                   (3) | Train Loss: 1.7877 | Train Acc: 0.3243
Average Train Accuracy: 0.5397
 Site-FERG_DB_256               (0) | Val  Loss: 1.2154 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.2420 | Val  Acc: 0.6111
 Site-FERG_DB_256               (0) | Val  Loss: 1.3172 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.2810 | Val  Acc: 0.7073
 Site-FERG_DB_256               (0) | Val  Loss: 1.2830 | Val  Acc: 0.6774
 Site-expw                      (1) | Val  Loss: 1.4539 | Val  Acc: 0.2500
 Site-expw                      (1) | Val  Loss: 1.3934 | Val  Acc: 0.4483
 Site-expw                      (1) | Val  Loss: 1.3458 | Val  Acc: 0.4200
 Site-FER                       (2) | Val  Loss: 1.9682 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.8003 | Val  Acc: 0.3784
 Site-jpWoman                   (3) | Val  Loss: 1.7307 | Val  Acc: 0.3200
Average Valid Accuracy: 0.4898
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.7500
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.6111
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.7143
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.7073
 Best site-FERG_DB_256              (0)  | Epoch:36 | Val Acc: 0.6774
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.2500
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.4483
 Best site-expw                     (1)  | Epoch:36 | Val Acc: 0.4200
 Best site-FER                      (2)  | Epoch:36 | Val Acc: 0.1111
 Best site-FER                      (2)  | Epoch:36 | Val Acc: 0.3784
 Best site-jpWoman                  (3)  | Epoch:36 | Val Acc: 0.3200
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 37 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-FERG_DB_256               (0) | Train Loss: 1.1225 | Train Acc: 0.7778
 Site-FERG_DB_256               (0) | Train Loss: 1.2072 | Train Acc: 0.7857
 Site-FERG_DB_256               (0) | Train Loss: 1.2694 | Train Acc: 0.6905
 Site-FERG_DB_256               (0) | Train Loss: 1.2873 | Train Acc: 0.6935
 Site-FERG_DB_256               (0) | Train Loss: 1.2198 | Train Acc: 0.6915
 Site-expw                      (1) | Train Loss: 1.4245 | Train Acc: 0.4800
 Site-expw                      (3) | Train Loss: 1.3819 | Train Acc: 0.3953
 Site-expw                      (1) | Train Loss: 1.3015 | Train Acc: 0.4800
 Site-FER                       (2) | Train Loss: 1.7338 | Train Acc: 0.3929
 Site-FER                       (2) | Train Loss: 1.7618 | Train Acc: 0.3214
 Site-jpWoman                   (2) | Train Loss: 1.7522 | Train Acc: 0.3514
Average Train Accuracy: 0.5509
 Site-FERG_DB_256               (0) | Val  Loss: 1.2667 | Val  Acc: 0.6667
 Site-FERG_DB_256               (0) | Val  Loss: 1.1997 | Val  Acc: 0.7222
 Site-FERG_DB_256               (0) | Val  Loss: 1.2812 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.2935 | Val  Acc: 0.5366
 Site-FERG_DB_256               (0) | Val  Loss: 1.2662 | Val  Acc: 0.5968
 Site-expw                      (1) | Val  Loss: 1.4041 | Val  Acc: 0.5000
 Site-expw                      (3) | Val  Loss: 1.3468 | Val  Acc: 0.4138
 Site-expw                      (1) | Val  Loss: 1.3054 | Val  Acc: 0.5200
 Site-FER                       (2) | Val  Loss: 2.0143 | Val  Acc: 0.0556
 Site-FER                       (2) | Val  Loss: 1.9012 | Val  Acc: 0.2703
 Site-jpWoman                   (2) | Val  Loss: 1.7326 | Val  Acc: 0.3600
Average Valid Accuracy: 0.4869
============ Train epoch 38 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-FERG_DB_256               (1) | Train Loss: 1.2921 | Train Acc: 0.6111
 Site-FERG_DB_256               (1) | Train Loss: 1.3138 | Train Acc: 0.6429
 Site-FERG_DB_256               (1) | Train Loss: 1.2176 | Train Acc: 0.6667
 Site-FERG_DB_256               (1) | Train Loss: 1.2633 | Train Acc: 0.7581
 Site-FERG_DB_256               (1) | Train Loss: 1.2200 | Train Acc: 0.6915
 Site-expw                      (2) | Train Loss: 1.5271 | Train Acc: 0.4800
 Site-expw                      (2) | Train Loss: 1.3135 | Train Acc: 0.4186
 Site-expw                      (2) | Train Loss: 1.4034 | Train Acc: 0.4533
 Site-FER                       (3) | Train Loss: 1.7123 | Train Acc: 0.5000
 Site-FER                       (0) | Train Loss: 1.7967 | Train Acc: 0.3036
 Site-jpWoman                   (3) | Train Loss: 1.8347 | Train Acc: 0.3514
Average Train Accuracy: 0.5343
 Site-FERG_DB_256               (1) | Val  Loss: 1.1289 | Val  Acc: 0.7500
 Site-FERG_DB_256               (1) | Val  Loss: 1.1251 | Val  Acc: 0.7222
 Site-FERG_DB_256               (1) | Val  Loss: 1.2116 | Val  Acc: 0.7857
 Site-FERG_DB_256               (1) | Val  Loss: 1.3209 | Val  Acc: 0.6585
 Site-FERG_DB_256               (1) | Val  Loss: 1.2438 | Val  Acc: 0.7097
 Site-expw                      (2) | Val  Loss: 1.4847 | Val  Acc: 0.1875
 Site-expw                      (2) | Val  Loss: 1.3187 | Val  Acc: 0.5172
 Site-expw                      (2) | Val  Loss: 1.3255 | Val  Acc: 0.4800
 Site-FER                       (3) | Val  Loss: 1.9070 | Val  Acc: 0.1667
 Site-FER                       (0) | Val  Loss: 1.8837 | Val  Acc: 0.3514
 Site-jpWoman                   (3) | Val  Loss: 1.7243 | Val  Acc: 0.4800
Average Valid Accuracy: 0.5281
 Best site-FERG_DB_256              (1)  | Epoch:38 | Val Acc: 0.7500
 Best site-FERG_DB_256              (1)  | Epoch:38 | Val Acc: 0.7222
 Best site-FERG_DB_256              (1)  | Epoch:38 | Val Acc: 0.7857
 Best site-FERG_DB_256              (1)  | Epoch:38 | Val Acc: 0.6585
 Best site-FERG_DB_256              (1)  | Epoch:38 | Val Acc: 0.7097
 Best site-expw                     (2)  | Epoch:38 | Val Acc: 0.1875
 Best site-expw                     (2)  | Epoch:38 | Val Acc: 0.5172
 Best site-expw                     (2)  | Epoch:38 | Val Acc: 0.4800
 Best site-FER                      (3)  | Epoch:38 | Val Acc: 0.1667
 Best site-FER                      (0)  | Epoch:38 | Val Acc: 0.3514
 Best site-jpWoman                  (3)  | Epoch:38 | Val Acc: 0.4800
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 39 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-FERG_DB_256               (0) | Train Loss: 0.9676 | Train Acc: 0.8889
 Site-FERG_DB_256               (0) | Train Loss: 1.2537 | Train Acc: 0.6786
 Site-FERG_DB_256               (0) | Train Loss: 1.2510 | Train Acc: 0.7381
 Site-FERG_DB_256               (0) | Train Loss: 1.2436 | Train Acc: 0.6613
 Site-FERG_DB_256               (0) | Train Loss: 1.1522 | Train Acc: 0.6489
 Site-expw                      (1) | Train Loss: 1.4989 | Train Acc: 0.4000
 Site-expw                      (1) | Train Loss: 1.4233 | Train Acc: 0.3488
 Site-expw                      (1) | Train Loss: 1.2905 | Train Acc: 0.5067
 Site-FER                       (2) | Train Loss: 1.7138 | Train Acc: 0.3929
 Site-FER                       (2) | Train Loss: 1.7704 | Train Acc: 0.3393
 Site-jpWoman                   (3) | Train Loss: 1.7729 | Train Acc: 0.1892
Average Train Accuracy: 0.5266
 Site-FERG_DB_256               (0) | Val  Loss: 1.2043 | Val  Acc: 0.5833
 Site-FERG_DB_256               (0) | Val  Loss: 1.0930 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.2461 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.2284 | Val  Acc: 0.7317
 Site-FERG_DB_256               (0) | Val  Loss: 1.2637 | Val  Acc: 0.6452
 Site-expw                      (1) | Val  Loss: 1.3870 | Val  Acc: 0.4375
 Site-expw                      (1) | Val  Loss: 1.3123 | Val  Acc: 0.4828
 Site-expw                      (1) | Val  Loss: 1.3282 | Val  Acc: 0.5000
 Site-FER                       (2) | Val  Loss: 1.7821 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.8066 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.7644 | Val  Acc: 0.4000
Average Valid Accuracy: 0.5290
 Best site-FERG_DB_256              (0)  | Epoch:39 | Val Acc: 0.5833
 Best site-FERG_DB_256              (0)  | Epoch:39 | Val Acc: 0.7778
 Best site-FERG_DB_256              (0)  | Epoch:39 | Val Acc: 0.7143
 Best site-FERG_DB_256              (0)  | Epoch:39 | Val Acc: 0.7317
 Best site-FERG_DB_256              (0)  | Epoch:39 | Val Acc: 0.6452
 Best site-expw                     (1)  | Epoch:39 | Val Acc: 0.4375
 Best site-expw                     (1)  | Epoch:39 | Val Acc: 0.4828
 Best site-expw                     (1)  | Epoch:39 | Val Acc: 0.5000
 Best site-FER                      (2)  | Epoch:39 | Val Acc: 0.2222
 Best site-FER                      (2)  | Epoch:39 | Val Acc: 0.3243
 Best site-jpWoman                  (3)  | Epoch:39 | Val Acc: 0.4000
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 40 ============
cnt=[3, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-FERG_DB_256               (1) | Train Loss: 0.9927 | Train Acc: 0.7778
 Site-FERG_DB_256               (1) | Train Loss: 1.2139 | Train Acc: 0.6429
 Site-FERG_DB_256               (1) | Train Loss: 1.2324 | Train Acc: 0.6905
 Site-FERG_DB_256               (1) | Train Loss: 1.2240 | Train Acc: 0.7742
 Site-FERG_DB_256               (1) | Train Loss: 1.1356 | Train Acc: 0.7340
 Site-expw                      (2) | Train Loss: 1.4959 | Train Acc: 0.4800
 Site-expw                      (3) | Train Loss: 1.3770 | Train Acc: 0.4651
 Site-expw                      (2) | Train Loss: 1.2337 | Train Acc: 0.5467
 Site-FER                       (0) | Train Loss: 1.7760 | Train Acc: 0.3571
 Site-FER                       (0) | Train Loss: 1.7455 | Train Acc: 0.3750
 Site-jpWoman                   (0) | Train Loss: 1.7443 | Train Acc: 0.2973
Average Train Accuracy: 0.5582
 Site-FERG_DB_256               (1) | Val  Loss: 1.1424 | Val  Acc: 0.7500
 Site-FERG_DB_256               (1) | Val  Loss: 1.1074 | Val  Acc: 0.8333
 Site-FERG_DB_256               (1) | Val  Loss: 1.2752 | Val  Acc: 0.6786
 Site-FERG_DB_256               (1) | Val  Loss: 1.2973 | Val  Acc: 0.5366
 Site-FERG_DB_256               (1) | Val  Loss: 1.1907 | Val  Acc: 0.6935
 Site-expw                      (2) | Val  Loss: 1.3961 | Val  Acc: 0.3750
 Site-expw                      (3) | Val  Loss: 1.2775 | Val  Acc: 0.4828
 Site-expw                      (2) | Val  Loss: 1.3563 | Val  Acc: 0.4200
 Site-FER                       (0) | Val  Loss: 1.8538 | Val  Acc: 0.1111
 Site-FER                       (0) | Val  Loss: 1.8020 | Val  Acc: 0.3784
 Site-jpWoman                   (0) | Val  Loss: 1.7697 | Val  Acc: 0.3200
Average Valid Accuracy: 0.5072
 Test site-FERG_DB_256               (1)| Epoch:39 | Test Acc: 0.6721
 Test site-expw                      (2)| Epoch:39 | Test Acc: 0.2652
 Test site-FER                       (0)| Epoch:39 | Test Acc: 0.2426
 Test site-jpWoman                   (0)| Epoch:39 | Test Acc: 0.2759
FERG_DB_256: 0.6721, expw: 0.2652, FER: 0.2426, jpWoman: 0.2759, 
Average Test Accuracy(group): 0.3639, Average Test Accuracy(individual): 0.4470,
domain std=0.1783, cluster std=0.1779, individual std=0.2057, 
Average Test Accuracy: 0.3639
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 41 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-FERG_DB_256               (0) | Train Loss: 1.1597 | Train Acc: 0.7222
 Site-FERG_DB_256               (0) | Train Loss: 1.2837 | Train Acc: 0.6071
 Site-FERG_DB_256               (0) | Train Loss: 1.1747 | Train Acc: 0.7619
 Site-FERG_DB_256               (0) | Train Loss: 1.2160 | Train Acc: 0.6935
 Site-FERG_DB_256               (0) | Train Loss: 1.2116 | Train Acc: 0.7234
 Site-expw                      (1) | Train Loss: 1.5325 | Train Acc: 0.3200
 Site-expw                      (3) | Train Loss: 1.4366 | Train Acc: 0.3721
 Site-expw                      (1) | Train Loss: 1.3254 | Train Acc: 0.4400
 Site-FER                       (2) | Train Loss: 1.8068 | Train Acc: 0.2857
 Site-FER                       (2) | Train Loss: 1.7889 | Train Acc: 0.3750
 Site-jpWoman                   (2) | Train Loss: 1.7426 | Train Acc: 0.4054
Average Train Accuracy: 0.5188
 Site-FERG_DB_256               (0) | Val  Loss: 1.1482 | Val  Acc: 0.8333
 Site-FERG_DB_256               (0) | Val  Loss: 1.2589 | Val  Acc: 0.6667
 Site-FERG_DB_256               (0) | Val  Loss: 1.1976 | Val  Acc: 0.6786
 Site-FERG_DB_256               (0) | Val  Loss: 1.3055 | Val  Acc: 0.6829
 Site-FERG_DB_256               (0) | Val  Loss: 1.2376 | Val  Acc: 0.6935
 Site-expw                      (1) | Val  Loss: 1.3591 | Val  Acc: 0.4375
 Site-expw                      (3) | Val  Loss: 1.2666 | Val  Acc: 0.4828
 Site-expw                      (1) | Val  Loss: 1.2515 | Val  Acc: 0.5000
 Site-FER                       (2) | Val  Loss: 1.9359 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.9104 | Val  Acc: 0.2703
 Site-jpWoman                   (2) | Val  Loss: 1.7888 | Val  Acc: 0.2800
Average Valid Accuracy: 0.5225
 Test site-FERG_DB_256               (0)| Epoch:40 | Test Acc: 0.6757
 Test site-expw                      (1)| Epoch:40 | Test Acc: 0.2630
 Test site-FER                       (2)| Epoch:40 | Test Acc: 0.2426
 Test site-jpWoman                   (2)| Epoch:40 | Test Acc: 0.2759
FERG_DB_256: 0.6757, expw: 0.2630, FER: 0.2426, jpWoman: 0.2759, 
Average Test Accuracy(group): 0.3643, Average Test Accuracy(individual): 0.4481,
domain std=0.1802, cluster std=0.1801, individual std=0.2080, 
Average Test Accuracy: 0.3643
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-FERG_DB_256               (0) | Train Loss: 1.0729 | Train Acc: 0.6667
 Site-FERG_DB_256               (0) | Train Loss: 1.1706 | Train Acc: 0.6786
 Site-FERG_DB_256               (0) | Train Loss: 1.2009 | Train Acc: 0.7143
 Site-FERG_DB_256               (0) | Train Loss: 1.2420 | Train Acc: 0.6613
 Site-FERG_DB_256               (0) | Train Loss: 1.1143 | Train Acc: 0.7872
 Site-expw                      (1) | Train Loss: 1.4895 | Train Acc: 0.3600
 Site-expw                      (3) | Train Loss: 1.3327 | Train Acc: 0.4186
 Site-expw                      (1) | Train Loss: 1.3061 | Train Acc: 0.5067
 Site-FER                       (2) | Train Loss: 1.7619 | Train Acc: 0.2857
 Site-FER                       (2) | Train Loss: 1.8164 | Train Acc: 0.3214
 Site-jpWoman                   (2) | Train Loss: 1.7194 | Train Acc: 0.3784
Average Train Accuracy: 0.5253
 Site-FERG_DB_256               (0) | Val  Loss: 1.0670 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.1265 | Val  Acc: 0.8333
 Site-FERG_DB_256               (0) | Val  Loss: 1.1756 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.1980 | Val  Acc: 0.7317
 Site-FERG_DB_256               (0) | Val  Loss: 1.1915 | Val  Acc: 0.6935
 Site-expw                      (1) | Val  Loss: 1.4450 | Val  Acc: 0.1875
 Site-expw                      (3) | Val  Loss: 1.3024 | Val  Acc: 0.4828
 Site-expw                      (1) | Val  Loss: 1.3271 | Val  Acc: 0.4600
 Site-FER                       (2) | Val  Loss: 1.8972 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.8721 | Val  Acc: 0.3243
 Site-jpWoman                   (2) | Val  Loss: 1.7749 | Val  Acc: 0.2400
Average Valid Accuracy: 0.5159
 Test site-FERG_DB_256               (0)| Epoch:41 | Test Acc: 0.6812
 Test site-expw                      (1)| Epoch:41 | Test Acc: 0.2664
 Test site-FER                       (2)| Epoch:41 | Test Acc: 0.2426
 Test site-jpWoman                   (2)| Epoch:41 | Test Acc: 0.2759
FERG_DB_256: 0.6812, expw: 0.2664, FER: 0.2426, jpWoman: 0.2759, 
Average Test Accuracy(group): 0.3665, Average Test Accuracy(individual): 0.4514,
domain std=0.1821, cluster std=0.1815, individual std=0.2099, 
Average Test Accuracy: 0.3665
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-FERG_DB_256               (1) | Train Loss: 0.9973 | Train Acc: 0.7778
 Site-FERG_DB_256               (1) | Train Loss: 1.1860 | Train Acc: 0.7143
 Site-FERG_DB_256               (1) | Train Loss: 1.1688 | Train Acc: 0.7143
 Site-FERG_DB_256               (1) | Train Loss: 1.1299 | Train Acc: 0.6935
 Site-FERG_DB_256               (1) | Train Loss: 1.2048 | Train Acc: 0.7234
 Site-expw                      (3) | Train Loss: 1.4236 | Train Acc: 0.4400
 Site-expw                      (0) | Train Loss: 1.3373 | Train Acc: 0.5349
 Site-expw                      (0) | Train Loss: 1.3603 | Train Acc: 0.5333
 Site-FER                       (2) | Train Loss: 1.8327 | Train Acc: 0.3214
 Site-FER                       (2) | Train Loss: 1.7668 | Train Acc: 0.2679
 Site-jpWoman                   (2) | Train Loss: 1.7093 | Train Acc: 0.3243
Average Train Accuracy: 0.5496
 Site-FERG_DB_256               (1) | Val  Loss: 1.0439 | Val  Acc: 0.8333
 Site-FERG_DB_256               (1) | Val  Loss: 1.1350 | Val  Acc: 0.7222
 Site-FERG_DB_256               (1) | Val  Loss: 1.2155 | Val  Acc: 0.6786
 Site-FERG_DB_256               (1) | Val  Loss: 1.2578 | Val  Acc: 0.6829
 Site-FERG_DB_256               (1) | Val  Loss: 1.2270 | Val  Acc: 0.6452
 Site-expw                      (3) | Val  Loss: 1.3773 | Val  Acc: 0.3750
 Site-expw                      (0) | Val  Loss: 1.2600 | Val  Acc: 0.5862
 Site-expw                      (0) | Val  Loss: 1.3347 | Val  Acc: 0.4800
 Site-FER                       (2) | Val  Loss: 2.0236 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.8764 | Val  Acc: 0.2973
 Site-jpWoman                   (2) | Val  Loss: 1.7401 | Val  Acc: 0.3600
Average Valid Accuracy: 0.5247
 Test site-FERG_DB_256               (1)| Epoch:42 | Test Acc: 0.6957
 Test site-expw                      (3)| Epoch:42 | Test Acc: 0.2675
 Test site-FER                       (2)| Epoch:42 | Test Acc: 0.2418
 Test site-jpWoman                   (2)| Epoch:42 | Test Acc: 0.2759
FERG_DB_256: 0.6957, expw: 0.2675, FER: 0.2418, jpWoman: 0.2759, 
Average Test Accuracy(group): 0.3702, Average Test Accuracy(individual): 0.4582,
domain std=0.1883, cluster std=0.1876, individual std=0.2170, 
Average Test Accuracy: 0.3702
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 44 ============
cnt=[1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-FERG_DB_256               (1) | Train Loss: 1.0055 | Train Acc: 0.8333
 Site-FERG_DB_256               (1) | Train Loss: 1.1591 | Train Acc: 0.7500
 Site-FERG_DB_256               (1) | Train Loss: 1.1871 | Train Acc: 0.6905
 Site-FERG_DB_256               (1) | Train Loss: 1.1388 | Train Acc: 0.7258
 Site-FERG_DB_256               (1) | Train Loss: 1.1666 | Train Acc: 0.6596
 Site-expw                      (0) | Train Loss: 1.4234 | Train Acc: 0.6000
 Site-expw                      (3) | Train Loss: 1.3556 | Train Acc: 0.3721
 Site-expw                      (3) | Train Loss: 1.2743 | Train Acc: 0.4533
 Site-FER                       (2) | Train Loss: 1.7721 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.7036 | Train Acc: 0.3571
 Site-jpWoman                   (2) | Train Loss: 1.7526 | Train Acc: 0.2432
Average Train Accuracy: 0.5395
 Site-FERG_DB_256               (1) | Val  Loss: 1.0326 | Val  Acc: 0.8333
 Site-FERG_DB_256               (1) | Val  Loss: 1.0497 | Val  Acc: 0.7222
 Site-FERG_DB_256               (1) | Val  Loss: 1.2635 | Val  Acc: 0.6071
 Site-FERG_DB_256               (1) | Val  Loss: 1.2435 | Val  Acc: 0.7317
 Site-FERG_DB_256               (1) | Val  Loss: 1.1584 | Val  Acc: 0.6774
 Site-expw                      (0) | Val  Loss: 1.4143 | Val  Acc: 0.5625
 Site-expw                      (3) | Val  Loss: 1.2692 | Val  Acc: 0.4138
 Site-expw                      (3) | Val  Loss: 1.2571 | Val  Acc: 0.5200
 Site-FER                       (2) | Val  Loss: 1.8977 | Val  Acc: 0.2222
 Site-FER                       (2) | Val  Loss: 1.7786 | Val  Acc: 0.3784
 Site-jpWoman                   (2) | Val  Loss: 1.7323 | Val  Acc: 0.4400
Average Valid Accuracy: 0.5553
 Best site-FERG_DB_256              (1)  | Epoch:44 | Val Acc: 0.8333
 Best site-FERG_DB_256              (1)  | Epoch:44 | Val Acc: 0.7222
 Best site-FERG_DB_256              (1)  | Epoch:44 | Val Acc: 0.6071
 Best site-FERG_DB_256              (1)  | Epoch:44 | Val Acc: 0.7317
 Best site-FERG_DB_256              (1)  | Epoch:44 | Val Acc: 0.6774
 Best site-expw                     (0)  | Epoch:44 | Val Acc: 0.5625
 Best site-expw                     (3)  | Epoch:44 | Val Acc: 0.4138
 Best site-expw                     (3)  | Epoch:44 | Val Acc: 0.5200
 Best site-FER                      (2)  | Epoch:44 | Val Acc: 0.2222
 Best site-FER                      (2)  | Epoch:44 | Val Acc: 0.3784
 Best site-jpWoman                  (2)  | Epoch:44 | Val Acc: 0.4400
 Test site-FERG_DB_256               (1)| Epoch:44 | Test Acc: 0.6866
 Test site-expw                      (0)| Epoch:44 | Test Acc: 0.2720
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.2433
 Test site-jpWoman                   (2)| Epoch:44 | Test Acc: 0.2874
FERG_DB_256: 0.6866, expw: 0.2720, FER: 0.2433, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3723, Average Test Accuracy(individual): 0.4566,
domain std=0.1821, cluster std=0.1816, individual std=0.2103, 
Average Test Accuracy: 0.3723
 Saving the gmap checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_expression_uneven_1.7_1/ccop_q=1...
============ Train epoch 45 ============
cnt=[5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-FERG_DB_256               (0) | Train Loss: 1.0373 | Train Acc: 0.7222
 Site-FERG_DB_256               (0) | Train Loss: 1.2100 | Train Acc: 0.6786
 Site-FERG_DB_256               (0) | Train Loss: 1.1467 | Train Acc: 0.7619
 Site-FERG_DB_256               (0) | Train Loss: 1.2118 | Train Acc: 0.6452
 Site-FERG_DB_256               (0) | Train Loss: 1.0979 | Train Acc: 0.7128
 Site-expw                      (3) | Train Loss: 1.4385 | Train Acc: 0.6000
 Site-expw                      (1) | Train Loss: 1.2945 | Train Acc: 0.4651
 Site-expw                      (1) | Train Loss: 1.3846 | Train Acc: 0.5200
 Site-FER                       (2) | Train Loss: 1.6613 | Train Acc: 0.5000
 Site-FER                       (2) | Train Loss: 1.7846 | Train Acc: 0.3214
 Site-jpWoman                   (2) | Train Loss: 1.6432 | Train Acc: 0.4595
Average Train Accuracy: 0.5806
 Site-FERG_DB_256               (0) | Val  Loss: 1.1596 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.1251 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.1891 | Val  Acc: 0.6429
 Site-FERG_DB_256               (0) | Val  Loss: 1.2192 | Val  Acc: 0.6585
 Site-FERG_DB_256               (0) | Val  Loss: 1.1276 | Val  Acc: 0.7097
 Site-expw                      (3) | Val  Loss: 1.5049 | Val  Acc: 0.3125
 Site-expw                      (1) | Val  Loss: 1.3184 | Val  Acc: 0.4483
 Site-expw                      (1) | Val  Loss: 1.3053 | Val  Acc: 0.4800
 Site-FER                       (2) | Val  Loss: 1.8645 | Val  Acc: 0.2778
 Site-FER                       (2) | Val  Loss: 1.8397 | Val  Acc: 0.1622
 Site-jpWoman                   (2) | Val  Loss: 1.7601 | Val  Acc: 0.2800
Average Valid Accuracy: 0.5000
 Test site-FERG_DB_256               (0)| Epoch:44 | Test Acc: 0.6866
 Test site-expw                      (3)| Epoch:44 | Test Acc: 0.2630
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.2449
 Test site-jpWoman                   (2)| Epoch:44 | Test Acc: 0.2874
FERG_DB_256: 0.6866, expw: 0.2630, FER: 0.2449, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3704, Average Test Accuracy(individual): 0.4545,
domain std=0.1832, cluster std=0.1840, individual std=0.2122, 
Average Test Accuracy: 0.3704
============ Train epoch 46 ============
cnt=[3, 1, 3, 4, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-FERG_DB_256               (3) | Train Loss: 1.0476 | Train Acc: 0.7778
 Site-FERG_DB_256               (1) | Train Loss: 1.2361 | Train Acc: 0.6786
 Site-FERG_DB_256               (3) | Train Loss: 1.1465 | Train Acc: 0.7381
 Site-FERG_DB_256               (3) | Train Loss: 1.1350 | Train Acc: 0.6613
 Site-FERG_DB_256               (3) | Train Loss: 1.1497 | Train Acc: 0.7766
 Site-expw                      (0) | Train Loss: 1.4918 | Train Acc: 0.4800
 Site-expw                      (0) | Train Loss: 1.3176 | Train Acc: 0.4419
 Site-expw                      (0) | Train Loss: 1.3128 | Train Acc: 0.4667
 Site-FER                       (2) | Train Loss: 1.7872 | Train Acc: 0.3571
 Site-FER                       (2) | Train Loss: 1.7312 | Train Acc: 0.4286
 Site-jpWoman                   (2) | Train Loss: 1.6868 | Train Acc: 0.3243
Average Train Accuracy: 0.5574
 Site-FERG_DB_256               (3) | Val  Loss: 1.1914 | Val  Acc: 0.6667
 Site-FERG_DB_256               (1) | Val  Loss: 1.1155 | Val  Acc: 0.7778
 Site-FERG_DB_256               (3) | Val  Loss: 1.2469 | Val  Acc: 0.5714
 Site-FERG_DB_256               (3) | Val  Loss: 1.1509 | Val  Acc: 0.7805
 Site-FERG_DB_256               (3) | Val  Loss: 1.1412 | Val  Acc: 0.7419
 Site-expw                      (0) | Val  Loss: 1.3905 | Val  Acc: 0.4375
 Site-expw                      (0) | Val  Loss: 1.2854 | Val  Acc: 0.5172
 Site-expw                      (0) | Val  Loss: 1.3409 | Val  Acc: 0.4400
 Site-FER                       (2) | Val  Loss: 1.8998 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.8688 | Val  Acc: 0.3243
 Site-jpWoman                   (2) | Val  Loss: 1.6433 | Val  Acc: 0.4400
Average Valid Accuracy: 0.5280
 Test site-FERG_DB_256               (3)| Epoch:44 | Test Acc: 0.6884
 Test site-expw                      (0)| Epoch:44 | Test Acc: 0.2596
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.2456
 Test site-jpWoman                   (2)| Epoch:44 | Test Acc: 0.2874
FERG_DB_256: 0.6884, expw: 0.2596, FER: 0.2456, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3702, Average Test Accuracy(individual): 0.4545,
domain std=0.1843, cluster std=0.2144, individual std=0.2138, 
Average Test Accuracy: 0.3702
============ Train epoch 47 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-FERG_DB_256               (0) | Train Loss: 0.9522 | Train Acc: 0.7778
 Site-FERG_DB_256               (0) | Train Loss: 1.1624 | Train Acc: 0.8214
 Site-FERG_DB_256               (0) | Train Loss: 1.1282 | Train Acc: 0.7381
 Site-FERG_DB_256               (0) | Train Loss: 1.0746 | Train Acc: 0.7742
 Site-FERG_DB_256               (0) | Train Loss: 1.0936 | Train Acc: 0.7447
 Site-expw                      (3) | Train Loss: 1.4535 | Train Acc: 0.4800
 Site-expw                      (2) | Train Loss: 1.3381 | Train Acc: 0.3953
 Site-expw                      (2) | Train Loss: 1.1623 | Train Acc: 0.5467
 Site-FER                       (1) | Train Loss: 1.7112 | Train Acc: 0.3929
 Site-FER                       (1) | Train Loss: 1.7399 | Train Acc: 0.3393
 Site-jpWoman                   (1) | Train Loss: 1.7356 | Train Acc: 0.3243
Average Train Accuracy: 0.5759
 Site-FERG_DB_256               (0) | Val  Loss: 1.1161 | Val  Acc: 0.5833
 Site-FERG_DB_256               (0) | Val  Loss: 1.0606 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.2043 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.2674 | Val  Acc: 0.5610
 Site-FERG_DB_256               (0) | Val  Loss: 1.1311 | Val  Acc: 0.7742
 Site-expw                      (3) | Val  Loss: 1.4077 | Val  Acc: 0.5625
 Site-expw                      (2) | Val  Loss: 1.2305 | Val  Acc: 0.5517
 Site-expw                      (2) | Val  Loss: 1.3258 | Val  Acc: 0.3800
 Site-FER                       (1) | Val  Loss: 1.9207 | Val  Acc: 0.1667
 Site-FER                       (1) | Val  Loss: 1.8086 | Val  Acc: 0.2162
 Site-jpWoman                   (1) | Val  Loss: 1.7632 | Val  Acc: 0.2800
Average Valid Accuracy: 0.5062
 Test site-FERG_DB_256               (0)| Epoch:44 | Test Acc: 0.6812
 Test site-expw                      (3)| Epoch:44 | Test Acc: 0.2585
 Test site-FER                       (1)| Epoch:44 | Test Acc: 0.2449
 Test site-jpWoman                   (1)| Epoch:44 | Test Acc: 0.2989
FERG_DB_256: 0.6812, expw: 0.2585, FER: 0.2449, jpWoman: 0.2989, 
Average Test Accuracy(group): 0.3708, Average Test Accuracy(individual): 0.4518,
domain std=0.1803, cluster std=0.1824, individual std=0.2098, 
Average Test Accuracy: 0.3708
============ Train epoch 48 ============
cnt=[5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-FERG_DB_256               (0) | Train Loss: 0.9616 | Train Acc: 0.8333
 Site-FERG_DB_256               (0) | Train Loss: 1.1154 | Train Acc: 0.7500
 Site-FERG_DB_256               (0) | Train Loss: 1.1166 | Train Acc: 0.7381
 Site-FERG_DB_256               (0) | Train Loss: 1.1394 | Train Acc: 0.7097
 Site-FERG_DB_256               (0) | Train Loss: 1.1271 | Train Acc: 0.7128
 Site-expw                      (1) | Train Loss: 1.4040 | Train Acc: 0.4400
 Site-expw                      (1) | Train Loss: 1.3198 | Train Acc: 0.4186
 Site-expw                      (1) | Train Loss: 1.3349 | Train Acc: 0.5067
 Site-FER                       (2) | Train Loss: 1.8258 | Train Acc: 0.2500
 Site-FER                       (2) | Train Loss: 1.7401 | Train Acc: 0.3750
 Site-jpWoman                   (3) | Train Loss: 1.6433 | Train Acc: 0.4054
Average Train Accuracy: 0.5581
 Site-FERG_DB_256               (0) | Val  Loss: 1.1057 | Val  Acc: 0.7500
 Site-FERG_DB_256               (0) | Val  Loss: 1.0503 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.1201 | Val  Acc: 0.7143
 Site-FERG_DB_256               (0) | Val  Loss: 1.2237 | Val  Acc: 0.7073
 Site-FERG_DB_256               (0) | Val  Loss: 1.1094 | Val  Acc: 0.7581
 Site-expw                      (1) | Val  Loss: 1.2995 | Val  Acc: 0.4375
 Site-expw                      (1) | Val  Loss: 1.2628 | Val  Acc: 0.5517
 Site-expw                      (1) | Val  Loss: 1.2894 | Val  Acc: 0.5600
 Site-FER                       (2) | Val  Loss: 1.9586 | Val  Acc: 0.1111
 Site-FER                       (2) | Val  Loss: 1.8168 | Val  Acc: 0.3243
 Site-jpWoman                   (3) | Val  Loss: 1.7095 | Val  Acc: 0.4400
Average Valid Accuracy: 0.5575
 Best site-FERG_DB_256              (0)  | Epoch:48 | Val Acc: 0.7500
 Best site-FERG_DB_256              (0)  | Epoch:48 | Val Acc: 0.7778
 Best site-FERG_DB_256              (0)  | Epoch:48 | Val Acc: 0.7143
 Best site-FERG_DB_256              (0)  | Epoch:48 | Val Acc: 0.7073
 Best site-FERG_DB_256              (0)  | Epoch:48 | Val Acc: 0.7581
 Best site-expw                     (1)  | Epoch:48 | Val Acc: 0.4375
 Best site-expw                     (1)  | Epoch:48 | Val Acc: 0.5517
 Best site-expw                     (1)  | Epoch:48 | Val Acc: 0.5600
 Best site-FER                      (2)  | Epoch:48 | Val Acc: 0.1111
 Best site-FER                      (2)  | Epoch:48 | Val Acc: 0.3243
 Best site-jpWoman                  (3)  | Epoch:48 | Val Acc: 0.4400
 Test site-FERG_DB_256               (0)| Epoch:48 | Test Acc: 0.6649
 Test site-expw                      (1)| Epoch:48 | Test Acc: 0.2551
 Test site-FER                       (2)| Epoch:48 | Test Acc: 0.2449
 Test site-jpWoman                   (3)| Epoch:48 | Test Acc: 0.2874
FERG_DB_256: 0.6649, expw: 0.2551, FER: 0.2449, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3630, Average Test Accuracy(individual): 0.4424,
domain std=0.1750, cluster std=0.1750, individual std=0.2033, 
Average Test Accuracy: 0.3630
============ Train epoch 49 ============
cnt=[5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-FERG_DB_256               (0) | Train Loss: 1.0206 | Train Acc: 0.7778
 Site-FERG_DB_256               (0) | Train Loss: 1.0887 | Train Acc: 0.8571
 Site-FERG_DB_256               (0) | Train Loss: 1.1109 | Train Acc: 0.7619
 Site-FERG_DB_256               (0) | Train Loss: 1.1296 | Train Acc: 0.7419
 Site-FERG_DB_256               (0) | Train Loss: 1.1330 | Train Acc: 0.7553
 Site-expw                      (1) | Train Loss: 1.4007 | Train Acc: 0.4800
 Site-expw                      (3) | Train Loss: 1.3861 | Train Acc: 0.4186
 Site-expw                      (3) | Train Loss: 1.2249 | Train Acc: 0.5200
 Site-FER                       (2) | Train Loss: 1.6670 | Train Acc: 0.3571
 Site-FER                       (2) | Train Loss: 1.6675 | Train Acc: 0.4107
 Site-jpWoman                   (2) | Train Loss: 1.6441 | Train Acc: 0.4595
Average Train Accuracy: 0.5945
 Site-FERG_DB_256               (0) | Val  Loss: 1.0291 | Val  Acc: 0.8333
 Site-FERG_DB_256               (0) | Val  Loss: 1.0402 | Val  Acc: 0.7778
 Site-FERG_DB_256               (0) | Val  Loss: 1.1183 | Val  Acc: 0.7857
 Site-FERG_DB_256               (0) | Val  Loss: 1.2316 | Val  Acc: 0.6098
 Site-FERG_DB_256               (0) | Val  Loss: 1.1455 | Val  Acc: 0.7258
 Site-expw                      (1) | Val  Loss: 1.3985 | Val  Acc: 0.3750
 Site-expw                      (3) | Val  Loss: 1.2147 | Val  Acc: 0.5172
 Site-expw                      (3) | Val  Loss: 1.3255 | Val  Acc: 0.4400
 Site-FER                       (2) | Val  Loss: 1.8444 | Val  Acc: 0.3333
 Site-FER                       (2) | Val  Loss: 1.7486 | Val  Acc: 0.4054
 Site-jpWoman                   (2) | Val  Loss: 1.6405 | Val  Acc: 0.4400
Average Valid Accuracy: 0.5676
 Best site-FERG_DB_256              (0)  | Epoch:49 | Val Acc: 0.8333
 Best site-FERG_DB_256              (0)  | Epoch:49 | Val Acc: 0.7778
 Best site-FERG_DB_256              (0)  | Epoch:49 | Val Acc: 0.7857
 Best site-FERG_DB_256              (0)  | Epoch:49 | Val Acc: 0.6098
 Best site-FERG_DB_256              (0)  | Epoch:49 | Val Acc: 0.7258
 Best site-expw                     (1)  | Epoch:49 | Val Acc: 0.3750
 Best site-expw                     (3)  | Epoch:49 | Val Acc: 0.5172
 Best site-expw                     (3)  | Epoch:49 | Val Acc: 0.4400
 Best site-FER                      (2)  | Epoch:49 | Val Acc: 0.3333
 Best site-FER                      (2)  | Epoch:49 | Val Acc: 0.4054
 Best site-jpWoman                  (2)  | Epoch:49 | Val Acc: 0.4400
 Test site-FERG_DB_256               (0)| Epoch:49 | Test Acc: 0.6504
 Test site-expw                      (1)| Epoch:49 | Test Acc: 0.2517
 Test site-FER                       (2)| Epoch:49 | Test Acc: 0.2426
 Test site-jpWoman                   (2)| Epoch:49 | Test Acc: 0.2874
FERG_DB_256: 0.6504, expw: 0.2517, FER: 0.2426, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3580, Average Test Accuracy(individual): 0.4345,
domain std=0.1696, cluster std=0.1718, individual std=0.1974, 
Average Test Accuracy: 0.3580
===2023-08-09 12:13:42===
===2023-08-09 12:13:49===
===Setting===
    dataset: expression
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[18,28,42,62,94,25,43,75,28,56,37,
client_nums=[5,3,2,1,]
len_dataset=[821,482,284,126,]
domain number = 4
Loading snapshots...
 Test site-FERG_DB_256               (1)| Epoch:44 | Test Acc: 0.6866
 Test site-expw                      (0)| Epoch:44 | Test Acc: 0.2720
 Test site-FER                       (2)| Epoch:44 | Test Acc: 0.2433
 Test site-jpWoman                   (2)| Epoch:44 | Test Acc: 0.2874
FERG_DB_256: 0.6866, expw: 0.2720, FER: 0.2433, jpWoman: 0.2874, 
Average Test Accuracy(group): 0.3723, Average Test Accuracy(individual): 0.4566,
domain std=0.1821, cluster std=0.1816, individual std=0.2103, 
