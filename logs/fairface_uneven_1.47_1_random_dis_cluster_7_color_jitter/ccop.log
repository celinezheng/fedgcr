===2023-05-25 14:18:57===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
data_number=[18,26,39,57,85,125,183,270,397,584,41,60,89,131,192,283,416,66,97,143,210,309,121,178,262,154,227,259,176,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[2980,2027,1378,937,637,433,294,]
label set of clients: [7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[7, 15, 1, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7699 | Train Acc: 0.3889
 Site-White                    | Train Loss: 2.1076 | Train Acc: 0.2692
 Site-White                    | Train Loss: 1.8508 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.8297 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.8454 | Train Acc: 0.3647
 Site-White                    | Train Loss: 1.8080 | Train Acc: 0.3600
 Site-White                    | Train Loss: 1.8611 | Train Acc: 0.3497
 Site-White                    | Train Loss: 1.8822 | Train Acc: 0.3556
 Site-White                    | Train Loss: 1.8587 | Train Acc: 0.3375
 Site-White                    | Train Loss: 1.8855 | Train Acc: 0.3425
 Site-Latino_Hispanic          | Train Loss: 2.0571 | Train Acc: 0.2439
 Site-Latino_Hispanic          | Train Loss: 1.9960 | Train Acc: 0.2333
 Site-Latino_Hispanic          | Train Loss: 1.9840 | Train Acc: 0.2247
 Site-Latino_Hispanic          | Train Loss: 2.2046 | Train Acc: 0.2672
 Site-Latino_Hispanic          | Train Loss: 2.0305 | Train Acc: 0.2552
 Site-Latino_Hispanic          | Train Loss: 1.9693 | Train Acc: 0.2721
 Site-Latino_Hispanic          | Train Loss: 1.9996 | Train Acc: 0.2716
 Site-Black                    | Train Loss: 1.8036 | Train Acc: 0.2273
 Site-Black                    | Train Loss: 2.0974 | Train Acc: 0.2474
 Site-Black                    | Train Loss: 2.0539 | Train Acc: 0.2168
 Site-Black                    | Train Loss: 1.9900 | Train Acc: 0.2619
 Site-Black                    | Train Loss: 2.0657 | Train Acc: 0.2492
 Site-East_Asian               | Train Loss: 1.8599 | Train Acc: 0.3802
 Site-East_Asian               | Train Loss: 1.8806 | Train Acc: 0.3708
 Site-East_Asian               | Train Loss: 1.8288 | Train Acc: 0.3779
 Site-Indian                   | Train Loss: 2.0903 | Train Acc: 0.2208
 Site-Indian                   | Train Loss: 2.1127 | Train Acc: 0.2247
 Site-Southeast_Asian          | Train Loss: 1.9969 | Train Acc: 0.3127
 Site-Middle_Eastern           | Train Loss: 2.0559 | Train Acc: 0.2386
 Site-White                     (1) | Val  Loss: 2.3634 | Val  Acc: 0.1667
 Site-White                     (1) | Val  Loss: 1.5798 | Val  Acc: 0.4706
 Site-White                     (2) | Val  Loss: 1.6508 | Val  Acc: 0.5000
 Site-White                     (4) | Val  Loss: 1.8615 | Val  Acc: 0.3421
 Site-White                     (4) | Val  Loss: 1.7454 | Val  Acc: 0.3571
 Site-White                     (0) | Val  Loss: 1.8475 | Val  Acc: 0.3373
 Site-White                     (0) | Val  Loss: 1.8918 | Val  Acc: 0.3197
 Site-White                     (0) | Val  Loss: 1.8715 | Val  Acc: 0.3556
 Site-White                     (1) | Val  Loss: 2.0489 | Val  Acc: 0.3333
 Site-White                     (0) | Val  Loss: 2.0307 | Val  Acc: 0.3548
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8722 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9041 | Val  Acc: 0.3500
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9993 | Val  Acc: 0.2712
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9284 | Val  Acc: 0.3103
 Site-Latino_Hispanic           (1) | Val  Loss: 2.0391 | Val  Acc: 0.2422
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9824 | Val  Acc: 0.2606
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9489 | Val  Acc: 0.2852
 Site-Black                     (1) | Val  Loss: 2.2107 | Val  Acc: 0.1364
 Site-Black                     (1) | Val  Loss: 2.1284 | Val  Acc: 0.2031
 Site-Black                     (1) | Val  Loss: 2.1494 | Val  Acc: 0.2105
 Site-Black                     (1) | Val  Loss: 1.8788 | Val  Acc: 0.2286
 Site-Black                     (1) | Val  Loss: 1.9864 | Val  Acc: 0.2476
 Site-East_Asian                (0) | Val  Loss: 1.9585 | Val  Acc: 0.3875
 Site-East_Asian                (0) | Val  Loss: 1.7974 | Val  Acc: 0.3983
 Site-East_Asian                (1) | Val  Loss: 1.8842 | Val  Acc: 0.3563
 Site-Indian                    (1) | Val  Loss: 2.1649 | Val  Acc: 0.2255
 Site-Indian                    (1) | Val  Loss: 2.1687 | Val  Acc: 0.2252
 Site-Southeast_Asian           (1) | Val  Loss: 2.0805 | Val  Acc: 0.3006
 Site-Middle_Eastern            (1) | Val  Loss: 1.9877 | Val  Acc: 0.2479
Average Valid Accuracy: 0.3007
Aggregated Acc | Val Acc: 0.3417
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.1667
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.4706
 Best site-White                    (2)  | Epoch:0 | Val Acc: 0.5000
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.3421
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.3571
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3373
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3197
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3556
 Best site-White                    (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3548
 Best site-Latino_Hispanic          (3)  | Epoch:0 | Val Acc: 0.2963
 Best site-Latino_Hispanic          (5)  | Epoch:0 | Val Acc: 0.3500
 Best site-Latino_Hispanic          (6)  | Epoch:0 | Val Acc: 0.2712
 Best site-Latino_Hispanic          (6)  | Epoch:0 | Val Acc: 0.3103
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2422
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2606
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2852
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.1364
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2031
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2105
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2286
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2476
 Best site-East_Asian               (0)  | Epoch:0 | Val Acc: 0.3875
 Best site-East_Asian               (0)  | Epoch:0 | Val Acc: 0.3983
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.3563
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.2255
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.2252
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.3006
 Best site-Middle_Eastern           (1)  | Epoch:0 | Val Acc: 0.2479
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 6, 3, 1, 1, 16, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6794 | Train Acc: 0.3333
 Site-White                    | Train Loss: 2.0260 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.8410 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.8296 | Train Acc: 0.3509
 Site-White                    | Train Loss: 1.8603 | Train Acc: 0.4118
 Site-White                    | Train Loss: 1.7865 | Train Acc: 0.3680
 Site-White                    | Train Loss: 1.8099 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.9179 | Train Acc: 0.3222
 Site-White                    | Train Loss: 1.8811 | Train Acc: 0.3300
 Site-White                    | Train Loss: 1.8651 | Train Acc: 0.3493
 Site-Latino_Hispanic          | Train Loss: 1.9798 | Train Acc: 0.2439
 Site-Latino_Hispanic          | Train Loss: 1.9292 | Train Acc: 0.2333
 Site-Latino_Hispanic          | Train Loss: 1.9336 | Train Acc: 0.2921
 Site-Latino_Hispanic          | Train Loss: 1.7524 | Train Acc: 0.2748
 Site-Latino_Hispanic          | Train Loss: 1.9803 | Train Acc: 0.2448
 Site-Latino_Hispanic          | Train Loss: 1.9106 | Train Acc: 0.2792
 Site-Latino_Hispanic          | Train Loss: 1.9619 | Train Acc: 0.2620
 Site-Black                    | Train Loss: 2.1372 | Train Acc: 0.1970
 Site-Black                    | Train Loss: 1.9068 | Train Acc: 0.2784
 Site-Black                    | Train Loss: 2.0606 | Train Acc: 0.2238
 Site-Black                    | Train Loss: 1.9346 | Train Acc: 0.2333
 Site-Black                    | Train Loss: 2.0251 | Train Acc: 0.2362
 Site-East_Asian               | Train Loss: 1.8074 | Train Acc: 0.3388
 Site-East_Asian               | Train Loss: 1.8518 | Train Acc: 0.3202
 Site-East_Asian               | Train Loss: 1.8769 | Train Acc: 0.3473
 Site-Indian                   | Train Loss: 2.0967 | Train Acc: 0.2403
 Site-Indian                   | Train Loss: 2.0991 | Train Acc: 0.2291
 Site-Southeast_Asian          | Train Loss: 1.9658 | Train Acc: 0.3205
 Site-Middle_Eastern           | Train Loss: 2.0050 | Train Acc: 0.2330
 Site-White                     (0) | Val  Loss: 2.1836 | Val  Acc: 0.0833
 Site-White                     (4) | Val  Loss: 1.6409 | Val  Acc: 0.2941
 Site-White                     (6) | Val  Loss: 1.6400 | Val  Acc: 0.4615
 Site-White                     (3) | Val  Loss: 1.8124 | Val  Acc: 0.3947
 Site-White                     (5) | Val  Loss: 1.7258 | Val  Acc: 0.4464
 Site-White                     (5) | Val  Loss: 1.8161 | Val  Acc: 0.3494
 Site-White                     (5) | Val  Loss: 1.8838 | Val  Acc: 0.2951
 Site-White                     (5) | Val  Loss: 1.8483 | Val  Acc: 0.3278
 Site-White                     (5) | Val  Loss: 1.9721 | Val  Acc: 0.3333
 Site-White                     (5) | Val  Loss: 1.9935 | Val  Acc: 0.3033
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8156 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8865 | Val  Acc: 0.3250
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9270 | Val  Acc: 0.3729
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9285 | Val  Acc: 0.2759
 Site-Latino_Hispanic           (5) | Val  Loss: 2.0096 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9481 | Val  Acc: 0.2553
 Site-Latino_Hispanic           (5) | Val  Loss: 1.9544 | Val  Acc: 0.2527
 Site-Black                     (1) | Val  Loss: 2.1573 | Val  Acc: 0.1818
 Site-Black                     (1) | Val  Loss: 2.0405 | Val  Acc: 0.2344
 Site-Black                     (1) | Val  Loss: 2.0526 | Val  Acc: 0.2526
 Site-Black                     (1) | Val  Loss: 1.7995 | Val  Acc: 0.2214
 Site-Black                     (1) | Val  Loss: 1.9766 | Val  Acc: 0.2330
 Site-East_Asian                (2) | Val  Loss: 1.9328 | Val  Acc: 0.3625
 Site-East_Asian                (2) | Val  Loss: 1.7446 | Val  Acc: 0.3644
 Site-East_Asian                (2) | Val  Loss: 1.8726 | Val  Acc: 0.2931
 Site-Indian                    (5) | Val  Loss: 2.1515 | Val  Acc: 0.2157
 Site-Indian                    (1) | Val  Loss: 2.1345 | Val  Acc: 0.2053
 Site-Southeast_Asian           (5) | Val  Loss: 2.0542 | Val  Acc: 0.3121
 Site-Middle_Eastern            (5) | Val  Loss: 1.9513 | Val  Acc: 0.2308
Average Valid Accuracy: 0.2905
Aggregated Acc | Val Acc: 0.2997
============ Train epoch 2 ============
===2023-05-25 14:30:48===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
data_number=[18,26,39,57,85,125,183,270,397,584,41,60,89,131,192,283,416,66,97,143,210,309,121,178,262,154,227,259,176,]
client_nums=[10,7,5,3,2,1,1,]
len_dataset=[2980,2027,1378,937,637,433,294,]
label set of clients: [7, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, 9, ]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[7, 8, 1, 1, 10, 1, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7872 | Train Acc: 0.3889
 Site-White                    | Train Loss: 2.0154 | Train Acc: 0.3077
 Site-White                    | Train Loss: 1.8908 | Train Acc: 0.2821
 Site-White                    | Train Loss: 1.8290 | Train Acc: 0.3509
 Site-White                    | Train Loss: 1.8665 | Train Acc: 0.3647
 Site-White                    | Train Loss: 1.8052 | Train Acc: 0.3360
 Site-White                    | Train Loss: 1.8714 | Train Acc: 0.3005
 Site-White                    | Train Loss: 1.8589 | Train Acc: 0.3296
 Site-White                    | Train Loss: 1.8342 | Train Acc: 0.3526
 Site-White                    | Train Loss: 1.9036 | Train Acc: 0.3236
 Site-Latino_Hispanic          | Train Loss: 2.0565 | Train Acc: 0.2195
 Site-Latino_Hispanic          | Train Loss: 1.9327 | Train Acc: 0.2333
 Site-Latino_Hispanic          | Train Loss: 1.9844 | Train Acc: 0.2809
 Site-Latino_Hispanic          | Train Loss: 1.9781 | Train Acc: 0.2977
 Site-Latino_Hispanic          | Train Loss: 2.0102 | Train Acc: 0.2448
 Site-Latino_Hispanic          | Train Loss: 1.9415 | Train Acc: 0.2650
 Site-Latino_Hispanic          | Train Loss: 1.9894 | Train Acc: 0.2428
 Site-Black                    | Train Loss: 2.4607 | Train Acc: 0.2121
 Site-Black                    | Train Loss: 2.0081 | Train Acc: 0.2474
 Site-Black                    | Train Loss: 2.1574 | Train Acc: 0.2517
 Site-Black                    | Train Loss: 2.0361 | Train Acc: 0.2381
 Site-Black                    | Train Loss: 2.0578 | Train Acc: 0.2621
 Site-East_Asian               | Train Loss: 1.8400 | Train Acc: 0.3967
 Site-East_Asian               | Train Loss: 1.8427 | Train Acc: 0.3596
 Site-East_Asian               | Train Loss: 1.7942 | Train Acc: 0.3550
 Site-Indian                   | Train Loss: 2.0578 | Train Acc: 0.2273
 Site-Indian                   | Train Loss: 2.1149 | Train Acc: 0.2115
 Site-Southeast_Asian          | Train Loss: 1.9880 | Train Acc: 0.3243
 Site-Middle_Eastern           | Train Loss: 2.0557 | Train Acc: 0.2159
 Site-White                     (4) | Val  Loss: 2.3490 | Val  Acc: 0.0833
 Site-White                     (0) | Val  Loss: 1.6211 | Val  Acc: 0.4118
 Site-White                     (5) | Val  Loss: 1.6641 | Val  Acc: 0.4615
 Site-White                     (0) | Val  Loss: 1.8311 | Val  Acc: 0.3684
 Site-White                     (4) | Val  Loss: 1.7494 | Val  Acc: 0.4107
 Site-White                     (0) | Val  Loss: 1.8166 | Val  Acc: 0.3976
 Site-White                     (4) | Val  Loss: 1.8740 | Val  Acc: 0.3443
 Site-White                     (0) | Val  Loss: 1.8786 | Val  Acc: 0.3111
 Site-White                     (4) | Val  Loss: 2.0443 | Val  Acc: 0.3409
 Site-White                     (0) | Val  Loss: 2.0149 | Val  Acc: 0.3033
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8821 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9199 | Val  Acc: 0.3000
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9756 | Val  Acc: 0.2542
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9391 | Val  Acc: 0.3103
 Site-Latino_Hispanic           (0) | Val  Loss: 2.0364 | Val  Acc: 0.2656
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9961 | Val  Acc: 0.2447
 Site-Latino_Hispanic           (4) | Val  Loss: 1.9742 | Val  Acc: 0.2708
 Site-Black                     (1) | Val  Loss: 2.1477 | Val  Acc: 0.1818
 Site-Black                     (3) | Val  Loss: 2.0982 | Val  Acc: 0.1875
 Site-Black                     (1) | Val  Loss: 2.1294 | Val  Acc: 0.2316
 Site-Black                     (1) | Val  Loss: 1.8175 | Val  Acc: 0.2429
 Site-Black                     (1) | Val  Loss: 1.9559 | Val  Acc: 0.2621
 Site-East_Asian                (4) | Val  Loss: 1.9596 | Val  Acc: 0.3625
 Site-East_Asian                (4) | Val  Loss: 1.7909 | Val  Acc: 0.4153
 Site-East_Asian                (4) | Val  Loss: 1.9019 | Val  Acc: 0.3391
 Site-Indian                    (1) | Val  Loss: 2.1717 | Val  Acc: 0.1863
 Site-Indian                    (1) | Val  Loss: 2.1405 | Val  Acc: 0.2318
 Site-Southeast_Asian           (4) | Val  Loss: 2.0612 | Val  Acc: 0.2948
 Site-Middle_Eastern            (4) | Val  Loss: 2.0038 | Val  Acc: 0.2222
Average Valid Accuracy: 0.2942
Aggregated Acc | Val Acc: 0.3031
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.0833
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.4118
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.4615
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3684
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.4107
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3976
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.3443
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3111
 Best site-White                    (4)  | Epoch:0 | Val Acc: 0.3409
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3033
 Best site-Latino_Hispanic          (2)  | Epoch:0 | Val Acc: 0.2963
 Best site-Latino_Hispanic          (6)  | Epoch:0 | Val Acc: 0.3000
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.3103
 Best site-Latino_Hispanic          (0)  | Epoch:0 | Val Acc: 0.2656
 Best site-Latino_Hispanic          (1)  | Epoch:0 | Val Acc: 0.2447
 Best site-Latino_Hispanic          (4)  | Epoch:0 | Val Acc: 0.2708
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.1818
 Best site-Black                    (3)  | Epoch:0 | Val Acc: 0.1875
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2316
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2429
 Best site-Black                    (1)  | Epoch:0 | Val Acc: 0.2621
 Best site-East_Asian               (4)  | Epoch:0 | Val Acc: 0.3625
 Best site-East_Asian               (4)  | Epoch:0 | Val Acc: 0.4153
 Best site-East_Asian               (4)  | Epoch:0 | Val Acc: 0.3391
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.1863
 Best site-Indian                   (1)  | Epoch:0 | Val Acc: 0.2318
 Best site-Southeast_Asian          (4)  | Epoch:0 | Val Acc: 0.2948
 Best site-Middle_Eastern           (4)  | Epoch:0 | Val Acc: 0.2222
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 1 ============
cnt=[1, 4, 6, 5, 1, 1, 11, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7481 | Train Acc: 0.3889
 Site-White                    | Train Loss: 2.0479 | Train Acc: 0.2692
 Site-White                    | Train Loss: 1.8603 | Train Acc: 0.3077
 Site-White                    | Train Loss: 1.8193 | Train Acc: 0.2281
 Site-White                    | Train Loss: 1.8332 | Train Acc: 0.3529
 Site-White                    | Train Loss: 1.8201 | Train Acc: 0.3360
 Site-White                    | Train Loss: 1.8719 | Train Acc: 0.2842
 Site-White                    | Train Loss: 1.9357 | Train Acc: 0.3259
 Site-White                    | Train Loss: 1.7897 | Train Acc: 0.3476
 Site-White                    | Train Loss: 1.8243 | Train Acc: 0.3390
 Site-Latino_Hispanic          | Train Loss: 2.0424 | Train Acc: 0.2439
 Site-Latino_Hispanic          | Train Loss: 1.9304 | Train Acc: 0.2667
 Site-Latino_Hispanic          | Train Loss: 1.9403 | Train Acc: 0.2697
 Site-Latino_Hispanic          | Train Loss: 2.0401 | Train Acc: 0.3053
 Site-Latino_Hispanic          | Train Loss: 1.9758 | Train Acc: 0.2552
 Site-Latino_Hispanic          | Train Loss: 1.9136 | Train Acc: 0.2650
 Site-Latino_Hispanic          | Train Loss: 1.9472 | Train Acc: 0.2452
 Site-Black                    | Train Loss: 2.1973 | Train Acc: 0.2273
 Site-Black                    | Train Loss: 2.0057 | Train Acc: 0.2887
 Site-Black                    | Train Loss: 2.0902 | Train Acc: 0.1958
 Site-Black                    | Train Loss: 1.9530 | Train Acc: 0.2286
 Site-Black                    | Train Loss: 2.0160 | Train Acc: 0.2557
 Site-East_Asian               | Train Loss: 1.7770 | Train Acc: 0.3471
 Site-East_Asian               | Train Loss: 1.8740 | Train Acc: 0.3258
 Site-East_Asian               | Train Loss: 1.8951 | Train Acc: 0.3092
 Site-Indian                   | Train Loss: 2.0549 | Train Acc: 0.2597
 Site-Indian                   | Train Loss: 2.1302 | Train Acc: 0.2379
 Site-Southeast_Asian          | Train Loss: 1.9656 | Train Acc: 0.2857
 Site-Middle_Eastern           | Train Loss: 2.0238 | Train Acc: 0.2500
 Site-White                     (0) | Val  Loss: 2.2451 | Val  Acc: 0.1667
 Site-White                     (4) | Val  Loss: 1.5826 | Val  Acc: 0.5882
 Site-White                     (6) | Val  Loss: 1.6885 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 1.8004 | Val  Acc: 0.4211
 Site-White                     (6) | Val  Loss: 1.7165 | Val  Acc: 0.4464
 Site-White                     (6) | Val  Loss: 1.8256 | Val  Acc: 0.4217
 Site-White                     (6) | Val  Loss: 1.8666 | Val  Acc: 0.3197
 Site-White                     (6) | Val  Loss: 1.8380 | Val  Acc: 0.3111
 Site-White                     (6) | Val  Loss: 2.0086 | Val  Acc: 0.3220
 Site-White                     (6) | Val  Loss: 1.9694 | Val  Acc: 0.3239
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8743 | Val  Acc: 0.1852
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9027 | Val  Acc: 0.3750
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9559 | Val  Acc: 0.2542
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9083 | Val  Acc: 0.3218
 Site-Latino_Hispanic           (2) | Val  Loss: 2.0103 | Val  Acc: 0.2578
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9566 | Val  Acc: 0.2021
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9025 | Val  Acc: 0.2852
 Site-Black                     (3) | Val  Loss: 2.1421 | Val  Acc: 0.1818
 Site-Black                     (3) | Val  Loss: 2.0431 | Val  Acc: 0.1719
 Site-Black                     (3) | Val  Loss: 2.0554 | Val  Acc: 0.1895
 Site-Black                     (3) | Val  Loss: 1.8110 | Val  Acc: 0.1929
 Site-Black                     (3) | Val  Loss: 1.9473 | Val  Acc: 0.2573
 Site-East_Asian                (1) | Val  Loss: 1.9844 | Val  Acc: 0.3625
 Site-East_Asian                (1) | Val  Loss: 1.7502 | Val  Acc: 0.3390
 Site-East_Asian                (1) | Val  Loss: 1.8826 | Val  Acc: 0.3161
 Site-Indian                    (2) | Val  Loss: 2.1238 | Val  Acc: 0.2157
 Site-Indian                    (2) | Val  Loss: 2.0982 | Val  Acc: 0.2517
 Site-Southeast_Asian           (2) | Val  Loss: 2.0717 | Val  Acc: 0.2659
 Site-Middle_Eastern            (6) | Val  Loss: 1.9617 | Val  Acc: 0.2222
Average Valid Accuracy: 0.2989
Aggregated Acc | Val Acc: 0.2954
 Best site-White                    (0)  | Epoch:1 | Val Acc: 0.1667
 Best site-White                    (4)  | Epoch:1 | Val Acc: 0.5882
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.5000
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.4211
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.4464
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.4217
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3197
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3111
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3220
 Best site-White                    (6)  | Epoch:1 | Val Acc: 0.3239
 Best site-Latino_Hispanic          (5)  | Epoch:1 | Val Acc: 0.1852
 Best site-Latino_Hispanic          (6)  | Epoch:1 | Val Acc: 0.3750
 Best site-Latino_Hispanic          (1)  | Epoch:1 | Val Acc: 0.2542
 Best site-Latino_Hispanic          (2)  | Epoch:1 | Val Acc: 0.3218
 Best site-Latino_Hispanic          (2)  | Epoch:1 | Val Acc: 0.2578
 Best site-Latino_Hispanic          (2)  | Epoch:1 | Val Acc: 0.2021
 Best site-Latino_Hispanic          (6)  | Epoch:1 | Val Acc: 0.2852
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.1818
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.1719
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.1895
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.1929
 Best site-Black                    (3)  | Epoch:1 | Val Acc: 0.2573
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3625
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3390
 Best site-East_Asian               (1)  | Epoch:1 | Val Acc: 0.3161
 Best site-Indian                   (2)  | Epoch:1 | Val Acc: 0.2157
 Best site-Indian                   (2)  | Epoch:1 | Val Acc: 0.2517
 Best site-Southeast_Asian          (2)  | Epoch:1 | Val Acc: 0.2659
 Best site-Middle_Eastern           (6)  | Epoch:1 | Val Acc: 0.2222
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 9, 5, 1, 1, 1, 10, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6924 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.9999 | Train Acc: 0.2308
 Site-White                    | Train Loss: 1.8002 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.8308 | Train Acc: 0.2456
 Site-White                    | Train Loss: 1.7594 | Train Acc: 0.3294
 Site-White                    | Train Loss: 1.7961 | Train Acc: 0.3600
 Site-White                    | Train Loss: 1.8246 | Train Acc: 0.3060
 Site-White                    | Train Loss: 1.8494 | Train Acc: 0.3148
 Site-White                    | Train Loss: 1.8105 | Train Acc: 0.3753
 Site-White                    | Train Loss: 1.8504 | Train Acc: 0.3425
 Site-Latino_Hispanic          | Train Loss: 1.9868 | Train Acc: 0.2195
 Site-Latino_Hispanic          | Train Loss: 1.9035 | Train Acc: 0.2833
 Site-Latino_Hispanic          | Train Loss: 1.8558 | Train Acc: 0.3258
 Site-Latino_Hispanic          | Train Loss: 1.8339 | Train Acc: 0.2901
 Site-Latino_Hispanic          | Train Loss: 1.9542 | Train Acc: 0.2552
 Site-Latino_Hispanic          | Train Loss: 1.8896 | Train Acc: 0.3074
 Site-Latino_Hispanic          | Train Loss: 1.9104 | Train Acc: 0.2692
 Site-Black                    | Train Loss: 1.9047 | Train Acc: 0.2121
 Site-Black                    | Train Loss: 1.9499 | Train Acc: 0.2784
 Site-Black                    | Train Loss: 2.0625 | Train Acc: 0.2797
 Site-Black                    | Train Loss: 1.9508 | Train Acc: 0.2524
 Site-Black                    | Train Loss: 2.0001 | Train Acc: 0.2330
 Site-East_Asian               | Train Loss: 1.7904 | Train Acc: 0.3554
 Site-East_Asian               | Train Loss: 1.8457 | Train Acc: 0.3876
 Site-East_Asian               | Train Loss: 1.7827 | Train Acc: 0.3435
 Site-Indian                   | Train Loss: 2.0407 | Train Acc: 0.2532
 Site-Indian                   | Train Loss: 2.0640 | Train Acc: 0.2379
 Site-Southeast_Asian          | Train Loss: 2.1016 | Train Acc: 0.3012
 Site-Middle_Eastern           | Train Loss: 1.9627 | Train Acc: 0.2273
 Site-White                     (5) | Val  Loss: 2.1623 | Val  Acc: 0.2500
 Site-White                     (4) | Val  Loss: 1.5449 | Val  Acc: 0.5294
 Site-White                     (6) | Val  Loss: 1.7072 | Val  Acc: 0.5385
 Site-White                     (6) | Val  Loss: 1.8106 | Val  Acc: 0.4474
 Site-White                     (6) | Val  Loss: 1.7395 | Val  Acc: 0.4286
 Site-White                     (6) | Val  Loss: 1.8261 | Val  Acc: 0.3494
 Site-White                     (1) | Val  Loss: 1.8202 | Val  Acc: 0.3361
 Site-White                     (6) | Val  Loss: 1.8359 | Val  Acc: 0.3278
 Site-White                     (6) | Val  Loss: 1.9554 | Val  Acc: 0.3295
 Site-White                     (1) | Val  Loss: 1.9577 | Val  Acc: 0.2853
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8562 | Val  Acc: 0.2593
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9056 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9124 | Val  Acc: 0.2542
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8504 | Val  Acc: 0.2644
 Site-Latino_Hispanic           (6) | Val  Loss: 1.9640 | Val  Acc: 0.2891
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9147 | Val  Acc: 0.2553
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9135 | Val  Acc: 0.2780
 Site-Black                     (2) | Val  Loss: 2.0969 | Val  Acc: 0.1818
 Site-Black                     (2) | Val  Loss: 2.0372 | Val  Acc: 0.1719
 Site-Black                     (2) | Val  Loss: 2.0151 | Val  Acc: 0.1789
 Site-Black                     (2) | Val  Loss: 1.7837 | Val  Acc: 0.2643
 Site-Black                     (2) | Val  Loss: 1.9333 | Val  Acc: 0.2233
 Site-East_Asian                (1) | Val  Loss: 1.8906 | Val  Acc: 0.3875
 Site-East_Asian                (1) | Val  Loss: 1.7805 | Val  Acc: 0.3559
 Site-East_Asian                (1) | Val  Loss: 1.8605 | Val  Acc: 0.3103
 Site-Indian                    (1) | Val  Loss: 2.0969 | Val  Acc: 0.2059
 Site-Indian                    (1) | Val  Loss: 2.1172 | Val  Acc: 0.1788
 Site-Southeast_Asian           (0) | Val  Loss: 2.0031 | Val  Acc: 0.2832
 Site-Middle_Eastern            (1) | Val  Loss: 1.9267 | Val  Acc: 0.2479
Average Valid Accuracy: 0.2987
Aggregated Acc | Val Acc: 0.3080
============ Train epoch 3 ============
cnt=[9, 8, 8, 1, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.7060 | Train Acc: 0.2778
 Site-White                    | Train Loss: 1.9102 | Train Acc: 0.2692
 Site-White                    | Train Loss: 1.7781 | Train Acc: 0.2821
 Site-White                    | Train Loss: 1.7931 | Train Acc: 0.3158
 Site-White                    | Train Loss: 1.8221 | Train Acc: 0.3882
 Site-White                    | Train Loss: 1.7778 | Train Acc: 0.3200
 Site-White                    | Train Loss: 1.8046 | Train Acc: 0.3443
 Site-White                    | Train Loss: 1.8409 | Train Acc: 0.3407
 Site-White                    | Train Loss: 1.8167 | Train Acc: 0.3426
 Site-White                    | Train Loss: 1.8117 | Train Acc: 0.3442
 Site-Latino_Hispanic          | Train Loss: 1.9985 | Train Acc: 0.2683
 Site-Latino_Hispanic          | Train Loss: 1.9291 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.9261 | Train Acc: 0.3146
 Site-Latino_Hispanic          | Train Loss: 1.7961 | Train Acc: 0.2519
 Site-Latino_Hispanic          | Train Loss: 1.9208 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.8614 | Train Acc: 0.2756
 Site-Latino_Hispanic          | Train Loss: 1.9078 | Train Acc: 0.2548
 Site-Black                    | Train Loss: 1.7255 | Train Acc: 0.2879
 Site-Black                    | Train Loss: 1.9095 | Train Acc: 0.2990
 Site-Black                    | Train Loss: 1.9254 | Train Acc: 0.2238
 Site-Black                    | Train Loss: 1.9955 | Train Acc: 0.2476
 Site-Black                    | Train Loss: 1.9772 | Train Acc: 0.2298
 Site-East_Asian               | Train Loss: 1.7836 | Train Acc: 0.3636
 Site-East_Asian               | Train Loss: 1.8415 | Train Acc: 0.3427
 Site-East_Asian               | Train Loss: 1.7916 | Train Acc: 0.3664
 Site-Indian                   | Train Loss: 2.0033 | Train Acc: 0.2208
 Site-Indian                   | Train Loss: 2.0107 | Train Acc: 0.2511
 Site-Southeast_Asian          | Train Loss: 2.0774 | Train Acc: 0.3243
 Site-Middle_Eastern           | Train Loss: 1.9412 | Train Acc: 0.2614
 Site-White                     (4) | Val  Loss: 2.1076 | Val  Acc: 0.1667
 Site-White                     (5) | Val  Loss: 1.5873 | Val  Acc: 0.3529
 Site-White                     (0) | Val  Loss: 1.7210 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.8003 | Val  Acc: 0.4474
 Site-White                     (1) | Val  Loss: 1.7092 | Val  Acc: 0.4643
 Site-White                     (1) | Val  Loss: 1.7766 | Val  Acc: 0.3614
 Site-White                     (2) | Val  Loss: 1.8288 | Val  Acc: 0.3607
 Site-White                     (1) | Val  Loss: 1.8176 | Val  Acc: 0.3611
 Site-White                     (2) | Val  Loss: 1.8969 | Val  Acc: 0.3371
 Site-White                     (2) | Val  Loss: 1.9293 | Val  Acc: 0.3342
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8358 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (3) | Val  Loss: 1.8661 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (1) | Val  Loss: 1.9213 | Val  Acc: 0.3390
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8992 | Val  Acc: 0.3103
 Site-Latino_Hispanic           (0) | Val  Loss: 1.9163 | Val  Acc: 0.2188
 Site-Latino_Hispanic           (0) | Val  Loss: 1.8909 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (2) | Val  Loss: 1.9044 | Val  Acc: 0.2744
 Site-Black                     (0) | Val  Loss: 2.0286 | Val  Acc: 0.2500
 Site-Black                     (1) | Val  Loss: 2.0014 | Val  Acc: 0.2031
 Site-Black                     (0) | Val  Loss: 1.9756 | Val  Acc: 0.2316
 Site-Black                     (0) | Val  Loss: 1.7718 | Val  Acc: 0.2214
 Site-Black                     (0) | Val  Loss: 1.9185 | Val  Acc: 0.2573
 Site-East_Asian                (2) | Val  Loss: 1.8532 | Val  Acc: 0.4125
 Site-East_Asian                (2) | Val  Loss: 1.7150 | Val  Acc: 0.3983
 Site-East_Asian                (2) | Val  Loss: 1.8403 | Val  Acc: 0.3276
 Site-Indian                    (0) | Val  Loss: 2.0506 | Val  Acc: 0.2451
 Site-Indian                    (0) | Val  Loss: 2.0186 | Val  Acc: 0.2318
 Site-Southeast_Asian           (1) | Val  Loss: 1.9789 | Val  Acc: 0.3179
 Site-Middle_Eastern            (1) | Val  Loss: 1.8702 | Val  Acc: 0.2222
Average Valid Accuracy: 0.3084
Aggregated Acc | Val Acc: 0.2882
 Best site-White                    (4)  | Epoch:3 | Val Acc: 0.1667
 Best site-White                    (5)  | Epoch:3 | Val Acc: 0.3529
 Best site-White                    (0)  | Epoch:3 | Val Acc: 0.5000
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.4474
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.4643
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3614
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.3607
 Best site-White                    (1)  | Epoch:3 | Val Acc: 0.3611
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.3371
 Best site-White                    (2)  | Epoch:3 | Val Acc: 0.3342
 Best site-Latino_Hispanic          (6)  | Epoch:3 | Val Acc: 0.2963
 Best site-Latino_Hispanic          (3)  | Epoch:3 | Val Acc: 0.2500
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.3390
 Best site-Latino_Hispanic          (1)  | Epoch:3 | Val Acc: 0.3103
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2188
 Best site-Latino_Hispanic          (0)  | Epoch:3 | Val Acc: 0.2500
 Best site-Latino_Hispanic          (2)  | Epoch:3 | Val Acc: 0.2744
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2500
 Best site-Black                    (1)  | Epoch:3 | Val Acc: 0.2031
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2316
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2214
 Best site-Black                    (0)  | Epoch:3 | Val Acc: 0.2573
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.4125
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.3983
 Best site-East_Asian               (2)  | Epoch:3 | Val Acc: 0.3276
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2451
 Best site-Indian                   (0)  | Epoch:3 | Val Acc: 0.2318
 Best site-Southeast_Asian          (1)  | Epoch:3 | Val Acc: 0.3179
 Best site-Middle_Eastern           (1)  | Epoch:3 | Val Acc: 0.2222
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 4 ============
cnt=[11, 2, 4, 1, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6414 | Train Acc: 0.3889
 Site-White                    | Train Loss: 1.8867 | Train Acc: 0.3462
 Site-White                    | Train Loss: 1.8313 | Train Acc: 0.2821
 Site-White                    | Train Loss: 1.7737 | Train Acc: 0.3860
 Site-White                    | Train Loss: 1.8386 | Train Acc: 0.3882
 Site-White                    | Train Loss: 1.7487 | Train Acc: 0.3520
 Site-White                    | Train Loss: 1.8086 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.7542 | Train Acc: 0.3704
 Site-White                    | Train Loss: 1.7729 | Train Acc: 0.3728
 Site-White                    | Train Loss: 1.7856 | Train Acc: 0.3682
 Site-Latino_Hispanic          | Train Loss: 1.9006 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.8619 | Train Acc: 0.2667
 Site-Latino_Hispanic          | Train Loss: 1.9285 | Train Acc: 0.2360
 Site-Latino_Hispanic          | Train Loss: 1.9678 | Train Acc: 0.2595
 Site-Latino_Hispanic          | Train Loss: 1.8959 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.8435 | Train Acc: 0.2862
 Site-Latino_Hispanic          | Train Loss: 1.8449 | Train Acc: 0.2716
 Site-Black                    | Train Loss: 2.1256 | Train Acc: 0.2576
 Site-Black                    | Train Loss: 1.8899 | Train Acc: 0.2474
 Site-Black                    | Train Loss: 2.0461 | Train Acc: 0.2168
 Site-Black                    | Train Loss: 1.8563 | Train Acc: 0.2619
 Site-Black                    | Train Loss: 1.9469 | Train Acc: 0.2686
 Site-East_Asian               | Train Loss: 1.7282 | Train Acc: 0.3884
 Site-East_Asian               | Train Loss: 1.7779 | Train Acc: 0.3876
 Site-East_Asian               | Train Loss: 1.7584 | Train Acc: 0.4237
 Site-Indian                   | Train Loss: 1.9800 | Train Acc: 0.2662
 Site-Indian                   | Train Loss: 1.9649 | Train Acc: 0.2423
 Site-Southeast_Asian          | Train Loss: 1.9065 | Train Acc: 0.3359
 Site-Middle_Eastern           | Train Loss: 1.8845 | Train Acc: 0.2898
 Site-White                     (6) | Val  Loss: 2.1368 | Val  Acc: 0.2500
 Site-White                     (0) | Val  Loss: 1.5997 | Val  Acc: 0.4118
 Site-White                     (0) | Val  Loss: 1.6839 | Val  Acc: 0.4231
 Site-White                     (0) | Val  Loss: 1.8606 | Val  Acc: 0.4474
 Site-White                     (0) | Val  Loss: 1.7631 | Val  Acc: 0.3929
 Site-White                     (0) | Val  Loss: 1.7528 | Val  Acc: 0.4217
 Site-White                     (0) | Val  Loss: 1.8278 | Val  Acc: 0.3443
 Site-White                     (0) | Val  Loss: 1.8262 | Val  Acc: 0.3056
 Site-White                     (0) | Val  Loss: 1.8741 | Val  Acc: 0.3750
 Site-White                     (0) | Val  Loss: 1.8734 | Val  Acc: 0.3522
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8345 | Val  Acc: 0.3333
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8250 | Val  Acc: 0.3250
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8764 | Val  Acc: 0.2542
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8495 | Val  Acc: 0.3103
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8770 | Val  Acc: 0.2656
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8633 | Val  Acc: 0.2926
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8612 | Val  Acc: 0.3069
 Site-Black                     (2) | Val  Loss: 2.0526 | Val  Acc: 0.1591
 Site-Black                     (3) | Val  Loss: 2.0110 | Val  Acc: 0.1719
 Site-Black                     (2) | Val  Loss: 1.9776 | Val  Acc: 0.1789
 Site-Black                     (2) | Val  Loss: 1.7786 | Val  Acc: 0.2786
 Site-Black                     (2) | Val  Loss: 1.8725 | Val  Acc: 0.2718
 Site-East_Asian                (5) | Val  Loss: 1.7560 | Val  Acc: 0.4000
 Site-East_Asian                (0) | Val  Loss: 1.7336 | Val  Acc: 0.4237
 Site-East_Asian                (5) | Val  Loss: 1.8259 | Val  Acc: 0.3448
 Site-Indian                    (1) | Val  Loss: 1.9982 | Val  Acc: 0.2353
 Site-Indian                    (1) | Val  Loss: 1.9340 | Val  Acc: 0.2450
 Site-Southeast_Asian           (5) | Val  Loss: 1.9166 | Val  Acc: 0.3353
 Site-Middle_Eastern            (0) | Val  Loss: 1.8836 | Val  Acc: 0.2479
Average Valid Accuracy: 0.3139
Aggregated Acc | Val Acc: 0.2728
 Best site-White                    (6)  | Epoch:4 | Val Acc: 0.2500
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4118
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4231
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4474
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3929
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.4217
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3443
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3056
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3750
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3522
 Best site-Latino_Hispanic          (4)  | Epoch:4 | Val Acc: 0.3333
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.3250
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2542
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.3103
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2656
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.2926
 Best site-Latino_Hispanic          (5)  | Epoch:4 | Val Acc: 0.3069
 Best site-Black                    (2)  | Epoch:4 | Val Acc: 0.1591
 Best site-Black                    (3)  | Epoch:4 | Val Acc: 0.1719
 Best site-Black                    (2)  | Epoch:4 | Val Acc: 0.1789
 Best site-Black                    (2)  | Epoch:4 | Val Acc: 0.2786
 Best site-Black                    (2)  | Epoch:4 | Val Acc: 0.2718
 Best site-East_Asian               (5)  | Epoch:4 | Val Acc: 0.4000
 Best site-East_Asian               (0)  | Epoch:4 | Val Acc: 0.4237
 Best site-East_Asian               (5)  | Epoch:4 | Val Acc: 0.3448
 Best site-Indian                   (1)  | Epoch:4 | Val Acc: 0.2353
 Best site-Indian                   (1)  | Epoch:4 | Val Acc: 0.2450
 Best site-Southeast_Asian          (5)  | Epoch:4 | Val Acc: 0.3353
 Best site-Middle_Eastern           (0)  | Epoch:4 | Val Acc: 0.2479
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 10, 10, 1, 5, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.6430 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.9067 | Train Acc: 0.2692
 Site-White                    | Train Loss: 1.7037 | Train Acc: 0.4103
 Site-White                    | Train Loss: 1.7184 | Train Acc: 0.3860
 Site-White                    | Train Loss: 1.7831 | Train Acc: 0.3882
 Site-White                    | Train Loss: 1.7237 | Train Acc: 0.3440
 Site-White                    | Train Loss: 1.7563 | Train Acc: 0.3934
 Site-White                    | Train Loss: 1.7113 | Train Acc: 0.3926
 Site-White                    | Train Loss: 1.7642 | Train Acc: 0.3753
 Site-White                    | Train Loss: 1.7227 | Train Acc: 0.3664
 Site-Latino_Hispanic          | Train Loss: 1.8512 | Train Acc: 0.2195
 Site-Latino_Hispanic          | Train Loss: 1.8356 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.9330 | Train Acc: 0.2584
 Site-Latino_Hispanic          | Train Loss: 1.9284 | Train Acc: 0.2901
 Site-Latino_Hispanic          | Train Loss: 1.9010 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.8388 | Train Acc: 0.2756
 Site-Latino_Hispanic          | Train Loss: 1.8233 | Train Acc: 0.2885
 Site-Black                    | Train Loss: 2.2463 | Train Acc: 0.2576
 Site-Black                    | Train Loss: 1.8405 | Train Acc: 0.2784
 Site-Black                    | Train Loss: 1.9945 | Train Acc: 0.2098
 Site-Black                    | Train Loss: 1.8707 | Train Acc: 0.2667
 Site-Black                    | Train Loss: 1.9356 | Train Acc: 0.2557
 Site-East_Asian               | Train Loss: 1.7236 | Train Acc: 0.3802
 Site-East_Asian               | Train Loss: 1.7717 | Train Acc: 0.3876
 Site-East_Asian               | Train Loss: 1.7281 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.8764 | Train Acc: 0.2727
 Site-Indian                   | Train Loss: 1.9184 | Train Acc: 0.2687
 Site-Southeast_Asian          | Train Loss: 1.8476 | Train Acc: 0.3436
 Site-Middle_Eastern           | Train Loss: 1.8624 | Train Acc: 0.2727
 Site-White                     (0) | Val  Loss: 2.0094 | Val  Acc: 0.2500
 Site-White                     (6) | Val  Loss: 1.5139 | Val  Acc: 0.5882
 Site-White                     (2) | Val  Loss: 1.7019 | Val  Acc: 0.5000
 Site-White                     (2) | Val  Loss: 1.8084 | Val  Acc: 0.3947
 Site-White                     (2) | Val  Loss: 1.7465 | Val  Acc: 0.4107
 Site-White                     (2) | Val  Loss: 1.7283 | Val  Acc: 0.4096
 Site-White                     (2) | Val  Loss: 1.7578 | Val  Acc: 0.3934
 Site-White                     (2) | Val  Loss: 1.7587 | Val  Acc: 0.3611
 Site-White                     (2) | Val  Loss: 1.8389 | Val  Acc: 0.3826
 Site-White                     (2) | Val  Loss: 1.8363 | Val  Acc: 0.3573
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7643 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (5) | Val  Loss: 1.8525 | Val  Acc: 0.3000
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8238 | Val  Acc: 0.2881
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8464 | Val  Acc: 0.2989
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8729 | Val  Acc: 0.2109
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8309 | Val  Acc: 0.2394
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8381 | Val  Acc: 0.3249
 Site-Black                     (3) | Val  Loss: 1.9608 | Val  Acc: 0.2500
 Site-Black                     (4) | Val  Loss: 1.9961 | Val  Acc: 0.2344
 Site-Black                     (4) | Val  Loss: 1.9428 | Val  Acc: 0.2421
 Site-Black                     (4) | Val  Loss: 1.7331 | Val  Acc: 0.2643
 Site-Black                     (4) | Val  Loss: 1.8913 | Val  Acc: 0.2524
 Site-East_Asian                (2) | Val  Loss: 1.8011 | Val  Acc: 0.3750
 Site-East_Asian                (1) | Val  Loss: 1.6922 | Val  Acc: 0.4492
 Site-East_Asian                (1) | Val  Loss: 1.7647 | Val  Acc: 0.3908
 Site-Indian                    (4) | Val  Loss: 1.9117 | Val  Acc: 0.2843
 Site-Indian                    (1) | Val  Loss: 1.9595 | Val  Acc: 0.2914
 Site-Southeast_Asian           (1) | Val  Loss: 1.8965 | Val  Acc: 0.3237
 Site-Middle_Eastern            (1) | Val  Loss: 1.7756 | Val  Acc: 0.2735
Average Valid Accuracy: 0.3323
Aggregated Acc | Val Acc: 0.3344
 Best site-White                    (0)  | Epoch:5 | Val Acc: 0.2500
 Best site-White                    (6)  | Epoch:5 | Val Acc: 0.5882
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.5000
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3947
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.4107
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.4096
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3934
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3611
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3826
 Best site-White                    (2)  | Epoch:5 | Val Acc: 0.3573
 Best site-Latino_Hispanic          (2)  | Epoch:5 | Val Acc: 0.2963
 Best site-Latino_Hispanic          (5)  | Epoch:5 | Val Acc: 0.3000
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2881
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2989
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2109
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.2394
 Best site-Latino_Hispanic          (1)  | Epoch:5 | Val Acc: 0.3249
 Best site-Black                    (3)  | Epoch:5 | Val Acc: 0.2500
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.2344
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.2421
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.2643
 Best site-Black                    (4)  | Epoch:5 | Val Acc: 0.2524
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3750
 Best site-East_Asian               (1)  | Epoch:5 | Val Acc: 0.4492
 Best site-East_Asian               (1)  | Epoch:5 | Val Acc: 0.3908
 Best site-Indian                   (4)  | Epoch:5 | Val Acc: 0.2843
 Best site-Indian                   (1)  | Epoch:5 | Val Acc: 0.2914
 Best site-Southeast_Asian          (1)  | Epoch:5 | Val Acc: 0.3237
 Best site-Middle_Eastern           (1)  | Epoch:5 | Val Acc: 0.2735
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 9, 7, 1, 1, 1, 9, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.5532 | Train Acc: 0.4444
 Site-White                    | Train Loss: 1.8675 | Train Acc: 0.3462
 Site-White                    | Train Loss: 1.7113 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.7240 | Train Acc: 0.2807
 Site-White                    | Train Loss: 1.8002 | Train Acc: 0.4000
 Site-White                    | Train Loss: 1.7173 | Train Acc: 0.3120
 Site-White                    | Train Loss: 1.7559 | Train Acc: 0.3825
 Site-White                    | Train Loss: 1.7152 | Train Acc: 0.3481
 Site-White                    | Train Loss: 1.7477 | Train Acc: 0.3778
 Site-White                    | Train Loss: 1.7197 | Train Acc: 0.3647
 Site-Latino_Hispanic          | Train Loss: 1.8509 | Train Acc: 0.3659
 Site-Latino_Hispanic          | Train Loss: 1.8560 | Train Acc: 0.2833
 Site-Latino_Hispanic          | Train Loss: 1.8116 | Train Acc: 0.3146
 Site-Latino_Hispanic          | Train Loss: 1.7744 | Train Acc: 0.3282
 Site-Latino_Hispanic          | Train Loss: 1.8385 | Train Acc: 0.3021
 Site-Latino_Hispanic          | Train Loss: 1.7883 | Train Acc: 0.3074
 Site-Latino_Hispanic          | Train Loss: 1.7704 | Train Acc: 0.3197
 Site-Black                    | Train Loss: 2.1874 | Train Acc: 0.2576
 Site-Black                    | Train Loss: 1.9061 | Train Acc: 0.2990
 Site-Black                    | Train Loss: 1.8376 | Train Acc: 0.2448
 Site-Black                    | Train Loss: 1.9382 | Train Acc: 0.2905
 Site-Black                    | Train Loss: 1.9180 | Train Acc: 0.2686
 Site-East_Asian               | Train Loss: 1.6943 | Train Acc: 0.4215
 Site-East_Asian               | Train Loss: 1.7762 | Train Acc: 0.3652
 Site-East_Asian               | Train Loss: 1.8064 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.9147 | Train Acc: 0.2662
 Site-Indian                   | Train Loss: 1.9018 | Train Acc: 0.2863
 Site-Southeast_Asian          | Train Loss: 1.9438 | Train Acc: 0.3205
 Site-Middle_Eastern           | Train Loss: 1.8315 | Train Acc: 0.3239
 Site-White                     (3) | Val  Loss: 2.0744 | Val  Acc: 0.1667
 Site-White                     (4) | Val  Loss: 1.6041 | Val  Acc: 0.4118
 Site-White                     (6) | Val  Loss: 1.6143 | Val  Acc: 0.5000
 Site-White                     (6) | Val  Loss: 1.7165 | Val  Acc: 0.4737
 Site-White                     (6) | Val  Loss: 1.6822 | Val  Acc: 0.3929
 Site-White                     (6) | Val  Loss: 1.6942 | Val  Acc: 0.4458
 Site-White                     (6) | Val  Loss: 1.7154 | Val  Acc: 0.4016
 Site-White                     (6) | Val  Loss: 1.7165 | Val  Acc: 0.3611
 Site-White                     (6) | Val  Loss: 1.7819 | Val  Acc: 0.3826
 Site-White                     (6) | Val  Loss: 1.7846 | Val  Acc: 0.3856
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8321 | Val  Acc: 0.2963
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7421 | Val  Acc: 0.3500
 Site-Latino_Hispanic           (6) | Val  Loss: 1.8097 | Val  Acc: 0.3220
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7662 | Val  Acc: 0.3448
 Site-Latino_Hispanic           (2) | Val  Loss: 1.8670 | Val  Acc: 0.2734
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8383 | Val  Acc: 0.2447
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8172 | Val  Acc: 0.2852
 Site-Black                     (0) | Val  Loss: 2.0302 | Val  Acc: 0.1818
 Site-Black                     (1) | Val  Loss: 1.8943 | Val  Acc: 0.2344
 Site-Black                     (1) | Val  Loss: 1.9649 | Val  Acc: 0.2105
 Site-Black                     (1) | Val  Loss: 1.7488 | Val  Acc: 0.2786
 Site-Black                     (1) | Val  Loss: 1.8224 | Val  Acc: 0.3204
 Site-East_Asian                (5) | Val  Loss: 1.7902 | Val  Acc: 0.4000
 Site-East_Asian                (2) | Val  Loss: 1.6268 | Val  Acc: 0.4068
 Site-East_Asian                (2) | Val  Loss: 1.7275 | Val  Acc: 0.3851
 Site-Indian                    (1) | Val  Loss: 1.9429 | Val  Acc: 0.2353
 Site-Indian                    (1) | Val  Loss: 1.9428 | Val  Acc: 0.2781
 Site-Southeast_Asian           (2) | Val  Loss: 1.8885 | Val  Acc: 0.3295
 Site-Middle_Eastern            (1) | Val  Loss: 1.7891 | Val  Acc: 0.3077
Average Valid Accuracy: 0.3313
Aggregated Acc | Val Acc: 0.3106
============ Train epoch 7 ============
cnt=[1, 7, 11, 7, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.5742 | Train Acc: 0.3889
 Site-White                    | Train Loss: 1.7688 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.6549 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.6628 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.7638 | Train Acc: 0.4235
 Site-White                    | Train Loss: 1.7130 | Train Acc: 0.3680
 Site-White                    | Train Loss: 1.6926 | Train Acc: 0.3661
 Site-White                    | Train Loss: 1.6978 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.6659 | Train Acc: 0.3879
 Site-White                    | Train Loss: 1.6654 | Train Acc: 0.3664
 Site-Latino_Hispanic          | Train Loss: 1.8234 | Train Acc: 0.3415
 Site-Latino_Hispanic          | Train Loss: 1.8416 | Train Acc: 0.2500
 Site-Latino_Hispanic          | Train Loss: 1.8144 | Train Acc: 0.3034
 Site-Latino_Hispanic          | Train Loss: 1.8747 | Train Acc: 0.3053
 Site-Latino_Hispanic          | Train Loss: 1.8148 | Train Acc: 0.2812
 Site-Latino_Hispanic          | Train Loss: 1.7702 | Train Acc: 0.3216
 Site-Latino_Hispanic          | Train Loss: 1.7552 | Train Acc: 0.3221
 Site-Black                    | Train Loss: 1.8061 | Train Acc: 0.3182
 Site-Black                    | Train Loss: 1.7905 | Train Acc: 0.2887
 Site-Black                    | Train Loss: 1.9369 | Train Acc: 0.2797
 Site-Black                    | Train Loss: 1.8687 | Train Acc: 0.2762
 Site-Black                    | Train Loss: 1.8676 | Train Acc: 0.2686
 Site-East_Asian               | Train Loss: 1.6439 | Train Acc: 0.4215
 Site-East_Asian               | Train Loss: 1.6922 | Train Acc: 0.3652
 Site-East_Asian               | Train Loss: 1.7096 | Train Acc: 0.4046
 Site-Indian                   | Train Loss: 1.7924 | Train Acc: 0.3182
 Site-Indian                   | Train Loss: 1.9014 | Train Acc: 0.2731
 Site-Southeast_Asian          | Train Loss: 1.8607 | Train Acc: 0.3398
 Site-Middle_Eastern           | Train Loss: 1.8024 | Train Acc: 0.3239
 Site-White                     (6) | Val  Loss: 1.9641 | Val  Acc: 0.1667
 Site-White                     (5) | Val  Loss: 1.6513 | Val  Acc: 0.2941
 Site-White                     (2) | Val  Loss: 1.6865 | Val  Acc: 0.3846
 Site-White                     (0) | Val  Loss: 1.7591 | Val  Acc: 0.3158
 Site-White                     (2) | Val  Loss: 1.6900 | Val  Acc: 0.3750
 Site-White                     (2) | Val  Loss: 1.6607 | Val  Acc: 0.4217
 Site-White                     (2) | Val  Loss: 1.7345 | Val  Acc: 0.4016
 Site-White                     (2) | Val  Loss: 1.7112 | Val  Acc: 0.3722
 Site-White                     (2) | Val  Loss: 1.7727 | Val  Acc: 0.3902
 Site-White                     (2) | Val  Loss: 1.8418 | Val  Acc: 0.3728
 Site-Latino_Hispanic           (4) | Val  Loss: 1.8319 | Val  Acc: 0.3704
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8244 | Val  Acc: 0.3000
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7243 | Val  Acc: 0.3390
 Site-Latino_Hispanic           (1) | Val  Loss: 1.7294 | Val  Acc: 0.3448
 Site-Latino_Hispanic           (1) | Val  Loss: 1.8262 | Val  Acc: 0.2500
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7976 | Val  Acc: 0.2713
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7706 | Val  Acc: 0.3141
 Site-Black                     (3) | Val  Loss: 1.9454 | Val  Acc: 0.2045
 Site-Black                     (3) | Val  Loss: 1.9257 | Val  Acc: 0.2344
 Site-Black                     (3) | Val  Loss: 1.9286 | Val  Acc: 0.2316
 Site-Black                     (3) | Val  Loss: 1.7358 | Val  Acc: 0.3000
 Site-Black                     (3) | Val  Loss: 1.8707 | Val  Acc: 0.2913
 Site-East_Asian                (2) | Val  Loss: 1.7661 | Val  Acc: 0.4375
 Site-East_Asian                (1) | Val  Loss: 1.5853 | Val  Acc: 0.4915
 Site-East_Asian                (1) | Val  Loss: 1.7121 | Val  Acc: 0.3966
 Site-Indian                    (3) | Val  Loss: 1.9203 | Val  Acc: 0.2157
 Site-Indian                    (3) | Val  Loss: 1.8644 | Val  Acc: 0.2649
 Site-Southeast_Asian           (1) | Val  Loss: 1.8285 | Val  Acc: 0.3699
 Site-Middle_Eastern            (2) | Val  Loss: 1.7444 | Val  Acc: 0.3419
Average Valid Accuracy: 0.3263
Aggregated Acc | Val Acc: 0.3033
============ Train epoch 8 ============
cnt=[1, 3, 10, 5, 7, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4398 | Train Acc: 0.5000
 Site-White                    | Train Loss: 1.7121 | Train Acc: 0.3462
 Site-White                    | Train Loss: 1.5766 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.6648 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.7341 | Train Acc: 0.3882
 Site-White                    | Train Loss: 1.6338 | Train Acc: 0.4400
 Site-White                    | Train Loss: 1.6924 | Train Acc: 0.3770
 Site-White                    | Train Loss: 1.7018 | Train Acc: 0.3963
 Site-White                    | Train Loss: 1.6859 | Train Acc: 0.3501
 Site-White                    | Train Loss: 1.6314 | Train Acc: 0.3955
 Site-Latino_Hispanic          | Train Loss: 1.7956 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.8442 | Train Acc: 0.3000
 Site-Latino_Hispanic          | Train Loss: 1.7811 | Train Acc: 0.3820
 Site-Latino_Hispanic          | Train Loss: 1.6914 | Train Acc: 0.2977
 Site-Latino_Hispanic          | Train Loss: 1.7784 | Train Acc: 0.2969
 Site-Latino_Hispanic          | Train Loss: 1.7663 | Train Acc: 0.3216
 Site-Latino_Hispanic          | Train Loss: 1.7616 | Train Acc: 0.3077
 Site-Black                    | Train Loss: 2.0112 | Train Acc: 0.2273
 Site-Black                    | Train Loss: 1.8141 | Train Acc: 0.3196
 Site-Black                    | Train Loss: 1.8626 | Train Acc: 0.2797
 Site-Black                    | Train Loss: 1.8750 | Train Acc: 0.2857
 Site-Black                    | Train Loss: 1.8733 | Train Acc: 0.2718
 Site-East_Asian               | Train Loss: 1.6237 | Train Acc: 0.3967
 Site-East_Asian               | Train Loss: 1.7153 | Train Acc: 0.3876
 Site-East_Asian               | Train Loss: 1.6134 | Train Acc: 0.4008
 Site-Indian                   | Train Loss: 1.7850 | Train Acc: 0.2662
 Site-Indian                   | Train Loss: 1.8671 | Train Acc: 0.2863
 Site-Southeast_Asian          | Train Loss: 1.7719 | Train Acc: 0.3475
 Site-Middle_Eastern           | Train Loss: 1.7170 | Train Acc: 0.3409
 Site-White                     (0) | Val  Loss: 1.8959 | Val  Acc: 0.1667
 Site-White                     (6) | Val  Loss: 1.4193 | Val  Acc: 0.4706
 Site-White                     (2) | Val  Loss: 1.5824 | Val  Acc: 0.4615
 Site-White                     (2) | Val  Loss: 1.7717 | Val  Acc: 0.3158
 Site-White                     (2) | Val  Loss: 1.6840 | Val  Acc: 0.4286
 Site-White                     (2) | Val  Loss: 1.6058 | Val  Acc: 0.4337
 Site-White                     (2) | Val  Loss: 1.7332 | Val  Acc: 0.4016
 Site-White                     (2) | Val  Loss: 1.6993 | Val  Acc: 0.3667
 Site-White                     (2) | Val  Loss: 1.7607 | Val  Acc: 0.3939
 Site-White                     (2) | Val  Loss: 1.7858 | Val  Acc: 0.3522
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7732 | Val  Acc: 0.3704
 Site-Latino_Hispanic           (2) | Val  Loss: 1.7309 | Val  Acc: 0.2750
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7827 | Val  Acc: 0.3559
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7501 | Val  Acc: 0.3103
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7857 | Val  Acc: 0.2969
 Site-Latino_Hispanic           (4) | Val  Loss: 1.7875 | Val  Acc: 0.2819
 Site-Latino_Hispanic           (5) | Val  Loss: 1.7577 | Val  Acc: 0.3141
 Site-Black                     (3) | Val  Loss: 1.8557 | Val  Acc: 0.2500
 Site-Black                     (3) | Val  Loss: 1.9343 | Val  Acc: 0.2812
 Site-Black                     (3) | Val  Loss: 1.8696 | Val  Acc: 0.2632
 Site-Black                     (3) | Val  Loss: 1.6871 | Val  Acc: 0.3000
 Site-Black                     (3) | Val  Loss: 1.8185 | Val  Acc: 0.3058
 Site-East_Asian                (4) | Val  Loss: 1.7682 | Val  Acc: 0.4000
 Site-East_Asian                (4) | Val  Loss: 1.5759 | Val  Acc: 0.4322
 Site-East_Asian                (4) | Val  Loss: 1.7305 | Val  Acc: 0.3621
 Site-Indian                    (1) | Val  Loss: 1.8887 | Val  Acc: 0.2647
 Site-Indian                    (1) | Val  Loss: 1.8411 | Val  Acc: 0.3444
 Site-Southeast_Asian           (4) | Val  Loss: 1.8236 | Val  Acc: 0.3584
 Site-Middle_Eastern            (1) | Val  Loss: 1.7447 | Val  Acc: 0.4017
Average Valid Accuracy: 0.3434
Aggregated Acc | Val Acc: 0.3288
 Best site-White                    (0)  | Epoch:8 | Val Acc: 0.1667
 Best site-White                    (6)  | Epoch:8 | Val Acc: 0.4706
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4615
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.3158
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4286
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4337
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.4016
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.3667
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.3939
 Best site-White                    (2)  | Epoch:8 | Val Acc: 0.3522
 Best site-Latino_Hispanic          (2)  | Epoch:8 | Val Acc: 0.3704
 Best site-Latino_Hispanic          (2)  | Epoch:8 | Val Acc: 0.2750
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.3559
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.3103
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.2969
 Best site-Latino_Hispanic          (4)  | Epoch:8 | Val Acc: 0.2819
 Best site-Latino_Hispanic          (5)  | Epoch:8 | Val Acc: 0.3141
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.2500
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.2812
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.2632
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.3000
 Best site-Black                    (3)  | Epoch:8 | Val Acc: 0.3058
 Best site-East_Asian               (4)  | Epoch:8 | Val Acc: 0.4000
 Best site-East_Asian               (4)  | Epoch:8 | Val Acc: 0.4322
 Best site-East_Asian               (4)  | Epoch:8 | Val Acc: 0.3621
 Best site-Indian                   (1)  | Epoch:8 | Val Acc: 0.2647
 Best site-Indian                   (1)  | Epoch:8 | Val Acc: 0.3444
 Best site-Southeast_Asian          (4)  | Epoch:8 | Val Acc: 0.3584
 Best site-Middle_Eastern           (1)  | Epoch:8 | Val Acc: 0.4017
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.47_1_random_dis_cluster_7_color_jitter/ccop_q=1...
============ Train epoch 9 ============
cnt=[10, 6, 1, 8, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-White                    | Train Loss: 1.4581 | Train Acc: 0.3333
 Site-White                    | Train Loss: 1.8360 | Train Acc: 0.3846
 Site-White                    | Train Loss: 1.6543 | Train Acc: 0.3590
 Site-White                    | Train Loss: 1.6329 | Train Acc: 0.3860
 Site-White                    | Train Loss: 1.6110 | Train Acc: 0.4000
 Site-White                    | Train Loss: 1.6201 | Train Acc: 0.3920
 Site-White                    | Train Loss: 1.6653 | Train Acc: 0.4044
 Site-White                    | Train Loss: 1.6605 | Train Acc: 0.3741
 Site-White                    | Train Loss: 1.6091 | Train Acc: 0.4081
 Site-White                    | Train Loss: 1.6734 | Train Acc: 0.4007
 Site-Latino_Hispanic          | Train Loss: 1.8005 | Train Acc: 0.3171
 Site-Latino_Hispanic          | Train Loss: 1.8396 | Train Acc: 0.2333
 Site-Latino_Hispanic          | Train Loss: 1.7824 | Train Acc: 0.3596
 Site-Latino_Hispanic          | Train Loss: 2.0151 | Train Acc: 0.3511
 Site-Latino_Hispanic          | Train Loss: 1.8202 | Train Acc: 0.3125
 Site-Latino_Hispanic          | Train Loss: 1.7345 | Train Acc: 0.3110
 Site-Latino_Hispanic          | Train Loss: 1.7321 | Train Acc: 0.3125
 Site-Black                    | Train Loss: 1.9321 | Train Acc: 0.1818
 Site-Black                    | Train Loss: 1.8778 | Train Acc: 0.3093
 Site-Black                    | Train Loss: 1.8551 | Train Acc: 0.2797
 Site-Black                    | Train Loss: 1.8012 | Train Acc: 0.3238
 Site-Black                    | Train Loss: 1.8711 | Train Acc: 0.2751
 Site-East_Asian               | Train Loss: 1.5682 | Train Acc: 0.4298
 Site-East_Asian               | Train Loss: 1.6837 | Train Acc: 0.3090
 Site-East_Asian               | Train Loss: 1.6239 | Train Acc: 0.4160
 Site-Indian                   | Train Loss: 1.7326 | Train Acc: 0.3247
 Site-Indian                   | Train Loss: 1.7953 | Train Acc: 0.3172
 Site-Southeast_Asian          | Train Loss: 1.8162 | Train Acc: 0.3977
 Site-Middle_Eastern           | Train Loss: 1.6867 | Train Acc: 0.3466
 Site-White                     (2) | Val  Loss: 2.0709 | Val  Acc: 0.1667
 Site-White                     (5) | Val  Loss: 1.5344 | Val  Acc: 0.4118
 Site-White                     (4) | Val  Loss: 1.5071 | Val  Acc: 0.5385
 Site-White                     (3) | Val  Loss: 1.7137 | Val  Acc: 0.2895
 Site-White                     (0) | Val  Loss: 1.6242 | Val  Acc: 0.4286
 Site-White                     (0) | Val  Loss: 1.6362 | Val  Acc: 0.4217
 Site-White                     (0) | Val  Loss: 1.6518 | Val  Acc: 0.4098
 Site-White                     (0) | Val  Loss: 1.6317 | Val  Acc: 0.4056
 Site-White                     (0) | Val  Loss: 1.7043 | Val  Acc: 0.4129
 Site-White                     (0) | Val  Loss: 1.7407 | Val  Acc: 0.3805
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7382 | Val  Acc: 0.3704
 Site-Latino_Hispanic           (6) | Val  Loss: 1.7774 | Val  Acc: 0.3000
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7400 | Val  Acc: 0.2881
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7407 | Val  Acc: 0.2644
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7037 | Val  Acc: 0.3047
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7507 | Val  Acc: 0.3245
 Site-Latino_Hispanic           (3) | Val  Loss: 1.7432 | Val  Acc: 0.3285
 Site-Black                     (1) | Val  Loss: 1.8207 | Val  Acc: 0.2727
 Site-Black                     (1) | Val  Loss: 1.8817 | Val  Acc: 0.2188
 Site-Black                     (1) | Val  Loss: 1.8680 | Val  Acc: 0.2947
 Site-Black                     (1) | Val  Loss: 1.7345 | Val  Acc: 0.2643
 Site-Black                     (1) | Val  Loss: 1.7741 | Val  Acc: 0.3155
 Site-East_Asian                (0) | Val  Loss: 1.6396 | Val  Acc: 0.4000
 Site-East_Asian                (0) | Val  Loss: 1.5900 | Val  Acc: 0.4407
 Site-East_Asian                (0) | Val  Loss: 1.6853 | Val  Acc: 0.3793
 Site-Indian                    (3) | Val  Loss: 1.8751 | Val  Acc: 0.2745
 Site-Indian                    (1) | Val  Loss: 1.8082 | Val  Acc: 0.3046
 Site-Southeast_Asian           (3) | Val  Loss: 1.8331 | Val  Acc: 0.3584
 Site-Middle_Eastern            (0) | Val  Loss: 1.6796 | Val  Acc: 0.2991
Average Valid Accuracy: 0.3403
Aggregated Acc | Val Acc: 0.3475
============ Train epoch 10 ============
