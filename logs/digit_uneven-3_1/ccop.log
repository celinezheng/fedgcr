===2023-04-30 18:50:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 60
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,37,74,111,59,118,44,88,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.9400, powerC: 0.0600
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 2.1623 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0584 | Train Acc: 0.2766
 Site-MNIST     | Train Loss: 1.9540 | Train Acc: 0.4366
 Site-MNIST     | Train Loss: 2.0281 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 1.9638 | Train Acc: 0.3644
 Site-SVHN      | Train Loss: 2.3046 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 2.0156 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 2.0026 | Train Acc: 0.3649
 Site-USPS      | Train Loss: 2.0269 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2280 | Train Acc: 0.2373
 Site-SynthDigits| Train Loss: 2.2151 | Train Acc: 0.2203
 Site-MNIST-M   | Train Loss: 2.3131 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.2751 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.0373 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0093 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.0492 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.0604 | Val  Acc: 0.3175
 Site-MNIST     | Val  Loss: 1.9675 | Val  Acc: 0.4557
 Site-SVHN      | Val  Loss: 2.3136 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.0551 | Val  Acc: 0.2083
 Site-USPS      | Val  Loss: 1.9684 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 2.0228 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 2.1763 | Val  Acc: 0.2308
 Site-SynthDigits| Val  Loss: 2.1820 | Val  Acc: 0.2179
 Site-MNIST-M   | Val  Loss: 2.2137 | Val  Acc: 0.1724
 Site-MNIST-M   | Val  Loss: 2.2598 | Val  Acc: 0.1207
Average Valid Accuracy: 0.2601
Aggregated Acc | Val Acc: 0.2192
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3175
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4557
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.2083
 Best site-USPS       | Epoch:0 | Val Acc: 0.3469
 Best site-USPS       | Epoch:0 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2308
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2179
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1724
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.8860, powerC: 0.1140
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.9958 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8335 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.7677 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8359 | Train Acc: 0.5213
 Site-MNIST     | Train Loss: 1.6976 | Train Acc: 0.6186
 Site-SVHN      | Train Loss: 2.2866 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.8448 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 1.7902 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 1.8415 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.1344 | Train Acc: 0.2712
 Site-SynthDigits| Train Loss: 2.1086 | Train Acc: 0.2797
 Site-MNIST-M   | Train Loss: 2.2773 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1849 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.7766 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7755 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.8577 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8767 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 1.7612 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2617 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.8565 | Val  Acc: 0.4583
 Site-USPS      | Val  Loss: 1.7809 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.8187 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.0948 | Val  Acc: 0.2821
 Site-SynthDigits| Val  Loss: 2.0931 | Val  Acc: 0.2821
 Site-MNIST-M   | Val  Loss: 2.1625 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.2036 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4345
Aggregated Acc | Val Acc: 0.3518
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1364
 Best site-USPS       | Epoch:1 | Val Acc: 0.4583
 Best site-USPS       | Epoch:1 | Val Acc: 0.5714
 Best site-USPS       | Epoch:1 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.8374, powerC: 0.1626
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.7984 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.6243 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.6264 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.6351 | Train Acc: 0.6277
 Site-MNIST     | Train Loss: 1.4911 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.3628 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.6727 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 1.5837 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.6490 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 2.0678 | Train Acc: 0.3220
 Site-SynthDigits| Train Loss: 2.0009 | Train Acc: 0.3220
 Site-MNIST-M   | Train Loss: 2.2367 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1093 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.5336 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5569 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.6670 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.6811 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.5536 | Val  Acc: 0.6582
 Site-SVHN      | Val  Loss: 2.2294 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.6636 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5991 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.6190 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.9966 | Val  Acc: 0.3846
 Site-SynthDigits| Val  Loss: 1.9846 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0890 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1241 | Val  Acc: 0.2586
Average Valid Accuracy: 0.4977
Aggregated Acc | Val Acc: 0.4058
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6582
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1364
 Best site-USPS       | Epoch:2 | Val Acc: 0.5000
 Best site-USPS       | Epoch:2 | Val Acc: 0.5714
 Best site-USPS       | Epoch:2 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3846
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[1, 3, 2, 3, 4, ]
power_decay: 0.9, powerI: 0.7937, powerC: 0.2063
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.5731 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.4084 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4151 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.4410 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.2989 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.2615 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 1.4633 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 1.3929 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 1.4528 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 1.9746 | Train Acc: 0.2881
 Site-SynthDigits| Train Loss: 1.8723 | Train Acc: 0.3475
 Site-MNIST-M   | Train Loss: 2.1562 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.0334 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.3095 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.3452 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.4610 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4820 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.3528 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.2417 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.4507 | Val  Acc: 0.6250
 Site-USPS      | Val  Loss: 1.4153 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 1.4145 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 1.8831 | Val  Acc: 0.4359
 Site-SynthDigits| Val  Loss: 1.8602 | Val  Acc: 0.4103
 Site-MNIST-M   | Val  Loss: 1.9889 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0236 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5657
Aggregated Acc | Val Acc: 0.5761
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1818
 Best site-USPS       | Epoch:3 | Val Acc: 0.6250
 Best site-USPS       | Epoch:3 | Val Acc: 0.6327
 Best site-USPS       | Epoch:3 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4359
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4103
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.7543, powerC: 0.2457
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.4476 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.2501 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.2233 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.3057 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.1988 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.2183 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.2438 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 1.2236 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 1.2826 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 1.9017 | Train Acc: 0.3390
 Site-SynthDigits| Train Loss: 1.7620 | Train Acc: 0.4322
 Site-MNIST-M   | Train Loss: 2.0776 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.9341 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.1806 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.2146 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.3310 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.3483 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2000 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.2555 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.2809 | Val  Acc: 0.7083
 Site-USPS      | Val  Loss: 1.2420 | Val  Acc: 0.7143
 Site-USPS      | Val  Loss: 1.2495 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7710 | Val  Acc: 0.4615
 Site-SynthDigits| Val  Loss: 1.7516 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 1.8904 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 1.9322 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6063
Aggregated Acc | Val Acc: 0.4921
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1364
 Best site-USPS       | Epoch:4 | Val Acc: 0.7083
 Best site-USPS       | Epoch:4 | Val Acc: 0.7143
 Best site-USPS       | Epoch:4 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4615
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.7189, powerC: 0.2811
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.2692 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1248 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.1225 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.1919 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.0385 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.2148 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 1.0977 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.1110 | Train Acc: 0.7703
 Site-USPS      | Train Loss: 1.1696 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.7913 | Train Acc: 0.3898
 Site-SynthDigits| Train Loss: 1.6770 | Train Acc: 0.4915
 Site-MNIST-M   | Train Loss: 2.0148 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8305 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.0694 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.0961 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.2213 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.2379 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.0830 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.2122 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.1544 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.1172 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 1.1299 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.6502 | Val  Acc: 0.5385
 Site-SynthDigits| Val  Loss: 1.6475 | Val  Acc: 0.5256
 Site-MNIST-M   | Val  Loss: 1.8013 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.8487 | Val  Acc: 0.4655
Average Valid Accuracy: 0.6545
Aggregated Acc | Val Acc: 0.5432
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1364
 Best site-USPS       | Epoch:5 | Val Acc: 0.7500
 Best site-USPS       | Epoch:5 | Val Acc: 0.7551
 Best site-USPS       | Epoch:5 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5385
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5256
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6870, powerC: 0.3130
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.2888 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.0413 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.9960 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.1028 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9471 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.2033 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.0433 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.0044 | Train Acc: 0.7973
 Site-USPS      | Train Loss: 1.0718 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.6843 | Train Acc: 0.4068
 Site-SynthDigits| Train Loss: 1.5640 | Train Acc: 0.5254
 Site-MNIST-M   | Train Loss: 1.9389 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.7475 | Train Acc: 0.4545
 Site-MNIST     | Val  Loss: 1.0014 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.0253 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.1376 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 1.1449 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 0.9797 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.2270 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.0751 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.0475 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 1.0328 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.5813 | Val  Acc: 0.5128
 Site-SynthDigits| Val  Loss: 1.5740 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.7117 | Val  Acc: 0.4483
 Site-MNIST-M   | Val  Loss: 1.7609 | Val  Acc: 0.4655
Average Valid Accuracy: 0.6679
Aggregated Acc | Val Acc: 0.5596
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1818
 Best site-USPS       | Epoch:6 | Val Acc: 0.7500
 Best site-USPS       | Epoch:6 | Val Acc: 0.8163
 Best site-USPS       | Epoch:6 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5128
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4483
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.6583, powerC: 0.3417
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0843 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9468 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.9134 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.0134 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8425 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.1784 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 0.9054 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.9663 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 1.0001 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.6344 | Train Acc: 0.4237
 Site-SynthDigits| Train Loss: 1.4595 | Train Acc: 0.5424
 Site-MNIST-M   | Train Loss: 1.8751 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.6950 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.9091 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.9354 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.0458 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0511 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8986 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 2.1867 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.9874 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.9512 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 0.9637 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.4935 | Val  Acc: 0.5897
 Site-SynthDigits| Val  Loss: 1.4931 | Val  Acc: 0.5769
 Site-MNIST-M   | Val  Loss: 1.6331 | Val  Acc: 0.5517
 Site-MNIST-M   | Val  Loss: 1.6877 | Val  Acc: 0.5690
Average Valid Accuracy: 0.6908
Aggregated Acc | Val Acc: 0.5831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1364
 Best site-USPS       | Epoch:7 | Val Acc: 0.7500
 Best site-USPS       | Epoch:7 | Val Acc: 0.8163
 Best site-USPS       | Epoch:7 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5897
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5769
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5517
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5690
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.6325, powerC: 0.3675
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0728 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8675 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.8693 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.9354 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.7847 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 2.1288 | Train Acc: 0.1515
 Site-USPS      | Train Loss: 0.9037 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.8631 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 0.9320 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.5941 | Train Acc: 0.4746
 Site-SynthDigits| Train Loss: 1.3979 | Train Acc: 0.5847
 Site-MNIST-M   | Train Loss: 1.7909 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.5808 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.8458 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.8745 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.9745 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9749 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8291 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 2.1904 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.9110 | Val  Acc: 0.7917
 Site-USPS      | Val  Loss: 0.8765 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.8917 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.4226 | Val  Acc: 0.5897
 Site-SynthDigits| Val  Loss: 1.4330 | Val  Acc: 0.6026
 Site-MNIST-M   | Val  Loss: 1.5537 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.6045 | Val  Acc: 0.6379
Average Valid Accuracy: 0.7200
Aggregated Acc | Val Acc: 0.6107
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1364
 Best site-USPS       | Epoch:8 | Val Acc: 0.7917
 Best site-USPS       | Epoch:8 | Val Acc: 0.8571
 Best site-USPS       | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5897
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6026
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6207
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[4, 3, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.6092, powerC: 0.3908
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.1890 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8112 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.8205 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8883 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.7270 | Train Acc: 0.8983
 Site-SVHN      | Train Loss: 1.9354 | Train Acc: 0.2424
 Site-USPS      | Train Loss: 0.8045 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.8190 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.8748 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.5067 | Train Acc: 0.5085
 Site-SynthDigits| Train Loss: 1.3624 | Train Acc: 0.6186
 Site-MNIST-M   | Train Loss: 1.7259 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.5097 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.7953 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.8255 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.9199 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9195 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7720 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.2039 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.8574 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.8368 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.8380 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3560 | Val  Acc: 0.6410
 Site-SynthDigits| Val  Loss: 1.3642 | Val  Acc: 0.6410
 Site-MNIST-M   | Val  Loss: 1.4723 | Val  Acc: 0.6552
 Site-MNIST-M   | Val  Loss: 1.5241 | Val  Acc: 0.6379
Average Valid Accuracy: 0.7306
Aggregated Acc | Val Acc: 0.7270
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1818
 Best site-USPS       | Epoch:9 | Val Acc: 0.8333
 Best site-USPS       | Epoch:9 | Val Acc: 0.8776
 Best site-USPS       | Epoch:9 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6410
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6410
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6552
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7529
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2841
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4788
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4007
Average Test Accuracy: 0.5532
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5883, powerC: 0.4117
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0537 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7519 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8067 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8405 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.6671 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.1954 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.7369 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.7698 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.8271 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.4528 | Train Acc: 0.4915
 Site-SynthDigits| Train Loss: 1.3169 | Train Acc: 0.6271
 Site-MNIST-M   | Train Loss: 1.7003 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.4491 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.7611 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7864 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.8784 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 0.8733 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7275 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1559 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.8028 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.7677 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7861 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2928 | Val  Acc: 0.6667
 Site-SynthDigits| Val  Loss: 1.2973 | Val  Acc: 0.6667
 Site-MNIST-M   | Val  Loss: 1.4134 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.4707 | Val  Acc: 0.7069
Average Valid Accuracy: 0.7482
Aggregated Acc | Val Acc: 0.6462
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:10 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1364
 Best site-USPS       | Epoch:10 | Val Acc: 0.8333
 Best site-USPS       | Epoch:10 | Val Acc: 0.8776
 Best site-USPS       | Epoch:10 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6667
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6667
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7241
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[3, 5, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5695, powerC: 0.4305
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8836 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7188 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.7717 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8073 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.6660 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.7367 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.6975 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.7306 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7808 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3844 | Train Acc: 0.5424
 Site-SynthDigits| Train Loss: 1.2235 | Train Acc: 0.6441
 Site-MNIST-M   | Train Loss: 1.6129 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.3753 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.7319 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.7568 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.8446 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 0.8381 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.6916 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.2141 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7682 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.7421 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7453 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.2398 | Val  Acc: 0.6923
 Site-SynthDigits| Val  Loss: 1.2446 | Val  Acc: 0.6282
 Site-MNIST-M   | Val  Loss: 1.3335 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.3944 | Val  Acc: 0.6552
Average Valid Accuracy: 0.7347
Aggregated Acc | Val Acc: 0.6412
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
client-12 is in G-2
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5525, powerC: 0.4475
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8600 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6881 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 0.7315 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7536 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6269 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6687 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.7384 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6926 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7466 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.3257 | Train Acc: 0.5932
 Site-SynthDigits| Train Loss: 1.1641 | Train Acc: 0.6525
 Site-MNIST-M   | Train Loss: 1.5578 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.3105 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.6887 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7110 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7981 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 0.7911 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6517 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.1679 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7279 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.6926 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7098 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1824 | Val  Acc: 0.6923
 Site-SynthDigits| Val  Loss: 1.1924 | Val  Acc: 0.6795
 Site-MNIST-M   | Val  Loss: 1.2565 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.3189 | Val  Acc: 0.7069
Average Valid Accuracy: 0.7611
Aggregated Acc | Val Acc: 0.6673
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1818
 Best site-USPS       | Epoch:12 | Val Acc: 0.8333
 Best site-USPS       | Epoch:12 | Val Acc: 0.8776
 Best site-USPS       | Epoch:12 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6923
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6795
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 13 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[5, 1, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.5373, powerC: 0.4627
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8849 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6385 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6853 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7181 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.5433 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0597 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.7102 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6699 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7283 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.2713 | Train Acc: 0.5932
 Site-SynthDigits| Train Loss: 1.1144 | Train Acc: 0.6780
 Site-MNIST-M   | Train Loss: 1.5276 | Train Acc: 0.5227
 Site-MNIST-M   | Train Loss: 1.2475 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.6299 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6608 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7566 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.7470 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6182 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1396 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6961 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.6538 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.6826 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1084 | Val  Acc: 0.7436
 Site-SynthDigits| Val  Loss: 1.1264 | Val  Acc: 0.6923
 Site-MNIST-M   | Val  Loss: 1.1945 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.2587 | Val  Acc: 0.7414
Average Valid Accuracy: 0.7777
Aggregated Acc | Val Acc: 0.6852
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1818
 Best site-USPS       | Epoch:13 | Val Acc: 0.8750
 Best site-USPS       | Epoch:13 | Val Acc: 0.8980
 Best site-USPS       | Epoch:13 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7436
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6923
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5235, powerC: 0.4765
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9257 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6258 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.6556 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6907 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.5522 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9202 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.6900 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6322 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.6987 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.2097 | Train Acc: 0.6610
 Site-SynthDigits| Train Loss: 1.0372 | Train Acc: 0.7034
 Site-MNIST-M   | Train Loss: 1.4587 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.1917 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.6077 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6419 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7359 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.7209 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.5952 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.1746 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.6638 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.6207 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.6562 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0561 | Val  Acc: 0.7436
 Site-SynthDigits| Val  Loss: 1.0804 | Val  Acc: 0.7436
 Site-MNIST-M   | Val  Loss: 1.1327 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.2001 | Val  Acc: 0.7586
Average Valid Accuracy: 0.7753
Aggregated Acc | Val Acc: 0.6792
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5112, powerC: 0.4888
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8561 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5703 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.5650 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6515 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5076 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.5631 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.5658 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6163 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.6637 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.1498 | Train Acc: 0.6610
 Site-SynthDigits| Train Loss: 1.0186 | Train Acc: 0.7288
 Site-MNIST-M   | Train Loss: 1.4148 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.1308 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.5733 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6132 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.6939 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6744 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5589 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1698 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6437 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.5922 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.6195 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.0129 | Val  Acc: 0.7692
 Site-SynthDigits| Val  Loss: 1.0360 | Val  Acc: 0.7564
 Site-MNIST-M   | Val  Loss: 1.0877 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.1506 | Val  Acc: 0.7931
Average Valid Accuracy: 0.8029
Aggregated Acc | Val Acc: 0.7116
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:15 | Val Acc: 0.1818
 Best site-USPS       | Epoch:15 | Val Acc: 0.8750
 Best site-USPS       | Epoch:15 | Val Acc: 0.8980
 Best site-USPS       | Epoch:15 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7692
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7564
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5001, powerC: 0.4999
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8263 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5573 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6187 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6315 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.4956 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5005 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.6428 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5852 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.6390 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.1226 | Train Acc: 0.7288
 Site-SynthDigits| Train Loss: 0.9778 | Train Acc: 0.7712
 Site-MNIST-M   | Train Loss: 1.3854 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.1006 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.5384 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5917 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6792 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6496 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5366 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2071 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6192 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.5657 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5992 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9572 | Val  Acc: 0.8205
 Site-SynthDigits| Val  Loss: 0.9810 | Val  Acc: 0.7949
 Site-MNIST-M   | Val  Loss: 1.0322 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.0944 | Val  Acc: 0.7931
Average Valid Accuracy: 0.8072
Aggregated Acc | Val Acc: 0.7184
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:16 | Val Acc: 0.1818
 Best site-USPS       | Epoch:16 | Val Acc: 0.8750
 Best site-USPS       | Epoch:16 | Val Acc: 0.8776
 Best site-USPS       | Epoch:16 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.8205
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7949
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.4901, powerC: 0.5099
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7459 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5082 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5778 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.5927 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4384 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7191 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.6883 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5365 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.6193 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.0848 | Train Acc: 0.7119
 Site-SynthDigits| Train Loss: 0.9347 | Train Acc: 0.7797
 Site-MNIST-M   | Train Loss: 1.3326 | Train Acc: 0.6136
 Site-MNIST-M   | Train Loss: 1.0357 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.5078 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5587 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6398 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6130 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5108 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1295 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5944 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5361 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5724 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9175 | Val  Acc: 0.7949
 Site-SynthDigits| Val  Loss: 0.9354 | Val  Acc: 0.7692
 Site-MNIST-M   | Val  Loss: 0.9992 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 1.0610 | Val  Acc: 0.7759
Average Valid Accuracy: 0.8036
Aggregated Acc | Val Acc: 0.7092
============ Train epoch 18 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.4811, powerC: 0.5189
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7132 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5025 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5687 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.5719 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4265 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4935 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5564 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5343 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.5920 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.0294 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8971 | Train Acc: 0.8220
 Site-MNIST-M   | Train Loss: 1.2630 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 0.9977 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.5024 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5505 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6298 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5927 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.4919 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2123 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5654 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5144 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5501 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.8701 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.9013 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 0.9344 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.9973 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8202
Aggregated Acc | Val Acc: 0.7321
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:18 | Val Acc: 0.1818
 Best site-USPS       | Epoch:18 | Val Acc: 0.8333
 Best site-USPS       | Epoch:18 | Val Acc: 0.8776
 Best site-USPS       | Epoch:18 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.4729, powerC: 0.5271
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6664 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4681 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5257 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5352 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.4098 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 2.0301 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.5414 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5540 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5793 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.9802 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8652 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.2042 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.9786 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.4460 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4992 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5828 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5548 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4714 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1689 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5365 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4832 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5374 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.8163 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.8451 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.8819 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9470 | Val  Acc: 0.8621
Average Valid Accuracy: 0.8359
Aggregated Acc | Val Acc: 0.7545
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2273
 Best site-USPS       | Epoch:19 | Val Acc: 0.8333
 Best site-USPS       | Epoch:19 | Val Acc: 0.8776
 Best site-USPS       | Epoch:19 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8590
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.8221
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3335
 Test site-USPS      | Epoch:19 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.6241
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.5364
Average Test Accuracy: 0.6385
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4657, powerC: 0.5343
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6531 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4490 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5344 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5125 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4068 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9536 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.6511 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5110 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.5604 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.9715 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8312 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.1955 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9018 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.4355 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4866 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5598 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5295 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4517 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2418 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5298 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4731 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5163 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.7911 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.8209 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.8566 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9186 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8365
Aggregated Acc | Val Acc: 0.7561
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:20 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:20 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:20 | Val Acc: 0.2273
 Best site-USPS       | Epoch:20 | Val Acc: 0.8333
 Best site-USPS       | Epoch:20 | Val Acc: 0.8776
 Best site-USPS       | Epoch:20 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:20 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:20 | Val Acc: 0.8448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 21 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4591, powerC: 0.5409
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7067 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4343 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5080 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4872 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.3873 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.1257 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5015 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4937 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.5372 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.9310 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.8163 | Train Acc: 0.8390
 Site-MNIST-M   | Train Loss: 1.1948 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8634 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.4093 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4695 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5457 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5084 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4332 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.3001 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5077 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4497 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5028 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.7704 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.7920 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.8248 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.8901 | Val  Acc: 0.8621
Average Valid Accuracy: 0.8355
Aggregated Acc | Val Acc: 0.7490
============ Train epoch 22 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4532, powerC: 0.5468
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5381 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4147 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4809 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4749 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.3624 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.1095 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.5013 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4706 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5245 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.9162 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.7640 | Train Acc: 0.8390
 Site-MNIST-M   | Train Loss: 1.1388 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8406 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.3889 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4429 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5288 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.4948 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4185 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1785 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4813 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.4311 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.4902 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.7117 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7535 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.7659 | Val  Acc: 0.9655
 Site-MNIST-M   | Val  Loss: 0.8346 | Val  Acc: 0.8793
Average Valid Accuracy: 0.8448
Aggregated Acc | Val Acc: 0.7639
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2273
 Best site-USPS       | Epoch:22 | Val Acc: 0.8750
 Best site-USPS       | Epoch:22 | Val Acc: 0.8980
 Best site-USPS       | Epoch:22 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.9655
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4479, powerC: 0.5521
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5438 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3935 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4390 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4542 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3281 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7252 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.6549 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4417 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.5065 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.8602 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.7596 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.0979 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.8071 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3669 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4230 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5057 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4690 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3996 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.1223 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.4699 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.4173 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.4720 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.6805 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7198 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.7323 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7990 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8653
Aggregated Acc | Val Acc: 0.7870
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2727
 Best site-USPS       | Epoch:23 | Val Acc: 0.9167
 Best site-USPS       | Epoch:23 | Val Acc: 0.9184
 Best site-USPS       | Epoch:23 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 24 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
client-12 is in G-0
cnt=[3, 1, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.4431, powerC: 0.5569
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5631 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3920 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4733 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4419 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.3531 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.5001 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4694 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4346 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4806 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.8398 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.7052 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.0606 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.7742 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3585 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4197 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5007 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4525 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3889 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.2276 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4361 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3842 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.4535 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.6647 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7005 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.6983 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7635 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8566
Aggregated Acc | Val Acc: 0.8569
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-4
client-12 is in G-4
cnt=[2, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.4388, powerC: 0.5612
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5263 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3785 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4904 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4197 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3070 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.4196 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4706 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4157 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4655 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.8126 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.6978 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 1.0684 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7555 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.3382 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3992 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4802 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4328 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3733 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.2315 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4225 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3758 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.4387 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.6356 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6765 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.6799 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7418 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8676
Aggregated Acc | Val Acc: 0.7848
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2273
 Best site-USPS       | Epoch:25 | Val Acc: 0.9167
 Best site-USPS       | Epoch:25 | Val Acc: 0.9388
 Best site-USPS       | Epoch:25 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4349, powerC: 0.5651
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5753 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3623 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4701 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4012 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2887 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1739 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4601 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4156 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4515 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.7766 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6739 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 1.0215 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.7293 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.3164 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3792 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4544 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4111 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3602 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.2359 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4148 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3643 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.4244 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.6190 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6567 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.6648 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7287 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8648
Aggregated Acc | Val Acc: 0.7782
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4314, powerC: 0.5686
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4543 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3439 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4111 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.3831 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.2829 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1839 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4243 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3923 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4439 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.7936 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.6607 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.9959 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7034 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.3068 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3678 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4387 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3949 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3444 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2132 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4088 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3583 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.4161 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5875 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6313 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.6342 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7007 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8666
Aggregated Acc | Val Acc: 0.7857
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.4283, powerC: 0.5717
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5099 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3381 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4257 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3703 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2812 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.3601 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4018 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3803 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4248 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.7394 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.6050 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9682 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6689 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.3044 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3640 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4344 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3859 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3358 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.1585 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3916 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3428 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3968 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5642 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6039 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.6052 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6711 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8781
Aggregated Acc | Val Acc: 0.8001
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2727
 Best site-USPS       | Epoch:28 | Val Acc: 0.9167
 Best site-USPS       | Epoch:28 | Val Acc: 0.9388
 Best site-USPS       | Epoch:28 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8974
 Best site-MNIST-M    | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.4254, powerC: 0.5746
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5103 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3307 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4672 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.3623 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2620 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1404 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.5649 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3835 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.4135 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7279 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6349 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9483 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.6503 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.2925 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3543 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4271 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3759 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3272 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.1575 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3797 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3322 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3899 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5298 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5773 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5831 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6470 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8745
Aggregated Acc | Val Acc: 0.7970
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4229, powerC: 0.5771
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4841 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3231 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4071 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3525 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2634 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 0.9223 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4237 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3622 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.4032 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7127 | Train Acc: 0.8305
 Site-SynthDigits| Train Loss: 0.5616 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9094 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6424 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2773 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3386 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4116 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3613 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3131 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1751 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3709 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3235 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3790 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5155 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5552 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5784 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6367 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8741
Aggregated Acc | Val Acc: 0.7958
============ Train epoch 31 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4206, powerC: 0.5794
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4158 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3105 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3732 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3280 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2510 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1372 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4810 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3768 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3891 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.6815 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.5633 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.8882 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.6071 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2609 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3170 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3859 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3424 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3023 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.0702 | Val  Acc: 0.3182
 Site-USPS      | Val  Loss: 0.3578 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3124 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3668 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5084 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5446 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5522 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6179 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8754
Aggregated Acc | Val Acc: 0.8038
============ Train epoch 32 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4185, powerC: 0.5815
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4266 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3198 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3721 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3214 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2342 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.1266 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4742 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3532 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3746 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6569 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.5560 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8823 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.5979 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2488 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3085 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3807 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3341 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2975 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.2369 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3386 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2968 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3604 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4998 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5333 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5277 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5953 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8757
Aggregated Acc | Val Acc: 0.7978
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
client-12 is in G-3
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4167, powerC: 0.5833
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4569 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3059 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3719 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3154 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.3759 | Train Acc: 0.6061
 Site-USPS      | Train Loss: 0.3767 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.3424 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3688 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6466 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5243 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8370 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5733 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2472 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3017 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3714 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3291 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2923 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2584 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3326 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2897 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3548 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4787 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5195 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5086 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5739 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8791
Aggregated Acc | Val Acc: 0.8010
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2727
 Best site-USPS       | Epoch:33 | Val Acc: 0.9167
 Best site-USPS       | Epoch:33 | Val Acc: 0.9388
 Best site-USPS       | Epoch:33 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4150, powerC: 0.5850
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4452 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2864 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3576 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3012 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2341 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.0778 | Train Acc: 0.6061
 Site-USPS      | Train Loss: 0.3724 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3254 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3617 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6154 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5169 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.8510 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.5677 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2419 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.2895 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3499 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3130 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2824 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2691 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3264 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2853 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3414 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4718 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5120 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.5128 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5737 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8779
Aggregated Acc | Val Acc: 0.7937
============ Train epoch 35 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4135, powerC: 0.5865
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3832 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2752 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3598 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2943 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2141 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.5638 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3550 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3184 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.3528 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6081 | Train Acc: 0.8305
 Site-SynthDigits| Train Loss: 0.4942 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8367 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.5588 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2222 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2808 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3466 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3082 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2721 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3249 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3157 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2721 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3407 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4643 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4998 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5041 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5612 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8843
Aggregated Acc | Val Acc: 0.8047
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2727
 Best site-USPS       | Epoch:35 | Val Acc: 0.9167
 Best site-USPS       | Epoch:35 | Val Acc: 0.9388
 Best site-USPS       | Epoch:35 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
client-12 is in G-3
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4122, powerC: 0.5878
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3601 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2790 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3557 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2869 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2158 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.9629 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3812 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3202 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3521 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5844 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5003 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7975 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5186 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2172 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2802 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3465 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3071 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2691 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3338 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3119 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2717 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3436 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4434 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4935 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4818 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5462 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8798
Aggregated Acc | Val Acc: 0.7947
============ Train epoch 37 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-0
client-12 is in G-0
cnt=[2, 2, 5, 3, 1, ]
power_decay: 0.9, powerI: 0.4109, powerC: 0.5891
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4287 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2690 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3253 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2831 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2085 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.8420 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.3598 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3166 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3421 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5684 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4743 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7632 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5092 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2129 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2737 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3350 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2986 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2617 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3151 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3119 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2692 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3318 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4244 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4777 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.4606 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5273 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8798
Aggregated Acc | Val Acc: 0.7943
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.4099, powerC: 0.5901
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3485 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2542 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3112 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2701 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2123 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.8339 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4625 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3086 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3351 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5575 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4460 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.7495 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4811 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.2087 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2646 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3198 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2878 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2575 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1993 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3120 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2617 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3169 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4068 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4533 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4426 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5092 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8903
Aggregated Acc | Val Acc: 0.8082
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2727
 Best site-USPS       | Epoch:38 | Val Acc: 0.9167
 Best site-USPS       | Epoch:38 | Val Acc: 0.9388
 Best site-USPS       | Epoch:38 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 39 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.4089, powerC: 0.5911
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3896 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3362 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2642 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2084 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0388 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3999 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.2884 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3241 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.5634 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4503 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.7398 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4855 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2106 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2597 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3139 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2789 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2529 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2031 | Val  Acc: 0.3182
 Site-USPS      | Val  Loss: 0.2925 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2495 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3071 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4002 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4489 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4213 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4907 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8913
Aggregated Acc | Val Acc: 0.8160
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:39 | Val Acc: 0.3182
 Best site-USPS       | Epoch:39 | Val Acc: 0.9167
 Best site-USPS       | Epoch:39 | Val Acc: 0.9388
 Best site-USPS       | Epoch:39 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8721
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3945
 Test site-USPS      | Epoch:39 | Test Acc: 0.9032
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.7339
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.5886
Average Test Accuracy: 0.6985
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.9, powerI: 0.4080, powerC: 0.5920
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3377 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2439 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3253 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2573 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.1959 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0314 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3439 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.2994 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.3128 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.5717 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4456 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.7367 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4558 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1956 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2507 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3077 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2665 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2477 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2386 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2761 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2353 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3038 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3913 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4354 | Val  Acc: 0.9231
 Site-MNIST-M   | Val  Loss: 0.4079 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4779 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8902
Aggregated Acc | Val Acc: 0.8086
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8764
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3879
 Test site-USPS      | Epoch:39 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.7347
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.5907
===2023-04-30 20:23:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 60
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,37,74,111,59,118,44,88,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.95, powerI: 0.9775, powerC: 0.0225
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 2.1623 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0584 | Train Acc: 0.2766
 Site-MNIST     | Train Loss: 1.9540 | Train Acc: 0.4366
 Site-MNIST     | Train Loss: 2.0281 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 1.9638 | Train Acc: 0.3644
 Site-SVHN      | Train Loss: 2.3046 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 2.0156 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 2.0026 | Train Acc: 0.3649
 Site-USPS      | Train Loss: 2.0269 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2280 | Train Acc: 0.2373
 Site-SynthDigits| Train Loss: 2.2151 | Train Acc: 0.2203
 Site-MNIST-M   | Train Loss: 2.3131 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.2751 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.0373 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0093 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.0492 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.0604 | Val  Acc: 0.3175
 Site-MNIST     | Val  Loss: 1.9675 | Val  Acc: 0.4557
 Site-SVHN      | Val  Loss: 2.3136 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.0551 | Val  Acc: 0.2083
 Site-USPS      | Val  Loss: 1.9684 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 2.0228 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 2.1763 | Val  Acc: 0.2308
 Site-SynthDigits| Val  Loss: 2.1820 | Val  Acc: 0.2179
 Site-MNIST-M   | Val  Loss: 2.2137 | Val  Acc: 0.1724
 Site-MNIST-M   | Val  Loss: 2.2598 | Val  Acc: 0.1207
Average Valid Accuracy: 0.2601
Aggregated Acc | Val Acc: 0.2192
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3175
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4557
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.2083
 Best site-USPS       | Epoch:0 | Val Acc: 0.3469
 Best site-USPS       | Epoch:0 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2308
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2179
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1724
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.9561, powerC: 0.0439
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.9958 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8336 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.7678 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8360 | Train Acc: 0.5213
 Site-MNIST     | Train Loss: 1.6978 | Train Acc: 0.6186
 Site-SVHN      | Train Loss: 2.2866 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.8449 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 1.7903 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 1.8416 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.1344 | Train Acc: 0.2712
 Site-SynthDigits| Train Loss: 2.1087 | Train Acc: 0.2797
 Site-MNIST-M   | Train Loss: 2.2773 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1849 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.7767 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7756 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.8577 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8768 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 1.7613 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2617 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.8566 | Val  Acc: 0.4583
 Site-USPS      | Val  Loss: 1.7810 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.8188 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.0948 | Val  Acc: 0.2821
 Site-SynthDigits| Val  Loss: 2.0932 | Val  Acc: 0.2821
 Site-MNIST-M   | Val  Loss: 2.1625 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.2036 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4345
Aggregated Acc | Val Acc: 0.3518
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1364
 Best site-USPS       | Epoch:1 | Val Acc: 0.4583
 Best site-USPS       | Epoch:1 | Val Acc: 0.5714
 Best site-USPS       | Epoch:1 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.9358, powerC: 0.0642
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.7985 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.6247 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.6268 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.6354 | Train Acc: 0.6277
 Site-MNIST     | Train Loss: 1.4918 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.3628 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.6729 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 1.5841 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.6493 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 2.0678 | Train Acc: 0.3220
 Site-SynthDigits| Train Loss: 2.0011 | Train Acc: 0.3220
 Site-MNIST-M   | Train Loss: 2.2366 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1096 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.5344 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5574 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.6672 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.6814 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.5540 | Val  Acc: 0.6582
 Site-SVHN      | Val  Loss: 2.2293 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.6640 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5994 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.6193 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.9968 | Val  Acc: 0.3846
 Site-SynthDigits| Val  Loss: 1.9848 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0893 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1244 | Val  Acc: 0.2586
Average Valid Accuracy: 0.4977
Aggregated Acc | Val Acc: 0.4058
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6582
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1364
 Best site-USPS       | Epoch:2 | Val Acc: 0.5000
 Best site-USPS       | Epoch:2 | Val Acc: 0.5714
 Best site-USPS       | Epoch:2 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3846
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[1, 3, 2, 3, 4, ]
power_decay: 0.95, powerI: 0.9165, powerC: 0.0835
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.5734 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.4090 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4157 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.4414 | Train Acc: 0.6915
 Site-MNIST     | Train Loss: 1.2998 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.2608 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 1.4637 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 1.3935 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 1.4532 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 1.9746 | Train Acc: 0.2881
 Site-SynthDigits| Train Loss: 1.8727 | Train Acc: 0.3475
 Site-MNIST-M   | Train Loss: 2.1560 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.0340 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.3106 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.3461 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.4614 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4824 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.3534 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.2420 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.4514 | Val  Acc: 0.6250
 Site-USPS      | Val  Loss: 1.4159 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 1.4149 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 1.8837 | Val  Acc: 0.4103
 Site-SynthDigits| Val  Loss: 1.8607 | Val  Acc: 0.4103
 Site-MNIST-M   | Val  Loss: 1.9895 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0242 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5637
Aggregated Acc | Val Acc: 0.5735
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1818
 Best site-USPS       | Epoch:3 | Val Acc: 0.6250
 Best site-USPS       | Epoch:3 | Val Acc: 0.6327
 Best site-USPS       | Epoch:3 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4103
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4103
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.95, powerI: 0.8982, powerC: 0.1018
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.4478 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.2505 | Train Acc: 0.6809
 Site-MNIST     | Train Loss: 1.2239 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.3061 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.2001 | Train Acc: 0.8475
 Site-SVHN      | Train Loss: 2.2180 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.2441 | Train Acc: 0.7568
 Site-USPS      | Train Loss: 1.2243 | Train Acc: 0.7297
 Site-USPS      | Train Loss: 1.2831 | Train Acc: 0.7387
 Site-SynthDigits| Train Loss: 1.9018 | Train Acc: 0.3390
 Site-SynthDigits| Train Loss: 1.7630 | Train Acc: 0.4322
 Site-MNIST-M   | Train Loss: 2.0772 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.9351 | Train Acc: 0.3295
 Site-MNIST     | Val  Loss: 1.1820 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.2156 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.3313 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.3485 | Val  Acc: 0.7143
 Site-MNIST     | Val  Loss: 1.2008 | Val  Acc: 0.7975
 Site-SVHN      | Val  Loss: 2.2555 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.2818 | Val  Acc: 0.7083
 Site-USPS      | Val  Loss: 1.2428 | Val  Acc: 0.7347
 Site-USPS      | Val  Loss: 1.2500 | Val  Acc: 0.7432
 Site-SynthDigits| Val  Loss: 1.7720 | Val  Acc: 0.4615
 Site-SynthDigits| Val  Loss: 1.7526 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 1.8914 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 1.9332 | Val  Acc: 0.3276
Average Valid Accuracy: 0.6079
Aggregated Acc | Val Acc: 0.4935
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7143
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7975
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1364
 Best site-USPS       | Epoch:4 | Val Acc: 0.7083
 Best site-USPS       | Epoch:4 | Val Acc: 0.7347
 Best site-USPS       | Epoch:4 | Val Acc: 0.7432
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4615
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 5 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.8808, powerC: 0.1192
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.2695 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1256 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.1234 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 1.1924 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.0400 | Train Acc: 0.8559
 Site-SVHN      | Train Loss: 2.2137 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 1.0978 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.1116 | Train Acc: 0.7703
 Site-USPS      | Train Loss: 1.1698 | Train Acc: 0.7568
 Site-SynthDigits| Train Loss: 1.7907 | Train Acc: 0.3898
 Site-SynthDigits| Train Loss: 1.6782 | Train Acc: 0.4915
 Site-MNIST-M   | Train Loss: 2.0142 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8318 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 1.0712 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.0975 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.2217 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.2383 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.0839 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.2128 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.1552 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.1177 | Val  Acc: 0.7551
 Site-USPS      | Val  Loss: 1.1303 | Val  Acc: 0.7568
 Site-SynthDigits| Val  Loss: 1.6518 | Val  Acc: 0.5128
 Site-SynthDigits| Val  Loss: 1.6490 | Val  Acc: 0.5256
 Site-MNIST-M   | Val  Loss: 1.8024 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.8500 | Val  Acc: 0.4655
Average Valid Accuracy: 0.6525
Aggregated Acc | Val Acc: 0.5406
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1364
 Best site-USPS       | Epoch:5 | Val Acc: 0.7500
 Best site-USPS       | Epoch:5 | Val Acc: 0.7551
 Best site-USPS       | Epoch:5 | Val Acc: 0.7568
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5128
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5256
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 6 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.8643, powerC: 0.1357
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.2891 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.0420 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.9969 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 1.1029 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.9487 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.2021 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.0434 | Train Acc: 0.7838
 Site-USPS      | Train Loss: 1.0047 | Train Acc: 0.7973
 Site-USPS      | Train Loss: 1.0717 | Train Acc: 0.8018
 Site-SynthDigits| Train Loss: 1.6833 | Train Acc: 0.4068
 Site-SynthDigits| Train Loss: 1.5657 | Train Acc: 0.5254
 Site-MNIST-M   | Train Loss: 1.9381 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.7494 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 1.0028 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.0265 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.1378 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 1.1449 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 0.9805 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.2279 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.0755 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.0474 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 1.0331 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 1.5834 | Val  Acc: 0.5128
 Site-SynthDigits| Val  Loss: 1.5758 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.7135 | Val  Acc: 0.4483
 Site-MNIST-M   | Val  Loss: 1.7629 | Val  Acc: 0.4655
Average Valid Accuracy: 0.6679
Aggregated Acc | Val Acc: 0.5596
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:6 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1818
 Best site-USPS       | Epoch:6 | Val Acc: 0.7500
 Best site-USPS       | Epoch:6 | Val Acc: 0.8163
 Best site-USPS       | Epoch:6 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5128
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4483
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 7 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.8485, powerC: 0.1515
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0845 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9473 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 0.9145 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 1.0134 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8446 | Train Acc: 0.8644
 Site-SVHN      | Train Loss: 2.1774 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 0.9055 | Train Acc: 0.8108
 Site-USPS      | Train Loss: 0.9666 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 1.0001 | Train Acc: 0.8378
 Site-SynthDigits| Train Loss: 1.6334 | Train Acc: 0.4237
 Site-SynthDigits| Train Loss: 1.4613 | Train Acc: 0.5424
 Site-MNIST-M   | Train Loss: 1.8736 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.6978 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.9111 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.9369 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.0458 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0511 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8995 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 2.1871 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.9883 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.9517 | Val  Acc: 0.8163
 Site-USPS      | Val  Loss: 0.9639 | Val  Acc: 0.8649
 Site-SynthDigits| Val  Loss: 1.4960 | Val  Acc: 0.5897
 Site-SynthDigits| Val  Loss: 1.4952 | Val  Acc: 0.5769
 Site-MNIST-M   | Val  Loss: 1.6359 | Val  Acc: 0.5517
 Site-MNIST-M   | Val  Loss: 1.6906 | Val  Acc: 0.5690
Average Valid Accuracy: 0.6908
Aggregated Acc | Val Acc: 0.5831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1364
 Best site-USPS       | Epoch:7 | Val Acc: 0.7500
 Best site-USPS       | Epoch:7 | Val Acc: 0.8163
 Best site-USPS       | Epoch:7 | Val Acc: 0.8649
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5897
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5769
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5517
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5690
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-2
client-12 is in G-2
cnt=[5, 2, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.8336, powerC: 0.1664
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0726 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8681 | Train Acc: 0.7872
 Site-MNIST     | Train Loss: 0.8702 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.9352 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.7867 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.1265 | Train Acc: 0.1515
 Site-USPS      | Train Loss: 0.9040 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.8638 | Train Acc: 0.8514
 Site-USPS      | Train Loss: 0.9321 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 1.5923 | Train Acc: 0.4746
 Site-SynthDigits| Train Loss: 1.4002 | Train Acc: 0.5763
 Site-MNIST-M   | Train Loss: 1.7891 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.5841 | Train Acc: 0.5909
 Site-MNIST     | Val  Loss: 0.8476 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.8758 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.9740 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9746 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.8301 | Val  Acc: 0.8481
 Site-SVHN      | Val  Loss: 2.1910 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.9118 | Val  Acc: 0.7917
 Site-USPS      | Val  Loss: 0.8769 | Val  Acc: 0.8571
 Site-USPS      | Val  Loss: 0.8921 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 1.4258 | Val  Acc: 0.5897
 Site-SynthDigits| Val  Loss: 1.4357 | Val  Acc: 0.6154
 Site-MNIST-M   | Val  Loss: 1.5569 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.6078 | Val  Acc: 0.6379
Average Valid Accuracy: 0.7222
Aggregated Acc | Val Acc: 0.6126
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8481
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1364
 Best site-USPS       | Epoch:8 | Val Acc: 0.7917
 Best site-USPS       | Epoch:8 | Val Acc: 0.8571
 Best site-USPS       | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5897
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6154
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6207
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[4, 3, 2, 1, 3, ]
power_decay: 0.95, powerI: 0.8194, powerC: 0.1806
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.1891 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.8115 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8216 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8873 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.7286 | Train Acc: 0.8898
 Site-SVHN      | Train Loss: 1.9228 | Train Acc: 0.2424
 Site-USPS      | Train Loss: 0.8050 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.8196 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.8746 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.5030 | Train Acc: 0.5254
 Site-SynthDigits| Train Loss: 1.3654 | Train Acc: 0.6186
 Site-MNIST-M   | Train Loss: 1.7246 | Train Acc: 0.3636
 Site-MNIST-M   | Train Loss: 1.5161 | Train Acc: 0.6023
 Site-MNIST     | Val  Loss: 0.7962 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.8265 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.9192 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9184 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7728 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.2085 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.8580 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.8368 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.8384 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.3601 | Val  Acc: 0.6410
 Site-SynthDigits| Val  Loss: 1.3675 | Val  Acc: 0.6410
 Site-MNIST-M   | Val  Loss: 1.4789 | Val  Acc: 0.6552
 Site-MNIST-M   | Val  Loss: 1.5310 | Val  Acc: 0.6379
Average Valid Accuracy: 0.7306
Aggregated Acc | Val Acc: 0.7270
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1818
 Best site-USPS       | Epoch:9 | Val Acc: 0.8333
 Best site-USPS       | Epoch:9 | Val Acc: 0.8776
 Best site-USPS       | Epoch:9 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6410
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6410
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6552
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6379
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7543
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2806
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4789
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3979
Average Test Accuracy: 0.5522
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.8060, powerC: 0.1940
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0531 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7528 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.8073 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8401 | Train Acc: 0.8617
 Site-MNIST     | Train Loss: 0.6700 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 2.1928 | Train Acc: 0.2727
 Site-USPS      | Train Loss: 0.7372 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.7702 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.8268 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.4493 | Train Acc: 0.4915
 Site-SynthDigits| Train Loss: 1.3204 | Train Acc: 0.6271
 Site-MNIST-M   | Train Loss: 1.6969 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 1.4538 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.7641 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7883 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.8780 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.8731 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7286 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1554 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.8038 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.7682 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7862 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 1.2972 | Val  Acc: 0.6667
 Site-SynthDigits| Val  Loss: 1.3016 | Val  Acc: 0.6667
 Site-MNIST-M   | Val  Loss: 1.4185 | Val  Acc: 0.7241
 Site-MNIST-M   | Val  Loss: 1.4758 | Val  Acc: 0.7069
Average Valid Accuracy: 0.7498
Aggregated Acc | Val Acc: 0.6470
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:10 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:10 | Val Acc: 0.1364
 Best site-USPS       | Epoch:10 | Val Acc: 0.8333
 Best site-USPS       | Epoch:10 | Val Acc: 0.8776
 Best site-USPS       | Epoch:10 | Val Acc: 0.8919
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6667
 Best site-SynthDigits | Epoch:10 | Val Acc: 0.6667
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7241
 Best site-MNIST-M    | Epoch:10 | Val Acc: 0.7069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 11 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[3, 5, 1, 2, 2, ]
power_decay: 0.95, powerI: 0.7932, powerC: 0.2068
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8837 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.7203 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.7728 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.8079 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.6702 | Train Acc: 0.9153
 Site-SVHN      | Train Loss: 1.7382 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.6978 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.7316 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7810 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.3815 | Train Acc: 0.5593
 Site-SynthDigits| Train Loss: 1.2280 | Train Acc: 0.6441
 Site-MNIST-M   | Train Loss: 1.6077 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 1.3790 | Train Acc: 0.6477
 Site-MNIST     | Val  Loss: 0.7371 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.7600 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.8449 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 0.8390 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.6932 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2123 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7702 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.7439 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7458 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.2449 | Val  Acc: 0.6923
 Site-SynthDigits| Val  Loss: 1.2497 | Val  Acc: 0.6410
 Site-MNIST-M   | Val  Loss: 1.3380 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.3987 | Val  Acc: 0.6552
Average Valid Accuracy: 0.7355
Aggregated Acc | Val Acc: 0.6423
============ Train epoch 12 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
client-12 is in G-2
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.7810, powerC: 0.2190
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8604 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6889 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 0.7329 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7532 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6298 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.6676 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.7391 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6933 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.7460 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.3213 | Train Acc: 0.6102
 Site-SynthDigits| Train Loss: 1.1682 | Train Acc: 0.6525
 Site-MNIST-M   | Train Loss: 1.5531 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.3165 | Train Acc: 0.6932
 Site-MNIST     | Val  Loss: 0.6910 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7128 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7980 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 0.7907 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.6528 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.1710 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7285 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.6928 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.7103 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 1.1875 | Val  Acc: 0.6923
 Site-SynthDigits| Val  Loss: 1.1971 | Val  Acc: 0.6795
 Site-MNIST-M   | Val  Loss: 1.2623 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.3250 | Val  Acc: 0.7069
Average Valid Accuracy: 0.7611
Aggregated Acc | Val Acc: 0.6673
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:12 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8608
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1818
 Best site-USPS       | Epoch:12 | Val Acc: 0.8333
 Best site-USPS       | Epoch:12 | Val Acc: 0.8776
 Best site-USPS       | Epoch:12 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6923
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6795
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 13 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[5, 1, 2, 3, 2, ]
power_decay: 0.95, powerI: 0.7695, powerC: 0.2305
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8851 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6393 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6861 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7177 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.5465 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 2.0543 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.7115 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6710 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.7281 | Train Acc: 0.8739
 Site-SynthDigits| Train Loss: 1.2664 | Train Acc: 0.5932
 Site-SynthDigits| Train Loss: 1.1196 | Train Acc: 0.6864
 Site-MNIST-M   | Train Loss: 1.5212 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.2530 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.6330 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6628 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7563 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.7467 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6192 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1417 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6974 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.6549 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.6833 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.1144 | Val  Acc: 0.7436
 Site-SynthDigits| Val  Loss: 1.1321 | Val  Acc: 0.6923
 Site-MNIST-M   | Val  Loss: 1.1999 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.2643 | Val  Acc: 0.7241
Average Valid Accuracy: 0.7775
Aggregated Acc | Val Acc: 0.6841
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:13 | Val Acc: 0.1818
 Best site-USPS       | Epoch:13 | Val Acc: 0.8750
 Best site-USPS       | Epoch:13 | Val Acc: 0.8980
 Best site-USPS       | Epoch:13 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.7436
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6923
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.8276
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.7585, powerC: 0.2415
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9240 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6263 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.6559 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6899 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.5557 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.9189 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.6910 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6336 | Train Acc: 0.8784
 Site-USPS      | Train Loss: 0.6988 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 1.2061 | Train Acc: 0.6610
 Site-SynthDigits| Train Loss: 1.0431 | Train Acc: 0.6949
 Site-MNIST-M   | Train Loss: 1.4511 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.1974 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.6113 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6439 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7349 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.7203 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5960 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.1740 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.6660 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.6225 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.6571 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 1.0637 | Val  Acc: 0.7436
 Site-SynthDigits| Val  Loss: 1.0874 | Val  Acc: 0.7436
 Site-MNIST-M   | Val  Loss: 1.1390 | Val  Acc: 0.8276
 Site-MNIST-M   | Val  Loss: 1.2064 | Val  Acc: 0.7414
Average Valid Accuracy: 0.7752
Aggregated Acc | Val Acc: 0.6781
============ Train epoch 15 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.7481, powerC: 0.2519
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8552 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5705 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.5657 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6508 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5112 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 1.5612 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.5667 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.6173 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.6637 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.1442 | Train Acc: 0.6780
 Site-SynthDigits| Train Loss: 1.0242 | Train Acc: 0.7203
 Site-MNIST-M   | Train Loss: 1.4059 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.1388 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.5765 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6150 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.6932 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6738 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5600 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1710 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.6452 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.5936 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.6205 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 1.0200 | Val  Acc: 0.7692
 Site-SynthDigits| Val  Loss: 1.0424 | Val  Acc: 0.7564
 Site-MNIST-M   | Val  Loss: 1.0958 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.1591 | Val  Acc: 0.7759
Average Valid Accuracy: 0.8050
Aggregated Acc | Val Acc: 0.7190
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:15 | Val Acc: 0.2273
 Best site-USPS       | Epoch:15 | Val Acc: 0.8750
 Best site-USPS       | Epoch:15 | Val Acc: 0.8980
 Best site-USPS       | Epoch:15 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7692
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.7564
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.7382, powerC: 0.2618
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8246 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5570 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6191 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6305 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4989 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.5038 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.6438 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5854 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.6385 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.1176 | Train Acc: 0.7288
 Site-SynthDigits| Train Loss: 0.9829 | Train Acc: 0.7627
 Site-MNIST-M   | Train Loss: 1.3759 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.1093 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.5409 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5929 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6781 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6486 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.5375 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2053 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6192 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.5655 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.5996 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9630 | Val  Acc: 0.8205
 Site-SynthDigits| Val  Loss: 0.9867 | Val  Acc: 0.7949
 Site-MNIST-M   | Val  Loss: 1.0413 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.1039 | Val  Acc: 0.7759
Average Valid Accuracy: 0.8087
Aggregated Acc | Val Acc: 0.7186
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:16 | Val Acc: 0.1818
 Best site-USPS       | Epoch:16 | Val Acc: 0.8750
 Best site-USPS       | Epoch:16 | Val Acc: 0.8980
 Best site-USPS       | Epoch:16 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.8205
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7949
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 17 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.7287, powerC: 0.2713
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7440 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5080 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5786 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.5916 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4422 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.7181 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.6896 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5368 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.6191 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 1.0793 | Train Acc: 0.7119
 Site-SynthDigits| Train Loss: 0.9395 | Train Acc: 0.7797
 Site-MNIST-M   | Train Loss: 1.3206 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.0456 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.5106 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5602 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6387 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6120 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.5121 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1294 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5951 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5363 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5731 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.9231 | Val  Acc: 0.7692
 Site-SynthDigits| Val  Loss: 0.9406 | Val  Acc: 0.7692
 Site-MNIST-M   | Val  Loss: 1.0096 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 1.0718 | Val  Acc: 0.7759
Average Valid Accuracy: 0.8017
Aggregated Acc | Val Acc: 0.7067
============ Train epoch 18 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.95, powerI: 0.7198, powerC: 0.2802
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7105 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.5023 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5687 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.5705 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4306 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.4927 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5570 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5358 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.5922 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 1.0243 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.9031 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.2488 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 1.0081 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.5065 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5527 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6281 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5915 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.4927 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2150 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5676 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.5159 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5514 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.8770 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.9076 | Val  Acc: 0.8333
 Site-MNIST-M   | Val  Loss: 0.9450 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.0080 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8185
Aggregated Acc | Val Acc: 0.7386
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2273
 Best site-USPS       | Epoch:18 | Val Acc: 0.8333
 Best site-USPS       | Epoch:18 | Val Acc: 0.8776
 Best site-USPS       | Epoch:18 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8333
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.95, powerI: 0.7113, powerC: 0.2887
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6646 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4684 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5266 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5351 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.4150 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 2.0312 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.5413 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5547 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5790 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.9737 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8705 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.1911 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.9895 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.4513 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5024 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5827 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5546 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4726 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1703 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5376 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4835 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5383 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.8226 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.8511 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.8924 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9576 | Val  Acc: 0.8621
Average Valid Accuracy: 0.8339
Aggregated Acc | Val Acc: 0.7519
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:19 | Val Acc: 0.9048
 Best site-MNIST      | Epoch:19 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:19 | Val Acc: 0.2273
 Best site-USPS       | Epoch:19 | Val Acc: 0.8333
 Best site-USPS       | Epoch:19 | Val Acc: 0.8776
 Best site-USPS       | Epoch:19 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:19 | Val Acc: 0.8590
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:19 | Val Acc: 0.8621
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:19 | Test Acc: 0.8207
 Test site-SVHN      | Epoch:19 | Test Acc: 0.3320
 Test site-USPS      | Epoch:19 | Test Acc: 0.8763
 Test site-SynthDigits| Epoch:19 | Test Acc: 0.6244
 Test site-MNIST-M   | Epoch:19 | Test Acc: 0.5364
Average Test Accuracy: 0.6380
============ Train epoch 20 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.7033, powerC: 0.2967
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6505 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4495 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5351 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5122 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4118 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.9532 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.6525 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.5122 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.5601 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.9648 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8364 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.1813 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.9114 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.4398 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4891 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5597 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5291 | Val  Acc: 0.9048
 Site-MNIST     | Val  Loss: 0.4530 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.2432 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5302 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4731 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5175 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.7968 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.8265 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.8666 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9288 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8330
Aggregated Acc | Val Acc: 0.7470
============ Train epoch 21 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.6956, powerC: 0.3044
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7040 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4343 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.5083 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4866 | Train Acc: 0.9043
 Site-MNIST     | Train Loss: 0.3919 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.1242 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5026 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4949 | Train Acc: 0.9054
 Site-USPS      | Train Loss: 0.5369 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.9237 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.8217 | Train Acc: 0.8390
 Site-MNIST-M   | Train Loss: 1.1778 | Train Acc: 0.6591
 Site-MNIST-M   | Train Loss: 0.8741 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.4135 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4718 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5452 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.5078 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4342 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.3004 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5083 | Val  Acc: 0.8333
 Site-USPS      | Val  Loss: 0.4500 | Val  Acc: 0.8776
 Site-USPS      | Val  Loss: 0.5041 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.7760 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.7978 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.8360 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9013 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8342
Aggregated Acc | Val Acc: 0.7472
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:21 | Val Acc: 0.1818
 Best site-USPS       | Epoch:21 | Val Acc: 0.8333
 Best site-USPS       | Epoch:21 | Val Acc: 0.8776
 Best site-USPS       | Epoch:21 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 22 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6883, powerC: 0.3117
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5359 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.4141 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4807 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4739 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3672 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.1102 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.5021 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4713 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.5238 | Train Acc: 0.8829
 Site-SynthDigits| Train Loss: 0.9096 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.7689 | Train Acc: 0.8390
 Site-MNIST-M   | Train Loss: 1.1213 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.8525 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.3929 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4452 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5284 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.4941 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4192 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1792 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4818 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.4309 | Val  Acc: 0.8980
 Site-USPS      | Val  Loss: 0.4909 | Val  Acc: 0.9054
 Site-SynthDigits| Val  Loss: 0.7172 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7590 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.7793 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.8476 | Val  Acc: 0.8793
Average Valid Accuracy: 0.8433
Aggregated Acc | Val Acc: 0.7611
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:22 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:22 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:22 | Val Acc: 0.2273
 Best site-USPS       | Epoch:22 | Val Acc: 0.8750
 Best site-USPS       | Epoch:22 | Val Acc: 0.8980
 Best site-USPS       | Epoch:22 | Val Acc: 0.9054
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:22 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:22 | Val Acc: 0.8793
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 23 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6814, powerC: 0.3186
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5422 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3937 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4392 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.4537 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3326 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7227 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.6571 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4427 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.5053 | Train Acc: 0.8919
 Site-SynthDigits| Train Loss: 0.8517 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.7655 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.0804 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.8203 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3715 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4255 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5056 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4684 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.4006 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.1278 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.4693 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.4163 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.4728 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.6864 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7259 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.7458 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.8125 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8653
Aggregated Acc | Val Acc: 0.7870
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:23 | Val Acc: 0.2727
 Best site-USPS       | Epoch:23 | Val Acc: 0.9167
 Best site-USPS       | Epoch:23 | Val Acc: 0.9184
 Best site-USPS       | Epoch:23 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 24 ============
gmm
client-0 is in G-4
client-1 is in G-1
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
client-12 is in G-0
cnt=[3, 1, 3, 2, 4, ]
power_decay: 0.95, powerI: 0.6748, powerC: 0.3252
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5639 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3921 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4732 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4421 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3587 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.4937 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.4704 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4373 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.4797 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.8299 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.7110 | Train Acc: 0.8475
 Site-MNIST-M   | Train Loss: 1.0447 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.7939 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3654 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4236 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5010 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4524 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3901 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2533 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4375 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3853 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.4545 | Val  Acc: 0.8919
 Site-SynthDigits| Val  Loss: 0.6710 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7073 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.7177 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7829 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8562
Aggregated Acc | Val Acc: 0.8564
============ Train epoch 25 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-4
client-12 is in G-4
cnt=[2, 5, 1, 3, 2, ]
power_decay: 0.95, powerI: 0.6686, powerC: 0.3314
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5255 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3782 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4899 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4195 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3121 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.4097 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4720 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4179 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4645 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.8057 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.7043 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 1.0507 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.7735 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.3441 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4023 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4800 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4323 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3741 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.2407 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4237 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3763 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.4400 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.6424 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6835 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.6977 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7597 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8687
Aggregated Acc | Val Acc: 0.7857
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:25 | Val Acc: 0.2273
 Best site-USPS       | Epoch:25 | Val Acc: 0.9167
 Best site-USPS       | Epoch:25 | Val Acc: 0.9388
 Best site-USPS       | Epoch:25 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 26 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.6627, powerC: 0.3373
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5707 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3618 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4696 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4005 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2939 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1648 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4616 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.4175 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4511 | Train Acc: 0.9099
 Site-SynthDigits| Train Loss: 0.7701 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6794 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 1.0020 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7455 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3216 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3817 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4538 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.4103 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3608 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2287 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4161 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3649 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.4257 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.6248 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6627 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.6816 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7460 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8657
Aggregated Acc | Val Acc: 0.7777
============ Train epoch 27 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6570, powerC: 0.3430
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4520 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3434 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4106 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.3826 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2877 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1816 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4256 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3938 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.4438 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.7863 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.6665 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.9761 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.7194 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.3123 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3704 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4385 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3944 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3450 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2038 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.4101 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.3589 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.4176 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.5933 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6374 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.6504 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7177 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8651
Aggregated Acc | Val Acc: 0.7843
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.95, powerI: 0.6517, powerC: 0.3483
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5079 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3377 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4248 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3694 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2862 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.3576 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4036 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3821 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.4241 | Train Acc: 0.9189
 Site-SynthDigits| Train Loss: 0.7325 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.6110 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9478 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6847 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.3098 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3664 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4339 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3851 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3362 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.1529 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3922 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3432 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3983 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5706 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.6103 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.6210 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6879 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8771
Aggregated Acc | Val Acc: 0.7992
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2727
 Best site-USPS       | Epoch:28 | Val Acc: 0.9167
 Best site-USPS       | Epoch:28 | Val Acc: 0.9388
 Best site-USPS       | Epoch:28 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8974
 Best site-MNIST-M    | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.95, powerI: 0.6466, powerC: 0.3534
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5062 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3303 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4651 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.3617 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2668 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1391 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.5667 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3852 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.4129 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.7205 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6415 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9284 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.6663 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.2984 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3568 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4266 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3753 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3274 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.1522 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3802 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3325 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3912 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5362 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5838 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5983 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6632 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8745
Aggregated Acc | Val Acc: 0.7970
============ Train epoch 30 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6418, powerC: 0.3582
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4799 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3219 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.4049 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3519 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2684 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 0.9199 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4249 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3642 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.4037 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.7058 | Train Acc: 0.8305
 Site-SynthDigits| Train Loss: 0.5676 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.8891 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.6587 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.2840 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3414 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4112 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3608 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3129 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1683 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3735 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3254 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3803 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5219 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5614 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5940 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6531 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8741
Aggregated Acc | Val Acc: 0.7958
============ Train epoch 31 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6372, powerC: 0.3628
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4147 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.3108 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3722 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3282 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2563 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1364 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.4806 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3784 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3886 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.6732 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.5689 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.8679 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6220 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.2673 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3203 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3867 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3424 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3022 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.0680 | Val  Acc: 0.3182
 Site-USPS      | Val  Loss: 0.3590 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.3133 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3678 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.5150 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5513 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5668 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6334 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8754
Aggregated Acc | Val Acc: 0.8038
============ Train epoch 32 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6328, powerC: 0.3672
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4209 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3206 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3709 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3216 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2391 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.1222 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4761 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3553 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3744 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6487 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.5621 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.8593 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6143 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2547 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3112 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3812 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3339 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2973 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.2342 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3403 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2981 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3619 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.5062 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5398 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5422 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6113 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8757
Aggregated Acc | Val Acc: 0.7978
============ Train epoch 33 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
client-12 is in G-3
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.6287, powerC: 0.3713
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4515 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3051 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3698 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3144 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2541 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.3745 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3776 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.3434 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3693 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6390 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5305 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.8133 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5887 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2529 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3039 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3709 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3279 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2914 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2491 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3347 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2910 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3556 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4848 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5254 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5232 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5897 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8791
Aggregated Acc | Val Acc: 0.8010
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:33 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:33 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:33 | Val Acc: 0.2727
 Best site-USPS       | Epoch:33 | Val Acc: 0.9167
 Best site-USPS       | Epoch:33 | Val Acc: 0.9388
 Best site-USPS       | Epoch:33 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:33 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:33 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:33 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 34 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6247, powerC: 0.3753
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4401 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2862 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3556 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.3010 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2396 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.0775 | Train Acc: 0.6061
 Site-USPS      | Train Loss: 0.3728 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3269 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3620 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6081 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5232 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8259 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.5834 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2474 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.2923 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3505 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3125 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2818 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2581 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3281 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2864 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3425 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4783 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5186 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.5277 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5899 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8801
Aggregated Acc | Val Acc: 0.8011
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:34 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:34 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:34 | Val Acc: 0.2727
 Best site-USPS       | Epoch:34 | Val Acc: 0.9167
 Best site-USPS       | Epoch:34 | Val Acc: 0.9388
 Best site-USPS       | Epoch:34 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:34 | Val Acc: 0.8974
 Best site-MNIST-M    | Epoch:34 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:34 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 35 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6210, powerC: 0.3790
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3797 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2753 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3577 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2942 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2187 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.5578 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3560 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3205 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.3529 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.6011 | Train Acc: 0.8305
 Site-SynthDigits| Train Loss: 0.5008 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8127 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.5743 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.2278 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2837 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3475 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3081 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2717 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3193 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3169 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2728 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3422 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4711 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.5068 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.5181 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5766 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8830
Aggregated Acc | Val Acc: 0.8030
 Best site-MNIST      | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:35 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:35 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:35 | Val Acc: 0.2727
 Best site-USPS       | Epoch:35 | Val Acc: 0.9167
 Best site-USPS       | Epoch:35 | Val Acc: 0.9388
 Best site-USPS       | Epoch:35 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:35 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:35 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 36 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
client-12 is in G-3
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.6175, powerC: 0.3825
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3566 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2784 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3530 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2864 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2202 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.9574 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3824 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3223 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3514 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5777 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5066 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7722 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5332 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2224 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2825 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.3464 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3064 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2685 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3193 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3125 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2717 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3443 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.4499 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4999 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4954 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5611 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8784
Aggregated Acc | Val Acc: 0.7930
============ Train epoch 37 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-1
client-10 is in G-1
client-11 is in G-0
client-12 is in G-0
cnt=[2, 2, 5, 3, 1, ]
power_decay: 0.95, powerI: 0.6141, powerC: 0.3859
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4256 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2686 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3228 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2827 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2134 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.8447 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.3606 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3179 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3412 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5616 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4806 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7384 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.5253 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2183 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2763 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3359 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2985 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2611 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2931 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3122 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2690 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3323 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.4308 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4840 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.4746 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5424 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8810
Aggregated Acc | Val Acc: 0.7939
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-0
client-10 is in G-0
client-11 is in G-3
client-12 is in G-3
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.6109, powerC: 0.3891
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3461 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2539 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3090 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2702 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2175 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.8358 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4625 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.3104 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3340 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.5507 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4517 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.7253 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4957 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2143 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2673 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3207 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2877 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2568 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1871 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3123 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2617 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3177 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4133 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4597 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4561 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5238 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8890
Aggregated Acc | Val Acc: 0.8065
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:38 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2727
 Best site-USPS       | Epoch:38 | Val Acc: 0.9167
 Best site-USPS       | Epoch:38 | Val Acc: 0.9388
 Best site-USPS       | Epoch:38 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 39 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6078, powerC: 0.3922
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3873 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2485 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3331 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2642 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2135 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.0333 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.4005 | Train Acc: 0.8378
 Site-USPS      | Train Loss: 0.2900 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3243 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.5559 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4561 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.7145 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5007 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2160 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2623 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3145 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2787 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2522 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1930 | Val  Acc: 0.3182
 Site-USPS      | Val  Loss: 0.2940 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2504 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3082 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.4061 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4548 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4344 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5053 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8900
Aggregated Acc | Val Acc: 0.8143
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:39 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:39 | Val Acc: 0.3182
 Best site-USPS       | Epoch:39 | Val Acc: 0.9167
 Best site-USPS       | Epoch:39 | Val Acc: 0.9388
 Best site-USPS       | Epoch:39 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.9103
 Best site-MNIST-M    | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8721
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3924
 Test site-USPS      | Epoch:39 | Test Acc: 0.8978
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.7354
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.5957
Average Test Accuracy: 0.6987
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.95, powerI: 0.6049, powerC: 0.3951
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3354 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2432 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3225 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.2576 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2013 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0283 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3441 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3008 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.3130 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.5647 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4513 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.7108 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4705 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.2014 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2535 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3084 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2665 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2471 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2310 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2777 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2366 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.3047 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3976 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4417 | Val  Acc: 0.9231
 Site-MNIST-M   | Val  Loss: 0.4209 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4930 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8879
Aggregated Acc | Val Acc: 0.8059
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8764
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3879
 Test site-USPS      | Epoch:39 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.7351
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.5893
Average Test Accuracy: 0.6995
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 41 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.6022, powerC: 0.3978
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3271 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2394 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3394 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2491 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2281 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.9619 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3029 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3030 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.3066 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.5260 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4448 | Train Acc: 0.9068
 Site-MNIST-M   | Train Loss: 0.6808 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4858 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.1974 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2508 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3047 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2611 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2413 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.4298 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2691 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2318 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.3047 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3827 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.4299 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.4070 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4791 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8932
Aggregated Acc | Val Acc: 0.8142
 Best site-MNIST      | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:41 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:41 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:41 | Val Acc: 0.2727
 Best site-USPS       | Epoch:41 | Val Acc: 0.9167
 Best site-USPS       | Epoch:41 | Val Acc: 0.9592
 Best site-USPS       | Epoch:41 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:41 | Val Acc: 0.9359
 Best site-MNIST-M    | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:41 | Val Acc: 0.9483
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8771
 Test site-SVHN      | Epoch:41 | Test Acc: 0.3668
 Test site-USPS      | Epoch:41 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.7379
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.5871
Average Test Accuracy: 0.6995
============ Train epoch 42 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.5996, powerC: 0.4004
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3648 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2220 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2984 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2406 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1925 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.9191 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3257 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.2921 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.3082 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.5273 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.4292 | Train Acc: 0.9068
 Site-MNIST-M   | Train Loss: 0.6744 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4515 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.1873 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2362 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2850 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.2521 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2309 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.3579 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2759 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2329 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.2917 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3670 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4169 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4067 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4690 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8896
Aggregated Acc | Val Acc: 0.8064
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8757
 Test site-SVHN      | Epoch:41 | Test Acc: 0.3678
 Test site-USPS      | Epoch:41 | Test Acc: 0.9032
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.7415
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.5879
Average Test Accuracy: 0.6995
============ Train epoch 43 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[5, 3, 1, 2, 2, ]
power_decay: 0.95, powerI: 0.5971, powerC: 0.4029
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3557 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2275 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3111 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2448 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.1903 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.8891 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4745 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.2930 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.3019 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.5130 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4232 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.6571 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4470 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1976 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.2508 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.2951 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.2549 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2268 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2004 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2753 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2289 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.2822 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3701 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4102 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.3912 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4553 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8813
Aggregated Acc | Val Acc: 0.8021
 Test site-MNIST     | Epoch:41 | Test Acc: 0.8793
 Test site-SVHN      | Epoch:41 | Test Acc: 0.4040
 Test site-USPS      | Epoch:41 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:41 | Test Acc: 0.7426
 Test site-MNIST-M   | Epoch:41 | Test Acc: 0.5993
Average Test Accuracy: 0.7068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.5947, powerC: 0.4053
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2589 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2225 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2913 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2382 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1899 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 0.8480 | Train Acc: 0.6061
 Site-USPS      | Train Loss: 0.3467 | Train Acc: 0.8649
 Site-USPS      | Train Loss: 0.3004 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2802 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.4965 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.4172 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.6551 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.4336 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1927 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2400 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2878 | Val  Acc: 0.9149
 Site-MNIST     | Val  Loss: 0.2520 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2173 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3332 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2617 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2173 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.2765 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3649 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.4086 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.3720 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4328 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9003
Aggregated Acc | Val Acc: 0.8187
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9149
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:44 | Val Acc: 0.2727
 Best site-USPS       | Epoch:44 | Val Acc: 0.9167
 Best site-USPS       | Epoch:44 | Val Acc: 0.9388
 Best site-USPS       | Epoch:44 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9359
 Best site-MNIST-M    | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.9655
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8814
 Test site-SVHN      | Epoch:44 | Test Acc: 0.3945
 Test site-USPS      | Epoch:44 | Test Acc: 0.8978
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.7395
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.5964
Average Test Accuracy: 0.7068
============ Train epoch 45 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-1
client-10 is in G-1
client-11 is in G-3
client-12 is in G-3
cnt=[5, 2, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.5925, powerC: 0.4075
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3169 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2192 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2913 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2277 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1744 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0608 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.4349 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2965 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.2794 | Train Acc: 0.9279
 Site-SynthDigits| Train Loss: 0.4858 | Train Acc: 0.8644
 Site-SynthDigits| Train Loss: 0.3869 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.6373 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4385 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1852 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2258 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2739 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2466 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.2139 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3740 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2548 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2125 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.2762 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3443 | Val  Acc: 0.9487
 Site-SynthDigits| Val  Loss: 0.3975 | Val  Acc: 0.9231
 Site-MNIST-M   | Val  Loss: 0.3635 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4189 | Val  Acc: 0.9655
Average Valid Accuracy: 0.8977
Aggregated Acc | Val Acc: 0.8141
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8821
 Test site-SVHN      | Epoch:44 | Test Acc: 0.3849
 Test site-USPS      | Epoch:44 | Test Acc: 0.9086
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.7446
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.5986
Average Test Accuracy: 0.7068
============ Train epoch 46 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[1, 5, 3, 2, 2, ]
power_decay: 0.95, powerI: 0.5904, powerC: 0.4096
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3045 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2150 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3345 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2291 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.1727 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.8756 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3020 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2827 | Train Acc: 0.9324
 Site-USPS      | Train Loss: 0.2644 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.4668 | Train Acc: 0.8644
 Site-SynthDigits| Train Loss: 0.4141 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.6484 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4248 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1810 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2238 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2710 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2410 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2120 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3466 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.2429 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.2024 | Val  Acc: 0.9184
 Site-USPS      | Val  Loss: 0.2742 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3419 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3961 | Val  Acc: 0.9487
 Site-MNIST-M   | Val  Loss: 0.3603 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4121 | Val  Acc: 0.9655
Average Valid Accuracy: 0.8934
Aggregated Acc | Val Acc: 0.8004
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8836
 Test site-SVHN      | Epoch:44 | Test Acc: 0.3940
 Test site-USPS      | Epoch:44 | Test Acc: 0.9032
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.7420
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.5979
Average Test Accuracy: 0.7068
============ Train epoch 47 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[5, 1, 3, 2, 2, ]
power_decay: 0.95, powerI: 0.5884, powerC: 0.4116
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3710 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2015 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2906 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2128 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1660 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0896 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.4564 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2735 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2685 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4627 | Train Acc: 0.8644
 Site-SynthDigits| Train Loss: 0.4053 | Train Acc: 0.9322
 Site-MNIST-M   | Train Loss: 0.6274 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.4089 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1654 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2108 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2567 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2285 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2076 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.2273 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.2383 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1966 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2610 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3232 | Val  Acc: 0.9487
 Site-SynthDigits| Val  Loss: 0.3734 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.3699 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4158 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8932
Aggregated Acc | Val Acc: 0.7980
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8864
 Test site-SVHN      | Epoch:44 | Test Acc: 0.4060
 Test site-USPS      | Epoch:44 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.7459
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.5950
Average Test Accuracy: 0.7095
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 48 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-3
client-10 is in G-3
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 3, 2, 1, ]
power_decay: 0.95, powerI: 0.5864, powerC: 0.4136
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3469 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2714 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2114 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1647 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.8760 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3496 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2926 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2641 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4483 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.3842 | Train Acc: 0.9322
 Site-MNIST-M   | Train Loss: 0.5995 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3876 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1589 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2048 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2526 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2255 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2057 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2165 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2359 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1955 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2575 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3153 | Val  Acc: 0.9487
 Site-SynthDigits| Val  Loss: 0.3683 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.3639 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4099 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9019
Aggregated Acc | Val Acc: 0.8123
 Best site-MNIST      | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:48 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:48 | Val Acc: 0.2273
 Best site-USPS       | Epoch:48 | Val Acc: 0.9167
 Best site-USPS       | Epoch:48 | Val Acc: 0.9592
 Best site-USPS       | Epoch:48 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9487
 Best site-SynthDigits | Epoch:48 | Val Acc: 0.9359
 Best site-MNIST-M    | Epoch:48 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:48 | Val Acc: 0.9828
 Test site-MNIST     | Epoch:48 | Test Acc: 0.8879
 Test site-SVHN      | Epoch:48 | Test Acc: 0.4065
 Test site-USPS      | Epoch:48 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:48 | Test Acc: 0.7494
 Test site-MNIST-M   | Epoch:48 | Test Acc: 0.5914
Average Test Accuracy: 0.7098
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.95, powerI: 0.5846, powerC: 0.4154
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3299 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1991 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2037 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1820 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.9442 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3258 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2545 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2615 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4411 | Train Acc: 0.8644
 Site-SynthDigits| Train Loss: 0.3541 | Train Acc: 0.9492
 Site-MNIST-M   | Train Loss: 0.5924 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.3703 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1510 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1989 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2512 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.2201 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2016 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.2805 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2354 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1931 | Val  Acc: 0.9388
 Site-USPS      | Val  Loss: 0.2520 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3057 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3590 | Val  Acc: 0.9487
 Site-MNIST-M   | Val  Loss: 0.3582 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4035 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9094
Aggregated Acc | Val Acc: 0.8252
 Best site-MNIST      | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9677
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9574
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:49 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:49 | Val Acc: 0.2727
 Best site-USPS       | Epoch:49 | Val Acc: 0.9167
 Best site-USPS       | Epoch:49 | Val Acc: 0.9388
 Best site-USPS       | Epoch:49 | Val Acc: 0.9324
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:49 | Val Acc: 0.9487
 Best site-MNIST-M    | Epoch:49 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:49 | Val Acc: 0.9828
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8907
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3965
 Test site-USPS      | Epoch:49 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.7477
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.5957
Average Test Accuracy: 0.7098
============ Train epoch 50 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.5829, powerC: 0.4171
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2482 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1996 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2646 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2083 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1561 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.7278 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 0.4146 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2894 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2587 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4431 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.3558 | Train Acc: 0.9407
 Site-MNIST-M   | Train Loss: 0.5788 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3881 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1975 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2501 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2166 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1965 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.4054 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.2359 | Val  Acc: 0.8750
 Site-USPS      | Val  Loss: 0.1892 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2484 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.3039 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3523 | Val  Acc: 0.9744
 Site-MNIST-M   | Val  Loss: 0.3637 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4026 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9023
Aggregated Acc | Val Acc: 0.8080
 Test site-MNIST     | Epoch:49 | Test Acc: 0.8914
 Test site-SVHN      | Epoch:49 | Test Acc: 0.3758
 Test site-USPS      | Epoch:49 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:49 | Test Acc: 0.7501
 Test site-MNIST-M   | Epoch:49 | Test Acc: 0.5914
Average Test Accuracy: 0.7098
============ Train epoch 51 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.95, powerI: 0.5812, powerC: 0.4188
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3157 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1974 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2536 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2048 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1639 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.7522 | Train Acc: 0.6970
 Site-USPS      | Train Loss: 0.2785 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2433 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2459 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4357 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.3601 | Train Acc: 0.9576
 Site-MNIST-M   | Train Loss: 0.5944 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.3785 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1419 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1907 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2435 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2121 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1935 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3802 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2294 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1819 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.2384 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.3008 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3465 | Val  Acc: 0.9615
 Site-MNIST-M   | Val  Loss: 0.3493 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3893 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9193
Aggregated Acc | Val Acc: 0.8326
 Best site-MNIST      | Epoch:51 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:51 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:51 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:51 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:51 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:51 | Val Acc: 0.2727
 Best site-USPS       | Epoch:51 | Val Acc: 0.9167
 Best site-USPS       | Epoch:51 | Val Acc: 0.9796
 Best site-USPS       | Epoch:51 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:51 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:51 | Val Acc: 0.9615
 Best site-MNIST-M    | Epoch:51 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:51 | Val Acc: 0.9828
 Test site-MNIST     | Epoch:51 | Test Acc: 0.8914
 Test site-SVHN      | Epoch:51 | Test Acc: 0.3834
 Test site-USPS      | Epoch:51 | Test Acc: 0.9194
 Test site-SynthDigits| Epoch:51 | Test Acc: 0.7513
 Test site-MNIST-M   | Epoch:51 | Test Acc: 0.5950
Average Test Accuracy: 0.7098
============ Train epoch 52 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
client-12 is in G-2
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.5797, powerC: 0.4203
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2864 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1989 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2442 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1934 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1591 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.7251 | Train Acc: 0.7576
 Site-USPS      | Train Loss: 0.2903 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2430 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2473 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4273 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.3367 | Train Acc: 0.9492
 Site-MNIST-M   | Train Loss: 0.5634 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3687 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1355 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1832 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2354 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2075 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1892 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3709 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2318 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1811 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2348 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.2915 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3373 | Val  Acc: 0.9615
 Site-MNIST-M   | Val  Loss: 0.3236 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3694 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9200
Aggregated Acc | Val Acc: 0.8328
 Best site-MNIST      | Epoch:52 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:52 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:52 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:52 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:52 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:52 | Val Acc: 0.2727
 Best site-USPS       | Epoch:52 | Val Acc: 0.9167
 Best site-USPS       | Epoch:52 | Val Acc: 0.9592
 Best site-USPS       | Epoch:52 | Val Acc: 0.9595
 Best site-SynthDigits | Epoch:52 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:52 | Val Acc: 0.9615
 Best site-MNIST-M    | Epoch:52 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:52 | Val Acc: 0.9828
 Test site-MNIST     | Epoch:52 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:52 | Test Acc: 0.3869
 Test site-USPS      | Epoch:52 | Test Acc: 0.9194
 Test site-SynthDigits| Epoch:52 | Test Acc: 0.7569
 Test site-MNIST-M   | Epoch:52 | Test Acc: 0.6029
Average Test Accuracy: 0.7118
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 53 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-2
client-12 is in G-2
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.5782, powerC: 0.4218
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2570 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1941 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2630 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1920 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1466 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.7924 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 0.3007 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2375 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2369 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4089 | Train Acc: 0.9153
 Site-SynthDigits| Train Loss: 0.3493 | Train Acc: 0.9492
 Site-MNIST-M   | Train Loss: 0.5385 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3479 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1328 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1789 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2334 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2034 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2929 | Val  Acc: 0.3182
 Site-USPS      | Val  Loss: 0.2322 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1812 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2294 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.2836 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3246 | Val  Acc: 0.9615
 Site-MNIST-M   | Val  Loss: 0.3066 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3583 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9211
Aggregated Acc | Val Acc: 0.8392
 Best site-MNIST      | Epoch:53 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:53 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:53 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:53 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:53 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:53 | Val Acc: 0.3182
 Best site-USPS       | Epoch:53 | Val Acc: 0.9167
 Best site-USPS       | Epoch:53 | Val Acc: 0.9592
 Best site-USPS       | Epoch:53 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:53 | Val Acc: 0.9744
 Best site-SynthDigits | Epoch:53 | Val Acc: 0.9615
 Best site-MNIST-M    | Epoch:53 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:53 | Val Acc: 0.9655
 Test site-MNIST     | Epoch:53 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:53 | Test Acc: 0.3970
 Test site-USPS      | Epoch:53 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:53 | Test Acc: 0.7560
 Test site-MNIST-M   | Epoch:53 | Test Acc: 0.6136
Average Test Accuracy: 0.7147
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 54 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-3
client-10 is in G-3
client-11 is in G-1
client-12 is in G-1
cnt=[3, 2, 5, 2, 1, ]
power_decay: 0.95, powerI: 0.5768, powerC: 0.4232
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2672 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1921 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2342 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1889 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1472 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.7329 | Train Acc: 0.7576
 Site-USPS      | Train Loss: 0.4313 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2313 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2423 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.4019 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.3159 | Train Acc: 0.9492
 Site-MNIST-M   | Train Loss: 0.5349 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3339 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1334 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1755 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2250 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1963 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1843 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2851 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2247 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1775 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2272 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.2766 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3168 | Val  Acc: 0.9744
 Site-MNIST-M   | Val  Loss: 0.2960 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3495 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9186
Aggregated Acc | Val Acc: 0.8314
 Test site-MNIST     | Epoch:53 | Test Acc: 0.8914
 Test site-SVHN      | Epoch:53 | Test Acc: 0.4101
 Test site-USPS      | Epoch:53 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:53 | Test Acc: 0.7590
 Test site-MNIST-M   | Epoch:53 | Test Acc: 0.6086
Average Test Accuracy: 0.7166
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 55 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-2
client-12 is in G-2
cnt=[5, 3, 2, 1, 2, ]
power_decay: 0.95, powerI: 0.5755, powerC: 0.4245
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2807 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1955 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2571 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1831 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1418 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.6772 | Train Acc: 0.7879
 Site-USPS      | Train Loss: 0.2949 | Train Acc: 0.8919
 Site-USPS      | Train Loss: 0.2287 | Train Acc: 0.9459
 Site-USPS      | Train Loss: 0.2286 | Train Acc: 0.9550
 Site-SynthDigits| Train Loss: 0.4138 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.3145 | Train Acc: 0.9661
 Site-MNIST-M   | Train Loss: 0.5289 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3420 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1391 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1809 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2275 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1956 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.1845 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3305 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2123 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1670 | Val  Acc: 0.9796
 Site-USPS      | Val  Loss: 0.2220 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.2709 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3092 | Val  Acc: 0.9744
 Site-MNIST-M   | Val  Loss: 0.2914 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3411 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9143
Aggregated Acc | Val Acc: 0.8301
 Test site-MNIST     | Epoch:54 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:54 | Test Acc: 0.4081
 Test site-USPS      | Epoch:54 | Test Acc: 0.9247
 Test site-SynthDigits| Epoch:54 | Test Acc: 0.7604
 Test site-MNIST-M   | Epoch:54 | Test Acc: 0.6086
Average Test Accuracy: 0.7189
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 56 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-0
client-10 is in G-0
client-11 is in G-2
client-12 is in G-2
cnt=[2, 5, 2, 1, 3, ]
power_decay: 0.95, powerI: 0.5742, powerC: 0.4258
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2838 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1939 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.1810 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1390 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.7693 | Train Acc: 0.7273
 Site-USPS      | Train Loss: 0.4007 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2427 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2258 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3870 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.3363 | Train Acc: 0.9576
 Site-MNIST-M   | Train Loss: 0.5130 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3258 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1322 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1762 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2248 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1927 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1816 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3926 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2036 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1597 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2192 | Val  Acc: 0.9595
 Site-SynthDigits| Val  Loss: 0.2660 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.3042 | Val  Acc: 0.9615
 Site-MNIST-M   | Val  Loss: 0.2849 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3328 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9113
Aggregated Acc | Val Acc: 0.8272
 Test site-MNIST     | Epoch:55 | Test Acc: 0.8957
 Test site-SVHN      | Epoch:55 | Test Acc: 0.3945
 Test site-USPS      | Epoch:55 | Test Acc: 0.9247
 Test site-SynthDigits| Epoch:55 | Test Acc: 0.7580
 Test site-MNIST-M   | Epoch:55 | Test Acc: 0.6093
Average Test Accuracy: 0.7189
============ Train epoch 57 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-4
client-10 is in G-4
client-11 is in G-3
client-12 is in G-3
cnt=[5, 3, 1, 2, 2, ]
power_decay: 0.95, powerI: 0.5730, powerC: 0.4270
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2488 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1856 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2258 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1783 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1387 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.7460 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.2610 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2314 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2207 | Train Acc: 0.9640
 Site-SynthDigits| Train Loss: 0.3990 | Train Acc: 0.9153
 Site-SynthDigits| Train Loss: 0.3073 | Train Acc: 0.9576
 Site-MNIST-M   | Train Loss: 0.5076 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.3245 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1310 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1774 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2273 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1935 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1775 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4385 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2023 | Val  Acc: 0.9583
 Site-USPS      | Val  Loss: 0.1560 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2223 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.2533 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.2942 | Val  Acc: 0.9744
 Site-MNIST-M   | Val  Loss: 0.2835 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3276 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9144
Aggregated Acc | Val Acc: 0.8304
 Test site-MNIST     | Epoch:55 | Test Acc: 0.8950
 Test site-SVHN      | Epoch:55 | Test Acc: 0.3723
 Test site-USPS      | Epoch:55 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:55 | Test Acc: 0.7608
 Test site-MNIST-M   | Epoch:55 | Test Acc: 0.6021
Average Test Accuracy: 0.7189
============ Train epoch 58 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[5, 1, 2, 3, 2, ]
power_decay: 0.95, powerI: 0.5718, powerC: 0.4282
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3052 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.1860 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2688 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1795 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1401 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.6423 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.2440 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2394 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2098 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3996 | Train Acc: 0.9153
 Site-SynthDigits| Train Loss: 0.3077 | Train Acc: 0.9661
 Site-MNIST-M   | Train Loss: 0.5057 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.3208 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1247 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1727 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2235 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.1883 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1715 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.4376 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.1980 | Val  Acc: 0.9583
 Site-USPS      | Val  Loss: 0.1528 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2162 | Val  Acc: 0.9324
 Site-SynthDigits| Val  Loss: 0.2544 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.2927 | Val  Acc: 0.9615
 Site-MNIST-M   | Val  Loss: 0.2778 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3223 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9099
Aggregated Acc | Val Acc: 0.8196
 Test site-MNIST     | Epoch:55 | Test Acc: 0.8986
 Test site-SVHN      | Epoch:55 | Test Acc: 0.3738
 Test site-USPS      | Epoch:55 | Test Acc: 0.9140
 Test site-SynthDigits| Epoch:55 | Test Acc: 0.7585
 Test site-MNIST-M   | Epoch:55 | Test Acc: 0.6079
Average Test Accuracy: 0.7189
============ Train epoch 59 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-2
client-10 is in G-2
client-11 is in G-3
client-12 is in G-3
cnt=[3, 5, 2, 2, 1, ]
power_decay: 0.95, powerI: 0.5707, powerC: 0.4293
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2483 | Train Acc: 0.9565
 Site-MNIST     | Train Loss: 0.1719 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2478 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1666 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1331 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.6112 | Train Acc: 0.6970
 Site-USPS      | Train Loss: 0.3107 | Train Acc: 0.9189
 Site-USPS      | Train Loss: 0.2253 | Train Acc: 0.9595
 Site-USPS      | Train Loss: 0.2095 | Train Acc: 0.9459
 Site-SynthDigits| Train Loss: 0.3659 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.2780 | Train Acc: 0.9661
 Site-MNIST-M   | Train Loss: 0.4910 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.2942 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1204 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1672 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2139 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1815 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.1689 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3585 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.1963 | Val  Acc: 0.9167
 Site-USPS      | Val  Loss: 0.1508 | Val  Acc: 0.9592
 Site-USPS      | Val  Loss: 0.2070 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.2529 | Val  Acc: 0.9744
 Site-SynthDigits| Val  Loss: 0.2861 | Val  Acc: 0.9744
 Site-MNIST-M   | Val  Loss: 0.2734 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3144 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9139
Aggregated Acc | Val Acc: 0.8289
 Test site-MNIST     | Epoch:55 | Test Acc: 0.8993
 Test site-SVHN      | Epoch:55 | Test Acc: 0.3940
 Test site-USPS      | Epoch:55 | Test Acc: 0.9247
 Test site-SynthDigits| Epoch:55 | Test Acc: 0.7610
 Test site-MNIST-M   | Epoch:55 | Test Acc: 0.6079
Average Test Accuracy: 0.7189
===2023-04-30 23:02:35===
===2023-04-30 23:02:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,37,74,111,59,118,44,88,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:55 | Test Acc: 0.8957
 Test site-SVHN      | Epoch:55 | Test Acc: 0.3859
 Test site-USPS      | Epoch:55 | Test Acc: 0.9194
 Test site-SynthDigits| Epoch:55 | Test Acc: 0.7664
 Test site-MNIST-M   | Epoch:55 | Test Acc: 0.6036
Average Test Accuracy: 0.7142
===2023-04-30 23:10:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 60
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,37,74,111,59,118,44,88,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-4
client-12 is in G-4
cnt=[1, 5, 2, 3, 2, ]
power_decay: 0.95, powerI: 0.9750, powerC: 0.0250
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 2.1623 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 2.0584 | Train Acc: 0.2766
 Site-MNIST     | Train Loss: 1.9540 | Train Acc: 0.4366
 Site-MNIST     | Train Loss: 2.0281 | Train Acc: 0.3404
 Site-MNIST     | Train Loss: 1.9638 | Train Acc: 0.3644
 Site-SVHN      | Train Loss: 2.3046 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 2.0156 | Train Acc: 0.4324
 Site-USPS      | Train Loss: 2.0026 | Train Acc: 0.3649
 Site-USPS      | Train Loss: 2.0269 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 2.2280 | Train Acc: 0.2373
 Site-SynthDigits| Train Loss: 2.2151 | Train Acc: 0.2203
 Site-MNIST-M   | Train Loss: 2.3131 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.2751 | Train Acc: 0.0909
 Site-MNIST     | Val  Loss: 2.0373 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0093 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.0492 | Val  Acc: 0.3191
 Site-MNIST     | Val  Loss: 2.0604 | Val  Acc: 0.3175
 Site-MNIST     | Val  Loss: 1.9675 | Val  Acc: 0.4557
 Site-SVHN      | Val  Loss: 2.3136 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 2.0551 | Val  Acc: 0.2083
 Site-USPS      | Val  Loss: 1.9684 | Val  Acc: 0.3469
 Site-USPS      | Val  Loss: 2.0228 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 2.1763 | Val  Acc: 0.2308
 Site-SynthDigits| Val  Loss: 2.1820 | Val  Acc: 0.2179
 Site-MNIST-M   | Val  Loss: 2.2137 | Val  Acc: 0.1724
 Site-MNIST-M   | Val  Loss: 2.2598 | Val  Acc: 0.1207
Average Valid Accuracy: 0.2601
Aggregated Acc | Val Acc: 0.2192
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3191
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3175
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4557
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0909
 Best site-USPS       | Epoch:0 | Val Acc: 0.2083
 Best site-USPS       | Epoch:0 | Val Acc: 0.3469
 Best site-USPS       | Epoch:0 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2308
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2179
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1724
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 1 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.9512, powerC: 0.0488
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.9958 | Train Acc: 0.3478
 Site-MNIST     | Train Loss: 1.8336 | Train Acc: 0.5319
 Site-MNIST     | Train Loss: 1.7678 | Train Acc: 0.5775
 Site-MNIST     | Train Loss: 1.8360 | Train Acc: 0.5213
 Site-MNIST     | Train Loss: 1.6978 | Train Acc: 0.6186
 Site-SVHN      | Train Loss: 2.2866 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.8449 | Train Acc: 0.5405
 Site-USPS      | Train Loss: 1.7903 | Train Acc: 0.5811
 Site-USPS      | Train Loss: 1.8415 | Train Acc: 0.5766
 Site-SynthDigits| Train Loss: 2.1344 | Train Acc: 0.2712
 Site-SynthDigits| Train Loss: 2.1087 | Train Acc: 0.2797
 Site-MNIST-M   | Train Loss: 2.2773 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1849 | Train Acc: 0.2045
 Site-MNIST     | Val  Loss: 1.7767 | Val  Acc: 0.6000
 Site-MNIST     | Val  Loss: 1.7756 | Val  Acc: 0.6452
 Site-MNIST     | Val  Loss: 1.8577 | Val  Acc: 0.5745
 Site-MNIST     | Val  Loss: 1.8768 | Val  Acc: 0.4603
 Site-MNIST     | Val  Loss: 1.7613 | Val  Acc: 0.5949
 Site-SVHN      | Val  Loss: 2.2617 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.8566 | Val  Acc: 0.4583
 Site-USPS      | Val  Loss: 1.7810 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.8188 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 2.0948 | Val  Acc: 0.2821
 Site-SynthDigits| Val  Loss: 2.0932 | Val  Acc: 0.2821
 Site-MNIST-M   | Val  Loss: 2.1625 | Val  Acc: 0.2759
 Site-MNIST-M   | Val  Loss: 2.2036 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4345
Aggregated Acc | Val Acc: 0.3518
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6000
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6452
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5745
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4603
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1364
 Best site-USPS       | Epoch:1 | Val Acc: 0.4583
 Best site-USPS       | Epoch:1 | Val Acc: 0.5714
 Best site-USPS       | Epoch:1 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2821
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2759
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-0
client-12 is in G-0
cnt=[2, 5, 2, 3, 1, ]
power_decay: 0.95, powerI: 0.9287, powerC: 0.0713
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.7985 | Train Acc: 0.5217
 Site-MNIST     | Train Loss: 1.6247 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.6268 | Train Acc: 0.6620
 Site-MNIST     | Train Loss: 1.6353 | Train Acc: 0.6277
 Site-MNIST     | Train Loss: 1.4917 | Train Acc: 0.7119
 Site-SVHN      | Train Loss: 2.3628 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.6729 | Train Acc: 0.5946
 Site-USPS      | Train Loss: 1.5841 | Train Acc: 0.6486
 Site-USPS      | Train Loss: 1.6493 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 2.0678 | Train Acc: 0.3220
 Site-SynthDigits| Train Loss: 2.0010 | Train Acc: 0.3220
 Site-MNIST-M   | Train Loss: 2.2366 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1095 | Train Acc: 0.2614
 Site-MNIST     | Val  Loss: 1.5343 | Val  Acc: 0.6667
 Site-MNIST     | Val  Loss: 1.5574 | Val  Acc: 0.7097
 Site-MNIST     | Val  Loss: 1.6672 | Val  Acc: 0.7021
 Site-MNIST     | Val  Loss: 1.6814 | Val  Acc: 0.5556
 Site-MNIST     | Val  Loss: 1.5540 | Val  Acc: 0.6582
 Site-SVHN      | Val  Loss: 2.2293 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.6640 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.5994 | Val  Acc: 0.5714
 Site-USPS      | Val  Loss: 1.6193 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 1.9968 | Val  Acc: 0.3846
 Site-SynthDigits| Val  Loss: 1.9848 | Val  Acc: 0.3333
 Site-MNIST-M   | Val  Loss: 2.0892 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.1244 | Val  Acc: 0.2586
Average Valid Accuracy: 0.4977
Aggregated Acc | Val Acc: 0.4058
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7097
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7021
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5556
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6582
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1364
 Best site-USPS       | Epoch:2 | Val Acc: 0.5000
 Best site-USPS       | Epoch:2 | Val Acc: 0.5714
 Best site-USPS       | Epoch:2 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3846
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-1
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-2
client-10 is in G-2
client-11 is in G-1
client-12 is in G-1
cnt=[1, 3, 2, 3, 4, ]
power_decay: 0.95, powerI: 0.9073, powerC: 0.0927
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.5734 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.4090 | Train Acc: 0.7021
 Site-MNIST     | Train Loss: 1.4157 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.4414 | Train Acc: 0.6915
 Site-MNIST     | Train Loss: 1.2998 | Train Acc: 0.8136
 Site-SVHN      | Train Loss: 2.2608 | Train Acc: 0.0909
 Site-USPS      | Train Loss: 1.4637 | Train Acc: 0.7027
 Site-USPS      | Train Loss: 1.3934 | Train Acc: 0.6892
 Site-USPS      | Train Loss: 1.4532 | Train Acc: 0.6847
 Site-SynthDigits| Train Loss: 1.9746 | Train Acc: 0.2881
 Site-SynthDigits| Train Loss: 1.8727 | Train Acc: 0.3475
 Site-MNIST-M   | Train Loss: 2.1560 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.0340 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.3105 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.3461 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.4614 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4824 | Val  Acc: 0.6190
 Site-MNIST     | Val  Loss: 1.3533 | Val  Acc: 0.7215
 Site-SVHN      | Val  Loss: 2.2420 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 1.4513 | Val  Acc: 0.6250
 Site-USPS      | Val  Loss: 1.4158 | Val  Acc: 0.6327
 Site-USPS      | Val  Loss: 1.4149 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 1.8836 | Val  Acc: 0.4103
 Site-SynthDigits| Val  Loss: 1.8607 | Val  Acc: 0.4103
 Site-MNIST-M   | Val  Loss: 1.9894 | Val  Acc: 0.3448
 Site-MNIST-M   | Val  Loss: 2.0241 | Val  Acc: 0.2759
Average Valid Accuracy: 0.5637
Aggregated Acc | Val Acc: 0.5735
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6190
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7215
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1818
 Best site-USPS       | Epoch:3 | Val Acc: 0.6250
 Best site-USPS       | Epoch:3 | Val Acc: 0.6327
 Best site-USPS       | Epoch:3 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4103
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4103
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3448
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2759
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=1...
============ Train epoch 4 ============
