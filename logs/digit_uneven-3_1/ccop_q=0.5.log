===2023-05-02 10:31:36===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,31,62,93,124,59,118,44,88,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
client-13 is in G-4
cnt=[1, 5, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 2.1220 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.0783 | Train Acc: 0.2979
 Site-MNIST     | Train Loss: 2.0077 | Train Acc: 0.4507
 Site-MNIST     | Train Loss: 2.0316 | Train Acc: 0.3936
 Site-MNIST     | Train Loss: 1.9745 | Train Acc: 0.4153
 Site-SVHN      | Train Loss: 2.3602 | Train Acc: 0.0606
 Site-USPS      | Train Loss: 1.9604 | Train Acc: 0.4194
 Site-USPS      | Train Loss: 2.0091 | Train Acc: 0.4032
 Site-USPS      | Train Loss: 2.0300 | Train Acc: 0.3763
 Site-USPS      | Train Loss: 1.9241 | Train Acc: 0.5081
 Site-SynthDigits| Train Loss: 2.2156 | Train Acc: 0.1864
 Site-SynthDigits| Train Loss: 2.2281 | Train Acc: 0.1610
 Site-MNIST-M   | Train Loss: 2.3192 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.2727 | Train Acc: 0.1364
 Site-MNIST     | Val  Loss: 2.0234 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0171 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.0466 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.0671 | Val  Acc: 0.3016
 Site-MNIST     | Val  Loss: 1.9827 | Val  Acc: 0.4684
 Site-SVHN      | Val  Loss: 2.2869 | Val  Acc: 0.0455
 Site-USPS      | Val  Loss: 1.9537 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.9490 | Val  Acc: 0.4634
 Site-USPS      | Val  Loss: 1.9930 | Val  Acc: 0.3871
 Site-USPS      | Val  Loss: 2.0202 | Val  Acc: 0.3735
 Site-SynthDigits| Val  Loss: 2.2265 | Val  Acc: 0.1026
 Site-SynthDigits| Val  Loss: 2.2204 | Val  Acc: 0.1667
 Site-MNIST-M   | Val  Loss: 2.2325 | Val  Acc: 0.1724
 Site-MNIST-M   | Val  Loss: 2.2661 | Val  Acc: 0.1552
Average Valid Accuracy: 0.2887
Aggregated Acc | Val Acc: 0.2220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3016
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4684
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0455
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-USPS       | Epoch:0 | Val Acc: 0.4634
 Best site-USPS       | Epoch:0 | Val Acc: 0.3871
 Best site-USPS       | Epoch:0 | Val Acc: 0.3735
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1026
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1667
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1724
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 1 ============
===2023-05-02 11:48:07===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,31,62,93,124,59,118,44,88,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
client-13 is in G-4
cnt=[1, 5, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 2.1220 | Train Acc: 0.1739
 Site-MNIST     | Train Loss: 2.0783 | Train Acc: 0.2979
 Site-MNIST     | Train Loss: 2.0077 | Train Acc: 0.4507
 Site-MNIST     | Train Loss: 2.0316 | Train Acc: 0.3936
 Site-MNIST     | Train Loss: 1.9745 | Train Acc: 0.4153
 Site-SVHN      | Train Loss: 2.3602 | Train Acc: 0.0606
 Site-USPS      | Train Loss: 1.9604 | Train Acc: 0.4194
 Site-USPS      | Train Loss: 2.0091 | Train Acc: 0.4032
 Site-USPS      | Train Loss: 2.0300 | Train Acc: 0.3763
 Site-USPS      | Train Loss: 1.9241 | Train Acc: 0.5081
 Site-SynthDigits| Train Loss: 2.2156 | Train Acc: 0.1864
 Site-SynthDigits| Train Loss: 2.2281 | Train Acc: 0.1610
 Site-MNIST-M   | Train Loss: 2.3192 | Train Acc: 0.1591
 Site-MNIST-M   | Train Loss: 2.2727 | Train Acc: 0.1364
 Site-MNIST     | Val  Loss: 2.0234 | Val  Acc: 0.2000
 Site-MNIST     | Val  Loss: 2.0171 | Val  Acc: 0.3226
 Site-MNIST     | Val  Loss: 2.0466 | Val  Acc: 0.3830
 Site-MNIST     | Val  Loss: 2.0671 | Val  Acc: 0.3016
 Site-MNIST     | Val  Loss: 1.9827 | Val  Acc: 0.4684
 Site-SVHN      | Val  Loss: 2.2869 | Val  Acc: 0.0455
 Site-USPS      | Val  Loss: 1.9537 | Val  Acc: 0.5000
 Site-USPS      | Val  Loss: 1.9490 | Val  Acc: 0.4634
 Site-USPS      | Val  Loss: 1.9930 | Val  Acc: 0.3871
 Site-USPS      | Val  Loss: 2.0202 | Val  Acc: 0.3735
 Site-SynthDigits| Val  Loss: 2.2265 | Val  Acc: 0.1026
 Site-SynthDigits| Val  Loss: 2.2204 | Val  Acc: 0.1667
 Site-MNIST-M   | Val  Loss: 2.2325 | Val  Acc: 0.1724
 Site-MNIST-M   | Val  Loss: 2.2661 | Val  Acc: 0.1552
Average Valid Accuracy: 0.2887
Aggregated Acc | Val Acc: 0.2220
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3226
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3830
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3016
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4684
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0455
 Best site-USPS       | Epoch:0 | Val Acc: 0.5000
 Best site-USPS       | Epoch:0 | Val Acc: 0.4634
 Best site-USPS       | Epoch:0 | Val Acc: 0.3871
 Best site-USPS       | Epoch:0 | Val Acc: 0.3735
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1026
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1667
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1724
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1552
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 1 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.9654 | Train Acc: 0.2609
 Site-MNIST     | Train Loss: 1.8536 | Train Acc: 0.4894
 Site-MNIST     | Train Loss: 1.7395 | Train Acc: 0.5634
 Site-MNIST     | Train Loss: 1.8298 | Train Acc: 0.4787
 Site-MNIST     | Train Loss: 1.7314 | Train Acc: 0.5254
 Site-SVHN      | Train Loss: 2.1812 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.7536 | Train Acc: 0.5806
 Site-USPS      | Train Loss: 1.7913 | Train Acc: 0.4677
 Site-USPS      | Train Loss: 1.8130 | Train Acc: 0.4946
 Site-USPS      | Train Loss: 1.6787 | Train Acc: 0.6048
 Site-SynthDigits| Train Loss: 2.1267 | Train Acc: 0.2542
 Site-SynthDigits| Train Loss: 2.1286 | Train Acc: 0.2712
 Site-MNIST-M   | Train Loss: 2.2960 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.1908 | Train Acc: 0.1818
 Site-MNIST     | Val  Loss: 1.7592 | Val  Acc: 0.5333
 Site-MNIST     | Val  Loss: 1.7890 | Val  Acc: 0.5161
 Site-MNIST     | Val  Loss: 1.8622 | Val  Acc: 0.4468
 Site-MNIST     | Val  Loss: 1.8653 | Val  Acc: 0.4444
 Site-MNIST     | Val  Loss: 1.7645 | Val  Acc: 0.5696
 Site-SVHN      | Val  Loss: 2.2558 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 1.6663 | Val  Acc: 0.7000
 Site-USPS      | Val  Loss: 1.7078 | Val  Acc: 0.6341
 Site-USPS      | Val  Loss: 1.7856 | Val  Acc: 0.5161
 Site-USPS      | Val  Loss: 1.8012 | Val  Acc: 0.4940
 Site-SynthDigits| Val  Loss: 2.1516 | Val  Acc: 0.2308
 Site-SynthDigits| Val  Loss: 2.1184 | Val  Acc: 0.2564
 Site-MNIST-M   | Val  Loss: 2.2076 | Val  Acc: 0.2414
 Site-MNIST-M   | Val  Loss: 2.2075 | Val  Acc: 0.1724
Average Valid Accuracy: 0.4176
Aggregated Acc | Val Acc: 0.3259
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5333
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5161
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4468
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4444
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5696
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0909
 Best site-USPS       | Epoch:1 | Val Acc: 0.7000
 Best site-USPS       | Epoch:1 | Val Acc: 0.6341
 Best site-USPS       | Epoch:1 | Val Acc: 0.5161
 Best site-USPS       | Epoch:1 | Val Acc: 0.4940
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2308
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2564
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2414
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 2 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
client-13 is in G-0
cnt=[2, 5, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.8268 | Train Acc: 0.3913
 Site-MNIST     | Train Loss: 1.6305 | Train Acc: 0.5745
 Site-MNIST     | Train Loss: 1.5462 | Train Acc: 0.6338
 Site-MNIST     | Train Loss: 1.6138 | Train Acc: 0.5957
 Site-MNIST     | Train Loss: 1.4576 | Train Acc: 0.6356
 Site-SVHN      | Train Loss: 2.0921 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.5386 | Train Acc: 0.5806
 Site-USPS      | Train Loss: 1.5485 | Train Acc: 0.5968
 Site-USPS      | Train Loss: 1.5986 | Train Acc: 0.6022
 Site-USPS      | Train Loss: 1.4391 | Train Acc: 0.7097
 Site-SynthDigits| Train Loss: 2.0459 | Train Acc: 0.3559
 Site-SynthDigits| Train Loss: 2.0033 | Train Acc: 0.3390
 Site-MNIST-M   | Train Loss: 2.2602 | Train Acc: 0.2727
 Site-MNIST-M   | Train Loss: 2.1186 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.4878 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.5406 | Val  Acc: 0.6774
 Site-MNIST     | Val  Loss: 1.6595 | Val  Acc: 0.5957
 Site-MNIST     | Val  Loss: 1.6544 | Val  Acc: 0.5397
 Site-MNIST     | Val  Loss: 1.5429 | Val  Acc: 0.6456
 Site-SVHN      | Val  Loss: 2.2253 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 1.4327 | Val  Acc: 0.7000
 Site-USPS      | Val  Loss: 1.4926 | Val  Acc: 0.7317
 Site-USPS      | Val  Loss: 1.5680 | Val  Acc: 0.6774
 Site-USPS      | Val  Loss: 1.5699 | Val  Acc: 0.5904
 Site-SynthDigits| Val  Loss: 2.0167 | Val  Acc: 0.3077
 Site-SynthDigits| Val  Loss: 1.9894 | Val  Acc: 0.3590
 Site-MNIST-M   | Val  Loss: 2.0613 | Val  Acc: 0.3103
 Site-MNIST-M   | Val  Loss: 2.1019 | Val  Acc: 0.2414
Average Valid Accuracy: 0.5143
Aggregated Acc | Val Acc: 0.4027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6774
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5957
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5397
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6456
 Best site-SVHN       | Epoch:2 | Val Acc: 0.0909
 Best site-USPS       | Epoch:2 | Val Acc: 0.7000
 Best site-USPS       | Epoch:2 | Val Acc: 0.7317
 Best site-USPS       | Epoch:2 | Val Acc: 0.6774
 Best site-USPS       | Epoch:2 | Val Acc: 0.5904
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3077
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3590
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3103
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 3 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-1
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
client-13 is in G-1
cnt=[1, 3, 4, 2, 4, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.5664 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.4249 | Train Acc: 0.6596
 Site-MNIST     | Train Loss: 1.3634 | Train Acc: 0.7183
 Site-MNIST     | Train Loss: 1.4254 | Train Acc: 0.6915
 Site-MNIST     | Train Loss: 1.2704 | Train Acc: 0.7627
 Site-SVHN      | Train Loss: 2.1427 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.3145 | Train Acc: 0.7097
 Site-USPS      | Train Loss: 1.3366 | Train Acc: 0.6935
 Site-USPS      | Train Loss: 1.3740 | Train Acc: 0.6559
 Site-USPS      | Train Loss: 1.2218 | Train Acc: 0.7984
 Site-SynthDigits| Train Loss: 1.9428 | Train Acc: 0.3729
 Site-SynthDigits| Train Loss: 1.8622 | Train Acc: 0.3559
 Site-MNIST-M   | Train Loss: 2.1582 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 2.0229 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.2886 | Val  Acc: 0.7333
 Site-MNIST     | Val  Loss: 1.3471 | Val  Acc: 0.7742
 Site-MNIST     | Val  Loss: 1.4750 | Val  Acc: 0.7660
 Site-MNIST     | Val  Loss: 1.4644 | Val  Acc: 0.6349
 Site-MNIST     | Val  Loss: 1.3378 | Val  Acc: 0.6709
 Site-SVHN      | Val  Loss: 2.2061 | Val  Acc: 0.0909
 Site-USPS      | Val  Loss: 1.2232 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 1.2713 | Val  Acc: 0.7805
 Site-USPS      | Val  Loss: 1.3463 | Val  Acc: 0.6935
 Site-USPS      | Val  Loss: 1.3413 | Val  Acc: 0.6867
 Site-SynthDigits| Val  Loss: 1.9017 | Val  Acc: 0.3590
 Site-SynthDigits| Val  Loss: 1.8826 | Val  Acc: 0.4231
 Site-MNIST-M   | Val  Loss: 1.9451 | Val  Acc: 0.3793
 Site-MNIST-M   | Val  Loss: 2.0000 | Val  Acc: 0.3276
Average Valid Accuracy: 0.5764
Aggregated Acc | Val Acc: 0.5659
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7333
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7742
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7660
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6349
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6709
 Best site-SVHN       | Epoch:3 | Val Acc: 0.0909
 Best site-USPS       | Epoch:3 | Val Acc: 0.7500
 Best site-USPS       | Epoch:3 | Val Acc: 0.7805
 Best site-USPS       | Epoch:3 | Val Acc: 0.6935
 Best site-USPS       | Epoch:3 | Val Acc: 0.6867
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3590
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4231
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3793
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 4 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
client-13 is in G-4
cnt=[1, 5, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.4643 | Train Acc: 0.6087
 Site-MNIST     | Train Loss: 1.2417 | Train Acc: 0.7234
 Site-MNIST     | Train Loss: 1.2340 | Train Acc: 0.7465
 Site-MNIST     | Train Loss: 1.2598 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 1.1037 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.3019 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.1522 | Train Acc: 0.7742
 Site-USPS      | Train Loss: 1.1597 | Train Acc: 0.7903
 Site-USPS      | Train Loss: 1.2000 | Train Acc: 0.7204
 Site-USPS      | Train Loss: 1.0570 | Train Acc: 0.8790
 Site-SynthDigits| Train Loss: 1.8788 | Train Acc: 0.3729
 Site-SynthDigits| Train Loss: 1.7830 | Train Acc: 0.3983
 Site-MNIST-M   | Train Loss: 2.0965 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.9480 | Train Acc: 0.3636
 Site-MNIST     | Val  Loss: 1.1296 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.1943 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 1.3078 | Val  Acc: 0.7872
 Site-MNIST     | Val  Loss: 1.2927 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.1847 | Val  Acc: 0.7722
 Site-SVHN      | Val  Loss: 2.2382 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 1.0709 | Val  Acc: 0.8000
 Site-USPS      | Val  Loss: 1.1111 | Val  Acc: 0.8537
 Site-USPS      | Val  Loss: 1.1772 | Val  Acc: 0.8065
 Site-USPS      | Val  Loss: 1.1650 | Val  Acc: 0.7229
 Site-SynthDigits| Val  Loss: 1.7979 | Val  Acc: 0.3846
 Site-SynthDigits| Val  Loss: 1.7686 | Val  Acc: 0.4487
 Site-MNIST-M   | Val  Loss: 1.8806 | Val  Acc: 0.4138
 Site-MNIST-M   | Val  Loss: 1.9334 | Val  Acc: 0.3966
Average Valid Accuracy: 0.6373
Aggregated Acc | Val Acc: 0.5092
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7872
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7722
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1364
 Best site-USPS       | Epoch:4 | Val Acc: 0.8000
 Best site-USPS       | Epoch:4 | Val Acc: 0.8537
 Best site-USPS       | Epoch:4 | Val Acc: 0.8065
 Best site-USPS       | Epoch:4 | Val Acc: 0.7229
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.3846
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4487
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4138
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.3966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 5 ============
gmm
client-0 is in G-3
client-1 is in G-3
client-2 is in G-3
client-3 is in G-3
client-4 is in G-3
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
client-13 is in G-0
cnt=[2, 4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.3394 | Train Acc: 0.6522
 Site-MNIST     | Train Loss: 1.1011 | Train Acc: 0.7660
 Site-MNIST     | Train Loss: 1.0585 | Train Acc: 0.7606
 Site-MNIST     | Train Loss: 1.1391 | Train Acc: 0.8191
 Site-MNIST     | Train Loss: 1.0021 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.1836 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 1.0373 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 1.0461 | Train Acc: 0.8226
 Site-USPS      | Train Loss: 1.0883 | Train Acc: 0.7634
 Site-USPS      | Train Loss: 0.9538 | Train Acc: 0.8790
 Site-SynthDigits| Train Loss: 1.7855 | Train Acc: 0.4068
 Site-SynthDigits| Train Loss: 1.6894 | Train Acc: 0.4407
 Site-MNIST-M   | Train Loss: 2.0300 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.8368 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 1.0153 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 1.0560 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.1802 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 1.1711 | Val  Acc: 0.7937
 Site-MNIST     | Val  Loss: 1.0498 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 2.1819 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.9800 | Val  Acc: 0.8500
 Site-USPS      | Val  Loss: 1.0029 | Val  Acc: 0.8293
 Site-USPS      | Val  Loss: 1.0662 | Val  Acc: 0.7742
 Site-USPS      | Val  Loss: 1.0457 | Val  Acc: 0.7952
 Site-SynthDigits| Val  Loss: 1.6922 | Val  Acc: 0.4359
 Site-SynthDigits| Val  Loss: 1.6708 | Val  Acc: 0.4872
 Site-MNIST-M   | Val  Loss: 1.7929 | Val  Acc: 0.4138
 Site-MNIST-M   | Val  Loss: 1.8509 | Val  Acc: 0.4310
Average Valid Accuracy: 0.6574
Aggregated Acc | Val Acc: 0.5285
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:5 | Val Acc: 0.7937
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1364
 Best site-USPS       | Epoch:5 | Val Acc: 0.8500
 Best site-USPS       | Epoch:5 | Val Acc: 0.8293
 Best site-USPS       | Epoch:5 | Val Acc: 0.7742
 Best site-USPS       | Epoch:5 | Val Acc: 0.7952
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4359
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4872
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4138
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 6 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.2763 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 1.0069 | Train Acc: 0.7447
 Site-MNIST     | Train Loss: 0.9396 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 1.0416 | Train Acc: 0.8404
 Site-MNIST     | Train Loss: 0.8831 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 1.9510 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 0.9616 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 0.9526 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 0.9869 | Train Acc: 0.7742
 Site-USPS      | Train Loss: 0.8602 | Train Acc: 0.8790
 Site-SynthDigits| Train Loss: 1.7083 | Train Acc: 0.4068
 Site-SynthDigits| Train Loss: 1.6318 | Train Acc: 0.4746
 Site-MNIST-M   | Train Loss: 1.9467 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.7607 | Train Acc: 0.4318
 Site-MNIST     | Val  Loss: 0.9247 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.9552 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.0810 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 1.0826 | Val  Acc: 0.8095
 Site-MNIST     | Val  Loss: 0.9545 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 2.1628 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.8832 | Val  Acc: 0.7500
 Site-USPS      | Val  Loss: 0.9198 | Val  Acc: 0.8049
 Site-USPS      | Val  Loss: 0.9788 | Val  Acc: 0.7742
 Site-USPS      | Val  Loss: 0.9476 | Val  Acc: 0.7831
 Site-SynthDigits| Val  Loss: 1.5972 | Val  Acc: 0.4615
 Site-SynthDigits| Val  Loss: 1.5785 | Val  Acc: 0.5256
 Site-MNIST-M   | Val  Loss: 1.7244 | Val  Acc: 0.4483
 Site-MNIST-M   | Val  Loss: 1.7737 | Val  Acc: 0.4483
Average Valid Accuracy: 0.6586
Aggregated Acc | Val Acc: 0.5348
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8095
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1364
 Best site-USPS       | Epoch:6 | Val Acc: 0.7500
 Best site-USPS       | Epoch:6 | Val Acc: 0.8049
 Best site-USPS       | Epoch:6 | Val Acc: 0.7742
 Best site-USPS       | Epoch:6 | Val Acc: 0.7831
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4615
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5256
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4483
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.4483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 7 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.1659 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.9111 | Train Acc: 0.8085
 Site-MNIST     | Train Loss: 0.9550 | Train Acc: 0.7746
 Site-MNIST     | Train Loss: 0.9649 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.7912 | Train Acc: 0.8814
 Site-SVHN      | Train Loss: 2.4136 | Train Acc: 0.1212
 Site-USPS      | Train Loss: 0.8798 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 0.8591 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.9046 | Train Acc: 0.8280
 Site-USPS      | Train Loss: 0.7977 | Train Acc: 0.9032
 Site-SynthDigits| Train Loss: 1.6336 | Train Acc: 0.4915
 Site-SynthDigits| Train Loss: 1.5233 | Train Acc: 0.5254
 Site-MNIST-M   | Train Loss: 1.9031 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.6830 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.8593 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.8860 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 1.0030 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.9986 | Val  Acc: 0.8254
 Site-MNIST     | Val  Loss: 0.8717 | Val  Acc: 0.8101
 Site-SVHN      | Val  Loss: 2.1371 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.8156 | Val  Acc: 0.8500
 Site-USPS      | Val  Loss: 0.8431 | Val  Acc: 0.8537
 Site-USPS      | Val  Loss: 0.8963 | Val  Acc: 0.8065
 Site-USPS      | Val  Loss: 0.8531 | Val  Acc: 0.8554
 Site-SynthDigits| Val  Loss: 1.5083 | Val  Acc: 0.5128
 Site-SynthDigits| Val  Loss: 1.5044 | Val  Acc: 0.5641
 Site-MNIST-M   | Val  Loss: 1.6305 | Val  Acc: 0.4828
 Site-MNIST-M   | Val  Loss: 1.6904 | Val  Acc: 0.5345
Average Valid Accuracy: 0.6944
Aggregated Acc | Val Acc: 0.5700
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8254
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8101
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1364
 Best site-USPS       | Epoch:7 | Val Acc: 0.8500
 Best site-USPS       | Epoch:7 | Val Acc: 0.8537
 Best site-USPS       | Epoch:7 | Val Acc: 0.8065
 Best site-USPS       | Epoch:7 | Val Acc: 0.8554
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5128
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5641
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.4828
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5345
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 8 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-3
client-13 is in G-3
cnt=[5, 2, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9993 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.8395 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.8099 | Train Acc: 0.7887
 Site-MNIST     | Train Loss: 0.8933 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.7923 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.1737 | Train Acc: 0.1515
 Site-USPS      | Train Loss: 0.8133 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.8030 | Train Acc: 0.8871
 Site-USPS      | Train Loss: 0.8397 | Train Acc: 0.8495
 Site-USPS      | Train Loss: 0.7256 | Train Acc: 0.9032
 Site-SynthDigits| Train Loss: 1.5799 | Train Acc: 0.4746
 Site-SynthDigits| Train Loss: 1.4699 | Train Acc: 0.5339
 Site-MNIST-M   | Train Loss: 1.8137 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.6105 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.8032 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.8297 | Val  Acc: 0.8065
 Site-MNIST     | Val  Loss: 0.9309 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.9254 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.8015 | Val  Acc: 0.8354
 Site-SVHN      | Val  Loss: 2.1195 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7684 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.7810 | Val  Acc: 0.8780
 Site-USPS      | Val  Loss: 0.8366 | Val  Acc: 0.8387
 Site-USPS      | Val  Loss: 0.7901 | Val  Acc: 0.8795
 Site-SynthDigits| Val  Loss: 1.4599 | Val  Acc: 0.5128
 Site-SynthDigits| Val  Loss: 1.4527 | Val  Acc: 0.5769
 Site-MNIST-M   | Val  Loss: 1.5678 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 1.6256 | Val  Acc: 0.5690
Average Valid Accuracy: 0.7169
Aggregated Acc | Val Acc: 0.6002
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8065
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8413
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8354
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1818
 Best site-USPS       | Epoch:8 | Val Acc: 0.9000
 Best site-USPS       | Epoch:8 | Val Acc: 0.8780
 Best site-USPS       | Epoch:8 | Val Acc: 0.8387
 Best site-USPS       | Epoch:8 | Val Acc: 0.8795
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5128
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5769
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5690
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 9 ============
gmm
client-0 is in G-3
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-0
client-13 is in G-0
cnt=[3, 4, 2, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.1081 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.7646 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.7880 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.8125 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.6736 | Train Acc: 0.9237
 Site-SVHN      | Train Loss: 2.4102 | Train Acc: 0.2424
 Site-USPS      | Train Loss: 0.7857 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.7468 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.7829 | Train Acc: 0.8602
 Site-USPS      | Train Loss: 0.6898 | Train Acc: 0.9032
 Site-SynthDigits| Train Loss: 1.5214 | Train Acc: 0.5085
 Site-SynthDigits| Train Loss: 1.3843 | Train Acc: 0.5763
 Site-MNIST-M   | Train Loss: 1.7871 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.5849 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.7086 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.7489 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.8577 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.8508 | Val  Acc: 0.8571
 Site-MNIST     | Val  Loss: 0.7456 | Val  Acc: 0.8734
 Site-SVHN      | Val  Loss: 2.1139 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.7252 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.7393 | Val  Acc: 0.9024
 Site-USPS      | Val  Loss: 0.7843 | Val  Acc: 0.8710
 Site-USPS      | Val  Loss: 0.7390 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 1.3730 | Val  Acc: 0.5641
 Site-SynthDigits| Val  Loss: 1.3671 | Val  Acc: 0.6026
 Site-MNIST-M   | Val  Loss: 1.5102 | Val  Acc: 0.5862
 Site-MNIST-M   | Val  Loss: 1.5653 | Val  Acc: 0.6207
Average Valid Accuracy: 0.7419
Aggregated Acc | Val Acc: 0.7308
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8298
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8571
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8734
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1818
 Best site-USPS       | Epoch:9 | Val Acc: 0.9000
 Best site-USPS       | Epoch:9 | Val Acc: 0.9024
 Best site-USPS       | Epoch:9 | Val Acc: 0.8710
 Best site-USPS       | Epoch:9 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5641
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6026
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5862
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6207
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.7621
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2897
 Test site-USPS      | Epoch:9 | Test Acc: 0.8656
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4716
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4000
Average Test Accuracy: 0.5578
============ Train epoch 10 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 1.0476 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.7281 | Train Acc: 0.8298
 Site-MNIST     | Train Loss: 0.7873 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.7945 | Train Acc: 0.8404
 Site-MNIST     | Train Loss: 0.6476 | Train Acc: 0.9068
 Site-SVHN      | Train Loss: 2.1148 | Train Acc: 0.2424
 Site-USPS      | Train Loss: 0.7358 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.6989 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.7397 | Train Acc: 0.8495
 Site-USPS      | Train Loss: 0.6337 | Train Acc: 0.8952
 Site-SynthDigits| Train Loss: 1.4432 | Train Acc: 0.5085
 Site-SynthDigits| Train Loss: 1.3213 | Train Acc: 0.5763
 Site-MNIST-M   | Train Loss: 1.6949 | Train Acc: 0.3409
 Site-MNIST-M   | Train Loss: 1.4870 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.7034 | Val  Acc: 0.8000
 Site-MNIST     | Val  Loss: 0.7269 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.8304 | Val  Acc: 0.8298
 Site-MNIST     | Val  Loss: 0.8229 | Val  Acc: 0.8413
 Site-MNIST     | Val  Loss: 0.7048 | Val  Acc: 0.8608
 Site-SVHN      | Val  Loss: 2.1459 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.6727 | Val  Acc: 0.8000
 Site-USPS      | Val  Loss: 0.6906 | Val  Acc: 0.8293
 Site-USPS      | Val  Loss: 0.7391 | Val  Acc: 0.8387
 Site-USPS      | Val  Loss: 0.6880 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 1.3008 | Val  Acc: 0.5385
 Site-SynthDigits| Val  Loss: 1.3149 | Val  Acc: 0.6026
 Site-MNIST-M   | Val  Loss: 1.4326 | Val  Acc: 0.6207
 Site-MNIST-M   | Val  Loss: 1.4892 | Val  Acc: 0.6207
Average Valid Accuracy: 0.7178
Aggregated Acc | Val Acc: 0.6003
============ Train epoch 11 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[5, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9036 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.6819 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.7370 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.7441 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.6209 | Train Acc: 0.9322
 Site-SVHN      | Train Loss: 1.8406 | Train Acc: 0.1818
 Site-USPS      | Train Loss: 0.7134 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.6553 | Train Acc: 0.8871
 Site-USPS      | Train Loss: 0.6945 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.6030 | Train Acc: 0.9032
 Site-SynthDigits| Train Loss: 1.3861 | Train Acc: 0.5254
 Site-SynthDigits| Train Loss: 1.2593 | Train Acc: 0.6186
 Site-MNIST-M   | Train Loss: 1.6477 | Train Acc: 0.3182
 Site-MNIST-M   | Train Loss: 1.4279 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.6598 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6912 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7886 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.7729 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.6635 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1303 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6378 | Val  Acc: 0.8500
 Site-USPS      | Val  Loss: 0.6551 | Val  Acc: 0.8537
 Site-USPS      | Val  Loss: 0.7056 | Val  Acc: 0.8548
 Site-USPS      | Val  Loss: 0.6561 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 1.2393 | Val  Acc: 0.5897
 Site-SynthDigits| Val  Loss: 1.2485 | Val  Acc: 0.6410
 Site-MNIST-M   | Val  Loss: 1.3721 | Val  Acc: 0.6897
 Site-MNIST-M   | Val  Loss: 1.4283 | Val  Acc: 0.6724
Average Valid Accuracy: 0.7518
Aggregated Acc | Val Acc: 0.6403
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:11 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:11 | Val Acc: 0.1818
 Best site-USPS       | Epoch:11 | Val Acc: 0.8500
 Best site-USPS       | Epoch:11 | Val Acc: 0.8537
 Best site-USPS       | Epoch:11 | Val Acc: 0.8548
 Best site-USPS       | Epoch:11 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.5897
 Best site-SynthDigits | Epoch:11 | Val Acc: 0.6410
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.6897
 Best site-MNIST-M    | Epoch:11 | Val Acc: 0.6724
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 12 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
client-13 is in G-1
cnt=[5, 2, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9581 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6372 | Train Acc: 0.8511
 Site-MNIST     | Train Loss: 0.6603 | Train Acc: 0.8028
 Site-MNIST     | Train Loss: 0.7142 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.6075 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 2.0039 | Train Acc: 0.2424
 Site-USPS      | Train Loss: 0.6643 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.6322 | Train Acc: 0.8871
 Site-USPS      | Train Loss: 0.6681 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.5884 | Train Acc: 0.9194
 Site-SynthDigits| Train Loss: 1.3242 | Train Acc: 0.5763
 Site-SynthDigits| Train Loss: 1.1596 | Train Acc: 0.6441
 Site-MNIST-M   | Train Loss: 1.5742 | Train Acc: 0.4318
 Site-MNIST-M   | Train Loss: 1.3602 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.6362 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6646 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.7657 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.7414 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.6292 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.0809 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.6250 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.6263 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.6797 | Val  Acc: 0.8710
 Site-USPS      | Val  Loss: 0.6251 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 1.1894 | Val  Acc: 0.6410
 Site-SynthDigits| Val  Loss: 1.2015 | Val  Acc: 0.6410
 Site-MNIST-M   | Val  Loss: 1.3081 | Val  Acc: 0.7586
 Site-MNIST-M   | Val  Loss: 1.3720 | Val  Acc: 0.6897
Average Valid Accuracy: 0.7732
Aggregated Acc | Val Acc: 0.6623
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8387
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:12 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:12 | Val Acc: 0.1818
 Best site-USPS       | Epoch:12 | Val Acc: 0.9500
 Best site-USPS       | Epoch:12 | Val Acc: 0.9268
 Best site-USPS       | Epoch:12 | Val Acc: 0.8710
 Best site-USPS       | Epoch:12 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6410
 Best site-SynthDigits | Epoch:12 | Val Acc: 0.6410
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.7586
 Best site-MNIST-M    | Epoch:12 | Val Acc: 0.6897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 13 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-1
client-13 is in G-1
cnt=[5, 2, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.8072 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.6061 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.6797 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6805 | Train Acc: 0.8723
 Site-MNIST     | Train Loss: 0.5155 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 1.8030 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.6539 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.6092 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.6351 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.5479 | Train Acc: 0.9113
 Site-SynthDigits| Train Loss: 1.2746 | Train Acc: 0.6271
 Site-SynthDigits| Train Loss: 1.1884 | Train Acc: 0.6525
 Site-MNIST-M   | Train Loss: 1.5354 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.2826 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.5977 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.6250 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.7219 | Val  Acc: 0.8085
 Site-MNIST     | Val  Loss: 0.6965 | Val  Acc: 0.8730
 Site-MNIST     | Val  Loss: 0.5959 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1139 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5903 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5922 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.6480 | Val  Acc: 0.8710
 Site-USPS      | Val  Loss: 0.5934 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 1.1421 | Val  Acc: 0.6154
 Site-SynthDigits| Val  Loss: 1.1551 | Val  Acc: 0.6667
 Site-MNIST-M   | Val  Loss: 1.2580 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.3167 | Val  Acc: 0.7069
Average Valid Accuracy: 0.7797
Aggregated Acc | Val Acc: 0.6759
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8085
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8730
 Best site-MNIST      | Epoch:13 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:13 | Val Acc: 0.2273
 Best site-USPS       | Epoch:13 | Val Acc: 0.9000
 Best site-USPS       | Epoch:13 | Val Acc: 0.9268
 Best site-USPS       | Epoch:13 | Val Acc: 0.8710
 Best site-USPS       | Epoch:13 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6154
 Best site-SynthDigits | Epoch:13 | Val Acc: 0.6667
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:13 | Val Acc: 0.7069
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 14 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[5, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.9066 | Train Acc: 0.6957
 Site-MNIST     | Train Loss: 0.5712 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.6346 | Train Acc: 0.8169
 Site-MNIST     | Train Loss: 0.6362 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4928 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7591 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.6211 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.5853 | Train Acc: 0.9194
 Site-USPS      | Train Loss: 0.6066 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.5292 | Train Acc: 0.9032
 Site-SynthDigits| Train Loss: 1.2202 | Train Acc: 0.6610
 Site-SynthDigits| Train Loss: 1.0966 | Train Acc: 0.6780
 Site-MNIST-M   | Train Loss: 1.4628 | Train Acc: 0.5455
 Site-MNIST-M   | Train Loss: 1.2489 | Train Acc: 0.6818
 Site-MNIST     | Val  Loss: 0.5666 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5958 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6836 | Val  Acc: 0.8511
 Site-MNIST     | Val  Loss: 0.6539 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.5631 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.1590 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5555 | Val  Acc: 0.8500
 Site-USPS      | Val  Loss: 0.5614 | Val  Acc: 0.8780
 Site-USPS      | Val  Loss: 0.6190 | Val  Acc: 0.8871
 Site-USPS      | Val  Loss: 0.5658 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 1.0796 | Val  Acc: 0.6667
 Site-SynthDigits| Val  Loss: 1.0940 | Val  Acc: 0.7051
 Site-MNIST-M   | Val  Loss: 1.1926 | Val  Acc: 0.7931
 Site-MNIST-M   | Val  Loss: 1.2544 | Val  Acc: 0.6897
Average Valid Accuracy: 0.7888
Aggregated Acc | Val Acc: 0.6846
 Best site-MNIST      | Epoch:14 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8511
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:14 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:14 | Val Acc: 0.2273
 Best site-USPS       | Epoch:14 | Val Acc: 0.8500
 Best site-USPS       | Epoch:14 | Val Acc: 0.8780
 Best site-USPS       | Epoch:14 | Val Acc: 0.8871
 Best site-USPS       | Epoch:14 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.6667
 Best site-SynthDigits | Epoch:14 | Val Acc: 0.7051
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.7931
 Best site-MNIST-M    | Epoch:14 | Val Acc: 0.6897
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 15 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[5, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7735 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5437 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.6257 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.6077 | Train Acc: 0.8830
 Site-MNIST     | Train Loss: 0.4970 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.3297 | Train Acc: 0.3333
 Site-USPS      | Train Loss: 0.5987 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.5596 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.5792 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.5031 | Train Acc: 0.9113
 Site-SynthDigits| Train Loss: 1.1561 | Train Acc: 0.6780
 Site-SynthDigits| Train Loss: 1.0272 | Train Acc: 0.6695
 Site-MNIST-M   | Train Loss: 1.4220 | Train Acc: 0.5909
 Site-MNIST-M   | Train Loss: 1.1630 | Train Acc: 0.7159
 Site-MNIST     | Val  Loss: 0.5477 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.5716 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6502 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.6238 | Val  Acc: 0.8889
 Site-MNIST     | Val  Loss: 0.5376 | Val  Acc: 0.8861
 Site-SVHN      | Val  Loss: 2.1402 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.5510 | Val  Acc: 0.8500
 Site-USPS      | Val  Loss: 0.5450 | Val  Acc: 0.8780
 Site-USPS      | Val  Loss: 0.5957 | Val  Acc: 0.8871
 Site-USPS      | Val  Loss: 0.5340 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 1.0284 | Val  Acc: 0.6923
 Site-SynthDigits| Val  Loss: 1.0539 | Val  Acc: 0.6795
 Site-MNIST-M   | Val  Loss: 1.1279 | Val  Acc: 0.8621
 Site-MNIST-M   | Val  Loss: 1.1932 | Val  Acc: 0.7241
Average Valid Accuracy: 0.7936
Aggregated Acc | Val Acc: 0.6862
 Best site-MNIST      | Epoch:15 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8889
 Best site-MNIST      | Epoch:15 | Val Acc: 0.8861
 Best site-SVHN       | Epoch:15 | Val Acc: 0.1818
 Best site-USPS       | Epoch:15 | Val Acc: 0.8500
 Best site-USPS       | Epoch:15 | Val Acc: 0.8780
 Best site-USPS       | Epoch:15 | Val Acc: 0.8871
 Best site-USPS       | Epoch:15 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6923
 Best site-SynthDigits | Epoch:15 | Val Acc: 0.6795
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.8621
 Best site-MNIST-M    | Epoch:15 | Val Acc: 0.7241
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 16 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7299 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.5079 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5491 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5605 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4668 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 1.7290 | Train Acc: 0.3030
 Site-USPS      | Train Loss: 0.5884 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.5282 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.5650 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.4793 | Train Acc: 0.9274
 Site-SynthDigits| Train Loss: 1.1484 | Train Acc: 0.6780
 Site-SynthDigits| Train Loss: 1.0604 | Train Acc: 0.6780
 Site-MNIST-M   | Train Loss: 1.4109 | Train Acc: 0.5682
 Site-MNIST-M   | Train Loss: 1.0989 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.5128 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5337 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.6045 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.5777 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.5056 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.1393 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5300 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.5225 | Val  Acc: 0.9024
 Site-USPS      | Val  Loss: 0.5751 | Val  Acc: 0.8710
 Site-USPS      | Val  Loss: 0.5086 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.9915 | Val  Acc: 0.7179
 Site-SynthDigits| Val  Loss: 1.0232 | Val  Acc: 0.7051
 Site-MNIST-M   | Val  Loss: 1.0689 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.1327 | Val  Acc: 0.7414
Average Valid Accuracy: 0.8094
Aggregated Acc | Val Acc: 0.7091
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:16 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:16 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:16 | Val Acc: 0.2273
 Best site-USPS       | Epoch:16 | Val Acc: 0.9000
 Best site-USPS       | Epoch:16 | Val Acc: 0.9024
 Best site-USPS       | Epoch:16 | Val Acc: 0.8710
 Best site-USPS       | Epoch:16 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7179
 Best site-SynthDigits | Epoch:16 | Val Acc: 0.7051
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:16 | Val Acc: 0.7414
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 17 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-0
client-13 is in G-0
cnt=[2, 4, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6735 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4821 | Train Acc: 0.8936
 Site-MNIST     | Train Loss: 0.5595 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.5376 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4090 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.4931 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 0.5682 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.5172 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.5435 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.4699 | Train Acc: 0.9194
 Site-SynthDigits| Train Loss: 1.0936 | Train Acc: 0.6949
 Site-SynthDigits| Train Loss: 0.9603 | Train Acc: 0.7034
 Site-MNIST-M   | Train Loss: 1.3232 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 1.0713 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.4950 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.5155 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5822 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5498 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4834 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.1619 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.5054 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.5042 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.5630 | Val  Acc: 0.8548
 Site-USPS      | Val  Loss: 0.4910 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.9339 | Val  Acc: 0.7949
 Site-SynthDigits| Val  Loss: 0.9697 | Val  Acc: 0.7564
 Site-MNIST-M   | Val  Loss: 1.0270 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.0908 | Val  Acc: 0.7586
Average Valid Accuracy: 0.8216
Aggregated Acc | Val Acc: 0.7251
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8667
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:17 | Val Acc: 0.9365
 Best site-MNIST      | Epoch:17 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:17 | Val Acc: 0.2273
 Best site-USPS       | Epoch:17 | Val Acc: 0.9500
 Best site-USPS       | Epoch:17 | Val Acc: 0.9268
 Best site-USPS       | Epoch:17 | Val Acc: 0.8548
 Best site-USPS       | Epoch:17 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7949
 Best site-SynthDigits | Epoch:17 | Val Acc: 0.7564
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:17 | Val Acc: 0.7586
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 18 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-3
client-13 is in G-3
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7575 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4727 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5337 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.5226 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3808 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7336 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.5483 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.4883 | Train Acc: 0.9194
 Site-USPS      | Train Loss: 0.5196 | Train Acc: 0.8925
 Site-USPS      | Train Loss: 0.4357 | Train Acc: 0.9274
 Site-SynthDigits| Train Loss: 1.0125 | Train Acc: 0.7119
 Site-SynthDigits| Train Loss: 0.8973 | Train Acc: 0.7542
 Site-MNIST-M   | Train Loss: 1.2727 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.9949 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.4769 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4998 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5817 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5396 | Val  Acc: 0.9206
 Site-MNIST     | Val  Loss: 0.4687 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2028 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.4785 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.4788 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.5438 | Val  Acc: 0.8548
 Site-USPS      | Val  Loss: 0.4691 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.8804 | Val  Acc: 0.8205
 Site-SynthDigits| Val  Loss: 0.9289 | Val  Acc: 0.7692
 Site-MNIST-M   | Val  Loss: 0.9608 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 1.0287 | Val  Acc: 0.7931
Average Valid Accuracy: 0.8337
Aggregated Acc | Val Acc: 0.7435
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:18 | Val Acc: 0.9206
 Best site-MNIST      | Epoch:18 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:18 | Val Acc: 0.2727
 Best site-USPS       | Epoch:18 | Val Acc: 0.9500
 Best site-USPS       | Epoch:18 | Val Acc: 0.9268
 Best site-USPS       | Epoch:18 | Val Acc: 0.8548
 Best site-USPS       | Epoch:18 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.8205
 Best site-SynthDigits | Epoch:18 | Val Acc: 0.7692
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.8966
 Best site-MNIST-M    | Epoch:18 | Val Acc: 0.7931
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 19 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.6944 | Train Acc: 0.7391
 Site-MNIST     | Train Loss: 0.4417 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5192 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4922 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3745 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.2435 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.5355 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.4712 | Train Acc: 0.9194
 Site-USPS      | Train Loss: 0.5019 | Train Acc: 0.8602
 Site-USPS      | Train Loss: 0.4185 | Train Acc: 0.9274
 Site-SynthDigits| Train Loss: 1.0079 | Train Acc: 0.7288
 Site-SynthDigits| Train Loss: 0.8915 | Train Acc: 0.7712
 Site-MNIST-M   | Train Loss: 1.2436 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9482 | Train Acc: 0.7841
 Site-MNIST     | Val  Loss: 0.4533 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4758 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.5483 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.5056 | Val  Acc: 0.9365
 Site-MNIST     | Val  Loss: 0.4463 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2628 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4608 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.4621 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.5284 | Val  Acc: 0.8871
 Site-USPS      | Val  Loss: 0.4518 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.8397 | Val  Acc: 0.8462
 Site-SynthDigits| Val  Loss: 0.8862 | Val  Acc: 0.7821
 Site-MNIST-M   | Val  Loss: 0.9189 | Val  Acc: 0.8966
 Site-MNIST-M   | Val  Loss: 0.9825 | Val  Acc: 0.7931
Average Valid Accuracy: 0.8334
Aggregated Acc | Val Acc: 0.7314
============ Train epoch 20 ============
gmm
client-0 is in G-4
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[4, 4, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.7257 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.4287 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.5102 | Train Acc: 0.8310
 Site-MNIST     | Train Loss: 0.4754 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3709 | Train Acc: 0.9492
 Site-SVHN      | Train Loss: 2.0166 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.5326 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.4574 | Train Acc: 0.9194
 Site-USPS      | Train Loss: 0.4884 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.4188 | Train Acc: 0.9194
 Site-SynthDigits| Train Loss: 0.9613 | Train Acc: 0.7458
 Site-SynthDigits| Train Loss: 0.8881 | Train Acc: 0.7881
 Site-MNIST-M   | Train Loss: 1.2257 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.9361 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.4438 | Val  Acc: 0.8667
 Site-MNIST     | Val  Loss: 0.4582 | Val  Acc: 0.8387
 Site-MNIST     | Val  Loss: 0.5254 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4831 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4286 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2075 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4560 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.4459 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.5114 | Val  Acc: 0.8548
 Site-USPS      | Val  Loss: 0.4348 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.8057 | Val  Acc: 0.8205
 Site-SynthDigits| Val  Loss: 0.8609 | Val  Acc: 0.7949
 Site-MNIST-M   | Val  Loss: 0.8673 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9314 | Val  Acc: 0.8103
Average Valid Accuracy: 0.8288
Aggregated Acc | Val Acc: 0.8230
============ Train epoch 21 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[5, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5547 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3985 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4671 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4465 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.3405 | Train Acc: 0.9407
 Site-SVHN      | Train Loss: 2.1448 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.5142 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.4453 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.4659 | Train Acc: 0.8925
 Site-USPS      | Train Loss: 0.3946 | Train Acc: 0.9194
 Site-SynthDigits| Train Loss: 0.9398 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.8354 | Train Acc: 0.8051
 Site-MNIST-M   | Train Loss: 1.2041 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8958 | Train Acc: 0.7955
 Site-MNIST     | Val  Loss: 0.4170 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4359 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4967 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4493 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.4081 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2276 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4451 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.4312 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.4931 | Val  Acc: 0.8548
 Site-USPS      | Val  Loss: 0.4191 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.7834 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.8343 | Val  Acc: 0.8205
 Site-MNIST-M   | Val  Loss: 0.8361 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.9007 | Val  Acc: 0.8276
Average Valid Accuracy: 0.8426
Aggregated Acc | Val Acc: 0.7443
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:21 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:21 | Val Acc: 0.8987
 Best site-SVHN       | Epoch:21 | Val Acc: 0.1818
 Best site-USPS       | Epoch:21 | Val Acc: 0.9500
 Best site-USPS       | Epoch:21 | Val Acc: 0.9268
 Best site-USPS       | Epoch:21 | Val Acc: 0.8548
 Best site-USPS       | Epoch:21 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8718
 Best site-SynthDigits | Epoch:21 | Val Acc: 0.8205
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.9310
 Best site-MNIST-M    | Epoch:21 | Val Acc: 0.8276
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 22 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
client-11 is in G-4
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5845 | Train Acc: 0.7826
 Site-MNIST     | Train Loss: 0.3862 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4588 | Train Acc: 0.8451
 Site-MNIST     | Train Loss: 0.4252 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.3610 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 2.0633 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5061 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.4440 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.4579 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.3822 | Train Acc: 0.9113
 Site-SynthDigits| Train Loss: 0.8784 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.7777 | Train Acc: 0.7881
 Site-MNIST-M   | Train Loss: 1.1626 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8557 | Train Acc: 0.8295
 Site-MNIST     | Val  Loss: 0.4003 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4191 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4834 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4323 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3954 | Val  Acc: 0.8987
 Site-SVHN      | Val  Loss: 2.2178 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.4264 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.4089 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.4721 | Val  Acc: 0.8871
 Site-USPS      | Val  Loss: 0.4007 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.7474 | Val  Acc: 0.8718
 Site-SynthDigits| Val  Loss: 0.8056 | Val  Acc: 0.8077
 Site-MNIST-M   | Val  Loss: 0.8007 | Val  Acc: 0.9310
 Site-MNIST-M   | Val  Loss: 0.8726 | Val  Acc: 0.8103
Average Valid Accuracy: 0.8412
Aggregated Acc | Val Acc: 0.7351
============ Train epoch 23 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-4
client-13 is in G-4
cnt=[2, 4, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5512 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3761 | Train Acc: 0.9149
 Site-MNIST     | Train Loss: 0.4684 | Train Acc: 0.8732
 Site-MNIST     | Train Loss: 0.4082 | Train Acc: 0.9255
 Site-MNIST     | Train Loss: 0.3226 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.7891 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.5116 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 0.4139 | Train Acc: 0.9194
 Site-USPS      | Train Loss: 0.4437 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.3650 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.8460 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.7832 | Train Acc: 0.8051
 Site-MNIST-M   | Train Loss: 1.1417 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.8424 | Train Acc: 0.8182
 Site-MNIST     | Val  Loss: 0.3825 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.4003 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4563 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.4075 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3791 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3007 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.4090 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3976 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.4629 | Val  Acc: 0.8871
 Site-USPS      | Val  Loss: 0.3903 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.7246 | Val  Acc: 0.8462
 Site-SynthDigits| Val  Loss: 0.7787 | Val  Acc: 0.8077
 Site-MNIST-M   | Val  Loss: 0.7770 | Val  Acc: 0.9655
 Site-MNIST-M   | Val  Loss: 0.8420 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8476
Aggregated Acc | Val Acc: 0.7484
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:23 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:23 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:23 | Val Acc: 0.1818
 Best site-USPS       | Epoch:23 | Val Acc: 0.9500
 Best site-USPS       | Epoch:23 | Val Acc: 0.9512
 Best site-USPS       | Epoch:23 | Val Acc: 0.8871
 Best site-USPS       | Epoch:23 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8462
 Best site-SynthDigits | Epoch:23 | Val Acc: 0.8077
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.9655
 Best site-MNIST-M    | Epoch:23 | Val Acc: 0.8448
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 24 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[4, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5187 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3443 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4601 | Train Acc: 0.8592
 Site-MNIST     | Train Loss: 0.3781 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3043 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.2694 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.5121 | Train Acc: 0.7742
 Site-USPS      | Train Loss: 0.4131 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.4493 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.3624 | Train Acc: 0.9274
 Site-SynthDigits| Train Loss: 0.8385 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.7668 | Train Acc: 0.8136
 Site-MNIST-M   | Train Loss: 1.0913 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.7960 | Train Acc: 0.8068
 Site-MNIST     | Val  Loss: 0.3600 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3786 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4241 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3821 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3644 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.4579 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.4076 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3953 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.4634 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3886 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.7126 | Val  Acc: 0.8462
 Site-SynthDigits| Val  Loss: 0.7556 | Val  Acc: 0.8077
 Site-MNIST-M   | Val  Loss: 0.7531 | Val  Acc: 0.9655
 Site-MNIST-M   | Val  Loss: 0.8135 | Val  Acc: 0.8448
Average Valid Accuracy: 0.8470
Aggregated Acc | Val Acc: 0.7410
============ Train epoch 25 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
client-13 is in G-3
cnt=[1, 4, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5372 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3406 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4348 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3688 | Train Acc: 0.9468
 Site-MNIST     | Train Loss: 0.2824 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.4260 | Train Acc: 0.3939
 Site-USPS      | Train Loss: 0.4875 | Train Acc: 0.8065
 Site-USPS      | Train Loss: 0.3742 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.4164 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.3431 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.8252 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6955 | Train Acc: 0.8390
 Site-MNIST-M   | Train Loss: 1.0727 | Train Acc: 0.6818
 Site-MNIST-M   | Train Loss: 0.7874 | Train Acc: 0.8750
 Site-MNIST     | Val  Loss: 0.3449 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3608 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4186 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3731 | Val  Acc: 0.9524
 Site-MNIST     | Val  Loss: 0.3537 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3047 | Val  Acc: 0.1364
 Site-USPS      | Val  Loss: 0.3821 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3771 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.4442 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3644 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.6537 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.7075 | Val  Acc: 0.8462
 Site-MNIST-M   | Val  Loss: 0.7130 | Val  Acc: 0.9655
 Site-MNIST-M   | Val  Loss: 0.7727 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8580
Aggregated Acc | Val Acc: 0.7557
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:25 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9524
 Best site-MNIST      | Epoch:25 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:25 | Val Acc: 0.1364
 Best site-USPS       | Epoch:25 | Val Acc: 0.9500
 Best site-USPS       | Epoch:25 | Val Acc: 0.9512
 Best site-USPS       | Epoch:25 | Val Acc: 0.9032
 Best site-USPS       | Epoch:25 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:25 | Val Acc: 0.8462
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.9655
 Best site-MNIST-M    | Epoch:25 | Val Acc: 0.8966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 26 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-2
client-13 is in G-2
cnt=[5, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5979 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3357 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3806 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3523 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2943 | Train Acc: 0.9576
 Site-SVHN      | Train Loss: 1.3939 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.4660 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.3777 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.4063 | Train Acc: 0.8817
 Site-USPS      | Train Loss: 0.3263 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.7925 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.6656 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 1.0322 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.7652 | Train Acc: 0.8409
 Site-MNIST     | Val  Loss: 0.3357 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3529 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4111 | Val  Acc: 0.8723
 Site-MNIST     | Val  Loss: 0.3595 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3408 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3844 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.3673 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3573 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.4277 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3569 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.6324 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.6837 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.6851 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7461 | Val  Acc: 0.8966
Average Valid Accuracy: 0.8634
Aggregated Acc | Val Acc: 0.7687
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:26 | Val Acc: 0.8723
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:26 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:26 | Val Acc: 0.1818
 Best site-USPS       | Epoch:26 | Val Acc: 0.9500
 Best site-USPS       | Epoch:26 | Val Acc: 0.9512
 Best site-USPS       | Epoch:26 | Val Acc: 0.9032
 Best site-USPS       | Epoch:26 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:26 | Val Acc: 0.8590
 Best site-MNIST-M    | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:26 | Val Acc: 0.8966
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 27 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
client-13 is in G-1
cnt=[5, 2, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4307 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3374 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.4162 | Train Acc: 0.8873
 Site-MNIST     | Train Loss: 0.3551 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.2637 | Train Acc: 0.9661
 Site-SVHN      | Train Loss: 1.8918 | Train Acc: 0.4242
 Site-USPS      | Train Loss: 0.4449 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.3506 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3987 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.3189 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.7868 | Train Acc: 0.7627
 Site-SynthDigits| Train Loss: 0.6727 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.9919 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7047 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.3226 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3421 | Val  Acc: 0.8710
 Site-MNIST     | Val  Loss: 0.4132 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3562 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3356 | Val  Acc: 0.9114
 Site-SVHN      | Val  Loss: 2.3605 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.3433 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3397 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.4091 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.3401 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.6009 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.6604 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.6513 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.7147 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8744
Aggregated Acc | Val Acc: 0.7777
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8710
 Best site-MNIST      | Epoch:27 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:27 | Val Acc: 0.9114
 Best site-SVHN       | Epoch:27 | Val Acc: 0.1818
 Best site-USPS       | Epoch:27 | Val Acc: 1.0000
 Best site-USPS       | Epoch:27 | Val Acc: 0.9756
 Best site-USPS       | Epoch:27 | Val Acc: 0.9194
 Best site-USPS       | Epoch:27 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:27 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:27 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 28 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-3
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
client-11 is in G-4
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.5483 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.3148 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3930 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3415 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2534 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.2026 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.4545 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.3507 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3772 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.3077 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.8058 | Train Acc: 0.7797
 Site-SynthDigits| Train Loss: 0.6476 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9730 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.7026 | Train Acc: 0.9091
 Site-MNIST     | Val  Loss: 0.3178 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3312 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3897 | Val  Acc: 0.8936
 Site-MNIST     | Val  Loss: 0.3417 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3255 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.2683 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.3353 | Val  Acc: 1.0000
 Site-USPS      | Val  Loss: 0.3380 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.4043 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3300 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.5945 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.6495 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.6347 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6984 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8785
Aggregated Acc | Val Acc: 0.7931
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9333
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9032
 Best site-MNIST      | Epoch:28 | Val Acc: 0.8936
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9683
 Best site-MNIST      | Epoch:28 | Val Acc: 0.9241
 Best site-SVHN       | Epoch:28 | Val Acc: 0.2727
 Best site-USPS       | Epoch:28 | Val Acc: 1.0000
 Best site-USPS       | Epoch:28 | Val Acc: 0.9268
 Best site-USPS       | Epoch:28 | Val Acc: 0.9032
 Best site-USPS       | Epoch:28 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:28 | Val Acc: 0.8590
 Best site-MNIST-M    | Epoch:28 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:28 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 29 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4879 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.3008 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3632 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.3220 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2360 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.0464 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.4427 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.3401 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3767 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.3034 | Train Acc: 0.9194
 Site-SynthDigits| Train Loss: 0.7317 | Train Acc: 0.7627
 Site-SynthDigits| Train Loss: 0.6217 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.9437 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.6645 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2883 | Val  Acc: 0.9333
 Site-MNIST     | Val  Loss: 0.3094 | Val  Acc: 0.9032
 Site-MNIST     | Val  Loss: 0.3735 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3222 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.3155 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2157 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3284 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.3407 | Val  Acc: 0.9024
 Site-USPS      | Val  Loss: 0.4016 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3220 | Val  Acc: 0.9157
 Site-SynthDigits| Val  Loss: 0.5713 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.6240 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.6158 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6789 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8712
Aggregated Acc | Val Acc: 0.7806
============ Train epoch 30 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4866 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.2983 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3525 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.3078 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2281 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4492 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.4412 | Train Acc: 0.8387
 Site-USPS      | Train Loss: 0.3242 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3702 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2981 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.7368 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6216 | Train Acc: 0.8559
 Site-MNIST-M   | Train Loss: 0.9177 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.6409 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2644 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2918 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3583 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.3064 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.3066 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2262 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3222 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3307 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3913 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.3134 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.5517 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.6034 | Val  Acc: 0.8718
 Site-MNIST-M   | Val  Loss: 0.5914 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6521 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8885
Aggregated Acc | Val Acc: 0.7922
 Best site-MNIST      | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:30 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:30 | Val Acc: 0.2273
 Best site-USPS       | Epoch:30 | Val Acc: 0.9500
 Best site-USPS       | Epoch:30 | Val Acc: 0.9512
 Best site-USPS       | Epoch:30 | Val Acc: 0.9194
 Best site-USPS       | Epoch:30 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:30 | Val Acc: 0.8718
 Best site-MNIST-M    | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:30 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 31 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[5, 4, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4762 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.2952 | Train Acc: 0.9362
 Site-MNIST     | Train Loss: 0.3754 | Train Acc: 0.9014
 Site-MNIST     | Train Loss: 0.3021 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2616 | Train Acc: 0.9746
 Site-SVHN      | Train Loss: 1.4436 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.4257 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.3059 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3520 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2815 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.6964 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.6133 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.8905 | Train Acc: 0.7500
 Site-MNIST-M   | Train Loss: 0.6303 | Train Acc: 0.9205
 Site-MNIST     | Val  Loss: 0.2704 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2902 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3531 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2990 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2990 | Val  Acc: 0.9241
 Site-SVHN      | Val  Loss: 2.2360 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.3024 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3107 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3759 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.3067 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.5323 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5910 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5758 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6347 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8865
Aggregated Acc | Val Acc: 0.7916
============ Train epoch 32 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-3
client-13 is in G-3
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4126 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.2748 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3398 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2816 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2126 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.1358 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.4227 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.3104 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3480 | Train Acc: 0.8925
 Site-USPS      | Train Loss: 0.2835 | Train Acc: 0.9435
 Site-SynthDigits| Train Loss: 0.6820 | Train Acc: 0.7966
 Site-SynthDigits| Train Loss: 0.5598 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.9177 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.6192 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2532 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2759 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3312 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2803 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2907 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2690 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2978 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.3033 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.3660 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2974 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.5219 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5750 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5583 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.6187 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8912
Aggregated Acc | Val Acc: 0.7947
 Best site-MNIST      | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:32 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:32 | Val Acc: 0.2273
 Best site-USPS       | Epoch:32 | Val Acc: 0.9500
 Best site-USPS       | Epoch:32 | Val Acc: 0.9756
 Best site-USPS       | Epoch:32 | Val Acc: 0.9194
 Best site-USPS       | Epoch:32 | Val Acc: 0.9036
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:32 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:32 | Val Acc: 0.9138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 33 ============
gmm
client-0 is in G-3
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-0
client-11 is in G-0
client-12 is in G-2
client-13 is in G-2
cnt=[6, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4368 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2696 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3308 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2737 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2100 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4899 | Train Acc: 0.4545
 Site-USPS      | Train Loss: 0.3932 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.2997 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3285 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2581 | Train Acc: 0.9597
 Site-SynthDigits| Train Loss: 0.6797 | Train Acc: 0.8136
 Site-SynthDigits| Train Loss: 0.5729 | Train Acc: 0.8729
 Site-MNIST-M   | Train Loss: 0.8688 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5774 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2431 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2684 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3291 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2723 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2836 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2670 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2819 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2884 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3471 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2815 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.5182 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5717 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.5339 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5979 | Val  Acc: 0.9138
Average Valid Accuracy: 0.8895
Aggregated Acc | Val Acc: 0.8106
============ Train epoch 34 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[1, 5, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4663 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2595 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3520 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2638 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2035 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.3452 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.3921 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.3005 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3246 | Train Acc: 0.8925
 Site-USPS      | Train Loss: 0.2586 | Train Acc: 0.9355
 Site-SynthDigits| Train Loss: 0.6775 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.6082 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.8336 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5685 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2445 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2664 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3171 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2623 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2763 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3348 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2857 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2890 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.3457 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2824 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.5043 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5558 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.5257 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5901 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8863
Aggregated Acc | Val Acc: 0.7908
============ Train epoch 35 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
client-13 is in G-3
cnt=[1, 4, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3927 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2562 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3217 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2674 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2101 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0691 | Train Acc: 0.5152
 Site-USPS      | Train Loss: 0.3944 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2876 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3170 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2572 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.6120 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.5305 | Train Acc: 0.8644
 Site-MNIST-M   | Train Loss: 0.8176 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.5441 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.2394 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2669 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3181 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2609 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2722 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2882 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2832 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2847 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.3401 | Val  Acc: 0.9032
 Site-USPS      | Val  Loss: 0.2771 | Val  Acc: 0.9036
 Site-SynthDigits| Val  Loss: 0.4835 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5360 | Val  Acc: 0.8590
 Site-MNIST-M   | Val  Loss: 0.5116 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5747 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8892
Aggregated Acc | Val Acc: 0.7997
============ Train epoch 36 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-0
client-11 is in G-0
client-12 is in G-3
client-13 is in G-3
cnt=[2, 4, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3719 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2572 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3662 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2580 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1964 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4882 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.3737 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2754 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3113 | Train Acc: 0.8925
 Site-USPS      | Train Loss: 0.2500 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.6345 | Train Acc: 0.8475
 Site-SynthDigits| Train Loss: 0.5043 | Train Acc: 0.8814
 Site-MNIST-M   | Train Loss: 0.8259 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.5446 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2269 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2537 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.3112 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2530 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2653 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.2529 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2704 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2726 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3301 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2713 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.4520 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.5150 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.4895 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5556 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8907
Aggregated Acc | Val Acc: 0.7951
============ Train epoch 37 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-4
client-13 is in G-4
cnt=[1, 5, 4, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3227 | Train Acc: 0.8261
 Site-MNIST     | Train Loss: 0.2460 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3283 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2438 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1940 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.9691 | Train Acc: 0.4848
 Site-USPS      | Train Loss: 0.3713 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2714 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.3122 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2414 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.6146 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.4947 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.8142 | Train Acc: 0.7273
 Site-MNIST-M   | Train Loss: 0.5241 | Train Acc: 0.9318
 Site-MNIST     | Val  Loss: 0.2186 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2440 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2961 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2419 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2589 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.2732 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2575 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2626 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3237 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2695 | Val  Acc: 0.8916
 Site-SynthDigits| Val  Loss: 0.4386 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.4991 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.4757 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5405 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8952
Aggregated Acc | Val Acc: 0.8059
 Best site-MNIST      | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:37 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:37 | Val Acc: 0.2727
 Best site-USPS       | Epoch:37 | Val Acc: 0.9500
 Best site-USPS       | Epoch:37 | Val Acc: 0.9512
 Best site-USPS       | Epoch:37 | Val Acc: 0.9194
 Best site-USPS       | Epoch:37 | Val Acc: 0.8916
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:37 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:37 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 38 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[4, 5, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3642 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2431 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2954 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2378 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.2251 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.0928 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3755 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2663 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.2947 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2344 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.5900 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.4606 | Train Acc: 0.8898
 Site-MNIST-M   | Train Loss: 0.7691 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.5215 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.2029 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2316 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2892 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2331 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2547 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.2351 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2498 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2585 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3140 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2587 | Val  Acc: 0.9157
 Site-SynthDigits| Val  Loss: 0.4291 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.4856 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.4642 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5276 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8969
Aggregated Acc | Val Acc: 0.8071
 Best site-MNIST      | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:38 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:38 | Val Acc: 0.2727
 Best site-USPS       | Epoch:38 | Val Acc: 0.9500
 Best site-USPS       | Epoch:38 | Val Acc: 0.9512
 Best site-USPS       | Epoch:38 | Val Acc: 0.9194
 Best site-USPS       | Epoch:38 | Val Acc: 0.9157
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:38 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:38 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:38 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 39 ============
gmm
client-0 is in G-0
client-1 is in G-4
client-2 is in G-4
client-3 is in G-4
client-4 is in G-4
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-3
client-11 is in G-3
client-12 is in G-2
client-13 is in G-2
cnt=[1, 4, 3, 2, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4205 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2373 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3049 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2327 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1766 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.2037 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3756 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2567 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.2896 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2290 | Train Acc: 0.9597
 Site-SynthDigits| Train Loss: 0.5924 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.4617 | Train Acc: 0.8983
 Site-MNIST-M   | Train Loss: 0.7625 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4906 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1883 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2199 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2820 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2262 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2498 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.1888 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2450 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2537 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3073 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2510 | Val  Acc: 0.9277
 Site-SynthDigits| Val  Loss: 0.4200 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.4747 | Val  Acc: 0.8846
 Site-MNIST-M   | Val  Loss: 0.4536 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.5150 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8978
Aggregated Acc | Val Acc: 0.9046
 Best site-MNIST      | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:39 | Val Acc: 0.9620
 Best site-SVHN       | Epoch:39 | Val Acc: 0.2727
 Best site-USPS       | Epoch:39 | Val Acc: 0.9500
 Best site-USPS       | Epoch:39 | Val Acc: 0.9512
 Best site-USPS       | Epoch:39 | Val Acc: 0.9194
 Best site-USPS       | Epoch:39 | Val Acc: 0.9277
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:39 | Val Acc: 0.8846
 Best site-MNIST-M    | Epoch:39 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:39 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
 Test site-MNIST     | Epoch:39 | Test Acc: 0.8864
 Test site-SVHN      | Epoch:39 | Test Acc: 0.3970
 Test site-USPS      | Epoch:39 | Test Acc: 0.9194
 Test site-SynthDigits| Epoch:39 | Test Acc: 0.7176
 Test site-MNIST-M   | Epoch:39 | Test Acc: 0.6164
Average Test Accuracy: 0.7073
============ Train epoch 40 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-3
client-11 is in G-3
client-12 is in G-0
client-13 is in G-0
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3857 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2344 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2825 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2350 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1662 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.4140 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3668 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.2507 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2882 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2274 | Train Acc: 0.9597
 Site-SynthDigits| Train Loss: 0.5721 | Train Acc: 0.9153
 Site-SynthDigits| Train Loss: 0.4628 | Train Acc: 0.9068
 Site-MNIST-M   | Train Loss: 0.7404 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4858 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1771 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2164 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2828 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2228 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2456 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.2216 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2438 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2520 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.3022 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2475 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.4121 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4622 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.4367 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4988 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8984
Aggregated Acc | Val Acc: 0.8094
 Best site-MNIST      | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:40 | Val Acc: 0.9367
 Best site-SVHN       | Epoch:40 | Val Acc: 0.2727
 Best site-USPS       | Epoch:40 | Val Acc: 0.9500
 Best site-USPS       | Epoch:40 | Val Acc: 0.9512
 Best site-USPS       | Epoch:40 | Val Acc: 0.9194
 Best site-USPS       | Epoch:40 | Val Acc: 0.9398
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:40 | Val Acc: 0.8974
 Best site-MNIST-M    | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:40 | Val Acc: 0.9310
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 41 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-0
client-6 is in G-4
client-7 is in G-4
client-8 is in G-4
client-9 is in G-4
client-10 is in G-2
client-11 is in G-2
client-12 is in G-3
client-13 is in G-3
cnt=[1, 5, 2, 2, 4, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4352 | Train Acc: 0.9130
 Site-MNIST     | Train Loss: 0.2288 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2993 | Train Acc: 0.9155
 Site-MNIST     | Train Loss: 0.2261 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1646 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 0.9596 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.3527 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2576 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2935 | Train Acc: 0.9247
 Site-USPS      | Train Loss: 0.2194 | Train Acc: 0.9516
 Site-SynthDigits| Train Loss: 0.5573 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.4623 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.7552 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 0.4711 | Train Acc: 0.9659
 Site-MNIST     | Val  Loss: 0.1829 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2205 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2803 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2186 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2404 | Val  Acc: 0.9367
 Site-SVHN      | Val  Loss: 2.1905 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2392 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.2484 | Val  Acc: 0.9268
 Site-USPS      | Val  Loss: 0.2956 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2413 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.4046 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4526 | Val  Acc: 0.9103
 Site-MNIST-M   | Val  Loss: 0.4296 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4879 | Val  Acc: 0.9310
Average Valid Accuracy: 0.8940
Aggregated Acc | Val Acc: 0.8070
============ Train epoch 42 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-0
client-11 is in G-0
client-12 is in G-3
client-13 is in G-3
cnt=[2, 5, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.4480 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2334 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.3073 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.2215 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1600 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0287 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3540 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2590 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2764 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2126 | Train Acc: 0.9597
 Site-SynthDigits| Train Loss: 0.5420 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.4215 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.7482 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.4712 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1734 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2058 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2699 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2126 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2342 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2180 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2365 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2412 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.2890 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2328 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3897 | Val  Acc: 0.8974
 Site-SynthDigits| Val  Loss: 0.4453 | Val  Acc: 0.8974
 Site-MNIST-M   | Val  Loss: 0.4182 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4736 | Val  Acc: 0.9483
Average Valid Accuracy: 0.8987
Aggregated Acc | Val Acc: 0.8091
 Best site-MNIST      | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:42 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:42 | Val Acc: 0.2727
 Best site-USPS       | Epoch:42 | Val Acc: 0.9500
 Best site-USPS       | Epoch:42 | Val Acc: 0.9512
 Best site-USPS       | Epoch:42 | Val Acc: 0.9194
 Best site-USPS       | Epoch:42 | Val Acc: 0.9398
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8974
 Best site-SynthDigits | Epoch:42 | Val Acc: 0.8974
 Best site-MNIST-M    | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:42 | Val Acc: 0.9483
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 43 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-0
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
client-13 is in G-3
cnt=[1, 4, 5, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3012 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2212 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2947 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.2126 | Train Acc: 0.9681
 Site-MNIST     | Train Loss: 0.1459 | Train Acc: 0.9831
 Site-SVHN      | Train Loss: 1.0397 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3489 | Train Acc: 0.8710
 Site-USPS      | Train Loss: 0.2471 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2741 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2094 | Train Acc: 0.9839
 Site-SynthDigits| Train Loss: 0.5517 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.4249 | Train Acc: 0.9153
 Site-MNIST-M   | Train Loss: 0.7083 | Train Acc: 0.8409
 Site-MNIST-M   | Train Loss: 0.4688 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1538 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1895 | Val  Acc: 0.9355
 Site-MNIST     | Val  Loss: 0.2591 | Val  Acc: 0.9362
 Site-MNIST     | Val  Loss: 0.2043 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2293 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3002 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2347 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2413 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.2871 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2281 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3790 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4313 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.4129 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4617 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9062
Aggregated Acc | Val Acc: 0.8184
 Best site-MNIST      | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9355
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9362
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:43 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:43 | Val Acc: 0.2727
 Best site-USPS       | Epoch:43 | Val Acc: 0.9500
 Best site-USPS       | Epoch:43 | Val Acc: 0.9756
 Best site-USPS       | Epoch:43 | Val Acc: 0.9194
 Best site-USPS       | Epoch:43 | Val Acc: 0.9398
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:43 | Val Acc: 0.9359
 Best site-MNIST-M    | Epoch:43 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:43 | Val Acc: 0.9655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 44 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-3
client-7 is in G-3
client-8 is in G-3
client-9 is in G-3
client-10 is in G-2
client-11 is in G-2
client-12 is in G-1
client-13 is in G-1
cnt=[5, 2, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2923 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.2090 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2872 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1979 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1564 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.9420 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3465 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2425 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.2615 | Train Acc: 0.9140
 Site-USPS      | Train Loss: 0.2083 | Train Acc: 0.9839
 Site-SynthDigits| Train Loss: 0.5107 | Train Acc: 0.8644
 Site-SynthDigits| Train Loss: 0.4132 | Train Acc: 0.9322
 Site-MNIST-M   | Train Loss: 0.6706 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.4433 | Train Acc: 0.9432
 Site-MNIST     | Val  Loss: 0.1559 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1818 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2422 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1966 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2239 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.3430 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2347 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2343 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.2796 | Val  Acc: 0.9355
 Site-USPS      | Val  Loss: 0.2203 | Val  Acc: 0.9277
 Site-SynthDigits| Val  Loss: 0.3689 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.4248 | Val  Acc: 0.9487
 Site-MNIST-M   | Val  Loss: 0.3934 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4432 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9166
Aggregated Acc | Val Acc: 0.8251
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9841
 Best site-MNIST      | Epoch:44 | Val Acc: 0.9494
 Best site-SVHN       | Epoch:44 | Val Acc: 0.2727
 Best site-USPS       | Epoch:44 | Val Acc: 0.9500
 Best site-USPS       | Epoch:44 | Val Acc: 0.9756
 Best site-USPS       | Epoch:44 | Val Acc: 0.9355
 Best site-USPS       | Epoch:44 | Val Acc: 0.9277
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9231
 Best site-SynthDigits | Epoch:44 | Val Acc: 0.9487
 Best site-MNIST-M    | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST-M    | Epoch:44 | Val Acc: 0.9655
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 45 ============
gmm
client-0 is in G-2
client-1 is in G-2
client-2 is in G-2
client-3 is in G-2
client-4 is in G-2
client-5 is in G-4
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-3
client-11 is in G-3
client-12 is in G-1
client-13 is in G-1
cnt=[4, 2, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3682 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1920 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2796 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1947 | Train Acc: 0.9894
 Site-MNIST     | Train Loss: 0.1686 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.4412 | Train Acc: 0.5758
 Site-USPS      | Train Loss: 0.3384 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2421 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2631 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.2034 | Train Acc: 0.9758
 Site-SynthDigits| Train Loss: 0.5221 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.3871 | Train Acc: 0.9237
 Site-MNIST-M   | Train Loss: 0.6839 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.4073 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.1620 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1837 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.2366 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1939 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2213 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.2679 | Val  Acc: 0.2727
 Site-USPS      | Val  Loss: 0.2352 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2349 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.2815 | Val  Acc: 0.9355
 Site-USPS      | Val  Loss: 0.2170 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3487 | Val  Acc: 0.9487
 Site-SynthDigits| Val  Loss: 0.4101 | Val  Acc: 0.9231
 Site-MNIST-M   | Val  Loss: 0.3832 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4331 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9159
Aggregated Acc | Val Acc: 0.8248
 Test site-MNIST     | Epoch:44 | Test Acc: 0.8871
 Test site-SVHN      | Epoch:44 | Test Acc: 0.3919
 Test site-USPS      | Epoch:44 | Test Acc: 0.9301
 Test site-SynthDigits| Epoch:44 | Test Acc: 0.7357
 Test site-MNIST-M   | Epoch:44 | Test Acc: 0.6243
Average Test Accuracy: 0.7138
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-3_1/ccop_q=0.5...
============ Train epoch 46 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-2
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
client-13 is in G-3
cnt=[5, 4, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3396 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1856 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2544 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1896 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1606 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.8526 | Train Acc: 0.6364
 Site-USPS      | Train Loss: 0.3304 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2374 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2577 | Train Acc: 0.9247
 Site-USPS      | Train Loss: 0.1952 | Train Acc: 0.9758
 Site-SynthDigits| Train Loss: 0.5106 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.3864 | Train Acc: 0.9492
 Site-MNIST-M   | Train Loss: 0.6465 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.4072 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1562 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1808 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2294 | Val  Acc: 0.9574
 Site-MNIST     | Val  Loss: 0.1877 | Val  Acc: 0.9683
 Site-MNIST     | Val  Loss: 0.2169 | Val  Acc: 0.9494
 Site-SVHN      | Val  Loss: 2.4092 | Val  Acc: 0.1818
 Site-USPS      | Val  Loss: 0.2291 | Val  Acc: 0.9000
 Site-USPS      | Val  Loss: 0.2326 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.2768 | Val  Acc: 0.9355
 Site-USPS      | Val  Loss: 0.2138 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3502 | Val  Acc: 0.9487
 Site-SynthDigits| Val  Loss: 0.4019 | Val  Acc: 0.9487
 Site-MNIST-M   | Val  Loss: 0.3875 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4311 | Val  Acc: 0.9655
Average Valid Accuracy: 0.9010
Aggregated Acc | Val Acc: 0.8027
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8921
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3642
 Test site-USPS      | Epoch:45 | Test Acc: 0.9355
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7374
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.6150
Average Test Accuracy: 0.7089
============ Train epoch 47 ============
gmm
client-0 is in G-1
client-1 is in G-1
client-2 is in G-1
client-3 is in G-1
client-4 is in G-1
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-0
client-9 is in G-0
client-10 is in G-4
client-11 is in G-4
client-12 is in G-3
client-13 is in G-3
cnt=[4, 5, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.3637 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1957 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2525 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1915 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1411 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.9414 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.3220 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2255 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2572 | Train Acc: 0.9355
 Site-USPS      | Train Loss: 0.1919 | Train Acc: 0.9677
 Site-SynthDigits| Train Loss: 0.5155 | Train Acc: 0.8814
 Site-SynthDigits| Train Loss: 0.3790 | Train Acc: 0.9322
 Site-MNIST-M   | Train Loss: 0.6448 | Train Acc: 0.9091
 Site-MNIST-M   | Train Loss: 0.3965 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1480 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1831 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2360 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1882 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2127 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3366 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2233 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2281 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.2759 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2090 | Val  Acc: 0.9518
 Site-SynthDigits| Val  Loss: 0.3450 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.3914 | Val  Acc: 0.9231
 Site-MNIST-M   | Val  Loss: 0.3648 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4134 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9087
Aggregated Acc | Val Acc: 0.8127
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8921
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3753
 Test site-USPS      | Epoch:45 | Test Acc: 0.9301
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7384
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.6271
Average Test Accuracy: 0.7126
============ Train epoch 48 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-4
client-6 is in G-2
client-7 is in G-2
client-8 is in G-2
client-9 is in G-2
client-10 is in G-1
client-11 is in G-1
client-12 is in G-3
client-13 is in G-3
cnt=[5, 2, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2518 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1957 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2940 | Train Acc: 0.9437
 Site-MNIST     | Train Loss: 0.1901 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1470 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 1.0536 | Train Acc: 0.6667
 Site-USPS      | Train Loss: 0.3241 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2232 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2495 | Train Acc: 0.9247
 Site-USPS      | Train Loss: 0.1849 | Train Acc: 0.9677
 Site-SynthDigits| Train Loss: 0.4911 | Train Acc: 0.8983
 Site-SynthDigits| Train Loss: 0.3607 | Train Acc: 0.9661
 Site-MNIST-M   | Train Loss: 0.6390 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.3902 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.1513 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1814 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2321 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2086 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3465 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2219 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2198 | Val  Acc: 0.9512
 Site-USPS      | Val  Loss: 0.2642 | Val  Acc: 0.9194
 Site-USPS      | Val  Loss: 0.2036 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3372 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.3820 | Val  Acc: 0.9359
 Site-MNIST-M   | Val  Loss: 0.3513 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.4013 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9087
Aggregated Acc | Val Acc: 0.8133
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8900
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3768
 Test site-USPS      | Epoch:45 | Test Acc: 0.9247
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7414
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.6271
Average Test Accuracy: 0.7120
============ Train epoch 49 ============
gmm
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-3
client-6 is in G-1
client-7 is in G-1
client-8 is in G-1
client-9 is in G-1
client-10 is in G-4
client-11 is in G-4
client-12 is in G-2
client-13 is in G-2
cnt=[5, 4, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
sum of wi : 1.0000
 Site-MNIST     | Train Loss: 0.2772 | Train Acc: 0.8696
 Site-MNIST     | Train Loss: 0.1895 | Train Acc: 0.9574
 Site-MNIST     | Train Loss: 0.2559 | Train Acc: 0.9296
 Site-MNIST     | Train Loss: 0.1805 | Train Acc: 0.9787
 Site-MNIST     | Train Loss: 0.1412 | Train Acc: 0.9915
 Site-SVHN      | Train Loss: 0.8650 | Train Acc: 0.5455
 Site-USPS      | Train Loss: 0.3197 | Train Acc: 0.9032
 Site-USPS      | Train Loss: 0.2146 | Train Acc: 0.9516
 Site-USPS      | Train Loss: 0.2471 | Train Acc: 0.9247
 Site-USPS      | Train Loss: 0.1820 | Train Acc: 0.9839
 Site-SynthDigits| Train Loss: 0.4775 | Train Acc: 0.9322
 Site-SynthDigits| Train Loss: 0.3691 | Train Acc: 0.9407
 Site-MNIST-M   | Train Loss: 0.6584 | Train Acc: 0.8636
 Site-MNIST-M   | Train Loss: 0.3742 | Train Acc: 0.9886
 Site-MNIST     | Val  Loss: 0.1466 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1722 | Val  Acc: 0.9677
 Site-MNIST     | Val  Loss: 0.2217 | Val  Acc: 0.9787
 Site-MNIST     | Val  Loss: 0.1767 | Val  Acc: 0.9841
 Site-MNIST     | Val  Loss: 0.2045 | Val  Acc: 0.9620
 Site-SVHN      | Val  Loss: 2.3606 | Val  Acc: 0.2273
 Site-USPS      | Val  Loss: 0.2108 | Val  Acc: 0.9500
 Site-USPS      | Val  Loss: 0.2133 | Val  Acc: 0.9756
 Site-USPS      | Val  Loss: 0.2551 | Val  Acc: 0.9355
 Site-USPS      | Val  Loss: 0.2009 | Val  Acc: 0.9398
 Site-SynthDigits| Val  Loss: 0.3332 | Val  Acc: 0.9231
 Site-SynthDigits| Val  Loss: 0.3745 | Val  Acc: 0.9487
 Site-MNIST-M   | Val  Loss: 0.3438 | Val  Acc: 1.0000
 Site-MNIST-M   | Val  Loss: 0.3935 | Val  Acc: 0.9828
Average Valid Accuracy: 0.9125
Aggregated Acc | Val Acc: 0.8167
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8914
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3713
 Test site-USPS      | Epoch:45 | Test Acc: 0.9355
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7433
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.6221
Average Test Accuracy: 0.7127
===2023-05-02 13:20:15===
===2023-05-02 13:20:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    si: False
    lambda for constrastive: 0.5
data_number=[23,47,71,94,118,33,31,62,93,124,59,118,44,88,]
domain number = 5
Loading snapshots...
 Test site-MNIST     | Epoch:45 | Test Acc: 0.8929
 Test site-SVHN      | Epoch:45 | Test Acc: 0.3864
 Test site-USPS      | Epoch:45 | Test Acc: 0.9301
 Test site-SynthDigits| Epoch:45 | Test Acc: 0.7519
 Test site-MNIST-M   | Epoch:45 | Test Acc: 0.6171
Average Test Accuracy: 0.7157
