===2023-06-09 22:34:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                  | Train Loss: 2.0298 | Train Acc: 0.3631
 Site-Clipart                  | Train Loss: 2.0650 | Train Acc: 0.3369
 Site-Real                     | Train Loss: 2.0388 | Train Acc: 0.4395
 Site-Real                     | Train Loss: 2.0043 | Train Acc: 0.4195
 Site-Painting                 | Train Loss: 2.0085 | Train Acc: 0.4013
 Site-Painting                 | Train Loss: 2.0357 | Train Acc: 0.3602
 Site-Sketch                   | Train Loss: 1.9919 | Train Acc: 0.4204
 Site-Sketch                   | Train Loss: 2.0167 | Train Acc: 0.4089
 Site-QuickDraw                | Train Loss: 2.2743 | Train Acc: 0.1083
 Site-QuickDraw                | Train Loss: 2.2789 | Train Acc: 0.1674
 Site-Infograph                | Train Loss: 2.2222 | Train Acc: 0.2038
 Site-Infograph                | Train Loss: 2.1904 | Train Acc: 0.2225
 Site-Clipart                   (4) | Val  Loss: 2.1321 | Val  Acc: 0.2952
 Site-Clipart                   (4) | Val  Loss: 2.0670 | Val  Acc: 0.3175
 Site-Real                      (5) | Val  Loss: 1.9893 | Val  Acc: 0.4381
 Site-Real                      (5) | Val  Loss: 1.9982 | Val  Acc: 0.3937
 Site-Painting                  (0) | Val  Loss: 1.9589 | Val  Acc: 0.4762
 Site-Painting                  (0) | Val  Loss: 2.0038 | Val  Acc: 0.4159
 Site-Sketch                    (1) | Val  Loss: 2.0652 | Val  Acc: 0.4000
 Site-Sketch                    (1) | Val  Loss: 2.0235 | Val  Acc: 0.4254
 Site-QuickDraw                 (2) | Val  Loss: 2.2678 | Val  Acc: 0.1714
 Site-QuickDraw                 (2) | Val  Loss: 2.2558 | Val  Acc: 0.1619
 Site-Infograph                 (3) | Val  Loss: 2.1799 | Val  Acc: 0.2190
 Site-Infograph                 (3) | Val  Loss: 2.1872 | Val  Acc: 0.2254
Average Valid Accuracy: 0.3283
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.2952
 Best site-Clipart                  (4)  | Epoch:0 | Val Acc: 0.3175
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.4381
 Best site-Real                     (5)  | Epoch:0 | Val Acc: 0.3937
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4762
 Best site-Painting                 (0)  | Epoch:0 | Val Acc: 0.4159
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.4000
 Best site-Sketch                   (1)  | Epoch:0 | Val Acc: 0.4254
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1714
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1619
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2190
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2254
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                  | Train Loss: 1.7107 | Train Acc: 0.5796
 Site-Clipart                  | Train Loss: 1.6982 | Train Acc: 0.5445
 Site-Real                     | Train Loss: 1.6671 | Train Acc: 0.6815
 Site-Real                     | Train Loss: 1.5208 | Train Acc: 0.7119
 Site-Painting                 | Train Loss: 1.6135 | Train Acc: 0.6242
 Site-Painting                 | Train Loss: 1.6052 | Train Acc: 0.6398
 Site-Sketch                   | Train Loss: 1.6685 | Train Acc: 0.6051
 Site-Sketch                   | Train Loss: 1.6305 | Train Acc: 0.5953
 Site-QuickDraw                | Train Loss: 2.1418 | Train Acc: 0.2739
 Site-QuickDraw                | Train Loss: 2.1576 | Train Acc: 0.2860
 Site-Infograph                | Train Loss: 2.0552 | Train Acc: 0.3376
 Site-Infograph                | Train Loss: 1.9755 | Train Acc: 0.3835
 Site-Clipart                   (4) | Val  Loss: 1.7661 | Val  Acc: 0.5524
 Site-Clipart                   (4) | Val  Loss: 1.7332 | Val  Acc: 0.5365
 Site-Real                      (5) | Val  Loss: 1.5584 | Val  Acc: 0.7048
 Site-Real                      (5) | Val  Loss: 1.5429 | Val  Acc: 0.6857
 Site-Painting                  (0) | Val  Loss: 1.5273 | Val  Acc: 0.7238
 Site-Painting                  (0) | Val  Loss: 1.5831 | Val  Acc: 0.6508
 Site-Sketch                    (3) | Val  Loss: 1.6906 | Val  Acc: 0.6190
 Site-Sketch                    (3) | Val  Loss: 1.6406 | Val  Acc: 0.5905
 Site-QuickDraw                 (1) | Val  Loss: 2.1794 | Val  Acc: 0.2762
 Site-QuickDraw                 (1) | Val  Loss: 2.1463 | Val  Acc: 0.3492
 Site-Infograph                 (2) | Val  Loss: 2.0365 | Val  Acc: 0.3143
 Site-Infograph                 (2) | Val  Loss: 1.9846 | Val  Acc: 0.3937
Average Valid Accuracy: 0.5331
 Best site-Clipart                  (4)  | Epoch:1 | Val Acc: 0.5524
 Best site-Clipart                  (4)  | Epoch:1 | Val Acc: 0.5365
 Best site-Real                     (5)  | Epoch:1 | Val Acc: 0.7048
 Best site-Real                     (5)  | Epoch:1 | Val Acc: 0.6857
 Best site-Painting                 (0)  | Epoch:1 | Val Acc: 0.7238
 Best site-Painting                 (0)  | Epoch:1 | Val Acc: 0.6508
 Best site-Sketch                   (3)  | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch                   (3)  | Epoch:1 | Val Acc: 0.5905
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.2762
 Best site-QuickDraw                (1)  | Epoch:1 | Val Acc: 0.3492
 Best site-Infograph                (2)  | Epoch:1 | Val Acc: 0.3143
 Best site-Infograph                (2)  | Epoch:1 | Val Acc: 0.3937
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                  | Train Loss: 1.4605 | Train Acc: 0.6815
 Site-Clipart                  | Train Loss: 1.4255 | Train Acc: 0.6758
 Site-Real                     | Train Loss: 1.2513 | Train Acc: 0.7898
 Site-Real                     | Train Loss: 1.1360 | Train Acc: 0.8369
 Site-Painting                 | Train Loss: 1.2892 | Train Acc: 0.7261
 Site-Painting                 | Train Loss: 1.2543 | Train Acc: 0.7606
 Site-Sketch                   | Train Loss: 1.3110 | Train Acc: 0.7006
 Site-Sketch                   | Train Loss: 1.3277 | Train Acc: 0.6695
 Site-QuickDraw                | Train Loss: 2.0166 | Train Acc: 0.3312
 Site-QuickDraw                | Train Loss: 2.0265 | Train Acc: 0.3708
 Site-Infograph                | Train Loss: 1.9003 | Train Acc: 0.4331
 Site-Infograph                | Train Loss: 1.7864 | Train Acc: 0.4661
 Site-Clipart                   (2) | Val  Loss: 1.5051 | Val  Acc: 0.6571
 Site-Clipart                   (2) | Val  Loss: 1.4629 | Val  Acc: 0.6635
 Site-Real                      (0) | Val  Loss: 1.1636 | Val  Acc: 0.7714
 Site-Real                      (0) | Val  Loss: 1.1426 | Val  Acc: 0.8222
 Site-Painting                  (5) | Val  Loss: 1.1382 | Val  Acc: 0.8000
 Site-Painting                  (5) | Val  Loss: 1.2644 | Val  Acc: 0.7683
 Site-Sketch                    (4) | Val  Loss: 1.3668 | Val  Acc: 0.6667
 Site-Sketch                    (4) | Val  Loss: 1.3275 | Val  Acc: 0.6889
 Site-QuickDraw                 (1) | Val  Loss: 2.0647 | Val  Acc: 0.2857
 Site-QuickDraw                 (1) | Val  Loss: 2.0078 | Val  Acc: 0.4032
 Site-Infograph                 (3) | Val  Loss: 1.9180 | Val  Acc: 0.4000
 Site-Infograph                 (3) | Val  Loss: 1.8125 | Val  Acc: 0.4286
Average Valid Accuracy: 0.6130
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6571
 Best site-Clipart                  (2)  | Epoch:2 | Val Acc: 0.6635
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.7714
 Best site-Real                     (0)  | Epoch:2 | Val Acc: 0.8222
 Best site-Painting                 (5)  | Epoch:2 | Val Acc: 0.8000
 Best site-Painting                 (5)  | Epoch:2 | Val Acc: 0.7683
 Best site-Sketch                   (4)  | Epoch:2 | Val Acc: 0.6667
 Best site-Sketch                   (4)  | Epoch:2 | Val Acc: 0.6889
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.2857
 Best site-QuickDraw                (1)  | Epoch:2 | Val Acc: 0.4032
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.4000
 Best site-Infograph                (3)  | Epoch:2 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                  | Train Loss: 1.2114 | Train Acc: 0.7197
 Site-Clipart                  | Train Loss: 1.1800 | Train Acc: 0.7521
 Site-Real                     | Train Loss: 1.0136 | Train Acc: 0.8471
 Site-Real                     | Train Loss: 0.8915 | Train Acc: 0.8686
 Site-Painting                 | Train Loss: 1.0431 | Train Acc: 0.7580
 Site-Painting                 | Train Loss: 1.0157 | Train Acc: 0.7924
 Site-Sketch                   | Train Loss: 1.0657 | Train Acc: 0.7643
 Site-Sketch                   | Train Loss: 1.0777 | Train Acc: 0.7331
 Site-QuickDraw                | Train Loss: 1.8158 | Train Acc: 0.4713
 Site-QuickDraw                | Train Loss: 1.8596 | Train Acc: 0.4153
 Site-Infograph                | Train Loss: 1.7757 | Train Acc: 0.4140
 Site-Infograph                | Train Loss: 1.6651 | Train Acc: 0.4915
 Site-Clipart                   (2) | Val  Loss: 1.2698 | Val  Acc: 0.7143
 Site-Clipart                   (2) | Val  Loss: 1.2137 | Val  Acc: 0.7333
 Site-Real                      (0) | Val  Loss: 0.9266 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.8817 | Val  Acc: 0.8825
 Site-Painting                  (5) | Val  Loss: 0.9332 | Val  Acc: 0.8190
 Site-Painting                  (5) | Val  Loss: 0.9974 | Val  Acc: 0.8127
 Site-Sketch                    (4) | Val  Loss: 1.0645 | Val  Acc: 0.7429
 Site-Sketch                    (4) | Val  Loss: 1.1078 | Val  Acc: 0.7587
 Site-QuickDraw                 (1) | Val  Loss: 1.8660 | Val  Acc: 0.3810
 Site-QuickDraw                 (1) | Val  Loss: 1.8557 | Val  Acc: 0.4349
 Site-Infograph                 (3) | Val  Loss: 1.7073 | Val  Acc: 0.4857
 Site-Infograph                 (3) | Val  Loss: 1.6769 | Val  Acc: 0.4825
Average Valid Accuracy: 0.6754
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.7143
 Best site-Clipart                  (2)  | Epoch:3 | Val Acc: 0.7333
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8571
 Best site-Real                     (0)  | Epoch:3 | Val Acc: 0.8825
 Best site-Painting                 (5)  | Epoch:3 | Val Acc: 0.8190
 Best site-Painting                 (5)  | Epoch:3 | Val Acc: 0.8127
 Best site-Sketch                   (4)  | Epoch:3 | Val Acc: 0.7429
 Best site-Sketch                   (4)  | Epoch:3 | Val Acc: 0.7587
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.3810
 Best site-QuickDraw                (1)  | Epoch:3 | Val Acc: 0.4349
 Best site-Infograph                (3)  | Epoch:3 | Val Acc: 0.4857
 Best site-Infograph                (3)  | Epoch:3 | Val Acc: 0.4825
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                  | Train Loss: 1.0908 | Train Acc: 0.7389
 Site-Clipart                  | Train Loss: 1.0173 | Train Acc: 0.7648
 Site-Real                     | Train Loss: 0.8466 | Train Acc: 0.8535
 Site-Real                     | Train Loss: 0.7482 | Train Acc: 0.8983
 Site-Painting                 | Train Loss: 0.9024 | Train Acc: 0.8153
 Site-Painting                 | Train Loss: 0.8589 | Train Acc: 0.8305
 Site-Sketch                   | Train Loss: 0.9333 | Train Acc: 0.7771
 Site-Sketch                   | Train Loss: 0.9727 | Train Acc: 0.7500
 Site-QuickDraw                | Train Loss: 1.6848 | Train Acc: 0.5223
 Site-QuickDraw                | Train Loss: 1.6472 | Train Acc: 0.5275
 Site-Infograph                | Train Loss: 1.6850 | Train Acc: 0.4459
 Site-Infograph                | Train Loss: 1.5300 | Train Acc: 0.5360
 Site-Clipart                   (0) | Val  Loss: 1.1470 | Val  Acc: 0.7143
 Site-Clipart                   (0) | Val  Loss: 1.0659 | Val  Acc: 0.7460
 Site-Real                      (3) | Val  Loss: 0.8010 | Val  Acc: 0.8286
 Site-Real                      (3) | Val  Loss: 0.7535 | Val  Acc: 0.9016
 Site-Painting                  (5) | Val  Loss: 0.7654 | Val  Acc: 0.8667
 Site-Painting                  (5) | Val  Loss: 0.8478 | Val  Acc: 0.8349
 Site-Sketch                    (4) | Val  Loss: 0.9643 | Val  Acc: 0.7238
 Site-Sketch                    (4) | Val  Loss: 0.9371 | Val  Acc: 0.7587
 Site-QuickDraw                 (1) | Val  Loss: 1.6727 | Val  Acc: 0.4571
 Site-QuickDraw                 (1) | Val  Loss: 1.6611 | Val  Acc: 0.5079
 Site-Infograph                 (2) | Val  Loss: 1.6537 | Val  Acc: 0.4667
 Site-Infograph                 (2) | Val  Loss: 1.5868 | Val  Acc: 0.4921
Average Valid Accuracy: 0.6915
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7460
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.8286
 Best site-Real                     (3)  | Epoch:4 | Val Acc: 0.9016
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.8667
 Best site-Painting                 (5)  | Epoch:4 | Val Acc: 0.8349
 Best site-Sketch                   (4)  | Epoch:4 | Val Acc: 0.7238
 Best site-Sketch                   (4)  | Epoch:4 | Val Acc: 0.7587
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.4571
 Best site-QuickDraw                (1)  | Epoch:4 | Val Acc: 0.5079
 Best site-Infograph                (2)  | Epoch:4 | Val Acc: 0.4667
 Best site-Infograph                (2)  | Epoch:4 | Val Acc: 0.4921
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                  | Train Loss: 0.8835 | Train Acc: 0.8025
 Site-Clipart                  | Train Loss: 0.8990 | Train Acc: 0.7881
 Site-Real                     | Train Loss: 0.7160 | Train Acc: 0.8535
 Site-Real                     | Train Loss: 0.6280 | Train Acc: 0.9216
 Site-Painting                 | Train Loss: 0.8077 | Train Acc: 0.8280
 Site-Painting                 | Train Loss: 0.7785 | Train Acc: 0.8284
 Site-Sketch                   | Train Loss: 0.7568 | Train Acc: 0.8280
 Site-Sketch                   | Train Loss: 0.8322 | Train Acc: 0.7860
 Site-QuickDraw                | Train Loss: 1.5594 | Train Acc: 0.5605
 Site-QuickDraw                | Train Loss: 1.5368 | Train Acc: 0.5360
 Site-Infograph                | Train Loss: 1.5304 | Train Acc: 0.5032
 Site-Infograph                | Train Loss: 1.4689 | Train Acc: 0.5169
 Site-Clipart                   (4) | Val  Loss: 0.9849 | Val  Acc: 0.7619
 Site-Clipart                   (4) | Val  Loss: 0.9418 | Val  Acc: 0.7810
 Site-Real                      (0) | Val  Loss: 0.6753 | Val  Acc: 0.8571
 Site-Real                      (0) | Val  Loss: 0.6348 | Val  Acc: 0.9048
 Site-Painting                  (5) | Val  Loss: 0.6791 | Val  Acc: 0.8476
 Site-Painting                  (5) | Val  Loss: 0.7438 | Val  Acc: 0.8540
 Site-Sketch                    (3) | Val  Loss: 0.8680 | Val  Acc: 0.7810
 Site-Sketch                    (3) | Val  Loss: 0.8428 | Val  Acc: 0.7619
 Site-QuickDraw                 (1) | Val  Loss: 1.5944 | Val  Acc: 0.5048
 Site-QuickDraw                 (1) | Val  Loss: 1.5047 | Val  Acc: 0.5778
 Site-Infograph                 (2) | Val  Loss: 1.5061 | Val  Acc: 0.5619
 Site-Infograph                 (2) | Val  Loss: 1.5128 | Val  Acc: 0.5270
Average Valid Accuracy: 0.7267
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7619
 Best site-Clipart                  (4)  | Epoch:5 | Val Acc: 0.7810
 Best site-Real                     (0)  | Epoch:5 | Val Acc: 0.8571
 Best site-Real                     (0)  | Epoch:5 | Val Acc: 0.9048
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8476
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8540
 Best site-Sketch                   (3)  | Epoch:5 | Val Acc: 0.7810
 Best site-Sketch                   (3)  | Epoch:5 | Val Acc: 0.7619
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.5048
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.5778
 Best site-Infograph                (2)  | Epoch:5 | Val Acc: 0.5619
 Best site-Infograph                (2)  | Epoch:5 | Val Acc: 0.5270
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                  | Train Loss: 0.8605 | Train Acc: 0.7898
 Site-Clipart                  | Train Loss: 0.8287 | Train Acc: 0.7966
 Site-Real                     | Train Loss: 0.6478 | Train Acc: 0.8917
 Site-Real                     | Train Loss: 0.5357 | Train Acc: 0.9153
 Site-Painting                 | Train Loss: 0.7412 | Train Acc: 0.8408
 Site-Painting                 | Train Loss: 0.7137 | Train Acc: 0.8496
 Site-Sketch                   | Train Loss: 0.7440 | Train Acc: 0.8153
 Site-Sketch                   | Train Loss: 0.8002 | Train Acc: 0.7797
 Site-QuickDraw                | Train Loss: 1.3261 | Train Acc: 0.5987
 Site-QuickDraw                | Train Loss: 1.4070 | Train Acc: 0.5953
 Site-Infograph                | Train Loss: 1.5354 | Train Acc: 0.5350
 Site-Infograph                | Train Loss: 1.3968 | Train Acc: 0.5699
 Site-Clipart                   (4) | Val  Loss: 0.9287 | Val  Acc: 0.7238
 Site-Clipart                   (4) | Val  Loss: 0.8674 | Val  Acc: 0.7873
 Site-Real                      (5) | Val  Loss: 0.5945 | Val  Acc: 0.8667
 Site-Real                      (5) | Val  Loss: 0.5518 | Val  Acc: 0.9016
 Site-Painting                  (1) | Val  Loss: 0.6297 | Val  Acc: 0.8667
 Site-Painting                  (1) | Val  Loss: 0.6893 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.7758 | Val  Acc: 0.7905
 Site-Sketch                    (3) | Val  Loss: 0.7977 | Val  Acc: 0.7714
 Site-QuickDraw                 (0) | Val  Loss: 1.4305 | Val  Acc: 0.5905
 Site-QuickDraw                 (0) | Val  Loss: 1.3867 | Val  Acc: 0.6190
 Site-Infograph                 (2) | Val  Loss: 1.4956 | Val  Acc: 0.5143
 Site-Infograph                 (2) | Val  Loss: 1.4722 | Val  Acc: 0.5460
Average Valid Accuracy: 0.7362
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7238
 Best site-Clipart                  (4)  | Epoch:6 | Val Acc: 0.7873
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.8667
 Best site-Real                     (5)  | Epoch:6 | Val Acc: 0.9016
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8667
 Best site-Painting                 (1)  | Epoch:6 | Val Acc: 0.8571
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.7905
 Best site-Sketch                   (3)  | Epoch:6 | Val Acc: 0.7714
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.5905
 Best site-QuickDraw                (0)  | Epoch:6 | Val Acc: 0.6190
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.5143
 Best site-Infograph                (2)  | Epoch:6 | Val Acc: 0.5460
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                  | Train Loss: 0.8001 | Train Acc: 0.8025
 Site-Clipart                  | Train Loss: 0.7564 | Train Acc: 0.8114
 Site-Real                     | Train Loss: 0.5962 | Train Acc: 0.9108
 Site-Real                     | Train Loss: 0.4668 | Train Acc: 0.9343
 Site-Painting                 | Train Loss: 0.6634 | Train Acc: 0.8471
 Site-Painting                 | Train Loss: 0.6579 | Train Acc: 0.8581
 Site-Sketch                   | Train Loss: 0.6176 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.7295 | Train Acc: 0.8008
 Site-QuickDraw                | Train Loss: 1.2739 | Train Acc: 0.6624
 Site-QuickDraw                | Train Loss: 1.3231 | Train Acc: 0.6335
 Site-Infograph                | Train Loss: 1.4615 | Train Acc: 0.5287
 Site-Infograph                | Train Loss: 1.3378 | Train Acc: 0.5720
 Site-Clipart                   (5) | Val  Loss: 0.8051 | Val  Acc: 0.7810
 Site-Clipart                   (5) | Val  Loss: 0.7979 | Val  Acc: 0.7905
 Site-Real                      (4) | Val  Loss: 0.5710 | Val  Acc: 0.8762
 Site-Real                      (4) | Val  Loss: 0.4927 | Val  Acc: 0.9175
 Site-Painting                  (2) | Val  Loss: 0.5418 | Val  Acc: 0.8857
 Site-Painting                  (2) | Val  Loss: 0.6377 | Val  Acc: 0.8476
 Site-Sketch                    (0) | Val  Loss: 0.7768 | Val  Acc: 0.7905
 Site-Sketch                    (0) | Val  Loss: 0.7160 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 1.3956 | Val  Acc: 0.5619
 Site-QuickDraw                 (1) | Val  Loss: 1.2995 | Val  Acc: 0.6476
 Site-Infograph                 (3) | Val  Loss: 1.4939 | Val  Acc: 0.5238
 Site-Infograph                 (3) | Val  Loss: 1.3902 | Val  Acc: 0.5429
Average Valid Accuracy: 0.7487
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.7810
 Best site-Clipart                  (5)  | Epoch:7 | Val Acc: 0.7905
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.8762
 Best site-Real                     (4)  | Epoch:7 | Val Acc: 0.9175
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8857
 Best site-Painting                 (2)  | Epoch:7 | Val Acc: 0.8476
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.7905
 Best site-Sketch                   (0)  | Epoch:7 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.5619
 Best site-QuickDraw                (1)  | Epoch:7 | Val Acc: 0.6476
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5238
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.5429
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                  | Train Loss: 0.7014 | Train Acc: 0.8217
 Site-Clipart                  | Train Loss: 0.7280 | Train Acc: 0.8284
 Site-Real                     | Train Loss: 0.5994 | Train Acc: 0.8981
 Site-Real                     | Train Loss: 0.4382 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.6180 | Train Acc: 0.8471
 Site-Painting                 | Train Loss: 0.6243 | Train Acc: 0.8538
 Site-Sketch                   | Train Loss: 0.6602 | Train Acc: 0.8408
 Site-Sketch                   | Train Loss: 0.7354 | Train Acc: 0.7987
 Site-QuickDraw                | Train Loss: 1.2349 | Train Acc: 0.6306
 Site-QuickDraw                | Train Loss: 1.2165 | Train Acc: 0.6610
 Site-Infograph                | Train Loss: 1.5124 | Train Acc: 0.5541
 Site-Infograph                | Train Loss: 1.2787 | Train Acc: 0.5890
 Site-Clipart                   (0) | Val  Loss: 0.7712 | Val  Acc: 0.7810
 Site-Clipart                   (0) | Val  Loss: 0.7338 | Val  Acc: 0.8000
 Site-Real                      (5) | Val  Loss: 0.5049 | Val  Acc: 0.8762
 Site-Real                      (5) | Val  Loss: 0.4727 | Val  Acc: 0.9079
 Site-Painting                  (2) | Val  Loss: 0.5121 | Val  Acc: 0.9143
 Site-Painting                  (2) | Val  Loss: 0.5908 | Val  Acc: 0.8730
 Site-Sketch                    (4) | Val  Loss: 0.7903 | Val  Acc: 0.7524
 Site-Sketch                    (4) | Val  Loss: 0.6904 | Val  Acc: 0.8063
 Site-QuickDraw                 (1) | Val  Loss: 1.2941 | Val  Acc: 0.5905
 Site-QuickDraw                 (1) | Val  Loss: 1.2193 | Val  Acc: 0.6571
 Site-Infograph                 (3) | Val  Loss: 1.3973 | Val  Acc: 0.5524
 Site-Infograph                 (3) | Val  Loss: 1.3322 | Val  Acc: 0.5778
Average Valid Accuracy: 0.7574
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.7810
 Best site-Clipart                  (0)  | Epoch:8 | Val Acc: 0.8000
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.8762
 Best site-Real                     (5)  | Epoch:8 | Val Acc: 0.9079
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.9143
 Best site-Painting                 (2)  | Epoch:8 | Val Acc: 0.8730
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.7524
 Best site-Sketch                   (4)  | Epoch:8 | Val Acc: 0.8063
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.5905
 Best site-QuickDraw                (1)  | Epoch:8 | Val Acc: 0.6571
 Best site-Infograph                (3)  | Epoch:8 | Val Acc: 0.5524
 Best site-Infograph                (3)  | Epoch:8 | Val Acc: 0.5778
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                  | Train Loss: 0.6852 | Train Acc: 0.8089
 Site-Clipart                  | Train Loss: 0.6619 | Train Acc: 0.8242
 Site-Real                     | Train Loss: 0.5054 | Train Acc: 0.8854
 Site-Real                     | Train Loss: 0.4207 | Train Acc: 0.9301
 Site-Painting                 | Train Loss: 0.5827 | Train Acc: 0.8217
 Site-Painting                 | Train Loss: 0.5619 | Train Acc: 0.8665
 Site-Sketch                   | Train Loss: 0.5960 | Train Acc: 0.8280
 Site-Sketch                   | Train Loss: 0.6805 | Train Acc: 0.8072
 Site-QuickDraw                | Train Loss: 1.1641 | Train Acc: 0.6369
 Site-QuickDraw                | Train Loss: 1.1667 | Train Acc: 0.6758
 Site-Infograph                | Train Loss: 1.3920 | Train Acc: 0.5414
 Site-Infograph                | Train Loss: 1.2546 | Train Acc: 0.5890
 Site-Clipart                   (4) | Val  Loss: 0.7537 | Val  Acc: 0.8095
 Site-Clipart                   (4) | Val  Loss: 0.7339 | Val  Acc: 0.7873
 Site-Real                      (1) | Val  Loss: 0.4812 | Val  Acc: 0.8952
 Site-Real                      (1) | Val  Loss: 0.4439 | Val  Acc: 0.9175
 Site-Painting                  (5) | Val  Loss: 0.4691 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.5328 | Val  Acc: 0.8952
 Site-Sketch                    (0) | Val  Loss: 0.6682 | Val  Acc: 0.7905
 Site-Sketch                    (0) | Val  Loss: 0.6843 | Val  Acc: 0.8000
 Site-QuickDraw                 (2) | Val  Loss: 1.1559 | Val  Acc: 0.6952
 Site-QuickDraw                 (2) | Val  Loss: 1.1690 | Val  Acc: 0.6762
 Site-Infograph                 (3) | Val  Loss: 1.3015 | Val  Acc: 0.5524
 Site-Infograph                 (3) | Val  Loss: 1.3326 | Val  Acc: 0.5556
Average Valid Accuracy: 0.7757
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.8095
 Best site-Clipart                  (4)  | Epoch:9 | Val Acc: 0.7873
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.8952
 Best site-Real                     (1)  | Epoch:9 | Val Acc: 0.9175
 Best site-Painting                 (5)  | Epoch:9 | Val Acc: 0.9333
 Best site-Painting                 (5)  | Epoch:9 | Val Acc: 0.8952
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7905
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-QuickDraw                (2)  | Epoch:9 | Val Acc: 0.6952
 Best site-QuickDraw                (2)  | Epoch:9 | Val Acc: 0.6762
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.5524
 Best site-Infograph                (3)  | Epoch:9 | Val Acc: 0.5556
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
 Test site-Clipart                   (4)| Epoch:9 | Test Acc: 0.8023
 Test site-Real                      (1)| Epoch:9 | Test Acc: 0.9351
 Test site-Painting                  (5)| Epoch:9 | Test Acc: 0.9015
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.8394
 Test site-QuickDraw                 (2)| Epoch:9 | Test Acc: 0.6850
 Test site-Infograph                 (3)| Epoch:9 | Test Acc: 0.5616
Clipart: 0.8023, Real: 0.9351, Painting: 0.9015, Sketch: 0.8394, QuickDraw: 0.6850, Infograph: 0.5616, 
Average Test Accuracy(group): 0.7875, Average Test Accuracy(individual): 0.7875,
domain CV=0.1633, cluster CV=0.1633, individual CV=0.1633, 
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                  | Train Loss: 0.6195 | Train Acc: 0.8599
 Site-Clipart                  | Train Loss: 0.6545 | Train Acc: 0.8051
 Site-Real                     | Train Loss: 0.4805 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.3788 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.5670 | Train Acc: 0.8535
 Site-Painting                 | Train Loss: 0.5397 | Train Acc: 0.8644
 Site-Sketch                   | Train Loss: 0.5708 | Train Acc: 0.8662
 Site-Sketch                   | Train Loss: 0.6312 | Train Acc: 0.8199
 Site-QuickDraw                | Train Loss: 1.1467 | Train Acc: 0.6624
 Site-QuickDraw                | Train Loss: 1.1138 | Train Acc: 0.6737
 Site-Infograph                | Train Loss: 1.4171 | Train Acc: 0.5541
 Site-Infograph                | Train Loss: 1.2254 | Train Acc: 0.5911
 Site-Clipart                   (1) | Val  Loss: 0.7302 | Val  Acc: 0.7619
 Site-Clipart                   (1) | Val  Loss: 0.7072 | Val  Acc: 0.8000
 Site-Real                      (5) | Val  Loss: 0.4290 | Val  Acc: 0.9238
 Site-Real                      (5) | Val  Loss: 0.3726 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.3997 | Val  Acc: 0.9048
 Site-Painting                  (4) | Val  Loss: 0.5215 | Val  Acc: 0.8825
 Site-Sketch                    (3) | Val  Loss: 0.5926 | Val  Acc: 0.8190
 Site-Sketch                    (3) | Val  Loss: 0.6418 | Val  Acc: 0.8190
 Site-QuickDraw                 (2) | Val  Loss: 1.1472 | Val  Acc: 0.6381
 Site-QuickDraw                 (2) | Val  Loss: 1.0884 | Val  Acc: 0.7016
 Site-Infograph                 (0) | Val  Loss: 1.4018 | Val  Acc: 0.5333
 Site-Infograph                 (0) | Val  Loss: 1.2670 | Val  Acc: 0.5810
Average Valid Accuracy: 0.7765
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.7619
 Best site-Clipart                  (1)  | Epoch:10 | Val Acc: 0.8000
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9238
 Best site-Real                     (5)  | Epoch:10 | Val Acc: 0.9524
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.9048
 Best site-Painting                 (4)  | Epoch:10 | Val Acc: 0.8825
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8190
 Best site-Sketch                   (3)  | Epoch:10 | Val Acc: 0.8190
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.6381
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.7016
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.5333
 Best site-Infograph                (0)  | Epoch:10 | Val Acc: 0.5810
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                  | Train Loss: 0.6328 | Train Acc: 0.8535
 Site-Clipart                  | Train Loss: 0.6140 | Train Acc: 0.8432
 Site-Real                     | Train Loss: 0.4709 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.3757 | Train Acc: 0.9343
 Site-Painting                 | Train Loss: 0.5620 | Train Acc: 0.8408
 Site-Painting                 | Train Loss: 0.5067 | Train Acc: 0.8644
 Site-Sketch                   | Train Loss: 0.5717 | Train Acc: 0.8344
 Site-Sketch                   | Train Loss: 0.5855 | Train Acc: 0.8051
 Site-QuickDraw                | Train Loss: 1.0635 | Train Acc: 0.6943
 Site-QuickDraw                | Train Loss: 1.0707 | Train Acc: 0.6949
 Site-Infograph                | Train Loss: 1.3428 | Train Acc: 0.5860
 Site-Infograph                | Train Loss: 1.1859 | Train Acc: 0.6208
 Site-Clipart                   (3) | Val  Loss: 0.6242 | Val  Acc: 0.8381
 Site-Clipart                   (3) | Val  Loss: 0.6504 | Val  Acc: 0.8159
 Site-Real                      (0) | Val  Loss: 0.4278 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.3786 | Val  Acc: 0.9397
 Site-Painting                  (5) | Val  Loss: 0.4268 | Val  Acc: 0.8952
 Site-Painting                  (5) | Val  Loss: 0.4931 | Val  Acc: 0.8921
 Site-Sketch                    (4) | Val  Loss: 0.6388 | Val  Acc: 0.8286
 Site-Sketch                    (4) | Val  Loss: 0.5852 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 1.0699 | Val  Acc: 0.6857
 Site-QuickDraw                 (1) | Val  Loss: 1.0569 | Val  Acc: 0.7016
 Site-Infograph                 (2) | Val  Loss: 1.2655 | Val  Acc: 0.5810
 Site-Infograph                 (2) | Val  Loss: 1.2388 | Val  Acc: 0.6032
Average Valid Accuracy: 0.7952
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8381
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8159
 Best site-Real                     (0)  | Epoch:11 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:11 | Val Acc: 0.9397
 Best site-Painting                 (5)  | Epoch:11 | Val Acc: 0.8952
 Best site-Painting                 (5)  | Epoch:11 | Val Acc: 0.8921
 Best site-Sketch                   (4)  | Epoch:11 | Val Acc: 0.8286
 Best site-Sketch                   (4)  | Epoch:11 | Val Acc: 0.8286
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.6857
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.7016
 Best site-Infograph                (2)  | Epoch:11 | Val Acc: 0.5810
 Best site-Infograph                (2)  | Epoch:11 | Val Acc: 0.6032
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                  | Train Loss: 0.6439 | Train Acc: 0.8408
 Site-Clipart                  | Train Loss: 0.6097 | Train Acc: 0.8305
 Site-Real                     | Train Loss: 0.4192 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.3413 | Train Acc: 0.9322
 Site-Painting                 | Train Loss: 0.5056 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.4727 | Train Acc: 0.8771
 Site-Sketch                   | Train Loss: 0.5569 | Train Acc: 0.8217
 Site-Sketch                   | Train Loss: 0.5991 | Train Acc: 0.8114
 Site-QuickDraw                | Train Loss: 1.0193 | Train Acc: 0.6815
 Site-QuickDraw                | Train Loss: 1.0537 | Train Acc: 0.7013
 Site-Infograph                | Train Loss: 1.3415 | Train Acc: 0.5860
 Site-Infograph                | Train Loss: 1.1456 | Train Acc: 0.6335
 Site-Clipart                   (4) | Val  Loss: 0.6174 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.6681 | Val  Acc: 0.8190
 Site-Real                      (5) | Val  Loss: 0.3835 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.3723 | Val  Acc: 0.9333
 Site-Painting                  (3) | Val  Loss: 0.3632 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.4580 | Val  Acc: 0.8984
 Site-Sketch                    (0) | Val  Loss: 0.5401 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.5884 | Val  Acc: 0.8254
 Site-QuickDraw                 (1) | Val  Loss: 1.1418 | Val  Acc: 0.6571
 Site-QuickDraw                 (1) | Val  Loss: 1.0259 | Val  Acc: 0.7143
 Site-Infograph                 (2) | Val  Loss: 1.2443 | Val  Acc: 0.6095
 Site-Infograph                 (2) | Val  Loss: 1.2125 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8032
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8476
 Best site-Clipart                  (4)  | Epoch:12 | Val Acc: 0.8190
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9143
 Best site-Real                     (5)  | Epoch:12 | Val Acc: 0.9333
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.9143
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8984
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8762
 Best site-Sketch                   (0)  | Epoch:12 | Val Acc: 0.8254
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.6571
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.7143
 Best site-Infograph                (2)  | Epoch:12 | Val Acc: 0.6095
 Best site-Infograph                (2)  | Epoch:12 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                  | Train Loss: 0.6160 | Train Acc: 0.8599
 Site-Clipart                  | Train Loss: 0.5644 | Train Acc: 0.8644
 Site-Real                     | Train Loss: 0.4194 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.3327 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.5033 | Train Acc: 0.8599
 Site-Painting                 | Train Loss: 0.4796 | Train Acc: 0.8814
 Site-Sketch                   | Train Loss: 0.5220 | Train Acc: 0.8726
 Site-Sketch                   | Train Loss: 0.5945 | Train Acc: 0.8369
 Site-QuickDraw                | Train Loss: 0.9998 | Train Acc: 0.6943
 Site-QuickDraw                | Train Loss: 0.9576 | Train Acc: 0.7225
 Site-Infograph                | Train Loss: 1.3347 | Train Acc: 0.5669
 Site-Infograph                | Train Loss: 1.1287 | Train Acc: 0.6314
 Site-Clipart                   (4) | Val  Loss: 0.5741 | Val  Acc: 0.8476
 Site-Clipart                   (4) | Val  Loss: 0.6268 | Val  Acc: 0.8190
 Site-Real                      (5) | Val  Loss: 0.3997 | Val  Acc: 0.9333
 Site-Real                      (5) | Val  Loss: 0.3605 | Val  Acc: 0.9302
 Site-Painting                  (0) | Val  Loss: 0.4083 | Val  Acc: 0.8952
 Site-Painting                  (0) | Val  Loss: 0.4458 | Val  Acc: 0.9079
 Site-Sketch                    (3) | Val  Loss: 0.5729 | Val  Acc: 0.8286
 Site-Sketch                    (3) | Val  Loss: 0.5712 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.9896 | Val  Acc: 0.7333
 Site-QuickDraw                 (1) | Val  Loss: 0.9863 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 1.2692 | Val  Acc: 0.6000
 Site-Infograph                 (2) | Val  Loss: 1.2128 | Val  Acc: 0.5905
Average Valid Accuracy: 0.8032
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                  | Train Loss: 0.6518 | Train Acc: 0.8535
 Site-Clipart                  | Train Loss: 0.5623 | Train Acc: 0.8475
 Site-Real                     | Train Loss: 0.4268 | Train Acc: 0.9236
 Site-Real                     | Train Loss: 0.3421 | Train Acc: 0.9301
 Site-Painting                 | Train Loss: 0.4613 | Train Acc: 0.8726
 Site-Painting                 | Train Loss: 0.4850 | Train Acc: 0.8686
 Site-Sketch                   | Train Loss: 0.5187 | Train Acc: 0.8599
 Site-Sketch                   | Train Loss: 0.5848 | Train Acc: 0.8284
 Site-QuickDraw                | Train Loss: 0.9800 | Train Acc: 0.7070
 Site-QuickDraw                | Train Loss: 0.9383 | Train Acc: 0.7436
 Site-Infograph                | Train Loss: 1.2901 | Train Acc: 0.5669
 Site-Infograph                | Train Loss: 1.0813 | Train Acc: 0.6547
 Site-Clipart                   (3) | Val  Loss: 0.5944 | Val  Acc: 0.8667
 Site-Clipart                   (3) | Val  Loss: 0.6326 | Val  Acc: 0.8190
 Site-Real                      (0) | Val  Loss: 0.3920 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.3181 | Val  Acc: 0.9429
 Site-Painting                  (4) | Val  Loss: 0.3658 | Val  Acc: 0.8857
 Site-Painting                  (4) | Val  Loss: 0.4525 | Val  Acc: 0.8921
 Site-Sketch                    (5) | Val  Loss: 0.5965 | Val  Acc: 0.8000
 Site-Sketch                    (5) | Val  Loss: 0.5564 | Val  Acc: 0.8317
 Site-QuickDraw                 (1) | Val  Loss: 1.0180 | Val  Acc: 0.6857
 Site-QuickDraw                 (1) | Val  Loss: 0.9207 | Val  Acc: 0.7492
 Site-Infograph                 (2) | Val  Loss: 1.2128 | Val  Acc: 0.5714
 Site-Infograph                 (2) | Val  Loss: 1.1801 | Val  Acc: 0.6190
Average Valid Accuracy: 0.7974
============ Train epoch 15 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                  | Train Loss: 0.6245 | Train Acc: 0.8217
 Site-Clipart                  | Train Loss: 0.5332 | Train Acc: 0.8517
 Site-Real                     | Train Loss: 0.4149 | Train Acc: 0.9108
 Site-Real                     | Train Loss: 0.3044 | Train Acc: 0.9364
 Site-Painting                 | Train Loss: 0.5315 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.4592 | Train Acc: 0.8941
 Site-Sketch                   | Train Loss: 0.4861 | Train Acc: 0.8408
 Site-Sketch                   | Train Loss: 0.5901 | Train Acc: 0.8263
 Site-QuickDraw                | Train Loss: 0.9209 | Train Acc: 0.7325
 Site-QuickDraw                | Train Loss: 0.8965 | Train Acc: 0.7669
 Site-Infograph                | Train Loss: 1.2723 | Train Acc: 0.5732
 Site-Infograph                | Train Loss: 1.1175 | Train Acc: 0.6462
 Site-Clipart                   (0) | Val  Loss: 0.5657 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.6044 | Val  Acc: 0.8159
 Site-Real                      (3) | Val  Loss: 0.3957 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.3165 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.3437 | Val  Acc: 0.8952
 Site-Painting                  (5) | Val  Loss: 0.4491 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.5506 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.5530 | Val  Acc: 0.8190
 Site-QuickDraw                 (1) | Val  Loss: 0.9745 | Val  Acc: 0.7524
 Site-QuickDraw                 (1) | Val  Loss: 0.8963 | Val  Acc: 0.7587
 Site-Infograph                 (2) | Val  Loss: 1.2116 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.1577 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8140
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:15 | Val Acc: 0.8159
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:15 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.8952
 Best site-Painting                 (5)  | Epoch:15 | Val Acc: 0.8698
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8571
 Best site-Sketch                   (4)  | Epoch:15 | Val Acc: 0.8190
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7524
 Best site-QuickDraw                (1)  | Epoch:15 | Val Acc: 0.7587
 Best site-Infograph                (2)  | Epoch:15 | Val Acc: 0.6476
 Best site-Infograph                (2)  | Epoch:15 | Val Acc: 0.6381
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                  | Train Loss: 0.5617 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.5579 | Train Acc: 0.8538
 Site-Real                     | Train Loss: 0.3885 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.3117 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.5144 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.4368 | Train Acc: 0.8877
 Site-Sketch                   | Train Loss: 0.4760 | Train Acc: 0.8854
 Site-Sketch                   | Train Loss: 0.5243 | Train Acc: 0.8326
 Site-QuickDraw                | Train Loss: 0.8613 | Train Acc: 0.7771
 Site-QuickDraw                | Train Loss: 0.9262 | Train Acc: 0.7352
 Site-Infograph                | Train Loss: 1.3394 | Train Acc: 0.6115
 Site-Infograph                | Train Loss: 1.0320 | Train Acc: 0.6653
 Site-Clipart                   (2) | Val  Loss: 0.5625 | Val  Acc: 0.8476
 Site-Clipart                   (2) | Val  Loss: 0.6039 | Val  Acc: 0.8286
 Site-Real                      (0) | Val  Loss: 0.3578 | Val  Acc: 0.8952
 Site-Real                      (0) | Val  Loss: 0.3389 | Val  Acc: 0.9238
 Site-Painting                  (5) | Val  Loss: 0.3543 | Val  Acc: 0.9048
 Site-Painting                  (5) | Val  Loss: 0.4542 | Val  Acc: 0.8857
 Site-Sketch                    (3) | Val  Loss: 0.5772 | Val  Acc: 0.8190
 Site-Sketch                    (3) | Val  Loss: 0.5546 | Val  Acc: 0.8349
 Site-QuickDraw                 (1) | Val  Loss: 0.9729 | Val  Acc: 0.7238
 Site-QuickDraw                 (1) | Val  Loss: 0.8887 | Val  Acc: 0.7492
 Site-Infograph                 (4) | Val  Loss: 1.1777 | Val  Acc: 0.6095
 Site-Infograph                 (4) | Val  Loss: 1.1034 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8042
============ Train epoch 17 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                  | Train Loss: 0.5736 | Train Acc: 0.8471
 Site-Clipart                  | Train Loss: 0.5203 | Train Acc: 0.8559
 Site-Real                     | Train Loss: 0.4149 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.3065 | Train Acc: 0.9428
 Site-Painting                 | Train Loss: 0.5475 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.4659 | Train Acc: 0.8686
 Site-Sketch                   | Train Loss: 0.4896 | Train Acc: 0.8726
 Site-Sketch                   | Train Loss: 0.5206 | Train Acc: 0.8305
 Site-QuickDraw                | Train Loss: 0.9506 | Train Acc: 0.7325
 Site-QuickDraw                | Train Loss: 0.8610 | Train Acc: 0.7669
 Site-Infograph                | Train Loss: 1.2469 | Train Acc: 0.5860
 Site-Infograph                | Train Loss: 1.0372 | Train Acc: 0.6547
 Site-Clipart                   (4) | Val  Loss: 0.5523 | Val  Acc: 0.8381
 Site-Clipart                   (4) | Val  Loss: 0.5749 | Val  Acc: 0.8317
 Site-Real                      (5) | Val  Loss: 0.3872 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.3119 | Val  Acc: 0.9397
 Site-Painting                  (1) | Val  Loss: 0.3610 | Val  Acc: 0.9143
 Site-Painting                  (1) | Val  Loss: 0.4348 | Val  Acc: 0.8667
 Site-Sketch                    (2) | Val  Loss: 0.5337 | Val  Acc: 0.8286
 Site-Sketch                    (2) | Val  Loss: 0.5211 | Val  Acc: 0.8413
 Site-QuickDraw                 (0) | Val  Loss: 0.9190 | Val  Acc: 0.7048
 Site-QuickDraw                 (0) | Val  Loss: 0.8469 | Val  Acc: 0.7714
 Site-Infograph                 (3) | Val  Loss: 1.1630 | Val  Acc: 0.6095
 Site-Infograph                 (3) | Val  Loss: 1.1046 | Val  Acc: 0.6476
Average Valid Accuracy: 0.8090
============ Train epoch 18 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                  | Train Loss: 0.5465 | Train Acc: 0.8471
 Site-Clipart                  | Train Loss: 0.4926 | Train Acc: 0.8750
 Site-Real                     | Train Loss: 0.3487 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2623 | Train Acc: 0.9555
 Site-Painting                 | Train Loss: 0.4362 | Train Acc: 0.8790
 Site-Painting                 | Train Loss: 0.4086 | Train Acc: 0.8877
 Site-Sketch                   | Train Loss: 0.4762 | Train Acc: 0.8726
 Site-Sketch                   | Train Loss: 0.5646 | Train Acc: 0.8242
 Site-QuickDraw                | Train Loss: 0.8875 | Train Acc: 0.7452
 Site-QuickDraw                | Train Loss: 0.8523 | Train Acc: 0.7648
 Site-Infograph                | Train Loss: 1.3120 | Train Acc: 0.5796
 Site-Infograph                | Train Loss: 1.0608 | Train Acc: 0.6610
 Site-Clipart                   (4) | Val  Loss: 0.5316 | Val  Acc: 0.8762
 Site-Clipart                   (4) | Val  Loss: 0.5636 | Val  Acc: 0.8413
 Site-Real                      (5) | Val  Loss: 0.3406 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.3000 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3455 | Val  Acc: 0.8952
 Site-Painting                  (2) | Val  Loss: 0.4080 | Val  Acc: 0.9016
 Site-Sketch                    (0) | Val  Loss: 0.5297 | Val  Acc: 0.8190
 Site-Sketch                    (0) | Val  Loss: 0.5337 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.9269 | Val  Acc: 0.7048
 Site-QuickDraw                 (1) | Val  Loss: 0.8336 | Val  Acc: 0.7429
 Site-Infograph                 (3) | Val  Loss: 1.1649 | Val  Acc: 0.6381
 Site-Infograph                 (3) | Val  Loss: 1.0933 | Val  Acc: 0.6381
Average Valid Accuracy: 0.8119
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                  | Train Loss: 0.5378 | Train Acc: 0.8471
 Site-Clipart                  | Train Loss: 0.5132 | Train Acc: 0.8475
 Site-Real                     | Train Loss: 0.3923 | Train Acc: 0.9045
 Site-Real                     | Train Loss: 0.2575 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.4277 | Train Acc: 0.8471
 Site-Painting                 | Train Loss: 0.4111 | Train Acc: 0.8835
 Site-Sketch                   | Train Loss: 0.4817 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.5213 | Train Acc: 0.8369
 Site-QuickDraw                | Train Loss: 0.8362 | Train Acc: 0.7452
 Site-QuickDraw                | Train Loss: 0.8069 | Train Acc: 0.7648
 Site-Infograph                | Train Loss: 1.2003 | Train Acc: 0.5796
 Site-Infograph                | Train Loss: 1.0126 | Train Acc: 0.6822
 Site-Clipart                   (1) | Val  Loss: 0.5135 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.5733 | Val  Acc: 0.8159
 Site-Real                      (5) | Val  Loss: 0.3603 | Val  Acc: 0.9048
 Site-Real                      (5) | Val  Loss: 0.3197 | Val  Acc: 0.9175
 Site-Painting                  (3) | Val  Loss: 0.3286 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.4042 | Val  Acc: 0.8921
 Site-Sketch                    (4) | Val  Loss: 0.5359 | Val  Acc: 0.8286
 Site-Sketch                    (4) | Val  Loss: 0.5164 | Val  Acc: 0.8476
 Site-QuickDraw                 (2) | Val  Loss: 0.9419 | Val  Acc: 0.7429
 Site-QuickDraw                 (2) | Val  Loss: 0.8397 | Val  Acc: 0.7524
 Site-Infograph                 (0) | Val  Loss: 1.1231 | Val  Acc: 0.6476
 Site-Infograph                 (0) | Val  Loss: 1.0431 | Val  Acc: 0.6730
Average Valid Accuracy: 0.8169
 Best site-Clipart                  (1)  | Epoch:19 | Val Acc: 0.8762
 Best site-Clipart                  (1)  | Epoch:19 | Val Acc: 0.8159
 Best site-Real                     (5)  | Epoch:19 | Val Acc: 0.9048
 Best site-Real                     (5)  | Epoch:19 | Val Acc: 0.9175
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.9048
 Best site-Painting                 (3)  | Epoch:19 | Val Acc: 0.8921
 Best site-Sketch                   (4)  | Epoch:19 | Val Acc: 0.8286
 Best site-Sketch                   (4)  | Epoch:19 | Val Acc: 0.8476
 Best site-QuickDraw                (2)  | Epoch:19 | Val Acc: 0.7429
 Best site-QuickDraw                (2)  | Epoch:19 | Val Acc: 0.7524
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6476
 Best site-Infograph                (0)  | Epoch:19 | Val Acc: 0.6730
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
 Test site-Clipart                   (1)| Epoch:19 | Test Acc: 0.8593
 Test site-Real                      (5)| Epoch:19 | Test Acc: 0.9351
 Test site-Painting                  (3)| Epoch:19 | Test Acc: 0.9128
 Test site-Sketch                    (4)| Epoch:19 | Test Acc: 0.8610
 Test site-QuickDraw                 (2)| Epoch:19 | Test Acc: 0.7410
 Test site-Infograph                 (0)| Epoch:19 | Test Acc: 0.6073
Clipart: 0.8593, Real: 0.9351, Painting: 0.9128, Sketch: 0.8610, QuickDraw: 0.7410, Infograph: 0.6073, 
Average Test Accuracy(group): 0.8194, Average Test Accuracy(individual): 0.8194,
domain CV=0.1379, cluster CV=0.1379, individual CV=0.1379, 
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                  | Train Loss: 0.5624 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4855 | Train Acc: 0.8602
 Site-Real                     | Train Loss: 0.3724 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2977 | Train Acc: 0.9343
 Site-Painting                 | Train Loss: 0.5048 | Train Acc: 0.8471
 Site-Painting                 | Train Loss: 0.4441 | Train Acc: 0.8835
 Site-Sketch                   | Train Loss: 0.4642 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.5425 | Train Acc: 0.8411
 Site-QuickDraw                | Train Loss: 0.8350 | Train Acc: 0.7580
 Site-QuickDraw                | Train Loss: 0.7933 | Train Acc: 0.7775
 Site-Infograph                | Train Loss: 1.2533 | Train Acc: 0.6115
 Site-Infograph                | Train Loss: 1.0307 | Train Acc: 0.6716
 Site-Clipart                   (1) | Val  Loss: 0.4524 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.5171 | Val  Acc: 0.8508
 Site-Real                      (5) | Val  Loss: 0.3546 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.3087 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.3173 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.3917 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.5270 | Val  Acc: 0.8381
 Site-Sketch                    (4) | Val  Loss: 0.5011 | Val  Acc: 0.8317
 Site-QuickDraw                 (0) | Val  Loss: 0.8299 | Val  Acc: 0.7524
 Site-QuickDraw                 (0) | Val  Loss: 0.7793 | Val  Acc: 0.7778
 Site-Infograph                 (2) | Val  Loss: 1.0944 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 1.0533 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8288
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.9048
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8508
 Best site-Real                     (5)  | Epoch:20 | Val Acc: 0.9143
 Best site-Real                     (5)  | Epoch:20 | Val Acc: 0.9238
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.9143
 Best site-Painting                 (3)  | Epoch:20 | Val Acc: 0.9048
 Best site-Sketch                   (4)  | Epoch:20 | Val Acc: 0.8381
 Best site-Sketch                   (4)  | Epoch:20 | Val Acc: 0.8317
 Best site-QuickDraw                (0)  | Epoch:20 | Val Acc: 0.7524
 Best site-QuickDraw                (0)  | Epoch:20 | Val Acc: 0.7778
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:20 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                  | Train Loss: 0.5036 | Train Acc: 0.8535
 Site-Clipart                  | Train Loss: 0.4862 | Train Acc: 0.8623
 Site-Real                     | Train Loss: 0.2913 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2640 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.4447 | Train Acc: 0.8790
 Site-Painting                 | Train Loss: 0.3842 | Train Acc: 0.8898
 Site-Sketch                   | Train Loss: 0.4938 | Train Acc: 0.8217
 Site-Sketch                   | Train Loss: 0.4980 | Train Acc: 0.8665
 Site-QuickDraw                | Train Loss: 0.9001 | Train Acc: 0.7197
 Site-QuickDraw                | Train Loss: 0.7924 | Train Acc: 0.7691
 Site-Infograph                | Train Loss: 1.1978 | Train Acc: 0.6369
 Site-Infograph                | Train Loss: 0.9932 | Train Acc: 0.6907
 Site-Clipart                   (3) | Val  Loss: 0.4946 | Val  Acc: 0.8286
 Site-Clipart                   (3) | Val  Loss: 0.5656 | Val  Acc: 0.8476
 Site-Real                      (4) | Val  Loss: 0.3391 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2944 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2992 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3550 | Val  Acc: 0.9111
 Site-Sketch                    (5) | Val  Loss: 0.5144 | Val  Acc: 0.8571
 Site-Sketch                    (5) | Val  Loss: 0.4648 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.8212 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.8189 | Val  Acc: 0.7683
 Site-Infograph                 (2) | Val  Loss: 1.0880 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 1.0677 | Val  Acc: 0.6413
Average Valid Accuracy: 0.8286
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                  | Train Loss: 0.5137 | Train Acc: 0.8344
 Site-Clipart                  | Train Loss: 0.4420 | Train Acc: 0.8771
 Site-Real                     | Train Loss: 0.3647 | Train Acc: 0.9108
 Site-Real                     | Train Loss: 0.2833 | Train Acc: 0.9364
 Site-Painting                 | Train Loss: 0.4861 | Train Acc: 0.8599
 Site-Painting                 | Train Loss: 0.3755 | Train Acc: 0.9047
 Site-Sketch                   | Train Loss: 0.4138 | Train Acc: 0.8662
 Site-Sketch                   | Train Loss: 0.5195 | Train Acc: 0.8347
 Site-QuickDraw                | Train Loss: 0.7961 | Train Acc: 0.7261
 Site-QuickDraw                | Train Loss: 0.7792 | Train Acc: 0.7881
 Site-Infograph                | Train Loss: 1.2161 | Train Acc: 0.5860
 Site-Infograph                | Train Loss: 0.9897 | Train Acc: 0.6737
 Site-Clipart                   (1) | Val  Loss: 0.5013 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.5132 | Val  Acc: 0.8571
 Site-Real                      (3) | Val  Loss: 0.3517 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.2661 | Val  Acc: 0.9429
 Site-Painting                  (5) | Val  Loss: 0.2679 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.3725 | Val  Acc: 0.8984
 Site-Sketch                    (4) | Val  Loss: 0.4864 | Val  Acc: 0.8667
 Site-Sketch                    (4) | Val  Loss: 0.4984 | Val  Acc: 0.8444
 Site-QuickDraw                 (2) | Val  Loss: 0.8436 | Val  Acc: 0.7524
 Site-QuickDraw                 (2) | Val  Loss: 0.7701 | Val  Acc: 0.7841
 Site-Infograph                 (0) | Val  Loss: 1.0964 | Val  Acc: 0.6286
 Site-Infograph                 (0) | Val  Loss: 1.0572 | Val  Acc: 0.6540
Average Valid Accuracy: 0.8310
 Best site-Clipart                  (1)  | Epoch:22 | Val Acc: 0.8762
 Best site-Clipart                  (1)  | Epoch:22 | Val Acc: 0.8571
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9143
 Best site-Real                     (3)  | Epoch:22 | Val Acc: 0.9429
 Best site-Painting                 (5)  | Epoch:22 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:22 | Val Acc: 0.8984
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8667
 Best site-Sketch                   (4)  | Epoch:22 | Val Acc: 0.8444
 Best site-QuickDraw                (2)  | Epoch:22 | Val Acc: 0.7524
 Best site-QuickDraw                (2)  | Epoch:22 | Val Acc: 0.7841
 Best site-Infograph                (0)  | Epoch:22 | Val Acc: 0.6286
 Best site-Infograph                (0)  | Epoch:22 | Val Acc: 0.6540
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                  | Train Loss: 0.5115 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.4553 | Train Acc: 0.8729
 Site-Real                     | Train Loss: 0.3293 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2784 | Train Acc: 0.9428
 Site-Painting                 | Train Loss: 0.4849 | Train Acc: 0.8535
 Site-Painting                 | Train Loss: 0.3853 | Train Acc: 0.9025
 Site-Sketch                   | Train Loss: 0.4790 | Train Acc: 0.8726
 Site-Sketch                   | Train Loss: 0.5108 | Train Acc: 0.8496
 Site-QuickDraw                | Train Loss: 0.8045 | Train Acc: 0.7070
 Site-QuickDraw                | Train Loss: 0.7525 | Train Acc: 0.7775
 Site-Infograph                | Train Loss: 1.1995 | Train Acc: 0.6115
 Site-Infograph                | Train Loss: 0.9391 | Train Acc: 0.7055
 Site-Clipart                   (1) | Val  Loss: 0.4773 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.5512 | Val  Acc: 0.8381
 Site-Real                      (5) | Val  Loss: 0.3263 | Val  Acc: 0.9333
 Site-Real                      (5) | Val  Loss: 0.2701 | Val  Acc: 0.9333
 Site-Painting                  (2) | Val  Loss: 0.3390 | Val  Acc: 0.8857
 Site-Painting                  (2) | Val  Loss: 0.3791 | Val  Acc: 0.8889
 Site-Sketch                    (4) | Val  Loss: 0.5033 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4424 | Val  Acc: 0.8825
 Site-QuickDraw                 (0) | Val  Loss: 0.7953 | Val  Acc: 0.7524
 Site-QuickDraw                 (0) | Val  Loss: 0.7673 | Val  Acc: 0.7587
 Site-Infograph                 (3) | Val  Loss: 0.9831 | Val  Acc: 0.6571
 Site-Infograph                 (3) | Val  Loss: 1.0129 | Val  Acc: 0.6635
Average Valid Accuracy: 0.8296
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                  | Train Loss: 0.5388 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4372 | Train Acc: 0.8835
 Site-Real                     | Train Loss: 0.3102 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2474 | Train Acc: 0.9428
 Site-Painting                 | Train Loss: 0.4049 | Train Acc: 0.8790
 Site-Painting                 | Train Loss: 0.3737 | Train Acc: 0.8962
 Site-Sketch                   | Train Loss: 0.4398 | Train Acc: 0.8599
 Site-Sketch                   | Train Loss: 0.4794 | Train Acc: 0.8432
 Site-QuickDraw                | Train Loss: 0.7822 | Train Acc: 0.7325
 Site-QuickDraw                | Train Loss: 0.7468 | Train Acc: 0.7818
 Site-Infograph                | Train Loss: 1.2874 | Train Acc: 0.6178
 Site-Infograph                | Train Loss: 0.9570 | Train Acc: 0.6864
 Site-Clipart                   (4) | Val  Loss: 0.4233 | Val  Acc: 0.8857
 Site-Clipart                   (4) | Val  Loss: 0.5288 | Val  Acc: 0.8508
 Site-Real                      (3) | Val  Loss: 0.2756 | Val  Acc: 0.9429
 Site-Real                      (3) | Val  Loss: 0.2608 | Val  Acc: 0.9397
 Site-Painting                  (5) | Val  Loss: 0.2594 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.3688 | Val  Acc: 0.9016
 Site-Sketch                    (0) | Val  Loss: 0.4471 | Val  Acc: 0.8762
 Site-Sketch                    (0) | Val  Loss: 0.4660 | Val  Acc: 0.8667
 Site-QuickDraw                 (1) | Val  Loss: 0.7758 | Val  Acc: 0.7524
 Site-QuickDraw                 (1) | Val  Loss: 0.7400 | Val  Acc: 0.8000
 Site-Infograph                 (2) | Val  Loss: 1.0942 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 0.9753 | Val  Acc: 0.6921
Average Valid Accuracy: 0.8447
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8857
 Best site-Clipart                  (4)  | Epoch:24 | Val Acc: 0.8508
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9429
 Best site-Real                     (3)  | Epoch:24 | Val Acc: 0.9397
 Best site-Painting                 (5)  | Epoch:24 | Val Acc: 0.9524
 Best site-Painting                 (5)  | Epoch:24 | Val Acc: 0.9016
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8762
 Best site-Sketch                   (0)  | Epoch:24 | Val Acc: 0.8667
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.7524
 Best site-QuickDraw                (1)  | Epoch:24 | Val Acc: 0.8000
 Best site-Infograph                (2)  | Epoch:24 | Val Acc: 0.6762
 Best site-Infograph                (2)  | Epoch:24 | Val Acc: 0.6921
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                  | Train Loss: 0.4523 | Train Acc: 0.8917
 Site-Clipart                  | Train Loss: 0.4531 | Train Acc: 0.8623
 Site-Real                     | Train Loss: 0.3416 | Train Acc: 0.9236
 Site-Real                     | Train Loss: 0.2442 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.4258 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.3862 | Train Acc: 0.9068
 Site-Sketch                   | Train Loss: 0.4591 | Train Acc: 0.8662
 Site-Sketch                   | Train Loss: 0.4563 | Train Acc: 0.8665
 Site-QuickDraw                | Train Loss: 0.7676 | Train Acc: 0.7325
 Site-QuickDraw                | Train Loss: 0.7304 | Train Acc: 0.8072
 Site-Infograph                | Train Loss: 1.1674 | Train Acc: 0.6242
 Site-Infograph                | Train Loss: 0.9220 | Train Acc: 0.7140
 Site-Clipart                   (5) | Val  Loss: 0.4669 | Val  Acc: 0.8381
 Site-Clipart                   (5) | Val  Loss: 0.5061 | Val  Acc: 0.8508
 Site-Real                      (4) | Val  Loss: 0.3150 | Val  Acc: 0.9048
 Site-Real                      (4) | Val  Loss: 0.2770 | Val  Acc: 0.9302
 Site-Painting                  (0) | Val  Loss: 0.2428 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3678 | Val  Acc: 0.8952
 Site-Sketch                    (3) | Val  Loss: 0.4959 | Val  Acc: 0.8571
 Site-Sketch                    (3) | Val  Loss: 0.4525 | Val  Acc: 0.8698
 Site-QuickDraw                 (1) | Val  Loss: 0.7273 | Val  Acc: 0.7905
 Site-QuickDraw                 (1) | Val  Loss: 0.7400 | Val  Acc: 0.8032
 Site-Infograph                 (2) | Val  Loss: 1.0418 | Val  Acc: 0.6667
 Site-Infograph                 (2) | Val  Loss: 0.9650 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8381
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                  | Train Loss: 0.4838 | Train Acc: 0.8854
 Site-Clipart                  | Train Loss: 0.4460 | Train Acc: 0.8665
 Site-Real                     | Train Loss: 0.3238 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2394 | Train Acc: 0.9364
 Site-Painting                 | Train Loss: 0.3876 | Train Acc: 0.8726
 Site-Painting                 | Train Loss: 0.3815 | Train Acc: 0.8856
 Site-Sketch                   | Train Loss: 0.4338 | Train Acc: 0.8471
 Site-Sketch                   | Train Loss: 0.4844 | Train Acc: 0.8305
 Site-QuickDraw                | Train Loss: 0.7611 | Train Acc: 0.7643
 Site-QuickDraw                | Train Loss: 0.7290 | Train Acc: 0.7839
 Site-Infograph                | Train Loss: 1.1432 | Train Acc: 0.6369
 Site-Infograph                | Train Loss: 0.9303 | Train Acc: 0.6928
 Site-Clipart                   (1) | Val  Loss: 0.4333 | Val  Acc: 0.8952
 Site-Clipart                   (1) | Val  Loss: 0.4687 | Val  Acc: 0.8794
 Site-Real                      (5) | Val  Loss: 0.3287 | Val  Acc: 0.9048
 Site-Real                      (5) | Val  Loss: 0.2553 | Val  Acc: 0.9365
 Site-Painting                  (3) | Val  Loss: 0.2929 | Val  Acc: 0.9238
 Site-Painting                  (3) | Val  Loss: 0.3436 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.4558 | Val  Acc: 0.8762
 Site-Sketch                    (4) | Val  Loss: 0.4667 | Val  Acc: 0.8730
 Site-QuickDraw                 (0) | Val  Loss: 0.7449 | Val  Acc: 0.7905
 Site-QuickDraw                 (0) | Val  Loss: 0.7028 | Val  Acc: 0.8222
 Site-Infograph                 (2) | Val  Loss: 1.0264 | Val  Acc: 0.6476
 Site-Infograph                 (2) | Val  Loss: 0.9641 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8458
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8952
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8794
 Best site-Real                     (5)  | Epoch:26 | Val Acc: 0.9048
 Best site-Real                     (5)  | Epoch:26 | Val Acc: 0.9365
 Best site-Painting                 (3)  | Epoch:26 | Val Acc: 0.9238
 Best site-Painting                 (3)  | Epoch:26 | Val Acc: 0.9111
 Best site-Sketch                   (4)  | Epoch:26 | Val Acc: 0.8762
 Best site-Sketch                   (4)  | Epoch:26 | Val Acc: 0.8730
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.7905
 Best site-QuickDraw                (0)  | Epoch:26 | Val Acc: 0.8222
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6476
 Best site-Infograph                (2)  | Epoch:26 | Val Acc: 0.6889
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                  | Train Loss: 0.4459 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.4069 | Train Acc: 0.8919
 Site-Real                     | Train Loss: 0.3496 | Train Acc: 0.9108
 Site-Real                     | Train Loss: 0.2558 | Train Acc: 0.9449
 Site-Painting                 | Train Loss: 0.3916 | Train Acc: 0.8917
 Site-Painting                 | Train Loss: 0.3640 | Train Acc: 0.8962
 Site-Sketch                   | Train Loss: 0.4426 | Train Acc: 0.9045
 Site-Sketch                   | Train Loss: 0.4451 | Train Acc: 0.8623
 Site-QuickDraw                | Train Loss: 0.8185 | Train Acc: 0.7261
 Site-QuickDraw                | Train Loss: 0.7066 | Train Acc: 0.7775
 Site-Infograph                | Train Loss: 1.1064 | Train Acc: 0.6815
 Site-Infograph                | Train Loss: 0.8868 | Train Acc: 0.7225
 Site-Clipart                   (1) | Val  Loss: 0.3775 | Val  Acc: 0.9143
 Site-Clipart                   (1) | Val  Loss: 0.4880 | Val  Acc: 0.8667
 Site-Real                      (4) | Val  Loss: 0.3023 | Val  Acc: 0.9238
 Site-Real                      (4) | Val  Loss: 0.2607 | Val  Acc: 0.9492
 Site-Painting                  (5) | Val  Loss: 0.2756 | Val  Acc: 0.9143
 Site-Painting                  (5) | Val  Loss: 0.3534 | Val  Acc: 0.8889
 Site-Sketch                    (0) | Val  Loss: 0.4409 | Val  Acc: 0.8571
 Site-Sketch                    (0) | Val  Loss: 0.4313 | Val  Acc: 0.8603
 Site-QuickDraw                 (2) | Val  Loss: 0.7530 | Val  Acc: 0.7619
 Site-QuickDraw                 (2) | Val  Loss: 0.7156 | Val  Acc: 0.8095
 Site-Infograph                 (3) | Val  Loss: 0.9945 | Val  Acc: 0.6667
 Site-Infograph                 (3) | Val  Loss: 0.9836 | Val  Acc: 0.6825
Average Valid Accuracy: 0.8413
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                  | Train Loss: 0.4691 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4406 | Train Acc: 0.8686
 Site-Real                     | Train Loss: 0.2978 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2401 | Train Acc: 0.9449
 Site-Painting                 | Train Loss: 0.4066 | Train Acc: 0.8726
 Site-Painting                 | Train Loss: 0.3537 | Train Acc: 0.9131
 Site-Sketch                   | Train Loss: 0.4482 | Train Acc: 0.8535
 Site-Sketch                   | Train Loss: 0.4638 | Train Acc: 0.8750
 Site-QuickDraw                | Train Loss: 0.7187 | Train Acc: 0.7707
 Site-QuickDraw                | Train Loss: 0.7105 | Train Acc: 0.7945
 Site-Infograph                | Train Loss: 1.2071 | Train Acc: 0.6115
 Site-Infograph                | Train Loss: 0.8507 | Train Acc: 0.7542
 Site-Clipart                   (4) | Val  Loss: 0.4060 | Val  Acc: 0.9333
 Site-Clipart                   (4) | Val  Loss: 0.4496 | Val  Acc: 0.8762
 Site-Real                      (3) | Val  Loss: 0.2837 | Val  Acc: 0.9238
 Site-Real                      (3) | Val  Loss: 0.2548 | Val  Acc: 0.9429
 Site-Painting                  (5) | Val  Loss: 0.2754 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3190 | Val  Acc: 0.9206
 Site-Sketch                    (0) | Val  Loss: 0.4394 | Val  Acc: 0.8571
 Site-Sketch                    (0) | Val  Loss: 0.4177 | Val  Acc: 0.8857
 Site-QuickDraw                 (1) | Val  Loss: 0.7957 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.7004 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 0.9513 | Val  Acc: 0.6952
 Site-Infograph                 (2) | Val  Loss: 0.9480 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8587
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.9333
 Best site-Clipart                  (4)  | Epoch:28 | Val Acc: 0.8762
 Best site-Real                     (3)  | Epoch:28 | Val Acc: 0.9238
 Best site-Real                     (3)  | Epoch:28 | Val Acc: 0.9429
 Best site-Painting                 (5)  | Epoch:28 | Val Acc: 0.9333
 Best site-Painting                 (5)  | Epoch:28 | Val Acc: 0.9206
 Best site-Sketch                   (0)  | Epoch:28 | Val Acc: 0.8571
 Best site-Sketch                   (0)  | Epoch:28 | Val Acc: 0.8857
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.8095
 Best site-QuickDraw                (1)  | Epoch:28 | Val Acc: 0.8286
 Best site-Infograph                (2)  | Epoch:28 | Val Acc: 0.6952
 Best site-Infograph                (2)  | Epoch:28 | Val Acc: 0.6984
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                  | Train Loss: 0.4958 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4124 | Train Acc: 0.8962
 Site-Real                     | Train Loss: 0.2872 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2426 | Train Acc: 0.9322
 Site-Painting                 | Train Loss: 0.4064 | Train Acc: 0.8854
 Site-Painting                 | Train Loss: 0.3423 | Train Acc: 0.8919
 Site-Sketch                   | Train Loss: 0.4159 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.4185 | Train Acc: 0.8708
 Site-QuickDraw                | Train Loss: 0.7406 | Train Acc: 0.7580
 Site-QuickDraw                | Train Loss: 0.7201 | Train Acc: 0.7987
 Site-Infograph                | Train Loss: 1.2224 | Train Acc: 0.5987
 Site-Infograph                | Train Loss: 0.8633 | Train Acc: 0.7267
 Site-Clipart                   (3) | Val  Loss: 0.3961 | Val  Acc: 0.9333
 Site-Clipart                   (3) | Val  Loss: 0.4737 | Val  Acc: 0.8730
 Site-Real                      (5) | Val  Loss: 0.2812 | Val  Acc: 0.9238
 Site-Real                      (5) | Val  Loss: 0.2554 | Val  Acc: 0.9492
 Site-Painting                  (0) | Val  Loss: 0.2521 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.3469 | Val  Acc: 0.9079
 Site-Sketch                    (4) | Val  Loss: 0.4304 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4141 | Val  Acc: 0.8825
 Site-QuickDraw                 (1) | Val  Loss: 0.6792 | Val  Acc: 0.7810
 Site-QuickDraw                 (1) | Val  Loss: 0.6863 | Val  Acc: 0.8190
 Site-Infograph                 (2) | Val  Loss: 0.9646 | Val  Acc: 0.6762
 Site-Infograph                 (2) | Val  Loss: 0.9072 | Val  Acc: 0.7111
Average Valid Accuracy: 0.8540
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                  | Train Loss: 0.4415 | Train Acc: 0.8854
 Site-Clipart                  | Train Loss: 0.4222 | Train Acc: 0.8814
 Site-Real                     | Train Loss: 0.2853 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2406 | Train Acc: 0.9492
 Site-Painting                 | Train Loss: 0.3890 | Train Acc: 0.9108
 Site-Painting                 | Train Loss: 0.3172 | Train Acc: 0.9153
 Site-Sketch                   | Train Loss: 0.4265 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.4464 | Train Acc: 0.8602
 Site-QuickDraw                | Train Loss: 0.7239 | Train Acc: 0.7771
 Site-QuickDraw                | Train Loss: 0.6706 | Train Acc: 0.8114
 Site-Infograph                | Train Loss: 1.2403 | Train Acc: 0.5924
 Site-Infograph                | Train Loss: 0.9043 | Train Acc: 0.6949
 Site-Clipart                   (4) | Val  Loss: 0.3740 | Val  Acc: 0.9143
 Site-Clipart                   (4) | Val  Loss: 0.4897 | Val  Acc: 0.8603
 Site-Real                      (5) | Val  Loss: 0.2968 | Val  Acc: 0.9333
 Site-Real                      (5) | Val  Loss: 0.2404 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.2573 | Val  Acc: 0.9238
 Site-Painting                  (1) | Val  Loss: 0.3272 | Val  Acc: 0.9079
 Site-Sketch                    (3) | Val  Loss: 0.4088 | Val  Acc: 0.8857
 Site-Sketch                    (3) | Val  Loss: 0.4177 | Val  Acc: 0.8667
 Site-QuickDraw                 (0) | Val  Loss: 0.7095 | Val  Acc: 0.8095
 Site-QuickDraw                 (0) | Val  Loss: 0.6709 | Val  Acc: 0.8190
 Site-Infograph                 (2) | Val  Loss: 1.0052 | Val  Acc: 0.6857
 Site-Infograph                 (2) | Val  Loss: 0.9118 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8529
============ Train epoch 31 ============
cnt=[4, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                  | Train Loss: 0.4762 | Train Acc: 0.8280
 Site-Clipart                  | Train Loss: 0.3771 | Train Acc: 0.9025
 Site-Real                     | Train Loss: 0.3868 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2553 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.4076 | Train Acc: 0.8599
 Site-Painting                 | Train Loss: 0.3651 | Train Acc: 0.8919
 Site-Sketch                   | Train Loss: 0.4835 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.4655 | Train Acc: 0.8538
 Site-QuickDraw                | Train Loss: 0.8370 | Train Acc: 0.7452
 Site-QuickDraw                | Train Loss: 0.6665 | Train Acc: 0.8051
 Site-Infograph                | Train Loss: 1.0541 | Train Acc: 0.6943
 Site-Infograph                | Train Loss: 0.8748 | Train Acc: 0.7203
 Site-Clipart                   (3) | Val  Loss: 0.4266 | Val  Acc: 0.9143
 Site-Clipart                   (3) | Val  Loss: 0.4761 | Val  Acc: 0.8794
 Site-Real                      (0) | Val  Loss: 0.3097 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2463 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2397 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3370 | Val  Acc: 0.9079
 Site-Sketch                    (4) | Val  Loss: 0.4687 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4538 | Val  Acc: 0.8540
 Site-QuickDraw                 (1) | Val  Loss: 0.7539 | Val  Acc: 0.7714
 Site-QuickDraw                 (1) | Val  Loss: 0.6748 | Val  Acc: 0.8349
 Site-Infograph                 (2) | Val  Loss: 1.0029 | Val  Acc: 0.6857
 Site-Infograph                 (5) | Val  Loss: 0.9334 | Val  Acc: 0.6889
Average Valid Accuracy: 0.8511
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                  | Train Loss: 0.5282 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4022 | Train Acc: 0.8983
 Site-Real                     | Train Loss: 0.3220 | Train Acc: 0.9108
 Site-Real                     | Train Loss: 0.2248 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.3892 | Train Acc: 0.8790
 Site-Painting                 | Train Loss: 0.3357 | Train Acc: 0.9068
 Site-Sketch                   | Train Loss: 0.3563 | Train Acc: 0.8726
 Site-Sketch                   | Train Loss: 0.4405 | Train Acc: 0.8559
 Site-QuickDraw                | Train Loss: 0.6985 | Train Acc: 0.8025
 Site-QuickDraw                | Train Loss: 0.6670 | Train Acc: 0.8157
 Site-Infograph                | Train Loss: 1.0898 | Train Acc: 0.6369
 Site-Infograph                | Train Loss: 0.8569 | Train Acc: 0.7182
 Site-Clipart                   (1) | Val  Loss: 0.3978 | Val  Acc: 0.9333
 Site-Clipart                   (1) | Val  Loss: 0.4705 | Val  Acc: 0.8794
 Site-Real                      (3) | Val  Loss: 0.2932 | Val  Acc: 0.9238
 Site-Real                      (3) | Val  Loss: 0.2428 | Val  Acc: 0.9460
 Site-Painting                  (5) | Val  Loss: 0.2283 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3127 | Val  Acc: 0.9302
 Site-Sketch                    (4) | Val  Loss: 0.3371 | Val  Acc: 0.9333
 Site-Sketch                    (4) | Val  Loss: 0.4147 | Val  Acc: 0.8635
 Site-QuickDraw                 (0) | Val  Loss: 0.7328 | Val  Acc: 0.7905
 Site-QuickDraw                 (0) | Val  Loss: 0.6566 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 0.9033 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.9183 | Val  Acc: 0.7048
Average Valid Accuracy: 0.8640
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.9333
 Best site-Clipart                  (1)  | Epoch:32 | Val Acc: 0.8794
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9238
 Best site-Real                     (3)  | Epoch:32 | Val Acc: 0.9460
 Best site-Painting                 (5)  | Epoch:32 | Val Acc: 0.9333
 Best site-Painting                 (5)  | Epoch:32 | Val Acc: 0.9302
 Best site-Sketch                   (4)  | Epoch:32 | Val Acc: 0.9333
 Best site-Sketch                   (4)  | Epoch:32 | Val Acc: 0.8635
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.7905
 Best site-QuickDraw                (0)  | Epoch:32 | Val Acc: 0.8254
 Best site-Infograph                (2)  | Epoch:32 | Val Acc: 0.7048
 Best site-Infograph                (2)  | Epoch:32 | Val Acc: 0.7048
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                  | Train Loss: 0.4894 | Train Acc: 0.8917
 Site-Clipart                  | Train Loss: 0.3839 | Train Acc: 0.8856
 Site-Real                     | Train Loss: 0.3106 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2306 | Train Acc: 0.9492
 Site-Painting                 | Train Loss: 0.3820 | Train Acc: 0.8599
 Site-Painting                 | Train Loss: 0.3305 | Train Acc: 0.9025
 Site-Sketch                   | Train Loss: 0.4044 | Train Acc: 0.8854
 Site-Sketch                   | Train Loss: 0.4166 | Train Acc: 0.8623
 Site-QuickDraw                | Train Loss: 0.7967 | Train Acc: 0.7834
 Site-QuickDraw                | Train Loss: 0.6712 | Train Acc: 0.8136
 Site-Infograph                | Train Loss: 1.0550 | Train Acc: 0.6306
 Site-Infograph                | Train Loss: 0.8639 | Train Acc: 0.7225
 Site-Clipart                   (4) | Val  Loss: 0.3848 | Val  Acc: 0.9238
 Site-Clipart                   (4) | Val  Loss: 0.4456 | Val  Acc: 0.8889
 Site-Real                      (3) | Val  Loss: 0.2735 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.2521 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.2766 | Val  Acc: 0.9238
 Site-Painting                  (5) | Val  Loss: 0.3171 | Val  Acc: 0.9175
 Site-Sketch                    (0) | Val  Loss: 0.4185 | Val  Acc: 0.8667
 Site-Sketch                    (0) | Val  Loss: 0.3988 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.7420 | Val  Acc: 0.7714
 Site-QuickDraw                 (1) | Val  Loss: 0.6913 | Val  Acc: 0.8063
 Site-Infograph                 (2) | Val  Loss: 0.8999 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.9092 | Val  Acc: 0.7111
Average Valid Accuracy: 0.8579
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                  | Train Loss: 0.4244 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.3957 | Train Acc: 0.8814
 Site-Real                     | Train Loss: 0.3267 | Train Acc: 0.9172
 Site-Real                     | Train Loss: 0.2137 | Train Acc: 0.9449
 Site-Painting                 | Train Loss: 0.3693 | Train Acc: 0.8726
 Site-Painting                 | Train Loss: 0.3477 | Train Acc: 0.9068
 Site-Sketch                   | Train Loss: 0.4732 | Train Acc: 0.8535
 Site-Sketch                   | Train Loss: 0.4201 | Train Acc: 0.8708
 Site-QuickDraw                | Train Loss: 0.7112 | Train Acc: 0.7643
 Site-QuickDraw                | Train Loss: 0.6555 | Train Acc: 0.8136
 Site-Infograph                | Train Loss: 1.1284 | Train Acc: 0.6433
 Site-Infograph                | Train Loss: 0.8335 | Train Acc: 0.7331
 Site-Clipart                   (2) | Val  Loss: 0.3630 | Val  Acc: 0.9143
 Site-Clipart                   (2) | Val  Loss: 0.4572 | Val  Acc: 0.8667
 Site-Real                      (1) | Val  Loss: 0.2774 | Val  Acc: 0.9238
 Site-Real                      (1) | Val  Loss: 0.2553 | Val  Acc: 0.9238
 Site-Painting                  (5) | Val  Loss: 0.2364 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3470 | Val  Acc: 0.9079
 Site-Sketch                    (4) | Val  Loss: 0.4342 | Val  Acc: 0.8857
 Site-Sketch                    (4) | Val  Loss: 0.4043 | Val  Acc: 0.8635
 Site-QuickDraw                 (0) | Val  Loss: 0.7193 | Val  Acc: 0.7714
 Site-QuickDraw                 (0) | Val  Loss: 0.6617 | Val  Acc: 0.8254
 Site-Infograph                 (3) | Val  Loss: 0.8983 | Val  Acc: 0.6381
 Site-Infograph                 (3) | Val  Loss: 0.8984 | Val  Acc: 0.6984
Average Valid Accuracy: 0.8460
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                  | Train Loss: 0.4614 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.4015 | Train Acc: 0.8941
 Site-Real                     | Train Loss: 0.3209 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2277 | Train Acc: 0.9364
 Site-Painting                 | Train Loss: 0.3631 | Train Acc: 0.8599
 Site-Painting                 | Train Loss: 0.3386 | Train Acc: 0.9025
 Site-Sketch                   | Train Loss: 0.4114 | Train Acc: 0.8662
 Site-Sketch                   | Train Loss: 0.4165 | Train Acc: 0.8581
 Site-QuickDraw                | Train Loss: 0.6537 | Train Acc: 0.7898
 Site-QuickDraw                | Train Loss: 0.6432 | Train Acc: 0.8030
 Site-Infograph                | Train Loss: 1.1247 | Train Acc: 0.6178
 Site-Infograph                | Train Loss: 0.8023 | Train Acc: 0.7691
 Site-Clipart                   (1) | Val  Loss: 0.3768 | Val  Acc: 0.9048
 Site-Clipart                   (1) | Val  Loss: 0.4368 | Val  Acc: 0.8698
 Site-Real                      (3) | Val  Loss: 0.3121 | Val  Acc: 0.8952
 Site-Real                      (3) | Val  Loss: 0.2434 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.2466 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.2930 | Val  Acc: 0.9238
 Site-Sketch                    (4) | Val  Loss: 0.4065 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.4146 | Val  Acc: 0.8540
 Site-QuickDraw                 (0) | Val  Loss: 0.6659 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 0.6505 | Val  Acc: 0.8317
 Site-Infograph                 (2) | Val  Loss: 0.9100 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.9171 | Val  Acc: 0.6952
Average Valid Accuracy: 0.8519
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                  | Train Loss: 0.4477 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.3888 | Train Acc: 0.8919
 Site-Real                     | Train Loss: 0.2806 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2222 | Train Acc: 0.9513
 Site-Painting                 | Train Loss: 0.3470 | Train Acc: 0.9045
 Site-Painting                 | Train Loss: 0.3176 | Train Acc: 0.9153
 Site-Sketch                   | Train Loss: 0.3975 | Train Acc: 0.8854
 Site-Sketch                   | Train Loss: 0.4502 | Train Acc: 0.8475
 Site-QuickDraw                | Train Loss: 0.6999 | Train Acc: 0.7771
 Site-QuickDraw                | Train Loss: 0.6683 | Train Acc: 0.8008
 Site-Infograph                | Train Loss: 1.0774 | Train Acc: 0.6688
 Site-Infograph                | Train Loss: 0.8339 | Train Acc: 0.7373
 Site-Clipart                   (4) | Val  Loss: 0.3476 | Val  Acc: 0.9429
 Site-Clipart                   (4) | Val  Loss: 0.4485 | Val  Acc: 0.8667
 Site-Real                      (5) | Val  Loss: 0.2639 | Val  Acc: 0.9238
 Site-Real                      (5) | Val  Loss: 0.2406 | Val  Acc: 0.9397
 Site-Painting                  (1) | Val  Loss: 0.2305 | Val  Acc: 0.9429
 Site-Painting                  (1) | Val  Loss: 0.3191 | Val  Acc: 0.9079
 Site-Sketch                    (3) | Val  Loss: 0.3796 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.4006 | Val  Acc: 0.8921
 Site-QuickDraw                 (0) | Val  Loss: 0.6968 | Val  Acc: 0.7905
 Site-QuickDraw                 (0) | Val  Loss: 0.6573 | Val  Acc: 0.8127
 Site-Infograph                 (2) | Val  Loss: 0.8746 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.8847 | Val  Acc: 0.7175
Average Valid Accuracy: 0.8622
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                  | Train Loss: 0.4571 | Train Acc: 0.8854
 Site-Clipart                  | Train Loss: 0.3965 | Train Acc: 0.8941
 Site-Real                     | Train Loss: 0.2997 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2066 | Train Acc: 0.9492
 Site-Painting                 | Train Loss: 0.3823 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.3331 | Train Acc: 0.8877
 Site-Sketch                   | Train Loss: 0.3327 | Train Acc: 0.9045
 Site-Sketch                   | Train Loss: 0.4225 | Train Acc: 0.8665
 Site-QuickDraw                | Train Loss: 0.7410 | Train Acc: 0.7516
 Site-QuickDraw                | Train Loss: 0.6316 | Train Acc: 0.8220
 Site-Infograph                | Train Loss: 1.0964 | Train Acc: 0.6624
 Site-Infograph                | Train Loss: 0.8042 | Train Acc: 0.7564
 Site-Clipart                   (2) | Val  Loss: 0.3757 | Val  Acc: 0.9429
 Site-Clipart                   (2) | Val  Loss: 0.4376 | Val  Acc: 0.8794
 Site-Real                      (0) | Val  Loss: 0.2954 | Val  Acc: 0.9048
 Site-Real                      (0) | Val  Loss: 0.2539 | Val  Acc: 0.9270
 Site-Painting                  (5) | Val  Loss: 0.2330 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2854 | Val  Acc: 0.9365
 Site-Sketch                    (4) | Val  Loss: 0.3630 | Val  Acc: 0.8857
 Site-Sketch                    (4) | Val  Loss: 0.4171 | Val  Acc: 0.8762
 Site-QuickDraw                 (1) | Val  Loss: 0.6943 | Val  Acc: 0.7524
 Site-QuickDraw                 (1) | Val  Loss: 0.6468 | Val  Acc: 0.8127
 Site-Infograph                 (3) | Val  Loss: 0.8257 | Val  Acc: 0.7333
 Site-Infograph                 (3) | Val  Loss: 0.8477 | Val  Acc: 0.7016
Average Valid Accuracy: 0.8587
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                  | Train Loss: 0.4160 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.3854 | Train Acc: 0.8898
 Site-Real                     | Train Loss: 0.3094 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2244 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.3649 | Train Acc: 0.8917
 Site-Painting                 | Train Loss: 0.3117 | Train Acc: 0.9089
 Site-Sketch                   | Train Loss: 0.4009 | Train Acc: 0.8917
 Site-Sketch                   | Train Loss: 0.4497 | Train Acc: 0.8453
 Site-QuickDraw                | Train Loss: 0.7368 | Train Acc: 0.7643
 Site-QuickDraw                | Train Loss: 0.6331 | Train Acc: 0.8199
 Site-Infograph                | Train Loss: 1.0452 | Train Acc: 0.6688
 Site-Infograph                | Train Loss: 0.7807 | Train Acc: 0.7458
 Site-Clipart                   (4) | Val  Loss: 0.3602 | Val  Acc: 0.9238
 Site-Clipart                   (4) | Val  Loss: 0.4231 | Val  Acc: 0.8667
 Site-Real                      (1) | Val  Loss: 0.2334 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.2088 | Val  Acc: 0.9619
 Site-Painting                  (5) | Val  Loss: 0.2361 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3155 | Val  Acc: 0.9206
 Site-Sketch                    (3) | Val  Loss: 0.3936 | Val  Acc: 0.8857
 Site-Sketch                    (3) | Val  Loss: 0.4080 | Val  Acc: 0.8635
 Site-QuickDraw                 (2) | Val  Loss: 0.6421 | Val  Acc: 0.8190
 Site-QuickDraw                 (2) | Val  Loss: 0.6244 | Val  Acc: 0.8381
 Site-Infograph                 (0) | Val  Loss: 0.8288 | Val  Acc: 0.7333
 Site-Infograph                 (0) | Val  Loss: 0.8129 | Val  Acc: 0.7524
Average Valid Accuracy: 0.8693
 Best site-Clipart                  (4)  | Epoch:38 | Val Acc: 0.9238
 Best site-Clipart                  (4)  | Epoch:38 | Val Acc: 0.8667
 Best site-Real                     (1)  | Epoch:38 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:38 | Val Acc: 0.9619
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9333
 Best site-Painting                 (5)  | Epoch:38 | Val Acc: 0.9206
 Best site-Sketch                   (3)  | Epoch:38 | Val Acc: 0.8857
 Best site-Sketch                   (3)  | Epoch:38 | Val Acc: 0.8635
 Best site-QuickDraw                (2)  | Epoch:38 | Val Acc: 0.8190
 Best site-QuickDraw                (2)  | Epoch:38 | Val Acc: 0.8381
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.7333
 Best site-Infograph                (0)  | Epoch:38 | Val Acc: 0.7524
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                  | Train Loss: 0.4687 | Train Acc: 0.8599
 Site-Clipart                  | Train Loss: 0.3947 | Train Acc: 0.8941
 Site-Real                     | Train Loss: 0.2748 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2010 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.3844 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.3077 | Train Acc: 0.9110
 Site-Sketch                   | Train Loss: 0.3609 | Train Acc: 0.8854
 Site-Sketch                   | Train Loss: 0.4067 | Train Acc: 0.8644
 Site-QuickDraw                | Train Loss: 0.6363 | Train Acc: 0.8280
 Site-QuickDraw                | Train Loss: 0.6140 | Train Acc: 0.8220
 Site-Infograph                | Train Loss: 1.1290 | Train Acc: 0.6624
 Site-Infograph                | Train Loss: 0.7722 | Train Acc: 0.7585
 Site-Clipart                   (3) | Val  Loss: 0.3486 | Val  Acc: 0.9333
 Site-Clipart                   (3) | Val  Loss: 0.4321 | Val  Acc: 0.8794
 Site-Real                      (0) | Val  Loss: 0.2564 | Val  Acc: 0.9333
 Site-Real                      (0) | Val  Loss: 0.2321 | Val  Acc: 0.9556
 Site-Painting                  (5) | Val  Loss: 0.2316 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3233 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.3878 | Val  Acc: 0.8857
 Site-Sketch                    (4) | Val  Loss: 0.3877 | Val  Acc: 0.8794
 Site-QuickDraw                 (1) | Val  Loss: 0.6545 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.6231 | Val  Acc: 0.8381
 Site-Infograph                 (2) | Val  Loss: 0.8687 | Val  Acc: 0.7048
 Site-Infograph                 (2) | Val  Loss: 0.8457 | Val  Acc: 0.7206
Average Valid Accuracy: 0.8669
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                  | Train Loss: 0.4248 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.3608 | Train Acc: 0.8835
 Site-Real                     | Train Loss: 0.2914 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.1958 | Train Acc: 0.9534
 Site-Painting                 | Train Loss: 0.3538 | Train Acc: 0.8917
 Site-Painting                 | Train Loss: 0.3279 | Train Acc: 0.9195
 Site-Sketch                   | Train Loss: 0.3721 | Train Acc: 0.8599
 Site-Sketch                   | Train Loss: 0.4168 | Train Acc: 0.8686
 Site-QuickDraw                | Train Loss: 0.6469 | Train Acc: 0.7962
 Site-QuickDraw                | Train Loss: 0.6274 | Train Acc: 0.8157
 Site-Infograph                | Train Loss: 1.0408 | Train Acc: 0.6752
 Site-Infograph                | Train Loss: 0.7672 | Train Acc: 0.7669
 Site-Clipart                   (0) | Val  Loss: 0.3258 | Val  Acc: 0.9429
 Site-Clipart                   (0) | Val  Loss: 0.4366 | Val  Acc: 0.8635
 Site-Real                      (3) | Val  Loss: 0.2632 | Val  Acc: 0.9143
 Site-Real                      (3) | Val  Loss: 0.2481 | Val  Acc: 0.9492
 Site-Painting                  (5) | Val  Loss: 0.2516 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.3047 | Val  Acc: 0.9079
 Site-Sketch                    (4) | Val  Loss: 0.3576 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.4140 | Val  Acc: 0.8571
 Site-QuickDraw                 (1) | Val  Loss: 0.6956 | Val  Acc: 0.7429
 Site-QuickDraw                 (1) | Val  Loss: 0.6037 | Val  Acc: 0.8381
 Site-Infograph                 (2) | Val  Loss: 0.8511 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.8378 | Val  Acc: 0.7175
Average Valid Accuracy: 0.8595
 Test site-Clipart                   (0)| Epoch:38 | Test Acc: 0.8745
 Test site-Real                      (3)| Epoch:38 | Test Acc: 0.9433
 Test site-Painting                  (5)| Epoch:38 | Test Acc: 0.9208
 Test site-Sketch                    (4)| Epoch:38 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:38 | Test Acc: 0.7840
 Test site-Infograph                 (2)| Epoch:38 | Test Acc: 0.6210
Clipart: 0.8745, Real: 0.9433, Painting: 0.9208, Sketch: 0.8845, QuickDraw: 0.7840, Infograph: 0.6210, 
Average Test Accuracy(group): 0.8380, Average Test Accuracy(individual): 0.8380,
domain CV=0.1302, cluster CV=0.1302, individual CV=0.1302, 
Average Test Accuracy: 0.8380
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                  | Train Loss: 0.4849 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.3528 | Train Acc: 0.8941
 Site-Real                     | Train Loss: 0.2735 | Train Acc: 0.9236
 Site-Real                     | Train Loss: 0.2083 | Train Acc: 0.9470
 Site-Painting                 | Train Loss: 0.3771 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.3015 | Train Acc: 0.9131
 Site-Sketch                   | Train Loss: 0.3895 | Train Acc: 0.9108
 Site-Sketch                   | Train Loss: 0.3456 | Train Acc: 0.8814
 Site-QuickDraw                | Train Loss: 0.7179 | Train Acc: 0.7580
 Site-QuickDraw                | Train Loss: 0.6594 | Train Acc: 0.8284
 Site-Infograph                | Train Loss: 1.0547 | Train Acc: 0.6433
 Site-Infograph                | Train Loss: 0.7440 | Train Acc: 0.7606
 Site-Clipart                   (1) | Val  Loss: 0.3479 | Val  Acc: 0.9238
 Site-Clipart                   (1) | Val  Loss: 0.4407 | Val  Acc: 0.8794
 Site-Real                      (0) | Val  Loss: 0.2322 | Val  Acc: 0.9429
 Site-Real                      (0) | Val  Loss: 0.2331 | Val  Acc: 0.9460
 Site-Painting                  (5) | Val  Loss: 0.2246 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.2903 | Val  Acc: 0.9143
 Site-Sketch                    (4) | Val  Loss: 0.3867 | Val  Acc: 0.8667
 Site-Sketch                    (4) | Val  Loss: 0.3937 | Val  Acc: 0.8603
 Site-QuickDraw                 (2) | Val  Loss: 0.7176 | Val  Acc: 0.8000
 Site-QuickDraw                 (2) | Val  Loss: 0.5920 | Val  Acc: 0.8286
 Site-Infograph                 (3) | Val  Loss: 0.8115 | Val  Acc: 0.7524
 Site-Infograph                 (3) | Val  Loss: 0.8095 | Val  Acc: 0.7524
Average Valid Accuracy: 0.8667
 Test site-Clipart                   (1)| Epoch:40 | Test Acc: 0.8764
 Test site-Real                      (0)| Epoch:40 | Test Acc: 0.9441
 Test site-Painting                  (5)| Epoch:40 | Test Acc: 0.9225
 Test site-Sketch                    (4)| Epoch:40 | Test Acc: 0.8881
 Test site-QuickDraw                 (2)| Epoch:40 | Test Acc: 0.7830
 Test site-Infograph                 (3)| Epoch:40 | Test Acc: 0.6164
Clipart: 0.8764, Real: 0.9441, Painting: 0.9225, Sketch: 0.8881, QuickDraw: 0.7830, Infograph: 0.6164, 
Average Test Accuracy(group): 0.8384, Average Test Accuracy(individual): 0.8384,
domain CV=0.1329, cluster CV=0.1329, individual CV=0.1329, 
Average Test Accuracy: 0.8384
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Clipart                  | Train Loss: 0.4602 | Train Acc: 0.8790
 Site-Clipart                  | Train Loss: 0.3347 | Train Acc: 0.9004
 Site-Real                     | Train Loss: 0.2926 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.2339 | Train Acc: 0.9386
 Site-Painting                 | Train Loss: 0.3518 | Train Acc: 0.8917
 Site-Painting                 | Train Loss: 0.2765 | Train Acc: 0.9237
 Site-Sketch                   | Train Loss: 0.3500 | Train Acc: 0.8854
 Site-Sketch                   | Train Loss: 0.3850 | Train Acc: 0.8835
 Site-QuickDraw                | Train Loss: 0.6691 | Train Acc: 0.7962
 Site-QuickDraw                | Train Loss: 0.6040 | Train Acc: 0.8263
 Site-Infograph                | Train Loss: 1.0823 | Train Acc: 0.6815
 Site-Infograph                | Train Loss: 0.7575 | Train Acc: 0.7606
 Site-Clipart                   (4) | Val  Loss: 0.3923 | Val  Acc: 0.9143
 Site-Clipart                   (4) | Val  Loss: 0.4238 | Val  Acc: 0.8794
 Site-Real                      (5) | Val  Loss: 0.2628 | Val  Acc: 0.8952
 Site-Real                      (5) | Val  Loss: 0.2328 | Val  Acc: 0.9238
 Site-Painting                  (1) | Val  Loss: 0.1825 | Val  Acc: 0.9524
 Site-Painting                  (1) | Val  Loss: 0.2867 | Val  Acc: 0.9365
 Site-Sketch                    (3) | Val  Loss: 0.3797 | Val  Acc: 0.9333
 Site-Sketch                    (3) | Val  Loss: 0.4042 | Val  Acc: 0.8698
 Site-QuickDraw                 (0) | Val  Loss: 0.6875 | Val  Acc: 0.7714
 Site-QuickDraw                 (0) | Val  Loss: 0.6138 | Val  Acc: 0.8254
 Site-Infograph                 (2) | Val  Loss: 0.8529 | Val  Acc: 0.7238
 Site-Infograph                 (2) | Val  Loss: 0.8104 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8630
 Test site-Clipart                   (4)| Epoch:41 | Test Acc: 0.8764
 Test site-Real                      (5)| Epoch:41 | Test Acc: 0.9441
 Test site-Painting                  (1)| Epoch:41 | Test Acc: 0.9273
 Test site-Sketch                    (3)| Epoch:41 | Test Acc: 0.8899
 Test site-QuickDraw                 (0)| Epoch:41 | Test Acc: 0.7850
 Test site-Infograph                 (2)| Epoch:41 | Test Acc: 0.6180
Clipart: 0.8764, Real: 0.9441, Painting: 0.9273, Sketch: 0.8899, QuickDraw: 0.7850, Infograph: 0.6180, 
Average Test Accuracy(group): 0.8401, Average Test Accuracy(individual): 0.8401,
domain CV=0.1327, cluster CV=0.1327, individual CV=0.1327, 
Average Test Accuracy: 0.8401
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                  | Train Loss: 0.4056 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.3755 | Train Acc: 0.9025
 Site-Real                     | Train Loss: 0.2906 | Train Acc: 0.9299
 Site-Real                     | Train Loss: 0.1975 | Train Acc: 0.9576
 Site-Painting                 | Train Loss: 0.3074 | Train Acc: 0.9045
 Site-Painting                 | Train Loss: 0.3125 | Train Acc: 0.9025
 Site-Sketch                   | Train Loss: 0.3422 | Train Acc: 0.9172
 Site-Sketch                   | Train Loss: 0.4036 | Train Acc: 0.8708
 Site-QuickDraw                | Train Loss: 0.7058 | Train Acc: 0.7962
 Site-QuickDraw                | Train Loss: 0.6031 | Train Acc: 0.8390
 Site-Infograph                | Train Loss: 1.0082 | Train Acc: 0.6561
 Site-Infograph                | Train Loss: 0.7341 | Train Acc: 0.7648
 Site-Clipart                   (5) | Val  Loss: 0.3408 | Val  Acc: 0.9238
 Site-Clipart                   (5) | Val  Loss: 0.4168 | Val  Acc: 0.8698
 Site-Real                      (4) | Val  Loss: 0.2052 | Val  Acc: 0.9619
 Site-Real                      (4) | Val  Loss: 0.2413 | Val  Acc: 0.9270
 Site-Painting                  (0) | Val  Loss: 0.2080 | Val  Acc: 0.9333
 Site-Painting                  (0) | Val  Loss: 0.2895 | Val  Acc: 0.9460
 Site-Sketch                    (3) | Val  Loss: 0.3330 | Val  Acc: 0.9048
 Site-Sketch                    (3) | Val  Loss: 0.3668 | Val  Acc: 0.8857
 Site-QuickDraw                 (1) | Val  Loss: 0.5827 | Val  Acc: 0.8476
 Site-QuickDraw                 (1) | Val  Loss: 0.6225 | Val  Acc: 0.8317
 Site-Infograph                 (2) | Val  Loss: 0.7765 | Val  Acc: 0.7619
 Site-Infograph                 (2) | Val  Loss: 0.8018 | Val  Acc: 0.7524
Average Valid Accuracy: 0.8788
 Best site-Clipart                  (5)  | Epoch:43 | Val Acc: 0.9238
 Best site-Clipart                  (5)  | Epoch:43 | Val Acc: 0.8698
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9619
 Best site-Real                     (4)  | Epoch:43 | Val Acc: 0.9270
 Best site-Painting                 (0)  | Epoch:43 | Val Acc: 0.9333
 Best site-Painting                 (0)  | Epoch:43 | Val Acc: 0.9460
 Best site-Sketch                   (3)  | Epoch:43 | Val Acc: 0.9048
 Best site-Sketch                   (3)  | Epoch:43 | Val Acc: 0.8857
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8476
 Best site-QuickDraw                (1)  | Epoch:43 | Val Acc: 0.8317
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.7619
 Best site-Infograph                (2)  | Epoch:43 | Val Acc: 0.7524
 Test site-Clipart                   (5)| Epoch:43 | Test Acc: 0.8840
 Test site-Real                      (4)| Epoch:43 | Test Acc: 0.9441
 Test site-Painting                  (0)| Epoch:43 | Test Acc: 0.9241
 Test site-Sketch                    (3)| Epoch:43 | Test Acc: 0.8917
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7910
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.6180
Clipart: 0.8840, Real: 0.9441, Painting: 0.9241, Sketch: 0.8917, QuickDraw: 0.7910, Infograph: 0.6180, 
Average Test Accuracy(group): 0.8421, Average Test Accuracy(individual): 0.8421,
domain CV=0.1320, cluster CV=0.1320, individual CV=0.1320, 
Average Test Accuracy: 0.8421
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                  | Train Loss: 0.3908 | Train Acc: 0.8662
 Site-Clipart                  | Train Loss: 0.3389 | Train Acc: 0.9153
 Site-Real                     | Train Loss: 0.2703 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2106 | Train Acc: 0.9428
 Site-Painting                 | Train Loss: 0.3710 | Train Acc: 0.9108
 Site-Painting                 | Train Loss: 0.2961 | Train Acc: 0.9216
 Site-Sketch                   | Train Loss: 0.3353 | Train Acc: 0.9108
 Site-Sketch                   | Train Loss: 0.3947 | Train Acc: 0.8538
 Site-QuickDraw                | Train Loss: 0.6335 | Train Acc: 0.7707
 Site-QuickDraw                | Train Loss: 0.6031 | Train Acc: 0.8369
 Site-Infograph                | Train Loss: 1.0694 | Train Acc: 0.6433
 Site-Infograph                | Train Loss: 0.7704 | Train Acc: 0.7627
 Site-Clipart                   (3) | Val  Loss: 0.3575 | Val  Acc: 0.9048
 Site-Clipart                   (3) | Val  Loss: 0.4049 | Val  Acc: 0.8762
 Site-Real                      (0) | Val  Loss: 0.2823 | Val  Acc: 0.8857
 Site-Real                      (0) | Val  Loss: 0.2474 | Val  Acc: 0.9460
 Site-Painting                  (5) | Val  Loss: 0.2417 | Val  Acc: 0.9143
 Site-Painting                  (5) | Val  Loss: 0.2739 | Val  Acc: 0.9270
 Site-Sketch                    (4) | Val  Loss: 0.3453 | Val  Acc: 0.8952
 Site-Sketch                    (4) | Val  Loss: 0.3604 | Val  Acc: 0.8857
 Site-QuickDraw                 (1) | Val  Loss: 0.6243 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.5784 | Val  Acc: 0.8286
 Site-Infograph                 (2) | Val  Loss: 0.7995 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.8301 | Val  Acc: 0.7365
Average Valid Accuracy: 0.8619
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8821
 Test site-Real                      (0)| Epoch:43 | Test Acc: 0.9433
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9273
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:43 | Test Acc: 0.7880
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.6164
Clipart: 0.8821, Real: 0.9433, Painting: 0.9273, Sketch: 0.8935, QuickDraw: 0.7880, Infograph: 0.6164, 
Average Test Accuracy(group): 0.8418, Average Test Accuracy(individual): 0.8418,
domain CV=0.1333, cluster CV=0.1333, individual CV=0.1333, 
Average Test Accuracy: 0.8418
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                  | Train Loss: 0.5027 | Train Acc: 0.8471
 Site-Clipart                  | Train Loss: 0.3535 | Train Acc: 0.8983
 Site-Real                     | Train Loss: 0.2452 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2025 | Train Acc: 0.9492
 Site-Painting                 | Train Loss: 0.3125 | Train Acc: 0.8981
 Site-Painting                 | Train Loss: 0.3018 | Train Acc: 0.9004
 Site-Sketch                   | Train Loss: 0.3656 | Train Acc: 0.8981
 Site-Sketch                   | Train Loss: 0.3711 | Train Acc: 0.8771
 Site-QuickDraw                | Train Loss: 0.6583 | Train Acc: 0.7898
 Site-QuickDraw                | Train Loss: 0.5941 | Train Acc: 0.8263
 Site-Infograph                | Train Loss: 1.0127 | Train Acc: 0.6561
 Site-Infograph                | Train Loss: 0.7114 | Train Acc: 0.7818
 Site-Clipart                   (3) | Val  Loss: 0.3407 | Val  Acc: 0.9143
 Site-Clipart                   (3) | Val  Loss: 0.3990 | Val  Acc: 0.8857
 Site-Real                      (1) | Val  Loss: 0.2202 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2129 | Val  Acc: 0.9492
 Site-Painting                  (5) | Val  Loss: 0.2067 | Val  Acc: 0.9429
 Site-Painting                  (5) | Val  Loss: 0.3166 | Val  Acc: 0.9111
 Site-Sketch                    (4) | Val  Loss: 0.4189 | Val  Acc: 0.8571
 Site-Sketch                    (4) | Val  Loss: 0.3477 | Val  Acc: 0.8952
 Site-QuickDraw                 (0) | Val  Loss: 0.6233 | Val  Acc: 0.8286
 Site-QuickDraw                 (0) | Val  Loss: 0.5975 | Val  Acc: 0.8349
 Site-Infograph                 (2) | Val  Loss: 0.8532 | Val  Acc: 0.7333
 Site-Infograph                 (2) | Val  Loss: 0.7852 | Val  Acc: 0.7556
Average Valid Accuracy: 0.8717
 Test site-Clipart                   (3)| Epoch:43 | Test Acc: 0.8840
 Test site-Real                      (1)| Epoch:43 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:43 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:43 | Test Acc: 0.8953
 Test site-QuickDraw                 (0)| Epoch:43 | Test Acc: 0.7860
 Test site-Infograph                 (2)| Epoch:43 | Test Acc: 0.6149
Clipart: 0.8840, Real: 0.9449, Painting: 0.9305, Sketch: 0.8953, QuickDraw: 0.7860, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8426, Average Test Accuracy(individual): 0.8426,
domain CV=0.1351, cluster CV=0.1351, individual CV=0.1351, 
Average Test Accuracy: 0.8426
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_even_1.0_1_cb/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                  | Train Loss: 0.3916 | Train Acc: 0.8726
 Site-Clipart                  | Train Loss: 0.3576 | Train Acc: 0.8919
 Site-Real                     | Train Loss: 0.2549 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2032 | Train Acc: 0.9534
 Site-Painting                 | Train Loss: 0.3831 | Train Acc: 0.8917
 Site-Painting                 | Train Loss: 0.3161 | Train Acc: 0.8941
 Site-Sketch                   | Train Loss: 0.3836 | Train Acc: 0.8790
 Site-Sketch                   | Train Loss: 0.3506 | Train Acc: 0.8983
 Site-QuickDraw                | Train Loss: 0.6547 | Train Acc: 0.7643
 Site-QuickDraw                | Train Loss: 0.5779 | Train Acc: 0.8347
 Site-Infograph                | Train Loss: 1.0503 | Train Acc: 0.6624
 Site-Infograph                | Train Loss: 0.7137 | Train Acc: 0.7818
 Site-Clipart                   (0) | Val  Loss: 0.3342 | Val  Acc: 0.9333
 Site-Clipart                   (0) | Val  Loss: 0.3859 | Val  Acc: 0.8952
 Site-Real                      (2) | Val  Loss: 0.2667 | Val  Acc: 0.9048
 Site-Real                      (2) | Val  Loss: 0.2236 | Val  Acc: 0.9333
 Site-Painting                  (5) | Val  Loss: 0.1855 | Val  Acc: 0.9619
 Site-Painting                  (5) | Val  Loss: 0.3087 | Val  Acc: 0.8952
 Site-Sketch                    (4) | Val  Loss: 0.3639 | Val  Acc: 0.8952
 Site-Sketch                    (4) | Val  Loss: 0.3298 | Val  Acc: 0.9016
 Site-QuickDraw                 (1) | Val  Loss: 0.6426 | Val  Acc: 0.8286
 Site-QuickDraw                 (1) | Val  Loss: 0.5536 | Val  Acc: 0.8508
 Site-Infograph                 (3) | Val  Loss: 0.7933 | Val  Acc: 0.7524
 Site-Infograph                 (3) | Val  Loss: 0.8285 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8735
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8821
 Test site-Real                      (2)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9289
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7890
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.6088
Clipart: 0.8821, Real: 0.9449, Painting: 0.9289, Sketch: 0.8935, QuickDraw: 0.7890, Infograph: 0.6088, 
Average Test Accuracy(group): 0.8412, Average Test Accuracy(individual): 0.8412,
domain CV=0.1369, cluster CV=0.1369, individual CV=0.1369, 
Average Test Accuracy: 0.8412
============ Train epoch 47 ============
cnt=[4, 2, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                  | Train Loss: 0.3712 | Train Acc: 0.8726
 Site-Clipart                  | Train Loss: 0.3789 | Train Acc: 0.8962
 Site-Real                     | Train Loss: 0.2790 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2074 | Train Acc: 0.9407
 Site-Painting                 | Train Loss: 0.4077 | Train Acc: 0.8662
 Site-Painting                 | Train Loss: 0.3277 | Train Acc: 0.8941
 Site-Sketch                   | Train Loss: 0.3391 | Train Acc: 0.8981
 Site-Sketch                   | Train Loss: 0.3641 | Train Acc: 0.8835
 Site-QuickDraw                | Train Loss: 0.6814 | Train Acc: 0.8217
 Site-QuickDraw                | Train Loss: 0.5853 | Train Acc: 0.8220
 Site-Infograph                | Train Loss: 1.0444 | Train Acc: 0.6497
 Site-Infograph                | Train Loss: 0.7295 | Train Acc: 0.7733
 Site-Clipart                   (4) | Val  Loss: 0.3277 | Val  Acc: 0.8762
 Site-Clipart                   (5) | Val  Loss: 0.3820 | Val  Acc: 0.8825
 Site-Real                      (0) | Val  Loss: 0.2347 | Val  Acc: 0.9238
 Site-Real                      (0) | Val  Loss: 0.2228 | Val  Acc: 0.9302
 Site-Painting                  (0) | Val  Loss: 0.2134 | Val  Acc: 0.9429
 Site-Painting                  (0) | Val  Loss: 0.2936 | Val  Acc: 0.9175
 Site-Sketch                    (3) | Val  Loss: 0.3421 | Val  Acc: 0.8952
 Site-Sketch                    (3) | Val  Loss: 0.3344 | Val  Acc: 0.8889
 Site-QuickDraw                 (1) | Val  Loss: 0.6099 | Val  Acc: 0.8095
 Site-QuickDraw                 (1) | Val  Loss: 0.5779 | Val  Acc: 0.8381
 Site-Infograph                 (2) | Val  Loss: 0.8480 | Val  Acc: 0.7143
 Site-Infograph                 (2) | Val  Loss: 0.7543 | Val  Acc: 0.7492
Average Valid Accuracy: 0.8640
 Test site-Clipart                   (4)| Epoch:45 | Test Acc: 0.8783
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9441
 Test site-Painting                  (0)| Epoch:45 | Test Acc: 0.9273
 Test site-Sketch                    (3)| Epoch:45 | Test Acc: 0.8845
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7890
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6043
Clipart: 0.8783, Real: 0.9441, Painting: 0.9273, Sketch: 0.8845, QuickDraw: 0.7890, Infograph: 0.6043, 
Average Test Accuracy(group): 0.8379, Average Test Accuracy(individual): 0.8379,
domain CV=0.1379, cluster CV=nan, individual CV=0.1379, 
Average Test Accuracy: 0.8379
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                  | Train Loss: 0.3884 | Train Acc: 0.8981
 Site-Clipart                  | Train Loss: 0.3392 | Train Acc: 0.9068
 Site-Real                     | Train Loss: 0.3079 | Train Acc: 0.9427
 Site-Real                     | Train Loss: 0.1983 | Train Acc: 0.9492
 Site-Painting                 | Train Loss: 0.4233 | Train Acc: 0.8790
 Site-Painting                 | Train Loss: 0.3094 | Train Acc: 0.9153
 Site-Sketch                   | Train Loss: 0.3583 | Train Acc: 0.9045
 Site-Sketch                   | Train Loss: 0.3401 | Train Acc: 0.8919
 Site-QuickDraw                | Train Loss: 0.5831 | Train Acc: 0.8153
 Site-QuickDraw                | Train Loss: 0.5936 | Train Acc: 0.8093
 Site-Infograph                | Train Loss: 1.0254 | Train Acc: 0.7006
 Site-Infograph                | Train Loss: 0.7386 | Train Acc: 0.7542
 Site-Clipart                   (1) | Val  Loss: 0.2931 | Val  Acc: 0.9238
 Site-Clipart                   (1) | Val  Loss: 0.3677 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2466 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2311 | Val  Acc: 0.9492
 Site-Painting                  (3) | Val  Loss: 0.2526 | Val  Acc: 0.9143
 Site-Painting                  (3) | Val  Loss: 0.2685 | Val  Acc: 0.9429
 Site-Sketch                    (4) | Val  Loss: 0.3308 | Val  Acc: 0.9048
 Site-Sketch                    (4) | Val  Loss: 0.3485 | Val  Acc: 0.9048
 Site-QuickDraw                 (0) | Val  Loss: 0.6103 | Val  Acc: 0.8000
 Site-QuickDraw                 (0) | Val  Loss: 0.5804 | Val  Acc: 0.8222
 Site-Infograph                 (2) | Val  Loss: 0.7629 | Val  Acc: 0.7429
 Site-Infograph                 (2) | Val  Loss: 0.7450 | Val  Acc: 0.7778
Average Valid Accuracy: 0.8759
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.8783
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9441
 Test site-Painting                  (3)| Epoch:45 | Test Acc: 0.9289
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8863
 Test site-QuickDraw                 (0)| Epoch:45 | Test Acc: 0.7920
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6104
Clipart: 0.8783, Real: 0.9441, Painting: 0.9289, Sketch: 0.8863, QuickDraw: 0.7920, Infograph: 0.6104, 
Average Test Accuracy(group): 0.8400, Average Test Accuracy(individual): 0.8400,
domain CV=0.1352, cluster CV=0.1352, individual CV=0.1352, 
Average Test Accuracy: 0.8400
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                  | Train Loss: 0.4026 | Train Acc: 0.8854
 Site-Clipart                  | Train Loss: 0.3309 | Train Acc: 0.9131
 Site-Real                     | Train Loss: 0.2793 | Train Acc: 0.9363
 Site-Real                     | Train Loss: 0.2019 | Train Acc: 0.9555
 Site-Painting                 | Train Loss: 0.3171 | Train Acc: 0.9108
 Site-Painting                 | Train Loss: 0.2946 | Train Acc: 0.9343
 Site-Sketch                   | Train Loss: 0.3963 | Train Acc: 0.8408
 Site-Sketch                   | Train Loss: 0.3460 | Train Acc: 0.8877
 Site-QuickDraw                | Train Loss: 0.6405 | Train Acc: 0.8217
 Site-QuickDraw                | Train Loss: 0.5871 | Train Acc: 0.8390
 Site-Infograph                | Train Loss: 1.0747 | Train Acc: 0.6561
 Site-Infograph                | Train Loss: 0.6923 | Train Acc: 0.7691
 Site-Clipart                   (0) | Val  Loss: 0.3134 | Val  Acc: 0.9238
 Site-Clipart                   (0) | Val  Loss: 0.3748 | Val  Acc: 0.8889
 Site-Real                      (5) | Val  Loss: 0.2356 | Val  Acc: 0.9143
 Site-Real                      (5) | Val  Loss: 0.2239 | Val  Acc: 0.9460
 Site-Painting                  (2) | Val  Loss: 0.2386 | Val  Acc: 0.9048
 Site-Painting                  (2) | Val  Loss: 0.2730 | Val  Acc: 0.9397
 Site-Sketch                    (4) | Val  Loss: 0.3118 | Val  Acc: 0.9143
 Site-Sketch                    (4) | Val  Loss: 0.3666 | Val  Acc: 0.8635
 Site-QuickDraw                 (1) | Val  Loss: 0.5834 | Val  Acc: 0.8381
 Site-QuickDraw                 (1) | Val  Loss: 0.5755 | Val  Acc: 0.8254
 Site-Infograph                 (3) | Val  Loss: 0.7852 | Val  Acc: 0.7619
 Site-Infograph                 (3) | Val  Loss: 0.7617 | Val  Acc: 0.7524
Average Valid Accuracy: 0.8728
 Test site-Clipart                   (0)| Epoch:45 | Test Acc: 0.8764
 Test site-Real                      (5)| Epoch:45 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:45 | Test Acc: 0.9257
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8899
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7910
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.6149
Clipart: 0.8764, Real: 0.9433, Painting: 0.9257, Sketch: 0.8899, QuickDraw: 0.7910, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8402, Average Test Accuracy(individual): 0.8402,
domain CV=0.1330, cluster CV=0.1330, individual CV=0.1330, 
Average Test Accuracy: 0.8402
===2023-06-10 01:39:37===
===2023-06-10 01:39:53===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[157,472,157,472,157,472,157,472,157,472,157,472,
client_nums=[2,2,2,2,2,2,]
len_dataset=[2103,2103,2103,2103,2103,2103,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (3)| Epoch:45 | Test Acc: 0.8840
 Test site-Real                      (1)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:45 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:45 | Test Acc: 0.8953
 Test site-QuickDraw                 (0)| Epoch:45 | Test Acc: 0.7860
 Test site-Infograph                 (2)| Epoch:45 | Test Acc: 0.6149
Clipart: 0.8840, Real: 0.9449, Painting: 0.9305, Sketch: 0.8953, QuickDraw: 0.7860, Infograph: 0.6149, 
Average Test Accuracy(group): 0.8426, Average Test Accuracy(individual): 0.8426,
domain CV=0.1351, cluster CV=0.1351, individual CV=0.1351, 
