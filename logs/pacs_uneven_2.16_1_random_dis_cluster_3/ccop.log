===2023-08-10 15:44:53===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 3
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[10, 1, 7, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (0) | Train Loss: 1.8995 | Train Acc: 0.1429
 Site-photo                     (0) | Train Loss: 1.7820 | Train Acc: 0.3889
 Site-photo                     (0) | Train Loss: 1.7170 | Train Acc: 0.2917
 Site-photo                     (0) | Train Loss: 1.6573 | Train Acc: 0.5161
 Site-photo                     (0) | Train Loss: 1.7674 | Train Acc: 0.3000
 Site-photo                     (0) | Train Loss: 1.7652 | Train Acc: 0.3269
 Site-photo                     (0) | Train Loss: 1.5944 | Train Acc: 0.5294
 Site-photo                     (0) | Train Loss: 1.6861 | Train Acc: 0.4205
 Site-photo                     (0) | Train Loss: 1.6968 | Train Acc: 0.4248
 Site-photo                     (0) | Train Loss: 1.7747 | Train Acc: 0.3425
 Site-art_painting              (2) | Train Loss: 1.8106 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7839 | Train Acc: 0.3182
 Site-art_painting              (2) | Train Loss: 1.9499 | Train Acc: 0.2250
 Site-art_painting              (2) | Train Loss: 2.0031 | Train Acc: 0.1528
 Site-art_painting              (2) | Train Loss: 1.8656 | Train Acc: 0.2812
 Site-cartoon                   (2) | Train Loss: 1.8688 | Train Acc: 0.2727
 Site-cartoon                   (2) | Train Loss: 1.8914 | Train Acc: 0.2087
 Site-sketch                    (1) | Train Loss: 1.9540 | Train Acc: 0.2069
Average Train Accuracy: 0.3203
 Site-photo                     (0) | Val  Loss: 1.7900 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7503 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7375 | Val  Acc: 0.3125
 Site-photo                     (0) | Val  Loss: 1.7571 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7398 | Val  Acc: 0.3333
 Site-photo                     (0) | Val  Loss: 1.7356 | Val  Acc: 0.4000
 Site-photo                     (0) | Val  Loss: 1.6118 | Val  Acc: 0.4222
 Site-photo                     (0) | Val  Loss: 1.6694 | Val  Acc: 0.4310
 Site-photo                     (0) | Val  Loss: 1.7507 | Val  Acc: 0.4533
 Site-photo                     (0) | Val  Loss: 1.7079 | Val  Acc: 0.3918
 Site-art_painting              (2) | Val  Loss: 2.0499 | Val  Acc: 0.1250
 Site-art_painting              (2) | Val  Loss: 1.8044 | Val  Acc: 0.3333
 Site-art_painting              (2) | Val  Loss: 1.6685 | Val  Acc: 0.3462
 Site-art_painting              (2) | Val  Loss: 1.9233 | Val  Acc: 0.1915
 Site-art_painting              (2) | Val  Loss: 1.9554 | Val  Acc: 0.2000
 Site-cartoon                   (2) | Val  Loss: 1.9725 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.8865 | Val  Acc: 0.1948
 Site-sketch                    (1) | Val  Loss: 1.9095 | Val  Acc: 0.2308
Average Valid Accuracy: 0.3060
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3125
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4222
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4310
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.4533
 Best site-photo                    (0)  | Epoch:0 | Val Acc: 0.3918
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.1250
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.3462
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.1915
 Best site-art_painting             (2)  | Epoch:0 | Val Acc: 0.2000
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:0 | Val Acc: 0.1948
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 10, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.7896 | Train Acc: 0.3571
 Site-photo                     (1) | Train Loss: 1.5997 | Train Acc: 0.6111
 Site-photo                     (1) | Train Loss: 1.6276 | Train Acc: 0.3333
 Site-photo                     (1) | Train Loss: 1.5472 | Train Acc: 0.5806
 Site-photo                     (1) | Train Loss: 1.5921 | Train Acc: 0.4000
 Site-photo                     (1) | Train Loss: 1.5914 | Train Acc: 0.4615
 Site-photo                     (1) | Train Loss: 1.3748 | Train Acc: 0.5000
 Site-photo                     (1) | Train Loss: 1.5726 | Train Acc: 0.4659
 Site-photo                     (1) | Train Loss: 1.5820 | Train Acc: 0.4867
 Site-photo                     (1) | Train Loss: 1.6640 | Train Acc: 0.4315
 Site-art_painting              (0) | Train Loss: 1.6602 | Train Acc: 0.4167
 Site-art_painting              (0) | Train Loss: 1.7062 | Train Acc: 0.3182
 Site-art_painting              (0) | Train Loss: 1.9713 | Train Acc: 0.1750
 Site-art_painting              (0) | Train Loss: 1.7006 | Train Acc: 0.2500
 Site-art_painting              (0) | Train Loss: 1.7618 | Train Acc: 0.2969
 Site-cartoon                   (2) | Train Loss: 1.8197 | Train Acc: 0.2727
 Site-cartoon                   (2) | Train Loss: 1.8864 | Train Acc: 0.2261
 Site-sketch                    (2) | Train Loss: 1.9484 | Train Acc: 0.1897
Average Train Accuracy: 0.3763
 Site-photo                     (1) | Val  Loss: 1.6914 | Val  Acc: 0.3333
 Site-photo                     (1) | Val  Loss: 1.6676 | Val  Acc: 0.4167
 Site-photo                     (1) | Val  Loss: 1.6043 | Val  Acc: 0.5625
 Site-photo                     (1) | Val  Loss: 1.6036 | Val  Acc: 0.5238
 Site-photo                     (1) | Val  Loss: 1.5649 | Val  Acc: 0.4074
 Site-photo                     (1) | Val  Loss: 1.6550 | Val  Acc: 0.4571
 Site-photo                     (1) | Val  Loss: 1.4936 | Val  Acc: 0.5333
 Site-photo                     (1) | Val  Loss: 1.5387 | Val  Acc: 0.5172
 Site-photo                     (1) | Val  Loss: 1.6042 | Val  Acc: 0.5333
 Site-photo                     (1) | Val  Loss: 1.5522 | Val  Acc: 0.4948
 Site-art_painting              (0) | Val  Loss: 1.9407 | Val  Acc: 0.2500
 Site-art_painting              (0) | Val  Loss: 1.6786 | Val  Acc: 0.3333
 Site-art_painting              (0) | Val  Loss: 1.6491 | Val  Acc: 0.3077
 Site-art_painting              (0) | Val  Loss: 1.7726 | Val  Acc: 0.2766
 Site-art_painting              (0) | Val  Loss: 1.8157 | Val  Acc: 0.2353
 Site-cartoon                   (2) | Val  Loss: 1.8958 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.9073 | Val  Acc: 0.2338
 Site-sketch                    (2) | Val  Loss: 1.9183 | Val  Acc: 0.1795
Average Valid Accuracy: 0.3744
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.3333
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.4167
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5625
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5238
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.4074
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.4571
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5172
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5333
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.4948
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.3077
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.2766
 Best site-art_painting             (0)  | Epoch:1 | Val Acc: 0.2353
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:1 | Val Acc: 0.2338
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 2 ============
cnt=[3, 1, 14, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (2) | Train Loss: 1.7175 | Train Acc: 0.4286
 Site-photo                     (1) | Train Loss: 1.4633 | Train Acc: 0.6111
 Site-photo                     (2) | Train Loss: 1.5127 | Train Acc: 0.4583
 Site-photo                     (2) | Train Loss: 1.4284 | Train Acc: 0.5806
 Site-photo                     (2) | Train Loss: 1.4635 | Train Acc: 0.5500
 Site-photo                     (2) | Train Loss: 1.4907 | Train Acc: 0.6346
 Site-photo                     (2) | Train Loss: 1.4721 | Train Acc: 0.6618
 Site-photo                     (2) | Train Loss: 1.4821 | Train Acc: 0.6364
 Site-photo                     (2) | Train Loss: 1.4394 | Train Acc: 0.6018
 Site-photo                     (2) | Train Loss: 1.5132 | Train Acc: 0.5616
 Site-art_painting              (2) | Train Loss: 1.6680 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7245 | Train Acc: 0.4545
 Site-art_painting              (2) | Train Loss: 1.8368 | Train Acc: 0.3000
 Site-art_painting              (2) | Train Loss: 1.6680 | Train Acc: 0.3333
 Site-art_painting              (2) | Train Loss: 1.7002 | Train Acc: 0.3750
 Site-cartoon                   (0) | Train Loss: 1.6842 | Train Acc: 0.2727
 Site-cartoon                   (0) | Train Loss: 1.8199 | Train Acc: 0.2435
 Site-sketch                    (0) | Train Loss: 1.9151 | Train Acc: 0.2759
Average Train Accuracy: 0.4665
 Site-photo                     (2) | Val  Loss: 1.5254 | Val  Acc: 0.5556
 Site-photo                     (1) | Val  Loss: 1.5243 | Val  Acc: 0.4167
 Site-photo                     (2) | Val  Loss: 1.4588 | Val  Acc: 0.5625
 Site-photo                     (2) | Val  Loss: 1.4880 | Val  Acc: 0.7143
 Site-photo                     (2) | Val  Loss: 1.4595 | Val  Acc: 0.5185
 Site-photo                     (2) | Val  Loss: 1.5258 | Val  Acc: 0.5429
 Site-photo                     (2) | Val  Loss: 1.3835 | Val  Acc: 0.6444
 Site-photo                     (2) | Val  Loss: 1.4220 | Val  Acc: 0.6379
 Site-photo                     (2) | Val  Loss: 1.5087 | Val  Acc: 0.6400
 Site-photo                     (2) | Val  Loss: 1.4098 | Val  Acc: 0.6598
 Site-art_painting              (2) | Val  Loss: 1.8657 | Val  Acc: 0.1250
 Site-art_painting              (2) | Val  Loss: 1.6869 | Val  Acc: 0.2667
 Site-art_painting              (2) | Val  Loss: 1.6015 | Val  Acc: 0.3846
 Site-art_painting              (2) | Val  Loss: 1.6897 | Val  Acc: 0.3617
 Site-art_painting              (2) | Val  Loss: 1.7540 | Val  Acc: 0.3176
 Site-cartoon                   (0) | Val  Loss: 1.7933 | Val  Acc: 0.2857
 Site-cartoon                   (0) | Val  Loss: 1.8077 | Val  Acc: 0.2468
 Site-sketch                    (0) | Val  Loss: 1.9130 | Val  Acc: 0.1538
Average Valid Accuracy: 0.4464
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.5556
 Best site-photo                    (1)  | Epoch:2 | Val Acc: 0.4167
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.5625
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.7143
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.5185
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.5429
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.6444
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.6379
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.6400
 Best site-photo                    (2)  | Epoch:2 | Val Acc: 0.6598
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.1250
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.2667
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3846
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3617
 Best site-art_painting             (2)  | Epoch:2 | Val Acc: 0.3176
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.2857
 Best site-cartoon                  (0)  | Epoch:2 | Val Acc: 0.2468
 Best site-sketch                   (0)  | Epoch:2 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 3 ============
cnt=[3, 5, 10, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (2) | Train Loss: 1.5542 | Train Acc: 0.4286
 Site-photo                     (2) | Train Loss: 1.3687 | Train Acc: 0.7222
 Site-photo                     (2) | Train Loss: 1.3642 | Train Acc: 0.6250
 Site-photo                     (2) | Train Loss: 1.2713 | Train Acc: 0.8065
 Site-photo                     (2) | Train Loss: 1.3202 | Train Acc: 0.7500
 Site-photo                     (2) | Train Loss: 1.3284 | Train Acc: 0.6538
 Site-photo                     (2) | Train Loss: 1.2364 | Train Acc: 0.7794
 Site-photo                     (2) | Train Loss: 1.3038 | Train Acc: 0.7500
 Site-photo                     (2) | Train Loss: 1.3171 | Train Acc: 0.7699
 Site-photo                     (2) | Train Loss: 1.3744 | Train Acc: 0.6781
 Site-art_painting              (1) | Train Loss: 1.6014 | Train Acc: 0.5833
 Site-art_painting              (1) | Train Loss: 1.6558 | Train Acc: 0.6364
 Site-art_painting              (1) | Train Loss: 1.7441 | Train Acc: 0.3000
 Site-art_painting              (1) | Train Loss: 1.5789 | Train Acc: 0.4028
 Site-art_painting              (1) | Train Loss: 1.6445 | Train Acc: 0.4141
 Site-cartoon                   (0) | Train Loss: 1.5864 | Train Acc: 0.5455
 Site-cartoon                   (0) | Train Loss: 1.7341 | Train Acc: 0.3652
 Site-sketch                    (0) | Train Loss: 1.8560 | Train Acc: 0.2931
Average Train Accuracy: 0.5835
 Site-photo                     (2) | Val  Loss: 1.3394 | Val  Acc: 0.6667
 Site-photo                     (2) | Val  Loss: 1.3776 | Val  Acc: 0.5833
 Site-photo                     (2) | Val  Loss: 1.3933 | Val  Acc: 0.6875
 Site-photo                     (2) | Val  Loss: 1.3319 | Val  Acc: 0.7619
 Site-photo                     (2) | Val  Loss: 1.4066 | Val  Acc: 0.6667
 Site-photo                     (2) | Val  Loss: 1.3623 | Val  Acc: 0.6571
 Site-photo                     (2) | Val  Loss: 1.2662 | Val  Acc: 0.7333
 Site-photo                     (2) | Val  Loss: 1.2850 | Val  Acc: 0.7414
 Site-photo                     (2) | Val  Loss: 1.3120 | Val  Acc: 0.7600
 Site-photo                     (2) | Val  Loss: 1.2386 | Val  Acc: 0.7732
 Site-art_painting              (1) | Val  Loss: 1.8257 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.6848 | Val  Acc: 0.3333
 Site-art_painting              (1) | Val  Loss: 1.5730 | Val  Acc: 0.3462
 Site-art_painting              (1) | Val  Loss: 1.6417 | Val  Acc: 0.5319
 Site-art_painting              (1) | Val  Loss: 1.6879 | Val  Acc: 0.4235
 Site-cartoon                   (0) | Val  Loss: 1.7930 | Val  Acc: 0.0000
 Site-cartoon                   (0) | Val  Loss: 1.7506 | Val  Acc: 0.2987
 Site-sketch                    (0) | Val  Loss: 1.8993 | Val  Acc: 0.1538
Average Valid Accuracy: 0.5205
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.5833
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.6875
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.7619
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.6667
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.6571
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.7333
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.7414
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.7600
 Best site-photo                    (2)  | Epoch:3 | Val Acc: 0.7732
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3333
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.3462
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5319
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.4235
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.0000
 Best site-cartoon                  (0)  | Epoch:3 | Val Acc: 0.2987
 Best site-sketch                   (0)  | Epoch:3 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 4 ============
cnt=[10, 7, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 1.3930 | Train Acc: 0.7857
 Site-photo                     (0) | Train Loss: 1.2235 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 1.2297 | Train Acc: 0.7917
 Site-photo                     (0) | Train Loss: 1.1291 | Train Acc: 0.9032
 Site-photo                     (0) | Train Loss: 1.2024 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 1.1583 | Train Acc: 0.8846
 Site-photo                     (0) | Train Loss: 1.1093 | Train Acc: 0.8529
 Site-photo                     (0) | Train Loss: 1.1592 | Train Acc: 0.8636
 Site-photo                     (0) | Train Loss: 1.1934 | Train Acc: 0.8584
 Site-photo                     (0) | Train Loss: 1.1593 | Train Acc: 0.8562
 Site-art_painting              (1) | Train Loss: 1.6546 | Train Acc: 0.4167
 Site-art_painting              (1) | Train Loss: 1.5564 | Train Acc: 0.6364
 Site-art_painting              (1) | Train Loss: 1.6696 | Train Acc: 0.3500
 Site-art_painting              (1) | Train Loss: 1.5893 | Train Acc: 0.5139
 Site-art_painting              (1) | Train Loss: 1.5342 | Train Acc: 0.5000
 Site-cartoon                   (1) | Train Loss: 1.5346 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.6950 | Train Acc: 0.3391
 Site-sketch                    (2) | Train Loss: 1.8506 | Train Acc: 0.2069
Average Train Accuracy: 0.6724
 Site-photo                     (0) | Val  Loss: 1.2604 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.2321 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 1.2072 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 1.2455 | Val  Acc: 0.8095
 Site-photo                     (0) | Val  Loss: 1.2570 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.2260 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.1146 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.1406 | Val  Acc: 0.8966
 Site-photo                     (0) | Val  Loss: 1.1923 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 1.1196 | Val  Acc: 0.9072
 Site-art_painting              (1) | Val  Loss: 1.5620 | Val  Acc: 0.5000
 Site-art_painting              (1) | Val  Loss: 1.6167 | Val  Acc: 0.4667
 Site-art_painting              (1) | Val  Loss: 1.4603 | Val  Acc: 0.5769
 Site-art_painting              (1) | Val  Loss: 1.5409 | Val  Acc: 0.5106
 Site-art_painting              (1) | Val  Loss: 1.5706 | Val  Acc: 0.4353
 Site-cartoon                   (1) | Val  Loss: 1.6949 | Val  Acc: 0.1429
 Site-cartoon                   (1) | Val  Loss: 1.7168 | Val  Acc: 0.4156
 Site-sketch                    (2) | Val  Loss: 1.8723 | Val  Acc: 0.1795
Average Valid Accuracy: 0.6544
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8095
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8966
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9072
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.5769
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.5106
 Best site-art_painting             (1)  | Epoch:4 | Val Acc: 0.4353
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.1429
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.4156
 Best site-sketch                   (2)  | Epoch:4 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 5 ============
cnt=[5, 12, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (1) | Train Loss: 1.2679 | Train Acc: 0.7857
 Site-photo                     (1) | Train Loss: 1.0296 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 1.1793 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 0.9690 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 1.0447 | Train Acc: 0.9000
 Site-photo                     (1) | Train Loss: 1.0757 | Train Acc: 0.8462
 Site-photo                     (1) | Train Loss: 1.0659 | Train Acc: 0.8824
 Site-photo                     (1) | Train Loss: 1.0409 | Train Acc: 0.9091
 Site-photo                     (1) | Train Loss: 1.0338 | Train Acc: 0.9381
 Site-photo                     (1) | Train Loss: 1.0700 | Train Acc: 0.8836
 Site-art_painting              (2) | Train Loss: 1.4771 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.5283 | Train Acc: 0.5909
 Site-art_painting              (0) | Train Loss: 1.6050 | Train Acc: 0.4250
 Site-art_painting              (1) | Train Loss: 1.4750 | Train Acc: 0.5278
 Site-art_painting              (1) | Train Loss: 1.4517 | Train Acc: 0.5859
 Site-cartoon                   (0) | Train Loss: 1.4887 | Train Acc: 0.5455
 Site-cartoon                   (0) | Train Loss: 1.6573 | Train Acc: 0.3826
 Site-sketch                    (0) | Train Loss: 1.7953 | Train Acc: 0.2414
Average Train Accuracy: 0.6955
 Site-photo                     (1) | Val  Loss: 1.1182 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.1108 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 1.0607 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.0958 | Val  Acc: 0.9048
 Site-photo                     (1) | Val  Loss: 1.1110 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.0853 | Val  Acc: 0.8571
 Site-photo                     (1) | Val  Loss: 0.9571 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 1.0009 | Val  Acc: 0.9310
 Site-photo                     (1) | Val  Loss: 1.0356 | Val  Acc: 0.9200
 Site-photo                     (1) | Val  Loss: 0.9875 | Val  Acc: 0.9381
 Site-art_painting              (2) | Val  Loss: 1.6958 | Val  Acc: 0.2500
 Site-art_painting              (0) | Val  Loss: 1.5251 | Val  Acc: 0.4667
 Site-art_painting              (0) | Val  Loss: 1.3577 | Val  Acc: 0.6538
 Site-art_painting              (1) | Val  Loss: 1.4405 | Val  Acc: 0.5745
 Site-art_painting              (1) | Val  Loss: 1.5018 | Val  Acc: 0.5294
 Site-cartoon                   (0) | Val  Loss: 1.5183 | Val  Acc: 0.4286
 Site-cartoon                   (0) | Val  Loss: 1.6274 | Val  Acc: 0.3896
 Site-sketch                    (0) | Val  Loss: 1.8210 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7112
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9048
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.8571
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9310
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9200
 Best site-photo                    (1)  | Epoch:5 | Val Acc: 0.9381
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.2500
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.4667
 Best site-art_painting             (0)  | Epoch:5 | Val Acc: 0.6538
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.5745
 Best site-art_painting             (1)  | Epoch:5 | Val Acc: 0.5294
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (0)  | Epoch:5 | Val Acc: 0.3896
 Best site-sketch                   (0)  | Epoch:5 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 10, 7, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 1.1028 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.9389 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 1.0103 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.8795 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 0.8992 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.9479 | Train Acc: 0.9038
 Site-photo                     (1) | Train Loss: 0.8588 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.8826 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.9175 | Train Acc: 0.9292
 Site-photo                     (1) | Train Loss: 0.9522 | Train Acc: 0.9178
 Site-art_painting              (2) | Train Loss: 1.4352 | Train Acc: 0.5833
 Site-art_painting              (2) | Train Loss: 1.4886 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.5119 | Train Acc: 0.4500
 Site-art_painting              (2) | Train Loss: 1.4121 | Train Acc: 0.6250
 Site-art_painting              (2) | Train Loss: 1.3769 | Train Acc: 0.6328
 Site-cartoon                   (2) | Train Loss: 1.4614 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 1.5912 | Train Acc: 0.4261
 Site-sketch                    (0) | Train Loss: 1.7971 | Train Acc: 0.3276
Average Train Accuracy: 0.7565
 Site-photo                     (1) | Val  Loss: 0.9723 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.9547 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9443 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.9462 | Val  Acc: 0.9048
 Site-photo                     (1) | Val  Loss: 0.9237 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 1.0073 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.8400 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.8756 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.9383 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.8649 | Val  Acc: 0.9381
 Site-art_painting              (2) | Val  Loss: 1.6246 | Val  Acc: 0.3750
 Site-art_painting              (2) | Val  Loss: 1.3728 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.3035 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.4119 | Val  Acc: 0.6383
 Site-art_painting              (2) | Val  Loss: 1.3667 | Val  Acc: 0.6588
 Site-cartoon                   (2) | Val  Loss: 1.6069 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.5806 | Val  Acc: 0.4286
 Site-sketch                    (0) | Val  Loss: 1.8122 | Val  Acc: 0.2821
Average Valid Accuracy: 0.7329
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9381
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.3750
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6000
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6383
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6588
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.1429
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.4286
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 7 ============
cnt=[10, 3, 5, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (0) | Train Loss: 1.0471 | Train Acc: 0.7857
 Site-photo                     (0) | Train Loss: 0.8582 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.9619 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 0.7681 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.8051 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.8327 | Train Acc: 0.9231
 Site-photo                     (0) | Train Loss: 0.6590 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.8111 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.8063 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.8261 | Train Acc: 0.9247
 Site-art_painting              (2) | Train Loss: 1.3381 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.3864 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.4097 | Train Acc: 0.5750
 Site-art_painting              (2) | Train Loss: 1.3076 | Train Acc: 0.6528
 Site-art_painting              (2) | Train Loss: 1.2873 | Train Acc: 0.6641
 Site-cartoon                   (1) | Train Loss: 1.2878 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.5098 | Train Acc: 0.5043
 Site-sketch                    (1) | Train Loss: 1.7694 | Train Acc: 0.2931
Average Train Accuracy: 0.7697
 Site-photo                     (0) | Val  Loss: 0.9190 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.9201 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.8523 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.8641 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 0.8523 | Val  Acc: 0.9259
 Site-photo                     (0) | Val  Loss: 0.8719 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.7461 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.7966 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.8418 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.7774 | Val  Acc: 0.9381
 Site-art_painting              (2) | Val  Loss: 1.4762 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.3107 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 1.2456 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.2685 | Val  Acc: 0.6596
 Site-art_painting              (2) | Val  Loss: 1.2931 | Val  Acc: 0.6118
 Site-cartoon                   (1) | Val  Loss: 1.4329 | Val  Acc: 0.4286
 Site-cartoon                   (1) | Val  Loss: 1.5371 | Val  Acc: 0.4935
 Site-sketch                    (1) | Val  Loss: 1.8177 | Val  Acc: 0.1282
Average Valid Accuracy: 0.7479
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9259
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.9381
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.7308
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.6596
 Best site-art_painting             (2)  | Epoch:7 | Val Acc: 0.6118
 Best site-cartoon                  (1)  | Epoch:7 | Val Acc: 0.4286
 Best site-cartoon                  (1)  | Epoch:7 | Val Acc: 0.4935
 Best site-sketch                   (1)  | Epoch:7 | Val Acc: 0.1282
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 8 ============
cnt=[7, 10, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (1) | Train Loss: 0.8749 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7155 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.8847 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.7082 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 0.7014 | Train Acc: 0.9250
 Site-photo                     (1) | Train Loss: 0.7482 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.6156 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.7637 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.7110 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.7724 | Train Acc: 0.9521
 Site-art_painting              (0) | Train Loss: 1.2774 | Train Acc: 0.6667
 Site-art_painting              (0) | Train Loss: 1.3289 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 1.3937 | Train Acc: 0.5500
 Site-art_painting              (0) | Train Loss: 1.1424 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.2082 | Train Acc: 0.7422
 Site-cartoon                   (0) | Train Loss: 1.3287 | Train Acc: 0.4545
 Site-cartoon                   (0) | Train Loss: 1.4688 | Train Acc: 0.5391
 Site-sketch                    (2) | Train Loss: 1.7704 | Train Acc: 0.3103
Average Train Accuracy: 0.7890
 Site-photo                     (1) | Val  Loss: 0.7743 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.8231 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.7013 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7356 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.7566 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7933 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.6704 | Val  Acc: 0.9333
 Site-photo                     (1) | Val  Loss: 0.6881 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.7292 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.6830 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 1.2099 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.2406 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 1.1494 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 1.2745 | Val  Acc: 0.7447
 Site-art_painting              (0) | Val  Loss: 1.2298 | Val  Acc: 0.6706
 Site-cartoon                   (0) | Val  Loss: 1.5222 | Val  Acc: 0.1429
 Site-cartoon                   (0) | Val  Loss: 1.4450 | Val  Acc: 0.5195
 Site-sketch                    (2) | Val  Loss: 1.7921 | Val  Acc: 0.1795
Average Valid Accuracy: 0.7919
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9333
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9483
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9588
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.7333
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.7447
 Best site-art_painting             (0)  | Epoch:8 | Val Acc: 0.6706
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.1429
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.5195
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 9 ============
cnt=[5, 10, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 0.8483 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7313 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.7886 | Train Acc: 0.8750
 Site-photo                     (1) | Train Loss: 0.6240 | Train Acc: 0.9355
 Site-photo                     (1) | Train Loss: 0.6246 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6619 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.6433 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6935 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.6423 | Train Acc: 0.9558
 Site-photo                     (1) | Train Loss: 0.6765 | Train Acc: 0.9384
 Site-art_painting              (0) | Train Loss: 1.2169 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.2489 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 1.3488 | Train Acc: 0.5000
 Site-art_painting              (0) | Train Loss: 1.2115 | Train Acc: 0.6806
 Site-art_painting              (0) | Train Loss: 1.1466 | Train Acc: 0.7344
 Site-cartoon                   (2) | Train Loss: 1.2285 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.4169 | Train Acc: 0.6087
 Site-sketch                    (2) | Train Loss: 1.7402 | Train Acc: 0.2931
Average Train Accuracy: 0.8119
 Site-photo                     (1) | Val  Loss: 0.6619 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7889 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.6645 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.6560 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6901 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7290 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.5870 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.6300 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6139 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 0.6351 | Val  Acc: 0.9588
 Site-art_painting              (0) | Val  Loss: 1.2209 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.1465 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 1.1364 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 1.1237 | Val  Acc: 0.8298
 Site-art_painting              (0) | Val  Loss: 1.1476 | Val  Acc: 0.7176
 Site-cartoon                   (2) | Val  Loss: 1.4701 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.4208 | Val  Acc: 0.5584
 Site-sketch                    (2) | Val  Loss: 1.7668 | Val  Acc: 0.2564
Average Valid Accuracy: 0.8204
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9588
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8077
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.8298
 Best site-art_painting             (0)  | Epoch:9 | Val Acc: 0.7176
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:9 | Val Acc: 0.5584
 Best site-sketch                   (2)  | Epoch:9 | Val Acc: 0.2564
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 10 ============
cnt=[3, 9, 6, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (1) | Train Loss: 0.7686 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6003 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.7116 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 0.5765 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6010 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.6308 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.4018 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5500 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.5881 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6275 | Train Acc: 0.9589
 Site-art_painting              (2) | Train Loss: 1.2051 | Train Acc: 0.5833
 Site-art_painting              (2) | Train Loss: 1.2230 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.1911 | Train Acc: 0.6500
 Site-art_painting              (2) | Train Loss: 1.1563 | Train Acc: 0.7222
 Site-art_painting              (2) | Train Loss: 1.0184 | Train Acc: 0.8438
 Site-cartoon                   (2) | Train Loss: 1.0936 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 1.3351 | Train Acc: 0.6435
 Site-sketch                    (0) | Train Loss: 1.6587 | Train Acc: 0.2759
Average Train Accuracy: 0.8250
 Site-photo                     (1) | Val  Loss: 0.6450 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.7506 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5725 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5942 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.6272 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6462 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.5561 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.5766 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6005 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.6051 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 1.0356 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 1.0382 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 1.0215 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 1.0411 | Val  Acc: 0.8511
 Site-art_painting              (2) | Val  Loss: 1.0884 | Val  Acc: 0.7412
 Site-cartoon                   (2) | Val  Loss: 1.4145 | Val  Acc: 0.4286
 Site-cartoon                   (0) | Val  Loss: 1.3135 | Val  Acc: 0.5974
 Site-sketch                    (0) | Val  Loss: 1.6564 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8378
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:10 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.8077
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.8511
 Best site-art_painting             (2)  | Epoch:10 | Val Acc: 0.7412
 Best site-cartoon                  (2)  | Epoch:10 | Val Acc: 0.4286
 Best site-cartoon                  (0)  | Epoch:10 | Val Acc: 0.5974
 Best site-sketch                   (0)  | Epoch:10 | Val Acc: 0.3590
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 11 ============
cnt=[10, 1, 7, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (0) | Train Loss: 0.6470 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5744 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.6503 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.5272 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5726 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.5614 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.4890 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5117 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.5469 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.5655 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 1.0208 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.1128 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.2002 | Train Acc: 0.6000
 Site-art_painting              (2) | Train Loss: 1.1444 | Train Acc: 0.7778
 Site-art_painting              (2) | Train Loss: 1.0240 | Train Acc: 0.8281
 Site-cartoon                   (2) | Train Loss: 1.0548 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.2327 | Train Acc: 0.7043
 Site-sketch                    (1) | Train Loss: 1.6056 | Train Acc: 0.3793
Average Train Accuracy: 0.8553
 Site-photo                     (0) | Val  Loss: 0.5700 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6847 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5499 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.5559 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.5611 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.6190 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.5079 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.5091 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.5521 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.5212 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.9476 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 1.1237 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 0.8865 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.9880 | Val  Acc: 0.7872
 Site-art_painting              (2) | Val  Loss: 0.9932 | Val  Acc: 0.8000
 Site-cartoon                   (2) | Val  Loss: 1.5593 | Val  Acc: 0.1429
 Site-cartoon                   (2) | Val  Loss: 1.3085 | Val  Acc: 0.6494
 Site-sketch                    (1) | Val  Loss: 1.6874 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8175
============ Train epoch 12 ============
cnt=[10, 2, 6, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 0.6263 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6105 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.6516 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 0.5037 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5166 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.5361 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3701 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5205 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.5087 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.5413 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.9929 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.1383 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.0469 | Train Acc: 0.7000
 Site-art_painting              (2) | Train Loss: 0.8778 | Train Acc: 0.7917
 Site-art_painting              (2) | Train Loss: 0.8875 | Train Acc: 0.8516
 Site-cartoon                   (1) | Train Loss: 0.9870 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 1.2249 | Train Acc: 0.6522
 Site-sketch                    (1) | Train Loss: 1.5832 | Train Acc: 0.3448
Average Train Accuracy: 0.8477
 Site-photo                     (0) | Val  Loss: 0.5788 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.6201 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.4899 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4509 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.5331 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5887 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.4517 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4812 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.4738 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.5025 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.9448 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 1.0192 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 0.8213 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.9315 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.9767 | Val  Acc: 0.8000
 Site-cartoon                   (1) | Val  Loss: 1.4067 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 1.2111 | Val  Acc: 0.6883
 Site-sketch                    (1) | Val  Loss: 1.6189 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8549
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.8846
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.9149
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.8000
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.5714
 Best site-cartoon                  (2)  | Epoch:12 | Val Acc: 0.6883
 Best site-sketch                   (1)  | Epoch:12 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 13 ============
cnt=[11, 1, 6, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (2) | Train Loss: 0.5925 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.5304 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.5166 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4669 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4574 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.4699 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.3486 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.4655 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.4631 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.4915 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 1.0170 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.1668 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.0245 | Train Acc: 0.7000
 Site-art_painting              (0) | Train Loss: 0.9467 | Train Acc: 0.7917
 Site-art_painting              (0) | Train Loss: 0.8723 | Train Acc: 0.8047
 Site-cartoon                   (0) | Train Loss: 0.8933 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 1.1246 | Train Acc: 0.7304
 Site-sketch                    (1) | Train Loss: 1.4899 | Train Acc: 0.5172
Average Train Accuracy: 0.8660
 Site-photo                     (2) | Val  Loss: 0.5440 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.5025 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4524 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.4432 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.5106 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5224 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.4400 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.4550 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.4509 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.4715 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.9402 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.8044 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.8402 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.8859 | Val  Acc: 0.8298
 Site-art_painting              (0) | Val  Loss: 0.9078 | Val  Acc: 0.7647
 Site-cartoon                   (0) | Val  Loss: 1.1707 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.1928 | Val  Acc: 0.7143
 Site-sketch                    (1) | Val  Loss: 1.5662 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8706
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:13 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:13 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.8298
 Best site-art_painting             (0)  | Epoch:13 | Val Acc: 0.7647
 Best site-cartoon                  (0)  | Epoch:13 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:13 | Val Acc: 0.7143
 Best site-sketch                   (1)  | Epoch:13 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 12, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (1) | Train Loss: 0.5622 | Train Acc: 0.8571
 Site-photo                     (1) | Train Loss: 0.4434 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.5579 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4097 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4223 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4062 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3060 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4212 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.4219 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.4368 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 1.0134 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.0798 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 0.9570 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.8841 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.8335 | Train Acc: 0.8203
 Site-cartoon                   (0) | Train Loss: 0.8271 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 1.0809 | Train Acc: 0.7391
 Site-sketch                    (0) | Train Loss: 1.4716 | Train Acc: 0.5172
Average Train Accuracy: 0.8763
 Site-photo                     (1) | Val  Loss: 0.5057 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5527 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.4124 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4416 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.4513 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4989 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.4068 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.4421 | Val  Acc: 0.9483
 Site-photo                     (1) | Val  Loss: 0.4156 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4218 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.7077 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.8560 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.8017 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 0.9182 | Val  Acc: 0.7660
 Site-art_painting              (1) | Val  Loss: 0.9016 | Val  Acc: 0.8118
 Site-cartoon                   (0) | Val  Loss: 1.2419 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.0975 | Val  Acc: 0.7532
 Site-sketch                    (0) | Val  Loss: 1.4674 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8708
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9483
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:14 | Val Acc: 0.9794
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:14 | Val Acc: 0.8077
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.7660
 Best site-art_painting             (1)  | Epoch:14 | Val Acc: 0.8118
 Best site-cartoon                  (0)  | Epoch:14 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:14 | Val Acc: 0.7532
 Best site-sketch                   (0)  | Epoch:14 | Val Acc: 0.4359
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 15 ============
cnt=[10, 1, 7, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.5236 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4212 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5016 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3725 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4092 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3832 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2464 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4052 | Train Acc: 0.9318
 Site-photo                     (2) | Train Loss: 0.4000 | Train Acc: 0.9646
 Site-photo                     (2) | Train Loss: 0.4195 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.8788 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.9063 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.9459 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.6089 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.8048 | Train Acc: 0.8438
 Site-cartoon                   (0) | Train Loss: 0.8538 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 1.0390 | Train Acc: 0.7304
 Site-sketch                    (1) | Train Loss: 1.4331 | Train Acc: 0.5345
Average Train Accuracy: 0.8877
 Site-photo                     (0) | Val  Loss: 0.4206 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.4676 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.3863 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3890 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3981 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4759 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.3663 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3962 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.3853 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.3631 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.7524 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.8240 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.7515 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.8397 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 0.8584 | Val  Acc: 0.7765
 Site-cartoon                   (0) | Val  Loss: 1.3324 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.1093 | Val  Acc: 0.7403
 Site-sketch                    (1) | Val  Loss: 1.4463 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8731
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:15 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:15 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:15 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:15 | Val Acc: 0.8298
 Best site-art_painting             (2)  | Epoch:15 | Val Acc: 0.7765
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:15 | Val Acc: 0.7403
 Best site-sketch                   (1)  | Epoch:15 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 16 ============
cnt=[8, 1, 9, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (2) | Train Loss: 0.4400 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4020 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.4680 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3549 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3557 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.3515 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3585 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3693 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.3685 | Train Acc: 0.9646
 Site-photo                     (2) | Train Loss: 0.3396 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.6965 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.9457 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.9522 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.6664 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.7313 | Train Acc: 0.8828
 Site-cartoon                   (0) | Train Loss: 0.8336 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 1.0097 | Train Acc: 0.7217
 Site-sketch                    (1) | Train Loss: 1.3563 | Train Acc: 0.5690
Average Train Accuracy: 0.8887
 Site-photo                     (2) | Val  Loss: 0.3465 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4076 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.3058 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3348 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.3431 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4350 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.3585 | Val  Acc: 0.9333
 Site-photo                     (2) | Val  Loss: 0.3581 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.3660 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.3288 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.6978 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.7649 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 0.7265 | Val  Acc: 0.7692
 Site-art_painting              (2) | Val  Loss: 0.7834 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 0.7978 | Val  Acc: 0.8353
 Site-cartoon                   (0) | Val  Loss: 1.1331 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.0845 | Val  Acc: 0.7403
 Site-sketch                    (1) | Val  Loss: 1.4138 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8693
============ Train epoch 17 ============
cnt=[5, 3, 10, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.4440 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3337 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4450 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.3257 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3631 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3424 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2437 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3659 | Train Acc: 0.9318
 Site-photo                     (2) | Train Loss: 0.3331 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.3308 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.6450 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.9035 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.9056 | Train Acc: 0.7000
 Site-art_painting              (0) | Train Loss: 0.8376 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6938 | Train Acc: 0.8281
 Site-cartoon                   (1) | Train Loss: 0.7491 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.9610 | Train Acc: 0.7565
 Site-sketch                    (1) | Train Loss: 1.2957 | Train Acc: 0.5862
Average Train Accuracy: 0.9029
 Site-photo                     (2) | Val  Loss: 0.4963 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.4614 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2873 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3522 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3355 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4098 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.3265 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.3797 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.3362 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3243 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4889 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.8595 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.5953 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6899 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.7613 | Val  Acc: 0.8235
 Site-cartoon                   (1) | Val  Loss: 1.0985 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.0742 | Val  Acc: 0.7662
 Site-sketch                    (1) | Val  Loss: 1.2290 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8994
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9483
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8723
 Best site-art_painting             (0)  | Epoch:17 | Val Acc: 0.8235
 Best site-cartoon                  (1)  | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:17 | Val Acc: 0.7662
 Best site-sketch                   (1)  | Epoch:17 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 18 ============
cnt=[12, 3, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (0) | Train Loss: 0.4281 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3466 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.4022 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3081 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3533 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.3325 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.2969 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3232 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.3102 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.3348 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.8008 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.8263 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.7895 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.7416 | Train Acc: 0.8472
 Site-art_painting              (0) | Train Loss: 0.6430 | Train Acc: 0.8828
 Site-cartoon                   (1) | Train Loss: 0.7991 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.9218 | Train Acc: 0.7826
 Site-sketch                    (1) | Train Loss: 1.2049 | Train Acc: 0.6379
Average Train Accuracy: 0.8981
 Site-photo                     (0) | Val  Loss: 0.3226 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3493 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2996 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3284 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.3059 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3730 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.3227 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.3444 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.3238 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2945 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4657 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.6955 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.6202 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.6762 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 0.6663 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 0.9633 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.9433 | Val  Acc: 0.7792
 Site-sketch                    (1) | Val  Loss: 1.3116 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8880
============ Train epoch 19 ============
cnt=[5, 3, 10, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (2) | Train Loss: 0.4198 | Train Acc: 0.9286
 Site-photo                     (2) | Train Loss: 0.3004 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.4113 | Train Acc: 0.9167
 Site-photo                     (2) | Train Loss: 0.2863 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3052 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.3070 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2878 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3080 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2868 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.3000 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.8813 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 0.7498 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.7378 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 0.5481 | Train Acc: 0.8611
 Site-art_painting              (0) | Train Loss: 0.6345 | Train Acc: 0.8516
 Site-cartoon                   (1) | Train Loss: 0.8010 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.8660 | Train Acc: 0.7652
 Site-sketch                    (1) | Train Loss: 1.1268 | Train Acc: 0.6552
Average Train Accuracy: 0.8814
 Site-photo                     (2) | Val  Loss: 0.4862 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.3803 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.3028 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.3129 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2920 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3434 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2809 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.3001 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2911 | Val  Acc: 0.9733
 Site-photo                     (2) | Val  Loss: 0.2797 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.6067 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.5797 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.5762 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.6708 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.6382 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 0.8786 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.9084 | Val  Acc: 0.7792
 Site-sketch                    (1) | Val  Loss: 1.1994 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8989
============ Train epoch 20 ============
cnt=[7, 1, 10, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (0) | Train Loss: 0.3261 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3178 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3579 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2506 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2805 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.2640 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3304 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.3176 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2472 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.2772 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.6314 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.7613 | Train Acc: 0.8636
 Site-art_painting              (2) | Train Loss: 0.7055 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.5564 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.6182 | Train Acc: 0.8750
 Site-cartoon                   (2) | Train Loss: 0.6919 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.8556 | Train Acc: 0.7739
 Site-sketch                    (1) | Train Loss: 1.0931 | Train Acc: 0.6724
Average Train Accuracy: 0.9074
 Site-photo                     (0) | Val  Loss: 0.4455 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.4248 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2309 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2927 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2819 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3227 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2813 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2662 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2417 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2800 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.4838 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.6933 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 0.4908 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.5743 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.6002 | Val  Acc: 0.8941
 Site-cartoon                   (2) | Val  Loss: 0.9363 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.9377 | Val  Acc: 0.8182
 Site-sketch                    (1) | Val  Loss: 1.0443 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9105
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:20 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:20 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.8936
 Best site-art_painting             (2)  | Epoch:20 | Val Acc: 0.8941
 Best site-cartoon                  (2)  | Epoch:20 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:20 | Val Acc: 0.8182
 Best site-sketch                   (1)  | Epoch:20 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 21 ============
cnt=[1, 11, 6, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (2) | Train Loss: 0.3466 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.2599 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.3640 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.2321 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2876 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2717 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2053 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.2716 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2466 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.2848 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.5756 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.7356 | Train Acc: 0.8182
 Site-art_painting              (1) | Train Loss: 0.7390 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 0.5698 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.5511 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.7386 | Train Acc: 0.9091
 Site-cartoon                   (2) | Train Loss: 0.7789 | Train Acc: 0.8522
 Site-sketch                    (0) | Train Loss: 1.1044 | Train Acc: 0.6897
Average Train Accuracy: 0.9094
 Site-photo                     (2) | Val  Loss: 0.2446 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3628 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1848 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2697 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2270 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2858 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2552 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2645 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2303 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2442 | Val  Acc: 0.9691
 Site-art_painting              (1) | Val  Loss: 0.4126 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.4520 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.4733 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.5273 | Val  Acc: 0.9149
 Site-art_painting              (1) | Val  Loss: 0.6346 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 1.0583 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.8526 | Val  Acc: 0.7662
 Site-sketch                    (0) | Val  Loss: 1.1885 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9164
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:21 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:21 | Val Acc: 0.9691
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9231
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.9149
 Best site-art_painting             (1)  | Epoch:21 | Val Acc: 0.8824
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:21 | Val Acc: 0.7662
 Best site-sketch                   (0)  | Epoch:21 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 22 ============
cnt=[13, 3, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (0) | Train Loss: 0.3084 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4093 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.3353 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.2462 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2870 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.2401 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1756 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3226 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.2392 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2757 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.6044 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7549 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.7412 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.5900 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5737 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.6578 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.7140 | Train Acc: 0.8174
 Site-sketch                    (1) | Train Loss: 1.0880 | Train Acc: 0.6207
Average Train Accuracy: 0.9067
 Site-photo                     (0) | Val  Loss: 0.4108 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3783 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2218 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2908 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.2137 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2985 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.2212 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2456 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2296 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2330 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.4649 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4878 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5573 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.5236 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.5820 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 0.9992 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7813 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 1.0400 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9158
============ Train epoch 23 ============
cnt=[5, 3, 10, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (2) | Train Loss: 0.3589 | Train Acc: 0.9286
 Site-photo                     (2) | Train Loss: 0.2655 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3310 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.2009 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2670 | Train Acc: 0.9250
 Site-photo                     (2) | Train Loss: 0.2641 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.1333 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2641 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.2421 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.2308 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.5208 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.7035 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.6930 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 0.4531 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5594 | Train Acc: 0.8672
 Site-cartoon                   (1) | Train Loss: 0.5511 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.7082 | Train Acc: 0.8174
 Site-sketch                    (1) | Train Loss: 1.0380 | Train Acc: 0.7069
Average Train Accuracy: 0.9129
 Site-photo                     (2) | Val  Loss: 0.2109 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3949 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2118 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.3092 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.2152 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2763 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2575 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2325 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2178 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2102 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.4095 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5511 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.5061 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.5243 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.5545 | Val  Acc: 0.8706
 Site-cartoon                   (1) | Val  Loss: 0.9005 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7984 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 1.0363 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9236
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9524
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9556
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9655
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:23 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.9362
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.8706
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:23 | Val Acc: 0.8442
 Best site-sketch                   (1)  | Epoch:23 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 24 ============
cnt=[3, 8, 7, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (2) | Train Loss: 0.2581 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2224 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2835 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2089 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2504 | Train Acc: 0.9250
 Site-photo                     (1) | Train Loss: 0.2141 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1292 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2457 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.2236 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.2412 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.5882 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.6518 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.6710 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.4303 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.5316 | Train Acc: 0.8750
 Site-cartoon                   (0) | Train Loss: 0.5680 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.7018 | Train Acc: 0.8000
 Site-sketch                    (0) | Train Loss: 1.0495 | Train Acc: 0.6724
Average Train Accuracy: 0.9162
 Site-photo                     (2) | Val  Loss: 0.2687 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2774 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.2217 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.2502 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.2212 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2633 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2087 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.2314 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.2086 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.2079 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.2642 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.4699 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.3560 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.4970 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.5220 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 0.8151 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.7562 | Val  Acc: 0.8312
 Site-sketch                    (0) | Val  Loss: 0.9778 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9291
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9429
 Best site-photo                    (2)  | Epoch:24 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:24 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.9149
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8824
 Best site-cartoon                  (0)  | Epoch:24 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:24 | Val Acc: 0.8312
 Best site-sketch                   (0)  | Epoch:24 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 25 ============
cnt=[3, 3, 12, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (2) | Train Loss: 0.2685 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2444 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3204 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2085 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2474 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.1750 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1505 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.2254 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.2260 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.2467 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.5871 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.7027 | Train Acc: 0.8636
 Site-art_painting              (2) | Train Loss: 0.6280 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.5104 | Train Acc: 0.9028
 Site-art_painting              (2) | Train Loss: 0.4832 | Train Acc: 0.8906
 Site-cartoon                   (1) | Train Loss: 0.5366 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6237 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.9188 | Train Acc: 0.7586
Average Train Accuracy: 0.9299
 Site-photo                     (2) | Val  Loss: 0.3775 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2692 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1611 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2515 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1734 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2554 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2103 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.2077 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1838 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1950 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.3487 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.5710 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.5163 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.5153 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.5009 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.8804 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.7450 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.9036 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9271
============ Train epoch 26 ============
cnt=[7, 3, 8, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (0) | Train Loss: 0.2033 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2429 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2777 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1714 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2193 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.2075 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.1565 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.2744 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.1929 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2116 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4929 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.8039 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.6330 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.5125 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.4876 | Train Acc: 0.8906
 Site-cartoon                   (1) | Train Loss: 0.4645 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.6483 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 0.8461 | Train Acc: 0.7586
Average Train Accuracy: 0.9253
 Site-photo                     (0) | Val  Loss: 0.3030 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2395 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1582 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2584 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1620 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2661 | Val  Acc: 0.9143
 Site-photo                     (2) | Val  Loss: 0.1933 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2269 | Val  Acc: 0.9483
 Site-photo                     (2) | Val  Loss: 0.1693 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1983 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.2574 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4462 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4766 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.4936 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.5202 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 0.8884 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7643 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 0.9749 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9089
============ Train epoch 27 ============
cnt=[5, 3, 10, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (2) | Train Loss: 0.2238 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3137 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.2488 | Train Acc: 0.9583
 Site-photo                     (2) | Train Loss: 0.1833 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2064 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.1748 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 0.2209 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2105 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.1794 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.1931 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.5040 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.6140 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.6152 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.4947 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4035 | Train Acc: 0.9297
 Site-cartoon                   (1) | Train Loss: 0.7018 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.6286 | Train Acc: 0.8261
 Site-sketch                    (1) | Train Loss: 0.8517 | Train Acc: 0.7241
Average Train Accuracy: 0.9070
 Site-photo                     (2) | Val  Loss: 0.3602 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2240 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1623 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.2533 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2060 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.2028 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.2040 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.2067 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1771 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.2874 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4166 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4016 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.4100 | Val  Acc: 0.9787
 Site-art_painting              (0) | Val  Loss: 0.4536 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.8924 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.6441 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.9603 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9034
============ Train epoch 28 ============
cnt=[10, 3, 5, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (2) | Train Loss: 0.2276 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2087 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2506 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1491 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2137 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.2327 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.1075 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1740 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1784 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1921 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.4379 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.7598 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.6145 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.4964 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.4743 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.6290 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5909 | Train Acc: 0.8696
 Site-sketch                    (1) | Train Loss: 0.8758 | Train Acc: 0.7414
Average Train Accuracy: 0.9257
 Site-photo                     (2) | Val  Loss: 0.3999 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1775 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1299 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2299 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1484 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2239 | Val  Acc: 0.9143
 Site-photo                     (2) | Val  Loss: 0.2118 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1735 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1740 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1922 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 0.2485 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3525 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4431 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4456 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4491 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.7415 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.6892 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.8794 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9360
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9143
 Best site-photo                    (2)  | Epoch:28 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:28 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:28 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9059
 Best site-cartoon                  (1)  | Epoch:28 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:28 | Val Acc: 0.8831
 Best site-sketch                   (1)  | Epoch:28 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 29 ============
cnt=[3, 14, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.2192 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1897 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2063 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1493 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2191 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1788 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.0933 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.1725 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1654 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.1728 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.4875 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5350 | Train Acc: 0.9091
 Site-art_painting              (1) | Train Loss: 0.5538 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.5024 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.4646 | Train Acc: 0.8984
 Site-cartoon                   (0) | Train Loss: 0.5629 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.5712 | Train Acc: 0.8609
 Site-sketch                    (0) | Train Loss: 0.8238 | Train Acc: 0.7241
Average Train Accuracy: 0.9258
 Site-photo                     (1) | Val  Loss: 0.1847 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2044 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1154 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2703 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1349 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2382 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.2066 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1785 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1594 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.1673 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2487 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.3697 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.4593 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 0.3961 | Val  Acc: 0.8936
 Site-art_painting              (1) | Val  Loss: 0.4641 | Val  Acc: 0.8941
 Site-cartoon                   (0) | Val  Loss: 0.8114 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 0.7394 | Val  Acc: 0.8182
 Site-sketch                    (0) | Val  Loss: 0.8760 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9079
============ Train epoch 30 ============
cnt=[2, 15, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (1) | Train Loss: 0.2108 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2128 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.2024 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1425 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2052 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1990 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.0885 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2098 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1606 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1672 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.5116 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5956 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.4914 | Train Acc: 0.9250
 Site-art_painting              (1) | Train Loss: 0.5381 | Train Acc: 0.9028
 Site-art_painting              (1) | Train Loss: 0.3936 | Train Acc: 0.9141
 Site-cartoon                   (0) | Train Loss: 0.5722 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.5427 | Train Acc: 0.8783
 Site-sketch                    (2) | Train Loss: 0.7671 | Train Acc: 0.8276
Average Train Accuracy: 0.9326
 Site-photo                     (1) | Val  Loss: 0.1772 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2763 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1204 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1772 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1346 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2197 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1863 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1770 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1390 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1699 | Val  Acc: 0.9588
 Site-art_painting              (1) | Val  Loss: 0.2526 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.6568 | Val  Acc: 0.8667
 Site-art_painting              (1) | Val  Loss: 0.3502 | Val  Acc: 0.9615
 Site-art_painting              (1) | Val  Loss: 0.3714 | Val  Acc: 0.9362
 Site-art_painting              (1) | Val  Loss: 0.4391 | Val  Acc: 0.9176
 Site-cartoon                   (0) | Val  Loss: 0.7159 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.5937 | Val  Acc: 0.8701
 Site-sketch                    (2) | Val  Loss: 0.8908 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9301
============ Train epoch 31 ============
cnt=[8, 3, 7, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1735 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2119 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.2053 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.1383 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1944 | Train Acc: 0.9250
 Site-photo                     (2) | Train Loss: 0.1433 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1267 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1819 | Train Acc: 0.9432
 Site-photo                     (2) | Train Loss: 0.1623 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.1586 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4214 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.5237 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.5528 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4560 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.4030 | Train Acc: 0.9141
 Site-cartoon                   (1) | Train Loss: 0.3917 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4964 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.7677 | Train Acc: 0.7414
Average Train Accuracy: 0.9349
 Site-photo                     (0) | Val  Loss: 0.4466 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.1732 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1025 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2238 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1502 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2110 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1810 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 0.1777 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1498 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.1709 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.3687 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.3655 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.3818 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.4419 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.3799 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.6085 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5427 | Val  Acc: 0.9091
 Site-sketch                    (1) | Val  Loss: 0.8636 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9262
============ Train epoch 32 ============
cnt=[4, 3, 11, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (2) | Train Loss: 0.1994 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1551 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2146 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1192 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1944 | Train Acc: 0.9250
 Site-photo                     (2) | Train Loss: 0.1126 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1338 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.1529 | Train Acc: 0.9659
 Site-photo                     (2) | Train Loss: 0.1553 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.1504 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.4766 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5695 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4806 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3843 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3517 | Train Acc: 0.9375
 Site-cartoon                   (1) | Train Loss: 0.5964 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.5601 | Train Acc: 0.8696
 Site-sketch                    (1) | Train Loss: 0.7775 | Train Acc: 0.7759
Average Train Accuracy: 0.9380
 Site-photo                     (2) | Val  Loss: 0.3492 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.1216 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.0941 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2578 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1321 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2206 | Val  Acc: 0.9429
 Site-photo                     (2) | Val  Loss: 0.1799 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1685 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1231 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1399 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.1563 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3886 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.4212 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3379 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4262 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 0.7868 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.6444 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8649 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9253
============ Train epoch 33 ============
cnt=[2, 15, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (1) | Train Loss: 0.1741 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1838 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1986 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.1475 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2012 | Train Acc: 0.9250
 Site-photo                     (1) | Train Loss: 0.1369 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.0940 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2059 | Train Acc: 0.9432
 Site-photo                     (1) | Train Loss: 0.1668 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1458 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 0.4325 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 0.4950 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.5529 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.3515 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.4065 | Train Acc: 0.8984
 Site-cartoon                   (0) | Train Loss: 0.5406 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.4988 | Train Acc: 0.8870
 Site-sketch                    (2) | Train Loss: 0.7418 | Train Acc: 0.7759
Average Train Accuracy: 0.9312
 Site-photo                     (1) | Val  Loss: 0.2206 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.2625 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0939 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2395 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.1154 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1798 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1873 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1803 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1548 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.1423 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.1924 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2865 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.4332 | Val  Acc: 0.8846
 Site-art_painting              (1) | Val  Loss: 0.3480 | Val  Acc: 0.9362
 Site-art_painting              (1) | Val  Loss: 0.3897 | Val  Acc: 0.9294
 Site-cartoon                   (0) | Val  Loss: 0.6279 | Val  Acc: 1.0000
 Site-cartoon                   (0) | Val  Loss: 0.7122 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.8615 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9338
============ Train epoch 34 ============
cnt=[5, 3, 10, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.1835 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2379 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2082 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1298 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1933 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1526 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1937 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.1646 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.1421 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1251 | Train Acc: 0.9932
 Site-art_painting              (2) | Train Loss: 0.4162 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.5768 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.4394 | Train Acc: 0.9250
 Site-art_painting              (2) | Train Loss: 0.4789 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3722 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.4007 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4715 | Train Acc: 0.8870
 Site-sketch                    (1) | Train Loss: 0.7908 | Train Acc: 0.7414
Average Train Accuracy: 0.9388
 Site-photo                     (0) | Val  Loss: 0.3552 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.1810 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.1256 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2256 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1912 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.1466 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1431 | Val  Acc: 0.9828
 Site-photo                     (2) | Val  Loss: 0.1363 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1416 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.2702 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.5053 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.3581 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.3442 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.3406 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.6375 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5954 | Val  Acc: 0.8961
 Site-sketch                    (1) | Val  Loss: 0.7391 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9356
============ Train epoch 35 ============
cnt=[3, 3, 12, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (2) | Train Loss: 0.1717 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.3417 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.1750 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1042 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1682 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.1131 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2152 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1562 | Train Acc: 0.9545
 Site-photo                     (2) | Train Loss: 0.1464 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.1586 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.4246 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5633 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.5741 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.4885 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.3970 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 0.4761 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.4639 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.7891 | Train Acc: 0.6897
Average Train Accuracy: 0.9189
 Site-photo                     (2) | Val  Loss: 0.2291 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.1958 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2405 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.1097 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2102 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.1681 | Val  Acc: 0.9556
 Site-photo                     (2) | Val  Loss: 0.1497 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.1099 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.1270 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.1762 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4941 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.3072 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.3564 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.3738 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.7257 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.6073 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.8311 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9083
============ Train epoch 36 ============
cnt=[1, 15, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.1465 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1345 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1657 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1176 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1883 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.1604 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.0683 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1409 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.1636 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1391 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.3642 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 0.5371 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.4857 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.3194 | Train Acc: 0.8889
 Site-art_painting              (1) | Train Loss: 0.3344 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.4569 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4336 | Train Acc: 0.9304
 Site-sketch                    (0) | Train Loss: 0.7260 | Train Acc: 0.7931
Average Train Accuracy: 0.9302
 Site-photo                     (1) | Val  Loss: 0.0964 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1825 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2492 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.0965 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1884 | Val  Acc: 0.9429
 Site-photo                     (1) | Val  Loss: 0.1671 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 0.1368 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.0995 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1366 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.2139 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.2098 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.2776 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.3834 | Val  Acc: 0.9149
 Site-art_painting              (1) | Val  Loss: 0.3587 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6607 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6324 | Val  Acc: 0.8701
 Site-sketch                    (0) | Val  Loss: 0.6969 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9383
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9429
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9794
 Best site-art_painting             (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:36 | Val Acc: 0.9333
 Best site-art_painting             (1)  | Epoch:36 | Val Acc: 0.9231
 Best site-art_painting             (1)  | Epoch:36 | Val Acc: 0.9149
 Best site-art_painting             (1)  | Epoch:36 | Val Acc: 0.9176
 Best site-cartoon                  (2)  | Epoch:36 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:36 | Val Acc: 0.8701
 Best site-sketch                   (0)  | Epoch:36 | Val Acc: 0.7436
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 37 ============
cnt=[15, 2, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1400 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1610 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1439 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0975 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1775 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1391 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1217 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1448 | Train Acc: 0.9432
 Site-photo                     (0) | Train Loss: 0.1723 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1699 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4092 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4405 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.5316 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.4728 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3962 | Train Acc: 0.8750
 Site-cartoon                   (1) | Train Loss: 0.3180 | Train Acc: 1.0000
 Site-cartoon                   (1) | Train Loss: 0.4737 | Train Acc: 0.8957
 Site-sketch                    (2) | Train Loss: 0.6268 | Train Acc: 0.8276
Average Train Accuracy: 0.9412
 Site-photo                     (0) | Val  Loss: 0.1112 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1059 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0752 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1529 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1103 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1476 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1835 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1137 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1056 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1039 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.1886 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5180 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.3691 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3204 | Val  Acc: 0.9787
 Site-art_painting              (0) | Val  Loss: 0.3765 | Val  Acc: 0.8941
 Site-cartoon                   (1) | Val  Loss: 0.4698 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 0.5582 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.7338 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9419
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:37 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.9787
 Best site-art_painting             (0)  | Epoch:37 | Val Acc: 0.8941
 Best site-cartoon                  (1)  | Epoch:37 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:37 | Val Acc: 0.9221
 Best site-sketch                   (2)  | Epoch:37 | Val Acc: 0.7949
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 38 ============
cnt=[15, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (0) | Train Loss: 0.1401 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1383 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2266 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 0.0909 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1761 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.1283 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0914 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1376 | Train Acc: 0.9659
 Site-photo                     (0) | Train Loss: 0.1216 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1144 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.4801 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.4837 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4345 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3994 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3711 | Train Acc: 0.9062
 Site-cartoon                   (2) | Train Loss: 0.5825 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4519 | Train Acc: 0.9217
 Site-sketch                    (1) | Train Loss: 0.6519 | Train Acc: 0.7586
Average Train Accuracy: 0.9287
 Site-photo                     (0) | Val  Loss: 0.2984 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2021 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0968 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1869 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1174 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1433 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1744 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1346 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.1071 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1372 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.2432 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2326 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2267 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.3001 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3238 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.7181 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5798 | Val  Acc: 0.9221
 Site-sketch                    (1) | Val  Loss: 0.6982 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9316
============ Train epoch 39 ============
cnt=[15, 1, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (0) | Train Loss: 0.1269 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1557 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1901 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1087 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1862 | Train Acc: 0.9250
 Site-photo                     (0) | Train Loss: 0.1106 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0816 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1817 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 0.1071 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.1569 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.3304 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.6225 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 0.5027 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 0.3870 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3339 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.4389 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4420 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.6705 | Train Acc: 0.8103
Average Train Accuracy: 0.9266
 Site-photo                     (0) | Val  Loss: 0.1077 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3183 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.0733 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2266 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0818 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1668 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.1468 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1201 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0947 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1304 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.1770 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3282 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3525 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3063 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.3199 | Val  Acc: 0.9294
 Site-cartoon                   (2) | Val  Loss: 0.6015 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5142 | Val  Acc: 0.8961
 Site-sketch                    (1) | Val  Loss: 0.6625 | Val  Acc: 0.8205
Average Valid Accuracy: 0.9424
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9556
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:39 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:39 | Val Acc: 0.9294
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:39 | Val Acc: 0.8961
 Best site-sketch                   (1)  | Epoch:39 | Val Acc: 0.8205
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_1_cluster_3/ccop_q=1...
============ Train epoch 40 ============
cnt=[15, 1, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (0) | Train Loss: 0.1260 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2192 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1655 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0930 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1553 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.1198 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1042 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1126 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1417 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1415 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.3660 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4654 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4213 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.2653 | Train Acc: 0.9306
 Site-art_painting              (0) | Train Loss: 0.3352 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.3745 | Train Acc: 1.0000
 Site-cartoon                   (2) | Train Loss: 0.3916 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.7042 | Train Acc: 0.7414
Average Train Accuracy: 0.9419
 Site-photo                     (0) | Val  Loss: 0.1510 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0755 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2119 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.0986 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1463 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1517 | Val  Acc: 0.9556
 Site-photo                     (0) | Val  Loss: 0.1398 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.0955 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0976 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.1016 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5782 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.4374 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3699 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3211 | Val  Acc: 0.8706
 Site-cartoon                   (2) | Val  Loss: 0.6522 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5086 | Val  Acc: 0.8961
 Site-sketch                    (1) | Val  Loss: 0.6311 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9304
 Test site-photo                     (0)| Epoch:39 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:39 | Test Acc: 0.8758
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8457
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.7306
photo: 0.9896, art_painting: 0.8758, cartoon: 0.8457, sketch: 0.7306, 
Average Test Accuracy(group): 0.8604, Average Test Accuracy(individual): 0.9276,
domain std=0.0922, cluster std=0.0902, individual std=0.0760, 
===2023-08-10 16:39:08===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 3
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 3
Loading snapshots...
 Test site-photo                     (0)| Epoch:39 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:39 | Test Acc: 0.8770
 Test site-cartoon                   (2)| Epoch:39 | Test Acc: 0.8457
 Test site-sketch                    (1)| Epoch:39 | Test Acc: 0.7300
photo: 0.9896, art_painting: 0.8770, cartoon: 0.8457, sketch: 0.7300, 
Average Test Accuracy(group): 0.8606, Average Test Accuracy(individual): 0.9279,
domain std=0.0924, cluster std=0.0907, individual std=0.0759, 
