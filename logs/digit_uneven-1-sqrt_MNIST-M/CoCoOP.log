===2023-03-30 05:00:30===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8405 | Train Acc: 0.4773
 Site-MNIST     | Train Loss: 1.7541 | Train Acc: 0.5795
 Site-MNIST     | Train Loss: 1.7457 | Train Acc: 0.5114
 Site-MNIST     | Train Loss: 1.6733 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 2.1982 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.1529 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1858 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 2.0965 | Train Acc: 0.2500
 Site-USPS      | Train Loss: 1.8259 | Train Acc: 0.4545
 Site-SynthDigits| Train Loss: 2.1443 | Train Acc: 0.2841
 Site-MNIST     | Val  Loss: 1.6745 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7550 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7889 | Val  Acc: 0.5424
 Site-MNIST     | Val  Loss: 1.7488 | Val  Acc: 0.6271
 Site-SVHN      | Val  Loss: 2.0863 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.2380 | Val  Acc: 0.1525
 Site-SVHN      | Val  Loss: 2.1295 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.2310 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.8077 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.1379 | Val  Acc: 0.3051
Average Valid Accuracy: 0.3949
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5424
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6271
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4164 | Train Acc: 0.7045
 Site-MNIST     | Train Loss: 1.3183 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.3416 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.2270 | Train Acc: 0.8295
 Site-SVHN      | Train Loss: 2.1296 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.0660 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0956 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9724 | Train Acc: 0.3750
 Site-USPS      | Train Loss: 1.4480 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 1.9732 | Train Acc: 0.3182
 Site-MNIST     | Val  Loss: 1.2613 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 1.3447 | Val  Acc: 0.7627
 Site-MNIST     | Val  Loss: 1.3726 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.3030 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.9481 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 2.1757 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.0307 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1516 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.4590 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 1.9656 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5237
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7627
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.1151 | Train Acc: 0.7841
 Site-MNIST     | Train Loss: 1.0068 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 1.0569 | Train Acc: 0.8409
 Site-MNIST     | Train Loss: 0.9499 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 2.1078 | Train Acc: 0.2386
 Site-SVHN      | Train Loss: 1.9810 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 2.0109 | Train Acc: 0.3182
 Site-SVHN      | Train Loss: 1.8765 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 1.1754 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.8307 | Train Acc: 0.4205
 Site-MNIST     | Val  Loss: 0.9613 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 1.0555 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 1.0840 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 1.0092 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.8435 | Val  Acc: 0.4576
 Site-SVHN      | Val  Loss: 2.1056 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 1.9677 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.0784 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.2011 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.8309 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5763
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4576
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.8746 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.8266 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.8613 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7718 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 2.0399 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 1.9088 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.9397 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.8040 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 1.0014 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.6961 | Train Acc: 0.4886
 Site-MNIST     | Val  Loss: 0.7815 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.8677 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.8953 | Val  Acc: 0.8305
 Site-MNIST     | Val  Loss: 0.8250 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.7568 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 2.0465 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.9308 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.0047 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.0312 | Val  Acc: 0.7966
 Site-SynthDigits| Val  Loss: 1.7283 | Val  Acc: 0.3390
Average Valid Accuracy: 0.5847
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8305
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2203
 Best site-USPS       | Epoch:3 | Val Acc: 0.7966
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.3390
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.7390 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.7081 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.7075 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6421 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.9851 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.8370 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 1.8878 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.6970 | Train Acc: 0.4659
 Site-USPS      | Train Loss: 0.8736 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.5744 | Train Acc: 0.5227
 Site-MNIST     | Val  Loss: 0.6448 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.7276 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7559 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6944 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.6723 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.9798 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.8790 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9366 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 0.8961 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.6225 | Val  Acc: 0.4237
Average Valid Accuracy: 0.6203
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2542
 Best site-USPS       | Epoch:4 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.6471 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.6083 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.6309 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5220 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.9664 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.7695 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7826 | Train Acc: 0.3977
 Site-SVHN      | Train Loss: 1.6708 | Train Acc: 0.4773
 Site-USPS      | Train Loss: 0.7668 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 1.4970 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.5486 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.6388 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6520 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6049 | Val  Acc: 0.8475
 Site-SVHN      | Val  Loss: 1.6098 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.9173 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 1.8238 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8681 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7781 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.5347 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6475
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2712
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.5492 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.5023 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.5378 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.4713 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.9276 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.6940 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.7061 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6132 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.6933 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.3705 | Train Acc: 0.5682
 Site-MNIST     | Val  Loss: 0.4723 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.5599 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5650 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.5234 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.5282 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.8631 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.7588 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.8081 | Val  Acc: 0.3051
 Site-USPS      | Val  Loss: 0.6978 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.4480 | Val  Acc: 0.5424
Average Valid Accuracy: 0.6763
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3051
 Best site-USPS       | Epoch:6 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.4958 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4933 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4713 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.3855 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8685 | Train Acc: 0.3068
 Site-SVHN      | Train Loss: 1.6265 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.6440 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5824 | Train Acc: 0.5568
 Site-USPS      | Train Loss: 0.6437 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.2808 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.4100 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4855 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.4859 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4561 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.4448 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.8098 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.6980 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.7314 | Val  Acc: 0.3220
 Site-USPS      | Val  Loss: 0.6549 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.3866 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6814
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3220
 Best site-USPS       | Epoch:7 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.4157 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4227 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.4287 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3333 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.8503 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.5696 | Train Acc: 0.4545
 Site-SVHN      | Train Loss: 1.6174 | Train Acc: 0.5114
 Site-SVHN      | Train Loss: 1.5002 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.5981 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.2395 | Train Acc: 0.6364
 Site-MNIST     | Val  Loss: 0.3560 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.4205 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.4149 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4080 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.3800 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.7544 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.6597 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6471 | Val  Acc: 0.3729
 Site-USPS      | Val  Loss: 0.6093 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3431 | Val  Acc: 0.5254
Average Valid Accuracy: 0.7017
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:8 | Val Acc: 0.3729
 Best site-USPS       | Epoch:8 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.3678 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3428 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.3815 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2852 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 1.7182 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.5379 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.5643 | Train Acc: 0.5227
 Site-SVHN      | Train Loss: 1.4786 | Train Acc: 0.6023
 Site-USPS      | Train Loss: 0.5289 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.1624 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.3144 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3743 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3612 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3694 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.3316 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.7072 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.6270 | Val  Acc: 0.4746
 Site-SVHN      | Val  Loss: 1.5630 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.5725 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.3052 | Val  Acc: 0.5763
Average Valid Accuracy: 0.7220
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:9 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4746
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4068
 Best site-USPS       | Epoch:9 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5763
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/CoCoOP_MNIST-M...
===2023-03-30 05:32:56===
===2023-03-30 05:32:57===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.3393
Average Test Accuracy: 0.3393
