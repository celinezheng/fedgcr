===2023-03-30 02:12:53===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.7826 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.6649 | Train Acc: 0.6250
 Site-MNIST     | Train Loss: 1.6858 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.5906 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 2.2251 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.1539 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.1557 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0709 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.8000 | Train Acc: 0.4659
 Site-SynthDigits| Train Loss: 2.1400 | Train Acc: 0.2727
 Site-MNIST     | Val  Loss: 1.6090 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.6992 | Val  Acc: 0.5254
 Site-MNIST     | Val  Loss: 1.7228 | Val  Acc: 0.5763
 Site-MNIST     | Val  Loss: 1.6669 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.0529 | Val  Acc: 0.3390
 Site-SVHN      | Val  Loss: 2.2205 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.1300 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2149 | Val  Acc: 0.1695
 Site-USPS      | Val  Loss: 1.7682 | Val  Acc: 0.4746
 Site-SynthDigits| Val  Loss: 2.1158 | Val  Acc: 0.3051
Average Valid Accuracy: 0.4169
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5763
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3390
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:0 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-USPS       | Epoch:0 | Val Acc: 0.4746
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.2226 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1420 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 1.1828 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 1.0576 | Train Acc: 0.8068
 Site-SVHN      | Train Loss: 2.1792 | Train Acc: 0.2273
 Site-SVHN      | Train Loss: 2.0064 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0526 | Train Acc: 0.2841
 Site-SVHN      | Train Loss: 1.8792 | Train Acc: 0.3636
 Site-USPS      | Train Loss: 1.2884 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.8735 | Train Acc: 0.3750
 Site-MNIST     | Val  Loss: 1.0828 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1690 | Val  Acc: 0.7797
 Site-MNIST     | Val  Loss: 1.2044 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.0991 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.8831 | Val  Acc: 0.3220
 Site-SVHN      | Val  Loss: 2.1357 | Val  Acc: 0.2373
 Site-SVHN      | Val  Loss: 1.9953 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.1063 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.3282 | Val  Acc: 0.7458
 Site-SynthDigits| Val  Loss: 1.9035 | Val  Acc: 0.3559
Average Valid Accuracy: 0.5169
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3220
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2373
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7458
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3559
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.8411 | Train Acc: 0.7500
 Site-MNIST     | Train Loss: 0.7757 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.7675 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.7076 | Train Acc: 0.8864
 Site-SVHN      | Train Loss: 2.0196 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 1.8505 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8895 | Train Acc: 0.3750
 Site-SVHN      | Train Loss: 1.7073 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.9313 | Train Acc: 0.7955
 Site-SynthDigits| Train Loss: 1.6869 | Train Acc: 0.4659
 Site-MNIST     | Val  Loss: 0.6917 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.7769 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.8356 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.7308 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 1.7020 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.9833 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 1.8502 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.9729 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 0.9720 | Val  Acc: 0.7627
 Site-SynthDigits| Val  Loss: 1.7115 | Val  Acc: 0.4068
Average Valid Accuracy: 0.5881
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:2 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2034
 Best site-USPS       | Epoch:2 | Val Acc: 0.7627
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.6522 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.5587 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.6226 | Train Acc: 0.8750
 Site-MNIST     | Train Loss: 0.5214 | Train Acc: 0.9205
 Site-SVHN      | Train Loss: 1.9011 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 1.7221 | Train Acc: 0.4432
 Site-SVHN      | Train Loss: 1.8157 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.5536 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.7025 | Train Acc: 0.8295
 Site-SynthDigits| Train Loss: 1.4553 | Train Acc: 0.5455
 Site-MNIST     | Val  Loss: 0.5020 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.6244 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6045 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5675 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.5365 | Val  Acc: 0.5593
 Site-SVHN      | Val  Loss: 1.8910 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.6829 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.8902 | Val  Acc: 0.2712
 Site-USPS      | Val  Loss: 0.7398 | Val  Acc: 0.8475
 Site-SynthDigits| Val  Loss: 1.6114 | Val  Acc: 0.4915
Average Valid Accuracy: 0.6542
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5593
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2712
 Best site-USPS       | Epoch:3 | Val Acc: 0.8475
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.3538 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3358 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.3374 | Train Acc: 0.9205
 Site-MNIST     | Train Loss: 0.2716 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.7632 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5055 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 1.5756 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.3677 | Train Acc: 0.5341
 Site-USPS      | Train Loss: 0.4813 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 1.3051 | Train Acc: 0.6250
 Site-MNIST     | Val  Loss: 0.2610 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3668 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3632 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3541 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.4346 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.7176 | Val  Acc: 0.3898
 Site-SVHN      | Val  Loss: 1.5806 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6644 | Val  Acc: 0.4237
 Site-USPS      | Val  Loss: 0.5070 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4984 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7068
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3898
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4237
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.3018 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2766 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2791 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2162 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5854 | Train Acc: 0.4886
 Site-SVHN      | Train Loss: 1.3184 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.4064 | Train Acc: 0.5682
 Site-SVHN      | Train Loss: 1.2098 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 0.3647 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.0630 | Train Acc: 0.6932
 Site-MNIST     | Val  Loss: 0.2116 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.3124 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2885 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2932 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.2083 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.5410 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.3443 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 1.4773 | Val  Acc: 0.5254
 Site-USPS      | Val  Loss: 0.3741 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3531 | Val  Acc: 0.5593
Average Valid Accuracy: 0.7525
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5254
 Best site-USPS       | Epoch:5 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5593
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1662 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1768 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1672 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1327 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 1.5007 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 1.1190 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 1.2660 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 1.2350 | Train Acc: 0.5227
 Site-USPS      | Train Loss: 0.4237 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.0783 | Train Acc: 0.6591
 Site-MNIST     | Val  Loss: 0.1263 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1883 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1921 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1781 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 1.1743 | Val  Acc: 0.6102
 Site-SVHN      | Val  Loss: 1.3261 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.1994 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 1.4273 | Val  Acc: 0.5593
 Site-USPS      | Val  Loss: 0.3323 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3576 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7695
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6102
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5593
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1532 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1431 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.1469 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0956 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.2151 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 0.9399 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 1.0364 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 0.9060 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.2898 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.7751 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.1149 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1579 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1469 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1582 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8960 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 1.0635 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 0.9538 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.1066 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.3048 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 1.2429 | Val  Acc: 0.5932
Average Valid Accuracy: 0.8203
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6610
 Best site-USPS       | Epoch:7 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5932
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0865 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0893 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0841 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0556 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 1.1194 | Train Acc: 0.6136
 Site-SVHN      | Train Loss: 0.7650 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.8717 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.8309 | Train Acc: 0.6818
 Site-USPS      | Train Loss: 0.2772 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.7075 | Train Acc: 0.7386
 Site-MNIST     | Val  Loss: 0.0612 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0936 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0910 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1047 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.8624 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 0.9018 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 0.8013 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 1.0106 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 0.2314 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 1.1924 | Val  Acc: 0.6102
Average Valid Accuracy: 0.8339
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6610
 Best site-USPS       | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0778 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0703 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0810 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0463 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.7761 | Train Acc: 0.7841
 Site-SVHN      | Train Loss: 0.5785 | Train Acc: 0.8523
 Site-SVHN      | Train Loss: 0.6715 | Train Acc: 0.8409
 Site-SVHN      | Train Loss: 0.5636 | Train Acc: 0.8409
 Site-USPS      | Train Loss: 0.1407 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.5077 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.0568 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0787 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0693 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0898 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.5941 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7423 | Val  Acc: 0.7966
 Site-SVHN      | Val  Loss: 0.5951 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7278 | Val  Acc: 0.8136
 Site-USPS      | Val  Loss: 0.1971 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0567 | Val  Acc: 0.6780
Average Valid Accuracy: 0.8915
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7966
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8136
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6780
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-1-sqrt/FedPrompt_MNIST-M...
===2023-03-30 02:46:36===
===2023-03-30 02:46:38===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of MNIST-M: 0.2936
Average Test Accuracy: 0.2936
