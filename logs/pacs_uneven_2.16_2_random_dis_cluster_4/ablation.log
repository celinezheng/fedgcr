===2023-08-13 19:34:33===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
============ Train epoch 0 ============
cnt=[7, 1, 1, 9, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (1) | Train Loss: 1.8310 | Train Acc: 0.4286
 Site-photo                     (3) | Train Loss: 1.8656 | Train Acc: 0.4444
 Site-photo                     (3) | Train Loss: 1.8224 | Train Acc: 0.5000
 Site-photo                     (3) | Train Loss: 1.8632 | Train Acc: 0.3871
 Site-photo                     (3) | Train Loss: 1.8324 | Train Acc: 0.5000
 Site-photo                     (3) | Train Loss: 1.8643 | Train Acc: 0.3846
 Site-photo                     (3) | Train Loss: 1.8690 | Train Acc: 0.4412
 Site-photo                     (3) | Train Loss: 1.8314 | Train Acc: 0.4432
 Site-photo                     (3) | Train Loss: 1.8489 | Train Acc: 0.4867
 Site-photo                     (3) | Train Loss: 1.8569 | Train Acc: 0.4521
 Site-art_painting              (0) | Train Loss: 1.9132 | Train Acc: 0.1667
 Site-art_painting              (0) | Train Loss: 1.9101 | Train Acc: 0.1364
 Site-art_painting              (0) | Train Loss: 1.8972 | Train Acc: 0.3750
 Site-art_painting              (0) | Train Loss: 1.9085 | Train Acc: 0.2778
 Site-art_painting              (0) | Train Loss: 1.9116 | Train Acc: 0.1953
 Site-cartoon                   (0) | Train Loss: 1.8984 | Train Acc: 0.3636
 Site-cartoon                   (0) | Train Loss: 1.9192 | Train Acc: 0.2522
 Site-sketch                    (2) | Train Loss: 1.9366 | Train Acc: 0.1207
Average Train Accuracy: 0.3531
 Site-photo                     (1) | Val  Loss: 1.8309 | Val  Acc: 0.5556
 Site-photo                     (3) | Val  Loss: 1.8458 | Val  Acc: 0.5000
 Site-photo                     (3) | Val  Loss: 1.8525 | Val  Acc: 0.3750
 Site-photo                     (3) | Val  Loss: 1.8472 | Val  Acc: 0.5238
 Site-photo                     (3) | Val  Loss: 1.8528 | Val  Acc: 0.4815
 Site-photo                     (3) | Val  Loss: 1.8203 | Val  Acc: 0.5143
 Site-photo                     (3) | Val  Loss: 1.8269 | Val  Acc: 0.4889
 Site-photo                     (3) | Val  Loss: 1.8642 | Val  Acc: 0.3103
 Site-photo                     (3) | Val  Loss: 1.8615 | Val  Acc: 0.4267
 Site-photo                     (3) | Val  Loss: 1.8492 | Val  Acc: 0.4433
 Site-art_painting              (0) | Val  Loss: 1.9263 | Val  Acc: 0.2500
 Site-art_painting              (0) | Val  Loss: 1.9034 | Val  Acc: 0.2667
 Site-art_painting              (0) | Val  Loss: 1.9205 | Val  Acc: 0.1923
 Site-art_painting              (0) | Val  Loss: 1.8986 | Val  Acc: 0.2553
 Site-art_painting              (0) | Val  Loss: 1.9032 | Val  Acc: 0.2824
 Site-cartoon                   (0) | Val  Loss: 1.8294 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.9202 | Val  Acc: 0.2208
 Site-sketch                    (2) | Val  Loss: 1.9381 | Val  Acc: 0.1538
Average Valid Accuracy: 0.3784
 Best site-photo                    (1)  | Epoch:0 | Val Acc: 0.5556
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.5000
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.3750
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.5238
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.4815
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.5143
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.4889
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.3103
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.4267
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.4433
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2667
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.1923
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2553
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2824
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.2208
 Best site-sketch                   (2)  | Epoch:0 | Val Acc: 0.1538
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 1 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.7514 | Train Acc: 0.7143
 Site-photo                     (1) | Train Loss: 1.7911 | Train Acc: 0.6667
 Site-photo                     (1) | Train Loss: 1.7461 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 1.7800 | Train Acc: 0.5806
 Site-photo                     (1) | Train Loss: 1.7701 | Train Acc: 0.7250
 Site-photo                     (1) | Train Loss: 1.7888 | Train Acc: 0.6154
 Site-photo                     (1) | Train Loss: 1.7576 | Train Acc: 0.6912
 Site-photo                     (1) | Train Loss: 1.7737 | Train Acc: 0.6818
 Site-photo                     (1) | Train Loss: 1.7723 | Train Acc: 0.7168
 Site-photo                     (1) | Train Loss: 1.7911 | Train Acc: 0.7123
 Site-art_painting              (3) | Train Loss: 1.8995 | Train Acc: 0.2500
 Site-art_painting              (3) | Train Loss: 1.8556 | Train Acc: 0.4545
 Site-art_painting              (3) | Train Loss: 1.8880 | Train Acc: 0.3750
 Site-art_painting              (3) | Train Loss: 1.8501 | Train Acc: 0.3750
 Site-art_painting              (3) | Train Loss: 1.8758 | Train Acc: 0.3281
 Site-cartoon                   (0) | Train Loss: 1.9034 | Train Acc: 0.1818
 Site-cartoon                   (0) | Train Loss: 1.8870 | Train Acc: 0.3217
 Site-sketch                    (2) | Train Loss: 1.9271 | Train Acc: 0.2069
Average Train Accuracy: 0.5193
 Site-photo                     (1) | Val  Loss: 1.7849 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.7670 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.7858 | Val  Acc: 0.6250
 Site-photo                     (1) | Val  Loss: 1.7938 | Val  Acc: 0.7143
 Site-photo                     (1) | Val  Loss: 1.7836 | Val  Acc: 0.7037
 Site-photo                     (1) | Val  Loss: 1.7481 | Val  Acc: 0.7714
 Site-photo                     (1) | Val  Loss: 1.7582 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.7846 | Val  Acc: 0.7241
 Site-photo                     (1) | Val  Loss: 1.7945 | Val  Acc: 0.6133
 Site-photo                     (1) | Val  Loss: 1.7744 | Val  Acc: 0.6804
 Site-art_painting              (3) | Val  Loss: 1.8832 | Val  Acc: 0.3750
 Site-art_painting              (3) | Val  Loss: 1.8769 | Val  Acc: 0.3333
 Site-art_painting              (3) | Val  Loss: 1.8848 | Val  Acc: 0.2308
 Site-art_painting              (3) | Val  Loss: 1.8574 | Val  Acc: 0.4468
 Site-art_painting              (3) | Val  Loss: 1.8767 | Val  Acc: 0.4118
 Site-cartoon                   (0) | Val  Loss: 1.8517 | Val  Acc: 0.2857
 Site-cartoon                   (0) | Val  Loss: 1.9022 | Val  Acc: 0.2338
 Site-sketch                    (2) | Val  Loss: 1.9340 | Val  Acc: 0.3333
Average Valid Accuracy: 0.5268
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6250
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7143
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7037
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7714
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7241
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6133
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6804
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.2308
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4468
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4118
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.2857
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.2338
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 2 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.6626 | Train Acc: 0.8571
 Site-photo                     (0) | Train Loss: 1.7391 | Train Acc: 0.8333
 Site-photo                     (0) | Train Loss: 1.6677 | Train Acc: 0.7917
 Site-photo                     (0) | Train Loss: 1.7142 | Train Acc: 0.8065
 Site-photo                     (0) | Train Loss: 1.6811 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 1.7313 | Train Acc: 0.7885
 Site-photo                     (0) | Train Loss: 1.6349 | Train Acc: 0.7647
 Site-photo                     (0) | Train Loss: 1.6852 | Train Acc: 0.8523
 Site-photo                     (0) | Train Loss: 1.7157 | Train Acc: 0.7965
 Site-photo                     (0) | Train Loss: 1.7051 | Train Acc: 0.8562
 Site-art_painting              (1) | Train Loss: 1.8491 | Train Acc: 0.2500
 Site-art_painting              (1) | Train Loss: 1.8505 | Train Acc: 0.4545
 Site-art_painting              (1) | Train Loss: 1.8471 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.8518 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.8395 | Train Acc: 0.4297
 Site-cartoon                   (3) | Train Loss: 1.8761 | Train Acc: 0.3636
 Site-cartoon                   (3) | Train Loss: 1.8588 | Train Acc: 0.3565
 Site-sketch                    (2) | Train Loss: 1.9234 | Train Acc: 0.2586
Average Train Accuracy: 0.6311
 Site-photo                     (0) | Val  Loss: 1.6964 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.7173 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 1.7477 | Val  Acc: 0.6875
 Site-photo                     (0) | Val  Loss: 1.7356 | Val  Acc: 0.8095
 Site-photo                     (0) | Val  Loss: 1.7111 | Val  Acc: 0.8519
 Site-photo                     (0) | Val  Loss: 1.6687 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.7076 | Val  Acc: 0.7333
 Site-photo                     (0) | Val  Loss: 1.7260 | Val  Acc: 0.7759
 Site-photo                     (0) | Val  Loss: 1.7147 | Val  Acc: 0.7867
 Site-photo                     (0) | Val  Loss: 1.7106 | Val  Acc: 0.8041
 Site-art_painting              (1) | Val  Loss: 1.8812 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.8348 | Val  Acc: 0.4000
 Site-art_painting              (1) | Val  Loss: 1.8327 | Val  Acc: 0.4231
 Site-art_painting              (1) | Val  Loss: 1.8188 | Val  Acc: 0.5957
 Site-art_painting              (1) | Val  Loss: 1.8427 | Val  Acc: 0.4706
 Site-cartoon                   (3) | Val  Loss: 1.8225 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.8842 | Val  Acc: 0.3506
 Site-sketch                    (2) | Val  Loss: 1.9144 | Val  Acc: 0.2308
Average Valid Accuracy: 0.6116
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.6875
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8095
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8519
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7333
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7759
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7867
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8041
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.4000
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.4231
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.5957
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.4706
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.3506
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 3 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.6110 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 1.6812 | Train Acc: 0.7778
 Site-photo                     (0) | Train Loss: 1.6031 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 1.6331 | Train Acc: 0.9032
 Site-photo                     (0) | Train Loss: 1.6058 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 1.6685 | Train Acc: 0.8077
 Site-photo                     (0) | Train Loss: 1.5620 | Train Acc: 0.8529
 Site-photo                     (0) | Train Loss: 1.6320 | Train Acc: 0.8977
 Site-photo                     (0) | Train Loss: 1.6557 | Train Acc: 0.8584
 Site-photo                     (0) | Train Loss: 1.6612 | Train Acc: 0.8699
 Site-art_painting              (1) | Train Loss: 1.8297 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.8176 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.7934 | Train Acc: 0.6250
 Site-art_painting              (1) | Train Loss: 1.8119 | Train Acc: 0.5556
 Site-art_painting              (1) | Train Loss: 1.8067 | Train Acc: 0.5703
 Site-cartoon                   (3) | Train Loss: 1.8676 | Train Acc: 0.2727
 Site-cartoon                   (3) | Train Loss: 1.8221 | Train Acc: 0.5304
 Site-sketch                    (2) | Train Loss: 1.9265 | Train Acc: 0.2069
Average Train Accuracy: 0.6958
 Site-photo                     (0) | Val  Loss: 1.6419 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.6523 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 1.6852 | Val  Acc: 0.8125
 Site-photo                     (0) | Val  Loss: 1.6852 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.6456 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.6022 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.6287 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.6646 | Val  Acc: 0.8621
 Site-photo                     (0) | Val  Loss: 1.6639 | Val  Acc: 0.8667
 Site-photo                     (0) | Val  Loss: 1.6473 | Val  Acc: 0.8454
 Site-art_painting              (1) | Val  Loss: 1.8328 | Val  Acc: 0.5000
 Site-art_painting              (1) | Val  Loss: 1.8007 | Val  Acc: 0.5333
 Site-art_painting              (1) | Val  Loss: 1.8122 | Val  Acc: 0.5385
 Site-art_painting              (1) | Val  Loss: 1.7908 | Val  Acc: 0.5957
 Site-art_painting              (1) | Val  Loss: 1.7992 | Val  Acc: 0.5647
 Site-cartoon                   (3) | Val  Loss: 1.7949 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 1.8559 | Val  Acc: 0.4286
 Site-sketch                    (2) | Val  Loss: 1.9252 | Val  Acc: 0.3077
Average Valid Accuracy: 0.6961
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8125
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8621
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8667
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8454
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5000
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5333
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5385
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5957
 Best site-art_painting             (1)  | Epoch:3 | Val Acc: 0.5647
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.5714
 Best site-cartoon                  (3)  | Epoch:3 | Val Acc: 0.4286
 Best site-sketch                   (2)  | Epoch:3 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 4 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 1.5327 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.6164 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.5672 | Train Acc: 0.7917
 Site-photo                     (0) | Train Loss: 1.5755 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 1.5530 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 1.6125 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 1.5811 | Train Acc: 0.8971
 Site-photo                     (0) | Train Loss: 1.5697 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 1.5905 | Train Acc: 0.9115
 Site-photo                     (0) | Train Loss: 1.5859 | Train Acc: 0.9178
 Site-art_painting              (2) | Train Loss: 1.7698 | Train Acc: 0.5833
 Site-art_painting              (2) | Train Loss: 1.8013 | Train Acc: 0.4545
 Site-art_painting              (2) | Train Loss: 1.7572 | Train Acc: 0.6000
 Site-art_painting              (2) | Train Loss: 1.7606 | Train Acc: 0.6528
 Site-art_painting              (2) | Train Loss: 1.7709 | Train Acc: 0.6172
 Site-cartoon                   (1) | Train Loss: 1.8324 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.8061 | Train Acc: 0.5391
 Site-sketch                    (3) | Train Loss: 1.9124 | Train Acc: 0.3448
Average Train Accuracy: 0.7500
 Site-photo                     (0) | Val  Loss: 1.5935 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.5870 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 1.6275 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.6107 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.5774 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 1.5384 | Val  Acc: 0.9143
 Site-photo                     (0) | Val  Loss: 1.5725 | Val  Acc: 0.9333
 Site-photo                     (0) | Val  Loss: 1.5963 | Val  Acc: 0.9310
 Site-photo                     (0) | Val  Loss: 1.5922 | Val  Acc: 0.9200
 Site-photo                     (0) | Val  Loss: 1.5806 | Val  Acc: 0.9175
 Site-art_painting              (2) | Val  Loss: 1.7938 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.7746 | Val  Acc: 0.5333
 Site-art_painting              (2) | Val  Loss: 1.7519 | Val  Acc: 0.6154
 Site-art_painting              (2) | Val  Loss: 1.7485 | Val  Acc: 0.5532
 Site-art_painting              (2) | Val  Loss: 1.7678 | Val  Acc: 0.5882
 Site-cartoon                   (1) | Val  Loss: 1.8057 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.8344 | Val  Acc: 0.4935
 Site-sketch                    (3) | Val  Loss: 1.9089 | Val  Acc: 0.3333
Average Valid Accuracy: 0.7408
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9143
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9333
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9310
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9200
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.9175
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5333
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.6154
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5532
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5882
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.4935
 Best site-sketch                   (3)  | Epoch:4 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 5 ============
cnt=[10, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (0) | Train Loss: 1.4480 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.5500 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 1.5043 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 1.5125 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 1.4971 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.5546 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 1.4976 | Train Acc: 0.9265
 Site-photo                     (0) | Train Loss: 1.4996 | Train Acc: 0.9545
 Site-photo                     (0) | Train Loss: 1.5330 | Train Acc: 0.9292
 Site-photo                     (0) | Train Loss: 1.5422 | Train Acc: 0.9247
 Site-art_painting              (3) | Train Loss: 1.7621 | Train Acc: 0.4167
 Site-art_painting              (2) | Train Loss: 1.7321 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.7313 | Train Acc: 0.6000
 Site-art_painting              (2) | Train Loss: 1.7489 | Train Acc: 0.6389
 Site-art_painting              (2) | Train Loss: 1.7310 | Train Acc: 0.6406
 Site-cartoon                   (2) | Train Loss: 1.8203 | Train Acc: 0.3636
 Site-cartoon                   (2) | Train Loss: 1.7814 | Train Acc: 0.5652
 Site-sketch                    (1) | Train Loss: 1.9025 | Train Acc: 0.2586
Average Train Accuracy: 0.7541
 Site-photo                     (0) | Val  Loss: 1.5301 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.5596 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 1.5748 | Val  Acc: 0.8125
 Site-photo                     (0) | Val  Loss: 1.5645 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.5202 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.4727 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 1.4997 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 1.5363 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 1.5264 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 1.5216 | Val  Acc: 0.9485
 Site-art_painting              (3) | Val  Loss: 1.7561 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.7498 | Val  Acc: 0.6667
 Site-art_painting              (2) | Val  Loss: 1.7268 | Val  Acc: 0.6538
 Site-art_painting              (2) | Val  Loss: 1.7339 | Val  Acc: 0.6383
 Site-art_painting              (2) | Val  Loss: 1.7288 | Val  Acc: 0.6118
 Site-cartoon                   (2) | Val  Loss: 1.7936 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.8093 | Val  Acc: 0.4675
 Site-sketch                    (1) | Val  Loss: 1.9034 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7591
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8125
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9778
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9483
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9600
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9485
 Best site-art_painting             (3)  | Epoch:5 | Val Acc: 0.6250
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6667
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6538
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6383
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6118
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.4675
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 6 ============
cnt=[1, 10, 5, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 1.3987 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.4995 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 1.4154 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 1.4504 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 1.4275 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.5001 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 1.4815 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 1.4501 | Train Acc: 0.9659
 Site-photo                     (1) | Train Loss: 1.4685 | Train Acc: 0.9204
 Site-photo                     (1) | Train Loss: 1.4526 | Train Acc: 0.9589
 Site-art_painting              (2) | Train Loss: 1.6712 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.7343 | Train Acc: 0.5909
 Site-art_painting              (2) | Train Loss: 1.7024 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.7011 | Train Acc: 0.6806
 Site-art_painting              (2) | Train Loss: 1.7046 | Train Acc: 0.6719
 Site-cartoon                   (3) | Train Loss: 1.8291 | Train Acc: 0.3636
 Site-cartoon                   (3) | Train Loss: 1.7579 | Train Acc: 0.5565
 Site-sketch                    (0) | Train Loss: 1.9047 | Train Acc: 0.3448
Average Train Accuracy: 0.7896
 Site-photo                     (1) | Val  Loss: 1.4809 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.5263 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.5146 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 1.5002 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 1.4531 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 1.4014 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.4528 | Val  Acc: 0.9556
 Site-photo                     (1) | Val  Loss: 1.4821 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 1.4760 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 1.4653 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 1.7414 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.7080 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.6737 | Val  Acc: 0.7692
 Site-art_painting              (2) | Val  Loss: 1.7056 | Val  Acc: 0.6383
 Site-art_painting              (2) | Val  Loss: 1.7085 | Val  Acc: 0.6588
 Site-cartoon                   (3) | Val  Loss: 1.7855 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.7916 | Val  Acc: 0.4935
 Site-sketch                    (0) | Val  Loss: 1.9098 | Val  Acc: 0.2308
Average Valid Accuracy: 0.7605
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.8750
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9556
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6000
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.7692
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6383
 Best site-art_painting             (2)  | Epoch:6 | Val Acc: 0.6588
 Best site-cartoon                  (3)  | Epoch:6 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:6 | Val Acc: 0.4935
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 7 ============
cnt=[1, 7, 1, 9, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (3) | Train Loss: 1.3159 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 1.4696 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 1.3771 | Train Acc: 0.8750
 Site-photo                     (3) | Train Loss: 1.3798 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 1.3803 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 1.4317 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 1.4388 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 1.3960 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 1.4035 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 1.4309 | Train Acc: 0.9384
 Site-art_painting              (1) | Train Loss: 1.7128 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.6829 | Train Acc: 0.5455
 Site-art_painting              (1) | Train Loss: 1.6780 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.7029 | Train Acc: 0.6528
 Site-art_painting              (1) | Train Loss: 1.6748 | Train Acc: 0.6719
 Site-cartoon                   (1) | Train Loss: 1.7924 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.7260 | Train Acc: 0.5913
 Site-sketch                    (2) | Train Loss: 1.9108 | Train Acc: 0.1897
Average Train Accuracy: 0.7749
 Site-photo                     (3) | Val  Loss: 1.4286 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.4629 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 1.4656 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 1.4454 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 1.4042 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 1.3514 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 1.3945 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 1.4229 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 1.4183 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 1.3977 | Val  Acc: 0.9691
 Site-art_painting              (1) | Val  Loss: 1.7313 | Val  Acc: 0.6250
 Site-art_painting              (1) | Val  Loss: 1.6553 | Val  Acc: 0.6000
 Site-art_painting              (1) | Val  Loss: 1.6767 | Val  Acc: 0.6538
 Site-art_painting              (1) | Val  Loss: 1.6369 | Val  Acc: 0.7872
 Site-art_painting              (1) | Val  Loss: 1.6569 | Val  Acc: 0.6824
 Site-cartoon                   (1) | Val  Loss: 1.7518 | Val  Acc: 0.4286
 Site-cartoon                   (1) | Val  Loss: 1.7547 | Val  Acc: 0.5844
 Site-sketch                    (2) | Val  Loss: 1.8986 | Val  Acc: 0.2308
Average Valid Accuracy: 0.7821
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9828
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9867
 Best site-photo                    (3)  | Epoch:7 | Val Acc: 0.9691
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6250
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6000
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6538
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.7872
 Best site-art_painting             (1)  | Epoch:7 | Val Acc: 0.6824
 Best site-cartoon                  (1)  | Epoch:7 | Val Acc: 0.4286
 Best site-cartoon                  (1)  | Epoch:7 | Val Acc: 0.5844
 Best site-sketch                   (2)  | Epoch:7 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 8 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (1) | Train Loss: 1.2587 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.3764 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 1.3050 | Train Acc: 0.9167
 Site-photo                     (1) | Train Loss: 1.3222 | Train Acc: 0.9677
 Site-photo                     (1) | Train Loss: 1.3097 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.4035 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 1.2286 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 1.3576 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 1.3559 | Train Acc: 0.9558
 Site-photo                     (1) | Train Loss: 1.3987 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 1.6782 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.6031 | Train Acc: 0.6364
 Site-art_painting              (2) | Train Loss: 1.6294 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.6295 | Train Acc: 0.7083
 Site-art_painting              (2) | Train Loss: 1.6255 | Train Acc: 0.6953
 Site-cartoon                   (0) | Train Loss: 1.7479 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 1.6992 | Train Acc: 0.6870
 Site-sketch                    (3) | Train Loss: 1.9000 | Train Acc: 0.3103
Average Train Accuracy: 0.8101
 Site-photo                     (1) | Val  Loss: 1.3462 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.3961 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 1.4207 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.3891 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 1.3514 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2987 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 1.3437 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.3721 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 1.3613 | Val  Acc: 0.9600
 Site-photo                     (1) | Val  Loss: 1.3504 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 1.6760 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.6191 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.6053 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.6171 | Val  Acc: 0.7447
 Site-art_painting              (2) | Val  Loss: 1.6292 | Val  Acc: 0.6941
 Site-cartoon                   (0) | Val  Loss: 1.7257 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.7355 | Val  Acc: 0.6234
 Site-sketch                    (3) | Val  Loss: 1.8661 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8164
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9600
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.6250
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.6000
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.7308
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.7447
 Best site-art_painting             (2)  | Epoch:8 | Val Acc: 0.6941
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.6234
 Best site-sketch                   (3)  | Epoch:8 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 9 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 1.2153 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 1.3739 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 1.2375 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 1.2711 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.2576 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.3418 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 1.2507 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 1.3003 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 1.3169 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 1.3167 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 1.5910 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.6223 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.5946 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 1.6376 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.6017 | Train Acc: 0.6953
 Site-cartoon                   (0) | Train Loss: 1.7645 | Train Acc: 0.4545
 Site-cartoon                   (0) | Train Loss: 1.6753 | Train Acc: 0.6174
 Site-sketch                    (3) | Train Loss: 1.8874 | Train Acc: 0.2759
Average Train Accuracy: 0.8178
 Site-photo                     (1) | Val  Loss: 1.3144 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.3642 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.3787 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.3398 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 1.2951 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2352 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2849 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.3282 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 1.3076 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 1.2894 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 1.6152 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.5949 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.6196 | Val  Acc: 0.5769
 Site-art_painting              (2) | Val  Loss: 1.5915 | Val  Acc: 0.7447
 Site-art_painting              (2) | Val  Loss: 1.5995 | Val  Acc: 0.6941
 Site-cartoon                   (0) | Val  Loss: 1.6725 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.7198 | Val  Acc: 0.6104
 Site-sketch                    (3) | Val  Loss: 1.8834 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8061
============ Train epoch 10 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 1.1119 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.3107 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.2086 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 1.2252 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.2040 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.2910 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 1.2582 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 1.2235 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 1.2569 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 1.2682 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 1.5959 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.5954 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.5797 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.5843 | Train Acc: 0.7639
 Site-art_painting              (1) | Train Loss: 1.5689 | Train Acc: 0.7188
 Site-cartoon                   (3) | Train Loss: 1.7481 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.6449 | Train Acc: 0.6783
 Site-sketch                    (2) | Train Loss: 1.8926 | Train Acc: 0.2241
Average Train Accuracy: 0.8239
 Site-photo                     (0) | Val  Loss: 1.2582 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.2839 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.3585 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 1.3007 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.2579 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1932 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 1.2392 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.2924 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 1.2580 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 1.2567 | Val  Acc: 0.9691
 Site-art_painting              (1) | Val  Loss: 1.6472 | Val  Acc: 0.5000
 Site-art_painting              (1) | Val  Loss: 1.5769 | Val  Acc: 0.6000
 Site-art_painting              (1) | Val  Loss: 1.5464 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.5291 | Val  Acc: 0.8085
 Site-art_painting              (1) | Val  Loss: 1.5698 | Val  Acc: 0.7176
 Site-cartoon                   (3) | Val  Loss: 1.6643 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.6942 | Val  Acc: 0.5714
 Site-sketch                    (2) | Val  Loss: 1.8686 | Val  Acc: 0.2051
Average Valid Accuracy: 0.8015
============ Train epoch 11 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (1) | Train Loss: 1.1066 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.2761 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 1.1547 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 1.1704 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.1792 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.2582 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 1.1858 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.1898 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 1.2255 | Train Acc: 0.9558
 Site-photo                     (1) | Train Loss: 1.2227 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 1.5572 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.5813 | Train Acc: 0.6818
 Site-art_painting              (0) | Train Loss: 1.5351 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 1.5339 | Train Acc: 0.7361
 Site-art_painting              (0) | Train Loss: 1.5328 | Train Acc: 0.7344
 Site-cartoon                   (3) | Train Loss: 1.7239 | Train Acc: 0.4545
 Site-cartoon                   (3) | Train Loss: 1.6223 | Train Acc: 0.6435
 Site-sketch                    (2) | Train Loss: 1.8550 | Train Acc: 0.2759
Average Train Accuracy: 0.8236
 Site-photo                     (1) | Val  Loss: 1.1696 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2892 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.2882 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.2500 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 1.1834 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.1400 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.1857 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.2436 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 1.2085 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 1.2097 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 1.5739 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.5289 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 1.4956 | Val  Acc: 0.7692
 Site-art_painting              (0) | Val  Loss: 1.5183 | Val  Acc: 0.8085
 Site-art_painting              (0) | Val  Loss: 1.5537 | Val  Acc: 0.7412
 Site-cartoon                   (3) | Val  Loss: 1.6429 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.6859 | Val  Acc: 0.6623
 Site-sketch                    (2) | Val  Loss: 1.8426 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8485
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:11 | Val Acc: 0.9691
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.7333
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.7692
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8085
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.7412
 Best site-cartoon                  (3)  | Epoch:11 | Val Acc: 0.8571
 Best site-cartoon                  (3)  | Epoch:11 | Val Acc: 0.6623
 Best site-sketch                   (2)  | Epoch:11 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 12 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 1.0642 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.2703 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.1211 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 1.1165 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1162 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.2046 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 1.1586 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1723 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1721 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 1.1935 | Train Acc: 0.9658
 Site-art_painting              (1) | Train Loss: 1.5330 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.5386 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.5344 | Train Acc: 0.7000
 Site-art_painting              (1) | Train Loss: 1.5041 | Train Acc: 0.7639
 Site-art_painting              (1) | Train Loss: 1.5048 | Train Acc: 0.7656
 Site-cartoon                   (3) | Train Loss: 1.6805 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 1.6118 | Train Acc: 0.6522
 Site-sketch                    (2) | Train Loss: 1.8634 | Train Acc: 0.3448
Average Train Accuracy: 0.8367
 Site-photo                     (0) | Val  Loss: 1.1787 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.2594 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 1.2710 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 1.2140 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.1474 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0831 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1575 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 1.1935 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 1.1632 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1601 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 1.5285 | Val  Acc: 0.6250
 Site-art_painting              (1) | Val  Loss: 1.4893 | Val  Acc: 0.6667
 Site-art_painting              (1) | Val  Loss: 1.5119 | Val  Acc: 0.7308
 Site-art_painting              (1) | Val  Loss: 1.4805 | Val  Acc: 0.8085
 Site-art_painting              (1) | Val  Loss: 1.5174 | Val  Acc: 0.7059
 Site-cartoon                   (3) | Val  Loss: 1.6826 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.6571 | Val  Acc: 0.6623
 Site-sketch                    (2) | Val  Loss: 1.8448 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8262
============ Train epoch 13 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.9869 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1979 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.0771 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 1.0884 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0688 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1471 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 1.0093 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1121 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 1.1299 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 1.1468 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 1.5005 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.5755 | Train Acc: 0.7273
 Site-art_painting              (2) | Train Loss: 1.4961 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 1.4588 | Train Acc: 0.7639
 Site-art_painting              (2) | Train Loss: 1.4721 | Train Acc: 0.7734
 Site-cartoon                   (1) | Train Loss: 1.6952 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.5726 | Train Acc: 0.6870
 Site-sketch                    (3) | Train Loss: 1.8669 | Train Acc: 0.2759
Average Train Accuracy: 0.8514
 Site-photo                     (0) | Val  Loss: 1.1280 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.1854 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 1.2222 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 1.1758 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.0971 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0610 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0873 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1404 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 1.1177 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 1.1162 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 1.5028 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.5057 | Val  Acc: 0.6667
 Site-art_painting              (2) | Val  Loss: 1.4355 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.4787 | Val  Acc: 0.7660
 Site-art_painting              (2) | Val  Loss: 1.4794 | Val  Acc: 0.7412
 Site-cartoon                   (1) | Val  Loss: 1.6541 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 1.6510 | Val  Acc: 0.5974
 Site-sketch                    (3) | Val  Loss: 1.8420 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8083
============ Train epoch 14 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (0) | Train Loss: 0.9675 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1353 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 1.0184 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 1.0426 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0340 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1234 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 1.0418 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0587 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 1.0792 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 1.0959 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 1.4724 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.4914 | Train Acc: 0.6818
 Site-art_painting              (3) | Train Loss: 1.4683 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.4597 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.4568 | Train Acc: 0.7500
 Site-cartoon                   (2) | Train Loss: 1.6381 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.5596 | Train Acc: 0.6522
 Site-sketch                    (1) | Train Loss: 1.8493 | Train Acc: 0.2931
Average Train Accuracy: 0.8486
 Site-photo                     (0) | Val  Loss: 1.0877 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 1.1323 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1628 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 1.1132 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0553 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.9987 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0536 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0982 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 1.0720 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0601 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 1.4447 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 1.4040 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 1.4242 | Val  Acc: 0.7308
 Site-art_painting              (3) | Val  Loss: 1.4258 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 1.4505 | Val  Acc: 0.7412
 Site-cartoon                   (2) | Val  Loss: 1.5833 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.6103 | Val  Acc: 0.6623
 Site-sketch                    (1) | Val  Loss: 1.8360 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8590
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9897
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.7500
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8000
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.7308
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8723
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.7412
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:14 | Val Acc: 0.6623
 Best site-sketch                   (1)  | Epoch:14 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 15 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (0) | Train Loss: 0.9251 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1337 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.9957 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.9857 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.9770 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.1002 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.9929 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0363 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 1.0348 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 1.0383 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 1.4385 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 1.4949 | Train Acc: 0.7273
 Site-art_painting              (3) | Train Loss: 1.4243 | Train Acc: 0.8000
 Site-art_painting              (3) | Train Loss: 1.3942 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.4416 | Train Acc: 0.7266
 Site-cartoon                   (2) | Train Loss: 1.6656 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.5238 | Train Acc: 0.6870
 Site-sketch                    (1) | Train Loss: 1.8304 | Train Acc: 0.2931
Average Train Accuracy: 0.8544
 Site-photo                     (0) | Val  Loss: 1.0396 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0642 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.1138 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 1.0838 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.0110 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.9567 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0170 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0553 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 1.0293 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 1.0251 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 1.4660 | Val  Acc: 0.6250
 Site-art_painting              (3) | Val  Loss: 1.4675 | Val  Acc: 0.6000
 Site-art_painting              (3) | Val  Loss: 1.4338 | Val  Acc: 0.6538
 Site-art_painting              (3) | Val  Loss: 1.3883 | Val  Acc: 0.8511
 Site-art_painting              (3) | Val  Loss: 1.4148 | Val  Acc: 0.7647
 Site-cartoon                   (2) | Val  Loss: 1.6408 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.5793 | Val  Acc: 0.7273
 Site-sketch                    (1) | Val  Loss: 1.8447 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8359
============ Train epoch 16 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (1) | Train Loss: 0.8691 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.0429 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.9747 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9445 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9589 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.0521 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.9322 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9998 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 1.0074 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 1.0137 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 1.4466 | Train Acc: 0.6667
 Site-art_painting              (3) | Train Loss: 1.4022 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.3913 | Train Acc: 0.7750
 Site-art_painting              (3) | Train Loss: 1.4589 | Train Acc: 0.7917
 Site-art_painting              (3) | Train Loss: 1.3959 | Train Acc: 0.7812
 Site-cartoon                   (0) | Train Loss: 1.6422 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 1.5241 | Train Acc: 0.7217
 Site-sketch                    (2) | Train Loss: 1.8326 | Train Acc: 0.3103
Average Train Accuracy: 0.8521
 Site-photo                     (1) | Val  Loss: 0.9906 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.0469 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.0984 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.0268 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.0134 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.9357 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9691 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 1.0284 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.9909 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9879 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 1.3938 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 1.3927 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 1.3427 | Val  Acc: 0.7692
 Site-art_painting              (3) | Val  Loss: 1.3791 | Val  Acc: 0.8298
 Site-art_painting              (3) | Val  Loss: 1.4280 | Val  Acc: 0.6824
 Site-cartoon                   (0) | Val  Loss: 1.5464 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.5853 | Val  Acc: 0.6753
 Site-sketch                    (2) | Val  Loss: 1.8296 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8471
============ Train epoch 17 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (1) | Train Loss: 0.8800 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.0824 | Train Acc: 0.8889
 Site-photo                     (1) | Train Loss: 0.9505 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.9055 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9119 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 1.0212 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.7640 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9490 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.9762 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 1.0005 | Train Acc: 0.9932
 Site-art_painting              (2) | Train Loss: 1.3942 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.3964 | Train Acc: 0.7273
 Site-art_painting              (2) | Train Loss: 1.3637 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 1.4179 | Train Acc: 0.7222
 Site-art_painting              (2) | Train Loss: 1.3563 | Train Acc: 0.7656
 Site-cartoon                   (0) | Train Loss: 1.5776 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 1.4767 | Train Acc: 0.7391
 Site-sketch                    (3) | Train Loss: 1.8023 | Train Acc: 0.2759
Average Train Accuracy: 0.8438
 Site-photo                     (1) | Val  Loss: 0.9851 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 1.0221 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 1.0869 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 1.0062 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.9535 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8988 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9504 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9936 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.9631 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9579 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 1.4059 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 1.3693 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.3083 | Val  Acc: 0.7308
 Site-art_painting              (2) | Val  Loss: 1.3230 | Val  Acc: 0.7660
 Site-art_painting              (2) | Val  Loss: 1.3827 | Val  Acc: 0.7176
 Site-cartoon                   (0) | Val  Loss: 1.5702 | Val  Acc: 1.0000
 Site-cartoon                   (0) | Val  Loss: 1.5458 | Val  Acc: 0.6883
 Site-sketch                    (3) | Val  Loss: 1.7896 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8517
============ Train epoch 18 ============
cnt=[3, 4, 10, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (2) | Train Loss: 0.8523 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 1.0576 | Train Acc: 0.8889
 Site-photo                     (2) | Train Loss: 0.8602 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.8736 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.8822 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.9807 | Train Acc: 0.9808
 Site-photo                     (2) | Train Loss: 1.0207 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.9130 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.9430 | Train Acc: 0.9735
 Site-photo                     (2) | Train Loss: 0.9430 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 1.3936 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.4051 | Train Acc: 0.6364
 Site-art_painting              (1) | Train Loss: 1.3614 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 1.2916 | Train Acc: 0.7361
 Site-art_painting              (1) | Train Loss: 1.3470 | Train Acc: 0.7578
 Site-cartoon                   (0) | Train Loss: 1.5732 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 1.4665 | Train Acc: 0.7130
 Site-sketch                    (0) | Train Loss: 1.8026 | Train Acc: 0.3793
Average Train Accuracy: 0.8460
 Site-photo                     (2) | Val  Loss: 0.9500 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 1.0535 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 1.0763 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.9770 | Val  Acc: 0.9524
 Site-photo                     (2) | Val  Loss: 0.8972 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.8691 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.9263 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.9528 | Val  Acc: 0.9655
 Site-photo                     (2) | Val  Loss: 0.9233 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.9219 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 1.3716 | Val  Acc: 0.6250
 Site-art_painting              (1) | Val  Loss: 1.3567 | Val  Acc: 0.6000
 Site-art_painting              (1) | Val  Loss: 1.2976 | Val  Acc: 0.7692
 Site-art_painting              (1) | Val  Loss: 1.3283 | Val  Acc: 0.7872
 Site-art_painting              (1) | Val  Loss: 1.3854 | Val  Acc: 0.7059
 Site-cartoon                   (0) | Val  Loss: 1.5348 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 1.5483 | Val  Acc: 0.6753
 Site-sketch                    (0) | Val  Loss: 1.8205 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8424
============ Train epoch 19 ============
cnt=[1, 7, 1, 9, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (3) | Train Loss: 0.7572 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.9568 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.8577 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.8532 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.8412 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.9390 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.8832 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.8965 | Train Acc: 0.9659
 Site-photo                     (3) | Train Loss: 0.8970 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.9082 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 1.3262 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 1.3919 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.2817 | Train Acc: 0.8500
 Site-art_painting              (1) | Train Loss: 1.3560 | Train Acc: 0.7778
 Site-art_painting              (1) | Train Loss: 1.3132 | Train Acc: 0.7891
 Site-cartoon                   (1) | Train Loss: 1.6105 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.4438 | Train Acc: 0.7130
 Site-sketch                    (2) | Train Loss: 1.7779 | Train Acc: 0.3448
Average Train Accuracy: 0.8584
 Site-photo                     (3) | Val  Loss: 0.9193 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.9522 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 1.0209 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.9445 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.8908 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.8449 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.8818 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.9247 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.8814 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.8894 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 1.3971 | Val  Acc: 0.6250
 Site-art_painting              (1) | Val  Loss: 1.3101 | Val  Acc: 0.7333
 Site-art_painting              (1) | Val  Loss: 1.2120 | Val  Acc: 0.8462
 Site-art_painting              (1) | Val  Loss: 1.2857 | Val  Acc: 0.8723
 Site-art_painting              (1) | Val  Loss: 1.3115 | Val  Acc: 0.7294
 Site-cartoon                   (1) | Val  Loss: 1.5562 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.4969 | Val  Acc: 0.7403
 Site-sketch                    (2) | Val  Loss: 1.7745 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8646
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9524
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9828
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9897
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.6250
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.7333
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.8462
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.8723
 Best site-art_painting             (1)  | Epoch:19 | Val Acc: 0.7294
 Best site-cartoon                  (1)  | Epoch:19 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:19 | Val Acc: 0.7403
 Best site-sketch                   (2)  | Epoch:19 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 20 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (1) | Train Loss: 0.7149 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.9710 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.8484 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.8233 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.8293 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.9349 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.8679 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.8383 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.8791 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.8766 | Train Acc: 0.9932
 Site-art_painting              (3) | Train Loss: 1.3672 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.3435 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 1.3257 | Train Acc: 0.8250
 Site-art_painting              (3) | Train Loss: 1.4007 | Train Acc: 0.7639
 Site-art_painting              (3) | Train Loss: 1.2836 | Train Acc: 0.8047
 Site-cartoon                   (2) | Train Loss: 1.5723 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 1.4169 | Train Acc: 0.7304
 Site-sketch                    (0) | Train Loss: 1.7738 | Train Acc: 0.2759
Average Train Accuracy: 0.8553
 Site-photo                     (1) | Val  Loss: 0.8883 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.9260 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.9956 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 0.9030 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.8352 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7796 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8507 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8790 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8448 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8502 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 1.2961 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 1.2227 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 1.2629 | Val  Acc: 0.7692
 Site-art_painting              (3) | Val  Loss: 1.2867 | Val  Acc: 0.8298
 Site-art_painting              (3) | Val  Loss: 1.2796 | Val  Acc: 0.7529
 Site-cartoon                   (2) | Val  Loss: 1.5392 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.4843 | Val  Acc: 0.6623
 Site-sketch                    (0) | Val  Loss: 1.7567 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8595
============ Train epoch 21 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (0) | Train Loss: 0.7166 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.9057 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.7909 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7675 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7741 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.8609 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.8482 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.8449 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.8384 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.8489 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 1.2441 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.3375 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.2409 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 1.3145 | Train Acc: 0.7917
 Site-art_painting              (2) | Train Loss: 1.2791 | Train Acc: 0.7812
 Site-cartoon                   (3) | Train Loss: 1.4876 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 1.4022 | Train Acc: 0.7217
 Site-sketch                    (1) | Train Loss: 1.7748 | Train Acc: 0.3448
Average Train Accuracy: 0.8763
 Site-photo                     (0) | Val  Loss: 0.8533 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.9246 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.9282 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.9045 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.8089 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7703 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8273 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8794 | Val  Acc: 0.9483
 Site-photo                     (0) | Val  Loss: 0.8062 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8165 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 1.2960 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 1.2505 | Val  Acc: 0.6667
 Site-art_painting              (2) | Val  Loss: 1.2418 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 1.2490 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 1.2820 | Val  Acc: 0.7529
 Site-cartoon                   (3) | Val  Loss: 1.4673 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.5071 | Val  Acc: 0.7532
 Site-sketch                    (1) | Val  Loss: 1.7670 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8654
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9483
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:21 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.7500
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.6667
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.8462
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.8298
 Best site-art_painting             (2)  | Epoch:21 | Val Acc: 0.7529
 Best site-cartoon                  (3)  | Epoch:21 | Val Acc: 0.8571
 Best site-cartoon                  (3)  | Epoch:21 | Val Acc: 0.7532
 Best site-sketch                   (1)  | Epoch:21 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 22 ============
cnt=[1, 10, 5, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (1) | Train Loss: 0.6843 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.8678 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.7469 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7477 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7683 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.8602 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.7225 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7802 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.8076 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.8379 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 1.2359 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 1.3531 | Train Acc: 0.6364
 Site-art_painting              (2) | Train Loss: 1.2426 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 1.2222 | Train Acc: 0.7639
 Site-art_painting              (2) | Train Loss: 1.2420 | Train Acc: 0.8203
 Site-cartoon                   (3) | Train Loss: 1.4479 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 1.3786 | Train Acc: 0.7826
 Site-sketch                    (0) | Train Loss: 1.7444 | Train Acc: 0.3966
Average Train Accuracy: 0.8852
 Site-photo                     (1) | Val  Loss: 0.8278 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.8943 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.8871 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.8466 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.7750 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7406 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7771 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8485 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.8068 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7838 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 1.2691 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.2155 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 1.1604 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 1.2578 | Val  Acc: 0.7447
 Site-art_painting              (2) | Val  Loss: 1.2752 | Val  Acc: 0.7882
 Site-cartoon                   (3) | Val  Loss: 1.4581 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.4693 | Val  Acc: 0.7403
 Site-sketch                    (0) | Val  Loss: 1.7611 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8553
============ Train epoch 23 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (1) | Train Loss: 0.6395 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.8603 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.7720 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7038 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7352 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.8012 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.6734 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7408 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.7573 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.8124 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 1.2477 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.3131 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.2158 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 1.3286 | Train Acc: 0.7778
 Site-art_painting              (0) | Train Loss: 1.2241 | Train Acc: 0.8281
 Site-cartoon                   (3) | Train Loss: 1.4664 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.3651 | Train Acc: 0.7478
 Site-sketch                    (2) | Train Loss: 1.7791 | Train Acc: 0.3276
Average Train Accuracy: 0.8711
 Site-photo                     (1) | Val  Loss: 0.7769 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8910 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.8778 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.8264 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7498 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7189 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7672 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8102 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.7635 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7869 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 1.1793 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.2249 | Val  Acc: 0.6667
 Site-art_painting              (0) | Val  Loss: 1.2033 | Val  Acc: 0.7692
 Site-art_painting              (0) | Val  Loss: 1.1838 | Val  Acc: 0.7872
 Site-art_painting              (0) | Val  Loss: 1.2222 | Val  Acc: 0.8000
 Site-cartoon                   (3) | Val  Loss: 1.4720 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.4390 | Val  Acc: 0.7403
 Site-sketch                    (2) | Val  Loss: 1.7343 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8708
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:23 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.6667
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.7692
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.7872
 Best site-art_painting             (0)  | Epoch:23 | Val Acc: 0.8000
 Best site-cartoon                  (3)  | Epoch:23 | Val Acc: 0.8571
 Best site-cartoon                  (3)  | Epoch:23 | Val Acc: 0.7403
 Best site-sketch                   (2)  | Epoch:23 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 24 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (0) | Train Loss: 0.6383 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.8081 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.7115 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6966 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7018 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7966 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.6547 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7124 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.7639 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.7472 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 1.2159 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.3549 | Train Acc: 0.6818
 Site-art_painting              (2) | Train Loss: 1.2083 | Train Acc: 0.7250
 Site-art_painting              (2) | Train Loss: 1.1810 | Train Acc: 0.7778
 Site-art_painting              (2) | Train Loss: 1.1778 | Train Acc: 0.8203
 Site-cartoon                   (1) | Train Loss: 1.4707 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 1.3567 | Train Acc: 0.7565
 Site-sketch                    (3) | Train Loss: 1.7495 | Train Acc: 0.3966
Average Train Accuracy: 0.8713
 Site-photo                     (0) | Val  Loss: 0.7926 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8249 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8795 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.7854 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7433 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6926 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7203 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7604 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7233 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7252 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 1.2164 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.1585 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 1.1495 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 1.2014 | Val  Acc: 0.8085
 Site-art_painting              (2) | Val  Loss: 1.1882 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 1.4512 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.4287 | Val  Acc: 0.7792
 Site-sketch                    (3) | Val  Loss: 1.7364 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8802
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:24 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.6250
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8077
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8085
 Best site-art_painting             (2)  | Epoch:24 | Val Acc: 0.8471
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:24 | Val Acc: 0.7792
 Best site-sketch                   (3)  | Epoch:24 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 25 ============
cnt=[10, 5, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.6213 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7766 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.7165 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.6722 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6458 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7340 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6573 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6956 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7361 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.7372 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 1.1904 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 1.2556 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.2072 | Train Acc: 0.7750
 Site-art_painting              (1) | Train Loss: 1.2144 | Train Acc: 0.7778
 Site-art_painting              (1) | Train Loss: 1.1846 | Train Acc: 0.8203
 Site-cartoon                   (2) | Train Loss: 1.4477 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.3249 | Train Acc: 0.7826
 Site-sketch                    (3) | Train Loss: 1.7181 | Train Acc: 0.3621
Average Train Accuracy: 0.8751
 Site-photo                     (0) | Val  Loss: 0.7635 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8007 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8266 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7734 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6966 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6357 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7141 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7558 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.7173 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7051 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 1.2607 | Val  Acc: 0.7500
 Site-art_painting              (1) | Val  Loss: 1.1397 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 1.1328 | Val  Acc: 0.7692
 Site-art_painting              (1) | Val  Loss: 1.1090 | Val  Acc: 0.8511
 Site-art_painting              (1) | Val  Loss: 1.1905 | Val  Acc: 0.8235
 Site-cartoon                   (2) | Val  Loss: 1.4277 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.4441 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.7111 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8853
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.7500
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.9333
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.7692
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.8511
 Best site-art_painting             (1)  | Epoch:25 | Val Acc: 0.8235
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:25 | Val Acc: 0.7532
 Best site-sketch                   (3)  | Epoch:25 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 26 ============
cnt=[1, 10, 5, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (1) | Train Loss: 0.5549 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7408 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.7144 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6594 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6290 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7414 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.7035 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6892 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6996 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.7162 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 1.1845 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.2718 | Train Acc: 0.7273
 Site-art_painting              (2) | Train Loss: 1.1730 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 1.1818 | Train Acc: 0.7639
 Site-art_painting              (2) | Train Loss: 1.1543 | Train Acc: 0.8203
 Site-cartoon                   (3) | Train Loss: 1.4499 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.3127 | Train Acc: 0.7652
 Site-sketch                    (0) | Train Loss: 1.6918 | Train Acc: 0.4483
Average Train Accuracy: 0.8799
 Site-photo                     (1) | Val  Loss: 0.7350 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7996 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8652 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 0.7385 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6932 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.6167 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6769 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7229 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.6915 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6865 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 1.1733 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.1181 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 1.0982 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 1.1435 | Val  Acc: 0.8085
 Site-art_painting              (2) | Val  Loss: 1.1659 | Val  Acc: 0.8000
 Site-cartoon                   (3) | Val  Loss: 1.4210 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.3796 | Val  Acc: 0.7922
 Site-sketch                    (0) | Val  Loss: 1.7048 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8714
============ Train epoch 27 ============
cnt=[1, 3, 5, 9, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (3) | Train Loss: 0.5804 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7286 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.6941 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.6078 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6263 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.7075 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6709 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6529 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6859 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.6974 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 1.1479 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.2868 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.1598 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 1.2213 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.1118 | Train Acc: 0.8047
 Site-cartoon                   (1) | Train Loss: 1.4171 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 1.2834 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 1.6979 | Train Acc: 0.3966
Average Train Accuracy: 0.8879
 Site-photo                     (3) | Val  Loss: 0.6916 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.8040 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.8260 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.7256 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6280 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6122 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6671 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.7247 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.6392 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6584 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 1.1655 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.1056 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 1.1101 | Val  Acc: 0.7692
 Site-art_painting              (2) | Val  Loss: 1.1166 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 1.1153 | Val  Acc: 0.8353
 Site-cartoon                   (1) | Val  Loss: 1.3708 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.3600 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 1.7222 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8858
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 0.9828
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:27 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:27 | Val Acc: 0.6250
 Best site-art_painting             (2)  | Epoch:27 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:27 | Val Acc: 0.7692
 Best site-art_painting             (2)  | Epoch:27 | Val Acc: 0.8298
 Best site-art_painting             (2)  | Epoch:27 | Val Acc: 0.8353
 Best site-cartoon                  (1)  | Epoch:27 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:27 | Val Acc: 0.8312
 Best site-sketch                   (1)  | Epoch:27 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 28 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (1) | Train Loss: 0.6244 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6976 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.6559 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5873 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6042 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7015 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.5896 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6445 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.6647 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.6950 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 1.1763 | Train Acc: 0.7500
 Site-art_painting              (0) | Train Loss: 1.1984 | Train Acc: 0.7273
 Site-art_painting              (0) | Train Loss: 1.1978 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 1.1287 | Train Acc: 0.7778
 Site-art_painting              (0) | Train Loss: 1.1123 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 1.4317 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.2735 | Train Acc: 0.8087
 Site-sketch                    (2) | Train Loss: 1.7301 | Train Acc: 0.3276
Average Train Accuracy: 0.8701
 Site-photo                     (1) | Val  Loss: 0.6381 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7640 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.8133 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 0.6871 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6330 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6016 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6357 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6863 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6373 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.6547 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 1.2215 | Val  Acc: 0.6250
 Site-art_painting              (0) | Val  Loss: 1.1542 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 1.0678 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 1.0496 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 1.1307 | Val  Acc: 0.8118
 Site-cartoon                   (3) | Val  Loss: 1.3450 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 1.3638 | Val  Acc: 0.7922
 Site-sketch                    (2) | Val  Loss: 1.6800 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8920
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 0.8750
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:28 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.6250
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.8000
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.8936
 Best site-art_painting             (0)  | Epoch:28 | Val Acc: 0.8118
 Best site-cartoon                  (3)  | Epoch:28 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:28 | Val Acc: 0.7922
 Best site-sketch                   (2)  | Epoch:28 | Val Acc: 0.4872
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 29 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (1) | Train Loss: 0.5379 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7225 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.6000 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5674 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5785 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6556 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5539 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6449 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.6482 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.6687 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 1.0725 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 1.1676 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.1734 | Train Acc: 0.8000
 Site-art_painting              (0) | Train Loss: 1.1780 | Train Acc: 0.7778
 Site-art_painting              (0) | Train Loss: 1.0872 | Train Acc: 0.8516
 Site-cartoon                   (3) | Train Loss: 1.4207 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.2697 | Train Acc: 0.7913
 Site-sketch                    (2) | Train Loss: 1.7224 | Train Acc: 0.3793
Average Train Accuracy: 0.8885
 Site-photo                     (1) | Val  Loss: 0.6700 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7574 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.7317 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6730 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.5985 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5864 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6036 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6486 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6148 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.6109 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 1.1787 | Val  Acc: 0.6250
 Site-art_painting              (0) | Val  Loss: 1.0843 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 1.1065 | Val  Acc: 0.7692
 Site-art_painting              (0) | Val  Loss: 1.0282 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 1.1159 | Val  Acc: 0.8353
 Site-cartoon                   (3) | Val  Loss: 1.3627 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.3247 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 1.6993 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8764
============ Train epoch 30 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (0) | Train Loss: 0.4973 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6940 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.6810 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.5732 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5399 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6784 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.6319 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.6301 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.6302 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.6602 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 1.1213 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.1735 | Train Acc: 0.7727
 Site-art_painting              (1) | Train Loss: 1.1864 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 1.0622 | Train Acc: 0.8194
 Site-art_painting              (1) | Train Loss: 1.0748 | Train Acc: 0.8281
 Site-cartoon                   (3) | Train Loss: 1.3769 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.2087 | Train Acc: 0.8261
 Site-sketch                    (2) | Train Loss: 1.6667 | Train Acc: 0.3793
Average Train Accuracy: 0.8728
 Site-photo                     (0) | Val  Loss: 0.6651 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.7226 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.7207 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6595 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.6080 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.5681 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6049 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6300 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.6103 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5884 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 1.1131 | Val  Acc: 0.7500
 Site-art_painting              (1) | Val  Loss: 0.9927 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 1.0279 | Val  Acc: 0.8846
 Site-art_painting              (1) | Val  Loss: 1.0336 | Val  Acc: 0.8085
 Site-art_painting              (1) | Val  Loss: 1.0709 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.3354 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.3290 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 1.6782 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8861
============ Train epoch 31 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.5157 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6837 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5555 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5303 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5704 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6182 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5104 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.6004 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.5930 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.5888 | Train Acc: 0.9932
 Site-art_painting              (1) | Train Loss: 1.0763 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 1.2047 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.0799 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 1.1401 | Train Acc: 0.8194
 Site-art_painting              (1) | Train Loss: 1.0415 | Train Acc: 0.8594
 Site-cartoon                   (3) | Train Loss: 1.3342 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.1677 | Train Acc: 0.8000
 Site-sketch                    (2) | Train Loss: 1.6380 | Train Acc: 0.4828
Average Train Accuracy: 0.8925
 Site-photo                     (0) | Val  Loss: 0.5764 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.6870 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7110 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.6472 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5889 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5281 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5728 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6371 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.5924 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5763 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 1.1017 | Val  Acc: 0.7500
 Site-art_painting              (1) | Val  Loss: 0.9660 | Val  Acc: 1.0000
 Site-art_painting              (1) | Val  Loss: 0.9789 | Val  Acc: 0.8846
 Site-art_painting              (1) | Val  Loss: 1.0490 | Val  Acc: 0.8085
 Site-art_painting              (1) | Val  Loss: 1.0583 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.3424 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 1.3011 | Val  Acc: 0.7922
 Site-sketch                    (2) | Val  Loss: 1.6900 | Val  Acc: 0.4103
Average Valid Accuracy: 0.9028
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:31 | Val Acc: 0.9897
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.7500
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.8846
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.8085
 Best site-art_painting             (1)  | Epoch:31 | Val Acc: 0.8235
 Best site-cartoon                  (3)  | Epoch:31 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:31 | Val Acc: 0.7922
 Best site-sketch                   (2)  | Epoch:31 | Val Acc: 0.4103
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 32 ============
cnt=[1, 7, 1, 9, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.4456 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6710 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.5166 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5322 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5112 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.6141 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.5403 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.5557 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.5747 | Train Acc: 0.9912
 Site-photo                     (3) | Train Loss: 0.5901 | Train Acc: 0.9932
 Site-art_painting              (1) | Train Loss: 1.1262 | Train Acc: 0.7500
 Site-art_painting              (1) | Train Loss: 1.2003 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.0834 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 1.1755 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 1.0239 | Train Acc: 0.8281
 Site-cartoon                   (1) | Train Loss: 1.3822 | Train Acc: 0.6364
 Site-cartoon                   (1) | Train Loss: 1.1856 | Train Acc: 0.8000
 Site-sketch                    (2) | Train Loss: 1.6255 | Train Acc: 0.4138
Average Train Accuracy: 0.8707
 Site-photo                     (0) | Val  Loss: 0.6022 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6876 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.7055 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.6261 | Val  Acc: 0.9524
 Site-photo                     (3) | Val  Loss: 0.5371 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5319 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5956 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.6085 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.5393 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5784 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 1.0444 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 1.0494 | Val  Acc: 0.8000
 Site-art_painting              (1) | Val  Loss: 1.0342 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 1.0124 | Val  Acc: 0.8511
 Site-art_painting              (1) | Val  Loss: 1.0186 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 1.2342 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.2912 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 1.6108 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9014
============ Train epoch 33 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (0) | Train Loss: 0.4764 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6340 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5323 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.5344 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5033 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5948 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4947 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5532 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5509 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5558 | Train Acc: 0.9863
 Site-art_painting              (1) | Train Loss: 1.0238 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 1.1709 | Train Acc: 0.6818
 Site-art_painting              (1) | Train Loss: 1.0755 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.9639 | Train Acc: 0.8056
 Site-art_painting              (1) | Train Loss: 0.9767 | Train Acc: 0.8594
 Site-cartoon                   (3) | Train Loss: 1.3320 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.1524 | Train Acc: 0.8348
 Site-sketch                    (2) | Train Loss: 1.6328 | Train Acc: 0.4483
Average Train Accuracy: 0.8919
 Site-photo                     (0) | Val  Loss: 0.5433 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6563 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7233 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.5765 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5110 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4943 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5434 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5657 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5296 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5554 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 1.0296 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 1.0031 | Val  Acc: 0.8000
 Site-art_painting              (1) | Val  Loss: 0.9930 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 1.0302 | Val  Acc: 0.8511
 Site-art_painting              (1) | Val  Loss: 1.0164 | Val  Acc: 0.8000
 Site-cartoon                   (3) | Val  Loss: 1.2868 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.2407 | Val  Acc: 0.8312
 Site-sketch                    (2) | Val  Loss: 1.6149 | Val  Acc: 0.4872
Average Valid Accuracy: 0.9015
============ Train epoch 34 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.4306 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.6324 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.5103 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4772 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4780 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5969 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.5646 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5205 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.5484 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5763 | Train Acc: 0.9726
 Site-art_painting              (1) | Train Loss: 1.0446 | Train Acc: 0.8333
 Site-art_painting              (1) | Train Loss: 1.1647 | Train Acc: 0.7273
 Site-art_painting              (1) | Train Loss: 1.0705 | Train Acc: 0.8250
 Site-art_painting              (1) | Train Loss: 0.9477 | Train Acc: 0.8611
 Site-art_painting              (1) | Train Loss: 1.0144 | Train Acc: 0.8125
 Site-cartoon                   (3) | Train Loss: 1.3392 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.1839 | Train Acc: 0.8087
 Site-sketch                    (2) | Train Loss: 1.5985 | Train Acc: 0.4828
Average Train Accuracy: 0.8909
 Site-photo                     (0) | Val  Loss: 0.5900 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.6277 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.7083 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.5545 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5568 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.4929 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5270 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5612 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.4943 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5116 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 1.0360 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.9848 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.9756 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 0.9669 | Val  Acc: 0.8723
 Site-art_painting              (1) | Val  Loss: 1.0081 | Val  Acc: 0.8471
 Site-cartoon                   (3) | Val  Loss: 1.2649 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.2800 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 1.6389 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8969
============ Train epoch 35 ============
cnt=[1, 10, 5, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (1) | Train Loss: 0.4319 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5858 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.5447 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4605 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4762 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5578 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4417 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5383 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5202 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.5432 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.9932 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 1.1749 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.0648 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 0.9913 | Train Acc: 0.8472
 Site-art_painting              (2) | Train Loss: 0.9572 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 1.3107 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 1.1652 | Train Acc: 0.8435
 Site-sketch                    (0) | Train Loss: 1.6206 | Train Acc: 0.4138
Average Train Accuracy: 0.8930
 Site-photo                     (1) | Val  Loss: 0.6067 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.6031 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6679 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.5728 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4889 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4601 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5151 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5585 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4893 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.5140 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.9527 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.9330 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.9635 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.9145 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 1.0108 | Val  Acc: 0.8118
 Site-cartoon                   (3) | Val  Loss: 1.2549 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 1.2597 | Val  Acc: 0.8182
 Site-sketch                    (0) | Val  Loss: 1.6189 | Val  Acc: 0.4103
Average Valid Accuracy: 0.9021
============ Train epoch 36 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (1) | Train Loss: 0.3953 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5926 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4662 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4562 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4512 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5638 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.5242 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4969 | Train Acc: 0.9659
 Site-photo                     (1) | Train Loss: 0.5032 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5022 | Train Acc: 0.9932
 Site-art_painting              (0) | Train Loss: 1.0014 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.0825 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.9593 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 1.0574 | Train Acc: 0.8056
 Site-art_painting              (0) | Train Loss: 0.9784 | Train Acc: 0.8594
 Site-cartoon                   (3) | Train Loss: 1.3234 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.1299 | Train Acc: 0.8261
 Site-sketch                    (2) | Train Loss: 1.6153 | Train Acc: 0.4138
Average Train Accuracy: 0.9006
 Site-photo                     (1) | Val  Loss: 0.6058 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.6241 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6704 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.5369 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4731 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4675 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5004 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5414 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.5184 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4906 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.9715 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 1.0084 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.9342 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.9818 | Val  Acc: 0.8511
 Site-art_painting              (0) | Val  Loss: 1.0087 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.1556 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 1.2248 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 1.6384 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9030
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:36 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:36 | Val Acc: 0.7500
 Best site-art_painting             (0)  | Epoch:36 | Val Acc: 0.8667
 Best site-art_painting             (0)  | Epoch:36 | Val Acc: 0.8846
 Best site-art_painting             (0)  | Epoch:36 | Val Acc: 0.8511
 Best site-art_painting             (0)  | Epoch:36 | Val Acc: 0.8235
 Best site-cartoon                  (3)  | Epoch:36 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:36 | Val Acc: 0.8182
 Best site-sketch                   (2)  | Epoch:36 | Val Acc: 0.4615
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 37 ============
cnt=[1, 1, 7, 9, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (3) | Train Loss: 0.4272 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5848 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.4737 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4455 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4216 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5226 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.6119 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4806 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.5228 | Train Acc: 0.9823
 Site-photo                     (3) | Train Loss: 0.5125 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.9773 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 1.0766 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.9799 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.8962 | Train Acc: 0.8056
 Site-art_painting              (2) | Train Loss: 0.9270 | Train Acc: 0.8828
 Site-cartoon                   (2) | Train Loss: 1.3458 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.1148 | Train Acc: 0.8609
 Site-sketch                    (1) | Train Loss: 1.5727 | Train Acc: 0.4483
Average Train Accuracy: 0.9099
 Site-photo                     (3) | Val  Loss: 0.5606 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.6458 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5779 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5291 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4559 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4740 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.4917 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.5227 | Val  Acc: 0.9828
 Site-photo                     (3) | Val  Loss: 0.4632 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.4860 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.9857 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.9287 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.9170 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.9199 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.9678 | Val  Acc: 0.8118
 Site-cartoon                   (2) | Val  Loss: 1.2851 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 1.1857 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 1.6019 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8877
============ Train epoch 38 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (1) | Train Loss: 0.3443 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5517 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.5005 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4043 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4176 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5382 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.4804 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4311 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4868 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.5095 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.9322 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 1.1014 | Train Acc: 0.7727
 Site-art_painting              (0) | Train Loss: 1.0233 | Train Acc: 0.8500
 Site-art_painting              (0) | Train Loss: 1.0628 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.9501 | Train Acc: 0.8516
 Site-cartoon                   (3) | Train Loss: 1.2797 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.0946 | Train Acc: 0.8348
 Site-sketch                    (2) | Train Loss: 1.5385 | Train Acc: 0.4655
Average Train Accuracy: 0.8999
 Site-photo                     (1) | Val  Loss: 0.5324 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5164 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6246 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.5018 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4358 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4308 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4582 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5032 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4674 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.4730 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.9303 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 0.9639 | Val  Acc: 0.7333
 Site-art_painting              (0) | Val  Loss: 0.8432 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.8938 | Val  Acc: 0.8085
 Site-art_painting              (0) | Val  Loss: 0.9641 | Val  Acc: 0.8118
 Site-cartoon                   (3) | Val  Loss: 1.1834 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.1798 | Val  Acc: 0.8442
 Site-sketch                    (2) | Val  Loss: 1.5893 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8937
============ Train epoch 39 ============
cnt=[1, 10, 5, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (1) | Train Loss: 0.3867 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5409 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4721 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4007 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4252 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5006 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.4398 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4767 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.4721 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.4729 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.9731 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 1.0804 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.9450 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 1.1021 | Train Acc: 0.8472
 Site-art_painting              (2) | Train Loss: 0.8891 | Train Acc: 0.8594
 Site-cartoon                   (3) | Train Loss: 1.2211 | Train Acc: 0.9091
 Site-cartoon                   (3) | Train Loss: 1.0772 | Train Acc: 0.8435
 Site-sketch                    (0) | Train Loss: 1.5284 | Train Acc: 0.5517
Average Train Accuracy: 0.9167
 Site-photo                     (1) | Val  Loss: 0.5341 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5447 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6023 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4849 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4174 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4022 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4434 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4858 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4558 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4498 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.9411 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.9337 | Val  Acc: 0.7333
 Site-art_painting              (2) | Val  Loss: 0.9298 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 0.8857 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.9137 | Val  Acc: 0.8471
 Site-cartoon                   (3) | Val  Loss: 1.2562 | Val  Acc: 1.0000
 Site-cartoon                   (3) | Val  Loss: 1.1546 | Val  Acc: 0.8442
 Site-sketch                    (0) | Val  Loss: 1.5554 | Val  Acc: 0.5128
Average Valid Accuracy: 0.9043
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:39 | Val Acc: 0.9897
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.7500
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.7333
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.8077
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.8723
 Best site-art_painting             (2)  | Epoch:39 | Val Acc: 0.8471
 Best site-cartoon                  (3)  | Epoch:39 | Val Acc: 1.0000
 Best site-cartoon                  (3)  | Epoch:39 | Val Acc: 0.8442
 Best site-sketch                   (0)  | Epoch:39 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 40 ============
cnt=[5, 10, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (1) | Train Loss: 0.3301 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5237 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4365 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3918 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3881 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4712 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5864 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.4475 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4604 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.4724 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.9884 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 1.0528 | Train Acc: 0.8182
 Site-art_painting              (0) | Train Loss: 0.9942 | Train Acc: 0.7750
 Site-art_painting              (0) | Train Loss: 0.8441 | Train Acc: 0.8194
 Site-art_painting              (0) | Train Loss: 0.9015 | Train Acc: 0.8750
 Site-cartoon                   (2) | Train Loss: 1.2449 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 1.0803 | Train Acc: 0.8261
 Site-sketch                    (3) | Train Loss: 1.5646 | Train Acc: 0.4310
Average Train Accuracy: 0.8946
 Site-photo                     (1) | Val  Loss: 0.4577 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5188 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5261 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4872 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4102 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3991 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4355 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4743 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.4167 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.4164 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.9121 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.8842 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.9064 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 0.8292 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.9113 | Val  Acc: 0.8588
 Site-cartoon                   (2) | Val  Loss: 1.1506 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 1.1544 | Val  Acc: 0.8831
 Site-sketch                    (3) | Val  Loss: 1.5444 | Val  Acc: 0.4872
Average Valid Accuracy: 0.9230
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:40 | Val Acc: 0.9897
 Best site-art_painting             (0)  | Epoch:40 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:40 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:40 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:40 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:40 | Val Acc: 0.8588
 Best site-cartoon                  (2)  | Epoch:40 | Val Acc: 0.8571
 Best site-cartoon                  (2)  | Epoch:40 | Val Acc: 0.8831
 Best site-sketch                   (3)  | Epoch:40 | Val Acc: 0.4872
 Test site-photo                     (1)| Epoch:40 | Test Acc: 0.9985
 Test site-art_painting              (0)| Epoch:40 | Test Acc: 0.8538
 Test site-cartoon                   (2)| Epoch:40 | Test Acc: 0.7383
 Test site-sketch                    (3)| Epoch:40 | Test Acc: 0.4886
photo: 0.9985, art_painting: 0.8538, cartoon: 0.7383, sketch: 0.4886, 
Average Test Accuracy(group): 0.7698, Average Test Accuracy(individual): 0.9011,
domain std=0.1867, cluster std=0.1867, individual std=0.1352, 
Average Test Accuracy: 0.7698
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 41 ============
cnt=[5, 10, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (1) | Train Loss: 0.3329 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5518 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4846 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3837 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4027 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4716 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.4365 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4241 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.4633 | Train Acc: 0.9823
 Site-photo                     (1) | Train Loss: 0.4441 | Train Acc: 0.9863
 Site-art_painting              (0) | Train Loss: 0.9385 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 1.0048 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 1.0024 | Train Acc: 0.8250
 Site-art_painting              (0) | Train Loss: 0.8667 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.8971 | Train Acc: 0.8672
 Site-cartoon                   (3) | Train Loss: 1.1925 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.0668 | Train Acc: 0.8000
 Site-sketch                    (2) | Train Loss: 1.5387 | Train Acc: 0.4310
Average Train Accuracy: 0.9090
 Site-photo                     (1) | Val  Loss: 0.5142 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.5713 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.6149 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.4687 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3942 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3995 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4433 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4414 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4081 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.4219 | Val  Acc: 0.9897
 Site-art_painting              (0) | Val  Loss: 0.9438 | Val  Acc: 0.7500
 Site-art_painting              (0) | Val  Loss: 0.8427 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.8971 | Val  Acc: 0.8077
 Site-art_painting              (0) | Val  Loss: 0.8628 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.9317 | Val  Acc: 0.8235
 Site-cartoon                   (3) | Val  Loss: 1.1381 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.1472 | Val  Acc: 0.8182
 Site-sketch                    (2) | Val  Loss: 1.5373 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8853
 Test site-photo                     (1)| Epoch:40 | Test Acc: 0.9985
 Test site-art_painting              (0)| Epoch:40 | Test Acc: 0.8526
 Test site-cartoon                   (3)| Epoch:40 | Test Acc: 0.7372
 Test site-sketch                    (2)| Epoch:40 | Test Acc: 0.4886
photo: 0.9985, art_painting: 0.8526, cartoon: 0.7372, sketch: 0.4886, 
Average Test Accuracy(group): 0.7692, Average Test Accuracy(individual): 0.9006,
domain std=0.1866, cluster std=0.1866, individual std=0.1355, 
Average Test Accuracy: 0.7692
============ Train epoch 42 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.3246 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4779 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.4244 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3626 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3704 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4368 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4200 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.4203 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4332 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.4631 | Train Acc: 0.9863
 Site-art_painting              (2) | Train Loss: 0.9076 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 1.0560 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.9742 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.9890 | Train Acc: 0.8472
 Site-art_painting              (2) | Train Loss: 0.8975 | Train Acc: 0.8438
 Site-cartoon                   (3) | Train Loss: 1.2674 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 1.0249 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 1.5053 | Train Acc: 0.4483
Average Train Accuracy: 0.9004
 Site-photo                     (0) | Val  Loss: 0.4247 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5698 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5280 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4459 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3944 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3805 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4134 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4541 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.4017 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4046 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.8677 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.8088 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.8939 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.8937 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.9171 | Val  Acc: 0.8471
 Site-cartoon                   (3) | Val  Loss: 1.1506 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.1349 | Val  Acc: 0.7922
 Site-sketch                    (1) | Val  Loss: 1.5509 | Val  Acc: 0.3846
Average Valid Accuracy: 0.9050
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9985
 Test site-art_painting              (2)| Epoch:40 | Test Acc: 0.8599
 Test site-cartoon                   (3)| Epoch:40 | Test Acc: 0.7436
 Test site-sketch                    (1)| Epoch:40 | Test Acc: 0.4879
photo: 0.9985, art_painting: 0.8599, cartoon: 0.7436, sketch: 0.4879, 
Average Test Accuracy(group): 0.7725, Average Test Accuracy(individual): 0.9033,
domain std=0.1874, cluster std=0.1874, individual std=0.1341, 
Average Test Accuracy: 0.7725
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 43 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (1) | Train Loss: 0.3369 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5137 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4316 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3684 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3568 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4222 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3796 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3841 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4286 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.4109 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.8961 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 1.1018 | Train Acc: 0.5909
 Site-art_painting              (2) | Train Loss: 0.9434 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.9306 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.8675 | Train Acc: 0.8594
 Site-cartoon                   (0) | Train Loss: 1.2605 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 1.0065 | Train Acc: 0.8174
 Site-sketch                    (3) | Train Loss: 1.5177 | Train Acc: 0.4310
Average Train Accuracy: 0.8918
 Site-photo                     (1) | Val  Loss: 0.4256 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5570 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5416 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4293 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3779 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3722 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3997 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4263 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3853 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.3913 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.9349 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.8938 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.8798 | Val  Acc: 0.7692
 Site-art_painting              (2) | Val  Loss: 0.8908 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.8897 | Val  Acc: 0.8353
 Site-cartoon                   (0) | Val  Loss: 1.1683 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 1.1457 | Val  Acc: 0.8442
 Site-sketch                    (3) | Val  Loss: 1.5789 | Val  Acc: 0.4359
Average Valid Accuracy: 0.9053
 Test site-photo                     (1)| Epoch:42 | Test Acc: 0.9985
 Test site-art_painting              (2)| Epoch:42 | Test Acc: 0.8563
 Test site-cartoon                   (0)| Epoch:42 | Test Acc: 0.7521
 Test site-sketch                    (3)| Epoch:42 | Test Acc: 0.4905
photo: 0.9985, art_painting: 0.8563, cartoon: 0.7521, sketch: 0.4905, 
Average Test Accuracy(group): 0.7743, Average Test Accuracy(individual): 0.9034,
domain std=0.1858, cluster std=0.1858, individual std=0.1329, 
Average Test Accuracy: 0.7743
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 44 ============
cnt=[10, 1, 6, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (0) | Train Loss: 0.2937 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5242 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.4027 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3558 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3528 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4207 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3874 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.4362 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4286 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.4038 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.9054 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.9815 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.9364 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.9833 | Train Acc: 0.8194
 Site-art_painting              (2) | Train Loss: 0.8777 | Train Acc: 0.8359
 Site-cartoon                   (2) | Train Loss: 1.3128 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 1.0253 | Train Acc: 0.8609
 Site-sketch                    (1) | Train Loss: 1.4894 | Train Acc: 0.5000
Average Train Accuracy: 0.9017
 Site-photo                     (0) | Val  Loss: 0.3837 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5460 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5763 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.4371 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3748 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3414 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3998 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4583 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.3679 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3807 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.8334 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.8200 | Val  Acc: 0.8000
 Site-art_painting              (2) | Val  Loss: 0.8225 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.8451 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.8582 | Val  Acc: 0.8353
 Site-cartoon                   (2) | Val  Loss: 1.1901 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 1.1006 | Val  Acc: 0.9091
 Site-sketch                    (1) | Val  Loss: 1.5475 | Val  Acc: 0.3846
Average Valid Accuracy: 0.9052
 Test site-photo                     (0)| Epoch:43 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.8575
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.7511
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.4956
photo: 0.9985, art_painting: 0.8575, cartoon: 0.7511, sketch: 0.4956, 
Average Test Accuracy(group): 0.7757, Average Test Accuracy(individual): 0.9039,
domain std=0.1840, cluster std=0.1842, individual std=0.1320, 
Average Test Accuracy: 0.7757
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 45 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (1) | Train Loss: 0.2996 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4633 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.4453 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.3569 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3291 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4467 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2711 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.3837 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3867 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4122 | Train Acc: 0.9863
 Site-art_painting              (3) | Train Loss: 0.9005 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.9416 | Train Acc: 0.8182
 Site-art_painting              (3) | Train Loss: 0.8588 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.8786 | Train Acc: 0.8611
 Site-art_painting              (3) | Train Loss: 0.8381 | Train Acc: 0.8750
 Site-cartoon                   (0) | Train Loss: 1.2130 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 1.0154 | Train Acc: 0.8435
 Site-sketch                    (2) | Train Loss: 1.5153 | Train Acc: 0.5345
Average Train Accuracy: 0.9045
 Site-photo                     (1) | Val  Loss: 0.4213 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5262 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5665 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 0.4295 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3654 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3424 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3950 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4103 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3518 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3835 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.8162 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.8159 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.8548 | Val  Acc: 0.8077
 Site-art_painting              (3) | Val  Loss: 0.8121 | Val  Acc: 0.8723
 Site-art_painting              (3) | Val  Loss: 0.8374 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 1.1929 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.1026 | Val  Acc: 0.8831
 Site-sketch                    (2) | Val  Loss: 1.5287 | Val  Acc: 0.4872
Average Valid Accuracy: 0.8997
 Test site-photo                     (1)| Epoch:44 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.8563
 Test site-cartoon                   (0)| Epoch:44 | Test Acc: 0.7532
 Test site-sketch                    (2)| Epoch:44 | Test Acc: 0.4924
photo: 0.9985, art_painting: 0.8563, cartoon: 0.7532, sketch: 0.4924, 
Average Test Accuracy(group): 0.7751, Average Test Accuracy(individual): 0.9036,
domain std=0.1850, cluster std=0.1850, individual std=0.1324, 
Average Test Accuracy: 0.7751
============ Train epoch 46 ============
cnt=[10, 3, 4, 1, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (0) | Train Loss: 0.2897 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5098 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3665 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3093 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3318 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3925 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3143 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3748 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.3952 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.3984 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.8607 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.9082 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.9520 | Train Acc: 0.7750
 Site-art_painting              (2) | Train Loss: 0.9100 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.8385 | Train Acc: 0.8516
 Site-cartoon                   (1) | Train Loss: 1.2810 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.0075 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 1.4479 | Train Acc: 0.4828
Average Train Accuracy: 0.8988
 Site-photo                     (0) | Val  Loss: 0.4172 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4656 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4313 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4046 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3768 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3255 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3863 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4371 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.3360 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3594 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.7858 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.8412 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.7935 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.8150 | Val  Acc: 0.7872
 Site-art_painting              (2) | Val  Loss: 0.8257 | Val  Acc: 0.8824
 Site-cartoon                   (1) | Val  Loss: 1.1189 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.0666 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 1.5421 | Val  Acc: 0.4872
Average Valid Accuracy: 0.9057
 Test site-photo                     (0)| Epoch:44 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:44 | Test Acc: 0.8551
 Test site-cartoon                   (1)| Epoch:44 | Test Acc: 0.7596
 Test site-sketch                    (1)| Epoch:44 | Test Acc: 0.4898
photo: 0.9985, art_painting: 0.8551, cartoon: 0.7596, sketch: 0.4898, 
Average Test Accuracy(group): 0.7757, Average Test Accuracy(individual): 0.9039,
domain std=0.1857, cluster std=0.1167, individual std=0.1322, 
Average Test Accuracy: 0.7757
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 47 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (0) | Train Loss: 0.2908 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4423 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3786 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3218 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3258 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4001 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.3715 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3725 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.3837 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.3894 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.9065 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.9949 | Train Acc: 0.8182
 Site-art_painting              (2) | Train Loss: 0.8925 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.7831 | Train Acc: 0.8194
 Site-art_painting              (2) | Train Loss: 0.7832 | Train Acc: 0.9062
 Site-cartoon                   (1) | Train Loss: 1.2124 | Train Acc: 0.9091
 Site-cartoon                   (1) | Train Loss: 0.9796 | Train Acc: 0.8609
 Site-sketch                    (3) | Train Loss: 1.4540 | Train Acc: 0.5345
Average Train Accuracy: 0.9144
 Site-photo                     (0) | Val  Loss: 0.4320 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4602 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5241 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3828 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3351 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3167 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3649 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3870 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.3584 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.3765 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.8418 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.7676 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.8222 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.8087 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.8619 | Val  Acc: 0.8588
 Site-cartoon                   (1) | Val  Loss: 1.2325 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.0731 | Val  Acc: 0.8701
 Site-sketch                    (3) | Val  Loss: 1.5526 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9120
 Test site-photo                     (0)| Epoch:46 | Test Acc: 0.9985
 Test site-art_painting              (2)| Epoch:46 | Test Acc: 0.8563
 Test site-cartoon                   (1)| Epoch:46 | Test Acc: 0.7628
 Test site-sketch                    (3)| Epoch:46 | Test Acc: 0.4911
photo: 0.9985, art_painting: 0.8563, cartoon: 0.7628, sketch: 0.4911, 
Average Test Accuracy(group): 0.7772, Average Test Accuracy(individual): 0.9046,
domain std=0.1853, cluster std=0.1853, individual std=0.1315, 
Average Test Accuracy: 0.7772
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
============ Train epoch 48 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (1) | Train Loss: 0.2759 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.4580 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.3774 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3229 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3405 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3807 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3904 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3547 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.3706 | Train Acc: 0.9912
 Site-photo                     (1) | Train Loss: 0.4159 | Train Acc: 0.9795
 Site-art_painting              (2) | Train Loss: 0.7735 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.9910 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.8889 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 1.0583 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.8178 | Train Acc: 0.8359
 Site-cartoon                   (0) | Train Loss: 1.2149 | Train Acc: 0.9091
 Site-cartoon                   (0) | Train Loss: 0.9618 | Train Acc: 0.8261
 Site-sketch                    (3) | Train Loss: 1.4536 | Train Acc: 0.4655
Average Train Accuracy: 0.9095
 Site-photo                     (1) | Val  Loss: 0.4045 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4163 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.4793 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.3929 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3333 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3359 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.3562 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3834 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3277 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3435 | Val  Acc: 0.9897
 Site-art_painting              (2) | Val  Loss: 0.7768 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.8416 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.7811 | Val  Acc: 0.8077
 Site-art_painting              (2) | Val  Loss: 0.8161 | Val  Acc: 0.8511
 Site-art_painting              (2) | Val  Loss: 0.8523 | Val  Acc: 0.8118
 Site-cartoon                   (0) | Val  Loss: 1.1063 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 1.0880 | Val  Acc: 0.8701
 Site-sketch                    (3) | Val  Loss: 1.4842 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8949
 Test site-photo                     (1)| Epoch:47 | Test Acc: 0.9985
 Test site-art_painting              (2)| Epoch:47 | Test Acc: 0.8575
 Test site-cartoon                   (0)| Epoch:47 | Test Acc: 0.7628
 Test site-sketch                    (3)| Epoch:47 | Test Acc: 0.4873
photo: 0.9985, art_painting: 0.8575, cartoon: 0.7628, sketch: 0.4873, 
Average Test Accuracy(group): 0.7765, Average Test Accuracy(individual): 0.9047,
domain std=0.1869, cluster std=0.1869, individual std=0.1320, 
Average Test Accuracy: 0.7765
============ Train epoch 49 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.2793 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4501 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.3514 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3067 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2989 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4215 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.2617 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3713 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.3542 | Train Acc: 0.9912
 Site-photo                     (0) | Train Loss: 0.3940 | Train Acc: 0.9795
 Site-art_painting              (1) | Train Loss: 0.7838 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 0.9996 | Train Acc: 0.7727
 Site-art_painting              (1) | Train Loss: 0.9461 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.7820 | Train Acc: 0.8611
 Site-art_painting              (1) | Train Loss: 0.7833 | Train Acc: 0.8906
 Site-cartoon                   (3) | Train Loss: 1.1459 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.9165 | Train Acc: 0.8174
 Site-sketch                    (2) | Train Loss: 1.4359 | Train Acc: 0.5000
Average Train Accuracy: 0.9031
 Site-photo                     (0) | Val  Loss: 0.4076 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4416 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3866 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3921 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3365 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3148 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3473 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3799 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.3192 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3350 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.8471 | Val  Acc: 0.7500
 Site-art_painting              (1) | Val  Loss: 0.7361 | Val  Acc: 0.8667
 Site-art_painting              (1) | Val  Loss: 0.7710 | Val  Acc: 0.8077
 Site-art_painting              (1) | Val  Loss: 0.7265 | Val  Acc: 0.8936
 Site-art_painting              (1) | Val  Loss: 0.8330 | Val  Acc: 0.8353
 Site-cartoon                   (3) | Val  Loss: 1.0432 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.0128 | Val  Acc: 0.8701
 Site-sketch                    (2) | Val  Loss: 1.4432 | Val  Acc: 0.4872
Average Valid Accuracy: 0.9078
 Test site-photo                     (0)| Epoch:47 | Test Acc: 0.9985
 Test site-art_painting              (1)| Epoch:47 | Test Acc: 0.8587
 Test site-cartoon                   (3)| Epoch:47 | Test Acc: 0.7638
 Test site-sketch                    (2)| Epoch:47 | Test Acc: 0.4924
photo: 0.9985, art_painting: 0.8587, cartoon: 0.7638, sketch: 0.4924, 
Average Test Accuracy(group): 0.7784, Average Test Accuracy(individual): 0.9055,
domain std=0.1850, cluster std=0.1850, individual std=0.1309, 
Average Test Accuracy: 0.7784
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ablation...
===2023-08-13 20:11:50===
===2023-08-13 20:11:58===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9985
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.8587
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.7638
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.4924
photo: 0.9985, art_painting: 0.8587, cartoon: 0.7638, sketch: 0.4924, 
Average Test Accuracy(group): 0.7784, Average Test Accuracy(individual): 0.9055,
domain std=0.1850, cluster std=0.1850, individual std=0.1309, 
