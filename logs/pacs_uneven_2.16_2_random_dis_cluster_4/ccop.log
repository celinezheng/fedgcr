===2023-08-12 07:11:26===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[7, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-photo                     (3) | Train Loss: 1.7018 | Train Acc: 0.3571
 Site-photo                     (2) | Train Loss: 1.8541 | Train Acc: 0.2222
 Site-photo                     (2) | Train Loss: 1.5636 | Train Acc: 0.4167
 Site-photo                     (2) | Train Loss: 1.6659 | Train Acc: 0.3226
 Site-photo                     (2) | Train Loss: 1.6925 | Train Acc: 0.3500
 Site-photo                     (2) | Train Loss: 1.8081 | Train Acc: 0.2115
 Site-photo                     (2) | Train Loss: 1.4273 | Train Acc: 0.3529
 Site-photo                     (2) | Train Loss: 1.7281 | Train Acc: 0.2841
 Site-photo                     (2) | Train Loss: 1.7300 | Train Acc: 0.2832
 Site-photo                     (2) | Train Loss: 1.8003 | Train Acc: 0.2466
 Site-art_painting              (0) | Train Loss: 1.9525 | Train Acc: 0.0833
 Site-art_painting              (0) | Train Loss: 1.8745 | Train Acc: 0.2273
 Site-art_painting              (0) | Train Loss: 1.7429 | Train Acc: 0.4250
 Site-art_painting              (0) | Train Loss: 1.9155 | Train Acc: 0.2778
 Site-art_painting              (0) | Train Loss: 1.9216 | Train Acc: 0.2109
 Site-cartoon                   (0) | Train Loss: 2.0682 | Train Acc: 0.1818
 Site-cartoon                   (0) | Train Loss: 1.9205 | Train Acc: 0.2000
 Site-sketch                    (1) | Train Loss: 2.0190 | Train Acc: 0.1034
Average Train Accuracy: 0.2643
 Site-photo                     (3) | Val  Loss: 1.7947 | Val  Acc: 0.2222
 Site-photo                     (2) | Val  Loss: 1.6943 | Val  Acc: 0.4167
 Site-photo                     (2) | Val  Loss: 1.8099 | Val  Acc: 0.2500
 Site-photo                     (2) | Val  Loss: 1.8518 | Val  Acc: 0.1905
 Site-photo                     (2) | Val  Loss: 1.6776 | Val  Acc: 0.2963
 Site-photo                     (2) | Val  Loss: 1.5816 | Val  Acc: 0.3714
 Site-photo                     (2) | Val  Loss: 1.6626 | Val  Acc: 0.3111
 Site-photo                     (2) | Val  Loss: 1.8085 | Val  Acc: 0.2069
 Site-photo                     (2) | Val  Loss: 1.7590 | Val  Acc: 0.3333
 Site-photo                     (2) | Val  Loss: 1.7404 | Val  Acc: 0.2680
 Site-art_painting              (0) | Val  Loss: 2.0775 | Val  Acc: 0.1250
 Site-art_painting              (0) | Val  Loss: 1.9504 | Val  Acc: 0.1333
 Site-art_painting              (0) | Val  Loss: 1.9122 | Val  Acc: 0.2308
 Site-art_painting              (0) | Val  Loss: 1.9852 | Val  Acc: 0.1277
 Site-art_painting              (0) | Val  Loss: 1.9201 | Val  Acc: 0.2235
 Site-cartoon                   (0) | Val  Loss: 1.7156 | Val  Acc: 0.2857
 Site-cartoon                   (0) | Val  Loss: 1.8301 | Val  Acc: 0.2208
 Site-sketch                    (1) | Val  Loss: 2.0901 | Val  Acc: 0.0769
Average Valid Accuracy: 0.2383
 Best site-photo                    (3)  | Epoch:0 | Val Acc: 0.2222
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.4167
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.2500
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.1905
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.2963
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.3714
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.3111
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.2069
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.3333
 Best site-photo                    (2)  | Epoch:0 | Val Acc: 0.2680
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.1250
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.1333
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2308
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.1277
 Best site-art_painting             (0)  | Epoch:0 | Val Acc: 0.2235
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.2857
 Best site-cartoon                  (0)  | Epoch:0 | Val Acc: 0.2208
 Best site-sketch                   (1)  | Epoch:0 | Val Acc: 0.0769
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-photo                     (1) | Train Loss: 1.4607 | Train Acc: 0.7143
 Site-photo                     (1) | Train Loss: 1.5504 | Train Acc: 0.6111
 Site-photo                     (1) | Train Loss: 1.4450 | Train Acc: 0.8333
 Site-photo                     (1) | Train Loss: 1.4780 | Train Acc: 0.7097
 Site-photo                     (1) | Train Loss: 1.5131 | Train Acc: 0.7500
 Site-photo                     (1) | Train Loss: 1.6460 | Train Acc: 0.5577
 Site-photo                     (1) | Train Loss: 1.5802 | Train Acc: 0.7353
 Site-photo                     (1) | Train Loss: 1.5067 | Train Acc: 0.6705
 Site-photo                     (1) | Train Loss: 1.5369 | Train Acc: 0.6991
 Site-photo                     (1) | Train Loss: 1.5103 | Train Acc: 0.6986
 Site-art_painting              (3) | Train Loss: 1.6988 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.7890 | Train Acc: 0.4091
 Site-art_painting              (3) | Train Loss: 1.7191 | Train Acc: 0.4500
 Site-art_painting              (3) | Train Loss: 1.8116 | Train Acc: 0.4167
 Site-art_painting              (3) | Train Loss: 1.8425 | Train Acc: 0.2891
 Site-cartoon                   (0) | Train Loss: 2.0181 | Train Acc: 0.1818
 Site-cartoon                   (0) | Train Loss: 1.8269 | Train Acc: 0.2609
 Site-sketch                    (2) | Train Loss: 1.9368 | Train Acc: 0.1724
Average Train Accuracy: 0.5366
 Site-photo                     (1) | Val  Loss: 1.5592 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 1.4866 | Val  Acc: 0.6667
 Site-photo                     (1) | Val  Loss: 1.6522 | Val  Acc: 0.5625
 Site-photo                     (1) | Val  Loss: 1.4717 | Val  Acc: 0.7619
 Site-photo                     (1) | Val  Loss: 1.4477 | Val  Acc: 0.7407
 Site-photo                     (1) | Val  Loss: 1.4282 | Val  Acc: 0.8286
 Site-photo                     (1) | Val  Loss: 1.5026 | Val  Acc: 0.6444
 Site-photo                     (1) | Val  Loss: 1.5586 | Val  Acc: 0.7069
 Site-photo                     (1) | Val  Loss: 1.5225 | Val  Acc: 0.7200
 Site-photo                     (1) | Val  Loss: 1.5633 | Val  Acc: 0.6392
 Site-art_painting              (3) | Val  Loss: 1.8623 | Val  Acc: 0.3750
 Site-art_painting              (3) | Val  Loss: 1.8099 | Val  Acc: 0.4667
 Site-art_painting              (3) | Val  Loss: 1.8321 | Val  Acc: 0.3462
 Site-art_painting              (3) | Val  Loss: 1.8432 | Val  Acc: 0.3191
 Site-art_painting              (3) | Val  Loss: 1.8295 | Val  Acc: 0.3529
 Site-cartoon                   (0) | Val  Loss: 1.6409 | Val  Acc: 0.4286
 Site-cartoon                   (0) | Val  Loss: 1.7685 | Val  Acc: 0.3117
 Site-sketch                    (2) | Val  Loss: 2.0005 | Val  Acc: 0.2051
Average Valid Accuracy: 0.5474
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6667
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.5625
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7619
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7407
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.8286
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6444
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7069
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.7200
 Best site-photo                    (1)  | Epoch:1 | Val Acc: 0.6392
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3750
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.4667
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3462
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3191
 Best site-art_painting             (3)  | Epoch:1 | Val Acc: 0.3529
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.4286
 Best site-cartoon                  (0)  | Epoch:1 | Val Acc: 0.3117
 Best site-sketch                   (2)  | Epoch:1 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 2 ============
cnt=[10, 5, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-photo                     (0) | Train Loss: 1.2452 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 1.3876 | Train Acc: 0.7778
 Site-photo                     (0) | Train Loss: 1.2383 | Train Acc: 0.7917
 Site-photo                     (0) | Train Loss: 1.2777 | Train Acc: 0.9032
 Site-photo                     (0) | Train Loss: 1.2988 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 1.4329 | Train Acc: 0.6346
 Site-photo                     (0) | Train Loss: 1.3542 | Train Acc: 0.7500
 Site-photo                     (0) | Train Loss: 1.3519 | Train Acc: 0.6932
 Site-photo                     (0) | Train Loss: 1.3531 | Train Acc: 0.7699
 Site-photo                     (0) | Train Loss: 1.4004 | Train Acc: 0.7123
 Site-art_painting              (1) | Train Loss: 1.5341 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.6043 | Train Acc: 0.5455
 Site-art_painting              (1) | Train Loss: 1.6107 | Train Acc: 0.4500
 Site-art_painting              (1) | Train Loss: 1.6170 | Train Acc: 0.5000
 Site-art_painting              (1) | Train Loss: 1.7636 | Train Acc: 0.3438
 Site-cartoon                   (3) | Train Loss: 1.8293 | Train Acc: 0.1818
 Site-cartoon                   (3) | Train Loss: 1.7503 | Train Acc: 0.3565
 Site-sketch                    (2) | Train Loss: 1.9996 | Train Acc: 0.1897
Average Train Accuracy: 0.6081
 Site-photo                     (0) | Val  Loss: 1.3725 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.3113 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.5612 | Val  Acc: 0.5000
 Site-photo                     (0) | Val  Loss: 1.3971 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.3161 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.1596 | Val  Acc: 0.8571
 Site-photo                     (0) | Val  Loss: 1.3360 | Val  Acc: 0.8444
 Site-photo                     (0) | Val  Loss: 1.3664 | Val  Acc: 0.7241
 Site-photo                     (0) | Val  Loss: 1.3304 | Val  Acc: 0.7733
 Site-photo                     (0) | Val  Loss: 1.3659 | Val  Acc: 0.7010
 Site-art_painting              (1) | Val  Loss: 1.8237 | Val  Acc: 0.2500
 Site-art_painting              (1) | Val  Loss: 1.8213 | Val  Acc: 0.2000
 Site-art_painting              (1) | Val  Loss: 1.7400 | Val  Acc: 0.3846
 Site-art_painting              (1) | Val  Loss: 1.8036 | Val  Acc: 0.2553
 Site-art_painting              (1) | Val  Loss: 1.7663 | Val  Acc: 0.3765
 Site-cartoon                   (3) | Val  Loss: 1.6162 | Val  Acc: 0.4286
 Site-cartoon                   (3) | Val  Loss: 1.7394 | Val  Acc: 0.3377
 Site-sketch                    (2) | Val  Loss: 2.0220 | Val  Acc: 0.2051
Average Valid Accuracy: 0.5556
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.5000
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8571
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.8444
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7241
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7733
 Best site-photo                    (0)  | Epoch:2 | Val Acc: 0.7010
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2500
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2000
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3846
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.2553
 Best site-art_painting             (1)  | Epoch:2 | Val Acc: 0.3765
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.4286
 Best site-cartoon                  (3)  | Epoch:2 | Val Acc: 0.3377
 Best site-sketch                   (2)  | Epoch:2 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-photo                     (0) | Train Loss: 1.1264 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 1.2226 | Train Acc: 0.7222
 Site-photo                     (0) | Train Loss: 1.1048 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 1.1303 | Train Acc: 0.8710
 Site-photo                     (0) | Train Loss: 1.2053 | Train Acc: 0.7250
 Site-photo                     (0) | Train Loss: 1.3401 | Train Acc: 0.6538
 Site-photo                     (0) | Train Loss: 1.1947 | Train Acc: 0.8088
 Site-photo                     (0) | Train Loss: 1.2157 | Train Acc: 0.7841
 Site-photo                     (0) | Train Loss: 1.2232 | Train Acc: 0.7876
 Site-photo                     (0) | Train Loss: 1.2410 | Train Acc: 0.7192
 Site-art_painting              (3) | Train Loss: 1.4686 | Train Acc: 0.6667
 Site-art_painting              (3) | Train Loss: 1.6373 | Train Acc: 0.3636
 Site-art_painting              (3) | Train Loss: 1.4770 | Train Acc: 0.5250
 Site-art_painting              (3) | Train Loss: 1.6529 | Train Acc: 0.5000
 Site-art_painting              (3) | Train Loss: 1.6828 | Train Acc: 0.3438
 Site-cartoon                   (2) | Train Loss: 1.7376 | Train Acc: 0.3636
 Site-cartoon                   (2) | Train Loss: 1.6854 | Train Acc: 0.3391
 Site-sketch                    (1) | Train Loss: 1.9835 | Train Acc: 0.1897
Average Train Accuracy: 0.6204
 Site-photo                     (0) | Val  Loss: 1.2265 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.3133 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.3851 | Val  Acc: 0.6875
 Site-photo                     (0) | Val  Loss: 1.2640 | Val  Acc: 0.9048
 Site-photo                     (0) | Val  Loss: 1.1724 | Val  Acc: 0.8148
 Site-photo                     (0) | Val  Loss: 1.0540 | Val  Acc: 0.8286
 Site-photo                     (0) | Val  Loss: 1.1643 | Val  Acc: 0.8222
 Site-photo                     (0) | Val  Loss: 1.2658 | Val  Acc: 0.7759
 Site-photo                     (0) | Val  Loss: 1.2144 | Val  Acc: 0.8000
 Site-photo                     (0) | Val  Loss: 1.2264 | Val  Acc: 0.7320
 Site-art_painting              (3) | Val  Loss: 1.8774 | Val  Acc: 0.0000
 Site-art_painting              (3) | Val  Loss: 1.7391 | Val  Acc: 0.2667
 Site-art_painting              (3) | Val  Loss: 1.6455 | Val  Acc: 0.3462
 Site-art_painting              (3) | Val  Loss: 1.6674 | Val  Acc: 0.3404
 Site-art_painting              (3) | Val  Loss: 1.6634 | Val  Acc: 0.4706
 Site-cartoon                   (2) | Val  Loss: 1.6074 | Val  Acc: 0.2857
 Site-cartoon                   (2) | Val  Loss: 1.6467 | Val  Acc: 0.3766
 Site-sketch                    (1) | Val  Loss: 2.0369 | Val  Acc: 0.1795
Average Valid Accuracy: 0.5644
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.6875
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.9048
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8148
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8286
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8222
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7759
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-photo                    (0)  | Epoch:3 | Val Acc: 0.7320
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.0000
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.2667
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.3462
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.3404
 Best site-art_painting             (3)  | Epoch:3 | Val Acc: 0.4706
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.2857
 Best site-cartoon                  (2)  | Epoch:3 | Val Acc: 0.3766
 Best site-sketch                   (1)  | Epoch:3 | Val Acc: 0.1795
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 4 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-photo                     (0) | Train Loss: 1.0229 | Train Acc: 0.8571
 Site-photo                     (0) | Train Loss: 1.1062 | Train Acc: 0.8889
 Site-photo                     (0) | Train Loss: 0.9692 | Train Acc: 0.8750
 Site-photo                     (0) | Train Loss: 0.9778 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 1.0368 | Train Acc: 0.8250
 Site-photo                     (0) | Train Loss: 1.1847 | Train Acc: 0.7308
 Site-photo                     (0) | Train Loss: 1.0193 | Train Acc: 0.8235
 Site-photo                     (0) | Train Loss: 1.0563 | Train Acc: 0.8295
 Site-photo                     (0) | Train Loss: 1.1049 | Train Acc: 0.8230
 Site-photo                     (0) | Train Loss: 1.1273 | Train Acc: 0.8151
 Site-art_painting              (2) | Train Loss: 1.4337 | Train Acc: 0.6667
 Site-art_painting              (2) | Train Loss: 1.5475 | Train Acc: 0.5000
 Site-art_painting              (2) | Train Loss: 1.4432 | Train Acc: 0.6250
 Site-art_painting              (2) | Train Loss: 1.5102 | Train Acc: 0.5556
 Site-art_painting              (2) | Train Loss: 1.6366 | Train Acc: 0.3828
 Site-cartoon                   (1) | Train Loss: 1.7708 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.6495 | Train Acc: 0.3565
 Site-sketch                    (3) | Train Loss: 1.9546 | Train Acc: 0.1724
Average Train Accuracy: 0.6901
 Site-photo                     (0) | Val  Loss: 1.1804 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.1258 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.2852 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.1605 | Val  Acc: 0.8095
 Site-photo                     (0) | Val  Loss: 1.0671 | Val  Acc: 0.8519
 Site-photo                     (0) | Val  Loss: 0.9676 | Val  Acc: 0.8286
 Site-photo                     (0) | Val  Loss: 1.0596 | Val  Acc: 0.8444
 Site-photo                     (0) | Val  Loss: 1.1311 | Val  Acc: 0.8103
 Site-photo                     (0) | Val  Loss: 1.0791 | Val  Acc: 0.8400
 Site-photo                     (0) | Val  Loss: 1.1148 | Val  Acc: 0.7629
 Site-art_painting              (2) | Val  Loss: 1.7237 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.6076 | Val  Acc: 0.3333
 Site-art_painting              (2) | Val  Loss: 1.5135 | Val  Acc: 0.4615
 Site-art_painting              (2) | Val  Loss: 1.5841 | Val  Acc: 0.3830
 Site-art_painting              (2) | Val  Loss: 1.5763 | Val  Acc: 0.4941
 Site-cartoon                   (1) | Val  Loss: 1.4483 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.5789 | Val  Acc: 0.3636
 Site-sketch                    (3) | Val  Loss: 2.0011 | Val  Acc: 0.2051
Average Valid Accuracy: 0.6378
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8095
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8519
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8286
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8444
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8103
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.8400
 Best site-photo                    (0)  | Epoch:4 | Val Acc: 0.7629
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.3333
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4615
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.3830
 Best site-art_painting             (2)  | Epoch:4 | Val Acc: 0.4941
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:4 | Val Acc: 0.3636
 Best site-sketch                   (3)  | Epoch:4 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 5 ============
cnt=[9, 1, 7, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-photo                     (3) | Train Loss: 0.8904 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.9474 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.9143 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 0.9477 | Train Acc: 0.9677
 Site-photo                     (0) | Train Loss: 0.9225 | Train Acc: 0.9000
 Site-photo                     (0) | Train Loss: 1.0661 | Train Acc: 0.8654
 Site-photo                     (0) | Train Loss: 1.0155 | Train Acc: 0.9118
 Site-photo                     (0) | Train Loss: 0.9225 | Train Acc: 0.9318
 Site-photo                     (0) | Train Loss: 0.9880 | Train Acc: 0.8761
 Site-photo                     (0) | Train Loss: 1.0320 | Train Acc: 0.8630
 Site-art_painting              (2) | Train Loss: 1.3448 | Train Acc: 0.5833
 Site-art_painting              (2) | Train Loss: 1.4921 | Train Acc: 0.5455
 Site-art_painting              (2) | Train Loss: 1.3768 | Train Acc: 0.7000
 Site-art_painting              (2) | Train Loss: 1.3874 | Train Acc: 0.5833
 Site-art_painting              (2) | Train Loss: 1.5181 | Train Acc: 0.5156
 Site-cartoon                   (2) | Train Loss: 1.6984 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 1.5474 | Train Acc: 0.4696
 Site-sketch                    (1) | Train Loss: 1.9123 | Train Acc: 0.1552
Average Train Accuracy: 0.7335
 Site-photo                     (3) | Val  Loss: 1.0277 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 1.0213 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.1884 | Val  Acc: 0.7500
 Site-photo                     (0) | Val  Loss: 1.0062 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 1.0118 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.8609 | Val  Acc: 0.9429
 Site-photo                     (0) | Val  Loss: 0.9283 | Val  Acc: 0.9111
 Site-photo                     (0) | Val  Loss: 0.9941 | Val  Acc: 0.8793
 Site-photo                     (0) | Val  Loss: 0.9614 | Val  Acc: 0.9467
 Site-photo                     (0) | Val  Loss: 0.9977 | Val  Acc: 0.8763
 Site-art_painting              (2) | Val  Loss: 1.7099 | Val  Acc: 0.3750
 Site-art_painting              (2) | Val  Loss: 1.6109 | Val  Acc: 0.4667
 Site-art_painting              (2) | Val  Loss: 1.5011 | Val  Acc: 0.5000
 Site-art_painting              (2) | Val  Loss: 1.5044 | Val  Acc: 0.4681
 Site-art_painting              (2) | Val  Loss: 1.4738 | Val  Acc: 0.6235
 Site-cartoon                   (2) | Val  Loss: 1.4980 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.4872 | Val  Acc: 0.4935
 Site-sketch                    (1) | Val  Loss: 2.0003 | Val  Acc: 0.1538
Average Valid Accuracy: 0.6769
 Best site-photo                    (3)  | Epoch:5 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.7500
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9524
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9429
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9111
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8793
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.9467
 Best site-photo                    (0)  | Epoch:5 | Val Acc: 0.8763
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.3750
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.4667
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.5000
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.4681
 Best site-art_painting             (2)  | Epoch:5 | Val Acc: 0.6235
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:5 | Val Acc: 0.4935
 Best site-sketch                   (1)  | Epoch:5 | Val Acc: 0.1538
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 6 ============
cnt=[1, 8, 2, 7, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-photo                     (1) | Train Loss: 0.8669 | Train Acc: 0.8571
 Site-photo                     (1) | Train Loss: 0.7997 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.8040 | Train Acc: 0.9583
 Site-photo                     (3) | Train Loss: 0.7541 | Train Acc: 0.9677
 Site-photo                     (3) | Train Loss: 0.8101 | Train Acc: 0.9250
 Site-photo                     (1) | Train Loss: 0.9904 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.9265 | Train Acc: 0.9412
 Site-photo                     (3) | Train Loss: 0.8754 | Train Acc: 0.9205
 Site-photo                     (3) | Train Loss: 0.8946 | Train Acc: 0.9027
 Site-photo                     (3) | Train Loss: 0.9134 | Train Acc: 0.9041
 Site-art_painting              (3) | Train Loss: 1.2273 | Train Acc: 0.6667
 Site-art_painting              (1) | Train Loss: 1.4191 | Train Acc: 0.5909
 Site-art_painting              (1) | Train Loss: 1.3078 | Train Acc: 0.7250
 Site-art_painting              (1) | Train Loss: 1.4790 | Train Acc: 0.6528
 Site-art_painting              (1) | Train Loss: 1.4575 | Train Acc: 0.5391
 Site-cartoon                   (2) | Train Loss: 1.7118 | Train Acc: 0.4545
 Site-cartoon                   (2) | Train Loss: 1.4914 | Train Acc: 0.4870
 Site-sketch                    (0) | Train Loss: 1.8762 | Train Acc: 0.2069
Average Train Accuracy: 0.7579
 Site-photo                     (1) | Val  Loss: 0.9122 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.9763 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 1.0735 | Val  Acc: 0.7500
 Site-photo                     (3) | Val  Loss: 0.9776 | Val  Acc: 0.9048
 Site-photo                     (3) | Val  Loss: 0.9056 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.7819 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.8263 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.9057 | Val  Acc: 0.9310
 Site-photo                     (3) | Val  Loss: 0.8838 | Val  Acc: 0.9600
 Site-photo                     (3) | Val  Loss: 0.8990 | Val  Acc: 0.9175
 Site-art_painting              (3) | Val  Loss: 1.5448 | Val  Acc: 0.5000
 Site-art_painting              (1) | Val  Loss: 1.5526 | Val  Acc: 0.5333
 Site-art_painting              (1) | Val  Loss: 1.3976 | Val  Acc: 0.6538
 Site-art_painting              (1) | Val  Loss: 1.4533 | Val  Acc: 0.5106
 Site-art_painting              (1) | Val  Loss: 1.4536 | Val  Acc: 0.5882
 Site-cartoon                   (2) | Val  Loss: 1.5303 | Val  Acc: 0.4286
 Site-cartoon                   (2) | Val  Loss: 1.4492 | Val  Acc: 0.4935
 Site-sketch                    (0) | Val  Loss: 1.9336 | Val  Acc: 0.2308
Average Valid Accuracy: 0.7156
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.8333
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.7500
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9048
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:6 | Val Acc: 0.9778
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9310
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9600
 Best site-photo                    (3)  | Epoch:6 | Val Acc: 0.9175
 Best site-art_painting             (3)  | Epoch:6 | Val Acc: 0.5000
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.5333
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.6538
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.5106
 Best site-art_painting             (1)  | Epoch:6 | Val Acc: 0.5882
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.4286
 Best site-cartoon                  (2)  | Epoch:6 | Val Acc: 0.4935
 Best site-sketch                   (0)  | Epoch:6 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 7 ============
cnt=[1, 9, 1, 7, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-photo                     (1) | Train Loss: 0.6565 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.7054 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7314 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.7212 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7225 | Train Acc: 0.9000
 Site-photo                     (1) | Train Loss: 0.8610 | Train Acc: 0.9231
 Site-photo                     (1) | Train Loss: 0.6983 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.7838 | Train Acc: 0.9545
 Site-photo                     (1) | Train Loss: 0.7976 | Train Acc: 0.9292
 Site-photo                     (1) | Train Loss: 0.8113 | Train Acc: 0.9452
 Site-art_painting              (3) | Train Loss: 1.0458 | Train Acc: 0.8333
 Site-art_painting              (3) | Train Loss: 1.3213 | Train Acc: 0.6818
 Site-art_painting              (3) | Train Loss: 1.2561 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 1.5094 | Train Acc: 0.6806
 Site-art_painting              (3) | Train Loss: 1.3787 | Train Acc: 0.5781
 Site-cartoon                   (3) | Train Loss: 1.6201 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 1.4631 | Train Acc: 0.5043
 Site-sketch                    (2) | Train Loss: 1.8439 | Train Acc: 0.2586
Average Train Accuracy: 0.7980
 Site-photo                     (1) | Val  Loss: 0.8789 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.9208 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 1.0390 | Val  Acc: 0.7500
 Site-photo                     (1) | Val  Loss: 0.8191 | Val  Acc: 0.9524
 Site-photo                     (1) | Val  Loss: 0.7586 | Val  Acc: 0.9259
 Site-photo                     (1) | Val  Loss: 0.6905 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.7537 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.7969 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.7506 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.7809 | Val  Acc: 0.9278
 Site-art_painting              (3) | Val  Loss: 1.5658 | Val  Acc: 0.3750
 Site-art_painting              (3) | Val  Loss: 1.4126 | Val  Acc: 0.3333
 Site-art_painting              (3) | Val  Loss: 1.2923 | Val  Acc: 0.6538
 Site-art_painting              (3) | Val  Loss: 1.3312 | Val  Acc: 0.5957
 Site-art_painting              (3) | Val  Loss: 1.3247 | Val  Acc: 0.6824
 Site-cartoon                   (3) | Val  Loss: 1.3814 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 1.3491 | Val  Acc: 0.5065
 Site-sketch                    (2) | Val  Loss: 1.9064 | Val  Acc: 0.2051
Average Valid Accuracy: 0.7306
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:7 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.7500
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9524
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9259
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:7 | Val Acc: 0.9278
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.3750
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.3333
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.6538
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.5957
 Best site-art_painting             (3)  | Epoch:7 | Val Acc: 0.6824
 Best site-cartoon                  (3)  | Epoch:7 | Val Acc: 0.7143
 Best site-cartoon                  (3)  | Epoch:7 | Val Acc: 0.5065
 Best site-sketch                   (2)  | Epoch:7 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-photo                     (1) | Train Loss: 0.6164 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.5929 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6195 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.6628 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6474 | Train Acc: 0.9500
 Site-photo                     (1) | Train Loss: 0.7979 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.7875 | Train Acc: 0.9706
 Site-photo                     (1) | Train Loss: 0.7178 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.7150 | Train Acc: 0.9381
 Site-photo                     (1) | Train Loss: 0.7227 | Train Acc: 0.9452
 Site-art_painting              (3) | Train Loss: 0.9871 | Train Acc: 0.7500
 Site-art_painting              (3) | Train Loss: 1.1980 | Train Acc: 0.7727
 Site-art_painting              (3) | Train Loss: 1.1889 | Train Acc: 0.7000
 Site-art_painting              (3) | Train Loss: 1.1876 | Train Acc: 0.7222
 Site-art_painting              (3) | Train Loss: 1.2920 | Train Acc: 0.6641
 Site-cartoon                   (0) | Train Loss: 1.5274 | Train Acc: 0.5455
 Site-cartoon                   (0) | Train Loss: 1.3443 | Train Acc: 0.5826
 Site-sketch                    (2) | Train Loss: 1.8116 | Train Acc: 0.2069
Average Train Accuracy: 0.8098
 Site-photo                     (1) | Val  Loss: 0.7713 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.8062 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.8568 | Val  Acc: 0.8750
 Site-photo                     (1) | Val  Loss: 0.7093 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6618 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5971 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.6415 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.7058 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.6883 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.6872 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 1.3200 | Val  Acc: 0.5000
 Site-art_painting              (3) | Val  Loss: 1.2359 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 1.2002 | Val  Acc: 0.6538
 Site-art_painting              (3) | Val  Loss: 1.2546 | Val  Acc: 0.7021
 Site-art_painting              (3) | Val  Loss: 1.2549 | Val  Acc: 0.7176
 Site-cartoon                   (0) | Val  Loss: 1.3149 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.3534 | Val  Acc: 0.5714
 Site-sketch                    (2) | Val  Loss: 1.8274 | Val  Acc: 0.2051
Average Valid Accuracy: 0.7823
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.8750
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9655
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:8 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.5000
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.6538
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.7021
 Best site-art_painting             (3)  | Epoch:8 | Val Acc: 0.7176
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:8 | Val Acc: 0.5714
 Best site-sketch                   (2)  | Epoch:8 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 10, 5, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-photo                     (1) | Train Loss: 0.5958 | Train Acc: 0.9286
 Site-photo                     (1) | Train Loss: 0.5243 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5484 | Train Acc: 0.9583
 Site-photo                     (1) | Train Loss: 0.5532 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.5587 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.7342 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.6661 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.6074 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.6443 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.6760 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 0.9560 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.1445 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 1.0815 | Train Acc: 0.8000
 Site-art_painting              (2) | Train Loss: 1.2525 | Train Acc: 0.7500
 Site-art_painting              (2) | Train Loss: 1.2024 | Train Acc: 0.7031
 Site-cartoon                   (0) | Train Loss: 1.4829 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 1.2852 | Train Acc: 0.5913
 Site-sketch                    (3) | Train Loss: 1.7571 | Train Acc: 0.2759
Average Train Accuracy: 0.8327
 Site-photo                     (1) | Val  Loss: 0.6987 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.7591 | Val  Acc: 0.8333
 Site-photo                     (1) | Val  Loss: 0.8236 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.6306 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.6166 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.5050 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.5944 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.6273 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.6087 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.6591 | Val  Acc: 0.9485
 Site-art_painting              (2) | Val  Loss: 1.3081 | Val  Acc: 0.6250
 Site-art_painting              (2) | Val  Loss: 1.2341 | Val  Acc: 0.6000
 Site-art_painting              (2) | Val  Loss: 1.1204 | Val  Acc: 0.7692
 Site-art_painting              (2) | Val  Loss: 1.1346 | Val  Acc: 0.6809
 Site-art_painting              (2) | Val  Loss: 1.2436 | Val  Acc: 0.6941
 Site-cartoon                   (0) | Val  Loss: 1.2914 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 1.2607 | Val  Acc: 0.6104
 Site-sketch                    (3) | Val  Loss: 1.7580 | Val  Acc: 0.2821
Average Valid Accuracy: 0.7904
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.7778
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.8333
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9778
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:9 | Val Acc: 0.9485
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.6250
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.6000
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.7692
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.6809
 Best site-art_painting             (2)  | Epoch:9 | Val Acc: 0.6941
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.5714
 Best site-cartoon                  (0)  | Epoch:9 | Val Acc: 0.6104
 Best site-sketch                   (3)  | Epoch:9 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 10 ============
cnt=[10, 2, 1, 5, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-photo                     (0) | Train Loss: 0.5090 | Train Acc: 0.9286
 Site-photo                     (0) | Train Loss: 0.4858 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.5137 | Train Acc: 0.9167
 Site-photo                     (0) | Train Loss: 0.4976 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4933 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.6905 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.4479 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.5657 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.5867 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.5637 | Train Acc: 0.9589
 Site-art_painting              (3) | Train Loss: 0.8559 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 1.0703 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 1.0383 | Train Acc: 0.8250
 Site-art_painting              (3) | Train Loss: 1.1441 | Train Acc: 0.6944
 Site-art_painting              (3) | Train Loss: 1.1264 | Train Acc: 0.6875
 Site-cartoon                   (1) | Train Loss: 1.3707 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 1.2097 | Train Acc: 0.6957
 Site-sketch                    (2) | Train Loss: 1.7111 | Train Acc: 0.3103
Average Train Accuracy: 0.8533
 Site-photo                     (0) | Val  Loss: 0.5325 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.7151 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.8447 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 0.5717 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5360 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.5078 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.5292 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5439 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.5276 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.5652 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 1.1633 | Val  Acc: 0.6250
 Site-art_painting              (3) | Val  Loss: 1.1522 | Val  Acc: 0.7333
 Site-art_painting              (3) | Val  Loss: 1.1184 | Val  Acc: 0.6923
 Site-art_painting              (3) | Val  Loss: 1.1033 | Val  Acc: 0.7234
 Site-art_painting              (3) | Val  Loss: 1.1383 | Val  Acc: 0.7059
 Site-cartoon                   (1) | Val  Loss: 1.2315 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 1.2316 | Val  Acc: 0.6364
 Site-sketch                    (2) | Val  Loss: 1.7620 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8009
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.8750
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:10 | Val Acc: 0.9794
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.6250
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.7333
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.6923
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.7234
 Best site-art_painting             (3)  | Epoch:10 | Val Acc: 0.7059
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.5714
 Best site-cartoon                  (1)  | Epoch:10 | Val Acc: 0.6364
 Best site-sketch                   (2)  | Epoch:10 | Val Acc: 0.2308
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 3, 5, 5, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-photo                     (3) | Train Loss: 0.4433 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4488 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4396 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4231 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.4441 | Train Acc: 0.9500
 Site-photo                     (3) | Train Loss: 0.5958 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.4696 | Train Acc: 0.9853
 Site-photo                     (2) | Train Loss: 0.4846 | Train Acc: 0.9886
 Site-photo                     (2) | Train Loss: 0.5148 | Train Acc: 0.9823
 Site-photo                     (2) | Train Loss: 0.5441 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.8492 | Train Acc: 0.8333
 Site-art_painting              (0) | Train Loss: 0.9817 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.9930 | Train Acc: 0.7250
 Site-art_painting              (0) | Train Loss: 0.9785 | Train Acc: 0.7639
 Site-art_painting              (0) | Train Loss: 1.0680 | Train Acc: 0.7344
 Site-cartoon                   (1) | Train Loss: 1.4400 | Train Acc: 0.5455
 Site-cartoon                   (1) | Train Loss: 1.1569 | Train Acc: 0.6870
 Site-sketch                    (1) | Train Loss: 1.6741 | Train Acc: 0.3621
Average Train Accuracy: 0.8556
 Site-photo                     (3) | Val  Loss: 0.6158 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.6306 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 0.6744 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.4863 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4871 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.4376 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.4936 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5059 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.4898 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.5258 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 1.1115 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 1.0937 | Val  Acc: 0.6667
 Site-art_painting              (0) | Val  Loss: 1.0033 | Val  Acc: 0.8462
 Site-art_painting              (0) | Val  Loss: 1.0056 | Val  Acc: 0.8085
 Site-art_painting              (0) | Val  Loss: 1.0360 | Val  Acc: 0.8000
 Site-cartoon                   (1) | Val  Loss: 1.2305 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 1.1923 | Val  Acc: 0.6364
 Site-sketch                    (1) | Val  Loss: 1.7096 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8446
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.8333
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:11 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:11 | Val Acc: 0.9794
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8750
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.6667
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8462
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8085
 Best site-art_painting             (0)  | Epoch:11 | Val Acc: 0.8000
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:11 | Val Acc: 0.6364
 Best site-sketch                   (1)  | Epoch:11 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 12 ============
cnt=[10, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-photo                     (0) | Train Loss: 0.4414 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3650 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4152 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3868 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4185 | Train Acc: 0.9750
 Site-photo                     (0) | Train Loss: 0.5872 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.3369 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4464 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.4758 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.4858 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 0.8776 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 1.0557 | Train Acc: 0.7727
 Site-art_painting              (2) | Train Loss: 0.9637 | Train Acc: 0.8250
 Site-art_painting              (2) | Train Loss: 0.9691 | Train Acc: 0.7639
 Site-art_painting              (2) | Train Loss: 1.0386 | Train Acc: 0.7188
 Site-cartoon                   (1) | Train Loss: 1.3901 | Train Acc: 0.4545
 Site-cartoon                   (1) | Train Loss: 1.0924 | Train Acc: 0.7304
 Site-sketch                    (3) | Train Loss: 1.6221 | Train Acc: 0.3276
Average Train Accuracy: 0.8487
 Site-photo                     (0) | Val  Loss: 0.6095 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.6429 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.5833 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.4645 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4656 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.3922 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4425 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4455 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.4528 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.4670 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 1.0021 | Val  Acc: 0.7500
 Site-art_painting              (2) | Val  Loss: 0.9811 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.9658 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.9384 | Val  Acc: 0.7872
 Site-art_painting              (2) | Val  Loss: 0.9945 | Val  Acc: 0.7647
 Site-cartoon                   (1) | Val  Loss: 1.2240 | Val  Acc: 0.8571
 Site-cartoon                   (1) | Val  Loss: 1.0870 | Val  Acc: 0.7013
 Site-sketch                    (3) | Val  Loss: 1.6949 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8568
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.7778
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.8333
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9828
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:12 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.7500
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.8462
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.7872
 Best site-art_painting             (2)  | Epoch:12 | Val Acc: 0.7647
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.8571
 Best site-cartoon                  (1)  | Epoch:12 | Val Acc: 0.7013
 Best site-sketch                   (3)  | Epoch:12 | Val Acc: 0.3333
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 13 ============
cnt=[10, 1, 1, 6, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-photo                     (0) | Train Loss: 0.3807 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3494 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.3740 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3550 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4066 | Train Acc: 0.9500
 Site-photo                     (0) | Train Loss: 0.5217 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.3465 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.4264 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.4512 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.4900 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.7346 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.8466 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.8867 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.8195 | Train Acc: 0.7917
 Site-art_painting              (3) | Train Loss: 0.9127 | Train Acc: 0.8125
 Site-cartoon                   (1) | Train Loss: 1.2821 | Train Acc: 0.6364
 Site-cartoon                   (3) | Train Loss: 1.0112 | Train Acc: 0.7217
 Site-sketch                    (2) | Train Loss: 1.5553 | Train Acc: 0.4138
Average Train Accuracy: 0.8739
 Site-photo                     (0) | Val  Loss: 0.5764 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4850 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.6434 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 0.4156 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3987 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.3749 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.3893 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4023 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4049 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.4366 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.9611 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.8703 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.8560 | Val  Acc: 0.8462
 Site-art_painting              (3) | Val  Loss: 0.9225 | Val  Acc: 0.7660
 Site-art_painting              (3) | Val  Loss: 0.8780 | Val  Acc: 0.8471
 Site-cartoon                   (1) | Val  Loss: 1.1471 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 1.0600 | Val  Acc: 0.7532
 Site-sketch                    (2) | Val  Loss: 1.6536 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8635
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.8750
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9630
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9733
 Best site-photo                    (0)  | Epoch:13 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.7500
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8000
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8462
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.7660
 Best site-art_painting             (3)  | Epoch:13 | Val Acc: 0.8471
 Best site-cartoon                  (1)  | Epoch:13 | Val Acc: 0.8571
 Best site-cartoon                  (3)  | Epoch:13 | Val Acc: 0.7532
 Best site-sketch                   (2)  | Epoch:13 | Val Acc: 0.2821
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 14 ============
cnt=[8, 2, 1, 7, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-photo                     (3) | Train Loss: 0.4030 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3149 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3665 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3124 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3715 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.5151 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.3958 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.4014 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.4065 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.3801 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.7246 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.8682 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.8783 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.9731 | Train Acc: 0.8056
 Site-art_painting              (3) | Train Loss: 0.8567 | Train Acc: 0.8281
 Site-cartoon                   (1) | Train Loss: 1.2234 | Train Acc: 0.5455
 Site-cartoon                   (1) | Train Loss: 0.9787 | Train Acc: 0.7652
 Site-sketch                    (2) | Train Loss: 1.4904 | Train Acc: 0.4655
Average Train Accuracy: 0.8859
 Site-photo                     (3) | Val  Loss: 0.5404 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.5580 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5479 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3657 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3917 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.3380 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.3527 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.4212 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.3728 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.4075 | Val  Acc: 0.9485
 Site-art_painting              (3) | Val  Loss: 0.9037 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.8740 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.8043 | Val  Acc: 0.8462
 Site-art_painting              (3) | Val  Loss: 0.7976 | Val  Acc: 0.8298
 Site-art_painting              (3) | Val  Loss: 0.8700 | Val  Acc: 0.8235
 Site-cartoon                   (1) | Val  Loss: 1.1695 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.9954 | Val  Acc: 0.7532
 Site-sketch                    (2) | Val  Loss: 1.5671 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8706
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9375
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:14 | Val Acc: 0.9714
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 1.0000
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9655
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9867
 Best site-photo                    (0)  | Epoch:14 | Val Acc: 0.9485
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8667
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8462
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8298
 Best site-art_painting             (3)  | Epoch:14 | Val Acc: 0.8235
 Best site-cartoon                  (1)  | Epoch:14 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:14 | Val Acc: 0.7532
 Best site-sketch                   (2)  | Epoch:14 | Val Acc: 0.3846
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 15 ============
cnt=[9, 1, 3, 5, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-photo                     (2) | Train Loss: 0.3425 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2790 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3491 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.3060 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3246 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.4437 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.3954 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.3426 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3650 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.4038 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.6934 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.8172 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.7821 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.7984 | Train Acc: 0.7917
 Site-art_painting              (3) | Train Loss: 0.7976 | Train Acc: 0.8359
 Site-cartoon                   (2) | Train Loss: 1.1229 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.9529 | Train Acc: 0.7391
 Site-sketch                    (1) | Train Loss: 1.4835 | Train Acc: 0.4655
Average Train Accuracy: 0.8869
 Site-photo                     (2) | Val  Loss: 0.5179 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.5681 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.5345 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.3292 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3789 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.3143 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.3257 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3501 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.3495 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.3851 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.8224 | Val  Acc: 0.7500
 Site-art_painting              (3) | Val  Loss: 0.7692 | Val  Acc: 0.8000
 Site-art_painting              (3) | Val  Loss: 0.6525 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.7725 | Val  Acc: 0.8298
 Site-art_painting              (3) | Val  Loss: 0.7944 | Val  Acc: 0.8471
 Site-cartoon                   (2) | Val  Loss: 1.1025 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 1.0041 | Val  Acc: 0.7532
 Site-sketch                    (1) | Val  Loss: 1.5279 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8630
============ Train epoch 16 ============
cnt=[2, 12, 1, 3, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-photo                     (3) | Train Loss: 0.3004 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2770 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.3119 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2966 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2964 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.4436 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.3675 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.3237 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3747 | Train Acc: 0.9469
 Site-photo                     (1) | Train Loss: 0.3657 | Train Acc: 0.9726
 Site-art_painting              (1) | Train Loss: 0.5126 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 0.7561 | Train Acc: 0.9091
 Site-art_painting              (1) | Train Loss: 0.7239 | Train Acc: 0.8500
 Site-art_painting              (1) | Train Loss: 0.9250 | Train Acc: 0.7917
 Site-art_painting              (1) | Train Loss: 0.7481 | Train Acc: 0.8516
 Site-cartoon                   (0) | Train Loss: 1.2482 | Train Acc: 0.5455
 Site-cartoon                   (0) | Train Loss: 0.9007 | Train Acc: 0.8174
 Site-sketch                    (2) | Train Loss: 1.4419 | Train Acc: 0.5172
Average Train Accuracy: 0.8937
 Site-photo                     (3) | Val  Loss: 0.5098 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.5298 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.5343 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.3127 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3285 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.3025 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.3172 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3409 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.3436 | Val  Acc: 0.9733
 Site-photo                     (1) | Val  Loss: 0.3547 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.7593 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.7424 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.6599 | Val  Acc: 0.9615
 Site-art_painting              (1) | Val  Loss: 0.7317 | Val  Acc: 0.8298
 Site-art_painting              (1) | Val  Loss: 0.7367 | Val  Acc: 0.8471
 Site-cartoon                   (0) | Val  Loss: 1.0161 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.9084 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.4519 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8918
 Best site-photo                    (3)  | Epoch:16 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:16 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:16 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9828
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9733
 Best site-photo                    (1)  | Epoch:16 | Val Acc: 0.9794
 Best site-art_painting             (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-art_painting             (1)  | Epoch:16 | Val Acc: 0.9333
 Best site-art_painting             (1)  | Epoch:16 | Val Acc: 0.9615
 Best site-art_painting             (1)  | Epoch:16 | Val Acc: 0.8298
 Best site-art_painting             (1)  | Epoch:16 | Val Acc: 0.8471
 Best site-cartoon                  (0)  | Epoch:16 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:16 | Val Acc: 0.7662
 Best site-sketch                   (2)  | Epoch:16 | Val Acc: 0.5128
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 9, 7, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-photo                     (2) | Train Loss: 0.2679 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2817 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.2865 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2768 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2721 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.4121 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.2259 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.3025 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.3281 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.3537 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 0.5337 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.6934 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.7172 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.6464 | Train Acc: 0.8333
 Site-art_painting              (2) | Train Loss: 0.7404 | Train Acc: 0.8359
 Site-cartoon                   (0) | Train Loss: 1.1906 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 0.8294 | Train Acc: 0.8174
 Site-sketch                    (3) | Train Loss: 1.3057 | Train Acc: 0.6034
Average Train Accuracy: 0.8995
 Site-photo                     (2) | Val  Loss: 0.4108 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.5167 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.4365 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.2924 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3091 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.2872 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2865 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3211 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3018 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.3134 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.7001 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.6529 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.6775 | Val  Acc: 0.8846
 Site-art_painting              (2) | Val  Loss: 0.6691 | Val  Acc: 0.8723
 Site-art_painting              (2) | Val  Loss: 0.7660 | Val  Acc: 0.8353
 Site-cartoon                   (0) | Val  Loss: 0.9854 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.8691 | Val  Acc: 0.7532
 Site-sketch                    (3) | Val  Loss: 1.3899 | Val  Acc: 0.5385
Average Valid Accuracy: 0.8934
 Best site-photo                    (2)  | Epoch:17 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 0.9630
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:17 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8750
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.9333
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8846
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8723
 Best site-art_painting             (2)  | Epoch:17 | Val Acc: 0.8353
 Best site-cartoon                  (0)  | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                  (2)  | Epoch:17 | Val Acc: 0.7532
 Best site-sketch                   (3)  | Epoch:17 | Val Acc: 0.5385
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 18 ============
cnt=[3, 5, 9, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-photo                     (2) | Train Loss: 0.2705 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2587 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.2541 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2513 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2683 | Train Acc: 0.9750
 Site-photo                     (2) | Train Loss: 0.4040 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.3405 | Train Acc: 0.9706
 Site-photo                     (2) | Train Loss: 0.2859 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.3376 | Train Acc: 0.9558
 Site-photo                     (2) | Train Loss: 0.3850 | Train Acc: 0.9589
 Site-art_painting              (3) | Train Loss: 0.4700 | Train Acc: 1.0000
 Site-art_painting              (1) | Train Loss: 0.6593 | Train Acc: 0.8636
 Site-art_painting              (1) | Train Loss: 0.6630 | Train Acc: 0.8500
 Site-art_painting              (1) | Train Loss: 0.6103 | Train Acc: 0.8611
 Site-art_painting              (1) | Train Loss: 0.7003 | Train Acc: 0.8594
 Site-cartoon                   (0) | Train Loss: 1.1047 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.7922 | Train Acc: 0.8261
 Site-sketch                    (0) | Train Loss: 1.2348 | Train Acc: 0.6034
Average Train Accuracy: 0.9064
 Site-photo                     (2) | Val  Loss: 0.4365 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.4690 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.4996 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.2909 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3092 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.2635 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.2742 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.3066 | Val  Acc: 0.9828
 Site-photo                     (2) | Val  Loss: 0.3112 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.3166 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.5739 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.5920 | Val  Acc: 0.9333
 Site-art_painting              (1) | Val  Loss: 0.6161 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.6067 | Val  Acc: 0.9149
 Site-art_painting              (1) | Val  Loss: 0.7026 | Val  Acc: 0.8588
 Site-cartoon                   (0) | Val  Loss: 1.1622 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.8387 | Val  Acc: 0.7662
 Site-sketch                    (0) | Val  Loss: 1.2287 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9018
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:18 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9630
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9828
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9867
 Best site-photo                    (2)  | Epoch:18 | Val Acc: 0.9588
 Best site-art_painting             (3)  | Epoch:18 | Val Acc: 0.8750
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.9333
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.9231
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.9149
 Best site-art_painting             (1)  | Epoch:18 | Val Acc: 0.8588
 Best site-cartoon                  (0)  | Epoch:18 | Val Acc: 0.7143
 Best site-cartoon                  (0)  | Epoch:18 | Val Acc: 0.7662
 Best site-sketch                   (0)  | Epoch:18 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 19 ============
cnt=[4, 1, 3, 10, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-photo                     (2) | Train Loss: 0.2414 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2266 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2535 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2501 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2606 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.4017 | Train Acc: 0.9423
 Site-photo                     (3) | Train Loss: 0.3444 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.2641 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2972 | Train Acc: 0.9735
 Site-photo                     (3) | Train Loss: 0.3255 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 0.4438 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.5913 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.6528 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.6165 | Train Acc: 0.8194
 Site-art_painting              (0) | Train Loss: 0.6243 | Train Acc: 0.8750
 Site-cartoon                   (3) | Train Loss: 1.0632 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.7351 | Train Acc: 0.8174
 Site-sketch                    (1) | Train Loss: 1.1795 | Train Acc: 0.6207
Average Train Accuracy: 0.9157
 Site-photo                     (2) | Val  Loss: 0.3956 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4813 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.5269 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.2734 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2911 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.2416 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2638 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2849 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3027 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3304 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.6592 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.5779 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.5627 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.6583 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.7087 | Val  Acc: 0.8471
 Site-cartoon                   (3) | Val  Loss: 0.9401 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.8008 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 1.2697 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9132
 Best site-photo                    (2)  | Epoch:19 | Val Acc: 0.8889
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9167
 Best site-photo                    (0)  | Epoch:19 | Val Acc: 0.9375
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:19 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:19 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:19 | Val Acc: 0.8750
 Best site-art_painting             (3)  | Epoch:19 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:19 | Val Acc: 0.9615
 Best site-art_painting             (3)  | Epoch:19 | Val Acc: 0.8936
 Best site-art_painting             (0)  | Epoch:19 | Val Acc: 0.8471
 Best site-cartoon                  (3)  | Epoch:19 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:19 | Val Acc: 0.8312
 Best site-sketch                   (1)  | Epoch:19 | Val Acc: 0.5641
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 20 ============
cnt=[1, 6, 2, 9, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-photo                     (1) | Train Loss: 0.2598 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2258 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2197 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2399 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2229 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.4134 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.2281 | Train Acc: 0.9706
 Site-photo                     (3) | Train Loss: 0.3124 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.2965 | Train Acc: 0.9558
 Site-photo                     (3) | Train Loss: 0.2883 | Train Acc: 0.9589
 Site-art_painting              (3) | Train Loss: 0.3949 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.5766 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.6832 | Train Acc: 0.8000
 Site-art_painting              (1) | Train Loss: 0.6355 | Train Acc: 0.7917
 Site-art_painting              (1) | Train Loss: 0.6052 | Train Acc: 0.8828
 Site-cartoon                   (2) | Train Loss: 1.1343 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 0.6999 | Train Acc: 0.8348
 Site-sketch                    (0) | Train Loss: 1.1491 | Train Acc: 0.6897
Average Train Accuracy: 0.9013
 Site-photo                     (1) | Val  Loss: 0.4980 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.4558 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.4022 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.2437 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2341 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.2284 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.2211 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2864 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2617 | Val  Acc: 0.9733
 Site-photo                     (3) | Val  Loss: 0.3015 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.6145 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.5647 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.5102 | Val  Acc: 0.9615
 Site-art_painting              (1) | Val  Loss: 0.5599 | Val  Acc: 0.8936
 Site-art_painting              (1) | Val  Loss: 0.6130 | Val  Acc: 0.8706
 Site-cartoon                   (2) | Val  Loss: 1.0794 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.7936 | Val  Acc: 0.7922
 Site-sketch                    (0) | Val  Loss: 1.1733 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9039
============ Train epoch 21 ============
cnt=[10, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-photo                     (3) | Train Loss: 0.2364 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2045 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2213 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2026 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2109 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.3761 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.2762 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.2536 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2856 | Train Acc: 0.9469
 Site-photo                     (0) | Train Loss: 0.2685 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.4289 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.5844 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.5887 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.5367 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.5833 | Train Acc: 0.8906
 Site-cartoon                   (1) | Train Loss: 1.1037 | Train Acc: 0.5455
 Site-cartoon                   (1) | Train Loss: 0.6647 | Train Acc: 0.8783
 Site-sketch                    (2) | Train Loss: 1.1224 | Train Acc: 0.6379
Average Train Accuracy: 0.9112
 Site-photo                     (3) | Val  Loss: 0.5067 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.5280 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.4206 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.2248 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2298 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.2083 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.2197 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2908 | Val  Acc: 0.9655
 Site-photo                     (0) | Val  Loss: 0.2731 | Val  Acc: 0.9467
 Site-photo                     (0) | Val  Loss: 0.2710 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.5866 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5629 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.4809 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.5352 | Val  Acc: 0.9149
 Site-art_painting              (1) | Val  Loss: 0.6291 | Val  Acc: 0.8235
 Site-cartoon                   (1) | Val  Loss: 0.8542 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.7367 | Val  Acc: 0.7662
 Site-sketch                    (2) | Val  Loss: 1.0929 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8925
============ Train epoch 22 ============
cnt=[1, 7, 2, 8, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-photo                     (1) | Train Loss: 0.2051 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1822 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1948 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2039 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2134 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3350 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.1694 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2382 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.2596 | Train Acc: 0.9469
 Site-photo                     (1) | Train Loss: 0.2541 | Train Acc: 0.9521
 Site-art_painting              (3) | Train Loss: 0.3879 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.5887 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.5604 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.5530 | Train Acc: 0.8611
 Site-art_painting              (3) | Train Loss: 0.5485 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 1.1024 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.6117 | Train Acc: 0.8696
 Site-sketch                    (0) | Train Loss: 1.0298 | Train Acc: 0.6897
Average Train Accuracy: 0.9215
 Site-photo                     (1) | Val  Loss: 0.4778 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.4348 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.5077 | Val  Acc: 0.8750
 Site-photo                     (3) | Val  Loss: 0.2332 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2614 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.2002 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.2102 | Val  Acc: 0.9778
 Site-photo                     (1) | Val  Loss: 0.2660 | Val  Acc: 0.9655
 Site-photo                     (3) | Val  Loss: 0.2583 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.2544 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.5348 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.5006 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.4883 | Val  Acc: 0.8846
 Site-art_painting              (3) | Val  Loss: 0.5287 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.6272 | Val  Acc: 0.8588
 Site-cartoon                   (2) | Val  Loss: 0.8206 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.7741 | Val  Acc: 0.7143
 Site-sketch                    (0) | Val  Loss: 1.1020 | Val  Acc: 0.5641
Average Valid Accuracy: 0.8992
============ Train epoch 23 ============
cnt=[6, 10, 1, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-photo                     (0) | Train Loss: 0.2301 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1858 | Train Acc: 0.9444
 Site-photo                     (0) | Train Loss: 0.1961 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1881 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2049 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.3090 | Train Acc: 0.9808
 Site-photo                     (1) | Train Loss: 0.2037 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.2209 | Train Acc: 0.9886
 Site-photo                     (1) | Train Loss: 0.2652 | Train Acc: 0.9646
 Site-photo                     (1) | Train Loss: 0.2629 | Train Acc: 0.9658
 Site-art_painting              (1) | Train Loss: 0.4568 | Train Acc: 0.9167
 Site-art_painting              (1) | Train Loss: 0.5726 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.5217 | Train Acc: 0.9250
 Site-art_painting              (1) | Train Loss: 0.5003 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.5334 | Train Acc: 0.8906
 Site-cartoon                   (3) | Train Loss: 1.1504 | Train Acc: 0.4545
 Site-cartoon                   (0) | Train Loss: 0.6457 | Train Acc: 0.8435
 Site-sketch                    (2) | Train Loss: 0.9342 | Train Acc: 0.7414
Average Train Accuracy: 0.9112
 Site-photo                     (0) | Val  Loss: 0.4214 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4436 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.3546 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.1886 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2467 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.1931 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.2023 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.2496 | Val  Acc: 0.9828
 Site-photo                     (1) | Val  Loss: 0.2365 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.2320 | Val  Acc: 0.9897
 Site-art_painting              (1) | Val  Loss: 0.5416 | Val  Acc: 0.8750
 Site-art_painting              (1) | Val  Loss: 0.5459 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.4652 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.4743 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.5464 | Val  Acc: 0.8941
 Site-cartoon                   (3) | Val  Loss: 0.9574 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.7007 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 1.0279 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9038
============ Train epoch 24 ============
cnt=[7, 1, 9, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-photo                     (2) | Train Loss: 0.1846 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2014 | Train Acc: 0.9444
 Site-photo                     (2) | Train Loss: 0.1897 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1584 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1830 | Train Acc: 0.9500
 Site-photo                     (2) | Train Loss: 0.3449 | Train Acc: 0.9423
 Site-photo                     (2) | Train Loss: 0.1655 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1875 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.2471 | Train Acc: 0.9558
 Site-photo                     (2) | Train Loss: 0.2811 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.3880 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.5381 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4672 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.4907 | Train Acc: 0.8889
 Site-art_painting              (2) | Train Loss: 0.4968 | Train Acc: 0.9141
 Site-cartoon                   (0) | Train Loss: 1.0475 | Train Acc: 0.5455
 Site-cartoon                   (0) | Train Loss: 0.6344 | Train Acc: 0.8435
 Site-sketch                    (1) | Train Loss: 0.9798 | Train Acc: 0.6897
Average Train Accuracy: 0.9078
 Site-photo                     (2) | Val  Loss: 0.3756 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.4428 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.4404 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.1823 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1930 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.1898 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.1676 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2259 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1947 | Val  Acc: 0.9867
 Site-photo                     (2) | Val  Loss: 0.2365 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.5798 | Val  Acc: 0.8750
 Site-art_painting              (2) | Val  Loss: 0.4692 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3976 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.5322 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.5273 | Val  Acc: 0.8941
 Site-cartoon                   (0) | Val  Loss: 0.9690 | Val  Acc: 0.5714
 Site-cartoon                   (0) | Val  Loss: 0.7272 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 0.9861 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9023
============ Train epoch 25 ============
cnt=[12, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-photo                     (0) | Train Loss: 0.1625 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1630 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1654 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1572 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1739 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.3323 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1880 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1835 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2219 | Train Acc: 0.9469
 Site-photo                     (0) | Train Loss: 0.2171 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 0.3792 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.4466 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.5358 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.4280 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.5206 | Train Acc: 0.8906
 Site-cartoon                   (3) | Train Loss: 1.0449 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 0.5905 | Train Acc: 0.8522
 Site-sketch                    (1) | Train Loss: 0.9550 | Train Acc: 0.6724
Average Train Accuracy: 0.9153
 Site-photo                     (0) | Val  Loss: 0.2220 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2151 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2892 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.1655 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2047 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1491 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1625 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2109 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1654 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.2275 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.5434 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4919 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.5533 | Val  Acc: 0.8462
 Site-art_painting              (2) | Val  Loss: 0.4732 | Val  Acc: 0.8936
 Site-art_painting              (0) | Val  Loss: 0.5388 | Val  Acc: 0.8824
 Site-cartoon                   (3) | Val  Loss: 0.9183 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.6823 | Val  Acc: 0.8052
 Site-sketch                    (1) | Val  Loss: 1.0843 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9065
============ Train epoch 26 ============
cnt=[1, 2, 14, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-photo                     (3) | Train Loss: 0.1946 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1718 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1781 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1500 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1699 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.2512 | Train Acc: 0.9615
 Site-photo                     (2) | Train Loss: 0.5170 | Train Acc: 0.9559
 Site-photo                     (2) | Train Loss: 0.1821 | Train Acc: 0.9773
 Site-photo                     (2) | Train Loss: 0.2382 | Train Acc: 0.9558
 Site-photo                     (2) | Train Loss: 0.2089 | Train Acc: 0.9726
 Site-art_painting              (2) | Train Loss: 0.3383 | Train Acc: 0.9167
 Site-art_painting              (2) | Train Loss: 0.5387 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.5664 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.4920 | Train Acc: 0.9028
 Site-art_painting              (2) | Train Loss: 0.4894 | Train Acc: 0.8906
 Site-cartoon                   (1) | Train Loss: 1.0058 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.5423 | Train Acc: 0.8609
 Site-sketch                    (0) | Train Loss: 0.9053 | Train Acc: 0.7069
Average Train Accuracy: 0.9215
 Site-photo                     (3) | Val  Loss: 0.4775 | Val  Acc: 0.8889
 Site-photo                     (2) | Val  Loss: 0.2897 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2970 | Val  Acc: 0.9375
 Site-photo                     (2) | Val  Loss: 0.1861 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1824 | Val  Acc: 0.9630
 Site-photo                     (2) | Val  Loss: 0.1670 | Val  Acc: 0.9714
 Site-photo                     (2) | Val  Loss: 0.1711 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1959 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1988 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.2346 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.4190 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.5508 | Val  Acc: 0.8667
 Site-art_painting              (2) | Val  Loss: 0.4246 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.5461 | Val  Acc: 0.8298
 Site-art_painting              (2) | Val  Loss: 0.4954 | Val  Acc: 0.9294
 Site-cartoon                   (1) | Val  Loss: 0.6872 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.6223 | Val  Acc: 0.8831
 Site-sketch                    (0) | Val  Loss: 1.0236 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9151
 Best site-photo                    (3)  | Epoch:26 | Val Acc: 0.8889
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 0.9375
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 0.9630
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 0.9714
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-photo                    (2)  | Epoch:26 | Val Acc: 0.9691
 Best site-art_painting             (2)  | Epoch:26 | Val Acc: 1.0000
 Best site-art_painting             (2)  | Epoch:26 | Val Acc: 0.8667
 Best site-art_painting             (2)  | Epoch:26 | Val Acc: 0.9615
 Best site-art_painting             (2)  | Epoch:26 | Val Acc: 0.8298
 Best site-art_painting             (2)  | Epoch:26 | Val Acc: 0.9294
 Best site-cartoon                  (1)  | Epoch:26 | Val Acc: 0.7143
 Best site-cartoon                  (1)  | Epoch:26 | Val Acc: 0.8831
 Best site-sketch                   (0)  | Epoch:26 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 27 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-photo                     (0) | Train Loss: 0.1655 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1906 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1536 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1704 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1446 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2457 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1565 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1636 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2125 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2771 | Train Acc: 0.9521
 Site-art_painting              (2) | Train Loss: 0.2629 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.4619 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.5375 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.5109 | Train Acc: 0.8472
 Site-art_painting              (2) | Train Loss: 0.4492 | Train Acc: 0.9219
 Site-cartoon                   (3) | Train Loss: 1.0633 | Train Acc: 0.5455
 Site-cartoon                   (3) | Train Loss: 0.5342 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.8913 | Train Acc: 0.7241
Average Train Accuracy: 0.9185
 Site-photo                     (0) | Val  Loss: 0.3721 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3342 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.3780 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.2067 | Val  Acc: 0.9524
 Site-photo                     (0) | Val  Loss: 0.1548 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1586 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1614 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1963 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1816 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1988 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.4632 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.3927 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.3946 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.4512 | Val  Acc: 0.9149
 Site-art_painting              (2) | Val  Loss: 0.4738 | Val  Acc: 0.8824
 Site-cartoon                   (3) | Val  Loss: 0.9585 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 0.6450 | Val  Acc: 0.8312
 Site-sketch                    (1) | Val  Loss: 0.9414 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9141
============ Train epoch 28 ============
cnt=[5, 2, 1, 10, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-photo                     (3) | Train Loss: 0.1447 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1229 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1405 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1380 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1521 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.2658 | Train Acc: 0.9808
 Site-photo                     (3) | Train Loss: 0.1303 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1595 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2222 | Train Acc: 0.9558
 Site-photo                     (3) | Train Loss: 0.2168 | Train Acc: 0.9521
 Site-art_painting              (0) | Train Loss: 0.2470 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.5020 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4072 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3607 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.4396 | Train Acc: 0.8984
 Site-cartoon                   (1) | Train Loss: 0.9751 | Train Acc: 0.8182
 Site-cartoon                   (1) | Train Loss: 0.5299 | Train Acc: 0.8435
 Site-sketch                    (2) | Train Loss: 0.7582 | Train Acc: 0.7931
Average Train Accuracy: 0.9371
 Site-photo                     (3) | Val  Loss: 0.3097 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.4810 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 0.3971 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.1695 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1670 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.1496 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1467 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1803 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1763 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1942 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.5077 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4657 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4244 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3876 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.5200 | Val  Acc: 0.9059
 Site-cartoon                   (1) | Val  Loss: 0.8791 | Val  Acc: 0.5714
 Site-cartoon                   (1) | Val  Loss: 0.6685 | Val  Acc: 0.8052
 Site-sketch                    (2) | Val  Loss: 0.9497 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8957
============ Train epoch 29 ============
cnt=[4, 1, 4, 9, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-photo                     (2) | Train Loss: 0.1275 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1355 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1413 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1428 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1342 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2438 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.2402 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.1538 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.2002 | Train Acc: 0.9469
 Site-photo                     (3) | Train Loss: 0.2028 | Train Acc: 0.9658
 Site-art_painting              (2) | Train Loss: 0.2859 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.4479 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4646 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4135 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.4389 | Train Acc: 0.9531
 Site-cartoon                   (2) | Train Loss: 0.9736 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.5248 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.8138 | Train Acc: 0.7069
Average Train Accuracy: 0.9398
 Site-photo                     (2) | Val  Loss: 0.4327 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3964 | Val  Acc: 0.9167
 Site-photo                     (2) | Val  Loss: 0.2561 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1401 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1945 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.1383 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1369 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1551 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1628 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1817 | Val  Acc: 0.9588
 Site-art_painting              (2) | Val  Loss: 0.3628 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4215 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.4353 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.4029 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4441 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.8375 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 0.6135 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8524 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9352
 Best site-photo                    (2)  | Epoch:29 | Val Acc: 0.8889
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9167
 Best site-photo                    (2)  | Epoch:29 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9630
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9714
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 1.0000
 Best site-photo                    (3)  | Epoch:29 | Val Acc: 0.9588
 Best site-art_painting             (2)  | Epoch:29 | Val Acc: 1.0000
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9333
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9231
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9149
 Best site-art_painting             (0)  | Epoch:29 | Val Acc: 0.9176
 Best site-cartoon                  (2)  | Epoch:29 | Val Acc: 0.8571
 Best site-cartoon                  (3)  | Epoch:29 | Val Acc: 0.8701
 Best site-sketch                   (1)  | Epoch:29 | Val Acc: 0.7179
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 30 ============
cnt=[7, 1, 1, 9, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-photo                     (3) | Train Loss: 0.1210 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1381 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1471 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1458 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1366 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2177 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1082 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1268 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1662 | Train Acc: 0.9823
 Site-photo                     (0) | Train Loss: 0.2221 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.2590 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.4109 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.4306 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.5245 | Train Acc: 0.8472
 Site-art_painting              (3) | Train Loss: 0.4183 | Train Acc: 0.9219
 Site-cartoon                   (2) | Train Loss: 0.8928 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.5142 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.8430 | Train Acc: 0.6897
Average Train Accuracy: 0.9327
 Site-photo                     (3) | Val  Loss: 0.3699 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3932 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.3153 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.1352 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1401 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.1329 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1432 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.1438 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1496 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1970 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.3747 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4881 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.3160 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3984 | Val  Acc: 0.9362
 Site-art_painting              (3) | Val  Loss: 0.4520 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.8440 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 0.6545 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.8993 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9192
============ Train epoch 31 ============
cnt=[9, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-photo                     (0) | Train Loss: 0.1205 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1349 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1546 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1369 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1230 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2347 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.1280 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1730 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2171 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1925 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.2990 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.4557 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.4739 | Train Acc: 0.8500
 Site-art_painting              (3) | Train Loss: 0.4112 | Train Acc: 0.8611
 Site-art_painting              (3) | Train Loss: 0.4010 | Train Acc: 0.9375
 Site-cartoon                   (2) | Train Loss: 0.8061 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.4976 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.8143 | Train Acc: 0.6897
Average Train Accuracy: 0.9288
 Site-photo                     (0) | Val  Loss: 0.3758 | Val  Acc: 0.7778
 Site-photo                     (0) | Val  Loss: 0.3753 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2138 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.1638 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1654 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1122 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1157 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1733 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1426 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1824 | Val  Acc: 0.9588
 Site-art_painting              (3) | Val  Loss: 0.4295 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.4580 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.3632 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.4188 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.4032 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.8260 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5983 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.9236 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9024
============ Train epoch 32 ============
cnt=[3, 1, 4, 10, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-photo                     (0) | Train Loss: 0.1146 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1207 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1548 | Train Acc: 1.0000
 Site-photo                     (2) | Train Loss: 0.1213 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1407 | Train Acc: 0.9750
 Site-photo                     (3) | Train Loss: 0.2597 | Train Acc: 0.9423
 Site-photo                     (3) | Train Loss: 0.1479 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1266 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1725 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.1817 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.1735 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.3395 | Train Acc: 0.9091
 Site-art_painting              (2) | Train Loss: 0.4435 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.5888 | Train Acc: 0.8750
 Site-art_painting              (2) | Train Loss: 0.4203 | Train Acc: 0.8828
 Site-cartoon                   (0) | Train Loss: 0.8170 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.5164 | Train Acc: 0.8870
 Site-sketch                    (1) | Train Loss: 0.7469 | Train Acc: 0.7414
Average Train Accuracy: 0.9339
 Site-photo                     (0) | Val  Loss: 0.3145 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3050 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1839 | Val  Acc: 1.0000
 Site-photo                     (2) | Val  Loss: 0.1493 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1565 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.1175 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1501 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1215 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.2033 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.4720 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.3441 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.3625 | Val  Acc: 0.9231
 Site-art_painting              (2) | Val  Loss: 0.3353 | Val  Acc: 0.9362
 Site-art_painting              (2) | Val  Loss: 0.4352 | Val  Acc: 0.8824
 Site-cartoon                   (0) | Val  Loss: 0.9800 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 0.6241 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.8113 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9121
============ Train epoch 33 ============
cnt=[8, 1, 2, 7, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-photo                     (3) | Train Loss: 0.1124 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1071 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1725 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.1023 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1394 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2504 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1187 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1339 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1960 | Train Acc: 0.9469
 Site-photo                     (0) | Train Loss: 0.2316 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.2159 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.4146 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.3770 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4268 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.3923 | Train Acc: 0.8984
 Site-cartoon                   (2) | Train Loss: 0.8376 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4925 | Train Acc: 0.8348
 Site-sketch                    (1) | Train Loss: 0.7155 | Train Acc: 0.8276
Average Train Accuracy: 0.9318
 Site-photo                     (3) | Val  Loss: 0.3061 | Val  Acc: 0.7778
 Site-photo                     (3) | Val  Loss: 0.2741 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.4306 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.1152 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1442 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1151 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1070 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1455 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1338 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.1741 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.3942 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.3337 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2906 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3647 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.3925 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.6367 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.6464 | Val  Acc: 0.8571
 Site-sketch                    (1) | Val  Loss: 0.8121 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9214
============ Train epoch 34 ============
cnt=[13, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-photo                     (0) | Train Loss: 0.0920 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1282 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1093 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1086 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1206 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2243 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.1478 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1530 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2258 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.1491 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.2008 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.4089 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.3887 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.3709 | Train Acc: 0.8611
 Site-art_painting              (0) | Train Loss: 0.4223 | Train Acc: 0.8906
 Site-cartoon                   (2) | Train Loss: 0.8893 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4375 | Train Acc: 0.8696
 Site-sketch                    (1) | Train Loss: 0.7112 | Train Acc: 0.7759
Average Train Accuracy: 0.9349
 Site-photo                     (0) | Val  Loss: 0.3099 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.2780 | Val  Acc: 0.8333
 Site-photo                     (3) | Val  Loss: 0.3325 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.1212 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1331 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1087 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1446 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1256 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1930 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.3160 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3945 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2837 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.4078 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.4298 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6459 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5377 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8132 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9208
============ Train epoch 35 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-photo                     (1) | Train Loss: 0.1032 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1198 | Train Acc: 0.9444
 Site-photo                     (1) | Train Loss: 0.1112 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1067 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1374 | Train Acc: 0.9750
 Site-photo                     (1) | Train Loss: 0.2491 | Train Acc: 0.9423
 Site-photo                     (1) | Train Loss: 0.0978 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1228 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1600 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1471 | Train Acc: 0.9726
 Site-art_painting              (3) | Train Loss: 0.1923 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.3321 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.4170 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.4616 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.3197 | Train Acc: 0.9453
 Site-cartoon                   (2) | Train Loss: 0.7774 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4239 | Train Acc: 0.8957
 Site-sketch                    (0) | Train Loss: 0.6891 | Train Acc: 0.7931
Average Train Accuracy: 0.9349
 Site-photo                     (1) | Val  Loss: 0.4189 | Val  Acc: 0.7778
 Site-photo                     (1) | Val  Loss: 0.2653 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.3529 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.1205 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1253 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.0908 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.1170 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1571 | Val  Acc: 0.9655
 Site-photo                     (1) | Val  Loss: 0.1318 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1724 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.4507 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.4009 | Val  Acc: 0.8667
 Site-art_painting              (3) | Val  Loss: 0.2995 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.4091 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.3910 | Val  Acc: 0.8941
 Site-cartoon                   (2) | Val  Loss: 0.8699 | Val  Acc: 0.7143
 Site-cartoon                   (2) | Val  Loss: 0.5611 | Val  Acc: 0.8701
 Site-sketch                    (0) | Val  Loss: 0.8103 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9058
============ Train epoch 36 ============
cnt=[13, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-photo                     (2) | Train Loss: 0.1072 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1053 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1067 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0876 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1120 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.2716 | Train Acc: 0.9231
 Site-photo                     (0) | Train Loss: 0.0998 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1152 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1903 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1567 | Train Acc: 0.9589
 Site-art_painting              (2) | Train Loss: 0.2267 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.3900 | Train Acc: 0.8636
 Site-art_painting              (0) | Train Loss: 0.3760 | Train Acc: 0.9500
 Site-art_painting              (0) | Train Loss: 0.3756 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.4057 | Train Acc: 0.8984
 Site-cartoon                   (3) | Train Loss: 0.7974 | Train Acc: 0.7273
 Site-cartoon                   (3) | Train Loss: 0.4228 | Train Acc: 0.8783
 Site-sketch                    (1) | Train Loss: 0.6822 | Train Acc: 0.7931
Average Train Accuracy: 0.9353
 Site-photo                     (2) | Val  Loss: 0.3856 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3274 | Val  Acc: 0.8333
 Site-photo                     (0) | Val  Loss: 0.3945 | Val  Acc: 0.8750
 Site-photo                     (0) | Val  Loss: 0.1062 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1135 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.1160 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.1082 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1395 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1498 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1870 | Val  Acc: 0.9691
 Site-art_painting              (2) | Val  Loss: 0.4614 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4408 | Val  Acc: 0.8000
 Site-art_painting              (0) | Val  Loss: 0.3820 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3830 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4538 | Val  Acc: 0.8588
 Site-cartoon                   (3) | Val  Loss: 0.6814 | Val  Acc: 0.7143
 Site-cartoon                   (3) | Val  Loss: 0.5088 | Val  Acc: 0.8442
 Site-sketch                    (1) | Val  Loss: 0.7587 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8943
============ Train epoch 37 ============
cnt=[5, 1, 1, 11, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-photo                     (0) | Train Loss: 0.1121 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1171 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1215 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1082 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1088 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2355 | Train Acc: 0.9423
 Site-photo                     (3) | Train Loss: 0.0977 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1154 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1690 | Train Acc: 0.9558
 Site-photo                     (3) | Train Loss: 0.1581 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.1920 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.3234 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.4078 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.4043 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.3759 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.8815 | Train Acc: 0.6364
 Site-cartoon                   (0) | Train Loss: 0.3790 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.5807 | Train Acc: 0.8621
Average Train Accuracy: 0.9374
 Site-photo                     (0) | Val  Loss: 0.4785 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.2216 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.3317 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.0857 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1371 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.0856 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.1007 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1384 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1137 | Val  Acc: 0.9867
 Site-photo                     (3) | Val  Loss: 0.1453 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.5172 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.3591 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2611 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.3420 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.4035 | Val  Acc: 0.9059
 Site-cartoon                   (2) | Val  Loss: 0.6133 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.6038 | Val  Acc: 0.7922
 Site-sketch                    (1) | Val  Loss: 0.8099 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9252
============ Train epoch 38 ============
cnt=[9, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-photo                     (3) | Train Loss: 0.0858 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0809 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1200 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0826 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1003 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.2325 | Train Acc: 0.9423
 Site-photo                     (3) | Train Loss: 0.1296 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.1410 | Train Acc: 0.9773
 Site-photo                     (0) | Train Loss: 0.1838 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.1807 | Train Acc: 0.9726
 Site-art_painting              (0) | Train Loss: 0.2663 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.3903 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.4055 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.3357 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.3474 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.9928 | Train Acc: 0.5455
 Site-cartoon                   (2) | Train Loss: 0.3685 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.6438 | Train Acc: 0.7759
Average Train Accuracy: 0.9265
 Site-photo                     (3) | Val  Loss: 0.2722 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3484 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2597 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.0973 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1064 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.1011 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.0908 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1250 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.1214 | Val  Acc: 0.9733
 Site-photo                     (3) | Val  Loss: 0.1447 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.2990 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3147 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.3729 | Val  Acc: 0.8846
 Site-art_painting              (0) | Val  Loss: 0.3609 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.3570 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6947 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.4756 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8243 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9291
============ Train epoch 39 ============
cnt=[1, 10, 2, 5, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-photo                     (1) | Train Loss: 0.0578 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0742 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1258 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0743 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0838 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1733 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.1664 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1038 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1359 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1629 | Train Acc: 0.9795
 Site-art_painting              (3) | Train Loss: 0.2423 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.3949 | Train Acc: 0.9545
 Site-art_painting              (3) | Train Loss: 0.3103 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.4971 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.3405 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.8661 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.4154 | Train Acc: 0.8696
 Site-sketch                    (0) | Train Loss: 0.6548 | Train Acc: 0.8103
Average Train Accuracy: 0.9471
 Site-photo                     (1) | Val  Loss: 0.2143 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3267 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1899 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.0835 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1033 | Val  Acc: 0.9630
 Site-photo                     (1) | Val  Loss: 0.0786 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.0829 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1110 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1201 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.1602 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.3025 | Val  Acc: 0.8750
 Site-art_painting              (3) | Val  Loss: 0.3537 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.3300 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.2937 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.3460 | Val  Acc: 0.8824
 Site-cartoon                   (2) | Val  Loss: 0.9024 | Val  Acc: 0.5714
 Site-cartoon                   (2) | Val  Loss: 0.6143 | Val  Acc: 0.8182
 Site-sketch                    (0) | Val  Loss: 0.7595 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9076
============ Train epoch 40 ============
cnt=[3, 2, 1, 12, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-photo                     (3) | Train Loss: 0.0892 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0795 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1343 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0732 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0814 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1670 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.0756 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0921 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1875 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.1773 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.2299 | Train Acc: 0.9167
 Site-art_painting              (0) | Train Loss: 0.2591 | Train Acc: 0.9545
 Site-art_painting              (0) | Train Loss: 0.3987 | Train Acc: 0.8750
 Site-art_painting              (3) | Train Loss: 0.3428 | Train Acc: 0.9028
 Site-art_painting              (3) | Train Loss: 0.3539 | Train Acc: 0.9219
 Site-cartoon                   (1) | Train Loss: 0.7481 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.3556 | Train Acc: 0.9478
 Site-sketch                    (2) | Train Loss: 0.6319 | Train Acc: 0.7931
Average Train Accuracy: 0.9398
 Site-photo                     (3) | Val  Loss: 0.3203 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.1726 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.3440 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1388 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.0772 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.0965 | Val  Acc: 0.9778
 Site-photo                     (3) | Val  Loss: 0.1034 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1030 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1289 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.1891 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3538 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2948 | Val  Acc: 0.9231
 Site-art_painting              (3) | Val  Loss: 0.3339 | Val  Acc: 0.9149
 Site-art_painting              (3) | Val  Loss: 0.3281 | Val  Acc: 0.9412
 Site-cartoon                   (1) | Val  Loss: 0.6504 | Val  Acc: 0.7143
 Site-cartoon                   (1) | Val  Loss: 0.4702 | Val  Acc: 0.8961
 Site-sketch                    (2) | Val  Loss: 0.7962 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9325
 Test site-photo                     (3)| Epoch:29 | Test Acc: 0.9881
 Test site-art_painting              (0)| Epoch:29 | Test Acc: 0.8965
 Test site-cartoon                   (1)| Epoch:29 | Test Acc: 0.8181
 Test site-sketch                    (2)| Epoch:29 | Test Acc: 0.6518
photo: 0.9881, art_painting: 0.8965, cartoon: 0.8181, sketch: 0.6518, 
Average Test Accuracy(group): 0.8386, Average Test Accuracy(individual): 0.9251,
domain std=0.1235, cluster std=0.1190, individual std=0.0886, 
Average Test Accuracy: 0.8386
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 41 ============
cnt=[15, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-photo                     (0) | Train Loss: 0.0666 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0795 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1101 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1035 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0822 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1805 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0738 | Train Acc: 0.9853
 Site-photo                     (0) | Train Loss: 0.1007 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1518 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.2057 | Train Acc: 0.9589
 Site-art_painting              (0) | Train Loss: 0.1755 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.3261 | Train Acc: 0.9545
 Site-art_painting              (0) | Train Loss: 0.4547 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.5158 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3670 | Train Acc: 0.9062
 Site-cartoon                   (3) | Train Loss: 0.8836 | Train Acc: 0.7273
 Site-cartoon                   (1) | Train Loss: 0.3694 | Train Acc: 0.9043
 Site-sketch                    (2) | Train Loss: 0.6236 | Train Acc: 0.8103
Average Train Accuracy: 0.9447
 Site-photo                     (0) | Val  Loss: 0.4477 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3351 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1793 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.0901 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1125 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.0939 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.0882 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1010 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1045 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.1410 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.4310 | Val  Acc: 0.8750
 Site-art_painting              (0) | Val  Loss: 0.4484 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.2885 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.3695 | Val  Acc: 0.8723
 Site-art_painting              (0) | Val  Loss: 0.3534 | Val  Acc: 0.9059
 Site-cartoon                   (3) | Val  Loss: 0.4991 | Val  Acc: 1.0000
 Site-cartoon                   (1) | Val  Loss: 0.4720 | Val  Acc: 0.8571
 Site-sketch                    (2) | Val  Loss: 0.7133 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9272
 Test site-photo                     (0)| Epoch:40 | Test Acc: 0.9881
 Test site-art_painting              (0)| Epoch:40 | Test Acc: 0.8977
 Test site-cartoon                   (3)| Epoch:40 | Test Acc: 0.8191
 Test site-sketch                    (2)| Epoch:40 | Test Acc: 0.6544
photo: 0.9881, art_painting: 0.8977, cartoon: 0.8191, sketch: 0.6544, 
Average Test Accuracy(group): 0.8398, Average Test Accuracy(individual): 0.9257,
domain std=0.1226, cluster std=0.1075, individual std=0.0879, 
Average Test Accuracy: 0.8398
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 42 ============
cnt=[10, 1, 5, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-photo                     (0) | Train Loss: 0.0743 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0662 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1073 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0880 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0825 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1638 | Train Acc: 0.9808
 Site-photo                     (0) | Train Loss: 0.0983 | Train Acc: 0.9706
 Site-photo                     (0) | Train Loss: 0.0957 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1618 | Train Acc: 0.9558
 Site-photo                     (0) | Train Loss: 0.1341 | Train Acc: 0.9589
 Site-art_painting              (2) | Train Loss: 0.2679 | Train Acc: 1.0000
 Site-art_painting              (2) | Train Loss: 0.3223 | Train Acc: 0.9545
 Site-art_painting              (2) | Train Loss: 0.4303 | Train Acc: 0.8500
 Site-art_painting              (2) | Train Loss: 0.3211 | Train Acc: 0.9028
 Site-art_painting              (2) | Train Loss: 0.3460 | Train Acc: 0.9219
 Site-cartoon                   (3) | Train Loss: 0.7718 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.3390 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.5908 | Train Acc: 0.7931
Average Train Accuracy: 0.9459
 Site-photo                     (0) | Val  Loss: 0.1267 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1907 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2007 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0989 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1073 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.0765 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0886 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1075 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1121 | Val  Acc: 0.9733
 Site-photo                     (0) | Val  Loss: 0.1431 | Val  Acc: 0.9794
 Site-art_painting              (2) | Val  Loss: 0.2672 | Val  Acc: 1.0000
 Site-art_painting              (2) | Val  Loss: 0.2813 | Val  Acc: 0.9333
 Site-art_painting              (2) | Val  Loss: 0.2303 | Val  Acc: 0.9615
 Site-art_painting              (2) | Val  Loss: 0.3425 | Val  Acc: 0.8936
 Site-art_painting              (2) | Val  Loss: 0.2970 | Val  Acc: 0.9412
 Site-cartoon                   (3) | Val  Loss: 0.9494 | Val  Acc: 0.5714
 Site-cartoon                   (3) | Val  Loss: 0.4813 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.6973 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9340
 Test site-photo                     (0)| Epoch:41 | Test Acc: 0.9866
 Test site-art_painting              (2)| Epoch:41 | Test Acc: 0.8940
 Test site-cartoon                   (3)| Epoch:41 | Test Acc: 0.8160
 Test site-sketch                    (1)| Epoch:41 | Test Acc: 0.6709
photo: 0.9866, art_painting: 0.8940, cartoon: 0.8160, sketch: 0.6709, 
Average Test Accuracy(group): 0.8419, Average Test Accuracy(individual): 0.9244,
domain std=0.1157, cluster std=0.1157, individual std=0.0853, 
Average Test Accuracy: 0.8419
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 12, 1, 3, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-photo                     (1) | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0721 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1098 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0795 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0783 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.2057 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.0880 | Train Acc: 0.9853
 Site-photo                     (1) | Train Loss: 0.0940 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1261 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1321 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.1710 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.4324 | Train Acc: 0.8636
 Site-art_painting              (3) | Train Loss: 0.3130 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.5559 | Train Acc: 0.8750
 Site-art_painting              (1) | Train Loss: 0.3325 | Train Acc: 0.9297
 Site-cartoon                   (0) | Train Loss: 0.8688 | Train Acc: 0.7273
 Site-cartoon                   (0) | Train Loss: 0.3409 | Train Acc: 0.9391
 Site-sketch                    (2) | Train Loss: 0.6137 | Train Acc: 0.7931
Average Train Accuracy: 0.9383
 Site-photo                     (1) | Val  Loss: 0.3967 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.3216 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1877 | Val  Acc: 0.9375
 Site-photo                     (1) | Val  Loss: 0.1192 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0900 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0745 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.0771 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0919 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0967 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.1425 | Val  Acc: 0.9691
 Site-art_painting              (3) | Val  Loss: 0.2734 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2879 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.2867 | Val  Acc: 0.9231
 Site-art_painting              (1) | Val  Loss: 0.2513 | Val  Acc: 0.9787
 Site-art_painting              (1) | Val  Loss: 0.3151 | Val  Acc: 0.9412
 Site-cartoon                   (0) | Val  Loss: 0.4689 | Val  Acc: 0.8571
 Site-cartoon                   (0) | Val  Loss: 0.4979 | Val  Acc: 0.9221
 Site-sketch                    (2) | Val  Loss: 0.7327 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9427
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.8889
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.9167
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.9375
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.9714
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 1.0000
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.9867
 Best site-photo                    (1)  | Epoch:43 | Val Acc: 0.9691
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 1.0000
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 0.9333
 Best site-art_painting             (3)  | Epoch:43 | Val Acc: 0.9231
 Best site-art_painting             (1)  | Epoch:43 | Val Acc: 0.9787
 Best site-art_painting             (1)  | Epoch:43 | Val Acc: 0.9412
 Best site-cartoon                  (0)  | Epoch:43 | Val Acc: 0.8571
 Best site-cartoon                  (0)  | Epoch:43 | Val Acc: 0.9221
 Best site-sketch                   (2)  | Epoch:43 | Val Acc: 0.7436
 Test site-photo                     (1)| Epoch:43 | Test Acc: 0.9866
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.8928
 Test site-cartoon                   (0)| Epoch:43 | Test Acc: 0.8191
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.6728
photo: 0.9866, art_painting: 0.8928, cartoon: 0.8191, sketch: 0.6728, 
Average Test Accuracy(group): 0.8428, Average Test Accuracy(individual): 0.9245,
domain std=0.1147, cluster std=0.1099, individual std=0.0847, 
Average Test Accuracy: 0.8428
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 44 ============
cnt=[12, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-photo                     (3) | Train Loss: 0.0625 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0720 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1217 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0687 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0708 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1977 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.1603 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1065 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1271 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1372 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.1743 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.4172 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.3611 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.3055 | Train Acc: 0.9028
 Site-art_painting              (0) | Train Loss: 0.3513 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.7625 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.3525 | Train Acc: 0.9130
 Site-sketch                    (1) | Train Loss: 0.5849 | Train Acc: 0.8621
Average Train Accuracy: 0.9431
 Site-photo                     (3) | Val  Loss: 0.2775 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3818 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.1656 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.0948 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0979 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0950 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1205 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.0952 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1039 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.4033 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2639 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2052 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.3489 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3192 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.6470 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.5536 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.7980 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9413
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9896
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.8928
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8096
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.6703
photo: 0.9896, art_painting: 0.8928, cartoon: 0.8096, sketch: 0.6703, 
Average Test Accuracy(group): 0.8406, Average Test Accuracy(individual): 0.9249,
domain std=0.1171, cluster std=0.1257, individual std=0.0877, 
Average Test Accuracy: 0.8406
============ Train epoch 45 ============
cnt=[5, 1, 2, 10, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-photo                     (3) | Train Loss: 0.0833 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0829 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0814 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0987 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1963 | Train Acc: 0.9615
 Site-photo                     (3) | Train Loss: 0.1177 | Train Acc: 0.9853
 Site-photo                     (3) | Train Loss: 0.0894 | Train Acc: 0.9886
 Site-photo                     (3) | Train Loss: 0.1396 | Train Acc: 0.9646
 Site-photo                     (3) | Train Loss: 0.1548 | Train Acc: 0.9658
 Site-art_painting              (0) | Train Loss: 0.1692 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.2995 | Train Acc: 0.9545
 Site-art_painting              (0) | Train Loss: 0.2947 | Train Acc: 0.9250
 Site-art_painting              (0) | Train Loss: 0.3873 | Train Acc: 0.8472
 Site-art_painting              (0) | Train Loss: 0.2930 | Train Acc: 0.9141
 Site-cartoon                   (2) | Train Loss: 0.8481 | Train Acc: 0.6364
 Site-cartoon                   (2) | Train Loss: 0.3884 | Train Acc: 0.8957
 Site-sketch                    (1) | Train Loss: 0.4982 | Train Acc: 0.8448
Average Train Accuracy: 0.9380
 Site-photo                     (3) | Val  Loss: 0.2599 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3468 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.3290 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.0992 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1007 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.0809 | Val  Acc: 0.9714
 Site-photo                     (3) | Val  Loss: 0.0742 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.0926 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1229 | Val  Acc: 0.9733
 Site-photo                     (3) | Val  Loss: 0.1131 | Val  Acc: 0.9691
 Site-art_painting              (0) | Val  Loss: 0.2991 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2818 | Val  Acc: 0.9333
 Site-art_painting              (0) | Val  Loss: 0.2652 | Val  Acc: 0.9231
 Site-art_painting              (0) | Val  Loss: 0.2486 | Val  Acc: 0.9574
 Site-art_painting              (0) | Val  Loss: 0.2986 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.7547 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.4530 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.6804 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9394
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9836
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.8879
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8074
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.6677
photo: 0.9836, art_painting: 0.8879, cartoon: 0.8074, sketch: 0.6677, 
Average Test Accuracy(group): 0.8367, Average Test Accuracy(individual): 0.9199,
domain std=0.1158, cluster std=0.1158, individual std=0.0865, 
Average Test Accuracy: 0.8367
============ Train epoch 46 ============
cnt=[9, 1, 2, 6, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-photo                     (3) | Train Loss: 0.1049 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1143 | Train Acc: 0.9444
 Site-photo                     (3) | Train Loss: 0.0958 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.0661 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0801 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1829 | Train Acc: 0.9423
 Site-photo                     (0) | Train Loss: 0.0859 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1075 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1305 | Train Acc: 0.9735
 Site-photo                     (0) | Train Loss: 0.1606 | Train Acc: 0.9658
 Site-art_painting              (3) | Train Loss: 0.1734 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.3246 | Train Acc: 0.9091
 Site-art_painting              (0) | Train Loss: 0.3205 | Train Acc: 0.9500
 Site-art_painting              (0) | Train Loss: 0.5467 | Train Acc: 0.8889
 Site-art_painting              (0) | Train Loss: 0.3353 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.7385 | Train Acc: 0.7273
 Site-cartoon                   (2) | Train Loss: 0.2945 | Train Acc: 0.9478
 Site-sketch                    (1) | Train Loss: 0.5854 | Train Acc: 0.8621
Average Train Accuracy: 0.9467
 Site-photo                     (3) | Val  Loss: 0.4453 | Val  Acc: 0.8889
 Site-photo                     (3) | Val  Loss: 0.3657 | Val  Acc: 0.9167
 Site-photo                     (3) | Val  Loss: 0.2760 | Val  Acc: 0.9375
 Site-photo                     (3) | Val  Loss: 0.0848 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0834 | Val  Acc: 0.9630
 Site-photo                     (3) | Val  Loss: 0.0756 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.0895 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1145 | Val  Acc: 0.9828
 Site-photo                     (0) | Val  Loss: 0.0832 | Val  Acc: 0.9867
 Site-photo                     (0) | Val  Loss: 0.1125 | Val  Acc: 0.9794
 Site-art_painting              (3) | Val  Loss: 0.2272 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.3624 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.1787 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2869 | Val  Acc: 0.9362
 Site-art_painting              (0) | Val  Loss: 0.3125 | Val  Acc: 0.9412
 Site-cartoon                   (2) | Val  Loss: 0.5370 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.4682 | Val  Acc: 0.9351
 Site-sketch                    (1) | Val  Loss: 0.7256 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9407
 Test site-photo                     (3)| Epoch:43 | Test Acc: 0.9866
 Test site-art_painting              (3)| Epoch:43 | Test Acc: 0.8928
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8138
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.6557
photo: 0.9866, art_painting: 0.8928, cartoon: 0.8138, sketch: 0.6557, 
Average Test Accuracy(group): 0.8372, Average Test Accuracy(individual): 0.9229,
domain std=0.1214, cluster std=0.1252, individual std=0.0883, 
Average Test Accuracy: 0.8372
============ Train epoch 47 ============
cnt=[15, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-photo                     (0) | Train Loss: 0.0573 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0868 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0837 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0628 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0676 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1560 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.1491 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0943 | Train Acc: 0.9886
 Site-photo                     (0) | Train Loss: 0.1808 | Train Acc: 0.9469
 Site-photo                     (0) | Train Loss: 0.1106 | Train Acc: 0.9795
 Site-art_painting              (0) | Train Loss: 0.1685 | Train Acc: 1.0000
 Site-art_painting              (0) | Train Loss: 0.3259 | Train Acc: 0.9545
 Site-art_painting              (0) | Train Loss: 0.3700 | Train Acc: 0.9000
 Site-art_painting              (0) | Train Loss: 0.4896 | Train Acc: 0.8750
 Site-art_painting              (0) | Train Loss: 0.3091 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.8124 | Train Acc: 0.8182
 Site-cartoon                   (3) | Train Loss: 0.3124 | Train Acc: 0.9304
 Site-sketch                    (1) | Train Loss: 0.5316 | Train Acc: 0.8793
Average Train Accuracy: 0.9535
 Site-photo                     (0) | Val  Loss: 0.1571 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1961 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.3181 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.0571 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1118 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.0773 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.0996 | Val  Acc: 0.9778
 Site-photo                     (0) | Val  Loss: 0.0946 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0863 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1194 | Val  Acc: 0.9794
 Site-art_painting              (0) | Val  Loss: 0.2971 | Val  Acc: 1.0000
 Site-art_painting              (0) | Val  Loss: 0.2700 | Val  Acc: 0.8667
 Site-art_painting              (0) | Val  Loss: 0.2265 | Val  Acc: 0.9615
 Site-art_painting              (0) | Val  Loss: 0.3288 | Val  Acc: 0.9149
 Site-art_painting              (0) | Val  Loss: 0.3986 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.4587 | Val  Acc: 0.8571
 Site-cartoon                   (3) | Val  Loss: 0.5037 | Val  Acc: 0.8701
 Site-sketch                    (1) | Val  Loss: 0.8262 | Val  Acc: 0.6923
Average Valid Accuracy: 0.9348
 Test site-photo                     (0)| Epoch:43 | Test Acc: 0.9851
 Test site-art_painting              (0)| Epoch:43 | Test Acc: 0.8928
 Test site-cartoon                   (2)| Epoch:43 | Test Acc: 0.8266
 Test site-sketch                    (1)| Epoch:43 | Test Acc: 0.6652
photo: 0.9851, art_painting: 0.8928, cartoon: 0.8266, sketch: 0.6652, 
Average Test Accuracy(group): 0.8424, Average Test Accuracy(individual): 0.9241,
domain std=0.1168, cluster std=0.1026, individual std=0.0844, 
Average Test Accuracy: 0.8424
============ Train epoch 48 ============
cnt=[2, 10, 1, 5, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-photo                     (1) | Train Loss: 0.0527 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0665 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0653 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0741 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.1966 | Train Acc: 0.9615
 Site-photo                     (1) | Train Loss: 0.0591 | Train Acc: 1.0000
 Site-photo                     (1) | Train Loss: 0.0865 | Train Acc: 1.0000
 Site-photo                     (3) | Train Loss: 0.1127 | Train Acc: 0.9735
 Site-photo                     (1) | Train Loss: 0.1510 | Train Acc: 0.9726
 Site-art_painting              (1) | Train Loss: 0.1323 | Train Acc: 1.0000
 Site-art_painting              (3) | Train Loss: 0.3595 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.3102 | Train Acc: 0.9000
 Site-art_painting              (3) | Train Loss: 0.4869 | Train Acc: 0.8889
 Site-art_painting              (3) | Train Loss: 0.2688 | Train Acc: 0.9453
 Site-cartoon                   (0) | Train Loss: 0.6790 | Train Acc: 0.8182
 Site-cartoon                   (0) | Train Loss: 0.3352 | Train Acc: 0.9217
 Site-sketch                    (2) | Train Loss: 0.4938 | Train Acc: 0.8448
Average Train Accuracy: 0.9520
 Site-photo                     (1) | Val  Loss: 0.4573 | Val  Acc: 0.8889
 Site-photo                     (1) | Val  Loss: 0.1761 | Val  Acc: 0.9167
 Site-photo                     (1) | Val  Loss: 0.1093 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0749 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0731 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.0841 | Val  Acc: 0.9714
 Site-photo                     (1) | Val  Loss: 0.0643 | Val  Acc: 1.0000
 Site-photo                     (1) | Val  Loss: 0.1006 | Val  Acc: 1.0000
 Site-photo                     (3) | Val  Loss: 0.1048 | Val  Acc: 0.9867
 Site-photo                     (1) | Val  Loss: 0.1241 | Val  Acc: 0.9794
 Site-art_painting              (1) | Val  Loss: 0.3124 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2308 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2122 | Val  Acc: 0.9615
 Site-art_painting              (3) | Val  Loss: 0.3057 | Val  Acc: 0.8936
 Site-art_painting              (3) | Val  Loss: 0.2802 | Val  Acc: 0.9647
 Site-cartoon                   (0) | Val  Loss: 0.6246 | Val  Acc: 0.7143
 Site-cartoon                   (0) | Val  Loss: 0.4778 | Val  Acc: 0.8701
 Site-sketch                    (2) | Val  Loss: 0.6940 | Val  Acc: 0.7949
Average Valid Accuracy: 0.9412
 Test site-photo                     (1)| Epoch:43 | Test Acc: 0.9866
 Test site-art_painting              (1)| Epoch:43 | Test Acc: 0.8892
 Test site-cartoon                   (0)| Epoch:43 | Test Acc: 0.8234
 Test site-sketch                    (2)| Epoch:43 | Test Acc: 0.6855
photo: 0.9866, art_painting: 0.8892, cartoon: 0.8234, sketch: 0.6855, 
Average Test Accuracy(group): 0.8462, Average Test Accuracy(individual): 0.9247,
domain std=0.1094, cluster std=0.1087, individual std=0.0824, 
Average Test Accuracy: 0.8462
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
============ Train epoch 49 ============
cnt=[10, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-photo                     (0) | Train Loss: 0.0853 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0544 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1200 | Train Acc: 0.9583
 Site-photo                     (0) | Train Loss: 0.0608 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.0733 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1524 | Train Acc: 0.9615
 Site-photo                     (0) | Train Loss: 0.0673 | Train Acc: 0.9559
 Site-photo                     (0) | Train Loss: 0.0848 | Train Acc: 1.0000
 Site-photo                     (0) | Train Loss: 0.1249 | Train Acc: 0.9646
 Site-photo                     (0) | Train Loss: 0.1171 | Train Acc: 0.9589
 Site-art_painting              (3) | Train Loss: 0.2833 | Train Acc: 0.9167
 Site-art_painting              (3) | Train Loss: 0.2920 | Train Acc: 0.9091
 Site-art_painting              (3) | Train Loss: 0.3261 | Train Acc: 0.9250
 Site-art_painting              (3) | Train Loss: 0.3365 | Train Acc: 0.9306
 Site-art_painting              (3) | Train Loss: 0.2764 | Train Acc: 0.9297
 Site-cartoon                   (2) | Train Loss: 0.8076 | Train Acc: 0.8182
 Site-cartoon                   (2) | Train Loss: 0.3324 | Train Acc: 0.9043
 Site-sketch                    (1) | Train Loss: 0.5603 | Train Acc: 0.7759
Average Train Accuracy: 0.9394
 Site-photo                     (0) | Val  Loss: 0.4218 | Val  Acc: 0.8889
 Site-photo                     (0) | Val  Loss: 0.3157 | Val  Acc: 0.9167
 Site-photo                     (0) | Val  Loss: 0.2481 | Val  Acc: 0.9375
 Site-photo                     (0) | Val  Loss: 0.0605 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1090 | Val  Acc: 0.9630
 Site-photo                     (0) | Val  Loss: 0.0777 | Val  Acc: 0.9714
 Site-photo                     (0) | Val  Loss: 0.0763 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.0841 | Val  Acc: 1.0000
 Site-photo                     (0) | Val  Loss: 0.1231 | Val  Acc: 0.9600
 Site-photo                     (0) | Val  Loss: 0.0868 | Val  Acc: 0.9897
 Site-art_painting              (3) | Val  Loss: 0.1679 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2107 | Val  Acc: 0.9333
 Site-art_painting              (3) | Val  Loss: 0.1947 | Val  Acc: 1.0000
 Site-art_painting              (3) | Val  Loss: 0.2202 | Val  Acc: 0.9574
 Site-art_painting              (3) | Val  Loss: 0.2957 | Val  Acc: 0.9176
 Site-cartoon                   (2) | Val  Loss: 0.5638 | Val  Acc: 0.8571
 Site-cartoon                   (2) | Val  Loss: 0.4486 | Val  Acc: 0.8831
 Site-sketch                    (1) | Val  Loss: 0.7313 | Val  Acc: 0.7692
Average Valid Accuracy: 0.9414
 Test site-photo                     (0)| Epoch:48 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:48 | Test Acc: 0.8879
 Test site-cartoon                   (2)| Epoch:48 | Test Acc: 0.8234
 Test site-sketch                    (1)| Epoch:48 | Test Acc: 0.6900
photo: 0.9881, art_painting: 0.8879, cartoon: 0.8234, sketch: 0.6900, 
Average Test Accuracy(group): 0.8473, Average Test Accuracy(individual): 0.9254,
domain std=0.1082, cluster std=0.1082, individual std=0.0825, 
Average Test Accuracy: 0.8473
 Saving the gmap checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/ccop_q=1...
===2023-08-12 08:27:19===
===2023-08-12 08:27:35===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     (0)| Epoch:49 | Test Acc: 0.9881
 Test site-art_painting              (3)| Epoch:49 | Test Acc: 0.8879
 Test site-cartoon                   (2)| Epoch:49 | Test Acc: 0.8234
 Test site-sketch                    (1)| Epoch:49 | Test Acc: 0.6900
photo: 0.9881, art_painting: 0.8879, cartoon: 0.8234, sketch: 0.6900, 
Average Test Accuracy(group): 0.8473, Average Test Accuracy(individual): 0.9254,
domain std=0.1082, cluster std=0.1082, individual std=0.0825, 
