===2023-08-10 21:19:56===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.8597 | Train Acc: 0.5000
 Site-photo                         | Train Loss: 1.8961 | Train Acc: 0.3889
 Site-photo                         | Train Loss: 1.9110 | Train Acc: 0.2500
 Site-photo                         | Train Loss: 1.8467 | Train Acc: 0.4516
 Site-photo                         | Train Loss: 1.8843 | Train Acc: 0.4000
 Site-photo                         | Train Loss: 1.8663 | Train Acc: 0.3269
 Site-photo                         | Train Loss: 1.8919 | Train Acc: 0.3235
 Site-photo                         | Train Loss: 1.8705 | Train Acc: 0.3523
 Site-photo                         | Train Loss: 1.8893 | Train Acc: 0.3009
 Site-photo                         | Train Loss: 1.8669 | Train Acc: 0.3836
 Site-art_painting                  | Train Loss: 1.9631 | Train Acc: 0.2500
 Site-art_painting                  | Train Loss: 1.9055 | Train Acc: 0.2273
 Site-art_painting                  | Train Loss: 1.8963 | Train Acc: 0.3500
 Site-art_painting                  | Train Loss: 1.8926 | Train Acc: 0.2361
 Site-art_painting                  | Train Loss: 1.8760 | Train Acc: 0.3281
 Site-cartoon                       | Train Loss: 1.9400 | Train Acc: 0.1818
 Site-cartoon                       | Train Loss: 1.9281 | Train Acc: 0.1739
 Site-sketch                        | Train Loss: 1.9612 | Train Acc: 0.0345
Average Train Accuracy: 0.3033
 Site-photo                         | Val  Loss: 1.8991 | Val  Acc: 0.2222
 Site-photo                         | Val  Loss: 1.8891 | Val  Acc: 0.1667
 Site-photo                         | Val  Loss: 1.9048 | Val  Acc: 0.4375
 Site-photo                         | Val  Loss: 1.8877 | Val  Acc: 0.2857
 Site-photo                         | Val  Loss: 1.8847 | Val  Acc: 0.3333
 Site-photo                         | Val  Loss: 1.8889 | Val  Acc: 0.2286
 Site-photo                         | Val  Loss: 1.8959 | Val  Acc: 0.3111
 Site-photo                         | Val  Loss: 1.8669 | Val  Acc: 0.4483
 Site-photo                         | Val  Loss: 1.8703 | Val  Acc: 0.3200
 Site-photo                         | Val  Loss: 1.8751 | Val  Acc: 0.3711
 Site-art_painting                  | Val  Loss: 1.9141 | Val  Acc: 0.2500
 Site-art_painting                  | Val  Loss: 1.9108 | Val  Acc: 0.1333
 Site-art_painting                  | Val  Loss: 1.8799 | Val  Acc: 0.4231
 Site-art_painting                  | Val  Loss: 1.8788 | Val  Acc: 0.3191
 Site-art_painting                  | Val  Loss: 1.8934 | Val  Acc: 0.2235
 Site-cartoon                       | Val  Loss: 1.9093 | Val  Acc: 0.1429
 Site-cartoon                       | Val  Loss: 1.9313 | Val  Acc: 0.1688
 Site-sketch                        | Val  Loss: 1.9614 | Val  Acc: 0.0769
Average Valid Accuracy: 0.2701
 Best site-photo                     | Epoch:0 | Val Acc: 0.2222
 Best site-photo                     | Epoch:0 | Val Acc: 0.1667
 Best site-photo                     | Epoch:0 | Val Acc: 0.4375
 Best site-photo                     | Epoch:0 | Val Acc: 0.2857
 Best site-photo                     | Epoch:0 | Val Acc: 0.3333
 Best site-photo                     | Epoch:0 | Val Acc: 0.2286
 Best site-photo                     | Epoch:0 | Val Acc: 0.3111
 Best site-photo                     | Epoch:0 | Val Acc: 0.4483
 Best site-photo                     | Epoch:0 | Val Acc: 0.3200
 Best site-photo                     | Epoch:0 | Val Acc: 0.3711
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2500
 Best site-art_painting              | Epoch:0 | Val Acc: 0.1333
 Best site-art_painting              | Epoch:0 | Val Acc: 0.4231
 Best site-art_painting              | Epoch:0 | Val Acc: 0.3191
 Best site-art_painting              | Epoch:0 | Val Acc: 0.2235
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.1429
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.1688
 Best site-sketch                    | Epoch:0 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 1.7458 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.8415 | Train Acc: 0.7222
 Site-photo                         | Train Loss: 1.8440 | Train Acc: 0.5833
 Site-photo                         | Train Loss: 1.7742 | Train Acc: 0.7742
 Site-photo                         | Train Loss: 1.8051 | Train Acc: 0.7500
 Site-photo                         | Train Loss: 1.7960 | Train Acc: 0.6731
 Site-photo                         | Train Loss: 1.8066 | Train Acc: 0.6176
 Site-photo                         | Train Loss: 1.7964 | Train Acc: 0.7386
 Site-photo                         | Train Loss: 1.8167 | Train Acc: 0.6549
 Site-photo                         | Train Loss: 1.8041 | Train Acc: 0.6781
 Site-art_painting                  | Train Loss: 1.8773 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.8782 | Train Acc: 0.3182
 Site-art_painting                  | Train Loss: 1.8751 | Train Acc: 0.4000
 Site-art_painting                  | Train Loss: 1.8390 | Train Acc: 0.4306
 Site-art_painting                  | Train Loss: 1.8559 | Train Acc: 0.3750
 Site-cartoon                       | Train Loss: 1.9306 | Train Acc: 0.1818
 Site-cartoon                       | Train Loss: 1.9001 | Train Acc: 0.2783
 Site-sketch                        | Train Loss: 1.9591 | Train Acc: 0.0690
Average Train Accuracy: 0.5374
 Site-photo                         | Val  Loss: 1.8352 | Val  Acc: 0.4444
 Site-photo                         | Val  Loss: 1.8368 | Val  Acc: 0.5833
 Site-photo                         | Val  Loss: 1.8412 | Val  Acc: 0.5625
 Site-photo                         | Val  Loss: 1.8373 | Val  Acc: 0.7143
 Site-photo                         | Val  Loss: 1.8068 | Val  Acc: 0.7037
 Site-photo                         | Val  Loss: 1.8130 | Val  Acc: 0.6286
 Site-photo                         | Val  Loss: 1.8173 | Val  Acc: 0.6444
 Site-photo                         | Val  Loss: 1.8068 | Val  Acc: 0.6552
 Site-photo                         | Val  Loss: 1.8001 | Val  Acc: 0.7067
 Site-photo                         | Val  Loss: 1.8066 | Val  Acc: 0.7010
 Site-art_painting                  | Val  Loss: 1.8839 | Val  Acc: 0.2500
 Site-art_painting                  | Val  Loss: 1.8559 | Val  Acc: 0.3333
 Site-art_painting                  | Val  Loss: 1.8476 | Val  Acc: 0.4231
 Site-art_painting                  | Val  Loss: 1.8504 | Val  Acc: 0.4255
 Site-art_painting                  | Val  Loss: 1.8519 | Val  Acc: 0.3882
 Site-cartoon                       | Val  Loss: 1.8751 | Val  Acc: 0.2857
 Site-cartoon                       | Val  Loss: 1.8878 | Val  Acc: 0.2987
 Site-sketch                        | Val  Loss: 1.9537 | Val  Acc: 0.0769
Average Valid Accuracy: 0.4903
 Best site-photo                     | Epoch:1 | Val Acc: 0.4444
 Best site-photo                     | Epoch:1 | Val Acc: 0.5833
 Best site-photo                     | Epoch:1 | Val Acc: 0.5625
 Best site-photo                     | Epoch:1 | Val Acc: 0.7143
 Best site-photo                     | Epoch:1 | Val Acc: 0.7037
 Best site-photo                     | Epoch:1 | Val Acc: 0.6286
 Best site-photo                     | Epoch:1 | Val Acc: 0.6444
 Best site-photo                     | Epoch:1 | Val Acc: 0.6552
 Best site-photo                     | Epoch:1 | Val Acc: 0.7067
 Best site-photo                     | Epoch:1 | Val Acc: 0.7010
 Best site-art_painting              | Epoch:1 | Val Acc: 0.2500
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3333
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4231
 Best site-art_painting              | Epoch:1 | Val Acc: 0.4255
 Best site-art_painting              | Epoch:1 | Val Acc: 0.3882
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.2857
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.2987
 Best site-sketch                    | Epoch:1 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 1.6522 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.7722 | Train Acc: 0.7778
 Site-photo                         | Train Loss: 1.7560 | Train Acc: 0.7917
 Site-photo                         | Train Loss: 1.6994 | Train Acc: 0.8710
 Site-photo                         | Train Loss: 1.7313 | Train Acc: 0.8000
 Site-photo                         | Train Loss: 1.7414 | Train Acc: 0.8269
 Site-photo                         | Train Loss: 1.7495 | Train Acc: 0.8382
 Site-photo                         | Train Loss: 1.7287 | Train Acc: 0.8182
 Site-photo                         | Train Loss: 1.7411 | Train Acc: 0.8407
 Site-photo                         | Train Loss: 1.7465 | Train Acc: 0.8219
 Site-art_painting                  | Train Loss: 1.8670 | Train Acc: 0.4167
 Site-art_painting                  | Train Loss: 1.8646 | Train Acc: 0.2727
 Site-art_painting                  | Train Loss: 1.8303 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.8109 | Train Acc: 0.5556
 Site-art_painting                  | Train Loss: 1.8011 | Train Acc: 0.4922
 Site-cartoon                       | Train Loss: 1.8313 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.8856 | Train Acc: 0.2957
 Site-sketch                        | Train Loss: 1.9587 | Train Acc: 0.1034
Average Train Accuracy: 0.6337
 Site-photo                         | Val  Loss: 1.7713 | Val  Acc: 0.7778
 Site-photo                         | Val  Loss: 1.7795 | Val  Acc: 0.7500
 Site-photo                         | Val  Loss: 1.7804 | Val  Acc: 0.8125
 Site-photo                         | Val  Loss: 1.7952 | Val  Acc: 0.8571
 Site-photo                         | Val  Loss: 1.7385 | Val  Acc: 0.8519
 Site-photo                         | Val  Loss: 1.7388 | Val  Acc: 0.9143
 Site-photo                         | Val  Loss: 1.7420 | Val  Acc: 0.8000
 Site-photo                         | Val  Loss: 1.7308 | Val  Acc: 0.8621
 Site-photo                         | Val  Loss: 1.7240 | Val  Acc: 0.8133
 Site-photo                         | Val  Loss: 1.7417 | Val  Acc: 0.8247
 Site-art_painting                  | Val  Loss: 1.8209 | Val  Acc: 0.3750
 Site-art_painting                  | Val  Loss: 1.8429 | Val  Acc: 0.4000
 Site-art_painting                  | Val  Loss: 1.8160 | Val  Acc: 0.5385
 Site-art_painting                  | Val  Loss: 1.8105 | Val  Acc: 0.4468
 Site-art_painting                  | Val  Loss: 1.8305 | Val  Acc: 0.4235
 Site-cartoon                       | Val  Loss: 1.8682 | Val  Acc: 0.2857
 Site-cartoon                       | Val  Loss: 1.8843 | Val  Acc: 0.2857
 Site-sketch                        | Val  Loss: 1.9315 | Val  Acc: 0.1026
Average Valid Accuracy: 0.6179
 Best site-photo                     | Epoch:2 | Val Acc: 0.7778
 Best site-photo                     | Epoch:2 | Val Acc: 0.7500
 Best site-photo                     | Epoch:2 | Val Acc: 0.8125
 Best site-photo                     | Epoch:2 | Val Acc: 0.8571
 Best site-photo                     | Epoch:2 | Val Acc: 0.8519
 Best site-photo                     | Epoch:2 | Val Acc: 0.9143
 Best site-photo                     | Epoch:2 | Val Acc: 0.8000
 Best site-photo                     | Epoch:2 | Val Acc: 0.8621
 Best site-photo                     | Epoch:2 | Val Acc: 0.8133
 Best site-photo                     | Epoch:2 | Val Acc: 0.8247
 Best site-art_painting              | Epoch:2 | Val Acc: 0.3750
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5385
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4468
 Best site-art_painting              | Epoch:2 | Val Acc: 0.4235
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.2857
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.2857
 Best site-sketch                    | Epoch:2 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 1.5890 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.7104 | Train Acc: 0.8333
 Site-photo                         | Train Loss: 1.6892 | Train Acc: 0.8750
 Site-photo                         | Train Loss: 1.6183 | Train Acc: 0.8710
 Site-photo                         | Train Loss: 1.6580 | Train Acc: 0.9500
 Site-photo                         | Train Loss: 1.6707 | Train Acc: 0.9231
 Site-photo                         | Train Loss: 1.6627 | Train Acc: 0.8971
 Site-photo                         | Train Loss: 1.6496 | Train Acc: 0.8977
 Site-photo                         | Train Loss: 1.6753 | Train Acc: 0.9292
 Site-photo                         | Train Loss: 1.6736 | Train Acc: 0.8904
 Site-art_painting                  | Train Loss: 1.7947 | Train Acc: 0.4167
 Site-art_painting                  | Train Loss: 1.8142 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.7833 | Train Acc: 0.5750
 Site-art_painting                  | Train Loss: 1.8111 | Train Acc: 0.5556
 Site-art_painting                  | Train Loss: 1.7788 | Train Acc: 0.5469
 Site-cartoon                       | Train Loss: 1.8935 | Train Acc: 0.2727
 Site-cartoon                       | Train Loss: 1.8586 | Train Acc: 0.3739
 Site-sketch                        | Train Loss: 1.9495 | Train Acc: 0.0690
Average Train Accuracy: 0.6836
 Site-photo                         | Val  Loss: 1.6753 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.6984 | Val  Acc: 0.8333
 Site-photo                         | Val  Loss: 1.7236 | Val  Acc: 0.8125
 Site-photo                         | Val  Loss: 1.7070 | Val  Acc: 0.9048
 Site-photo                         | Val  Loss: 1.6682 | Val  Acc: 0.9630
 Site-photo                         | Val  Loss: 1.6578 | Val  Acc: 0.9429
 Site-photo                         | Val  Loss: 1.6776 | Val  Acc: 0.8222
 Site-photo                         | Val  Loss: 1.6704 | Val  Acc: 0.9138
 Site-photo                         | Val  Loss: 1.6521 | Val  Acc: 0.8933
 Site-photo                         | Val  Loss: 1.6749 | Val  Acc: 0.8969
 Site-art_painting                  | Val  Loss: 1.7488 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.8271 | Val  Acc: 0.6000
 Site-art_painting                  | Val  Loss: 1.7665 | Val  Acc: 0.5000
 Site-art_painting                  | Val  Loss: 1.7656 | Val  Acc: 0.5319
 Site-art_painting                  | Val  Loss: 1.7899 | Val  Acc: 0.5176
 Site-cartoon                       | Val  Loss: 1.8623 | Val  Acc: 0.2857
 Site-cartoon                       | Val  Loss: 1.8410 | Val  Acc: 0.4156
 Site-sketch                        | Val  Loss: 1.9363 | Val  Acc: 0.1026
Average Valid Accuracy: 0.6986
 Best site-photo                     | Epoch:3 | Val Acc: 0.8889
 Best site-photo                     | Epoch:3 | Val Acc: 0.8333
 Best site-photo                     | Epoch:3 | Val Acc: 0.8125
 Best site-photo                     | Epoch:3 | Val Acc: 0.9048
 Best site-photo                     | Epoch:3 | Val Acc: 0.9630
 Best site-photo                     | Epoch:3 | Val Acc: 0.9429
 Best site-photo                     | Epoch:3 | Val Acc: 0.8222
 Best site-photo                     | Epoch:3 | Val Acc: 0.9138
 Best site-photo                     | Epoch:3 | Val Acc: 0.8933
 Best site-photo                     | Epoch:3 | Val Acc: 0.8969
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:3 | Val Acc: 0.6000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5319
 Best site-art_painting              | Epoch:3 | Val Acc: 0.5176
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.2857
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.4156
 Best site-sketch                    | Epoch:3 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 1.5055 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.6453 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.5997 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 1.5433 | Train Acc: 0.9355
 Site-photo                         | Train Loss: 1.5895 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 1.6241 | Train Acc: 0.9423
 Site-photo                         | Train Loss: 1.5728 | Train Acc: 0.9412
 Site-photo                         | Train Loss: 1.5886 | Train Acc: 0.9432
 Site-photo                         | Train Loss: 1.6137 | Train Acc: 0.9292
 Site-photo                         | Train Loss: 1.5865 | Train Acc: 0.9589
 Site-art_painting                  | Train Loss: 1.7683 | Train Acc: 0.5833
 Site-art_painting                  | Train Loss: 1.8043 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.7506 | Train Acc: 0.5750
 Site-art_painting                  | Train Loss: 1.7310 | Train Acc: 0.6111
 Site-art_painting                  | Train Loss: 1.7367 | Train Acc: 0.5781
 Site-cartoon                       | Train Loss: 1.8347 | Train Acc: 0.3636
 Site-cartoon                       | Train Loss: 1.8215 | Train Acc: 0.4522
 Site-sketch                        | Train Loss: 1.9458 | Train Acc: 0.1379
Average Train Accuracy: 0.7366
 Site-photo                         | Val  Loss: 1.6344 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.6434 | Val  Acc: 0.9167
 Site-photo                         | Val  Loss: 1.6947 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 1.6423 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.6054 | Val  Acc: 0.9630
 Site-photo                         | Val  Loss: 1.5849 | Val  Acc: 0.9714
 Site-photo                         | Val  Loss: 1.5920 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.5988 | Val  Acc: 0.9138
 Site-photo                         | Val  Loss: 1.5915 | Val  Acc: 0.9600
 Site-photo                         | Val  Loss: 1.6052 | Val  Acc: 0.9588
 Site-art_painting                  | Val  Loss: 1.7851 | Val  Acc: 0.5000
 Site-art_painting                  | Val  Loss: 1.8008 | Val  Acc: 0.4667
 Site-art_painting                  | Val  Loss: 1.7627 | Val  Acc: 0.5385
 Site-art_painting                  | Val  Loss: 1.7414 | Val  Acc: 0.5106
 Site-art_painting                  | Val  Loss: 1.7657 | Val  Acc: 0.4824
 Site-cartoon                       | Val  Loss: 1.8526 | Val  Acc: 0.4286
 Site-cartoon                       | Val  Loss: 1.8376 | Val  Acc: 0.4286
 Site-sketch                        | Val  Loss: 1.9377 | Val  Acc: 0.0769
Average Valid Accuracy: 0.7067
 Best site-photo                     | Epoch:4 | Val Acc: 0.8889
 Best site-photo                     | Epoch:4 | Val Acc: 0.9167
 Best site-photo                     | Epoch:4 | Val Acc: 0.8750
 Best site-photo                     | Epoch:4 | Val Acc: 0.9524
 Best site-photo                     | Epoch:4 | Val Acc: 0.9630
 Best site-photo                     | Epoch:4 | Val Acc: 0.9714
 Best site-photo                     | Epoch:4 | Val Acc: 0.8889
 Best site-photo                     | Epoch:4 | Val Acc: 0.9138
 Best site-photo                     | Epoch:4 | Val Acc: 0.9600
 Best site-photo                     | Epoch:4 | Val Acc: 0.9588
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:4 | Val Acc: 0.4667
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5385
 Best site-art_painting              | Epoch:4 | Val Acc: 0.5106
 Best site-art_painting              | Epoch:4 | Val Acc: 0.4824
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.4286
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.4286
 Best site-sketch                    | Epoch:4 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 1.4728 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.5818 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 1.5623 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 1.4730 | Train Acc: 0.9677
 Site-photo                         | Train Loss: 1.5228 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 1.5445 | Train Acc: 0.9423
 Site-photo                         | Train Loss: 1.5498 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.5224 | Train Acc: 0.9659
 Site-photo                         | Train Loss: 1.5421 | Train Acc: 0.9469
 Site-photo                         | Train Loss: 1.5385 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 1.7456 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.7360 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.7257 | Train Acc: 0.5750
 Site-art_painting                  | Train Loss: 1.7046 | Train Acc: 0.6528
 Site-art_painting                  | Train Loss: 1.7164 | Train Acc: 0.6328
 Site-cartoon                       | Train Loss: 1.8424 | Train Acc: 0.3636
 Site-cartoon                       | Train Loss: 1.7856 | Train Acc: 0.5391
 Site-sketch                        | Train Loss: 1.9452 | Train Acc: 0.1034
Average Train Accuracy: 0.7528
 Site-photo                         | Val  Loss: 1.5406 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.5685 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.6071 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.5654 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.5207 | Val  Acc: 0.9630
 Site-photo                         | Val  Loss: 1.5165 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.5375 | Val  Acc: 0.9556
 Site-photo                         | Val  Loss: 1.5272 | Val  Acc: 0.9655
 Site-photo                         | Val  Loss: 1.5184 | Val  Acc: 0.9333
 Site-photo                         | Val  Loss: 1.5303 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.6878 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.7165 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.6761 | Val  Acc: 0.6923
 Site-art_painting                  | Val  Loss: 1.7476 | Val  Acc: 0.5745
 Site-art_painting                  | Val  Loss: 1.7258 | Val  Acc: 0.6706
 Site-cartoon                       | Val  Loss: 1.8166 | Val  Acc: 0.2857
 Site-cartoon                       | Val  Loss: 1.8079 | Val  Acc: 0.4675
 Site-sketch                        | Val  Loss: 1.9140 | Val  Acc: 0.1282
Average Valid Accuracy: 0.7609
 Best site-photo                     | Epoch:5 | Val Acc: 0.8889
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9375
 Best site-photo                     | Epoch:5 | Val Acc: 0.9524
 Best site-photo                     | Epoch:5 | Val Acc: 0.9630
 Best site-photo                     | Epoch:5 | Val Acc: 1.0000
 Best site-photo                     | Epoch:5 | Val Acc: 0.9556
 Best site-photo                     | Epoch:5 | Val Acc: 0.9655
 Best site-photo                     | Epoch:5 | Val Acc: 0.9333
 Best site-photo                     | Epoch:5 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6250
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6923
 Best site-art_painting              | Epoch:5 | Val Acc: 0.5745
 Best site-art_painting              | Epoch:5 | Val Acc: 0.6706
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.2857
 Best site-cartoon                   | Epoch:5 | Val Acc: 0.4675
 Best site-sketch                    | Epoch:5 | Val Acc: 0.1282
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 1.3695 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.5328 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 1.4814 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 1.4252 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4485 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.4982 | Train Acc: 0.9231
 Site-photo                         | Train Loss: 1.4883 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.4603 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 1.4692 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 1.4766 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 1.6918 | Train Acc: 0.5833
 Site-art_painting                  | Train Loss: 1.7242 | Train Acc: 0.5455
 Site-art_painting                  | Train Loss: 1.7231 | Train Acc: 0.6250
 Site-art_painting                  | Train Loss: 1.6751 | Train Acc: 0.6528
 Site-art_painting                  | Train Loss: 1.6747 | Train Acc: 0.6484
 Site-cartoon                       | Train Loss: 1.8052 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.7768 | Train Acc: 0.5130
 Site-sketch                        | Train Loss: 1.9489 | Train Acc: 0.1207
Average Train Accuracy: 0.7653
 Site-photo                         | Val  Loss: 1.4938 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.5297 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.5400 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.5159 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.4693 | Val  Acc: 0.9630
 Site-photo                         | Val  Loss: 1.4417 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4734 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.4720 | Val  Acc: 0.9655
 Site-photo                         | Val  Loss: 1.4486 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4743 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.6786 | Val  Acc: 0.5000
 Site-art_painting                  | Val  Loss: 1.6745 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.6440 | Val  Acc: 0.7308
 Site-art_painting                  | Val  Loss: 1.6588 | Val  Acc: 0.6809
 Site-art_painting                  | Val  Loss: 1.6953 | Val  Acc: 0.6000
 Site-cartoon                       | Val  Loss: 1.8239 | Val  Acc: 0.4286
 Site-cartoon                       | Val  Loss: 1.7904 | Val  Acc: 0.5455
 Site-sketch                        | Val  Loss: 1.9274 | Val  Acc: 0.1026
Average Valid Accuracy: 0.7770
 Best site-photo                     | Epoch:6 | Val Acc: 0.8889
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9375
 Best site-photo                     | Epoch:6 | Val Acc: 0.9524
 Best site-photo                     | Epoch:6 | Val Acc: 0.9630
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9778
 Best site-photo                     | Epoch:6 | Val Acc: 0.9655
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9794
 Best site-art_painting              | Epoch:6 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7308
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6809
 Best site-art_painting              | Epoch:6 | Val Acc: 0.6000
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.4286
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.5455
 Best site-sketch                    | Epoch:6 | Val Acc: 0.1026
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 1.3302 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.4351 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.4635 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 1.3484 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3943 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 1.4268 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.4015 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.3837 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.4135 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 1.3984 | Train Acc: 0.9658
 Site-art_painting                  | Train Loss: 1.6857 | Train Acc: 0.5000
 Site-art_painting                  | Train Loss: 1.6735 | Train Acc: 0.5455
 Site-art_painting                  | Train Loss: 1.7023 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.5943 | Train Acc: 0.6806
 Site-art_painting                  | Train Loss: 1.6415 | Train Acc: 0.7422
 Site-cartoon                       | Train Loss: 1.7674 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.7426 | Train Acc: 0.5478
 Site-sketch                        | Train Loss: 1.9410 | Train Acc: 0.1207
Average Train Accuracy: 0.7805
 Site-photo                         | Val  Loss: 1.4398 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.4574 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4741 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.4645 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.4087 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3693 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4087 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.4080 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.4054 | Val  Acc: 0.9733
 Site-photo                         | Val  Loss: 1.4038 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.6440 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.6720 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.5763 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.6763 | Val  Acc: 0.5532
 Site-art_painting                  | Val  Loss: 1.6461 | Val  Acc: 0.7176
 Site-cartoon                       | Val  Loss: 1.7978 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.7667 | Val  Acc: 0.5195
 Site-sketch                        | Val  Loss: 1.9480 | Val  Acc: 0.0513
Average Valid Accuracy: 0.8067
 Best site-photo                     | Epoch:7 | Val Acc: 0.8889
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9375
 Best site-photo                     | Epoch:7 | Val Acc: 0.9524
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 0.9778
 Best site-photo                     | Epoch:7 | Val Acc: 0.9828
 Best site-photo                     | Epoch:7 | Val Acc: 0.9733
 Best site-photo                     | Epoch:7 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:7 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:7 | Val Acc: 0.5532
 Best site-art_painting              | Epoch:7 | Val Acc: 0.7176
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.5195
 Best site-sketch                    | Epoch:7 | Val Acc: 0.0513
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 1.2735 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.4115 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 1.3655 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 1.2796 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3338 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3690 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.2944 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 1.3478 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 1.3435 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 1.3376 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 1.6267 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.6580 | Train Acc: 0.5909
 Site-art_painting                  | Train Loss: 1.6452 | Train Acc: 0.6750
 Site-art_painting                  | Train Loss: 1.5728 | Train Acc: 0.6944
 Site-art_painting                  | Train Loss: 1.6103 | Train Acc: 0.6641
 Site-cartoon                       | Train Loss: 1.7463 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.7059 | Train Acc: 0.6000
 Site-sketch                        | Train Loss: 1.9386 | Train Acc: 0.1207
Average Train Accuracy: 0.8043
 Site-photo                         | Val  Loss: 1.4022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3769 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.4491 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 1.3960 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.3437 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2956 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3515 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.3441 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.3218 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3412 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.5876 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.6428 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.5861 | Val  Acc: 0.6923
 Site-art_painting                  | Val  Loss: 1.6330 | Val  Acc: 0.7021
 Site-art_painting                  | Val  Loss: 1.6251 | Val  Acc: 0.6471
 Site-cartoon                       | Val  Loss: 1.7441 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.7416 | Val  Acc: 0.5844
 Site-sketch                        | Val  Loss: 1.9325 | Val  Acc: 0.0769
Average Valid Accuracy: 0.8261
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.8750
 Best site-photo                     | Epoch:8 | Val Acc: 0.9524
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9778
 Best site-photo                     | Epoch:8 | Val Acc: 0.9828
 Best site-photo                     | Epoch:8 | Val Acc: 1.0000
 Best site-photo                     | Epoch:8 | Val Acc: 0.9794
 Best site-art_painting              | Epoch:8 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:8 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:8 | Val Acc: 0.6923
 Best site-art_painting              | Epoch:8 | Val Acc: 0.7021
 Best site-art_painting              | Epoch:8 | Val Acc: 0.6471
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:8 | Val Acc: 0.5844
 Best site-sketch                    | Epoch:8 | Val Acc: 0.0769
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 1.1694 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3274 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.2965 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 1.2279 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2749 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3295 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.2829 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2776 | Train Acc: 0.9545
 Site-photo                         | Train Loss: 1.2868 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 1.2882 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 1.5848 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.6410 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.6149 | Train Acc: 0.6500
 Site-art_painting                  | Train Loss: 1.5615 | Train Acc: 0.6806
 Site-art_painting                  | Train Loss: 1.5812 | Train Acc: 0.6875
 Site-cartoon                       | Train Loss: 1.7481 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.6793 | Train Acc: 0.6435
 Site-sketch                        | Train Loss: 1.9253 | Train Acc: 0.1207
Average Train Accuracy: 0.8055
 Site-photo                         | Val  Loss: 1.2685 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3702 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3432 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.3289 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.2914 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2503 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2868 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3034 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.2708 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2754 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.6044 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.6105 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.5707 | Val  Acc: 0.6154
 Site-art_painting                  | Val  Loss: 1.5840 | Val  Acc: 0.7447
 Site-art_painting                  | Val  Loss: 1.5941 | Val  Acc: 0.6941
 Site-cartoon                       | Val  Loss: 1.7642 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.7134 | Val  Acc: 0.5584
 Site-sketch                        | Val  Loss: 1.9258 | Val  Acc: 0.0769
Average Valid Accuracy: 0.8088
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 1.1065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2836 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.2262 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 1.1763 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2136 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 1.2580 | Train Acc: 0.9615
 Site-photo                         | Train Loss: 1.1701 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2195 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.2336 | Train Acc: 0.9646
 Site-photo                         | Train Loss: 1.2209 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.5759 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.5818 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.5631 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.6177 | Train Acc: 0.7639
 Site-art_painting                  | Train Loss: 1.5661 | Train Acc: 0.7109
 Site-cartoon                       | Train Loss: 1.7171 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.6792 | Train Acc: 0.6348
 Site-sketch                        | Train Loss: 1.9448 | Train Acc: 0.1552
Average Train Accuracy: 0.8205
 Site-photo                         | Val  Loss: 1.2328 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.3148 | Val  Acc: 0.9167
 Site-photo                         | Val  Loss: 1.3344 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 1.2855 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.2134 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1987 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2281 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.2537 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.2069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2078 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.5501 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.5202 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.4931 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 1.5566 | Val  Acc: 0.7660
 Site-art_painting                  | Val  Loss: 1.5836 | Val  Acc: 0.7059
 Site-cartoon                       | Val  Loss: 1.7224 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.6965 | Val  Acc: 0.5714
 Site-sketch                        | Val  Loss: 1.9062 | Val  Acc: 0.1282
Average Valid Accuracy: 0.8262
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9167
 Best site-photo                     | Epoch:10 | Val Acc: 0.8750
 Best site-photo                     | Epoch:10 | Val Acc: 0.9524
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9778
 Best site-photo                     | Epoch:10 | Val Acc: 0.9828
 Best site-photo                     | Epoch:10 | Val Acc: 1.0000
 Best site-photo                     | Epoch:10 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:10 | Val Acc: 0.8077
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7660
 Best site-art_painting              | Epoch:10 | Val Acc: 0.7059
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:10 | Val Acc: 0.5714
 Best site-sketch                    | Epoch:10 | Val Acc: 0.1282
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 1.1021 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.2369 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.2009 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 1.1001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1361 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.2011 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.0844 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1590 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.1722 | Train Acc: 0.9646
 Site-photo                         | Train Loss: 1.1794 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.5653 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.5906 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.5257 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.5742 | Train Acc: 0.6806
 Site-art_painting                  | Train Loss: 1.5141 | Train Acc: 0.6875
 Site-cartoon                       | Train Loss: 1.7179 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.6422 | Train Acc: 0.5913
 Site-sketch                        | Train Loss: 1.9424 | Train Acc: 0.1379
Average Train Accuracy: 0.8119
 Site-photo                         | Val  Loss: 1.1572 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2524 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2838 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.2322 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.1652 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1103 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1812 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1865 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.1466 | Val  Acc: 0.9733
 Site-photo                         | Val  Loss: 1.1626 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.5492 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.5481 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.4547 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.5292 | Val  Acc: 0.7447
 Site-art_painting                  | Val  Loss: 1.5451 | Val  Acc: 0.6824
 Site-cartoon                       | Val  Loss: 1.7186 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.6682 | Val  Acc: 0.6364
 Site-sketch                        | Val  Loss: 1.9145 | Val  Acc: 0.1538
Average Valid Accuracy: 0.8340
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9375
 Best site-photo                     | Epoch:11 | Val Acc: 0.9524
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 0.9828
 Best site-photo                     | Epoch:11 | Val Acc: 0.9733
 Best site-photo                     | Epoch:11 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:11 | Val Acc: 0.7447
 Best site-art_painting              | Epoch:11 | Val Acc: 0.6824
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.6364
 Best site-sketch                    | Epoch:11 | Val Acc: 0.1538
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 1.0162 | Train Acc: 0.9286
 Site-photo                         | Train Loss: 1.1815 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.1416 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0426 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0812 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1571 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.0847 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1116 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.1244 | Train Acc: 0.9646
 Site-photo                         | Train Loss: 1.1167 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.4720 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.5282 | Train Acc: 0.5909
 Site-art_painting                  | Train Loss: 1.5360 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.4863 | Train Acc: 0.7083
 Site-art_painting                  | Train Loss: 1.4870 | Train Acc: 0.7422
 Site-cartoon                       | Train Loss: 1.7901 | Train Acc: 0.2727
 Site-cartoon                       | Train Loss: 1.6107 | Train Acc: 0.6696
 Site-sketch                        | Train Loss: 1.9366 | Train Acc: 0.1034
Average Train Accuracy: 0.8078
 Site-photo                         | Val  Loss: 1.1200 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1813 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.1832 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.1018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0621 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1083 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1192 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.0871 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 1.1191 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.5222 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.5027 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.4552 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 1.4971 | Val  Acc: 0.7660
 Site-art_painting                  | Val  Loss: 1.4748 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.6854 | Val  Acc: 0.4286
 Site-cartoon                       | Val  Loss: 1.6578 | Val  Acc: 0.6494
 Site-sketch                        | Val  Loss: 1.9244 | Val  Acc: 0.0513
Average Valid Accuracy: 0.8248
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.8956 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1458 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 1.0784 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.9893 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0270 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0979 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0397 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0624 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.0674 | Train Acc: 0.9735
 Site-photo                         | Train Loss: 1.0941 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.5234 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.5145 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.4718 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.5144 | Train Acc: 0.6944
 Site-art_painting                  | Train Loss: 1.4595 | Train Acc: 0.7656
 Site-cartoon                       | Train Loss: 1.7015 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.6068 | Train Acc: 0.6261
 Site-sketch                        | Train Loss: 1.9040 | Train Acc: 0.1897
Average Train Accuracy: 0.8192
 Site-photo                         | Val  Loss: 1.0876 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1470 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.1773 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 1.1270 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.0519 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0168 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0702 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0755 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 1.0397 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0559 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.4845 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.5044 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.4149 | Val  Acc: 0.7308
 Site-art_painting                  | Val  Loss: 1.4747 | Val  Acc: 0.7447
 Site-art_painting                  | Val  Loss: 1.4779 | Val  Acc: 0.7294
 Site-cartoon                       | Val  Loss: 1.6540 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.6355 | Val  Acc: 0.6753
 Site-sketch                        | Val  Loss: 1.8743 | Val  Acc: 0.2308
Average Valid Accuracy: 0.8388
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.8750
 Best site-photo                     | Epoch:13 | Val Acc: 0.9524
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.9828
 Best site-photo                     | Epoch:13 | Val Acc: 1.0000
 Best site-photo                     | Epoch:13 | Val Acc: 0.9794
 Best site-art_painting              | Epoch:13 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:13 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:13 | Val Acc: 0.7308
 Best site-art_painting              | Epoch:13 | Val Acc: 0.7447
 Best site-art_painting              | Epoch:13 | Val Acc: 0.7294
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:13 | Val Acc: 0.6753
 Best site-sketch                    | Epoch:13 | Val Acc: 0.2308
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.8933 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.1172 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.0145 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9445 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9744 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0806 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 1.0270 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.9777 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.0182 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 1.0077 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 1.4306 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.4629 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 1.3903 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 1.4454 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 1.4311 | Train Acc: 0.7422
 Site-cartoon                       | Train Loss: 1.6319 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.5754 | Train Acc: 0.6348
 Site-sketch                        | Train Loss: 1.9037 | Train Acc: 0.1207
Average Train Accuracy: 0.8460
 Site-photo                         | Val  Loss: 1.0218 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.0877 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0989 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.0660 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9440 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0203 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 1.0507 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.9895 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 1.0103 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.4894 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.4425 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.3889 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 1.4378 | Val  Acc: 0.7872
 Site-art_painting                  | Val  Loss: 1.4592 | Val  Acc: 0.7647
 Site-cartoon                       | Val  Loss: 1.6610 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.6352 | Val  Acc: 0.6104
 Site-sketch                        | Val  Loss: 1.8906 | Val  Acc: 0.1538
Average Valid Accuracy: 0.8269
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.8172 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0043 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.9691 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8887 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9447 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.0090 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.8744 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.9408 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.9698 | Train Acc: 0.9646
 Site-photo                         | Train Loss: 0.9586 | Train Acc: 0.9658
 Site-art_painting                  | Train Loss: 1.4176 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4767 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.4064 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3575 | Train Acc: 0.6806
 Site-art_painting                  | Train Loss: 1.4032 | Train Acc: 0.7578
 Site-cartoon                       | Train Loss: 1.6540 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.5684 | Train Acc: 0.6261
 Site-sketch                        | Train Loss: 1.9033 | Train Acc: 0.1897
Average Train Accuracy: 0.8294
 Site-photo                         | Val  Loss: 1.0117 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0510 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0564 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 1.0118 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.9505 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9193 | Val  Acc: 0.9714
 Site-photo                         | Val  Loss: 0.9993 | Val  Acc: 0.9778
 Site-photo                         | Val  Loss: 0.9766 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.9612 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.9527 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.4572 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.3881 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 1.3932 | Val  Acc: 0.7308
 Site-art_painting                  | Val  Loss: 1.4201 | Val  Acc: 0.7447
 Site-art_painting                  | Val  Loss: 1.4257 | Val  Acc: 0.7176
 Site-cartoon                       | Val  Loss: 1.6284 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.6109 | Val  Acc: 0.6623
 Site-sketch                        | Val  Loss: 1.8828 | Val  Acc: 0.1282
Average Valid Accuracy: 0.8433
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9375
 Best site-photo                     | Epoch:15 | Val Acc: 0.9524
 Best site-photo                     | Epoch:15 | Val Acc: 1.0000
 Best site-photo                     | Epoch:15 | Val Acc: 0.9714
 Best site-photo                     | Epoch:15 | Val Acc: 0.9778
 Best site-photo                     | Epoch:15 | Val Acc: 0.9828
 Best site-photo                     | Epoch:15 | Val Acc: 0.9867
 Best site-photo                     | Epoch:15 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:15 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7308
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7447
 Best site-art_painting              | Epoch:15 | Val Acc: 0.7176
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:15 | Val Acc: 0.6623
 Best site-sketch                    | Epoch:15 | Val Acc: 0.1282
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.8312 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9634 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.8856 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8570 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9117 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.9529 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8729 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9148 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.9307 | Train Acc: 0.9735
 Site-photo                         | Train Loss: 0.9425 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.4110 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4044 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.4113 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 1.4874 | Train Acc: 0.7361
 Site-art_painting                  | Train Loss: 1.3796 | Train Acc: 0.7578
 Site-cartoon                       | Train Loss: 1.7287 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.5345 | Train Acc: 0.6957
 Site-sketch                        | Train Loss: 1.9165 | Train Acc: 0.1724
Average Train Accuracy: 0.8336
 Site-photo                         | Val  Loss: 0.9441 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.0097 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.0474 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 0.9732 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.9086 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8391 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8998 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9198 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.8805 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.9165 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.4130 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.3877 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.2889 | Val  Acc: 0.7692
 Site-art_painting                  | Val  Loss: 1.4056 | Val  Acc: 0.7447
 Site-art_painting                  | Val  Loss: 1.4330 | Val  Acc: 0.7059
 Site-cartoon                       | Val  Loss: 1.6867 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.5915 | Val  Acc: 0.6753
 Site-sketch                        | Val  Loss: 1.8599 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8371
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.7993 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9601 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.9636 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 0.8035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8324 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9020 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.7484 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8397 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.8711 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.8909 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 1.3517 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.4080 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 1.3792 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3663 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3685 | Train Acc: 0.7500
 Site-cartoon                       | Train Loss: 1.6011 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.5124 | Train Acc: 0.6957
 Site-sketch                        | Train Loss: 1.8983 | Train Acc: 0.1897
Average Train Accuracy: 0.8333
 Site-photo                         | Val  Loss: 0.8892 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9530 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9448 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.9215 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.8743 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7773 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8675 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8952 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.8653 | Val  Acc: 0.9733
 Site-photo                         | Val  Loss: 0.8652 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.3383 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.3377 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.3076 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 1.3548 | Val  Acc: 0.7660
 Site-art_painting                  | Val  Loss: 1.3994 | Val  Acc: 0.7529
 Site-cartoon                       | Val  Loss: 1.6545 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.5626 | Val  Acc: 0.7143
 Site-sketch                        | Val  Loss: 1.8902 | Val  Acc: 0.1282
Average Valid Accuracy: 0.8589
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9375
 Best site-photo                     | Epoch:17 | Val Acc: 0.9524
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 1.0000
 Best site-photo                     | Epoch:17 | Val Acc: 0.9828
 Best site-photo                     | Epoch:17 | Val Acc: 0.9733
 Best site-photo                     | Epoch:17 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:17 | Val Acc: 0.8077
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7660
 Best site-art_painting              | Epoch:17 | Val Acc: 0.7529
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:17 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:17 | Val Acc: 0.1282
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.7198 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9201 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.8166 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.7279 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8241 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.8603 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.7104 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7957 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.8291 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.8445 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.3142 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.3784 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.3649 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3010 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3120 | Train Acc: 0.7891
 Site-cartoon                       | Train Loss: 1.5791 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.4924 | Train Acc: 0.6870
 Site-sketch                        | Train Loss: 1.8739 | Train Acc: 0.2759
Average Train Accuracy: 0.8578
 Site-photo                         | Val  Loss: 0.8177 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9080 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9526 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.8633 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8106 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7542 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8189 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8686 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.7984 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8176 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.3040 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.3276 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.2534 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.3161 | Val  Acc: 0.8085
 Site-art_painting                  | Val  Loss: 1.3225 | Val  Acc: 0.8353
 Site-cartoon                       | Val  Loss: 1.6000 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.5430 | Val  Acc: 0.6494
 Site-sketch                        | Val  Loss: 1.8484 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8819
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9375
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 0.9828
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-photo                     | Epoch:18 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8085
 Best site-art_painting              | Epoch:18 | Val Acc: 0.8353
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:18 | Val Acc: 0.6494
 Best site-sketch                    | Epoch:18 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.6510 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8771 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.7700 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7072 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7419 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8449 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.7132 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7773 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.8080 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.7905 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.3430 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.3874 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.2739 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.3599 | Train Acc: 0.7222
 Site-art_painting                  | Train Loss: 1.2847 | Train Acc: 0.7734
 Site-cartoon                       | Train Loss: 1.5528 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.4710 | Train Acc: 0.7217
 Site-sketch                        | Train Loss: 1.8949 | Train Acc: 0.1034
Average Train Accuracy: 0.8463
 Site-photo                         | Val  Loss: 0.8196 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8651 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9062 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8345 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7565 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7255 | Val  Acc: 0.9714
 Site-photo                         | Val  Loss: 0.8018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8066 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.7642 | Val  Acc: 0.9733
 Site-photo                         | Val  Loss: 0.7746 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.2715 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.2803 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.2408 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 1.2938 | Val  Acc: 0.7872
 Site-art_painting                  | Val  Loss: 1.3600 | Val  Acc: 0.7412
 Site-cartoon                       | Val  Loss: 1.5740 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.5219 | Val  Acc: 0.6883
 Site-sketch                        | Val  Loss: 1.8239 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8749
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.6410 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8652 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.7662 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.6804 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7063 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8292 | Train Acc: 0.9615
 Site-photo                         | Train Loss: 0.7853 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.7492 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.7392 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7487 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.2563 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.3251 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.3662 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.3216 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.2914 | Train Acc: 0.7578
 Site-cartoon                       | Train Loss: 1.6523 | Train Acc: 0.4545
 Site-cartoon                       | Train Loss: 1.4475 | Train Acc: 0.6870
 Site-sketch                        | Train Loss: 1.8421 | Train Acc: 0.3103
Average Train Accuracy: 0.8405
 Site-photo                         | Val  Loss: 0.8049 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8659 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8678 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.7809 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.7305 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6742 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7589 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7795 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.7335 | Val  Acc: 0.9733
 Site-photo                         | Val  Loss: 0.7234 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.3075 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.2838 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.2264 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.2368 | Val  Acc: 0.8298
 Site-art_painting                  | Val  Loss: 1.3153 | Val  Acc: 0.7176
 Site-cartoon                       | Val  Loss: 1.5861 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.5027 | Val  Acc: 0.6753
 Site-sketch                        | Val  Loss: 1.8286 | Val  Acc: 0.2051
Average Valid Accuracy: 0.8659
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.5457 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7692 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.7371 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.6451 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6865 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.7585 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.6642 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.7021 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.7110 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.7012 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.2886 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.2927 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.2716 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 1.1494 | Train Acc: 0.7639
 Site-art_painting                  | Train Loss: 1.2306 | Train Acc: 0.8203
 Site-cartoon                       | Train Loss: 1.5074 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.4246 | Train Acc: 0.7217
 Site-sketch                        | Train Loss: 1.8752 | Train Acc: 0.2586
Average Train Accuracy: 0.8494
 Site-photo                         | Val  Loss: 0.7405 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7948 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8131 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.7535 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6672 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6643 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7287 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.6710 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.6976 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.2712 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.2395 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.2129 | Val  Acc: 0.7692
 Site-art_painting                  | Val  Loss: 1.2329 | Val  Acc: 0.7872
 Site-art_painting                  | Val  Loss: 1.3028 | Val  Acc: 0.7294
 Site-cartoon                       | Val  Loss: 1.6281 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.5132 | Val  Acc: 0.6494
 Site-sketch                        | Val  Loss: 1.8238 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8619
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.5077 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7465 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.6810 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.6153 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6191 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7170 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.6303 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6309 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6803 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.6691 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.1816 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.2717 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.2882 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.1598 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.2192 | Train Acc: 0.7812
 Site-cartoon                       | Train Loss: 1.5125 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.4183 | Train Acc: 0.7391
 Site-sketch                        | Train Loss: 1.8513 | Train Acc: 0.2069
Average Train Accuracy: 0.8595
 Site-photo                         | Val  Loss: 0.7207 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7392 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8393 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.7266 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.6494 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5971 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6843 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7007 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.6367 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6727 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.2560 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.2384 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.1435 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.2871 | Val  Acc: 0.7660
 Site-art_painting                  | Val  Loss: 1.2724 | Val  Acc: 0.7765
 Site-cartoon                       | Val  Loss: 1.5446 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.4816 | Val  Acc: 0.7013
 Site-sketch                        | Val  Loss: 1.8483 | Val  Acc: 0.2564
Average Valid Accuracy: 0.8644
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.5435 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6898 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.6247 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5462 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5875 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6937 | Train Acc: 0.9615
 Site-photo                         | Train Loss: 0.6504 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.6198 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6380 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.6722 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 1.2957 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.2489 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.2225 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 1.2631 | Train Acc: 0.7361
 Site-art_painting                  | Train Loss: 1.2197 | Train Acc: 0.7891
 Site-cartoon                       | Train Loss: 1.4807 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.4239 | Train Acc: 0.7304
 Site-sketch                        | Train Loss: 1.8660 | Train Acc: 0.2586
Average Train Accuracy: 0.8555
 Site-photo                         | Val  Loss: 0.7012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7438 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7503 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.6704 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6107 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5735 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6471 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6711 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.5963 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6151 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.2627 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.1791 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.1676 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.1663 | Val  Acc: 0.8298
 Site-art_painting                  | Val  Loss: 1.2809 | Val  Acc: 0.7529
 Site-cartoon                       | Val  Loss: 1.5678 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.4829 | Val  Acc: 0.7403
 Site-sketch                        | Val  Loss: 1.8270 | Val  Acc: 0.2051
Average Valid Accuracy: 0.8648
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.5361 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7045 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.6135 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.5286 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5461 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6462 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5510 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5934 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6066 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.6136 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.2044 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.2348 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.2154 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 1.2148 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.2186 | Train Acc: 0.7734
 Site-cartoon                       | Train Loss: 1.4806 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.4117 | Train Acc: 0.7043
 Site-sketch                        | Train Loss: 1.8259 | Train Acc: 0.3276
Average Train Accuracy: 0.8657
 Site-photo                         | Val  Loss: 0.6758 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 0.6984 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6541 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5816 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5332 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5971 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6489 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.6155 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.5933 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.2213 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.1245 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 1.1323 | Val  Acc: 0.7692
 Site-art_painting                  | Val  Loss: 1.1925 | Val  Acc: 0.7234
 Site-art_painting                  | Val  Loss: 1.1951 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.4974 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.4125 | Val  Acc: 0.7143
 Site-sketch                        | Val  Loss: 1.8133 | Val  Acc: 0.3333
Average Valid Accuracy: 0.8745
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.4625 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6235 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.5592 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4982 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5079 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6243 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.4823 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5811 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5770 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.5723 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 1.0808 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.2520 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 1.2041 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 1.1232 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 1.1451 | Train Acc: 0.7891
 Site-cartoon                       | Train Loss: 1.6285 | Train Acc: 0.3636
 Site-cartoon                       | Train Loss: 1.3834 | Train Acc: 0.7304
 Site-sketch                        | Train Loss: 1.8303 | Train Acc: 0.3276
Average Train Accuracy: 0.8451
 Site-photo                         | Val  Loss: 0.5647 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6813 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7348 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.6361 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.5401 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5138 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5674 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5942 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.5606 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.5506 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.1330 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.1768 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.0569 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 1.1307 | Val  Acc: 0.8511
 Site-art_painting                  | Val  Loss: 1.2247 | Val  Acc: 0.7176
 Site-cartoon                       | Val  Loss: 1.5130 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.4344 | Val  Acc: 0.6883
 Site-sketch                        | Val  Loss: 1.7983 | Val  Acc: 0.3077
Average Valid Accuracy: 0.8822
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9375
 Best site-photo                     | Epoch:25 | Val Acc: 0.9524
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-photo                     | Epoch:25 | Val Acc: 0.9828
 Best site-photo                     | Epoch:25 | Val Acc: 0.9867
 Best site-photo                     | Epoch:25 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8000
 Best site-art_painting              | Epoch:25 | Val Acc: 0.9231
 Best site-art_painting              | Epoch:25 | Val Acc: 0.8511
 Best site-art_painting              | Epoch:25 | Val Acc: 0.7176
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:25 | Val Acc: 0.6883
 Best site-sketch                    | Epoch:25 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.4066 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.6045 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.5841 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.4935 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5052 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5701 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4460 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5367 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.5564 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.5535 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.1746 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.1954 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.1247 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.0810 | Train Acc: 0.7361
 Site-art_painting                  | Train Loss: 1.1590 | Train Acc: 0.7578
 Site-cartoon                       | Train Loss: 1.5005 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.3540 | Train Acc: 0.7217
 Site-sketch                        | Train Loss: 1.8072 | Train Acc: 0.2931
Average Train Accuracy: 0.8495
 Site-photo                         | Val  Loss: 0.6045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5997 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6371 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5759 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4996 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4718 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5397 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5548 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5216 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5371 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.1470 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.0852 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.1055 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.0530 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 1.1572 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.4817 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3874 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.7512 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8900
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 1.0000
 Best site-photo                     | Epoch:26 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:26 | Val Acc: 0.6250
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8723
 Best site-art_painting              | Epoch:26 | Val Acc: 0.8118
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:26 | Val Acc: 0.7662
 Best site-sketch                    | Epoch:26 | Val Acc: 0.3846
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.3759 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5953 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.5394 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.4621 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4632 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5574 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4935 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.4982 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.5068 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.5342 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.1799 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.2050 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.1612 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 1.1349 | Train Acc: 0.7361
 Site-art_painting                  | Train Loss: 1.0904 | Train Acc: 0.7969
 Site-cartoon                       | Train Loss: 1.4616 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.3213 | Train Acc: 0.7652
 Site-sketch                        | Train Loss: 1.7711 | Train Acc: 0.3621
Average Train Accuracy: 0.8562
 Site-photo                         | Val  Loss: 0.5434 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 0.5932 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6483 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.5554 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5332 | Val  Acc: 0.9630
 Site-photo                         | Val  Loss: 0.4406 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5135 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5321 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.5014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4982 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.1280 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.1460 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.0665 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 1.0650 | Val  Acc: 0.8085
 Site-art_painting                  | Val  Loss: 1.1261 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.5017 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.4110 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.7920 | Val  Acc: 0.3846
Average Valid Accuracy: 0.8824
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.3652 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5696 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.4697 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4229 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4446 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5490 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.4503 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4610 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.4953 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.5288 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.0711 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 1.1714 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.1253 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 1.0554 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 1.1101 | Train Acc: 0.8203
 Site-cartoon                       | Train Loss: 1.4927 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.3015 | Train Acc: 0.7391
 Site-sketch                        | Train Loss: 1.7745 | Train Acc: 0.3621
Average Train Accuracy: 0.8792
 Site-photo                         | Val  Loss: 0.5052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5784 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.6371 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.5364 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4644 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4394 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4899 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5253 | Val  Acc: 0.9655
 Site-photo                         | Val  Loss: 0.4532 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.4683 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.0964 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.1077 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.0258 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 1.0661 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 1.1093 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 1.4768 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3976 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.7836 | Val  Acc: 0.4359
Average Valid Accuracy: 0.8960
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9375
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 1.0000
 Best site-photo                     | Epoch:28 | Val Acc: 0.9655
 Best site-photo                     | Epoch:28 | Val Acc: 0.9867
 Best site-photo                     | Epoch:28 | Val Acc: 0.9794
 Best site-art_painting              | Epoch:28 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:28 | Val Acc: 0.9231
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8723
 Best site-art_painting              | Epoch:28 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:28 | Val Acc: 0.7532
 Best site-sketch                    | Epoch:28 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.3659 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5303 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.4948 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3936 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4395 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.5097 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3721 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4436 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4842 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.4870 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.0470 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.1975 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.1426 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 1.2872 | Train Acc: 0.7639
 Site-art_painting                  | Train Loss: 1.0764 | Train Acc: 0.8359
 Site-cartoon                       | Train Loss: 1.4515 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.2764 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.8306 | Train Acc: 0.2414
Average Train Accuracy: 0.8630
 Site-photo                         | Val  Loss: 0.4982 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5658 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5783 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4784 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4353 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4145 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4449 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4840 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4372 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.4459 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 1.1328 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 1.0773 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 1.0383 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 1.0538 | Val  Acc: 0.7872
 Site-art_painting                  | Val  Loss: 1.1298 | Val  Acc: 0.7529
 Site-cartoon                       | Val  Loss: 1.3941 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.3523 | Val  Acc: 0.7143
 Site-sketch                        | Val  Loss: 1.8468 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8865
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.3177 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5122 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.5079 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.3743 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3837 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4931 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.4633 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 0.4343 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4329 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.5007 | Train Acc: 0.9795
 Site-art_painting                  | Train Loss: 1.0923 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.1619 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.0842 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.0609 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.0417 | Train Acc: 0.8281
 Site-cartoon                       | Train Loss: 1.5017 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.2977 | Train Acc: 0.7304
 Site-sketch                        | Train Loss: 1.7837 | Train Acc: 0.2931
Average Train Accuracy: 0.8569
 Site-photo                         | Val  Loss: 0.4785 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4923 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5083 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4918 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4248 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3715 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4353 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4652 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.4114 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4046 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.2258 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.9625 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.0325 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 1.0027 | Val  Acc: 0.8511
 Site-art_painting                  | Val  Loss: 1.0696 | Val  Acc: 0.7765
 Site-cartoon                       | Val  Loss: 1.4143 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3394 | Val  Acc: 0.7403
 Site-sketch                        | Val  Loss: 1.7767 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8921
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.2817 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4923 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3905 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3562 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3580 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4805 | Train Acc: 0.9615
 Site-photo                         | Train Loss: 0.3588 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4174 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4050 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4092 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.0276 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.1742 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.1094 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.0302 | Train Acc: 0.8472
 Site-art_painting                  | Train Loss: 1.0317 | Train Acc: 0.8125
 Site-cartoon                       | Train Loss: 1.4127 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.2747 | Train Acc: 0.7391
 Site-sketch                        | Train Loss: 1.7832 | Train Acc: 0.2414
Average Train Accuracy: 0.8724
 Site-photo                         | Val  Loss: 0.4529 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4894 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4693 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4539 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3949 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3559 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4148 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4542 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.4297 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3974 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.9554 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 1.0075 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.0005 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.0343 | Val  Acc: 0.8085
 Site-art_painting                  | Val  Loss: 1.0254 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.4039 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3503 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.7480 | Val  Acc: 0.4359
Average Valid Accuracy: 0.9028
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 0.9828
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-photo                     | Epoch:31 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8085
 Best site-art_painting              | Epoch:31 | Val Acc: 0.8118
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:31 | Val Acc: 0.7662
 Best site-sketch                    | Epoch:31 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.2833 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4655 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.4576 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.3340 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3318 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4376 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.3878 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4074 | Train Acc: 0.9773
 Site-photo                         | Train Loss: 0.3985 | Train Acc: 0.9735
 Site-photo                         | Train Loss: 0.3821 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.0097 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.0748 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.0738 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 0.9818 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 1.0218 | Train Acc: 0.7891
 Site-cartoon                       | Train Loss: 1.4219 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.2407 | Train Acc: 0.7652
 Site-sketch                        | Train Loss: 1.7793 | Train Acc: 0.3276
Average Train Accuracy: 0.8672
 Site-photo                         | Val  Loss: 0.4447 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4953 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5261 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.4499 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3722 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3642 | Val  Acc: 0.9714
 Site-photo                         | Val  Loss: 0.4012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4077 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.3654 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3834 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.9489 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.9588 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.9488 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 1.0245 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 1.0610 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 1.4148 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3004 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.7513 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8979
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.2873 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4620 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3786 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3191 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3333 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4132 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.3964 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3964 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3925 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.3772 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.9307 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.1265 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.0748 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 0.9668 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9723 | Train Acc: 0.8594
 Site-cartoon                       | Train Loss: 1.3377 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.2732 | Train Acc: 0.7478
 Site-sketch                        | Train Loss: 1.7576 | Train Acc: 0.3621
Average Train Accuracy: 0.8748
 Site-photo                         | Val  Loss: 0.3778 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4653 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4148 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4168 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3407 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3365 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3581 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3856 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.3567 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3691 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.9841 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.9245 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.9273 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.9647 | Val  Acc: 0.8298
 Site-art_painting                  | Val  Loss: 1.0129 | Val  Acc: 0.8000
 Site-cartoon                       | Val  Loss: 1.4266 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2767 | Val  Acc: 0.7922
 Site-sketch                        | Val  Loss: 1.7929 | Val  Acc: 0.3077
Average Valid Accuracy: 0.9050
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9828
 Best site-photo                     | Epoch:33 | Val Acc: 1.0000
 Best site-photo                     | Epoch:33 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8298
 Best site-art_painting              | Epoch:33 | Val Acc: 0.8000
 Best site-cartoon                   | Epoch:33 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:33 | Val Acc: 0.7922
 Best site-sketch                    | Epoch:33 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.2473 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4394 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3356 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3001 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2943 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3996 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.3381 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3253 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.3849 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.3738 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.8318 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 1.1326 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.0544 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.0098 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 1.0174 | Train Acc: 0.8047
 Site-cartoon                       | Train Loss: 1.3784 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.2050 | Train Acc: 0.7739
 Site-sketch                        | Train Loss: 1.7310 | Train Acc: 0.3276
Average Train Accuracy: 0.8797
 Site-photo                         | Val  Loss: 0.3923 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4199 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3558 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3213 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3056 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3334 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3584 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.3169 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3319 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 0.9739 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.9494 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.9277 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.9305 | Val  Acc: 0.8511
 Site-art_painting                  | Val  Loss: 1.0065 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.4459 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.3117 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.7143 | Val  Acc: 0.4103
Average Valid Accuracy: 0.8903
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.2445 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3621 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.4372 | Train Acc: 0.9167
 Site-photo                         | Train Loss: 0.3019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3230 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.3695 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2552 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3353 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.3521 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.3437 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.9598 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.1058 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.0098 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.9499 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 0.9644 | Train Acc: 0.8047
 Site-cartoon                       | Train Loss: 1.3278 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.2636 | Train Acc: 0.7217
 Site-sketch                        | Train Loss: 1.7826 | Train Acc: 0.3621
Average Train Accuracy: 0.8704
 Site-photo                         | Val  Loss: 0.3679 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4278 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3535 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3417 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2894 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3174 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3493 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.3091 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3087 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8879 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.9078 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.9099 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 1.0141 | Val  Acc: 0.8298
 Site-art_painting                  | Val  Loss: 1.0126 | Val  Acc: 0.7765
 Site-cartoon                       | Val  Loss: 1.4044 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.3057 | Val  Acc: 0.7403
 Site-sketch                        | Val  Loss: 1.7285 | Val  Acc: 0.4615
Average Valid Accuracy: 0.8972
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.2227 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3879 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3529 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.2618 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2591 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3593 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2624 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3547 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.3197 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3451 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.9207 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.9576 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 1.1244 | Train Acc: 0.7000
 Site-art_painting                  | Train Loss: 0.9723 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 0.9531 | Train Acc: 0.8438
 Site-cartoon                       | Train Loss: 1.4018 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.1816 | Train Acc: 0.7739
 Site-sketch                        | Train Loss: 1.7332 | Train Acc: 0.4138
Average Train Accuracy: 0.8824
 Site-photo                         | Val  Loss: 0.3190 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4136 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3931 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3511 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2694 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2611 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3136 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3422 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2880 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3037 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.0426 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.9693 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 0.9363 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.9092 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.9637 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.3718 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2305 | Val  Acc: 0.8182
 Site-sketch                        | Val  Loss: 1.7598 | Val  Acc: 0.4103
Average Valid Accuracy: 0.9045
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.2110 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4170 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3139 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2460 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2874 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.3212 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3127 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2973 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.3113 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.9101 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.1563 | Train Acc: 0.6364
 Site-art_painting                  | Train Loss: 1.0243 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 0.9909 | Train Acc: 0.7639
 Site-art_painting                  | Train Loss: 0.8924 | Train Acc: 0.8672
 Site-cartoon                       | Train Loss: 1.3606 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.1781 | Train Acc: 0.7826
 Site-sketch                        | Train Loss: 1.7198 | Train Acc: 0.3793
Average Train Accuracy: 0.8697
 Site-photo                         | Val  Loss: 0.3629 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4313 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.3384 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2815 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2391 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3173 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3231 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2951 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.2854 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8912 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.9045 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.8901 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.8830 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.9098 | Val  Acc: 0.8588
 Site-cartoon                       | Val  Loss: 1.3893 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.2409 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.7519 | Val  Acc: 0.4359
Average Valid Accuracy: 0.9059
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 0.9375
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-photo                     | Epoch:37 | Val Acc: 0.9828
 Best site-photo                     | Epoch:37 | Val Acc: 0.9867
 Best site-photo                     | Epoch:37 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8936
 Best site-art_painting              | Epoch:37 | Val Acc: 0.8588
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:37 | Val Acc: 0.7662
 Best site-sketch                    | Epoch:37 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.2185 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3921 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3401 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.2344 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2820 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.3338 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1974 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3075 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2871 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.3162 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.8512 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.0440 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.0296 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 1.1071 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9608 | Train Acc: 0.7812
 Site-cartoon                       | Train Loss: 1.3478 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.1753 | Train Acc: 0.7478
 Site-sketch                        | Train Loss: 1.7000 | Train Acc: 0.4828
Average Train Accuracy: 0.8782
 Site-photo                         | Val  Loss: 0.3016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3409 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4259 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.3227 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2552 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2361 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2949 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2984 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2927 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.2649 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8395 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.8349 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.9327 | Val  Acc: 0.7692
 Site-art_painting                  | Val  Loss: 1.0018 | Val  Acc: 0.8085
 Site-art_painting                  | Val  Loss: 0.9221 | Val  Acc: 0.8235
 Site-cartoon                       | Val  Loss: 1.3218 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2482 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.7355 | Val  Acc: 0.3846
Average Valid Accuracy: 0.9030
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.1961 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3341 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3310 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2198 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2433 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2464 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2606 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.2733 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.3045 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.8986 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 1.0342 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 1.0514 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 0.9393 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 0.8839 | Train Acc: 0.8438
 Site-cartoon                       | Train Loss: 1.3295 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.1694 | Train Acc: 0.7652
 Site-sketch                        | Train Loss: 1.7235 | Train Acc: 0.4310
Average Train Accuracy: 0.8788
 Site-photo                         | Val  Loss: 0.3396 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3665 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4141 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.2881 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2312 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2386 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2846 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2806 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2414 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2466 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.9105 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.8794 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.8617 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.8264 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.9547 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.3584 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2103 | Val  Acc: 0.8182
 Site-sketch                        | Val  Loss: 1.7291 | Val  Acc: 0.3333
Average Valid Accuracy: 0.9092
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 0.9375
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 0.9828
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-photo                     | Epoch:39 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:39 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:39 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:39 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:39 | Val Acc: 0.8936
 Best site-art_painting              | Epoch:39 | Val Acc: 0.8118
 Best site-cartoon                   | Epoch:39 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:39 | Val Acc: 0.8182
 Best site-sketch                    | Epoch:39 | Val Acc: 0.3333
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.1956 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3326 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2509 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2225 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2137 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2933 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.2522 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2724 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.2680 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.2865 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.9576 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.9782 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.0027 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 0.7156 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 0.8875 | Train Acc: 0.8672
 Site-cartoon                       | Train Loss: 1.3396 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.1330 | Train Acc: 0.7478
 Site-sketch                        | Train Loss: 1.7492 | Train Acc: 0.3103
Average Train Accuracy: 0.8688
 Site-photo                         | Val  Loss: 0.3170 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3722 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3352 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2707 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2258 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2629 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3096 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2240 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2521 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8273 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.9419 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 0.8780 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.8179 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.8903 | Val  Acc: 0.8235
 Site-cartoon                       | Val  Loss: 1.2853 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2271 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.6842 | Val  Acc: 0.3846
Average Valid Accuracy: 0.9059
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.1692 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3216 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2588 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1951 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2980 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.2950 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2362 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.2668 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.2874 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.8596 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.9437 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.9571 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 0.9947 | Train Acc: 0.7639
 Site-art_painting                  | Train Loss: 0.8866 | Train Acc: 0.8281
 Site-cartoon                       | Train Loss: 1.2975 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.1348 | Train Acc: 0.7565
 Site-sketch                        | Train Loss: 1.6941 | Train Acc: 0.3448
Average Train Accuracy: 0.8737
 Site-photo                         | Val  Loss: 0.2692 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3626 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2826 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2880 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2151 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2561 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2768 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2170 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2341 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.8210 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.8913 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 0.9181 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 0.8264 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.9134 | Val  Acc: 0.8235
 Site-cartoon                       | Val  Loss: 1.3207 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.2009 | Val  Acc: 0.7792
 Site-sketch                        | Val  Loss: 1.7206 | Val  Acc: 0.4359
Average Valid Accuracy: 0.9088
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.1313 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3091 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2286 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1952 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1772 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2961 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1622 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2683 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.2578 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.2495 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.8409 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.9947 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.0485 | Train Acc: 0.7250
 Site-art_painting                  | Train Loss: 0.9844 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8220 | Train Acc: 0.8594
 Site-cartoon                       | Train Loss: 1.3160 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.1121 | Train Acc: 0.7826
 Site-sketch                        | Train Loss: 1.6653 | Train Acc: 0.4138
Average Train Accuracy: 0.8803
 Site-photo                         | Val  Loss: 0.2779 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3282 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3332 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2334 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2389 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2367 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2592 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2174 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2064 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7656 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.7794 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.8125 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.8598 | Val  Acc: 0.8085
 Site-art_painting                  | Val  Loss: 0.9729 | Val  Acc: 0.7529
 Site-cartoon                       | Val  Loss: 1.2345 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.1749 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.7245 | Val  Acc: 0.3590
Average Valid Accuracy: 0.9071
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.1520 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3021 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3012 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.2041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2006 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.2495 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1665 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2150 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2481 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.2364 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.8269 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.0102 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.9827 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 0.7898 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 0.8552 | Train Acc: 0.8203
 Site-cartoon                       | Train Loss: 1.2889 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.1368 | Train Acc: 0.7913
 Site-sketch                        | Train Loss: 1.6644 | Train Acc: 0.4138
Average Train Accuracy: 0.8691
 Site-photo                         | Val  Loss: 0.2243 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3456 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2720 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2507 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1804 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1926 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2191 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2922 | Val  Acc: 0.9483
 Site-photo                         | Val  Loss: 0.2011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1911 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.9166 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.7919 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7466 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.8108 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.8614 | Val  Acc: 0.8235
 Site-cartoon                       | Val  Loss: 1.3350 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.1777 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.6884 | Val  Acc: 0.4359
Average Valid Accuracy: 0.9166
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9483
 Best site-photo                     | Epoch:43 | Val Acc: 1.0000
 Best site-photo                     | Epoch:43 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:43 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:43 | Val Acc: 0.9231
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8936
 Best site-art_painting              | Epoch:43 | Val Acc: 0.8235
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:43 | Val Acc: 0.7532
 Best site-sketch                    | Epoch:43 | Val Acc: 0.4359
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.1754 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3099 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2608 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1975 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1532 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2466 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2112 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2123 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.2387 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.2748 | Train Acc: 0.9726
 Site-art_painting                  | Train Loss: 0.8227 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.9817 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 0.9015 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.9643 | Train Acc: 0.7778
 Site-art_painting                  | Train Loss: 0.8391 | Train Acc: 0.8828
 Site-cartoon                       | Train Loss: 1.2902 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.1142 | Train Acc: 0.7565
 Site-sketch                        | Train Loss: 1.6657 | Train Acc: 0.4655
Average Train Accuracy: 0.8871
 Site-photo                         | Val  Loss: 0.2657 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3133 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3164 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2207 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1856 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1872 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2076 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2112 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1790 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1936 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7981 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.8083 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.7708 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.7529 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.8352 | Val  Acc: 0.8353
 Site-cartoon                       | Val  Loss: 1.3094 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.1693 | Val  Acc: 0.7922
 Site-sketch                        | Val  Loss: 1.6181 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9295
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-photo                     | Epoch:44 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:44 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8723
 Best site-art_painting              | Epoch:44 | Val Acc: 0.8353
 Best site-cartoon                   | Epoch:44 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:44 | Val Acc: 0.7922
 Best site-sketch                    | Epoch:44 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/fedavg...
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.1465 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2775 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2614 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.1561 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1660 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2361 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1955 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2223 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.2158 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.7432 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.9010 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.9162 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 0.7800 | Train Acc: 0.8194
 Site-art_painting                  | Train Loss: 0.8149 | Train Acc: 0.8438
 Site-cartoon                       | Train Loss: 1.3123 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 1.0677 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.6883 | Train Acc: 0.3621
Average Train Accuracy: 0.8827
 Site-photo                         | Val  Loss: 0.2945 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3123 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2943 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2197 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1579 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1719 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2006 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2150 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1777 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1752 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8184 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.7113 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.7974 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.7266 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.8457 | Val  Acc: 0.8353
 Site-cartoon                       | Val  Loss: 1.3027 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.1927 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.5955 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9076
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.1433 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3164 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.2510 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1643 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1476 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2157 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1589 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1839 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2261 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2290 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.7073 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.8796 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.9414 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 0.8326 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 0.8115 | Train Acc: 0.8516
 Site-cartoon                       | Train Loss: 1.2356 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.0835 | Train Acc: 0.7652
 Site-sketch                        | Train Loss: 1.6645 | Train Acc: 0.4310
Average Train Accuracy: 0.8916
 Site-photo                         | Val  Loss: 0.2585 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2833 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3392 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2161 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1712 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1549 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1784 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1840 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1956 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.1761 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8308 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.8025 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.8172 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.7451 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.8545 | Val  Acc: 0.8353
 Site-cartoon                       | Val  Loss: 1.2433 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 1.1430 | Val  Acc: 0.7792
 Site-sketch                        | Val  Loss: 1.6235 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9245
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.1377 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2431 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.1947 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1541 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1267 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2117 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1316 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1776 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.1806 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1794 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.7625 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.9228 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 0.9364 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.8669 | Train Acc: 0.8611
 Site-art_painting                  | Train Loss: 0.7552 | Train Acc: 0.8828
 Site-cartoon                       | Train Loss: 1.3107 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.1066 | Train Acc: 0.7652
 Site-sketch                        | Train Loss: 1.6705 | Train Acc: 0.4138
Average Train Accuracy: 0.8763
 Site-photo                         | Val  Loss: 0.2157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2880 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2478 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2180 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1577 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1512 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1747 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2005 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.1673 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.1513 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8087 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.7433 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.7756 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 0.6958 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.8534 | Val  Acc: 0.8118
 Site-cartoon                       | Val  Loss: 1.3342 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.1640 | Val  Acc: 0.7403
 Site-sketch                        | Val  Loss: 1.6315 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9095
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.1266 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2336 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1324 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1319 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2181 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1224 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1973 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.1772 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1533 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7831 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.8284 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.9384 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 0.9679 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.7597 | Train Acc: 0.8750
 Site-cartoon                       | Train Loss: 1.2510 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.0893 | Train Acc: 0.7739
 Site-sketch                        | Train Loss: 1.6756 | Train Acc: 0.4310
Average Train Accuracy: 0.8899
 Site-photo                         | Val  Loss: 0.2140 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2473 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2389 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1869 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1529 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1518 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1793 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2122 | Val  Acc: 0.9655
 Site-photo                         | Val  Loss: 0.1573 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1570 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7230 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7932 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 0.7029 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.7633 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.7967 | Val  Acc: 0.8588
 Site-cartoon                       | Val  Loss: 1.2635 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 1.0784 | Val  Acc: 0.7922
 Site-sketch                        | Val  Loss: 1.6853 | Val  Acc: 0.4103
Average Valid Accuracy: 0.9076
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0966 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2561 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2379 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.1485 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1386 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1957 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1981 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1625 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.1872 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.1551 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.8191 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.9001 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 0.9080 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 0.8309 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8102 | Train Acc: 0.8281
 Site-cartoon                       | Train Loss: 1.3366 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.0584 | Train Acc: 0.7826
 Site-sketch                        | Train Loss: 1.7131 | Train Acc: 0.4138
Average Train Accuracy: 0.8750
 Site-photo                         | Val  Loss: 0.1826 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2677 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2295 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1869 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1708 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1347 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1604 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1957 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.1352 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1571 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.7036 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.8493 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.7493 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.7238 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.7868 | Val  Acc: 0.8471
 Site-cartoon                       | Val  Loss: 1.1966 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.1349 | Val  Acc: 0.8052
 Site-sketch                        | Val  Loss: 1.5887 | Val  Acc: 0.4872
Average Valid Accuracy: 0.9149
===2023-08-10 21:47:13===
===2023-08-10 21:47:21===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:44 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:44 | Test Acc: 0.8465
 Test site-cartoon                   | Epoch:44 | Test Acc: 0.7021
 Test site-sketch                    | Epoch:44 | Test Acc: 0.4790
photo: 0.9985, art_painting: 0.8465, cartoon: 0.7021, sketch: 0.4790, 
Average Test Accuracy(group): 0.7565, Average Test Accuracy(individual): 0.8945,
domain std=0.1915, cluster std=-1.0000, individual std=0.1427, 
