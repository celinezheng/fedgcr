===2023-08-10 19:02:47===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
============ Train epoch 0 ============
 Site-photo                         | Train Loss: 1.1801 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3585 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 1.2344 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 1.2566 | Train Acc: 0.9677
 Site-photo                         | Train Loss: 1.2455 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 1.3234 | Train Acc: 0.9615
 Site-photo                         | Train Loss: 1.1640 | Train Acc: 0.9706
 Site-photo                         | Train Loss: 1.2788 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 1.2906 | Train Acc: 0.9646
 Site-photo                         | Train Loss: 1.2788 | Train Acc: 0.9589
 Site-art_painting                  | Train Loss: 1.6027 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.6203 | Train Acc: 0.6818
 Site-art_painting                  | Train Loss: 1.6278 | Train Acc: 0.6500
 Site-art_painting                  | Train Loss: 1.5810 | Train Acc: 0.6528
 Site-art_painting                  | Train Loss: 1.5899 | Train Acc: 0.6953
 Site-cartoon                       | Train Loss: 1.6990 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.6812 | Train Acc: 0.5739
 Site-sketch                        | Train Loss: 1.8939 | Train Acc: 0.1724
Average Train Accuracy: 0.8020
 Site-photo                         | Val  Loss: 1.2934 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 1.3409 | Val  Acc: 0.8333
 Site-photo                         | Val  Loss: 1.3733 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 1.3364 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 1.2650 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2124 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2638 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2959 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 1.2900 | Val  Acc: 0.9600
 Site-photo                         | Val  Loss: 1.2710 | Val  Acc: 0.9691
 Site-art_painting                  | Val  Loss: 1.6300 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 1.5984 | Val  Acc: 0.6667
 Site-art_painting                  | Val  Loss: 1.5814 | Val  Acc: 0.6923
 Site-art_painting                  | Val  Loss: 1.5519 | Val  Acc: 0.7660
 Site-art_painting                  | Val  Loss: 1.5928 | Val  Acc: 0.7059
 Site-cartoon                       | Val  Loss: 1.7375 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.7025 | Val  Acc: 0.5195
 Site-sketch                        | Val  Loss: 1.8727 | Val  Acc: 0.3077
Average Valid Accuracy: 0.7963
 Best site-photo                     | Epoch:0 | Val Acc: 0.8889
 Best site-photo                     | Epoch:0 | Val Acc: 0.8333
 Best site-photo                     | Epoch:0 | Val Acc: 0.8750
 Best site-photo                     | Epoch:0 | Val Acc: 0.9524
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 1.0000
 Best site-photo                     | Epoch:0 | Val Acc: 0.9600
 Best site-photo                     | Epoch:0 | Val Acc: 0.9691
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6250
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6667
 Best site-art_painting              | Epoch:0 | Val Acc: 0.6923
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7660
 Best site-art_painting              | Epoch:0 | Val Acc: 0.7059
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:0 | Val Acc: 0.5195
 Best site-sketch                    | Epoch:0 | Val Acc: 0.3077
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 1 ============
 Site-photo                         | Train Loss: 0.6675 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.9095 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.7604 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7409 | Train Acc: 0.9677
 Site-photo                         | Train Loss: 0.7410 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.8335 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.7627 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.7771 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.8038 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.8465 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.3179 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 1.3796 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 1.3287 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 1.3358 | Train Acc: 0.7222
 Site-art_painting                  | Train Loss: 1.3313 | Train Acc: 0.7031
 Site-cartoon                       | Train Loss: 1.5559 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.4590 | Train Acc: 0.6696
 Site-sketch                        | Train Loss: 1.8232 | Train Acc: 0.2931
Average Train Accuracy: 0.8531
 Site-photo                         | Val  Loss: 0.7944 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8839 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.9391 | Val  Acc: 0.8750
 Site-photo                         | Val  Loss: 0.8464 | Val  Acc: 0.9524
 Site-photo                         | Val  Loss: 0.7775 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7225 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.7790 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.8107 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.7893 | Val  Acc: 0.9794
 Site-art_painting                  | Val  Loss: 1.4327 | Val  Acc: 0.5000
 Site-art_painting                  | Val  Loss: 1.3245 | Val  Acc: 0.7333
 Site-art_painting                  | Val  Loss: 1.3161 | Val  Acc: 0.6923
 Site-art_painting                  | Val  Loss: 1.2759 | Val  Acc: 0.7872
 Site-art_painting                  | Val  Loss: 1.3277 | Val  Acc: 0.7647
 Site-cartoon                       | Val  Loss: 1.6315 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.5087 | Val  Acc: 0.6494
 Site-sketch                        | Val  Loss: 1.8027 | Val  Acc: 0.2821
Average Valid Accuracy: 0.8208
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 0.8750
 Best site-photo                     | Epoch:1 | Val Acc: 0.9524
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 1.0000
 Best site-photo                     | Epoch:1 | Val Acc: 0.9867
 Best site-photo                     | Epoch:1 | Val Acc: 0.9794
 Best site-art_painting              | Epoch:1 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7333
 Best site-art_painting              | Epoch:1 | Val Acc: 0.6923
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7872
 Best site-art_painting              | Epoch:1 | Val Acc: 0.7647
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:1 | Val Acc: 0.6494
 Best site-sketch                    | Epoch:1 | Val Acc: 0.2821
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 2 ============
 Site-photo                         | Train Loss: 0.3488 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5508 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.4975 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4378 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4324 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.5044 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.5783 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.4594 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.4981 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.5422 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 1.2336 | Train Acc: 0.7500
 Site-art_painting                  | Train Loss: 1.1982 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 1.1525 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 1.0980 | Train Acc: 0.8056
 Site-art_painting                  | Train Loss: 1.0970 | Train Acc: 0.7812
 Site-cartoon                       | Train Loss: 1.4213 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.2758 | Train Acc: 0.7478
 Site-sketch                        | Train Loss: 1.7777 | Train Acc: 0.3276
Average Train Accuracy: 0.8655
 Site-photo                         | Val  Loss: 0.5603 | Val  Acc: 0.8889
 Site-photo                         | Val  Loss: 0.6159 | Val  Acc: 0.9167
 Site-photo                         | Val  Loss: 0.6361 | Val  Acc: 0.9375
 Site-photo                         | Val  Loss: 0.5216 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4431 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4280 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4603 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.5029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4826 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.4650 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.1841 | Val  Acc: 0.5000
 Site-art_painting                  | Val  Loss: 1.0538 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 1.1136 | Val  Acc: 0.7692
 Site-art_painting                  | Val  Loss: 1.0489 | Val  Acc: 0.8298
 Site-art_painting                  | Val  Loss: 1.0833 | Val  Acc: 0.7765
 Site-cartoon                       | Val  Loss: 1.4307 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.3667 | Val  Acc: 0.7403
 Site-sketch                        | Val  Loss: 1.7454 | Val  Acc: 0.3590
Average Valid Accuracy: 0.8407
 Best site-photo                     | Epoch:2 | Val Acc: 0.8889
 Best site-photo                     | Epoch:2 | Val Acc: 0.9167
 Best site-photo                     | Epoch:2 | Val Acc: 0.9375
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 1.0000
 Best site-photo                     | Epoch:2 | Val Acc: 0.9867
 Best site-photo                     | Epoch:2 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:2 | Val Acc: 0.5000
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7692
 Best site-art_painting              | Epoch:2 | Val Acc: 0.8298
 Best site-art_painting              | Epoch:2 | Val Acc: 0.7765
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:2 | Val Acc: 0.7403
 Best site-sketch                    | Epoch:2 | Val Acc: 0.3590
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 3 ============
 Site-photo                         | Train Loss: 0.2276 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3619 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.3376 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2455 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2348 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2922 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3386 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2800 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3149 | Train Acc: 0.9823
 Site-photo                         | Train Loss: 0.2984 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.9751 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.9728 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.9896 | Train Acc: 0.7750
 Site-art_painting                  | Train Loss: 1.0666 | Train Acc: 0.7917
 Site-art_painting                  | Train Loss: 0.9057 | Train Acc: 0.8594
 Site-cartoon                       | Train Loss: 1.3398 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.2062 | Train Acc: 0.7304
 Site-sketch                        | Train Loss: 1.6899 | Train Acc: 0.3621
Average Train Accuracy: 0.8686
 Site-photo                         | Val  Loss: 0.3285 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3719 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.4344 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2566 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2617 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.3141 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.2670 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.2727 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 1.0048 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.9118 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.8495 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.8910 | Val  Acc: 0.8511
 Site-art_painting                  | Val  Loss: 0.9549 | Val  Acc: 0.8235
 Site-cartoon                       | Val  Loss: 1.4209 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.2409 | Val  Acc: 0.7532
 Site-sketch                        | Val  Loss: 1.6111 | Val  Acc: 0.5128
Average Valid Accuracy: 0.8874
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 1.0000
 Best site-photo                     | Epoch:3 | Val Acc: 0.9828
 Best site-photo                     | Epoch:3 | Val Acc: 0.9867
 Best site-photo                     | Epoch:3 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:3 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8667
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8511
 Best site-art_painting              | Epoch:3 | Val Acc: 0.8235
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:3 | Val Acc: 0.7532
 Best site-sketch                    | Epoch:3 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 4 ============
 Site-photo                         | Train Loss: 0.1800 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.3006 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.2206 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1357 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1391 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2176 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1236 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.1933 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.1902 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.1936 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.7928 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.9070 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 0.8765 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.7132 | Train Acc: 0.8472
 Site-art_painting                  | Train Loss: 0.8066 | Train Acc: 0.8672
 Site-cartoon                       | Train Loss: 1.1904 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 1.0517 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.6447 | Train Acc: 0.3966
Average Train Accuracy: 0.8941
 Site-photo                         | Val  Loss: 0.2149 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2473 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2509 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1973 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1405 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1440 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1582 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1950 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1618 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1474 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7093 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7943 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.8381 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.7308 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.8349 | Val  Acc: 0.8471
 Site-cartoon                       | Val  Loss: 1.3800 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 1.1721 | Val  Acc: 0.7143
 Site-sketch                        | Val  Loss: 1.5562 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9109
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-photo                     | Epoch:4 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:4 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:4 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8936
 Best site-art_painting              | Epoch:4 | Val Acc: 0.8471
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.5714
 Best site-cartoon                   | Epoch:4 | Val Acc: 0.7143
 Best site-sketch                    | Epoch:4 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 5 ============
 Site-photo                         | Train Loss: 0.0888 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2427 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.1297 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0853 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1333 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.1125 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0911 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1148 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1603 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.7679 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.8114 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.8373 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.5900 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.7131 | Train Acc: 0.8750
 Site-cartoon                       | Train Loss: 1.2130 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 1.0014 | Train Acc: 0.7565
 Site-sketch                        | Train Loss: 1.5991 | Train Acc: 0.4828
Average Train Accuracy: 0.8798
 Site-photo                         | Val  Loss: 0.1630 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2216 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.2687 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1078 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0920 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1100 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1267 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0990 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.8567 | Val  Acc: 0.6250
 Site-art_painting                  | Val  Loss: 0.6170 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.7025 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.6241 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.7220 | Val  Acc: 0.8706
 Site-cartoon                       | Val  Loss: 1.2021 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 1.0431 | Val  Acc: 0.7273
 Site-sketch                        | Val  Loss: 1.5912 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9075
============ Train epoch 6 ============
 Site-photo                         | Train Loss: 0.0543 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2031 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.1101 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0460 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0459 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0849 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0483 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0649 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0780 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0928 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6409 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7256 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.7791 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.6378 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.6510 | Train Acc: 0.8672
 Site-cartoon                       | Train Loss: 0.9819 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.8894 | Train Acc: 0.7913
 Site-sketch                        | Train Loss: 1.4651 | Train Acc: 0.5345
Average Train Accuracy: 0.9145
 Site-photo                         | Val  Loss: 0.1194 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1250 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0956 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0612 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0595 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0799 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0976 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.1191 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0655 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.8067 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.5596 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.6347 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.5822 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.6134 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 1.0802 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.9386 | Val  Acc: 0.8052
 Site-sketch                        | Val  Loss: 1.4220 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9285
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9828
 Best site-photo                     | Epoch:6 | Val Acc: 1.0000
 Best site-photo                     | Epoch:6 | Val Acc: 0.9897
 Best site-art_painting              | Epoch:6 | Val Acc: 0.7500
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:6 | Val Acc: 0.8723
 Best site-art_painting              | Epoch:6 | Val Acc: 0.9059
 Best site-cartoon                   | Epoch:6 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:6 | Val Acc: 0.8052
 Best site-sketch                    | Epoch:6 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 7 ============
 Site-photo                         | Train Loss: 0.0287 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1403 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0964 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0562 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0297 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0715 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0400 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0745 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0672 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0645 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5433 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.7131 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.7667 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.6381 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.5503 | Train Acc: 0.9219
 Site-cartoon                       | Train Loss: 1.1420 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 0.8438 | Train Acc: 0.8261
 Site-sketch                        | Train Loss: 1.5118 | Train Acc: 0.4828
Average Train Accuracy: 0.8992
 Site-photo                         | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0871 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0916 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0722 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0344 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0416 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0558 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0481 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0425 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0450 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6151 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5491 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.6898 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.4559 | Val  Acc: 0.9787
 Site-art_painting                  | Val  Loss: 0.6471 | Val  Acc: 0.8824
 Site-cartoon                       | Val  Loss: 1.0222 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.9483 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.3935 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9349
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-photo                     | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8462
 Best site-art_painting              | Epoch:7 | Val Acc: 0.9787
 Best site-art_painting              | Epoch:7 | Val Acc: 0.8824
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:7 | Val Acc: 0.7662
 Best site-sketch                    | Epoch:7 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 8 ============
 Site-photo                         | Train Loss: 0.0178 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1230 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0792 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0214 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0190 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0504 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0253 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0401 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0396 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0618 | Train Acc: 0.9863
 Site-art_painting                  | Train Loss: 0.5022 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.6438 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.5498 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.5328 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.5386 | Train Acc: 0.8984
 Site-cartoon                       | Train Loss: 1.0867 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.8384 | Train Acc: 0.8000
 Site-sketch                        | Train Loss: 1.4210 | Train Acc: 0.4828
Average Train Accuracy: 0.9071
 Site-photo                         | Val  Loss: 0.0419 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0902 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0991 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0559 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0258 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0391 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0371 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0414 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0354 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7151 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.5067 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.5448 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.5290 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.5991 | Val  Acc: 0.8706
 Site-cartoon                       | Val  Loss: 1.1916 | Val  Acc: 0.5714
 Site-cartoon                       | Val  Loss: 0.9119 | Val  Acc: 0.7662
 Site-sketch                        | Val  Loss: 1.4056 | Val  Acc: 0.6154
Average Valid Accuracy: 0.8998
============ Train epoch 9 ============
 Site-photo                         | Train Loss: 0.0139 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1622 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0725 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0157 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0133 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0197 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0284 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0506 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0388 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4381 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5548 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.5914 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.6129 | Train Acc: 0.8611
 Site-art_painting                  | Train Loss: 0.4940 | Train Acc: 0.9141
 Site-cartoon                       | Train Loss: 1.1744 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 0.8182 | Train Acc: 0.8087
 Site-sketch                        | Train Loss: 1.4069 | Train Acc: 0.5517
Average Train Accuracy: 0.9105
 Site-photo                         | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.1662 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0401 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0427 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0236 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0301 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0588 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0259 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5858 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.5618 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5925 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.4914 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.5568 | Val  Acc: 0.8941
 Site-cartoon                       | Val  Loss: 0.8894 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.9369 | Val  Acc: 0.7922
 Site-sketch                        | Val  Loss: 1.3656 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9319
============ Train epoch 10 ============
 Site-photo                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1285 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0410 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0319 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0256 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0421 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0187 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4679 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.6137 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.6524 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.5742 | Train Acc: 0.8333
 Site-art_painting                  | Train Loss: 0.4644 | Train Acc: 0.8906
 Site-cartoon                       | Train Loss: 1.0197 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.7448 | Train Acc: 0.8348
 Site-sketch                        | Train Loss: 1.3898 | Train Acc: 0.5517
Average Train Accuracy: 0.9155
 Site-photo                         | Val  Loss: 0.0608 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0328 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0505 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0383 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0135 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0155 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0264 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0225 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0168 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0373 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5309 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.5091 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.4776 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3536 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.4473 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8137 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.8115 | Val  Acc: 0.8312
 Site-sketch                        | Val  Loss: 1.2991 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9192
============ Train epoch 11 ============
 Site-photo                         | Train Loss: 0.0094 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1207 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0457 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0195 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0181 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0128 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0212 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0246 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0176 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2869 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6600 | Train Acc: 0.7273
 Site-art_painting                  | Train Loss: 0.5701 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.6410 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.4632 | Train Acc: 0.8984
 Site-cartoon                       | Train Loss: 1.0049 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.7034 | Train Acc: 0.8348
 Site-sketch                        | Train Loss: 1.4002 | Train Acc: 0.6034
Average Train Accuracy: 0.9153
 Site-photo                         | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0785 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0489 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0204 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0230 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4155 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4976 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.4476 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3580 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.5076 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7430 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.8013 | Val  Acc: 0.8442
 Site-sketch                        | Val  Loss: 1.3652 | Val  Acc: 0.5128
Average Valid Accuracy: 0.9386
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-photo                     | Epoch:11 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:11 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:11 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9574
 Best site-art_painting              | Epoch:11 | Val Acc: 0.9059
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:11 | Val Acc: 0.8442
 Best site-sketch                    | Epoch:11 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 12 ============
 Site-photo                         | Train Loss: 0.0169 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1363 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0315 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0079 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0371 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0130 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0596 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0280 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4409 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.5674 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.5919 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.4366 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3667 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8818 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.7267 | Train Acc: 0.7913
 Site-sketch                        | Train Loss: 1.4236 | Train Acc: 0.4655
Average Train Accuracy: 0.9094
 Site-photo                         | Val  Loss: 0.0644 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0348 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0162 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0075 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0109 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3322 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2664 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5482 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3469 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.4384 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8350 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.7363 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.2749 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9363
============ Train epoch 13 ============
 Site-photo                         | Train Loss: 0.0040 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1579 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0463 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0052 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0200 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0715 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0127 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3716 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.5513 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.5069 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.5226 | Train Acc: 0.8611
 Site-art_painting                  | Train Loss: 0.3981 | Train Acc: 0.9062
 Site-cartoon                       | Train Loss: 0.9771 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.6889 | Train Acc: 0.8522
 Site-sketch                        | Train Loss: 1.3555 | Train Acc: 0.4828
Average Train Accuracy: 0.9107
 Site-photo                         | Val  Loss: 0.0347 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0802 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0370 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0192 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0101 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0121 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0217 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.2835 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3134 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.5043 | Val  Acc: 0.8077
 Site-art_painting                  | Val  Loss: 0.4144 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.4786 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8537 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.7402 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.2073 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9357
============ Train epoch 14 ============
 Site-photo                         | Train Loss: 0.0136 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0740 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0525 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0174 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0151 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0229 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0105 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3179 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.4704 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.5420 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.4870 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.3869 | Train Acc: 0.9219
 Site-cartoon                       | Train Loss: 0.9917 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.6797 | Train Acc: 0.8435
 Site-sketch                        | Train Loss: 1.3053 | Train Acc: 0.5345
Average Train Accuracy: 0.9149
 Site-photo                         | Val  Loss: 0.0377 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0237 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0208 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0060 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0143 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0329 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2592 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3755 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3886 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.3807 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.4014 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8618 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.7164 | Val  Acc: 0.8312
 Site-sketch                        | Val  Loss: 1.2586 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9391
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 0.9828
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-photo                     | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9615
 Best site-art_painting              | Epoch:14 | Val Acc: 0.8936
 Best site-art_painting              | Epoch:14 | Val Acc: 0.9059
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:14 | Val Acc: 0.8312
 Best site-sketch                    | Epoch:14 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 15 ============
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1197 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0208 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0149 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0238 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0083 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0107 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3559 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.5163 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.5210 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.8621 | Train Acc: 0.9028
 Site-art_painting                  | Train Loss: 0.3957 | Train Acc: 0.9062
 Site-cartoon                       | Train Loss: 0.9166 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.5979 | Train Acc: 0.8696
 Site-sketch                        | Train Loss: 1.2590 | Train Acc: 0.5345
Average Train Accuracy: 0.9150
 Site-photo                         | Val  Loss: 0.0635 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0263 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0207 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0133 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0049 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2775 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4352 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3720 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.3312 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3977 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8240 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6894 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.2663 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9388
============ Train epoch 16 ============
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1478 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0433 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0078 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0218 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0071 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3591 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.4618 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4768 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.4539 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3457 | Train Acc: 0.9219
 Site-cartoon                       | Train Loss: 0.8430 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.6283 | Train Acc: 0.8261
 Site-sketch                        | Train Loss: 1.2111 | Train Acc: 0.5517
Average Train Accuracy: 0.9198
 Site-photo                         | Val  Loss: 0.0391 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0130 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0178 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0094 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0072 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0082 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0087 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2166 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3406 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3741 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.3757 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.4966 | Val  Acc: 0.8706
 Site-cartoon                       | Val  Loss: 0.9045 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.7276 | Val  Acc: 0.8312
 Site-sketch                        | Val  Loss: 1.2280 | Val  Acc: 0.5128
Average Valid Accuracy: 0.9299
============ Train epoch 17 ============
 Site-photo                         | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1034 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0565 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0650 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2942 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.6238 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.4209 | Train Acc: 0.9500
 Site-art_painting                  | Train Loss: 0.4318 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3634 | Train Acc: 0.8984
 Site-cartoon                       | Train Loss: 0.9845 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.5569 | Train Acc: 0.8870
 Site-sketch                        | Train Loss: 1.3563 | Train Acc: 0.4828
Average Train Accuracy: 0.9185
 Site-photo                         | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0462 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0117 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0268 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0166 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0054 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0123 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3437 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4734 | Val  Acc: 0.8000
 Site-art_painting                  | Val  Loss: 0.5201 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.2928 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.4434 | Val  Acc: 0.8824
 Site-cartoon                       | Val  Loss: 0.8004 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6799 | Val  Acc: 0.8182
 Site-sketch                        | Val  Loss: 1.1637 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9224
============ Train epoch 18 ============
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1321 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0441 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0180 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0121 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0098 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0056 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3008 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5950 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.5453 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.3815 | Train Acc: 0.9028
 Site-art_painting                  | Train Loss: 0.3928 | Train Acc: 0.8984
 Site-cartoon                       | Train Loss: 0.8298 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5736 | Train Acc: 0.8783
 Site-sketch                        | Train Loss: 1.2373 | Train Acc: 0.5690
Average Train Accuracy: 0.9238
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0062 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4242 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4083 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3500 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2761 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.3416 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.6814 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6527 | Val  Acc: 0.8571
 Site-sketch                        | Val  Loss: 1.2222 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9377
============ Train epoch 19 ============
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1121 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0123 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0673 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.0048 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0308 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3405 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4822 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4505 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.3180 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.3481 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8278 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.6128 | Train Acc: 0.8174
 Site-sketch                        | Train Loss: 1.2582 | Train Acc: 0.5517
Average Train Accuracy: 0.9222
 Site-photo                         | Val  Loss: 0.0459 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0120 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2432 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5261 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.4122 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.2588 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.3866 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.8452 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6194 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.3210 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9292
============ Train epoch 20 ============
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2416 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0310 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0101 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1115 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0106 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2432 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4278 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.5113 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.3592 | Train Acc: 0.9583
 Site-art_painting                  | Train Loss: 0.3326 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8766 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.5335 | Train Acc: 0.8783
 Site-sketch                        | Train Loss: 1.1525 | Train Acc: 0.6207
Average Train Accuracy: 0.9310
 Site-photo                         | Val  Loss: 0.0172 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0088 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2669 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2511 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.4810 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.3020 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.3985 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7943 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6526 | Val  Acc: 0.8312
 Site-sketch                        | Val  Loss: 1.2164 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9286
============ Train epoch 21 ============
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0902 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0576 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0030 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0175 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0168 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2831 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3892 | Train Acc: 0.9545
 Site-art_painting                  | Train Loss: 0.3981 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2717 | Train Acc: 0.9028
 Site-art_painting                  | Train Loss: 0.3053 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.7435 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5744 | Train Acc: 0.8957
 Site-sketch                        | Train Loss: 1.1547 | Train Acc: 0.5517
Average Train Accuracy: 0.9377
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0125 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0169 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3063 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3327 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.3519 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.4533 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.7834 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5577 | Val  Acc: 0.9221
 Site-sketch                        | Val  Loss: 1.1183 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9430
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-photo                     | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9615
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9362
 Best site-art_painting              | Epoch:21 | Val Acc: 0.9176
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:21 | Val Acc: 0.9221
 Best site-sketch                    | Epoch:21 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 22 ============
 Site-photo                         | Train Loss: 0.0053 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1515 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0224 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0070 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1827 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4525 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.4007 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.2296 | Train Acc: 0.9583
 Site-art_painting                  | Train Loss: 0.3146 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8378 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5179 | Train Acc: 0.8870
 Site-sketch                        | Train Loss: 1.3324 | Train Acc: 0.5172
Average Train Accuracy: 0.9332
 Site-photo                         | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0625 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0496 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0084 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2635 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1884 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3604 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2822 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3748 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7202 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.7149 | Val  Acc: 0.8182
 Site-sketch                        | Val  Loss: 1.2354 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9323
============ Train epoch 23 ============
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1270 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0343 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0067 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0088 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2363 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5892 | Train Acc: 0.9091
 Site-art_painting                  | Train Loss: 0.4424 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.4224 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3404 | Train Acc: 0.9141
 Site-cartoon                       | Train Loss: 0.8388 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5408 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.1926 | Train Acc: 0.6207
Average Train Accuracy: 0.9423
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0157 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0034 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5254 | Val  Acc: 0.7500
 Site-art_painting                  | Val  Loss: 0.2450 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.4073 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.2545 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.2826 | Val  Acc: 0.9529
 Site-cartoon                       | Val  Loss: 0.6569 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.6704 | Val  Acc: 0.8312
 Site-sketch                        | Val  Loss: 1.0935 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9304
============ Train epoch 24 ============
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1664 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0099 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0160 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3517 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.5469 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3951 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2892 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3045 | Train Acc: 0.9375
 Site-cartoon                       | Train Loss: 0.9077 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.5034 | Train Acc: 0.8957
 Site-sketch                        | Train Loss: 1.1778 | Train Acc: 0.5172
Average Train Accuracy: 0.9186
 Site-photo                         | Val  Loss: 0.0296 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0222 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0055 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1216 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4848 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.3756 | Val  Acc: 0.8462
 Site-art_painting                  | Val  Loss: 0.3123 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3700 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.6141 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.6150 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.0671 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9376
============ Train epoch 25 ============
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2206 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0073 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0028 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0047 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2507 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4473 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.4766 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.2685 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.3191 | Train Acc: 0.9375
 Site-cartoon                       | Train Loss: 0.8114 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5269 | Train Acc: 0.8609
 Site-sketch                        | Train Loss: 1.2308 | Train Acc: 0.5862
Average Train Accuracy: 0.9303
 Site-photo                         | Val  Loss: 0.0124 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.7383 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.2973 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2990 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3208 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3542 | Val  Acc: 0.8824
 Site-cartoon                       | Val  Loss: 0.7227 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5513 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.1593 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9324
============ Train epoch 26 ============
 Site-photo                         | Train Loss: 0.0064 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1893 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0652 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0031 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0146 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1969 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.5046 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3492 | Train Acc: 0.9500
 Site-art_painting                  | Train Loss: 0.1921 | Train Acc: 0.9583
 Site-art_painting                  | Train Loss: 0.2831 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.6796 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4888 | Train Acc: 0.8957
 Site-sketch                        | Train Loss: 1.2216 | Train Acc: 0.5517
Average Train Accuracy: 0.9324
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0086 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0092 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2118 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2962 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3366 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3864 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3509 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7969 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5587 | Val  Acc: 0.9351
 Site-sketch                        | Val  Loss: 1.1332 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9388
============ Train epoch 27 ============
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0884 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0663 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0076 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3728 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.4610 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.3407 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.3037 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3048 | Train Acc: 0.9453
 Site-cartoon                       | Train Loss: 0.9574 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 0.5423 | Train Acc: 0.8870
 Site-sketch                        | Train Loss: 1.1612 | Train Acc: 0.5862
Average Train Accuracy: 0.9226
 Site-photo                         | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0215 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0042 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.6220 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.4115 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.3106 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.3271 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.3385 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.6340 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.6568 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.0456 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9336
============ Train epoch 28 ============
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1175 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0156 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0100 | Train Acc: 0.9853
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0361 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0138 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2671 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3759 | Train Acc: 0.9091
 Site-art_painting                  | Train Loss: 0.3749 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2276 | Train Acc: 0.9583
 Site-art_painting                  | Train Loss: 0.2622 | Train Acc: 0.9609
 Site-cartoon                       | Train Loss: 0.7582 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4805 | Train Acc: 0.9043
 Site-sketch                        | Train Loss: 1.2934 | Train Acc: 0.5690
Average Train Accuracy: 0.9315
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0152 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2040 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3672 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2745 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2209 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3490 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.6152 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5182 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.2015 | Val  Acc: 0.5128
Average Valid Accuracy: 0.9425
============ Train epoch 29 ============
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1084 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0227 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0103 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3554 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.4100 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3257 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3069 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3117 | Train Acc: 0.9219
 Site-cartoon                       | Train Loss: 0.6792 | Train Acc: 0.9091
 Site-cartoon                       | Train Loss: 0.4248 | Train Acc: 0.9217
 Site-sketch                        | Train Loss: 1.1109 | Train Acc: 0.6034
Average Train Accuracy: 0.9362
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.0096 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4058 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3152 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2637 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2148 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.3799 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7292 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5333 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.1510 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9442
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-photo                     | Epoch:29 | Val Acc: 0.9867
 Best site-photo                     | Epoch:29 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:29 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9615
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9574
 Best site-art_painting              | Epoch:29 | Val Acc: 0.9059
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.7143
 Best site-cartoon                   | Epoch:29 | Val Acc: 0.8961
 Best site-sketch                    | Epoch:29 | Val Acc: 0.6410
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 30 ============
 Site-photo                         | Train Loss: 0.0017 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1461 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0216 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0115 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0291 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2452 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3668 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4247 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.3455 | Train Acc: 0.9028
 Site-art_painting                  | Train Loss: 0.2190 | Train Acc: 0.9766
 Site-cartoon                       | Train Loss: 0.6966 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.5065 | Train Acc: 0.8957
 Site-sketch                        | Train Loss: 1.1566 | Train Acc: 0.6034
Average Train Accuracy: 0.9340
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0184 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0057 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3800 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.3744 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2867 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2799 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3470 | Val  Acc: 0.8941
 Site-cartoon                       | Val  Loss: 0.6027 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6471 | Val  Acc: 0.8571
 Site-sketch                        | Val  Loss: 1.1415 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9250
============ Train epoch 31 ============
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1343 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0062 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0260 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2496 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5127 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.4337 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.2717 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.2441 | Train Acc: 0.9609
 Site-cartoon                       | Train Loss: 0.6638 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4390 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.2922 | Train Acc: 0.5517
Average Train Accuracy: 0.9317
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0064 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0039 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2602 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2572 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.3630 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.3464 | Val  Acc: 0.8936
 Site-art_painting                  | Val  Loss: 0.3062 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.6594 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5917 | Val  Acc: 0.8831
 Site-sketch                        | Val  Loss: 1.3192 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9350
============ Train epoch 32 ============
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1242 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0280 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.0065 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0408 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2858 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5429 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.4523 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2927 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2951 | Train Acc: 0.9375
 Site-cartoon                       | Train Loss: 1.0383 | Train Acc: 0.5455
 Site-cartoon                       | Train Loss: 0.4592 | Train Acc: 0.9478
 Site-sketch                        | Train Loss: 1.1095 | Train Acc: 0.6379
Average Train Accuracy: 0.9220
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0053 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1748 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2929 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2292 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2565 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3553 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.5656 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.6275 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.1908 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9473
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-photo                     | Epoch:32 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:32 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9615
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9362
 Best site-art_painting              | Epoch:32 | Val Acc: 0.9294
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:32 | Val Acc: 0.8701
 Best site-sketch                    | Epoch:32 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 33 ============
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1839 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.0386 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0034 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0046 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1758 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4456 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.3268 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2389 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.3409 | Train Acc: 0.9141
 Site-cartoon                       | Train Loss: 0.8625 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4864 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.0180 | Train Acc: 0.6552
Average Train Accuracy: 0.9329
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0154 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0149 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2116 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.5550 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2384 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2813 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.3744 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.6949 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5165 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.1974 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9472
============ Train epoch 34 ============
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2106 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0300 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0074 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0055 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0057 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2371 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5232 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3981 | Train Acc: 0.9250
 Site-art_painting                  | Train Loss: 0.2499 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3033 | Train Acc: 0.9219
 Site-cartoon                       | Train Loss: 0.6432 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4336 | Train Acc: 0.9217
 Site-sketch                        | Train Loss: 1.1233 | Train Acc: 0.6034
Average Train Accuracy: 0.9372
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0058 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0045 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0339 | Val  Acc: 0.9714
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2423 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1476 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3647 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.2690 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3309 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.5350 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5614 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.2316 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9413
============ Train epoch 35 ============
 Site-photo                         | Train Loss: 0.0032 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1749 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0271 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0413 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0038 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0167 | Train Acc: 0.9912
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2958 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.4818 | Train Acc: 0.9091
 Site-art_painting                  | Train Loss: 0.4134 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2873 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2920 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8472 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4360 | Train Acc: 0.9391
 Site-sketch                        | Train Loss: 1.0751 | Train Acc: 0.6379
Average Train Accuracy: 0.9342
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0107 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0067 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0321 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.0092 | Val  Acc: 0.9867
 Site-photo                         | Val  Loss: 0.0141 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.2876 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2717 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2290 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.3591 | Val  Acc: 0.8723
 Site-art_painting                  | Val  Loss: 0.3424 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.5121 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5564 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.2119 | Val  Acc: 0.4615
Average Valid Accuracy: 0.9337
============ Train epoch 36 ============
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1452 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0262 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0094 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0081 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0292 | Train Acc: 0.9886
 Site-photo                         | Train Loss: 0.0108 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0216 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.1789 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5595 | Train Acc: 0.7727
 Site-art_painting                  | Train Loss: 0.3890 | Train Acc: 0.9500
 Site-art_painting                  | Train Loss: 0.2383 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.2875 | Train Acc: 0.9375
 Site-cartoon                       | Train Loss: 0.9014 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4120 | Train Acc: 0.9304
 Site-sketch                        | Train Loss: 1.1077 | Train Acc: 0.6034
Average Train Accuracy: 0.9372
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0061 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0029 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0147 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1706 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2985 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2701 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.4906 | Val  Acc: 0.8511
 Site-art_painting                  | Val  Loss: 0.3007 | Val  Acc: 0.9529
 Site-cartoon                       | Val  Loss: 0.7664 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5821 | Val  Acc: 0.9221
 Site-sketch                        | Val  Loss: 1.2470 | Val  Acc: 0.5128
Average Valid Accuracy: 0.9376
============ Train epoch 37 ============
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1513 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0662 | Train Acc: 0.9583
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0059 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0063 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0049 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0195 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.2504 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5451 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4118 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.3007 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.2539 | Train Acc: 0.9453
 Site-cartoon                       | Train Loss: 0.8005 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4394 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.0845 | Train Acc: 0.5690
Average Train Accuracy: 0.9332
 Site-photo                         | Val  Loss: 0.0063 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0052 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0114 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1502 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3579 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2719 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2462 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3072 | Val  Acc: 0.9412
 Site-cartoon                       | Val  Loss: 0.7824 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6002 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.0345 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9393
============ Train epoch 38 ============
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1430 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0560 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0024 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2955 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4186 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.4412 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1611 | Train Acc: 0.9722
 Site-art_painting                  | Train Loss: 0.2784 | Train Acc: 0.9141
 Site-cartoon                       | Train Loss: 0.8740 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4266 | Train Acc: 0.8870
 Site-sketch                        | Train Loss: 1.1769 | Train Acc: 0.6724
Average Train Accuracy: 0.9404
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0115 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0036 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0120 | Val  Acc: 0.9897
 Site-art_painting                  | Val  Loss: 0.1798 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4267 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.2454 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.3049 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3225 | Val  Acc: 0.8941
 Site-cartoon                       | Val  Loss: 0.6050 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5675 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.1886 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9360
============ Train epoch 39 ============
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1108 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0243 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0082 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0022 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0039 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1861 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4574 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4111 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.4868 | Train Acc: 0.8889
 Site-art_painting                  | Train Loss: 0.3184 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.9231 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4329 | Train Acc: 0.9478
 Site-sketch                        | Train Loss: 1.0676 | Train Acc: 0.6207
Average Train Accuracy: 0.9382
 Site-photo                         | Val  Loss: 0.0032 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0104 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0066 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0046 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3373 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.2752 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.4608 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3138 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3664 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.6062 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5689 | Val  Acc: 0.8831
 Site-sketch                        | Val  Loss: 1.0373 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9311
============ Train epoch 40 ============
 Site-photo                         | Train Loss: 0.0012 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1900 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0362 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0033 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1588 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5143 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.3554 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.3456 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.2716 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 0.7441 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4151 | Train Acc: 0.9391
 Site-sketch                        | Train Loss: 1.0419 | Train Acc: 0.7241
Average Train Accuracy: 0.9413
 Site-photo                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0131 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0073 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0051 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0206 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0193 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3832 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.2007 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2996 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.3594 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3105 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.5333 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.5692 | Val  Acc: 0.8831
 Site-sketch                        | Val  Loss: 1.0275 | Val  Acc: 0.6667
Average Valid Accuracy: 0.9492
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-photo                     | Epoch:40 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8750
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9333
 Best site-art_painting              | Epoch:40 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9362
 Best site-art_painting              | Epoch:40 | Val Acc: 0.9059
 Best site-cartoon                   | Epoch:40 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:40 | Val Acc: 0.8831
 Best site-sketch                    | Epoch:40 | Val Acc: 0.6667
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 41 ============
 Site-photo                         | Train Loss: 0.0004 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1298 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0085 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0051 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0066 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2711 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3485 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.3782 | Train Acc: 0.8500
 Site-art_painting                  | Train Loss: 0.2921 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.2613 | Train Acc: 0.9375
 Site-cartoon                       | Train Loss: 1.0886 | Train Acc: 0.6364
 Site-cartoon                       | Train Loss: 0.4384 | Train Acc: 0.9217
 Site-sketch                        | Train Loss: 1.1308 | Train Acc: 0.6379
Average Train Accuracy: 0.9290
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0038 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0069 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0027 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0035 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2639 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1638 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3278 | Val  Acc: 0.8846
 Site-art_painting                  | Val  Loss: 0.2923 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3243 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.4972 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.5764 | Val  Acc: 0.8701
 Site-sketch                        | Val  Loss: 1.0316 | Val  Acc: 0.7179
Average Valid Accuracy: 0.9621
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-photo                     | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:41 | Val Acc: 0.8846
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9149
 Best site-art_painting              | Epoch:41 | Val Acc: 0.9294
 Best site-cartoon                   | Epoch:41 | Val Acc: 1.0000
 Best site-cartoon                   | Epoch:41 | Val Acc: 0.8701
 Best site-sketch                    | Epoch:41 | Val Acc: 0.7179
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 42 ============
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1058 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0154 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0474 | Train Acc: 0.9750
 Site-photo                         | Train Loss: 0.0087 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0029 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0018 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0069 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0015 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1892 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4762 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4160 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.2718 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.3124 | Train Acc: 0.9453
 Site-cartoon                       | Train Loss: 0.7744 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4271 | Train Acc: 0.9304
 Site-sketch                        | Train Loss: 1.1138 | Train Acc: 0.6379
Average Train Accuracy: 0.9350
 Site-photo                         | Val  Loss: 0.0044 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0081 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0095 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0050 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1345 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2288 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2409 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2684 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.4181 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.6329 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.6034 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.0986 | Val  Acc: 0.5897
Average Valid Accuracy: 0.9490
============ Train epoch 43 ============
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1460 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0184 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0041 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0105 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0020 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0150 | Train Acc: 0.9932
 Site-art_painting                  | Train Loss: 0.1946 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5751 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.5236 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.3910 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.2515 | Train Acc: 0.9531
 Site-cartoon                       | Train Loss: 1.1553 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4232 | Train Acc: 0.9304
 Site-sketch                        | Train Loss: 0.9933 | Train Acc: 0.6897
Average Train Accuracy: 0.9287
 Site-photo                         | Val  Loss: 0.0077 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0278 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0026 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0209 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0023 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1321 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1471 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3010 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.3124 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3453 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.6478 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.6146 | Val  Acc: 0.8831
 Site-sketch                        | Val  Loss: 1.2473 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9384
============ Train epoch 44 ============
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1124 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0068 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0036 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0042 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0026 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1534 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4389 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3238 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.3854 | Train Acc: 0.9167
 Site-art_painting                  | Train Loss: 0.3052 | Train Acc: 0.8984
 Site-cartoon                       | Train Loss: 0.7946 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.3842 | Train Acc: 0.9565
 Site-sketch                        | Train Loss: 1.1828 | Train Acc: 0.6379
Average Train Accuracy: 0.9370
 Site-photo                         | Val  Loss: 0.0234 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0079 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0011 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0017 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0033 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0037 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3259 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.1639 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2807 | Val  Acc: 0.9231
 Site-art_painting                  | Val  Loss: 0.2960 | Val  Acc: 0.9149
 Site-art_painting                  | Val  Loss: 0.3436 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.7584 | Val  Acc: 0.7143
 Site-cartoon                       | Val  Loss: 0.5292 | Val  Acc: 0.9351
 Site-sketch                        | Val  Loss: 1.2741 | Val  Acc: 0.5385
Average Valid Accuracy: 0.9337
============ Train epoch 45 ============
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1641 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0270 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0064 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0118 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2041 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2315 | Train Acc: 0.9545
 Site-art_painting                  | Train Loss: 0.4792 | Train Acc: 0.8000
 Site-art_painting                  | Train Loss: 0.2335 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2241 | Train Acc: 0.9609
 Site-cartoon                       | Train Loss: 0.8358 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4764 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.1315 | Train Acc: 0.6379
Average Train Accuracy: 0.9419
 Site-photo                         | Val  Loss: 0.0005 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0048 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0205 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0016 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0181 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0024 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0068 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1383 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2409 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2548 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.3150 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3222 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.6260 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5472 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.0119 | Val  Acc: 0.7436
Average Valid Accuracy: 0.9624
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-photo                     | Epoch:45 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:45 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:45 | Val Acc: 1.0000
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9615
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9362
 Best site-art_painting              | Epoch:45 | Val Acc: 0.9294
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8571
 Best site-cartoon                   | Epoch:45 | Val Acc: 0.8961
 Best site-sketch                    | Epoch:45 | Val Acc: 0.7436
 Saving the local and server checkpoint to ../checkpoint/fed_pacs_uneven_2.16_2/harmo-fl...
============ Train epoch 46 ============
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.2541 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.0131 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0014 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0009 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0126 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0037 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2672 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4872 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.3906 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.2461 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.3326 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.9719 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.4785 | Train Acc: 0.9130
 Site-sketch                        | Train Loss: 1.0522 | Train Acc: 0.6034
Average Train Accuracy: 0.9284
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0014 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0167 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0028 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0059 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0025 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0012 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1711 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4105 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2618 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2695 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.4191 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.4999 | Val  Acc: 1.0000
 Site-cartoon                       | Val  Loss: 0.5503 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.1473 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9596
============ Train epoch 47 ============
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1581 | Train Acc: 0.8889
 Site-photo                         | Train Loss: 0.0144 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0456 | Train Acc: 0.9808
 Site-photo                         | Train Loss: 0.0010 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0148 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0043 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0035 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.2188 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.4025 | Train Acc: 0.8636
 Site-art_painting                  | Train Loss: 0.4110 | Train Acc: 0.8250
 Site-art_painting                  | Train Loss: 0.2501 | Train Acc: 0.9444
 Site-art_painting                  | Train Loss: 0.2749 | Train Acc: 0.9453
 Site-cartoon                       | Train Loss: 0.8088 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.4618 | Train Acc: 0.9478
 Site-sketch                        | Train Loss: 1.0376 | Train Acc: 0.6379
Average Train Accuracy: 0.9362
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0022 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0031 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0191 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0041 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0021 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1625 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.3414 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.2338 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2527 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3636 | Val  Acc: 0.9176
 Site-cartoon                       | Val  Loss: 0.5492 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5806 | Val  Acc: 0.9091
 Site-sketch                        | Val  Loss: 1.1166 | Val  Acc: 0.6154
Average Valid Accuracy: 0.9480
============ Train epoch 48 ============
 Site-photo                         | Train Loss: 0.0005 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1453 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0217 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0091 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0025 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0008 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0027 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0019 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1980 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.3177 | Train Acc: 0.9545
 Site-art_painting                  | Train Loss: 0.3951 | Train Acc: 0.9000
 Site-art_painting                  | Train Loss: 0.1787 | Train Acc: 0.9722
 Site-art_painting                  | Train Loss: 0.3019 | Train Acc: 0.9297
 Site-cartoon                       | Train Loss: 0.8126 | Train Acc: 0.8182
 Site-cartoon                       | Train Loss: 0.3996 | Train Acc: 0.9565
 Site-sketch                        | Train Loss: 1.0497 | Train Acc: 0.5690
Average Train Accuracy: 0.9469
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0159 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0043 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0007 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0150 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0015 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0222 | Val  Acc: 0.9828
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0010 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.2995 | Val  Acc: 0.8750
 Site-art_painting                  | Val  Loss: 0.5911 | Val  Acc: 0.8667
 Site-art_painting                  | Val  Loss: 0.2595 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.1794 | Val  Acc: 0.9362
 Site-art_painting                  | Val  Loss: 0.3410 | Val  Acc: 0.9059
 Site-cartoon                       | Val  Loss: 0.6422 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5788 | Val  Acc: 0.8961
 Site-sketch                        | Val  Loss: 1.0302 | Val  Acc: 0.6410
Average Valid Accuracy: 0.9401
============ Train epoch 49 ============
 Site-photo                         | Train Loss: 0.0023 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.1176 | Train Acc: 0.9444
 Site-photo                         | Train Loss: 0.0060 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0006 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0007 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0090 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0013 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0011 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0021 | Train Acc: 1.0000
 Site-photo                         | Train Loss: 0.0016 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.1979 | Train Acc: 1.0000
 Site-art_painting                  | Train Loss: 0.5832 | Train Acc: 0.8182
 Site-art_painting                  | Train Loss: 0.4865 | Train Acc: 0.8750
 Site-art_painting                  | Train Loss: 0.2469 | Train Acc: 0.9306
 Site-art_painting                  | Train Loss: 0.3040 | Train Acc: 0.9062
 Site-cartoon                       | Train Loss: 0.9419 | Train Acc: 0.7273
 Site-cartoon                       | Train Loss: 0.3974 | Train Acc: 0.9304
 Site-sketch                        | Train Loss: 1.0361 | Train Acc: 0.6034
Average Train Accuracy: 0.9298
 Site-photo                         | Val  Loss: 0.0040 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0013 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0080 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0009 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0008 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0018 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0020 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0030 | Val  Acc: 1.0000
 Site-photo                         | Val  Loss: 0.0019 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.1621 | Val  Acc: 1.0000
 Site-art_painting                  | Val  Loss: 0.4257 | Val  Acc: 0.9333
 Site-art_painting                  | Val  Loss: 0.2306 | Val  Acc: 0.9615
 Site-art_painting                  | Val  Loss: 0.2395 | Val  Acc: 0.9574
 Site-art_painting                  | Val  Loss: 0.3335 | Val  Acc: 0.9294
 Site-cartoon                       | Val  Loss: 0.7133 | Val  Acc: 0.8571
 Site-cartoon                       | Val  Loss: 0.5930 | Val  Acc: 0.8831
 Site-sketch                        | Val  Loss: 1.0655 | Val  Acc: 0.5641
Average Valid Accuracy: 0.9492
===2023-08-10 20:09:15===
===2023-08-10 20:09:22===
===Setting===
    dataset: pacs
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[14,18,24,31,40,52,68,88,113,146,12,22,40,72,128,11,115,58,
client_nums=[10,5,2,1,]
len_dataset=[1000,462,213,98,]
domain number = 4
Loading snapshots...
 Test site-photo                     | Epoch:45 | Test Acc: 0.9985
 Test site-art_painting              | Epoch:45 | Test Acc: 0.8928
 Test site-cartoon                   | Epoch:45 | Test Acc: 0.7798
 Test site-sketch                    | Epoch:45 | Test Acc: 0.5407
photo: 0.9985, art_painting: 0.8928, cartoon: 0.7798, sketch: 0.5407, 
Average Test Accuracy(group): 0.8029, Average Test Accuracy(individual): 0.9194,
domain std=0.1700, cluster std=-1.0000, individual std=0.1175, 
