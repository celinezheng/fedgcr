===2023-04-16 20:32:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
 Site-Clipart   | Train Loss: 2.3249 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2501 | Train Acc: 0.0417
 Site-Clipart   | Train Loss: 2.3203 | Train Acc: 0.0556
 Site-Clipart   | Train Loss: 2.3249 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.2987 | Train Acc: 0.0667
 Site-Clipart   | Train Loss: 2.2972 | Train Acc: 0.1250
 Site-Infograph | Train Loss: 2.3241 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.4096 | Train Acc: 0.0794
 Site-Infograph | Train Loss: 2.3298 | Train Acc: 0.1277
 Site-Painting  | Train Loss: 2.2870 | Train Acc: 0.1356
 Site-QuickDraw | Train Loss: 2.3524 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.2911 | Train Acc: 0.1316
 Site-Sketch    | Train Loss: 2.2298 | Train Acc: 0.0857
 Site-Clipart   | Val  Loss: 2.4211 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.4166 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2615 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.3128 | Val  Acc: 0.1562
 Site-Clipart   | Val  Loss: 2.3181 | Val  Acc: 0.0750
 Site-Clipart   | Val  Loss: 2.3098 | Val  Acc: 0.0625
 Site-Infograph | Val  Loss: 2.3519 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3331 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.3420 | Val  Acc: 0.0476
 Site-Painting  | Val  Loss: 2.3233 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 2.4281 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.3262 | Val  Acc: 0.1200
 Site-Sketch    | Val  Loss: 2.3109 | Val  Acc: 0.0000
Average Valid Accuracy: 0.0734
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1562
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0750
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0476
 Best site-Painting   | Epoch:0 | Val Acc: 0.1538
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.1200
 Best site-Sketch     | Epoch:0 | Val Acc: 0.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.3545 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2600 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.1993 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.3149 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.2888 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2375 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.2980 | Train Acc: 0.0645
 Site-Infograph | Train Loss: 2.4023 | Train Acc: 0.0635
 Site-Infograph | Train Loss: 2.3562 | Train Acc: 0.1064
 Site-Painting  | Train Loss: 2.2662 | Train Acc: 0.1525
 Site-QuickDraw | Train Loss: 2.3444 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2649 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.2776 | Train Acc: 0.0286
 Site-Clipart   | Val  Loss: 2.3868 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2938 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.2687 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2475 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2846 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2587 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.4026 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3193 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.3211 | Val  Acc: 0.0635
 Site-Painting  | Val  Loss: 2.3481 | Val  Acc: 0.1026
 Site-QuickDraw | Val  Loss: 2.4343 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2875 | Val  Acc: 0.0800
 Site-Sketch    | Val  Loss: 2.2510 | Val  Acc: 0.0435
Average Valid Accuracy: 0.0982
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1250
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0635
 Best site-Painting   | Epoch:1 | Val Acc: 0.1026
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.0435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 2 ============
 Site-Clipart   | Train Loss: 2.3542 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2598 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2099 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2579 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2417 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.1943 | Train Acc: 0.2083
 Site-Infograph | Train Loss: 2.3311 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.3910 | Train Acc: 0.0317
 Site-Infograph | Train Loss: 2.3329 | Train Acc: 0.1170
 Site-Painting  | Train Loss: 2.2403 | Train Acc: 0.1186
 Site-QuickDraw | Train Loss: 2.3304 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2118 | Train Acc: 0.1316
 Site-Sketch    | Train Loss: 2.2627 | Train Acc: 0.0571
 Site-Clipart   | Val  Loss: 2.3889 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2846 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.2381 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2867 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2445 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2632 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.3547 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3378 | Val  Acc: 0.0476
 Site-Infograph | Val  Loss: 2.3177 | Val  Acc: 0.0952
 Site-Painting  | Val  Loss: 2.3049 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 2.4000 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2998 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.1709 | Val  Acc: 0.1304
Average Valid Accuracy: 0.0911
============ Train epoch 3 ============
===2023-04-16 20:36:11===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
denominator: 287621.125
 Site-Clipart   | Train Loss: 2.3249 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2501 | Train Acc: 0.0417
 Site-Clipart   | Train Loss: 2.3203 | Train Acc: 0.0556
 Site-Clipart   | Train Loss: 2.3249 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.2987 | Train Acc: 0.0667
 Site-Clipart   | Train Loss: 2.2972 | Train Acc: 0.1250
 Site-Infograph | Train Loss: 2.3241 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.4096 | Train Acc: 0.0794
 Site-Infograph | Train Loss: 2.3298 | Train Acc: 0.1277
 Site-Painting  | Train Loss: 2.2870 | Train Acc: 0.1356
 Site-QuickDraw | Train Loss: 2.3524 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.2911 | Train Acc: 0.1316
 Site-Sketch    | Train Loss: 2.2298 | Train Acc: 0.0857
 Site-Clipart   | Val  Loss: 2.4211 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.4166 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2615 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.3128 | Val  Acc: 0.1562
 Site-Clipart   | Val  Loss: 2.3181 | Val  Acc: 0.0750
 Site-Clipart   | Val  Loss: 2.3098 | Val  Acc: 0.0625
 Site-Infograph | Val  Loss: 2.3519 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3331 | Val  Acc: 0.1190
 Site-Infograph | Val  Loss: 2.3420 | Val  Acc: 0.0476
 Site-Painting  | Val  Loss: 2.3233 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 2.4281 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.3262 | Val  Acc: 0.1200
 Site-Sketch    | Val  Loss: 2.3109 | Val  Acc: 0.0000
Average Valid Accuracy: 0.0734
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1562
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0750
 Best site-Clipart    | Epoch:0 | Val Acc: 0.0625
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1190
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0476
 Best site-Painting   | Epoch:0 | Val Acc: 0.1538
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.1200
 Best site-Sketch     | Epoch:0 | Val Acc: 0.0000
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 1 ============
denominator: 235180.625
 Site-Clipart   | Train Loss: 2.3545 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2600 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.1993 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.3149 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.2888 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2375 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.2980 | Train Acc: 0.0645
 Site-Infograph | Train Loss: 2.4023 | Train Acc: 0.0635
 Site-Infograph | Train Loss: 2.3562 | Train Acc: 0.1064
 Site-Painting  | Train Loss: 2.2662 | Train Acc: 0.1525
 Site-QuickDraw | Train Loss: 2.3444 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2649 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.2776 | Train Acc: 0.0286
 Site-Clipart   | Val  Loss: 2.3868 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2938 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.2687 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2475 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2846 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2587 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.4026 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3193 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.3211 | Val  Acc: 0.0635
 Site-Painting  | Val  Loss: 2.3481 | Val  Acc: 0.1026
 Site-QuickDraw | Val  Loss: 2.4343 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2875 | Val  Acc: 0.0800
 Site-Sketch    | Val  Loss: 2.2510 | Val  Acc: 0.0435
Average Valid Accuracy: 0.0982
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0625
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1250
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:1 | Val Acc: 0.0635
 Best site-Painting   | Epoch:1 | Val Acc: 0.1026
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0800
 Best site-Sketch     | Epoch:1 | Val Acc: 0.0435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 2 ============
denominator: 225425.75
 Site-Clipart   | Train Loss: 2.3542 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.2598 | Train Acc: 0.0000
 Site-Clipart   | Train Loss: 2.2099 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2579 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2417 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.1943 | Train Acc: 0.2083
 Site-Infograph | Train Loss: 2.3311 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.3910 | Train Acc: 0.0317
 Site-Infograph | Train Loss: 2.3329 | Train Acc: 0.1170
 Site-Painting  | Train Loss: 2.2403 | Train Acc: 0.1186
 Site-QuickDraw | Train Loss: 2.3304 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2118 | Train Acc: 0.1316
 Site-Sketch    | Train Loss: 2.2627 | Train Acc: 0.0571
 Site-Clipart   | Val  Loss: 2.3889 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2846 | Val  Acc: 0.0625
 Site-Clipart   | Val  Loss: 2.2381 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2867 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2445 | Val  Acc: 0.1000
 Site-Clipart   | Val  Loss: 2.2632 | Val  Acc: 0.1250
 Site-Infograph | Val  Loss: 2.3547 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.3378 | Val  Acc: 0.0476
 Site-Infograph | Val  Loss: 2.3177 | Val  Acc: 0.0952
 Site-Painting  | Val  Loss: 2.3049 | Val  Acc: 0.1538
 Site-QuickDraw | Val  Loss: 2.4000 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2998 | Val  Acc: 0.0000
 Site-Sketch    | Val  Loss: 2.1709 | Val  Acc: 0.1304
Average Valid Accuracy: 0.0911
============ Train epoch 3 ============
===2023-04-16 20:42:24===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 50
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
============ Train epoch 0 ============
denominator: 70557.75
 Site-Clipart   | Train Loss: 2.3168 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.1681 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2785 | Train Acc: 0.1389
 Site-Clipart   | Train Loss: 2.2843 | Train Acc: 0.1875
 Site-Clipart   | Train Loss: 2.2467 | Train Acc: 0.1333
 Site-Clipart   | Train Loss: 2.2579 | Train Acc: 0.1389
 Site-Infograph | Train Loss: 2.3122 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.3739 | Train Acc: 0.0635
 Site-Infograph | Train Loss: 2.3006 | Train Acc: 0.1383
 Site-Painting  | Train Loss: 2.2425 | Train Acc: 0.1695
 Site-QuickDraw | Train Loss: 2.3402 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.2262 | Train Acc: 0.2368
 Site-Sketch    | Train Loss: 2.2077 | Train Acc: 0.1429
 Site-Clipart   | Val  Loss: 2.3535 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.3455 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2175 | Val  Acc: 0.2083
 Site-Clipart   | Val  Loss: 2.2551 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.2625 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.2698 | Val  Acc: 0.1875
 Site-Infograph | Val  Loss: 2.3179 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.2824 | Val  Acc: 0.0714
 Site-Infograph | Val  Loss: 2.3092 | Val  Acc: 0.0317
 Site-Painting  | Val  Loss: 2.3011 | Val  Acc: 0.1795
 Site-QuickDraw | Val  Loss: 2.3927 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2785 | Val  Acc: 0.1600
 Site-Sketch    | Val  Loss: 2.2303 | Val  Acc: 0.0435
Average Valid Accuracy: 0.1221
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.2083
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:0 | Val Acc: 0.1875
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0714
 Best site-Infograph  | Epoch:0 | Val Acc: 0.0317
 Best site-Painting   | Epoch:0 | Val Acc: 0.1795
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.0000
 Best site-Real       | Epoch:0 | Val Acc: 0.1600
 Best site-Sketch     | Epoch:0 | Val Acc: 0.0435
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 1 ============
denominator: 64946.13671875
 Site-Clipart   | Train Loss: 2.3235 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.1686 | Train Acc: 0.1250
 Site-Clipart   | Train Loss: 2.1717 | Train Acc: 0.2222
 Site-Clipart   | Train Loss: 2.2304 | Train Acc: 0.2292
 Site-Clipart   | Train Loss: 2.1947 | Train Acc: 0.1833
 Site-Clipart   | Train Loss: 2.1653 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.2596 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.3549 | Train Acc: 0.0952
 Site-Infograph | Train Loss: 2.2975 | Train Acc: 0.0745
 Site-Painting  | Train Loss: 2.1994 | Train Acc: 0.2373
 Site-QuickDraw | Train Loss: 2.3171 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.1968 | Train Acc: 0.2368
 Site-Sketch    | Train Loss: 2.2533 | Train Acc: 0.1143
 Site-Clipart   | Val  Loss: 2.2952 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.2225 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.1886 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1579 | Val  Acc: 0.2812
 Site-Clipart   | Val  Loss: 2.1912 | Val  Acc: 0.2250
 Site-Clipart   | Val  Loss: 2.1917 | Val  Acc: 0.2500
 Site-Infograph | Val  Loss: 2.3198 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.2385 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.2587 | Val  Acc: 0.1111
 Site-Painting  | Val  Loss: 2.2783 | Val  Acc: 0.2051
 Site-QuickDraw | Val  Loss: 2.3787 | Val  Acc: 0.0476
 Site-Real      | Val  Loss: 2.2075 | Val  Acc: 0.1200
 Site-Sketch    | Val  Loss: 2.1573 | Val  Acc: 0.2174
Average Valid Accuracy: 0.1785
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2812
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2250
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1111
 Best site-Painting   | Epoch:1 | Val Acc: 0.2051
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0476
 Best site-Real       | Epoch:1 | Val Acc: 0.1200
 Best site-Sketch     | Epoch:1 | Val Acc: 0.2174
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 2 ============
denominator: 62993.4453125
 Site-Clipart   | Train Loss: 2.2707 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.1294 | Train Acc: 0.2083
 Site-Clipart   | Train Loss: 2.1361 | Train Acc: 0.2778
 Site-Clipart   | Train Loss: 2.1591 | Train Acc: 0.2708
 Site-Clipart   | Train Loss: 2.1332 | Train Acc: 0.3167
 Site-Clipart   | Train Loss: 2.0968 | Train Acc: 0.3056
 Site-Infograph | Train Loss: 2.2917 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.3168 | Train Acc: 0.1111
 Site-Infograph | Train Loss: 2.2649 | Train Acc: 0.1915
 Site-Painting  | Train Loss: 2.1453 | Train Acc: 0.2881
 Site-QuickDraw | Train Loss: 2.2961 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1375 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.1508 | Train Acc: 0.2286
 Site-Clipart   | Val  Loss: 2.2640 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.1771 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.1398 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.1740 | Val  Acc: 0.1562
 Site-Clipart   | Val  Loss: 2.1233 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.1737 | Val  Acc: 0.3125
 Site-Infograph | Val  Loss: 2.2374 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.2217 | Val  Acc: 0.1667
 Site-Infograph | Val  Loss: 2.2360 | Val  Acc: 0.1270
 Site-Painting  | Val  Loss: 2.2213 | Val  Acc: 0.2564
 Site-QuickDraw | Val  Loss: 2.3242 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1998 | Val  Acc: 0.1200
 Site-Sketch    | Val  Loss: 2.0683 | Val  Acc: 0.3043
Average Valid Accuracy: 0.1959
 Best site-Clipart    | Epoch:2 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:2 | Val Acc: 0.1562
 Best site-Clipart    | Epoch:2 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:2 | Val Acc: 0.3125
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.1270
 Best site-Painting   | Epoch:2 | Val Acc: 0.2564
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.1429
 Best site-Real       | Epoch:2 | Val Acc: 0.1200
 Best site-Sketch     | Epoch:2 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 3 ============
denominator: 61584.34375
 Site-Clipart   | Train Loss: 2.1832 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.0449 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 2.0607 | Train Acc: 0.3889
 Site-Clipart   | Train Loss: 2.1525 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.0868 | Train Acc: 0.2667
 Site-Clipart   | Train Loss: 2.0853 | Train Acc: 0.3611
 Site-Infograph | Train Loss: 2.2807 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.2679 | Train Acc: 0.1270
 Site-Infograph | Train Loss: 2.2123 | Train Acc: 0.1809
 Site-Painting  | Train Loss: 2.1420 | Train Acc: 0.2881
 Site-QuickDraw | Train Loss: 2.2314 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.1117 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.0451 | Train Acc: 0.3714
 Site-Clipart   | Val  Loss: 2.1502 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.1877 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.1084 | Val  Acc: 0.1667
 Site-Clipart   | Val  Loss: 2.0875 | Val  Acc: 0.3438
 Site-Clipart   | Val  Loss: 2.1091 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.1094 | Val  Acc: 0.3125
 Site-Infograph | Val  Loss: 2.1954 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.1736 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.2056 | Val  Acc: 0.2063
 Site-Painting  | Val  Loss: 2.1930 | Val  Acc: 0.2564
 Site-QuickDraw | Val  Loss: 2.2783 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.1974 | Val  Acc: 0.1200
 Site-Sketch    | Val  Loss: 2.0740 | Val  Acc: 0.3043
Average Valid Accuracy: 0.2196
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.1667
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3438
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3125
 Best site-Infograph  | Epoch:3 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2063
 Best site-Painting   | Epoch:3 | Val Acc: 0.2564
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1429
 Best site-Real       | Epoch:3 | Val Acc: 0.1200
 Best site-Sketch     | Epoch:3 | Val Acc: 0.3043
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 4 ============
denominator: 60163.40625
 Site-Clipart   | Train Loss: 2.1844 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.0318 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.0058 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.1012 | Train Acc: 0.3542
 Site-Clipart   | Train Loss: 2.0536 | Train Acc: 0.3167
 Site-Clipart   | Train Loss: 2.0512 | Train Acc: 0.3194
 Site-Infograph | Train Loss: 2.2278 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.2544 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.2079 | Train Acc: 0.1915
 Site-Painting  | Train Loss: 2.1107 | Train Acc: 0.2881
 Site-QuickDraw | Train Loss: 2.2276 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.0405 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 2.0373 | Train Acc: 0.3429
 Site-Clipart   | Val  Loss: 2.2075 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.1385 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.0552 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.0348 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.0505 | Val  Acc: 0.3500
 Site-Clipart   | Val  Loss: 2.1555 | Val  Acc: 0.2292
 Site-Infograph | Val  Loss: 2.1271 | Val  Acc: 0.0952
 Site-Infograph | Val  Loss: 2.1518 | Val  Acc: 0.2143
 Site-Infograph | Val  Loss: 2.1862 | Val  Acc: 0.2063
 Site-Painting  | Val  Loss: 2.1720 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2889 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.1701 | Val  Acc: 0.2000
 Site-Sketch    | Val  Loss: 2.0361 | Val  Acc: 0.3478
Average Valid Accuracy: 0.2484
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:4 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:4 | Val Acc: 0.3500
 Best site-Clipart    | Epoch:4 | Val Acc: 0.2292
 Best site-Infograph  | Epoch:4 | Val Acc: 0.0952
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2143
 Best site-Infograph  | Epoch:4 | Val Acc: 0.2063
 Best site-Painting   | Epoch:4 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.1905
 Best site-Real       | Epoch:4 | Val Acc: 0.2000
 Best site-Sketch     | Epoch:4 | Val Acc: 0.3478
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 5 ============
denominator: 59414.0390625
 Site-Clipart   | Train Loss: 2.1458 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9318 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 2.0716 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.0514 | Train Acc: 0.2917
 Site-Clipart   | Train Loss: 2.0243 | Train Acc: 0.3167
 Site-Clipart   | Train Loss: 2.0233 | Train Acc: 0.3472
 Site-Infograph | Train Loss: 2.2801 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2313 | Train Acc: 0.1746
 Site-Infograph | Train Loss: 2.1692 | Train Acc: 0.2553
 Site-Painting  | Train Loss: 2.0140 | Train Acc: 0.3898
 Site-QuickDraw | Train Loss: 2.2582 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.0000 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 2.0364 | Train Acc: 0.2000
 Site-Clipart   | Val  Loss: 2.0654 | Val  Acc: 0.1250
 Site-Clipart   | Val  Loss: 2.0670 | Val  Acc: 0.1875
 Site-Clipart   | Val  Loss: 2.0221 | Val  Acc: 0.2083
 Site-Clipart   | Val  Loss: 1.9829 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.0091 | Val  Acc: 0.3500
 Site-Clipart   | Val  Loss: 2.1054 | Val  Acc: 0.2917
 Site-Infograph | Val  Loss: 2.1026 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1013 | Val  Acc: 0.3095
 Site-Infograph | Val  Loss: 2.1595 | Val  Acc: 0.2540
 Site-Painting  | Val  Loss: 2.0306 | Val  Acc: 0.3846
 Site-QuickDraw | Val  Loss: 2.2633 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0677 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 1.9199 | Val  Acc: 0.5652
Average Valid Accuracy: 0.2934
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1250
 Best site-Clipart    | Epoch:5 | Val Acc: 0.1875
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2083
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2917
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3095
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2540
 Best site-Painting   | Epoch:5 | Val Acc: 0.3846
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.1905
 Best site-Real       | Epoch:5 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:5 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 6 ============
denominator: 57709.109375
 Site-Clipart   | Train Loss: 2.1523 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.8728 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.9657 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9982 | Train Acc: 0.3542
 Site-Clipart   | Train Loss: 1.9717 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.9652 | Train Acc: 0.4167
 Site-Infograph | Train Loss: 2.2295 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2280 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1874 | Train Acc: 0.2234
 Site-Painting  | Train Loss: 2.0148 | Train Acc: 0.4068
 Site-QuickDraw | Train Loss: 2.2546 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.9957 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 1.9777 | Train Acc: 0.4286
 Site-Clipart   | Val  Loss: 2.0794 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 1.9987 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 1.9995 | Val  Acc: 0.4167
 Site-Clipart   | Val  Loss: 1.9639 | Val  Acc: 0.3438
 Site-Clipart   | Val  Loss: 1.9666 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 2.0521 | Val  Acc: 0.3750
 Site-Infograph | Val  Loss: 2.0773 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1027 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1464 | Val  Acc: 0.2698
 Site-Painting  | Val  Loss: 2.0845 | Val  Acc: 0.3846
 Site-QuickDraw | Val  Loss: 2.2453 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.1194 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 1.9157 | Val  Acc: 0.4783
Average Valid Accuracy: 0.3259
 Best site-Clipart    | Epoch:6 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4167
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3438
 Best site-Clipart    | Epoch:6 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:6 | Val Acc: 0.3750
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.2698
 Best site-Painting   | Epoch:6 | Val Acc: 0.3846
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.1905
 Best site-Real       | Epoch:6 | Val Acc: 0.2800
 Best site-Sketch     | Epoch:6 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 7 ============
denominator: 58271.3515625
 Site-Clipart   | Train Loss: 2.1191 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 1.8733 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.9708 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.9974 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.9207 | Train Acc: 0.3667
 Site-Clipart   | Train Loss: 1.9672 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 2.2098 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2222 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.1586 | Train Acc: 0.2234
 Site-Painting  | Train Loss: 1.9698 | Train Acc: 0.4068
 Site-QuickDraw | Train Loss: 2.2262 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.9672 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 1.9171 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.8787 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.9693 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.0008 | Val  Acc: 0.2917
 Site-Clipart   | Val  Loss: 1.9259 | Val  Acc: 0.4062
 Site-Clipart   | Val  Loss: 1.8973 | Val  Acc: 0.5250
 Site-Clipart   | Val  Loss: 1.9674 | Val  Acc: 0.4583
 Site-Infograph | Val  Loss: 2.1253 | Val  Acc: 0.1429
 Site-Infograph | Val  Loss: 2.0809 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1610 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 2.0159 | Val  Acc: 0.4359
 Site-QuickDraw | Val  Loss: 2.2473 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0610 | Val  Acc: 0.3600
 Site-Sketch    | Val  Loss: 1.9019 | Val  Acc: 0.5217
Average Valid Accuracy: 0.3747
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:7 | Val Acc: 0.2917
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4062
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.4583
 Best site-Infograph  | Epoch:7 | Val Acc: 0.1429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.2381
 Best site-Painting   | Epoch:7 | Val Acc: 0.4359
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.1429
 Best site-Real       | Epoch:7 | Val Acc: 0.3600
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 8 ============
denominator: 56606.49609375
 Site-Clipart   | Train Loss: 2.0729 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.8344 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.9726 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.9502 | Train Acc: 0.3958
 Site-Clipart   | Train Loss: 1.8913 | Train Acc: 0.4333
 Site-Clipart   | Train Loss: 1.9269 | Train Acc: 0.4167
 Site-Infograph | Train Loss: 2.2211 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.2057 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.1401 | Train Acc: 0.2766
 Site-Painting  | Train Loss: 1.9336 | Train Acc: 0.4576
 Site-QuickDraw | Train Loss: 2.2299 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.9227 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 1.8484 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 2.0473 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.9491 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.9154 | Val  Acc: 0.4167
 Site-Clipart   | Val  Loss: 1.8857 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.8702 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9648 | Val  Acc: 0.3958
 Site-Infograph | Val  Loss: 2.0155 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1031 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1646 | Val  Acc: 0.2540
 Site-Painting  | Val  Loss: 1.9420 | Val  Acc: 0.4872
 Site-QuickDraw | Val  Loss: 2.2504 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0475 | Val  Acc: 0.2800
 Site-Sketch    | Val  Loss: 1.8609 | Val  Acc: 0.5217
Average Valid Accuracy: 0.3685
============ Train epoch 9 ============
denominator: 56051.69140625
 Site-Clipart   | Train Loss: 1.9291 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.7239 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.9098 | Train Acc: 0.4722
 Site-Clipart   | Train Loss: 1.8670 | Train Acc: 0.6042
 Site-Clipart   | Train Loss: 1.8381 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.8751 | Train Acc: 0.4306
 Site-Infograph | Train Loss: 2.2273 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.1872 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.1322 | Train Acc: 0.2340
 Site-Painting  | Train Loss: 1.9216 | Train Acc: 0.4068
 Site-QuickDraw | Train Loss: 2.2023 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8718 | Train Acc: 0.4474
 Site-Sketch    | Train Loss: 1.7862 | Train Acc: 0.5143
 Site-Clipart   | Val  Loss: 1.9483 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8723 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.9031 | Val  Acc: 0.4583
 Site-Clipart   | Val  Loss: 1.8763 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.8519 | Val  Acc: 0.5250
 Site-Clipart   | Val  Loss: 1.9135 | Val  Acc: 0.5208
 Site-Infograph | Val  Loss: 2.0511 | Val  Acc: 0.1905
 Site-Infograph | Val  Loss: 2.0521 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1340 | Val  Acc: 0.2222
 Site-Painting  | Val  Loss: 1.9101 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.2428 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 2.0102 | Val  Acc: 0.3200
 Site-Sketch    | Val  Loss: 1.8192 | Val  Acc: 0.4348
Average Valid Accuracy: 0.3846
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:9 | Val Acc: 0.4583
 Best site-Clipart    | Epoch:9 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5250
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5208
 Best site-Infograph  | Epoch:9 | Val Acc: 0.1905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:9 | Val Acc: 0.2222
 Best site-Painting   | Epoch:9 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1429
 Best site-Real       | Epoch:9 | Val Acc: 0.3200
 Best site-Sketch     | Epoch:9 | Val Acc: 0.4348
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.5000
 Test site-Infograph | Epoch:9 | Test Acc: 0.2892
 Test site-Painting  | Epoch:9 | Test Acc: 0.4071
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.1970
 Test site-Real      | Epoch:9 | Test Acc: 0.4938
 Test site-Sketch    | Epoch:9 | Test Acc: 0.4874
Average Test Accuracy: 0.3958
============ Train epoch 10 ============
denominator: 54795.078125
 Site-Clipart   | Train Loss: 2.0069 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.6662 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.8080 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.8590 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.8120 | Train Acc: 0.5167
 Site-Clipart   | Train Loss: 1.8332 | Train Acc: 0.4861
 Site-Infograph | Train Loss: 2.2588 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.2023 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.0811 | Train Acc: 0.3191
 Site-Painting  | Train Loss: 1.8960 | Train Acc: 0.4237
 Site-QuickDraw | Train Loss: 2.1844 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7942 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.7440 | Train Acc: 0.4857
 Site-Clipart   | Val  Loss: 1.9224 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.8760 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 1.8065 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.8107 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8094 | Val  Acc: 0.5750
 Site-Clipart   | Val  Loss: 1.9230 | Val  Acc: 0.4375
 Site-Infograph | Val  Loss: 1.9710 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.0466 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0907 | Val  Acc: 0.3175
 Site-Painting  | Val  Loss: 1.8292 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2343 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 1.9640 | Val  Acc: 0.5600
 Site-Sketch    | Val  Loss: 1.7548 | Val  Acc: 0.5652
Average Valid Accuracy: 0.4432
 Best site-Clipart    | Epoch:10 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:10 | Val Acc: 0.5750
 Best site-Clipart    | Epoch:10 | Val Acc: 0.4375
 Best site-Infograph  | Epoch:10 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:10 | Val Acc: 0.3175
 Best site-Painting   | Epoch:10 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:10 | Val Acc: 0.1905
 Best site-Real       | Epoch:10 | Val Acc: 0.5600
 Best site-Sketch     | Epoch:10 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 11 ============
denominator: 54917.8515625
 Site-Clipart   | Train Loss: 1.9353 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.5869 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.9107 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.8117 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.7483 | Train Acc: 0.4667
 Site-Clipart   | Train Loss: 1.7412 | Train Acc: 0.5833
 Site-Infograph | Train Loss: 2.2071 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1604 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 2.0482 | Train Acc: 0.3830
 Site-Painting  | Train Loss: 1.8233 | Train Acc: 0.5085
 Site-QuickDraw | Train Loss: 2.2088 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.7194 | Train Acc: 0.5000
 Site-Sketch    | Train Loss: 1.6455 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8755 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.8739 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8324 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7703 | Val  Acc: 0.5312
 Site-Clipart   | Val  Loss: 1.8203 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8926 | Val  Acc: 0.4375
 Site-Infograph | Val  Loss: 2.0276 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.0108 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.0995 | Val  Acc: 0.3175
 Site-Painting  | Val  Loss: 1.7891 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2029 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.9113 | Val  Acc: 0.4000
 Site-Sketch    | Val  Loss: 1.7871 | Val  Acc: 0.4783
Average Valid Accuracy: 0.4499
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5312
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:11 | Val Acc: 0.4375
 Best site-Infograph  | Epoch:11 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:11 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:11 | Val Acc: 0.3175
 Best site-Painting   | Epoch:11 | Val Acc: 0.5385
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2381
 Best site-Real       | Epoch:11 | Val Acc: 0.4000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 12 ============
denominator: 53966.8671875
 Site-Clipart   | Train Loss: 1.9176 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6605 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.8030 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.7917 | Train Acc: 0.6458
 Site-Clipart   | Train Loss: 1.7486 | Train Acc: 0.5500
 Site-Clipart   | Train Loss: 1.7918 | Train Acc: 0.5417
 Site-Infograph | Train Loss: 2.1584 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.1224 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0352 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.8405 | Train Acc: 0.5424
 Site-QuickDraw | Train Loss: 2.1830 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7893 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.6535 | Train Acc: 0.6286
 Site-Clipart   | Val  Loss: 1.8189 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7282 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7676 | Val  Acc: 0.5417
 Site-Clipart   | Val  Loss: 1.7030 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6961 | Val  Acc: 0.6750
 Site-Clipart   | Val  Loss: 1.7920 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 1.9480 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9762 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0535 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.7851 | Val  Acc: 0.4872
 Site-QuickDraw | Val  Loss: 2.2162 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9311 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.7712 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5122
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5417
 Best site-Clipart    | Epoch:12 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6750
 Best site-Clipart    | Epoch:12 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:12 | Val Acc: 0.3333
 Best site-Painting   | Epoch:12 | Val Acc: 0.4872
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.1429
 Best site-Real       | Epoch:12 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:12 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 13 ============
denominator: 53455.51953125
 Site-Clipart   | Train Loss: 1.8901 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.6000 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7050 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.7270 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.6891 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.7395 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 2.2293 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.1325 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 2.0384 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.8017 | Train Acc: 0.5424
 Site-QuickDraw | Train Loss: 2.1504 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.7203 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.7464 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8292 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6640 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7049 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.7131 | Val  Acc: 0.4688
 Site-Clipart   | Val  Loss: 1.7322 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8180 | Val  Acc: 0.5417
 Site-Infograph | Val  Loss: 1.8580 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9927 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0395 | Val  Acc: 0.3175
 Site-Painting  | Val  Loss: 1.6992 | Val  Acc: 0.5385
 Site-QuickDraw | Val  Loss: 2.2268 | Val  Acc: 0.0952
 Site-Real      | Val  Loss: 1.8874 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.7625 | Val  Acc: 0.6087
Average Valid Accuracy: 0.4901
============ Train epoch 14 ============
denominator: 52372.6171875
 Site-Clipart   | Train Loss: 1.7860 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.4269 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.7918 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.7248 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.6649 | Train Acc: 0.6333
 Site-Clipart   | Train Loss: 1.7251 | Train Acc: 0.5833
 Site-Infograph | Train Loss: 2.2225 | Train Acc: 0.1290
 Site-Infograph | Train Loss: 2.0806 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.9925 | Train Acc: 0.3936
 Site-Painting  | Train Loss: 1.7777 | Train Acc: 0.5593
 Site-QuickDraw | Train Loss: 2.1843 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.6677 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.6313 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7173 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6700 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.6834 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.6892 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.6854 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.7392 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.7893 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8609 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9735 | Val  Acc: 0.3968
 Site-Painting  | Val  Loss: 1.6755 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 2.1334 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.8311 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.7191 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5509
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:14 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:14 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:14 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:14 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:14 | Val Acc: 0.3968
 Best site-Painting   | Epoch:14 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:14 | Val Acc: 0.3333
 Best site-Real       | Epoch:14 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:14 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 15 ============
denominator: 52419.74609375
 Site-Clipart   | Train Loss: 1.7409 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.4306 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6324 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.6781 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.5730 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5954 | Train Acc: 0.6250
 Site-Infograph | Train Loss: 2.2049 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0852 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.9400 | Train Acc: 0.4574
 Site-Painting  | Train Loss: 1.7067 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.2062 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6530 | Train Acc: 0.6053
 Site-Sketch    | Train Loss: 1.5981 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.6357 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6215 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.6427 | Val  Acc: 0.7083
 Site-Clipart   | Val  Loss: 1.6566 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.6471 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.7590 | Val  Acc: 0.4583
 Site-Infograph | Val  Loss: 1.7780 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.8759 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.9978 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 1.7108 | Val  Acc: 0.5128
 Site-QuickDraw | Val  Loss: 2.1722 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.7981 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.7266 | Val  Acc: 0.5652
Average Valid Accuracy: 0.5575
 Best site-Clipart    | Epoch:15 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7083
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.4583
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:15 | Val Acc: 0.4444
 Best site-Painting   | Epoch:15 | Val Acc: 0.5128
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2857
 Best site-Real       | Epoch:15 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:15 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 16 ============
denominator: 50962.62109375
 Site-Clipart   | Train Loss: 1.7202 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.4351 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6590 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 1.6447 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.5868 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.5659 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.1806 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0380 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9106 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.6925 | Train Acc: 0.6441
 Site-QuickDraw | Train Loss: 2.1558 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.5790 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 1.7204 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.8133 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6072 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5580 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.5445 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.6237 | Val  Acc: 0.7250
 Site-Clipart   | Val  Loss: 1.6174 | Val  Acc: 0.7292
 Site-Infograph | Val  Loss: 1.7469 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9114 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.9518 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 1.6114 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1663 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.7920 | Val  Acc: 0.6000
 Site-Sketch    | Val  Loss: 1.7064 | Val  Acc: 0.6087
Average Valid Accuracy: 0.5841
 Best site-Clipart    | Epoch:16 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:16 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:16 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7250
 Best site-Clipart    | Epoch:16 | Val Acc: 0.7292
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:16 | Val Acc: 0.4444
 Best site-Painting   | Epoch:16 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:16 | Val Acc: 0.2857
 Best site-Real       | Epoch:16 | Val Acc: 0.6000
 Best site-Sketch     | Epoch:16 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 17 ============
denominator: 50142.62109375
 Site-Clipart   | Train Loss: 1.7030 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4572 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4986 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.6076 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.5343 | Train Acc: 0.6333
 Site-Clipart   | Train Loss: 1.5635 | Train Acc: 0.6528
 Site-Infograph | Train Loss: 2.1470 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0147 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9393 | Train Acc: 0.4787
 Site-Painting  | Train Loss: 1.6552 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.1791 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.5482 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5728 | Train Acc: 0.6571
 Site-Clipart   | Val  Loss: 1.6032 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.5344 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.5081 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.5252 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5522 | Val  Acc: 0.7250
 Site-Clipart   | Val  Loss: 1.6246 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.8057 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8678 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.9155 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 1.6142 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1217 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.7505 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.7263 | Val  Acc: 0.5217
Average Valid Accuracy: 0.5972
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7250
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4444
 Best site-Painting   | Epoch:17 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.2857
 Best site-Real       | Epoch:17 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:17 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 18 ============
denominator: 48874.49609375
 Site-Clipart   | Train Loss: 1.6273 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3459 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.5655 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 1.5783 | Train Acc: 0.7292
 Site-Clipart   | Train Loss: 1.4980 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5149 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.1216 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0229 | Train Acc: 0.2857
 Site-Infograph | Train Loss: 1.8762 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.6200 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.1697 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.5018 | Train Acc: 0.6579
 Site-Sketch    | Train Loss: 1.4970 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5852 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5077 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.4990 | Val  Acc: 0.7083
 Site-Clipart   | Val  Loss: 1.4772 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.5040 | Val  Acc: 0.7750
 Site-Clipart   | Val  Loss: 1.5744 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.8327 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8448 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9547 | Val  Acc: 0.4444
 Site-Painting  | Val  Loss: 1.5529 | Val  Acc: 0.5897
 Site-QuickDraw | Val  Loss: 2.1383 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.7361 | Val  Acc: 0.6800
 Site-Sketch    | Val  Loss: 1.7167 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6078
 Best site-Clipart    | Epoch:18 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:18 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7083
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:18 | Val Acc: 0.7750
 Best site-Clipart    | Epoch:18 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:18 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:18 | Val Acc: 0.4444
 Best site-Painting   | Epoch:18 | Val Acc: 0.5897
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.3810
 Best site-Real       | Epoch:18 | Val Acc: 0.6800
 Best site-Sketch     | Epoch:18 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 19 ============
denominator: 48228.4921875
 Site-Clipart   | Train Loss: 1.6148 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3497 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.5922 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.5851 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.4750 | Train Acc: 0.6833
 Site-Clipart   | Train Loss: 1.4627 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.1235 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0552 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8623 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.5968 | Train Acc: 0.6610
 Site-QuickDraw | Train Loss: 2.1458 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4623 | Train Acc: 0.7105
 Site-Sketch    | Train Loss: 1.5369 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.5559 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5132 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.5108 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5151 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.4667 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.5306 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.6928 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8371 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8779 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 1.4872 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1351 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6900 | Val  Acc: 0.6400
 Site-Sketch    | Val  Loss: 1.6003 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6245
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4762
 Best site-Painting   | Epoch:19 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.2857
 Best site-Real       | Epoch:19 | Val Acc: 0.6400
 Best site-Sketch     | Epoch:19 | Val Acc: 0.5217
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.6901
 Test site-Infograph | Epoch:19 | Test Acc: 0.3866
 Test site-Painting  | Epoch:19 | Test Acc: 0.6640
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.2650
 Test site-Real      | Epoch:19 | Test Acc: 0.7354
 Test site-Sketch    | Epoch:19 | Test Acc: 0.6480
Average Test Accuracy: 0.5649
============ Train epoch 20 ============
denominator: 47405.125
 Site-Clipart   | Train Loss: 1.5907 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.2972 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.4698 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.5438 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.4284 | Train Acc: 0.7667
 Site-Clipart   | Train Loss: 1.4710 | Train Acc: 0.6806
 Site-Infograph | Train Loss: 2.1329 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 1.9841 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.8395 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.5730 | Train Acc: 0.6780
 Site-QuickDraw | Train Loss: 2.1146 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.3991 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.4865 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.6120 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3398 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.5058 | Val  Acc: 0.7083
 Site-Clipart   | Val  Loss: 1.5107 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.5338 | Val  Acc: 0.7750
 Site-Clipart   | Val  Loss: 1.5218 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.7209 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8093 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8800 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 1.5337 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1005 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.6022 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.5225 | Val  Acc: 0.6522
Average Valid Accuracy: 0.6238
============ Train epoch 21 ============
denominator: 46448.3828125
 Site-Clipart   | Train Loss: 1.6067 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.3066 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.5619 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 1.4760 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.3413 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4245 | Train Acc: 0.6944
 Site-Infograph | Train Loss: 2.1549 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 1.9539 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.8134 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.4898 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.1327 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.3637 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.5630 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.4983 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3707 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4425 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3675 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.4172 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.4953 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.7149 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7281 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8395 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 1.5014 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.0942 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.6635 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.5713 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6323
 Best site-Clipart    | Epoch:21 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:21 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:21 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:21 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:21 | Val Acc: 0.8250
 Best site-Clipart    | Epoch:21 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:21 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5079
 Best site-Painting   | Epoch:21 | Val Acc: 0.6923
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.3333
 Best site-Real       | Epoch:21 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:21 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 22 ============
denominator: 46556.64453125
 Site-Clipart   | Train Loss: 1.5763 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.2810 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.4339 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.4614 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.3381 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3193 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.0868 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9784 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.7963 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.4608 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.1145 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.3454 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5030 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.4357 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3188 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.4222 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3685 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.4222 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5166 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.6028 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7357 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8690 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 1.4567 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.1072 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.5860 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4956 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6499
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:22 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:22 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:22 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:22 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:22 | Val Acc: 0.5238
 Best site-Painting   | Epoch:22 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:22 | Val Acc: 0.3333
 Best site-Real       | Epoch:22 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:22 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 23 ============
denominator: 44999.6328125
 Site-Clipart   | Train Loss: 1.6319 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.1709 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.2580 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.4791 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3120 | Train Acc: 0.7833
 Site-Clipart   | Train Loss: 1.3030 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 2.1043 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.9228 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7955 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.4671 | Train Acc: 0.7119
 Site-QuickDraw | Train Loss: 2.1141 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.2642 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.4049 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.4731 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2702 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3403 | Val  Acc: 0.7083
 Site-Clipart   | Val  Loss: 1.3958 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.3565 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.4645 | Val  Acc: 0.7083
 Site-Infograph | Val  Loss: 1.5652 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7105 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.8025 | Val  Acc: 0.4921
 Site-Painting  | Val  Loss: 1.4345 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.0995 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.4937 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4525 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6215
============ Train epoch 24 ============
denominator: 44279.1328125
 Site-Clipart   | Train Loss: 1.5311 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.1168 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.3245 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.4421 | Train Acc: 0.7292
 Site-Clipart   | Train Loss: 1.2769 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3328 | Train Acc: 0.7639
 Site-Infograph | Train Loss: 2.0488 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9248 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.7620 | Train Acc: 0.4787
 Site-Painting  | Train Loss: 1.4225 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.1116 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.3191 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.3887 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.4392 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.2000 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3561 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3767 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.3165 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.4358 | Val  Acc: 0.7083
 Site-Infograph | Val  Loss: 1.6777 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7391 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7630 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 1.4452 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.1008 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.5406 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5000 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6281
============ Train epoch 25 ============
denominator: 44859.078125
 Site-Clipart   | Train Loss: 1.5114 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.0740 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.3834 | Train Acc: 0.7222
 Site-Clipart   | Train Loss: 1.3947 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.2485 | Train Acc: 0.7833
 Site-Clipart   | Train Loss: 1.2214 | Train Acc: 0.7361
 Site-Infograph | Train Loss: 2.0909 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8569 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.7451 | Train Acc: 0.5213
 Site-Painting  | Train Loss: 1.3674 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 2.1103 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.1825 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2697 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.2703 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.2275 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3241 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.3045 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.3582 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4738 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5291 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6768 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7810 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 1.3173 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0557 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.4969 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.4485 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6603
 Best site-Clipart    | Epoch:25 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:25 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:25 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:25 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:25 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:25 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:25 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:25 | Val Acc: 0.5397
 Best site-Painting   | Epoch:25 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.3810
 Best site-Real       | Epoch:25 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:25 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 26 ============
denominator: 43897.9765625
 Site-Clipart   | Train Loss: 1.4354 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.0726 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.2506 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3871 | Train Acc: 0.7708
 Site-Clipart   | Train Loss: 1.2451 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.2142 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 2.0937 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8719 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.7120 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.2787 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.0867 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.2309 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3623 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.5099 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.1922 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.2237 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3105 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3054 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.3373 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.5346 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7154 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7712 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 1.2948 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 2.0741 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4883 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.5330 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6516
============ Train epoch 27 ============
denominator: 43167.6796875
 Site-Clipart   | Train Loss: 1.3931 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.0154 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1945 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3177 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.2201 | Train Acc: 0.7167
 Site-Clipart   | Train Loss: 1.2121 | Train Acc: 0.7639
 Site-Infograph | Train Loss: 2.0952 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8545 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.6908 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.3354 | Train Acc: 0.7797
 Site-QuickDraw | Train Loss: 2.0485 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.2503 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2174 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2391 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0704 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2517 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.2411 | Val  Acc: 0.7188
 Site-Clipart   | Val  Loss: 1.2152 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.3169 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.4941 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6219 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7906 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.3111 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0226 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.4257 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4511 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6871
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7188
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7917
 Best site-Infograph  | Epoch:27 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:27 | Val Acc: 0.5556
 Best site-Painting   | Epoch:27 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.3333
 Best site-Real       | Epoch:27 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:27 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 28 ============
denominator: 42364.6796875
 Site-Clipart   | Train Loss: 1.4295 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9413 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.2918 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.2901 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.1686 | Train Acc: 0.8167
 Site-Clipart   | Train Loss: 1.1835 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9615 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.8712 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6872 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.3230 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.0379 | Train Acc: 0.4062
 Site-Real      | Train Loss: 1.2238 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2234 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3874 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.1632 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.1549 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.1994 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.2051 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.2859 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 1.5343 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.6233 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7089 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.2908 | Val  Acc: 0.6923
 Site-QuickDraw | Val  Loss: 2.0894 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4122 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4138 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6611
============ Train epoch 29 ============
denominator: 41758.77734375
 Site-Clipart   | Train Loss: 1.3081 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9681 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3775 | Train Acc: 0.7222
 Site-Clipart   | Train Loss: 1.3150 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 1.1698 | Train Acc: 0.7667
 Site-Clipart   | Train Loss: 1.1521 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 2.0306 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.8538 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.6516 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.2418 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.0624 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.2397 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.2271 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.3881 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.0745 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2011 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.2170 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 1.1916 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.3254 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.4869 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5909 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.7128 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.2351 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.0766 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.3762 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.3697 | Val  Acc: 0.6087
Average Valid Accuracy: 0.6915
 Best site-Clipart    | Epoch:29 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:29 | Val Acc: 0.7917
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8250
 Best site-Clipart    | Epoch:29 | Val Acc: 0.7917
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:29 | Val Acc: 0.5556
 Best site-Painting   | Epoch:29 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.2381
 Best site-Real       | Epoch:29 | Val Acc: 0.8000
 Best site-Sketch     | Epoch:29 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.7548
 Test site-Infograph | Epoch:29 | Test Acc: 0.4444
 Test site-Painting  | Epoch:29 | Test Acc: 0.7302
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.3520
 Test site-Real      | Epoch:29 | Test Acc: 0.8348
 Test site-Sketch    | Epoch:29 | Test Acc: 0.7040
Average Test Accuracy: 0.6367
============ Train epoch 30 ============
denominator: 40892.72265625
 Site-Clipart   | Train Loss: 1.3761 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9307 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 1.3310 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.2427 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.1688 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.1772 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 1.9617 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.8392 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5762 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 1.2232 | Train Acc: 0.7458
 Site-QuickDraw | Train Loss: 2.0790 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.2904 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.0123 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.2681 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1067 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1544 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2037 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.1988 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.2799 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.4760 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6477 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.7152 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.2247 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0447 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.3876 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4099 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6925
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:30 | Val Acc: 0.8250
 Best site-Clipart    | Epoch:30 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:30 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:30 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:30 | Val Acc: 0.5556
 Best site-Painting   | Epoch:30 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:30 | Val Acc: 0.4286
 Best site-Real       | Epoch:30 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:30 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 31 ============
denominator: 41131.5078125
 Site-Clipart   | Train Loss: 1.3844 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 0.8256 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1887 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2570 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.1068 | Train Acc: 0.7833
 Site-Clipart   | Train Loss: 1.1512 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0047 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.7949 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.6222 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.2066 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.0875 | Train Acc: 0.3750
 Site-Real      | Train Loss: 1.0279 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.3707 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.2474 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0175 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1137 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2131 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1341 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2469 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.3925 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.6423 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7230 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 1.2387 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.9780 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.4064 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3513 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7247
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:31 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:31 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:31 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:31 | Val Acc: 0.5238
 Best site-Painting   | Epoch:31 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.4286
 Best site-Real       | Epoch:31 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:31 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 32 ============
denominator: 40048.78515625
 Site-Clipart   | Train Loss: 1.2759 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 0.8750 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 1.3365 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.2197 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.0755 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0996 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9974 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7989 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.6129 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 1.1517 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.0566 | Train Acc: 0.3438
 Site-Real      | Train Loss: 1.0508 | Train Acc: 0.8158
 Site-Sketch    | Train Loss: 1.0951 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.0697 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0390 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1134 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.2063 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1137 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.2319 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.4171 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5888 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6077 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 1.1966 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.0237 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3092 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2928 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7200
============ Train epoch 33 ============
denominator: 39898.96875
 Site-Clipart   | Train Loss: 1.1949 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8341 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.1237 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 1.2067 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0906 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0890 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 2.0262 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8161 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6031 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.1777 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 2.0445 | Train Acc: 0.2812
 Site-Real      | Train Loss: 1.1085 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.2381 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0995 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0248 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1635 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1495 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 1.1175 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.2276 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.4758 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5649 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.7117 | Val  Acc: 0.5079
 Site-Painting  | Val  Loss: 1.1514 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9685 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.2530 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.4183 | Val  Acc: 0.5217
Average Valid Accuracy: 0.6927
============ Train epoch 34 ============
denominator: 39246.91796875
 Site-Clipart   | Train Loss: 1.4070 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9026 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.2484 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1722 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9913 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 1.0450 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 1.9113 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7579 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.5721 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 1.1334 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 2.0535 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.0194 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.2637 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.1896 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9359 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.0555 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.1145 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0691 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1608 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 1.3653 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5416 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6138 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 1.1230 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 1.9724 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.3121 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.2801 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7088
============ Train epoch 35 ============
denominator: 39452.41796875
 Site-Clipart   | Train Loss: 1.2643 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8064 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.1798 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 1.1769 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0399 | Train Acc: 0.7833
 Site-Clipart   | Train Loss: 1.0108 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 1.9474 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.7650 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5918 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.1496 | Train Acc: 0.7627
 Site-QuickDraw | Train Loss: 1.9934 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.9803 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.1174 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0068 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0071 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0596 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.1461 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0954 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.1678 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.4882 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4767 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5723 | Val  Acc: 0.6825
 Site-Painting  | Val  Loss: 1.1084 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9685 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.2091 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2790 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7265
 Best site-Clipart    | Epoch:35 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:35 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:35 | Val Acc: 0.7917
 Best site-Clipart    | Epoch:35 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:35 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:35 | Val Acc: 0.7917
 Best site-Infograph  | Epoch:35 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:35 | Val Acc: 0.6825
 Best site-Painting   | Epoch:35 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.4286
 Best site-Real       | Epoch:35 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:35 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 36 ============
denominator: 39780.72265625
 Site-Clipart   | Train Loss: 1.2467 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8003 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1923 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 1.1204 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 1.0317 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 1.0083 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.9686 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7446 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5567 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 1.0617 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.0612 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.0286 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0304 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.1756 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9340 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0266 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0985 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.1180 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.1577 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 1.4179 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5136 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.5814 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 1.0928 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9800 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.2196 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2719 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7038
============ Train epoch 37 ============
denominator: 39126.23828125
 Site-Clipart   | Train Loss: 1.2146 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7877 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.1538 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.1399 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 1.0036 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0405 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.8984 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.7733 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5535 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 1.1022 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 1.9756 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.9587 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9167 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.0089 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9171 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9489 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0166 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.0349 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.1348 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.3961 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.4855 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6018 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 1.0876 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9909 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1418 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.3723 | Val  Acc: 0.5217
Average Valid Accuracy: 0.7069
============ Train epoch 38 ============
denominator: 38166.671875
 Site-Clipart   | Train Loss: 1.1527 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7415 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1372 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 1.0821 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.9866 | Train Acc: 0.8167
 Site-Clipart   | Train Loss: 0.9718 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.8893 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.7139 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.5753 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0720 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 1.9991 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.9080 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.9868 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1460 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.8776 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9857 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0487 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0022 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.1736 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.4394 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5713 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5620 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 1.0750 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9948 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.1601 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2531 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7386
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:38 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:38 | Val Acc: 0.7917
 Best site-Infograph  | Epoch:38 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:38 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:38 | Val Acc: 0.5873
 Best site-Painting   | Epoch:38 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.4286
 Best site-Real       | Epoch:38 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:38 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 39 ============
denominator: 37315.79296875
 Site-Clipart   | Train Loss: 1.2833 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7478 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 1.1066 | Train Acc: 0.8611
 Site-Clipart   | Train Loss: 1.0625 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.9460 | Train Acc: 0.8167
 Site-Clipart   | Train Loss: 0.9344 | Train Acc: 0.8194
 Site-Infograph | Train Loss: 1.9364 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6584 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4952 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 1.0602 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.0075 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.8979 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8123 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.1807 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8495 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9429 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0374 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.0453 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.1124 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.3083 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4713 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5638 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 1.1125 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9383 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.1971 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2542 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7319
============ Train epoch 40 ============
denominator: 37739.5859375
 Site-Clipart   | Train Loss: 1.1527 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.7169 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 1.1544 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0823 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9574 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.9094 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8823 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6796 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.5253 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.0147 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.0161 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.8831 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8121 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0962 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8945 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9157 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0776 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 0.9399 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0572 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3654 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4849 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5802 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.0348 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9653 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1494 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.2430 | Val  Acc: 0.5652
Average Valid Accuracy: 0.7029
============ Train epoch 41 ============
denominator: 36657.51953125
 Site-Clipart   | Train Loss: 1.1306 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7341 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.0628 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0644 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.9157 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.8981 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.8960 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6697 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4736 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 1.0060 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 1.9738 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.8987 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.7936 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9552 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8778 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8923 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0513 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9838 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.1054 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.2518 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4297 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5510 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 1.1109 | Val  Acc: 0.7436
 Site-QuickDraw | Val  Loss: 1.9930 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.0509 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2204 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7422
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:41 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:41 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:41 | Val Acc: 0.8750
 Best site-Infograph  | Epoch:41 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:41 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:41 | Val Acc: 0.6032
 Best site-Painting   | Epoch:41 | Val Acc: 0.7436
 Best site-QuickDraw  | Epoch:41 | Val Acc: 0.3810
 Best site-Real       | Epoch:41 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:41 | Val Acc: 0.6522
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 42 ============
denominator: 36157.8671875
 Site-Clipart   | Train Loss: 1.1825 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.6368 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.0504 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0057 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.9106 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.8741 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.9905 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6860 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.5102 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.0726 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 1.9561 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.8284 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.9095 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 1.0490 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 0.8444 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9183 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 0.9957 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.9101 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0532 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4103 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4255 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5355 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 1.0313 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.9875 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.1711 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2029 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7195
============ Train epoch 43 ============
denominator: 35885.8671875
 Site-Clipart   | Train Loss: 1.1668 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.6562 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.9633 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 1.0334 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9136 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 0.8728 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.8821 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6373 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.4506 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9830 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 1.9817 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.8767 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 1.1712 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.0646 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8267 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9408 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9625 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.9805 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0336 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 1.2617 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.4671 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4551 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 1.0241 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9901 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.0860 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.2205 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7509
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:43 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:43 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:43 | Val Acc: 0.7708
 Best site-Infograph  | Epoch:43 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:43 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:43 | Val Acc: 0.6190
 Best site-Painting   | Epoch:43 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:43 | Val Acc: 0.4286
 Best site-Real       | Epoch:43 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:43 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 44 ============
denominator: 35822.77734375
 Site-Clipart   | Train Loss: 1.1857 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7216 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9623 | Train Acc: 0.8611
 Site-Clipart   | Train Loss: 1.0021 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.8932 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.9143 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8948 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6957 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4889 | Train Acc: 0.5638
 Site-Painting  | Train Loss: 0.9997 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 1.9237 | Train Acc: 0.4688
 Site-Real      | Train Loss: 0.7948 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8038 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.9331 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.8059 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9165 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.9462 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9644 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0242 | Val  Acc: 0.8750
 Site-Infograph | Val  Loss: 1.3228 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.4623 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5775 | Val  Acc: 0.5397
 Site-Painting  | Val  Loss: 1.0624 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.9488 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 1.0604 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2080 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7278
============ Train epoch 45 ============
denominator: 36591.30859375
 Site-Clipart   | Train Loss: 1.1695 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.6338 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.0006 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0045 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.8570 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.8686 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 1.8395 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6422 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.4384 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 0.9770 | Train Acc: 0.8136
 Site-QuickDraw | Train Loss: 1.9517 | Train Acc: 0.5000
 Site-Real      | Train Loss: 0.8288 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.8607 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 1.0967 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 0.7780 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8631 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 0.9299 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.8943 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9966 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3867 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3532 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5380 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.0447 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 1.8948 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 1.0822 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.2546 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7343
============ Train epoch 46 ============
denominator: 35483.5703125
 Site-Clipart   | Train Loss: 1.0555 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6411 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.9224 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0033 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 0.9078 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8520 | Train Acc: 0.8333
 Site-Infograph | Train Loss: 1.9072 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.6721 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.3959 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 0.9884 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 1.9702 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.7276 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0172 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 0.9940 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7269 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8558 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0325 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 0.9335 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 1.0247 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.2626 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.3913 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4759 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.9497 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9068 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.0610 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1487 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7654
 Best site-Clipart    | Epoch:46 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:46 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:46 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:46 | Val Acc: 0.9000
 Best site-Clipart    | Epoch:46 | Val Acc: 0.8125
 Best site-Infograph  | Epoch:46 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:46 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:46 | Val Acc: 0.5873
 Best site-Painting   | Epoch:46 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:46 | Val Acc: 0.4762
 Best site-Real       | Epoch:46 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:46 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/q-FFL...
============ Train epoch 47 ============
denominator: 34621.23046875
 Site-Clipart   | Train Loss: 1.1489 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6984 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.9885 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 0.9870 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.8278 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.7841 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.9507 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6295 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4251 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 0.9055 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 1.9324 | Train Acc: 0.5312
 Site-Real      | Train Loss: 0.8173 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0408 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.0017 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6530 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.8167 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9245 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8750 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.9401 | Val  Acc: 0.8542
 Site-Infograph | Val  Loss: 1.2664 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3842 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4237 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.9237 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9615 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.0443 | Val  Acc: 0.8000
 Site-Sketch    | Val  Loss: 1.1792 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7571
============ Train epoch 48 ============
denominator: 35320.04296875
 Site-Clipart   | Train Loss: 1.1278 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.5891 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.8177 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9770 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.8560 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.8236 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.9023 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.6202 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3773 | Train Acc: 0.5851
 Site-Painting  | Train Loss: 0.9052 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 1.9592 | Train Acc: 0.4375
 Site-Real      | Train Loss: 0.7892 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.2794 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.8661 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6893 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.7825 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9266 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 0.9039 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9223 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 1.2227 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4105 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.4744 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.9373 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9286 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 1.0087 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.1328 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7590
============ Train epoch 49 ============
denominator: 35119.203125
 Site-Clipart   | Train Loss: 1.0328 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6169 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.8371 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9635 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.7849 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.7937 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.8876 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5891 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.4357 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 0.9912 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 1.9276 | Train Acc: 0.4062
 Site-Real      | Train Loss: 0.7407 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9435 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.9583 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7835 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8326 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.8702 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8233 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9423 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.3422 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3838 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4435 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.9430 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 1.9452 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 1.0078 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1408 | Val  Acc: 0.6522
Average Valid Accuracy: 0.7432
===2023-04-16 21:27:02===
===2023-04-16 21:27:52===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
label set of clients: [9, 9, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 9, ]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:46 | Test Acc: 0.8042
 Test site-Infograph | Epoch:46 | Test Acc: 0.4795
 Test site-Painting  | Epoch:46 | Test Acc: 0.8094
 Test site-QuickDraw | Epoch:46 | Test Acc: 0.3960
 Test site-Real      | Epoch:46 | Test Acc: 0.8759
 Test site-Sketch    | Epoch:46 | Test Acc: 0.7473
Average Test Accuracy: 0.6854
