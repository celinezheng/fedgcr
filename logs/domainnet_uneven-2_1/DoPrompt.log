===2023-04-06 11:05:38===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 40
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-Clipart   | Train Loss: 2.0690 | Train Acc: 0.3492
 Site-Clipart   | Train Loss: 1.9910 | Train Acc: 0.3810
 Site-Clipart   | Train Loss: 1.9522 | Train Acc: 0.5238
 Site-Clipart   | Train Loss: 1.9616 | Train Acc: 0.4127
 Site-Clipart   | Train Loss: 2.1099 | Train Acc: 0.3651
 Site-Clipart   | Train Loss: 2.0881 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 2.2262 | Train Acc: 0.1429
 Site-Infograph | Train Loss: 2.1956 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 2.1039 | Train Acc: 0.2698
 Site-Painting  | Train Loss: 2.0493 | Train Acc: 0.3492
 Site-QuickDraw | Train Loss: 2.2574 | Train Acc: 0.0794
 Site-Real      | Train Loss: 2.0140 | Train Acc: 0.3651
 Site-Sketch    | Train Loss: 1.9569 | Train Acc: 0.5397
 Site-Clipart   | Val  Loss: 2.0850 | Val  Acc: 0.3571
 Site-Clipart   | Val  Loss: 1.9462 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.8964 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9524 | Val  Acc: 0.4762
 Site-Clipart   | Val  Loss: 1.9622 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9959 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1256 | Val  Acc: 0.2619
 Site-Infograph | Val  Loss: 2.1505 | Val  Acc: 0.2381
 Site-Infograph | Val  Loss: 2.1662 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 2.1908 | Val  Acc: 0.3333
 Site-QuickDraw | Val  Loss: 2.2583 | Val  Acc: 0.1667
 Site-Real      | Val  Loss: 2.1289 | Val  Acc: 0.3810
 Site-Sketch    | Val  Loss: 2.1138 | Val  Acc: 0.2381
Average Valid Accuracy: 0.3315
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4762
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2619
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Infograph  | Epoch:0 | Val Acc: 0.1905
 Best site-Painting   | Epoch:0 | Val Acc: 0.3333
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1667
 Best site-Real       | Epoch:0 | Val Acc: 0.3810
 Best site-Sketch     | Epoch:0 | Val Acc: 0.2381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.7482 | Train Acc: 0.4921
 Site-Clipart   | Train Loss: 1.6906 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.5838 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.6767 | Train Acc: 0.5397
 Site-Clipart   | Train Loss: 1.8716 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.8229 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.1201 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0496 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9339 | Train Acc: 0.4603
 Site-Painting  | Train Loss: 1.7682 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2649 | Train Acc: 0.2063
 Site-Real      | Train Loss: 1.7104 | Train Acc: 0.6667
 Site-Sketch    | Train Loss: 1.6637 | Train Acc: 0.6032
 Site-Clipart   | Val  Loss: 1.7957 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.6556 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.5343 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.5790 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.6227 | Val  Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.7560 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 2.0123 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0354 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1215 | Val  Acc: 0.1905
 Site-Painting  | Val  Loss: 1.9543 | Val  Acc: 0.3810
 Site-QuickDraw | Val  Loss: 2.2413 | Val  Acc: 0.2619
 Site-Real      | Val  Loss: 1.8023 | Val  Acc: 0.6190
 Site-Sketch    | Val  Loss: 1.7860 | Val  Acc: 0.6905
Average Valid Accuracy: 0.5183
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:1 | Val Acc: 0.7143
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1905
 Best site-Painting   | Epoch:1 | Val Acc: 0.3810
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2619
 Best site-Real       | Epoch:1 | Val Acc: 0.6190
 Best site-Sketch     | Epoch:1 | Val Acc: 0.6905
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.5069 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.4293 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.3747 | Train Acc: 0.6825
 Site-Clipart   | Train Loss: 1.3335 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.6013 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5994 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 2.0162 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.8824 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.7512 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.5400 | Train Acc: 0.6825
 Site-QuickDraw | Train Loss: 2.1740 | Train Acc: 0.2381
 Site-Real      | Train Loss: 1.4022 | Train Acc: 0.7778
 Site-Sketch    | Train Loss: 1.3473 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.5828 | Val  Acc: 0.5714
 Site-Clipart   | Val  Loss: 1.3680 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2955 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.3053 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.4043 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.4921 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8151 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.8635 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.9959 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.6621 | Val  Acc: 0.5476
 Site-QuickDraw | Val  Loss: 2.1893 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.5145 | Val  Acc: 0.6905
 Site-Sketch    | Val  Loss: 1.6054 | Val  Acc: 0.6190
Average Valid Accuracy: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.5714
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.3333
 Best site-Painting   | Epoch:2 | Val Acc: 0.5476
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2857
 Best site-Real       | Epoch:2 | Val Acc: 0.6905
 Best site-Sketch     | Epoch:2 | Val Acc: 0.6190
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.2495 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.2729 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.1544 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1825 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.3821 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.3973 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.9480 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.8337 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.6700 | Train Acc: 0.5238
 Site-Painting  | Train Loss: 1.3474 | Train Acc: 0.7302
 Site-QuickDraw | Train Loss: 2.1557 | Train Acc: 0.2857
 Site-Real      | Train Loss: 1.1359 | Train Acc: 0.8571
 Site-Sketch    | Train Loss: 1.2309 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 1.3878 | Val  Acc: 0.6190
 Site-Clipart   | Val  Loss: 1.1513 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0619 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0907 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2960 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.2684 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6967 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8001 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 1.9443 | Val  Acc: 0.3333
 Site-Painting  | Val  Loss: 1.5425 | Val  Acc: 0.5000
 Site-QuickDraw | Val  Loss: 2.1039 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.2217 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4412 | Val  Acc: 0.7381
Average Valid Accuracy: 0.6227
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6190
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:3 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3333
 Best site-Painting   | Epoch:3 | Val Acc: 0.5000
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.3095
 Best site-Real       | Epoch:3 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7381
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 1.2153 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 1.0983 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.9869 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 1.0005 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 1.2272 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2511 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8863 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.7453 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.6154 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 1.1862 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 2.0776 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.0126 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0716 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1889 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 1.0363 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.9999 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 0.9679 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1397 | Val  Acc: 0.7381
 Site-Clipart   | Val  Loss: 1.1136 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.5905 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.6540 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8870 | Val  Acc: 0.3571
 Site-Painting  | Val  Loss: 1.4329 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 2.0464 | Val  Acc: 0.3095
 Site-Real      | Val  Loss: 1.1108 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2208 | Val  Acc: 0.8571
Average Valid Accuracy: 0.6722
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7381
 Best site-Clipart    | Epoch:4 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:4 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:4 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:4 | Val Acc: 0.3571
 Best site-Painting   | Epoch:4 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:4 | Val Acc: 0.3095
 Best site-Real       | Epoch:4 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:4 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.0480 | Train Acc: 0.7619
 Site-Clipart   | Train Loss: 1.0114 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9336 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8492 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 1.1154 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.1962 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 1.8736 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6278 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4731 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 1.0833 | Train Acc: 0.7460
 Site-QuickDraw | Train Loss: 2.0347 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8835 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 1.0474 | Train Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0537 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9345 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.8027 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.8261 | Val  Acc: 0.7857
 Site-Clipart   | Val  Loss: 0.9731 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 1.0788 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.5334 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.6316 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.7995 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.2410 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.9946 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0218 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.2499 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6941
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7857
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Painting   | Epoch:5 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.3333
 Best site-Real       | Epoch:5 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.9271 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9525 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8596 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.8642 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 1.0485 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 1.0742 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 1.7924 | Train Acc: 0.4286
 Site-Infograph | Train Loss: 1.5932 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.4722 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 0.9925 | Train Acc: 0.7937
 Site-QuickDraw | Train Loss: 1.9715 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.8144 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.9760 | Train Acc: 0.7937
 Site-Clipart   | Val  Loss: 0.9635 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7804 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7618 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.7715 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.9380 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.0158 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.4097 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.5547 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.7843 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 1.2028 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 2.0517 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8927 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.1786 | Val  Acc: 0.7143
Average Valid Accuracy: 0.7106
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:6 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:6 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:6 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:6 | Val Acc: 0.4762
 Best site-Painting   | Epoch:6 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:6 | Val Acc: 0.3333
 Best site-Real       | Epoch:6 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:6 | Val Acc: 0.7143
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.8918 | Train Acc: 0.7937
 Site-Clipart   | Train Loss: 0.8728 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.7927 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7359 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.9470 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0645 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 1.7726 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5635 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3217 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.9178 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 1.9095 | Train Acc: 0.4127
 Site-Real      | Train Loss: 0.7138 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.8364 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.9036 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.6896 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6474 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6741 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8630 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.9262 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.4865 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.4468 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.7821 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 1.0992 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.9826 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.7871 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 1.0786 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7253
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4048
 Best site-Painting   | Epoch:7 | Val Acc: 0.7381
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3333
 Best site-Real       | Epoch:7 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.7938 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.8276 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6111 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.8794 | Train Acc: 0.8254
 Site-Clipart   | Train Loss: 0.9707 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.6813 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.5107 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.3417 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.7838 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8282 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.6848 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.8230 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8328 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.6326 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6447 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6060 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7731 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.8307 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4632 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.4571 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6169 | Val  Acc: 0.4524
 Site-Painting  | Val  Loss: 1.0595 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.8773 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6952 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9644 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7363
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:8 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:8 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4524
 Best site-Painting   | Epoch:8 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3571
 Best site-Real       | Epoch:8 | Val Acc: 0.8571
 Best site-Sketch     | Epoch:8 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8081 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6825 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.6541 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6235 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.8261 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.9001 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 1.6903 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.4052 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2476 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.7618 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.8098 | Train Acc: 0.4444
 Site-Real      | Train Loss: 0.6606 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7464 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7512 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5608 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.5807 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5604 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.7178 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.7085 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.3945 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3177 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.5705 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.9959 | Val  Acc: 0.6905
 Site-QuickDraw | Val  Loss: 1.8224 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.6697 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.9279 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7619
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Painting   | Epoch:9 | Val Acc: 0.6905
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3571
 Best site-Real       | Epoch:9 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:9 | Val Acc: 0.7857
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 50 ============
============ Train epoch 51 ============
============ Train epoch 52 ============
============ Train epoch 53 ============
============ Train epoch 54 ============
 Site-Clipart   | Train Loss: 0.7339 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6401 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5635 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.5513 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.7593 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.8443 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 1.6574 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.4165 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.2952 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.7476 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.7767 | Train Acc: 0.3651
 Site-Real      | Train Loss: 0.5639 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.7135 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7292 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.5475 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6245 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5818 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.7645 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6887 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.3239 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.3308 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5974 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8822 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8283 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.6215 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0590 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7381
============ Train epoch 55 ============
============ Train epoch 56 ============
============ Train epoch 57 ============
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.6242 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.6269 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5922 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4795 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.7417 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.7918 | Train Acc: 0.8095
 Site-Infograph | Train Loss: 1.5726 | Train Acc: 0.4921
 Site-Infograph | Train Loss: 1.3600 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1853 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.6409 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.6117 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.5149 | Train Acc: 0.8889
 Site-Sketch    | Train Loss: 0.7055 | Train Acc: 0.8254
 Site-Clipart   | Val  Loss: 0.7240 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.4622 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5223 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4996 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6706 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6201 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1981 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2185 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4888 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.8848 | Val  Acc: 0.7381
 Site-QuickDraw | Val  Loss: 1.7210 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.6024 | Val  Acc: 0.8571
 Site-Sketch    | Val  Loss: 0.9421 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7601
============ Train epoch 60 ============
============ Train epoch 61 ============
============ Train epoch 62 ============
============ Train epoch 63 ============
============ Train epoch 64 ============
 Site-Clipart   | Train Loss: 0.5811 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.6282 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5417 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4675 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6915 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.8092 | Train Acc: 0.7937
 Site-Infograph | Train Loss: 1.6781 | Train Acc: 0.3810
 Site-Infograph | Train Loss: 1.3197 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.2444 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 0.6004 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.6531 | Train Acc: 0.4603
 Site-Real      | Train Loss: 0.4444 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.6486 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5899 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4495 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4465 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4324 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6191 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.6649 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.2995 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.3288 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5349 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.8433 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.6947 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.5496 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.8274 | Val  Acc: 0.8333
Average Valid Accuracy: 0.7692
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:12 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:12 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:12 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:12 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:12 | Val Acc: 0.4762
 Best site-Painting   | Epoch:12 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:12 | Val Acc: 0.4048
 Best site-Real       | Epoch:12 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:12 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 65 ============
============ Train epoch 66 ============
============ Train epoch 67 ============
============ Train epoch 68 ============
============ Train epoch 69 ============
 Site-Clipart   | Train Loss: 0.6103 | Train Acc: 0.8571
 Site-Clipart   | Train Loss: 0.5725 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5028 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3734 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.6346 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.7570 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 1.5717 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.3004 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.1370 | Train Acc: 0.5714
 Site-Painting  | Train Loss: 0.6052 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5312 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.4402 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5842 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.5738 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3799 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4285 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4726 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5579 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5792 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1995 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1999 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4818 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.7993 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.6588 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.5260 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.9101 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7967
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:13 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4762
 Best site-Painting   | Epoch:13 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.4762
 Best site-Real       | Epoch:13 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:13 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 70 ============
============ Train epoch 71 ============
============ Train epoch 72 ============
============ Train epoch 73 ============
============ Train epoch 74 ============
 Site-Clipart   | Train Loss: 0.5660 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.5222 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4762 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3760 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5944 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6558 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.5946 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.2467 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.1773 | Train Acc: 0.5873
 Site-Painting  | Train Loss: 0.5537 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.5658 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.4273 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5346 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5314 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4157 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4266 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3715 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5312 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.6369 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.2285 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1845 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4492 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.8260 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.6685 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.5050 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8801 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7839
============ Train epoch 75 ============
============ Train epoch 76 ============
============ Train epoch 77 ============
============ Train epoch 78 ============
============ Train epoch 79 ============
 Site-Clipart   | Train Loss: 0.5182 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5005 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4498 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3815 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5856 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6523 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.4789 | Train Acc: 0.5079
 Site-Infograph | Train Loss: 1.2711 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0669 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.5185 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5059 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.3725 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5721 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.5036 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3246 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4975 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3963 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6660 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.4378 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 1.1199 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.2163 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4225 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.7234 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.6367 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.4294 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.8360 | Val  Acc: 0.7857
Average Valid Accuracy: 0.7821
============ Train epoch 80 ============
============ Train epoch 81 ============
============ Train epoch 82 ============
============ Train epoch 83 ============
============ Train epoch 84 ============
 Site-Clipart   | Train Loss: 0.4936 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4229 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4346 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3255 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.5080 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.6375 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.4936 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2601 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0947 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.4644 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.4921 | Train Acc: 0.5238
 Site-Real      | Train Loss: 0.3843 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5339 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4944 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3446 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3189 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3774 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4703 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.5037 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1791 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.1539 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.4565 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.7142 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.6439 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3917 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.8211 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7949
============ Train epoch 85 ============
============ Train epoch 86 ============
============ Train epoch 87 ============
============ Train epoch 88 ============
============ Train epoch 89 ============
 Site-Clipart   | Train Loss: 0.4357 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.4561 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4210 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2942 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.5452 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6600 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.5140 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.2026 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.0447 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.4860 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.4375 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3495 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.5070 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.4362 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3459 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3601 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3508 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.5229 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4798 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.1633 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1591 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3853 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.7710 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.5739 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4190 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7927 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8095
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5952
 Best site-Painting   | Epoch:17 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.4286
 Best site-Real       | Epoch:17 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:17 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 90 ============
============ Train epoch 91 ============
============ Train epoch 92 ============
============ Train epoch 93 ============
============ Train epoch 94 ============
 Site-Clipart   | Train Loss: 0.4230 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3965 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3947 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3206 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4693 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5885 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.4765 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1769 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9602 | Train Acc: 0.6508
 Site-Painting  | Train Loss: 0.4609 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.3950 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.3289 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.5040 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.4370 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3546 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3543 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3173 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4787 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4563 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1243 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1169 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.3721 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.7240 | Val  Acc: 0.7619
 Site-QuickDraw | Val  Loss: 1.6106 | Val  Acc: 0.4048
 Site-Real      | Val  Loss: 0.3443 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7450 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8114
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:18 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:18 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:18 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:18 | Val Acc: 0.5476
 Best site-Painting   | Epoch:18 | Val Acc: 0.7619
 Best site-QuickDraw  | Epoch:18 | Val Acc: 0.4048
 Best site-Real       | Epoch:18 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:18 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 95 ============
============ Train epoch 96 ============
============ Train epoch 97 ============
============ Train epoch 98 ============
============ Train epoch 99 ============
 Site-Clipart   | Train Loss: 0.4501 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3757 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4061 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.3183 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4512 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5771 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4930 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.1429 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.9552 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.4336 | Train Acc: 0.8730
 Site-QuickDraw | Train Loss: 1.2974 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.3436 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4263 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4235 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2723 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2882 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3608 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.4852 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.4888 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 1.0594 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0141 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3100 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.7266 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.6352 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3117 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7893 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8242
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5952
 Best site-Painting   | Epoch:19 | Val Acc: 0.8095
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.4762
 Best site-Real       | Epoch:19 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:19 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8707
 Test site-Infograph | Epoch:19 | Test Acc: 0.4977
 Test site-Painting  | Epoch:19 | Test Acc: 0.8530
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.4610
 Test site-Real      | Epoch:19 | Test Acc: 0.9236
 Test site-Sketch    | Epoch:19 | Test Acc: 0.8087
Average Test Accuracy: 0.7358
============ Train epoch 100 ============
============ Train epoch 101 ============
============ Train epoch 102 ============
============ Train epoch 103 ============
============ Train epoch 104 ============
 Site-Clipart   | Train Loss: 0.3818 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3959 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3838 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1954 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.4247 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5441 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4811 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1673 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9041 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3785 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.3802 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.3502 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 0.4621 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.4627 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2924 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2999 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3227 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3956 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4311 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0649 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0681 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3846 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.6186 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.5683 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3573 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.6404 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8095
============ Train epoch 105 ============
============ Train epoch 106 ============
============ Train epoch 107 ============
============ Train epoch 108 ============
============ Train epoch 109 ============
 Site-Clipart   | Train Loss: 0.4359 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.3925 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3316 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.2406 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3980 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5229 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.4023 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0893 | Train Acc: 0.6508
 Site-Infograph | Train Loss: 0.9250 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.4121 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.3179 | Train Acc: 0.5556
 Site-Real      | Train Loss: 0.3405 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3850 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3434 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2628 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2528 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2873 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.4354 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3697 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.1309 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0087 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.2569 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.5438 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.4687 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3160 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7086 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:21 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:21 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:21 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:21 | Val Acc: 0.5476
 Best site-Painting   | Epoch:21 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:21 | Val Acc: 0.5476
 Best site-Real       | Epoch:21 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:21 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 110 ============
============ Train epoch 111 ============
============ Train epoch 112 ============
============ Train epoch 113 ============
============ Train epoch 114 ============
 Site-Clipart   | Train Loss: 0.3366 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3482 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3196 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2501 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4107 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.5053 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.4838 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0567 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.9237 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3367 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.3695 | Train Acc: 0.5079
 Site-Real      | Train Loss: 0.2631 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3820 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.3347 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2894 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2604 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2738 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3671 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3571 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9269 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0064 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2625 | Val  Acc: 0.5714
 Site-Painting  | Val  Loss: 0.6297 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.5128 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.3489 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6451 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8260
============ Train epoch 115 ============
============ Train epoch 116 ============
============ Train epoch 117 ============
============ Train epoch 118 ============
============ Train epoch 119 ============
 Site-Clipart   | Train Loss: 0.3472 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3347 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3329 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2529 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3933 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5046 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.3874 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.0535 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8598 | Train Acc: 0.7143
 Site-Painting  | Train Loss: 0.3350 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1366 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2989 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3818 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.3241 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2434 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2420 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3046 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3590 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3895 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9758 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.0451 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.2655 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.7128 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4264 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3124 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.7627 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8150
============ Train epoch 120 ============
============ Train epoch 121 ============
============ Train epoch 122 ============
============ Train epoch 123 ============
============ Train epoch 124 ============
 Site-Clipart   | Train Loss: 0.3229 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3231 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3097 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.2343 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.3474 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4585 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.3937 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 1.0549 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.8104 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.3235 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1323 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.2399 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.4108 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.3263 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1572 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2630 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3273 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3200 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3287 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 1.0282 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0081 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1310 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.5977 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4475 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3130 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7268 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8407
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:24 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:24 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:24 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:24 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:24 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:24 | Val Acc: 0.6905
 Best site-Painting   | Epoch:24 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:24 | Val Acc: 0.4762
 Best site-Real       | Epoch:24 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:24 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 125 ============
============ Train epoch 126 ============
============ Train epoch 127 ============
============ Train epoch 128 ============
============ Train epoch 129 ============
 Site-Clipart   | Train Loss: 0.3300 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3173 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3163 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1651 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3727 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.5397 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.3279 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0495 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8735 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.3119 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.1166 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2545 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3192 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.3345 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1740 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2374 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2735 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3393 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2988 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.9320 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9630 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.1348 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.5778 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.4011 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3088 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7000 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8370
============ Train epoch 130 ============
============ Train epoch 131 ============
============ Train epoch 132 ============
============ Train epoch 133 ============
============ Train epoch 134 ============
 Site-Clipart   | Train Loss: 0.2976 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3390 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2814 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1766 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3426 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4280 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.3451 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 0.9796 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8587 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.2821 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.2229 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2508 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3678 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.3306 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2074 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2054 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3160 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.2642 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3240 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.9289 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.9379 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2126 | Val  Acc: 0.6429
 Site-Painting  | Val  Loss: 0.5398 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.3827 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3632 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.6286 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8425
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:26 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:26 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:26 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:26 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:26 | Val Acc: 0.6429
 Best site-Painting   | Epoch:26 | Val Acc: 0.8810
 Best site-QuickDraw  | Epoch:26 | Val Acc: 0.5238
 Best site-Real       | Epoch:26 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:26 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 135 ============
============ Train epoch 136 ============
============ Train epoch 137 ============
============ Train epoch 138 ============
============ Train epoch 139 ============
 Site-Clipart   | Train Loss: 0.2554 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3754 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.2887 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.1849 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3526 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4072 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.3903 | Train Acc: 0.4762
 Site-Infograph | Train Loss: 1.0417 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 0.8362 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.3016 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.1840 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.2296 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.3720 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3096 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1593 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2171 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2184 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2913 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3264 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.9133 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0409 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.2271 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.5028 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4500 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3153 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5826 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8462
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:27 | Val Acc: 0.5952
 Best site-Painting   | Epoch:27 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.5000
 Best site-Real       | Epoch:27 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:27 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 140 ============
============ Train epoch 141 ============
============ Train epoch 142 ============
============ Train epoch 143 ============
============ Train epoch 144 ============
 Site-Clipart   | Train Loss: 0.2559 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2362 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2871 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1603 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3190 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4240 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2649 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8701 | Train Acc: 0.7460
 Site-Infograph | Train Loss: 0.7468 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2690 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1077 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.2195 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.3270 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2257 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1963 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2324 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2853 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.3384 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3265 | Val  Acc: 0.9762
 Site-Infograph | Val  Loss: 0.9262 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 0.9208 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1070 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.6118 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.3535 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3005 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6853 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8553
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:28 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:28 | Val Acc: 0.9762
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:28 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:28 | Val Acc: 0.6667
 Best site-Painting   | Epoch:28 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:28 | Val Acc: 0.5476
 Best site-Real       | Epoch:28 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:28 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 145 ============
============ Train epoch 146 ============
============ Train epoch 147 ============
============ Train epoch 148 ============
============ Train epoch 149 ============
 Site-Clipart   | Train Loss: 0.2703 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2728 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2802 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1495 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2942 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4270 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.3385 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9392 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.8785 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.2502 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.1651 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1951 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3250 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2560 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1500 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1704 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2481 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.3286 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2638 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.8876 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8480 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1333 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5357 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.5252 | Val  Acc: 0.5238
 Site-Real      | Val  Loss: 0.3589 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7163 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8571
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:29 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6667
 Best site-Painting   | Epoch:29 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.5238
 Best site-Real       | Epoch:29 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 150 ============
============ Train epoch 151 ============
============ Train epoch 152 ============
============ Train epoch 153 ============
============ Train epoch 154 ============
 Site-Clipart   | Train Loss: 0.2327 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2804 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2328 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1192 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3245 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.4583 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.2849 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9786 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7560 | Train Acc: 0.7619
 Site-Painting  | Train Loss: 0.2587 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.1646 | Train Acc: 0.6667
 Site-Real      | Train Loss: 0.1777 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3238 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2728 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1535 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1970 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2321 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2464 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2476 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.8469 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8868 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1263 | Val  Acc: 0.6190
 Site-Painting  | Val  Loss: 0.5540 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4199 | Val  Acc: 0.4762
 Site-Real      | Val  Loss: 0.3129 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6248 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8352
============ Train epoch 155 ============
============ Train epoch 156 ============
============ Train epoch 157 ============
============ Train epoch 158 ============
============ Train epoch 159 ============
 Site-Clipart   | Train Loss: 0.2388 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2296 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2430 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1373 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3436 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.4645 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.2803 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9196 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7189 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2772 | Train Acc: 0.9365
 Site-QuickDraw | Train Loss: 1.0855 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.2125 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3207 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2468 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1021 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1684 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1957 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2427 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3519 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8753 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8432 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0986 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.5320 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.4505 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2896 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.5278 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8608
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:31 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:31 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:31 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:31 | Val Acc: 0.6905
 Best site-Painting   | Epoch:31 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:31 | Val Acc: 0.5714
 Best site-Real       | Epoch:31 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:31 | Val Acc: 0.9286
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 160 ============
============ Train epoch 161 ============
============ Train epoch 162 ============
============ Train epoch 163 ============
============ Train epoch 164 ============
 Site-Clipart   | Train Loss: 0.2011 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2178 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2954 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.1221 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.3231 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.4358 | Train Acc: 0.8571
 Site-Infograph | Train Loss: 1.2687 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.9546 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.7082 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2323 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 1.0685 | Train Acc: 0.6825
 Site-Real      | Train Loss: 0.1890 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3433 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2363 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1849 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1549 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.2286 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2904 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2145 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8542 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.8948 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.1259 | Val  Acc: 0.5952
 Site-Painting  | Val  Loss: 0.4910 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2681 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3102 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.5898 | Val  Acc: 0.9286
Average Valid Accuracy: 0.8462
============ Train epoch 165 ============
============ Train epoch 166 ============
============ Train epoch 167 ============
============ Train epoch 168 ============
============ Train epoch 169 ============
 Site-Clipart   | Train Loss: 0.1683 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2191 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2503 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1493 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2927 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.3532 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.1327 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 0.8248 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7250 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2565 | Train Acc: 0.9524
 Site-QuickDraw | Train Loss: 1.0015 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1607 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2927 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.2592 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1483 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1712 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1706 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2967 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2793 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 0.7437 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9005 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.0855 | Val  Acc: 0.5476
 Site-Painting  | Val  Loss: 0.4684 | Val  Acc: 0.8095
 Site-QuickDraw | Val  Loss: 1.2544 | Val  Acc: 0.5476
 Site-Real      | Val  Loss: 0.3170 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6004 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8407
============ Train epoch 170 ============
============ Train epoch 171 ============
============ Train epoch 172 ============
============ Train epoch 173 ============
============ Train epoch 174 ============
 Site-Clipart   | Train Loss: 0.1801 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2513 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1772 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1213 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2726 | Train Acc: 0.9048
 Site-Clipart   | Train Loss: 0.3471 | Train Acc: 0.9206
 Site-Infograph | Train Loss: 1.2322 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9053 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7685 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1983 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9027 | Train Acc: 0.8095
 Site-Real      | Train Loss: 0.1645 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.3038 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2422 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1307 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2046 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1838 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2405 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2564 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.8411 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9032 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.0191 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5717 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.1841 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.2920 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6364 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8553
============ Train epoch 175 ============
============ Train epoch 176 ============
============ Train epoch 177 ============
============ Train epoch 178 ============
============ Train epoch 179 ============
 Site-Clipart   | Train Loss: 0.1456 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2441 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2235 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1135 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2446 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4081 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.0752 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.7957 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7128 | Train Acc: 0.7460
 Site-Painting  | Train Loss: 0.1880 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9840 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.1471 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2612 | Train Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2788 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1222 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1678 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2030 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2848 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2469 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8489 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.8613 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.0000 | Val  Acc: 0.7619
 Site-Painting  | Val  Loss: 0.4740 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.3451 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2613 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6458 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8626
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:35 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:35 | Val Acc: 0.7619
 Best site-Painting   | Epoch:35 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:35 | Val Acc: 0.5714
 Best site-Real       | Epoch:35 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:35 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 180 ============
============ Train epoch 181 ============
============ Train epoch 182 ============
============ Train epoch 183 ============
============ Train epoch 184 ============
 Site-Clipart   | Train Loss: 0.1796 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2656 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.2089 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.0986 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2425 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3499 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.0720 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.6877 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 0.7956 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.1616 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9183 | Train Acc: 0.7460
 Site-Real      | Train Loss: 0.1413 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.3598 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2232 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1336 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.1794 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2234 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1882 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2288 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8540 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8046 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9294 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.4123 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.2183 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.3063 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.6026 | Val  Acc: 0.8571
Average Valid Accuracy: 0.8681
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:36 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:36 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:36 | Val Acc: 0.7143
 Best site-Painting   | Epoch:36 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:36 | Val Acc: 0.5714
 Best site-Real       | Epoch:36 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:36 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 185 ============
============ Train epoch 186 ============
============ Train epoch 187 ============
============ Train epoch 188 ============
============ Train epoch 189 ============
 Site-Clipart   | Train Loss: 0.1770 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2274 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.1953 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.0940 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2368 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3567 | Train Acc: 0.9048
 Site-Infograph | Train Loss: 1.1313 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.8098 | Train Acc: 0.7619
 Site-Infograph | Train Loss: 0.6628 | Train Acc: 0.8095
 Site-Painting  | Train Loss: 0.1703 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 1.0505 | Train Acc: 0.6508
 Site-Real      | Train Loss: 0.1510 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3141 | Train Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.2229 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1131 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2265 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1594 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2382 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.2033 | Val  Acc: 0.9524
 Site-Infograph | Val  Loss: 0.6281 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.6858 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.9515 | Val  Acc: 0.7381
 Site-Painting  | Val  Loss: 0.5686 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.3414 | Val  Acc: 0.5000
 Site-Real      | Val  Loss: 0.3105 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6436 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8718
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:37 | Val Acc: 0.9524
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:37 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:37 | Val Acc: 0.7381
 Best site-Painting   | Epoch:37 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:37 | Val Acc: 0.5000
 Best site-Real       | Epoch:37 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:37 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 190 ============
============ Train epoch 191 ============
============ Train epoch 192 ============
============ Train epoch 193 ============
============ Train epoch 194 ============
 Site-Clipart   | Train Loss: 0.2341 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1682 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2166 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.1281 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.2432 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3838 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.1261 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.9034 | Train Acc: 0.6984
 Site-Infograph | Train Loss: 0.6471 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.1765 | Train Acc: 0.9841
 Site-QuickDraw | Train Loss: 0.9914 | Train Acc: 0.6984
 Site-Real      | Train Loss: 0.1422 | Train Acc: 1.0000
 Site-Sketch    | Train Loss: 0.2273 | Train Acc: 0.9841
 Site-Clipart   | Val  Loss: 0.2525 | Val  Acc: 0.9048
 Site-Clipart   | Val  Loss: 0.1119 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1169 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1971 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3200 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2131 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.6478 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 0.8110 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1101 | Val  Acc: 0.6667
 Site-Painting  | Val  Loss: 0.5060 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.2545 | Val  Acc: 0.5714
 Site-Real      | Val  Loss: 0.2736 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.6019 | Val  Acc: 0.8810
Average Valid Accuracy: 0.8755
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9048
 Best site-Clipart    | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:38 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:38 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:38 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:38 | Val Acc: 0.8810
 Best site-Infograph  | Epoch:38 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:38 | Val Acc: 0.6667
 Best site-Painting   | Epoch:38 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:38 | Val Acc: 0.5714
 Best site-Real       | Epoch:38 | Val Acc: 0.9524
 Best site-Sketch     | Epoch:38 | Val Acc: 0.8810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
============ Train epoch 195 ============
============ Train epoch 196 ============
============ Train epoch 197 ============
============ Train epoch 198 ============
============ Train epoch 199 ============
 Site-Clipart   | Train Loss: 0.1321 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.1624 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2103 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.0626 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2279 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.2978 | Train Acc: 0.9683
 Site-Infograph | Train Loss: 1.0497 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 0.6966 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 0.7278 | Train Acc: 0.6984
 Site-Painting  | Train Loss: 0.1889 | Train Acc: 1.0000
 Site-QuickDraw | Train Loss: 0.9897 | Train Acc: 0.7302
 Site-Real      | Train Loss: 0.1436 | Train Acc: 0.9841
 Site-Sketch    | Train Loss: 0.2686 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.2448 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1174 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1651 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.1885 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2669 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1819 | Val  Acc: 1.0000
 Site-Infograph | Val  Loss: 0.7304 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 0.6321 | Val  Acc: 0.8571
 Site-Infograph | Val  Loss: 0.7886 | Val  Acc: 0.8095
 Site-Painting  | Val  Loss: 0.4994 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.1883 | Val  Acc: 0.5952
 Site-Real      | Val  Loss: 0.3075 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 0.5647 | Val  Acc: 0.9048
Average Valid Accuracy: 0.8810
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:39 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:39 | Val Acc: 1.0000
 Best site-Infograph  | Epoch:39 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8571
 Best site-Infograph  | Epoch:39 | Val Acc: 0.8095
 Best site-Painting   | Epoch:39 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:39 | Val Acc: 0.5952
 Best site-Real       | Epoch:39 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:39 | Val Acc: 0.9048
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/DoPrompt...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8859
 Test site-Infograph | Epoch:39 | Test Acc: 0.5099
 Test site-Painting  | Epoch:39 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.5370
 Test site-Real      | Epoch:39 | Test Acc: 0.9260
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8213
Average Test Accuracy: 0.7585
===2023-04-06 13:32:47===
===2023-04-06 13:32:48===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:39 | Test Acc: 0.8859
 Test site-Infograph | Epoch:39 | Test Acc: 0.5099
 Test site-Painting  | Epoch:39 | Test Acc: 0.8708
 Test site-QuickDraw | Epoch:39 | Test Acc: 0.5370
 Test site-Real      | Epoch:39 | Test Acc: 0.9260
 Test site-Sketch    | Epoch:39 | Test Acc: 0.8213
Average Test Accuracy: 0.7585
