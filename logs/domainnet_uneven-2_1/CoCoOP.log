===2023-04-09 23:42:22===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[6,12,18,24,30,36,15,31,47,29,16,19,17,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.2731 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.1725 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.3881 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2873 | Train Acc: 0.0417
 Site-Clipart   | Train Loss: 2.1754 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1959 | Train Acc: 0.1667
 Site-Infograph | Train Loss: 2.3550 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.2775 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.2004 | Train Acc: 0.2766
 Site-Painting  | Train Loss: 2.2619 | Train Acc: 0.1034
 Site-QuickDraw | Train Loss: 2.4576 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.2513 | Train Acc: 0.0000
 Site-Sketch    | Train Loss: 2.2245 | Train Acc: 0.0588
============ Train epoch 2 ============
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.2042 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.0734 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.2085 | Train Acc: 0.2778
 Site-Clipart   | Train Loss: 2.1090 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.1505 | Train Acc: 0.2000
 Site-Clipart   | Train Loss: 2.1130 | Train Acc: 0.2778
 Site-Infograph | Train Loss: 2.3228 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.2409 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.1758 | Train Acc: 0.2128
 Site-Painting  | Train Loss: 2.2004 | Train Acc: 0.1379
 Site-QuickDraw | Train Loss: 2.4005 | Train Acc: 0.0625
 Site-Real      | Train Loss: 2.1039 | Train Acc: 0.1053
 Site-Sketch    | Train Loss: 2.2337 | Train Acc: 0.1176
 Site-Clipart   | Val  Loss: 2.1873 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.3021 | Val  Acc: 0.0000
 Site-Clipart   | Val  Loss: 2.1199 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.1129 | Val  Acc: 0.3125
 Site-Clipart   | Val  Loss: 2.1637 | Val  Acc: 0.3500
 Site-Clipart   | Val  Loss: 2.1733 | Val  Acc: 0.2083
 Site-Infograph | Val  Loss: 2.1904 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1728 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.2302 | Val  Acc: 0.1613
 Site-Painting  | Val  Loss: 2.4068 | Val  Acc: 0.1053
 Site-QuickDraw | Val  Loss: 2.4056 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2525 | Val  Acc: 0.0833
 Site-Sketch    | Val  Loss: 2.1358 | Val  Acc: 0.1818
Average Valid Accuracy: 0.2029
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.0000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3125
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2083
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:1 | Val Acc: 0.1613
 Best site-Painting   | Epoch:1 | Val Acc: 0.1053
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.0000
 Best site-Real       | Epoch:1 | Val Acc: 0.0833
 Best site-Sketch     | Epoch:1 | Val Acc: 0.1818
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 4 ============
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.1840 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.0315 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.4034 | Train Acc: 0.2222
 Site-Clipart   | Train Loss: 2.1188 | Train Acc: 0.2917
 Site-Clipart   | Train Loss: 2.1045 | Train Acc: 0.3000
 Site-Clipart   | Train Loss: 2.0982 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.2417 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.2422 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.1222 | Train Acc: 0.3191
 Site-Painting  | Train Loss: 2.1972 | Train Acc: 0.1379
 Site-QuickDraw | Train Loss: 2.4356 | Train Acc: 0.0000
 Site-Real      | Train Loss: 2.1724 | Train Acc: 0.2105
 Site-Sketch    | Train Loss: 2.1530 | Train Acc: 0.1176
============ Train epoch 6 ============
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.1229 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9686 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.1198 | Train Acc: 0.2222
 Site-Clipart   | Train Loss: 2.0071 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 2.0886 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.9864 | Train Acc: 0.3889
 Site-Infograph | Train Loss: 2.2437 | Train Acc: 0.0667
 Site-Infograph | Train Loss: 2.1459 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0795 | Train Acc: 0.4255
 Site-Painting  | Train Loss: 2.1087 | Train Acc: 0.2759
 Site-QuickDraw | Train Loss: 2.3990 | Train Acc: 0.1250
 Site-Real      | Train Loss: 2.1384 | Train Acc: 0.2632
 Site-Sketch    | Train Loss: 2.0029 | Train Acc: 0.2941
 Site-Clipart   | Val  Loss: 2.4017 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.2098 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 2.0580 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0482 | Val  Acc: 0.4375
 Site-Clipart   | Val  Loss: 2.1750 | Val  Acc: 0.3000
 Site-Clipart   | Val  Loss: 2.0674 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1729 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 2.1315 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1464 | Val  Acc: 0.2903
 Site-Painting  | Val  Loss: 2.3519 | Val  Acc: 0.1053
 Site-QuickDraw | Val  Loss: 2.3510 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.2543 | Val  Acc: 0.1667
 Site-Sketch    | Val  Loss: 2.0316 | Val  Acc: 0.2727
Average Valid Accuracy: 0.2723
 Best site-Clipart    | Epoch:3 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4375
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3000
 Best site-Clipart    | Epoch:3 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:3 | Val Acc: 0.2903
 Best site-Painting   | Epoch:3 | Val Acc: 0.1053
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.0000
 Best site-Real       | Epoch:3 | Val Acc: 0.1667
 Best site-Sketch     | Epoch:3 | Val Acc: 0.2727
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 2.0325 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9470 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 2.2966 | Train Acc: 0.2778
 Site-Clipart   | Train Loss: 2.1019 | Train Acc: 0.3750
 Site-Clipart   | Train Loss: 1.9840 | Train Acc: 0.4000
 Site-Clipart   | Train Loss: 1.8660 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.2743 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 2.1854 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 2.0846 | Train Acc: 0.3404
 Site-Painting  | Train Loss: 2.0802 | Train Acc: 0.3793
 Site-QuickDraw | Train Loss: 2.3866 | Train Acc: 0.0000
 Site-Real      | Train Loss: 1.9977 | Train Acc: 0.4211
 Site-Sketch    | Train Loss: 2.0336 | Train Acc: 0.2941
============ Train epoch 10 ============
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.9425 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8965 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 2.1743 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9169 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8884 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8733 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.2231 | Train Acc: 0.1333
 Site-Infograph | Train Loss: 2.1840 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.0005 | Train Acc: 0.3404
 Site-Painting  | Train Loss: 1.9781 | Train Acc: 0.3793
 Site-QuickDraw | Train Loss: 2.3708 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.7804 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.8130 | Train Acc: 0.2941
 Site-Clipart   | Val  Loss: 2.1348 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 2.0169 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9305 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 1.9571 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.9995 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 1.8821 | Val  Acc: 0.4167
 Site-Infograph | Val  Loss: 2.1240 | Val  Acc: 0.2000
 Site-Infograph | Val  Loss: 1.9696 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 2.0799 | Val  Acc: 0.2903
 Site-Painting  | Val  Loss: 2.1943 | Val  Acc: 0.2105
 Site-QuickDraw | Val  Loss: 2.2813 | Val  Acc: 0.0000
 Site-Real      | Val  Loss: 2.0888 | Val  Acc: 0.3333
 Site-Sketch    | Val  Loss: 1.9939 | Val  Acc: 0.3636
Average Valid Accuracy: 0.3193
 Best site-Clipart    | Epoch:5 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.4167
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2000
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:5 | Val Acc: 0.2903
 Best site-Painting   | Epoch:5 | Val Acc: 0.2105
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.0000
 Best site-Real       | Epoch:5 | Val Acc: 0.3333
 Best site-Sketch     | Epoch:5 | Val Acc: 0.3636
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 12 ============
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 2.0734 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.8017 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.1248 | Train Acc: 0.2778
 Site-Clipart   | Train Loss: 1.9011 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.8502 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.8737 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.1353 | Train Acc: 0.5333
 Site-Infograph | Train Loss: 2.1972 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.9607 | Train Acc: 0.4894
 Site-Painting  | Train Loss: 1.9813 | Train Acc: 0.4138
 Site-QuickDraw | Train Loss: 2.3754 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.8583 | Train Acc: 0.5789
 Site-Sketch    | Train Loss: 2.1161 | Train Acc: 0.4118
============ Train epoch 14 ============
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.9434 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.7866 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 2.1659 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.8393 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.8414 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.7991 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.1318 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.0557 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.9603 | Train Acc: 0.4043
 Site-Painting  | Train Loss: 1.8809 | Train Acc: 0.5172
 Site-QuickDraw | Train Loss: 2.3442 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.8537 | Train Acc: 0.5263
 Site-Sketch    | Train Loss: 1.6468 | Train Acc: 0.4706
 Site-Clipart   | Val  Loss: 2.0295 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0472 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.8422 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.8021 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7780 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.8495 | Val  Acc: 0.5417
 Site-Infograph | Val  Loss: 1.9812 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.9653 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.0130 | Val  Acc: 0.3226
 Site-Painting  | Val  Loss: 2.2209 | Val  Acc: 0.1053
 Site-QuickDraw | Val  Loss: 2.2763 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 2.0257 | Val  Acc: 0.4167
 Site-Sketch    | Val  Loss: 1.7591 | Val  Acc: 0.7273
Average Valid Accuracy: 0.4537
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:7 | Val Acc: 0.5417
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:7 | Val Acc: 0.3226
 Best site-Painting   | Epoch:7 | Val Acc: 0.1053
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2000
 Best site-Real       | Epoch:7 | Val Acc: 0.4167
 Best site-Sketch     | Epoch:7 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 16 ============
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 2.0145 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6854 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 2.0398 | Train Acc: 0.3889
 Site-Clipart   | Train Loss: 1.7931 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.7803 | Train Acc: 0.6000
 Site-Clipart   | Train Loss: 1.7308 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 2.1312 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 2.0152 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.9019 | Train Acc: 0.4468
 Site-Painting  | Train Loss: 1.7951 | Train Acc: 0.5517
 Site-QuickDraw | Train Loss: 2.3171 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.9023 | Train Acc: 0.5789
 Site-Sketch    | Train Loss: 1.5570 | Train Acc: 0.3529
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.9870 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.6052 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 2.0510 | Train Acc: 0.3889
 Site-Clipart   | Train Loss: 1.6224 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.7868 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.7486 | Train Acc: 0.6389
 Site-Infograph | Train Loss: 2.0680 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.9826 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.8365 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.8014 | Train Acc: 0.5172
 Site-QuickDraw | Train Loss: 2.2818 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6301 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.9746 | Train Acc: 0.5882
 Site-Clipart   | Val  Loss: 1.9261 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.9681 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.6989 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.7013 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.8740 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6726 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.9722 | Val  Acc: 0.3000
 Site-Infograph | Val  Loss: 1.8888 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9303 | Val  Acc: 0.4516
 Site-Painting  | Val  Loss: 2.0844 | Val  Acc: 0.3158
 Site-QuickDraw | Val  Loss: 2.3110 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.9621 | Val  Acc: 0.4167
 Site-Sketch    | Val  Loss: 1.8005 | Val  Acc: 0.5455
Average Valid Accuracy: 0.4594
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:9 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.3000
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4516
 Best site-Painting   | Epoch:9 | Val Acc: 0.3158
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.1000
 Best site-Real       | Epoch:9 | Val Acc: 0.4167
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5455
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.4525
 Test site-Infograph | Epoch:9 | Test Acc: 0.3166
 Test site-Painting  | Epoch:9 | Test Acc: 0.4895
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2230
 Test site-Real      | Epoch:9 | Test Acc: 0.4938
 Test site-Sketch    | Epoch:9 | Test Acc: 0.4711
Average Test Accuracy: 0.4078
============ Train epoch 20 ============
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.9568 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5026 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.8099 | Train Acc: 0.4444
 Site-Clipart   | Train Loss: 1.6500 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.6872 | Train Acc: 0.5333
 Site-Clipart   | Train Loss: 1.6629 | Train Acc: 0.6944
 Site-Infograph | Train Loss: 2.0933 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.9875 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.8041 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.7217 | Train Acc: 0.5517
 Site-QuickDraw | Train Loss: 2.2889 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.8942 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.5960 | Train Acc: 0.4706
============ Train epoch 22 ============
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 1.6908 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5924 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.5626 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6314 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.5961 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.4003 | Train Acc: 0.7222
 Site-Infograph | Train Loss: 2.1200 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9884 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.7663 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.6418 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.3404 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.7669 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.2451 | Train Acc: 0.5294
 Site-Clipart   | Val  Loss: 2.0065 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.7844 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.5911 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.6412 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.6401 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.5518 | Val  Acc: 0.5833
 Site-Infograph | Val  Loss: 1.8577 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8821 | Val  Acc: 0.4286
 Site-Infograph | Val  Loss: 1.8296 | Val  Acc: 0.5806
 Site-Painting  | Val  Loss: 1.9849 | Val  Acc: 0.4737
 Site-QuickDraw | Val  Loss: 2.2111 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.9014 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 1.6073 | Val  Acc: 0.7273
Average Valid Accuracy: 0.5174
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:11 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.5833
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4286
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5806
 Best site-Painting   | Epoch:11 | Val Acc: 0.4737
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.1000
 Best site-Real       | Epoch:11 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:11 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 24 ============
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 1.6119 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4508 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.8866 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.6022 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.5836 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5480 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 2.1304 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.9188 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7407 | Train Acc: 0.5106
 Site-Painting  | Train Loss: 1.5961 | Train Acc: 0.7241
 Site-QuickDraw | Train Loss: 2.3171 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.6029 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 1.8949 | Train Acc: 0.4706
============ Train epoch 26 ============
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 1.6954 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.3853 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.7891 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 1.5461 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.4380 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.4354 | Train Acc: 0.7222
 Site-Infograph | Train Loss: 2.0775 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8939 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.6976 | Train Acc: 0.5745
 Site-Painting  | Train Loss: 1.5286 | Train Acc: 0.6897
 Site-QuickDraw | Train Loss: 2.2465 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4693 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 1.2471 | Train Acc: 0.5882
 Site-Clipart   | Val  Loss: 1.7968 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7478 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4845 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.5508 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6500 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.4794 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.8061 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.8462 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8361 | Val  Acc: 0.4516
 Site-Painting  | Val  Loss: 1.8230 | Val  Acc: 0.5263
 Site-QuickDraw | Val  Loss: 2.2722 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.7861 | Val  Acc: 0.5833
 Site-Sketch    | Val  Loss: 1.6119 | Val  Acc: 0.6364
Average Valid Accuracy: 0.5720
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:13 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:13 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:13 | Val Acc: 0.4516
 Best site-Painting   | Epoch:13 | Val Acc: 0.5263
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.2000
 Best site-Real       | Epoch:13 | Val Acc: 0.5833
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.7047 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.3619 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.6026 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.6118 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4419 | Train Acc: 0.7667
 Site-Clipart   | Train Loss: 1.4184 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0565 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.9464 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6895 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.4920 | Train Acc: 0.6207
 Site-QuickDraw | Train Loss: 2.2423 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.6061 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.6862 | Train Acc: 0.5294
============ Train epoch 30 ============
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.6533 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2480 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.2484 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.4110 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4129 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.4593 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0524 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.9060 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.6580 | Train Acc: 0.6170
 Site-Painting  | Train Loss: 1.3968 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.2737 | Train Acc: 0.0625
 Site-Real      | Train Loss: 1.2872 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.3330 | Train Acc: 0.6471
 Site-Clipart   | Val  Loss: 1.8336 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.7033 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.3743 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 1.3623 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.6139 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.3664 | Val  Acc: 0.6250
 Site-Infograph | Val  Loss: 1.7358 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.6889 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7087 | Val  Acc: 0.6452
 Site-Painting  | Val  Loss: 1.7753 | Val  Acc: 0.5263
 Site-QuickDraw | Val  Loss: 2.2509 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.9561 | Val  Acc: 0.4167
 Site-Sketch    | Val  Loss: 1.4854 | Val  Acc: 0.7273
Average Valid Accuracy: 0.6164
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:15 | Val Acc: 0.6250
 Best site-Infograph  | Epoch:15 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6452
 Best site-Painting   | Epoch:15 | Val Acc: 0.5263
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.2000
 Best site-Real       | Epoch:15 | Val Acc: 0.4167
 Best site-Sketch     | Epoch:15 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 32 ============
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.5735 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1939 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4650 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.3930 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3987 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3103 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0200 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.8784 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5890 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 1.3268 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.1918 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4555 | Train Acc: 0.6842
 Site-Sketch    | Train Loss: 1.3182 | Train Acc: 0.5294
============ Train epoch 34 ============
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.6211 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.2642 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3281 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2649 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.3219 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.2465 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0138 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.8735 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.5731 | Train Acc: 0.6383
 Site-Painting  | Train Loss: 1.3386 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.3301 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.3147 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.1551 | Train Acc: 0.5294
 Site-Clipart   | Val  Loss: 1.8062 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5837 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2339 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 1.2774 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.5053 | Val  Acc: 0.5500
 Site-Clipart   | Val  Loss: 1.2399 | Val  Acc: 0.7083
 Site-Infograph | Val  Loss: 1.6797 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.7223 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.6610 | Val  Acc: 0.6452
 Site-Painting  | Val  Loss: 1.7342 | Val  Acc: 0.4737
 Site-QuickDraw | Val  Loss: 2.2242 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.6532 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.3700 | Val  Acc: 0.7273
Average Valid Accuracy: 0.6226
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:17 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:17 | Val Acc: 0.5500
 Best site-Clipart    | Epoch:17 | Val Acc: 0.7083
 Best site-Infograph  | Epoch:17 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:17 | Val Acc: 0.6452
 Best site-Painting   | Epoch:17 | Val Acc: 0.4737
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.2000
 Best site-Real       | Epoch:17 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7273
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 36 ============
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.6333 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.2071 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9658 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 1.2987 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.2948 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.3416 | Train Acc: 0.7500
 Site-Infograph | Train Loss: 1.9752 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.7336 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.5452 | Train Acc: 0.7447
 Site-Painting  | Train Loss: 1.2280 | Train Acc: 0.8276
 Site-QuickDraw | Train Loss: 2.2425 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.3226 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.2746 | Train Acc: 0.6471
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.4507 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0484 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.4684 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 1.3329 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.2522 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 1.2214 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.9388 | Train Acc: 0.2000
 Site-Infograph | Train Loss: 1.7475 | Train Acc: 0.4194
 Site-Infograph | Train Loss: 1.4841 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 1.2505 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.2526 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4028 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1462 | Train Acc: 0.7647
 Site-Clipart   | Val  Loss: 1.6981 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4932 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.2000 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 1.1971 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.3039 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.2110 | Val  Acc: 0.7083
 Site-Infograph | Val  Loss: 1.6448 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.6672 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.5921 | Val  Acc: 0.6774
 Site-Painting  | Val  Loss: 1.6444 | Val  Acc: 0.5789
 Site-QuickDraw | Val  Loss: 2.1755 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.5851 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.3382 | Val  Acc: 0.6364
Average Valid Accuracy: 0.6277
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:19 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:19 | Val Acc: 0.7083
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:19 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:19 | Val Acc: 0.6774
 Best site-Painting   | Epoch:19 | Val Acc: 0.5789
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.2000
 Best site-Real       | Epoch:19 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:19 | Val Acc: 0.6364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.6806
 Test site-Infograph | Epoch:19 | Test Acc: 0.4216
 Test site-Painting  | Epoch:19 | Test Acc: 0.6898
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.2550
 Test site-Real      | Epoch:19 | Test Acc: 0.7338
 Test site-Sketch    | Epoch:19 | Test Acc: 0.6155
Average Test Accuracy: 0.5661
============ Train epoch 40 ============
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 1.4809 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.1217 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5259 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.3390 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1905 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.2718 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.9416 | Train Acc: 0.2667
 Site-Infograph | Train Loss: 1.8254 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.4821 | Train Acc: 0.6809
 Site-Painting  | Train Loss: 1.1852 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.3031 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2065 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.6354 | Train Acc: 0.5882
============ Train epoch 42 ============
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 1.5272 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0109 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.6042 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1508 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.2203 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 1.3016 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.8101 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.7330 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4415 | Train Acc: 0.7660
 Site-Painting  | Train Loss: 1.1706 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 2.2281 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.9837 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.5153 | Train Acc: 0.8235
 Site-Clipart   | Val  Loss: 1.7933 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 1.5538 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.1461 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.2059 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.3125 | Val  Acc: 0.7000
 Site-Clipart   | Val  Loss: 1.1251 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.5248 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5338 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5590 | Val  Acc: 0.6452
 Site-Painting  | Val  Loss: 1.5754 | Val  Acc: 0.5789
 Site-QuickDraw | Val  Loss: 2.2277 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.5040 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.2395 | Val  Acc: 0.6364
Average Valid Accuracy: 0.6093
============ Train epoch 44 ============
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.5631 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 0.9566 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.2619 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1998 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.0832 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 1.0016 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.8484 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.7829 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.4289 | Train Acc: 0.8085
 Site-Painting  | Train Loss: 1.0821 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 2.2799 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2036 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 0.9701 | Train Acc: 0.7647
============ Train epoch 46 ============
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.4655 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.0530 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.2316 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1470 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.0977 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0316 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.9031 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7421 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.4065 | Train Acc: 0.7872
 Site-Painting  | Train Loss: 1.0948 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.2181 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.0323 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.7377 | Train Acc: 0.8235
 Site-Clipart   | Val  Loss: 1.6502 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4583 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0923 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 1.0911 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 1.3062 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 1.0379 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.5953 | Val  Acc: 0.4000
 Site-Infograph | Val  Loss: 1.5699 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.5544 | Val  Acc: 0.6452
 Site-Painting  | Val  Loss: 1.5576 | Val  Acc: 0.6316
 Site-QuickDraw | Val  Loss: 2.1586 | Val  Acc: 0.1000
 Site-Real      | Val  Loss: 1.4971 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.1529 | Val  Acc: 0.8182
Average Valid Accuracy: 0.6674
 Best site-Clipart    | Epoch:23 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:23 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:23 | Val Acc: 0.6500
 Best site-Clipart    | Epoch:23 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:23 | Val Acc: 0.4000
 Best site-Infograph  | Epoch:23 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:23 | Val Acc: 0.6452
 Best site-Painting   | Epoch:23 | Val Acc: 0.6316
 Best site-QuickDraw  | Epoch:23 | Val Acc: 0.1000
 Best site-Real       | Epoch:23 | Val Acc: 0.7500
 Best site-Sketch     | Epoch:23 | Val Acc: 0.8182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 1.3379 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9090 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.0154 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 1.0292 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.0337 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 1.0426 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 1.8696 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6983 | Train Acc: 0.5484
 Site-Infograph | Train Loss: 1.3410 | Train Acc: 0.7660
 Site-Painting  | Train Loss: 0.9863 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.2154 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2230 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 0.9080 | Train Acc: 0.6471
============ Train epoch 50 ============
============ Train epoch 51 ============
 Site-Clipart   | Train Loss: 1.3381 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 0.9563 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.4485 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.2495 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 0.9792 | Train Acc: 0.9667
 Site-Clipart   | Train Loss: 0.9671 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.8653 | Train Acc: 0.4667
 Site-Infograph | Train Loss: 1.7056 | Train Acc: 0.4516
 Site-Infograph | Train Loss: 1.3605 | Train Acc: 0.7872
 Site-Painting  | Train Loss: 1.0038 | Train Acc: 0.8621
 Site-QuickDraw | Train Loss: 2.2107 | Train Acc: 0.3125
 Site-Real      | Train Loss: 1.1008 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 0.9715 | Train Acc: 0.5882
 Site-Clipart   | Val  Loss: 1.5102 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.4094 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9945 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 1.0917 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 1.3286 | Val  Acc: 0.6500
 Site-Clipart   | Val  Loss: 0.9506 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.5249 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5475 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.3818 | Val  Acc: 0.7097
 Site-Painting  | Val  Loss: 1.5246 | Val  Acc: 0.6316
 Site-QuickDraw | Val  Loss: 2.2310 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.5286 | Val  Acc: 0.7500
 Site-Sketch    | Val  Loss: 1.2554 | Val  Acc: 0.6364
Average Valid Accuracy: 0.6587
============ Train epoch 52 ============
============ Train epoch 53 ============
 Site-Clipart   | Train Loss: 1.4585 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 0.9237 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.1080 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9994 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.0648 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.9770 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.8368 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.6011 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.3108 | Train Acc: 0.7660
 Site-Painting  | Train Loss: 0.9967 | Train Acc: 0.8966
 Site-QuickDraw | Train Loss: 2.2329 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8859 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 0.8160 | Train Acc: 0.7059
============ Train epoch 54 ============
============ Train epoch 55 ============
 Site-Clipart   | Train Loss: 1.1663 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0142 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.9316 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 1.0982 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.0037 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 1.0177 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.8943 | Train Acc: 0.4000
 Site-Infograph | Train Loss: 1.5713 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.2983 | Train Acc: 0.8085
 Site-Painting  | Train Loss: 0.9974 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 2.2798 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.8935 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.6965 | Train Acc: 0.7647
 Site-Clipart   | Val  Loss: 1.4196 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3766 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9493 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 1.0120 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.3167 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 0.9064 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.4360 | Val  Acc: 0.6000
 Site-Infograph | Val  Loss: 1.4451 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.3548 | Val  Acc: 0.8065
 Site-Painting  | Val  Loss: 1.4382 | Val  Acc: 0.6842
 Site-QuickDraw | Val  Loss: 2.1460 | Val  Acc: 0.3000
 Site-Real      | Val  Loss: 1.3490 | Val  Acc: 0.6667
 Site-Sketch    | Val  Loss: 1.2056 | Val  Acc: 0.6364
Average Valid Accuracy: 0.6906
 Best site-Clipart    | Epoch:27 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:27 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6000
 Best site-Infograph  | Epoch:27 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:27 | Val Acc: 0.8065
 Best site-Painting   | Epoch:27 | Val Acc: 0.6842
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.3000
 Best site-Real       | Epoch:27 | Val Acc: 0.6667
 Best site-Sketch     | Epoch:27 | Val Acc: 0.6364
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 56 ============
============ Train epoch 57 ============
 Site-Clipart   | Train Loss: 1.1481 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 0.8879 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.0998 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.1069 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.0058 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9929 | Train Acc: 0.8611
 Site-Infograph | Train Loss: 1.8953 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5621 | Train Acc: 0.5161
 Site-Infograph | Train Loss: 1.2856 | Train Acc: 0.8085
 Site-Painting  | Train Loss: 0.9283 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 2.2403 | Train Acc: 0.1250
 Site-Real      | Train Loss: 0.9647 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.4741 | Train Acc: 0.8235
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 1.2974 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.8664 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8841 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 1.0596 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.0007 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.8565 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 1.8854 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.5873 | Train Acc: 0.4839
 Site-Infograph | Train Loss: 1.2685 | Train Acc: 0.7447
 Site-Painting  | Train Loss: 0.8617 | Train Acc: 0.9310
 Site-QuickDraw | Train Loss: 2.2621 | Train Acc: 0.2500
 Site-Real      | Train Loss: 1.1611 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.8709 | Train Acc: 0.8235
 Site-Clipart   | Val  Loss: 1.4548 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.3157 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 0.9284 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.9318 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0748 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.8908 | Val  Acc: 0.7917
 Site-Infograph | Val  Loss: 1.3728 | Val  Acc: 0.7000
 Site-Infograph | Val  Loss: 1.4334 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.4002 | Val  Acc: 0.7419
 Site-Painting  | Val  Loss: 1.3691 | Val  Acc: 0.6316
 Site-QuickDraw | Val  Loss: 2.2220 | Val  Acc: 0.2000
 Site-Real      | Val  Loss: 1.3887 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.0576 | Val  Acc: 0.8182
Average Valid Accuracy: 0.7162
 Best site-Clipart    | Epoch:29 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:29 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:29 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:29 | Val Acc: 0.7917
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7000
 Best site-Infograph  | Epoch:29 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:29 | Val Acc: 0.7419
 Best site-Painting   | Epoch:29 | Val Acc: 0.6316
 Best site-QuickDraw  | Epoch:29 | Val Acc: 0.2000
 Best site-Real       | Epoch:29 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:29 | Val Acc: 0.8182
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.7605
 Test site-Infograph | Epoch:29 | Test Acc: 0.4323
 Test site-Painting  | Epoch:29 | Test Acc: 0.7674
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.2960
 Test site-Real      | Epoch:29 | Test Acc: 0.8233
 Test site-Sketch    | Epoch:29 | Test Acc: 0.6625
Average Test Accuracy: 0.6236
===2023-04-10 00:03:29===
===2023-04-10 00:03:31===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[6,12,18,24,30,36,15,31,47,29,16,19,17,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:29 | Test Acc: 0.7567
 Test site-Infograph | Epoch:29 | Test Acc: 0.4323
 Test site-Painting  | Epoch:29 | Test Acc: 0.7722
 Test site-QuickDraw | Epoch:29 | Test Acc: 0.2940
 Test site-Real      | Epoch:29 | Test Acc: 0.8184
 Test site-Sketch    | Epoch:29 | Test Acc: 0.6643
Average Test Accuracy: 0.6230
===2023-04-10 00:57:45===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 30
    wk_iters: 2
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
 Site-Clipart   | Train Loss: 2.3136 | Train Acc: 0.0833
 Site-Clipart   | Train Loss: 2.1892 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 2.1685 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.1808 | Train Acc: 0.2292
 Site-Clipart   | Train Loss: 2.1229 | Train Acc: 0.2333
 Site-Clipart   | Train Loss: 2.2101 | Train Acc: 0.2500
 Site-Infograph | Train Loss: 2.2722 | Train Acc: 0.0968
 Site-Infograph | Train Loss: 2.2531 | Train Acc: 0.2063
 Site-Infograph | Train Loss: 2.1875 | Train Acc: 0.2553
 Site-Painting  | Train Loss: 2.2848 | Train Acc: 0.1356
 Site-QuickDraw | Train Loss: 2.3726 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.2354 | Train Acc: 0.1579
 Site-Sketch    | Train Loss: 2.3120 | Train Acc: 0.1429
============ Train epoch 2 ============
============ Train epoch 3 ============
 Site-Clipart   | Train Loss: 2.1850 | Train Acc: 0.1667
 Site-Clipart   | Train Loss: 2.0925 | Train Acc: 0.2917
 Site-Clipart   | Train Loss: 2.1250 | Train Acc: 0.3056
 Site-Clipart   | Train Loss: 2.1133 | Train Acc: 0.3125
 Site-Clipart   | Train Loss: 1.9812 | Train Acc: 0.4333
 Site-Clipart   | Train Loss: 2.0367 | Train Acc: 0.4167
 Site-Infograph | Train Loss: 2.1899 | Train Acc: 0.1935
 Site-Infograph | Train Loss: 2.1885 | Train Acc: 0.1905
 Site-Infograph | Train Loss: 2.0877 | Train Acc: 0.2660
 Site-Painting  | Train Loss: 2.1580 | Train Acc: 0.2881
 Site-QuickDraw | Train Loss: 2.3778 | Train Acc: 0.0312
 Site-Real      | Train Loss: 2.1096 | Train Acc: 0.3158
 Site-Sketch    | Train Loss: 2.0479 | Train Acc: 0.1714
 Site-Clipart   | Val  Loss: 1.9604 | Val  Acc: 0.2500
 Site-Clipart   | Val  Loss: 1.9874 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 2.0652 | Val  Acc: 0.3333
 Site-Clipart   | Val  Loss: 2.0379 | Val  Acc: 0.3750
 Site-Clipart   | Val  Loss: 1.9950 | Val  Acc: 0.3500
 Site-Clipart   | Val  Loss: 2.1451 | Val  Acc: 0.2917
 Site-Infograph | Val  Loss: 2.0283 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.0856 | Val  Acc: 0.3810
 Site-Infograph | Val  Loss: 2.1852 | Val  Acc: 0.2540
 Site-Painting  | Val  Loss: 2.1641 | Val  Acc: 0.1795
 Site-QuickDraw | Val  Loss: 2.2365 | Val  Acc: 0.1905
 Site-Real      | Val  Loss: 2.0814 | Val  Acc: 0.2400
 Site-Sketch    | Val  Loss: 2.0178 | Val  Acc: 0.3913
Average Valid Accuracy: 0.3167
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3333
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3750
 Best site-Clipart    | Epoch:1 | Val Acc: 0.3500
 Best site-Clipart    | Epoch:1 | Val Acc: 0.2917
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3810
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2540
 Best site-Painting   | Epoch:1 | Val Acc: 0.1795
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.1905
 Best site-Real       | Epoch:1 | Val Acc: 0.2400
 Best site-Sketch     | Epoch:1 | Val Acc: 0.3913
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 4 ============
============ Train epoch 5 ============
 Site-Clipart   | Train Loss: 2.0983 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.9290 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 2.0646 | Train Acc: 0.3611
 Site-Clipart   | Train Loss: 1.9856 | Train Acc: 0.4375
 Site-Clipart   | Train Loss: 1.8983 | Train Acc: 0.4833
 Site-Clipart   | Train Loss: 1.9813 | Train Acc: 0.4306
 Site-Infograph | Train Loss: 2.2440 | Train Acc: 0.1613
 Site-Infograph | Train Loss: 2.1644 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 2.0409 | Train Acc: 0.4043
 Site-Painting  | Train Loss: 2.0230 | Train Acc: 0.4407
 Site-QuickDraw | Train Loss: 2.3576 | Train Acc: 0.0938
 Site-Real      | Train Loss: 2.0308 | Train Acc: 0.3684
 Site-Sketch    | Train Loss: 1.9059 | Train Acc: 0.4571
============ Train epoch 6 ============
============ Train epoch 7 ============
 Site-Clipart   | Train Loss: 2.0611 | Train Acc: 0.2500
 Site-Clipart   | Train Loss: 1.8306 | Train Acc: 0.5417
 Site-Clipart   | Train Loss: 1.9605 | Train Acc: 0.4722
 Site-Clipart   | Train Loss: 1.9156 | Train Acc: 0.4583
 Site-Clipart   | Train Loss: 1.7665 | Train Acc: 0.6167
 Site-Clipart   | Train Loss: 1.8298 | Train Acc: 0.5000
 Site-Infograph | Train Loss: 2.1787 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 2.0777 | Train Acc: 0.2698
 Site-Infograph | Train Loss: 1.9221 | Train Acc: 0.4255
 Site-Painting  | Train Loss: 1.9748 | Train Acc: 0.4237
 Site-QuickDraw | Train Loss: 2.2879 | Train Acc: 0.0312
 Site-Real      | Train Loss: 1.9724 | Train Acc: 0.4737
 Site-Sketch    | Train Loss: 1.8680 | Train Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7507 | Val  Acc: 0.6250
 Site-Clipart   | Val  Loss: 1.7093 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.7666 | Val  Acc: 0.5833
 Site-Clipart   | Val  Loss: 1.7833 | Val  Acc: 0.5625
 Site-Clipart   | Val  Loss: 1.7823 | Val  Acc: 0.4500
 Site-Clipart   | Val  Loss: 1.9495 | Val  Acc: 0.4792
 Site-Infograph | Val  Loss: 1.8050 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.8284 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 2.0731 | Val  Acc: 0.3492
 Site-Painting  | Val  Loss: 1.9393 | Val  Acc: 0.4615
 Site-QuickDraw | Val  Loss: 2.1496 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.8870 | Val  Acc: 0.4400
 Site-Sketch    | Val  Loss: 1.8532 | Val  Acc: 0.6087
Average Valid Accuracy: 0.4988
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6250
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5833
 Best site-Clipart    | Epoch:3 | Val Acc: 0.5625
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4500
 Best site-Clipart    | Epoch:3 | Val Acc: 0.4792
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:3 | Val Acc: 0.3492
 Best site-Painting   | Epoch:3 | Val Acc: 0.4615
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.1429
 Best site-Real       | Epoch:3 | Val Acc: 0.4400
 Best site-Sketch     | Epoch:3 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.9413 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.6940 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.8482 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.7998 | Train Acc: 0.5417
 Site-Clipart   | Train Loss: 1.6108 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.7093 | Train Acc: 0.5694
 Site-Infograph | Train Loss: 2.1746 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 2.0954 | Train Acc: 0.2381
 Site-Infograph | Train Loss: 1.8878 | Train Acc: 0.4787
 Site-Painting  | Train Loss: 1.8617 | Train Acc: 0.4746
 Site-QuickDraw | Train Loss: 2.3477 | Train Acc: 0.0938
 Site-Real      | Train Loss: 1.7739 | Train Acc: 0.5526
 Site-Sketch    | Train Loss: 1.7258 | Train Acc: 0.6571
============ Train epoch 10 ============
============ Train epoch 11 ============
 Site-Clipart   | Train Loss: 1.8858 | Train Acc: 0.3333
 Site-Clipart   | Train Loss: 1.4781 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.5918 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.6886 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.5400 | Train Acc: 0.7000
 Site-Clipart   | Train Loss: 1.5856 | Train Acc: 0.6111
 Site-Infograph | Train Loss: 2.0604 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 2.0337 | Train Acc: 0.2540
 Site-Infograph | Train Loss: 1.8141 | Train Acc: 0.5000
 Site-Painting  | Train Loss: 1.7068 | Train Acc: 0.6441
 Site-QuickDraw | Train Loss: 2.3115 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.7293 | Train Acc: 0.6316
 Site-Sketch    | Train Loss: 1.5415 | Train Acc: 0.6857
 Site-Clipart   | Val  Loss: 1.4719 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.4207 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.5610 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.5546 | Val  Acc: 0.6875
 Site-Clipart   | Val  Loss: 1.6295 | Val  Acc: 0.6000
 Site-Clipart   | Val  Loss: 1.7573 | Val  Acc: 0.5417
 Site-Infograph | Val  Loss: 1.6871 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.7522 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 1.9312 | Val  Acc: 0.3651
 Site-Painting  | Val  Loss: 1.6275 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1523 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.6784 | Val  Acc: 0.4800
 Site-Sketch    | Val  Loss: 1.6897 | Val  Acc: 0.4783
Average Valid Accuracy: 0.5780
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:5 | Val Acc: 0.7917
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6875
 Best site-Clipart    | Epoch:5 | Val Acc: 0.6000
 Best site-Clipart    | Epoch:5 | Val Acc: 0.5417
 Best site-Infograph  | Epoch:5 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:5 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:5 | Val Acc: 0.3651
 Best site-Painting   | Epoch:5 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.2381
 Best site-Real       | Epoch:5 | Val Acc: 0.4800
 Best site-Sketch     | Epoch:5 | Val Acc: 0.4783
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 12 ============
============ Train epoch 13 ============
 Site-Clipart   | Train Loss: 1.6870 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.4996 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.6662 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.5969 | Train Acc: 0.6875
 Site-Clipart   | Train Loss: 1.4347 | Train Acc: 0.7333
 Site-Clipart   | Train Loss: 1.4884 | Train Acc: 0.6667
 Site-Infograph | Train Loss: 2.0789 | Train Acc: 0.2258
 Site-Infograph | Train Loss: 1.9936 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 1.7311 | Train Acc: 0.5319
 Site-Painting  | Train Loss: 1.6469 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.2859 | Train Acc: 0.1250
 Site-Real      | Train Loss: 1.5953 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5408 | Train Acc: 0.6857
============ Train epoch 14 ============
============ Train epoch 15 ============
 Site-Clipart   | Train Loss: 1.6373 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.4156 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.5094 | Train Acc: 0.5556
 Site-Clipart   | Train Loss: 1.5176 | Train Acc: 0.7083
 Site-Clipart   | Train Loss: 1.2768 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.3853 | Train Acc: 0.7083
 Site-Infograph | Train Loss: 2.0872 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.9169 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.6931 | Train Acc: 0.5213
 Site-Painting  | Train Loss: 1.5483 | Train Acc: 0.6271
 Site-QuickDraw | Train Loss: 2.3125 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.4728 | Train Acc: 0.7368
 Site-Sketch    | Train Loss: 1.5769 | Train Acc: 0.7143
 Site-Clipart   | Val  Loss: 1.3278 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.1784 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.2816 | Val  Acc: 0.7917
 Site-Clipart   | Val  Loss: 1.3884 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.3838 | Val  Acc: 0.8250
 Site-Clipart   | Val  Loss: 1.5207 | Val  Acc: 0.6875
 Site-Infograph | Val  Loss: 1.4457 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.6015 | Val  Acc: 0.5476
 Site-Infograph | Val  Loss: 1.8271 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.4379 | Val  Acc: 0.6410
 Site-QuickDraw | Val  Loss: 2.1143 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.5371 | Val  Acc: 0.7200
 Site-Sketch    | Val  Loss: 1.5853 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6601
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7917
 Best site-Clipart    | Epoch:7 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8250
 Best site-Clipart    | Epoch:7 | Val Acc: 0.6875
 Best site-Infograph  | Epoch:7 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5476
 Best site-Infograph  | Epoch:7 | Val Acc: 0.4286
 Best site-Painting   | Epoch:7 | Val Acc: 0.6410
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.2381
 Best site-Real       | Epoch:7 | Val Acc: 0.7200
 Best site-Sketch     | Epoch:7 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 16 ============
============ Train epoch 17 ============
 Site-Clipart   | Train Loss: 1.6963 | Train Acc: 0.4167
 Site-Clipart   | Train Loss: 1.3292 | Train Acc: 0.6250
 Site-Clipart   | Train Loss: 1.4355 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 1.4508 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 1.1781 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 1.2977 | Train Acc: 0.7639
 Site-Infograph | Train Loss: 2.0452 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.8615 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.5933 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.5021 | Train Acc: 0.6441
 Site-QuickDraw | Train Loss: 2.2789 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.3775 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.3756 | Train Acc: 0.7714
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.4991 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 0.9737 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.3467 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.3138 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.1341 | Train Acc: 0.8167
 Site-Clipart   | Train Loss: 1.1804 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.0445 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.8315 | Train Acc: 0.3968
 Site-Infograph | Train Loss: 1.5588 | Train Acc: 0.5532
 Site-Painting  | Train Loss: 1.4077 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.2849 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.2949 | Train Acc: 0.7895
 Site-Sketch    | Train Loss: 1.2349 | Train Acc: 0.7429
 Site-Clipart   | Val  Loss: 1.0604 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9856 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.1923 | Val  Acc: 0.7083
 Site-Clipart   | Val  Loss: 1.1969 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.2477 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 1.4236 | Val  Acc: 0.7292
 Site-Infograph | Val  Loss: 1.2881 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5183 | Val  Acc: 0.5238
 Site-Infograph | Val  Loss: 1.6950 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 1.2903 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0594 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.3335 | Val  Acc: 0.7600
 Site-Sketch    | Val  Loss: 1.4771 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6820
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7083
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:9 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:9 | Val Acc: 0.7292
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:9 | Val Acc: 0.5238
 Best site-Infograph  | Epoch:9 | Val Acc: 0.4286
 Best site-Painting   | Epoch:9 | Val Acc: 0.7692
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.3333
 Best site-Real       | Epoch:9 | Val Acc: 0.7600
 Best site-Sketch     | Epoch:9 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.6977
 Test site-Infograph | Epoch:9 | Test Acc: 0.3820
 Test site-Painting  | Epoch:9 | Test Acc: 0.7157
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.2820
 Test site-Real      | Epoch:9 | Test Acc: 0.7814
 Test site-Sketch    | Epoch:9 | Test Acc: 0.6480
Average Test Accuracy: 0.5845
============ Train epoch 20 ============
============ Train epoch 21 ============
 Site-Clipart   | Train Loss: 1.4739 | Train Acc: 0.5833
 Site-Clipart   | Train Loss: 1.0049 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.5680 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.2736 | Train Acc: 0.8125
 Site-Clipart   | Train Loss: 1.0395 | Train Acc: 0.8000
 Site-Clipart   | Train Loss: 1.0989 | Train Acc: 0.7917
 Site-Infograph | Train Loss: 2.0095 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.7707 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4452 | Train Acc: 0.5957
 Site-Painting  | Train Loss: 1.2813 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.2717 | Train Acc: 0.1562
 Site-Real      | Train Loss: 1.2403 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 1.0308 | Train Acc: 0.7143
============ Train epoch 22 ============
============ Train epoch 23 ============
 Site-Clipart   | Train Loss: 1.4782 | Train Acc: 0.5000
 Site-Clipart   | Train Loss: 1.0508 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.2747 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 1.1739 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9898 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 1.0476 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.9376 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.7308 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4590 | Train Acc: 0.6064
 Site-Painting  | Train Loss: 1.2594 | Train Acc: 0.7288
 Site-QuickDraw | Train Loss: 2.2325 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.0911 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.1980 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.0355 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.8647 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.9678 | Val  Acc: 0.7500
 Site-Clipart   | Val  Loss: 1.0779 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.1130 | Val  Acc: 0.8000
 Site-Clipart   | Val  Loss: 1.2528 | Val  Acc: 0.7500
 Site-Infograph | Val  Loss: 1.3117 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.4212 | Val  Acc: 0.5952
 Site-Infograph | Val  Loss: 1.6218 | Val  Acc: 0.4603
 Site-Painting  | Val  Loss: 1.1290 | Val  Acc: 0.7179
 Site-QuickDraw | Val  Loss: 2.0351 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.1951 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 1.3852 | Val  Acc: 0.5652
Average Valid Accuracy: 0.6973
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:11 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7500
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:11 | Val Acc: 0.8000
 Best site-Clipart    | Epoch:11 | Val Acc: 0.7500
 Best site-Infograph  | Epoch:11 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:11 | Val Acc: 0.5952
 Best site-Infograph  | Epoch:11 | Val Acc: 0.4603
 Best site-Painting   | Epoch:11 | Val Acc: 0.7179
 Best site-QuickDraw  | Epoch:11 | Val Acc: 0.2857
 Best site-Real       | Epoch:11 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:11 | Val Acc: 0.5652
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 24 ============
============ Train epoch 25 ============
 Site-Clipart   | Train Loss: 1.3169 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.9521 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1353 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 1.2032 | Train Acc: 0.7708
 Site-Clipart   | Train Loss: 0.9807 | Train Acc: 0.8167
 Site-Clipart   | Train Loss: 0.9950 | Train Acc: 0.8056
 Site-Infograph | Train Loss: 1.9621 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.7189 | Train Acc: 0.4603
 Site-Infograph | Train Loss: 1.3733 | Train Acc: 0.6277
 Site-Painting  | Train Loss: 1.1215 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.2302 | Train Acc: 0.2188
 Site-Real      | Train Loss: 1.0417 | Train Acc: 0.7632
 Site-Sketch    | Train Loss: 1.0506 | Train Acc: 0.8000
============ Train epoch 26 ============
============ Train epoch 27 ============
 Site-Clipart   | Train Loss: 1.2858 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.8563 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.1555 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0693 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.8957 | Train Acc: 0.8667
 Site-Clipart   | Train Loss: 0.9290 | Train Acc: 0.8472
 Site-Infograph | Train Loss: 1.8977 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.6481 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.3597 | Train Acc: 0.6596
 Site-Painting  | Train Loss: 1.0707 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.2638 | Train Acc: 0.1875
 Site-Real      | Train Loss: 1.0669 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.8801 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.8360 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7148 | Val  Acc: 0.9375
 Site-Clipart   | Val  Loss: 0.8592 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9888 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 1.0665 | Val  Acc: 0.7750
 Site-Clipart   | Val  Loss: 1.1758 | Val  Acc: 0.7292
 Site-Infograph | Val  Loss: 1.1404 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3040 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5427 | Val  Acc: 0.5556
 Site-Painting  | Val  Loss: 1.0601 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 2.0297 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0965 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.3307 | Val  Acc: 0.6087
Average Valid Accuracy: 0.7416
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.9375
 Best site-Clipart    | Epoch:13 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7750
 Best site-Clipart    | Epoch:13 | Val Acc: 0.7292
 Best site-Infograph  | Epoch:13 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:13 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:13 | Val Acc: 0.5556
 Best site-Painting   | Epoch:13 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:13 | Val Acc: 0.3333
 Best site-Real       | Epoch:13 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:13 | Val Acc: 0.6087
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 1.2063 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.9685 | Train Acc: 0.7917
 Site-Clipart   | Train Loss: 1.2745 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.0818 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.8731 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9391 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.9156 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.6280 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2926 | Train Acc: 0.6915
 Site-Painting  | Train Loss: 1.0287 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.2483 | Train Acc: 0.2500
 Site-Real      | Train Loss: 0.9522 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 1.3214 | Train Acc: 0.8571
============ Train epoch 30 ============
============ Train epoch 31 ============
 Site-Clipart   | Train Loss: 1.2899 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.8939 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.9952 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9506 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.7736 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.8493 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8462 | Train Acc: 0.3548
 Site-Infograph | Train Loss: 1.5638 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.2741 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.9874 | Train Acc: 0.7966
 Site-QuickDraw | Train Loss: 2.1857 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.8905 | Train Acc: 0.8421
 Site-Sketch    | Train Loss: 0.9906 | Train Acc: 0.7714
 Site-Clipart   | Val  Loss: 0.7692 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6280 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7928 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.9159 | Val  Acc: 0.7812
 Site-Clipart   | Val  Loss: 0.9079 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 1.0522 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 1.1327 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2549 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4780 | Val  Acc: 0.6032
 Site-Painting  | Val  Loss: 0.9491 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.9882 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 1.0207 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 1.1643 | Val  Acc: 0.6957
Average Valid Accuracy: 0.7777
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:15 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:15 | Val Acc: 0.7812
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:15 | Val Acc: 0.8125
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:15 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:15 | Val Acc: 0.6032
 Best site-Painting   | Epoch:15 | Val Acc: 0.8718
 Best site-QuickDraw  | Epoch:15 | Val Acc: 0.3333
 Best site-Real       | Epoch:15 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:15 | Val Acc: 0.6957
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 32 ============
============ Train epoch 33 ============
 Site-Clipart   | Train Loss: 1.0271 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.7293 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.0087 | Train Acc: 0.6389
 Site-Clipart   | Train Loss: 0.9816 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.7475 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.8056 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 1.9408 | Train Acc: 0.3871
 Site-Infograph | Train Loss: 1.5637 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.2145 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.9932 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.1564 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.8582 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8459 | Train Acc: 0.8286
============ Train epoch 34 ============
============ Train epoch 35 ============
 Site-Clipart   | Train Loss: 1.2287 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7162 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 1.2703 | Train Acc: 0.6111
 Site-Clipart   | Train Loss: 0.9539 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.7297 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.7585 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8976 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.5415 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 1.2104 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.8840 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.1873 | Train Acc: 0.1875
 Site-Real      | Train Loss: 0.8389 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.1992 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.7928 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5920 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6945 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.8266 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.9110 | Val  Acc: 0.8500
 Site-Clipart   | Val  Loss: 0.9554 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 0.9600 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.2222 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.4044 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.8514 | Val  Acc: 0.8205
 Site-QuickDraw | Val  Loss: 2.0350 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9017 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.1197 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7923
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:17 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8500
 Best site-Clipart    | Epoch:17 | Val Acc: 0.8125
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:17 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:17 | Val Acc: 0.5873
 Best site-Painting   | Epoch:17 | Val Acc: 0.8205
 Best site-QuickDraw  | Epoch:17 | Val Acc: 0.3333
 Best site-Real       | Epoch:17 | Val Acc: 0.9200
 Best site-Sketch     | Epoch:17 | Val Acc: 0.7391
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 36 ============
============ Train epoch 37 ============
 Site-Clipart   | Train Loss: 1.2066 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6123 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.8842 | Train Acc: 0.7222
 Site-Clipart   | Train Loss: 0.9165 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.6953 | Train Acc: 0.8500
 Site-Clipart   | Train Loss: 0.7571 | Train Acc: 0.8750
 Site-Infograph | Train Loss: 1.8459 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.4913 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1679 | Train Acc: 0.6702
 Site-Painting  | Train Loss: 0.8687 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1609 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.6984 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.9758 | Train Acc: 0.7429
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 1.0247 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5631 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.9613 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 0.8641 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.6282 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6926 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 1.8501 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.4825 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.1481 | Train Acc: 0.7660
 Site-Painting  | Train Loss: 0.8888 | Train Acc: 0.8475
 Site-QuickDraw | Train Loss: 2.1883 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.8154 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8447 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.6694 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5378 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.7301 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.7415 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.7875 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.9113 | Val  Acc: 0.8542
 Site-Infograph | Val  Loss: 0.9316 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1106 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.3766 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.8346 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.9778 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.9100 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 0.9918 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8012
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:19 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8125
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8750
 Best site-Clipart    | Epoch:19 | Val Acc: 0.8542
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:19 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:19 | Val Acc: 0.5873
 Best site-Painting   | Epoch:19 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:19 | Val Acc: 0.3333
 Best site-Real       | Epoch:19 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:19 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
 Test site-Clipart   | Epoch:19 | Test Acc: 0.8137
 Test site-Infograph | Epoch:19 | Test Acc: 0.4612
 Test site-Painting  | Epoch:19 | Test Acc: 0.8110
 Test site-QuickDraw | Epoch:19 | Test Acc: 0.3200
 Test site-Real      | Epoch:19 | Test Acc: 0.8841
 Test site-Sketch    | Epoch:19 | Test Acc: 0.7437
Average Test Accuracy: 0.6723
============ Train epoch 40 ============
============ Train epoch 41 ============
 Site-Clipart   | Train Loss: 0.9607 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6276 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.8698 | Train Acc: 0.7222
 Site-Clipart   | Train Loss: 0.8549 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6179 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.6389 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.8533 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4670 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0949 | Train Acc: 0.7553
 Site-Painting  | Train Loss: 0.8768 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.1855 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.7308 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.8191 | Train Acc: 0.8286
============ Train epoch 42 ============
============ Train epoch 43 ============
 Site-Clipart   | Train Loss: 0.9916 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.6650 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.9832 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 0.8144 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.5906 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6053 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 1.9612 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.4333 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0795 | Train Acc: 0.7447
 Site-Painting  | Train Loss: 0.7694 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.1522 | Train Acc: 0.2188
 Site-Real      | Train Loss: 0.6902 | Train Acc: 0.8684
 Site-Sketch    | Train Loss: 0.7319 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.5304 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3969 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.6870 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.7400 | Val  Acc: 0.8125
 Site-Clipart   | Val  Loss: 0.6828 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.9668 | Val  Acc: 0.7708
 Site-Infograph | Val  Loss: 0.8989 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1046 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 1.3189 | Val  Acc: 0.5873
 Site-Painting  | Val  Loss: 0.7844 | Val  Acc: 0.7692
 Site-QuickDraw | Val  Loss: 2.0068 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.8077 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 1.0403 | Val  Acc: 0.7391
Average Valid Accuracy: 0.7779
============ Train epoch 44 ============
============ Train epoch 45 ============
 Site-Clipart   | Train Loss: 1.1198 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.5315 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.8265 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.7705 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6055 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.5547 | Train Acc: 0.9444
 Site-Infograph | Train Loss: 1.9025 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.4062 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0768 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.8138 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1411 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.6653 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 1.0078 | Train Acc: 0.8286
============ Train epoch 46 ============
============ Train epoch 47 ============
 Site-Clipart   | Train Loss: 1.0163 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 0.5910 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.6646 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.7568 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.5666 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.6117 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 1.8346 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3660 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 1.0747 | Train Acc: 0.7021
 Site-Painting  | Train Loss: 0.7622 | Train Acc: 0.8305
 Site-QuickDraw | Train Loss: 2.0540 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.6324 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.9427 | Train Acc: 0.8000
 Site-Clipart   | Val  Loss: 0.5836 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4395 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5661 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.6750 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.6484 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.7990 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.9232 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.0657 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.2406 | Val  Acc: 0.6508
 Site-Painting  | Val  Loss: 0.7288 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.9735 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 0.7318 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9393 | Val  Acc: 0.8261
Average Valid Accuracy: 0.7942
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.8780 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.5256 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.7518 | Train Acc: 0.8056
 Site-Clipart   | Train Loss: 0.7961 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.5523 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.5579 | Train Acc: 0.9167
 Site-Infograph | Train Loss: 1.9651 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3713 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.0376 | Train Acc: 0.7340
 Site-Painting  | Train Loss: 0.6553 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.1033 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.6415 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.5811 | Train Acc: 0.8857
============ Train epoch 50 ============
============ Train epoch 51 ============
 Site-Clipart   | Train Loss: 0.8019 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.5393 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.8112 | Train Acc: 0.7500
 Site-Clipart   | Train Loss: 0.7566 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.5735 | Train Acc: 0.8833
 Site-Clipart   | Train Loss: 0.4907 | Train Acc: 0.9028
 Site-Infograph | Train Loss: 1.7523 | Train Acc: 0.2581
 Site-Infograph | Train Loss: 1.3920 | Train Acc: 0.5873
 Site-Infograph | Train Loss: 1.0132 | Train Acc: 0.7128
 Site-Painting  | Train Loss: 0.6851 | Train Acc: 0.8644
 Site-QuickDraw | Train Loss: 2.1226 | Train Acc: 0.2812
 Site-Real      | Train Loss: 0.5609 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7430 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5256 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3467 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5575 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.5982 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.5873 | Val  Acc: 0.9500
 Site-Clipart   | Val  Loss: 0.7966 | Val  Acc: 0.8125
 Site-Infograph | Val  Loss: 0.7922 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.0398 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1903 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.7185 | Val  Acc: 0.8462
 Site-QuickDraw | Val  Loss: 1.8966 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.7745 | Val  Acc: 0.8400
 Site-Sketch    | Val  Loss: 0.8695 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8101
 Best site-Clipart    | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:25 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:25 | Val Acc: 0.9500
 Best site-Clipart    | Epoch:25 | Val Acc: 0.8125
 Best site-Infograph  | Epoch:25 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:25 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:25 | Val Acc: 0.6349
 Best site-Painting   | Epoch:25 | Val Acc: 0.8462
 Best site-QuickDraw  | Epoch:25 | Val Acc: 0.4286
 Best site-Real       | Epoch:25 | Val Acc: 0.8400
 Best site-Sketch     | Epoch:25 | Val Acc: 0.7826
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 52 ============
============ Train epoch 53 ============
 Site-Clipart   | Train Loss: 0.9741 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4782 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 1.0683 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.6797 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.4900 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.5072 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 1.8336 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3091 | Train Acc: 0.6032
 Site-Infograph | Train Loss: 0.9521 | Train Acc: 0.7872
 Site-Painting  | Train Loss: 0.6630 | Train Acc: 0.9153
 Site-QuickDraw | Train Loss: 2.0987 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.6585 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6520 | Train Acc: 0.8571
============ Train epoch 54 ============
============ Train epoch 55 ============
 Site-Clipart   | Train Loss: 0.9284 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.4574 | Train Acc: 0.9583
 Site-Clipart   | Train Loss: 0.8508 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.7015 | Train Acc: 0.8542
 Site-Clipart   | Train Loss: 0.4892 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4633 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 1.8150 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.3326 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9765 | Train Acc: 0.7340
 Site-Painting  | Train Loss: 0.6610 | Train Acc: 0.8814
 Site-QuickDraw | Train Loss: 2.0356 | Train Acc: 0.3438
 Site-Real      | Train Loss: 0.5385 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6678 | Train Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.5090 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3783 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5022 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.6185 | Val  Acc: 0.8438
 Site-Clipart   | Val  Loss: 0.4970 | Val  Acc: 0.9250
 Site-Clipart   | Val  Loss: 0.7035 | Val  Acc: 0.8958
 Site-Infograph | Val  Loss: 0.7315 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 0.9705 | Val  Acc: 0.7857
 Site-Infograph | Val  Loss: 1.1578 | Val  Acc: 0.6349
 Site-Painting  | Val  Loss: 0.7082 | Val  Acc: 0.7949
 Site-QuickDraw | Val  Loss: 1.8384 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.6688 | Val  Acc: 0.8800
 Site-Sketch    | Val  Loss: 0.9366 | Val  Acc: 0.8261
Average Valid Accuracy: 0.8262
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9167
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8438
 Best site-Clipart    | Epoch:27 | Val Acc: 0.9250
 Best site-Clipart    | Epoch:27 | Val Acc: 0.8958
 Best site-Infograph  | Epoch:27 | Val Acc: 0.8095
 Best site-Infograph  | Epoch:27 | Val Acc: 0.7857
 Best site-Infograph  | Epoch:27 | Val Acc: 0.6349
 Best site-Painting   | Epoch:27 | Val Acc: 0.7949
 Best site-QuickDraw  | Epoch:27 | Val Acc: 0.4286
 Best site-Real       | Epoch:27 | Val Acc: 0.8800
 Best site-Sketch     | Epoch:27 | Val Acc: 0.8261
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-2_1/CoCoOP...
============ Train epoch 56 ============
============ Train epoch 57 ============
 Site-Clipart   | Train Loss: 0.9362 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.3370 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.7275 | Train Acc: 0.6944
 Site-Clipart   | Train Loss: 0.7157 | Train Acc: 0.8958
 Site-Clipart   | Train Loss: 0.4906 | Train Acc: 0.9000
 Site-Clipart   | Train Loss: 0.4484 | Train Acc: 0.9306
 Site-Infograph | Train Loss: 1.7699 | Train Acc: 0.3226
 Site-Infograph | Train Loss: 1.2809 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9463 | Train Acc: 0.7234
 Site-Painting  | Train Loss: 0.6040 | Train Acc: 0.8983
 Site-QuickDraw | Train Loss: 1.9383 | Train Acc: 0.3750
 Site-Real      | Train Loss: 0.5389 | Train Acc: 0.9211
 Site-Sketch    | Train Loss: 0.7762 | Train Acc: 0.8286
============ Train epoch 58 ============
============ Train epoch 59 ============
 Site-Clipart   | Train Loss: 0.8284 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.4647 | Train Acc: 0.9167
 Site-Clipart   | Train Loss: 0.7440 | Train Acc: 0.8333
 Site-Clipart   | Train Loss: 0.7325 | Train Acc: 0.8750
 Site-Clipart   | Train Loss: 0.4502 | Train Acc: 0.9333
 Site-Clipart   | Train Loss: 0.4699 | Train Acc: 0.9861
 Site-Infograph | Train Loss: 1.8990 | Train Acc: 0.2903
 Site-Infograph | Train Loss: 1.3036 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.8872 | Train Acc: 0.7766
 Site-Painting  | Train Loss: 0.5479 | Train Acc: 0.9322
 Site-QuickDraw | Train Loss: 2.0805 | Train Acc: 0.3125
 Site-Real      | Train Loss: 0.5113 | Train Acc: 0.8947
 Site-Sketch    | Train Loss: 0.6988 | Train Acc: 0.8286
 Site-Clipart   | Val  Loss: 0.4668 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.3152 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.5184 | Val  Acc: 0.9167
 Site-Clipart   | Val  Loss: 0.5781 | Val  Acc: 0.8750
 Site-Clipart   | Val  Loss: 0.5470 | Val  Acc: 0.9000
 Site-Clipart   | Val  Loss: 0.6939 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 0.8128 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 0.9546 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 1.1034 | Val  Acc: 0.7143
 Site-Painting  | Val  Loss: 0.6467 | Val  Acc: 0.8718
 Site-QuickDraw | Val  Loss: 1.9875 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 0.6401 | Val  Acc: 0.9200
 Site-Sketch    | Val  Loss: 0.8922 | Val  Acc: 0.7826
Average Valid Accuracy: 0.8135
===2023-04-10 01:34:30===
===2023-04-10 01:34:32===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:27 | Test Acc: 0.8270
 Test site-Infograph | Epoch:27 | Test Acc: 0.4947
 Test site-Painting  | Epoch:27 | Test Acc: 0.8320
 Test site-QuickDraw | Epoch:27 | Test Acc: 0.3430
 Test site-Real      | Epoch:27 | Test Acc: 0.9006
 Test site-Sketch    | Epoch:27 | Test Acc: 0.7834
Average Test Accuracy: 0.6968
===2023-04-12 00:48:20===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 1
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
data_number=[12,24,36,48,60,72,31,63,94,59,32,38,35,]
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:27 | Test Acc: 0.8270
 Test site-Infograph | Epoch:27 | Test Acc: 0.4901
 Test site-Painting  | Epoch:27 | Test Acc: 0.8271
 Test site-QuickDraw | Epoch:27 | Test Acc: 0.3450
 Test site-Real      | Epoch:27 | Test Acc: 0.8998
 Test site-Sketch    | Epoch:27 | Test Acc: 0.7816
Average Test Accuracy: 0.6951
