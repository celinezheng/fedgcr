cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.6835 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.5279 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.7747 | Train Acc: 0.8133
 Site-Clipart                   (2) | Train Loss: 0.6336 | Train Acc: 0.8544
 Site-Clipart                   (2) | Train Loss: 0.7042 | Train Acc: 0.8281
 Site-Real                      (0) | Train Loss: 0.5367 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.4321 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.4421 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.5030 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.7125 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.5803 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.6292 | Train Acc: 0.8651
 Site-Sketch                    (5) | Train Loss: 0.6615 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.7178 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.3692 | Train Acc: 0.5719
 Site-Infograph                 (4) | Train Loss: 1.4545 | Train Acc: 0.5299
Average Train Accuracy: 0.8308
 Site-Clipart                   (2) | Val  Loss: 0.5548 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.6400 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.6834 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.6705 | Val  Acc: 0.8095
 Site-Clipart                   (2) | Val  Loss: 0.7430 | Val  Acc: 0.8102
 Site-Real                      (0) | Val  Loss: 0.4272 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.4595 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.4348 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.4503 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.5440 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.5665 | Val  Acc: 0.8759
 Site-Painting                  (3) | Val  Loss: 0.6375 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.6783 | Val  Acc: 0.8189
 Site-Sketch                    (5) | Val  Loss: 0.7327 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.5013 | Val  Acc: 0.5688
 Site-Infograph                 (4) | Val  Loss: 1.3941 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8337
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8421
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8095
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8102
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9212
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8759
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:12 | Val Acc: 0.8189
 Best site-Sketch                   (5)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.5688
 Best site-Infograph                (4)  | Epoch:12 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 13 ============
cnt=[1, 4, 1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (3) | Train Loss: 0.6389 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.5341 | Train Acc: 0.9006
 Site-Clipart                   (3) | Train Loss: 0.7270 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.5868 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.6529 | Train Acc: 0.8575
 Site-Real                      (1) | Train Loss: 0.5068 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.4160 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.4067 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4812 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6813 | Train Acc: 0.8163
 Site-Painting                  (4) | Train Loss: 0.6334 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.6219 | Train Acc: 0.8616
 Site-Sketch                    (5) | Train Loss: 0.6435 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.7187 | Train Acc: 0.8090
 Site-QuickDraw                 (2) | Train Loss: 1.3778 | Train Acc: 0.6055
 Site-Infograph                 (0) | Train Loss: 1.4012 | Train Acc: 0.5513
Average Train Accuracy: 0.8355
 Site-Clipart                   (3) | Val  Loss: 0.5110 | Val  Acc: 0.8553
 Site-Clipart                   (3) | Val  Loss: 0.5866 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.6285 | Val  Acc: 0.8533
 Site-Clipart                   (3) | Val  Loss: 0.5951 | Val  Acc: 0.8429
 Site-Clipart                   (3) | Val  Loss: 0.6782 | Val  Acc: 0.8339
 Site-Real                      (1) | Val  Loss: 0.4136 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.3894 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.4215 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.4592 | Val  Acc: 0.9221
 Site-Painting                  (4) | Val  Loss: 0.5310 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.6240 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.6125 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6088 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6942 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.4028 | Val  Acc: 0.6147
 Site-Infograph                 (0) | Val  Loss: 1.3616 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8439
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8553
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8879
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8533
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8429
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8339
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9221
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8646
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:13 | Val Acc: 0.6147
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.6035 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.5180 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.6481 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.5963 | Train Acc: 0.8576
 Site-Clipart                   (3) | Train Loss: 0.6415 | Train Acc: 0.8507
 Site-Real                      (1) | Train Loss: 0.4865 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.4085 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.4111 | Train Acc: 0.9194
 Site-Real                      (1) | Train Loss: 0.4615 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.6332 | Train Acc: 0.8299
 Site-Painting                  (5) | Train Loss: 0.5869 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.6145 | Train Acc: 0.8581
 Site-Sketch                    (0) | Train Loss: 0.6339 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.7658 | Train Acc: 0.8015
 Site-QuickDraw                 (2) | Train Loss: 1.3049 | Train Acc: 0.6269
 Site-Infograph                 (4) | Train Loss: 1.3620 | Train Acc: 0.5299
Average Train Accuracy: 0.8335
 Site-Clipart                   (3) | Val  Loss: 0.4965 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.5504 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.6040 | Val  Acc: 0.8400
 Site-Clipart                   (3) | Val  Loss: 0.5804 | Val  Acc: 0.8381
 Site-Clipart                   (3) | Val  Loss: 0.6674 | Val  Acc: 0.8169
 Site-Real                      (1) | Val  Loss: 0.4068 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.4056 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.4086 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.4206 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.5132 | Val  Acc: 0.8571
 Site-Painting                  (5) | Val  Loss: 0.5470 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.6082 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.6676 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.6924 | Val  Acc: 0.7697
 Site-QuickDraw                 (2) | Val  Loss: 1.3191 | Val  Acc: 0.6514
 Site-Infograph                 (4) | Val  Loss: 1.3295 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8386
============ Train epoch 15 ============
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.5584 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.5244 | Train Acc: 0.8634
 Site-Clipart                   (0) | Train Loss: 0.6490 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.5622 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.6114 | Train Acc: 0.8507
 Site-Real                      (3) | Train Loss: 0.4499 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.3961 | Train Acc: 0.9322
 Site-Real                      (3) | Train Loss: 0.3696 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4290 | Train Acc: 0.9511
 Site-Painting                  (2) | Train Loss: 0.6657 | Train Acc: 0.8299
 Site-Painting                  (2) | Train Loss: 0.5971 | Train Acc: 0.8544
 Site-Painting                  (2) | Train Loss: 0.6035 | Train Acc: 0.8651
 Site-Sketch                    (5) | Train Loss: 0.6521 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.6131 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.3189 | Train Acc: 0.6177
 Site-Infograph                 (4) | Train Loss: 1.3928 | Train Acc: 0.5299
Average Train Accuracy: 0.8353
 Site-Clipart                   (0) | Val  Loss: 0.4933 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.5526 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5417 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.5642 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.6168 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.3797 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3593 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3717 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3800 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.4845 | Val  Acc: 0.8980
 Site-Painting                  (2) | Val  Loss: 0.5525 | Val  Acc: 0.8467
 Site-Painting                  (2) | Val  Loss: 0.5384 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6036 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.6697 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.2949 | Val  Acc: 0.6606
 Site-Infograph                 (4) | Val  Loss: 1.2894 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8427
============ Train epoch 16 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.6061 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4876 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.6144 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.5509 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5705 | Train Acc: 0.8597
 Site-Real                      (3) | Train Loss: 0.4559 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3602 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3518 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4048 | Train Acc: 0.9454
 Site-Painting                  (1) | Train Loss: 0.5575 | Train Acc: 0.8503
 Site-Painting                  (1) | Train Loss: 0.6559 | Train Acc: 0.8495
 Site-Painting                  (1) | Train Loss: 0.5711 | Train Acc: 0.8512
 Site-Sketch                    (5) | Train Loss: 0.6113 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.6561 | Train Acc: 0.7978
 Site-QuickDraw                 (2) | Train Loss: 1.2222 | Train Acc: 0.6391
 Site-Infograph                 (4) | Train Loss: 1.3436 | Train Acc: 0.5470
Average Train Accuracy: 0.8352
 Site-Clipart                   (0) | Val  Loss: 0.4707 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.5470 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5701 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.5243 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.6323 | Val  Acc: 0.8034
 Site-Real                      (3) | Val  Loss: 0.3490 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3523 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3441 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.3845 | Val  Acc: 0.9481
 Site-Painting                  (1) | Val  Loss: 0.4829 | Val  Acc: 0.9082
 Site-Painting                  (1) | Val  Loss: 0.4941 | Val  Acc: 0.8759
 Site-Painting                  (1) | Val  Loss: 0.5403 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5905 | Val  Acc: 0.7953
 Site-Sketch                    (5) | Val  Loss: 0.6885 | Val  Acc: 0.7584
 Site-QuickDraw                 (2) | Val  Loss: 1.2470 | Val  Acc: 0.6330
 Site-Infograph                 (4) | Val  Loss: 1.2253 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8459
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8533
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8571
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8034
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9481
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.9082
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.8759
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.7953
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.7584
 Best site-QuickDraw                (2)  | Epoch:16 | Val Acc: 0.6330
 Best site-Infograph                (4)  | Epoch:16 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 17 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.5588 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4452 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5955 | Train Acc: 0.8578
 Site-Clipart                   (0) | Train Loss: 0.5396 | Train Acc: 0.8576
 Site-Clipart                   (0) | Train Loss: 0.5665 | Train Acc: 0.8439
 Site-Real                      (2) | Train Loss: 0.4316 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3439 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3423 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.3845 | Train Acc: 0.9454
 Site-Painting                  (3) | Train Loss: 0.6069 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.6403 | Train Acc: 0.8204
 Site-Painting                  (3) | Train Loss: 0.5315 | Train Acc: 0.8754
 Site-Sketch                    (5) | Train Loss: 0.5933 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.6071 | Train Acc: 0.7828
 Site-QuickDraw                 (1) | Train Loss: 1.1133 | Train Acc: 0.6514
 Site-Infograph                 (4) | Train Loss: 1.3066 | Train Acc: 0.5855
Average Train Accuracy: 0.8398
 Site-Clipart                   (0) | Val  Loss: 0.4389 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5005 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5430 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5136 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.5835 | Val  Acc: 0.8373
 Site-Real                      (2) | Val  Loss: 0.3482 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.3430 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.3251 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.3574 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3935 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.5039 | Val  Acc: 0.8394
 Site-Painting                  (3) | Val  Loss: 0.5298 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5862 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6664 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.2198 | Val  Acc: 0.6514
 Site-Infograph                 (4) | Val  Loss: 1.2913 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8501
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8373
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8394
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.6514
 Best site-Infograph                (4)  | Epoch:17 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (1) | Train Loss: 0.5466 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.4420 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.6014 | Train Acc: 0.8533
 Site-Clipart                   (1) | Train Loss: 0.5044 | Train Acc: 0.8481
 Site-Clipart                   (1) | Train Loss: 0.5391 | Train Acc: 0.8688
 Site-Real                      (2) | Train Loss: 0.4051 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.3190 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.3406 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.3904 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.6561 | Train Acc: 0.8231
 Site-Painting                  (4) | Train Loss: 0.5721 | Train Acc: 0.8592
 Site-Painting                  (4) | Train Loss: 0.5194 | Train Acc: 0.8547
 Site-Sketch                    (5) | Train Loss: 0.5809 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5988 | Train Acc: 0.8165
 Site-QuickDraw                 (0) | Train Loss: 1.0727 | Train Acc: 0.6789
 Site-Infograph                 (3) | Train Loss: 1.2690 | Train Acc: 0.5897
Average Train Accuracy: 0.8458
 Site-Clipart                   (1) | Val  Loss: 0.4264 | Val  Acc: 0.8684
 Site-Clipart                   (1) | Val  Loss: 0.4465 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.4999 | Val  Acc: 0.8533
 Site-Clipart                   (1) | Val  Loss: 0.5028 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.5783 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.3288 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3419 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.3238 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.3406 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.4209 | Val  Acc: 0.8980
 Site-Painting                  (4) | Val  Loss: 0.4651 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.5253 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.5675 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6205 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 1.1823 | Val  Acc: 0.6789
 Site-Infograph                 (3) | Val  Loss: 1.2455 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8532
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8684
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.9065
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8533
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8980
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8613
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8146
 Best site-QuickDraw                (0)  | Epoch:18 | Val Acc: 0.6789
 Best site-Infograph                (3)  | Epoch:18 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 19 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.5667 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4280 | Train Acc: 0.8882
 Site-Clipart                   (0) | Train Loss: 0.5831 | Train Acc: 0.8267
 Site-Clipart                   (0) | Train Loss: 0.5064 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.5377 | Train Acc: 0.8597
 Site-Real                      (1) | Train Loss: 0.3914 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3155 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.3137 | Train Acc: 0.9355
 Site-Real                      (1) | Train Loss: 0.3837 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.6365 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.5222 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4847 | Train Acc: 0.8720
 Site-Sketch                    (5) | Train Loss: 0.5929 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.5332 | Train Acc: 0.8315
 Site-QuickDraw                 (3) | Train Loss: 1.0646 | Train Acc: 0.6789
 Site-Infograph                 (2) | Train Loss: 1.2581 | Train Acc: 0.5812
Average Train Accuracy: 0.8462
 Site-Clipart                   (0) | Val  Loss: 0.4376 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4706 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.4916 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4979 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.5625 | Val  Acc: 0.8644
 Site-Real                      (1) | Val  Loss: 0.3017 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2885 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.3368 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3471 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.4337 | Val  Acc: 0.8878
 Site-Painting                  (4) | Val  Loss: 0.4483 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.5132 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.5768 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6468 | Val  Acc: 0.7809
 Site-QuickDraw                 (3) | Val  Loss: 1.1678 | Val  Acc: 0.6835
 Site-Infograph                 (2) | Val  Loss: 1.2391 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8567
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8421
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8879
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8644
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8878
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.7809
 Best site-QuickDraw                (3)  | Epoch:19 | Val Acc: 0.6835
 Best site-Infograph                (2)  | Epoch:19 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:19 | Test Acc: 0.8688
 Test site-Real                      (1)| Epoch:19 | Test Acc: 0.9425
 Test site-Painting                  (4)| Epoch:19 | Test Acc: 0.9079
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8682
 Test site-QuickDraw                 (3)| Epoch:19 | Test Acc: 0.6770
 Test site-Infograph                 (2)| Epoch:19 | Test Acc: 0.5419
Clipart: 0.8688, Real: 0.9425, Painting: 0.9079, Sketch: 0.8682, QuickDraw: 0.6770, Infograph: 0.5419, 
Average Test Accuracy(group): 0.8011, Average Test Accuracy(individual): 0.8621,
domain std=0.1432, cluster std=0.1432, individual std=0.1029, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 20 ============
cnt=[3, 5, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (1) | Train Loss: 0.5095 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.4052 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.5399 | Train Acc: 0.8667
 Site-Clipart                   (1) | Train Loss: 0.5099 | Train Acc: 0.8544
 Site-Clipart                   (1) | Train Loss: 0.5295 | Train Acc: 0.8552
 Site-Real                      (4) | Train Loss: 0.3936 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.3171 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3013 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.3631 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.4717 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.5833 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.4733 | Train Acc: 0.9135
 Site-Sketch                    (3) | Train Loss: 0.5315 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.5481 | Train Acc: 0.8240
 Site-QuickDraw                 (2) | Train Loss: 1.0282 | Train Acc: 0.6942
 Site-Infograph                 (5) | Train Loss: 1.2169 | Train Acc: 0.5940
Average Train Accuracy: 0.8557
 Site-Clipart                   (1) | Val  Loss: 0.3863 | Val  Acc: 0.8684
 Site-Clipart                   (1) | Val  Loss: 0.4166 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.5067 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.5119 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.5699 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.3230 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.3011 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.3217 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.3201 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3976 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4305 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.4862 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.4911 | Val  Acc: 0.8504
 Site-Sketch                    (3) | Val  Loss: 0.5790 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 1.1404 | Val  Acc: 0.6835
 Site-Infograph                 (5) | Val  Loss: 1.1422 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8591
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8684
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.9065
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8476
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9394
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8759
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.8504
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.8090
 Best site-QuickDraw                (2)  | Epoch:20 | Val Acc: 0.6835
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 21 ============
===2023-06-25 14:09:43===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (0) | Train Loss: 0.4478 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.4295 | Train Acc: 0.9193
cnt=[4, 5, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-Clipart                   (0) | Train Loss: 0.5421 | Train Acc: 0.8489
 Site-Clipart                   (1) | Train Loss: 2.1117 | Train Acc: 0.3304
 Site-Clipart                   (1) | Train Loss: 2.0673 | Train Acc: 0.3602
 Site-Clipart                   (0) | Train Loss: 0.4750 | Train Acc: 0.8766
 Site-Clipart                   (1) | Train Loss: 2.1178 | Train Acc: 0.2400
 Site-Clipart                   (1) | Train Loss: 2.0848 | Train Acc: 0.3101
 Site-Clipart                   (0) | Train Loss: 0.4924 | Train Acc: 0.8710
 Site-Real                      (1) | Train Loss: 0.3956 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2956 | Train Acc: 0.9661
 Site-Clipart                   (1) | Train Loss: 2.1006 | Train Acc: 0.2986
 Site-Real                      (0) | Train Loss: 2.0889 | Train Acc: 0.3651
 Site-Real                      (1) | Train Loss: 0.2806 | Train Acc: 0.9435
 Site-Real                      (0) | Train Loss: 2.0576 | Train Acc: 0.4124
 Site-Real                      (0) | Train Loss: 2.0425 | Train Acc: 0.4073
 Site-Real                      (1) | Train Loss: 0.3201 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.5065 | Train Acc: 0.8571
 Site-Real                      (0) | Train Loss: 2.0840 | Train Acc: 0.3132
 Site-Painting                  (4) | Train Loss: 0.4570 | Train Acc: 0.8738
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3061
 Site-Painting                  (5) | Train Loss: 2.0955 | Train Acc: 0.3204
 Site-Painting                  (4) | Train Loss: 0.4339 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5532 | Train Acc: 0.8325
 Site-Painting                  (5) | Train Loss: 2.0697 | Train Acc: 0.3322
 Site-Sketch                    (4) | Train Loss: 2.0506 | Train Acc: 0.3560
 Site-Sketch                    (5) | Train Loss: 0.5217 | Train Acc: 0.8427
 Site-Sketch                    (4) | Train Loss: 2.1015 | Train Acc: 0.3258
 Site-QuickDraw                 (2) | Train Loss: 1.0620 | Train Acc: 0.6789
 Site-QuickDraw                 (2) | Train Loss: 2.3122 | Train Acc: 0.1560
 Site-Infograph                 (3) | Train Loss: 1.1648 | Train Acc: 0.6325
Average Train Accuracy: 0.8602
 Site-Clipart                   (0) | Val  Loss: 0.4073 | Val  Acc: 0.8947
 Site-Infograph                 (3) | Train Loss: 2.2644 | Train Acc: 0.1795
Average Train Accuracy: 0.3133
 Site-Clipart                   (1) | Val  Loss: 2.0332 | Val  Acc: 0.2368
 Site-Clipart                   (0) | Val  Loss: 0.4443 | Val  Acc: 0.8972
 Site-Clipart                   (1) | Val  Loss: 2.0641 | Val  Acc: 0.3271
 Site-Clipart                   (0) | Val  Loss: 0.4854 | Val  Acc: 0.8867
 Site-Clipart                   (1) | Val  Loss: 2.0737 | Val  Acc: 0.3200
 Site-Clipart                   (0) | Val  Loss: 0.4687 | Val  Acc: 0.8714
 Site-Clipart                   (1) | Val  Loss: 2.0718 | Val  Acc: 0.3476
 Site-Clipart                   (0) | Val  Loss: 0.5664 | Val  Acc: 0.8373
 Site-Clipart                   (1) | Val  Loss: 2.1096 | Val  Acc: 0.2542
 Site-Real                      (1) | Val  Loss: 0.2942 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 2.0446 | Val  Acc: 0.4048
 Site-Real                      (1) | Val  Loss: 0.3160 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 2.0548 | Val  Acc: 0.3729
 Site-Real                      (1) | Val  Loss: 0.3132 | Val  Acc: 0.9152
 Site-Real                      (0) | Val  Loss: 2.0184 | Val  Acc: 0.3879
 Site-Real                      (1) | Val  Loss: 0.3213 | Val  Acc: 0.9437
 Site-Real                      (0) | Val  Loss: 2.0560 | Val  Acc: 0.3636
 Site-Painting                  (4) | Val  Loss: 0.4147 | Val  Acc: 0.8776
 Site-Painting                  (5) | Val  Loss: 2.0635 | Val  Acc: 0.4082
 Site-Painting                  (5) | Val  Loss: 2.0362 | Val  Acc: 0.3431
 Site-Painting                  (4) | Val  Loss: 0.4792 | Val  Acc: 0.8540
 Site-Painting                  (5) | Val  Loss: 2.1192 | Val  Acc: 0.3438
 Site-Painting                  (4) | Val  Loss: 0.4785 | Val  Acc: 0.8750
 Site-Sketch                    (4) | Val  Loss: 2.0892 | Val  Acc: 0.3622
 Site-Sketch                    (5) | Val  Loss: 0.5392 | Val  Acc: 0.8583
 Site-Sketch                    (4) | Val  Loss: 2.0841 | Val  Acc: 0.3596
 Site-Sketch                    (5) | Val  Loss: 0.5974 | Val  Acc: 0.7978
 Site-QuickDraw                 (2) | Val  Loss: 2.3454 | Val  Acc: 0.1697
 Site-QuickDraw                 (2) | Val  Loss: 1.0819 | Val  Acc: 0.7064
 Site-Infograph                 (3) | Val  Loss: 2.2659 | Val  Acc: 0.2051
Average Valid Accuracy: 0.3254
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2368
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3271
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3200
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.3476
 Best site-Clipart                  (1)  | Epoch:0 | Val Acc: 0.2542
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.4048
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3729
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3879
 Best site-Real                     (0)  | Epoch:0 | Val Acc: 0.3636
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.4082
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3431
 Best site-Painting                 (5)  | Epoch:0 | Val Acc: 0.3438
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3622
 Best site-Sketch                   (4)  | Epoch:0 | Val Acc: 0.3596
 Best site-QuickDraw                (2)  | Epoch:0 | Val Acc: 0.1697
 Best site-Infograph                (3)  | Epoch:0 | Val Acc: 0.2051
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
 Site-Infograph                 (3) | Val  Loss: 1.1646 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8609
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8714
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8373
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9152
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8776
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8540
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8750
============ Train epoch 1 ============
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.7978
 Best site-QuickDraw                (2)  | Epoch:21 | Val Acc: 0.7064
 Best site-Infograph                (3)  | Epoch:21 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 22 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-Clipart                   (0) | Train Loss: 1.9564 | Train Acc: 0.4261
 Site-Clipart                   (0) | Train Loss: 1.8780 | Train Acc: 0.5590
 Site-Clipart                   (0) | Train Loss: 1.9442 | Train Acc: 0.4756
 Site-Clipart                   (0) | Train Loss: 1.9028 | Train Acc: 0.5411
cnt=[5, 1, 2, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 1.9181 | Train Acc: 0.5136
 Site-Clipart                   (0) | Train Loss: 0.5049 | Train Acc: 0.8870
 Site-Real                      (1) | Train Loss: 1.8402 | Train Acc: 0.6032
 Site-Clipart                   (0) | Train Loss: 0.4099 | Train Acc: 0.9006
 Site-Real                      (1) | Train Loss: 1.8171 | Train Acc: 0.6441
 Site-Clipart                   (0) | Train Loss: 0.5394 | Train Acc: 0.8578
 Site-Real                      (1) | Train Loss: 1.7388 | Train Acc: 0.6976
 Site-Clipart                   (0) | Train Loss: 0.4486 | Train Acc: 0.8544
 Site-Real                      (1) | Train Loss: 1.8392 | Train Acc: 0.6006
 Site-Painting                  (3) | Train Loss: 1.8604 | Train Acc: 0.5850
 Site-Painting                  (3) | Train Loss: 1.8864 | Train Acc: 0.4951
 Site-Clipart                   (0) | Train Loss: 0.4818 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3653 | Train Acc: 0.9286
 Site-Painting                  (3) | Train Loss: 1.8268 | Train Acc: 0.5640
 Site-Real                      (3) | Train Loss: 0.2925 | Train Acc: 0.9492
 Site-Sketch                    (5) | Train Loss: 1.8919 | Train Acc: 0.5340
 Site-Real                      (3) | Train Loss: 0.2914 | Train Acc: 0.9516
 Site-Sketch                    (5) | Train Loss: 1.8959 | Train Acc: 0.5019
 Site-QuickDraw                 (2) | Train Loss: 2.2784 | Train Acc: 0.1713
 Site-Real                      (3) | Train Loss: 0.3370 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.4270 | Train Acc: 0.8776
 Site-Infograph                 (4) | Train Loss: 2.1102 | Train Acc: 0.3205
Average Train Accuracy: 0.5145
 Site-Clipart                   (0) | Val  Loss: 1.8312 | Val  Acc: 0.5132
 Site-Painting                  (5) | Train Loss: 0.4721 | Train Acc: 0.8883
 Site-Clipart                   (0) | Val  Loss: 1.8830 | Val  Acc: 0.5140
 Site-Clipart                   (0) | Val  Loss: 1.9166 | Val  Acc: 0.5400
 Site-Painting                  (5) | Train Loss: 0.4706 | Train Acc: 0.8720
 Site-Clipart                   (0) | Val  Loss: 1.9092 | Val  Acc: 0.4952
 Site-Sketch                    (2) | Train Loss: 0.5478 | Train Acc: 0.8377
 Site-Clipart                   (0) | Val  Loss: 1.9405 | Val  Acc: 0.4678
 Site-Real                      (1) | Val  Loss: 1.7780 | Val  Acc: 0.5476
 Site-Sketch                    (2) | Train Loss: 0.5853 | Train Acc: 0.8352
 Site-Real                      (1) | Val  Loss: 1.7713 | Val  Acc: 0.6864
 Site-Real                      (1) | Val  Loss: 1.7121 | Val  Acc: 0.7152
 Site-QuickDraw                 (1) | Train Loss: 0.9990 | Train Acc: 0.6820
 Site-Real                      (1) | Val  Loss: 1.7571 | Val  Acc: 0.6883
 Site-Painting                  (3) | Val  Loss: 1.8129 | Val  Acc: 0.5714
 Site-Infograph                 (4) | Train Loss: 1.2165 | Train Acc: 0.5897
Average Train Accuracy: 0.8588
 Site-Painting                  (3) | Val  Loss: 1.7804 | Val  Acc: 0.5109
 Site-Clipart                   (0) | Val  Loss: 0.3898 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4454 | Val  Acc: 0.8785
 Site-Painting                  (3) | Val  Loss: 1.8767 | Val  Acc: 0.5312
 Site-Clipart                   (0) | Val  Loss: 0.4832 | Val  Acc: 0.8867
 Site-Sketch                    (5) | Val  Loss: 1.8698 | Val  Acc: 0.5906
 Site-Sketch                    (5) | Val  Loss: 1.8906 | Val  Acc: 0.5169
 Site-Clipart                   (0) | Val  Loss: 0.4534 | Val  Acc: 0.8381
 Site-QuickDraw                 (2) | Val  Loss: 2.2739 | Val  Acc: 0.1606
 Site-Clipart                   (0) | Val  Loss: 0.5487 | Val  Acc: 0.8339
 Site-Infograph                 (4) | Val  Loss: 2.1128 | Val  Acc: 0.3077
Average Valid Accuracy: 0.5223
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5132
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5140
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.5400
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4952
 Best site-Clipart                  (0)  | Epoch:1 | Val Acc: 0.4678
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.5476
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6864
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.7152
 Best site-Real                     (1)  | Epoch:1 | Val Acc: 0.6883
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5714
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5109
 Best site-Painting                 (3)  | Epoch:1 | Val Acc: 0.5312
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5906
 Best site-Sketch                   (5)  | Epoch:1 | Val Acc: 0.5169
 Best site-QuickDraw                (2)  | Epoch:1 | Val Acc: 0.1606
 Best site-Infograph                (4)  | Epoch:1 | Val Acc: 0.3077
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 2 ============
 Site-Real                      (3) | Val  Loss: 0.3084 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3074 | Val  Acc: 0.9492
 Site-Real                      (3) | Val  Loss: 0.2972 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3266 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.3835 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.4393 | Val  Acc: 0.8759
 Site-Painting                  (5) | Val  Loss: 0.4158 | Val  Acc: 0.9010
 Site-Sketch                    (2) | Val  Loss: 0.5339 | Val  Acc: 0.8504
 Site-Sketch                    (2) | Val  Loss: 0.5948 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.0614 | Val  Acc: 0.6881
 Site-Infograph                 (4) | Val  Loss: 1.2107 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8583
============ Train epoch 23 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-Clipart                   (0) | Train Loss: 1.7692 | Train Acc: 0.5565
 Site-Clipart                   (0) | Train Loss: 1.6770 | Train Acc: 0.5901
 Site-Clipart                   (0) | Train Loss: 1.7857 | Train Acc: 0.5422
 Site-Clipart                   (0) | Train Loss: 1.7170 | Train Acc: 0.5728
 Site-Clipart                   (0) | Train Loss: 1.7443 | Train Acc: 0.5995
 Site-Real                      (1) | Train Loss: 1.5735 | Train Acc: 0.7302
 Site-Real                      (1) | Train Loss: 1.5509 | Train Acc: 0.7288
 Site-Real                      (1) | Train Loss: 1.4777 | Train Acc: 0.8105
 Site-Real                      (1) | Train Loss: 1.5989 | Train Acc: 0.7184
 Site-Painting                  (3) | Train Loss: 1.6360 | Train Acc: 0.6054
 Site-Painting                  (3) | Train Loss: 1.7041 | Train Acc: 0.5874
 Site-Painting                  (3) | Train Loss: 1.6662 | Train Acc: 0.5952
 Site-Sketch                    (5) | Train Loss: 1.7057 | Train Acc: 0.6230
cnt=[1, 4, 7, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.5205 | Train Acc: 0.8435
 Site-Sketch                    (5) | Train Loss: 1.7073 | Train Acc: 0.5805
 Site-Clipart                   (2) | Train Loss: 0.3811 | Train Acc: 0.9130
 Site-QuickDraw                 (2) | Train Loss: 2.2131 | Train Acc: 0.2569
 Site-Clipart                   (2) | Train Loss: 0.5540 | Train Acc: 0.8667
 Site-Infograph                 (4) | Train Loss: 2.1009 | Train Acc: 0.3162
Average Train Accuracy: 0.5884
 Site-Clipart                   (0) | Val  Loss: 1.5935 | Val  Acc: 0.5658
 Site-Clipart                   (2) | Train Loss: 0.4585 | Train Acc: 0.8639
 Site-Clipart                   (0) | Val  Loss: 1.7165 | Val  Acc: 0.5514
 Site-Clipart                   (0) | Val  Loss: 1.7384 | Val  Acc: 0.6000
 Site-Clipart                   (0) | Val  Loss: 1.6923 | Val  Acc: 0.5810
 Site-Clipart                   (2) | Train Loss: 0.4939 | Train Acc: 0.8710
 Site-Real                      (1) | Train Loss: 0.3716 | Train Acc: 0.9206
 Site-Clipart                   (0) | Val  Loss: 1.7699 | Val  Acc: 0.5356
 Site-Real                      (1) | Train Loss: 0.2893 | Train Acc: 0.9548
 Site-Real                      (1) | Val  Loss: 1.5126 | Val  Acc: 0.7381
 Site-Real                      (1) | Val  Loss: 1.5283 | Val  Acc: 0.7458
 Site-Real                      (1) | Val  Loss: 1.4721 | Val  Acc: 0.8061
 Site-Real                      (1) | Train Loss: 0.2921 | Train Acc: 0.9395
 Site-Real                      (1) | Val  Loss: 1.5190 | Val  Acc: 0.7792
 Site-Painting                  (3) | Val  Loss: 1.5858 | Val  Acc: 0.7041
 Site-Real                      (1) | Train Loss: 0.3435 | Train Acc: 0.9310
 Site-Painting                  (3) | Val  Loss: 1.5879 | Val  Acc: 0.5839
 Site-Painting                  (5) | Train Loss: 0.4589 | Train Acc: 0.8639
 Site-Painting                  (3) | Val  Loss: 1.6878 | Val  Acc: 0.5729
 Site-Painting                  (5) | Train Loss: 0.4311 | Train Acc: 0.8592
 Site-Sketch                    (5) | Val  Loss: 1.6988 | Val  Acc: 0.6457
 Site-Sketch                    (5) | Val  Loss: 1.7400 | Val  Acc: 0.5449
 Site-Painting                  (4) | Train Loss: 0.4596 | Train Acc: 0.8789
 Site-QuickDraw                 (2) | Val  Loss: 2.2285 | Val  Acc: 0.2339
 Site-Sketch                    (2) | Train Loss: 0.5095 | Train Acc: 0.8482
 Site-Infograph                 (4) | Val  Loss: 2.0717 | Val  Acc: 0.3397
Average Valid Accuracy: 0.5955
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5658
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5514
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.6000
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5810
 Best site-Clipart                  (0)  | Epoch:2 | Val Acc: 0.5356
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7381
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7458
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.8061
 Best site-Real                     (1)  | Epoch:2 | Val Acc: 0.7792
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.7041
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5839
 Best site-Painting                 (3)  | Epoch:2 | Val Acc: 0.5729
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.6457
 Best site-Sketch                   (5)  | Epoch:2 | Val Acc: 0.5449
 Best site-QuickDraw                (2)  | Epoch:2 | Val Acc: 0.2339
 Best site-Infograph                (4)  | Epoch:2 | Val Acc: 0.3397
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 3 ============
 Site-Sketch                    (2) | Train Loss: 0.5100 | Train Acc: 0.8240
 Site-QuickDraw                 (0) | Train Loss: 0.9108 | Train Acc: 0.7217
 Site-Infograph                 (3) | Train Loss: 1.1290 | Train Acc: 0.6325
Average Train Accuracy: 0.8583
 Site-Clipart                   (2) | Val  Loss: 0.3771 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.3992 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.4582 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.4325 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5315 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.3087 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2771 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2669 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.3139 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3359 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3933 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.4685 | Val  Acc: 0.8906
 Site-Sketch                    (2) | Val  Loss: 0.5392 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5305 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 1.0164 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 1.1443 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8736
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8553
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8533
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8441
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:23 | Val Acc: 0.8906
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:23 | Val Acc: 0.7569
 Best site-Infograph                (3)  | Epoch:23 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 24 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-Clipart                   (0) | Train Loss: 1.5908 | Train Acc: 0.6000
 Site-Clipart                   (0) | Train Loss: 1.4758 | Train Acc: 0.6894
 Site-Clipart                   (0) | Train Loss: 1.6302 | Train Acc: 0.6089
 Site-Clipart                   (0) | Train Loss: 1.5304 | Train Acc: 0.6835
 Site-Clipart                   (0) | Train Loss: 1.5744 | Train Acc: 0.6448
 Site-Real                      (1) | Train Loss: 1.3871 | Train Acc: 0.8413
 Site-Real                      (1) | Train Loss: 1.2947 | Train Acc: 0.8418
 Site-Real                      (1) | Train Loss: 1.2712 | Train Acc: 0.8468
 Site-Real                      (1) | Train Loss: 1.3697 | Train Acc: 0.8420
 Site-Painting                  (3) | Train Loss: 1.4412 | Train Acc: 0.7075
 Site-Painting                  (3) | Train Loss: 1.4900 | Train Acc: 0.7233
 Site-Painting                  (3) | Train Loss: 1.4639 | Train Acc: 0.7059
 Site-Sketch                    (5) | Train Loss: 1.4690 | Train Acc: 0.6963
 Site-Sketch                    (5) | Train Loss: 1.5567 | Train Acc: 0.6742
 Site-QuickDraw                 (2) | Train Loss: 2.1137 | Train Acc: 0.2661
 Site-Infograph                 (4) | Train Loss: 2.0164 | Train Acc: 0.3462
Average Train Accuracy: 0.6699
 Site-Clipart                   (0) | Val  Loss: 1.4383 | Val  Acc: 0.6579
 Site-Clipart                   (0) | Val  Loss: 1.5082 | Val  Acc: 0.6449
 Site-Clipart                   (0) | Val  Loss: 1.5398 | Val  Acc: 0.6800
 Site-Clipart                   (0) | Val  Loss: 1.4921 | Val  Acc: 0.6476
 Site-Clipart                   (0) | Val  Loss: 1.6122 | Val  Acc: 0.5864
 Site-Real                      (1) | Val  Loss: 1.3011 | Val  Acc: 0.8333
 Site-Real                      (1) | Val  Loss: 1.3380 | Val  Acc: 0.8220
cnt=[2, 3, 1, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Real                      (1) | Val  Loss: 1.2478 | Val  Acc: 0.8606
 Site-Clipart                   (4) | Train Loss: 0.4368 | Train Acc: 0.8696
 Site-Real                      (1) | Val  Loss: 1.3036 | Val  Acc: 0.8528
 Site-Clipart                   (4) | Train Loss: 0.3870 | Train Acc: 0.9130
 Site-Painting                  (3) | Val  Loss: 1.4069 | Val  Acc: 0.7755
 Site-Painting                  (3) | Val  Loss: 1.4009 | Val  Acc: 0.6861
 Site-Clipart                   (4) | Train Loss: 0.5589 | Train Acc: 0.8578
 Site-Painting                  (3) | Val  Loss: 1.4662 | Val  Acc: 0.6875
 Site-Sketch                    (5) | Val  Loss: 1.5186 | Val  Acc: 0.6772
 Site-Clipart                   (4) | Train Loss: 0.4244 | Train Acc: 0.8956
 Site-Sketch                    (5) | Val  Loss: 1.5558 | Val  Acc: 0.6404
 Site-QuickDraw                 (2) | Val  Loss: 2.1540 | Val  Acc: 0.2890
 Site-Clipart                   (4) | Train Loss: 0.4764 | Train Acc: 0.8710
 Site-Infograph                 (4) | Val  Loss: 1.9531 | Val  Acc: 0.4231
Average Valid Accuracy: 0.6728
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6579
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6449
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6800
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.6476
 Best site-Clipart                  (0)  | Epoch:3 | Val Acc: 0.5864
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8333
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8220
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8606
 Best site-Real                     (1)  | Epoch:3 | Val Acc: 0.8528
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.7755
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6861
 Best site-Painting                 (3)  | Epoch:3 | Val Acc: 0.6875
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6772
 Best site-Sketch                   (5)  | Epoch:3 | Val Acc: 0.6404
 Best site-QuickDraw                (2)  | Epoch:3 | Val Acc: 0.2890
 Best site-Infograph                (4)  | Epoch:3 | Val Acc: 0.4231
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 4 ============
 Site-Real                      (3) | Train Loss: 0.3983 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2709 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2903 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3216 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.5557 | Train Acc: 0.8639
 Site-Painting                  (1) | Train Loss: 0.4227 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.4673 | Train Acc: 0.8789
 Site-Sketch                    (0) | Train Loss: 0.5130 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.5552 | Train Acc: 0.8090
 Site-QuickDraw                 (2) | Train Loss: 1.0168 | Train Acc: 0.7217
 Site-Infograph                 (5) | Train Loss: 1.1416 | Train Acc: 0.6282
Average Train Accuracy: 0.8623
 Site-Clipart                   (4) | Val  Loss: 0.3981 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4389 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.4309 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.4672 | Val  Acc: 0.8429
 Site-Clipart                   (4) | Val  Loss: 0.5326 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2960 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2902 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2749 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2994 | Val  Acc: 0.9351
 Site-Painting                  (1) | Val  Loss: 0.3700 | Val  Acc: 0.9082
 Site-Painting                  (1) | Val  Loss: 0.4213 | Val  Acc: 0.8978
 Site-Painting                  (1) | Val  Loss: 0.4485 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.4452 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5693 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 1.0353 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 1.1473 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8657
============ Train epoch 25 ============
cnt=[5, 3, 1, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-Clipart                   (0) | Train Loss: 1.3729 | Train Acc: 0.7304
 Site-Clipart                   (0) | Train Loss: 1.3493 | Train Acc: 0.7019
 Site-Clipart                   (0) | Train Loss: 1.4475 | Train Acc: 0.7244
 Site-Clipart                   (0) | Train Loss: 1.3727 | Train Acc: 0.7373
 Site-Clipart                   (0) | Train Loss: 1.4009 | Train Acc: 0.7308
 Site-Real                      (4) | Train Loss: 1.2153 | Train Acc: 0.8413
 Site-Real                      (4) | Train Loss: 1.1251 | Train Acc: 0.8757
 Site-Real                      (4) | Train Loss: 1.0815 | Train Acc: 0.8911
 Site-Real                      (4) | Train Loss: 1.2292 | Train Acc: 0.8506
 Site-Painting                  (1) | Train Loss: 1.2382 | Train Acc: 0.7279
 Site-Painting                  (1) | Train Loss: 1.3038 | Train Acc: 0.7427
 Site-Painting                  (1) | Train Loss: 1.2808 | Train Acc: 0.7578
 Site-Sketch                    (5) | Train Loss: 1.3517 | Train Acc: 0.7068
 Site-Sketch                    (5) | Train Loss: 1.4526 | Train Acc: 0.6779
 Site-QuickDraw                 (2) | Train Loss: 2.0310 | Train Acc: 0.2691
 Site-Infograph                 (3) | Train Loss: 1.9182 | Train Acc: 0.4060
Average Train Accuracy: 0.7107
 Site-Clipart                   (0) | Val  Loss: 1.2114 | Val  Acc: 0.7500
 Site-Clipart                   (0) | Val  Loss: 1.3341 | Val  Acc: 0.7664
 Site-Clipart                   (0) | Val  Loss: 1.3764 | Val  Acc: 0.7267
 Site-Clipart                   (0) | Val  Loss: 1.3237 | Val  Acc: 0.7143
 Site-Clipart                   (0) | Val  Loss: 1.4519 | Val  Acc: 0.6780
 Site-Real                      (4) | Val  Loss: 1.1241 | Val  Acc: 0.8452
 Site-Real                      (4) | Val  Loss: 1.1218 | Val  Acc: 0.8220
 Site-Real                      (4) | Val  Loss: 1.0694 | Val  Acc: 0.8545
 Site-Real                      (4) | Val  Loss: 1.1039 | Val  Acc: 0.8658
 Site-Painting                  (1) | Val  Loss: 1.1846 | Val  Acc: 0.8061
 Site-Painting                  (1) | Val  Loss: 1.2541 | Val  Acc: 0.7664
 Site-Painting                  (1) | Val  Loss: 1.3153 | Val  Acc: 0.7552
 Site-Sketch                    (5) | Val  Loss: 1.3056 | Val  Acc: 0.7638
 Site-Sketch                    (5) | Val  Loss: 1.3843 | Val  Acc: 0.6910
 Site-QuickDraw                 (2) | Val  Loss: 2.0824 | Val  Acc: 0.2890
 Site-Infograph                 (3) | Val  Loss: 1.8995 | Val  Acc: 0.4423
Average Valid Accuracy: 0.7210
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7664
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7267
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.7143
 Best site-Clipart                  (0)  | Epoch:4 | Val Acc: 0.6780
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8452
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8220
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8545
 Best site-Real                     (4)  | Epoch:4 | Val Acc: 0.8658
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.8061
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7664
 Best site-Painting                 (1)  | Epoch:4 | Val Acc: 0.7552
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.7638
 Best site-Sketch                   (5)  | Epoch:4 | Val Acc: 0.6910
 Best site-QuickDraw                (2)  | Epoch:4 | Val Acc: 0.2890
 Best site-Infograph                (3)  | Epoch:4 | Val Acc: 0.4423
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 5 ============
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (1) | Train Loss: 0.4607 | Train Acc: 0.8783
 Site-Clipart                   (1) | Train Loss: 0.3644 | Train Acc: 0.9193
 Site-Clipart                   (1) | Train Loss: 0.5010 | Train Acc: 0.8711
 Site-Clipart                   (1) | Train Loss: 0.4698 | Train Acc: 0.8576
 Site-Clipart                   (1) | Train Loss: 0.4586 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3859 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2507 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2655 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3001 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.4976 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.3939 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4158 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.5237 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.4711 | Train Acc: 0.8390
 Site-QuickDraw                 (2) | Train Loss: 0.9672 | Train Acc: 0.7462
 Site-Infograph                 (0) | Train Loss: 1.1433 | Train Acc: 0.6197
Average Train Accuracy: 0.8655
 Site-Clipart                   (1) | Val  Loss: 0.3596 | Val  Acc: 0.8553
 Site-Clipart                   (1) | Val  Loss: 0.4022 | Val  Acc: 0.8972
 Site-Clipart                   (1) | Val  Loss: 0.4103 | Val  Acc: 0.9067
 Site-Clipart                   (1) | Val  Loss: 0.4304 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.5163 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2796 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2755 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2636 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3120 | Val  Acc: 0.9351
 Site-Painting                  (4) | Val  Loss: 0.2997 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3963 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.4102 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4747 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5544 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 1.0887 | Val  Acc: 0.7064
 Site-Infograph                 (0) | Val  Loss: 1.0836 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8706
============ Train epoch 26 ============
cnt=[2, 1, 4, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-Clipart                   (3) | Train Loss: 1.2503 | Train Acc: 0.7478
 Site-Clipart                   (3) | Train Loss: 1.1715 | Train Acc: 0.7640
 Site-Clipart                   (3) | Train Loss: 1.3221 | Train Acc: 0.7200
 Site-Clipart                   (3) | Train Loss: 1.2028 | Train Acc: 0.7532
 Site-Clipart                   (3) | Train Loss: 1.2377 | Train Acc: 0.7511
 Site-Real                      (2) | Train Loss: 1.0711 | Train Acc: 0.8730
 Site-Real                      (2) | Train Loss: 0.9606 | Train Acc: 0.8701
 Site-Real                      (2) | Train Loss: 0.9283 | Train Acc: 0.8952
 Site-Real                      (2) | Train Loss: 1.0591 | Train Acc: 0.8649
 Site-Painting                  (5) | Train Loss: 1.2571 | Train Acc: 0.7823
 Site-Painting                  (5) | Train Loss: 1.2018 | Train Acc: 0.7621
 Site-Painting                  (5) | Train Loss: 1.1403 | Train Acc: 0.7855
 Site-Sketch                    (0) | Train Loss: 1.1695 | Train Acc: 0.7435
 Site-Sketch                    (0) | Train Loss: 1.2876 | Train Acc: 0.7154
 Site-QuickDraw                 (1) | Train Loss: 1.9978 | Train Acc: 0.2691
 Site-Infograph                 (4) | Train Loss: 1.8120 | Train Acc: 0.4316
Average Train Accuracy: 0.7330
 Site-Clipart                   (3) | Val  Loss: 1.0952 | Val  Acc: 0.7895
 Site-Clipart                   (3) | Val  Loss: 1.2035 | Val  Acc: 0.7757
 Site-Clipart                   (3) | Val  Loss: 1.2008 | Val  Acc: 0.7667
 Site-Clipart                   (3) | Val  Loss: 1.1779 | Val  Acc: 0.7476
 Site-Clipart                   (3) | Val  Loss: 1.2825 | Val  Acc: 0.7322
 Site-Real                      (2) | Val  Loss: 0.9617 | Val  Acc: 0.8452
 Site-Real                      (2) | Val  Loss: 0.9782 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.9067 | Val  Acc: 0.8848
 Site-Real                      (2) | Val  Loss: 0.9576 | Val  Acc: 0.9004
 Site-Painting                  (5) | Val  Loss: 1.0348 | Val  Acc: 0.8469
 Site-Painting                  (5) | Val  Loss: 1.0865 | Val  Acc: 0.7883
 Site-Painting                  (5) | Val  Loss: 1.1362 | Val  Acc: 0.7969
 Site-Sketch                    (0) | Val  Loss: 1.2249 | Val  Acc: 0.7008
 Site-Sketch                    (0) | Val  Loss: 1.2711 | Val  Acc: 0.6854
 Site-QuickDraw                 (1) | Val  Loss: 2.0478 | Val  Acc: 0.2936
 Site-Infograph                 (4) | Val  Loss: 1.7849 | Val  Acc: 0.4487
Average Valid Accuracy: 0.7406
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7895
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7757
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7667
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7476
 Best site-Clipart                  (3)  | Epoch:5 | Val Acc: 0.7322
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8452
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.8848
 Best site-Real                     (2)  | Epoch:5 | Val Acc: 0.9004
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.8469
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7883
 Best site-Painting                 (5)  | Epoch:5 | Val Acc: 0.7969
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.7008
 Best site-Sketch                   (0)  | Epoch:5 | Val Acc: 0.6854
 Best site-QuickDraw                (1)  | Epoch:5 | Val Acc: 0.2936
 Best site-Infograph                (4)  | Epoch:5 | Val Acc: 0.4487
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (1) | Train Loss: 0.4735 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.3499 | Train Acc: 0.9503
 Site-Clipart                   (1) | Train Loss: 0.5067 | Train Acc: 0.8489
 Site-Clipart                   (1) | Train Loss: 0.4597 | Train Acc: 0.8544
 Site-Clipart                   (1) | Train Loss: 0.4543 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3493 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2755 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2658 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3152 | Train Acc: 0.9368
 Site-Painting                  (0) | Train Loss: 0.4315 | Train Acc: 0.8844
 Site-Painting                  (0) | Train Loss: 0.3865 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.4064 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5056 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.5015 | Train Acc: 0.8464
 Site-QuickDraw                 (2) | Train Loss: 0.9192 | Train Acc: 0.7431
 Site-Infograph                 (4) | Train Loss: 1.0942 | Train Acc: 0.6496
Average Train Accuracy: 0.8708
 Site-Clipart                   (1) | Val  Loss: 0.3415 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.3976 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.4276 | Val  Acc: 0.9067
 Site-Clipart                   (1) | Val  Loss: 0.4193 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.4890 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2921 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2937 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.3051 | Val  Acc: 0.9273
 Site-Real                      (3) | Val  Loss: 0.2935 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.3257 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.3811 | Val  Acc: 0.9197
 Site-Painting                  (0) | Val  Loss: 0.4596 | Val  Acc: 0.8802
 Site-Sketch                    (5) | Val  Loss: 0.4991 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5456 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 1.0002 | Val  Acc: 0.7385
 Site-Infograph                 (4) | Val  Loss: 1.1251 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8746
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.9342
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.9065
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.9067
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:26 | Val Acc: 0.8542
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9405
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9407
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9273
 Best site-Real                     (3)  | Epoch:26 | Val Acc: 0.9567
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.9197
 Best site-Painting                 (0)  | Epoch:26 | Val Acc: 0.8802
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:26 | Val Acc: 0.8090
 Best site-QuickDraw                (2)  | Epoch:26 | Val Acc: 0.7385
 Best site-Infograph                (4)  | Epoch:26 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 27 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-Clipart                   (0) | Train Loss: 1.1119 | Train Acc: 0.7478
 Site-Clipart                   (0) | Train Loss: 1.0413 | Train Acc: 0.7640
 Site-Clipart                   (0) | Train Loss: 1.1814 | Train Acc: 0.7822
 Site-Clipart                   (0) | Train Loss: 1.0527 | Train Acc: 0.8101
 Site-Clipart                   (0) | Train Loss: 1.1116 | Train Acc: 0.7873
 Site-Real                      (1) | Train Loss: 0.9440 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.8488 | Train Acc: 0.8927
 Site-Real                      (1) | Train Loss: 0.8186 | Train Acc: 0.9113
 Site-Real                      (1) | Train Loss: 0.9198 | Train Acc: 0.8879
 Site-Painting                  (3) | Train Loss: 1.0618 | Train Acc: 0.7891
 Site-Painting                  (3) | Train Loss: 1.0341 | Train Acc: 0.8155
 Site-Painting                  (3) | Train Loss: 0.9896 | Train Acc: 0.8270
 Site-Sketch                    (5) | Train Loss: 1.0922 | Train Acc: 0.7277
 Site-Sketch                    (5) | Train Loss: 1.1242 | Train Acc: 0.7453
 Site-QuickDraw                 (2) | Train Loss: 1.9461 | Train Acc: 0.3333
 Site-Infograph                 (4) | Train Loss: 1.7828 | Train Acc: 0.4316
Average Train Accuracy: 0.7594
 Site-Clipart                   (0) | Val  Loss: 0.9886 | Val  Acc: 0.7763
 Site-Clipart                   (0) | Val  Loss: 1.0951 | Val  Acc: 0.7664
 Site-Clipart                   (0) | Val  Loss: 1.0393 | Val  Acc: 0.8133
 Site-Clipart                   (0) | Val  Loss: 1.0543 | Val  Acc: 0.7619
 Site-Clipart                   (0) | Val  Loss: 1.1922 | Val  Acc: 0.7492
 Site-Real                      (1) | Val  Loss: 0.8365 | Val  Acc: 0.9048
 Site-Real                      (1) | Val  Loss: 0.8450 | Val  Acc: 0.8898
 Site-Real                      (1) | Val  Loss: 0.7813 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.8366 | Val  Acc: 0.9048
 Site-Painting                  (3) | Val  Loss: 0.8984 | Val  Acc: 0.8673
 Site-Painting                  (3) | Val  Loss: 0.9863 | Val  Acc: 0.7737
 Site-Painting                  (3) | Val  Loss: 1.0204 | Val  Acc: 0.8281
 Site-Sketch                    (5) | Val  Loss: 1.0756 | Val  Acc: 0.7638
 Site-Sketch                    (5) | Val  Loss: 1.1174 | Val  Acc: 0.7191
 Site-QuickDraw                 (2) | Val  Loss: 1.9763 | Val  Acc: 0.3349
 Site-Infograph                 (4) | Val  Loss: 1.7142 | Val  Acc: 0.4679
Average Valid Accuracy: 0.7644
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7763
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7664
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.8133
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7619
 Best site-Clipart                  (0)  | Epoch:6 | Val Acc: 0.7492
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9048
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.8898
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9091
 Best site-Real                     (1)  | Epoch:6 | Val Acc: 0.9048
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8673
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.7737
 Best site-Painting                 (3)  | Epoch:6 | Val Acc: 0.8281
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7638
 Best site-Sketch                   (5)  | Epoch:6 | Val Acc: 0.7191
 Best site-QuickDraw                (2)  | Epoch:6 | Val Acc: 0.3349
 Best site-Infograph                (4)  | Epoch:6 | Val Acc: 0.4679
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 7 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-Clipart                   (0) | Train Loss: 0.4626 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3282 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4679 | Train Acc: 0.8978
 Site-Clipart                   (0) | Train Loss: 0.4362 | Train Acc: 0.8703
 Site-Clipart                   (0) | Train Loss: 0.4429 | Train Acc: 0.8801
 Site-Real                      (1) | Train Loss: 0.3690 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2753 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.2617 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.3444 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.4954 | Train Acc: 0.8912
 Site-Painting                  (4) | Train Loss: 0.4512 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.4475 | Train Acc: 0.8927
 Site-Sketch                    (5) | Train Loss: 0.4652 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4831 | Train Acc: 0.8502
 Site-QuickDraw                 (2) | Train Loss: 0.8744 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 1.1234 | Train Acc: 0.6282
Average Train Accuracy: 0.8720
 Site-Clipart                   (0) | Val  Loss: 0.3691 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.4033 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3757 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4185 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4985 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.2725 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2844 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.2839 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.2889 | Val  Acc: 0.9481
 Site-Painting                  (4) | Val  Loss: 0.3510 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.4036 | Val  Acc: 0.8832
 Site-Painting                  (4) | Val  Loss: 0.4474 | Val  Acc: 0.8854
 Site-Sketch                    (5) | Val  Loss: 0.4114 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4892 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.9549 | Val  Acc: 0.7339
 Site-Infograph                 (3) | Val  Loss: 1.0766 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8717
============ Train epoch 28 ============
cnt=[2, 5, 1, 1, 2, 5, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-Clipart                   (1) | Train Loss: 0.9502 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.9278 | Train Acc: 0.7888
 Site-Clipart                   (1) | Train Loss: 1.0899 | Train Acc: 0.7467
 Site-Clipart                   (1) | Train Loss: 0.9655 | Train Acc: 0.8070
 Site-Clipart                   (1) | Train Loss: 0.9967 | Train Acc: 0.7941
 Site-Real                      (0) | Train Loss: 0.8309 | Train Acc: 0.9127
 Site-Real                      (5) | Train Loss: 0.7208 | Train Acc: 0.9266
 Site-Real                      (5) | Train Loss: 0.7152 | Train Acc: 0.9194
 Site-Real                      (5) | Train Loss: 0.8163 | Train Acc: 0.9195
 Site-Painting                  (0) | Train Loss: 0.9112 | Train Acc: 0.8027
 Site-Painting                  (5) | Train Loss: 1.0220 | Train Acc: 0.8058
 Site-Painting                  (5) | Train Loss: 0.9292 | Train Acc: 0.8270
 Site-Sketch                    (4) | Train Loss: 0.9998 | Train Acc: 0.7644
 Site-Sketch                    (4) | Train Loss: 1.0335 | Train Acc: 0.7303
 Site-QuickDraw                 (2) | Train Loss: 1.8660 | Train Acc: 0.3853
 Site-Infograph                 (3) | Train Loss: 1.6962 | Train Acc: 0.4444
Average Train Accuracy: 0.7761
 Site-Clipart                   (1) | Val  Loss: 0.8499 | Val  Acc: 0.7895
 Site-Clipart                   (1) | Val  Loss: 0.9674 | Val  Acc: 0.8505
 Site-Clipart                   (1) | Val  Loss: 0.9481 | Val  Acc: 0.7933
 Site-Clipart                   (1) | Val  Loss: 0.9465 | Val  Acc: 0.7905
 Site-Clipart                   (1) | Val  Loss: 1.0622 | Val  Acc: 0.7695
 Site-Real                      (0) | Val  Loss: 0.7393 | Val  Acc: 0.9524
 Site-Real                      (5) | Val  Loss: 0.7363 | Val  Acc: 0.9153
 Site-Real                      (5) | Val  Loss: 0.6860 | Val  Acc: 0.9091
 Site-Real                      (5) | Val  Loss: 0.7165 | Val  Acc: 0.9134
 Site-Painting                  (0) | Val  Loss: 0.8169 | Val  Acc: 0.8776
 Site-Painting                  (5) | Val  Loss: 0.8980 | Val  Acc: 0.8394
 Site-Painting                  (5) | Val  Loss: 0.9053 | Val  Acc: 0.8490
 Site-Sketch                    (4) | Val  Loss: 0.9010 | Val  Acc: 0.8268
 Site-Sketch                    (4) | Val  Loss: 1.0646 | Val  Acc: 0.6854
 Site-QuickDraw                 (2) | Val  Loss: 1.8387 | Val  Acc: 0.4495
 Site-Infograph                 (3) | Val  Loss: 1.6658 | Val  Acc: 0.4936
Average Valid Accuracy: 0.7940
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7895
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.8505
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7933
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7905
 Best site-Clipart                  (1)  | Epoch:7 | Val Acc: 0.7695
 Best site-Real                     (0)  | Epoch:7 | Val Acc: 0.9524
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9153
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9091
 Best site-Real                     (5)  | Epoch:7 | Val Acc: 0.9134
 Best site-Painting                 (0)  | Epoch:7 | Val Acc: 0.8776
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8394
 Best site-Painting                 (5)  | Epoch:7 | Val Acc: 0.8490
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.8268
 Best site-Sketch                   (4)  | Epoch:7 | Val Acc: 0.6854
 Best site-QuickDraw                (2)  | Epoch:7 | Val Acc: 0.4495
 Best site-Infograph                (3)  | Epoch:7 | Val Acc: 0.4936
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 8 ============
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-Clipart                   (0) | Train Loss: 0.4624 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.3178 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4756 | Train Acc: 0.8800
 Site-Clipart                   (0) | Train Loss: 0.4292 | Train Acc: 0.8671
 Site-Clipart                   (0) | Train Loss: 0.4237 | Train Acc: 0.9005
 Site-Real                      (3) | Train Loss: 0.3558 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2738 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2731 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.3305 | Train Acc: 0.9397
 Site-Painting                  (2) | Train Loss: 0.4274 | Train Acc: 0.8503
 Site-Painting                  (2) | Train Loss: 0.3939 | Train Acc: 0.8883
 Site-Painting                  (2) | Train Loss: 0.3822 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.5068 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5070 | Train Acc: 0.8502
 Site-QuickDraw                 (1) | Train Loss: 0.8198 | Train Acc: 0.7523
 Site-Infograph                 (4) | Train Loss: 1.0897 | Train Acc: 0.6624
Average Train Accuracy: 0.8732
 Site-Clipart                   (0) | Val  Loss: 0.2899 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3884 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4435 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.4361 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.5399 | Val  Acc: 0.8373
 Site-Real                      (3) | Val  Loss: 0.2773 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2765 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2493 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2696 | Val  Acc: 0.9481
 Site-Painting                  (2) | Val  Loss: 0.2831 | Val  Acc: 0.9184
 Site-Painting                  (2) | Val  Loss: 0.3667 | Val  Acc: 0.9051
 Site-Painting                  (2) | Val  Loss: 0.4253 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.4288 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.5474 | Val  Acc: 0.8146
 Site-QuickDraw                 (1) | Val  Loss: 0.9013 | Val  Acc: 0.7569
 Site-Infograph                 (4) | Val  Loss: 1.0781 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8731
============ Train epoch 29 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-Clipart                   (0) | Train Loss: 0.8807 | Train Acc: 0.8087
 Site-Clipart                   (0) | Train Loss: 0.7915 | Train Acc: 0.8820
 Site-Clipart                   (0) | Train Loss: 0.9829 | Train Acc: 0.8000
 Site-Clipart                   (0) | Train Loss: 0.8612 | Train Acc: 0.8133
 Site-Clipart                   (0) | Train Loss: 0.9071 | Train Acc: 0.8122
 Site-Real                      (1) | Train Loss: 0.7320 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.6552 | Train Acc: 0.9379
 Site-Real                      (1) | Train Loss: 0.6128 | Train Acc: 0.9355
 Site-Real                      (1) | Train Loss: 0.7362 | Train Acc: 0.9195
 Site-Painting                  (2) | Train Loss: 0.8371 | Train Acc: 0.8163
 Site-Painting                  (2) | Train Loss: 0.9340 | Train Acc: 0.8010
 Site-Painting                  (2) | Train Loss: 0.8592 | Train Acc: 0.8131
 Site-Sketch                    (5) | Train Loss: 0.8975 | Train Acc: 0.7801
 Site-Sketch                    (5) | Train Loss: 0.9059 | Train Acc: 0.7828
 Site-QuickDraw                 (3) | Train Loss: 1.7687 | Train Acc: 0.4312
 Site-Infograph                 (4) | Train Loss: 1.6344 | Train Acc: 0.4829
Average Train Accuracy: 0.7951
 Site-Clipart                   (0) | Val  Loss: 0.7981 | Val  Acc: 0.7632
 Site-Clipart                   (0) | Val  Loss: 0.8330 | Val  Acc: 0.8411
 Site-Clipart                   (0) | Val  Loss: 0.8791 | Val  Acc: 0.7933
 Site-Clipart                   (0) | Val  Loss: 0.8073 | Val  Acc: 0.8095
 Site-Clipart                   (0) | Val  Loss: 1.0012 | Val  Acc: 0.7593
 Site-Real                      (1) | Val  Loss: 0.6625 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.6374 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.5967 | Val  Acc: 0.9091
 Site-Real                      (1) | Val  Loss: 0.6419 | Val  Acc: 0.9351
 Site-Painting                  (2) | Val  Loss: 0.7639 | Val  Acc: 0.8367
 Site-Painting                  (2) | Val  Loss: 0.8534 | Val  Acc: 0.8102
 Site-Painting                  (2) | Val  Loss: 0.8187 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.8822 | Val  Acc: 0.7874
 Site-Sketch                    (5) | Val  Loss: 0.9610 | Val  Acc: 0.7360
 Site-QuickDraw                 (3) | Val  Loss: 1.7878 | Val  Acc: 0.4633
 Site-Infograph                 (4) | Val  Loss: 1.5899 | Val  Acc: 0.4872
Average Valid Accuracy: 0.7910
============ Train epoch 9 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-Clipart                   (0) | Train Loss: 0.4023 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.2928 | Train Acc: 0.9565
 Site-Clipart                   (0) | Train Loss: 0.5111 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.4265 | Train Acc: 0.8829
 Site-Clipart                   (0) | Train Loss: 0.4191 | Train Acc: 0.8959
 Site-Real                      (1) | Train Loss: 0.3498 | Train Acc: 0.8968
 Site-Real                      (1) | Train Loss: 0.2452 | Train Acc: 0.9661
 Site-Real                      (1) | Train Loss: 0.2490 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.2860 | Train Acc: 0.9397
 Site-Painting                  (5) | Train Loss: 0.4948 | Train Acc: 0.8639
 Site-Painting                  (5) | Train Loss: 0.3857 | Train Acc: 0.8883
 Site-Painting                  (5) | Train Loss: 0.3980 | Train Acc: 0.9204
 Site-Sketch                    (4) | Train Loss: 0.4307 | Train Acc: 0.8743
 Site-Sketch                    (4) | Train Loss: 0.4376 | Train Acc: 0.8502
 Site-QuickDraw                 (2) | Train Loss: 0.8376 | Train Acc: 0.7737
 Site-Infograph                 (3) | Train Loss: 1.0793 | Train Acc: 0.6496
Average Train Accuracy: 0.8760
 Site-Clipart                   (0) | Val  Loss: 0.3145 | Val  Acc: 0.8684
 Site-Clipart                   (0) | Val  Loss: 0.3710 | Val  Acc: 0.8785
 Site-Clipart                   (0) | Val  Loss: 0.4171 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.4428 | Val  Acc: 0.8619
 Site-Clipart                   (0) | Val  Loss: 0.4761 | Val  Acc: 0.8644
 Site-Real                      (1) | Val  Loss: 0.2527 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2693 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.2768 | Val  Acc: 0.9152
 Site-Real                      (1) | Val  Loss: 0.2725 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2836 | Val  Acc: 0.9490
 Site-Painting                  (5) | Val  Loss: 0.3665 | Val  Acc: 0.8978
 Site-Painting                  (5) | Val  Loss: 0.4216 | Val  Acc: 0.8698
 Site-Sketch                    (4) | Val  Loss: 0.4866 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.5298 | Val  Acc: 0.8258
 Site-QuickDraw                 (2) | Val  Loss: 0.9789 | Val  Acc: 0.7248
 Site-Infograph                 (3) | Val  Loss: 1.0297 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8699
 Test site-Clipart                   (0)| Epoch:26 | Test Acc: 0.8783
 Test site-Real                      (1)| Epoch:26 | Test Acc: 0.9433
cnt=[2, 3, 5, 1, 1, 4, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-Clipart                   (2) | Train Loss: 0.8150 | Train Acc: 0.7913
 Test site-Painting                  (5)| Epoch:26 | Test Acc: 0.9111
 Site-Clipart                   (2) | Train Loss: 0.7200 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.8905 | Train Acc: 0.7956
 Site-Clipart                   (2) | Train Loss: 0.7875 | Train Acc: 0.8354
 Test site-Sketch                    (4)| Epoch:26 | Test Acc: 0.8845
 Site-Clipart                   (2) | Train Loss: 0.8290 | Train Acc: 0.8326
 Site-Real                      (5) | Train Loss: 0.7087 | Train Acc: 0.8810
 Site-Real                      (5) | Train Loss: 0.5884 | Train Acc: 0.9040
 Site-Real                      (5) | Train Loss: 0.5586 | Train Acc: 0.9395
 Site-Real                      (5) | Train Loss: 0.6536 | Train Acc: 0.9109
 Test site-QuickDraw                 (2)| Epoch:26 | Test Acc: 0.7260
 Site-Painting                  (1) | Train Loss: 0.8476 | Train Acc: 0.8435
 Site-Painting                  (1) | Train Loss: 0.8291 | Train Acc: 0.8301
 Site-Painting                  (1) | Train Loss: 0.7833 | Train Acc: 0.8131
 Site-Sketch                    (0) | Train Loss: 0.8494 | Train Acc: 0.7539
 Site-Sketch                    (0) | Train Loss: 0.8288 | Train Acc: 0.7678
 Test site-Infograph                 (3)| Epoch:26 | Test Acc: 0.5556
Clipart: 0.8783, Real: 0.9433, Painting: 0.9111, Sketch: 0.8845, QuickDraw: 0.7260, Infograph: 0.5556, 
Average Test Accuracy(group): 0.8165, Average Test Accuracy(individual): 0.8718,
domain std=0.1353, cluster std=0.1353, individual std=0.0958, 
============ Train epoch 30 ============
 Site-QuickDraw                 (3) | Train Loss: 1.6981 | Train Acc: 0.4924
 Site-Infograph                 (4) | Train Loss: 1.5815 | Train Acc: 0.4872
Average Train Accuracy: 0.7967
 Site-Clipart                   (2) | Val  Loss: 0.6931 | Val  Acc: 0.8289
 Site-Clipart                   (2) | Val  Loss: 0.7912 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.8219 | Val  Acc: 0.8067
 Site-Clipart                   (2) | Val  Loss: 0.7898 | Val  Acc: 0.8190
 Site-Clipart                   (2) | Val  Loss: 0.8602 | Val  Acc: 0.7966
 Site-Real                      (5) | Val  Loss: 0.5901 | Val  Acc: 0.9405
 Site-Real                      (5) | Val  Loss: 0.6017 | Val  Acc: 0.9407
 Site-Real                      (5) | Val  Loss: 0.5820 | Val  Acc: 0.9152
 Site-Real                      (5) | Val  Loss: 0.5869 | Val  Acc: 0.9177
 Site-Painting                  (1) | Val  Loss: 0.7058 | Val  Acc: 0.8571
 Site-Painting                  (1) | Val  Loss: 0.7766 | Val  Acc: 0.7956
 Site-Painting                  (1) | Val  Loss: 0.7978 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.8252 | Val  Acc: 0.7874
 Site-Sketch                    (0) | Val  Loss: 0.9178 | Val  Acc: 0.7247
 Site-QuickDraw                 (3) | Val  Loss: 1.6833 | Val  Acc: 0.4908
 Site-Infograph                 (4) | Val  Loss: 1.5029 | Val  Acc: 0.5321
Average Valid Accuracy: 0.8043
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8289
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8067
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.8190
 Best site-Clipart                  (2)  | Epoch:9 | Val Acc: 0.7966
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9405
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9407
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9152
 Best site-Real                     (5)  | Epoch:9 | Val Acc: 0.9177
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8571
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.7956
 Best site-Painting                 (1)  | Epoch:9 | Val Acc: 0.8646
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7874
 Best site-Sketch                   (0)  | Epoch:9 | Val Acc: 0.7247
 Best site-QuickDraw                (3)  | Epoch:9 | Val Acc: 0.4908
 Best site-Infograph                (4)  | Epoch:9 | Val Acc: 0.5321
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Test site-Clipart                   (2)| Epoch:9 | Test Acc: 0.8593
 Test site-Real                      (5)| Epoch:9 | Test Acc: 0.9219
 Test site-Painting                  (1)| Epoch:9 | Test Acc: 0.8708
 Test site-Sketch                    (0)| Epoch:9 | Test Acc: 0.8159
 Test site-QuickDraw                 (3)| Epoch:9 | Test Acc: 0.5120
 Test site-Infograph                 (4)| Epoch:9 | Test Acc: 0.4901
Clipart: 0.8593, Real: 0.9219, Painting: 0.8708, Sketch: 0.8159, QuickDraw: 0.5120, Infograph: 0.4901, 
Average Test Accuracy(group): 0.7450, Average Test Accuracy(individual): 0.8269,
domain std=0.1753, cluster std=0.1753, individual std=0.1275, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 4, 5, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-Clipart                   (2) | Train Loss: 0.4971 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.3226 | Train Acc: 0.9255
 Site-Clipart                   (2) | Train Loss: 0.4849 | Train Acc: 0.8533
 Site-Clipart                   (2) | Train Loss: 0.4144 | Train Acc: 0.8766
 Site-Clipart                   (2) | Train Loss: 0.4407 | Train Acc: 0.8824
 Site-Real                      (1) | Train Loss: 0.3598 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2303 | Train Acc: 0.9661
 Site-Real                      (1) | Train Loss: 0.2544 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2929 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.3633 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.4406 | Train Acc: 0.8689
 Site-Painting                  (4) | Train Loss: 0.3561 | Train Acc: 0.9135
 Site-Sketch                    (5) | Train Loss: 0.5016 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.4397 | Train Acc: 0.8427
 Site-QuickDraw                 (0) | Train Loss: 0.8643 | Train Acc: 0.7523
 Site-Infograph                 (3) | Train Loss: 1.0544 | Train Acc: 0.6624
Average Train Accuracy: 0.8707
 Site-Clipart                   (2) | Val  Loss: 0.3404 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3694 | Val  Acc: 0.9065
 Site-Clipart                   (2) | Val  Loss: 0.4081 | Val  Acc: 0.9067
 Site-Clipart                   (2) | Val  Loss: 0.4090 | Val  Acc: 0.8619
 Site-Clipart                   (2) | Val  Loss: 0.5044 | Val  Acc: 0.8542
 Site-Real                      (1) | Val  Loss: 0.2685 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2492 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2653 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.2460 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.3252 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.3619 | Val  Acc: 0.9416
 Site-Painting                  (4) | Val  Loss: 0.3765 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4365 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.5118 | Val  Acc: 0.8371
 Site-QuickDraw                 (0) | Val  Loss: 0.9205 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 1.0663 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8856
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.9079
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.9065
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.9067
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.8619
 Best site-Clipart                  (2)  | Epoch:30 | Val Acc: 0.8542
 Best site-Real                     (1)  | Epoch:30 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:30 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:30 | Val Acc: 0.9212
 Best site-Real                     (1)  | Epoch:30 | Val Acc: 0.9610
 Best site-Painting                 (4)  | Epoch:30 | Val Acc: 0.9286
 Best site-Painting                 (4)  | Epoch:30 | Val Acc: 0.9416
 Best site-Painting                 (4)  | Epoch:30 | Val Acc: 0.8958
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:30 | Val Acc: 0.8371
 Best site-QuickDraw                (0)  | Epoch:30 | Val Acc: 0.7615
 Best site-Infograph                (3)  | Epoch:30 | Val Acc: 0.6987
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 31 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-Clipart                   (0) | Train Loss: 0.7462 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.6818 | Train Acc: 0.8696
 Site-Clipart                   (0) | Train Loss: 0.8316 | Train Acc: 0.8222
 Site-Clipart                   (0) | Train Loss: 0.7415 | Train Acc: 0.8386
 Site-Clipart                   (0) | Train Loss: 0.7843 | Train Acc: 0.8122
 Site-Real                      (1) | Train Loss: 0.5968 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.5534 | Train Acc: 0.9322
 Site-Real                      (1) | Train Loss: 0.5312 | Train Acc: 0.9274
 Site-Real                      (1) | Train Loss: 0.6052 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.8689 | Train Acc: 0.8027
 Site-Painting                  (5) | Train Loss: 0.8046 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.7365 | Train Acc: 0.8478
 Site-Sketch                    (4) | Train Loss: 0.7962 | Train Acc: 0.8063
 Site-Sketch                    (4) | Train Loss: 0.7971 | Train Acc: 0.7978
 Site-QuickDraw                 (2) | Train Loss: 1.5251 | Train Acc: 0.5352
 Site-Infograph                 (3) | Train Loss: 1.5121 | Train Acc: 0.5256
Average Train Accuracy: 0.8175
 Site-Clipart                   (0) | Val  Loss: 0.6392 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.7525 | Val  Acc: 0.8037
 Site-Clipart                   (0) | Val  Loss: 0.7375 | Val  Acc: 0.8333
 Site-Clipart                   (0) | Val  Loss: 0.6746 | Val  Acc: 0.8429
 Site-Clipart                   (0) | Val  Loss: 0.8330 | Val  Acc: 0.8136
 Site-Real                      (1) | Val  Loss: 0.5494 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.5443 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.5146 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.5574 | Val  Acc: 0.9307
 Site-Painting                  (5) | Val  Loss: 0.6921 | Val  Acc: 0.8367
 Site-Painting                  (5) | Val  Loss: 0.7094 | Val  Acc: 0.8321
 Site-Painting                  (5) | Val  Loss: 0.7521 | Val  Acc: 0.8438
 Site-Sketch                    (4) | Val  Loss: 0.7631 | Val  Acc: 0.8504
 Site-Sketch                    (4) | Val  Loss: 0.8548 | Val  Acc: 0.7416
 Site-QuickDraw                 (2) | Val  Loss: 1.5715 | Val  Acc: 0.5688
 Site-Infograph                 (3) | Val  Loss: 1.4806 | Val  Acc: 0.5769
Average Valid Accuracy: 0.8219
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8037
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8333
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8429
 Best site-Clipart                  (0)  | Epoch:10 | Val Acc: 0.8136
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:10 | Val Acc: 0.9307
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8367
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8321
 Best site-Painting                 (5)  | Epoch:10 | Val Acc: 0.8438
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.8504
 Best site-Sketch                   (4)  | Epoch:10 | Val Acc: 0.7416
 Best site-QuickDraw                (2)  | Epoch:10 | Val Acc: 0.5688
 Best site-Infograph                (3)  | Epoch:10 | Val Acc: 0.5769
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 11 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-Clipart                   (0) | Train Loss: 0.4851 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3475 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.4584 | Train Acc: 0.8711
 Site-Clipart                   (0) | Train Loss: 0.4153 | Train Acc: 0.8671
 Site-Clipart                   (0) | Train Loss: 0.4058 | Train Acc: 0.9005
 Site-Real                      (2) | Train Loss: 0.3445 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.2278 | Train Acc: 0.9605
 Site-Real                      (2) | Train Loss: 0.2504 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.3121 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.4383 | Train Acc: 0.8503
 Site-Painting                  (3) | Train Loss: 0.3876 | Train Acc: 0.8641
 Site-Painting                  (3) | Train Loss: 0.3648 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4777 | Train Acc: 0.8639
 Site-Sketch                    (5) | Train Loss: 0.4934 | Train Acc: 0.8427
 Site-QuickDraw                 (1) | Train Loss: 0.8329 | Train Acc: 0.7798
 Site-Infograph                 (4) | Train Loss: 1.0292 | Train Acc: 0.6624
Average Train Accuracy: 0.8707
 Site-Clipart                   (0) | Val  Loss: 0.2965 | Val  Acc: 0.9211
 Site-Clipart                   (0) | Val  Loss: 0.3415 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3918 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.3816 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4651 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2660 | Val  Acc: 0.9524
 Site-Real                      (2) | Val  Loss: 0.2465 | Val  Acc: 0.9661
 Site-Real                      (2) | Val  Loss: 0.2509 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2622 | Val  Acc: 0.9394
 Site-Painting                  (3) | Val  Loss: 0.3377 | Val  Acc: 0.9082
 Site-Painting                  (3) | Val  Loss: 0.3757 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.3653 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.4569 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.5434 | Val  Acc: 0.8034
 Site-QuickDraw                 (1) | Val  Loss: 0.8925 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 1.0450 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8884
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.9211
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.9252
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.9000
 Best site-Clipart                  (0)  | Epoch:31 | Val Acc: 0.8780
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9524
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9661
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:31 | Val Acc: 0.9394
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9082
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9051
 Best site-Painting                 (3)  | Epoch:31 | Val Acc: 0.9167
 Best site-Sketch                   (5)  | Epoch:31 | Val Acc: 0.8819
 Best site-Sketch                   (5)  | Epoch:31 | Val Acc: 0.8034
 Best site-QuickDraw                (1)  | Epoch:31 | Val Acc: 0.7798
 Best site-Infograph                (4)  | Epoch:31 | Val Acc: 0.7115
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 32 ============
cnt=[3, 1, 2, 5, 4, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-Clipart                   (3) | Train Loss: 0.7242 | Train Acc: 0.8435
 Site-Clipart                   (3) | Train Loss: 0.5800 | Train Acc: 0.9006
 Site-Clipart                   (3) | Train Loss: 0.7553 | Train Acc: 0.8356
 Site-Clipart                   (3) | Train Loss: 0.6976 | Train Acc: 0.8354
 Site-Clipart                   (3) | Train Loss: 0.7380 | Train Acc: 0.8348
 Site-Real                      (4) | Train Loss: 0.5673 | Train Acc: 0.8968
 Site-Real                      (4) | Train Loss: 0.4619 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.4799 | Train Acc: 0.9194
 Site-Real                      (4) | Train Loss: 0.5282 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.6702 | Train Acc: 0.8299
 Site-Painting                  (0) | Train Loss: 0.6896 | Train Acc: 0.8592
 Site-Painting                  (0) | Train Loss: 0.6713 | Train Acc: 0.8616
 Site-Sketch                    (2) | Train Loss: 0.7411 | Train Acc: 0.8010
 Site-Sketch                    (2) | Train Loss: 0.7172 | Train Acc: 0.7903
 Site-QuickDraw                 (1) | Train Loss: 1.5307 | Train Acc: 0.5413
 Site-Infograph                 (5) | Train Loss: 1.5181 | Train Acc: 0.5000
Average Train Accuracy: 0.8210
 Site-Clipart                   (3) | Val  Loss: 0.6273 | Val  Acc: 0.8289
 Site-Clipart                   (3) | Val  Loss: 0.6551 | Val  Acc: 0.8505
 Site-Clipart                   (3) | Val  Loss: 0.6818 | Val  Acc: 0.8000
 Site-Clipart                   (3) | Val  Loss: 0.6615 | Val  Acc: 0.8190
 Site-Clipart                   (3) | Val  Loss: 0.7472 | Val  Acc: 0.8237
 Site-Real                      (4) | Val  Loss: 0.4810 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.4862 | Val  Acc: 0.9576
 Site-Real                      (4) | Val  Loss: 0.4564 | Val  Acc: 0.9333
 Site-Real                      (4) | Val  Loss: 0.5001 | Val  Acc: 0.9307
 Site-Painting                  (0) | Val  Loss: 0.6315 | Val  Acc: 0.9082
 Site-Painting                  (0) | Val  Loss: 0.6426 | Val  Acc: 0.8540
 Site-Painting                  (0) | Val  Loss: 0.6723 | Val  Acc: 0.8698
 Site-Sketch                    (2) | Val  Loss: 0.7244 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.7590 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.5101 | Val  Acc: 0.5917
 Site-Infograph                 (5) | Val  Loss: 1.4138 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8332
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8289
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8505
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8000
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8190
 Best site-Clipart                  (3)  | Epoch:11 | Val Acc: 0.8237
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9576
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9333
 Best site-Real                     (4)  | Epoch:11 | Val Acc: 0.9307
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.9082
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8540
 Best site-Painting                 (0)  | Epoch:11 | Val Acc: 0.8698
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:11 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:11 | Val Acc: 0.5917
 Best site-Infograph                (5)  | Epoch:11 | Val Acc: 0.5833
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 12 ============
cnt=[3, 1, 5, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-Clipart                   (2) | Train Loss: 0.4820 | Train Acc: 0.8783
 Site-Clipart                   (2) | Train Loss: 0.3466 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4475 | Train Acc: 0.8756
 Site-Clipart                   (2) | Train Loss: 0.3910 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.4038 | Train Acc: 0.8959
 Site-Real                      (4) | Train Loss: 0.3706 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.2445 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2583 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2767 | Train Acc: 0.9454
 Site-Painting                  (0) | Train Loss: 0.4355 | Train Acc: 0.8707
 Site-Painting                  (0) | Train Loss: 0.4335 | Train Acc: 0.8981
 Site-Painting                  (0) | Train Loss: 0.3466 | Train Acc: 0.9412
 Site-Sketch                    (5) | Train Loss: 0.4989 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.5174 | Train Acc: 0.8315
 Site-QuickDraw                 (1) | Train Loss: 0.7924 | Train Acc: 0.7798
 Site-Infograph                 (3) | Train Loss: 1.0851 | Train Acc: 0.6453
Average Train Accuracy: 0.8773
 Site-Clipart                   (2) | Val  Loss: 0.2980 | Val  Acc: 0.9079
 Site-Clipart                   (2) | Val  Loss: 0.3323 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3334 | Val  Acc: 0.9000
 Site-Clipart                   (2) | Val  Loss: 0.4043 | Val  Acc: 0.8857
 Site-Clipart                   (2) | Val  Loss: 0.4570 | Val  Acc: 0.8644
 Site-Real                      (4) | Val  Loss: 0.2486 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.2402 | Val  Acc: 0.9492
 Site-Real                      (4) | Val  Loss: 0.2376 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2569 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.3009 | Val  Acc: 0.9388
 Site-Painting                  (0) | Val  Loss: 0.3397 | Val  Acc: 0.9343
 Site-Painting                  (0) | Val  Loss: 0.4021 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.4418 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5125 | Val  Acc: 0.8202
 Site-QuickDraw                 (1) | Val  Loss: 0.8695 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 1.1002 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8847
============ Train epoch 33 ============
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-Clipart                   (2) | Train Loss: 0.6835 | Train Acc: 0.8696
 Site-Clipart                   (2) | Train Loss: 0.5279 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.7747 | Train Acc: 0.8133
 Site-Clipart                   (2) | Train Loss: 0.6336 | Train Acc: 0.8544
 Site-Clipart                   (2) | Train Loss: 0.7042 | Train Acc: 0.8281
 Site-Real                      (0) | Train Loss: 0.5367 | Train Acc: 0.8968
 Site-Real                      (0) | Train Loss: 0.4321 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.4421 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.5030 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.7125 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.5803 | Train Acc: 0.8786
 Site-Painting                  (3) | Train Loss: 0.6292 | Train Acc: 0.8651
 Site-Sketch                    (5) | Train Loss: 0.6615 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.7178 | Train Acc: 0.7865
 Site-QuickDraw                 (1) | Train Loss: 1.3692 | Train Acc: 0.5719
 Site-Infograph                 (4) | Train Loss: 1.4545 | Train Acc: 0.5299
Average Train Accuracy: 0.8308
 Site-Clipart                   (2) | Val  Loss: 0.5548 | Val  Acc: 0.8421
 Site-Clipart                   (2) | Val  Loss: 0.6400 | Val  Acc: 0.8505
 Site-Clipart                   (2) | Val  Loss: 0.6834 | Val  Acc: 0.8467
 Site-Clipart                   (2) | Val  Loss: 0.6705 | Val  Acc: 0.8095
 Site-Clipart                   (2) | Val  Loss: 0.7430 | Val  Acc: 0.8102
 Site-Real                      (0) | Val  Loss: 0.4272 | Val  Acc: 0.9643
 Site-Real                      (0) | Val  Loss: 0.4595 | Val  Acc: 0.9492
 Site-Real                      (0) | Val  Loss: 0.4348 | Val  Acc: 0.9212
 Site-Real                      (0) | Val  Loss: 0.4503 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.5440 | Val  Acc: 0.8878
 Site-Painting                  (3) | Val  Loss: 0.5665 | Val  Acc: 0.8759
 Site-Painting                  (3) | Val  Loss: 0.6375 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.6783 | Val  Acc: 0.8189
 Site-Sketch                    (5) | Val  Loss: 0.7327 | Val  Acc: 0.7809
 Site-QuickDraw                 (1) | Val  Loss: 1.5013 | Val  Acc: 0.5688
 Site-Infograph                 (4) | Val  Loss: 1.3941 | Val  Acc: 0.5962
Average Valid Accuracy: 0.8337
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8421
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8505
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8467
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8095
 Best site-Clipart                  (2)  | Epoch:12 | Val Acc: 0.8102
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9643
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9492
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9212
 Best site-Real                     (0)  | Epoch:12 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8878
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8759
 Best site-Painting                 (3)  | Epoch:12 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:12 | Val Acc: 0.8189
 Best site-Sketch                   (5)  | Epoch:12 | Val Acc: 0.7809
 Best site-QuickDraw                (1)  | Epoch:12 | Val Acc: 0.5688
 Best site-Infograph                (4)  | Epoch:12 | Val Acc: 0.5962
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 13 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-Clipart                   (1) | Train Loss: 0.4138 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.3273 | Train Acc: 0.9317
 Site-Clipart                   (1) | Train Loss: 0.4310 | Train Acc: 0.8622
 Site-Clipart                   (1) | Train Loss: 0.4117 | Train Acc: 0.8576
 Site-Clipart                   (1) | Train Loss: 0.3733 | Train Acc: 0.9140
 Site-Real                      (0) | Train Loss: 0.3529 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2367 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2481 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2923 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.4612 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.3688 | Train Acc: 0.8786
 Site-Painting                  (4) | Train Loss: 0.3439 | Train Acc: 0.9170
 Site-Sketch                    (5) | Train Loss: 0.4612 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.4798 | Train Acc: 0.8464
 Site-QuickDraw                 (2) | Train Loss: 0.8070 | Train Acc: 0.7706
 Site-Infograph                 (3) | Train Loss: 0.9804 | Train Acc: 0.6709
Average Train Accuracy: 0.8734
 Site-Clipart                   (1) | Val  Loss: 0.2709 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.3260 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3928 | Val  Acc: 0.8600
 Site-Clipart                   (1) | Val  Loss: 0.4105 | Val  Acc: 0.8619
 Site-Clipart                   (1) | Val  Loss: 0.4557 | Val  Acc: 0.8746
 Site-Real                      (0) | Val  Loss: 0.2399 | Val  Acc: 0.9286
 Site-Real                      (0) | Val  Loss: 0.2530 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2142 | Val  Acc: 0.9515
 Site-Real                      (0) | Val  Loss: 0.2648 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2405 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3445 | Val  Acc: 0.8905
 Site-Painting                  (4) | Val  Loss: 0.3555 | Val  Acc: 0.8958
 Site-Sketch                    (5) | Val  Loss: 0.4566 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.5030 | Val  Acc: 0.8371
 Site-QuickDraw                 (2) | Val  Loss: 0.8835 | Val  Acc: 0.7798
 Site-Infograph                 (3) | Val  Loss: 1.0355 | Val  Acc: 0.6987
Average Valid Accuracy: 0.8825
============ Train epoch 34 ============
cnt=[1, 4, 1, 5, 3, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-Clipart                   (3) | Train Loss: 0.6389 | Train Acc: 0.8609
 Site-Clipart                   (3) | Train Loss: 0.5341 | Train Acc: 0.9006
 Site-Clipart                   (3) | Train Loss: 0.7270 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.5868 | Train Acc: 0.8734
 Site-Clipart                   (3) | Train Loss: 0.6529 | Train Acc: 0.8575
 Site-Real                      (1) | Train Loss: 0.5068 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.4160 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.4067 | Train Acc: 0.9435
 Site-Real                      (1) | Train Loss: 0.4812 | Train Acc: 0.9339
 Site-Painting                  (4) | Train Loss: 0.6813 | Train Acc: 0.8163
 Site-Painting                  (4) | Train Loss: 0.6334 | Train Acc: 0.8447
 Site-Painting                  (4) | Train Loss: 0.6219 | Train Acc: 0.8616
 Site-Sketch                    (5) | Train Loss: 0.6435 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.7187 | Train Acc: 0.8090
 Site-QuickDraw                 (2) | Train Loss: 1.3778 | Train Acc: 0.6055
 Site-Infograph                 (0) | Train Loss: 1.4012 | Train Acc: 0.5513
Average Train Accuracy: 0.8355
 Site-Clipart                   (3) | Val  Loss: 0.5110 | Val  Acc: 0.8553
 Site-Clipart                   (3) | Val  Loss: 0.5866 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.6285 | Val  Acc: 0.8533
 Site-Clipart                   (3) | Val  Loss: 0.5951 | Val  Acc: 0.8429
 Site-Clipart                   (3) | Val  Loss: 0.6782 | Val  Acc: 0.8339
 Site-Real                      (1) | Val  Loss: 0.4136 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.3894 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.4215 | Val  Acc: 0.9273
 Site-Real                      (1) | Val  Loss: 0.4592 | Val  Acc: 0.9221
 Site-Painting                  (4) | Val  Loss: 0.5310 | Val  Acc: 0.9082
 Site-Painting                  (4) | Val  Loss: 0.6240 | Val  Acc: 0.8759
 Site-Painting                  (4) | Val  Loss: 0.6125 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6088 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6942 | Val  Acc: 0.7753
 Site-QuickDraw                 (2) | Val  Loss: 1.4028 | Val  Acc: 0.6147
 Site-Infograph                 (0) | Val  Loss: 1.3616 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8439
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8553
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8879
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8533
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8429
 Best site-Clipart                  (3)  | Epoch:13 | Val Acc: 0.8339
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9273
 Best site-Real                     (1)  | Epoch:13 | Val Acc: 0.9221
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.9082
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8759
 Best site-Painting                 (4)  | Epoch:13 | Val Acc: 0.8646
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:13 | Val Acc: 0.7753
 Best site-QuickDraw                (2)  | Epoch:13 | Val Acc: 0.6147
 Best site-Infograph                (0)  | Epoch:13 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 14 ============
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-Clipart                   (1) | Train Loss: 0.4764 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.2899 | Train Acc: 0.9379
 Site-Clipart                   (1) | Train Loss: 0.4627 | Train Acc: 0.8711
 Site-Clipart                   (1) | Train Loss: 0.4054 | Train Acc: 0.8608
 Site-Clipart                   (1) | Train Loss: 0.3798 | Train Acc: 0.9095
 Site-Real                      (3) | Train Loss: 0.3379 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2162 | Train Acc: 0.9718
 Site-Real                      (3) | Train Loss: 0.2194 | Train Acc: 0.9637
 Site-Real                      (3) | Train Loss: 0.2914 | Train Acc: 0.9397
 Site-Painting                  (0) | Train Loss: 0.4527 | Train Acc: 0.8776
 Site-Painting                  (0) | Train Loss: 0.3609 | Train Acc: 0.9029
 Site-Painting                  (0) | Train Loss: 0.3407 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4731 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5058 | Train Acc: 0.8614
 Site-QuickDraw                 (2) | Train Loss: 0.8093 | Train Acc: 0.7768
 Site-Infograph                 (4) | Train Loss: 0.9856 | Train Acc: 0.6795
Average Train Accuracy: 0.8787
 Site-Clipart                   (1) | Val  Loss: 0.3182 | Val  Acc: 0.8553
 Site-Clipart                   (1) | Val  Loss: 0.3171 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.3504 | Val  Acc: 0.9067
 Site-Clipart                   (1) | Val  Loss: 0.3874 | Val  Acc: 0.8857
 Site-Clipart                   (1) | Val  Loss: 0.4757 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2407 | Val  Acc: 0.9643
 Site-Real                      (3) | Val  Loss: 0.2459 | Val  Acc: 0.9407
 Site-Real                      (3) | Val  Loss: 0.2267 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2579 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.2486 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3138 | Val  Acc: 0.9124
 Site-Painting                  (0) | Val  Loss: 0.3789 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4542 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4864 | Val  Acc: 0.8258
 Site-QuickDraw                 (2) | Val  Loss: 0.8886 | Val  Acc: 0.7523
 Site-Infograph                 (4) | Val  Loss: 1.0172 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8843
============ Train epoch 35 ============
cnt=[2, 4, 1, 5, 1, 3, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-Clipart                   (3) | Train Loss: 0.6035 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.5180 | Train Acc: 0.8696
 Site-Clipart                   (3) | Train Loss: 0.6481 | Train Acc: 0.8489
 Site-Clipart                   (3) | Train Loss: 0.5963 | Train Acc: 0.8576
 Site-Clipart                   (3) | Train Loss: 0.6415 | Train Acc: 0.8507
 Site-Real                      (1) | Train Loss: 0.4865 | Train Acc: 0.9048
 Site-Real                      (1) | Train Loss: 0.4085 | Train Acc: 0.9492
 Site-Real                      (1) | Train Loss: 0.4111 | Train Acc: 0.9194
 Site-Real                      (1) | Train Loss: 0.4615 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.6332 | Train Acc: 0.8299
 Site-Painting                  (5) | Train Loss: 0.5869 | Train Acc: 0.8641
 Site-Painting                  (5) | Train Loss: 0.6145 | Train Acc: 0.8581
 Site-Sketch                    (0) | Train Loss: 0.6339 | Train Acc: 0.8220
 Site-Sketch                    (0) | Train Loss: 0.7658 | Train Acc: 0.8015
 Site-QuickDraw                 (2) | Train Loss: 1.3049 | Train Acc: 0.6269
 Site-Infograph                 (4) | Train Loss: 1.3620 | Train Acc: 0.5299
Average Train Accuracy: 0.8335
 Site-Clipart                   (3) | Val  Loss: 0.4965 | Val  Acc: 0.8684
 Site-Clipart                   (3) | Val  Loss: 0.5504 | Val  Acc: 0.8879
 Site-Clipart                   (3) | Val  Loss: 0.6040 | Val  Acc: 0.8400
 Site-Clipart                   (3) | Val  Loss: 0.5804 | Val  Acc: 0.8381
 Site-Clipart                   (3) | Val  Loss: 0.6674 | Val  Acc: 0.8169
 Site-Real                      (1) | Val  Loss: 0.4068 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.4056 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.4086 | Val  Acc: 0.9212
 Site-Real                      (1) | Val  Loss: 0.4206 | Val  Acc: 0.9437
 Site-Painting                  (5) | Val  Loss: 0.5132 | Val  Acc: 0.8571
 Site-Painting                  (5) | Val  Loss: 0.5470 | Val  Acc: 0.8905
 Site-Painting                  (5) | Val  Loss: 0.6082 | Val  Acc: 0.8646
 Site-Sketch                    (0) | Val  Loss: 0.6676 | Val  Acc: 0.7953
 Site-Sketch                    (0) | Val  Loss: 0.6924 | Val  Acc: 0.7697
 Site-QuickDraw                 (2) | Val  Loss: 1.3191 | Val  Acc: 0.6514
 Site-Infograph                 (4) | Val  Loss: 1.3295 | Val  Acc: 0.5833
Average Valid Accuracy: 0.8386
============ Train epoch 15 ============
cnt=[5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-Clipart                   (0) | Train Loss: 0.4433 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3120 | Train Acc: 0.9317
 Site-Clipart                   (0) | Train Loss: 0.4251 | Train Acc: 0.8933
 Site-Clipart                   (0) | Train Loss: 0.3821 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3814 | Train Acc: 0.9005
 Site-Real                      (1) | Train Loss: 0.3278 | Train Acc: 0.9286
 Site-Real                      (1) | Train Loss: 0.2358 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2530 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2828 | Train Acc: 0.9368
 Site-Painting                  (3) | Train Loss: 0.3933 | Train Acc: 0.8980
 Site-Painting                  (3) | Train Loss: 0.3092 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3414 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4460 | Train Acc: 0.8534
 Site-Sketch                    (5) | Train Loss: 0.4686 | Train Acc: 0.8727
 Site-QuickDraw                 (2) | Train Loss: 0.7650 | Train Acc: 0.7798
 Site-Infograph                 (4) | Train Loss: 0.9804 | Train Acc: 0.6966
Average Train Accuracy: 0.8855
 Site-Clipart                   (0) | Val  Loss: 0.2733 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.3164 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3439 | Val  Acc: 0.8800
 Site-Clipart                   (0) | Val  Loss: 0.4000 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.4711 | Val  Acc: 0.8576
 Site-Real                      (1) | Val  Loss: 0.2334 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2448 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.2206 | Val  Acc: 0.9515
 Site-Real                      (1) | Val  Loss: 0.2386 | Val  Acc: 0.9437
 Site-Painting                  (3) | Val  Loss: 0.3006 | Val  Acc: 0.9490
 Site-Painting                  (3) | Val  Loss: 0.3358 | Val  Acc: 0.9051
 Site-Painting                  (3) | Val  Loss: 0.4097 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.3987 | Val  Acc: 0.8898
 Site-Sketch                    (5) | Val  Loss: 0.5043 | Val  Acc: 0.8371
 Site-QuickDraw                 (2) | Val  Loss: 0.8470 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0612 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8833
============ Train epoch 36 ============
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-Clipart                   (0) | Train Loss: 0.5584 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.5244 | Train Acc: 0.8634
 Site-Clipart                   (0) | Train Loss: 0.6490 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.5622 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.6114 | Train Acc: 0.8507
 Site-Real                      (3) | Train Loss: 0.4499 | Train Acc: 0.9206
 Site-Real                      (3) | Train Loss: 0.3961 | Train Acc: 0.9322
 Site-Real                      (3) | Train Loss: 0.3696 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4290 | Train Acc: 0.9511
 Site-Painting                  (2) | Train Loss: 0.6657 | Train Acc: 0.8299
 Site-Painting                  (2) | Train Loss: 0.5971 | Train Acc: 0.8544
 Site-Painting                  (2) | Train Loss: 0.6035 | Train Acc: 0.8651
 Site-Sketch                    (5) | Train Loss: 0.6521 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.6131 | Train Acc: 0.8202
 Site-QuickDraw                 (1) | Train Loss: 1.3189 | Train Acc: 0.6177
 Site-Infograph                 (4) | Train Loss: 1.3928 | Train Acc: 0.5299
Average Train Accuracy: 0.8353
 Site-Clipart                   (0) | Val  Loss: 0.4933 | Val  Acc: 0.8158
 Site-Clipart                   (0) | Val  Loss: 0.5526 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5417 | Val  Acc: 0.8600
 Site-Clipart                   (0) | Val  Loss: 0.5642 | Val  Acc: 0.8524
 Site-Clipart                   (0) | Val  Loss: 0.6168 | Val  Acc: 0.8203
 Site-Real                      (3) | Val  Loss: 0.3797 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.3593 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.3717 | Val  Acc: 0.9333
 Site-Real                      (3) | Val  Loss: 0.3800 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.4845 | Val  Acc: 0.8980
 Site-Painting                  (2) | Val  Loss: 0.5525 | Val  Acc: 0.8467
 Site-Painting                  (2) | Val  Loss: 0.5384 | Val  Acc: 0.8646
 Site-Sketch                    (5) | Val  Loss: 0.6036 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Val  Loss: 0.6697 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.2949 | Val  Acc: 0.6606
 Site-Infograph                 (4) | Val  Loss: 1.2894 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8427
============ Train epoch 16 ============
cnt=[3, 1, 4, 2, 5, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-Clipart                   (4) | Train Loss: 0.4430 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3449 | Train Acc: 0.9193
 Site-Clipart                   (4) | Train Loss: 0.4017 | Train Acc: 0.8889
 Site-Clipart                   (4) | Train Loss: 0.3538 | Train Acc: 0.9019
 Site-Clipart                   (4) | Train Loss: 0.3670 | Train Acc: 0.9027
 Site-Real                      (2) | Train Loss: 0.3247 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.2173 | Train Acc: 0.9661
 Site-Real                      (2) | Train Loss: 0.2380 | Train Acc: 0.9476
 Site-Real                      (2) | Train Loss: 0.2657 | Train Acc: 0.9425
 Site-Painting                  (0) | Train Loss: 0.4350 | Train Acc: 0.9048
 Site-Painting                  (0) | Train Loss: 0.4285 | Train Acc: 0.8835
 Site-Painting                  (0) | Train Loss: 0.3611 | Train Acc: 0.8997
 Site-Sketch                    (3) | Train Loss: 0.4765 | Train Acc: 0.8639
 Site-Sketch                    (3) | Train Loss: 0.4921 | Train Acc: 0.8464
 Site-QuickDraw                 (1) | Train Loss: 0.8460 | Train Acc: 0.7645
 Site-Infograph                 (5) | Train Loss: 0.9726 | Train Acc: 0.6795
Average Train Accuracy: 0.8814
 Site-Clipart                   (4) | Val  Loss: 0.2898 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3373 | Val  Acc: 0.9346
 Site-Clipart                   (4) | Val  Loss: 0.3814 | Val  Acc: 0.8733
 Site-Clipart                   (4) | Val  Loss: 0.3945 | Val  Acc: 0.8810
 Site-Clipart                   (4) | Val  Loss: 0.4280 | Val  Acc: 0.8780
 Site-Real                      (2) | Val  Loss: 0.2364 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2475 | Val  Acc: 0.9492
 Site-Real                      (2) | Val  Loss: 0.2127 | Val  Acc: 0.9394
 Site-Real                      (2) | Val  Loss: 0.2598 | Val  Acc: 0.9567
 Site-Painting                  (0) | Val  Loss: 0.2552 | Val  Acc: 0.9490
 Site-Painting                  (0) | Val  Loss: 0.3061 | Val  Acc: 0.9343
 Site-Painting                  (0) | Val  Loss: 0.3662 | Val  Acc: 0.9010
 Site-Sketch                    (3) | Val  Loss: 0.4284 | Val  Acc: 0.8819
 Site-Sketch                    (3) | Val  Loss: 0.5055 | Val  Acc: 0.8539
 Site-QuickDraw                 (1) | Val  Loss: 0.8667 | Val  Acc: 0.7661
 Site-Infograph                 (5) | Val  Loss: 1.0184 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8900
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.9346
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8733
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8810
 Best site-Clipart                  (4)  | Epoch:36 | Val Acc: 0.8780
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9492
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9394
 Best site-Real                     (2)  | Epoch:36 | Val Acc: 0.9567
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9490
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9343
 Best site-Painting                 (0)  | Epoch:36 | Val Acc: 0.9010
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8819
 Best site-Sketch                   (3)  | Epoch:36 | Val Acc: 0.8539
 Best site-QuickDraw                (1)  | Epoch:36 | Val Acc: 0.7661
 Best site-Infograph                (5)  | Epoch:36 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 37 ============
cnt=[5, 3, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-Clipart                   (0) | Train Loss: 0.6061 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4876 | Train Acc: 0.8944
 Site-Clipart                   (0) | Train Loss: 0.6144 | Train Acc: 0.8444
 Site-Clipart                   (0) | Train Loss: 0.5509 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.5705 | Train Acc: 0.8597
 Site-Real                      (3) | Train Loss: 0.4559 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.3602 | Train Acc: 0.9435
 Site-Real                      (3) | Train Loss: 0.3518 | Train Acc: 0.9315
 Site-Real                      (3) | Train Loss: 0.4048 | Train Acc: 0.9454
 Site-Painting                  (1) | Train Loss: 0.5575 | Train Acc: 0.8503
 Site-Painting                  (1) | Train Loss: 0.6559 | Train Acc: 0.8495
 Site-Painting                  (1) | Train Loss: 0.5711 | Train Acc: 0.8512
 Site-Sketch                    (5) | Train Loss: 0.6113 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.6561 | Train Acc: 0.7978
 Site-QuickDraw                 (2) | Train Loss: 1.2222 | Train Acc: 0.6391
 Site-Infograph                 (4) | Train Loss: 1.3436 | Train Acc: 0.5470
Average Train Accuracy: 0.8352
 Site-Clipart                   (0) | Val  Loss: 0.4707 | Val  Acc: 0.8553
 Site-Clipart                   (0) | Val  Loss: 0.5470 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5701 | Val  Acc: 0.8533
 Site-Clipart                   (0) | Val  Loss: 0.5243 | Val  Acc: 0.8571
 Site-Clipart                   (0) | Val  Loss: 0.6323 | Val  Acc: 0.8034
 Site-Real                      (3) | Val  Loss: 0.3490 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.3523 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.3441 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.3845 | Val  Acc: 0.9481
 Site-Painting                  (1) | Val  Loss: 0.4829 | Val  Acc: 0.9082
 Site-Painting                  (1) | Val  Loss: 0.4941 | Val  Acc: 0.8759
 Site-Painting                  (1) | Val  Loss: 0.5403 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5905 | Val  Acc: 0.7953
 Site-Sketch                    (5) | Val  Loss: 0.6885 | Val  Acc: 0.7584
 Site-QuickDraw                 (2) | Val  Loss: 1.2470 | Val  Acc: 0.6330
 Site-Infograph                 (4) | Val  Loss: 1.2253 | Val  Acc: 0.6474
Average Valid Accuracy: 0.8459
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8553
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8533
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8571
 Best site-Clipart                  (0)  | Epoch:16 | Val Acc: 0.8034
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9524
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9576
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9455
 Best site-Real                     (3)  | Epoch:16 | Val Acc: 0.9481
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.9082
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.8759
 Best site-Painting                 (1)  | Epoch:16 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.7953
 Best site-Sketch                   (5)  | Epoch:16 | Val Acc: 0.7584
 Best site-QuickDraw                (2)  | Epoch:16 | Val Acc: 0.6330
 Best site-Infograph                (4)  | Epoch:16 | Val Acc: 0.6474
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 17 ============
cnt=[1, 3, 5, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-Clipart                   (2) | Train Loss: 0.3641 | Train Acc: 0.8957
 Site-Clipart                   (2) | Train Loss: 0.3205 | Train Acc: 0.9193
 Site-Clipart                   (2) | Train Loss: 0.4254 | Train Acc: 0.8933
 Site-Clipart                   (2) | Train Loss: 0.3737 | Train Acc: 0.8924
 Site-Clipart                   (2) | Train Loss: 0.3727 | Train Acc: 0.9050
 Site-Real                      (3) | Train Loss: 0.3244 | Train Acc: 0.9127
 Site-Real                      (3) | Train Loss: 0.2288 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2315 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.2614 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.3841 | Train Acc: 0.8844
 Site-Painting                  (1) | Train Loss: 0.3733 | Train Acc: 0.8835
 Site-Painting                  (1) | Train Loss: 0.3640 | Train Acc: 0.9204
 Site-Sketch                    (5) | Train Loss: 0.4858 | Train Acc: 0.8325
 Site-Sketch                    (5) | Train Loss: 0.4840 | Train Acc: 0.8539
 Site-QuickDraw                 (0) | Train Loss: 0.8272 | Train Acc: 0.7370
 Site-Infograph                 (4) | Train Loss: 0.9697 | Train Acc: 0.6752
Average Train Accuracy: 0.8787
 Site-Clipart                   (2) | Val  Loss: 0.2725 | Val  Acc: 0.8947
 Site-Clipart                   (2) | Val  Loss: 0.3470 | Val  Acc: 0.9159
 Site-Clipart                   (2) | Val  Loss: 0.3720 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.4110 | Val  Acc: 0.8714
 Site-Clipart                   (2) | Val  Loss: 0.4201 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.2409 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2854 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2148 | Val  Acc: 0.9576
 Site-Real                      (3) | Val  Loss: 0.2504 | Val  Acc: 0.9481
 Site-Painting                  (1) | Val  Loss: 0.2508 | Val  Acc: 0.9490
 Site-Painting                  (1) | Val  Loss: 0.3148 | Val  Acc: 0.9051
 Site-Painting                  (1) | Val  Loss: 0.3366 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3836 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5107 | Val  Acc: 0.8371
 Site-QuickDraw                 (0) | Val  Loss: 0.8421 | Val  Acc: 0.7431
 Site-Infograph                 (4) | Val  Loss: 1.0156 | Val  Acc: 0.7308
Average Valid Accuracy: 0.8849
============ Train epoch 38 ============
cnt=[5, 1, 4, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-Clipart                   (0) | Train Loss: 0.5588 | Train Acc: 0.8435
 Site-Clipart                   (0) | Train Loss: 0.4452 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5955 | Train Acc: 0.8578
 Site-Clipart                   (0) | Train Loss: 0.5396 | Train Acc: 0.8576
 Site-Clipart                   (0) | Train Loss: 0.5665 | Train Acc: 0.8439
 Site-Real                      (2) | Train Loss: 0.4316 | Train Acc: 0.9127
 Site-Real                      (2) | Train Loss: 0.3439 | Train Acc: 0.9435
 Site-Real                      (2) | Train Loss: 0.3423 | Train Acc: 0.9516
 Site-Real                      (2) | Train Loss: 0.3845 | Train Acc: 0.9454
 Site-Painting                  (3) | Train Loss: 0.6069 | Train Acc: 0.8299
 Site-Painting                  (3) | Train Loss: 0.6403 | Train Acc: 0.8204
 Site-Painting                  (3) | Train Loss: 0.5315 | Train Acc: 0.8754
 Site-Sketch                    (5) | Train Loss: 0.5933 | Train Acc: 0.8168
 Site-Sketch                    (5) | Train Loss: 0.6071 | Train Acc: 0.7828
 Site-QuickDraw                 (1) | Train Loss: 1.1133 | Train Acc: 0.6514
 Site-Infograph                 (4) | Train Loss: 1.3066 | Train Acc: 0.5855
Average Train Accuracy: 0.8398
 Site-Clipart                   (0) | Val  Loss: 0.4389 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.5005 | Val  Acc: 0.8692
 Site-Clipart                   (0) | Val  Loss: 0.5430 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.5136 | Val  Acc: 0.8476
 Site-Clipart                   (0) | Val  Loss: 0.5835 | Val  Acc: 0.8373
 Site-Real                      (2) | Val  Loss: 0.3482 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.3430 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.3251 | Val  Acc: 0.9455
 Site-Real                      (2) | Val  Loss: 0.3574 | Val  Acc: 0.9481
 Site-Painting                  (3) | Val  Loss: 0.3935 | Val  Acc: 0.9184
 Site-Painting                  (3) | Val  Loss: 0.5039 | Val  Acc: 0.8394
 Site-Painting                  (3) | Val  Loss: 0.5298 | Val  Acc: 0.8750
 Site-Sketch                    (5) | Val  Loss: 0.5862 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.6664 | Val  Acc: 0.8090
 Site-QuickDraw                 (1) | Val  Loss: 1.2198 | Val  Acc: 0.6514
 Site-Infograph                 (4) | Val  Loss: 1.2913 | Val  Acc: 0.5897
Average Valid Accuracy: 0.8501
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8816
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8692
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8733
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8476
 Best site-Clipart                  (0)  | Epoch:17 | Val Acc: 0.8373
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9405
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9455
 Best site-Real                     (2)  | Epoch:17 | Val Acc: 0.9481
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.9184
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8394
 Best site-Painting                 (3)  | Epoch:17 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8346
 Best site-Sketch                   (5)  | Epoch:17 | Val Acc: 0.8090
 Best site-QuickDraw                (1)  | Epoch:17 | Val Acc: 0.6514
 Best site-Infograph                (4)  | Epoch:17 | Val Acc: 0.5897
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-Clipart                   (1) | Train Loss: 0.4069 | Train Acc: 0.8870
 Site-Clipart                   (1) | Train Loss: 0.2721 | Train Acc: 0.9441
 Site-Clipart                   (1) | Train Loss: 0.4307 | Train Acc: 0.8622
 Site-Clipart                   (1) | Train Loss: 0.3697 | Train Acc: 0.8829
 Site-Clipart                   (1) | Train Loss: 0.3741 | Train Acc: 0.9005
 Site-Real                      (2) | Train Loss: 0.3142 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.2184 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.2297 | Train Acc: 0.9315
 Site-Real                      (2) | Train Loss: 0.2644 | Train Acc: 0.9425
 Site-Painting                  (4) | Train Loss: 0.4522 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3457 | Train Acc: 0.9078
 Site-Painting                  (4) | Train Loss: 0.3633 | Train Acc: 0.9100
 Site-Sketch                    (5) | Train Loss: 0.4598 | Train Acc: 0.8429
 Site-Sketch                    (5) | Train Loss: 0.5227 | Train Acc: 0.8577
 Site-QuickDraw                 (3) | Train Loss: 0.8091 | Train Acc: 0.7615
 Site-Infograph                 (0) | Train Loss: 0.9291 | Train Acc: 0.7137
Average Train Accuracy: 0.8820
 Site-Clipart                   (1) | Val  Loss: 0.2550 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.2942 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.3416 | Val  Acc: 0.8800
 Site-Clipart                   (1) | Val  Loss: 0.4040 | Val  Acc: 0.8619
 Site-Clipart                   (1) | Val  Loss: 0.4383 | Val  Acc: 0.8712
 Site-Real                      (2) | Val  Loss: 0.2227 | Val  Acc: 0.9405
 Site-Real                      (2) | Val  Loss: 0.2459 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.2224 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.2394 | Val  Acc: 0.9610
 Site-Painting                  (4) | Val  Loss: 0.2611 | Val  Acc: 0.9694
 Site-Painting                  (4) | Val  Loss: 0.3303 | Val  Acc: 0.9270
 Site-Painting                  (4) | Val  Loss: 0.3529 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.4446 | Val  Acc: 0.8740
 Site-Sketch                    (5) | Val  Loss: 0.4553 | Val  Acc: 0.8371
 Site-QuickDraw                 (3) | Val  Loss: 0.8136 | Val  Acc: 0.7615
 Site-Infograph                 (0) | Val  Loss: 1.0126 | Val  Acc: 0.6731
Average Valid Accuracy: 0.8879
============ Train epoch 39 ============
cnt=[1, 5, 4, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-Clipart                   (1) | Train Loss: 0.5466 | Train Acc: 0.8435
 Site-Clipart                   (1) | Train Loss: 0.4420 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.6014 | Train Acc: 0.8533
 Site-Clipart                   (1) | Train Loss: 0.5044 | Train Acc: 0.8481
 Site-Clipart                   (1) | Train Loss: 0.5391 | Train Acc: 0.8688
 Site-Real                      (2) | Train Loss: 0.4051 | Train Acc: 0.9206
 Site-Real                      (2) | Train Loss: 0.3190 | Train Acc: 0.9492
 Site-Real                      (2) | Train Loss: 0.3406 | Train Acc: 0.9395
 Site-Real                      (2) | Train Loss: 0.3904 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.6561 | Train Acc: 0.8231
 Site-Painting                  (4) | Train Loss: 0.5721 | Train Acc: 0.8592
 Site-Painting                  (4) | Train Loss: 0.5194 | Train Acc: 0.8547
 Site-Sketch                    (5) | Train Loss: 0.5809 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.5988 | Train Acc: 0.8165
 Site-QuickDraw                 (0) | Train Loss: 1.0727 | Train Acc: 0.6789
 Site-Infograph                 (3) | Train Loss: 1.2690 | Train Acc: 0.5897
Average Train Accuracy: 0.8458
 Site-Clipart                   (1) | Val  Loss: 0.4264 | Val  Acc: 0.8684
 Site-Clipart                   (1) | Val  Loss: 0.4465 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.4999 | Val  Acc: 0.8533
 Site-Clipart                   (1) | Val  Loss: 0.5028 | Val  Acc: 0.8429
 Site-Clipart                   (1) | Val  Loss: 0.5783 | Val  Acc: 0.8475
 Site-Real                      (2) | Val  Loss: 0.3288 | Val  Acc: 0.9286
 Site-Real                      (2) | Val  Loss: 0.3419 | Val  Acc: 0.9407
 Site-Real                      (2) | Val  Loss: 0.3238 | Val  Acc: 0.9333
 Site-Real                      (2) | Val  Loss: 0.3406 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.4209 | Val  Acc: 0.8980
 Site-Painting                  (4) | Val  Loss: 0.4651 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.5253 | Val  Acc: 0.8698
 Site-Sketch                    (5) | Val  Loss: 0.5675 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6205 | Val  Acc: 0.8146
 Site-QuickDraw                 (0) | Val  Loss: 1.1823 | Val  Acc: 0.6789
 Site-Infograph                 (3) | Val  Loss: 1.2455 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8532
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8684
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.9065
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8533
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8429
 Best site-Clipart                  (1)  | Epoch:18 | Val Acc: 0.8475
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9286
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9407
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9333
 Best site-Real                     (2)  | Epoch:18 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8980
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8613
 Best site-Painting                 (4)  | Epoch:18 | Val Acc: 0.8698
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:18 | Val Acc: 0.8146
 Best site-QuickDraw                (0)  | Epoch:18 | Val Acc: 0.6789
 Best site-Infograph                (3)  | Epoch:18 | Val Acc: 0.6090
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 3, 1, 1, 5, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-Clipart                   (4) | Train Loss: 0.4590 | Train Acc: 0.8783
 Site-Clipart                   (4) | Train Loss: 0.3125 | Train Acc: 0.9255
 Site-Clipart                   (4) | Train Loss: 0.3947 | Train Acc: 0.8800
 Site-Clipart                   (4) | Train Loss: 0.3892 | Train Acc: 0.8734
 Site-Clipart                   (4) | Train Loss: 0.3905 | Train Acc: 0.9050
 Site-Real                      (5) | Train Loss: 0.3197 | Train Acc: 0.9206
 Site-Real                      (5) | Train Loss: 0.2213 | Train Acc: 0.9661
 Site-Real                      (5) | Train Loss: 0.2155 | Train Acc: 0.9476
 Site-Real                      (5) | Train Loss: 0.2780 | Train Acc: 0.9483
 Site-Painting                  (1) | Train Loss: 0.3832 | Train Acc: 0.9048
 Site-Painting                  (1) | Train Loss: 0.3403 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.3426 | Train Acc: 0.9343
 Site-Sketch                    (0) | Train Loss: 0.4472 | Train Acc: 0.8429
 Site-Sketch                    (0) | Train Loss: 0.4334 | Train Acc: 0.8652
 Site-QuickDraw                 (2) | Train Loss: 0.7385 | Train Acc: 0.7829
 Site-Infograph                 (3) | Train Loss: 0.9436 | Train Acc: 0.6966
Average Train Accuracy: 0.8856
 Site-Clipart                   (4) | Val  Loss: 0.2767 | Val  Acc: 0.9211
 Site-Clipart                   (4) | Val  Loss: 0.3058 | Val  Acc: 0.9159
 Site-Clipart                   (4) | Val  Loss: 0.3355 | Val  Acc: 0.9133
 Site-Clipart                   (4) | Val  Loss: 0.3583 | Val  Acc: 0.9095
 Site-Clipart                   (4) | Val  Loss: 0.4653 | Val  Acc: 0.8542
 Site-Real                      (5) | Val  Loss: 0.2252 | Val  Acc: 0.9643
 Site-Real                      (5) | Val  Loss: 0.2119 | Val  Acc: 0.9661
 Site-Real                      (5) | Val  Loss: 0.2111 | Val  Acc: 0.9576
 Site-Real                      (5) | Val  Loss: 0.2251 | Val  Acc: 0.9654
 Site-Painting                  (1) | Val  Loss: 0.2396 | Val  Acc: 0.9592
 Site-Painting                  (1) | Val  Loss: 0.3231 | Val  Acc: 0.9197
 Site-Painting                  (1) | Val  Loss: 0.3197 | Val  Acc: 0.9427
 Site-Sketch                    (0) | Val  Loss: 0.4245 | Val  Acc: 0.8661
 Site-Sketch                    (0) | Val  Loss: 0.4802 | Val  Acc: 0.8258
 Site-QuickDraw                 (2) | Val  Loss: 0.8162 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 0.9976 | Val  Acc: 0.6795
Average Valid Accuracy: 0.8951
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.9211
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.9159
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.9133
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.9095
 Best site-Clipart                  (4)  | Epoch:39 | Val Acc: 0.8542
 Best site-Real                     (5)  | Epoch:39 | Val Acc: 0.9643
 Best site-Real                     (5)  | Epoch:39 | Val Acc: 0.9661
 Best site-Real                     (5)  | Epoch:39 | Val Acc: 0.9576
 Best site-Real                     (5)  | Epoch:39 | Val Acc: 0.9654
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9592
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9197
 Best site-Painting                 (1)  | Epoch:39 | Val Acc: 0.9427
 Best site-Sketch                   (0)  | Epoch:39 | Val Acc: 0.8661
 Best site-Sketch                   (0)  | Epoch:39 | Val Acc: 0.8258
 Best site-QuickDraw                (2)  | Epoch:39 | Val Acc: 0.7615
 Best site-Infograph                (3)  | Epoch:39 | Val Acc: 0.6795
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Test site-Clipart                   (4)| Epoch:39 | Test Acc: 0.8859
 Test site-Real                      (5)| Epoch:39 | Test Acc: 0.9433
 Test site-Painting                  (1)| Epoch:39 | Test Acc: 0.9241
 Test site-Sketch                    (0)| Epoch:39 | Test Acc: 0.8881
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-Clipart                   (0) | Train Loss: 0.5667 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.4280 | Train Acc: 0.8882
 Test site-QuickDraw                 (2)| Epoch:39 | Test Acc: 0.7470
 Site-Clipart                   (0) | Train Loss: 0.5831 | Train Acc: 0.8267
 Site-Clipart                   (0) | Train Loss: 0.5064 | Train Acc: 0.8608
 Site-Clipart                   (0) | Train Loss: 0.5377 | Train Acc: 0.8597
 Site-Real                      (1) | Train Loss: 0.3914 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.3155 | Train Acc: 0.9605
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5403
Clipart: 0.8859, Real: 0.9433, Painting: 0.9241, Sketch: 0.8881, QuickDraw: 0.7470, Infograph: 0.5403, 
Average Test Accuracy(group): 0.8215, Average Test Accuracy(individual): 0.8774,
domain std=0.1406, cluster std=0.1406, individual std=0.0985, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 40 ============
 Site-Real                      (1) | Train Loss: 0.3137 | Train Acc: 0.9355
 Site-Real                      (1) | Train Loss: 0.3837 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.6365 | Train Acc: 0.8435
 Site-Painting                  (4) | Train Loss: 0.5222 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4847 | Train Acc: 0.8720
 Site-Sketch                    (5) | Train Loss: 0.5929 | Train Acc: 0.8063
 Site-Sketch                    (5) | Train Loss: 0.5332 | Train Acc: 0.8315
 Site-QuickDraw                 (3) | Train Loss: 1.0646 | Train Acc: 0.6789
 Site-Infograph                 (2) | Train Loss: 1.2581 | Train Acc: 0.5812
Average Train Accuracy: 0.8462
 Site-Clipart                   (0) | Val  Loss: 0.4376 | Val  Acc: 0.8421
 Site-Clipart                   (0) | Val  Loss: 0.4706 | Val  Acc: 0.8879
 Site-Clipart                   (0) | Val  Loss: 0.4916 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4979 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.5625 | Val  Acc: 0.8644
 Site-Real                      (1) | Val  Loss: 0.3017 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2885 | Val  Acc: 0.9492
 Site-Real                      (1) | Val  Loss: 0.3368 | Val  Acc: 0.9333
 Site-Real                      (1) | Val  Loss: 0.3471 | Val  Acc: 0.9394
 Site-Painting                  (4) | Val  Loss: 0.4337 | Val  Acc: 0.8878
 Site-Painting                  (4) | Val  Loss: 0.4483 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.5132 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.5768 | Val  Acc: 0.8425
 Site-Sketch                    (5) | Val  Loss: 0.6468 | Val  Acc: 0.7809
 Site-QuickDraw                 (3) | Val  Loss: 1.1678 | Val  Acc: 0.6835
 Site-Infograph                 (2) | Val  Loss: 1.2391 | Val  Acc: 0.6218
Average Valid Accuracy: 0.8567
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8421
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8879
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8667
 Best site-Clipart                  (0)  | Epoch:19 | Val Acc: 0.8644
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9492
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9333
 Best site-Real                     (1)  | Epoch:19 | Val Acc: 0.9394
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8878
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:19 | Val Acc: 0.8906
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.8425
 Best site-Sketch                   (5)  | Epoch:19 | Val Acc: 0.7809
 Best site-QuickDraw                (3)  | Epoch:19 | Val Acc: 0.6835
 Best site-Infograph                (2)  | Epoch:19 | Val Acc: 0.6218
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:19 | Test Acc: 0.8688
 Test site-Real                      (1)| Epoch:19 | Test Acc: 0.9425
 Test site-Painting                  (4)| Epoch:19 | Test Acc: 0.9079
 Test site-Sketch                    (5)| Epoch:19 | Test Acc: 0.8682
 Test site-QuickDraw                 (3)| Epoch:19 | Test Acc: 0.6770
 Test site-Infograph                 (2)| Epoch:19 | Test Acc: 0.5419
Clipart: 0.8688, Real: 0.9425, Painting: 0.9079, Sketch: 0.8682, QuickDraw: 0.6770, Infograph: 0.5419, 
Average Test Accuracy(group): 0.8011, Average Test Accuracy(individual): 0.8621,
domain std=0.1432, cluster std=0.1432, individual std=0.1029, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 20 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-Clipart                   (1) | Train Loss: 0.3996 | Train Acc: 0.8783
 Site-Clipart                   (1) | Train Loss: 0.3065 | Train Acc: 0.9006
 Site-Clipart                   (1) | Train Loss: 0.4312 | Train Acc: 0.8889
 Site-Clipart                   (1) | Train Loss: 0.3775 | Train Acc: 0.8797
 Site-Clipart                   (1) | Train Loss: 0.3552 | Train Acc: 0.9027
 Site-Real                      (0) | Train Loss: 0.3284 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.2125 | Train Acc: 0.9605
 Site-Real                      (0) | Train Loss: 0.2337 | Train Acc: 0.9315
 Site-Real                      (0) | Train Loss: 0.2618 | Train Acc: 0.9511
 Site-Painting                  (4) | Train Loss: 0.4306 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3617 | Train Acc: 0.8932
 Site-Painting                  (4) | Train Loss: 0.3035 | Train Acc: 0.9446
 Site-Sketch                    (5) | Train Loss: 0.4592 | Train Acc: 0.8377
 Site-Sketch                    (5) | Train Loss: 0.4421 | Train Acc: 0.8577
 Site-QuickDraw                 (2) | Train Loss: 0.6991 | Train Acc: 0.7859
 Site-Infograph                 (3) | Train Loss: 0.9424 | Train Acc: 0.7009
Average Train Accuracy: 0.8832
 Site-Clipart                   (1) | Val  Loss: 0.2947 | Val  Acc: 0.8947
 Site-Clipart                   (1) | Val  Loss: 0.2879 | Val  Acc: 0.9252
 Site-Clipart                   (1) | Val  Loss: 0.3471 | Val  Acc: 0.9000
 Site-Clipart                   (1) | Val  Loss: 0.3647 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.4307 | Val  Acc: 0.8712
 Site-Real                      (0) | Val  Loss: 0.2195 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2250 | Val  Acc: 0.9322
 Site-Real                      (0) | Val  Loss: 0.1986 | Val  Acc: 0.9455
 Site-Real                      (0) | Val  Loss: 0.2226 | Val  Acc: 0.9567
 Site-Painting                  (4) | Val  Loss: 0.2744 | Val  Acc: 0.9286
 Site-Painting                  (4) | Val  Loss: 0.2996 | Val  Acc: 0.9416
 Site-Painting                  (4) | Val  Loss: 0.3376 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4006 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.4910 | Val  Acc: 0.8315
 Site-QuickDraw                 (2) | Val  Loss: 0.7936 | Val  Acc: 0.7890
 Site-Infograph                 (3) | Val  Loss: 0.9890 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8878
 Test site-Clipart                   (1)| Epoch:39 | Test Acc: 0.8840
 Test site-Real                      (0)| Epoch:39 | Test Acc: 0.9417
 Test site-Painting                  (4)| Epoch:39 | Test Acc: 0.9241
 Test site-Sketch                    (5)| Epoch:39 | Test Acc: 0.8935
cnt=[3, 5, 1, 2, 4, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-Clipart                   (1) | Train Loss: 0.5095 | Train Acc: 0.8522
 Site-Clipart                   (1) | Train Loss: 0.4052 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.5399 | Train Acc: 0.8667
 Site-Clipart                   (1) | Train Loss: 0.5099 | Train Acc: 0.8544
 Test site-QuickDraw                 (2)| Epoch:39 | Test Acc: 0.7510
 Site-Clipart                   (1) | Train Loss: 0.5295 | Train Acc: 0.8552
 Site-Real                      (4) | Train Loss: 0.3936 | Train Acc: 0.9127
 Site-Real                      (4) | Train Loss: 0.3171 | Train Acc: 0.9492
 Site-Real                      (4) | Train Loss: 0.3013 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.3631 | Train Acc: 0.9454
 Test site-Infograph                 (3)| Epoch:39 | Test Acc: 0.5479
Clipart: 0.8840, Real: 0.9417, Painting: 0.9241, Sketch: 0.8935, QuickDraw: 0.7510, Infograph: 0.5479, 
Average Test Accuracy(group): 0.8237, Average Test Accuracy(individual): 0.8778,
domain std=0.1377, cluster std=0.1377, individual std=0.0963, 
Average Test Accuracy: 0.8237
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 41 ============
 Site-Painting                  (0) | Train Loss: 0.4717 | Train Acc: 0.8571
 Site-Painting                  (0) | Train Loss: 0.5833 | Train Acc: 0.8641
 Site-Painting                  (0) | Train Loss: 0.4733 | Train Acc: 0.9135
 Site-Sketch                    (3) | Train Loss: 0.5315 | Train Acc: 0.8482
 Site-Sketch                    (3) | Train Loss: 0.5481 | Train Acc: 0.8240
 Site-QuickDraw                 (2) | Train Loss: 1.0282 | Train Acc: 0.6942
 Site-Infograph                 (5) | Train Loss: 1.2169 | Train Acc: 0.5940
Average Train Accuracy: 0.8557
 Site-Clipart                   (1) | Val  Loss: 0.3863 | Val  Acc: 0.8684
 Site-Clipart                   (1) | Val  Loss: 0.4166 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.5067 | Val  Acc: 0.8667
 Site-Clipart                   (1) | Val  Loss: 0.5119 | Val  Acc: 0.8476
 Site-Clipart                   (1) | Val  Loss: 0.5699 | Val  Acc: 0.8542
 Site-Real                      (4) | Val  Loss: 0.3230 | Val  Acc: 0.9286
 Site-Real                      (4) | Val  Loss: 0.3011 | Val  Acc: 0.9237
 Site-Real                      (4) | Val  Loss: 0.3217 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.3201 | Val  Acc: 0.9524
 Site-Painting                  (0) | Val  Loss: 0.3976 | Val  Acc: 0.9184
 Site-Painting                  (0) | Val  Loss: 0.4305 | Val  Acc: 0.8759
 Site-Painting                  (0) | Val  Loss: 0.4862 | Val  Acc: 0.8802
 Site-Sketch                    (3) | Val  Loss: 0.4911 | Val  Acc: 0.8504
 Site-Sketch                    (3) | Val  Loss: 0.5790 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 1.1404 | Val  Acc: 0.6835
 Site-Infograph                 (5) | Val  Loss: 1.1422 | Val  Acc: 0.6410
Average Valid Accuracy: 0.8591
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8684
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.9065
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8476
 Best site-Clipart                  (1)  | Epoch:20 | Val Acc: 0.8542
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9286
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9237
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9394
 Best site-Real                     (4)  | Epoch:20 | Val Acc: 0.9524
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.9184
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8759
 Best site-Painting                 (0)  | Epoch:20 | Val Acc: 0.8802
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.8504
 Best site-Sketch                   (3)  | Epoch:20 | Val Acc: 0.8090
 Best site-QuickDraw                (2)  | Epoch:20 | Val Acc: 0.6835
 Best site-Infograph                (5)  | Epoch:20 | Val Acc: 0.6410
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 21 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-Clipart                   (1) | Train Loss: 0.3737 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.3020 | Train Acc: 0.9255
 Site-Clipart                   (1) | Train Loss: 0.4283 | Train Acc: 0.8756
 Site-Clipart                   (1) | Train Loss: 0.3527 | Train Acc: 0.8956
 Site-Clipart                   (1) | Train Loss: 0.3312 | Train Acc: 0.9276
 Site-Real                      (0) | Train Loss: 0.3069 | Train Acc: 0.9365
 Site-Real                      (0) | Train Loss: 0.2193 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2279 | Train Acc: 0.9395
 Site-Real                      (0) | Train Loss: 0.2389 | Train Acc: 0.9454
 Site-Painting                  (4) | Train Loss: 0.3912 | Train Acc: 0.8980
 Site-Painting                  (4) | Train Loss: 0.3388 | Train Acc: 0.9078
 Site-Painting                  (4) | Train Loss: 0.3227 | Train Acc: 0.9239
 Site-Sketch                    (5) | Train Loss: 0.4138 | Train Acc: 0.8691
 Site-Sketch                    (5) | Train Loss: 0.4315 | Train Acc: 0.8614
 Site-QuickDraw                 (3) | Train Loss: 0.6788 | Train Acc: 0.7798
 Site-Infograph                 (2) | Train Loss: 0.8956 | Train Acc: 0.7436
Average Train Accuracy: 0.8936
 Site-Clipart                   (1) | Val  Loss: 0.2663 | Val  Acc: 0.9079
 Site-Clipart                   (1) | Val  Loss: 0.2963 | Val  Acc: 0.9252
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-Clipart                   (1) | Val  Loss: 0.3285 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Train Loss: 0.4478 | Train Acc: 0.8696
 Site-Clipart                   (1) | Val  Loss: 0.3755 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Train Loss: 0.4295 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.5421 | Train Acc: 0.8489
 Site-Clipart                   (1) | Val  Loss: 0.4220 | Val  Acc: 0.8746
 Site-Real                      (0) | Val  Loss: 0.2240 | Val  Acc: 0.9405
 Site-Real                      (0) | Val  Loss: 0.2544 | Val  Acc: 0.9068
 Site-Clipart                   (0) | Train Loss: 0.4750 | Train Acc: 0.8766
 Site-Real                      (0) | Val  Loss: 0.2177 | Val  Acc: 0.9273
 Site-Real                      (0) | Val  Loss: 0.2174 | Val  Acc: 0.9610
 Site-Clipart                   (0) | Train Loss: 0.4924 | Train Acc: 0.8710
 Site-Painting                  (4) | Val  Loss: 0.2076 | Val  Acc: 0.9694
 Site-Real                      (1) | Train Loss: 0.3956 | Train Acc: 0.9127
 Site-Painting                  (4) | Val  Loss: 0.2945 | Val  Acc: 0.9051
 Site-Real                      (1) | Train Loss: 0.2956 | Train Acc: 0.9661
 Site-Painting                  (4) | Val  Loss: 0.3032 | Val  Acc: 0.9375
 Site-Sketch                    (5) | Val  Loss: 0.4473 | Val  Acc: 0.8504
 Site-Real                      (1) | Train Loss: 0.2806 | Train Acc: 0.9435
 Site-Sketch                    (5) | Val  Loss: 0.4880 | Val  Acc: 0.8483
 Site-Real                      (1) | Train Loss: 0.3201 | Train Acc: 0.9425
 Site-QuickDraw                 (3) | Val  Loss: 0.7948 | Val  Acc: 0.7569
 Site-Painting                  (4) | Train Loss: 0.5065 | Train Acc: 0.8571
 Site-Infograph                 (2) | Val  Loss: 0.9884 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8879
 Site-Painting                  (4) | Train Loss: 0.4570 | Train Acc: 0.8738
 Site-Painting                  (4) | Train Loss: 0.4339 | Train Acc: 0.8962
 Site-Sketch                    (5) | Train Loss: 0.5532 | Train Acc: 0.8325
 Test site-Clipart                   (1)| Epoch:40 | Test Acc: 0.8859
 Site-Sketch                    (5) | Train Loss: 0.5217 | Train Acc: 0.8427
 Site-QuickDraw                 (2) | Train Loss: 1.0620 | Train Acc: 0.6789
 Site-Infograph                 (3) | Train Loss: 1.1648 | Train Acc: 0.6325
Average Train Accuracy: 0.8602
 Site-Clipart                   (0) | Val  Loss: 0.4073 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Val  Loss: 0.4443 | Val  Acc: 0.8972
 Site-Clipart                   (0) | Val  Loss: 0.4854 | Val  Acc: 0.8867
 Site-Clipart                   (0) | Val  Loss: 0.4687 | Val  Acc: 0.8714
 Site-Clipart                   (0) | Val  Loss: 0.5664 | Val  Acc: 0.8373
 Site-Real                      (1) | Val  Loss: 0.2942 | Val  Acc: 0.9524
 Test site-Real                      (0)| Epoch:40 | Test Acc: 0.9425
 Site-Real                      (1) | Val  Loss: 0.3160 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.3132 | Val  Acc: 0.9152
 Site-Real                      (1) | Val  Loss: 0.3213 | Val  Acc: 0.9437
 Site-Painting                  (4) | Val  Loss: 0.4147 | Val  Acc: 0.8776
 Site-Painting                  (4) | Val  Loss: 0.4792 | Val  Acc: 0.8540
 Site-Painting                  (4) | Val  Loss: 0.4785 | Val  Acc: 0.8750
 Test site-Painting                  (4)| Epoch:40 | Test Acc: 0.9241
 Site-Sketch                    (5) | Val  Loss: 0.5392 | Val  Acc: 0.8583
 Site-Sketch                    (5) | Val  Loss: 0.5974 | Val  Acc: 0.7978
 Site-QuickDraw                 (2) | Val  Loss: 1.0819 | Val  Acc: 0.7064
 Site-Infograph                 (3) | Val  Loss: 1.1646 | Val  Acc: 0.6667
Average Valid Accuracy: 0.8609
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8947
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8972
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8867
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8714
 Best site-Clipart                  (0)  | Epoch:21 | Val Acc: 0.8373
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9524
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9152
 Best site-Real                     (1)  | Epoch:21 | Val Acc: 0.9437
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8776
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8540
 Best site-Painting                 (4)  | Epoch:21 | Val Acc: 0.8750
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.8583
 Best site-Sketch                   (5)  | Epoch:21 | Val Acc: 0.7978
 Best site-QuickDraw                (2)  | Epoch:21 | Val Acc: 0.7064
 Best site-Infograph                (3)  | Epoch:21 | Val Acc: 0.6667
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 22 ============
 Test site-Sketch                    (5)| Epoch:40 | Test Acc: 0.8953
 Test site-QuickDraw                 (3)| Epoch:40 | Test Acc: 0.7590
 Test site-Infograph                 (2)| Epoch:40 | Test Acc: 0.5495
Clipart: 0.8859, Real: 0.9425, Painting: 0.9241, Sketch: 0.8953, QuickDraw: 0.7590, Infograph: 0.5495, 
Average Test Accuracy(group): 0.8260, Average Test Accuracy(individual): 0.8794,
domain std=0.1370, cluster std=0.1370, individual std=0.0955, 
Average Test Accuracy: 0.8260
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 42 ============
cnt=[5, 1, 2, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-Clipart                   (0) | Train Loss: 0.5049 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.4099 | Train Acc: 0.9006
 Site-Clipart                   (0) | Train Loss: 0.5394 | Train Acc: 0.8578
 Site-Clipart                   (0) | Train Loss: 0.4486 | Train Acc: 0.8544
 Site-Clipart                   (0) | Train Loss: 0.4818 | Train Acc: 0.8778
 Site-Real                      (3) | Train Loss: 0.3653 | Train Acc: 0.9286
 Site-Real                      (3) | Train Loss: 0.2925 | Train Acc: 0.9492
 Site-Real                      (3) | Train Loss: 0.2914 | Train Acc: 0.9516
 Site-Real                      (3) | Train Loss: 0.3370 | Train Acc: 0.9511
 Site-Painting                  (5) | Train Loss: 0.4270 | Train Acc: 0.8776
 Site-Painting                  (5) | Train Loss: 0.4721 | Train Acc: 0.8883
cnt=[5, 1, 3, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-Painting                  (5) | Train Loss: 0.4706 | Train Acc: 0.8720
 Site-Clipart                   (0) | Train Loss: 0.3587 | Train Acc: 0.9130
 Site-Sketch                    (2) | Train Loss: 0.5478 | Train Acc: 0.8377
 Site-Clipart                   (0) | Train Loss: 0.2484 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.3792 | Train Acc: 0.9067
 Site-Sketch                    (2) | Train Loss: 0.5853 | Train Acc: 0.8352
 Site-QuickDraw                 (1) | Train Loss: 0.9990 | Train Acc: 0.6820
 Site-Clipart                   (0) | Train Loss: 0.3484 | Train Acc: 0.8956
 Site-Infograph                 (4) | Train Loss: 1.2165 | Train Acc: 0.5897
Average Train Accuracy: 0.8588
 Site-Clipart                   (0) | Val  Loss: 0.3898 | Val  Acc: 0.8947
 Site-Clipart                   (0) | Train Loss: 0.3553 | Train Acc: 0.8959
 Site-Clipart                   (0) | Val  Loss: 0.4454 | Val  Acc: 0.8785
 Site-Real                      (3) | Train Loss: 0.3156 | Train Acc: 0.9127
 Site-Clipart                   (0) | Val  Loss: 0.4832 | Val  Acc: 0.8867
 Site-Real                      (3) | Train Loss: 0.2166 | Train Acc: 0.9605
 Site-Clipart                   (0) | Val  Loss: 0.4534 | Val  Acc: 0.8381
 Site-Real                      (3) | Train Loss: 0.2115 | Train Acc: 0.9435
 Site-Clipart                   (0) | Val  Loss: 0.5487 | Val  Acc: 0.8339
 Site-Real                      (3) | Val  Loss: 0.3084 | Val  Acc: 0.9524
 Site-Real                      (3) | Train Loss: 0.2409 | Train Acc: 0.9511
 Site-Real                      (3) | Val  Loss: 0.3074 | Val  Acc: 0.9492
 Site-Painting                  (2) | Train Loss: 0.3544 | Train Acc: 0.9048
 Site-Real                      (3) | Val  Loss: 0.2972 | Val  Acc: 0.9394
 Site-Painting                  (2) | Train Loss: 0.3825 | Train Acc: 0.9126
 Site-Real                      (3) | Val  Loss: 0.3266 | Val  Acc: 0.9394
 Site-Painting                  (5) | Val  Loss: 0.3835 | Val  Acc: 0.8980
 Site-Painting                  (5) | Val  Loss: 0.4393 | Val  Acc: 0.8759
 Site-Painting                  (2) | Train Loss: 0.3201 | Train Acc: 0.9170
 Site-Painting                  (5) | Val  Loss: 0.4158 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Train Loss: 0.4594 | Train Acc: 0.8429
 Site-Sketch                    (2) | Val  Loss: 0.5339 | Val  Acc: 0.8504
 Site-Sketch                    (5) | Train Loss: 0.4164 | Train Acc: 0.8614
 Site-Sketch                    (2) | Val  Loss: 0.5948 | Val  Acc: 0.7978
 Site-QuickDraw                 (1) | Val  Loss: 1.0614 | Val  Acc: 0.6881
 Site-QuickDraw                 (1) | Train Loss: 0.7444 | Train Acc: 0.7920
 Site-Infograph                 (4) | Val  Loss: 1.2107 | Val  Acc: 0.6090
Average Valid Accuracy: 0.8583
============ Train epoch 23 ============
 Site-Infograph                 (4) | Train Loss: 0.8487 | Train Acc: 0.7350
Average Train Accuracy: 0.8931
 Site-Clipart                   (0) | Val  Loss: 0.2629 | Val  Acc: 0.8816
 Site-Clipart                   (0) | Val  Loss: 0.3153 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3575 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.3556 | Val  Acc: 0.8667
 Site-Clipart                   (0) | Val  Loss: 0.4248 | Val  Acc: 0.8746
 Site-Real                      (3) | Val  Loss: 0.2248 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2429 | Val  Acc: 0.9237
 Site-Real                      (3) | Val  Loss: 0.1940 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2288 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2578 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2677 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3182 | Val  Acc: 0.9167
 Site-Sketch                    (5) | Val  Loss: 0.3470 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4558 | Val  Acc: 0.8596
 Site-QuickDraw                 (1) | Val  Loss: 0.7496 | Val  Acc: 0.7798
 Site-Infograph                 (4) | Val  Loss: 0.9615 | Val  Acc: 0.7372
Average Valid Accuracy: 0.8910
 Test site-Clipart                   (0)| Epoch:41 | Test Acc: 0.8935
 Test site-Real                      (3)| Epoch:41 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:41 | Test Acc: 0.9225
 Test site-Sketch                    (5)| Epoch:41 | Test Acc: 0.8935
 Test site-QuickDraw                 (1)| Epoch:41 | Test Acc: 0.7570
 Test site-Infograph                 (4)| Epoch:41 | Test Acc: 0.5525
Clipart: 0.8935, Real: 0.9441, Painting: 0.9225, Sketch: 0.8935, QuickDraw: 0.7570, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8272, Average Test Accuracy(individual): 0.8818,
domain std=0.1366, cluster std=0.1366, individual std=0.0953, 
Average Test Accuracy: 0.8272
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 43 ============
cnt=[1, 4, 7, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-Clipart                   (2) | Train Loss: 0.5205 | Train Acc: 0.8435
 Site-Clipart                   (2) | Train Loss: 0.3811 | Train Acc: 0.9130
 Site-Clipart                   (2) | Train Loss: 0.5540 | Train Acc: 0.8667
 Site-Clipart                   (2) | Train Loss: 0.4585 | Train Acc: 0.8639
 Site-Clipart                   (2) | Train Loss: 0.4939 | Train Acc: 0.8710
 Site-Real                      (1) | Train Loss: 0.3716 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.2893 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.2921 | Train Acc: 0.9395
 Site-Real                      (1) | Train Loss: 0.3435 | Train Acc: 0.9310
 Site-Painting                  (5) | Train Loss: 0.4589 | Train Acc: 0.8639
 Site-Painting                  (5) | Train Loss: 0.4311 | Train Acc: 0.8592
 Site-Painting                  (4) | Train Loss: 0.4596 | Train Acc: 0.8789
 Site-Sketch                    (2) | Train Loss: 0.5095 | Train Acc: 0.8482
 Site-Sketch                    (2) | Train Loss: 0.5100 | Train Acc: 0.8240
 Site-QuickDraw                 (0) | Train Loss: 0.9108 | Train Acc: 0.7217
 Site-Infograph                 (3) | Train Loss: 1.1290 | Train Acc: 0.6325
Average Train Accuracy: 0.8583
 Site-Clipart                   (2) | Val  Loss: 0.3771 | Val  Acc: 0.8553
 Site-Clipart                   (2) | Val  Loss: 0.3992 | Val  Acc: 0.9252
 Site-Clipart                   (2) | Val  Loss: 0.4582 | Val  Acc: 0.8533
 Site-Clipart                   (2) | Val  Loss: 0.4325 | Val  Acc: 0.8810
 Site-Clipart                   (2) | Val  Loss: 0.5315 | Val  Acc: 0.8441
 Site-Real                      (1) | Val  Loss: 0.3087 | Val  Acc: 0.9405
 Site-Real                      (1) | Val  Loss: 0.2771 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2669 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.3139 | Val  Acc: 0.9567
 Site-Painting                  (5) | Val  Loss: 0.3359 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.3933 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.4685 | Val  Acc: 0.8906
 Site-Sketch                    (2) | Val  Loss: 0.5392 | Val  Acc: 0.8583
 Site-Sketch                    (2) | Val  Loss: 0.5305 | Val  Acc: 0.8202
 Site-QuickDraw                 (0) | Val  Loss: 1.0164 | Val  Acc: 0.7569
 Site-Infograph                 (3) | Val  Loss: 1.1443 | Val  Acc: 0.6603
Average Valid Accuracy: 0.8736
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8553
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.9252
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8533
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8810
 Best site-Clipart                  (2)  | Epoch:23 | Val Acc: 0.8441
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9405
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9407
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9576
 Best site-Real                     (1)  | Epoch:23 | Val Acc: 0.9567
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.9388
 Best site-Painting                 (5)  | Epoch:23 | Val Acc: 0.8978
 Best site-Painting                 (4)  | Epoch:23 | Val Acc: 0.8906
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8583
 Best site-Sketch                   (2)  | Epoch:23 | Val Acc: 0.8202
 Best site-QuickDraw                (0)  | Epoch:23 | Val Acc: 0.7569
 Best site-Infograph                (3)  | Epoch:23 | Val Acc: 0.6603
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 24 ============
cnt=[2, 5, 3, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-Clipart                   (1) | Train Loss: 0.3931 | Train Acc: 0.8870
 Site-Clipart                   (1) | Train Loss: 0.3105 | Train Acc: 0.9379
 Site-Clipart                   (1) | Train Loss: 0.3911 | Train Acc: 0.8889
 Site-Clipart                   (1) | Train Loss: 0.3575 | Train Acc: 0.8861
 Site-Clipart                   (1) | Train Loss: 0.3574 | Train Acc: 0.9072
 Site-Real                      (4) | Train Loss: 0.3243 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1847 | Train Acc: 0.9718
 Site-Real                      (4) | Train Loss: 0.2124 | Train Acc: 0.9435
 Site-Real                      (4) | Train Loss: 0.2567 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3640 | Train Acc: 0.8980
 Site-Painting                  (2) | Train Loss: 0.2922 | Train Acc: 0.9029
 Site-Painting                  (2) | Train Loss: 0.3099 | Train Acc: 0.9343
 Site-Sketch                    (0) | Train Loss: 0.4718 | Train Acc: 0.8377
 Site-Sketch                    (0) | Train Loss: 0.4766 | Train Acc: 0.8727
 Site-QuickDraw                 (3) | Train Loss: 0.7023 | Train Acc: 0.7951
 Site-Infograph                 (5) | Train Loss: 0.8757 | Train Acc: 0.7521
Average Train Accuracy: 0.8924
 Site-Clipart                   (1) | Val  Loss: 0.2608 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.3057 | Val  Acc: 0.9159
 Site-Clipart                   (1) | Val  Loss: 0.3664 | Val  Acc: 0.8733
 Site-Clipart                   (1) | Val  Loss: 0.3756 | Val  Acc: 0.8905
 Site-Clipart                   (1) | Val  Loss: 0.4099 | Val  Acc: 0.8847
 Site-Real                      (4) | Val  Loss: 0.2225 | Val  Acc: 0.9524
 Site-Real                      (4) | Val  Loss: 0.2302 | Val  Acc: 0.9322
 Site-Real                      (4) | Val  Loss: 0.2257 | Val  Acc: 0.9394
 Site-Real                      (4) | Val  Loss: 0.2240 | Val  Acc: 0.9610
 Site-Painting                  (2) | Val  Loss: 0.2281 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.3159 | Val  Acc: 0.9124
 Site-Painting                  (2) | Val  Loss: 0.3551 | Val  Acc: 0.9115
 Site-Sketch                    (0) | Val  Loss: 0.3900 | Val  Acc: 0.8976
 Site-Sketch                    (0) | Val  Loss: 0.3951 | Val  Acc: 0.8596
 Site-QuickDraw                 (3) | Val  Loss: 0.7673 | Val  Acc: 0.7890
 Site-Infograph                 (5) | Val  Loss: 0.9809 | Val  Acc: 0.7179
Average Valid Accuracy: 0.8950
 Test site-Clipart                   (1)| Epoch:42 | Test Acc: 0.8897
 Test site-Real                      (4)| Epoch:42 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:42 | Test Acc: 0.9273
 Test site-Sketch                    (0)| Epoch:42 | Test Acc: 0.8971
 Test site-QuickDraw                 (3)| Epoch:42 | Test Acc: 0.7620
 Test site-Infograph                 (5)| Epoch:42 | Test Acc: 0.5540
Clipart: 0.8897, Real: 0.9441, Painting: 0.9273, Sketch: 0.8971, QuickDraw: 0.7620, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8823,
domain std=0.1362, cluster std=0.1362, individual std=0.0950, 
Average Test Accuracy: 0.8291
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 44 ============
cnt=[2, 3, 1, 4, 5, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-Clipart                   (4) | Train Loss: 0.4368 | Train Acc: 0.8696
 Site-Clipart                   (4) | Train Loss: 0.3870 | Train Acc: 0.9130
 Site-Clipart                   (4) | Train Loss: 0.5589 | Train Acc: 0.8578
 Site-Clipart                   (4) | Train Loss: 0.4244 | Train Acc: 0.8956
 Site-Clipart                   (4) | Train Loss: 0.4764 | Train Acc: 0.8710
 Site-Real                      (3) | Train Loss: 0.3983 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2709 | Train Acc: 0.9661
 Site-Real                      (3) | Train Loss: 0.2903 | Train Acc: 0.9476
 Site-Real                      (3) | Train Loss: 0.3216 | Train Acc: 0.9397
 Site-Painting                  (1) | Train Loss: 0.5557 | Train Acc: 0.8639
 Site-Painting                  (1) | Train Loss: 0.4227 | Train Acc: 0.8981
 Site-Painting                  (1) | Train Loss: 0.4673 | Train Acc: 0.8789
 Site-Sketch                    (0) | Train Loss: 0.5130 | Train Acc: 0.8325
 Site-Sketch                    (0) | Train Loss: 0.5552 | Train Acc: 0.8090
 Site-QuickDraw                 (2) | Train Loss: 1.0168 | Train Acc: 0.7217
 Site-Infograph                 (5) | Train Loss: 1.1416 | Train Acc: 0.6282
Average Train Accuracy: 0.8623
 Site-Clipart                   (4) | Val  Loss: 0.3981 | Val  Acc: 0.8684
 Site-Clipart                   (4) | Val  Loss: 0.4389 | Val  Acc: 0.8879
 Site-Clipart                   (4) | Val  Loss: 0.4309 | Val  Acc: 0.8800
 Site-Clipart                   (4) | Val  Loss: 0.4672 | Val  Acc: 0.8429
 Site-Clipart                   (4) | Val  Loss: 0.5326 | Val  Acc: 0.8542
 Site-Real                      (3) | Val  Loss: 0.2960 | Val  Acc: 0.9405
 Site-Real                      (3) | Val  Loss: 0.2902 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2749 | Val  Acc: 0.9455
 Site-Real                      (3) | Val  Loss: 0.2994 | Val  Acc: 0.9351
 Site-Painting                  (1) | Val  Loss: 0.3700 | Val  Acc: 0.9082
 Site-Painting                  (1) | Val  Loss: 0.4213 | Val  Acc: 0.8978
 Site-Painting                  (1) | Val  Loss: 0.4485 | Val  Acc: 0.9010
 Site-Sketch                    (0) | Val  Loss: 0.4452 | Val  Acc: 0.8740
 Site-Sketch                    (0) | Val  Loss: 0.5693 | Val  Acc: 0.8034
 Site-QuickDraw                 (2) | Val  Loss: 1.0353 | Val  Acc: 0.7523
 Site-Infograph                 (5) | Val  Loss: 1.1473 | Val  Acc: 0.6282
Average Valid Accuracy: 0.8657
============ Train epoch 25 ============
cnt=[5, 4, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-Clipart                   (0) | Train Loss: 0.3930 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.2808 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.3911 | Train Acc: 0.8933
 Site-Clipart                   (0) | Train Loss: 0.3553 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3455 | Train Acc: 0.9140
 Site-Real                      (1) | Train Loss: 0.3155 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.1855 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.1965 | Train Acc: 0.9637
 Site-Real                      (1) | Train Loss: 0.2811 | Train Acc: 0.9310
 Site-Painting                  (4) | Train Loss: 0.4064 | Train Acc: 0.8707
 Site-Painting                  (4) | Train Loss: 0.3935 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.3289 | Train Acc: 0.9066
 Site-Sketch                    (5) | Train Loss: 0.4031 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.4736 | Train Acc: 0.8427
 Site-QuickDraw                 (2) | Train Loss: 0.7934 | Train Acc: 0.7890
 Site-Infograph                 (3) | Train Loss: 0.8937 | Train Acc: 0.7137
Average Train Accuracy: 0.8836
 Site-Clipart                   (0) | Val  Loss: 0.2120 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.2977 | Val  Acc: 0.9252
 Site-Clipart                   (0) | Val  Loss: 0.3295 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3524 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4308 | Val  Acc: 0.8814
 Site-Real                      (1) | Val  Loss: 0.2286 | Val  Acc: 0.9286
 Site-Real                      (1) | Val  Loss: 0.2170 | Val  Acc: 0.9322
 Site-Real                      (1) | Val  Loss: 0.2125 | Val  Acc: 0.9455
 Site-Real                      (1) | Val  Loss: 0.2219 | Val  Acc: 0.9524
 Site-Painting                  (4) | Val  Loss: 0.2142 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3039 | Val  Acc: 0.8978
 Site-Painting                  (4) | Val  Loss: 0.3388 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.3532 | Val  Acc: 0.9055
 Site-Sketch                    (5) | Val  Loss: 0.4590 | Val  Acc: 0.8427
 Site-QuickDraw                 (2) | Val  Loss: 0.7510 | Val  Acc: 0.7615
 Site-Infograph                 (3) | Val  Loss: 0.9693 | Val  Acc: 0.7051
Average Valid Accuracy: 0.8911
 Test site-Clipart                   (0)| Epoch:43 | Test Acc: 0.8859
cnt=[1, 5, 1, 4, 3, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-Clipart                   (1) | Train Loss: 0.4607 | Train Acc: 0.8783
 Site-Clipart                   (1) | Train Loss: 0.3644 | Train Acc: 0.9193
 Site-Clipart                   (1) | Train Loss: 0.5010 | Train Acc: 0.8711
 Site-Clipart                   (1) | Train Loss: 0.4698 | Train Acc: 0.8576
 Test site-Real                      (1)| Epoch:43 | Test Acc: 0.9433
 Site-Clipart                   (1) | Train Loss: 0.4586 | Train Acc: 0.8891
 Site-Real                      (3) | Train Loss: 0.3859 | Train Acc: 0.9048
 Site-Real                      (3) | Train Loss: 0.2507 | Train Acc: 0.9605
 Site-Real                      (3) | Train Loss: 0.2655 | Train Acc: 0.9476
 Test site-Painting                  (4)| Epoch:43 | Test Acc: 0.9305
 Site-Real                      (3) | Train Loss: 0.3001 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.4976 | Train Acc: 0.8571
 Site-Painting                  (4) | Train Loss: 0.3939 | Train Acc: 0.8835
 Site-Painting                  (4) | Train Loss: 0.4158 | Train Acc: 0.9100
 Test site-Sketch                    (5)| Epoch:43 | Test Acc: 0.9043
 Site-Sketch                    (5) | Train Loss: 0.5237 | Train Acc: 0.8272
 Site-Sketch                    (5) | Train Loss: 0.4711 | Train Acc: 0.8390
 Site-QuickDraw                 (2) | Train Loss: 0.9672 | Train Acc: 0.7462
 Site-Infograph                 (0) | Train Loss: 1.1433 | Train Acc: 0.6197
Average Train Accuracy: 0.8655
 Site-Clipart                   (1) | Val  Loss: 0.3596 | Val  Acc: 0.8553
 Site-Clipart                   (1) | Val  Loss: 0.4022 | Val  Acc: 0.8972
 Test site-QuickDraw                 (2)| Epoch:43 | Test Acc: 0.7640
 Site-Clipart                   (1) | Val  Loss: 0.4103 | Val  Acc: 0.9067
 Site-Clipart                   (1) | Val  Loss: 0.4304 | Val  Acc: 0.8762
 Site-Clipart                   (1) | Val  Loss: 0.5163 | Val  Acc: 0.8610
 Site-Real                      (3) | Val  Loss: 0.2796 | Val  Acc: 0.9524
 Site-Real                      (3) | Val  Loss: 0.2755 | Val  Acc: 0.9322
 Site-Real                      (3) | Val  Loss: 0.2636 | Val  Acc: 0.9394
 Site-Real                      (3) | Val  Loss: 0.3120 | Val  Acc: 0.9351
 Test site-Infograph                 (3)| Epoch:43 | Test Acc: 0.5464
Clipart: 0.8859, Real: 0.9433, Painting: 0.9305, Sketch: 0.9043, QuickDraw: 0.7640, Infograph: 0.5464, 
Average Test Accuracy(group): 0.8291, Average Test Accuracy(individual): 0.8821,
domain std=0.1393, cluster std=0.1393, individual std=0.0967, 
Average Test Accuracy: 0.8291
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 45 ============
 Site-Painting                  (4) | Val  Loss: 0.2997 | Val  Acc: 0.9388
 Site-Painting                  (4) | Val  Loss: 0.3963 | Val  Acc: 0.8613
 Site-Painting                  (4) | Val  Loss: 0.4102 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.4747 | Val  Acc: 0.8661
 Site-Sketch                    (5) | Val  Loss: 0.5544 | Val  Acc: 0.8090
 Site-QuickDraw                 (2) | Val  Loss: 1.0887 | Val  Acc: 0.7064
 Site-Infograph                 (0) | Val  Loss: 1.0836 | Val  Acc: 0.6923
Average Valid Accuracy: 0.8706
============ Train epoch 26 ============
cnt=[4, 5, 1, 1, 3, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-Clipart                   (1) | Train Loss: 0.3505 | Train Acc: 0.9130
 Site-Clipart                   (1) | Train Loss: 0.2886 | Train Acc: 0.9441
 Site-Clipart                   (1) | Train Loss: 0.4142 | Train Acc: 0.8800
cnt=[3, 5, 1, 4, 1, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-Clipart                   (1) | Train Loss: 0.3669 | Train Acc: 0.8829
 Site-Clipart                   (1) | Train Loss: 0.4735 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.3499 | Train Acc: 0.9503
 Site-Clipart                   (1) | Train Loss: 0.5067 | Train Acc: 0.8489
 Site-Clipart                   (1) | Train Loss: 0.3291 | Train Acc: 0.9253
 Site-Real                      (0) | Train Loss: 0.3072 | Train Acc: 0.9206
 Site-Clipart                   (1) | Train Loss: 0.4597 | Train Acc: 0.8544
 Site-Real                      (0) | Train Loss: 0.2137 | Train Acc: 0.9661
 Site-Real                      (0) | Train Loss: 0.2137 | Train Acc: 0.9556
 Site-Clipart                   (1) | Train Loss: 0.4543 | Train Acc: 0.8846
 Site-Real                      (3) | Train Loss: 0.3493 | Train Acc: 0.9127
 Site-Real                      (0) | Train Loss: 0.2505 | Train Acc: 0.9397
 Site-Real                      (3) | Train Loss: 0.2755 | Train Acc: 0.9605
 Site-Painting                  (4) | Train Loss: 0.2728 | Train Acc: 0.9388
 Site-Real                      (3) | Train Loss: 0.2658 | Train Acc: 0.9435
 Site-Painting                  (4) | Train Loss: 0.3486 | Train Acc: 0.8786
 Site-Real                      (3) | Train Loss: 0.3152 | Train Acc: 0.9368
 Site-Painting                  (4) | Train Loss: 0.3158 | Train Acc: 0.9343
 Site-Painting                  (0) | Train Loss: 0.4315 | Train Acc: 0.8844
 Site-Sketch                    (5) | Train Loss: 0.3902 | Train Acc: 0.8429
 Site-Painting                  (0) | Train Loss: 0.3865 | Train Acc: 0.8981
 Site-Sketch                    (5) | Train Loss: 0.4961 | Train Acc: 0.8689
 Site-Painting                  (0) | Train Loss: 0.4064 | Train Acc: 0.8962
 Site-QuickDraw                 (2) | Train Loss: 0.6395 | Train Acc: 0.7920
 Site-Sketch                    (5) | Train Loss: 0.5056 | Train Acc: 0.8534
 Site-Infograph                 (3) | Train Loss: 0.8630 | Train Acc: 0.7137
Average Train Accuracy: 0.8935
 Site-Sketch                    (5) | Train Loss: 0.5015 | Train Acc: 0.8464
 Site-Clipart                   (1) | Val  Loss: 0.2291 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2922 | Val  Acc: 0.9159
 Site-QuickDraw                 (2) | Train Loss: 0.9192 | Train Acc: 0.7431
 Site-Clipart                   (1) | Val  Loss: 0.3749 | Val  Acc: 0.8667
 Site-Infograph                 (4) | Train Loss: 1.0942 | Train Acc: 0.6496
Average Train Accuracy: 0.8708
 Site-Clipart                   (1) | Val  Loss: 0.3431 | Val  Acc: 0.8905
 Site-Clipart                   (1) | Val  Loss: 0.3415 | Val  Acc: 0.9342
 Site-Clipart                   (1) | Val  Loss: 0.3976 | Val  Acc: 0.9065
 Site-Clipart                   (1) | Val  Loss: 0.4276 | Val  Acc: 0.9067
 Site-Clipart                   (1) | Val  Loss: 0.4126 | Val  Acc: 0.8746
 Site-Real                      (0) | Val  Loss: 0.2217 | Val  Acc: 0.9524
 Site-Clipart                   (1) | Val  Loss: 0.4193 | Val  Acc: 0.8667
 Site-Real                      (0) | Val  Loss: 0.2258 | Val  Acc: 0.9407
 Site-Real                      (0) | Val  Loss: 0.2227 | Val  Acc: 0.9333
 Site-Clipart                   (1) | Val  Loss: 0.4890 | Val  Acc: 0.8542
 Site-Real                      (0) | Val  Loss: 0.2344 | Val  Acc: 0.9567
 Site-Real                      (3) | Val  Loss: 0.2921 | Val  Acc: 0.9405
 Site-Painting                  (4) | Val  Loss: 0.2182 | Val  Acc: 0.9490
 Site-Real                      (3) | Val  Loss: 0.2937 | Val  Acc: 0.9407
 Site-Painting                  (4) | Val  Loss: 0.2719 | Val  Acc: 0.9343
 Site-Real                      (3) | Val  Loss: 0.3051 | Val  Acc: 0.9273
 Site-Painting                  (4) | Val  Loss: 0.3193 | Val  Acc: 0.9010
 Site-Real                      (3) | Val  Loss: 0.2935 | Val  Acc: 0.9567
 Site-Sketch                    (5) | Val  Loss: 0.3462 | Val  Acc: 0.8976
 Site-Painting                  (0) | Val  Loss: 0.3257 | Val  Acc: 0.9184
 Site-Sketch                    (5) | Val  Loss: 0.4359 | Val  Acc: 0.8596
 Site-Painting                  (0) | Val  Loss: 0.3811 | Val  Acc: 0.9197
 Site-QuickDraw                 (2) | Val  Loss: 0.7443 | Val  Acc: 0.7982
 Site-Painting                  (0) | Val  Loss: 0.4596 | Val  Acc: 0.8802
 Site-Infograph                 (3) | Val  Loss: 0.9764 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8956
 Best site-Clipart                  (1)  | Epoch:45 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:45 | Val Acc: 0.9159
 Best site-Clipart                  (1)  | Epoch:45 | Val Acc: 0.8667
 Best site-Clipart                  (1)  | Epoch:45 | Val Acc: 0.8905
 Best site-Clipart                  (1)  | Epoch:45 | Val Acc: 0.8746
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9524
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9407
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9333
 Best site-Real                     (0)  | Epoch:45 | Val Acc: 0.9567
 Best site-Painting                 (4)  | Epoch:45 | Val Acc: 0.9490
 Best site-Painting                 (4)  | Epoch:45 | Val Acc: 0.9343
 Best site-Painting                 (4)  | Epoch:45 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:45 | Val Acc: 0.8976
 Best site-Sketch                   (5)  | Epoch:45 | Val Acc: 0.8596
 Best site-QuickDraw                (2)  | Epoch:45 | Val Acc: 0.7982
 Best site-Infograph                (3)  | Epoch:45 | Val Acc: 0.7115
 Site-Sketch                    (5) | Val  Loss: 0.4991 | Val  Acc: 0.8346
 Site-Sketch                    (5) | Val  Loss: 0.5456 | Val  Acc: 0.8090
 Test site-Clipart                   (1)| Epoch:45 | Test Acc: 0.8878
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9433
 Test site-Painting                  (4)| Epoch:45 | Test Acc: 0.9273
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.8989
 Test site-QuickDraw                 (2)| Epoch:45 | Test Acc: 0.7660
 Test site-Infograph                 (3)| Epoch:45 | Test Acc: 0.5525
Clipart: 0.8878, Real: 0.9433, Painting: 0.9273, Sketch: 0.8989, QuickDraw: 0.7660, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8293, Average Test Accuracy(individual): 0.8819,
domain std=0.1363, cluster std=0.1363, individual std=0.0949, 
Average Test Accuracy: 0.8293
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 46 ============
cnt=[4, 1, 5, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-Clipart                   (2) | Train Loss: 0.4029 | Train Acc: 0.8609
 Site-Clipart                   (2) | Train Loss: 0.3117 | Train Acc: 0.9317
 Site-Clipart                   (2) | Train Loss: 0.4240 | Train Acc: 0.8800
 Site-Clipart                   (2) | Train Loss: 0.3579 | Train Acc: 0.8829
 Site-Clipart                   (2) | Train Loss: 0.3243 | Train Acc: 0.9276
 Site-Real                      (0) | Train Loss: 0.3203 | Train Acc: 0.9206
 Site-Real                      (0) | Train Loss: 0.1842 | Train Acc: 0.9548
 Site-Real                      (0) | Train Loss: 0.2174 | Train Acc: 0.9516
 Site-Real                      (0) | Train Loss: 0.2686 | Train Acc: 0.9397
 Site-Painting                  (3) | Train Loss: 0.4145 | Train Acc: 0.8912
 Site-Painting                  (3) | Train Loss: 0.3027 | Train Acc: 0.8981
 Site-Painting                  (3) | Train Loss: 0.3008 | Train Acc: 0.9377
 Site-Sketch                    (5) | Train Loss: 0.4184 | Train Acc: 0.8796
 Site-Sketch                    (5) | Train Loss: 0.3839 | Train Acc: 0.8764
 Site-QuickDraw                 (1) | Train Loss: 0.6724 | Train Acc: 0.8349
 Site-Infograph                 (4) | Train Loss: 0.8328 | Train Acc: 0.7393
Average Train Accuracy: 0.8942
 Site-Clipart                   (2) | Val  Loss: 0.2222 | Val  Acc: 0.9211
 Site-Clipart                   (2) | Val  Loss: 0.3362 | Val  Acc: 0.8972
 Site-Clipart                   (2) | Val  Loss: 0.3374 | Val  Acc: 0.8933
 Site-Clipart                   (2) | Val  Loss: 0.3530 | Val  Acc: 0.8762
 Site-Clipart                   (2) | Val  Loss: 0.4136 | Val  Acc: 0.8847
 Site-Real                      (0) | Val  Loss: 0.2150 | Val  Acc: 0.9524
 Site-Real                      (0) | Val  Loss: 0.2347 | Val  Acc: 0.9068
 Site-Real                      (0) | Val  Loss: 0.1685 | Val  Acc: 0.9576
 Site-Real                      (0) | Val  Loss: 0.2224 | Val  Acc: 0.9524
 Site-Painting                  (3) | Val  Loss: 0.1995 | Val  Acc: 0.9592
 Site-Painting                  (3) | Val  Loss: 0.2525 | Val  Acc: 0.9270
 Site-Painting                  (3) | Val  Loss: 0.3390 | Val  Acc: 0.9062
 Site-Sketch                    (5) | Val  Loss: 0.3989 | Val  Acc: 0.8819
 Site-Sketch                    (5) | Val  Loss: 0.4735 | Val  Acc: 0.8371
 Site-QuickDraw                 (1) | Val  Loss: 0.7495 | Val  Acc: 0.7936
 Site-Infograph                 (4) | Val  Loss: 0.9203 | Val  Acc: 0.7115
Average Valid Accuracy: 0.8911
 Test site-Clipart                   (2)| Epoch:45 | Test Acc: 0.8878
 Test site-Real                      (0)| Epoch:45 | Test Acc: 0.9449
 Test site-Painting                  (3)| Epoch:45 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:45 | Test Acc: 0.9043
 Test site-QuickDraw                 (1)| Epoch:45 | Test Acc: 0.7680
 Test site-Infograph                 (4)| Epoch:45 | Test Acc: 0.5525
Clipart: 0.8878, Real: 0.9449, Painting: 0.9305, Sketch: 0.9043, QuickDraw: 0.7680, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8314, Average Test Accuracy(individual): 0.8837,
domain std=0.1372, cluster std=0.1372, individual std=0.0954, 
Average Test Accuracy: 0.8314
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
============ Train epoch 47 ============
cnt=[5, 4, 1, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-Clipart                   (0) | Train Loss: 0.4451 | Train Acc: 0.8870
 Site-Clipart                   (0) | Train Loss: 0.2801 | Train Acc: 0.9441
 Site-Clipart                   (0) | Train Loss: 0.4204 | Train Acc: 0.8667
 Site-Clipart                   (0) | Train Loss: 0.3704 | Train Acc: 0.8766
 Site-Clipart                   (0) | Train Loss: 0.3263 | Train Acc: 0.9208
 Site-Real                      (1) | Train Loss: 0.3100 | Train Acc: 0.9127
 Site-Real                      (1) | Train Loss: 0.2001 | Train Acc: 0.9605
 Site-Real                      (1) | Train Loss: 0.2031 | Train Acc: 0.9556
 Site-Real                      (1) | Train Loss: 0.2640 | Train Acc: 0.9339
 Site-Painting                  (5) | Train Loss: 0.4368 | Train Acc: 0.8980
 Site-Painting                  (5) | Train Loss: 0.3057 | Train Acc: 0.8932
 Site-Painting                  (5) | Train Loss: 0.2880 | Train Acc: 0.9343
 Site-Sketch                    (4) | Train Loss: 0.4150 | Train Acc: 0.8639
 Site-Sketch                    (4) | Train Loss: 0.3560 | Train Acc: 0.8914
 Site-QuickDraw                 (2) | Train Loss: 0.6339 | Train Acc: 0.8135
 Site-Infograph                 (3) | Train Loss: 0.8593 | Train Acc: 0.7308
Average Train Accuracy: 0.8927
 Site-Clipart                   (0) | Val  Loss: 0.2667 | Val  Acc: 0.9079
 Site-Clipart                   (0) | Val  Loss: 0.2871 | Val  Acc: 0.9065
 Site-Clipart                   (0) | Val  Loss: 0.3445 | Val  Acc: 0.8733
 Site-Clipart                   (0) | Val  Loss: 0.3371 | Val  Acc: 0.8952
 Site-Clipart                   (0) | Val  Loss: 0.3986 | Val  Acc: 0.8712
 Site-Real                      (1) | Val  Loss: 0.2159 | Val  Acc: 0.9524
 Site-Real                      (1) | Val  Loss: 0.2244 | Val  Acc: 0.9407
 Site-Real                      (1) | Val  Loss: 0.2067 | Val  Acc: 0.9576
 Site-Real                      (1) | Val  Loss: 0.2284 | Val  Acc: 0.9524
 Site-Painting                  (5) | Val  Loss: 0.2611 | Val  Acc: 0.9388
 Site-Painting                  (5) | Val  Loss: 0.2684 | Val  Acc: 0.9416
 Site-Painting                  (5) | Val  Loss: 0.3301 | Val  Acc: 0.9062
 Site-Sketch                    (4) | Val  Loss: 0.4081 | Val  Acc: 0.8976
 Site-Sketch                    (4) | Val  Loss: 0.4409 | Val  Acc: 0.8483
 Site-QuickDraw                 (2) | Val  Loss: 0.7424 | Val  Acc: 0.7936
 Site-Infograph                 (3) | Val  Loss: 0.9815 | Val  Acc: 0.6859
Average Valid Accuracy: 0.8918
 Test site-Clipart                   (0)| Epoch:46 | Test Acc: 0.8878
 Test site-Real                      (1)| Epoch:46 | Test Acc: 0.9449
 Test site-Painting                  (5)| Epoch:46 | Test Acc: 0.9305
 Test site-Sketch                    (4)| Epoch:46 | Test Acc: 0.9025
 Test site-QuickDraw                 (2)| Epoch:46 | Test Acc: 0.7630
 Test site-Infograph                 (3)| Epoch:46 | Test Acc: 0.5525
Clipart: 0.8878, Real: 0.9449, Painting: 0.9305, Sketch: 0.9025, QuickDraw: 0.7630, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8302, Average Test Accuracy(individual): 0.8832,
domain std=0.1375, cluster std=0.1375, individual std=0.0957, 
Average Test Accuracy: 0.8302
============ Train epoch 48 ============
cnt=[1, 5, 3, 1, 4, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-Clipart                   (1) | Train Loss: 0.4231 | Train Acc: 0.8696
 Site-Clipart                   (1) | Train Loss: 0.2542 | Train Acc: 0.9317
 Site-Clipart                   (1) | Train Loss: 0.3649 | Train Acc: 0.9111
 Site-Clipart                   (1) | Train Loss: 0.3440 | Train Acc: 0.8987
 Site-Clipart                   (1) | Train Loss: 0.3366 | Train Acc: 0.9118
 Site-Real                      (4) | Train Loss: 0.3024 | Train Acc: 0.9206
 Site-Real                      (4) | Train Loss: 0.1766 | Train Acc: 0.9661
 Site-Real                      (4) | Train Loss: 0.2184 | Train Acc: 0.9476
 Site-Real                      (4) | Train Loss: 0.2606 | Train Acc: 0.9454
 Site-Painting                  (2) | Train Loss: 0.4383 | Train Acc: 0.8912
 Site-Painting                  (2) | Train Loss: 0.3693 | Train Acc: 0.8981
 Site-Painting                  (2) | Train Loss: 0.3024 | Train Acc: 0.9308
 Site-Sketch                    (5) | Train Loss: 0.4475 | Train Acc: 0.8482
 Site-Sketch                    (5) | Train Loss: 0.4362 | Train Acc: 0.8876
 Site-QuickDraw                 (0) | Train Loss: 0.7497 | Train Acc: 0.8379
 Site-Infograph                 (3) | Train Loss: 0.8387 | Train Acc: 0.7350
Average Train Accuracy: 0.8957
 Site-Clipart                   (1) | Val  Loss: 0.2228 | Val  Acc: 0.9474
 Site-Clipart                   (1) | Val  Loss: 0.2845 | Val  Acc: 0.9346
 Site-Clipart                   (1) | Val  Loss: 0.3058 | Val  Acc: 0.8933
 Site-Clipart                   (1) | Val  Loss: 0.3202 | Val  Acc: 0.9000
 Site-Clipart                   (1) | Val  Loss: 0.4169 | Val  Acc: 0.8780
 Site-Real                      (4) | Val  Loss: 0.2311 | Val  Acc: 0.9405
 Site-Real                      (4) | Val  Loss: 0.2518 | Val  Acc: 0.9407
 Site-Real                      (4) | Val  Loss: 0.1984 | Val  Acc: 0.9515
 Site-Real                      (4) | Val  Loss: 0.2305 | Val  Acc: 0.9524
 Site-Painting                  (2) | Val  Loss: 0.2283 | Val  Acc: 0.9490
 Site-Painting                  (2) | Val  Loss: 0.2618 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3310 | Val  Acc: 0.9010
 Site-Sketch                    (5) | Val  Loss: 0.3128 | Val  Acc: 0.9134
 Site-Sketch                    (5) | Val  Loss: 0.4145 | Val  Acc: 0.8539
 Site-QuickDraw                 (0) | Val  Loss: 0.7691 | Val  Acc: 0.8028
 Site-Infograph                 (3) | Val  Loss: 0.9083 | Val  Acc: 0.7372
Average Valid Accuracy: 0.9010
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9474
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9346
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.8933
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.9000
 Best site-Clipart                  (1)  | Epoch:48 | Val Acc: 0.8780
 Best site-Real                     (4)  | Epoch:48 | Val Acc: 0.9405
 Best site-Real                     (4)  | Epoch:48 | Val Acc: 0.9407
 Best site-Real                     (4)  | Epoch:48 | Val Acc: 0.9515
 Best site-Real                     (4)  | Epoch:48 | Val Acc: 0.9524
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9490
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9197
 Best site-Painting                 (2)  | Epoch:48 | Val Acc: 0.9010
 Best site-Sketch                   (5)  | Epoch:48 | Val Acc: 0.9134
 Best site-Sketch                   (5)  | Epoch:48 | Val Acc: 0.8539
 Best site-QuickDraw                (0)  | Epoch:48 | Val Acc: 0.8028
 Best site-Infograph                (3)  | Epoch:48 | Val Acc: 0.7372
 Test site-Clipart                   (1)| Epoch:48 | Test Acc: 0.8859
 Test site-Real                      (4)| Epoch:48 | Test Acc: 0.9441
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9305
 Test site-Sketch                    (5)| Epoch:48 | Test Acc: 0.9007
 Test site-QuickDraw                 (0)| Epoch:48 | Test Acc: 0.7640
 Test site-Infograph                 (3)| Epoch:48 | Test Acc: 0.5525
Clipart: 0.8859, Real: 0.9441, Painting: 0.9305, Sketch: 0.9007, QuickDraw: 0.7640, Infograph: 0.5525, 
Average Test Accuracy(group): 0.8296, Average Test Accuracy(individual): 0.8822,
domain std=0.1370, cluster std=0.1370, individual std=0.0954, 
Average Test Accuracy: 0.8296
============ Train epoch 49 ============
cnt=[5, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-Clipart                   (0) | Train Loss: 0.4024 | Train Acc: 0.8609
 Site-Clipart                   (0) | Train Loss: 0.3024 | Train Acc: 0.9193
 Site-Clipart                   (0) | Train Loss: 0.3776 | Train Acc: 0.8844
 Site-Clipart                   (0) | Train Loss: 0.3606 | Train Acc: 0.8892
 Site-Clipart                   (0) | Train Loss: 0.3142 | Train Acc: 0.9299
 Site-Real                      (1) | Train Loss: 0.3104 | Train Acc: 0.9206
 Site-Real                      (1) | Train Loss: 0.1887 | Train Acc: 0.9548
 Site-Real                      (1) | Train Loss: 0.2003 | Train Acc: 0.9476
 Site-Real                      (1) | Train Loss: 0.2824 | Train Acc: 0.9425
 Site-Painting                  (2) | Train Loss: 0.3553 | Train Acc: 0.9184
 Site-Painting                  (2) | Train Loss: 0.3209 | Train Acc: 0.8932
 Site-Painting                  (2) | Train Loss: 0.2826 | Train Acc: 0.9343
 Site-Sketch                    (5) | Train Loss: 0.3962 | Train Acc: 0.8586
 Site-Sketch                    (5) | Train Loss: 0.4521 | Train Acc: 0.8614
 Site-QuickDraw                 (3) | Train Loss: 0.6406 | Train Acc: 0.8349
 Site-Infograph                 (4) | Train Loss: 0.8555 | Train Acc: 0.7222
Average Train Accuracy: 0.8920
 Site-Clipart                   (0) | Val  Loss: 0.2351 | Val  Acc: 0.9474
 Site-Clipart                   (0) | Val  Loss: 0.2846 | Val  Acc: 0.9159
 Site-Clipart                   (0) | Val  Loss: 0.3139 | Val  Acc: 0.8933
 Site-Clipart                   (0) | Val  Loss: 0.3189 | Val  Acc: 0.9000
 Site-Clipart                   (0) | Val  Loss: 0.4396 | Val  Acc: 0.8644
 Site-Real                      (1) | Val  Loss: 0.2095 | Val  Acc: 0.9643
 Site-Real                      (1) | Val  Loss: 0.2409 | Val  Acc: 0.9237
 Site-Real                      (1) | Val  Loss: 0.2023 | Val  Acc: 0.9394
 Site-Real                      (1) | Val  Loss: 0.2224 | Val  Acc: 0.9437
 Site-Painting                  (2) | Val  Loss: 0.2151 | Val  Acc: 0.9286
 Site-Painting                  (2) | Val  Loss: 0.3316 | Val  Acc: 0.9197
 Site-Painting                  (2) | Val  Loss: 0.3467 | Val  Acc: 0.8906
 Site-Sketch                    (5) | Val  Loss: 0.3606 | Val  Acc: 0.8976
 Site-Sketch                    (5) | Val  Loss: 0.4603 | Val  Acc: 0.8427
 Site-QuickDraw                 (3) | Val  Loss: 0.7121 | Val  Acc: 0.8119
 Site-Infograph                 (4) | Val  Loss: 0.9430 | Val  Acc: 0.7244
Average Valid Accuracy: 0.8942
 Test site-Clipart                   (0)| Epoch:48 | Test Acc: 0.8954
 Test site-Real                      (1)| Epoch:48 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:48 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:48 | Test Acc: 0.8989
 Test site-QuickDraw                 (3)| Epoch:48 | Test Acc: 0.7720
 Test site-Infograph                 (4)| Epoch:48 | Test Acc: 0.5540
Clipart: 0.8954, Real: 0.9433, Painting: 0.9257, Sketch: 0.8989, QuickDraw: 0.7720, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8316, Average Test Accuracy(individual): 0.8845,
domain std=0.1357, cluster std=0.1357, individual std=0.0941, 
Average Test Accuracy: 0.8316
 Saving the gmap checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1_gmap...
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.8954
 Test site-Real                      (1)| Epoch:49 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:49 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8989
 Test site-QuickDraw                 (3)| Epoch:49 | Test Acc: 0.7720
 Test site-Infograph                 (4)| Epoch:49 | Test Acc: 0.5540
Clipart: 0.8954, Real: 0.9433, Painting: 0.9257, Sketch: 0.8989, QuickDraw: 0.7720, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8316, Average Test Accuracy(individual): 0.8845,
domain std=0.1357, cluster std=0.1357, individual std=0.0941, 
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven_1.4_1_moon/ccop_q=1...
===2023-06-25 16:52:26===
===2023-06-25 16:52:41===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 6
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[115,161,225,316,442,126,177,248,348,147,206,289,191,267,327,234,
client_nums=[5,4,3,2,1,1,]
len_dataset=[2103,1502,1072,765,546,390,]
domain number = 6
Loading snapshots...
 Test site-Clipart                   (0)| Epoch:49 | Test Acc: 0.8954
 Test site-Real                      (1)| Epoch:49 | Test Acc: 0.9433
 Test site-Painting                  (2)| Epoch:49 | Test Acc: 0.9257
 Test site-Sketch                    (5)| Epoch:49 | Test Acc: 0.8989
 Test site-QuickDraw                 (3)| Epoch:49 | Test Acc: 0.7720
 Test site-Infograph                 (4)| Epoch:49 | Test Acc: 0.5540
Clipart: 0.8954, Real: 0.9433, Painting: 0.9257, Sketch: 0.8989, QuickDraw: 0.7720, Infograph: 0.5540, 
Average Test Accuracy(group): 0.8316, Average Test Accuracy(individual): 0.8845,
domain std=0.1357, cluster std=0.1357, individual std=0.0941, 
