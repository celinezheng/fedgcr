===2023-03-30 19:05:04===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0client-1 is in G-0client-2 is in G-0client-3 is in G-0client-4 is in G-0client-5 is in G-0client-6 is in G-0client-7 is in G-0client-8 is in G-0client-9 is in G-0clients=[(10,)(0,)(0,)]
 Site-MNIST     | Train Loss: nan | Train Acc: 0.0909
 Site-MNIST     | Train Loss: nan | Train Acc: 0.2159
 Site-SVHN      | Train Loss: nan | Train Acc: 0.0909
 Site-SVHN      | Train Loss: nan | Train Acc: 0.0682
 Site-USPS      | Train Loss: nan | Train Acc: 0.1818
 Site-USPS      | Train Loss: nan | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: nan | Train Acc: 0.1023
 Site-SynthDigits| Train Loss: nan | Train Acc: 0.0568
 Site-MNIST-M   | Train Loss: nan | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: nan | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: nan | Val  Acc: 0.2034
 Site-MNIST     | Val  Loss: nan | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: nan | Val  Acc: 0.0678
 Site-SVHN      | Val  Loss: nan | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: nan | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: nan | Val  Acc: 0.0678
 Site-SynthDigits| Val  Loss: nan | Val  Acc: 0.0847
 Site-SynthDigits| Val  Loss: nan | Val  Acc: 0.0169
 Site-MNIST-M   | Val  Loss: nan | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: nan | Val  Acc: 0.2034
Average Valid Accuracy: 0.1339
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-USPS       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.0678
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0847
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0169
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 5 ============
===2023-03-30 19:09:06===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0client-1 is in G-0client-2 is in G-0client-3 is in G-0client-4 is in G-0client-5 is in G-0client-6 is in G-0client-7 is in G-0client-8 is in G-0client-9 is in G-0clients=[(10,)(0,)(0,)]
 Site-MNIST     | Train Loss: nan | Train Acc: 0.0909
 Site-MNIST     | Train Loss: nan | Train Acc: 0.2159
 Site-SVHN      | Train Loss: nan | Train Acc: 0.0909
 Site-SVHN      | Train Loss: nan | Train Acc: 0.0682
 Site-USPS      | Train Loss: nan | Train Acc: 0.1818
 Site-USPS      | Train Loss: nan | Train Acc: 0.1591
 Site-SynthDigits| Train Loss: nan | Train Acc: 0.1023
 Site-SynthDigits| Train Loss: nan | Train Acc: 0.0568
 Site-MNIST-M   | Train Loss: nan | Train Acc: 0.0909
 Site-MNIST-M   | Train Loss: nan | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: nan | Val  Acc: 0.2034
 Site-MNIST     | Val  Loss: nan | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: nan | Val  Acc: 0.0678
 Site-SVHN      | Val  Loss: nan | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: nan | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: nan | Val  Acc: 0.0678
 Site-SynthDigits| Val  Loss: nan | Val  Acc: 0.0847
 Site-SynthDigits| Val  Loss: nan | Val  Acc: 0.0169
 Site-MNIST-M   | Val  Loss: nan | Val  Acc: 0.2034
 Site-MNIST-M   | Val  Loss: nan | Val  Acc: 0.2034
Average Valid Accuracy: 0.1339
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST      | Epoch:0 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-USPS       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.0678
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0847
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0169
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 5 ============
===2023-03-30 19:13:37===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
===2023-03-30 19:14:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
clients=[(6,)(0,)(4,)]
 Site-MNIST     | Train Loss: 2.2295 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.1638 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.3552 | Train Acc: 0.1023
 Site-SVHN      | Train Loss: 2.3171 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1472 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1721 | Train Acc: 0.1477
 Site-SynthDigits| Train Loss: 2.2948 | Train Acc: 0.1023
 Site-SynthDigits| Train Loss: 2.2859 | Train Acc: 0.0682
 Site-MNIST-M   | Train Loss: 2.3488 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.3185 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1914 | Val  Acc: 0.1525
 Site-MNIST     | Val  Loss: 2.2006 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.3213 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3289 | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: 2.1964 | Val  Acc: 0.1186
 Site-USPS      | Val  Loss: 2.1422 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.2801 | Val  Acc: 0.0508
 Site-SynthDigits| Val  Loss: 2.2850 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2934 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3303 | Val  Acc: 0.0508
Average Valid Accuracy: 0.1237
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-USPS       | Epoch:0 | Val Acc: 0.1186
 Best site-USPS       | Epoch:0 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0508
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0508
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 1 ============
===2023-03-30 19:16:12===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 1
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
clients=[(6,)(0,)(4,)]
 Site-MNIST     | Train Loss: 2.2295 | Train Acc: 0.1818
 Site-MNIST     | Train Loss: 2.1638 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 2.3552 | Train Acc: 0.1023
 Site-SVHN      | Train Loss: 2.3171 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1472 | Train Acc: 0.1364
 Site-USPS      | Train Loss: 2.1721 | Train Acc: 0.1477
 Site-SynthDigits| Train Loss: 2.2948 | Train Acc: 0.1023
 Site-SynthDigits| Train Loss: 2.2859 | Train Acc: 0.0682
 Site-MNIST-M   | Train Loss: 2.3488 | Train Acc: 0.1250
 Site-MNIST-M   | Train Loss: 2.3185 | Train Acc: 0.1136
 Site-MNIST     | Val  Loss: 2.1914 | Val  Acc: 0.1525
 Site-MNIST     | Val  Loss: 2.2006 | Val  Acc: 0.1864
 Site-SVHN      | Val  Loss: 2.3213 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.3289 | Val  Acc: 0.0678
 Site-USPS      | Val  Loss: 2.1964 | Val  Acc: 0.1186
 Site-USPS      | Val  Loss: 2.1422 | Val  Acc: 0.1695
 Site-SynthDigits| Val  Loss: 2.2801 | Val  Acc: 0.0508
 Site-SynthDigits| Val  Loss: 2.2850 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2934 | Val  Acc: 0.1186
 Site-MNIST-M   | Val  Loss: 2.3303 | Val  Acc: 0.0508
Average Valid Accuracy: 0.1237
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1864
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0678
 Best site-USPS       | Epoch:0 | Val Acc: 0.1186
 Best site-USPS       | Epoch:0 | Val Acc: 0.1695
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0508
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1186
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.0508
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 1 ============
client-0 is in G-2
client-1 is in G-0
client-2 is in G-2
client-3 is in G-0
client-4 is in G-2
client-5 is in G-2
client-6 is in G-0
client-7 is in G-0
client-8 is in G-2
client-9 is in G-0
clients=[(5,)(0,)(5,)]
 Site-MNIST     | Train Loss: 2.1373 | Train Acc: 0.2386
 Site-MNIST     | Train Loss: 2.0561 | Train Acc: 0.3636
 Site-SVHN      | Train Loss: 2.3020 | Train Acc: 0.1136
 Site-SVHN      | Train Loss: 2.2838 | Train Acc: 0.1705
 Site-USPS      | Train Loss: 2.0401 | Train Acc: 0.2955
 Site-USPS      | Train Loss: 2.0718 | Train Acc: 0.2727
 Site-SynthDigits| Train Loss: 2.2349 | Train Acc: 0.2045
 Site-SynthDigits| Train Loss: 2.2286 | Train Acc: 0.1364
 Site-MNIST-M   | Train Loss: 2.3030 | Train Acc: 0.1136
 Site-MNIST-M   | Train Loss: 2.2222 | Train Acc: 0.1591
 Site-MNIST     | Val  Loss: 2.0776 | Val  Acc: 0.3729
 Site-MNIST     | Val  Loss: 2.0707 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.2715 | Val  Acc: 0.2034
 Site-SVHN      | Val  Loss: 2.2814 | Val  Acc: 0.0847
 Site-USPS      | Val  Loss: 2.0920 | Val  Acc: 0.2542
 Site-USPS      | Val  Loss: 2.0474 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 2.2429 | Val  Acc: 0.1356
 Site-SynthDigits| Val  Loss: 2.2374 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2373 | Val  Acc: 0.1525
 Site-MNIST-M   | Val  Loss: 2.2718 | Val  Acc: 0.1186
Average Valid Accuracy: 0.2085
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3729
 Best site-MNIST      | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-SVHN       | Epoch:1 | Val Acc: 0.0847
 Best site-USPS       | Epoch:1 | Val Acc: 0.2542
 Best site-USPS       | Epoch:1 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1356
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1525
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1186
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 2 ============
===2023-03-30 21:06:21===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
clients=[(8,)(1,)(1,)]
 Site-MNIST     | Train Loss: 1.8538 | Train Acc: 0.4886
 Site-MNIST     | Train Loss: 1.7963 | Train Acc: 0.5795
 Site-SVHN      | Train Loss: 2.2491 | Train Acc: 0.1705
 Site-SVHN      | Train Loss: 2.1932 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.7717 | Train Acc: 0.6250
 Site-USPS      | Train Loss: 1.7807 | Train Acc: 0.6477
 Site-SynthDigits| Train Loss: 2.1005 | Train Acc: 0.3068
 Site-SynthDigits| Train Loss: 2.1042 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 2.2000 | Train Acc: 0.1932
 Site-MNIST-M   | Train Loss: 2.1530 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.8237 | Val  Acc: 0.5593
 Site-MNIST     | Val  Loss: 1.7831 | Val  Acc: 0.5932
 Site-SVHN      | Val  Loss: 2.2051 | Val  Acc: 0.2542
 Site-SVHN      | Val  Loss: 2.2047 | Val  Acc: 0.2203
 Site-USPS      | Val  Loss: 1.8248 | Val  Acc: 0.6271
 Site-USPS      | Val  Loss: 1.7410 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 2.1156 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.0760 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.1452 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.1890 | Val  Acc: 0.2203
Average Valid Accuracy: 0.3932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5593
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2542
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-USPS       | Epoch:0 | Val Acc: 0.6271
 Best site-USPS       | Epoch:0 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
client-0 is in G-0
client-1 is in G-0
client-2 is in G-0
client-3 is in G-0
client-4 is in G-0
client-5 is in G-0
client-6 is in G-0
client-7 is in G-0
client-8 is in G-1
client-9 is in G-2
clients=[(8,)(1,)(1,)]
 Site-MNIST     | Train Loss: 1.3785 | Train Acc: 0.6705
 Site-MNIST     | Train Loss: 1.2794 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 2.1314 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0290 | Train Acc: 0.3068
 Site-USPS      | Train Loss: 1.2717 | Train Acc: 0.7614
 Site-USPS      | Train Loss: 1.3153 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.8838 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.8520 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.0378 | Train Acc: 0.2386
 Site-MNIST-M   | Train Loss: 1.9837 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.3554 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.2452 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1072 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0428 | Val  Acc: 0.2881
 Site-USPS      | Val  Loss: 1.3609 | Val  Acc: 0.6610
 Site-USPS      | Val  Loss: 1.3029 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.8672 | Val  Acc: 0.4407
 Site-SynthDigits| Val  Loss: 1.8170 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.9755 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0355 | Val  Acc: 0.2712
Average Valid Accuracy: 0.4797
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-USPS       | Epoch:1 | Val Acc: 0.6610
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4407
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
