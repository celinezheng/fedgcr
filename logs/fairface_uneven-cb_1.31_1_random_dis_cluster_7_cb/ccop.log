===2023-06-14 11:20:02===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: True
data_number=[128,168,220,288,378,144,188,247,323,138,181,238,110,145,164,214,307,125,]
client_nums=[5,4,3,2,2,1,1,]
len_dataset=[3952,3016,1865,856,1265,1024,419,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 7, 1, 2, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-White_utk                 (1) | Train Loss: 2.4206 | Train Acc: 0.1094
 Site-White_utk                 (1) | Train Loss: 2.3910 | Train Acc: 0.1131
 Site-White_utk                 (1) | Train Loss: 2.4183 | Train Acc: 0.1091
 Site-White_utk                 (1) | Train Loss: 2.4229 | Train Acc: 0.1111
 Site-White_utk                 (1) | Train Loss: 2.4065 | Train Acc: 0.1085
 Site-White                     (0) | Train Loss: 1.9044 | Train Acc: 0.3472
 Site-White                     (5) | Train Loss: 1.8334 | Train Acc: 0.3830
 Site-White                     (0) | Train Loss: 1.8764 | Train Acc: 0.3401
 Site-White                     (5) | Train Loss: 1.8960 | Train Acc: 0.3467
 Site-Indian_utk                (4) | Train Loss: 1.9664 | Train Acc: 0.3623
 Site-Indian_utk                (4) | Train Loss: 1.9431 | Train Acc: 0.3536
 Site-Indian_utk                (4) | Train Loss: 1.9588 | Train Acc: 0.3571
 Site-Black_utk                 (3) | Train Loss: 1.9618 | Train Acc: 0.3273
 Site-Black_utk                 (3) | Train Loss: 1.9563 | Train Acc: 0.3241
 Site-Others_utk                (1) | Train Loss: 1.8118 | Train Acc: 0.4390
 Site-Others_utk                (1) | Train Loss: 1.8631 | Train Acc: 0.4206
 Site-Southeast_Asian           (6) | Train Loss: 2.0308 | Train Acc: 0.3127
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.4051 | Train Acc: 0.6880
Average Train Accuracy: 0.3085
 Site-White_utk                 (1) | Val  Loss: 2.4482 | Val  Acc: 0.1059
 Site-White_utk                 (1) | Val  Loss: 2.4187 | Val  Acc: 0.1250
 Site-White_utk                 (1) | Val  Loss: 2.4033 | Val  Acc: 0.1088
 Site-White_utk                 (1) | Val  Loss: 2.4045 | Val  Acc: 0.1094
 Site-White_utk                 (1) | Val  Loss: 2.3953 | Val  Acc: 0.1071
 Site-White                     (0) | Val  Loss: 1.8267 | Val  Acc: 0.3750
 Site-White                     (5) | Val  Loss: 1.8235 | Val  Acc: 0.3600
 Site-White                     (0) | Val  Loss: 1.8628 | Val  Acc: 0.3598
 Site-White                     (5) | Val  Loss: 1.8634 | Val  Acc: 0.3565
 Site-Indian_utk                (4) | Val  Loss: 2.0082 | Val  Acc: 0.3261
 Site-Indian_utk                (4) | Val  Loss: 1.9302 | Val  Acc: 0.3719
 Site-Indian_utk                (4) | Val  Loss: 1.9715 | Val  Acc: 0.3608
 Site-Black_utk                 (3) | Val  Loss: 2.0915 | Val  Acc: 0.3243
 Site-Black_utk                 (3) | Val  Loss: 1.9665 | Val  Acc: 0.3229
 Site-Others_utk                (1) | Val  Loss: 1.9046 | Val  Acc: 0.3853
 Site-Others_utk                (1) | Val  Loss: 1.5709 | Val  Acc: 0.4755
 Site-Southeast_Asian           (6) | Val  Loss: 2.0581 | Val  Acc: 0.3088
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.9430 | Val  Acc: 0.4940
Average Valid Accuracy: 0.2987
 Best site-White_utk                (1)  | Epoch:0 | Val Acc: 0.1059
 Best site-White_utk                (1)  | Epoch:0 | Val Acc: 0.1250
 Best site-White_utk                (1)  | Epoch:0 | Val Acc: 0.1088
 Best site-White_utk                (1)  | Epoch:0 | Val Acc: 0.1094
 Best site-White_utk                (1)  | Epoch:0 | Val Acc: 0.1071
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3750
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3600
 Best site-White                    (0)  | Epoch:0 | Val Acc: 0.3598
 Best site-White                    (5)  | Epoch:0 | Val Acc: 0.3565
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3261
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3719
 Best site-Indian_utk               (4)  | Epoch:0 | Val Acc: 0.3608
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3243
 Best site-Black_utk                (3)  | Epoch:0 | Val Acc: 0.3229
 Best site-Others_utk               (1)  | Epoch:0 | Val Acc: 0.3853
 Best site-Others_utk               (1)  | Epoch:0 | Val Acc: 0.4755
 Best site-Southeast_Asian          (6)  | Epoch:0 | Val Acc: 0.3088
 Best site-Middle_Eastern_gan       (2)  | Epoch:0 | Val Acc: 0.4940
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[5, 1, 1, 2, 3, 4, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-White_utk                 (0) | Train Loss: 2.2670 | Train Acc: 0.1094
 Site-White_utk                 (0) | Train Loss: 2.2569 | Train Acc: 0.1250
 Site-White_utk                 (0) | Train Loss: 2.2563 | Train Acc: 0.1091
 Site-White_utk                 (0) | Train Loss: 2.2347 | Train Acc: 0.1181
 Site-White_utk                 (0) | Train Loss: 2.2446 | Train Acc: 0.1085
 Site-White                     (5) | Train Loss: 1.9246 | Train Acc: 0.3472
 Site-White                     (5) | Train Loss: 1.8125 | Train Acc: 0.3670
 Site-White                     (5) | Train Loss: 1.8710 | Train Acc: 0.3401
 Site-White                     (5) | Train Loss: 1.7945 | Train Acc: 0.3498
 Site-Indian_utk                (4) | Train Loss: 1.9269 | Train Acc: 0.3551
 Site-Indian_utk                (4) | Train Loss: 1.8872 | Train Acc: 0.3646
 Site-Indian_utk                (4) | Train Loss: 1.9047 | Train Acc: 0.3529
 Site-Black_utk                 (3) | Train Loss: 1.9085 | Train Acc: 0.3273
 Site-Black_utk                 (3) | Train Loss: 1.8649 | Train Acc: 0.3241
 Site-Others_utk                (6) | Train Loss: 1.7374 | Train Acc: 0.4207
 Site-Others_utk                (6) | Train Loss: 1.7800 | Train Acc: 0.4206
 Site-Southeast_Asian           (1) | Train Loss: 1.9817 | Train Acc: 0.3160
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.5012 | Train Acc: 0.6720
Average Train Accuracy: 0.3071
 Site-White_utk                 (0) | Val  Loss: 2.3035 | Val  Acc: 0.1294
 Site-White_utk                 (0) | Val  Loss: 2.2531 | Val  Acc: 0.1161
 Site-White_utk                 (0) | Val  Loss: 2.2421 | Val  Acc: 0.1020
 Site-White_utk                 (0) | Val  Loss: 2.2486 | Val  Acc: 0.1146
 Site-White_utk                 (0) | Val  Loss: 2.2455 | Val  Acc: 0.1111
 Site-White                     (5) | Val  Loss: 1.8339 | Val  Acc: 0.3750
 Site-White                     (5) | Val  Loss: 1.7990 | Val  Acc: 0.3680
 Site-White                     (5) | Val  Loss: 1.8663 | Val  Acc: 0.3598
 Site-White                     (5) | Val  Loss: 1.8320 | Val  Acc: 0.3565
 Site-Indian_utk                (4) | Val  Loss: 1.9223 | Val  Acc: 0.3261
 Site-Indian_utk                (4) | Val  Loss: 1.8881 | Val  Acc: 0.3554
 Site-Indian_utk                (4) | Val  Loss: 1.9133 | Val  Acc: 0.3671
 Site-Black_utk                 (3) | Val  Loss: 2.0147 | Val  Acc: 0.3378
 Site-Black_utk                 (3) | Val  Loss: 1.9284 | Val  Acc: 0.3333
 Site-Others_utk                (6) | Val  Loss: 1.8072 | Val  Acc: 0.3945
 Site-Others_utk                (6) | Val  Loss: 1.6201 | Val  Acc: 0.4825
 Site-Southeast_Asian           (1) | Val  Loss: 1.9997 | Val  Acc: 0.2990
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.9280 | Val  Acc: 0.5060
Average Valid Accuracy: 0.3019
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1294
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1161
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1020
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1146
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1111
 Best site-White                    (5)  | Epoch:1 | Val Acc: 0.3750
 Best site-White                    (5)  | Epoch:1 | Val Acc: 0.3680
 Best site-White                    (5)  | Epoch:1 | Val Acc: 0.3598
 Best site-White                    (5)  | Epoch:1 | Val Acc: 0.3565
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3261
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3554
 Best site-Indian_utk               (4)  | Epoch:1 | Val Acc: 0.3671
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3378
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3333
 Best site-Others_utk               (6)  | Epoch:1 | Val Acc: 0.3945
 Best site-Others_utk               (6)  | Epoch:1 | Val Acc: 0.4825
 Best site-Southeast_Asian          (1)  | Epoch:1 | Val Acc: 0.2990
 Best site-Middle_Eastern_gan       (2)  | Epoch:1 | Val Acc: 0.5060
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[1, 6, 1, 3, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-White_utk                 (1) | Train Loss: 2.2143 | Train Acc: 0.1406
 Site-White_utk                 (1) | Train Loss: 2.2078 | Train Acc: 0.1190
 Site-White_utk                 (1) | Train Loss: 2.2401 | Train Acc: 0.1273
 Site-White_utk                 (1) | Train Loss: 2.2237 | Train Acc: 0.1111
 Site-White_utk                 (1) | Train Loss: 2.2222 | Train Acc: 0.1190
 Site-White                     (6) | Train Loss: 1.8761 | Train Acc: 0.3264
 Site-White                     (4) | Train Loss: 1.7751 | Train Acc: 0.3670
 Site-White                     (4) | Train Loss: 1.8333 | Train Acc: 0.3441
 Site-White                     (6) | Train Loss: 1.8081 | Train Acc: 0.3406
 Site-Indian_utk                (3) | Train Loss: 1.8414 | Train Acc: 0.3623
 Site-Indian_utk                (3) | Train Loss: 1.8695 | Train Acc: 0.3536
 Site-Indian_utk                (3) | Train Loss: 1.8549 | Train Acc: 0.3571
 Site-Black_utk                 (5) | Train Loss: 1.8600 | Train Acc: 0.3545
 Site-Black_utk                 (5) | Train Loss: 1.8459 | Train Acc: 0.3103
 Site-Others_utk                (5) | Train Loss: 1.7148 | Train Acc: 0.4451
 Site-Others_utk                (1) | Train Loss: 1.7479 | Train Acc: 0.4112
 Site-Southeast_Asian           (0) | Train Loss: 1.9465 | Train Acc: 0.3094
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.4495 | Train Acc: 0.6720
Average Train Accuracy: 0.3095
 Site-White_utk                 (1) | Val  Loss: 2.2512 | Val  Acc: 0.1294
 Site-White_utk                 (1) | Val  Loss: 2.2185 | Val  Acc: 0.1071
 Site-White_utk                 (1) | Val  Loss: 2.2240 | Val  Acc: 0.1088
 Site-White_utk                 (1) | Val  Loss: 2.2445 | Val  Acc: 0.1094
 Site-White_utk                 (1) | Val  Loss: 2.2383 | Val  Acc: 0.1230
 Site-White                     (6) | Val  Loss: 1.7825 | Val  Acc: 0.3542
 Site-White                     (4) | Val  Loss: 1.7834 | Val  Acc: 0.3520
 Site-White                     (4) | Val  Loss: 1.8266 | Val  Acc: 0.3537
 Site-White                     (6) | Val  Loss: 1.8113 | Val  Acc: 0.3611
 Site-Indian_utk                (3) | Val  Loss: 1.9165 | Val  Acc: 0.3152
 Site-Indian_utk                (3) | Val  Loss: 1.8681 | Val  Acc: 0.3802
 Site-Indian_utk                (3) | Val  Loss: 1.8553 | Val  Acc: 0.3608
 Site-Black_utk                 (5) | Val  Loss: 2.0475 | Val  Acc: 0.2973
 Site-Black_utk                 (5) | Val  Loss: 1.9202 | Val  Acc: 0.3333
 Site-Others_utk                (5) | Val  Loss: 1.7780 | Val  Acc: 0.4037
 Site-Others_utk                (1) | Val  Loss: 1.5627 | Val  Acc: 0.4755
 Site-Southeast_Asian           (0) | Val  Loss: 1.9784 | Val  Acc: 0.3137
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8646 | Val  Acc: 0.5181
Average Valid Accuracy: 0.2998
============ Train epoch 3 ============
cnt=[4, 6, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-White_utk                 (1) | Train Loss: 2.1494 | Train Acc: 0.1641
 Site-White_utk                 (1) | Train Loss: 2.1767 | Train Acc: 0.1488
 Site-White_utk                 (1) | Train Loss: 2.1875 | Train Acc: 0.1364
 Site-White_utk                 (1) | Train Loss: 2.1813 | Train Acc: 0.1354
 Site-White_utk                 (1) | Train Loss: 2.1699 | Train Acc: 0.1349
 Site-White                     (0) | Train Loss: 1.7762 | Train Acc: 0.3403
 Site-White                     (0) | Train Loss: 1.7648 | Train Acc: 0.3670
 Site-White                     (0) | Train Loss: 1.8222 | Train Acc: 0.3441
 Site-White                     (0) | Train Loss: 1.8986 | Train Acc: 0.3498
 Site-Indian_utk                (4) | Train Loss: 1.7209 | Train Acc: 0.3623
 Site-Indian_utk                (4) | Train Loss: 1.8211 | Train Acc: 0.3812
 Site-Indian_utk                (4) | Train Loss: 1.8150 | Train Acc: 0.3866
 Site-Black_utk                 (3) | Train Loss: 1.8198 | Train Acc: 0.3364
 Site-Black_utk                 (3) | Train Loss: 1.8372 | Train Acc: 0.3310
 Site-Others_utk                (6) | Train Loss: 1.6287 | Train Acc: 0.4817
 Site-Others_utk                (1) | Train Loss: 1.7209 | Train Acc: 0.4486
 Site-Southeast_Asian           (5) | Train Loss: 1.9178 | Train Acc: 0.3225
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.4235 | Train Acc: 0.6800
Average Train Accuracy: 0.3251
 Site-White_utk                 (1) | Val  Loss: 2.2229 | Val  Acc: 0.1412
 Site-White_utk                 (1) | Val  Loss: 2.1419 | Val  Acc: 0.1429
 Site-White_utk                 (1) | Val  Loss: 2.1843 | Val  Acc: 0.1224
 Site-White_utk                 (1) | Val  Loss: 2.2011 | Val  Acc: 0.1458
 Site-White_utk                 (1) | Val  Loss: 2.1807 | Val  Acc: 0.1468
 Site-White                     (0) | Val  Loss: 1.7883 | Val  Acc: 0.3542
 Site-White                     (0) | Val  Loss: 1.7780 | Val  Acc: 0.3680
 Site-White                     (0) | Val  Loss: 1.8132 | Val  Acc: 0.3659
 Site-White                     (0) | Val  Loss: 1.7947 | Val  Acc: 0.3565
 Site-Indian_utk                (4) | Val  Loss: 1.8836 | Val  Acc: 0.3370
 Site-Indian_utk                (4) | Val  Loss: 1.8238 | Val  Acc: 0.3802
 Site-Indian_utk                (4) | Val  Loss: 1.8324 | Val  Acc: 0.3544
 Site-Black_utk                 (3) | Val  Loss: 2.0071 | Val  Acc: 0.3243
 Site-Black_utk                 (3) | Val  Loss: 1.8980 | Val  Acc: 0.2917
 Site-Others_utk                (6) | Val  Loss: 1.6936 | Val  Acc: 0.4312
 Site-Others_utk                (1) | Val  Loss: 1.5041 | Val  Acc: 0.4965
 Site-Southeast_Asian           (5) | Val  Loss: 1.9362 | Val  Acc: 0.3186
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8802 | Val  Acc: 0.5181
Average Valid Accuracy: 0.3109
 Best site-White_utk                (1)  | Epoch:3 | Val Acc: 0.1412
 Best site-White_utk                (1)  | Epoch:3 | Val Acc: 0.1429
 Best site-White_utk                (1)  | Epoch:3 | Val Acc: 0.1224
 Best site-White_utk                (1)  | Epoch:3 | Val Acc: 0.1458
 Best site-White_utk                (1)  | Epoch:3 | Val Acc: 0.1468
 Best site-White                    (0)  | Epoch:3 | Val Acc: 0.3542
 Best site-White                    (0)  | Epoch:3 | Val Acc: 0.3680
 Best site-White                    (0)  | Epoch:3 | Val Acc: 0.3659
 Best site-White                    (0)  | Epoch:3 | Val Acc: 0.3565
 Best site-Indian_utk               (4)  | Epoch:3 | Val Acc: 0.3370
 Best site-Indian_utk               (4)  | Epoch:3 | Val Acc: 0.3802
 Best site-Indian_utk               (4)  | Epoch:3 | Val Acc: 0.3544
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.3243
 Best site-Black_utk                (3)  | Epoch:3 | Val Acc: 0.2917
 Best site-Others_utk               (6)  | Epoch:3 | Val Acc: 0.4312
 Best site-Others_utk               (1)  | Epoch:3 | Val Acc: 0.4965
 Best site-Southeast_Asian          (5)  | Epoch:3 | Val Acc: 0.3186
 Best site-Middle_Eastern_gan       (2)  | Epoch:3 | Val Acc: 0.5181
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[5, 3, 1, 5, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-White_utk                 (3) | Train Loss: 2.1096 | Train Acc: 0.2109
 Site-White_utk                 (3) | Train Loss: 2.1176 | Train Acc: 0.1726
 Site-White_utk                 (3) | Train Loss: 2.1565 | Train Acc: 0.1545
 Site-White_utk                 (3) | Train Loss: 2.1243 | Train Acc: 0.1736
 Site-White_utk                 (3) | Train Loss: 2.1149 | Train Acc: 0.1693
 Site-White                     (0) | Train Loss: 1.7779 | Train Acc: 0.3611
 Site-White                     (0) | Train Loss: 1.7499 | Train Acc: 0.3723
 Site-White                     (0) | Train Loss: 1.8202 | Train Acc: 0.3603
 Site-White                     (0) | Train Loss: 1.8187 | Train Acc: 0.3591
 Site-Indian_utk                (1) | Train Loss: 1.8872 | Train Acc: 0.3841
 Site-Indian_utk                (1) | Train Loss: 1.8071 | Train Acc: 0.3923
 Site-Indian_utk                (1) | Train Loss: 1.8068 | Train Acc: 0.3950
 Site-Black_utk                 (5) | Train Loss: 1.7961 | Train Acc: 0.3818
 Site-Black_utk                 (5) | Train Loss: 1.7691 | Train Acc: 0.3586
 Site-Others_utk                (4) | Train Loss: 1.5428 | Train Acc: 0.5061
 Site-Others_utk                (6) | Train Loss: 1.6309 | Train Acc: 0.5234
 Site-Southeast_Asian           (0) | Train Loss: 1.9020 | Train Acc: 0.3355
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.4358 | Train Acc: 0.6720
Average Train Accuracy: 0.3490
 Site-White_utk                 (3) | Val  Loss: 2.1347 | Val  Acc: 0.1882
 Site-White_utk                 (3) | Val  Loss: 2.1159 | Val  Acc: 0.1786
 Site-White_utk                 (3) | Val  Loss: 2.1145 | Val  Acc: 0.1565
 Site-White_utk                 (3) | Val  Loss: 2.1381 | Val  Acc: 0.1927
 Site-White_utk                 (3) | Val  Loss: 2.1289 | Val  Acc: 0.1825
 Site-White                     (0) | Val  Loss: 1.7674 | Val  Acc: 0.3750
 Site-White                     (0) | Val  Loss: 1.7481 | Val  Acc: 0.3920
 Site-White                     (0) | Val  Loss: 1.8254 | Val  Acc: 0.3720
 Site-White                     (0) | Val  Loss: 1.7762 | Val  Acc: 0.3704
 Site-Indian_utk                (1) | Val  Loss: 1.8218 | Val  Acc: 0.3696
 Site-Indian_utk                (1) | Val  Loss: 1.7846 | Val  Acc: 0.3967
 Site-Indian_utk                (1) | Val  Loss: 1.8201 | Val  Acc: 0.3924
 Site-Black_utk                 (5) | Val  Loss: 1.9390 | Val  Acc: 0.3378
 Site-Black_utk                 (5) | Val  Loss: 1.8582 | Val  Acc: 0.3229
 Site-Others_utk                (4) | Val  Loss: 1.6230 | Val  Acc: 0.4954
 Site-Others_utk                (6) | Val  Loss: 1.4439 | Val  Acc: 0.5385
 Site-Southeast_Asian           (0) | Val  Loss: 1.9224 | Val  Acc: 0.3284
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.9056 | Val  Acc: 0.4940
Average Valid Accuracy: 0.3380
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.1882
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.1786
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.1565
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.1927
 Best site-White_utk                (3)  | Epoch:4 | Val Acc: 0.1825
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3750
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3920
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3720
 Best site-White                    (0)  | Epoch:4 | Val Acc: 0.3704
 Best site-Indian_utk               (1)  | Epoch:4 | Val Acc: 0.3696
 Best site-Indian_utk               (1)  | Epoch:4 | Val Acc: 0.3967
 Best site-Indian_utk               (1)  | Epoch:4 | Val Acc: 0.3924
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.3378
 Best site-Black_utk                (5)  | Epoch:4 | Val Acc: 0.3229
 Best site-Others_utk               (4)  | Epoch:4 | Val Acc: 0.4954
 Best site-Others_utk               (6)  | Epoch:4 | Val Acc: 0.5385
 Best site-Southeast_Asian          (0)  | Epoch:4 | Val Acc: 0.3284
 Best site-Middle_Eastern_gan       (2)  | Epoch:4 | Val Acc: 0.4940
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[3, 4, 6, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-White_utk                 (2) | Train Loss: 1.9456 | Train Acc: 0.2422
 Site-White_utk                 (2) | Train Loss: 1.9846 | Train Acc: 0.2083
 Site-White_utk                 (2) | Train Loss: 1.9577 | Train Acc: 0.2227
 Site-White_utk                 (2) | Train Loss: 1.9851 | Train Acc: 0.1979
 Site-White_utk                 (2) | Train Loss: 1.9402 | Train Acc: 0.2302
 Site-White                     (1) | Train Loss: 1.7600 | Train Acc: 0.3750
 Site-White                     (1) | Train Loss: 1.7243 | Train Acc: 0.4362
 Site-White                     (1) | Train Loss: 1.7758 | Train Acc: 0.3725
 Site-White                     (1) | Train Loss: 1.7235 | Train Acc: 0.3839
 Site-Indian_utk                (0) | Train Loss: 1.5958 | Train Acc: 0.4493
 Site-Indian_utk                (0) | Train Loss: 1.7473 | Train Acc: 0.3923
 Site-Indian_utk                (0) | Train Loss: 1.7576 | Train Acc: 0.4076
 Site-Black_utk                 (4) | Train Loss: 1.7658 | Train Acc: 0.3727
 Site-Black_utk                 (4) | Train Loss: 1.7908 | Train Acc: 0.3793
 Site-Others_utk                (5) | Train Loss: 1.5278 | Train Acc: 0.5854
 Site-Others_utk                (2) | Train Loss: 1.6116 | Train Acc: 0.5374
 Site-Southeast_Asian           (6) | Train Loss: 1.8294 | Train Acc: 0.3844
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.5713 | Train Acc: 0.5840
Average Train Accuracy: 0.3756
 Site-White_utk                 (2) | Val  Loss: 1.9509 | Val  Acc: 0.2118
 Site-White_utk                 (2) | Val  Loss: 1.9564 | Val  Acc: 0.2143
 Site-White_utk                 (2) | Val  Loss: 1.9770 | Val  Acc: 0.2177
 Site-White_utk                 (2) | Val  Loss: 1.9941 | Val  Acc: 0.2188
 Site-White_utk                 (2) | Val  Loss: 1.9383 | Val  Acc: 0.2302
 Site-White                     (1) | Val  Loss: 1.7561 | Val  Acc: 0.4062
 Site-White                     (1) | Val  Loss: 1.7232 | Val  Acc: 0.3920
 Site-White                     (1) | Val  Loss: 1.7743 | Val  Acc: 0.4024
 Site-White                     (1) | Val  Loss: 1.7350 | Val  Acc: 0.4028
 Site-Indian_utk                (0) | Val  Loss: 1.7626 | Val  Acc: 0.3478
 Site-Indian_utk                (0) | Val  Loss: 1.7416 | Val  Acc: 0.4463
 Site-Indian_utk                (0) | Val  Loss: 1.7462 | Val  Acc: 0.4177
 Site-Black_utk                 (4) | Val  Loss: 1.8613 | Val  Acc: 0.4054
 Site-Black_utk                 (4) | Val  Loss: 1.8139 | Val  Acc: 0.3646
 Site-Others_utk                (5) | Val  Loss: 1.5928 | Val  Acc: 0.5229
 Site-Others_utk                (2) | Val  Loss: 1.5205 | Val  Acc: 0.5734
 Site-Southeast_Asian           (6) | Val  Loss: 1.8438 | Val  Acc: 0.3725
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.9504 | Val  Acc: 0.4819
Average Valid Accuracy: 0.3683
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2118
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2143
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2177
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2188
 Best site-White_utk                (2)  | Epoch:5 | Val Acc: 0.2302
 Best site-White                    (1)  | Epoch:5 | Val Acc: 0.4062
 Best site-White                    (1)  | Epoch:5 | Val Acc: 0.3920
 Best site-White                    (1)  | Epoch:5 | Val Acc: 0.4024
 Best site-White                    (1)  | Epoch:5 | Val Acc: 0.4028
 Best site-Indian_utk               (0)  | Epoch:5 | Val Acc: 0.3478
 Best site-Indian_utk               (0)  | Epoch:5 | Val Acc: 0.4463
 Best site-Indian_utk               (0)  | Epoch:5 | Val Acc: 0.4177
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.4054
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3646
 Best site-Others_utk               (5)  | Epoch:5 | Val Acc: 0.5229
 Best site-Others_utk               (2)  | Epoch:5 | Val Acc: 0.5734
 Best site-Southeast_Asian          (6)  | Epoch:5 | Val Acc: 0.3725
 Best site-Middle_Eastern_gan       (3)  | Epoch:5 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[3, 4, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-White_utk                 (2) | Train Loss: 1.8054 | Train Acc: 0.2891
 Site-White_utk                 (6) | Train Loss: 1.8651 | Train Acc: 0.2381
 Site-White_utk                 (2) | Train Loss: 1.8553 | Train Acc: 0.2409
 Site-White_utk                 (2) | Train Loss: 1.8856 | Train Acc: 0.2674
 Site-White_utk                 (2) | Train Loss: 1.8261 | Train Acc: 0.2778
 Site-White                     (1) | Train Loss: 1.7580 | Train Acc: 0.3889
 Site-White                     (1) | Train Loss: 1.6914 | Train Acc: 0.4521
 Site-White                     (1) | Train Loss: 1.7627 | Train Acc: 0.3846
 Site-White                     (1) | Train Loss: 1.7585 | Train Acc: 0.3901
 Site-Indian_utk                (3) | Train Loss: 1.6604 | Train Acc: 0.4348
 Site-Indian_utk                (3) | Train Loss: 1.7328 | Train Acc: 0.4309
 Site-Indian_utk                (3) | Train Loss: 1.7007 | Train Acc: 0.3992
 Site-Black_utk                 (0) | Train Loss: 1.7285 | Train Acc: 0.3909
 Site-Black_utk                 (0) | Train Loss: 1.7440 | Train Acc: 0.3724
 Site-Others_utk                (0) | Train Loss: 1.4983 | Train Acc: 0.5488
 Site-Others_utk                (6) | Train Loss: 1.5627 | Train Acc: 0.5467
 Site-Southeast_Asian           (4) | Train Loss: 1.7843 | Train Acc: 0.3713
 Site-Middle_Eastern_gan        (5) | Train Loss: 1.6493 | Train Acc: 0.5280
Average Train Accuracy: 0.3862
 Site-White_utk                 (2) | Val  Loss: 1.8201 | Val  Acc: 0.2471
 Site-White_utk                 (6) | Val  Loss: 1.8341 | Val  Acc: 0.3036
 Site-White_utk                 (2) | Val  Loss: 1.8725 | Val  Acc: 0.2449
 Site-White_utk                 (2) | Val  Loss: 1.8873 | Val  Acc: 0.2604
 Site-White_utk                 (2) | Val  Loss: 1.8283 | Val  Acc: 0.2778
 Site-White                     (1) | Val  Loss: 1.7413 | Val  Acc: 0.4479
 Site-White                     (1) | Val  Loss: 1.6915 | Val  Acc: 0.4320
 Site-White                     (1) | Val  Loss: 1.7568 | Val  Acc: 0.4329
 Site-White                     (1) | Val  Loss: 1.7113 | Val  Acc: 0.4074
 Site-Indian_utk                (3) | Val  Loss: 1.7304 | Val  Acc: 0.3696
 Site-Indian_utk                (3) | Val  Loss: 1.7297 | Val  Acc: 0.4380
 Site-Indian_utk                (3) | Val  Loss: 1.7475 | Val  Acc: 0.4051
 Site-Black_utk                 (0) | Val  Loss: 1.8042 | Val  Acc: 0.4189
 Site-Black_utk                 (0) | Val  Loss: 1.7867 | Val  Acc: 0.3854
 Site-Others_utk                (0) | Val  Loss: 1.5569 | Val  Acc: 0.4862
 Site-Others_utk                (6) | Val  Loss: 1.5703 | Val  Acc: 0.5385
 Site-Southeast_Asian           (4) | Val  Loss: 1.8018 | Val  Acc: 0.3922
 Site-Middle_Eastern_gan        (5) | Val  Loss: 1.9245 | Val  Acc: 0.4337
Average Valid Accuracy: 0.3845
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2471
 Best site-White_utk                (6)  | Epoch:6 | Val Acc: 0.3036
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2449
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2604
 Best site-White_utk                (2)  | Epoch:6 | Val Acc: 0.2778
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4479
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4320
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4329
 Best site-White                    (1)  | Epoch:6 | Val Acc: 0.4074
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.3696
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.4380
 Best site-Indian_utk               (3)  | Epoch:6 | Val Acc: 0.4051
 Best site-Black_utk                (0)  | Epoch:6 | Val Acc: 0.4189
 Best site-Black_utk                (0)  | Epoch:6 | Val Acc: 0.3854
 Best site-Others_utk               (0)  | Epoch:6 | Val Acc: 0.4862
 Best site-Others_utk               (6)  | Epoch:6 | Val Acc: 0.5385
 Best site-Southeast_Asian          (4)  | Epoch:6 | Val Acc: 0.3922
 Best site-Middle_Eastern_gan       (5)  | Epoch:6 | Val Acc: 0.4337
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[6, 5, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-White_utk                 (0) | Train Loss: 1.8512 | Train Acc: 0.2344
 Site-White_utk                 (0) | Train Loss: 1.8685 | Train Acc: 0.2560
 Site-White_utk                 (0) | Train Loss: 1.8511 | Train Acc: 0.2409
 Site-White_utk                 (0) | Train Loss: 1.9080 | Train Acc: 0.2292
 Site-White_utk                 (0) | Train Loss: 1.8347 | Train Acc: 0.2513
 Site-White                     (1) | Train Loss: 1.7301 | Train Acc: 0.3958
 Site-White                     (1) | Train Loss: 1.6492 | Train Acc: 0.4202
 Site-White                     (1) | Train Loss: 1.6884 | Train Acc: 0.3887
 Site-White                     (1) | Train Loss: 1.9341 | Train Acc: 0.3715
 Site-Indian_utk                (4) | Train Loss: 1.6234 | Train Acc: 0.4493
 Site-Indian_utk                (4) | Train Loss: 1.6546 | Train Acc: 0.4309
 Site-Indian_utk                (4) | Train Loss: 1.6182 | Train Acc: 0.4538
 Site-Black_utk                 (6) | Train Loss: 1.6245 | Train Acc: 0.4364
 Site-Black_utk                 (3) | Train Loss: 1.6491 | Train Acc: 0.4138
 Site-Others_utk                (0) | Train Loss: 1.3723 | Train Acc: 0.5793
 Site-Others_utk                (5) | Train Loss: 1.4527 | Train Acc: 0.5607
 Site-Southeast_Asian           (1) | Train Loss: 1.7771 | Train Acc: 0.3616
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.4497 | Train Acc: 0.6640
Average Train Accuracy: 0.3965
 Site-White_utk                 (0) | Val  Loss: 1.8200 | Val  Acc: 0.2471
 Site-White_utk                 (0) | Val  Loss: 1.8516 | Val  Acc: 0.2321
 Site-White_utk                 (0) | Val  Loss: 1.8783 | Val  Acc: 0.2449
 Site-White_utk                 (0) | Val  Loss: 1.8921 | Val  Acc: 0.2292
 Site-White_utk                 (0) | Val  Loss: 1.8524 | Val  Acc: 0.2500
 Site-White                     (1) | Val  Loss: 1.6766 | Val  Acc: 0.4375
 Site-White                     (1) | Val  Loss: 1.6614 | Val  Acc: 0.3920
 Site-White                     (1) | Val  Loss: 1.7174 | Val  Acc: 0.4085
 Site-White                     (1) | Val  Loss: 1.6690 | Val  Acc: 0.4028
 Site-Indian_utk                (4) | Val  Loss: 1.6576 | Val  Acc: 0.3913
 Site-Indian_utk                (4) | Val  Loss: 1.6390 | Val  Acc: 0.4711
 Site-Indian_utk                (4) | Val  Loss: 1.6531 | Val  Acc: 0.4367
 Site-Black_utk                 (6) | Val  Loss: 1.7102 | Val  Acc: 0.5000
 Site-Black_utk                 (3) | Val  Loss: 1.6789 | Val  Acc: 0.3542
 Site-Others_utk                (0) | Val  Loss: 1.4413 | Val  Acc: 0.5413
 Site-Others_utk                (5) | Val  Loss: 1.3976 | Val  Acc: 0.5944
 Site-Southeast_Asian           (1) | Val  Loss: 1.7541 | Val  Acc: 0.3971
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8767 | Val  Acc: 0.4819
Average Valid Accuracy: 0.3896
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2471
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2321
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2449
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2292
 Best site-White_utk                (0)  | Epoch:7 | Val Acc: 0.2500
 Best site-White                    (1)  | Epoch:7 | Val Acc: 0.4375
 Best site-White                    (1)  | Epoch:7 | Val Acc: 0.3920
 Best site-White                    (1)  | Epoch:7 | Val Acc: 0.4085
 Best site-White                    (1)  | Epoch:7 | Val Acc: 0.4028
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.3913
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.4711
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.4367
 Best site-Black_utk                (6)  | Epoch:7 | Val Acc: 0.5000
 Best site-Black_utk                (3)  | Epoch:7 | Val Acc: 0.3542
 Best site-Others_utk               (0)  | Epoch:7 | Val Acc: 0.5413
 Best site-Others_utk               (5)  | Epoch:7 | Val Acc: 0.5944
 Best site-Southeast_Asian          (1)  | Epoch:7 | Val Acc: 0.3971
 Best site-Middle_Eastern_gan       (2)  | Epoch:7 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[1, 6, 5, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-White_utk                 (1) | Train Loss: 1.8159 | Train Acc: 0.2266
 Site-White_utk                 (1) | Train Loss: 1.8825 | Train Acc: 0.2321
 Site-White_utk                 (1) | Train Loss: 1.8843 | Train Acc: 0.2455
 Site-White_utk                 (1) | Train Loss: 1.9076 | Train Acc: 0.2326
 Site-White_utk                 (1) | Train Loss: 1.8660 | Train Acc: 0.2328
 Site-White                     (2) | Train Loss: 1.6118 | Train Acc: 0.3889
 Site-White                     (2) | Train Loss: 1.6069 | Train Acc: 0.4149
 Site-White                     (2) | Train Loss: 1.6987 | Train Acc: 0.3846
 Site-White                     (2) | Train Loss: 1.7005 | Train Acc: 0.4025
 Site-Indian_utk                (4) | Train Loss: 1.6365 | Train Acc: 0.4420
 Site-Indian_utk                (4) | Train Loss: 1.6043 | Train Acc: 0.4254
 Site-Indian_utk                (4) | Train Loss: 1.5702 | Train Acc: 0.4538
 Site-Black_utk                 (3) | Train Loss: 1.5530 | Train Acc: 0.4818
 Site-Black_utk                 (6) | Train Loss: 1.6403 | Train Acc: 0.4000
 Site-Others_utk                (1) | Train Loss: 1.3259 | Train Acc: 0.6037
 Site-Others_utk                (5) | Train Loss: 1.3876 | Train Acc: 0.5794
 Site-Southeast_Asian           (2) | Train Loss: 1.7566 | Train Acc: 0.3583
 Site-Middle_Eastern_gan        (0) | Train Loss: 1.3053 | Train Acc: 0.6400
Average Train Accuracy: 0.3969
 Site-White_utk                 (1) | Val  Loss: 1.8436 | Val  Acc: 0.2235
 Site-White_utk                 (1) | Val  Loss: 1.8835 | Val  Acc: 0.2232
 Site-White_utk                 (1) | Val  Loss: 1.9173 | Val  Acc: 0.2109
 Site-White_utk                 (1) | Val  Loss: 1.9471 | Val  Acc: 0.2240
 Site-White_utk                 (1) | Val  Loss: 1.8719 | Val  Acc: 0.2183
 Site-White                     (2) | Val  Loss: 1.6826 | Val  Acc: 0.4062
 Site-White                     (2) | Val  Loss: 1.6700 | Val  Acc: 0.4080
 Site-White                     (2) | Val  Loss: 1.7049 | Val  Acc: 0.4024
 Site-White                     (2) | Val  Loss: 1.6530 | Val  Acc: 0.4028
 Site-Indian_utk                (4) | Val  Loss: 1.6172 | Val  Acc: 0.4130
 Site-Indian_utk                (4) | Val  Loss: 1.6012 | Val  Acc: 0.4545
 Site-Indian_utk                (4) | Val  Loss: 1.6160 | Val  Acc: 0.4304
 Site-Black_utk                 (3) | Val  Loss: 1.6919 | Val  Acc: 0.4459
 Site-Black_utk                 (6) | Val  Loss: 1.6553 | Val  Acc: 0.3854
 Site-Others_utk                (1) | Val  Loss: 1.3529 | Val  Acc: 0.5688
 Site-Others_utk                (5) | Val  Loss: 1.2639 | Val  Acc: 0.6014
 Site-Southeast_Asian           (2) | Val  Loss: 1.7483 | Val  Acc: 0.3775
 Site-Middle_Eastern_gan        (0) | Val  Loss: 1.8559 | Val  Acc: 0.5060
Average Valid Accuracy: 0.3835
============ Train epoch 9 ============
cnt=[1, 3, 4, 3, 3, 3, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-White_utk                 (1) | Train Loss: 1.6819 | Train Acc: 0.2969
 Site-White_utk                 (1) | Train Loss: 1.7641 | Train Acc: 0.3274
 Site-White_utk                 (1) | Train Loss: 1.7072 | Train Acc: 0.2818
 Site-White_utk                 (5) | Train Loss: 1.7687 | Train Acc: 0.2743
 Site-White_utk                 (5) | Train Loss: 1.7161 | Train Acc: 0.3360
 Site-White                     (2) | Train Loss: 1.5498 | Train Acc: 0.4097
 Site-White                     (2) | Train Loss: 1.6110 | Train Acc: 0.4149
 Site-White                     (2) | Train Loss: 1.6677 | Train Acc: 0.3968
 Site-White                     (2) | Train Loss: 1.6377 | Train Acc: 0.4025
 Site-Indian_utk                (3) | Train Loss: 1.5680 | Train Acc: 0.4638
 Site-Indian_utk                (3) | Train Loss: 1.6009 | Train Acc: 0.4254
 Site-Indian_utk                (3) | Train Loss: 1.5788 | Train Acc: 0.4538
 Site-Black_utk                 (4) | Train Loss: 1.5865 | Train Acc: 0.4545
 Site-Black_utk                 (4) | Train Loss: 1.6156 | Train Acc: 0.4414
 Site-Others_utk                (4) | Train Loss: 1.3432 | Train Acc: 0.6159
 Site-Others_utk                (5) | Train Loss: 1.3999 | Train Acc: 0.5234
 Site-Southeast_Asian           (6) | Train Loss: 1.6797 | Train Acc: 0.3876
 Site-Middle_Eastern_gan        (0) | Train Loss: 1.4554 | Train Acc: 0.6320
Average Train Accuracy: 0.4188
 Site-White_utk                 (1) | Val  Loss: 1.7163 | Val  Acc: 0.3294
 Site-White_utk                 (1) | Val  Loss: 1.7220 | Val  Acc: 0.3304
 Site-White_utk                 (1) | Val  Loss: 1.7802 | Val  Acc: 0.2993
 Site-White_utk                 (5) | Val  Loss: 1.8068 | Val  Acc: 0.2552
 Site-White_utk                 (5) | Val  Loss: 1.7239 | Val  Acc: 0.2778
 Site-White                     (2) | Val  Loss: 1.6389 | Val  Acc: 0.4271
 Site-White                     (2) | Val  Loss: 1.6511 | Val  Acc: 0.4160
 Site-White                     (2) | Val  Loss: 1.6933 | Val  Acc: 0.3902
 Site-White                     (2) | Val  Loss: 1.6307 | Val  Acc: 0.4028
 Site-Indian_utk                (3) | Val  Loss: 1.5974 | Val  Acc: 0.4130
 Site-Indian_utk                (3) | Val  Loss: 1.5946 | Val  Acc: 0.4298
 Site-Indian_utk                (3) | Val  Loss: 1.6274 | Val  Acc: 0.4430
 Site-Black_utk                 (4) | Val  Loss: 1.7029 | Val  Acc: 0.4595
 Site-Black_utk                 (4) | Val  Loss: 1.6707 | Val  Acc: 0.3958
 Site-Others_utk                (4) | Val  Loss: 1.3707 | Val  Acc: 0.5596
 Site-Others_utk                (5) | Val  Loss: 1.3933 | Val  Acc: 0.5874
 Site-Southeast_Asian           (6) | Val  Loss: 1.6884 | Val  Acc: 0.4118
 Site-Middle_Eastern_gan        (0) | Val  Loss: 1.8344 | Val  Acc: 0.5060
Average Valid Accuracy: 0.4075
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.3294
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.3304
 Best site-White_utk                (1)  | Epoch:9 | Val Acc: 0.2993
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.2552
 Best site-White_utk                (5)  | Epoch:9 | Val Acc: 0.2778
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4271
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4160
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.3902
 Best site-White                    (2)  | Epoch:9 | Val Acc: 0.4028
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4130
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4298
 Best site-Indian_utk               (3)  | Epoch:9 | Val Acc: 0.4430
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.4595
 Best site-Black_utk                (4)  | Epoch:9 | Val Acc: 0.3958
 Best site-Others_utk               (4)  | Epoch:9 | Val Acc: 0.5596
 Best site-Others_utk               (5)  | Epoch:9 | Val Acc: 0.5874
 Best site-Southeast_Asian          (6)  | Epoch:9 | Val Acc: 0.4118
 Best site-Middle_Eastern_gan       (0)  | Epoch:9 | Val Acc: 0.5060
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (1)| Epoch:9 | Test Acc: 0.2970
 Test site-White                     (2)| Epoch:9 | Test Acc: 0.3924
 Test site-Indian_utk                (3)| Epoch:9 | Test Acc: 0.5021
 Test site-Black_utk                 (4)| Epoch:9 | Test Acc: 0.4133
 Test site-Others_utk                (4)| Epoch:9 | Test Acc: 0.5678
 Test site-Southeast_Asian           (6)| Epoch:9 | Test Acc: 0.4107
 Test site-Middle_Eastern_gan        (0)| Epoch:9 | Test Acc: 0.5051
White_utk: 0.2970, White: 0.3924, Indian_utk: 0.5021, Black_utk: 0.4133, Others_utk: 0.5678, Southeast_Asian: 0.4107, Middle_Eastern_gan: 0.5051, 
Average Test Accuracy(group): 0.4412, Average Test Accuracy(individual): 0.4133,
domain CV=0.1890, cluster CV=nan, individual CV=0.2203, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 10 ============
cnt=[1, 5, 1, 3, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-White_utk                 (1) | Train Loss: 1.6852 | Train Acc: 0.2734
 Site-White_utk                 (1) | Train Loss: 1.6943 | Train Acc: 0.3512
 Site-White_utk                 (1) | Train Loss: 1.7216 | Train Acc: 0.2909
 Site-White_utk                 (1) | Train Loss: 1.7576 | Train Acc: 0.2708
 Site-White_utk                 (1) | Train Loss: 1.7041 | Train Acc: 0.3201
 Site-White                     (4) | Train Loss: 1.6376 | Train Acc: 0.3819
 Site-White                     (4) | Train Loss: 1.5923 | Train Acc: 0.4309
 Site-White                     (4) | Train Loss: 1.6469 | Train Acc: 0.4049
 Site-White                     (4) | Train Loss: 1.5773 | Train Acc: 0.4025
 Site-Indian_utk                (3) | Train Loss: 1.4995 | Train Acc: 0.5072
 Site-Indian_utk                (3) | Train Loss: 1.5882 | Train Acc: 0.4530
 Site-Indian_utk                (3) | Train Loss: 1.5427 | Train Acc: 0.4496
 Site-Black_utk                 (6) | Train Loss: 1.4999 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.6131 | Train Acc: 0.4690
 Site-Others_utk                (6) | Train Loss: 1.2777 | Train Acc: 0.6098
 Site-Others_utk                (5) | Train Loss: 1.3604 | Train Acc: 0.5701
 Site-Southeast_Asian           (0) | Train Loss: 1.6693 | Train Acc: 0.3876
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.3970 | Train Acc: 0.6560
Average Train Accuracy: 0.4294
 Site-White_utk                 (1) | Val  Loss: 1.6888 | Val  Acc: 0.3059
 Site-White_utk                 (1) | Val  Loss: 1.7176 | Val  Acc: 0.2857
 Site-White_utk                 (1) | Val  Loss: 1.7457 | Val  Acc: 0.2653
 Site-White_utk                 (1) | Val  Loss: 1.8039 | Val  Acc: 0.2917
 Site-White_utk                 (1) | Val  Loss: 1.7128 | Val  Acc: 0.2976
 Site-White                     (4) | Val  Loss: 1.6116 | Val  Acc: 0.4792
 Site-White                     (4) | Val  Loss: 1.6229 | Val  Acc: 0.4080
 Site-White                     (4) | Val  Loss: 1.6735 | Val  Acc: 0.3963
 Site-White                     (4) | Val  Loss: 1.5920 | Val  Acc: 0.4259
 Site-Indian_utk                (3) | Val  Loss: 1.5498 | Val  Acc: 0.3913
 Site-Indian_utk                (3) | Val  Loss: 1.5717 | Val  Acc: 0.4628
 Site-Indian_utk                (3) | Val  Loss: 1.5548 | Val  Acc: 0.4620
 Site-Black_utk                 (6) | Val  Loss: 1.7176 | Val  Acc: 0.4459
 Site-Black_utk                 (6) | Val  Loss: 1.5949 | Val  Acc: 0.3958
 Site-Others_utk                (6) | Val  Loss: 1.3237 | Val  Acc: 0.5505
 Site-Others_utk                (5) | Val  Loss: 1.3269 | Val  Acc: 0.5664
 Site-Southeast_Asian           (0) | Val  Loss: 1.6744 | Val  Acc: 0.4216
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8341 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4068
============ Train epoch 11 ============
cnt=[2, 4, 6, 1, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-White_utk                 (2) | Train Loss: 1.6572 | Train Acc: 0.2500
 Site-White_utk                 (2) | Train Loss: 1.7250 | Train Acc: 0.2917
 Site-White_utk                 (2) | Train Loss: 1.7613 | Train Acc: 0.2545
 Site-White_utk                 (2) | Train Loss: 1.8178 | Train Acc: 0.2292
 Site-White_utk                 (2) | Train Loss: 1.7197 | Train Acc: 0.2778
 Site-White                     (1) | Train Loss: 1.6967 | Train Acc: 0.3819
 Site-White                     (1) | Train Loss: 1.5803 | Train Acc: 0.4255
 Site-White                     (1) | Train Loss: 1.6178 | Train Acc: 0.3887
 Site-White                     (1) | Train Loss: 1.5420 | Train Acc: 0.3963
 Site-Indian_utk                (5) | Train Loss: 1.5476 | Train Acc: 0.4928
 Site-Indian_utk                (5) | Train Loss: 1.5555 | Train Acc: 0.4365
 Site-Indian_utk                (5) | Train Loss: 1.4901 | Train Acc: 0.4496
 Site-Black_utk                 (0) | Train Loss: 1.5128 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.5833 | Train Acc: 0.4414
 Site-Others_utk                (6) | Train Loss: 1.2329 | Train Acc: 0.6098
 Site-Others_utk                (2) | Train Loss: 1.3154 | Train Acc: 0.5701
 Site-Southeast_Asian           (3) | Train Loss: 1.6772 | Train Acc: 0.3779
 Site-Middle_Eastern_gan        (4) | Train Loss: 1.2841 | Train Acc: 0.6400
Average Train Accuracy: 0.4119
 Site-White_utk                 (2) | Val  Loss: 1.7079 | Val  Acc: 0.2824
 Site-White_utk                 (2) | Val  Loss: 1.7746 | Val  Acc: 0.2589
 Site-White_utk                 (2) | Val  Loss: 1.7957 | Val  Acc: 0.2585
 Site-White_utk                 (2) | Val  Loss: 1.8398 | Val  Acc: 0.2760
 Site-White_utk                 (2) | Val  Loss: 1.7498 | Val  Acc: 0.2619
 Site-White                     (1) | Val  Loss: 1.6068 | Val  Acc: 0.4271
 Site-White                     (1) | Val  Loss: 1.5953 | Val  Acc: 0.4160
 Site-White                     (1) | Val  Loss: 1.6475 | Val  Acc: 0.4085
 Site-White                     (1) | Val  Loss: 1.5690 | Val  Acc: 0.4167
 Site-Indian_utk                (5) | Val  Loss: 1.5560 | Val  Acc: 0.3804
 Site-Indian_utk                (5) | Val  Loss: 1.4943 | Val  Acc: 0.4876
 Site-Indian_utk                (5) | Val  Loss: 1.5412 | Val  Acc: 0.4810
 Site-Black_utk                 (0) | Val  Loss: 1.6631 | Val  Acc: 0.5135
 Site-Black_utk                 (0) | Val  Loss: 1.5563 | Val  Acc: 0.3854
 Site-Others_utk                (6) | Val  Loss: 1.2884 | Val  Acc: 0.5688
 Site-Others_utk                (2) | Val  Loss: 1.1969 | Val  Acc: 0.6154
 Site-Southeast_Asian           (3) | Val  Loss: 1.6352 | Val  Acc: 0.4069
 Site-Middle_Eastern_gan        (4) | Val  Loss: 1.8027 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4071
============ Train epoch 12 ============
cnt=[6, 1, 4, 3, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-White_utk                 (0) | Train Loss: 1.6427 | Train Acc: 0.2734
 Site-White_utk                 (0) | Train Loss: 1.6906 | Train Acc: 0.3571
 Site-White_utk                 (0) | Train Loss: 1.7087 | Train Acc: 0.2818
 Site-White_utk                 (0) | Train Loss: 1.7225 | Train Acc: 0.2951
 Site-White_utk                 (0) | Train Loss: 1.6876 | Train Acc: 0.2884
 Site-White                     (2) | Train Loss: 1.5822 | Train Acc: 0.3819
 Site-White                     (2) | Train Loss: 1.5464 | Train Acc: 0.4043
 Site-White                     (2) | Train Loss: 1.5924 | Train Acc: 0.4170
 Site-White                     (2) | Train Loss: 1.5198 | Train Acc: 0.3932
 Site-Indian_utk                (3) | Train Loss: 1.3611 | Train Acc: 0.5435
 Site-Indian_utk                (3) | Train Loss: 1.5495 | Train Acc: 0.4475
 Site-Indian_utk                (3) | Train Loss: 1.4673 | Train Acc: 0.4706
 Site-Black_utk                 (4) | Train Loss: 1.4886 | Train Acc: 0.5273
 Site-Black_utk                 (4) | Train Loss: 1.5718 | Train Acc: 0.4621
 Site-Others_utk                (0) | Train Loss: 1.1818 | Train Acc: 0.6463
 Site-Others_utk                (5) | Train Loss: 1.3278 | Train Acc: 0.5935
 Site-Southeast_Asian           (6) | Train Loss: 1.6218 | Train Acc: 0.4300
 Site-Middle_Eastern_gan        (1) | Train Loss: 1.3025 | Train Acc: 0.6560
Average Train Accuracy: 0.4372
 Site-White_utk                 (0) | Val  Loss: 1.6581 | Val  Acc: 0.2941
 Site-White_utk                 (0) | Val  Loss: 1.7213 | Val  Acc: 0.2857
 Site-White_utk                 (0) | Val  Loss: 1.7533 | Val  Acc: 0.2993
 Site-White_utk                 (0) | Val  Loss: 1.7939 | Val  Acc: 0.2812
 Site-White_utk                 (0) | Val  Loss: 1.6913 | Val  Acc: 0.2857
 Site-White                     (2) | Val  Loss: 1.5776 | Val  Acc: 0.4271
 Site-White                     (2) | Val  Loss: 1.5365 | Val  Acc: 0.4320
 Site-White                     (2) | Val  Loss: 1.5882 | Val  Acc: 0.4024
 Site-White                     (2) | Val  Loss: 1.5503 | Val  Acc: 0.4398
 Site-Indian_utk                (3) | Val  Loss: 1.5065 | Val  Acc: 0.4239
 Site-Indian_utk                (3) | Val  Loss: 1.4959 | Val  Acc: 0.4463
 Site-Indian_utk                (3) | Val  Loss: 1.5378 | Val  Acc: 0.4557
 Site-Black_utk                 (4) | Val  Loss: 1.6555 | Val  Acc: 0.4865
 Site-Black_utk                 (4) | Val  Loss: 1.5658 | Val  Acc: 0.4271
 Site-Others_utk                (0) | Val  Loss: 1.2752 | Val  Acc: 0.5780
 Site-Others_utk                (5) | Val  Loss: 1.2275 | Val  Acc: 0.6014
 Site-Southeast_Asian           (6) | Val  Loss: 1.6003 | Val  Acc: 0.4020
 Site-Middle_Eastern_gan        (1) | Val  Loss: 1.8212 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4139
 Best site-White_utk                (0)  | Epoch:12 | Val Acc: 0.2941
 Best site-White_utk                (0)  | Epoch:12 | Val Acc: 0.2857
 Best site-White_utk                (0)  | Epoch:12 | Val Acc: 0.2993
 Best site-White_utk                (0)  | Epoch:12 | Val Acc: 0.2812
 Best site-White_utk                (0)  | Epoch:12 | Val Acc: 0.2857
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4271
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4320
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4024
 Best site-White                    (2)  | Epoch:12 | Val Acc: 0.4398
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4239
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4463
 Best site-Indian_utk               (3)  | Epoch:12 | Val Acc: 0.4557
 Best site-Black_utk                (4)  | Epoch:12 | Val Acc: 0.4865
 Best site-Black_utk                (4)  | Epoch:12 | Val Acc: 0.4271
 Best site-Others_utk               (0)  | Epoch:12 | Val Acc: 0.5780
 Best site-Others_utk               (5)  | Epoch:12 | Val Acc: 0.6014
 Best site-Southeast_Asian          (6)  | Epoch:12 | Val Acc: 0.4020
 Best site-Middle_Eastern_gan       (1)  | Epoch:12 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 4, 5, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-White_utk                 (2) | Train Loss: 1.5887 | Train Acc: 0.2969
 Site-White_utk                 (2) | Train Loss: 1.6186 | Train Acc: 0.3690
 Site-White_utk                 (2) | Train Loss: 1.6750 | Train Acc: 0.2909
 Site-White_utk                 (2) | Train Loss: 1.7227 | Train Acc: 0.3160
 Site-White_utk                 (2) | Train Loss: 1.6263 | Train Acc: 0.3598
 Site-White                     (1) | Train Loss: 1.5578 | Train Acc: 0.4097
 Site-White                     (1) | Train Loss: 1.5333 | Train Acc: 0.4415
 Site-White                     (1) | Train Loss: 1.5926 | Train Acc: 0.4008
 Site-White                     (1) | Train Loss: 1.4603 | Train Acc: 0.4180
 Site-Indian_utk                (4) | Train Loss: 1.4764 | Train Acc: 0.4855
 Site-Indian_utk                (4) | Train Loss: 1.5238 | Train Acc: 0.4420
 Site-Indian_utk                (4) | Train Loss: 1.4671 | Train Acc: 0.4706
 Site-Black_utk                 (0) | Train Loss: 1.4828 | Train Acc: 0.4909
 Site-Black_utk                 (0) | Train Loss: 1.5109 | Train Acc: 0.4552
 Site-Others_utk                (5) | Train Loss: 1.1566 | Train Acc: 0.6341
 Site-Others_utk                (4) | Train Loss: 1.3446 | Train Acc: 0.5748
 Site-Southeast_Asian           (6) | Train Loss: 1.6214 | Train Acc: 0.4235
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.3522 | Train Acc: 0.6320
Average Train Accuracy: 0.4395
 Site-White_utk                 (2) | Val  Loss: 1.6352 | Val  Acc: 0.3176
 Site-White_utk                 (2) | Val  Loss: 1.6589 | Val  Acc: 0.3393
 Site-White_utk                 (2) | Val  Loss: 1.7195 | Val  Acc: 0.3129
 Site-White_utk                 (2) | Val  Loss: 1.7824 | Val  Acc: 0.2708
 Site-White_utk                 (2) | Val  Loss: 1.6576 | Val  Acc: 0.3095
 Site-White                     (1) | Val  Loss: 1.5789 | Val  Acc: 0.4271
 Site-White                     (1) | Val  Loss: 1.5805 | Val  Acc: 0.4320
 Site-White                     (1) | Val  Loss: 1.5855 | Val  Acc: 0.4207
 Site-White                     (1) | Val  Loss: 1.5364 | Val  Acc: 0.4213
 Site-Indian_utk                (4) | Val  Loss: 1.4619 | Val  Acc: 0.4130
 Site-Indian_utk                (4) | Val  Loss: 1.4981 | Val  Acc: 0.4711
 Site-Indian_utk                (4) | Val  Loss: 1.5244 | Val  Acc: 0.4747
 Site-Black_utk                 (0) | Val  Loss: 1.5310 | Val  Acc: 0.5270
 Site-Black_utk                 (0) | Val  Loss: 1.5822 | Val  Acc: 0.3646
 Site-Others_utk                (5) | Val  Loss: 1.2441 | Val  Acc: 0.5963
 Site-Others_utk                (4) | Val  Loss: 1.2506 | Val  Acc: 0.6224
 Site-Southeast_Asian           (6) | Val  Loss: 1.6177 | Val  Acc: 0.4461
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.8333 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4249
 Best site-White_utk                (2)  | Epoch:13 | Val Acc: 0.3176
 Best site-White_utk                (2)  | Epoch:13 | Val Acc: 0.3393
 Best site-White_utk                (2)  | Epoch:13 | Val Acc: 0.3129
 Best site-White_utk                (2)  | Epoch:13 | Val Acc: 0.2708
 Best site-White_utk                (2)  | Epoch:13 | Val Acc: 0.3095
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4271
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4320
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4207
 Best site-White                    (1)  | Epoch:13 | Val Acc: 0.4213
 Best site-Indian_utk               (4)  | Epoch:13 | Val Acc: 0.4130
 Best site-Indian_utk               (4)  | Epoch:13 | Val Acc: 0.4711
 Best site-Indian_utk               (4)  | Epoch:13 | Val Acc: 0.4747
 Best site-Black_utk                (0)  | Epoch:13 | Val Acc: 0.5270
 Best site-Black_utk                (0)  | Epoch:13 | Val Acc: 0.3646
 Best site-Others_utk               (5)  | Epoch:13 | Val Acc: 0.5963
 Best site-Others_utk               (4)  | Epoch:13 | Val Acc: 0.6224
 Best site-Southeast_Asian          (6)  | Epoch:13 | Val Acc: 0.4461
 Best site-Middle_Eastern_gan       (3)  | Epoch:13 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 14 ============
cnt=[1, 5, 5, 2, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-White_utk                 (2) | Train Loss: 1.6263 | Train Acc: 0.2969
 Site-White_utk                 (2) | Train Loss: 1.6689 | Train Acc: 0.3333
 Site-White_utk                 (2) | Train Loss: 1.7300 | Train Acc: 0.2955
 Site-White_utk                 (2) | Train Loss: 1.7175 | Train Acc: 0.2986
 Site-White_utk                 (2) | Train Loss: 1.6660 | Train Acc: 0.3069
 Site-White                     (1) | Train Loss: 1.6868 | Train Acc: 0.4028
 Site-White                     (1) | Train Loss: 1.4966 | Train Acc: 0.4362
 Site-White                     (1) | Train Loss: 1.5949 | Train Acc: 0.3887
 Site-White                     (1) | Train Loss: 1.6374 | Train Acc: 0.4118
 Site-Indian_utk                (5) | Train Loss: 1.4561 | Train Acc: 0.5145
 Site-Indian_utk                (5) | Train Loss: 1.4970 | Train Acc: 0.4751
 Site-Indian_utk                (5) | Train Loss: 1.4410 | Train Acc: 0.4454
 Site-Black_utk                 (3) | Train Loss: 1.4696 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.4507 | Train Acc: 0.4621
 Site-Others_utk                (0) | Train Loss: 1.1103 | Train Acc: 0.6402
 Site-Others_utk                (6) | Train Loss: 1.2745 | Train Acc: 0.5935
 Site-Southeast_Asian           (1) | Train Loss: 1.6130 | Train Acc: 0.4169
 Site-Middle_Eastern_gan        (4) | Train Loss: 1.2760 | Train Acc: 0.6320
Average Train Accuracy: 0.4361
 Site-White_utk                 (2) | Val  Loss: 1.6280 | Val  Acc: 0.2824
 Site-White_utk                 (2) | Val  Loss: 1.7181 | Val  Acc: 0.2768
 Site-White_utk                 (2) | Val  Loss: 1.7452 | Val  Acc: 0.2789
 Site-White_utk                 (2) | Val  Loss: 1.7806 | Val  Acc: 0.2760
 Site-White_utk                 (2) | Val  Loss: 1.7103 | Val  Acc: 0.2857
 Site-White                     (1) | Val  Loss: 1.5384 | Val  Acc: 0.4479
 Site-White                     (1) | Val  Loss: 1.5484 | Val  Acc: 0.4160
 Site-White                     (1) | Val  Loss: 1.6242 | Val  Acc: 0.4146
 Site-White                     (1) | Val  Loss: 1.5495 | Val  Acc: 0.4167
 Site-Indian_utk                (5) | Val  Loss: 1.4575 | Val  Acc: 0.4022
 Site-Indian_utk                (5) | Val  Loss: 1.4301 | Val  Acc: 0.4793
 Site-Indian_utk                (5) | Val  Loss: 1.4676 | Val  Acc: 0.4620
 Site-Black_utk                 (3) | Val  Loss: 1.5290 | Val  Acc: 0.5405
 Site-Black_utk                 (3) | Val  Loss: 1.5506 | Val  Acc: 0.3854
 Site-Others_utk                (0) | Val  Loss: 1.1739 | Val  Acc: 0.5963
 Site-Others_utk                (6) | Val  Loss: 1.1054 | Val  Acc: 0.6434
 Site-Southeast_Asian           (1) | Val  Loss: 1.6335 | Val  Acc: 0.4363
 Site-Middle_Eastern_gan        (4) | Val  Loss: 1.8184 | Val  Acc: 0.5060
Average Valid Accuracy: 0.4193
============ Train epoch 15 ============
cnt=[1, 1, 1, 2, 4, 4, 5, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-White_utk                 (0) | Train Loss: 1.5549 | Train Acc: 0.3125
 Site-White_utk                 (6) | Train Loss: 1.6447 | Train Acc: 0.3512
 Site-White_utk                 (6) | Train Loss: 1.6528 | Train Acc: 0.3182
 Site-White_utk                 (6) | Train Loss: 1.6786 | Train Acc: 0.3403
 Site-White_utk                 (6) | Train Loss: 1.6073 | Train Acc: 0.3598
 Site-White                     (5) | Train Loss: 1.4980 | Train Acc: 0.4236
 Site-White                     (1) | Train Loss: 1.4698 | Train Acc: 0.4149
 Site-White                     (5) | Train Loss: 1.5666 | Train Acc: 0.4089
 Site-White                     (5) | Train Loss: 1.5157 | Train Acc: 0.4087
 Site-Indian_utk                (4) | Train Loss: 1.3101 | Train Acc: 0.5362
 Site-Indian_utk                (4) | Train Loss: 1.4790 | Train Acc: 0.4530
 Site-Indian_utk                (4) | Train Loss: 1.4145 | Train Acc: 0.4748
 Site-Black_utk                 (3) | Train Loss: 1.4613 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.4427 | Train Acc: 0.4621
 Site-Others_utk                (6) | Train Loss: 1.1090 | Train Acc: 0.6463
 Site-Others_utk                (4) | Train Loss: 1.2074 | Train Acc: 0.6028
 Site-Southeast_Asian           (5) | Train Loss: 1.6126 | Train Acc: 0.4169
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.3292 | Train Acc: 0.6400
Average Train Accuracy: 0.4483
 Site-White_utk                 (0) | Val  Loss: 1.5350 | Val  Acc: 0.3765
 Site-White_utk                 (6) | Val  Loss: 1.6611 | Val  Acc: 0.3036
 Site-White_utk                 (6) | Val  Loss: 1.6995 | Val  Acc: 0.3401
 Site-White_utk                 (6) | Val  Loss: 1.7495 | Val  Acc: 0.2812
 Site-White_utk                 (6) | Val  Loss: 1.6600 | Val  Acc: 0.2937
 Site-White                     (5) | Val  Loss: 1.5449 | Val  Acc: 0.4271
 Site-White                     (1) | Val  Loss: 1.5572 | Val  Acc: 0.4080
 Site-White                     (5) | Val  Loss: 1.5829 | Val  Acc: 0.4329
 Site-White                     (5) | Val  Loss: 1.5379 | Val  Acc: 0.4074
 Site-Indian_utk                (4) | Val  Loss: 1.4626 | Val  Acc: 0.3696
 Site-Indian_utk                (4) | Val  Loss: 1.4266 | Val  Acc: 0.4545
 Site-Indian_utk                (4) | Val  Loss: 1.4836 | Val  Acc: 0.4684
 Site-Black_utk                 (3) | Val  Loss: 1.5092 | Val  Acc: 0.5135
 Site-Black_utk                 (3) | Val  Loss: 1.5038 | Val  Acc: 0.4062
 Site-Others_utk                (6) | Val  Loss: 1.2204 | Val  Acc: 0.5688
 Site-Others_utk                (4) | Val  Loss: 1.1882 | Val  Acc: 0.6224
 Site-Southeast_Asian           (5) | Val  Loss: 1.5747 | Val  Acc: 0.4314
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8331 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4208
============ Train epoch 16 ============
cnt=[6, 5, 1, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-White_utk                 (0) | Train Loss: 1.5725 | Train Acc: 0.3047
 Site-White_utk                 (0) | Train Loss: 1.6447 | Train Acc: 0.3452
 Site-White_utk                 (0) | Train Loss: 1.6810 | Train Acc: 0.2909
 Site-White_utk                 (0) | Train Loss: 1.7385 | Train Acc: 0.2917
 Site-White_utk                 (0) | Train Loss: 1.6363 | Train Acc: 0.3254
 Site-White                     (1) | Train Loss: 1.5352 | Train Acc: 0.4167
 Site-White                     (1) | Train Loss: 1.4720 | Train Acc: 0.4362
 Site-White                     (1) | Train Loss: 1.5852 | Train Acc: 0.3927
 Site-White                     (1) | Train Loss: 1.5097 | Train Acc: 0.3870
 Site-Indian_utk                (4) | Train Loss: 1.4044 | Train Acc: 0.4783
 Site-Indian_utk                (4) | Train Loss: 1.4838 | Train Acc: 0.4420
 Site-Indian_utk                (4) | Train Loss: 1.3887 | Train Acc: 0.4874
 Site-Black_utk                 (3) | Train Loss: 1.4157 | Train Acc: 0.5273
 Site-Black_utk                 (5) | Train Loss: 1.4375 | Train Acc: 0.4345
 Site-Others_utk                (6) | Train Loss: 1.0806 | Train Acc: 0.6220
 Site-Others_utk                (0) | Train Loss: 1.1865 | Train Acc: 0.6262
 Site-Southeast_Asian           (1) | Train Loss: 1.6221 | Train Acc: 0.4169
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2681 | Train Acc: 0.6400
Average Train Accuracy: 0.4369
 Site-White_utk                 (0) | Val  Loss: 1.5407 | Val  Acc: 0.3176
 Site-White_utk                 (0) | Val  Loss: 1.6903 | Val  Acc: 0.2857
 Site-White_utk                 (0) | Val  Loss: 1.7118 | Val  Acc: 0.3061
 Site-White_utk                 (0) | Val  Loss: 1.7689 | Val  Acc: 0.3125
 Site-White_utk                 (0) | Val  Loss: 1.6745 | Val  Acc: 0.3056
 Site-White                     (1) | Val  Loss: 1.5078 | Val  Acc: 0.4375
 Site-White                     (1) | Val  Loss: 1.5411 | Val  Acc: 0.4160
 Site-White                     (1) | Val  Loss: 1.5752 | Val  Acc: 0.4451
 Site-White                     (1) | Val  Loss: 1.5131 | Val  Acc: 0.4352
 Site-Indian_utk                (4) | Val  Loss: 1.4676 | Val  Acc: 0.4022
 Site-Indian_utk                (4) | Val  Loss: 1.4154 | Val  Acc: 0.4793
 Site-Indian_utk                (4) | Val  Loss: 1.4673 | Val  Acc: 0.4620
 Site-Black_utk                 (3) | Val  Loss: 1.4462 | Val  Acc: 0.5405
 Site-Black_utk                 (5) | Val  Loss: 1.4976 | Val  Acc: 0.4167
 Site-Others_utk                (6) | Val  Loss: 1.1744 | Val  Acc: 0.6055
 Site-Others_utk                (0) | Val  Loss: 1.1334 | Val  Acc: 0.5944
 Site-Southeast_Asian           (1) | Val  Loss: 1.6003 | Val  Acc: 0.4265
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8067 | Val  Acc: 0.4940
Average Valid Accuracy: 0.4268
 Best site-White_utk                (0)  | Epoch:16 | Val Acc: 0.3176
 Best site-White_utk                (0)  | Epoch:16 | Val Acc: 0.2857
 Best site-White_utk                (0)  | Epoch:16 | Val Acc: 0.3061
 Best site-White_utk                (0)  | Epoch:16 | Val Acc: 0.3125
 Best site-White_utk                (0)  | Epoch:16 | Val Acc: 0.3056
 Best site-White                    (1)  | Epoch:16 | Val Acc: 0.4375
 Best site-White                    (1)  | Epoch:16 | Val Acc: 0.4160
 Best site-White                    (1)  | Epoch:16 | Val Acc: 0.4451
 Best site-White                    (1)  | Epoch:16 | Val Acc: 0.4352
 Best site-Indian_utk               (4)  | Epoch:16 | Val Acc: 0.4022
 Best site-Indian_utk               (4)  | Epoch:16 | Val Acc: 0.4793
 Best site-Indian_utk               (4)  | Epoch:16 | Val Acc: 0.4620
 Best site-Black_utk                (3)  | Epoch:16 | Val Acc: 0.5405
 Best site-Black_utk                (5)  | Epoch:16 | Val Acc: 0.4167
 Best site-Others_utk               (6)  | Epoch:16 | Val Acc: 0.6055
 Best site-Others_utk               (0)  | Epoch:16 | Val Acc: 0.5944
 Best site-Southeast_Asian          (1)  | Epoch:16 | Val Acc: 0.4265
 Best site-Middle_Eastern_gan       (2)  | Epoch:16 | Val Acc: 0.4940
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 17 ============
cnt=[6, 2, 1, 2, 1, 3, 3, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-White_utk                 (0) | Train Loss: 1.5650 | Train Acc: 0.3281
 Site-White_utk                 (0) | Train Loss: 1.5920 | Train Acc: 0.3631
 Site-White_utk                 (0) | Train Loss: 1.6609 | Train Acc: 0.3000
 Site-White_utk                 (0) | Train Loss: 1.6615 | Train Acc: 0.2917
 Site-White_utk                 (0) | Train Loss: 1.5953 | Train Acc: 0.3386
 Site-White                     (6) | Train Loss: 1.5294 | Train Acc: 0.4167
 Site-White                     (1) | Train Loss: 1.4788 | Train Acc: 0.4362
 Site-White                     (1) | Train Loss: 1.5535 | Train Acc: 0.4049
 Site-White                     (6) | Train Loss: 1.5679 | Train Acc: 0.4241
 Site-Indian_utk                (5) | Train Loss: 1.4026 | Train Acc: 0.5217
 Site-Indian_utk                (5) | Train Loss: 1.4529 | Train Acc: 0.4641
 Site-Indian_utk                (5) | Train Loss: 1.4013 | Train Acc: 0.4790
 Site-Black_utk                 (3) | Train Loss: 1.4029 | Train Acc: 0.4818
 Site-Black_utk                 (3) | Train Loss: 1.4892 | Train Acc: 0.4966
 Site-Others_utk                (0) | Train Loss: 1.0681 | Train Acc: 0.6707
 Site-Others_utk                (4) | Train Loss: 1.2131 | Train Acc: 0.5981
 Site-Southeast_Asian           (6) | Train Loss: 1.5875 | Train Acc: 0.4365
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2713 | Train Acc: 0.6160
Average Train Accuracy: 0.4482
 Site-White_utk                 (0) | Val  Loss: 1.5738 | Val  Acc: 0.3647
 Site-White_utk                 (0) | Val  Loss: 1.6499 | Val  Acc: 0.3125
 Site-White_utk                 (0) | Val  Loss: 1.7252 | Val  Acc: 0.3265
 Site-White_utk                 (0) | Val  Loss: 1.7727 | Val  Acc: 0.2917
 Site-White_utk                 (0) | Val  Loss: 1.6474 | Val  Acc: 0.2976
 Site-White                     (6) | Val  Loss: 1.5115 | Val  Acc: 0.4583
 Site-White                     (1) | Val  Loss: 1.5241 | Val  Acc: 0.4320
 Site-White                     (1) | Val  Loss: 1.5665 | Val  Acc: 0.4146
 Site-White                     (6) | Val  Loss: 1.4911 | Val  Acc: 0.4444
 Site-Indian_utk                (5) | Val  Loss: 1.4273 | Val  Acc: 0.4130
 Site-Indian_utk                (5) | Val  Loss: 1.4091 | Val  Acc: 0.4711
 Site-Indian_utk                (5) | Val  Loss: 1.4466 | Val  Acc: 0.4684
 Site-Black_utk                 (3) | Val  Loss: 1.5174 | Val  Acc: 0.5135
 Site-Black_utk                 (3) | Val  Loss: 1.4758 | Val  Acc: 0.4792
 Site-Others_utk                (0) | Val  Loss: 1.1884 | Val  Acc: 0.5872
 Site-Others_utk                (4) | Val  Loss: 1.1316 | Val  Acc: 0.6364
 Site-Southeast_Asian           (6) | Val  Loss: 1.5656 | Val  Acc: 0.4118
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.7719 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4336
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3647
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3125
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.3265
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.2917
 Best site-White_utk                (0)  | Epoch:17 | Val Acc: 0.2976
 Best site-White                    (6)  | Epoch:17 | Val Acc: 0.4583
 Best site-White                    (1)  | Epoch:17 | Val Acc: 0.4320
 Best site-White                    (1)  | Epoch:17 | Val Acc: 0.4146
 Best site-White                    (6)  | Epoch:17 | Val Acc: 0.4444
 Best site-Indian_utk               (5)  | Epoch:17 | Val Acc: 0.4130
 Best site-Indian_utk               (5)  | Epoch:17 | Val Acc: 0.4711
 Best site-Indian_utk               (5)  | Epoch:17 | Val Acc: 0.4684
 Best site-Black_utk                (3)  | Epoch:17 | Val Acc: 0.5135
 Best site-Black_utk                (3)  | Epoch:17 | Val Acc: 0.4792
 Best site-Others_utk               (0)  | Epoch:17 | Val Acc: 0.5872
 Best site-Others_utk               (4)  | Epoch:17 | Val Acc: 0.6364
 Best site-Southeast_Asian          (6)  | Epoch:17 | Val Acc: 0.4118
 Best site-Middle_Eastern_gan       (2)  | Epoch:17 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 18 ============
cnt=[5, 5, 1, 1, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-White_utk                 (0) | Train Loss: 1.5179 | Train Acc: 0.3203
 Site-White_utk                 (0) | Train Loss: 1.5749 | Train Acc: 0.3929
 Site-White_utk                 (0) | Train Loss: 1.6149 | Train Acc: 0.3091
 Site-White_utk                 (0) | Train Loss: 1.6661 | Train Acc: 0.3333
 Site-White_utk                 (0) | Train Loss: 1.5750 | Train Acc: 0.3836
 Site-White                     (1) | Train Loss: 1.5215 | Train Acc: 0.4306
 Site-White                     (1) | Train Loss: 1.4970 | Train Acc: 0.4362
 Site-White                     (1) | Train Loss: 1.5710 | Train Acc: 0.4251
 Site-White                     (1) | Train Loss: 1.6371 | Train Acc: 0.4180
 Site-Indian_utk                (4) | Train Loss: 1.3930 | Train Acc: 0.5435
 Site-Indian_utk                (4) | Train Loss: 1.4368 | Train Acc: 0.4807
 Site-Indian_utk                (4) | Train Loss: 1.3995 | Train Acc: 0.4790
 Site-Black_utk                 (6) | Train Loss: 1.3711 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.4606 | Train Acc: 0.4690
 Site-Others_utk                (5) | Train Loss: 1.0538 | Train Acc: 0.6707
 Site-Others_utk                (5) | Train Loss: 1.2188 | Train Acc: 0.6121
 Site-Southeast_Asian           (1) | Train Loss: 1.5791 | Train Acc: 0.4495
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.3304 | Train Acc: 0.6160
Average Train Accuracy: 0.4594
 Site-White_utk                 (0) | Val  Loss: 1.5532 | Val  Acc: 0.3647
 Site-White_utk                 (0) | Val  Loss: 1.6260 | Val  Acc: 0.3304
 Site-White_utk                 (0) | Val  Loss: 1.6489 | Val  Acc: 0.3469
 Site-White_utk                 (0) | Val  Loss: 1.7063 | Val  Acc: 0.3177
 Site-White_utk                 (0) | Val  Loss: 1.6169 | Val  Acc: 0.3294
 Site-White                     (1) | Val  Loss: 1.4874 | Val  Acc: 0.4896
 Site-White                     (1) | Val  Loss: 1.5208 | Val  Acc: 0.4640
 Site-White                     (1) | Val  Loss: 1.5793 | Val  Acc: 0.4329
 Site-White                     (1) | Val  Loss: 1.4939 | Val  Acc: 0.4306
 Site-Indian_utk                (4) | Val  Loss: 1.4384 | Val  Acc: 0.4239
 Site-Indian_utk                (4) | Val  Loss: 1.3951 | Val  Acc: 0.4959
 Site-Indian_utk                (4) | Val  Loss: 1.4532 | Val  Acc: 0.4747
 Site-Black_utk                 (6) | Val  Loss: 1.4364 | Val  Acc: 0.5405
 Site-Black_utk                 (3) | Val  Loss: 1.4943 | Val  Acc: 0.4167
 Site-Others_utk                (5) | Val  Loss: 1.1684 | Val  Acc: 0.5780
 Site-Others_utk                (5) | Val  Loss: 1.1082 | Val  Acc: 0.6643
 Site-Southeast_Asian           (1) | Val  Loss: 1.5711 | Val  Acc: 0.4216
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8580 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4446
 Best site-White_utk                (0)  | Epoch:18 | Val Acc: 0.3647
 Best site-White_utk                (0)  | Epoch:18 | Val Acc: 0.3304
 Best site-White_utk                (0)  | Epoch:18 | Val Acc: 0.3469
 Best site-White_utk                (0)  | Epoch:18 | Val Acc: 0.3177
 Best site-White_utk                (0)  | Epoch:18 | Val Acc: 0.3294
 Best site-White                    (1)  | Epoch:18 | Val Acc: 0.4896
 Best site-White                    (1)  | Epoch:18 | Val Acc: 0.4640
 Best site-White                    (1)  | Epoch:18 | Val Acc: 0.4329
 Best site-White                    (1)  | Epoch:18 | Val Acc: 0.4306
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4239
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4959
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4747
 Best site-Black_utk                (6)  | Epoch:18 | Val Acc: 0.5405
 Best site-Black_utk                (3)  | Epoch:18 | Val Acc: 0.4167
 Best site-Others_utk               (5)  | Epoch:18 | Val Acc: 0.5780
 Best site-Others_utk               (5)  | Epoch:18 | Val Acc: 0.6643
 Best site-Southeast_Asian          (1)  | Epoch:18 | Val Acc: 0.4216
 Best site-Middle_Eastern_gan       (2)  | Epoch:18 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 19 ============
cnt=[6, 4, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-White_utk                 (0) | Train Loss: 1.5551 | Train Acc: 0.3281
 Site-White_utk                 (0) | Train Loss: 1.5332 | Train Acc: 0.3690
 Site-White_utk                 (0) | Train Loss: 1.6770 | Train Acc: 0.3091
 Site-White_utk                 (0) | Train Loss: 1.6366 | Train Acc: 0.3438
 Site-White_utk                 (0) | Train Loss: 1.5509 | Train Acc: 0.3704
 Site-White                     (1) | Train Loss: 1.5149 | Train Acc: 0.4236
 Site-White                     (1) | Train Loss: 1.4619 | Train Acc: 0.4096
 Site-White                     (1) | Train Loss: 1.5389 | Train Acc: 0.4089
 Site-White                     (1) | Train Loss: 1.3973 | Train Acc: 0.4241
 Site-Indian_utk                (4) | Train Loss: 1.2789 | Train Acc: 0.5362
 Site-Indian_utk                (4) | Train Loss: 1.4300 | Train Acc: 0.4696
 Site-Indian_utk                (4) | Train Loss: 1.3715 | Train Acc: 0.4874
 Site-Black_utk                 (3) | Train Loss: 1.4279 | Train Acc: 0.4909
 Site-Black_utk                 (3) | Train Loss: 1.3958 | Train Acc: 0.5172
 Site-Others_utk                (5) | Train Loss: 1.0660 | Train Acc: 0.6402
 Site-Others_utk                (0) | Train Loss: 1.1423 | Train Acc: 0.6028
 Site-Southeast_Asian           (6) | Train Loss: 1.5698 | Train Acc: 0.4430
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2807 | Train Acc: 0.6000
Average Train Accuracy: 0.4541
 Site-White_utk                 (0) | Val  Loss: 1.5017 | Val  Acc: 0.3529
 Site-White_utk                 (0) | Val  Loss: 1.6353 | Val  Acc: 0.2768
 Site-White_utk                 (0) | Val  Loss: 1.6334 | Val  Acc: 0.3197
 Site-White_utk                 (0) | Val  Loss: 1.7182 | Val  Acc: 0.3385
 Site-White_utk                 (0) | Val  Loss: 1.6044 | Val  Acc: 0.3214
 Site-White                     (1) | Val  Loss: 1.4967 | Val  Acc: 0.4688
 Site-White                     (1) | Val  Loss: 1.4964 | Val  Acc: 0.4400
 Site-White                     (1) | Val  Loss: 1.5522 | Val  Acc: 0.4268
 Site-White                     (1) | Val  Loss: 1.4912 | Val  Acc: 0.4259
 Site-Indian_utk                (4) | Val  Loss: 1.4395 | Val  Acc: 0.3913
 Site-Indian_utk                (4) | Val  Loss: 1.4151 | Val  Acc: 0.4711
 Site-Indian_utk                (4) | Val  Loss: 1.4430 | Val  Acc: 0.4747
 Site-Black_utk                 (3) | Val  Loss: 1.4740 | Val  Acc: 0.5405
 Site-Black_utk                 (3) | Val  Loss: 1.4657 | Val  Acc: 0.4792
 Site-Others_utk                (5) | Val  Loss: 1.1489 | Val  Acc: 0.5963
 Site-Others_utk                (0) | Val  Loss: 1.1159 | Val  Acc: 0.6294
 Site-Southeast_Asian           (6) | Val  Loss: 1.5333 | Val  Acc: 0.4412
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8319 | Val  Acc: 0.5060
Average Valid Accuracy: 0.4389
 Test site-White_utk                 (0)| Epoch:18 | Test Acc: 0.3361
 Test site-White                     (1)| Epoch:18 | Test Acc: 0.4304
 Test site-Indian_utk                (4)| Epoch:18 | Test Acc: 0.5437
 Test site-Black_utk                 (3)| Epoch:18 | Test Acc: 0.4898
 Test site-Others_utk                (5)| Epoch:18 | Test Acc: 0.5897
 Test site-Southeast_Asian           (6)| Epoch:18 | Test Acc: 0.4263
 Test site-Middle_Eastern_gan        (2)| Epoch:18 | Test Acc: 0.4545
White_utk: 0.3361, White: 0.4304, Indian_utk: 0.5437, Black_utk: 0.4898, Others_utk: 0.5897, Southeast_Asian: 0.4263, Middle_Eastern_gan: 0.4545, 
Average Test Accuracy(group): 0.4672, Average Test Accuracy(individual): 0.4485,
domain CV=0.1653, cluster CV=0.1653, individual CV=0.1935, 
============ Train epoch 20 ============
cnt=[2, 5, 4, 1, 3, 1, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-White_utk                 (2) | Train Loss: 1.5259 | Train Acc: 0.3047
 Site-White_utk                 (6) | Train Loss: 1.5323 | Train Acc: 0.4107
 Site-White_utk                 (2) | Train Loss: 1.5929 | Train Acc: 0.3273
 Site-White_utk                 (2) | Train Loss: 1.6118 | Train Acc: 0.3438
 Site-White_utk                 (2) | Train Loss: 1.5090 | Train Acc: 0.3942
 Site-White                     (1) | Train Loss: 1.5656 | Train Acc: 0.4306
 Site-White                     (1) | Train Loss: 1.4535 | Train Acc: 0.4309
 Site-White                     (1) | Train Loss: 1.5300 | Train Acc: 0.4494
 Site-White                     (1) | Train Loss: 1.5972 | Train Acc: 0.4149
 Site-Indian_utk                (4) | Train Loss: 1.5154 | Train Acc: 0.5507
 Site-Indian_utk                (4) | Train Loss: 1.4391 | Train Acc: 0.4751
 Site-Indian_utk                (4) | Train Loss: 1.3476 | Train Acc: 0.5168
 Site-Black_utk                 (0) | Train Loss: 1.4095 | Train Acc: 0.5091
 Site-Black_utk                 (0) | Train Loss: 1.4456 | Train Acc: 0.4690
 Site-Others_utk                (5) | Train Loss: 1.0101 | Train Acc: 0.6768
 Site-Others_utk                (6) | Train Loss: 1.1823 | Train Acc: 0.6308
 Site-Southeast_Asian           (1) | Train Loss: 1.5183 | Train Acc: 0.4593
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.3177 | Train Acc: 0.6000
Average Train Accuracy: 0.4663
 Site-White_utk                 (2) | Val  Loss: 1.4312 | Val  Acc: 0.4118
 Site-White_utk                 (6) | Val  Loss: 1.5488 | Val  Acc: 0.3214
 Site-White_utk                 (2) | Val  Loss: 1.5979 | Val  Acc: 0.3741
 Site-White_utk                 (2) | Val  Loss: 1.6855 | Val  Acc: 0.3281
 Site-White_utk                 (2) | Val  Loss: 1.5682 | Val  Acc: 0.3413
 Site-White                     (1) | Val  Loss: 1.5084 | Val  Acc: 0.4896
 Site-White                     (1) | Val  Loss: 1.5157 | Val  Acc: 0.4320
 Site-White                     (1) | Val  Loss: 1.5608 | Val  Acc: 0.4268
 Site-White                     (1) | Val  Loss: 1.4601 | Val  Acc: 0.4306
 Site-Indian_utk                (4) | Val  Loss: 1.3798 | Val  Acc: 0.4674
 Site-Indian_utk                (4) | Val  Loss: 1.3701 | Val  Acc: 0.5041
 Site-Indian_utk                (4) | Val  Loss: 1.4305 | Val  Acc: 0.4937
 Site-Black_utk                 (0) | Val  Loss: 1.4272 | Val  Acc: 0.5541
 Site-Black_utk                 (0) | Val  Loss: 1.4306 | Val  Acc: 0.5000
 Site-Others_utk                (5) | Val  Loss: 1.1412 | Val  Acc: 0.5688
 Site-Others_utk                (6) | Val  Loss: 1.1095 | Val  Acc: 0.6294
 Site-Southeast_Asian           (1) | Val  Loss: 1.5350 | Val  Acc: 0.4657
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.8717 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4567
 Best site-White_utk                (2)  | Epoch:20 | Val Acc: 0.4118
 Best site-White_utk                (6)  | Epoch:20 | Val Acc: 0.3214
 Best site-White_utk                (2)  | Epoch:20 | Val Acc: 0.3741
 Best site-White_utk                (2)  | Epoch:20 | Val Acc: 0.3281
 Best site-White_utk                (2)  | Epoch:20 | Val Acc: 0.3413
 Best site-White                    (1)  | Epoch:20 | Val Acc: 0.4896
 Best site-White                    (1)  | Epoch:20 | Val Acc: 0.4320
 Best site-White                    (1)  | Epoch:20 | Val Acc: 0.4268
 Best site-White                    (1)  | Epoch:20 | Val Acc: 0.4306
 Best site-Indian_utk               (4)  | Epoch:20 | Val Acc: 0.4674
 Best site-Indian_utk               (4)  | Epoch:20 | Val Acc: 0.5041
 Best site-Indian_utk               (4)  | Epoch:20 | Val Acc: 0.4937
 Best site-Black_utk                (0)  | Epoch:20 | Val Acc: 0.5541
 Best site-Black_utk                (0)  | Epoch:20 | Val Acc: 0.5000
 Best site-Others_utk               (5)  | Epoch:20 | Val Acc: 0.5688
 Best site-Others_utk               (6)  | Epoch:20 | Val Acc: 0.6294
 Best site-Southeast_Asian          (1)  | Epoch:20 | Val Acc: 0.4657
 Best site-Middle_Eastern_gan       (3)  | Epoch:20 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 21 ============
cnt=[2, 5, 1, 5, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-White_utk                 (3) | Train Loss: 1.5442 | Train Acc: 0.3516
 Site-White_utk                 (3) | Train Loss: 1.5625 | Train Acc: 0.3452
 Site-White_utk                 (3) | Train Loss: 1.6375 | Train Acc: 0.3273
 Site-White_utk                 (3) | Train Loss: 1.6827 | Train Acc: 0.3160
 Site-White_utk                 (3) | Train Loss: 1.5729 | Train Acc: 0.3571
 Site-White                     (1) | Train Loss: 1.6102 | Train Acc: 0.4444
 Site-White                     (1) | Train Loss: 1.4316 | Train Acc: 0.4681
 Site-White                     (1) | Train Loss: 1.5515 | Train Acc: 0.4251
 Site-White                     (1) | Train Loss: 1.4411 | Train Acc: 0.4211
 Site-Indian_utk                (4) | Train Loss: 1.2479 | Train Acc: 0.5290
 Site-Indian_utk                (4) | Train Loss: 1.3961 | Train Acc: 0.4807
 Site-Indian_utk                (4) | Train Loss: 1.3439 | Train Acc: 0.5042
 Site-Black_utk                 (0) | Train Loss: 1.3165 | Train Acc: 0.5455
 Site-Black_utk                 (0) | Train Loss: 1.3665 | Train Acc: 0.4966
 Site-Others_utk                (5) | Train Loss: 1.0180 | Train Acc: 0.6585
 Site-Others_utk                (6) | Train Loss: 1.1832 | Train Acc: 0.6589
 Site-Southeast_Asian           (1) | Train Loss: 1.5473 | Train Acc: 0.4397
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2144 | Train Acc: 0.6160
Average Train Accuracy: 0.4658
 Site-White_utk                 (3) | Val  Loss: 1.5296 | Val  Acc: 0.3176
 Site-White_utk                 (3) | Val  Loss: 1.6125 | Val  Acc: 0.3214
 Site-White_utk                 (3) | Val  Loss: 1.6576 | Val  Acc: 0.3333
 Site-White_utk                 (3) | Val  Loss: 1.7314 | Val  Acc: 0.3125
 Site-White_utk                 (3) | Val  Loss: 1.6480 | Val  Acc: 0.3016
 Site-White                     (1) | Val  Loss: 1.4546 | Val  Acc: 0.4583
 Site-White                     (1) | Val  Loss: 1.5020 | Val  Acc: 0.4240
 Site-White                     (1) | Val  Loss: 1.5535 | Val  Acc: 0.4085
 Site-White                     (1) | Val  Loss: 1.4509 | Val  Acc: 0.4583
 Site-Indian_utk                (4) | Val  Loss: 1.3672 | Val  Acc: 0.4348
 Site-Indian_utk                (4) | Val  Loss: 1.3349 | Val  Acc: 0.5289
 Site-Indian_utk                (4) | Val  Loss: 1.4063 | Val  Acc: 0.4810
 Site-Black_utk                 (0) | Val  Loss: 1.4121 | Val  Acc: 0.5405
 Site-Black_utk                 (0) | Val  Loss: 1.4174 | Val  Acc: 0.4896
 Site-Others_utk                (5) | Val  Loss: 1.0741 | Val  Acc: 0.6055
 Site-Others_utk                (6) | Val  Loss: 1.0409 | Val  Acc: 0.6434
 Site-Southeast_Asian           (1) | Val  Loss: 1.5362 | Val  Acc: 0.4510
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.7925 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4440
============ Train epoch 22 ============
cnt=[1, 5, 5, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-White_utk                 (1) | Train Loss: 1.5244 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.5599 | Train Acc: 0.3988
 Site-White_utk                 (1) | Train Loss: 1.6176 | Train Acc: 0.3000
 Site-White_utk                 (1) | Train Loss: 1.6680 | Train Acc: 0.3194
 Site-White_utk                 (1) | Train Loss: 1.5335 | Train Acc: 0.3757
 Site-White                     (2) | Train Loss: 1.4359 | Train Acc: 0.4306
 Site-White                     (2) | Train Loss: 1.4410 | Train Acc: 0.4255
 Site-White                     (2) | Train Loss: 1.5344 | Train Acc: 0.4170
 Site-White                     (2) | Train Loss: 1.5695 | Train Acc: 0.4334
 Site-Indian_utk                (4) | Train Loss: 1.3069 | Train Acc: 0.5652
 Site-Indian_utk                (4) | Train Loss: 1.3842 | Train Acc: 0.4972
 Site-Indian_utk                (4) | Train Loss: 1.3264 | Train Acc: 0.5084
 Site-Black_utk                 (3) | Train Loss: 1.3476 | Train Acc: 0.5182
 Site-Black_utk                 (3) | Train Loss: 1.4112 | Train Acc: 0.4897
 Site-Others_utk                (6) | Train Loss: 0.9967 | Train Acc: 0.6585
 Site-Others_utk                (5) | Train Loss: 1.1204 | Train Acc: 0.6355
 Site-Southeast_Asian           (2) | Train Loss: 1.5612 | Train Acc: 0.4560
 Site-Middle_Eastern_gan        (0) | Train Loss: 1.2564 | Train Acc: 0.6160
Average Train Accuracy: 0.4669
 Site-White_utk                 (1) | Val  Loss: 1.4578 | Val  Acc: 0.3647
 Site-White_utk                 (1) | Val  Loss: 1.6070 | Val  Acc: 0.2768
 Site-White_utk                 (1) | Val  Loss: 1.6272 | Val  Acc: 0.3129
 Site-White_utk                 (1) | Val  Loss: 1.6848 | Val  Acc: 0.3281
 Site-White_utk                 (1) | Val  Loss: 1.5836 | Val  Acc: 0.3373
 Site-White                     (2) | Val  Loss: 1.4746 | Val  Acc: 0.4583
 Site-White                     (2) | Val  Loss: 1.5094 | Val  Acc: 0.4320
 Site-White                     (2) | Val  Loss: 1.5100 | Val  Acc: 0.4390
 Site-White                     (2) | Val  Loss: 1.4715 | Val  Acc: 0.4537
 Site-Indian_utk                (4) | Val  Loss: 1.3882 | Val  Acc: 0.4457
 Site-Indian_utk                (4) | Val  Loss: 1.3338 | Val  Acc: 0.4876
 Site-Indian_utk                (4) | Val  Loss: 1.3894 | Val  Acc: 0.4810
 Site-Black_utk                 (3) | Val  Loss: 1.3590 | Val  Acc: 0.5811
 Site-Black_utk                 (3) | Val  Loss: 1.4236 | Val  Acc: 0.4792
 Site-Others_utk                (6) | Val  Loss: 1.1085 | Val  Acc: 0.5872
 Site-Others_utk                (5) | Val  Loss: 1.0310 | Val  Acc: 0.6783
 Site-Southeast_Asian           (2) | Val  Loss: 1.5273 | Val  Acc: 0.4559
 Site-Middle_Eastern_gan        (0) | Val  Loss: 1.8312 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4483
============ Train epoch 23 ============
cnt=[5, 1, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-White_utk                 (3) | Train Loss: 1.5150 | Train Acc: 0.3594
 Site-White_utk                 (3) | Train Loss: 1.5204 | Train Acc: 0.3929
 Site-White_utk                 (3) | Train Loss: 1.5558 | Train Acc: 0.3545
 Site-White_utk                 (3) | Train Loss: 1.6092 | Train Acc: 0.3438
 Site-White_utk                 (3) | Train Loss: 1.5199 | Train Acc: 0.3810
 Site-White                     (0) | Train Loss: 1.5105 | Train Acc: 0.4375
 Site-White                     (0) | Train Loss: 1.4520 | Train Acc: 0.4415
 Site-White                     (0) | Train Loss: 1.5249 | Train Acc: 0.4251
 Site-White                     (0) | Train Loss: 1.5481 | Train Acc: 0.4241
 Site-Indian_utk                (4) | Train Loss: 1.3019 | Train Acc: 0.5507
 Site-Indian_utk                (4) | Train Loss: 1.3975 | Train Acc: 0.4586
 Site-Indian_utk                (4) | Train Loss: 1.3276 | Train Acc: 0.4790
 Site-Black_utk                 (5) | Train Loss: 1.3843 | Train Acc: 0.5364
 Site-Black_utk                 (5) | Train Loss: 1.3986 | Train Acc: 0.5172
 Site-Others_utk                (1) | Train Loss: 0.9970 | Train Acc: 0.6890
 Site-Others_utk                (6) | Train Loss: 1.1091 | Train Acc: 0.6308
 Site-Southeast_Asian           (0) | Train Loss: 1.5636 | Train Acc: 0.4625
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2794 | Train Acc: 0.6240
Average Train Accuracy: 0.4727
 Site-White_utk                 (3) | Val  Loss: 1.4610 | Val  Acc: 0.3412
 Site-White_utk                 (3) | Val  Loss: 1.5465 | Val  Acc: 0.3214
 Site-White_utk                 (3) | Val  Loss: 1.5861 | Val  Acc: 0.3673
 Site-White_utk                 (3) | Val  Loss: 1.6701 | Val  Acc: 0.3125
 Site-White_utk                 (3) | Val  Loss: 1.5306 | Val  Acc: 0.3849
 Site-White                     (0) | Val  Loss: 1.4448 | Val  Acc: 0.4896
 Site-White                     (0) | Val  Loss: 1.4925 | Val  Acc: 0.4000
 Site-White                     (0) | Val  Loss: 1.5271 | Val  Acc: 0.4451
 Site-White                     (0) | Val  Loss: 1.4680 | Val  Acc: 0.4444
 Site-Indian_utk                (4) | Val  Loss: 1.3569 | Val  Acc: 0.4457
 Site-Indian_utk                (4) | Val  Loss: 1.3494 | Val  Acc: 0.5041
 Site-Indian_utk                (4) | Val  Loss: 1.3987 | Val  Acc: 0.5063
 Site-Black_utk                 (5) | Val  Loss: 1.4241 | Val  Acc: 0.5270
 Site-Black_utk                 (5) | Val  Loss: 1.4334 | Val  Acc: 0.4792
 Site-Others_utk                (1) | Val  Loss: 1.0799 | Val  Acc: 0.6055
 Site-Others_utk                (6) | Val  Loss: 1.0366 | Val  Acc: 0.6573
 Site-Southeast_Asian           (0) | Val  Loss: 1.5278 | Val  Acc: 0.4608
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8477 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4528
============ Train epoch 24 ============
cnt=[6, 1, 3, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-White_utk                 (0) | Train Loss: 1.4643 | Train Acc: 0.3672
 Site-White_utk                 (0) | Train Loss: 1.4845 | Train Acc: 0.3750
 Site-White_utk                 (0) | Train Loss: 1.5626 | Train Acc: 0.3455
 Site-White_utk                 (0) | Train Loss: 1.5892 | Train Acc: 0.3611
 Site-White_utk                 (0) | Train Loss: 1.4784 | Train Acc: 0.4497
 Site-White                     (4) | Train Loss: 1.4987 | Train Acc: 0.4306
 Site-White                     (4) | Train Loss: 1.4257 | Train Acc: 0.4840
 Site-White                     (4) | Train Loss: 1.5070 | Train Acc: 0.4211
 Site-White                     (4) | Train Loss: 1.2931 | Train Acc: 0.4180
 Site-Indian_utk                (2) | Train Loss: 1.2915 | Train Acc: 0.5290
 Site-Indian_utk                (2) | Train Loss: 1.3580 | Train Acc: 0.5138
 Site-Indian_utk                (2) | Train Loss: 1.2828 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.3391 | Train Acc: 0.5273
 Site-Black_utk                 (5) | Train Loss: 1.3736 | Train Acc: 0.4828
 Site-Others_utk                (0) | Train Loss: 0.9895 | Train Acc: 0.6890
 Site-Others_utk                (6) | Train Loss: 1.0820 | Train Acc: 0.6589
 Site-Southeast_Asian           (1) | Train Loss: 1.4947 | Train Acc: 0.4788
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.2706 | Train Acc: 0.6320
Average Train Accuracy: 0.4813
 Site-White_utk                 (0) | Val  Loss: 1.4074 | Val  Acc: 0.4471
 Site-White_utk                 (0) | Val  Loss: 1.5422 | Val  Acc: 0.3214
 Site-White_utk                 (0) | Val  Loss: 1.5953 | Val  Acc: 0.3401
 Site-White_utk                 (0) | Val  Loss: 1.6982 | Val  Acc: 0.3542
 Site-White_utk                 (0) | Val  Loss: 1.5526 | Val  Acc: 0.3611
 Site-White                     (4) | Val  Loss: 1.4566 | Val  Acc: 0.4688
 Site-White                     (4) | Val  Loss: 1.4858 | Val  Acc: 0.4400
 Site-White                     (4) | Val  Loss: 1.5378 | Val  Acc: 0.4268
 Site-White                     (4) | Val  Loss: 1.4431 | Val  Acc: 0.4630
 Site-Indian_utk                (2) | Val  Loss: 1.3455 | Val  Acc: 0.4891
 Site-Indian_utk                (2) | Val  Loss: 1.3290 | Val  Acc: 0.5455
 Site-Indian_utk                (2) | Val  Loss: 1.3749 | Val  Acc: 0.5063
 Site-Black_utk                 (5) | Val  Loss: 1.3750 | Val  Acc: 0.5676
 Site-Black_utk                 (5) | Val  Loss: 1.3934 | Val  Acc: 0.4896
 Site-Others_utk                (0) | Val  Loss: 1.0540 | Val  Acc: 0.6422
 Site-Others_utk                (6) | Val  Loss: 1.0254 | Val  Acc: 0.6573
 Site-Southeast_Asian           (1) | Val  Loss: 1.5172 | Val  Acc: 0.4657
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.8310 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4691
 Best site-White_utk                (0)  | Epoch:24 | Val Acc: 0.4471
 Best site-White_utk                (0)  | Epoch:24 | Val Acc: 0.3214
 Best site-White_utk                (0)  | Epoch:24 | Val Acc: 0.3401
 Best site-White_utk                (0)  | Epoch:24 | Val Acc: 0.3542
 Best site-White_utk                (0)  | Epoch:24 | Val Acc: 0.3611
 Best site-White                    (4)  | Epoch:24 | Val Acc: 0.4688
 Best site-White                    (4)  | Epoch:24 | Val Acc: 0.4400
 Best site-White                    (4)  | Epoch:24 | Val Acc: 0.4268
 Best site-White                    (4)  | Epoch:24 | Val Acc: 0.4630
 Best site-Indian_utk               (2)  | Epoch:24 | Val Acc: 0.4891
 Best site-Indian_utk               (2)  | Epoch:24 | Val Acc: 0.5455
 Best site-Indian_utk               (2)  | Epoch:24 | Val Acc: 0.5063
 Best site-Black_utk                (5)  | Epoch:24 | Val Acc: 0.5676
 Best site-Black_utk                (5)  | Epoch:24 | Val Acc: 0.4896
 Best site-Others_utk               (0)  | Epoch:24 | Val Acc: 0.6422
 Best site-Others_utk               (6)  | Epoch:24 | Val Acc: 0.6573
 Best site-Southeast_Asian          (1)  | Epoch:24 | Val Acc: 0.4657
 Best site-Middle_Eastern_gan       (3)  | Epoch:24 | Val Acc: 0.4578
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 25 ============
cnt=[1, 4, 3, 1, 6, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-White_utk                 (4) | Train Loss: 1.4721 | Train Acc: 0.3750
 Site-White_utk                 (4) | Train Loss: 1.5120 | Train Acc: 0.3571
 Site-White_utk                 (4) | Train Loss: 1.5583 | Train Acc: 0.3364
 Site-White_utk                 (4) | Train Loss: 1.5735 | Train Acc: 0.3264
 Site-White_utk                 (4) | Train Loss: 1.4938 | Train Acc: 0.4074
 Site-White                     (1) | Train Loss: 1.4372 | Train Acc: 0.4514
 Site-White                     (1) | Train Loss: 1.4213 | Train Acc: 0.4628
 Site-White                     (1) | Train Loss: 1.4913 | Train Acc: 0.4291
 Site-White                     (1) | Train Loss: 1.4406 | Train Acc: 0.4087
 Site-Indian_utk                (2) | Train Loss: 1.2772 | Train Acc: 0.5290
 Site-Indian_utk                (2) | Train Loss: 1.3645 | Train Acc: 0.5083
 Site-Indian_utk                (2) | Train Loss: 1.2970 | Train Acc: 0.4916
 Site-Black_utk                 (5) | Train Loss: 1.3456 | Train Acc: 0.5364
 Site-Black_utk                 (5) | Train Loss: 1.3789 | Train Acc: 0.5103
 Site-Others_utk                (0) | Train Loss: 0.9932 | Train Acc: 0.6646
 Site-Others_utk                (4) | Train Loss: 1.1323 | Train Acc: 0.6168
 Site-Southeast_Asian           (6) | Train Loss: 1.5023 | Train Acc: 0.4658
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.2161 | Train Acc: 0.6160
Average Train Accuracy: 0.4718
 Site-White_utk                 (4) | Val  Loss: 1.4327 | Val  Acc: 0.3647
 Site-White_utk                 (4) | Val  Loss: 1.5524 | Val  Acc: 0.3125
 Site-White_utk                 (4) | Val  Loss: 1.5851 | Val  Acc: 0.3401
 Site-White_utk                 (4) | Val  Loss: 1.6631 | Val  Acc: 0.3438
 Site-White_utk                 (4) | Val  Loss: 1.5424 | Val  Acc: 0.3175
 Site-White                     (1) | Val  Loss: 1.4015 | Val  Acc: 0.4792
 Site-White                     (1) | Val  Loss: 1.4874 | Val  Acc: 0.4480
 Site-White                     (1) | Val  Loss: 1.5113 | Val  Acc: 0.4634
 Site-White                     (1) | Val  Loss: 1.4490 | Val  Acc: 0.4630
 Site-Indian_utk                (2) | Val  Loss: 1.3709 | Val  Acc: 0.4674
 Site-Indian_utk                (2) | Val  Loss: 1.2970 | Val  Acc: 0.5289
 Site-Indian_utk                (2) | Val  Loss: 1.3788 | Val  Acc: 0.5000
 Site-Black_utk                 (5) | Val  Loss: 1.3881 | Val  Acc: 0.5135
 Site-Black_utk                 (5) | Val  Loss: 1.4582 | Val  Acc: 0.4583
 Site-Others_utk                (0) | Val  Loss: 1.1230 | Val  Acc: 0.5872
 Site-Others_utk                (4) | Val  Loss: 1.0250 | Val  Acc: 0.6783
 Site-Southeast_Asian           (6) | Val  Loss: 1.4916 | Val  Acc: 0.4461
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.8574 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4545
============ Train epoch 26 ============
cnt=[4, 7, 1, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-White_utk                 (1) | Train Loss: 1.4478 | Train Acc: 0.3672
 Site-White_utk                 (1) | Train Loss: 1.4896 | Train Acc: 0.3690
 Site-White_utk                 (1) | Train Loss: 1.5560 | Train Acc: 0.3591
 Site-White_utk                 (1) | Train Loss: 1.5799 | Train Acc: 0.3542
 Site-White_utk                 (1) | Train Loss: 1.4871 | Train Acc: 0.3942
 Site-White                     (0) | Train Loss: 1.3581 | Train Acc: 0.4444
 Site-White                     (0) | Train Loss: 1.4380 | Train Acc: 0.4415
 Site-White                     (0) | Train Loss: 1.5040 | Train Acc: 0.4170
 Site-White                     (0) | Train Loss: 1.4496 | Train Acc: 0.4334
 Site-Indian_utk                (6) | Train Loss: 1.3720 | Train Acc: 0.5217
 Site-Indian_utk                (3) | Train Loss: 1.3338 | Train Acc: 0.5193
 Site-Indian_utk                (3) | Train Loss: 1.2799 | Train Acc: 0.5294
 Site-Black_utk                 (4) | Train Loss: 1.3592 | Train Acc: 0.5273
 Site-Black_utk                 (4) | Train Loss: 1.3275 | Train Acc: 0.5310
 Site-Others_utk                (1) | Train Loss: 0.9706 | Train Acc: 0.6890
 Site-Others_utk                (1) | Train Loss: 1.1537 | Train Acc: 0.6495
 Site-Southeast_Asian           (5) | Train Loss: 1.4776 | Train Acc: 0.4658
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2468 | Train Acc: 0.6400
Average Train Accuracy: 0.4807
 Site-White_utk                 (1) | Val  Loss: 1.4240 | Val  Acc: 0.4471
 Site-White_utk                 (1) | Val  Loss: 1.5827 | Val  Acc: 0.2946
 Site-White_utk                 (1) | Val  Loss: 1.5604 | Val  Acc: 0.3605
 Site-White_utk                 (1) | Val  Loss: 1.6838 | Val  Acc: 0.3438
 Site-White_utk                 (1) | Val  Loss: 1.5354 | Val  Acc: 0.3571
 Site-White                     (0) | Val  Loss: 1.4418 | Val  Acc: 0.4375
 Site-White                     (0) | Val  Loss: 1.4586 | Val  Acc: 0.4480
 Site-White                     (0) | Val  Loss: 1.5091 | Val  Acc: 0.4573
 Site-White                     (0) | Val  Loss: 1.4326 | Val  Acc: 0.4491
 Site-Indian_utk                (6) | Val  Loss: 1.3343 | Val  Acc: 0.4565
 Site-Indian_utk                (3) | Val  Loss: 1.2920 | Val  Acc: 0.5124
 Site-Indian_utk                (3) | Val  Loss: 1.3429 | Val  Acc: 0.5063
 Site-Black_utk                 (4) | Val  Loss: 1.4625 | Val  Acc: 0.5676
 Site-Black_utk                 (4) | Val  Loss: 1.3736 | Val  Acc: 0.5000
 Site-Others_utk                (1) | Val  Loss: 1.1001 | Val  Acc: 0.5963
 Site-Others_utk                (1) | Val  Loss: 1.0141 | Val  Acc: 0.6294
 Site-Southeast_Asian           (5) | Val  Loss: 1.5069 | Val  Acc: 0.4608
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8466 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4615
============ Train epoch 27 ============
cnt=[3, 5, 1, 5, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-White_utk                 (3) | Train Loss: 1.4739 | Train Acc: 0.3438
 Site-White_utk                 (3) | Train Loss: 1.5061 | Train Acc: 0.4048
 Site-White_utk                 (3) | Train Loss: 1.5519 | Train Acc: 0.3500
 Site-White_utk                 (3) | Train Loss: 1.5907 | Train Acc: 0.3403
 Site-White_utk                 (3) | Train Loss: 1.4822 | Train Acc: 0.4074
 Site-White                     (1) | Train Loss: 1.5015 | Train Acc: 0.4375
 Site-White                     (1) | Train Loss: 1.4020 | Train Acc: 0.4521
 Site-White                     (1) | Train Loss: 1.5219 | Train Acc: 0.4130
 Site-White                     (1) | Train Loss: 1.3878 | Train Acc: 0.4365
 Site-Indian_utk                (0) | Train Loss: 1.1886 | Train Acc: 0.5217
 Site-Indian_utk                (0) | Train Loss: 1.3417 | Train Acc: 0.5138
 Site-Indian_utk                (0) | Train Loss: 1.2933 | Train Acc: 0.5042
 Site-Black_utk                 (4) | Train Loss: 1.3201 | Train Acc: 0.5455
 Site-Black_utk                 (4) | Train Loss: 1.2788 | Train Acc: 0.4828
 Site-Others_utk                (5) | Train Loss: 0.9349 | Train Acc: 0.6646
 Site-Others_utk                (6) | Train Loss: 1.0942 | Train Acc: 0.6589
 Site-Southeast_Asian           (1) | Train Loss: 1.4984 | Train Acc: 0.4919
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2007 | Train Acc: 0.6480
Average Train Accuracy: 0.4787
 Site-White_utk                 (3) | Val  Loss: 1.3937 | Val  Acc: 0.4000
 Site-White_utk                 (3) | Val  Loss: 1.5668 | Val  Acc: 0.3125
 Site-White_utk                 (3) | Val  Loss: 1.5872 | Val  Acc: 0.3605
 Site-White_utk                 (3) | Val  Loss: 1.6382 | Val  Acc: 0.3698
 Site-White_utk                 (3) | Val  Loss: 1.5439 | Val  Acc: 0.3214
 Site-White                     (1) | Val  Loss: 1.4293 | Val  Acc: 0.5208
 Site-White                     (1) | Val  Loss: 1.4444 | Val  Acc: 0.4320
 Site-White                     (1) | Val  Loss: 1.5071 | Val  Acc: 0.4329
 Site-White                     (1) | Val  Loss: 1.4366 | Val  Acc: 0.4444
 Site-Indian_utk                (0) | Val  Loss: 1.3431 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.2769 | Val  Acc: 0.5041
 Site-Indian_utk                (0) | Val  Loss: 1.3401 | Val  Acc: 0.5063
 Site-Black_utk                 (4) | Val  Loss: 1.3384 | Val  Acc: 0.5541
 Site-Black_utk                 (4) | Val  Loss: 1.4123 | Val  Acc: 0.4896
 Site-Others_utk                (5) | Val  Loss: 1.0683 | Val  Acc: 0.6239
 Site-Others_utk                (6) | Val  Loss: 0.9724 | Val  Acc: 0.6643
 Site-Southeast_Asian           (1) | Val  Loss: 1.5041 | Val  Acc: 0.4657
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8280 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4634
============ Train epoch 28 ============
cnt=[5, 5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-White_utk                 (0) | Train Loss: 1.4394 | Train Acc: 0.3750
 Site-White_utk                 (0) | Train Loss: 1.5125 | Train Acc: 0.3869
 Site-White_utk                 (0) | Train Loss: 1.5421 | Train Acc: 0.3773
 Site-White_utk                 (0) | Train Loss: 1.5861 | Train Acc: 0.3368
 Site-White_utk                 (0) | Train Loss: 1.4707 | Train Acc: 0.4021
 Site-White                     (1) | Train Loss: 1.4210 | Train Acc: 0.4514
 Site-White                     (1) | Train Loss: 1.3974 | Train Acc: 0.4574
 Site-White                     (1) | Train Loss: 1.4866 | Train Acc: 0.4251
 Site-White                     (1) | Train Loss: 1.4684 | Train Acc: 0.4272
 Site-Indian_utk                (4) | Train Loss: 1.1950 | Train Acc: 0.5725
 Site-Indian_utk                (4) | Train Loss: 1.3609 | Train Acc: 0.5193
 Site-Indian_utk                (4) | Train Loss: 1.2787 | Train Acc: 0.5420
 Site-Black_utk                 (3) | Train Loss: 1.3249 | Train Acc: 0.5455
 Site-Black_utk                 (3) | Train Loss: 1.3952 | Train Acc: 0.5103
 Site-Others_utk                (5) | Train Loss: 0.9290 | Train Acc: 0.7012
 Site-Others_utk                (6) | Train Loss: 1.1002 | Train Acc: 0.6449
 Site-Southeast_Asian           (1) | Train Loss: 1.5143 | Train Acc: 0.4365
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2362 | Train Acc: 0.6480
Average Train Accuracy: 0.4866
 Site-White_utk                 (0) | Val  Loss: 1.3629 | Val  Acc: 0.4235
 Site-White_utk                 (0) | Val  Loss: 1.5344 | Val  Acc: 0.2946
 Site-White_utk                 (0) | Val  Loss: 1.5579 | Val  Acc: 0.3810
 Site-White_utk                 (0) | Val  Loss: 1.6266 | Val  Acc: 0.3594
 Site-White_utk                 (0) | Val  Loss: 1.5120 | Val  Acc: 0.3571
 Site-White                     (1) | Val  Loss: 1.4095 | Val  Acc: 0.4583
 Site-White                     (1) | Val  Loss: 1.4514 | Val  Acc: 0.4480
 Site-White                     (1) | Val  Loss: 1.4794 | Val  Acc: 0.4878
 Site-White                     (1) | Val  Loss: 1.4212 | Val  Acc: 0.4444
 Site-Indian_utk                (4) | Val  Loss: 1.3538 | Val  Acc: 0.4457
 Site-Indian_utk                (4) | Val  Loss: 1.2634 | Val  Acc: 0.5620
 Site-Indian_utk                (4) | Val  Loss: 1.2949 | Val  Acc: 0.5190
 Site-Black_utk                 (3) | Val  Loss: 1.3548 | Val  Acc: 0.5405
 Site-Black_utk                 (3) | Val  Loss: 1.3861 | Val  Acc: 0.5000
 Site-Others_utk                (5) | Val  Loss: 1.0600 | Val  Acc: 0.6147
 Site-Others_utk                (6) | Val  Loss: 0.9645 | Val  Acc: 0.6853
 Site-Southeast_Asian           (1) | Val  Loss: 1.4991 | Val  Acc: 0.4755
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8242 | Val  Acc: 0.4940
Average Valid Accuracy: 0.4717
 Best site-White_utk                (0)  | Epoch:28 | Val Acc: 0.4235
 Best site-White_utk                (0)  | Epoch:28 | Val Acc: 0.2946
 Best site-White_utk                (0)  | Epoch:28 | Val Acc: 0.3810
 Best site-White_utk                (0)  | Epoch:28 | Val Acc: 0.3594
 Best site-White_utk                (0)  | Epoch:28 | Val Acc: 0.3571
 Best site-White                    (1)  | Epoch:28 | Val Acc: 0.4583
 Best site-White                    (1)  | Epoch:28 | Val Acc: 0.4480
 Best site-White                    (1)  | Epoch:28 | Val Acc: 0.4878
 Best site-White                    (1)  | Epoch:28 | Val Acc: 0.4444
 Best site-Indian_utk               (4)  | Epoch:28 | Val Acc: 0.4457
 Best site-Indian_utk               (4)  | Epoch:28 | Val Acc: 0.5620
 Best site-Indian_utk               (4)  | Epoch:28 | Val Acc: 0.5190
 Best site-Black_utk                (3)  | Epoch:28 | Val Acc: 0.5405
 Best site-Black_utk                (3)  | Epoch:28 | Val Acc: 0.5000
 Best site-Others_utk               (5)  | Epoch:28 | Val Acc: 0.6147
 Best site-Others_utk               (6)  | Epoch:28 | Val Acc: 0.6853
 Best site-Southeast_Asian          (1)  | Epoch:28 | Val Acc: 0.4755
 Best site-Middle_Eastern_gan       (2)  | Epoch:28 | Val Acc: 0.4940
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 29 ============
cnt=[5, 5, 1, 1, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-White_utk                 (0) | Train Loss: 1.4539 | Train Acc: 0.3984
 Site-White_utk                 (0) | Train Loss: 1.4845 | Train Acc: 0.4226
 Site-White_utk                 (0) | Train Loss: 1.5605 | Train Acc: 0.3591
 Site-White_utk                 (0) | Train Loss: 1.5431 | Train Acc: 0.3681
 Site-White_utk                 (0) | Train Loss: 1.4455 | Train Acc: 0.4339
 Site-White                     (1) | Train Loss: 1.4560 | Train Acc: 0.4444
 Site-White                     (1) | Train Loss: 1.4094 | Train Acc: 0.4521
 Site-White                     (1) | Train Loss: 1.4884 | Train Acc: 0.4615
 Site-White                     (1) | Train Loss: 1.5139 | Train Acc: 0.4272
 Site-Indian_utk                (5) | Train Loss: 1.2713 | Train Acc: 0.5580
 Site-Indian_utk                (5) | Train Loss: 1.3405 | Train Acc: 0.4586
 Site-Indian_utk                (5) | Train Loss: 1.2543 | Train Acc: 0.5378
 Site-Black_utk                 (4) | Train Loss: 1.3170 | Train Acc: 0.5455
 Site-Black_utk                 (4) | Train Loss: 1.2798 | Train Acc: 0.5241
 Site-Others_utk                (6) | Train Loss: 0.9423 | Train Acc: 0.6646
 Site-Others_utk                (3) | Train Loss: 1.0561 | Train Acc: 0.6355
 Site-Southeast_Asian           (1) | Train Loss: 1.5091 | Train Acc: 0.4593
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2790 | Train Acc: 0.6240
Average Train Accuracy: 0.4875
 Site-White_utk                 (0) | Val  Loss: 1.3769 | Val  Acc: 0.4471
 Site-White_utk                 (0) | Val  Loss: 1.4972 | Val  Acc: 0.3571
 Site-White_utk                 (0) | Val  Loss: 1.5287 | Val  Acc: 0.3946
 Site-White_utk                 (0) | Val  Loss: 1.6452 | Val  Acc: 0.3594
 Site-White_utk                 (0) | Val  Loss: 1.5049 | Val  Acc: 0.3849
 Site-White                     (1) | Val  Loss: 1.4217 | Val  Acc: 0.4271
 Site-White                     (1) | Val  Loss: 1.4251 | Val  Acc: 0.4400
 Site-White                     (1) | Val  Loss: 1.5065 | Val  Acc: 0.4878
 Site-White                     (1) | Val  Loss: 1.4214 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3357 | Val  Acc: 0.4565
 Site-Indian_utk                (5) | Val  Loss: 1.2680 | Val  Acc: 0.5455
 Site-Indian_utk                (5) | Val  Loss: 1.2987 | Val  Acc: 0.5316
 Site-Black_utk                 (4) | Val  Loss: 1.3660 | Val  Acc: 0.5000
 Site-Black_utk                 (4) | Val  Loss: 1.4000 | Val  Acc: 0.4896
 Site-Others_utk                (6) | Val  Loss: 1.0376 | Val  Acc: 0.6422
 Site-Others_utk                (3) | Val  Loss: 0.9852 | Val  Acc: 0.6853
 Site-Southeast_Asian           (1) | Val  Loss: 1.4932 | Val  Acc: 0.4755
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8464 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4768
 Best site-White_utk                (0)  | Epoch:29 | Val Acc: 0.4471
 Best site-White_utk                (0)  | Epoch:29 | Val Acc: 0.3571
 Best site-White_utk                (0)  | Epoch:29 | Val Acc: 0.3946
 Best site-White_utk                (0)  | Epoch:29 | Val Acc: 0.3594
 Best site-White_utk                (0)  | Epoch:29 | Val Acc: 0.3849
 Best site-White                    (1)  | Epoch:29 | Val Acc: 0.4271
 Best site-White                    (1)  | Epoch:29 | Val Acc: 0.4400
 Best site-White                    (1)  | Epoch:29 | Val Acc: 0.4878
 Best site-White                    (1)  | Epoch:29 | Val Acc: 0.5000
 Best site-Indian_utk               (5)  | Epoch:29 | Val Acc: 0.4565
 Best site-Indian_utk               (5)  | Epoch:29 | Val Acc: 0.5455
 Best site-Indian_utk               (5)  | Epoch:29 | Val Acc: 0.5316
 Best site-Black_utk                (4)  | Epoch:29 | Val Acc: 0.5000
 Best site-Black_utk                (4)  | Epoch:29 | Val Acc: 0.4896
 Best site-Others_utk               (6)  | Epoch:29 | Val Acc: 0.6422
 Best site-Others_utk               (3)  | Epoch:29 | Val Acc: 0.6853
 Best site-Southeast_Asian          (1)  | Epoch:29 | Val Acc: 0.4755
 Best site-Middle_Eastern_gan       (2)  | Epoch:29 | Val Acc: 0.4578
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (0)| Epoch:29 | Test Acc: 0.3566
 Test site-White                     (1)| Epoch:29 | Test Acc: 0.4374
 Test site-Indian_utk                (5)| Epoch:29 | Test Acc: 0.5292
 Test site-Black_utk                 (4)| Epoch:29 | Test Acc: 0.4847
 Test site-Others_utk                (6)| Epoch:29 | Test Acc: 0.5971
 Test site-Southeast_Asian           (1)| Epoch:29 | Test Acc: 0.4229
 Test site-Middle_Eastern_gan        (2)| Epoch:29 | Test Acc: 0.3939
White_utk: 0.3566, White: 0.4374, Indian_utk: 0.5292, Black_utk: 0.4847, Others_utk: 0.5971, Southeast_Asian: 0.4229, Middle_Eastern_gan: 0.3939, 
Average Test Accuracy(group): 0.4603, Average Test Accuracy(individual): 0.4500,
domain CV=0.1665, cluster CV=nan, individual CV=0.1757, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 30 ============
cnt=[5, 5, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-White_utk                 (1) | Train Loss: 1.4280 | Train Acc: 0.4141
 Site-White_utk                 (1) | Train Loss: 1.4829 | Train Acc: 0.4345
 Site-White_utk                 (1) | Train Loss: 1.5623 | Train Acc: 0.3182
 Site-White_utk                 (1) | Train Loss: 1.5411 | Train Acc: 0.3854
 Site-White_utk                 (1) | Train Loss: 1.4485 | Train Acc: 0.4206
 Site-White                     (0) | Train Loss: 1.4187 | Train Acc: 0.4514
 Site-White                     (0) | Train Loss: 1.3530 | Train Acc: 0.4628
 Site-White                     (0) | Train Loss: 1.4757 | Train Acc: 0.4251
 Site-White                     (0) | Train Loss: 1.5498 | Train Acc: 0.4458
 Site-Indian_utk                (4) | Train Loss: 1.3227 | Train Acc: 0.5435
 Site-Indian_utk                (4) | Train Loss: 1.3393 | Train Acc: 0.4696
 Site-Indian_utk                (4) | Train Loss: 1.2402 | Train Acc: 0.5420
 Site-Black_utk                 (3) | Train Loss: 1.3188 | Train Acc: 0.5545
 Site-Black_utk                 (3) | Train Loss: 1.3285 | Train Acc: 0.5310
 Site-Others_utk                (6) | Train Loss: 0.9484 | Train Acc: 0.6280
 Site-Others_utk                (5) | Train Loss: 1.0570 | Train Acc: 0.6449
 Site-Southeast_Asian           (0) | Train Loss: 1.5080 | Train Acc: 0.4723
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2239 | Train Acc: 0.6320
Average Train Accuracy: 0.4875
 Site-White_utk                 (1) | Val  Loss: 1.3520 | Val  Acc: 0.3765
 Site-White_utk                 (1) | Val  Loss: 1.5141 | Val  Acc: 0.3482
 Site-White_utk                 (1) | Val  Loss: 1.5199 | Val  Acc: 0.3673
 Site-White_utk                 (1) | Val  Loss: 1.6029 | Val  Acc: 0.3594
 Site-White_utk                 (1) | Val  Loss: 1.5443 | Val  Acc: 0.3611
 Site-White                     (0) | Val  Loss: 1.4183 | Val  Acc: 0.4583
 Site-White                     (0) | Val  Loss: 1.4553 | Val  Acc: 0.4400
 Site-White                     (0) | Val  Loss: 1.4880 | Val  Acc: 0.4512
 Site-White                     (0) | Val  Loss: 1.4014 | Val  Acc: 0.4491
 Site-Indian_utk                (4) | Val  Loss: 1.3306 | Val  Acc: 0.4565
 Site-Indian_utk                (4) | Val  Loss: 1.2404 | Val  Acc: 0.5455
 Site-Indian_utk                (4) | Val  Loss: 1.3347 | Val  Acc: 0.4747
 Site-Black_utk                 (3) | Val  Loss: 1.4737 | Val  Acc: 0.5135
 Site-Black_utk                 (3) | Val  Loss: 1.3648 | Val  Acc: 0.4479
 Site-Others_utk                (6) | Val  Loss: 1.0116 | Val  Acc: 0.6330
 Site-Others_utk                (5) | Val  Loss: 0.9811 | Val  Acc: 0.6643
 Site-Southeast_Asian           (0) | Val  Loss: 1.4962 | Val  Acc: 0.4804
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8414 | Val  Acc: 0.4337
Average Valid Accuracy: 0.4589
============ Train epoch 31 ============
cnt=[1, 5, 1, 5, 3, 2, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-White_utk                 (3) | Train Loss: 1.4456 | Train Acc: 0.3906
 Site-White_utk                 (3) | Train Loss: 1.4674 | Train Acc: 0.3929
 Site-White_utk                 (3) | Train Loss: 1.5372 | Train Acc: 0.3864
 Site-White_utk                 (3) | Train Loss: 1.5541 | Train Acc: 0.3681
 Site-White_utk                 (3) | Train Loss: 1.4274 | Train Acc: 0.4312
 Site-White                     (1) | Train Loss: 1.3881 | Train Acc: 0.4792
 Site-White                     (1) | Train Loss: 1.3812 | Train Acc: 0.4947
 Site-White                     (1) | Train Loss: 1.4812 | Train Acc: 0.4615
 Site-White                     (1) | Train Loss: 1.2928 | Train Acc: 0.4365
 Site-Indian_utk                (4) | Train Loss: 1.3479 | Train Acc: 0.5435
 Site-Indian_utk                (4) | Train Loss: 1.3388 | Train Acc: 0.4807
 Site-Indian_utk                (4) | Train Loss: 1.2497 | Train Acc: 0.5252
 Site-Black_utk                 (5) | Train Loss: 1.3405 | Train Acc: 0.5091
 Site-Black_utk                 (5) | Train Loss: 1.2674 | Train Acc: 0.5103
 Site-Others_utk                (0) | Train Loss: 0.8909 | Train Acc: 0.6768
 Site-Others_utk                (6) | Train Loss: 1.0643 | Train Acc: 0.6542
 Site-Southeast_Asian           (1) | Train Loss: 1.4955 | Train Acc: 0.4430
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.1993 | Train Acc: 0.6400
Average Train Accuracy: 0.4902
 Site-White_utk                 (3) | Val  Loss: 1.4148 | Val  Acc: 0.4118
 Site-White_utk                 (3) | Val  Loss: 1.5046 | Val  Acc: 0.3393
 Site-White_utk                 (3) | Val  Loss: 1.5139 | Val  Acc: 0.3946
 Site-White_utk                 (3) | Val  Loss: 1.6426 | Val  Acc: 0.3490
 Site-White_utk                 (3) | Val  Loss: 1.5465 | Val  Acc: 0.3452
 Site-White                     (1) | Val  Loss: 1.4205 | Val  Acc: 0.4271
 Site-White                     (1) | Val  Loss: 1.4401 | Val  Acc: 0.4240
 Site-White                     (1) | Val  Loss: 1.4623 | Val  Acc: 0.4695
 Site-White                     (1) | Val  Loss: 1.3964 | Val  Acc: 0.4769
 Site-Indian_utk                (4) | Val  Loss: 1.3009 | Val  Acc: 0.4783
 Site-Indian_utk                (4) | Val  Loss: 1.2544 | Val  Acc: 0.5041
 Site-Indian_utk                (4) | Val  Loss: 1.2869 | Val  Acc: 0.5127
 Site-Black_utk                 (5) | Val  Loss: 1.3476 | Val  Acc: 0.5946
 Site-Black_utk                 (5) | Val  Loss: 1.3616 | Val  Acc: 0.4792
 Site-Others_utk                (0) | Val  Loss: 1.0608 | Val  Acc: 0.6514
 Site-Others_utk                (6) | Val  Loss: 0.9403 | Val  Acc: 0.7063
 Site-Southeast_Asian           (1) | Val  Loss: 1.4818 | Val  Acc: 0.4559
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8329 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4716
============ Train epoch 32 ============
cnt=[3, 3, 2, 7, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-White_utk                 (3) | Train Loss: 1.4514 | Train Acc: 0.3906
 Site-White_utk                 (3) | Train Loss: 1.4835 | Train Acc: 0.4048
 Site-White_utk                 (3) | Train Loss: 1.5315 | Train Acc: 0.3409
 Site-White_utk                 (3) | Train Loss: 1.5692 | Train Acc: 0.3681
 Site-White_utk                 (3) | Train Loss: 1.4386 | Train Acc: 0.4259
 Site-White                     (1) | Train Loss: 1.3834 | Train Acc: 0.4653
 Site-White                     (6) | Train Loss: 1.3659 | Train Acc: 0.4787
 Site-White                     (1) | Train Loss: 1.4856 | Train Acc: 0.4615
 Site-White                     (1) | Train Loss: 1.5186 | Train Acc: 0.4334
 Site-Indian_utk                (0) | Train Loss: 1.3710 | Train Acc: 0.5435
 Site-Indian_utk                (0) | Train Loss: 1.3370 | Train Acc: 0.5083
 Site-Indian_utk                (0) | Train Loss: 1.2222 | Train Acc: 0.5420
 Site-Black_utk                 (2) | Train Loss: 1.3351 | Train Acc: 0.5364
 Site-Black_utk                 (2) | Train Loss: 1.3310 | Train Acc: 0.5034
 Site-Others_utk                (3) | Train Loss: 0.9385 | Train Acc: 0.6890
 Site-Others_utk                (3) | Train Loss: 1.0609 | Train Acc: 0.6355
 Site-Southeast_Asian           (5) | Train Loss: 1.4792 | Train Acc: 0.4723
 Site-Middle_Eastern_gan        (4) | Train Loss: 1.1559 | Train Acc: 0.6640
Average Train Accuracy: 0.4924
 Site-White_utk                 (3) | Val  Loss: 1.3690 | Val  Acc: 0.3765
 Site-White_utk                 (3) | Val  Loss: 1.5641 | Val  Acc: 0.3214
 Site-White_utk                 (3) | Val  Loss: 1.5192 | Val  Acc: 0.3741
 Site-White_utk                 (3) | Val  Loss: 1.5980 | Val  Acc: 0.3750
 Site-White_utk                 (3) | Val  Loss: 1.5425 | Val  Acc: 0.3651
 Site-White                     (1) | Val  Loss: 1.3878 | Val  Acc: 0.4479
 Site-White                     (6) | Val  Loss: 1.4244 | Val  Acc: 0.4480
 Site-White                     (1) | Val  Loss: 1.4817 | Val  Acc: 0.4390
 Site-White                     (1) | Val  Loss: 1.3901 | Val  Acc: 0.4907
 Site-Indian_utk                (0) | Val  Loss: 1.2698 | Val  Acc: 0.4565
 Site-Indian_utk                (0) | Val  Loss: 1.2378 | Val  Acc: 0.5041
 Site-Indian_utk                (0) | Val  Loss: 1.3242 | Val  Acc: 0.5190
 Site-Black_utk                 (2) | Val  Loss: 1.4144 | Val  Acc: 0.5270
 Site-Black_utk                 (2) | Val  Loss: 1.3565 | Val  Acc: 0.4896
 Site-Others_utk                (3) | Val  Loss: 1.0600 | Val  Acc: 0.6514
 Site-Others_utk                (3) | Val  Loss: 0.9741 | Val  Acc: 0.6993
 Site-Southeast_Asian           (5) | Val  Loss: 1.4838 | Val  Acc: 0.4706
 Site-Middle_Eastern_gan        (4) | Val  Loss: 1.7725 | Val  Acc: 0.4458
Average Valid Accuracy: 0.4667
============ Train epoch 33 ============
cnt=[4, 1, 1, 6, 2, 3, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-White_utk                 (3) | Train Loss: 1.3749 | Train Acc: 0.4062
 Site-White_utk                 (3) | Train Loss: 1.4135 | Train Acc: 0.4524
 Site-White_utk                 (3) | Train Loss: 1.4830 | Train Acc: 0.3818
 Site-White_utk                 (3) | Train Loss: 1.5301 | Train Acc: 0.3750
 Site-White_utk                 (3) | Train Loss: 1.4047 | Train Acc: 0.4365
 Site-White                     (0) | Train Loss: 1.3789 | Train Acc: 0.4583
 Site-White                     (0) | Train Loss: 1.3704 | Train Acc: 0.5053
 Site-White                     (0) | Train Loss: 1.4689 | Train Acc: 0.4534
 Site-White                     (0) | Train Loss: 1.4660 | Train Acc: 0.4396
 Site-Indian_utk                (5) | Train Loss: 1.3127 | Train Acc: 0.5580
 Site-Indian_utk                (5) | Train Loss: 1.3197 | Train Acc: 0.5304
 Site-Indian_utk                (5) | Train Loss: 1.2153 | Train Acc: 0.5420
 Site-Black_utk                 (4) | Train Loss: 1.3788 | Train Acc: 0.4909
 Site-Black_utk                 (4) | Train Loss: 1.3139 | Train Acc: 0.4966
 Site-Others_utk                (3) | Train Loss: 0.9331 | Train Acc: 0.6829
 Site-Others_utk                (1) | Train Loss: 1.0806 | Train Acc: 0.6776
 Site-Southeast_Asian           (6) | Train Loss: 1.4495 | Train Acc: 0.4951
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2127 | Train Acc: 0.6400
Average Train Accuracy: 0.5012
 Site-White_utk                 (3) | Val  Loss: 1.3318 | Val  Acc: 0.4118
 Site-White_utk                 (3) | Val  Loss: 1.4493 | Val  Acc: 0.3839
 Site-White_utk                 (3) | Val  Loss: 1.5100 | Val  Acc: 0.3741
 Site-White_utk                 (3) | Val  Loss: 1.6049 | Val  Acc: 0.3906
 Site-White_utk                 (3) | Val  Loss: 1.4744 | Val  Acc: 0.3730
 Site-White                     (0) | Val  Loss: 1.4056 | Val  Acc: 0.4167
 Site-White                     (0) | Val  Loss: 1.4267 | Val  Acc: 0.4240
 Site-White                     (0) | Val  Loss: 1.4475 | Val  Acc: 0.4390
 Site-White                     (0) | Val  Loss: 1.3820 | Val  Acc: 0.4769
 Site-Indian_utk                (5) | Val  Loss: 1.3020 | Val  Acc: 0.4783
 Site-Indian_utk                (5) | Val  Loss: 1.2486 | Val  Acc: 0.5372
 Site-Indian_utk                (5) | Val  Loss: 1.2930 | Val  Acc: 0.5000
 Site-Black_utk                 (4) | Val  Loss: 1.3187 | Val  Acc: 0.5541
 Site-Black_utk                 (4) | Val  Loss: 1.3719 | Val  Acc: 0.4479
 Site-Others_utk                (3) | Val  Loss: 1.0645 | Val  Acc: 0.6239
 Site-Others_utk                (1) | Val  Loss: 1.0070 | Val  Acc: 0.6713
 Site-Southeast_Asian           (6) | Val  Loss: 1.4188 | Val  Acc: 0.4902
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8014 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4695
============ Train epoch 34 ============
cnt=[5, 5, 1, 3, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-White_utk                 (1) | Train Loss: 1.3961 | Train Acc: 0.4375
 Site-White_utk                 (1) | Train Loss: 1.4416 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.5417 | Train Acc: 0.3455
 Site-White_utk                 (1) | Train Loss: 1.5366 | Train Acc: 0.3681
 Site-White_utk                 (1) | Train Loss: 1.4292 | Train Acc: 0.4180
 Site-White                     (0) | Train Loss: 1.4119 | Train Acc: 0.4722
 Site-White                     (0) | Train Loss: 1.3781 | Train Acc: 0.4521
 Site-White                     (0) | Train Loss: 1.4507 | Train Acc: 0.4494
 Site-White                     (0) | Train Loss: 1.4016 | Train Acc: 0.4241
 Site-Indian_utk                (3) | Train Loss: 1.1667 | Train Acc: 0.5942
 Site-Indian_utk                (3) | Train Loss: 1.2787 | Train Acc: 0.5138
 Site-Indian_utk                (3) | Train Loss: 1.2165 | Train Acc: 0.5420
 Site-Black_utk                 (5) | Train Loss: 1.3074 | Train Acc: 0.5364
 Site-Black_utk                 (5) | Train Loss: 1.2265 | Train Acc: 0.5241
 Site-Others_utk                (2) | Train Loss: 0.9026 | Train Acc: 0.6768
 Site-Others_utk                (6) | Train Loss: 1.0196 | Train Acc: 0.6542
 Site-Southeast_Asian           (0) | Train Loss: 1.4631 | Train Acc: 0.4756
 Site-Middle_Eastern_gan        (4) | Train Loss: 1.1762 | Train Acc: 0.6480
Average Train Accuracy: 0.4948
 Site-White_utk                 (1) | Val  Loss: 1.3354 | Val  Acc: 0.4235
 Site-White_utk                 (1) | Val  Loss: 1.5118 | Val  Acc: 0.3214
 Site-White_utk                 (1) | Val  Loss: 1.4927 | Val  Acc: 0.3946
 Site-White_utk                 (1) | Val  Loss: 1.6191 | Val  Acc: 0.3438
 Site-White_utk                 (1) | Val  Loss: 1.5174 | Val  Acc: 0.3651
 Site-White                     (0) | Val  Loss: 1.3507 | Val  Acc: 0.5208
 Site-White                     (0) | Val  Loss: 1.4363 | Val  Acc: 0.4160
 Site-White                     (0) | Val  Loss: 1.4737 | Val  Acc: 0.4634
 Site-White                     (0) | Val  Loss: 1.3700 | Val  Acc: 0.4815
 Site-Indian_utk                (3) | Val  Loss: 1.2921 | Val  Acc: 0.4565
 Site-Indian_utk                (3) | Val  Loss: 1.2325 | Val  Acc: 0.5289
 Site-Indian_utk                (3) | Val  Loss: 1.3000 | Val  Acc: 0.5063
 Site-Black_utk                 (5) | Val  Loss: 1.3561 | Val  Acc: 0.5405
 Site-Black_utk                 (5) | Val  Loss: 1.3449 | Val  Acc: 0.4896
 Site-Others_utk                (2) | Val  Loss: 1.0114 | Val  Acc: 0.6147
 Site-Others_utk                (6) | Val  Loss: 0.9405 | Val  Acc: 0.6853
 Site-Southeast_Asian           (0) | Val  Loss: 1.4676 | Val  Acc: 0.4853
 Site-Middle_Eastern_gan        (4) | Val  Loss: 1.8023 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4726
============ Train epoch 35 ============
cnt=[2, 4, 1, 5, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-White_utk                 (3) | Train Loss: 1.3998 | Train Acc: 0.3984
 Site-White_utk                 (3) | Train Loss: 1.4477 | Train Acc: 0.4345
 Site-White_utk                 (3) | Train Loss: 1.5063 | Train Acc: 0.3636
 Site-White_utk                 (3) | Train Loss: 1.4885 | Train Acc: 0.3750
 Site-White_utk                 (3) | Train Loss: 1.4060 | Train Acc: 0.4524
 Site-White                     (1) | Train Loss: 1.3740 | Train Acc: 0.4931
 Site-White                     (1) | Train Loss: 1.3666 | Train Acc: 0.4894
 Site-White                     (1) | Train Loss: 1.4474 | Train Acc: 0.4494
 Site-White                     (1) | Train Loss: 1.3764 | Train Acc: 0.4489
 Site-Indian_utk                (6) | Train Loss: 1.3103 | Train Acc: 0.5942
 Site-Indian_utk                (6) | Train Loss: 1.3103 | Train Acc: 0.5028
 Site-Indian_utk                (6) | Train Loss: 1.2149 | Train Acc: 0.5252
 Site-Black_utk                 (4) | Train Loss: 1.3007 | Train Acc: 0.5273
 Site-Black_utk                 (4) | Train Loss: 1.3089 | Train Acc: 0.5448
 Site-Others_utk                (0) | Train Loss: 0.9387 | Train Acc: 0.6768
 Site-Others_utk                (0) | Train Loss: 1.0676 | Train Acc: 0.6542
 Site-Southeast_Asian           (5) | Train Loss: 1.4467 | Train Acc: 0.4853
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2229 | Train Acc: 0.6480
Average Train Accuracy: 0.5035
 Site-White_utk                 (3) | Val  Loss: 1.3377 | Val  Acc: 0.4235
 Site-White_utk                 (3) | Val  Loss: 1.4562 | Val  Acc: 0.3571
 Site-White_utk                 (3) | Val  Loss: 1.4785 | Val  Acc: 0.3741
 Site-White_utk                 (3) | Val  Loss: 1.6290 | Val  Acc: 0.3750
 Site-White_utk                 (3) | Val  Loss: 1.4874 | Val  Acc: 0.3849
 Site-White                     (1) | Val  Loss: 1.3575 | Val  Acc: 0.4896
 Site-White                     (1) | Val  Loss: 1.4266 | Val  Acc: 0.4560
 Site-White                     (1) | Val  Loss: 1.4505 | Val  Acc: 0.4512
 Site-White                     (1) | Val  Loss: 1.3712 | Val  Acc: 0.4537
 Site-Indian_utk                (6) | Val  Loss: 1.2900 | Val  Acc: 0.4457
 Site-Indian_utk                (6) | Val  Loss: 1.2542 | Val  Acc: 0.5289
 Site-Indian_utk                (6) | Val  Loss: 1.3006 | Val  Acc: 0.4937
 Site-Black_utk                 (4) | Val  Loss: 1.3397 | Val  Acc: 0.5676
 Site-Black_utk                 (4) | Val  Loss: 1.3563 | Val  Acc: 0.4896
 Site-Others_utk                (0) | Val  Loss: 1.0524 | Val  Acc: 0.6514
 Site-Others_utk                (0) | Val  Loss: 0.9628 | Val  Acc: 0.6853
 Site-Southeast_Asian           (5) | Val  Loss: 1.4930 | Val  Acc: 0.4853
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8494 | Val  Acc: 0.4458
Average Valid Accuracy: 0.4755
============ Train epoch 36 ============
cnt=[3, 4, 1, 2, 6, 1, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-White_utk                 (4) | Train Loss: 1.4167 | Train Acc: 0.3906
 Site-White_utk                 (4) | Train Loss: 1.4129 | Train Acc: 0.4524
 Site-White_utk                 (4) | Train Loss: 1.4854 | Train Acc: 0.3636
 Site-White_utk                 (4) | Train Loss: 1.4919 | Train Acc: 0.4097
 Site-White_utk                 (4) | Train Loss: 1.3876 | Train Acc: 0.4524
 Site-White                     (1) | Train Loss: 1.3629 | Train Acc: 0.4375
 Site-White                     (1) | Train Loss: 1.3810 | Train Acc: 0.4787
 Site-White                     (1) | Train Loss: 1.4424 | Train Acc: 0.4453
 Site-White                     (1) | Train Loss: 1.4591 | Train Acc: 0.4149
 Site-Indian_utk                (0) | Train Loss: 1.2887 | Train Acc: 0.5290
 Site-Indian_utk                (0) | Train Loss: 1.3032 | Train Acc: 0.4972
 Site-Indian_utk                (0) | Train Loss: 1.2043 | Train Acc: 0.5420
 Site-Black_utk                 (3) | Train Loss: 1.3288 | Train Acc: 0.5545
 Site-Black_utk                 (3) | Train Loss: 1.3472 | Train Acc: 0.5448
 Site-Others_utk                (4) | Train Loss: 0.9108 | Train Acc: 0.6768
 Site-Others_utk                (6) | Train Loss: 1.0373 | Train Acc: 0.6542
 Site-Southeast_Asian           (5) | Train Loss: 1.4326 | Train Acc: 0.4853
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.2002 | Train Acc: 0.6320
Average Train Accuracy: 0.4978
 Site-White_utk                 (4) | Val  Loss: 1.2968 | Val  Acc: 0.4588
 Site-White_utk                 (4) | Val  Loss: 1.4507 | Val  Acc: 0.3750
 Site-White_utk                 (4) | Val  Loss: 1.5024 | Val  Acc: 0.3810
 Site-White_utk                 (4) | Val  Loss: 1.6025 | Val  Acc: 0.3854
 Site-White_utk                 (4) | Val  Loss: 1.4784 | Val  Acc: 0.3611
 Site-White                     (1) | Val  Loss: 1.3509 | Val  Acc: 0.4479
 Site-White                     (1) | Val  Loss: 1.4236 | Val  Acc: 0.4480
 Site-White                     (1) | Val  Loss: 1.4454 | Val  Acc: 0.4756
 Site-White                     (1) | Val  Loss: 1.3891 | Val  Acc: 0.5185
 Site-Indian_utk                (0) | Val  Loss: 1.2596 | Val  Acc: 0.4783
 Site-Indian_utk                (0) | Val  Loss: 1.2120 | Val  Acc: 0.5289
 Site-Indian_utk                (0) | Val  Loss: 1.3032 | Val  Acc: 0.5063
 Site-Black_utk                 (3) | Val  Loss: 1.3634 | Val  Acc: 0.5135
 Site-Black_utk                 (3) | Val  Loss: 1.3625 | Val  Acc: 0.4896
 Site-Others_utk                (4) | Val  Loss: 1.0382 | Val  Acc: 0.6330
 Site-Others_utk                (6) | Val  Loss: 0.9473 | Val  Acc: 0.6853
 Site-Southeast_Asian           (5) | Val  Loss: 1.4536 | Val  Acc: 0.4951
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8220 | Val  Acc: 0.4337
Average Valid Accuracy: 0.4786
 Best site-White_utk                (4)  | Epoch:36 | Val Acc: 0.4588
 Best site-White_utk                (4)  | Epoch:36 | Val Acc: 0.3750
 Best site-White_utk                (4)  | Epoch:36 | Val Acc: 0.3810
 Best site-White_utk                (4)  | Epoch:36 | Val Acc: 0.3854
 Best site-White_utk                (4)  | Epoch:36 | Val Acc: 0.3611
 Best site-White                    (1)  | Epoch:36 | Val Acc: 0.4479
 Best site-White                    (1)  | Epoch:36 | Val Acc: 0.4480
 Best site-White                    (1)  | Epoch:36 | Val Acc: 0.4756
 Best site-White                    (1)  | Epoch:36 | Val Acc: 0.5185
 Best site-Indian_utk               (0)  | Epoch:36 | Val Acc: 0.4783
 Best site-Indian_utk               (0)  | Epoch:36 | Val Acc: 0.5289
 Best site-Indian_utk               (0)  | Epoch:36 | Val Acc: 0.5063
 Best site-Black_utk                (3)  | Epoch:36 | Val Acc: 0.5135
 Best site-Black_utk                (3)  | Epoch:36 | Val Acc: 0.4896
 Best site-Others_utk               (4)  | Epoch:36 | Val Acc: 0.6330
 Best site-Others_utk               (6)  | Epoch:36 | Val Acc: 0.6853
 Best site-Southeast_Asian          (5)  | Epoch:36 | Val Acc: 0.4951
 Best site-Middle_Eastern_gan       (2)  | Epoch:36 | Val Acc: 0.4337
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 5, 1, 2, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-White_utk                 (1) | Train Loss: 1.4060 | Train Acc: 0.4375
 Site-White_utk                 (1) | Train Loss: 1.4235 | Train Acc: 0.4167
 Site-White_utk                 (1) | Train Loss: 1.5337 | Train Acc: 0.3591
 Site-White_utk                 (1) | Train Loss: 1.5007 | Train Acc: 0.3889
 Site-White_utk                 (1) | Train Loss: 1.4151 | Train Acc: 0.4206
 Site-White                     (0) | Train Loss: 1.3367 | Train Acc: 0.4583
 Site-White                     (0) | Train Loss: 1.3840 | Train Acc: 0.4681
 Site-White                     (0) | Train Loss: 1.4410 | Train Acc: 0.4413
 Site-White                     (0) | Train Loss: 1.4019 | Train Acc: 0.4334
 Site-Indian_utk                (4) | Train Loss: 1.3431 | Train Acc: 0.5652
 Site-Indian_utk                (4) | Train Loss: 1.2993 | Train Acc: 0.5083
 Site-Indian_utk                (4) | Train Loss: 1.2125 | Train Acc: 0.5294
 Site-Black_utk                 (3) | Train Loss: 1.3001 | Train Acc: 0.5545
 Site-Black_utk                 (3) | Train Loss: 1.3132 | Train Acc: 0.5448
 Site-Others_utk                (6) | Train Loss: 0.9342 | Train Acc: 0.6768
 Site-Others_utk                (4) | Train Loss: 1.0480 | Train Acc: 0.6589
 Site-Southeast_Asian           (5) | Train Loss: 1.3963 | Train Acc: 0.5081
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.1414 | Train Acc: 0.6720
Average Train Accuracy: 0.5023
 Site-White_utk                 (1) | Val  Loss: 1.3086 | Val  Acc: 0.4588
 Site-White_utk                 (1) | Val  Loss: 1.4589 | Val  Acc: 0.3482
 Site-White_utk                 (1) | Val  Loss: 1.5190 | Val  Acc: 0.4082
 Site-White_utk                 (1) | Val  Loss: 1.5900 | Val  Acc: 0.3854
 Site-White_utk                 (1) | Val  Loss: 1.4986 | Val  Acc: 0.3770
 Site-White                     (0) | Val  Loss: 1.3664 | Val  Acc: 0.4479
 Site-White                     (0) | Val  Loss: 1.4181 | Val  Acc: 0.4320
 Site-White                     (0) | Val  Loss: 1.4490 | Val  Acc: 0.4756
 Site-White                     (0) | Val  Loss: 1.3563 | Val  Acc: 0.4954
 Site-Indian_utk                (4) | Val  Loss: 1.2757 | Val  Acc: 0.4565
 Site-Indian_utk                (4) | Val  Loss: 1.2117 | Val  Acc: 0.5372
 Site-Indian_utk                (4) | Val  Loss: 1.2993 | Val  Acc: 0.5190
 Site-Black_utk                 (3) | Val  Loss: 1.4079 | Val  Acc: 0.5405
 Site-Black_utk                 (3) | Val  Loss: 1.3643 | Val  Acc: 0.4792
 Site-Others_utk                (6) | Val  Loss: 1.0261 | Val  Acc: 0.6514
 Site-Others_utk                (4) | Val  Loss: 0.9596 | Val  Acc: 0.7063
 Site-Southeast_Asian           (5) | Val  Loss: 1.4574 | Val  Acc: 0.5049
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8139 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4836
 Best site-White_utk                (1)  | Epoch:37 | Val Acc: 0.4588
 Best site-White_utk                (1)  | Epoch:37 | Val Acc: 0.3482
 Best site-White_utk                (1)  | Epoch:37 | Val Acc: 0.4082
 Best site-White_utk                (1)  | Epoch:37 | Val Acc: 0.3854
 Best site-White_utk                (1)  | Epoch:37 | Val Acc: 0.3770
 Best site-White                    (0)  | Epoch:37 | Val Acc: 0.4479
 Best site-White                    (0)  | Epoch:37 | Val Acc: 0.4320
 Best site-White                    (0)  | Epoch:37 | Val Acc: 0.4756
 Best site-White                    (0)  | Epoch:37 | Val Acc: 0.4954
 Best site-Indian_utk               (4)  | Epoch:37 | Val Acc: 0.4565
 Best site-Indian_utk               (4)  | Epoch:37 | Val Acc: 0.5372
 Best site-Indian_utk               (4)  | Epoch:37 | Val Acc: 0.5190
 Best site-Black_utk                (3)  | Epoch:37 | Val Acc: 0.5405
 Best site-Black_utk                (3)  | Epoch:37 | Val Acc: 0.4792
 Best site-Others_utk               (6)  | Epoch:37 | Val Acc: 0.6514
 Best site-Others_utk               (4)  | Epoch:37 | Val Acc: 0.7063
 Best site-Southeast_Asian          (5)  | Epoch:37 | Val Acc: 0.5049
 Best site-Middle_Eastern_gan       (2)  | Epoch:37 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 6, 4, 1, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-White_utk                 (1) | Train Loss: 1.3878 | Train Acc: 0.4062
 Site-White_utk                 (1) | Train Loss: 1.4163 | Train Acc: 0.4107
 Site-White_utk                 (1) | Train Loss: 1.5186 | Train Acc: 0.3455
 Site-White_utk                 (1) | Train Loss: 1.5412 | Train Acc: 0.3646
 Site-White_utk                 (1) | Train Loss: 1.3986 | Train Acc: 0.4497
 Site-White                     (2) | Train Loss: 1.4306 | Train Acc: 0.4375
 Site-White                     (2) | Train Loss: 1.3704 | Train Acc: 0.4628
 Site-White                     (2) | Train Loss: 1.4408 | Train Acc: 0.4534
 Site-White                     (2) | Train Loss: 1.4507 | Train Acc: 0.4303
 Site-Indian_utk                (4) | Train Loss: 1.2221 | Train Acc: 0.5797
 Site-Indian_utk                (4) | Train Loss: 1.2914 | Train Acc: 0.5028
 Site-Indian_utk                (4) | Train Loss: 1.2143 | Train Acc: 0.5378
 Site-Black_utk                 (0) | Train Loss: 1.2938 | Train Acc: 0.5636
 Site-Black_utk                 (0) | Train Loss: 1.2436 | Train Acc: 0.5241
 Site-Others_utk                (6) | Train Loss: 0.9139 | Train Acc: 0.6829
 Site-Others_utk                (1) | Train Loss: 0.9788 | Train Acc: 0.6542
 Site-Southeast_Asian           (5) | Train Loss: 1.4107 | Train Acc: 0.4886
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.1495 | Train Acc: 0.6720
Average Train Accuracy: 0.4981
 Site-White_utk                 (1) | Val  Loss: 1.3158 | Val  Acc: 0.4588
 Site-White_utk                 (1) | Val  Loss: 1.4785 | Val  Acc: 0.3661
 Site-White_utk                 (1) | Val  Loss: 1.5456 | Val  Acc: 0.3741
 Site-White_utk                 (1) | Val  Loss: 1.6167 | Val  Acc: 0.3646
 Site-White_utk                 (1) | Val  Loss: 1.5192 | Val  Acc: 0.3810
 Site-White                     (2) | Val  Loss: 1.3699 | Val  Acc: 0.4583
 Site-White                     (2) | Val  Loss: 1.4358 | Val  Acc: 0.4400
 Site-White                     (2) | Val  Loss: 1.4399 | Val  Acc: 0.4451
 Site-White                     (2) | Val  Loss: 1.3824 | Val  Acc: 0.4861
 Site-Indian_utk                (4) | Val  Loss: 1.2573 | Val  Acc: 0.4674
 Site-Indian_utk                (4) | Val  Loss: 1.2280 | Val  Acc: 0.5702
 Site-Indian_utk                (4) | Val  Loss: 1.3057 | Val  Acc: 0.4937
 Site-Black_utk                 (0) | Val  Loss: 1.3269 | Val  Acc: 0.5541
 Site-Black_utk                 (0) | Val  Loss: 1.3414 | Val  Acc: 0.5104
 Site-Others_utk                (6) | Val  Loss: 1.0168 | Val  Acc: 0.6606
 Site-Others_utk                (1) | Val  Loss: 0.9516 | Val  Acc: 0.6923
 Site-Southeast_Asian           (5) | Val  Loss: 1.4515 | Val  Acc: 0.4804
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.7824 | Val  Acc: 0.4699
Average Valid Accuracy: 0.4818
============ Train epoch 39 ============
cnt=[5, 1, 4, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-White_utk                 (0) | Train Loss: 1.3602 | Train Acc: 0.3984
 Site-White_utk                 (0) | Train Loss: 1.3951 | Train Acc: 0.4286
 Site-White_utk                 (0) | Train Loss: 1.4786 | Train Acc: 0.3864
 Site-White_utk                 (0) | Train Loss: 1.4682 | Train Acc: 0.4097
 Site-White_utk                 (0) | Train Loss: 1.3718 | Train Acc: 0.4497
 Site-White                     (2) | Train Loss: 1.4557 | Train Acc: 0.4861
 Site-White                     (2) | Train Loss: 1.3808 | Train Acc: 0.4255
 Site-White                     (2) | Train Loss: 1.4586 | Train Acc: 0.4291
 Site-White                     (2) | Train Loss: 1.4246 | Train Acc: 0.4365
 Site-Indian_utk                (3) | Train Loss: 1.1828 | Train Acc: 0.5942
 Site-Indian_utk                (3) | Train Loss: 1.3123 | Train Acc: 0.4972
 Site-Indian_utk                (3) | Train Loss: 1.2060 | Train Acc: 0.5462
 Site-Black_utk                 (4) | Train Loss: 1.3207 | Train Acc: 0.5273
 Site-Black_utk                 (4) | Train Loss: 1.3671 | Train Acc: 0.5034
 Site-Others_utk                (5) | Train Loss: 0.9419 | Train Acc: 0.6951
 Site-Others_utk                (5) | Train Loss: 1.0609 | Train Acc: 0.6542
 Site-Southeast_Asian           (6) | Train Loss: 1.3881 | Train Acc: 0.4951
 Site-Middle_Eastern_gan        (1) | Train Loss: 1.1849 | Train Acc: 0.6640
Average Train Accuracy: 0.5015
 Site-White_utk                 (0) | Val  Loss: 1.3018 | Val  Acc: 0.4824
 Site-White_utk                 (0) | Val  Loss: 1.4259 | Val  Acc: 0.3929
 Site-White_utk                 (0) | Val  Loss: 1.4657 | Val  Acc: 0.4082
 Site-White_utk                 (0) | Val  Loss: 1.5672 | Val  Acc: 0.3750
 Site-White_utk                 (0) | Val  Loss: 1.4427 | Val  Acc: 0.3889
 Site-White                     (2) | Val  Loss: 1.3898 | Val  Acc: 0.4792
 Site-White                     (2) | Val  Loss: 1.4333 | Val  Acc: 0.4240
 Site-White                     (2) | Val  Loss: 1.4417 | Val  Acc: 0.4634
 Site-White                     (2) | Val  Loss: 1.4048 | Val  Acc: 0.4907
 Site-Indian_utk                (3) | Val  Loss: 1.2716 | Val  Acc: 0.4891
 Site-Indian_utk                (3) | Val  Loss: 1.2276 | Val  Acc: 0.5124
 Site-Indian_utk                (3) | Val  Loss: 1.2822 | Val  Acc: 0.5316
 Site-Black_utk                 (4) | Val  Loss: 1.2616 | Val  Acc: 0.5676
 Site-Black_utk                 (4) | Val  Loss: 1.3852 | Val  Acc: 0.5000
 Site-Others_utk                (5) | Val  Loss: 1.0509 | Val  Acc: 0.6422
 Site-Others_utk                (5) | Val  Loss: 0.9450 | Val  Acc: 0.7063
 Site-Southeast_Asian           (6) | Val  Loss: 1.4377 | Val  Acc: 0.5196
 Site-Middle_Eastern_gan        (1) | Val  Loss: 1.8256 | Val  Acc: 0.4819
Average Valid Accuracy: 0.4920
 Best site-White_utk                (0)  | Epoch:39 | Val Acc: 0.4824
 Best site-White_utk                (0)  | Epoch:39 | Val Acc: 0.3929
 Best site-White_utk                (0)  | Epoch:39 | Val Acc: 0.4082
 Best site-White_utk                (0)  | Epoch:39 | Val Acc: 0.3750
 Best site-White_utk                (0)  | Epoch:39 | Val Acc: 0.3889
 Best site-White                    (2)  | Epoch:39 | Val Acc: 0.4792
 Best site-White                    (2)  | Epoch:39 | Val Acc: 0.4240
 Best site-White                    (2)  | Epoch:39 | Val Acc: 0.4634
 Best site-White                    (2)  | Epoch:39 | Val Acc: 0.4907
 Best site-Indian_utk               (3)  | Epoch:39 | Val Acc: 0.4891
 Best site-Indian_utk               (3)  | Epoch:39 | Val Acc: 0.5124
 Best site-Indian_utk               (3)  | Epoch:39 | Val Acc: 0.5316
 Best site-Black_utk                (4)  | Epoch:39 | Val Acc: 0.5676
 Best site-Black_utk                (4)  | Epoch:39 | Val Acc: 0.5000
 Best site-Others_utk               (5)  | Epoch:39 | Val Acc: 0.6422
 Best site-Others_utk               (5)  | Epoch:39 | Val Acc: 0.7063
 Best site-Southeast_Asian          (6)  | Epoch:39 | Val Acc: 0.5196
 Best site-Middle_Eastern_gan       (1)  | Epoch:39 | Val Acc: 0.4819
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (0)| Epoch:39 | Test Acc: 0.3864
 Test site-White                     (2)| Epoch:39 | Test Acc: 0.4402
 Test site-Indian_utk                (3)| Epoch:39 | Test Acc: 0.5521
 Test site-Black_utk                 (4)| Epoch:39 | Test Acc: 0.4745
 Test site-Others_utk                (5)| Epoch:39 | Test Acc: 0.5971
 Test site-Southeast_Asian           (6)| Epoch:39 | Test Acc: 0.4385
 Test site-Middle_Eastern_gan        (1)| Epoch:39 | Test Acc: 0.4444
White_utk: 0.3864, White: 0.4402, Indian_utk: 0.5521, Black_utk: 0.4745, Others_utk: 0.5971, Southeast_Asian: 0.4385, Middle_Eastern_gan: 0.4444, 
Average Test Accuracy(group): 0.4762, Average Test Accuracy(individual): 0.4653,
domain CV=0.1423, cluster CV=0.1423, individual CV=0.1539, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 40 ============
cnt=[2, 6, 2, 1, 4, 2, 1, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-White_utk                 (1) | Train Loss: 1.3615 | Train Acc: 0.4141
 Site-White_utk                 (1) | Train Loss: 1.4293 | Train Acc: 0.4048
 Site-White_utk                 (1) | Train Loss: 1.4636 | Train Acc: 0.3591
 Site-White_utk                 (1) | Train Loss: 1.5175 | Train Acc: 0.3854
 Site-White_utk                 (1) | Train Loss: 1.3773 | Train Acc: 0.4524
 Site-White                     (5) | Train Loss: 1.4048 | Train Acc: 0.4514
 Site-White                     (0) | Train Loss: 1.3723 | Train Acc: 0.4734
 Site-White                     (0) | Train Loss: 1.4095 | Train Acc: 0.4575
 Site-White                     (5) | Train Loss: 1.5563 | Train Acc: 0.4582
 Site-Indian_utk                (4) | Train Loss: 1.2638 | Train Acc: 0.5725
 Site-Indian_utk                (4) | Train Loss: 1.3046 | Train Acc: 0.5304
 Site-Indian_utk                (4) | Train Loss: 1.2250 | Train Acc: 0.5168
 Site-Black_utk                 (2) | Train Loss: 1.2960 | Train Acc: 0.5727
 Site-Black_utk                 (2) | Train Loss: 1.3509 | Train Acc: 0.5379
 Site-Others_utk                (4) | Train Loss: 0.9063 | Train Acc: 0.6707
 Site-Others_utk                (1) | Train Loss: 1.0795 | Train Acc: 0.6308
 Site-Southeast_Asian           (6) | Train Loss: 1.4120 | Train Acc: 0.4853
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.1125 | Train Acc: 0.6800
Average Train Accuracy: 0.5030
 Site-White_utk                 (1) | Val  Loss: 1.3081 | Val  Acc: 0.4588
 Site-White_utk                 (1) | Val  Loss: 1.4533 | Val  Acc: 0.3839
 Site-White_utk                 (1) | Val  Loss: 1.4912 | Val  Acc: 0.3878
 Site-White_utk                 (1) | Val  Loss: 1.5928 | Val  Acc: 0.3646
 Site-White_utk                 (1) | Val  Loss: 1.4773 | Val  Acc: 0.3929
 Site-White                     (5) | Val  Loss: 1.3461 | Val  Acc: 0.4688
 Site-White                     (0) | Val  Loss: 1.4358 | Val  Acc: 0.4080
 Site-White                     (0) | Val  Loss: 1.4393 | Val  Acc: 0.4512
 Site-White                     (5) | Val  Loss: 1.3657 | Val  Acc: 0.4907
 Site-Indian_utk                (4) | Val  Loss: 1.2583 | Val  Acc: 0.4783
 Site-Indian_utk                (4) | Val  Loss: 1.2114 | Val  Acc: 0.5785
 Site-Indian_utk                (4) | Val  Loss: 1.2582 | Val  Acc: 0.5316
 Site-Black_utk                 (2) | Val  Loss: 1.3687 | Val  Acc: 0.5000
 Site-Black_utk                 (2) | Val  Loss: 1.3941 | Val  Acc: 0.4583
 Site-Others_utk                (4) | Val  Loss: 1.0441 | Val  Acc: 0.6147
 Site-Others_utk                (1) | Val  Loss: 0.9393 | Val  Acc: 0.6923
 Site-Southeast_Asian           (6) | Val  Loss: 1.4059 | Val  Acc: 0.4902
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.7606 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4782
 Test site-White_utk                 (1)| Epoch:39 | Test Acc: 0.3731
 Test site-White                     (5)| Epoch:39 | Test Acc: 0.4487
 Test site-Indian_utk                (4)| Epoch:39 | Test Acc: 0.5437
 Test site-Black_utk                 (2)| Epoch:39 | Test Acc: 0.4745
 Test site-Others_utk                (4)| Epoch:39 | Test Acc: 0.5934
 Test site-Southeast_Asian           (6)| Epoch:39 | Test Acc: 0.4367
 Test site-Middle_Eastern_gan        (3)| Epoch:39 | Test Acc: 0.4646
White_utk: 0.3731, White: 0.4487, Indian_utk: 0.5437, Black_utk: 0.4745, Others_utk: 0.5934, Southeast_Asian: 0.4367, Middle_Eastern_gan: 0.4646, 
Average Test Accuracy(group): 0.4764, Average Test Accuracy(individual): 0.4627,
domain CV=0.1406, cluster CV=nan, individual CV=0.1577, 
Average Test Accuracy: 0.4764
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 41 ============
cnt=[6, 4, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-White_utk                 (0) | Train Loss: 1.4578 | Train Acc: 0.4141
 Site-White_utk                 (0) | Train Loss: 1.4743 | Train Acc: 0.4048
 Site-White_utk                 (0) | Train Loss: 1.5399 | Train Acc: 0.3636
 Site-White_utk                 (0) | Train Loss: 1.5149 | Train Acc: 0.3576
 Site-White_utk                 (0) | Train Loss: 1.4162 | Train Acc: 0.4286
 Site-White                     (5) | Train Loss: 1.2689 | Train Acc: 0.4653
 Site-White                     (1) | Train Loss: 1.3249 | Train Acc: 0.5053
 Site-White                     (1) | Train Loss: 1.4128 | Train Acc: 0.4777
 Site-White                     (1) | Train Loss: 1.3583 | Train Acc: 0.4427
 Site-Indian_utk                (4) | Train Loss: 1.1663 | Train Acc: 0.5797
 Site-Indian_utk                (4) | Train Loss: 1.3027 | Train Acc: 0.5193
 Site-Indian_utk                (4) | Train Loss: 1.2001 | Train Acc: 0.5378
 Site-Black_utk                 (3) | Train Loss: 1.2502 | Train Acc: 0.5545
 Site-Black_utk                 (3) | Train Loss: 1.2653 | Train Acc: 0.4966
 Site-Others_utk                (6) | Train Loss: 0.8898 | Train Acc: 0.6463
 Site-Others_utk                (0) | Train Loss: 1.0324 | Train Acc: 0.6729
 Site-Southeast_Asian           (1) | Train Loss: 1.3958 | Train Acc: 0.5016
 Site-Middle_Eastern_gan        (2) | Train Loss: 1.1095 | Train Acc: 0.6560
Average Train Accuracy: 0.5014
 Site-White_utk                 (0) | Val  Loss: 1.3225 | Val  Acc: 0.4353
 Site-White_utk                 (0) | Val  Loss: 1.4622 | Val  Acc: 0.3482
 Site-White_utk                 (0) | Val  Loss: 1.5300 | Val  Acc: 0.4082
 Site-White_utk                 (0) | Val  Loss: 1.6281 | Val  Acc: 0.3490
 Site-White_utk                 (0) | Val  Loss: 1.5275 | Val  Acc: 0.3810
 Site-White                     (5) | Val  Loss: 1.3743 | Val  Acc: 0.4479
 Site-White                     (1) | Val  Loss: 1.4287 | Val  Acc: 0.4560
 Site-White                     (1) | Val  Loss: 1.4434 | Val  Acc: 0.4756
 Site-White                     (1) | Val  Loss: 1.3612 | Val  Acc: 0.4861
 Site-Indian_utk                (4) | Val  Loss: 1.2668 | Val  Acc: 0.4891
 Site-Indian_utk                (4) | Val  Loss: 1.1998 | Val  Acc: 0.5537
 Site-Indian_utk                (4) | Val  Loss: 1.2478 | Val  Acc: 0.5380
 Site-Black_utk                 (3) | Val  Loss: 1.3806 | Val  Acc: 0.5135
 Site-Black_utk                 (3) | Val  Loss: 1.2914 | Val  Acc: 0.5312
 Site-Others_utk                (6) | Val  Loss: 1.0081 | Val  Acc: 0.6330
 Site-Others_utk                (0) | Val  Loss: 0.9497 | Val  Acc: 0.6713
 Site-Southeast_Asian           (1) | Val  Loss: 1.4057 | Val  Acc: 0.5049
 Site-Middle_Eastern_gan        (2) | Val  Loss: 1.8024 | Val  Acc: 0.4578
Average Valid Accuracy: 0.4822
 Test site-White_utk                 (0)| Epoch:40 | Test Acc: 0.3505
 Test site-White                     (5)| Epoch:40 | Test Acc: 0.4430
 Test site-Indian_utk                (4)| Epoch:40 | Test Acc: 0.5521
 Test site-Black_utk                 (3)| Epoch:40 | Test Acc: 0.4796
 Test site-Others_utk                (6)| Epoch:40 | Test Acc: 0.5934
 Test site-Southeast_Asian           (1)| Epoch:40 | Test Acc: 0.4367
 Test site-Middle_Eastern_gan        (2)| Epoch:40 | Test Acc: 0.4848
White_utk: 0.3505, White: 0.4430, Indian_utk: 0.5521, Black_utk: 0.4796, Others_utk: 0.5934, Southeast_Asian: 0.4367, Middle_Eastern_gan: 0.4848, 
Average Test Accuracy(group): 0.4772, Average Test Accuracy(individual): 0.4582,
domain CV=0.1545, cluster CV=0.1545, individual CV=0.1812, 
Average Test Accuracy: 0.4772
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven-cb_1.31_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 42 ============
cnt=[1, 5, 2, 1, 1, 5, 3, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-White_utk                 (5) | Train Loss: 1.4063 | Train Acc: 0.4453
 Site-White_utk                 (5) | Train Loss: 1.4355 | Train Acc: 0.4226
 Site-White_utk                 (5) | Train Loss: 1.5286 | Train Acc: 0.3636
 Site-White_utk                 (5) | Train Loss: 1.4821 | Train Acc: 0.3993
 Site-White_utk                 (5) | Train Loss: 1.4005 | Train Acc: 0.4550
 Site-White                     (1) | Train Loss: 1.4385 | Train Acc: 0.4792
 Site-White                     (1) | Train Loss: 1.3455 | Train Acc: 0.4840
 Site-White                     (1) | Train Loss: 1.4144 | Train Acc: 0.4656
 Site-White                     (1) | Train Loss: 1.4047 | Train Acc: 0.4520
 Site-Indian_utk                (6) | Train Loss: 1.2642 | Train Acc: 0.5797
 Site-Indian_utk                (6) | Train Loss: 1.2834 | Train Acc: 0.5083
 Site-Indian_utk                (6) | Train Loss: 1.2206 | Train Acc: 0.5378
 Site-Black_utk                 (2) | Train Loss: 1.2614 | Train Acc: 0.5727
 Site-Black_utk                 (2) | Train Loss: 1.2801 | Train Acc: 0.5172
 Site-Others_utk                (0) | Train Loss: 0.9205 | Train Acc: 0.6524
 Site-Others_utk                (4) | Train Loss: 0.9625 | Train Acc: 0.6729
 Site-Southeast_Asian           (1) | Train Loss: 1.3908 | Train Acc: 0.5049
 Site-Middle_Eastern_gan        (3) | Train Loss: 1.1990 | Train Acc: 0.6240
Average Train Accuracy: 0.5076
 Site-White_utk                 (5) | Val  Loss: 1.2911 | Val  Acc: 0.4706
 Site-White_utk                 (5) | Val  Loss: 1.4325 | Val  Acc: 0.3750
 Site-White_utk                 (5) | Val  Loss: 1.4790 | Val  Acc: 0.4150
 Site-White_utk                 (5) | Val  Loss: 1.5940 | Val  Acc: 0.3802
 Site-White_utk                 (5) | Val  Loss: 1.4423 | Val  Acc: 0.4167
 Site-White                     (1) | Val  Loss: 1.3874 | Val  Acc: 0.4479
 Site-White                     (1) | Val  Loss: 1.3834 | Val  Acc: 0.4720
 Site-White                     (1) | Val  Loss: 1.4189 | Val  Acc: 0.4695
 Site-White                     (1) | Val  Loss: 1.3543 | Val  Acc: 0.5139
 Site-Indian_utk                (6) | Val  Loss: 1.2438 | Val  Acc: 0.4565
 Site-Indian_utk                (6) | Val  Loss: 1.1981 | Val  Acc: 0.5289
 Site-Indian_utk                (6) | Val  Loss: 1.2505 | Val  Acc: 0.5253
 Site-Black_utk                 (2) | Val  Loss: 1.3105 | Val  Acc: 0.5541
 Site-Black_utk                 (2) | Val  Loss: 1.3187 | Val  Acc: 0.5104
 Site-Others_utk                (0) | Val  Loss: 0.9787 | Val  Acc: 0.6606
 Site-Others_utk                (4) | Val  Loss: 0.9409 | Val  Acc: 0.6783
 Site-Southeast_Asian           (1) | Val  Loss: 1.4536 | Val  Acc: 0.4902
 Site-Middle_Eastern_gan        (3) | Val  Loss: 1.8284 | Val  Acc: 0.4458
Average Valid Accuracy: 0.4895
 Test site-White_utk                 (5)| Epoch:41 | Test Acc: 0.3690
 Test site-White                     (1)| Epoch:41 | Test Acc: 0.4473
 Test site-Indian_utk                (6)| Epoch:41 | Test Acc: 0.5604
 Test site-Black_utk                 (2)| Epoch:41 | Test Acc: 0.4796
 Test site-Others_utk                (0)| Epoch:41 | Test Acc: 0.5861
 Test site-Southeast_Asian           (1)| Epoch:41 | Test Acc: 0.4350
 Test site-Middle_Eastern_gan        (3)| Epoch:41 | Test Acc: 0.4242
White_utk: 0.3690, White: 0.4473, Indian_utk: 0.5604, Black_utk: 0.4796, Others_utk: 0.5861, Southeast_Asian: 0.4350, Middle_Eastern_gan: 0.4242, 
Average Test Accuracy(group): 0.4717, Average Test Accuracy(individual): 0.4614,
domain CV=0.1516, cluster CV=nan, individual CV=0.1669, 
Average Test Accuracy: 0.4717
============ Train epoch 43 ============
