===2023-03-29 14:33:01===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-Clipart   | Train Loss: 2.0217 | Train Acc: 0.3968
 Site-Clipart   | Train Loss: 1.9642 | Train Acc: 0.4286
 Site-Clipart   | Train Loss: 1.8711 | Train Acc: 0.4603
 Site-Clipart   | Train Loss: 1.8818 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 2.2089 | Train Acc: 0.1587
 Site-Infograph | Train Loss: 2.1481 | Train Acc: 0.3016
 Site-Infograph | Train Loss: 2.0404 | Train Acc: 0.3810
 Site-Painting  | Train Loss: 1.9391 | Train Acc: 0.5079
 Site-Painting  | Train Loss: 1.9379 | Train Acc: 0.4762
 Site-QuickDraw | Train Loss: 2.3096 | Train Acc: 0.0476
 Site-Real      | Train Loss: 1.9152 | Train Acc: 0.4921
 Site-Sketch    | Train Loss: 1.8438 | Train Acc: 0.5873
 Site-Clipart   | Val  Loss: 1.8520 | Val  Acc: 0.5476
 Site-Clipart   | Val  Loss: 1.8890 | Val  Acc: 0.4048
 Site-Clipart   | Val  Loss: 1.9651 | Val  Acc: 0.3810
 Site-Clipart   | Val  Loss: 2.0597 | Val  Acc: 0.3571
 Site-Infograph | Val  Loss: 2.1052 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.1354 | Val  Acc: 0.2857
 Site-Infograph | Val  Loss: 2.1725 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.8241 | Val  Acc: 0.5000
 Site-Painting  | Val  Loss: 2.0239 | Val  Acc: 0.4762
 Site-QuickDraw | Val  Loss: 2.2510 | Val  Acc: 0.1429
 Site-Real      | Val  Loss: 1.9604 | Val  Acc: 0.5000
 Site-Sketch    | Val  Loss: 2.0184 | Val  Acc: 0.3810
Average Valid Accuracy: 0.3790
 Best site-Clipart    | Epoch:0 | Val Acc: 0.5476
 Best site-Clipart    | Epoch:0 | Val Acc: 0.4048
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3810
 Best site-Clipart    | Epoch:0 | Val Acc: 0.3571
 Best site-Infograph  | Epoch:0 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2857
 Best site-Infograph  | Epoch:0 | Val Acc: 0.2381
 Best site-Painting   | Epoch:0 | Val Acc: 0.5000
 Best site-Painting   | Epoch:0 | Val Acc: 0.4762
 Best site-QuickDraw  | Epoch:0 | Val Acc: 0.1429
 Best site-Real       | Epoch:0 | Val Acc: 0.5000
 Best site-Sketch     | Epoch:0 | Val Acc: 0.3810
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-Clipart   | Train Loss: 1.6134 | Train Acc: 0.6032
 Site-Clipart   | Train Loss: 1.7028 | Train Acc: 0.5873
 Site-Clipart   | Train Loss: 1.5299 | Train Acc: 0.6349
 Site-Clipart   | Train Loss: 1.4769 | Train Acc: 0.7778
 Site-Infograph | Train Loss: 2.1419 | Train Acc: 0.2222
 Site-Infograph | Train Loss: 2.0459 | Train Acc: 0.3492
 Site-Infograph | Train Loss: 1.9759 | Train Acc: 0.3492
 Site-Painting  | Train Loss: 1.5315 | Train Acc: 0.6032
 Site-Painting  | Train Loss: 1.5422 | Train Acc: 0.5714
 Site-QuickDraw | Train Loss: 2.2069 | Train Acc: 0.1587
 Site-Real      | Train Loss: 1.4420 | Train Acc: 0.8095
 Site-Sketch    | Train Loss: 1.4682 | Train Acc: 0.7302
 Site-Clipart   | Val  Loss: 1.3929 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.4407 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 1.6521 | Val  Acc: 0.5000
 Site-Clipart   | Val  Loss: 1.6336 | Val  Acc: 0.6190
 Site-Infograph | Val  Loss: 1.9977 | Val  Acc: 0.3333
 Site-Infograph | Val  Loss: 2.0050 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 2.1704 | Val  Acc: 0.2381
 Site-Painting  | Val  Loss: 1.3938 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 1.6829 | Val  Acc: 0.5238
 Site-QuickDraw | Val  Loss: 2.1662 | Val  Acc: 0.2857
 Site-Real      | Val  Loss: 1.4437 | Val  Acc: 0.8095
 Site-Sketch    | Val  Loss: 1.6972 | Val  Acc: 0.4762
Average Valid Accuracy: 0.5278
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6905
 Best site-Clipart    | Epoch:1 | Val Acc: 0.5000
 Best site-Clipart    | Epoch:1 | Val Acc: 0.6190
 Best site-Infograph  | Epoch:1 | Val Acc: 0.3333
 Best site-Infograph  | Epoch:1 | Val Acc: 0.4762
 Best site-Infograph  | Epoch:1 | Val Acc: 0.2381
 Best site-Painting   | Epoch:1 | Val Acc: 0.6905
 Best site-Painting   | Epoch:1 | Val Acc: 0.5238
 Best site-QuickDraw  | Epoch:1 | Val Acc: 0.2857
 Best site-Real       | Epoch:1 | Val Acc: 0.8095
 Best site-Sketch     | Epoch:1 | Val Acc: 0.4762
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-Clipart   | Train Loss: 1.2676 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.4101 | Train Acc: 0.6667
 Site-Clipart   | Train Loss: 1.1868 | Train Acc: 0.7302
 Site-Clipart   | Train Loss: 1.1215 | Train Acc: 0.8254
 Site-Infograph | Train Loss: 1.9029 | Train Acc: 0.3333
 Site-Infograph | Train Loss: 1.7168 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.6967 | Train Acc: 0.4921
 Site-Painting  | Train Loss: 1.1522 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 1.1496 | Train Acc: 0.8095
 Site-QuickDraw | Train Loss: 2.1222 | Train Acc: 0.3175
 Site-Real      | Train Loss: 1.0172 | Train Acc: 0.9048
 Site-Sketch    | Train Loss: 1.1461 | Train Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.1669 | Val  Acc: 0.7619
 Site-Clipart   | Val  Loss: 1.0952 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 1.3773 | Val  Acc: 0.6667
 Site-Clipart   | Val  Loss: 1.2915 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.8099 | Val  Acc: 0.4048
 Site-Infograph | Val  Loss: 1.7530 | Val  Acc: 0.5714
 Site-Infograph | Val  Loss: 2.0220 | Val  Acc: 0.2619
 Site-Painting  | Val  Loss: 1.0465 | Val  Acc: 0.8810
 Site-Painting  | Val  Loss: 1.3989 | Val  Acc: 0.6667
 Site-QuickDraw | Val  Loss: 2.0985 | Val  Acc: 0.2381
 Site-Real      | Val  Loss: 1.0941 | Val  Acc: 0.8333
 Site-Sketch    | Val  Loss: 1.4078 | Val  Acc: 0.5952
Average Valid Accuracy: 0.6171
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7619
 Best site-Clipart    | Epoch:2 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:2 | Val Acc: 0.6667
 Best site-Clipart    | Epoch:2 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:2 | Val Acc: 0.4048
 Best site-Infograph  | Epoch:2 | Val Acc: 0.5714
 Best site-Infograph  | Epoch:2 | Val Acc: 0.2619
 Best site-Painting   | Epoch:2 | Val Acc: 0.8810
 Best site-Painting   | Epoch:2 | Val Acc: 0.6667
 Best site-QuickDraw  | Epoch:2 | Val Acc: 0.2381
 Best site-Real       | Epoch:2 | Val Acc: 0.8333
 Best site-Sketch     | Epoch:2 | Val Acc: 0.5952
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-Clipart   | Train Loss: 1.0445 | Train Acc: 0.7460
 Site-Clipart   | Train Loss: 1.1166 | Train Acc: 0.7778
 Site-Clipart   | Train Loss: 0.9011 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.7949 | Train Acc: 0.8889
 Site-Infograph | Train Loss: 1.8625 | Train Acc: 0.3175
 Site-Infograph | Train Loss: 1.6270 | Train Acc: 0.4444
 Site-Infograph | Train Loss: 1.4647 | Train Acc: 0.5397
 Site-Painting  | Train Loss: 0.8886 | Train Acc: 0.8254
 Site-Painting  | Train Loss: 0.9850 | Train Acc: 0.7778
 Site-QuickDraw | Train Loss: 2.0072 | Train Acc: 0.3333
 Site-Real      | Train Loss: 0.7285 | Train Acc: 0.9365
 Site-Sketch    | Train Loss: 0.8505 | Train Acc: 0.8889
 Site-Clipart   | Val  Loss: 0.7879 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.8003 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.1822 | Val  Acc: 0.6429
 Site-Clipart   | Val  Loss: 1.1513 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.5616 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.5468 | Val  Acc: 0.5000
 Site-Infograph | Val  Loss: 1.8150 | Val  Acc: 0.4048
 Site-Painting  | Val  Loss: 0.8292 | Val  Acc: 0.8571
 Site-Painting  | Val  Loss: 1.0718 | Val  Acc: 0.8333
 Site-QuickDraw | Val  Loss: 1.9869 | Val  Acc: 0.4524
 Site-Real      | Val  Loss: 0.7724 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.1280 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6905
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.8810
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6429
 Best site-Clipart    | Epoch:3 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.5000
 Best site-Infograph  | Epoch:3 | Val Acc: 0.4048
 Best site-Painting   | Epoch:3 | Val Acc: 0.8571
 Best site-Painting   | Epoch:3 | Val Acc: 0.8333
 Best site-QuickDraw  | Epoch:3 | Val Acc: 0.4524
 Best site-Real       | Epoch:3 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:3 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-Clipart   | Train Loss: 0.8449 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.9903 | Train Acc: 0.7143
 Site-Clipart   | Train Loss: 0.7071 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.6739 | Train Acc: 0.8730
 Site-Infograph | Train Loss: 1.6547 | Train Acc: 0.4127
 Site-Infograph | Train Loss: 1.4927 | Train Acc: 0.5238
 Site-Infograph | Train Loss: 1.4136 | Train Acc: 0.5556
 Site-Painting  | Train Loss: 0.7422 | Train Acc: 0.8413
 Site-Painting  | Train Loss: 0.7300 | Train Acc: 0.8571
 Site-QuickDraw | Train Loss: 1.7276 | Train Acc: 0.4921
 Site-Real      | Train Loss: 0.4787 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.6952 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.6376 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 0.6380 | Val  Acc: 0.8810
 Site-Clipart   | Val  Loss: 1.0050 | Val  Acc: 0.6905
 Site-Clipart   | Val  Loss: 0.8641 | Val  Acc: 0.8095
 Site-Infograph | Val  Loss: 1.4743 | Val  Acc: 0.4524
 Site-Infograph | Val  Loss: 1.4804 | Val  Acc: 0.4762
 Site-Infograph | Val  Loss: 1.8088 | Val  Acc: 0.2857
 Site-Painting  | Val  Loss: 0.5721 | Val  Acc: 0.9048
 Site-Painting  | Val  Loss: 0.8665 | Val  Acc: 0.7857
 Site-QuickDraw | Val  Loss: 1.8567 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.6110 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.9333 | Val  Acc: 0.7619
Average Valid Accuracy: 0.6865
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-Clipart   | Train Loss: 0.6365 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.7643 | Train Acc: 0.8095
 Site-Clipart   | Train Loss: 0.4954 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.4626 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.3849 | Train Acc: 0.5397
 Site-Infograph | Train Loss: 1.2389 | Train Acc: 0.6349
 Site-Infograph | Train Loss: 1.1246 | Train Acc: 0.6825
 Site-Painting  | Train Loss: 0.5926 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.5891 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.7751 | Train Acc: 0.4286
 Site-Real      | Train Loss: 0.4618 | Train Acc: 0.8730
 Site-Sketch    | Train Loss: 0.6387 | Train Acc: 0.8413
 Site-Clipart   | Val  Loss: 0.4459 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3963 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.8310 | Val  Acc: 0.8333
 Site-Clipart   | Val  Loss: 0.6566 | Val  Acc: 0.8333
 Site-Infograph | Val  Loss: 1.1646 | Val  Acc: 0.7143
 Site-Infograph | Val  Loss: 1.1582 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.5525 | Val  Acc: 0.4762
 Site-Painting  | Val  Loss: 0.4510 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.6814 | Val  Acc: 0.8571
 Site-QuickDraw | Val  Loss: 1.8020 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.4915 | Val  Acc: 0.9048
 Site-Sketch    | Val  Loss: 1.0118 | Val  Acc: 0.7619
Average Valid Accuracy: 0.7837
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:5 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Clipart    | Epoch:5 | Val Acc: 0.8333
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7143
 Best site-Infograph  | Epoch:5 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:5 | Val Acc: 0.4762
 Best site-Painting   | Epoch:5 | Val Acc: 0.9286
 Best site-Painting   | Epoch:5 | Val Acc: 0.8571
 Best site-QuickDraw  | Epoch:5 | Val Acc: 0.4286
 Best site-Real       | Epoch:5 | Val Acc: 0.9048
 Best site-Sketch     | Epoch:5 | Val Acc: 0.7619
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-Clipart   | Train Loss: 0.5000 | Train Acc: 0.9206
 Site-Clipart   | Train Loss: 0.6103 | Train Acc: 0.8413
 Site-Clipart   | Train Loss: 0.3249 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.3444 | Train Acc: 0.9365
 Site-Infograph | Train Loss: 1.6279 | Train Acc: 0.3651
 Site-Infograph | Train Loss: 1.2071 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.0546 | Train Acc: 0.6667
 Site-Painting  | Train Loss: 0.4546 | Train Acc: 0.8730
 Site-Painting  | Train Loss: 0.4718 | Train Acc: 0.8889
 Site-QuickDraw | Train Loss: 1.5751 | Train Acc: 0.4762
 Site-Real      | Train Loss: 0.2976 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.4460 | Train Acc: 0.8730
 Site-Clipart   | Val  Loss: 0.3299 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.3108 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.5856 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.5406 | Val  Acc: 0.8810
 Site-Infograph | Val  Loss: 1.1729 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.1390 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.5335 | Val  Acc: 0.3810
 Site-Painting  | Val  Loss: 0.3741 | Val  Acc: 0.9286
 Site-Painting  | Val  Loss: 0.5801 | Val  Acc: 0.8810
 Site-QuickDraw | Val  Loss: 1.7846 | Val  Acc: 0.3810
 Site-Real      | Val  Loss: 0.3493 | Val  Acc: 0.9524
 Site-Sketch    | Val  Loss: 0.7588 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7758
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-Clipart   | Train Loss: 0.3442 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.5082 | Train Acc: 0.8889
 Site-Clipart   | Train Loss: 0.3328 | Train Acc: 0.9524
 Site-Clipart   | Train Loss: 0.3071 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.2863 | Train Acc: 0.5556
 Site-Infograph | Train Loss: 1.1284 | Train Acc: 0.6190
 Site-Infograph | Train Loss: 0.9678 | Train Acc: 0.6349
 Site-Painting  | Train Loss: 0.3899 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.3273 | Train Acc: 0.9206
 Site-QuickDraw | Train Loss: 1.4299 | Train Acc: 0.5397
 Site-Real      | Train Loss: 0.2174 | Train Acc: 0.9683
 Site-Sketch    | Train Loss: 0.3567 | Train Acc: 0.9206
 Site-Clipart   | Val  Loss: 0.2762 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.2775 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.6348 | Val  Acc: 0.8095
 Site-Clipart   | Val  Loss: 0.4795 | Val  Acc: 0.9048
 Site-Infograph | Val  Loss: 1.0005 | Val  Acc: 0.6429
 Site-Infograph | Val  Loss: 1.0768 | Val  Acc: 0.6667
 Site-Infograph | Val  Loss: 1.3795 | Val  Acc: 0.5238
 Site-Painting  | Val  Loss: 0.2201 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.4012 | Val  Acc: 0.9048
 Site-QuickDraw | Val  Loss: 1.6132 | Val  Acc: 0.3571
 Site-Real      | Val  Loss: 0.3388 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7072 | Val  Acc: 0.8571
Average Valid Accuracy: 0.7897
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:7 | Val Acc: 0.8095
 Best site-Clipart    | Epoch:7 | Val Acc: 0.9048
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6429
 Best site-Infograph  | Epoch:7 | Val Acc: 0.6667
 Best site-Infograph  | Epoch:7 | Val Acc: 0.5238
 Best site-Painting   | Epoch:7 | Val Acc: 0.9762
 Best site-Painting   | Epoch:7 | Val Acc: 0.9048
 Best site-QuickDraw  | Epoch:7 | Val Acc: 0.3571
 Best site-Real       | Epoch:7 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:7 | Val Acc: 0.8571
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-Clipart   | Train Loss: 0.2937 | Train Acc: 0.9683
 Site-Clipart   | Train Loss: 0.4419 | Train Acc: 0.8730
 Site-Clipart   | Train Loss: 0.1703 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.2040 | Train Acc: 0.9524
 Site-Infograph | Train Loss: 1.1958 | Train Acc: 0.5714
 Site-Infograph | Train Loss: 0.9787 | Train Acc: 0.7143
 Site-Infograph | Train Loss: 0.7701 | Train Acc: 0.7937
 Site-Painting  | Train Loss: 0.3091 | Train Acc: 0.9365
 Site-Painting  | Train Loss: 0.2945 | Train Acc: 0.9048
 Site-QuickDraw | Train Loss: 1.5004 | Train Acc: 0.5873
 Site-Real      | Train Loss: 0.2265 | Train Acc: 0.9206
 Site-Sketch    | Train Loss: 0.3581 | Train Acc: 0.9365
 Site-Clipart   | Val  Loss: 0.1563 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.1722 | Val  Acc: 1.0000
 Site-Clipart   | Val  Loss: 0.4564 | Val  Acc: 0.8571
 Site-Clipart   | Val  Loss: 0.3556 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8215 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.8535 | Val  Acc: 0.7381
 Site-Infograph | Val  Loss: 1.2596 | Val  Acc: 0.4286
 Site-Painting  | Val  Loss: 0.1931 | Val  Acc: 1.0000
 Site-Painting  | Val  Loss: 0.3234 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.7991 | Val  Acc: 0.3333
 Site-Real      | Val  Loss: 0.3342 | Val  Acc: 0.9286
 Site-Sketch    | Val  Loss: 0.7466 | Val  Acc: 0.8095
Average Valid Accuracy: 0.8115
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 1.0000
 Best site-Clipart    | Epoch:8 | Val Acc: 0.8571
 Best site-Clipart    | Epoch:8 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:8 | Val Acc: 0.7381
 Best site-Infograph  | Epoch:8 | Val Acc: 0.4286
 Best site-Painting   | Epoch:8 | Val Acc: 1.0000
 Best site-Painting   | Epoch:8 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:8 | Val Acc: 0.3333
 Best site-Real       | Epoch:8 | Val Acc: 0.9286
 Best site-Sketch     | Epoch:8 | Val Acc: 0.8095
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-Clipart   | Train Loss: 0.2107 | Train Acc: 0.9841
 Site-Clipart   | Train Loss: 0.2855 | Train Acc: 0.9365
 Site-Clipart   | Train Loss: 0.1597 | Train Acc: 1.0000
 Site-Clipart   | Train Loss: 0.1508 | Train Acc: 0.9841
 Site-Infograph | Train Loss: 0.9771 | Train Acc: 0.7302
 Site-Infograph | Train Loss: 0.8447 | Train Acc: 0.6825
 Site-Infograph | Train Loss: 0.7220 | Train Acc: 0.7778
 Site-Painting  | Train Loss: 0.2136 | Train Acc: 0.9841
 Site-Painting  | Train Loss: 0.2402 | Train Acc: 0.9683
 Site-QuickDraw | Train Loss: 1.3955 | Train Acc: 0.5714
 Site-Real      | Train Loss: 0.2026 | Train Acc: 0.9524
 Site-Sketch    | Train Loss: 0.2382 | Train Acc: 0.9683
 Site-Clipart   | Val  Loss: 0.1908 | Val  Acc: 0.9524
 Site-Clipart   | Val  Loss: 0.1765 | Val  Acc: 0.9762
 Site-Clipart   | Val  Loss: 0.3295 | Val  Acc: 0.9286
 Site-Clipart   | Val  Loss: 0.2962 | Val  Acc: 0.9286
 Site-Infograph | Val  Loss: 0.8589 | Val  Acc: 0.6905
 Site-Infograph | Val  Loss: 0.7294 | Val  Acc: 0.7619
 Site-Infograph | Val  Loss: 0.9797 | Val  Acc: 0.6905
 Site-Painting  | Val  Loss: 0.1466 | Val  Acc: 0.9762
 Site-Painting  | Val  Loss: 0.3414 | Val  Acc: 0.9524
 Site-QuickDraw | Val  Loss: 1.5316 | Val  Acc: 0.4286
 Site-Real      | Val  Loss: 0.3833 | Val  Acc: 0.8810
 Site-Sketch    | Val  Loss: 0.7794 | Val  Acc: 0.8333
Average Valid Accuracy: 0.8333
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9524
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9762
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Clipart    | Epoch:9 | Val Acc: 0.9286
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Infograph  | Epoch:9 | Val Acc: 0.7619
 Best site-Infograph  | Epoch:9 | Val Acc: 0.6905
 Best site-Painting   | Epoch:9 | Val Acc: 0.9762
 Best site-Painting   | Epoch:9 | Val Acc: 0.9524
 Best site-QuickDraw  | Epoch:9 | Val Acc: 0.4286
 Best site-Real       | Epoch:9 | Val Acc: 0.8810
 Best site-Sketch     | Epoch:9 | Val Acc: 0.8333
 Saving the local and server checkpoint to ../checkpoint/fed_domainnet_uneven-1-align/FedPrompt...
===2023-03-29 15:06:19===
===2023-03-29 15:06:21===
===Setting===
    dataset: domainnet
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 6
Loading snapshots...
 Test site-Clipart   | Epoch:9 | Test Acc: 0.8384
 Test site-Infograph | Epoch:9 | Test Acc: 0.5084
 Test site-Painting  | Epoch:9 | Test Acc: 0.8481
 Test site-QuickDraw | Epoch:9 | Test Acc: 0.4120
 Test site-Real      | Epoch:9 | Test Acc: 0.9269
 Test site-Sketch    | Epoch:9 | Test Acc: 0.8014
Average Test Accuracy: 0.7225
