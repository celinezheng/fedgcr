===2023-03-26 06:18:27===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8304 | Train Acc: 0.4955
 Site-MNIST     | Train Loss: 1.8312 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 2.1872 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2243 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.0966 | Train Acc: 0.2793
 Site-SynthDigits| Train Loss: 2.1282 | Train Acc: 0.2523
 Site-MNIST-M   | Train Loss: 2.1757 | Train Acc: 0.2072
 Site-MNIST-M   | Train Loss: 2.1708 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 1.8284 | Val  Acc: 0.5270
 Site-MNIST     | Val  Loss: 1.7707 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.2647 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.1887 | Val  Acc: 0.2027
 Site-SynthDigits| Val  Loss: 2.1355 | Val  Acc: 0.2297
 Site-SynthDigits| Val  Loss: 2.0927 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.1702 | Val  Acc: 0.2432
 Site-MNIST-M   | Val  Loss: 2.1505 | Val  Acc: 0.1892
Average Valid Accuracy: 0.3057
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5270
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2027
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2297
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2432
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1892
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4815 | Train Acc: 0.6216
 Site-MNIST     | Train Loss: 1.5102 | Train Acc: 0.6126
 Site-SVHN      | Train Loss: 2.0931 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1306 | Train Acc: 0.2523
 Site-SynthDigits| Train Loss: 1.9197 | Train Acc: 0.3964
 Site-SynthDigits| Train Loss: 1.9686 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.0294 | Train Acc: 0.2432
 Site-MNIST-M   | Train Loss: 2.0206 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 1.5125 | Val  Acc: 0.6216
 Site-MNIST     | Val  Loss: 1.4235 | Val  Acc: 0.6757
 Site-SVHN      | Val  Loss: 2.1891 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.0891 | Val  Acc: 0.2568
 Site-SynthDigits| Val  Loss: 1.9800 | Val  Acc: 0.3108
 Site-SynthDigits| Val  Loss: 1.9225 | Val  Acc: 0.4189
 Site-MNIST-M   | Val  Loss: 2.0093 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 1.9923 | Val  Acc: 0.2297
Average Valid Accuracy: 0.3801
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6216
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2568
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3108
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2297
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.2171 | Train Acc: 0.7658
 Site-MNIST     | Train Loss: 1.2695 | Train Acc: 0.7117
 Site-SVHN      | Train Loss: 2.0260 | Train Acc: 0.2973
 Site-SVHN      | Train Loss: 2.0700 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 1.7795 | Train Acc: 0.4054
 Site-SynthDigits| Train Loss: 1.8419 | Train Acc: 0.4234
 Site-MNIST-M   | Train Loss: 1.9153 | Train Acc: 0.3333
 Site-MNIST-M   | Train Loss: 1.8982 | Train Acc: 0.3514
 Site-MNIST     | Val  Loss: 1.2733 | Val  Acc: 0.7027
 Site-MNIST     | Val  Loss: 1.1735 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 2.1299 | Val  Acc: 0.2297
 Site-SVHN      | Val  Loss: 2.0257 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 1.8543 | Val  Acc: 0.3919
 Site-SynthDigits| Val  Loss: 1.7849 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.8805 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 1.8647 | Val  Acc: 0.3108
Average Valid Accuracy: 0.4510
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7027
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2297
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.3919
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3108
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 1.0230 | Train Acc: 0.8108
 Site-MNIST     | Train Loss: 1.0814 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 1.9683 | Train Acc: 0.3604
 Site-SVHN      | Train Loss: 2.0117 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 1.6649 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.7338 | Train Acc: 0.4324
 Site-MNIST-M   | Train Loss: 1.8133 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.7887 | Train Acc: 0.4054
 Site-MNIST     | Val  Loss: 1.0854 | Val  Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.9855 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 2.0746 | Val  Acc: 0.2703
 Site-SVHN      | Val  Loss: 1.9683 | Val  Acc: 0.3649
 Site-SynthDigits| Val  Loss: 1.7424 | Val  Acc: 0.4054
 Site-SynthDigits| Val  Loss: 1.6807 | Val  Acc: 0.5000
 Site-MNIST-M   | Val  Loss: 1.7713 | Val  Acc: 0.4459
 Site-MNIST-M   | Val  Loss: 1.7501 | Val  Acc: 0.4324
Average Valid Accuracy: 0.5068
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8108
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3649
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4054
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5000
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4459
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.8701 | Train Acc: 0.8468
 Site-MNIST     | Train Loss: 0.9390 | Train Acc: 0.8378
 Site-SVHN      | Train Loss: 1.9157 | Train Acc: 0.3694
 Site-SVHN      | Train Loss: 1.9631 | Train Acc: 0.3784
 Site-SynthDigits| Train Loss: 1.5651 | Train Acc: 0.4955
 Site-SynthDigits| Train Loss: 1.6392 | Train Acc: 0.4685
 Site-MNIST-M   | Train Loss: 1.7181 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.6937 | Train Acc: 0.4595
 Site-MNIST     | Val  Loss: 0.9399 | Val  Acc: 0.8649
 Site-MNIST     | Val  Loss: 0.8498 | Val  Acc: 0.8514
 Site-SVHN      | Val  Loss: 2.0332 | Val  Acc: 0.2973
 Site-SVHN      | Val  Loss: 1.9182 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.6531 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.5825 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.6759 | Val  Acc: 0.4730
 Site-MNIST-M   | Val  Loss: 1.6489 | Val  Acc: 0.5541
Average Valid Accuracy: 0.5541
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8649
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8514
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2973
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4730
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5541
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.7446 | Train Acc: 0.8919
 Site-MNIST     | Train Loss: 0.8131 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.8733 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.9156 | Train Acc: 0.4144
 Site-SynthDigits| Train Loss: 1.4838 | Train Acc: 0.5135
 Site-SynthDigits| Train Loss: 1.5461 | Train Acc: 0.4955
 Site-MNIST-M   | Train Loss: 1.6322 | Train Acc: 0.5045
 Site-MNIST-M   | Train Loss: 1.6140 | Train Acc: 0.4865
 Site-MNIST     | Val  Loss: 0.8077 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.7375 | Val  Acc: 0.8919
 Site-SVHN      | Val  Loss: 1.9935 | Val  Acc: 0.3378
 Site-SVHN      | Val  Loss: 1.8700 | Val  Acc: 0.4459
 Site-SynthDigits| Val  Loss: 1.5611 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.4925 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.5929 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.5630 | Val  Acc: 0.5811
Average Valid Accuracy: 0.5845
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8919
 Best site-SVHN       | Epoch:5 | Val Acc: 0.3378
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4459
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5811
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.6512 | Train Acc: 0.9099
 Site-MNIST     | Train Loss: 0.7165 | Train Acc: 0.8829
 Site-SVHN      | Train Loss: 1.8342 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.8801 | Train Acc: 0.4324
 Site-SynthDigits| Train Loss: 1.4168 | Train Acc: 0.5586
 Site-SynthDigits| Train Loss: 1.4706 | Train Acc: 0.5225
 Site-MNIST-M   | Train Loss: 1.5562 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.5373 | Train Acc: 0.5135
 Site-MNIST     | Val  Loss: 0.7089 | Val  Acc: 0.9054
 Site-MNIST     | Val  Loss: 0.6566 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.9615 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 1.8303 | Val  Acc: 0.4730
 Site-SynthDigits| Val  Loss: 1.4845 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 1.4231 | Val  Acc: 0.6081
 Site-MNIST-M   | Val  Loss: 1.5162 | Val  Acc: 0.5135
 Site-MNIST-M   | Val  Loss: 1.4811 | Val  Acc: 0.6081
Average Valid Accuracy: 0.6064
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:6 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:6 | Val Acc: 0.4730
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.6081
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.5135
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.5690 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.6340 | Train Acc: 0.8919
 Site-SVHN      | Train Loss: 1.7989 | Train Acc: 0.3964
 Site-SVHN      | Train Loss: 1.8500 | Train Acc: 0.4505
 Site-SynthDigits| Train Loss: 1.3577 | Train Acc: 0.5946
 Site-SynthDigits| Train Loss: 1.4031 | Train Acc: 0.5946
 Site-MNIST-M   | Train Loss: 1.4883 | Train Acc: 0.5225
 Site-MNIST-M   | Train Loss: 1.4704 | Train Acc: 0.5315
 Site-MNIST     | Val  Loss: 0.6189 | Val  Acc: 0.9189
 Site-MNIST     | Val  Loss: 0.5838 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.9312 | Val  Acc: 0.3649
 Site-SVHN      | Val  Loss: 1.8035 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 1.4157 | Val  Acc: 0.5676
 Site-SynthDigits| Val  Loss: 1.3594 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.4491 | Val  Acc: 0.5405
 Site-MNIST-M   | Val  Loss: 1.4117 | Val  Acc: 0.6081
Average Valid Accuracy: 0.6284
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9189
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:7 | Val Acc: 0.3649
 Best site-SVHN       | Epoch:7 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.5676
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.5405
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.6081
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.5126 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5731 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.7720 | Train Acc: 0.3874
 Site-SVHN      | Train Loss: 1.8223 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.3017 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 1.3273 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.4221 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.3994 | Train Acc: 0.5766
 Site-MNIST     | Val  Loss: 0.5525 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.5310 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.9072 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7808 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.3446 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.2956 | Val  Acc: 0.6351
 Site-MNIST-M   | Val  Loss: 1.3795 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.3420 | Val  Acc: 0.6351
Average Valid Accuracy: 0.6537
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:8 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:8 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.6351
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.4471 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.5071 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 1.7470 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.7979 | Train Acc: 0.4865
 Site-SynthDigits| Train Loss: 1.2585 | Train Acc: 0.6396
 Site-SynthDigits| Train Loss: 1.2874 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.3633 | Train Acc: 0.5676
 Site-MNIST-M   | Train Loss: 1.3503 | Train Acc: 0.5946
 Site-MNIST     | Val  Loss: 0.4881 | Val  Acc: 0.9595
 Site-MNIST     | Val  Loss: 0.4705 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.8848 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.7599 | Val  Acc: 0.4865
 Site-SynthDigits| Val  Loss: 1.3018 | Val  Acc: 0.5946
 Site-SynthDigits| Val  Loss: 1.2532 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.3287 | Val  Acc: 0.5946
 Site-MNIST-M   | Val  Loss: 1.2879 | Val  Acc: 0.6622
Average Valid Accuracy: 0.6605
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9595
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:9 | Val Acc: 0.4865
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.5946
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.5946
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.6622
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/DoPrompt_USPS...
===2023-03-26 06:51:31===
===2023-03-26 06:51:32===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8064
 Test site-SVHN      | Epoch:9 | Test Acc: 0.2730
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.5304
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3657
Average Test Accuracy: 0.4939
===2023-03-26 12:04:14===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of USPS: 0.7903
Average Test Accuracy: 0.7903
