===2023-03-26 12:40:35===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 2.2441 | Train Acc: 0.3153
 Site-MNIST     | Train Loss: 2.2536 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2781 | Train Acc: 0.1622
 Site-SVHN      | Train Loss: 2.2857 | Train Acc: 0.1351
 Site-SynthDigits| Train Loss: 2.2948 | Train Acc: 0.1441
 Site-SynthDigits| Train Loss: 2.2865 | Train Acc: 0.0991
 Site-MNIST-M   | Train Loss: 2.2933 | Train Acc: 0.1622
 Site-MNIST-M   | Train Loss: 2.2936 | Train Acc: 0.1351
 Site-MNIST     | Val  Loss: 2.2601 | Val  Acc: 0.1757
 Site-MNIST     | Val  Loss: 2.2352 | Val  Acc: 0.3514
 Site-SVHN      | Val  Loss: 2.2867 | Val  Acc: 0.0946
 Site-SVHN      | Val  Loss: 2.2834 | Val  Acc: 0.2162
 Site-SynthDigits| Val  Loss: 2.2954 | Val  Acc: 0.0946
 Site-SynthDigits| Val  Loss: 2.2907 | Val  Acc: 0.0946
 Site-MNIST-M   | Val  Loss: 2.2851 | Val  Acc: 0.1351
 Site-MNIST-M   | Val  Loss: 2.3090 | Val  Acc: 0.1486
Average Valid Accuracy: 0.1639
 Best site-MNIST      | Epoch:0 | Val Acc: 0.1757
 Best site-MNIST      | Epoch:0 | Val Acc: 0.3514
 Best site-SVHN       | Epoch:0 | Val Acc: 0.0946
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2162
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0946
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.0946
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1351
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1486
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 2.1974 | Train Acc: 0.4234
 Site-MNIST     | Train Loss: 2.2065 | Train Acc: 0.3423
 Site-SVHN      | Train Loss: 2.2616 | Train Acc: 0.1712
 Site-SVHN      | Train Loss: 2.2692 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2838 | Train Acc: 0.1982
 Site-SynthDigits| Train Loss: 2.2700 | Train Acc: 0.1712
 Site-MNIST-M   | Train Loss: 2.2777 | Train Acc: 0.1802
 Site-MNIST-M   | Train Loss: 2.2763 | Train Acc: 0.1622
 Site-MNIST     | Val  Loss: 2.2135 | Val  Acc: 0.2838
 Site-MNIST     | Val  Loss: 2.1823 | Val  Acc: 0.4459
 Site-SVHN      | Val  Loss: 2.2731 | Val  Acc: 0.1351
 Site-SVHN      | Val  Loss: 2.2662 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.2789 | Val  Acc: 0.1351
 Site-SynthDigits| Val  Loss: 2.2800 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2686 | Val  Acc: 0.1486
 Site-MNIST-M   | Val  Loss: 2.2889 | Val  Acc: 0.2027
Average Valid Accuracy: 0.2230
 Best site-MNIST      | Epoch:1 | Val Acc: 0.2838
 Best site-MNIST      | Epoch:1 | Val Acc: 0.4459
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1351
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1351
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.1486
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 2.1527 | Train Acc: 0.5495
 Site-MNIST     | Train Loss: 2.1612 | Train Acc: 0.4775
 Site-SVHN      | Train Loss: 2.2470 | Train Acc: 0.2072
 Site-SVHN      | Train Loss: 2.2539 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2724 | Train Acc: 0.1982
 Site-SynthDigits| Train Loss: 2.2548 | Train Acc: 0.1802
 Site-MNIST-M   | Train Loss: 2.2632 | Train Acc: 0.1982
 Site-MNIST-M   | Train Loss: 2.2609 | Train Acc: 0.2162
 Site-MNIST     | Val  Loss: 2.1696 | Val  Acc: 0.4324
 Site-MNIST     | Val  Loss: 2.1320 | Val  Acc: 0.5811
 Site-SVHN      | Val  Loss: 2.2604 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2506 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 2.2631 | Val  Acc: 0.1351
 Site-SynthDigits| Val  Loss: 2.2687 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2540 | Val  Acc: 0.1892
 Site-MNIST-M   | Val  Loss: 2.2701 | Val  Acc: 0.2568
Average Valid Accuracy: 0.2720
 Best site-MNIST      | Epoch:2 | Val Acc: 0.4324
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5811
 Best site-SVHN       | Epoch:2 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1351
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.1892
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.2568
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 2.1093 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 2.1189 | Train Acc: 0.5225
 Site-SVHN      | Train Loss: 2.2337 | Train Acc: 0.2162
 Site-SVHN      | Train Loss: 2.2407 | Train Acc: 0.1892
 Site-SynthDigits| Train Loss: 2.2602 | Train Acc: 0.2252
 Site-SynthDigits| Train Loss: 2.2386 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.2482 | Train Acc: 0.2342
 Site-MNIST-M   | Train Loss: 2.2454 | Train Acc: 0.2252
 Site-MNIST     | Val  Loss: 2.1278 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 2.0840 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2494 | Val  Acc: 0.1216
 Site-SVHN      | Val  Loss: 2.2361 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 2.2471 | Val  Acc: 0.1757
 Site-SynthDigits| Val  Loss: 2.2560 | Val  Acc: 0.2162
 Site-MNIST-M   | Val  Loss: 2.2392 | Val  Acc: 0.2027
 Site-MNIST-M   | Val  Loss: 2.2516 | Val  Acc: 0.2703
Average Valid Accuracy: 0.2973
 Best site-MNIST      | Epoch:3 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:3 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:3 | Val Acc: 0.1216
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.1757
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.2162
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2027
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.2703
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 2.0662 | Train Acc: 0.5946
 Site-MNIST     | Train Loss: 2.0777 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 2.2224 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2275 | Train Acc: 0.2072
 Site-SynthDigits| Train Loss: 2.2465 | Train Acc: 0.2432
 Site-SynthDigits| Train Loss: 2.2215 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2341 | Train Acc: 0.2613
 Site-MNIST-M   | Train Loss: 2.2304 | Train Acc: 0.2883
 Site-MNIST     | Val  Loss: 2.0871 | Val  Acc: 0.4865
 Site-MNIST     | Val  Loss: 2.0370 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2386 | Val  Acc: 0.1622
 Site-SVHN      | Val  Loss: 2.2233 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 2.2312 | Val  Acc: 0.2162
 Site-SynthDigits| Val  Loss: 2.2423 | Val  Acc: 0.2297
 Site-MNIST-M   | Val  Loss: 2.2244 | Val  Acc: 0.2973
 Site-MNIST-M   | Val  Loss: 2.2343 | Val  Acc: 0.2973
Average Valid Accuracy: 0.3243
 Best site-MNIST      | Epoch:4 | Val Acc: 0.4865
 Best site-MNIST      | Epoch:4 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:4 | Val Acc: 0.1622
 Best site-SVHN       | Epoch:4 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2162
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.2297
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2973
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.2973
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 2.0249 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 2.0372 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 2.2107 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2168 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.2316 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.2056 | Train Acc: 0.2703
 Site-MNIST-M   | Train Loss: 2.2226 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.2165 | Train Acc: 0.3153
 Site-MNIST     | Val  Loss: 2.0480 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.9915 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 2.2287 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2127 | Val  Acc: 0.2703
 Site-SynthDigits| Val  Loss: 2.2156 | Val  Acc: 0.2297
 Site-SynthDigits| Val  Loss: 2.2271 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.2107 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.2174 | Val  Acc: 0.3514
Average Valid Accuracy: 0.3480
 Best site-MNIST      | Epoch:5 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:5 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:5 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:5 | Val Acc: 0.2703
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2297
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 1.9837 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.9980 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 2.2024 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2066 | Train Acc: 0.2252
 Site-SynthDigits| Train Loss: 2.2145 | Train Acc: 0.2883
 Site-SynthDigits| Train Loss: 2.1888 | Train Acc: 0.2883
 Site-MNIST-M   | Train Loss: 2.2103 | Train Acc: 0.3063
 Site-MNIST-M   | Train Loss: 2.2034 | Train Acc: 0.2973
 Site-MNIST     | Val  Loss: 2.0097 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.9468 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2194 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.2040 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 2.2001 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.2105 | Val  Acc: 0.2838
 Site-MNIST-M   | Val  Loss: 2.1979 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.2016 | Val  Acc: 0.3514
Average Valid Accuracy: 0.3514
 Best site-MNIST      | Epoch:6 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:6 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:6 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:6 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.2838
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.3514
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 1.9457 | Train Acc: 0.6036
 Site-MNIST     | Train Loss: 1.9621 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 2.1934 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1972 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.1994 | Train Acc: 0.3243
 Site-SynthDigits| Train Loss: 2.1724 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 2.1987 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1901 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.9748 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.9050 | Val  Acc: 0.6351
 Site-SVHN      | Val  Loss: 2.2105 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1952 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 2.1843 | Val  Acc: 0.2432
 Site-SynthDigits| Val  Loss: 2.1939 | Val  Acc: 0.3108
 Site-MNIST-M   | Val  Loss: 2.1852 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.1850 | Val  Acc: 0.3649
Average Valid Accuracy: 0.3632
 Best site-MNIST      | Epoch:7 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:7 | Val Acc: 0.6351
 Best site-SVHN       | Epoch:7 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:7 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.2432
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.3108
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.3649
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 1.9074 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.9283 | Train Acc: 0.5315
 Site-SVHN      | Train Loss: 2.1840 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1883 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.1830 | Train Acc: 0.3333
 Site-SynthDigits| Train Loss: 2.1551 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.1877 | Train Acc: 0.3694
 Site-MNIST-M   | Train Loss: 2.1768 | Train Acc: 0.3423
 Site-MNIST     | Val  Loss: 1.9425 | Val  Acc: 0.5135
 Site-MNIST     | Val  Loss: 1.8651 | Val  Acc: 0.6216
 Site-SVHN      | Val  Loss: 2.2020 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1863 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 2.1678 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 2.1759 | Val  Acc: 0.3378
 Site-MNIST-M   | Val  Loss: 2.1724 | Val  Acc: 0.3649
 Site-MNIST-M   | Val  Loss: 2.1710 | Val  Acc: 0.3784
Average Valid Accuracy: 0.3733
 Best site-MNIST      | Epoch:8 | Val Acc: 0.5135
 Best site-MNIST      | Epoch:8 | Val Acc: 0.6216
 Best site-SVHN       | Epoch:8 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:8 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.3378
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3649
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.3784
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 1.8727 | Train Acc: 0.6126
 Site-MNIST     | Train Loss: 1.8949 | Train Acc: 0.5676
 Site-SVHN      | Train Loss: 2.1770 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.1785 | Train Acc: 0.2342
 Site-SynthDigits| Train Loss: 2.1661 | Train Acc: 0.3423
 Site-SynthDigits| Train Loss: 2.1378 | Train Acc: 0.3423
 Site-MNIST-M   | Train Loss: 2.1766 | Train Acc: 0.3514
 Site-MNIST-M   | Train Loss: 2.1658 | Train Acc: 0.3694
 Site-MNIST     | Val  Loss: 1.9106 | Val  Acc: 0.5405
 Site-MNIST     | Val  Loss: 1.8259 | Val  Acc: 0.6622
 Site-SVHN      | Val  Loss: 2.1933 | Val  Acc: 0.1892
 Site-SVHN      | Val  Loss: 2.1793 | Val  Acc: 0.2838
 Site-SynthDigits| Val  Loss: 2.1521 | Val  Acc: 0.2973
 Site-SynthDigits| Val  Loss: 2.1575 | Val  Acc: 0.3514
 Site-MNIST-M   | Val  Loss: 2.1603 | Val  Acc: 0.3919
 Site-MNIST-M   | Val  Loss: 2.1572 | Val  Acc: 0.3919
Average Valid Accuracy: 0.3885
 Best site-MNIST      | Epoch:9 | Val Acc: 0.5405
 Best site-MNIST      | Epoch:9 | Val Acc: 0.6622
 Best site-SVHN       | Epoch:9 | Val Acc: 0.1892
 Best site-SVHN       | Epoch:9 | Val Acc: 0.2838
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.2973
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.3514
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3919
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.3919
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/PromptFL_USPS...
===2023-03-26 12:54:54===
===2023-03-26 12:54:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of USPS: 0.5699
Average Test Accuracy: 0.5699
