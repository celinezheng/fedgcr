===2023-03-26 01:29:16===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
===2023-03-26 01:32:18===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
===2023-03-26 03:14:58===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
domain number = 2
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.8175 | Train Acc: 0.4865
 Site-MNIST     | Train Loss: 1.8359 | Train Acc: 0.5045
 Site-SVHN      | Train Loss: 2.1901 | Train Acc: 0.2342
 Site-SVHN      | Train Loss: 2.2127 | Train Acc: 0.2162
 Site-SynthDigits| Train Loss: 2.0845 | Train Acc: 0.2703
 Site-SynthDigits| Train Loss: 2.1283 | Train Acc: 0.2523
 Site-MNIST-M   | Train Loss: 2.1717 | Train Acc: 0.2252
 Site-MNIST-M   | Train Loss: 2.1677 | Train Acc: 0.2252
 Site-MNIST     | Val  Loss: 1.8291 | Val  Acc: 0.5000
 Site-MNIST     | Val  Loss: 1.7774 | Val  Acc: 0.5676
 Site-SVHN      | Val  Loss: 2.2570 | Val  Acc: 0.1757
 Site-SVHN      | Val  Loss: 2.1778 | Val  Acc: 0.1892
 Site-SynthDigits| Val  Loss: 2.1383 | Val  Acc: 0.2162
 Site-SynthDigits| Val  Loss: 2.0739 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 2.1604 | Val  Acc: 0.2568
 Site-MNIST-M   | Val  Loss: 2.1612 | Val  Acc: 0.2027
Average Valid Accuracy: 0.3041
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5000
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5676
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1757
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1892
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2162
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2568
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2027
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.3007 | Train Acc: 0.6847
 Site-MNIST     | Train Loss: 1.3277 | Train Acc: 0.6757
 Site-SVHN      | Train Loss: 2.0671 | Train Acc: 0.2883
 Site-SVHN      | Train Loss: 2.0832 | Train Acc: 0.3063
 Site-SynthDigits| Train Loss: 1.8204 | Train Acc: 0.3604
 Site-SynthDigits| Train Loss: 1.8765 | Train Acc: 0.4414
 Site-MNIST-M   | Train Loss: 2.0009 | Train Acc: 0.2973
 Site-MNIST-M   | Train Loss: 1.9682 | Train Acc: 0.3333
 Site-MNIST     | Val  Loss: 1.3534 | Val  Acc: 0.6757
 Site-MNIST     | Val  Loss: 1.1975 | Val  Acc: 0.7568
 Site-SVHN      | Val  Loss: 2.1406 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 2.0367 | Val  Acc: 0.3243
 Site-SynthDigits| Val  Loss: 1.8918 | Val  Acc: 0.4189
 Site-SynthDigits| Val  Loss: 1.8221 | Val  Acc: 0.4595
 Site-MNIST-M   | Val  Loss: 1.9548 | Val  Acc: 0.3243
 Site-MNIST-M   | Val  Loss: 1.9791 | Val  Acc: 0.3243
Average Valid Accuracy: 0.4409
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6757
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7568
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:1 | Val Acc: 0.3243
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4189
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4595
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3243
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3243
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.9096 | Train Acc: 0.7838
 Site-MNIST     | Train Loss: 1.0058 | Train Acc: 0.7568
 Site-SVHN      | Train Loss: 1.9323 | Train Acc: 0.2703
 Site-SVHN      | Train Loss: 1.9875 | Train Acc: 0.3514
 Site-SynthDigits| Train Loss: 1.5382 | Train Acc: 0.5225
 Site-SynthDigits| Train Loss: 1.5685 | Train Acc: 0.5135
 Site-MNIST-M   | Train Loss: 1.7301 | Train Acc: 0.4144
 Site-MNIST-M   | Train Loss: 1.6410 | Train Acc: 0.5045
 Site-MNIST     | Val  Loss: 1.0292 | Val  Acc: 0.7703
 Site-MNIST     | Val  Loss: 0.8586 | Val  Acc: 0.7973
 Site-SVHN      | Val  Loss: 2.0970 | Val  Acc: 0.2432
 Site-SVHN      | Val  Loss: 1.8829 | Val  Acc: 0.3784
 Site-SynthDigits| Val  Loss: 1.6049 | Val  Acc: 0.5000
 Site-SynthDigits| Val  Loss: 1.5443 | Val  Acc: 0.5676
 Site-MNIST-M   | Val  Loss: 1.6448 | Val  Acc: 0.4865
 Site-MNIST-M   | Val  Loss: 1.6116 | Val  Acc: 0.5000
Average Valid Accuracy: 0.5304
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7703
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7973
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2432
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3784
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5000
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.5676
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4865
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.5000
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5323 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.6709 | Train Acc: 0.8198
 Site-SVHN      | Train Loss: 1.6788 | Train Acc: 0.3784
 Site-SVHN      | Train Loss: 1.7380 | Train Acc: 0.4595
 Site-SynthDigits| Train Loss: 1.1751 | Train Acc: 0.6667
 Site-SynthDigits| Train Loss: 1.1564 | Train Acc: 0.7297
 Site-MNIST-M   | Train Loss: 1.4333 | Train Acc: 0.5225
 Site-MNIST-M   | Train Loss: 1.3745 | Train Acc: 0.5856
 Site-MNIST     | Val  Loss: 0.6767 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.5535 | Val  Acc: 0.8649
 Site-SVHN      | Val  Loss: 1.8915 | Val  Acc: 0.4054
 Site-SVHN      | Val  Loss: 1.5780 | Val  Acc: 0.4595
 Site-SynthDigits| Val  Loss: 1.2186 | Val  Acc: 0.7027
 Site-SynthDigits| Val  Loss: 1.1347 | Val  Acc: 0.7297
 Site-MNIST-M   | Val  Loss: 1.3957 | Val  Acc: 0.5541
 Site-MNIST-M   | Val  Loss: 1.3268 | Val  Acc: 0.6351
Average Valid Accuracy: 0.6486
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8649
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4054
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4595
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7027
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.7297
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.5541
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.6351
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.4182 | Train Acc: 0.9189
 Site-MNIST     | Train Loss: 0.5440 | Train Acc: 0.8468
 Site-SVHN      | Train Loss: 1.4286 | Train Acc: 0.5586
 Site-SVHN      | Train Loss: 1.4444 | Train Acc: 0.5676
 Site-SynthDigits| Train Loss: 0.8957 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.8966 | Train Acc: 0.8108
 Site-MNIST-M   | Train Loss: 1.1379 | Train Acc: 0.6126
 Site-MNIST-M   | Train Loss: 1.1254 | Train Acc: 0.6847
 Site-MNIST     | Val  Loss: 0.5452 | Val  Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.4473 | Val  Acc: 0.9054
 Site-SVHN      | Val  Loss: 1.6154 | Val  Acc: 0.4865
 Site-SVHN      | Val  Loss: 1.3080 | Val  Acc: 0.6486
 Site-SynthDigits| Val  Loss: 0.9617 | Val  Acc: 0.7838
 Site-SynthDigits| Val  Loss: 0.8455 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 1.1159 | Val  Acc: 0.6622
 Site-MNIST-M   | Val  Loss: 1.0824 | Val  Acc: 0.7432
Average Valid Accuracy: 0.7365
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8378
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9054
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4865
 Best site-SVHN       | Epoch:4 | Val Acc: 0.6486
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.7838
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6622
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.7432
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2810 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.3478 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 1.2671 | Train Acc: 0.5495
 Site-SVHN      | Train Loss: 1.3688 | Train Acc: 0.6036
 Site-SynthDigits| Train Loss: 0.7355 | Train Acc: 0.8108
 Site-SynthDigits| Train Loss: 0.7337 | Train Acc: 0.7928
 Site-MNIST-M   | Train Loss: 0.8509 | Train Acc: 0.7568
 Site-MNIST-M   | Train Loss: 0.8379 | Train Acc: 0.8108
 Site-MNIST     | Val  Loss: 0.3361 | Val  Acc: 0.9324
 Site-MNIST     | Val  Loss: 0.3097 | Val  Acc: 0.9324
 Site-SVHN      | Val  Loss: 1.5047 | Val  Acc: 0.5135
 Site-SVHN      | Val  Loss: 1.2587 | Val  Acc: 0.6351
 Site-SynthDigits| Val  Loss: 0.8101 | Val  Acc: 0.7703
 Site-SynthDigits| Val  Loss: 0.6897 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.8323 | Val  Acc: 0.7973
 Site-MNIST-M   | Val  Loss: 0.7904 | Val  Acc: 0.8378
Average Valid Accuracy: 0.7804
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9324
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5135
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6351
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7703
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.7973
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.8378
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.2102 | Train Acc: 0.9369
 Site-MNIST     | Train Loss: 0.2874 | Train Acc: 0.9279
 Site-SVHN      | Train Loss: 0.9672 | Train Acc: 0.7027
 Site-SVHN      | Train Loss: 1.0424 | Train Acc: 0.6937
 Site-SynthDigits| Train Loss: 0.5574 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.5422 | Train Acc: 0.8649
 Site-MNIST-M   | Train Loss: 0.5854 | Train Acc: 0.8829
 Site-MNIST-M   | Train Loss: 0.6787 | Train Acc: 0.8378
 Site-MNIST     | Val  Loss: 0.2561 | Val  Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.2751 | Val  Acc: 0.9189
 Site-SVHN      | Val  Loss: 1.1750 | Val  Acc: 0.6486
 Site-SVHN      | Val  Loss: 0.9264 | Val  Acc: 0.7297
 Site-SynthDigits| Val  Loss: 0.6101 | Val  Acc: 0.8378
 Site-SynthDigits| Val  Loss: 0.4868 | Val  Acc: 0.8919
 Site-MNIST-M   | Val  Loss: 0.6707 | Val  Acc: 0.8243
 Site-MNIST-M   | Val  Loss: 0.5959 | Val  Acc: 0.9054
Average Valid Accuracy: 0.8378
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9459
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9189
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6486
 Best site-SVHN       | Epoch:6 | Val Acc: 0.7297
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8378
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8919
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.8243
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.9054
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1205 | Train Acc: 0.9910
 Site-MNIST     | Train Loss: 0.1482 | Train Acc: 0.9820
 Site-SVHN      | Train Loss: 0.7679 | Train Acc: 0.7928
 Site-SVHN      | Train Loss: 0.8046 | Train Acc: 0.7838
 Site-SynthDigits| Train Loss: 0.4376 | Train Acc: 0.8649
 Site-SynthDigits| Train Loss: 0.4053 | Train Acc: 0.9459
 Site-MNIST-M   | Train Loss: 0.3270 | Train Acc: 0.9730
 Site-MNIST-M   | Train Loss: 0.3616 | Train Acc: 0.9369
 Site-MNIST     | Val  Loss: 0.1452 | Val  Acc: 0.9865
 Site-MNIST     | Val  Loss: 0.1276 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.8823 | Val  Acc: 0.7297
 Site-SVHN      | Val  Loss: 0.7390 | Val  Acc: 0.8243
 Site-SynthDigits| Val  Loss: 0.4805 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.3604 | Val  Acc: 0.9324
 Site-MNIST-M   | Val  Loss: 0.3529 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.3225 | Val  Acc: 0.9324
Average Valid Accuracy: 0.9088
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7297
 Best site-SVHN       | Epoch:7 | Val Acc: 0.8243
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9324
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.9324
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0896 | Train Acc: 0.9730
 Site-MNIST     | Train Loss: 0.0960 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5079 | Train Acc: 0.8739
 Site-SVHN      | Train Loss: 0.6392 | Train Acc: 0.8559
 Site-SynthDigits| Train Loss: 0.2949 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.2836 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.2333 | Train Acc: 0.9910
 Site-MNIST-M   | Train Loss: 0.2741 | Train Acc: 0.9459
 Site-MNIST     | Val  Loss: 0.0903 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0909 | Val  Acc: 0.9865
 Site-SVHN      | Val  Loss: 0.7192 | Val  Acc: 0.8243
 Site-SVHN      | Val  Loss: 0.5418 | Val  Acc: 0.8784
 Site-SynthDigits| Val  Loss: 0.3387 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.2401 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.2660 | Val  Acc: 0.9595
 Site-MNIST-M   | Val  Loss: 0.2399 | Val  Acc: 0.9459
Average Valid Accuracy: 0.9409
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9865
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8243
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8784
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9595
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.9459
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0559 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0688 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.4204 | Train Acc: 0.9189
 Site-SVHN      | Train Loss: 0.4749 | Train Acc: 0.9009
 Site-SynthDigits| Train Loss: 0.2426 | Train Acc: 0.9369
 Site-SynthDigits| Train Loss: 0.2260 | Train Acc: 0.9640
 Site-MNIST-M   | Train Loss: 0.1492 | Train Acc: 1.0000
 Site-MNIST-M   | Train Loss: 0.1644 | Train Acc: 0.9820
 Site-MNIST     | Val  Loss: 0.0713 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0575 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5253 | Val  Acc: 0.8784
 Site-SVHN      | Val  Loss: 0.4295 | Val  Acc: 0.9189
 Site-SynthDigits| Val  Loss: 0.2789 | Val  Acc: 0.9459
 Site-SynthDigits| Val  Loss: 0.1842 | Val  Acc: 0.9730
 Site-MNIST-M   | Val  Loss: 0.1656 | Val  Acc: 0.9865
 Site-MNIST-M   | Val  Loss: 0.1419 | Val  Acc: 0.9865
Average Valid Accuracy: 0.9611
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8784
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9189
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9459
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9730
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9865
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-1-sqrt/FedPrompt_USPS...
===2023-03-26 03:48:55===
===2023-03-26 03:48:56===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8629
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3975
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.6658
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.4293
Average Test Accuracy: 0.5889
===2023-03-26 12:00:10===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
domain number = 2
Loading snapshots...
Test Accuracy of USPS: 0.7204
Average Test Accuracy: 0.7204
===2023-03-29 18:28:39===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
 Site-MNIST     | Train Loss: 1.9193 | Train Acc: 0.5000
 Site-MNIST     | Train Loss: 1.8863 | Train Acc: 0.4773
 Site-MNIST     | Train Loss: 1.8497 | Train Acc: 0.4659
 Site-SVHN      | Train Loss: 2.2168 | Train Acc: 0.2159
 Site-SVHN      | Train Loss: 2.1987 | Train Acc: 0.2045
 Site-SVHN      | Train Loss: 2.2089 | Train Acc: 0.2159
 Site-SynthDigits| Train Loss: 2.1568 | Train Acc: 0.2500
 Site-SynthDigits| Train Loss: 2.1229 | Train Acc: 0.2159
 Site-SynthDigits| Train Loss: 2.1151 | Train Acc: 0.2614
 Site-MNIST-M   | Train Loss: 2.2026 | Train Acc: 0.1818
 Site-MNIST-M   | Train Loss: 2.1726 | Train Acc: 0.2045
 Site-MNIST-M   | Train Loss: 2.2222 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 1.8429 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.8979 | Val  Acc: 0.4746
 Site-MNIST     | Val  Loss: 1.8570 | Val  Acc: 0.5254
 Site-SVHN      | Val  Loss: 2.2425 | Val  Acc: 0.1695
 Site-SVHN      | Val  Loss: 2.1825 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2271 | Val  Acc: 0.1525
 Site-SynthDigits| Val  Loss: 2.1231 | Val  Acc: 0.2542
 Site-SynthDigits| Val  Loss: 2.1517 | Val  Acc: 0.1525
 Site-SynthDigits| Val  Loss: 2.1124 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.2028 | Val  Acc: 0.2373
 Site-MNIST-M   | Val  Loss: 2.1806 | Val  Acc: 0.2203
 Site-MNIST-M   | Val  Loss: 2.2112 | Val  Acc: 0.1695
Average Valid Accuracy: 0.2825
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:0 | Val Acc: 0.4746
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5254
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1695
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1525
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.2542
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.1525
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2373
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.2203
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.4989 | Train Acc: 0.5455
 Site-MNIST     | Train Loss: 1.4333 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.5007 | Train Acc: 0.6250
 Site-SVHN      | Train Loss: 2.1108 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 2.0554 | Train Acc: 0.2614
 Site-SVHN      | Train Loss: 2.0796 | Train Acc: 0.3295
 Site-SynthDigits| Train Loss: 1.9294 | Train Acc: 0.3864
 Site-SynthDigits| Train Loss: 1.9158 | Train Acc: 0.4318
 Site-SynthDigits| Train Loss: 1.9520 | Train Acc: 0.4545
 Site-MNIST-M   | Train Loss: 2.0680 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.0256 | Train Acc: 0.2841
 Site-MNIST-M   | Train Loss: 1.9849 | Train Acc: 0.3068
 Site-MNIST     | Val  Loss: 1.4555 | Val  Acc: 0.6610
 Site-MNIST     | Val  Loss: 1.4603 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.3819 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 2.1485 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0628 | Val  Acc: 0.2881
 Site-SVHN      | Val  Loss: 2.0980 | Val  Acc: 0.1864
 Site-SynthDigits| Val  Loss: 1.9471 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 1.9757 | Val  Acc: 0.3729
 Site-SynthDigits| Val  Loss: 1.8578 | Val  Acc: 0.4576
 Site-MNIST-M   | Val  Loss: 2.0214 | Val  Acc: 0.2881
 Site-MNIST-M   | Val  Loss: 2.0279 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0488 | Val  Acc: 0.2712
Average Valid Accuracy: 0.3969
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6610
 Best site-MNIST      | Epoch:1 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2881
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3729
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.4576
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2881
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2712
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 1.3338 | Train Acc: 0.5682
 Site-MNIST     | Train Loss: 1.2028 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.2729 | Train Acc: 0.5909
 Site-SVHN      | Train Loss: 2.0216 | Train Acc: 0.3295
 Site-SVHN      | Train Loss: 2.0693 | Train Acc: 0.2727
 Site-SVHN      | Train Loss: 2.0685 | Train Acc: 0.3636
 Site-SynthDigits| Train Loss: 1.7526 | Train Acc: 0.4205
 Site-SynthDigits| Train Loss: 1.6750 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.7417 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.9770 | Train Acc: 0.3068
 Site-MNIST-M   | Train Loss: 1.7581 | Train Acc: 0.4773
 Site-MNIST-M   | Train Loss: 1.8960 | Train Acc: 0.3864
 Site-MNIST     | Val  Loss: 1.2667 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.2730 | Val  Acc: 0.6102
 Site-MNIST     | Val  Loss: 1.1791 | Val  Acc: 0.6610
 Site-SVHN      | Val  Loss: 2.0591 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 2.0581 | Val  Acc: 0.3051
 Site-SVHN      | Val  Loss: 2.0385 | Val  Acc: 0.2373
 Site-SynthDigits| Val  Loss: 1.7717 | Val  Acc: 0.4068
 Site-SynthDigits| Val  Loss: 1.7560 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.6881 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8999 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.7507 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.8335 | Val  Acc: 0.4237
Average Valid Accuracy: 0.4520
 Best site-MNIST      | Epoch:2 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6102
 Best site-MNIST      | Epoch:2 | Val Acc: 0.6610
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3051
 Best site-SVHN       | Epoch:2 | Val Acc: 0.2373
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.4237
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.9002 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 0.8010 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.8993 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 1.9044 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.8186 | Train Acc: 0.3864
 Site-SVHN      | Train Loss: 1.8401 | Train Acc: 0.4091
 Site-SynthDigits| Train Loss: 1.5305 | Train Acc: 0.5000
 Site-SynthDigits| Train Loss: 1.4901 | Train Acc: 0.5341
 Site-SynthDigits| Train Loss: 1.5352 | Train Acc: 0.4659
 Site-MNIST-M   | Train Loss: 1.8026 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.6987 | Train Acc: 0.4886
 Site-MNIST-M   | Train Loss: 1.6806 | Train Acc: 0.4091
 Site-MNIST     | Val  Loss: 0.9534 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 0.8958 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.7875 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 1.8988 | Val  Acc: 0.3559
 Site-SVHN      | Val  Loss: 1.8438 | Val  Acc: 0.4068
 Site-SVHN      | Val  Loss: 1.8427 | Val  Acc: 0.2881
 Site-SynthDigits| Val  Loss: 1.5170 | Val  Acc: 0.4576
 Site-SynthDigits| Val  Loss: 1.5398 | Val  Acc: 0.4915
 Site-SynthDigits| Val  Loss: 1.4554 | Val  Acc: 0.5254
 Site-MNIST-M   | Val  Loss: 1.7484 | Val  Acc: 0.3898
 Site-MNIST-M   | Val  Loss: 1.7399 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7056 | Val  Acc: 0.4915
Average Valid Accuracy: 0.5141
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:3 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:3 | Val Acc: 0.3559
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-SVHN       | Epoch:3 | Val Acc: 0.2881
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4576
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4915
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.5254
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.3898
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4915
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.6812 | Train Acc: 0.8182
 Site-MNIST     | Train Loss: 0.6227 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.6557 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.6030 | Train Acc: 0.4318
 Site-SVHN      | Train Loss: 1.6356 | Train Acc: 0.4205
 Site-SVHN      | Train Loss: 1.5419 | Train Acc: 0.5114
 Site-SynthDigits| Train Loss: 1.2290 | Train Acc: 0.6023
 Site-SynthDigits| Train Loss: 1.1486 | Train Acc: 0.6250
 Site-SynthDigits| Train Loss: 1.2238 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.5775 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 1.3270 | Train Acc: 0.6250
 Site-MNIST-M   | Train Loss: 1.4506 | Train Acc: 0.5341
 Site-MNIST     | Val  Loss: 0.6603 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.6804 | Val  Acc: 0.7966
 Site-MNIST     | Val  Loss: 0.5592 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 1.6286 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6908 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.6851 | Val  Acc: 0.3559
 Site-SynthDigits| Val  Loss: 1.2746 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 1.1841 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 1.2324 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.5201 | Val  Acc: 0.4915
 Site-MNIST-M   | Val  Loss: 1.3456 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.3872 | Val  Acc: 0.5254
Average Valid Accuracy: 0.6073
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:4 | Val Acc: 0.7966
 Best site-MNIST      | Epoch:4 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:4 | Val Acc: 0.3559
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.4915
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5254
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.4700 | Train Acc: 0.8864
 Site-MNIST     | Train Loss: 0.4402 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4984 | Train Acc: 0.8636
 Site-SVHN      | Train Loss: 1.4501 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.5327 | Train Acc: 0.4773
 Site-SVHN      | Train Loss: 1.4498 | Train Acc: 0.5227
 Site-SynthDigits| Train Loss: 1.0360 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 0.8913 | Train Acc: 0.7727
 Site-SynthDigits| Train Loss: 0.9204 | Train Acc: 0.7727
 Site-MNIST-M   | Train Loss: 1.4050 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.0359 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.3047 | Train Acc: 0.6136
 Site-MNIST     | Val  Loss: 0.4948 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.5154 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4130 | Val  Acc: 0.8814
 Site-SVHN      | Val  Loss: 1.5573 | Val  Acc: 0.4915
 Site-SVHN      | Val  Loss: 1.5326 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.5765 | Val  Acc: 0.4237
 Site-SynthDigits| Val  Loss: 0.9774 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 0.8854 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 1.0467 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 1.3745 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.0611 | Val  Acc: 0.6610
 Site-MNIST-M   | Val  Loss: 1.1471 | Val  Acc: 0.6441
Average Valid Accuracy: 0.6737
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:5 | Val Acc: 0.8814
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4915
 Best site-SVHN       | Epoch:5 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:5 | Val Acc: 0.4237
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6610
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6441
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.3228 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.3350 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3565 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.2749 | Train Acc: 0.5455
 Site-SVHN      | Train Loss: 1.1803 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.2057 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.8095 | Train Acc: 0.7159
 Site-SynthDigits| Train Loss: 0.7288 | Train Acc: 0.8636
 Site-SynthDigits| Train Loss: 0.8123 | Train Acc: 0.7841
 Site-MNIST-M   | Train Loss: 1.0710 | Train Acc: 0.6364
 Site-MNIST-M   | Train Loss: 0.8608 | Train Acc: 0.8068
 Site-MNIST-M   | Train Loss: 1.0247 | Train Acc: 0.7273
 Site-MNIST     | Val  Loss: 0.3411 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.3431 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.3062 | Val  Acc: 0.8983
 Site-SVHN      | Val  Loss: 1.2546 | Val  Acc: 0.5763
 Site-SVHN      | Val  Loss: 1.2131 | Val  Acc: 0.6441
 Site-SVHN      | Val  Loss: 1.2829 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 0.9006 | Val  Acc: 0.7119
 Site-SynthDigits| Val  Loss: 0.7218 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.8456 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 1.1173 | Val  Acc: 0.6271
 Site-MNIST-M   | Val  Loss: 0.8992 | Val  Acc: 0.7627
 Site-MNIST-M   | Val  Loss: 0.9037 | Val  Acc: 0.7627
Average Valid Accuracy: 0.7528
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:6 | Val Acc: 0.8983
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-SVHN       | Epoch:6 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7119
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6271
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7627
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.2492 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2795 | Train Acc: 0.9091
 Site-MNIST     | Train Loss: 0.2861 | Train Acc: 0.9318
 Site-SVHN      | Train Loss: 1.0502 | Train Acc: 0.6364
 Site-SVHN      | Train Loss: 1.0909 | Train Acc: 0.6705
 Site-SVHN      | Train Loss: 1.1048 | Train Acc: 0.6364
 Site-SynthDigits| Train Loss: 0.6872 | Train Acc: 0.8182
 Site-SynthDigits| Train Loss: 0.5294 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 0.6228 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.9072 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 0.6295 | Train Acc: 0.8750
 Site-MNIST-M   | Train Loss: 0.7983 | Train Acc: 0.7727
 Site-MNIST     | Val  Loss: 0.2773 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2835 | Val  Acc: 0.9153
 Site-MNIST     | Val  Loss: 0.2348 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.1948 | Val  Acc: 0.5424
 Site-SVHN      | Val  Loss: 1.0451 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.1084 | Val  Acc: 0.6441
 Site-SynthDigits| Val  Loss: 0.6561 | Val  Acc: 0.8305
 Site-SynthDigits| Val  Loss: 0.5319 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 0.7085 | Val  Acc: 0.7458
 Site-MNIST-M   | Val  Loss: 0.9066 | Val  Acc: 0.7119
 Site-MNIST-M   | Val  Loss: 0.7060 | Val  Acc: 0.8305
 Site-MNIST-M   | Val  Loss: 0.6788 | Val  Acc: 0.8644
Average Valid Accuracy: 0.7994
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9153
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:7 | Val Acc: 0.5424
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:7 | Val Acc: 0.6441
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.8305
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.7458
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7119
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8305
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.8644
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.1937 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1863 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.2127 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.0577 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 0.8428 | Train Acc: 0.7500
 Site-SVHN      | Train Loss: 0.8922 | Train Acc: 0.7273
 Site-SynthDigits| Train Loss: 0.5602 | Train Acc: 0.8409
 Site-SynthDigits| Train Loss: 0.3943 | Train Acc: 0.9432
 Site-SynthDigits| Train Loss: 0.4859 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.7800 | Train Acc: 0.7386
 Site-MNIST-M   | Train Loss: 0.6141 | Train Acc: 0.9318
 Site-MNIST-M   | Train Loss: 0.6722 | Train Acc: 0.8523
 Site-MNIST     | Val  Loss: 0.2154 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2016 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.1821 | Val  Acc: 0.9661
 Site-SVHN      | Val  Loss: 0.9861 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 0.8513 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.9781 | Val  Acc: 0.6949
 Site-SynthDigits| Val  Loss: 0.5172 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 0.3814 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.5891 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.7299 | Val  Acc: 0.7966
 Site-MNIST-M   | Val  Loss: 0.6386 | Val  Acc: 0.8983
 Site-MNIST-M   | Val  Loss: 0.5586 | Val  Acc: 0.8814
Average Valid Accuracy: 0.8517
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9661
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:8 | Val Acc: 0.6949
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7966
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8983
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.8814
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.1445 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1312 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1763 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 0.7461 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.6728 | Train Acc: 0.7955
 Site-SVHN      | Train Loss: 0.7368 | Train Acc: 0.7841
 Site-SynthDigits| Train Loss: 0.4689 | Train Acc: 0.8864
 Site-SynthDigits| Train Loss: 0.3409 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.4454 | Train Acc: 0.9205
 Site-MNIST-M   | Train Loss: 0.5752 | Train Acc: 0.7955
 Site-MNIST-M   | Train Loss: 0.3930 | Train Acc: 0.9545
 Site-MNIST-M   | Train Loss: 0.4947 | Train Acc: 0.8977
 Site-MNIST     | Val  Loss: 0.1761 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1501 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1308 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 0.8429 | Val  Acc: 0.7458
 Site-SVHN      | Val  Loss: 0.6701 | Val  Acc: 0.8305
 Site-SVHN      | Val  Loss: 0.7639 | Val  Acc: 0.7797
 Site-SynthDigits| Val  Loss: 0.4544 | Val  Acc: 0.9153
 Site-SynthDigits| Val  Loss: 0.3312 | Val  Acc: 0.9661
 Site-SynthDigits| Val  Loss: 0.4706 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.5634 | Val  Acc: 0.8475
 Site-MNIST-M   | Val  Loss: 0.4465 | Val  Acc: 0.9322
 Site-MNIST-M   | Val  Loss: 0.3797 | Val  Acc: 0.8983
Average Valid Accuracy: 0.8912
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7458
 Best site-SVHN       | Epoch:9 | Val Acc: 0.8305
 Best site-SVHN       | Epoch:9 | Val Acc: 0.7797
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9153
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.9661
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8475
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.9322
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.8983
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even-sqrt/FedPrompt_USPS...
===2023-03-29 19:09:16===
===2023-03-29 19:09:17===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
Test Accuracy of USPS: 0.6828
Average Test Accuracy: 0.6828
