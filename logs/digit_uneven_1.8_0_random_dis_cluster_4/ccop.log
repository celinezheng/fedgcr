===2023-08-02 12:57:55===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 4
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[6, 3, 10, 3, ]
cnt=[10, 3, 3, 6, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                     (2) | Train Loss: 1.6933 | Train Acc: 0.5000
 Site-MNIST                     (2) | Train Loss: 1.7288 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.5745 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.6454 | Train Acc: 0.7632
 Site-MNIST                     (2) | Train Loss: 1.5632 | Train Acc: 0.6857
 Site-MNIST                     (2) | Train Loss: 1.6032 | Train Acc: 0.7302
 Site-MNIST                     (2) | Train Loss: 1.6067 | Train Acc: 0.6784
 Site-MNIST                     (2) | Train Loss: 1.6766 | Train Acc: 0.6235
 Site-MNIST                     (2) | Train Loss: 1.6493 | Train Acc: 0.6644
 Site-MNIST                     (2) | Train Loss: 1.6265 | Train Acc: 0.6860
 Site-USPS                      (0) | Train Loss: 1.7111 | Train Acc: 0.5500
 Site-USPS                      (0) | Train Loss: 1.6562 | Train Acc: 0.5556
 Site-USPS                      (0) | Train Loss: 1.8253 | Train Acc: 0.5736
 Site-USPS                      (0) | Train Loss: 1.7285 | Train Acc: 0.5536
 Site-USPS                      (0) | Train Loss: 1.7470 | Train Acc: 0.5690
 Site-USPS                      (0) | Train Loss: 1.7449 | Train Acc: 0.5463
 Site-SynthDigits               (3) | Train Loss: 2.1621 | Train Acc: 0.2914
 Site-SynthDigits               (3) | Train Loss: 2.1584 | Train Acc: 0.2308
 Site-SynthDigits               (3) | Train Loss: 2.1377 | Train Acc: 0.2587
 Site-MNIST_M                   (1) | Train Loss: 2.2426 | Train Acc: 0.1934
 Site-MNIST_M                   (1) | Train Loss: 2.1697 | Train Acc: 0.2141
 Site-SVHN                      (1) | Train Loss: 2.2692 | Train Acc: 0.1631
Average Train Accuracy: 0.5166
 Site-MNIST                     (2) | Val  Loss: 2.0150 | Val  Acc: 0.0000
 Site-MNIST                     (2) | Val  Loss: 1.4954 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.4747 | Val  Acc: 0.6000
 Site-MNIST                     (2) | Val  Loss: 1.6396 | Val  Acc: 0.5556
 Site-MNIST                     (2) | Val  Loss: 1.6631 | Val  Acc: 0.5882
 Site-MNIST                     (2) | Val  Loss: 1.7017 | Val  Acc: 0.6452
 Site-MNIST                     (2) | Val  Loss: 1.6223 | Val  Acc: 0.6964
 Site-MNIST                     (2) | Val  Loss: 1.6110 | Val  Acc: 0.7255
 Site-MNIST                     (2) | Val  Loss: 1.6629 | Val  Acc: 0.6503
 Site-MNIST                     (2) | Val  Loss: 1.6314 | Val  Acc: 0.6435
 Site-USPS                      (0) | Val  Loss: 1.7363 | Val  Acc: 0.4000
 Site-USPS                      (0) | Val  Loss: 1.8335 | Val  Acc: 0.3889
 Site-USPS                      (0) | Val  Loss: 1.8047 | Val  Acc: 0.5000
 Site-USPS                      (0) | Val  Loss: 1.7916 | Val  Acc: 0.4828
 Site-USPS                      (0) | Val  Loss: 1.7383 | Val  Acc: 0.5810
 Site-USPS                      (0) | Val  Loss: 1.6739 | Val  Acc: 0.6085
 Site-SynthDigits               (3) | Val  Loss: 2.1917 | Val  Acc: 0.1622
 Site-SynthDigits               (3) | Val  Loss: 2.2467 | Val  Acc: 0.2647
 Site-SynthDigits               (3) | Val  Loss: 2.1293 | Val  Acc: 0.2869
 Site-MNIST_M                   (1) | Val  Loss: 2.1776 | Val  Acc: 0.2000
 Site-MNIST_M                   (1) | Val  Loss: 2.2288 | Val  Acc: 0.1852
 Site-SVHN                      (1) | Val  Loss: 2.2313 | Val  Acc: 0.2000
Average Valid Accuracy: 0.4560
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.0000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6000
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5556
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5882
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6452
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6964
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.7255
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6503
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6435
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.3889
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5000
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.4828
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.5810
 Best site-USPS                     (0)  | Epoch:0 | Val Acc: 0.6085
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.1622
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2647
 Best site-SynthDigits              (3)  | Epoch:0 | Val Acc: 0.2869
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.2000
 Best site-MNIST_M                  (1)  | Epoch:0 | Val Acc: 0.1852
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 1 ============
cnt=[6, 3, 10, 3, ]
cnt=[6, 10, 3, 3, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                     (2) | Train Loss: 1.2380 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 1.2679 | Train Acc: 0.7500
 Site-MNIST                     (2) | Train Loss: 1.0737 | Train Acc: 0.8095
 Site-MNIST                     (2) | Train Loss: 1.1017 | Train Acc: 0.8947
 Site-MNIST                     (2) | Train Loss: 1.2782 | Train Acc: 0.8000
 Site-MNIST                     (2) | Train Loss: 1.1127 | Train Acc: 0.8254
 Site-MNIST                     (2) | Train Loss: 1.1031 | Train Acc: 0.8546
 Site-MNIST                     (2) | Train Loss: 1.2296 | Train Acc: 0.7506
 Site-MNIST                     (2) | Train Loss: 1.1627 | Train Acc: 0.7840
 Site-MNIST                     (2) | Train Loss: 1.1296 | Train Acc: 0.7977
 Site-USPS                      (0) | Train Loss: 1.2373 | Train Acc: 0.7250
 Site-USPS                      (0) | Train Loss: 1.2130 | Train Acc: 0.7361
 Site-USPS                      (0) | Train Loss: 1.4579 | Train Acc: 0.7132
 Site-USPS                      (0) | Train Loss: 1.2613 | Train Acc: 0.7339
 Site-USPS                      (0) | Train Loss: 1.2451 | Train Acc: 0.7500
 Site-USPS                      (0) | Train Loss: 1.2615 | Train Acc: 0.7381
 Site-SynthDigits               (1) | Train Loss: 2.0083 | Train Acc: 0.2980
 Site-SynthDigits               (1) | Train Loss: 1.9824 | Train Acc: 0.2711
 Site-SynthDigits               (1) | Train Loss: 1.9789 | Train Acc: 0.3035
 Site-MNIST_M                   (3) | Train Loss: 2.0596 | Train Acc: 0.2597
 Site-MNIST_M                   (3) | Train Loss: 2.0518 | Train Acc: 0.3180
 Site-SVHN                      (3) | Train Loss: 2.2030 | Train Acc: 0.1809
Average Train Accuracy: 0.6346
 Site-MNIST                     (2) | Val  Loss: 1.3143 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.9242 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.9578 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.2483 | Val  Acc: 0.5556
 Site-MNIST                     (2) | Val  Loss: 1.2439 | Val  Acc: 0.7059
 Site-MNIST                     (2) | Val  Loss: 1.2642 | Val  Acc: 0.7419
 Site-MNIST                     (2) | Val  Loss: 1.1310 | Val  Acc: 0.8571
 Site-MNIST                     (2) | Val  Loss: 1.1287 | Val  Acc: 0.8137
 Site-MNIST                     (2) | Val  Loss: 1.2033 | Val  Acc: 0.7705
 Site-MNIST                     (2) | Val  Loss: 1.1664 | Val  Acc: 0.7976
 Site-USPS                      (0) | Val  Loss: 1.1694 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.4290 | Val  Acc: 0.6667
 Site-USPS                      (0) | Val  Loss: 1.4098 | Val  Acc: 0.5938
 Site-USPS                      (0) | Val  Loss: 1.3741 | Val  Acc: 0.6207
 Site-USPS                      (0) | Val  Loss: 1.2775 | Val  Acc: 0.7238
 Site-USPS                      (0) | Val  Loss: 1.1954 | Val  Acc: 0.7672
 Site-SynthDigits               (1) | Val  Loss: 2.0893 | Val  Acc: 0.1892
 Site-SynthDigits               (1) | Val  Loss: 2.1887 | Val  Acc: 0.2794
 Site-SynthDigits               (1) | Val  Loss: 1.9879 | Val  Acc: 0.3115
 Site-MNIST_M                   (3) | Val  Loss: 2.0663 | Val  Acc: 0.2667
 Site-MNIST_M                   (3) | Val  Loss: 2.0773 | Val  Acc: 0.2469
 Site-SVHN                      (3) | Val  Loss: 2.0701 | Val  Acc: 0.2286
Average Valid Accuracy: 0.6244
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.5556
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7059
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7419
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8571
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.8137
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7705
 Best site-MNIST                    (2)  | Epoch:1 | Val Acc: 0.7976
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6667
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.5938
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6207
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7238
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7672
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.1892
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.2794
 Best site-SynthDigits              (1)  | Epoch:1 | Val Acc: 0.3115
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2667
 Best site-MNIST_M                  (3)  | Epoch:1 | Val Acc: 0.2469
 Best site-SVHN                     (3)  | Epoch:1 | Val Acc: 0.2286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 2 ============
cnt=[6, 3, 10, 3, ]
cnt=[1, 9, 3, 9, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                     (2) | Train Loss: 0.9318 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 1.1269 | Train Acc: 0.6667
 Site-MNIST                     (2) | Train Loss: 0.9496 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.9588 | Train Acc: 0.8421
 Site-MNIST                     (2) | Train Loss: 1.1791 | Train Acc: 0.7857
 Site-MNIST                     (2) | Train Loss: 0.9932 | Train Acc: 0.8095
 Site-MNIST                     (2) | Train Loss: 0.9471 | Train Acc: 0.8194
 Site-MNIST                     (2) | Train Loss: 1.0955 | Train Acc: 0.7579
 Site-MNIST                     (2) | Train Loss: 1.0350 | Train Acc: 0.7812
 Site-MNIST                     (2) | Train Loss: 0.9918 | Train Acc: 0.7842
 Site-USPS                      (0) | Train Loss: 0.9119 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 0.8606 | Train Acc: 0.8056
 Site-USPS                      (0) | Train Loss: 0.6954 | Train Acc: 0.7442
 Site-USPS                      (0) | Train Loss: 1.0271 | Train Acc: 0.7682
 Site-USPS                      (0) | Train Loss: 1.0135 | Train Acc: 0.7905
 Site-USPS                      (0) | Train Loss: 1.0035 | Train Acc: 0.7791
 Site-SynthDigits               (3) | Train Loss: 1.8523 | Train Acc: 0.3642
 Site-SynthDigits               (3) | Train Loss: 1.8169 | Train Acc: 0.3883
 Site-SynthDigits               (3) | Train Loss: 1.7440 | Train Acc: 0.4053
 Site-MNIST_M                   (1) | Train Loss: 1.9462 | Train Acc: 0.2983
 Site-MNIST_M                   (1) | Train Loss: 1.8890 | Train Acc: 0.3578
 Site-SVHN                      (1) | Train Loss: 2.0877 | Train Acc: 0.2092
Average Train Accuracy: 0.6658
 Site-MNIST                     (2) | Val  Loss: 0.9150 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.6753 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.7686 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 1.0427 | Val  Acc: 0.6667
 Site-MNIST                     (2) | Val  Loss: 1.0878 | Val  Acc: 0.7647
 Site-MNIST                     (2) | Val  Loss: 1.1390 | Val  Acc: 0.7742
 Site-MNIST                     (2) | Val  Loss: 1.0220 | Val  Acc: 0.8214
 Site-MNIST                     (2) | Val  Loss: 1.0065 | Val  Acc: 0.7941
 Site-MNIST                     (2) | Val  Loss: 1.0690 | Val  Acc: 0.7596
 Site-MNIST                     (2) | Val  Loss: 1.0246 | Val  Acc: 0.7825
 Site-USPS                      (0) | Val  Loss: 0.8982 | Val  Acc: 0.8000
 Site-USPS                      (0) | Val  Loss: 1.1810 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 1.1455 | Val  Acc: 0.6562
 Site-USPS                      (0) | Val  Loss: 1.1540 | Val  Acc: 0.6724
 Site-USPS                      (0) | Val  Loss: 1.0369 | Val  Acc: 0.7714
 Site-USPS                      (0) | Val  Loss: 0.9528 | Val  Acc: 0.7937
 Site-SynthDigits               (3) | Val  Loss: 1.8925 | Val  Acc: 0.4054
 Site-SynthDigits               (3) | Val  Loss: 1.9440 | Val  Acc: 0.4265
 Site-SynthDigits               (3) | Val  Loss: 1.7954 | Val  Acc: 0.3934
 Site-MNIST_M                   (1) | Val  Loss: 1.9692 | Val  Acc: 0.3333
 Site-MNIST_M                   (1) | Val  Loss: 1.9576 | Val  Acc: 0.2963
 Site-SVHN                      (1) | Val  Loss: 1.9723 | Val  Acc: 0.2429
Average Valid Accuracy: 0.6671
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.6667
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7647
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7742
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.8214
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7941
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7596
 Best site-MNIST                    (2)  | Epoch:2 | Val Acc: 0.7825
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.8000
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6562
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.6724
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7714
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7937
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.4054
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.4265
 Best site-SynthDigits              (3)  | Epoch:2 | Val Acc: 0.3934
 Best site-MNIST_M                  (1)  | Epoch:2 | Val Acc: 0.3333
 Best site-MNIST_M                  (1)  | Epoch:2 | Val Acc: 0.2963
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.2429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 3 ============
cnt=[10, 3, 3, 6, ]
cnt=[1, 3, 7, 11, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                     (0) | Train Loss: 0.8065 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 1.0057 | Train Acc: 0.7500
 Site-MNIST                     (0) | Train Loss: 0.7692 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.8130 | Train Acc: 0.8421
 Site-MNIST                     (0) | Train Loss: 0.8409 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.8457 | Train Acc: 0.8254
 Site-MNIST                     (0) | Train Loss: 0.8114 | Train Acc: 0.8678
 Site-MNIST                     (0) | Train Loss: 0.9227 | Train Acc: 0.8020
 Site-MNIST                     (0) | Train Loss: 0.8789 | Train Acc: 0.8098
 Site-MNIST                     (0) | Train Loss: 0.8422 | Train Acc: 0.8158
 Site-USPS                      (3) | Train Loss: 0.7718 | Train Acc: 0.8250
 Site-USPS                      (3) | Train Loss: 0.8207 | Train Acc: 0.8056
 Site-USPS                      (3) | Train Loss: 0.7991 | Train Acc: 0.8062
 Site-USPS                      (3) | Train Loss: 0.8710 | Train Acc: 0.8069
 Site-USPS                      (3) | Train Loss: 0.8632 | Train Acc: 0.8119
 Site-USPS                      (3) | Train Loss: 0.8561 | Train Acc: 0.8042
 Site-SynthDigits               (2) | Train Loss: 1.7294 | Train Acc: 0.4305
 Site-SynthDigits               (2) | Train Loss: 1.6347 | Train Acc: 0.4579
 Site-SynthDigits               (2) | Train Loss: 1.5941 | Train Acc: 0.4745
 Site-MNIST_M                   (1) | Train Loss: 1.8731 | Train Acc: 0.3204
 Site-MNIST_M                   (1) | Train Loss: 1.7991 | Train Acc: 0.3884
 Site-SVHN                      (1) | Train Loss: 2.0338 | Train Acc: 0.2411
Average Train Accuracy: 0.7002
 Site-MNIST                     (0) | Val  Loss: 0.6916 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.5223 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.6640 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.9389 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.9487 | Val  Acc: 0.8235
 Site-MNIST                     (0) | Val  Loss: 0.9687 | Val  Acc: 0.8387
 Site-MNIST                     (0) | Val  Loss: 0.8490 | Val  Acc: 0.8571
 Site-MNIST                     (0) | Val  Loss: 0.8452 | Val  Acc: 0.8333
 Site-MNIST                     (0) | Val  Loss: 0.9209 | Val  Acc: 0.8142
 Site-MNIST                     (0) | Val  Loss: 0.8778 | Val  Acc: 0.8338
 Site-USPS                      (3) | Val  Loss: 0.6894 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 1.0375 | Val  Acc: 0.7778
 Site-USPS                      (3) | Val  Loss: 1.0404 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 1.0267 | Val  Acc: 0.7241
 Site-USPS                      (3) | Val  Loss: 0.8951 | Val  Acc: 0.8095
 Site-USPS                      (3) | Val  Loss: 0.8139 | Val  Acc: 0.8307
 Site-SynthDigits               (2) | Val  Loss: 1.7544 | Val  Acc: 0.5135
 Site-SynthDigits               (2) | Val  Loss: 1.8084 | Val  Acc: 0.5294
 Site-SynthDigits               (2) | Val  Loss: 1.6433 | Val  Acc: 0.4754
 Site-MNIST_M                   (1) | Val  Loss: 1.9264 | Val  Acc: 0.2889
 Site-MNIST_M                   (1) | Val  Loss: 1.9015 | Val  Acc: 0.3704
 Site-SVHN                      (1) | Val  Loss: 1.9356 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7190
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8235
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8387
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8571
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8333
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8142
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8338
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7778
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7241
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.8095
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.8307
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5135
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.5294
 Best site-SynthDigits              (2)  | Epoch:3 | Val Acc: 0.4754
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.2889
 Best site-MNIST_M                  (1)  | Epoch:3 | Val Acc: 0.3704
 Best site-SVHN                     (1)  | Epoch:3 | Val Acc: 0.3000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 4 ============
cnt=[6, 3, 3, 10, ]
cnt=[6, 10, 3, 3, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                     (3) | Train Loss: 0.7662 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.8825 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.6615 | Train Acc: 0.8095
 Site-MNIST                     (3) | Train Loss: 0.7055 | Train Acc: 0.8684
 Site-MNIST                     (3) | Train Loss: 0.7184 | Train Acc: 0.8286
 Site-MNIST                     (3) | Train Loss: 0.7523 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7038 | Train Acc: 0.8811
 Site-MNIST                     (3) | Train Loss: 0.8249 | Train Acc: 0.8117
 Site-MNIST                     (3) | Train Loss: 0.7810 | Train Acc: 0.8383
 Site-MNIST                     (3) | Train Loss: 0.7404 | Train Acc: 0.8475
 Site-USPS                      (0) | Train Loss: 0.6786 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.6530 | Train Acc: 0.8472
 Site-USPS                      (0) | Train Loss: 0.5208 | Train Acc: 0.8295
 Site-USPS                      (0) | Train Loss: 0.7982 | Train Acc: 0.8240
 Site-USPS                      (0) | Train Loss: 0.7658 | Train Acc: 0.8381
 Site-USPS                      (0) | Train Loss: 0.7685 | Train Acc: 0.8347
 Site-SynthDigits               (1) | Train Loss: 1.6068 | Train Acc: 0.4901
 Site-SynthDigits               (1) | Train Loss: 1.5191 | Train Acc: 0.4908
 Site-SynthDigits               (1) | Train Loss: 1.4816 | Train Acc: 0.5051
 Site-MNIST_M                   (2) | Train Loss: 1.7857 | Train Acc: 0.3702
 Site-MNIST_M                   (2) | Train Loss: 1.7388 | Train Acc: 0.4404
 Site-SVHN                      (2) | Train Loss: 1.9742 | Train Acc: 0.2624
Average Train Accuracy: 0.7247
 Site-MNIST                     (3) | Val  Loss: 0.4870 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4181 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.6010 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.8755 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.8547 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.8475 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.7280 | Val  Acc: 0.8750
 Site-MNIST                     (3) | Val  Loss: 0.7320 | Val  Acc: 0.8431
 Site-MNIST                     (3) | Val  Loss: 0.8174 | Val  Acc: 0.8087
 Site-MNIST                     (3) | Val  Loss: 0.7776 | Val  Acc: 0.8399
 Site-USPS                      (0) | Val  Loss: 0.5704 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.9552 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9653 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.9317 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.8036 | Val  Acc: 0.8190
 Site-USPS                      (0) | Val  Loss: 0.7343 | Val  Acc: 0.8624
 Site-SynthDigits               (1) | Val  Loss: 1.6268 | Val  Acc: 0.5405
 Site-SynthDigits               (1) | Val  Loss: 1.6069 | Val  Acc: 0.5588
 Site-SynthDigits               (1) | Val  Loss: 1.5264 | Val  Acc: 0.5246
 Site-MNIST_M                   (2) | Val  Loss: 1.8577 | Val  Acc: 0.3333
 Site-MNIST_M                   (2) | Val  Loss: 1.8200 | Val  Acc: 0.4321
 Site-SVHN                      (2) | Val  Loss: 1.8973 | Val  Acc: 0.2857
Average Valid Accuracy: 0.7326
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8750
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8431
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8087
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8399
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8190
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.8624
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5405
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5588
 Best site-SynthDigits              (1)  | Epoch:4 | Val Acc: 0.5246
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.3333
 Best site-MNIST_M                  (2)  | Epoch:4 | Val Acc: 0.4321
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.2857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 5 ============
cnt=[6, 3, 3, 10, ]
cnt=[10, 3, 6, 3, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                     (3) | Train Loss: 0.7232 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.8335 | Train Acc: 0.7500
 Site-MNIST                     (3) | Train Loss: 0.5892 | Train Acc: 0.9048
 Site-MNIST                     (3) | Train Loss: 0.6192 | Train Acc: 0.9211
 Site-MNIST                     (3) | Train Loss: 0.9194 | Train Acc: 0.8143
 Site-MNIST                     (3) | Train Loss: 0.6864 | Train Acc: 0.8413
 Site-MNIST                     (3) | Train Loss: 0.6228 | Train Acc: 0.8811
 Site-MNIST                     (3) | Train Loss: 0.7446 | Train Acc: 0.8362
 Site-MNIST                     (3) | Train Loss: 0.6993 | Train Acc: 0.8383
 Site-MNIST                     (3) | Train Loss: 0.6708 | Train Acc: 0.8574
 Site-USPS                      (0) | Train Loss: 0.6058 | Train Acc: 0.8250
 Site-USPS                      (0) | Train Loss: 0.5901 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.4787 | Train Acc: 0.8295
 Site-USPS                      (0) | Train Loss: 0.7382 | Train Acc: 0.8326
 Site-USPS                      (0) | Train Loss: 0.7090 | Train Acc: 0.8452
 Site-USPS                      (0) | Train Loss: 0.7050 | Train Acc: 0.8386
 Site-SynthDigits               (1) | Train Loss: 1.5231 | Train Acc: 0.5232
 Site-SynthDigits               (1) | Train Loss: 1.4632 | Train Acc: 0.5495
 Site-SynthDigits               (1) | Train Loss: 1.3768 | Train Acc: 0.5703
 Site-MNIST_M                   (2) | Train Loss: 1.6952 | Train Acc: 0.3978
 Site-MNIST_M                   (2) | Train Loss: 1.6640 | Train Acc: 0.4771
 Site-SVHN                      (2) | Train Loss: 1.9179 | Train Acc: 0.3121
Average Train Accuracy: 0.7433
 Site-MNIST                     (3) | Val  Loss: 0.3672 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.3072 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.5234 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.7645 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.7548 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.7687 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.6638 | Val  Acc: 0.9107
 Site-MNIST                     (3) | Val  Loss: 0.6669 | Val  Acc: 0.8627
 Site-MNIST                     (3) | Val  Loss: 0.7431 | Val  Acc: 0.8361
 Site-MNIST                     (3) | Val  Loss: 0.7061 | Val  Acc: 0.8459
 Site-USPS                      (0) | Val  Loss: 0.5234 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.9073 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9205 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.8836 | Val  Acc: 0.7241
 Site-USPS                      (0) | Val  Loss: 0.7511 | Val  Acc: 0.8190
 Site-USPS                      (0) | Val  Loss: 0.6781 | Val  Acc: 0.8677
 Site-SynthDigits               (1) | Val  Loss: 1.5114 | Val  Acc: 0.6216
 Site-SynthDigits               (1) | Val  Loss: 1.4721 | Val  Acc: 0.6176
 Site-SynthDigits               (1) | Val  Loss: 1.4097 | Val  Acc: 0.5738
 Site-MNIST_M                   (2) | Val  Loss: 1.7850 | Val  Acc: 0.4000
 Site-MNIST_M                   (2) | Val  Loss: 1.7349 | Val  Acc: 0.4938
 Site-SVHN                      (2) | Val  Loss: 1.8526 | Val  Acc: 0.3000
Average Valid Accuracy: 0.7519
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.9107
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8627
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8361
 Best site-MNIST                    (3)  | Epoch:5 | Val Acc: 0.8459
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.7241
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8190
 Best site-USPS                     (0)  | Epoch:5 | Val Acc: 0.8677
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6216
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6176
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.5738
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.4000
 Best site-MNIST_M                  (2)  | Epoch:5 | Val Acc: 0.4938
 Best site-SVHN                     (2)  | Epoch:5 | Val Acc: 0.3000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 6 ============
cnt=[6, 3, 3, 10, ]
cnt=[10, 6, 4, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                     (3) | Train Loss: 0.6616 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.7812 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.5433 | Train Acc: 0.9048
 Site-MNIST                     (3) | Train Loss: 0.5591 | Train Acc: 0.9211
 Site-MNIST                     (3) | Train Loss: 1.0195 | Train Acc: 0.8429
 Site-MNIST                     (3) | Train Loss: 0.6288 | Train Acc: 0.8651
 Site-MNIST                     (3) | Train Loss: 0.5604 | Train Acc: 0.8943
 Site-MNIST                     (3) | Train Loss: 0.6781 | Train Acc: 0.8435
 Site-MNIST                     (3) | Train Loss: 0.6468 | Train Acc: 0.8546
 Site-MNIST                     (3) | Train Loss: 0.6157 | Train Acc: 0.8725
 Site-USPS                      (0) | Train Loss: 0.5728 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 0.7976 | Train Acc: 0.9028
 Site-USPS                      (0) | Train Loss: 1.0563 | Train Acc: 0.8295
 Site-USPS                      (0) | Train Loss: 0.7041 | Train Acc: 0.8369
 Site-USPS                      (0) | Train Loss: 0.6493 | Train Acc: 0.8429
 Site-USPS                      (0) | Train Loss: 0.6610 | Train Acc: 0.8571
 Site-SynthDigits               (2) | Train Loss: 1.4350 | Train Acc: 0.5563
 Site-SynthDigits               (2) | Train Loss: 1.3889 | Train Acc: 0.5751
 Site-SynthDigits               (2) | Train Loss: 1.2846 | Train Acc: 0.6171
 Site-MNIST_M                   (1) | Train Loss: 1.6418 | Train Acc: 0.4254
 Site-MNIST_M                   (1) | Train Loss: 1.5178 | Train Acc: 0.5321
 Site-SVHN                      (1) | Train Loss: 1.8425 | Train Acc: 0.3652
Average Train Accuracy: 0.7639
 Site-MNIST                     (3) | Val  Loss: 0.3251 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.2692 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.5036 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.7333 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.7007 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.6881 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.5957 | Val  Acc: 0.9286
 Site-MNIST                     (3) | Val  Loss: 0.6004 | Val  Acc: 0.8725
 Site-MNIST                     (3) | Val  Loss: 0.6791 | Val  Acc: 0.8415
 Site-MNIST                     (3) | Val  Loss: 0.6447 | Val  Acc: 0.8520
 Site-USPS                      (0) | Val  Loss: 0.4762 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8782 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.9029 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.8509 | Val  Acc: 0.7586
 Site-USPS                      (0) | Val  Loss: 0.7193 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.6405 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 1.4094 | Val  Acc: 0.6757
 Site-SynthDigits               (2) | Val  Loss: 1.3582 | Val  Acc: 0.6618
 Site-SynthDigits               (2) | Val  Loss: 1.3253 | Val  Acc: 0.5984
 Site-MNIST_M                   (1) | Val  Loss: 1.7291 | Val  Acc: 0.4222
 Site-MNIST_M                   (1) | Val  Loss: 1.6617 | Val  Acc: 0.5185
 Site-SVHN                      (1) | Val  Loss: 1.7905 | Val  Acc: 0.3571
Average Valid Accuracy: 0.7655
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.9286
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8725
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8415
 Best site-MNIST                    (3)  | Epoch:6 | Val Acc: 0.8520
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7586
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6757
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.6618
 Best site-SynthDigits              (2)  | Epoch:6 | Val Acc: 0.5984
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.4222
 Best site-MNIST_M                  (1)  | Epoch:6 | Val Acc: 0.5185
 Best site-SVHN                     (1)  | Epoch:6 | Val Acc: 0.3571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 7 ============
cnt=[6, 3, 10, 3, ]
cnt=[6, 2, 10, 4, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                     (2) | Train Loss: 0.6650 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.7377 | Train Acc: 0.9167
 Site-MNIST                     (2) | Train Loss: 0.5061 | Train Acc: 0.9048
 Site-MNIST                     (2) | Train Loss: 0.5103 | Train Acc: 0.8947
 Site-MNIST                     (2) | Train Loss: 0.5170 | Train Acc: 0.8429
 Site-MNIST                     (2) | Train Loss: 0.5867 | Train Acc: 0.8492
 Site-MNIST                     (2) | Train Loss: 0.5149 | Train Acc: 0.8899
 Site-MNIST                     (2) | Train Loss: 0.6253 | Train Acc: 0.8680
 Site-MNIST                     (2) | Train Loss: 0.6022 | Train Acc: 0.8655
 Site-MNIST                     (2) | Train Loss: 0.5747 | Train Acc: 0.8770
 Site-USPS                      (0) | Train Loss: 0.5691 | Train Acc: 0.8000
 Site-USPS                      (0) | Train Loss: 0.5781 | Train Acc: 0.9167
 Site-USPS                      (0) | Train Loss: 0.4335 | Train Acc: 0.8527
 Site-USPS                      (0) | Train Loss: 0.6737 | Train Acc: 0.8326
 Site-USPS                      (0) | Train Loss: 0.6201 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.6261 | Train Acc: 0.8571
 Site-SynthDigits               (3) | Train Loss: 1.3297 | Train Acc: 0.5695
 Site-SynthDigits               (3) | Train Loss: 1.2968 | Train Acc: 0.6117
 Site-SynthDigits               (3) | Train Loss: 1.1994 | Train Acc: 0.6415
 Site-MNIST_M                   (1) | Train Loss: 1.5797 | Train Acc: 0.4586
 Site-MNIST_M                   (1) | Train Loss: 1.5119 | Train Acc: 0.5443
 Site-SVHN                      (1) | Train Loss: 1.7946 | Train Acc: 0.3723
Average Train Accuracy: 0.7750
 Site-MNIST                     (2) | Val  Loss: 0.2455 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.2400 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4997 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.7269 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.6784 | Val  Acc: 0.8235
 Site-MNIST                     (2) | Val  Loss: 0.6467 | Val  Acc: 0.8710
 Site-MNIST                     (2) | Val  Loss: 0.5534 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.5597 | Val  Acc: 0.8922
 Site-MNIST                     (2) | Val  Loss: 0.6353 | Val  Acc: 0.8689
 Site-MNIST                     (2) | Val  Loss: 0.6050 | Val  Acc: 0.8640
 Site-USPS                      (0) | Val  Loss: 0.4274 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.8492 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.8918 | Val  Acc: 0.6562
 Site-USPS                      (0) | Val  Loss: 0.8146 | Val  Acc: 0.7414
 Site-USPS                      (0) | Val  Loss: 0.6814 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.6085 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 1.3345 | Val  Acc: 0.7297
 Site-SynthDigits               (3) | Val  Loss: 1.2532 | Val  Acc: 0.7206
 Site-SynthDigits               (3) | Val  Loss: 1.2263 | Val  Acc: 0.6393
 Site-MNIST_M                   (1) | Val  Loss: 1.6718 | Val  Acc: 0.4222
 Site-MNIST_M                   (1) | Val  Loss: 1.5988 | Val  Acc: 0.5185
 Site-SVHN                      (1) | Val  Loss: 1.7069 | Val  Acc: 0.3714
Average Valid Accuracy: 0.7711
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8235
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8710
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8922
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8689
 Best site-MNIST                    (2)  | Epoch:7 | Val Acc: 0.8640
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.6562
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.7414
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:7 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7297
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.7206
 Best site-SynthDigits              (3)  | Epoch:7 | Val Acc: 0.6393
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.4222
 Best site-MNIST_M                  (1)  | Epoch:7 | Val Acc: 0.5185
 Best site-SVHN                     (1)  | Epoch:7 | Val Acc: 0.3714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 8 ============
cnt=[3, 10, 3, 6, ]
cnt=[6, 2, 10, 4, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                     (1) | Train Loss: 0.6502 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.7625 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5118 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.4926 | Train Acc: 0.8684
 Site-MNIST                     (1) | Train Loss: 0.4908 | Train Acc: 0.8143
 Site-MNIST                     (1) | Train Loss: 0.5885 | Train Acc: 0.8175
 Site-MNIST                     (1) | Train Loss: 0.5167 | Train Acc: 0.8899
 Site-MNIST                     (1) | Train Loss: 0.6113 | Train Acc: 0.8460
 Site-MNIST                     (1) | Train Loss: 0.5836 | Train Acc: 0.8573
 Site-MNIST                     (1) | Train Loss: 0.5623 | Train Acc: 0.8679
 Site-USPS                      (3) | Train Loss: 0.5113 | Train Acc: 0.8500
 Site-USPS                      (3) | Train Loss: 0.4879 | Train Acc: 0.9167
 Site-USPS                      (3) | Train Loss: 0.4304 | Train Acc: 0.8760
 Site-USPS                      (3) | Train Loss: 0.6280 | Train Acc: 0.8455
 Site-USPS                      (3) | Train Loss: 0.5785 | Train Acc: 0.8762
 Site-USPS                      (3) | Train Loss: 0.5852 | Train Acc: 0.8743
 Site-SynthDigits               (2) | Train Loss: 1.2410 | Train Acc: 0.6490
 Site-SynthDigits               (2) | Train Loss: 1.1779 | Train Acc: 0.6410
 Site-SynthDigits               (2) | Train Loss: 1.1207 | Train Acc: 0.6884
 Site-MNIST_M                   (0) | Train Loss: 1.5124 | Train Acc: 0.4807
 Site-MNIST_M                   (0) | Train Loss: 1.3980 | Train Acc: 0.5810
 Site-SVHN                      (0) | Train Loss: 1.7264 | Train Acc: 0.4078
Average Train Accuracy: 0.7805
 Site-MNIST                     (1) | Val  Loss: 0.1877 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.2011 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4755 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6766 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.6503 | Val  Acc: 0.7647
 Site-MNIST                     (1) | Val  Loss: 0.6261 | Val  Acc: 0.8387
 Site-MNIST                     (1) | Val  Loss: 0.5478 | Val  Acc: 0.8750
 Site-MNIST                     (1) | Val  Loss: 0.5486 | Val  Acc: 0.8725
 Site-MNIST                     (1) | Val  Loss: 0.6227 | Val  Acc: 0.8470
 Site-MNIST                     (1) | Val  Loss: 0.5897 | Val  Acc: 0.8550
 Site-USPS                      (3) | Val  Loss: 0.3890 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7871 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8337 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.7873 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.6482 | Val  Acc: 0.8476
 Site-USPS                      (3) | Val  Loss: 0.5674 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 1.2402 | Val  Acc: 0.7027
 Site-SynthDigits               (2) | Val  Loss: 1.1639 | Val  Acc: 0.7647
 Site-SynthDigits               (2) | Val  Loss: 1.1283 | Val  Acc: 0.7049
 Site-MNIST_M                   (0) | Val  Loss: 1.5884 | Val  Acc: 0.4667
 Site-MNIST_M                   (0) | Val  Loss: 1.5077 | Val  Acc: 0.5802
 Site-SVHN                      (0) | Val  Loss: 1.5984 | Val  Acc: 0.4286
Average Valid Accuracy: 0.7790
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.7647
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8387
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8750
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8725
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8470
 Best site-MNIST                    (1)  | Epoch:8 | Val Acc: 0.8550
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.7931
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8476
 Best site-USPS                     (3)  | Epoch:8 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7027
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7647
 Best site-SynthDigits              (2)  | Epoch:8 | Val Acc: 0.7049
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.4667
 Best site-MNIST_M                  (0)  | Epoch:8 | Val Acc: 0.5802
 Best site-SVHN                     (0)  | Epoch:8 | Val Acc: 0.4286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 9 ============
cnt=[3, 10, 3, 6, ]
cnt=[10, 3, 6, 3, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                     (1) | Train Loss: 0.5857 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.6828 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4664 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.4376 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.4410 | Train Acc: 0.8143
 Site-MNIST                     (1) | Train Loss: 0.5298 | Train Acc: 0.8413
 Site-MNIST                     (1) | Train Loss: 0.4584 | Train Acc: 0.8987
 Site-MNIST                     (1) | Train Loss: 0.5591 | Train Acc: 0.8606
 Site-MNIST                     (1) | Train Loss: 0.5264 | Train Acc: 0.8709
 Site-MNIST                     (1) | Train Loss: 0.5059 | Train Acc: 0.8898
 Site-USPS                      (3) | Train Loss: 0.5096 | Train Acc: 0.8000
 Site-USPS                      (3) | Train Loss: 0.4376 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.5871 | Train Acc: 0.8527
 Site-USPS                      (3) | Train Loss: 0.6195 | Train Acc: 0.8369
 Site-USPS                      (3) | Train Loss: 0.5595 | Train Acc: 0.8667
 Site-USPS                      (3) | Train Loss: 0.5743 | Train Acc: 0.8690
 Site-SynthDigits               (2) | Train Loss: 1.2020 | Train Acc: 0.6424
 Site-SynthDigits               (2) | Train Loss: 1.1100 | Train Acc: 0.6593
 Site-SynthDigits               (2) | Train Loss: 1.0635 | Train Acc: 0.7047
 Site-MNIST_M                   (0) | Train Loss: 1.4329 | Train Acc: 0.5525
 Site-MNIST_M                   (0) | Train Loss: 1.3655 | Train Acc: 0.6208
 Site-SVHN                      (0) | Train Loss: 1.6509 | Train Acc: 0.4113
Average Train Accuracy: 0.7901
 Site-MNIST                     (1) | Val  Loss: 0.1507 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.1681 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4768 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.6650 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.6027 | Val  Acc: 0.8235
 Site-MNIST                     (1) | Val  Loss: 0.5626 | Val  Acc: 0.8710
 Site-MNIST                     (1) | Val  Loss: 0.4880 | Val  Acc: 0.9107
 Site-MNIST                     (1) | Val  Loss: 0.4951 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.5677 | Val  Acc: 0.8689
 Site-MNIST                     (1) | Val  Loss: 0.5361 | Val  Acc: 0.8671
 Site-USPS                      (3) | Val  Loss: 0.3855 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.8174 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.8581 | Val  Acc: 0.6562
 Site-USPS                      (3) | Val  Loss: 0.7720 | Val  Acc: 0.7586
 Site-USPS                      (3) | Val  Loss: 0.6374 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.5558 | Val  Acc: 0.8730
 Site-SynthDigits               (2) | Val  Loss: 1.1801 | Val  Acc: 0.7027
 Site-SynthDigits               (2) | Val  Loss: 1.0947 | Val  Acc: 0.7500
 Site-SynthDigits               (2) | Val  Loss: 1.0854 | Val  Acc: 0.6967
 Site-MNIST_M                   (0) | Val  Loss: 1.5099 | Val  Acc: 0.5111
 Site-MNIST_M                   (0) | Val  Loss: 1.4253 | Val  Acc: 0.6420
 Site-SVHN                      (0) | Val  Loss: 1.5287 | Val  Acc: 0.4571
Average Valid Accuracy: 0.7859
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8235
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8710
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.9107
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8689
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8671
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.6562
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.7586
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8190
 Best site-USPS                     (3)  | Epoch:9 | Val Acc: 0.8730
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7027
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.7500
 Best site-SynthDigits              (2)  | Epoch:9 | Val Acc: 0.6967
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.5111
 Best site-MNIST_M                  (0)  | Epoch:9 | Val Acc: 0.6420
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.4571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 10 ============
cnt=[6, 3, 3, 10, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                     (3) | Train Loss: 0.5738 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.6931 | Train Acc: 0.8333
 Site-MNIST                     (3) | Train Loss: 0.4641 | Train Acc: 0.8571
 Site-MNIST                     (3) | Train Loss: 0.4170 | Train Acc: 0.9211
 Site-MNIST                     (3) | Train Loss: 0.5649 | Train Acc: 0.8143
 Site-MNIST                     (3) | Train Loss: 0.5147 | Train Acc: 0.8413
 Site-MNIST                     (3) | Train Loss: 0.4227 | Train Acc: 0.9031
 Site-MNIST                     (3) | Train Loss: 0.5524 | Train Acc: 0.8729
 Site-MNIST                     (3) | Train Loss: 0.5211 | Train Acc: 0.8696
 Site-MNIST                     (3) | Train Loss: 0.4876 | Train Acc: 0.8868
 Site-USPS                      (0) | Train Loss: 0.4745 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.4139 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.4087 | Train Acc: 0.8837
 Site-USPS                      (0) | Train Loss: 0.5843 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.5283 | Train Acc: 0.8690
 Site-USPS                      (0) | Train Loss: 0.5339 | Train Acc: 0.8704
 Site-SynthDigits               (1) | Train Loss: 1.1749 | Train Acc: 0.6623
 Site-SynthDigits               (1) | Train Loss: 1.0773 | Train Acc: 0.6703
 Site-SynthDigits               (1) | Train Loss: 1.0131 | Train Acc: 0.7169
 Site-MNIST_M                   (2) | Train Loss: 1.3843 | Train Acc: 0.5856
 Site-MNIST_M                   (2) | Train Loss: 1.2657 | Train Acc: 0.6269
 Site-SVHN                      (2) | Train Loss: 1.6211 | Train Acc: 0.4504
Average Train Accuracy: 0.7997
 Site-MNIST                     (3) | Val  Loss: 0.1203 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.1432 | Val  Acc: 1.0000
 Site-MNIST                     (3) | Val  Loss: 0.4648 | Val  Acc: 0.8000
 Site-MNIST                     (3) | Val  Loss: 0.6322 | Val  Acc: 0.7778
 Site-MNIST                     (3) | Val  Loss: 0.5762 | Val  Acc: 0.8235
 Site-MNIST                     (3) | Val  Loss: 0.5356 | Val  Acc: 0.8710
 Site-MNIST                     (3) | Val  Loss: 0.4762 | Val  Acc: 0.8929
 Site-MNIST                     (3) | Val  Loss: 0.4804 | Val  Acc: 0.8824
 Site-MNIST                     (3) | Val  Loss: 0.5485 | Val  Acc: 0.8634
 Site-MNIST                     (3) | Val  Loss: 0.5167 | Val  Acc: 0.8761
 Site-USPS                      (0) | Val  Loss: 0.3537 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.7786 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.8196 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.7500 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.6094 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.5221 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 1.1137 | Val  Acc: 0.7297
 Site-SynthDigits               (1) | Val  Loss: 1.0295 | Val  Acc: 0.7647
 Site-SynthDigits               (1) | Val  Loss: 1.0109 | Val  Acc: 0.7377
 Site-MNIST_M                   (2) | Val  Loss: 1.4451 | Val  Acc: 0.6222
 Site-MNIST_M                   (2) | Val  Loss: 1.3534 | Val  Acc: 0.6790
 Site-SVHN                      (2) | Val  Loss: 1.4229 | Val  Acc: 0.4857
Average Valid Accuracy: 0.8012
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 1.0000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8000
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.7778
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8235
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8710
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8929
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8824
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8634
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8761
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7297
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7647
 Best site-SynthDigits              (1)  | Epoch:10 | Val Acc: 0.7377
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.6222
 Best site-MNIST_M                  (2)  | Epoch:10 | Val Acc: 0.6790
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.4857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 11 ============
cnt=[3, 6, 10, 3, ]
cnt=[2, 10, 6, 4, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                     (2) | Train Loss: 0.5751 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.6348 | Train Acc: 0.8333
 Site-MNIST                     (2) | Train Loss: 0.4228 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.3734 | Train Acc: 0.8947
 Site-MNIST                     (2) | Train Loss: 0.7781 | Train Acc: 0.8429
 Site-MNIST                     (2) | Train Loss: 0.4603 | Train Acc: 0.8571
 Site-MNIST                     (2) | Train Loss: 0.4139 | Train Acc: 0.9163
 Site-MNIST                     (2) | Train Loss: 0.4903 | Train Acc: 0.8753
 Site-MNIST                     (2) | Train Loss: 0.4801 | Train Acc: 0.8927
 Site-MNIST                     (2) | Train Loss: 0.4484 | Train Acc: 0.8974
 Site-USPS                      (1) | Train Loss: 0.4851 | Train Acc: 0.8250
 Site-USPS                      (1) | Train Loss: 0.5168 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3884 | Train Acc: 0.8837
 Site-USPS                      (1) | Train Loss: 0.5677 | Train Acc: 0.8412
 Site-USPS                      (1) | Train Loss: 0.4987 | Train Acc: 0.8762
 Site-USPS                      (1) | Train Loss: 0.5275 | Train Acc: 0.8783
 Site-SynthDigits               (3) | Train Loss: 1.0724 | Train Acc: 0.6887
 Site-SynthDigits               (3) | Train Loss: 1.0040 | Train Acc: 0.6996
 Site-SynthDigits               (3) | Train Loss: 0.9489 | Train Acc: 0.7515
 Site-MNIST_M                   (0) | Train Loss: 1.3196 | Train Acc: 0.6022
 Site-MNIST_M                   (0) | Train Loss: 1.2720 | Train Acc: 0.6453
 Site-SVHN                      (0) | Train Loss: 1.5315 | Train Acc: 0.4681
Average Train Accuracy: 0.8093
 Site-MNIST                     (2) | Val  Loss: 0.1127 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.1337 | Val  Acc: 1.0000
 Site-MNIST                     (2) | Val  Loss: 0.4557 | Val  Acc: 0.8000
 Site-MNIST                     (2) | Val  Loss: 0.6080 | Val  Acc: 0.7778
 Site-MNIST                     (2) | Val  Loss: 0.5364 | Val  Acc: 0.8824
 Site-MNIST                     (2) | Val  Loss: 0.4922 | Val  Acc: 0.9032
 Site-MNIST                     (2) | Val  Loss: 0.4376 | Val  Acc: 0.9286
 Site-MNIST                     (2) | Val  Loss: 0.4448 | Val  Acc: 0.9020
 Site-MNIST                     (2) | Val  Loss: 0.5045 | Val  Acc: 0.8743
 Site-MNIST                     (2) | Val  Loss: 0.4792 | Val  Acc: 0.8792
 Site-USPS                      (1) | Val  Loss: 0.3576 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.8017 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.8362 | Val  Acc: 0.6875
 Site-USPS                      (1) | Val  Loss: 0.7292 | Val  Acc: 0.7414
 Site-USPS                      (1) | Val  Loss: 0.5959 | Val  Acc: 0.8190
 Site-USPS                      (1) | Val  Loss: 0.5148 | Val  Acc: 0.8730
 Site-SynthDigits               (3) | Val  Loss: 1.0569 | Val  Acc: 0.7568
 Site-SynthDigits               (3) | Val  Loss: 0.9620 | Val  Acc: 0.7794
 Site-SynthDigits               (3) | Val  Loss: 0.9592 | Val  Acc: 0.7459
 Site-MNIST_M                   (0) | Val  Loss: 1.4027 | Val  Acc: 0.5778
 Site-MNIST_M                   (0) | Val  Loss: 1.3029 | Val  Acc: 0.6667
 Site-SVHN                      (0) | Val  Loss: 1.3417 | Val  Acc: 0.5000
Average Valid Accuracy: 0.8053
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 1.0000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8000
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.7778
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8824
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.9032
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.9286
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.9020
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8743
 Best site-MNIST                    (2)  | Epoch:11 | Val Acc: 0.8792
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.6875
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.7414
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8190
 Best site-USPS                     (1)  | Epoch:11 | Val Acc: 0.8730
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7568
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7794
 Best site-SynthDigits              (3)  | Epoch:11 | Val Acc: 0.7459
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.5778
 Best site-MNIST_M                  (0)  | Epoch:11 | Val Acc: 0.6667
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.5000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 12 ============
cnt=[10, 3, 3, 6, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                     (0) | Train Loss: 0.5725 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5947 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4069 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3556 | Train Acc: 0.8947
 Site-MNIST                     (0) | Train Loss: 0.4931 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4408 | Train Acc: 0.8651
 Site-MNIST                     (0) | Train Loss: 0.3667 | Train Acc: 0.9163
 Site-MNIST                     (0) | Train Loss: 0.4657 | Train Acc: 0.8778
 Site-MNIST                     (0) | Train Loss: 0.4533 | Train Acc: 0.8913
 Site-MNIST                     (0) | Train Loss: 0.4255 | Train Acc: 0.9019
 Site-USPS                      (3) | Train Loss: 0.4681 | Train Acc: 0.8500
 Site-USPS                      (3) | Train Loss: 0.4489 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.5271 | Train Acc: 0.8682
 Site-USPS                      (3) | Train Loss: 0.5596 | Train Acc: 0.8412
 Site-USPS                      (3) | Train Loss: 0.4893 | Train Acc: 0.8810
 Site-USPS                      (3) | Train Loss: 0.5003 | Train Acc: 0.8770
 Site-SynthDigits               (2) | Train Loss: 1.0395 | Train Acc: 0.7020
 Site-SynthDigits               (2) | Train Loss: 0.9395 | Train Acc: 0.7326
 Site-SynthDigits               (2) | Train Loss: 0.9028 | Train Acc: 0.7597
 Site-MNIST_M                   (1) | Train Loss: 1.2501 | Train Acc: 0.6354
 Site-MNIST_M                   (1) | Train Loss: 1.3216 | Train Acc: 0.6453
 Site-SVHN                      (1) | Train Loss: 1.4842 | Train Acc: 0.5142
Average Train Accuracy: 0.8153
 Site-MNIST                     (0) | Val  Loss: 0.0809 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1199 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4601 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.6044 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.5198 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4702 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.4187 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.4263 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.4816 | Val  Acc: 0.8743
 Site-MNIST                     (0) | Val  Loss: 0.4582 | Val  Acc: 0.8852
 Site-USPS                      (3) | Val  Loss: 0.3323 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7660 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7956 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.6959 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.5724 | Val  Acc: 0.8381
 Site-USPS                      (3) | Val  Loss: 0.4922 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.9951 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.8932 | Val  Acc: 0.7794
 Site-SynthDigits               (2) | Val  Loss: 0.9176 | Val  Acc: 0.7541
 Site-MNIST_M                   (1) | Val  Loss: 1.3233 | Val  Acc: 0.6444
 Site-MNIST_M                   (1) | Val  Loss: 1.2204 | Val  Acc: 0.6914
 Site-SVHN                      (1) | Val  Loss: 1.2994 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8195
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8743
 Best site-MNIST                    (0)  | Epoch:12 | Val Acc: 0.8852
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.7931
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8381
 Best site-USPS                     (3)  | Epoch:12 | Val Acc: 0.8783
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.7794
 Best site-SynthDigits              (2)  | Epoch:12 | Val Acc: 0.7541
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.6444
 Best site-MNIST_M                  (1)  | Epoch:12 | Val Acc: 0.6914
 Best site-SVHN                     (1)  | Epoch:12 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 13 ============
cnt=[10, 3, 3, 6, ]
cnt=[10, 1, 9, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                     (0) | Train Loss: 0.5666 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.6010 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4027 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3451 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.3531 | Train Acc: 0.8429
 Site-MNIST                     (0) | Train Loss: 0.4320 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3698 | Train Acc: 0.9119
 Site-MNIST                     (0) | Train Loss: 0.5012 | Train Acc: 0.8802
 Site-MNIST                     (0) | Train Loss: 0.4475 | Train Acc: 0.8886
 Site-MNIST                     (0) | Train Loss: 0.4148 | Train Acc: 0.9004
 Site-USPS                      (3) | Train Loss: 0.4228 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.3725 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.3254 | Train Acc: 0.8682
 Site-USPS                      (3) | Train Loss: 0.5209 | Train Acc: 0.8455
 Site-USPS                      (3) | Train Loss: 0.4571 | Train Acc: 0.8786
 Site-USPS                      (3) | Train Loss: 0.4646 | Train Acc: 0.8862
 Site-SynthDigits               (2) | Train Loss: 0.9722 | Train Acc: 0.7086
 Site-SynthDigits               (2) | Train Loss: 0.9328 | Train Acc: 0.7216
 Site-SynthDigits               (2) | Train Loss: 0.8569 | Train Acc: 0.7760
 Site-MNIST_M                   (1) | Train Loss: 1.2133 | Train Acc: 0.6685
 Site-MNIST_M                   (1) | Train Loss: 1.2140 | Train Acc: 0.6697
 Site-SVHN                      (1) | Train Loss: 1.4329 | Train Acc: 0.5248
Average Train Accuracy: 0.8224
 Site-MNIST                     (0) | Val  Loss: 0.0691 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.1062 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4374 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5754 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4968 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4504 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.4091 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.4147 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4719 | Val  Acc: 0.8743
 Site-MNIST                     (0) | Val  Loss: 0.4459 | Val  Acc: 0.8852
 Site-USPS                      (3) | Val  Loss: 0.3066 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7231 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7527 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.6709 | Val  Acc: 0.7759
 Site-USPS                      (3) | Val  Loss: 0.5454 | Val  Acc: 0.8381
 Site-USPS                      (3) | Val  Loss: 0.4600 | Val  Acc: 0.8889
 Site-SynthDigits               (2) | Val  Loss: 0.9410 | Val  Acc: 0.7838
 Site-SynthDigits               (2) | Val  Loss: 0.8567 | Val  Acc: 0.7794
 Site-SynthDigits               (2) | Val  Loss: 0.8754 | Val  Acc: 0.7787
 Site-MNIST_M                   (1) | Val  Loss: 1.2897 | Val  Acc: 0.6889
 Site-MNIST_M                   (1) | Val  Loss: 1.1732 | Val  Acc: 0.7407
 Site-SVHN                      (1) | Val  Loss: 1.2474 | Val  Acc: 0.5714
Average Valid Accuracy: 0.8214
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.9107
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8743
 Best site-MNIST                    (0)  | Epoch:13 | Val Acc: 0.8852
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.6875
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.7759
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8381
 Best site-USPS                     (3)  | Epoch:13 | Val Acc: 0.8889
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7838
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7794
 Best site-SynthDigits              (2)  | Epoch:13 | Val Acc: 0.7787
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.6889
 Best site-MNIST_M                  (1)  | Epoch:13 | Val Acc: 0.7407
 Best site-SVHN                     (1)  | Epoch:13 | Val Acc: 0.5714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 14 ============
cnt=[10, 3, 3, 6, ]
cnt=[1, 1, 9, 11, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                     (0) | Train Loss: 0.5658 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5844 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3922 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3214 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.5625 | Train Acc: 0.8286
 Site-MNIST                     (0) | Train Loss: 0.4055 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3517 | Train Acc: 0.9207
 Site-MNIST                     (0) | Train Loss: 0.4367 | Train Acc: 0.8900
 Site-MNIST                     (0) | Train Loss: 0.4224 | Train Acc: 0.8940
 Site-MNIST                     (0) | Train Loss: 0.3887 | Train Acc: 0.9011
 Site-USPS                      (3) | Train Loss: 0.4172 | Train Acc: 0.8500
 Site-USPS                      (3) | Train Loss: 0.4302 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.3369 | Train Acc: 0.8915
 Site-USPS                      (3) | Train Loss: 0.5046 | Train Acc: 0.8541
 Site-USPS                      (3) | Train Loss: 0.4392 | Train Acc: 0.8929
 Site-USPS                      (3) | Train Loss: 0.4583 | Train Acc: 0.8929
 Site-SynthDigits               (2) | Train Loss: 1.0354 | Train Acc: 0.7152
 Site-SynthDigits               (2) | Train Loss: 0.8839 | Train Acc: 0.7509
 Site-SynthDigits               (2) | Train Loss: 0.8289 | Train Acc: 0.7923
 Site-MNIST_M                   (1) | Train Loss: 1.1907 | Train Acc: 0.6464
 Site-MNIST_M                   (1) | Train Loss: 1.1975 | Train Acc: 0.6881
 Site-SVHN                      (1) | Train Loss: 1.4210 | Train Acc: 0.5355
Average Train Accuracy: 0.8268
 Site-MNIST                     (0) | Val  Loss: 0.0594 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0961 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4543 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5829 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4828 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4200 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3789 | Val  Acc: 0.9107
 Site-MNIST                     (0) | Val  Loss: 0.3882 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.4464 | Val  Acc: 0.8962
 Site-MNIST                     (0) | Val  Loss: 0.4229 | Val  Acc: 0.8973
 Site-USPS                      (3) | Val  Loss: 0.2796 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7138 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7561 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.6634 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.5379 | Val  Acc: 0.8286
 Site-USPS                      (3) | Val  Loss: 0.4508 | Val  Acc: 0.8783
 Site-SynthDigits               (2) | Val  Loss: 0.9027 | Val  Acc: 0.7568
 Site-SynthDigits               (2) | Val  Loss: 0.8186 | Val  Acc: 0.8088
 Site-SynthDigits               (2) | Val  Loss: 0.8454 | Val  Acc: 0.7787
 Site-MNIST_M                   (1) | Val  Loss: 1.2449 | Val  Acc: 0.6444
 Site-MNIST_M                   (1) | Val  Loss: 1.1296 | Val  Acc: 0.7037
 Site-SVHN                      (1) | Val  Loss: 1.1857 | Val  Acc: 0.5857
Average Valid Accuracy: 0.8199
============ Train epoch 15 ============
cnt=[3, 10, 3, 6, ]
cnt=[2, 10, 6, 4, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                     (1) | Train Loss: 0.5506 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.5449 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3562 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.2925 | Train Acc: 0.9211
 Site-MNIST                     (1) | Train Loss: 0.6036 | Train Acc: 0.8571
 Site-MNIST                     (1) | Train Loss: 0.3710 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.3284 | Train Acc: 0.9251
 Site-MNIST                     (1) | Train Loss: 0.4117 | Train Acc: 0.8949
 Site-MNIST                     (1) | Train Loss: 0.3952 | Train Acc: 0.8981
 Site-MNIST                     (1) | Train Loss: 0.3639 | Train Acc: 0.9140
 Site-USPS                      (3) | Train Loss: 0.4262 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.6297 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.3342 | Train Acc: 0.8992
 Site-USPS                      (3) | Train Loss: 0.5052 | Train Acc: 0.8455
 Site-USPS                      (3) | Train Loss: 0.4411 | Train Acc: 0.8881
 Site-USPS                      (3) | Train Loss: 0.4551 | Train Acc: 0.8902
 Site-SynthDigits               (0) | Train Loss: 0.8764 | Train Acc: 0.7285
 Site-SynthDigits               (0) | Train Loss: 0.8229 | Train Acc: 0.7582
 Site-SynthDigits               (0) | Train Loss: 0.7776 | Train Acc: 0.8024
 Site-MNIST_M                   (2) | Train Loss: 1.1271 | Train Acc: 0.6796
 Site-MNIST_M                   (2) | Train Loss: 1.0279 | Train Acc: 0.6911
 Site-SVHN                      (2) | Train Loss: 1.3712 | Train Acc: 0.5532
Average Train Accuracy: 0.8355
 Site-MNIST                     (1) | Val  Loss: 0.0512 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0827 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4446 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5572 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4549 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.4013 | Val  Acc: 0.9032
 Site-MNIST                     (1) | Val  Loss: 0.3608 | Val  Acc: 0.9286
 Site-MNIST                     (1) | Val  Loss: 0.3689 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.4180 | Val  Acc: 0.9016
 Site-MNIST                     (1) | Val  Loss: 0.3984 | Val  Acc: 0.9063
 Site-USPS                      (3) | Val  Loss: 0.2911 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7276 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7635 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.6552 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.5387 | Val  Acc: 0.8286
 Site-USPS                      (3) | Val  Loss: 0.4512 | Val  Acc: 0.8730
 Site-SynthDigits               (0) | Val  Loss: 0.8685 | Val  Acc: 0.7838
 Site-SynthDigits               (0) | Val  Loss: 0.7479 | Val  Acc: 0.8235
 Site-SynthDigits               (0) | Val  Loss: 0.8118 | Val  Acc: 0.7869
 Site-MNIST_M                   (2) | Val  Loss: 1.1819 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.0706 | Val  Acc: 0.7407
 Site-SVHN                      (2) | Val  Loss: 1.1203 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8291
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9032
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9286
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9020
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9016
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9063
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.7931
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8286
 Best site-USPS                     (3)  | Epoch:15 | Val Acc: 0.8730
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7838
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8235
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.7869
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.6667
 Best site-MNIST_M                  (2)  | Epoch:15 | Val Acc: 0.7407
 Best site-SVHN                     (2)  | Epoch:15 | Val Acc: 0.6000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 16 ============
cnt=[10, 3, 3, 6, ]
cnt=[1, 10, 9, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                     (0) | Train Loss: 0.5483 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5178 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3156 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2674 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.3613 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3321 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2962 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.3739 | Train Acc: 0.9046
 Site-MNIST                     (0) | Train Loss: 0.3697 | Train Acc: 0.9076
 Site-MNIST                     (0) | Train Loss: 0.3368 | Train Acc: 0.9223
 Site-USPS                      (3) | Train Loss: 0.4201 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.3635 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.3768 | Train Acc: 0.8915
 Site-USPS                      (3) | Train Loss: 0.4863 | Train Acc: 0.8455
 Site-USPS                      (3) | Train Loss: 0.4181 | Train Acc: 0.8929
 Site-USPS                      (3) | Train Loss: 0.4387 | Train Acc: 0.8915
 Site-SynthDigits               (1) | Train Loss: 0.9433 | Train Acc: 0.7285
 Site-SynthDigits               (1) | Train Loss: 0.8257 | Train Acc: 0.7619
 Site-SynthDigits               (1) | Train Loss: 0.7466 | Train Acc: 0.8228
 Site-MNIST_M                   (2) | Train Loss: 1.1102 | Train Acc: 0.6575
 Site-MNIST_M                   (2) | Train Loss: 1.0664 | Train Acc: 0.6942
 Site-SVHN                      (2) | Train Loss: 1.3114 | Train Acc: 0.5674
Average Train Accuracy: 0.8403
 Site-MNIST                     (0) | Val  Loss: 0.0502 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0751 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4356 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5494 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4313 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3705 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3299 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3386 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3878 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3708 | Val  Acc: 0.9094
 Site-USPS                      (3) | Val  Loss: 0.2715 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.7313 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.7670 | Val  Acc: 0.6875
 Site-USPS                      (3) | Val  Loss: 0.6432 | Val  Acc: 0.7931
 Site-USPS                      (3) | Val  Loss: 0.5225 | Val  Acc: 0.8190
 Site-USPS                      (3) | Val  Loss: 0.4356 | Val  Acc: 0.8677
 Site-SynthDigits               (1) | Val  Loss: 0.8340 | Val  Acc: 0.7838
 Site-SynthDigits               (1) | Val  Loss: 0.7206 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.7803 | Val  Acc: 0.7869
 Site-MNIST_M                   (2) | Val  Loss: 1.1827 | Val  Acc: 0.6667
 Site-MNIST_M                   (2) | Val  Loss: 1.0545 | Val  Acc: 0.7284
 Site-SVHN                      (2) | Val  Loss: 1.0941 | Val  Acc: 0.6000
Average Valid Accuracy: 0.8270
============ Train epoch 17 ============
cnt=[10, 6, 3, 3, ]
cnt=[6, 2, 10, 4, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                     (0) | Train Loss: 0.5496 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.5094 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3251 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2617 | Train Acc: 0.9211
 Site-MNIST                     (0) | Train Loss: 0.3562 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.3334 | Train Acc: 0.9127
 Site-MNIST                     (0) | Train Loss: 0.2839 | Train Acc: 0.9295
 Site-MNIST                     (0) | Train Loss: 0.3795 | Train Acc: 0.9046
 Site-MNIST                     (0) | Train Loss: 0.3630 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3319 | Train Acc: 0.9200
 Site-USPS                      (1) | Train Loss: 0.3715 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.3859 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.3977 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.4683 | Train Acc: 0.8627
 Site-USPS                      (1) | Train Loss: 0.3940 | Train Acc: 0.9024
 Site-USPS                      (1) | Train Loss: 0.4079 | Train Acc: 0.8955
 Site-SynthDigits               (3) | Train Loss: 0.8300 | Train Acc: 0.7550
 Site-SynthDigits               (3) | Train Loss: 0.7753 | Train Acc: 0.7875
 Site-SynthDigits               (3) | Train Loss: 0.7201 | Train Acc: 0.8269
 Site-MNIST_M                   (2) | Train Loss: 1.0723 | Train Acc: 0.6851
 Site-MNIST_M                   (2) | Train Loss: 1.0134 | Train Acc: 0.7064
 Site-SVHN                      (2) | Train Loss: 1.3276 | Train Acc: 0.5745
Average Train Accuracy: 0.8462
 Site-MNIST                     (0) | Val  Loss: 0.0401 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4455 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5511 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4256 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3620 | Val  Acc: 0.9032
 Site-MNIST                     (0) | Val  Loss: 0.3256 | Val  Acc: 0.9286
 Site-MNIST                     (0) | Val  Loss: 0.3348 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3843 | Val  Acc: 0.9071
 Site-MNIST                     (0) | Val  Loss: 0.3657 | Val  Acc: 0.9124
 Site-USPS                      (1) | Val  Loss: 0.2463 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6821 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.7149 | Val  Acc: 0.6875
 Site-USPS                      (1) | Val  Loss: 0.6182 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.4976 | Val  Acc: 0.8381
 Site-USPS                      (1) | Val  Loss: 0.4113 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.7801 | Val  Acc: 0.7568
 Site-SynthDigits               (3) | Val  Loss: 0.6565 | Val  Acc: 0.7941
 Site-SynthDigits               (3) | Val  Loss: 0.7392 | Val  Acc: 0.8115
 Site-MNIST_M                   (2) | Val  Loss: 1.1482 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 1.0208 | Val  Acc: 0.7654
 Site-SVHN                      (2) | Val  Loss: 1.0609 | Val  Acc: 0.6286
Average Valid Accuracy: 0.8308
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9032
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9286
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9071
 Best site-MNIST                    (0)  | Epoch:17 | Val Acc: 0.9124
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.6875
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.7931
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8381
 Best site-USPS                     (1)  | Epoch:17 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7568
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.7941
 Best site-SynthDigits              (3)  | Epoch:17 | Val Acc: 0.8115
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.6889
 Best site-MNIST_M                  (2)  | Epoch:17 | Val Acc: 0.7654
 Best site-SVHN                     (2)  | Epoch:17 | Val Acc: 0.6286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 18 ============
cnt=[6, 10, 3, 3, ]
cnt=[10, 6, 2, 4, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                     (1) | Train Loss: 0.5248 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4896 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2995 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2500 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.3331 | Train Acc: 0.8714
 Site-MNIST                     (1) | Train Loss: 0.3099 | Train Acc: 0.9127
 Site-MNIST                     (1) | Train Loss: 0.2766 | Train Acc: 0.9383
 Site-MNIST                     (1) | Train Loss: 0.3501 | Train Acc: 0.9095
 Site-MNIST                     (1) | Train Loss: 0.3475 | Train Acc: 0.9117
 Site-MNIST                     (1) | Train Loss: 0.3109 | Train Acc: 0.9238
 Site-USPS                      (0) | Train Loss: 0.3758 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.4346 | Train Acc: 0.9444
 Site-USPS                      (0) | Train Loss: 0.3443 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.4549 | Train Acc: 0.8498
 Site-USPS                      (0) | Train Loss: 0.3830 | Train Acc: 0.9000
 Site-USPS                      (0) | Train Loss: 0.4076 | Train Acc: 0.8942
 Site-SynthDigits               (3) | Train Loss: 0.8520 | Train Acc: 0.7815
 Site-SynthDigits               (3) | Train Loss: 0.7576 | Train Acc: 0.7875
 Site-SynthDigits               (3) | Train Loss: 0.6907 | Train Acc: 0.8289
 Site-MNIST_M                   (2) | Train Loss: 1.0254 | Train Acc: 0.6961
 Site-MNIST_M                   (2) | Train Loss: 1.0547 | Train Acc: 0.7034
 Site-SVHN                      (2) | Train Loss: 1.3049 | Train Acc: 0.5957
Average Train Accuracy: 0.8530
 Site-MNIST                     (1) | Val  Loss: 0.0351 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0620 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4470 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5416 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.4092 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.3422 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.3074 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.3163 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3664 | Val  Acc: 0.9126
 Site-MNIST                     (1) | Val  Loss: 0.3472 | Val  Acc: 0.9215
 Site-USPS                      (0) | Val  Loss: 0.2483 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6859 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.7183 | Val  Acc: 0.6875
 Site-USPS                      (0) | Val  Loss: 0.6151 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4934 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.4039 | Val  Acc: 0.8783
 Site-SynthDigits               (3) | Val  Loss: 0.7532 | Val  Acc: 0.7838
 Site-SynthDigits               (3) | Val  Loss: 0.6303 | Val  Acc: 0.8088
 Site-SynthDigits               (3) | Val  Loss: 0.7229 | Val  Acc: 0.8197
 Site-MNIST_M                   (2) | Val  Loss: 1.1016 | Val  Acc: 0.7111
 Site-MNIST_M                   (2) | Val  Loss: 0.9742 | Val  Acc: 0.7778
 Site-SVHN                      (2) | Val  Loss: 1.0313 | Val  Acc: 0.6571
Average Valid Accuracy: 0.8389
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9126
 Best site-MNIST                    (1)  | Epoch:18 | Val Acc: 0.9215
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.6875
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8286
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8783
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.7838
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8088
 Best site-SynthDigits              (3)  | Epoch:18 | Val Acc: 0.8197
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7111
 Best site-MNIST_M                  (2)  | Epoch:18 | Val Acc: 0.7778
 Best site-SVHN                     (2)  | Epoch:18 | Val Acc: 0.6571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 19 ============
cnt=[10, 3, 6, 3, ]
cnt=[1, 10, 9, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                     (0) | Train Loss: 0.5534 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4979 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3202 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2507 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.2408 | Train Acc: 0.8714
 Site-MNIST                     (0) | Train Loss: 0.3177 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2840 | Train Acc: 0.9251
 Site-MNIST                     (0) | Train Loss: 0.3588 | Train Acc: 0.8998
 Site-MNIST                     (0) | Train Loss: 0.3488 | Train Acc: 0.9090
 Site-MNIST                     (0) | Train Loss: 0.3125 | Train Acc: 0.9192
 Site-USPS                      (2) | Train Loss: 0.3603 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.3690 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2740 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.4406 | Train Acc: 0.8627
 Site-USPS                      (2) | Train Loss: 0.3699 | Train Acc: 0.9119
 Site-USPS                      (2) | Train Loss: 0.3860 | Train Acc: 0.9048
 Site-SynthDigits               (1) | Train Loss: 0.8515 | Train Acc: 0.7748
 Site-SynthDigits               (1) | Train Loss: 0.7726 | Train Acc: 0.8022
 Site-SynthDigits               (1) | Train Loss: 0.6703 | Train Acc: 0.8391
 Site-MNIST_M                   (3) | Train Loss: 1.0109 | Train Acc: 0.6851
 Site-MNIST_M                   (3) | Train Loss: 0.9474 | Train Acc: 0.7003
 Site-SVHN                      (3) | Train Loss: 1.2665 | Train Acc: 0.5957
Average Train Accuracy: 0.8509
 Site-MNIST                     (0) | Val  Loss: 0.0289 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0596 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4608 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5513 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.4153 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3409 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.3091 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3188 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3661 | Val  Acc: 0.9126
 Site-MNIST                     (0) | Val  Loss: 0.3493 | Val  Acc: 0.9094
 Site-USPS                      (2) | Val  Loss: 0.2210 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.6472 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6819 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5943 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.4758 | Val  Acc: 0.8571
 Site-USPS                      (2) | Val  Loss: 0.3874 | Val  Acc: 0.8995
 Site-SynthDigits               (1) | Val  Loss: 0.7339 | Val  Acc: 0.8108
 Site-SynthDigits               (1) | Val  Loss: 0.5973 | Val  Acc: 0.8235
 Site-SynthDigits               (1) | Val  Loss: 0.6872 | Val  Acc: 0.8361
 Site-MNIST_M                   (3) | Val  Loss: 1.0683 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9525 | Val  Acc: 0.7778
 Site-SVHN                      (3) | Val  Loss: 0.9828 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8457
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9020
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9126
 Best site-MNIST                    (0)  | Epoch:19 | Val Acc: 0.9094
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8571
 Best site-USPS                     (2)  | Epoch:19 | Val Acc: 0.8995
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8108
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8235
 Best site-SynthDigits              (1)  | Epoch:19 | Val Acc: 0.8361
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7111
 Best site-MNIST_M                  (3)  | Epoch:19 | Val Acc: 0.7778
 Best site-SVHN                     (3)  | Epoch:19 | Val Acc: 0.6714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 20 ============
cnt=[10, 6, 3, 3, ]
cnt=[2, 6, 8, 6, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                     (0) | Train Loss: 0.5606 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4665 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2945 | Train Acc: 0.8571
 Site-MNIST                     (0) | Train Loss: 0.2302 | Train Acc: 0.9474
 Site-MNIST                     (0) | Train Loss: 0.4826 | Train Acc: 0.8714
 Site-MNIST                     (0) | Train Loss: 0.2948 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2689 | Train Acc: 0.9339
 Site-MNIST                     (0) | Train Loss: 0.3234 | Train Acc: 0.9095
 Site-MNIST                     (0) | Train Loss: 0.3342 | Train Acc: 0.9158
 Site-MNIST                     (0) | Train Loss: 0.2977 | Train Acc: 0.9291
 Site-USPS                      (1) | Train Loss: 0.3540 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.4366 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.2733 | Train Acc: 0.9147
 Site-USPS                      (1) | Train Loss: 0.4427 | Train Acc: 0.8584
 Site-USPS                      (1) | Train Loss: 0.3666 | Train Acc: 0.9071
 Site-USPS                      (1) | Train Loss: 0.3795 | Train Acc: 0.8995
 Site-SynthDigits               (3) | Train Loss: 0.7216 | Train Acc: 0.7748
 Site-SynthDigits               (3) | Train Loss: 0.7050 | Train Acc: 0.8315
 Site-SynthDigits               (3) | Train Loss: 0.6553 | Train Acc: 0.8595
 Site-MNIST_M                   (2) | Train Loss: 1.0063 | Train Acc: 0.7017
 Site-MNIST_M                   (2) | Train Loss: 0.9690 | Train Acc: 0.7278
 Site-SVHN                      (2) | Train Loss: 1.2264 | Train Acc: 0.6099
Average Train Accuracy: 0.8568
 Site-MNIST                     (0) | Val  Loss: 0.0273 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0556 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4568 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5425 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3979 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3265 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2930 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.3043 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.3480 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3328 | Val  Acc: 0.9215
 Site-USPS                      (1) | Val  Loss: 0.2165 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6408 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.6780 | Val  Acc: 0.7188
 Site-USPS                      (1) | Val  Loss: 0.5832 | Val  Acc: 0.8103
 Site-USPS                      (1) | Val  Loss: 0.4693 | Val  Acc: 0.8476
 Site-USPS                      (1) | Val  Loss: 0.3819 | Val  Acc: 0.8942
 Site-SynthDigits               (3) | Val  Loss: 0.7029 | Val  Acc: 0.8649
 Site-SynthDigits               (3) | Val  Loss: 0.5686 | Val  Acc: 0.8676
 Site-SynthDigits               (3) | Val  Loss: 0.6643 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 1.0570 | Val  Acc: 0.6889
 Site-MNIST_M                   (2) | Val  Loss: 0.9380 | Val  Acc: 0.7778
 Site-SVHN                      (2) | Val  Loss: 0.9390 | Val  Acc: 0.7000
Average Valid Accuracy: 0.8518
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9180
 Best site-MNIST                    (0)  | Epoch:20 | Val Acc: 0.9215
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.7222
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.7188
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8103
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8476
 Best site-USPS                     (1)  | Epoch:20 | Val Acc: 0.8942
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8649
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8676
 Best site-SynthDigits              (3)  | Epoch:20 | Val Acc: 0.8443
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.6889
 Best site-MNIST_M                  (2)  | Epoch:20 | Val Acc: 0.7778
 Best site-SVHN                     (2)  | Epoch:20 | Val Acc: 0.7000
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 21 ============
cnt=[10, 6, 4, 2, ]
cnt=[10, 9, 2, 1, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                     (0) | Train Loss: 0.5264 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4333 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2488 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.2101 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3543 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.2620 | Train Acc: 0.9444
 Site-MNIST                     (0) | Train Loss: 0.2609 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.3051 | Train Acc: 0.9169
 Site-MNIST                     (0) | Train Loss: 0.3113 | Train Acc: 0.9266
 Site-MNIST                     (0) | Train Loss: 0.2693 | Train Acc: 0.9389
 Site-USPS                      (1) | Train Loss: 0.3749 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.3019 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.2732 | Train Acc: 0.9070
 Site-USPS                      (1) | Train Loss: 0.4397 | Train Acc: 0.8455
 Site-USPS                      (1) | Train Loss: 0.3623 | Train Acc: 0.9024
 Site-USPS                      (1) | Train Loss: 0.3799 | Train Acc: 0.8981
 Site-SynthDigits               (2) | Train Loss: 0.7167 | Train Acc: 0.7815
 Site-SynthDigits               (2) | Train Loss: 0.7135 | Train Acc: 0.8132
 Site-SynthDigits               (2) | Train Loss: 0.6313 | Train Acc: 0.8574
 Site-MNIST_M                   (3) | Train Loss: 0.9622 | Train Acc: 0.7293
 Site-MNIST_M                   (3) | Train Loss: 0.8796 | Train Acc: 0.7401
 Site-SVHN                      (2) | Train Loss: 1.2497 | Train Acc: 0.5957
Average Train Accuracy: 0.8685
 Site-MNIST                     (0) | Val  Loss: 0.0272 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0492 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4481 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5317 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3772 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.3041 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2688 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2818 | Val  Acc: 0.9020
 Site-MNIST                     (0) | Val  Loss: 0.3255 | Val  Acc: 0.9180
 Site-MNIST                     (0) | Val  Loss: 0.3091 | Val  Acc: 0.9335
 Site-USPS                      (1) | Val  Loss: 0.2251 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.6670 | Val  Acc: 0.7222
 Site-USPS                      (1) | Val  Loss: 0.7076 | Val  Acc: 0.7188
 Site-USPS                      (1) | Val  Loss: 0.5858 | Val  Acc: 0.7931
 Site-USPS                      (1) | Val  Loss: 0.4705 | Val  Acc: 0.8190
 Site-USPS                      (1) | Val  Loss: 0.3811 | Val  Acc: 0.8677
 Site-SynthDigits               (2) | Val  Loss: 0.6717 | Val  Acc: 0.8378
 Site-SynthDigits               (2) | Val  Loss: 0.5640 | Val  Acc: 0.8235
 Site-SynthDigits               (2) | Val  Loss: 0.6474 | Val  Acc: 0.8525
 Site-MNIST_M                   (3) | Val  Loss: 1.0373 | Val  Acc: 0.7111
 Site-MNIST_M                   (3) | Val  Loss: 0.9075 | Val  Acc: 0.7901
 Site-SVHN                      (2) | Val  Loss: 0.9332 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8462
============ Train epoch 22 ============
cnt=[6, 10, 2, 4, ]
cnt=[10, 6, 4, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                     (1) | Train Loss: 0.5224 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4288 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2333 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2084 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3180 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.2495 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2317 | Train Acc: 0.9515
 Site-MNIST                     (1) | Train Loss: 0.3104 | Train Acc: 0.9193
 Site-MNIST                     (1) | Train Loss: 0.3028 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2612 | Train Acc: 0.9411
 Site-USPS                      (0) | Train Loss: 0.3460 | Train Acc: 0.8750
 Site-USPS                      (0) | Train Loss: 0.5338 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2560 | Train Acc: 0.9147
 Site-USPS                      (0) | Train Loss: 0.4183 | Train Acc: 0.8455
 Site-USPS                      (0) | Train Loss: 0.3384 | Train Acc: 0.9071
 Site-USPS                      (0) | Train Loss: 0.3633 | Train Acc: 0.9074
 Site-SynthDigits               (3) | Train Loss: 0.7663 | Train Acc: 0.8013
 Site-SynthDigits               (3) | Train Loss: 0.6410 | Train Acc: 0.8205
 Site-SynthDigits               (3) | Train Loss: 0.5997 | Train Acc: 0.8595
 Site-MNIST_M                   (2) | Train Loss: 0.9442 | Train Acc: 0.7127
 Site-MNIST_M                   (2) | Train Loss: 0.9241 | Train Acc: 0.7523
 Site-SVHN                      (3) | Train Loss: 1.1807 | Train Acc: 0.6064
Average Train Accuracy: 0.8706
 Site-MNIST                     (1) | Val  Loss: 0.0233 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0456 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4322 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5150 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3614 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2941 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2616 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2723 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3164 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2979 | Val  Acc: 0.9335
 Site-USPS                      (0) | Val  Loss: 0.2203 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6425 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6745 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.5673 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4557 | Val  Acc: 0.8286
 Site-USPS                      (0) | Val  Loss: 0.3650 | Val  Acc: 0.8730
 Site-SynthDigits               (3) | Val  Loss: 0.6344 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.5235 | Val  Acc: 0.8382
 Site-SynthDigits               (3) | Val  Loss: 0.6339 | Val  Acc: 0.8361
 Site-MNIST_M                   (2) | Val  Loss: 1.0107 | Val  Acc: 0.7111
 Site-MNIST_M                   (2) | Val  Loss: 0.8780 | Val  Acc: 0.8025
 Site-SVHN                      (3) | Val  Loss: 0.9341 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8499
============ Train epoch 23 ============
cnt=[6, 10, 2, 4, ]
cnt=[6, 10, 2, 4, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                     (1) | Train Loss: 0.5186 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4128 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.2472 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2056 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.4675 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2516 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2464 | Train Acc: 0.9427
 Site-MNIST                     (1) | Train Loss: 0.3100 | Train Acc: 0.9193
 Site-MNIST                     (1) | Train Loss: 0.3022 | Train Acc: 0.9253
 Site-MNIST                     (1) | Train Loss: 0.2606 | Train Acc: 0.9419
 Site-USPS                      (0) | Train Loss: 0.3353 | Train Acc: 0.8500
 Site-USPS                      (0) | Train Loss: 0.2618 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 1.2427 | Train Acc: 0.9225
 Site-USPS                      (0) | Train Loss: 0.3944 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.3281 | Train Acc: 0.9214
 Site-USPS                      (0) | Train Loss: 0.3461 | Train Acc: 0.9114
 Site-SynthDigits               (3) | Train Loss: 0.7162 | Train Acc: 0.7947
 Site-SynthDigits               (3) | Train Loss: 0.6945 | Train Acc: 0.8352
 Site-SynthDigits               (3) | Train Loss: 0.5907 | Train Acc: 0.8697
 Site-MNIST_M                   (2) | Train Loss: 0.9208 | Train Acc: 0.7238
 Site-MNIST_M                   (2) | Train Loss: 0.9185 | Train Acc: 0.7462
 Site-SVHN                      (3) | Train Loss: 1.1687 | Train Acc: 0.6170
Average Train Accuracy: 0.8734
 Site-MNIST                     (1) | Val  Loss: 0.0202 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0428 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4605 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5430 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3784 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2955 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2599 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2714 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3162 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2990 | Val  Acc: 0.9305
 Site-USPS                      (0) | Val  Loss: 0.1892 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.6040 | Val  Acc: 0.7222
 Site-USPS                      (0) | Val  Loss: 0.6456 | Val  Acc: 0.7188
 Site-USPS                      (0) | Val  Loss: 0.5509 | Val  Acc: 0.7931
 Site-USPS                      (0) | Val  Loss: 0.4367 | Val  Acc: 0.8381
 Site-USPS                      (0) | Val  Loss: 0.3498 | Val  Acc: 0.9048
 Site-SynthDigits               (3) | Val  Loss: 0.6176 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.5020 | Val  Acc: 0.8529
 Site-SynthDigits               (3) | Val  Loss: 0.6113 | Val  Acc: 0.8689
 Site-MNIST_M                   (2) | Val  Loss: 0.9711 | Val  Acc: 0.7556
 Site-MNIST_M                   (2) | Val  Loss: 0.8572 | Val  Acc: 0.8148
 Site-SVHN                      (3) | Val  Loss: 0.8974 | Val  Acc: 0.6714
Average Valid Accuracy: 0.8574
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:23 | Val Acc: 0.9305
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.7222
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.7188
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.7931
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.8381
 Best site-USPS                     (0)  | Epoch:23 | Val Acc: 0.9048
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8529
 Best site-SynthDigits              (3)  | Epoch:23 | Val Acc: 0.8689
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.7556
 Best site-MNIST_M                  (2)  | Epoch:23 | Val Acc: 0.8148
 Best site-SVHN                     (3)  | Epoch:23 | Val Acc: 0.6714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 10, 2, 6, ]
cnt=[3, 10, 6, 3, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                     (1) | Train Loss: 0.5214 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.4207 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2483 | Train Acc: 0.9048
 Site-MNIST                     (1) | Train Loss: 0.2029 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3582 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2481 | Train Acc: 0.9365
 Site-MNIST                     (1) | Train Loss: 0.2398 | Train Acc: 0.9427
 Site-MNIST                     (1) | Train Loss: 0.2996 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.2965 | Train Acc: 0.9280
 Site-MNIST                     (1) | Train Loss: 0.2548 | Train Acc: 0.9396
 Site-USPS                      (3) | Train Loss: 0.3328 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.2885 | Train Acc: 0.9444
 Site-USPS                      (3) | Train Loss: 0.2568 | Train Acc: 0.9225
 Site-USPS                      (3) | Train Loss: 0.4048 | Train Acc: 0.8627
 Site-USPS                      (3) | Train Loss: 0.3193 | Train Acc: 0.9286
 Site-USPS                      (3) | Train Loss: 0.3398 | Train Acc: 0.9114
 Site-SynthDigits               (0) | Train Loss: 0.6935 | Train Acc: 0.8013
 Site-SynthDigits               (0) | Train Loss: 0.6205 | Train Acc: 0.8388
 Site-SynthDigits               (0) | Train Loss: 0.5738 | Train Acc: 0.8819
 Site-MNIST_M                   (2) | Train Loss: 0.8874 | Train Acc: 0.7238
 Site-MNIST_M                   (2) | Train Loss: 0.8924 | Train Acc: 0.7554
 Site-SVHN                      (0) | Train Loss: 1.1265 | Train Acc: 0.6312
Average Train Accuracy: 0.8736
 Site-MNIST                     (1) | Val  Loss: 0.0175 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0402 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4652 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5375 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3739 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2900 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2558 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2669 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.3114 | Val  Acc: 0.9180
 Site-MNIST                     (1) | Val  Loss: 0.2941 | Val  Acc: 0.9305
 Site-USPS                      (3) | Val  Loss: 0.1795 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.5958 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.6394 | Val  Acc: 0.7188
 Site-USPS                      (3) | Val  Loss: 0.5406 | Val  Acc: 0.8276
 Site-USPS                      (3) | Val  Loss: 0.4302 | Val  Acc: 0.8762
 Site-USPS                      (3) | Val  Loss: 0.3440 | Val  Acc: 0.9048
 Site-SynthDigits               (0) | Val  Loss: 0.5885 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4689 | Val  Acc: 0.8676
 Site-SynthDigits               (0) | Val  Loss: 0.5966 | Val  Acc: 0.8443
 Site-MNIST_M                   (2) | Val  Loss: 0.9485 | Val  Acc: 0.7778
 Site-MNIST_M                   (2) | Val  Loss: 0.8315 | Val  Acc: 0.8272
 Site-SVHN                      (0) | Val  Loss: 0.8720 | Val  Acc: 0.6857
Average Valid Accuracy: 0.8624
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9180
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9305
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.7222
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.7188
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8276
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8762
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.9048
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8676
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8443
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.7778
 Best site-MNIST_M                  (2)  | Epoch:24 | Val Acc: 0.8272
 Best site-SVHN                     (0)  | Epoch:24 | Val Acc: 0.6857
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 25 ============
cnt=[10, 4, 6, 2, ]
cnt=[10, 6, 2, 4, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                     (0) | Train Loss: 0.5252 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.4058 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2293 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.1920 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.4432 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2379 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2215 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.2917 | Train Acc: 0.9242
 Site-MNIST                     (0) | Train Loss: 0.2871 | Train Acc: 0.9334
 Site-MNIST                     (0) | Train Loss: 0.2479 | Train Acc: 0.9426
 Site-USPS                      (2) | Train Loss: 0.3397 | Train Acc: 0.8750
 Site-USPS                      (2) | Train Loss: 0.3714 | Train Acc: 0.9444
 Site-USPS                      (2) | Train Loss: 0.2305 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.4007 | Train Acc: 0.8498
 Site-USPS                      (2) | Train Loss: 0.3089 | Train Acc: 0.9310
 Site-USPS                      (2) | Train Loss: 0.3354 | Train Acc: 0.9127
 Site-SynthDigits               (1) | Train Loss: 0.7372 | Train Acc: 0.8079
 Site-SynthDigits               (1) | Train Loss: 0.6614 | Train Acc: 0.8388
 Site-SynthDigits               (1) | Train Loss: 0.5605 | Train Acc: 0.8819
 Site-MNIST_M                   (3) | Train Loss: 0.8788 | Train Acc: 0.7403
 Site-MNIST_M                   (3) | Train Loss: 0.8350 | Train Acc: 0.7584
 Site-SVHN                      (1) | Train Loss: 1.1581 | Train Acc: 0.6312
Average Train Accuracy: 0.8796
 Site-MNIST                     (0) | Val  Loss: 0.0165 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0392 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4652 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5403 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3709 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2834 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2471 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2594 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.3033 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.2875 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1752 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5929 | Val  Acc: 0.7222
 Site-USPS                      (2) | Val  Loss: 0.6446 | Val  Acc: 0.7188
 Site-USPS                      (2) | Val  Loss: 0.5326 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.4276 | Val  Acc: 0.8667
 Site-USPS                      (2) | Val  Loss: 0.3409 | Val  Acc: 0.8889
 Site-SynthDigits               (1) | Val  Loss: 0.5633 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4631 | Val  Acc: 0.8676
 Site-SynthDigits               (1) | Val  Loss: 0.5823 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9377 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.8178 | Val  Acc: 0.8272
 Site-SVHN                      (1) | Val  Loss: 0.8739 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8643
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:25 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.7222
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.7188
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8667
 Best site-USPS                     (2)  | Epoch:25 | Val Acc: 0.8889
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8676
 Best site-SynthDigits              (1)  | Epoch:25 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:25 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:25 | Val Acc: 0.8272
 Best site-SVHN                     (1)  | Epoch:25 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 26 ============
cnt=[10, 4, 6, 2, ]
cnt=[10, 6, 2, 4, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                     (0) | Train Loss: 0.5188 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3962 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2197 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.1895 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2306 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2263 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2298 | Train Acc: 0.9471
 Site-MNIST                     (0) | Train Loss: 0.2780 | Train Acc: 0.9218
 Site-MNIST                     (0) | Train Loss: 0.2804 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.2397 | Train Acc: 0.9464
 Site-USPS                      (2) | Train Loss: 0.3384 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.2630 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2367 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3878 | Train Acc: 0.8541
 Site-USPS                      (2) | Train Loss: 0.3148 | Train Acc: 0.9310
 Site-USPS                      (2) | Train Loss: 0.3279 | Train Acc: 0.9101
 Site-SynthDigits               (1) | Train Loss: 0.6628 | Train Acc: 0.7947
 Site-SynthDigits               (1) | Train Loss: 0.6137 | Train Acc: 0.8388
 Site-SynthDigits               (1) | Train Loss: 0.5399 | Train Acc: 0.8839
 Site-MNIST_M                   (3) | Train Loss: 0.8581 | Train Acc: 0.7459
 Site-MNIST_M                   (3) | Train Loss: 0.8654 | Train Acc: 0.7706
 Site-SVHN                      (1) | Train Loss: 1.0950 | Train Acc: 0.6525
Average Train Accuracy: 0.8805
 Site-MNIST                     (0) | Val  Loss: 0.0151 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0352 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4570 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5220 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3554 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2707 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2375 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2500 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2931 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.2783 | Val  Acc: 0.9335
 Site-USPS                      (2) | Val  Loss: 0.1706 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5908 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.6411 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.5301 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.4228 | Val  Acc: 0.8667
 Site-USPS                      (2) | Val  Loss: 0.3350 | Val  Acc: 0.8783
 Site-SynthDigits               (1) | Val  Loss: 0.5391 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.4514 | Val  Acc: 0.8824
 Site-SynthDigits               (1) | Val  Loss: 0.5564 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.9306 | Val  Acc: 0.7778
 Site-MNIST_M                   (3) | Val  Loss: 0.8047 | Val  Acc: 0.8519
 Site-SVHN                      (1) | Val  Loss: 0.8643 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8717
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:26 | Val Acc: 0.9335
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8667
 Best site-USPS                     (2)  | Epoch:26 | Val Acc: 0.8783
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8824
 Best site-SynthDigits              (1)  | Epoch:26 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.7778
 Best site-MNIST_M                  (3)  | Epoch:26 | Val Acc: 0.8519
 Best site-SVHN                     (1)  | Epoch:26 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 27 ============
cnt=[10, 6, 4, 2, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                     (0) | Train Loss: 0.5033 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3891 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.2044 | Train Acc: 0.9048
 Site-MNIST                     (0) | Train Loss: 0.1844 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2415 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2224 | Train Acc: 0.9365
 Site-MNIST                     (0) | Train Loss: 0.2095 | Train Acc: 0.9427
 Site-MNIST                     (0) | Train Loss: 0.2708 | Train Acc: 0.9242
 Site-MNIST                     (0) | Train Loss: 0.2741 | Train Acc: 0.9361
 Site-MNIST                     (0) | Train Loss: 0.2336 | Train Acc: 0.9464
 Site-USPS                      (1) | Train Loss: 0.3038 | Train Acc: 0.9000
 Site-USPS                      (1) | Train Loss: 0.2182 | Train Acc: 0.9444
 Site-USPS                      (1) | Train Loss: 0.7895 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.3813 | Train Acc: 0.8627
 Site-USPS                      (1) | Train Loss: 0.3020 | Train Acc: 0.9262
 Site-USPS                      (1) | Train Loss: 0.3166 | Train Acc: 0.9193
 Site-SynthDigits               (2) | Train Loss: 0.6408 | Train Acc: 0.8146
 Site-SynthDigits               (2) | Train Loss: 0.5732 | Train Acc: 0.8462
 Site-SynthDigits               (2) | Train Loss: 0.5125 | Train Acc: 0.8778
 Site-MNIST_M                   (3) | Train Loss: 0.8491 | Train Acc: 0.7403
 Site-MNIST_M                   (3) | Train Loss: 0.7916 | Train Acc: 0.7706
 Site-SVHN                      (2) | Train Loss: 1.1326 | Train Acc: 0.6489
Average Train Accuracy: 0.8826
 Site-MNIST                     (0) | Val  Loss: 0.0148 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4599 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5176 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3511 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2638 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2320 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2430 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2874 | Val  Acc: 0.9235
 Site-MNIST                     (0) | Val  Loss: 0.2713 | Val  Acc: 0.9335
 Site-USPS                      (1) | Val  Loss: 0.1594 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5653 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6120 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.5150 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.4088 | Val  Acc: 0.8762
 Site-USPS                      (1) | Val  Loss: 0.3217 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.5314 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.4325 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5380 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.9043 | Val  Acc: 0.8000
 Site-MNIST_M                   (3) | Val  Loss: 0.7793 | Val  Acc: 0.8519
 Site-SVHN                      (2) | Val  Loss: 0.8534 | Val  Acc: 0.7143
Average Valid Accuracy: 0.8717
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9235
 Best site-MNIST                    (0)  | Epoch:27 | Val Acc: 0.9335
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8762
 Best site-USPS                     (1)  | Epoch:27 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8824
 Best site-SynthDigits              (2)  | Epoch:27 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:27 | Val Acc: 0.8000
 Best site-MNIST_M                  (3)  | Epoch:27 | Val Acc: 0.8519
 Best site-SVHN                     (2)  | Epoch:27 | Val Acc: 0.7143
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 28 ============
cnt=[4, 10, 2, 6, ]
cnt=[10, 4, 6, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                     (1) | Train Loss: 0.4890 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3767 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1894 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1689 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.6518 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.2090 | Train Acc: 0.9444
 Site-MNIST                     (1) | Train Loss: 0.2058 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2793 | Train Acc: 0.9218
 Site-MNIST                     (1) | Train Loss: 0.2582 | Train Acc: 0.9334
 Site-MNIST                     (1) | Train Loss: 0.2242 | Train Acc: 0.9532
 Site-USPS                      (3) | Train Loss: 0.3276 | Train Acc: 0.8750
 Site-USPS                      (3) | Train Loss: 0.4592 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.4997 | Train Acc: 0.8992
 Site-USPS                      (3) | Train Loss: 0.3730 | Train Acc: 0.8670
 Site-USPS                      (3) | Train Loss: 0.2853 | Train Acc: 0.9286
 Site-USPS                      (3) | Train Loss: 0.3102 | Train Acc: 0.9153
 Site-SynthDigits               (0) | Train Loss: 0.6211 | Train Acc: 0.8013
 Site-SynthDigits               (0) | Train Loss: 0.5850 | Train Acc: 0.8462
 Site-SynthDigits               (0) | Train Loss: 0.5021 | Train Acc: 0.8921
 Site-MNIST_M                   (2) | Train Loss: 0.8364 | Train Acc: 0.7624
 Site-MNIST_M                   (2) | Train Loss: 0.8332 | Train Acc: 0.7676
 Site-SVHN                      (0) | Train Loss: 1.0833 | Train Acc: 0.6489
Average Train Accuracy: 0.8840
 Site-MNIST                     (1) | Val  Loss: 0.0164 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0309 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4208 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4738 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3209 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2494 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2238 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2340 | Val  Acc: 0.9020
 Site-MNIST                     (1) | Val  Loss: 0.2764 | Val  Acc: 0.9235
 Site-MNIST                     (1) | Val  Loss: 0.2612 | Val  Acc: 0.9366
 Site-USPS                      (3) | Val  Loss: 0.1766 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.5868 | Val  Acc: 0.7222
 Site-USPS                      (3) | Val  Loss: 0.6199 | Val  Acc: 0.7812
 Site-USPS                      (3) | Val  Loss: 0.5045 | Val  Acc: 0.8276
 Site-USPS                      (3) | Val  Loss: 0.4088 | Val  Acc: 0.8476
 Site-USPS                      (3) | Val  Loss: 0.3207 | Val  Acc: 0.8783
 Site-SynthDigits               (0) | Val  Loss: 0.5226 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.4229 | Val  Acc: 0.8824
 Site-SynthDigits               (0) | Val  Loss: 0.5391 | Val  Acc: 0.8607
 Site-MNIST_M                   (2) | Val  Loss: 0.8980 | Val  Acc: 0.8000
 Site-MNIST_M                   (2) | Val  Loss: 0.7657 | Val  Acc: 0.8642
 Site-SVHN                      (0) | Val  Loss: 0.8430 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8702
============ Train epoch 29 ============
cnt=[10, 6, 4, 2, ]
cnt=[10, 4, 6, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                     (0) | Train Loss: 0.5226 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3750 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1741 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1635 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.2979 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.2010 | Train Acc: 0.9603
 Site-MNIST                     (0) | Train Loss: 0.2073 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2531 | Train Acc: 0.9315
 Site-MNIST                     (0) | Train Loss: 0.2551 | Train Acc: 0.9375
 Site-MNIST                     (0) | Train Loss: 0.2162 | Train Acc: 0.9540
 Site-USPS                      (1) | Train Loss: 0.3153 | Train Acc: 0.8750
 Site-USPS                      (1) | Train Loss: 0.2220 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.2154 | Train Acc: 0.9070
 Site-USPS                      (1) | Train Loss: 0.3665 | Train Acc: 0.8584
 Site-USPS                      (1) | Train Loss: 0.2869 | Train Acc: 0.9357
 Site-USPS                      (1) | Train Loss: 0.3037 | Train Acc: 0.9153
 Site-SynthDigits               (2) | Train Loss: 0.6576 | Train Acc: 0.7947
 Site-SynthDigits               (2) | Train Loss: 0.5375 | Train Acc: 0.8608
 Site-SynthDigits               (2) | Train Loss: 0.4997 | Train Acc: 0.8921
 Site-MNIST_M                   (3) | Train Loss: 0.8297 | Train Acc: 0.7624
 Site-MNIST_M                   (3) | Train Loss: 0.7545 | Train Acc: 0.7676
 Site-SVHN                      (2) | Train Loss: 1.0952 | Train Acc: 0.6489
Average Train Accuracy: 0.8860
 Site-MNIST                     (0) | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0316 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4335 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4776 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3183 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2426 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.2148 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2268 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2674 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2546 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.1614 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5670 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.6057 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4978 | Val  Acc: 0.8103
 Site-USPS                      (1) | Val  Loss: 0.4010 | Val  Acc: 0.8952
 Site-USPS                      (1) | Val  Loss: 0.3154 | Val  Acc: 0.8836
 Site-SynthDigits               (2) | Val  Loss: 0.5053 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3976 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.5158 | Val  Acc: 0.8607
 Site-MNIST_M                   (3) | Val  Loss: 0.8713 | Val  Acc: 0.7556
 Site-MNIST_M                   (3) | Val  Loss: 0.7530 | Val  Acc: 0.8642
 Site-SVHN                      (2) | Val  Loss: 0.8122 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8720
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9290
 Best site-MNIST                    (0)  | Epoch:29 | Val Acc: 0.9426
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.9000
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.7778
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.8103
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.8952
 Best site-USPS                     (1)  | Epoch:29 | Val Acc: 0.8836
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8824
 Best site-SynthDigits              (2)  | Epoch:29 | Val Acc: 0.8607
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.7556
 Best site-MNIST_M                  (3)  | Epoch:29 | Val Acc: 0.8642
 Best site-SVHN                     (2)  | Epoch:29 | Val Acc: 0.7286
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 30 ============
cnt=[6, 10, 4, 2, ]
cnt=[1, 10, 9, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                     (1) | Train Loss: 0.5272 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3672 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1704 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1577 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.7230 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1926 | Train Acc: 0.9603
 Site-MNIST                     (1) | Train Loss: 0.1863 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2487 | Train Acc: 0.9315
 Site-MNIST                     (1) | Train Loss: 0.2473 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.2099 | Train Acc: 0.9555
 Site-USPS                      (0) | Train Loss: 0.2975 | Train Acc: 0.9500
 Site-USPS                      (0) | Train Loss: 0.2205 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2130 | Train Acc: 0.9070
 Site-USPS                      (0) | Train Loss: 0.3600 | Train Acc: 0.8627
 Site-USPS                      (0) | Train Loss: 0.2816 | Train Acc: 0.9381
 Site-USPS                      (0) | Train Loss: 0.3061 | Train Acc: 0.9193
 Site-SynthDigits               (2) | Train Loss: 0.6350 | Train Acc: 0.8146
 Site-SynthDigits               (2) | Train Loss: 0.5204 | Train Acc: 0.8828
 Site-SynthDigits               (2) | Train Loss: 0.4812 | Train Acc: 0.8961
 Site-MNIST_M                   (3) | Train Loss: 0.8083 | Train Acc: 0.7790
 Site-MNIST_M                   (3) | Train Loss: 0.7977 | Train Acc: 0.7798
 Site-SVHN                      (2) | Train Loss: 1.0191 | Train Acc: 0.6667
Average Train Accuracy: 0.8938
 Site-MNIST                     (1) | Val  Loss: 0.0161 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4510 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4847 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3190 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2295 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.2045 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2196 | Val  Acc: 0.9118
 Site-MNIST                     (1) | Val  Loss: 0.2601 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2494 | Val  Acc: 0.9426
 Site-USPS                      (0) | Val  Loss: 0.1620 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5619 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.6129 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.4975 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.4052 | Val  Acc: 0.8952
 Site-USPS                      (0) | Val  Loss: 0.3168 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.4930 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3895 | Val  Acc: 0.8824
 Site-SynthDigits               (2) | Val  Loss: 0.4996 | Val  Acc: 0.8689
 Site-MNIST_M                   (3) | Val  Loss: 0.8684 | Val  Acc: 0.8222
 Site-MNIST_M                   (3) | Val  Loss: 0.7435 | Val  Acc: 0.8642
 Site-SVHN                      (2) | Val  Loss: 0.7979 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8772
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9118
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:30 | Val Acc: 0.9426
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8952
 Best site-USPS                     (0)  | Epoch:30 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.9189
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.8824
 Best site-SynthDigits              (2)  | Epoch:30 | Val Acc: 0.8689
 Best site-MNIST_M                  (3)  | Epoch:30 | Val Acc: 0.8222
 Best site-MNIST_M                  (3)  | Epoch:30 | Val Acc: 0.8642
 Best site-SVHN                     (2)  | Epoch:30 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 31 ============
cnt=[2, 10, 6, 4, ]
cnt=[6, 10, 4, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                     (1) | Train Loss: 0.5222 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3449 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1741 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1536 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1845 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1902 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1981 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2419 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2483 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.2040 | Train Acc: 0.9562
 Site-USPS                      (2) | Train Loss: 0.3116 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.3270 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2077 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3656 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2756 | Train Acc: 0.9381
 Site-USPS                      (2) | Train Loss: 0.2989 | Train Acc: 0.9193
 Site-SynthDigits               (3) | Train Loss: 0.6078 | Train Acc: 0.8146
 Site-SynthDigits               (3) | Train Loss: 0.5440 | Train Acc: 0.8755
 Site-SynthDigits               (3) | Train Loss: 0.4709 | Train Acc: 0.9084
 Site-MNIST_M                   (0) | Train Loss: 0.7816 | Train Acc: 0.7845
 Site-MNIST_M                   (0) | Train Loss: 0.7732 | Train Acc: 0.7951
 Site-SVHN                      (3) | Train Loss: 1.0203 | Train Acc: 0.6738
Average Train Accuracy: 0.8942
 Site-MNIST                     (1) | Val  Loss: 0.0156 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0346 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4549 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4875 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3156 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2195 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1941 | Val  Acc: 0.9464
 Site-MNIST                     (1) | Val  Loss: 0.2117 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2547 | Val  Acc: 0.9290
 Site-MNIST                     (1) | Val  Loss: 0.2454 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.1520 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5453 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5968 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4819 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3952 | Val  Acc: 0.9143
 Site-USPS                      (2) | Val  Loss: 0.3122 | Val  Acc: 0.8995
 Site-SynthDigits               (3) | Val  Loss: 0.4877 | Val  Acc: 0.8649
 Site-SynthDigits               (3) | Val  Loss: 0.3924 | Val  Acc: 0.8676
 Site-SynthDigits               (3) | Val  Loss: 0.4934 | Val  Acc: 0.8689
 Site-MNIST_M                   (0) | Val  Loss: 0.8546 | Val  Acc: 0.8444
 Site-MNIST_M                   (0) | Val  Loss: 0.7247 | Val  Acc: 0.8642
 Site-SVHN                      (3) | Val  Loss: 0.8068 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8788
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9464
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9290
 Best site-MNIST                    (1)  | Epoch:31 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.9143
 Best site-USPS                     (2)  | Epoch:31 | Val Acc: 0.8995
 Best site-SynthDigits              (3)  | Epoch:31 | Val Acc: 0.8649
 Best site-SynthDigits              (3)  | Epoch:31 | Val Acc: 0.8676
 Best site-SynthDigits              (3)  | Epoch:31 | Val Acc: 0.8689
 Best site-MNIST_M                  (0)  | Epoch:31 | Val Acc: 0.8444
 Best site-MNIST_M                  (0)  | Epoch:31 | Val Acc: 0.8642
 Best site-SVHN                     (3)  | Epoch:31 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 32 ============
cnt=[10, 4, 6, 2, ]
cnt=[2, 10, 1, 9, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                     (0) | Train Loss: 0.5139 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3462 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1619 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1488 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.6769 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1910 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1891 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2395 | Train Acc: 0.9340
 Site-MNIST                     (0) | Train Loss: 0.2389 | Train Acc: 0.9402
 Site-MNIST                     (0) | Train Loss: 0.2012 | Train Acc: 0.9570
 Site-USPS                      (2) | Train Loss: 0.3007 | Train Acc: 0.9000
 Site-USPS                      (2) | Train Loss: 0.2415 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.2053 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3384 | Train Acc: 0.8798
 Site-USPS                      (2) | Train Loss: 0.2628 | Train Acc: 0.9333
 Site-USPS                      (2) | Train Loss: 0.2846 | Train Acc: 0.9339
 Site-SynthDigits               (1) | Train Loss: 0.5273 | Train Acc: 0.8411
 Site-SynthDigits               (1) | Train Loss: 0.5162 | Train Acc: 0.8681
 Site-SynthDigits               (1) | Train Loss: 0.4564 | Train Acc: 0.8961
 Site-MNIST_M                   (3) | Train Loss: 0.7713 | Train Acc: 0.8011
 Site-MNIST_M                   (3) | Train Loss: 0.7408 | Train Acc: 0.7982
 Site-SVHN                      (1) | Train Loss: 1.0149 | Train Acc: 0.6560
Average Train Accuracy: 0.8950
 Site-MNIST                     (0) | Val  Loss: 0.0136 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0322 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4375 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4750 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3069 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2246 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1960 | Val  Acc: 0.9464
 Site-MNIST                     (0) | Val  Loss: 0.2115 | Val  Acc: 0.9118
 Site-MNIST                     (0) | Val  Loss: 0.2522 | Val  Acc: 0.9290
 Site-MNIST                     (0) | Val  Loss: 0.2414 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.1529 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5273 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5625 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4614 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3801 | Val  Acc: 0.8952
 Site-USPS                      (2) | Val  Loss: 0.3015 | Val  Acc: 0.8942
 Site-SynthDigits               (1) | Val  Loss: 0.4719 | Val  Acc: 0.9189
 Site-SynthDigits               (1) | Val  Loss: 0.3637 | Val  Acc: 0.9118
 Site-SynthDigits               (1) | Val  Loss: 0.4666 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.8458 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.7107 | Val  Acc: 0.8765
 Site-SVHN                      (1) | Val  Loss: 0.7883 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8813
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9464
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9118
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9290
 Best site-MNIST                    (0)  | Epoch:32 | Val Acc: 0.9426
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.7778
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8276
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8952
 Best site-USPS                     (2)  | Epoch:32 | Val Acc: 0.8942
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.9189
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.9118
 Best site-SynthDigits              (1)  | Epoch:32 | Val Acc: 0.8934
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8444
 Best site-MNIST_M                  (3)  | Epoch:32 | Val Acc: 0.8765
 Best site-SVHN                     (1)  | Epoch:32 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 33 ============
cnt=[10, 6, 4, 2, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                     (0) | Train Loss: 0.5232 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3365 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1604 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1467 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3539 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1832 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1857 | Train Acc: 0.9559
 Site-MNIST                     (0) | Train Loss: 0.2386 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2409 | Train Acc: 0.9416
 Site-MNIST                     (0) | Train Loss: 0.1965 | Train Acc: 0.9570
 Site-USPS                      (1) | Train Loss: 0.2801 | Train Acc: 0.9250
 Site-USPS                      (1) | Train Loss: 0.2688 | Train Acc: 0.9306
 Site-USPS                      (1) | Train Loss: 0.2320 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.3430 | Train Acc: 0.8627
 Site-USPS                      (1) | Train Loss: 0.2568 | Train Acc: 0.9333
 Site-USPS                      (1) | Train Loss: 0.2840 | Train Acc: 0.9246
 Site-SynthDigits               (2) | Train Loss: 0.6225 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4908 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.4532 | Train Acc: 0.9002
 Site-MNIST_M                   (3) | Train Loss: 0.7490 | Train Acc: 0.7901
 Site-MNIST_M                   (3) | Train Loss: 0.7036 | Train Acc: 0.7920
 Site-SVHN                      (2) | Train Loss: 1.0109 | Train Acc: 0.6489
Average Train Accuracy: 0.8959
 Site-MNIST                     (0) | Val  Loss: 0.0127 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0327 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4598 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4931 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3142 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2227 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1910 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.2076 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2474 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2373 | Val  Acc: 0.9426
 Site-USPS                      (1) | Val  Loss: 0.1429 | Val  Acc: 0.9000
 Site-USPS                      (1) | Val  Loss: 0.5211 | Val  Acc: 0.7778
 Site-USPS                      (1) | Val  Loss: 0.5566 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4587 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3784 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2991 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.4711 | Val  Acc: 0.9189
 Site-SynthDigits               (2) | Val  Loss: 0.3530 | Val  Acc: 0.9118
 Site-SynthDigits               (2) | Val  Loss: 0.4574 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.8221 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6883 | Val  Acc: 0.8642
 Site-SVHN                      (2) | Val  Loss: 0.7824 | Val  Acc: 0.7286
Average Valid Accuracy: 0.8812
============ Train epoch 34 ============
cnt=[4, 10, 6, 2, ]
cnt=[2, 6, 10, 4, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                     (1) | Train Loss: 0.5148 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3268 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1517 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1467 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2538 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1737 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1817 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2350 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2362 | Train Acc: 0.9416
 Site-MNIST                     (1) | Train Loss: 0.1898 | Train Acc: 0.9577
 Site-USPS                      (2) | Train Loss: 0.2799 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.2319 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.3214 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3290 | Train Acc: 0.8670
 Site-USPS                      (2) | Train Loss: 0.2563 | Train Acc: 0.9405
 Site-USPS                      (2) | Train Loss: 0.2732 | Train Acc: 0.9299
 Site-SynthDigits               (0) | Train Loss: 0.5287 | Train Acc: 0.8278
 Site-SynthDigits               (0) | Train Loss: 0.4605 | Train Acc: 0.9011
 Site-SynthDigits               (0) | Train Loss: 0.4403 | Train Acc: 0.9022
 Site-MNIST_M                   (3) | Train Loss: 0.7483 | Train Acc: 0.8011
 Site-MNIST_M                   (3) | Train Loss: 0.7467 | Train Acc: 0.8043
 Site-SVHN                      (0) | Train Loss: 0.9910 | Train Acc: 0.6525
Average Train Accuracy: 0.9000
 Site-MNIST                     (1) | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0332 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4665 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5101 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3197 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2181 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1848 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.2011 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2417 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2311 | Val  Acc: 0.9456
 Site-USPS                      (2) | Val  Loss: 0.1443 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.5162 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5493 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4597 | Val  Acc: 0.7931
 Site-USPS                      (2) | Val  Loss: 0.3765 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2917 | Val  Acc: 0.8942
 Site-SynthDigits               (0) | Val  Loss: 0.4625 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3463 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.4441 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8226 | Val  Acc: 0.8222
 Site-MNIST_M                   (3) | Val  Loss: 0.6904 | Val  Acc: 0.8765
 Site-SVHN                      (0) | Val  Loss: 0.7751 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8786
============ Train epoch 35 ============
cnt=[6, 10, 4, 2, ]
cnt=[4, 6, 10, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                     (1) | Train Loss: 0.5148 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3222 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1410 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1408 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3059 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1657 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1784 | Train Acc: 0.9559
 Site-MNIST                     (1) | Train Loss: 0.2193 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.2230 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.1855 | Train Acc: 0.9592
 Site-USPS                      (0) | Train Loss: 0.2689 | Train Acc: 0.9250
 Site-USPS                      (0) | Train Loss: 0.1876 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.1823 | Train Acc: 0.9147
 Site-USPS                      (0) | Train Loss: 0.3267 | Train Acc: 0.8755
 Site-USPS                      (0) | Train Loss: 0.2532 | Train Acc: 0.9405
 Site-USPS                      (0) | Train Loss: 0.2679 | Train Acc: 0.9339
 Site-SynthDigits               (2) | Train Loss: 0.5509 | Train Acc: 0.8411
 Site-SynthDigits               (2) | Train Loss: 0.4706 | Train Acc: 0.8864
 Site-SynthDigits               (2) | Train Loss: 0.4271 | Train Acc: 0.9124
 Site-MNIST_M                   (3) | Train Loss: 0.7435 | Train Acc: 0.7956
 Site-MNIST_M                   (3) | Train Loss: 0.7503 | Train Acc: 0.8012
 Site-SVHN                      (2) | Train Loss: 1.0442 | Train Acc: 0.6738
Average Train Accuracy: 0.8992
 Site-MNIST                     (1) | Val  Loss: 0.0126 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4681 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5107 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3185 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2107 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1789 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1950 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2378 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.2275 | Val  Acc: 0.9456
 Site-USPS                      (0) | Val  Loss: 0.1354 | Val  Acc: 0.9000
 Site-USPS                      (0) | Val  Loss: 0.5011 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.5368 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4440 | Val  Acc: 0.8448
 Site-USPS                      (0) | Val  Loss: 0.3688 | Val  Acc: 0.9048
 Site-USPS                      (0) | Val  Loss: 0.2868 | Val  Acc: 0.9048
 Site-SynthDigits               (2) | Val  Loss: 0.4424 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.3476 | Val  Acc: 0.8971
 Site-SynthDigits               (2) | Val  Loss: 0.4450 | Val  Acc: 0.8852
 Site-MNIST_M                   (3) | Val  Loss: 0.8169 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6775 | Val  Acc: 0.8765
 Site-SVHN                      (2) | Val  Loss: 0.7728 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8829
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9454
 Best site-MNIST                    (1)  | Epoch:35 | Val Acc: 0.9456
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9000
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.8448
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9048
 Best site-USPS                     (0)  | Epoch:35 | Val Acc: 0.9048
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8971
 Best site-SynthDigits              (2)  | Epoch:35 | Val Acc: 0.8852
 Best site-MNIST_M                  (3)  | Epoch:35 | Val Acc: 0.8444
 Best site-MNIST_M                  (3)  | Epoch:35 | Val Acc: 0.8765
 Best site-SVHN                     (2)  | Epoch:35 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 36 ============
cnt=[4, 10, 6, 2, ]
cnt=[3, 10, 6, 3, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                     (1) | Train Loss: 0.5115 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3141 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1367 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1465 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.2938 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1600 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1723 | Train Acc: 0.9604
 Site-MNIST                     (1) | Train Loss: 0.2321 | Train Acc: 0.9315
 Site-MNIST                     (1) | Train Loss: 0.2341 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.1808 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2761 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.3501 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1839 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.3295 | Train Acc: 0.8712
 Site-USPS                      (2) | Train Loss: 0.2389 | Train Acc: 0.9452
 Site-USPS                      (2) | Train Loss: 0.2661 | Train Acc: 0.9312
 Site-SynthDigits               (0) | Train Loss: 0.5151 | Train Acc: 0.8609
 Site-SynthDigits               (0) | Train Loss: 0.4509 | Train Acc: 0.8864
 Site-SynthDigits               (0) | Train Loss: 0.4223 | Train Acc: 0.9185
 Site-MNIST_M                   (3) | Train Loss: 0.7278 | Train Acc: 0.8011
 Site-MNIST_M                   (3) | Train Loss: 0.6637 | Train Acc: 0.8012
 Site-SVHN                      (0) | Train Loss: 1.0341 | Train Acc: 0.6631
Average Train Accuracy: 0.9031
 Site-MNIST                     (1) | Val  Loss: 0.0118 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0313 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4797 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5140 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3202 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2094 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1776 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1931 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2346 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2249 | Val  Acc: 0.9456
 Site-USPS                      (2) | Val  Loss: 0.1255 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.4905 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.5278 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4363 | Val  Acc: 0.8103
 Site-USPS                      (2) | Val  Loss: 0.3656 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2853 | Val  Acc: 0.8995
 Site-SynthDigits               (0) | Val  Loss: 0.4354 | Val  Acc: 0.8919
 Site-SynthDigits               (0) | Val  Loss: 0.3349 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.4320 | Val  Acc: 0.8934
 Site-MNIST_M                   (3) | Val  Loss: 0.7869 | Val  Acc: 0.8444
 Site-MNIST_M                   (3) | Val  Loss: 0.6608 | Val  Acc: 0.8765
 Site-SVHN                      (0) | Val  Loss: 0.7538 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8853
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:36 | Val Acc: 0.9456
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.9000
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8103
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8857
 Best site-USPS                     (2)  | Epoch:36 | Val Acc: 0.8995
 Best site-SynthDigits              (0)  | Epoch:36 | Val Acc: 0.8919
 Best site-SynthDigits              (0)  | Epoch:36 | Val Acc: 0.9265
 Best site-SynthDigits              (0)  | Epoch:36 | Val Acc: 0.8934
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8444
 Best site-MNIST_M                  (3)  | Epoch:36 | Val Acc: 0.8765
 Best site-SVHN                     (0)  | Epoch:36 | Val Acc: 0.7714
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 37 ============
cnt=[4, 10, 2, 6, ]
cnt=[6, 10, 2, 4, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                     (1) | Train Loss: 0.5160 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3111 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1271 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1374 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3753 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1556 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1624 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2220 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.2152 | Train Acc: 0.9348
 Site-MNIST                     (1) | Train Loss: 0.1765 | Train Acc: 0.9608
 Site-USPS                      (3) | Train Loss: 0.2670 | Train Acc: 0.9750
 Site-USPS                      (3) | Train Loss: 0.4228 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.1871 | Train Acc: 0.9225
 Site-USPS                      (3) | Train Loss: 0.3160 | Train Acc: 0.8798
 Site-USPS                      (3) | Train Loss: 0.2433 | Train Acc: 0.9500
 Site-USPS                      (3) | Train Loss: 0.2620 | Train Acc: 0.9365
 Site-SynthDigits               (0) | Train Loss: 0.5001 | Train Acc: 0.8675
 Site-SynthDigits               (0) | Train Loss: 0.4953 | Train Acc: 0.8901
 Site-SynthDigits               (0) | Train Loss: 0.4087 | Train Acc: 0.9165
 Site-MNIST_M                   (2) | Train Loss: 0.7161 | Train Acc: 0.8011
 Site-MNIST_M                   (2) | Train Loss: 0.7182 | Train Acc: 0.8012
 Site-SVHN                      (0) | Train Loss: 0.9812 | Train Acc: 0.6844
Average Train Accuracy: 0.9057
 Site-MNIST                     (1) | Val  Loss: 0.0112 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0306 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4808 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5208 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3210 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2089 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1732 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1899 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2317 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2221 | Val  Acc: 0.9456
 Site-USPS                      (3) | Val  Loss: 0.1208 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.4912 | Val  Acc: 0.8333
 Site-USPS                      (3) | Val  Loss: 0.5308 | Val  Acc: 0.7812
 Site-USPS                      (3) | Val  Loss: 0.4283 | Val  Acc: 0.8276
 Site-USPS                      (3) | Val  Loss: 0.3609 | Val  Acc: 0.8762
 Site-USPS                      (3) | Val  Loss: 0.2857 | Val  Acc: 0.8889
 Site-SynthDigits               (0) | Val  Loss: 0.4254 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.3263 | Val  Acc: 0.9118
 Site-SynthDigits               (0) | Val  Loss: 0.4268 | Val  Acc: 0.8934
 Site-MNIST_M                   (2) | Val  Loss: 0.7985 | Val  Acc: 0.8444
 Site-MNIST_M                   (2) | Val  Loss: 0.6617 | Val  Acc: 0.9012
 Site-SVHN                      (0) | Val  Loss: 0.7398 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8855
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9216
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9344
 Best site-MNIST                    (1)  | Epoch:37 | Val Acc: 0.9456
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.9000
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8333
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.7812
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8276
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8762
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8889
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.9118
 Best site-SynthDigits              (0)  | Epoch:37 | Val Acc: 0.8934
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.8444
 Best site-MNIST_M                  (2)  | Epoch:37 | Val Acc: 0.9012
 Best site-SVHN                     (0)  | Epoch:37 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 10, 6, 4, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                     (1) | Train Loss: 0.5111 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3039 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1311 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1331 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1879 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1553 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1657 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2209 | Train Acc: 0.9340
 Site-MNIST                     (1) | Train Loss: 0.2125 | Train Acc: 0.9429
 Site-MNIST                     (1) | Train Loss: 0.1757 | Train Acc: 0.9585
 Site-USPS                      (2) | Train Loss: 0.2553 | Train Acc: 0.9500
 Site-USPS                      (2) | Train Loss: 0.3064 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.6662 | Train Acc: 0.9147
 Site-USPS                      (2) | Train Loss: 0.3024 | Train Acc: 0.8798
 Site-USPS                      (2) | Train Loss: 0.2326 | Train Acc: 0.9476
 Site-USPS                      (2) | Train Loss: 0.2532 | Train Acc: 0.9339
 Site-SynthDigits               (3) | Train Loss: 0.5103 | Train Acc: 0.8477
 Site-SynthDigits               (3) | Train Loss: 0.4691 | Train Acc: 0.8938
 Site-SynthDigits               (3) | Train Loss: 0.3940 | Train Acc: 0.9226
 Site-MNIST_M                   (0) | Train Loss: 0.6965 | Train Acc: 0.8177
 Site-MNIST_M                   (0) | Train Loss: 0.7121 | Train Acc: 0.8135
 Site-SVHN                      (3) | Train Loss: 0.9582 | Train Acc: 0.6738
Average Train Accuracy: 0.9045
 Site-MNIST                     (1) | Val  Loss: 0.0106 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0285 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4759 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5160 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3174 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2093 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1743 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1887 | Val  Acc: 0.9216
 Site-MNIST                     (1) | Val  Loss: 0.2304 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2190 | Val  Acc: 0.9486
 Site-USPS                      (2) | Val  Loss: 0.1207 | Val  Acc: 0.9000
 Site-USPS                      (2) | Val  Loss: 0.4705 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.5096 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.4219 | Val  Acc: 0.8276
 Site-USPS                      (2) | Val  Loss: 0.3492 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2718 | Val  Acc: 0.8942
 Site-SynthDigits               (3) | Val  Loss: 0.4212 | Val  Acc: 0.8919
 Site-SynthDigits               (3) | Val  Loss: 0.3211 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.4181 | Val  Acc: 0.8852
 Site-MNIST_M                   (0) | Val  Loss: 0.7735 | Val  Acc: 0.8667
 Site-MNIST_M                   (0) | Val  Loss: 0.6470 | Val  Acc: 0.8889
 Site-SVHN                      (3) | Val  Loss: 0.7359 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8840
============ Train epoch 39 ============
cnt=[10, 4, 2, 6, ]
cnt=[10, 6, 2, 4, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                     (0) | Train Loss: 0.5231 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.3096 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1388 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1391 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3681 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1595 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1866 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2080 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2186 | Train Acc: 0.9429
 Site-MNIST                     (0) | Train Loss: 0.1788 | Train Acc: 0.9600
 Site-USPS                      (3) | Train Loss: 0.2562 | Train Acc: 0.9500
 Site-USPS                      (3) | Train Loss: 0.2575 | Train Acc: 0.9306
 Site-USPS                      (3) | Train Loss: 0.3563 | Train Acc: 0.9302
 Site-USPS                      (3) | Train Loss: 0.3005 | Train Acc: 0.8970
 Site-USPS                      (3) | Train Loss: 0.2199 | Train Acc: 0.9405
 Site-USPS                      (3) | Train Loss: 0.2418 | Train Acc: 0.9405
 Site-SynthDigits               (1) | Train Loss: 0.5320 | Train Acc: 0.8609
 Site-SynthDigits               (1) | Train Loss: 0.4626 | Train Acc: 0.8974
 Site-SynthDigits               (1) | Train Loss: 0.3972 | Train Acc: 0.9185
 Site-MNIST_M                   (2) | Train Loss: 0.6900 | Train Acc: 0.8343
 Site-MNIST_M                   (2) | Train Loss: 0.6622 | Train Acc: 0.8135
 Site-SVHN                      (1) | Train Loss: 0.9455 | Train Acc: 0.6773
Average Train Accuracy: 0.9077
 Site-MNIST                     (0) | Val  Loss: 0.0098 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0260 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4573 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.4962 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3097 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2096 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1769 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1886 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2305 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2193 | Val  Acc: 0.9517
 Site-USPS                      (3) | Val  Loss: 0.1078 | Val  Acc: 0.9000
 Site-USPS                      (3) | Val  Loss: 0.4472 | Val  Acc: 0.7778
 Site-USPS                      (3) | Val  Loss: 0.4750 | Val  Acc: 0.7812
 Site-USPS                      (3) | Val  Loss: 0.4058 | Val  Acc: 0.8276
 Site-USPS                      (3) | Val  Loss: 0.3343 | Val  Acc: 0.8952
 Site-USPS                      (3) | Val  Loss: 0.2570 | Val  Acc: 0.9048
 Site-SynthDigits               (1) | Val  Loss: 0.4106 | Val  Acc: 0.8919
 Site-SynthDigits               (1) | Val  Loss: 0.3132 | Val  Acc: 0.9265
 Site-SynthDigits               (1) | Val  Loss: 0.4067 | Val  Acc: 0.8852
 Site-MNIST_M                   (2) | Val  Loss: 0.7481 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.6332 | Val  Acc: 0.8889
 Site-SVHN                      (1) | Val  Loss: 0.7293 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8846
============ Train epoch 40 ============
cnt=[6, 10, 2, 4, ]
cnt=[6, 10, 3, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                     (1) | Train Loss: 0.5552 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3010 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1392 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1351 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.3674 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1595 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1716 | Train Acc: 0.9648
 Site-MNIST                     (1) | Train Loss: 0.2106 | Train Acc: 0.9438
 Site-MNIST                     (1) | Train Loss: 0.2140 | Train Acc: 0.9457
 Site-MNIST                     (1) | Train Loss: 0.1766 | Train Acc: 0.9600
 Site-USPS                      (0) | Train Loss: 0.2359 | Train Acc: 0.9750
 Site-USPS                      (0) | Train Loss: 0.1953 | Train Acc: 0.9306
 Site-USPS                      (0) | Train Loss: 0.2136 | Train Acc: 0.9380
 Site-USPS                      (0) | Train Loss: 0.3023 | Train Acc: 0.8884
 Site-USPS                      (0) | Train Loss: 0.2200 | Train Acc: 0.9429
 Site-USPS                      (0) | Train Loss: 0.2390 | Train Acc: 0.9392
 Site-SynthDigits               (3) | Train Loss: 0.5501 | Train Acc: 0.8675
 Site-SynthDigits               (3) | Train Loss: 0.4300 | Train Acc: 0.9084
 Site-SynthDigits               (3) | Train Loss: 0.3842 | Train Acc: 0.9185
 Site-MNIST_M                   (2) | Train Loss: 0.6931 | Train Acc: 0.8343
 Site-MNIST_M                   (2) | Train Loss: 0.6273 | Train Acc: 0.8135
 Site-SVHN                      (3) | Train Loss: 0.9556 | Train Acc: 0.7092
Average Train Accuracy: 0.9108
 Site-MNIST                     (1) | Val  Loss: 0.0097 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0265 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4547 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4910 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3060 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.2051 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1725 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1855 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2270 | Val  Acc: 0.9399
 Site-MNIST                     (1) | Val  Loss: 0.2181 | Val  Acc: 0.9486
 Site-USPS                      (0) | Val  Loss: 0.1058 | Val  Acc: 1.0000
 Site-USPS                      (0) | Val  Loss: 0.4413 | Val  Acc: 0.7778
 Site-USPS                      (0) | Val  Loss: 0.4730 | Val  Acc: 0.7812
 Site-USPS                      (0) | Val  Loss: 0.4018 | Val  Acc: 0.8276
 Site-USPS                      (0) | Val  Loss: 0.3363 | Val  Acc: 0.8857
 Site-USPS                      (0) | Val  Loss: 0.2575 | Val  Acc: 0.8995
 Site-SynthDigits               (3) | Val  Loss: 0.3966 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.3025 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.3976 | Val  Acc: 0.8934
 Site-MNIST_M                   (2) | Val  Loss: 0.7607 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.6389 | Val  Acc: 0.9012
 Site-SVHN                      (3) | Val  Loss: 0.7200 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8910
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9399
 Best site-MNIST                    (1)  | Epoch:40 | Val Acc: 0.9486
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 1.0000
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.7778
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.7812
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8276
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8857
 Best site-USPS                     (0)  | Epoch:40 | Val Acc: 0.8995
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.9265
 Best site-SynthDigits              (3)  | Epoch:40 | Val Acc: 0.8934
 Best site-MNIST_M                  (2)  | Epoch:40 | Val Acc: 0.8667
 Best site-MNIST_M                  (2)  | Epoch:40 | Val Acc: 0.9012
 Best site-SVHN                     (3)  | Epoch:40 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 41 ============
cnt=[10, 6, 2, 4, ]
cnt=[4, 10, 6, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                     (0) | Train Loss: 0.5480 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2939 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1311 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1352 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.1562 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1498 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1590 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2242 | Train Acc: 0.9413
 Site-MNIST                     (0) | Train Loss: 0.2069 | Train Acc: 0.9443
 Site-MNIST                     (0) | Train Loss: 0.1710 | Train Acc: 0.9592
 Site-USPS                      (1) | Train Loss: 0.2421 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.1736 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.2047 | Train Acc: 0.9225
 Site-USPS                      (1) | Train Loss: 0.2913 | Train Acc: 0.8841
 Site-USPS                      (1) | Train Loss: 0.2228 | Train Acc: 0.9405
 Site-USPS                      (1) | Train Loss: 0.2414 | Train Acc: 0.9418
 Site-SynthDigits               (3) | Train Loss: 0.5139 | Train Acc: 0.8609
 Site-SynthDigits               (3) | Train Loss: 0.3948 | Train Acc: 0.9084
 Site-SynthDigits               (3) | Train Loss: 0.3725 | Train Acc: 0.9246
 Site-MNIST_M                   (2) | Train Loss: 0.6925 | Train Acc: 0.8122
 Site-MNIST_M                   (2) | Train Loss: 0.6980 | Train Acc: 0.7951
 Site-SVHN                      (3) | Train Loss: 0.9001 | Train Acc: 0.6844
Average Train Accuracy: 0.9068
 Site-MNIST                     (0) | Val  Loss: 0.0100 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0281 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4696 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5040 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3100 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.2008 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1658 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1805 | Val  Acc: 0.9314
 Site-MNIST                     (0) | Val  Loss: 0.2229 | Val  Acc: 0.9344
 Site-MNIST                     (0) | Val  Loss: 0.2146 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.1035 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4511 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.4859 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.4027 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3378 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2615 | Val  Acc: 0.8995
 Site-SynthDigits               (3) | Val  Loss: 0.3884 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2869 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.3882 | Val  Acc: 0.9016
 Site-MNIST_M                   (2) | Val  Loss: 0.7554 | Val  Acc: 0.8667
 Site-MNIST_M                   (2) | Val  Loss: 0.6321 | Val  Acc: 0.9012
 Site-SVHN                      (3) | Val  Loss: 0.7067 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8935
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9314
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9344
 Best site-MNIST                    (0)  | Epoch:41 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8333
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.7812
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8857
 Best site-USPS                     (1)  | Epoch:41 | Val Acc: 0.8995
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9189
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9265
 Best site-SynthDigits              (3)  | Epoch:41 | Val Acc: 0.9016
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.8667
 Best site-MNIST_M                  (2)  | Epoch:41 | Val Acc: 0.9012
 Best site-SVHN                     (3)  | Epoch:41 | Val Acc: 0.7429
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 42 ============
cnt=[10, 6, 4, 2, ]
cnt=[1, 6, 6, 9, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                     (0) | Train Loss: 0.5315 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2950 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1316 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1361 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3603 | Train Acc: 0.9143
 Site-MNIST                     (0) | Train Loss: 0.1524 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1609 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2296 | Train Acc: 0.9389
 Site-MNIST                     (0) | Train Loss: 0.2063 | Train Acc: 0.9429
 Site-MNIST                     (0) | Train Loss: 0.1696 | Train Acc: 0.9600
 Site-USPS                      (1) | Train Loss: 0.2435 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2189 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.9418 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2792 | Train Acc: 0.9013
 Site-USPS                      (1) | Train Loss: 0.2177 | Train Acc: 0.9429
 Site-USPS                      (1) | Train Loss: 0.2384 | Train Acc: 0.9378
 Site-SynthDigits               (2) | Train Loss: 0.5343 | Train Acc: 0.8874
 Site-SynthDigits               (2) | Train Loss: 0.4329 | Train Acc: 0.9084
 Site-SynthDigits               (2) | Train Loss: 0.3719 | Train Acc: 0.9226
 Site-MNIST_M                   (3) | Train Loss: 0.6614 | Train Acc: 0.8177
 Site-MNIST_M                   (3) | Train Loss: 0.6787 | Train Acc: 0.8196
 Site-SVHN                      (2) | Train Loss: 0.9127 | Train Acc: 0.6950
Average Train Accuracy: 0.9103
 Site-MNIST                     (0) | Val  Loss: 0.0089 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0279 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4946 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5126 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3187 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1989 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1651 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1791 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2219 | Val  Acc: 0.9399
 Site-MNIST                     (0) | Val  Loss: 0.2137 | Val  Acc: 0.9456
 Site-USPS                      (1) | Val  Loss: 0.0929 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4293 | Val  Acc: 0.8889
 Site-USPS                      (1) | Val  Loss: 0.4685 | Val  Acc: 0.8125
 Site-USPS                      (1) | Val  Loss: 0.4010 | Val  Acc: 0.8276
 Site-USPS                      (1) | Val  Loss: 0.3358 | Val  Acc: 0.8762
 Site-USPS                      (1) | Val  Loss: 0.2554 | Val  Acc: 0.8942
 Site-SynthDigits               (2) | Val  Loss: 0.3934 | Val  Acc: 0.8919
 Site-SynthDigits               (2) | Val  Loss: 0.2827 | Val  Acc: 0.9265
 Site-SynthDigits               (2) | Val  Loss: 0.3794 | Val  Acc: 0.9016
 Site-MNIST_M                   (3) | Val  Loss: 0.7111 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.6038 | Val  Acc: 0.9012
 Site-SVHN                      (2) | Val  Loss: 0.7206 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8960
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 1.0000
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.8000
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.7778
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.8824
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9355
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9643
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9216
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9399
 Best site-MNIST                    (0)  | Epoch:42 | Val Acc: 0.9456
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 1.0000
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8889
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8125
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8276
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8762
 Best site-USPS                     (1)  | Epoch:42 | Val Acc: 0.8942
 Best site-SynthDigits              (2)  | Epoch:42 | Val Acc: 0.8919
 Best site-SynthDigits              (2)  | Epoch:42 | Val Acc: 0.9265
 Best site-SynthDigits              (2)  | Epoch:42 | Val Acc: 0.9016
 Best site-MNIST_M                  (3)  | Epoch:42 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:42 | Val Acc: 0.9012
 Best site-SVHN                     (2)  | Epoch:42 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 43 ============
cnt=[10, 6, 2, 4, ]
cnt=[4, 10, 2, 6, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                     (0) | Train Loss: 0.5165 | Train Acc: 0.8333
 Site-MNIST                     (0) | Train Loss: 0.2987 | Train Acc: 0.9167
 Site-MNIST                     (0) | Train Loss: 0.1280 | Train Acc: 0.9524
 Site-MNIST                     (0) | Train Loss: 0.1391 | Train Acc: 0.9737
 Site-MNIST                     (0) | Train Loss: 0.3538 | Train Acc: 0.9286
 Site-MNIST                     (0) | Train Loss: 0.1494 | Train Acc: 0.9683
 Site-MNIST                     (0) | Train Loss: 0.1558 | Train Acc: 0.9648
 Site-MNIST                     (0) | Train Loss: 0.2012 | Train Acc: 0.9438
 Site-MNIST                     (0) | Train Loss: 0.2126 | Train Acc: 0.9443
 Site-MNIST                     (0) | Train Loss: 0.1676 | Train Acc: 0.9623
 Site-USPS                      (1) | Train Loss: 0.2272 | Train Acc: 0.9750
 Site-USPS                      (1) | Train Loss: 0.2782 | Train Acc: 0.9167
 Site-USPS                      (1) | Train Loss: 0.5404 | Train Acc: 0.9380
 Site-USPS                      (1) | Train Loss: 0.2694 | Train Acc: 0.8884
 Site-USPS                      (1) | Train Loss: 0.2023 | Train Acc: 0.9500
 Site-USPS                      (1) | Train Loss: 0.2306 | Train Acc: 0.9365
 Site-SynthDigits               (3) | Train Loss: 0.4807 | Train Acc: 0.8609
 Site-SynthDigits               (3) | Train Loss: 0.4298 | Train Acc: 0.9121
 Site-SynthDigits               (3) | Train Loss: 0.3745 | Train Acc: 0.9226
 Site-MNIST_M                   (2) | Train Loss: 0.6441 | Train Acc: 0.8453
 Site-MNIST_M                   (2) | Train Loss: 0.6008 | Train Acc: 0.8440
 Site-SVHN                      (3) | Train Loss: 0.8831 | Train Acc: 0.6950
Average Train Accuracy: 0.9124
 Site-MNIST                     (0) | Val  Loss: 0.0085 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.0246 | Val  Acc: 1.0000
 Site-MNIST                     (0) | Val  Loss: 0.4918 | Val  Acc: 0.8000
 Site-MNIST                     (0) | Val  Loss: 0.5049 | Val  Acc: 0.7778
 Site-MNIST                     (0) | Val  Loss: 0.3159 | Val  Acc: 0.8824
 Site-MNIST                     (0) | Val  Loss: 0.1967 | Val  Acc: 0.9355
 Site-MNIST                     (0) | Val  Loss: 0.1645 | Val  Acc: 0.9643
 Site-MNIST                     (0) | Val  Loss: 0.1770 | Val  Acc: 0.9216
 Site-MNIST                     (0) | Val  Loss: 0.2200 | Val  Acc: 0.9454
 Site-MNIST                     (0) | Val  Loss: 0.2101 | Val  Acc: 0.9517
 Site-USPS                      (1) | Val  Loss: 0.0940 | Val  Acc: 1.0000
 Site-USPS                      (1) | Val  Loss: 0.4155 | Val  Acc: 0.8333
 Site-USPS                      (1) | Val  Loss: 0.4453 | Val  Acc: 0.7812
 Site-USPS                      (1) | Val  Loss: 0.3922 | Val  Acc: 0.8448
 Site-USPS                      (1) | Val  Loss: 0.3252 | Val  Acc: 0.8857
 Site-USPS                      (1) | Val  Loss: 0.2419 | Val  Acc: 0.9153
 Site-SynthDigits               (3) | Val  Loss: 0.3905 | Val  Acc: 0.9189
 Site-SynthDigits               (3) | Val  Loss: 0.2738 | Val  Acc: 0.9265
 Site-SynthDigits               (3) | Val  Loss: 0.3736 | Val  Acc: 0.9098
 Site-MNIST_M                   (2) | Val  Loss: 0.6905 | Val  Acc: 0.8444
 Site-MNIST_M                   (2) | Val  Loss: 0.5894 | Val  Acc: 0.9012
 Site-SVHN                      (3) | Val  Loss: 0.7244 | Val  Acc: 0.7429
Average Valid Accuracy: 0.8947
============ Train epoch 44 ============
cnt=[4, 10, 6, 2, ]
cnt=[3, 10, 6, 3, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                     (1) | Train Loss: 0.5289 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.2998 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1154 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1283 | Train Acc: 0.9737
 Site-MNIST                     (1) | Train Loss: 0.1746 | Train Acc: 0.9286
 Site-MNIST                     (1) | Train Loss: 0.1427 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1747 | Train Acc: 0.9692
 Site-MNIST                     (1) | Train Loss: 0.2060 | Train Acc: 0.9413
 Site-MNIST                     (1) | Train Loss: 0.2023 | Train Acc: 0.9389
 Site-MNIST                     (1) | Train Loss: 0.1630 | Train Acc: 0.9615
 Site-USPS                      (2) | Train Loss: 0.2261 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.2722 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1667 | Train Acc: 0.9380
 Site-USPS                      (2) | Train Loss: 0.2746 | Train Acc: 0.8841
 Site-USPS                      (2) | Train Loss: 0.2010 | Train Acc: 0.9524
 Site-USPS                      (2) | Train Loss: 0.2241 | Train Acc: 0.9405
 Site-SynthDigits               (0) | Train Loss: 0.5300 | Train Acc: 0.8742
 Site-SynthDigits               (0) | Train Loss: 0.4200 | Train Acc: 0.9158
 Site-SynthDigits               (0) | Train Loss: 0.3604 | Train Acc: 0.9185
 Site-MNIST_M                   (3) | Train Loss: 0.6387 | Train Acc: 0.8453
 Site-MNIST_M                   (3) | Train Loss: 0.6085 | Train Acc: 0.8379
 Site-SVHN                      (0) | Train Loss: 0.8707 | Train Acc: 0.7128
Average Train Accuracy: 0.9140
 Site-MNIST                     (1) | Val  Loss: 0.0099 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0244 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4768 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.4969 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3098 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1927 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1603 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1733 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2169 | Val  Acc: 0.9454
 Site-MNIST                     (1) | Val  Loss: 0.2058 | Val  Acc: 0.9517
 Site-USPS                      (2) | Val  Loss: 0.0993 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4171 | Val  Acc: 0.8333
 Site-USPS                      (2) | Val  Loss: 0.4482 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.3874 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3256 | Val  Acc: 0.8762
 Site-USPS                      (2) | Val  Loss: 0.2418 | Val  Acc: 0.9206
 Site-SynthDigits               (0) | Val  Loss: 0.3773 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2684 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.3693 | Val  Acc: 0.9262
 Site-MNIST_M                   (3) | Val  Loss: 0.7011 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.5912 | Val  Acc: 0.9012
 Site-SVHN                      (0) | Val  Loss: 0.7146 | Val  Acc: 0.7571
Average Valid Accuracy: 0.8973
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 1.0000
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.8000
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.7778
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.8824
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9355
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9643
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9314
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9454
 Best site-MNIST                    (1)  | Epoch:44 | Val Acc: 0.9517
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 1.0000
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 0.8333
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 0.7812
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 0.8448
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 0.8762
 Best site-USPS                     (2)  | Epoch:44 | Val Acc: 0.9206
 Best site-SynthDigits              (0)  | Epoch:44 | Val Acc: 0.9189
 Best site-SynthDigits              (0)  | Epoch:44 | Val Acc: 0.9265
 Best site-SynthDigits              (0)  | Epoch:44 | Val Acc: 0.9262
 Best site-MNIST_M                  (3)  | Epoch:44 | Val Acc: 0.8667
 Best site-MNIST_M                  (3)  | Epoch:44 | Val Acc: 0.9012
 Best site-SVHN                     (0)  | Epoch:44 | Val Acc: 0.7571
 Saving the gmap checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven_1.8_0_cluster_4/ccop_q=1...
============ Train epoch 45 ============
cnt=[4, 10, 6, 2, ]
cnt=[6, 10, 2, 4, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                     (1) | Train Loss: 0.5113 | Train Acc: 0.8333
 Site-MNIST                     (1) | Train Loss: 0.3062 | Train Acc: 0.9167
 Site-MNIST                     (1) | Train Loss: 0.1060 | Train Acc: 0.9524
 Site-MNIST                     (1) | Train Loss: 0.1314 | Train Acc: 0.9474
 Site-MNIST                     (1) | Train Loss: 0.1900 | Train Acc: 0.9143
 Site-MNIST                     (1) | Train Loss: 0.1361 | Train Acc: 0.9683
 Site-MNIST                     (1) | Train Loss: 0.1607 | Train Acc: 0.9692
 Site-MNIST                     (1) | Train Loss: 0.2060 | Train Acc: 0.9364
 Site-MNIST                     (1) | Train Loss: 0.1964 | Train Acc: 0.9375
 Site-MNIST                     (1) | Train Loss: 0.1582 | Train Acc: 0.9608
 Site-USPS                      (2) | Train Loss: 0.2379 | Train Acc: 0.9750
 Site-USPS                      (2) | Train Loss: 0.4642 | Train Acc: 0.9306
 Site-USPS                      (2) | Train Loss: 0.1636 | Train Acc: 0.9225
 Site-USPS                      (2) | Train Loss: 0.2887 | Train Acc: 0.8927
 Site-USPS                      (2) | Train Loss: 0.2075 | Train Acc: 0.9548
 Site-USPS                      (2) | Train Loss: 0.2242 | Train Acc: 0.9392
 Site-SynthDigits               (0) | Train Loss: 0.4533 | Train Acc: 0.8808
 Site-SynthDigits               (0) | Train Loss: 0.4019 | Train Acc: 0.9048
 Site-SynthDigits               (0) | Train Loss: 0.3562 | Train Acc: 0.9246
 Site-MNIST_M                   (3) | Train Loss: 0.6274 | Train Acc: 0.8564
 Site-MNIST_M                   (3) | Train Loss: 0.5867 | Train Acc: 0.8379
 Site-SVHN                      (0) | Train Loss: 0.8638 | Train Acc: 0.7021
Average Train Accuracy: 0.9117
 Site-MNIST                     (1) | Val  Loss: 0.0103 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.0254 | Val  Acc: 1.0000
 Site-MNIST                     (1) | Val  Loss: 0.4922 | Val  Acc: 0.8000
 Site-MNIST                     (1) | Val  Loss: 0.5088 | Val  Acc: 0.7778
 Site-MNIST                     (1) | Val  Loss: 0.3149 | Val  Acc: 0.8824
 Site-MNIST                     (1) | Val  Loss: 0.1907 | Val  Acc: 0.9355
 Site-MNIST                     (1) | Val  Loss: 0.1570 | Val  Acc: 0.9643
 Site-MNIST                     (1) | Val  Loss: 0.1700 | Val  Acc: 0.9314
 Site-MNIST                     (1) | Val  Loss: 0.2153 | Val  Acc: 0.9344
 Site-MNIST                     (1) | Val  Loss: 0.2029 | Val  Acc: 0.9426
 Site-USPS                      (2) | Val  Loss: 0.0940 | Val  Acc: 1.0000
 Site-USPS                      (2) | Val  Loss: 0.4145 | Val  Acc: 0.7778
 Site-USPS                      (2) | Val  Loss: 0.4511 | Val  Acc: 0.7812
 Site-USPS                      (2) | Val  Loss: 0.3851 | Val  Acc: 0.8448
 Site-USPS                      (2) | Val  Loss: 0.3233 | Val  Acc: 0.8857
 Site-USPS                      (2) | Val  Loss: 0.2421 | Val  Acc: 0.9048
 Site-SynthDigits               (0) | Val  Loss: 0.3743 | Val  Acc: 0.9189
 Site-SynthDigits               (0) | Val  Loss: 0.2699 | Val  Acc: 0.9265
 Site-SynthDigits               (0) | Val  Loss: 0.3665 | Val  Acc: 0.9098
 Site-MNIST_M                   (3) | Val  Loss: 0.6838 | Val  Acc: 0.8667
 Site-MNIST_M                   (3) | Val  Loss: 0.5760 | Val  Acc: 0.9012
 Site-SVHN                      (0) | Val  Loss: 0.7015 | Val  Acc: 0.7714
Average Valid Accuracy: 0.8935
 Test site-MNIST                     (1)| Epoch:44 | Test Acc: 0.9420
 Test site-USPS                      (2)| Epoch:44 | Test Acc: 0.9409
 Test site-SynthDigits               (0)| Epoch:44 | Test Acc: 0.8876
 Test site-MNIST_M                   (3)| Epoch:44 | Test Acc: 0.7200
 Test site-SVHN                      (0)| Epoch:44 | Test Acc: 0.6207
MNIST: 0.9420, USPS: 0.9409, SynthDigits: 0.8876, MNIST_M: 0.7200, SVHN: 0.6207, 
Average Test Accuracy(group): 0.8222, Average Test Accuracy(individual): 0.8995,
domain std=0.1294, cluster std=0.0926, individual std=0.0881, 
===2023-08-02 16:42:59===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 10
    wk_iters: 1
    si: False
    domain_num: 4
    quantile: 0
    power_cs: 1
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix5: False
    power_relu: 1
    Ea_val: False
data_number=[6,12,21,38,70,126,227,409,736,1325,40,72,129,233,420,756,151,273,491,181,327,282,
client_nums=[10,6,3,2,1,]
len_dataset=[3719,2066,1147,637,353,]
domain number = 4
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:44 | Test Acc: 0.9424
 Test site-USPS                      (2)| Epoch:44 | Test Acc: 0.9441
 Test site-SynthDigits               (0)| Epoch:44 | Test Acc: 0.8849
 Test site-MNIST_M                   (3)| Epoch:44 | Test Acc: 0.7186
 Test site-SVHN                      (0)| Epoch:44 | Test Acc: 0.6189
MNIST: 0.9424, USPS: 0.9441, SynthDigits: 0.8849, MNIST_M: 0.7186, SVHN: 0.6189, 
Average Test Accuracy(group): 0.8218, Average Test Accuracy(individual): 0.9000,
domain std=0.1306, cluster std=0.0942, individual std=0.0892, 
