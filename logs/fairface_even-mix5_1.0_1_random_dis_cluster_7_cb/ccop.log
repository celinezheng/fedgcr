===2023-06-15 16:44:44===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[64,192,64,192,64,192,64,192,64,192,64,192,64,192,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[856,856,856,856,856,856,856,]
domain number = 7
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[4, 4, 1, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
min_w=0.12500, quan_i=1.00, quan_c=1.00
minimize weight of clients:[]
 Site-White_utk                 (0) | Train Loss: 2.3828 | Train Acc: 0.1094
 Site-White_utk                 (0) | Train Loss: 2.4062 | Train Acc: 0.1146
 Site-East_Asian                (1) | Train Loss: 1.9410 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.8786 | Train Acc: 0.3750
 Site-Indian_utk                (0) | Train Loss: 1.9379 | Train Acc: 0.3750
 Site-Indian_utk                (0) | Train Loss: 1.9929 | Train Acc: 0.3490
 Site-Black_utk                 (5) | Train Loss: 1.9628 | Train Acc: 0.3281
 Site-Black_utk                 (5) | Train Loss: 1.9721 | Train Acc: 0.3177
 Site-Southeast_Asian           (1) | Train Loss: 2.0075 | Train Acc: 0.3125
 Site-Southeast_Asian           (1) | Train Loss: 2.0710 | Train Acc: 0.2917
 Site-Asian_ffhq                (2) | Train Loss: 1.6153 | Train Acc: 0.7031
 Site-Asian_ffhq                (3) | Train Loss: 1.2610 | Train Acc: 0.7396
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.2868 | Train Acc: 0.8906
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.6543 | Train Acc: 0.3646
Average Train Accuracy: 0.4055
 Site-White_utk                 (0) | Val  Loss: 2.3933 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.3965 | Val  Acc: 0.1094
 Site-East_Asian                (1) | Val  Loss: 1.9978 | Val  Acc: 0.2857
 Site-East_Asian                (1) | Val  Loss: 1.8852 | Val  Acc: 0.3906
 Site-Indian_utk                (0) | Val  Loss: 1.9418 | Val  Acc: 0.3571
 Site-Indian_utk                (0) | Val  Loss: 1.9493 | Val  Acc: 0.3594
 Site-Black_utk                 (5) | Val  Loss: 2.0100 | Val  Acc: 0.2619
 Site-Black_utk                 (5) | Val  Loss: 2.0121 | Val  Acc: 0.3047
 Site-Southeast_Asian           (1) | Val  Loss: 2.0950 | Val  Acc: 0.3333
 Site-Southeast_Asian           (1) | Val  Loss: 2.0557 | Val  Acc: 0.3203
 Site-Asian_ffhq                (2) | Val  Loss: 1.1626 | Val  Acc: 0.9286
 Site-Asian_ffhq                (3) | Val  Loss: 1.3479 | Val  Acc: 0.6250
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.3453 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7617 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3391
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:0 | Val Acc: 0.1094
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.2857
 Best site-East_Asian               (1)  | Epoch:0 | Val Acc: 0.3906
 Best site-Indian_utk               (0)  | Epoch:0 | Val Acc: 0.3571
 Best site-Indian_utk               (0)  | Epoch:0 | Val Acc: 0.3594
 Best site-Black_utk                (5)  | Epoch:0 | Val Acc: 0.2619
 Best site-Black_utk                (5)  | Epoch:0 | Val Acc: 0.3047
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.3333
 Best site-Southeast_Asian          (1)  | Epoch:0 | Val Acc: 0.3203
 Best site-Asian_ffhq               (2)  | Epoch:0 | Val Acc: 0.9286
 Best site-Asian_ffhq               (3)  | Epoch:0 | Val Acc: 0.6250
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:0 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:0 | Val Acc: 0.3281
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 1, 4, 1, 3, 1, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
min_w=0.48217, quan_i=2.00, quan_c=2.00
minimize weight of clients:[2, 3, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 2.2172 | Train Acc: 0.1250
 Site-White_utk                 (0) | Train Loss: 2.2675 | Train Acc: 0.1042
 Site-East_Asian                (2) | Train Loss: 1.8942 | Train Acc: 0.4062
 Site-East_Asian                (5) | Train Loss: 1.8848 | Train Acc: 0.3802
 Site-Indian_utk                (3) | Train Loss: 1.9467 | Train Acc: 0.3750
 Site-Indian_utk                (3) | Train Loss: 1.9500 | Train Acc: 0.3490
 Site-Black_utk                 (3) | Train Loss: 1.9237 | Train Acc: 0.3438
 Site-Black_utk                 (3) | Train Loss: 1.9553 | Train Acc: 0.3125
 Site-Southeast_Asian           (5) | Train Loss: 2.0042 | Train Acc: 0.3281
 Site-Southeast_Asian           (5) | Train Loss: 2.0105 | Train Acc: 0.3073
 Site-Asian_ffhq                (4) | Train Loss: 1.6189 | Train Acc: 0.7031
 Site-Asian_ffhq                (1) | Train Loss: 1.3986 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.3644 | Train Acc: 0.8750
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.7295 | Train Acc: 0.3594
Average Train Accuracy: 0.4085
 Site-White_utk                 (0) | Val  Loss: 2.2106 | Val  Acc: 0.1190
 Site-White_utk                 (0) | Val  Loss: 2.2492 | Val  Acc: 0.1094
 Site-East_Asian                (2) | Val  Loss: 2.0044 | Val  Acc: 0.2619
 Site-East_Asian                (5) | Val  Loss: 1.8816 | Val  Acc: 0.3750
 Site-Indian_utk                (3) | Val  Loss: 1.9444 | Val  Acc: 0.3571
 Site-Indian_utk                (3) | Val  Loss: 1.9227 | Val  Acc: 0.3672
 Site-Black_utk                 (3) | Val  Loss: 1.9954 | Val  Acc: 0.3095
 Site-Black_utk                 (3) | Val  Loss: 1.9956 | Val  Acc: 0.2891
 Site-Southeast_Asian           (5) | Val  Loss: 2.0457 | Val  Acc: 0.3333
 Site-Southeast_Asian           (5) | Val  Loss: 2.0343 | Val  Acc: 0.3281
 Site-Asian_ffhq                (4) | Val  Loss: 1.3155 | Val  Acc: 0.9286
 Site-Asian_ffhq                (1) | Val  Loss: 1.4617 | Val  Acc: 0.6562
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.3057 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7980 | Val  Acc: 0.3359
Average Valid Accuracy: 0.3407
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1190
 Best site-White_utk                (0)  | Epoch:1 | Val Acc: 0.1094
 Best site-East_Asian               (2)  | Epoch:1 | Val Acc: 0.2619
 Best site-East_Asian               (5)  | Epoch:1 | Val Acc: 0.3750
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3571
 Best site-Indian_utk               (3)  | Epoch:1 | Val Acc: 0.3672
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.3095
 Best site-Black_utk                (3)  | Epoch:1 | Val Acc: 0.2891
 Best site-Southeast_Asian          (5)  | Epoch:1 | Val Acc: 0.3333
 Best site-Southeast_Asian          (5)  | Epoch:1 | Val Acc: 0.3281
 Best site-Asian_ffhq               (4)  | Epoch:1 | Val Acc: 0.9286
 Best site-Asian_ffhq               (1)  | Epoch:1 | Val Acc: 0.6562
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:1 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:1 | Val Acc: 0.3359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 1, 2, 2, 3, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
min_w=0.38073, quan_i=1.97, quan_c=1.97
minimize weight of clients:[2, 3, 4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 2.1596 | Train Acc: 0.1094
 Site-White_utk                 (0) | Train Loss: 2.2121 | Train Acc: 0.1146
 Site-East_Asian                (1) | Train Loss: 1.8658 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.8549 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.9068 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 1.9286 | Train Acc: 0.3385
 Site-Black_utk                 (3) | Train Loss: 1.9358 | Train Acc: 0.2969
 Site-Black_utk                 (3) | Train Loss: 1.9496 | Train Acc: 0.3281
 Site-Southeast_Asian           (6) | Train Loss: 2.0009 | Train Acc: 0.3125
 Site-Southeast_Asian           (6) | Train Loss: 1.9687 | Train Acc: 0.3125
 Site-Asian_ffhq                (5) | Train Loss: 1.5922 | Train Acc: 0.7031
 Site-Asian_ffhq                (5) | Train Loss: 1.4020 | Train Acc: 0.7448
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3472 | Train Acc: 0.8906
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.7414 | Train Acc: 0.3542
Average Train Accuracy: 0.4055
 Site-White_utk                 (0) | Val  Loss: 2.1806 | Val  Acc: 0.1429
 Site-White_utk                 (0) | Val  Loss: 2.1706 | Val  Acc: 0.1328
 Site-East_Asian                (1) | Val  Loss: 1.9531 | Val  Acc: 0.2619
 Site-East_Asian                (1) | Val  Loss: 1.8604 | Val  Acc: 0.3984
 Site-Indian_utk                (4) | Val  Loss: 1.9132 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8916 | Val  Acc: 0.3672
 Site-Black_utk                 (3) | Val  Loss: 1.9377 | Val  Acc: 0.3095
 Site-Black_utk                 (3) | Val  Loss: 1.9514 | Val  Acc: 0.3203
 Site-Southeast_Asian           (6) | Val  Loss: 1.9483 | Val  Acc: 0.3333
 Site-Southeast_Asian           (6) | Val  Loss: 1.9861 | Val  Acc: 0.3125
 Site-Asian_ffhq                (5) | Val  Loss: 1.3087 | Val  Acc: 0.9286
 Site-Asian_ffhq                (5) | Val  Loss: 1.4639 | Val  Acc: 0.6484
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.3185 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8251 | Val  Acc: 0.3438
Average Valid Accuracy: 0.3469
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.1429
 Best site-White_utk                (0)  | Epoch:2 | Val Acc: 0.1328
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.2619
 Best site-East_Asian               (1)  | Epoch:2 | Val Acc: 0.3984
 Best site-Indian_utk               (4)  | Epoch:2 | Val Acc: 0.3571
 Best site-Indian_utk               (4)  | Epoch:2 | Val Acc: 0.3672
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3095
 Best site-Black_utk                (3)  | Epoch:2 | Val Acc: 0.3203
 Best site-Southeast_Asian          (6)  | Epoch:2 | Val Acc: 0.3333
 Best site-Southeast_Asian          (6)  | Epoch:2 | Val Acc: 0.3125
 Best site-Asian_ffhq               (5)  | Epoch:2 | Val Acc: 0.9286
 Best site-Asian_ffhq               (5)  | Epoch:2 | Val Acc: 0.6484
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:2 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:2 | Val Acc: 0.3438
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 3 ============
cnt=[4, 2, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
min_w=0.44995, quan_i=1.96, quan_c=1.97
minimize weight of clients:[2, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (4) | Train Loss: 2.1269 | Train Acc: 0.1406
 Site-White_utk                 (4) | Train Loss: 2.1859 | Train Acc: 0.1302
 Site-East_Asian                (0) | Train Loss: 1.8149 | Train Acc: 0.4062
 Site-East_Asian                (0) | Train Loss: 1.8103 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.8629 | Train Acc: 0.3906
 Site-Indian_utk                (4) | Train Loss: 1.8593 | Train Acc: 0.3438
 Site-Black_utk                 (1) | Train Loss: 1.8893 | Train Acc: 0.3281
 Site-Black_utk                 (1) | Train Loss: 1.9006 | Train Acc: 0.3385
 Site-Southeast_Asian           (0) | Train Loss: 1.9609 | Train Acc: 0.3125
 Site-Southeast_Asian           (0) | Train Loss: 1.9411 | Train Acc: 0.3125
 Site-Asian_ffhq                (2) | Train Loss: 1.5534 | Train Acc: 0.6719
 Site-Asian_ffhq                (3) | Train Loss: 1.3080 | Train Acc: 0.7552
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2532 | Train Acc: 0.9219
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6948 | Train Acc: 0.3542
Average Train Accuracy: 0.4141
 Site-White_utk                 (4) | Val  Loss: 2.1283 | Val  Acc: 0.1190
 Site-White_utk                 (4) | Val  Loss: 2.1674 | Val  Acc: 0.1406
 Site-East_Asian                (0) | Val  Loss: 1.9910 | Val  Acc: 0.2857
 Site-East_Asian                (0) | Val  Loss: 1.8255 | Val  Acc: 0.3906
 Site-Indian_utk                (4) | Val  Loss: 1.8509 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8627 | Val  Acc: 0.3516
 Site-Black_utk                 (1) | Val  Loss: 1.9527 | Val  Acc: 0.2619
 Site-Black_utk                 (1) | Val  Loss: 1.9088 | Val  Acc: 0.3125
 Site-Southeast_Asian           (0) | Val  Loss: 1.9573 | Val  Acc: 0.3333
 Site-Southeast_Asian           (0) | Val  Loss: 1.9441 | Val  Acc: 0.3281
 Site-Asian_ffhq                (2) | Val  Loss: 1.1969 | Val  Acc: 0.9286
 Site-Asian_ffhq                (3) | Val  Loss: 1.3874 | Val  Acc: 0.6328
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.3910 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7560 | Val  Acc: 0.3516
Average Valid Accuracy: 0.3424
============ Train epoch 4 ============
cnt=[2, 4, 1, 1, 4, 1, 1, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
min_w=0.42023, quan_i=1.93, quan_c=1.94
minimize weight of clients:[2, 3, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (4) | Train Loss: 2.1520 | Train Acc: 0.1250
 Site-White_utk                 (4) | Train Loss: 2.1739 | Train Acc: 0.1354
 Site-East_Asian                (1) | Train Loss: 1.7554 | Train Acc: 0.4062
 Site-East_Asian                (1) | Train Loss: 1.7843 | Train Acc: 0.3854
 Site-Indian_utk                (4) | Train Loss: 1.8159 | Train Acc: 0.4062
 Site-Indian_utk                (4) | Train Loss: 1.8470 | Train Acc: 0.3438
 Site-Black_utk                 (0) | Train Loss: 1.8400 | Train Acc: 0.3281
 Site-Black_utk                 (0) | Train Loss: 1.8665 | Train Acc: 0.3333
 Site-Southeast_Asian           (1) | Train Loss: 1.9423 | Train Acc: 0.3438
 Site-Southeast_Asian           (1) | Train Loss: 1.9345 | Train Acc: 0.3177
 Site-Asian_ffhq                (5) | Train Loss: 1.5191 | Train Acc: 0.6719
 Site-Asian_ffhq                (3) | Train Loss: 1.2192 | Train Acc: 0.7604
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1785 | Train Acc: 0.9062
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.6586 | Train Acc: 0.3490
Average Train Accuracy: 0.4152
 Site-White_utk                 (4) | Val  Loss: 2.1083 | Val  Acc: 0.1667
 Site-White_utk                 (4) | Val  Loss: 2.1329 | Val  Acc: 0.1406
 Site-East_Asian                (1) | Val  Loss: 1.9771 | Val  Acc: 0.2381
 Site-East_Asian                (1) | Val  Loss: 1.7644 | Val  Acc: 0.3906
 Site-Indian_utk                (4) | Val  Loss: 1.8202 | Val  Acc: 0.3571
 Site-Indian_utk                (4) | Val  Loss: 1.8302 | Val  Acc: 0.3672
 Site-Black_utk                 (0) | Val  Loss: 1.9297 | Val  Acc: 0.3095
 Site-Black_utk                 (0) | Val  Loss: 1.9027 | Val  Acc: 0.3047
 Site-Southeast_Asian           (1) | Val  Loss: 1.9822 | Val  Acc: 0.3333
 Site-Southeast_Asian           (1) | Val  Loss: 1.9280 | Val  Acc: 0.3203
 Site-Asian_ffhq                (5) | Val  Loss: 1.1027 | Val  Acc: 0.9286
 Site-Asian_ffhq                (3) | Val  Loss: 1.3272 | Val  Acc: 0.6328
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.3805 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7471 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3441
============ Train epoch 5 ============
cnt=[2, 2, 4, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
min_w=0.40764, quan_i=1.89, quan_c=1.87
minimize weight of clients:[2, 3, 4, 5, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 2.0139 | Train Acc: 0.2188
 Site-White_utk                 (0) | Train Loss: 2.0751 | Train Acc: 0.1875
 Site-East_Asian                (2) | Train Loss: 1.7662 | Train Acc: 0.4219
 Site-East_Asian                (2) | Train Loss: 1.7744 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.7840 | Train Acc: 0.3750
 Site-Indian_utk                (3) | Train Loss: 1.7875 | Train Acc: 0.3802
 Site-Black_utk                 (4) | Train Loss: 1.8168 | Train Acc: 0.3438
 Site-Black_utk                 (4) | Train Loss: 1.8489 | Train Acc: 0.3438
 Site-Southeast_Asian           (2) | Train Loss: 1.9157 | Train Acc: 0.3281
 Site-Southeast_Asian           (2) | Train Loss: 1.9024 | Train Acc: 0.3281
 Site-Asian_ffhq                (5) | Train Loss: 1.5231 | Train Acc: 0.6719
 Site-Asian_ffhq                (1) | Train Loss: 1.2708 | Train Acc: 0.7448
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2214 | Train Acc: 0.9062
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.6584 | Train Acc: 0.3542
Average Train Accuracy: 0.4282
 Site-White_utk                 (0) | Val  Loss: 2.0218 | Val  Acc: 0.2143
 Site-White_utk                 (0) | Val  Loss: 2.0530 | Val  Acc: 0.1562
 Site-East_Asian                (2) | Val  Loss: 1.9093 | Val  Acc: 0.2619
 Site-East_Asian                (2) | Val  Loss: 1.7441 | Val  Acc: 0.3984
 Site-Indian_utk                (3) | Val  Loss: 1.8064 | Val  Acc: 0.3571
 Site-Indian_utk                (3) | Val  Loss: 1.7884 | Val  Acc: 0.3828
 Site-Black_utk                 (4) | Val  Loss: 1.8501 | Val  Acc: 0.3095
 Site-Black_utk                 (4) | Val  Loss: 1.8632 | Val  Acc: 0.3047
 Site-Southeast_Asian           (2) | Val  Loss: 1.9346 | Val  Acc: 0.3571
 Site-Southeast_Asian           (2) | Val  Loss: 1.9137 | Val  Acc: 0.3125
 Site-Asian_ffhq                (5) | Val  Loss: 1.1899 | Val  Acc: 0.9048
 Site-Asian_ffhq                (1) | Val  Loss: 1.3649 | Val  Acc: 0.6172
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.3004 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.7118 | Val  Acc: 0.3359
Average Valid Accuracy: 0.3509
 Best site-White_utk                (0)  | Epoch:5 | Val Acc: 0.2143
 Best site-White_utk                (0)  | Epoch:5 | Val Acc: 0.1562
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.2619
 Best site-East_Asian               (2)  | Epoch:5 | Val Acc: 0.3984
 Best site-Indian_utk               (3)  | Epoch:5 | Val Acc: 0.3571
 Best site-Indian_utk               (3)  | Epoch:5 | Val Acc: 0.3828
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3095
 Best site-Black_utk                (4)  | Epoch:5 | Val Acc: 0.3047
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3571
 Best site-Southeast_Asian          (2)  | Epoch:5 | Val Acc: 0.3125
 Best site-Asian_ffhq               (5)  | Epoch:5 | Val Acc: 0.9048
 Best site-Asian_ffhq               (1)  | Epoch:5 | Val Acc: 0.6172
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:5 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:5 | Val Acc: 0.3359
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 4, 1, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
min_w=0.40652, quan_i=1.86, quan_c=1.85
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 1.8939 | Train Acc: 0.2656
 Site-White_utk                 (0) | Train Loss: 1.9125 | Train Acc: 0.2656
 Site-East_Asian                (1) | Train Loss: 1.7162 | Train Acc: 0.4375
 Site-East_Asian                (1) | Train Loss: 1.7968 | Train Acc: 0.3802
 Site-Indian_utk                (4) | Train Loss: 1.8190 | Train Acc: 0.3750
 Site-Indian_utk                (4) | Train Loss: 1.7838 | Train Acc: 0.4115
 Site-Black_utk                 (6) | Train Loss: 1.7581 | Train Acc: 0.4844
 Site-Black_utk                 (6) | Train Loss: 1.8669 | Train Acc: 0.3229
 Site-Southeast_Asian           (1) | Train Loss: 1.9236 | Train Acc: 0.3281
 Site-Southeast_Asian           (1) | Train Loss: 1.8695 | Train Acc: 0.3333
 Site-Asian_ffhq                (3) | Train Loss: 1.6572 | Train Acc: 0.5469
 Site-Asian_ffhq                (5) | Train Loss: 1.4295 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3716 | Train Acc: 0.8438
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6770 | Train Acc: 0.3646
Average Train Accuracy: 0.4263
 Site-White_utk                 (0) | Val  Loss: 1.8885 | Val  Acc: 0.2857
 Site-White_utk                 (0) | Val  Loss: 1.8900 | Val  Acc: 0.2812
 Site-East_Asian                (1) | Val  Loss: 1.8322 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.7609 | Val  Acc: 0.3906
 Site-Indian_utk                (4) | Val  Loss: 1.7882 | Val  Acc: 0.4048
 Site-Indian_utk                (4) | Val  Loss: 1.8066 | Val  Acc: 0.3750
 Site-Black_utk                 (6) | Val  Loss: 1.8665 | Val  Acc: 0.4524
 Site-Black_utk                 (6) | Val  Loss: 1.8397 | Val  Acc: 0.3828
 Site-Southeast_Asian           (1) | Val  Loss: 1.9775 | Val  Acc: 0.2857
 Site-Southeast_Asian           (1) | Val  Loss: 1.8777 | Val  Acc: 0.3281
 Site-Asian_ffhq                (3) | Val  Loss: 1.4228 | Val  Acc: 0.5476
 Site-Asian_ffhq                (5) | Val  Loss: 1.4902 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.1234 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7213 | Val  Acc: 0.3828
Average Valid Accuracy: 0.3643
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.2857
 Best site-White_utk                (0)  | Epoch:6 | Val Acc: 0.2812
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:6 | Val Acc: 0.3906
 Best site-Indian_utk               (4)  | Epoch:6 | Val Acc: 0.4048
 Best site-Indian_utk               (4)  | Epoch:6 | Val Acc: 0.3750
 Best site-Black_utk                (6)  | Epoch:6 | Val Acc: 0.4524
 Best site-Black_utk                (6)  | Epoch:6 | Val Acc: 0.3828
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.2857
 Best site-Southeast_Asian          (1)  | Epoch:6 | Val Acc: 0.3281
 Best site-Asian_ffhq               (3)  | Epoch:6 | Val Acc: 0.5476
 Best site-Asian_ffhq               (5)  | Epoch:6 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:6 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:6 | Val Acc: 0.3828
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[4, 2, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
min_w=0.38679, quan_i=1.89, quan_c=1.85
minimize weight of clients:[2, 3, 4, 5, 10, 11, 12, 13, ]
 Site-White_utk                 (5) | Train Loss: 1.7882 | Train Acc: 0.2969
 Site-White_utk                 (5) | Train Loss: 1.8284 | Train Acc: 0.3333
 Site-East_Asian                (0) | Train Loss: 1.7036 | Train Acc: 0.4375
 Site-East_Asian                (0) | Train Loss: 1.7587 | Train Acc: 0.4010
 Site-Indian_utk                (4) | Train Loss: 1.7728 | Train Acc: 0.4062
 Site-Indian_utk                (4) | Train Loss: 1.7544 | Train Acc: 0.3854
 Site-Black_utk                 (1) | Train Loss: 1.7248 | Train Acc: 0.4375
 Site-Black_utk                 (1) | Train Loss: 1.8009 | Train Acc: 0.3958
 Site-Southeast_Asian           (0) | Train Loss: 1.8813 | Train Acc: 0.3438
 Site-Southeast_Asian           (0) | Train Loss: 1.8348 | Train Acc: 0.3646
 Site-Asian_ffhq                (6) | Train Loss: 1.7170 | Train Acc: 0.4688
 Site-Asian_ffhq                (3) | Train Loss: 1.4923 | Train Acc: 0.5521
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4710 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6754 | Train Acc: 0.3125
Average Train Accuracy: 0.4148
 Site-White_utk                 (5) | Val  Loss: 1.7565 | Val  Acc: 0.4524
 Site-White_utk                 (5) | Val  Loss: 1.8351 | Val  Acc: 0.2734
 Site-East_Asian                (0) | Val  Loss: 1.8813 | Val  Acc: 0.2857
 Site-East_Asian                (0) | Val  Loss: 1.7312 | Val  Acc: 0.4141
 Site-Indian_utk                (4) | Val  Loss: 1.7859 | Val  Acc: 0.4286
 Site-Indian_utk                (4) | Val  Loss: 1.7905 | Val  Acc: 0.3516
 Site-Black_utk                 (1) | Val  Loss: 1.8391 | Val  Acc: 0.3333
 Site-Black_utk                 (1) | Val  Loss: 1.8314 | Val  Acc: 0.3359
 Site-Southeast_Asian           (0) | Val  Loss: 1.9489 | Val  Acc: 0.3095
 Site-Southeast_Asian           (0) | Val  Loss: 1.8345 | Val  Acc: 0.3516
 Site-Asian_ffhq                (6) | Val  Loss: 1.4544 | Val  Acc: 0.7619
 Site-Asian_ffhq                (3) | Val  Loss: 1.5485 | Val  Acc: 0.4375
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.1003 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.7450 | Val  Acc: 0.3047
Average Valid Accuracy: 0.3668
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.4524
 Best site-White_utk                (5)  | Epoch:7 | Val Acc: 0.2734
 Best site-East_Asian               (0)  | Epoch:7 | Val Acc: 0.2857
 Best site-East_Asian               (0)  | Epoch:7 | Val Acc: 0.4141
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.4286
 Best site-Indian_utk               (4)  | Epoch:7 | Val Acc: 0.3516
 Best site-Black_utk                (1)  | Epoch:7 | Val Acc: 0.3333
 Best site-Black_utk                (1)  | Epoch:7 | Val Acc: 0.3359
 Best site-Southeast_Asian          (0)  | Epoch:7 | Val Acc: 0.3095
 Best site-Southeast_Asian          (0)  | Epoch:7 | Val Acc: 0.3516
 Best site-Asian_ffhq               (6)  | Epoch:7 | Val Acc: 0.7619
 Best site-Asian_ffhq               (3)  | Epoch:7 | Val Acc: 0.4375
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:7 | Val Acc: 0.0952
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:7 | Val Acc: 0.3047
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 4, 1, 2, 3, 1, 1, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
min_w=0.38352, quan_i=1.82, quan_c=1.82
minimize weight of clients:[4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 1.7359 | Train Acc: 0.3281
 Site-White_utk                 (0) | Train Loss: 1.8149 | Train Acc: 0.3229
 Site-East_Asian                (1) | Train Loss: 1.6265 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.7132 | Train Acc: 0.3802
 Site-Indian_utk                (6) | Train Loss: 1.6693 | Train Acc: 0.4219
 Site-Indian_utk                (4) | Train Loss: 1.6896 | Train Acc: 0.3802
 Site-Black_utk                 (4) | Train Loss: 1.6463 | Train Acc: 0.4688
 Site-Black_utk                 (4) | Train Loss: 1.7573 | Train Acc: 0.4010
 Site-Southeast_Asian           (1) | Train Loss: 1.8335 | Train Acc: 0.3750
 Site-Southeast_Asian           (1) | Train Loss: 1.8053 | Train Acc: 0.3333
 Site-Asian_ffhq                (2) | Train Loss: 1.5717 | Train Acc: 0.5312
 Site-Asian_ffhq                (3) | Train Loss: 1.3748 | Train Acc: 0.6198
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.2864 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6595 | Train Acc: 0.3281
Average Train Accuracy: 0.4397
 Site-White_utk                 (0) | Val  Loss: 1.7785 | Val  Acc: 0.3333
 Site-White_utk                 (0) | Val  Loss: 1.7795 | Val  Acc: 0.2891
 Site-East_Asian                (1) | Val  Loss: 1.8646 | Val  Acc: 0.2857
 Site-East_Asian                (1) | Val  Loss: 1.6982 | Val  Acc: 0.4062
 Site-Indian_utk                (6) | Val  Loss: 1.7013 | Val  Acc: 0.4286
 Site-Indian_utk                (4) | Val  Loss: 1.7295 | Val  Acc: 0.3906
 Site-Black_utk                 (4) | Val  Loss: 1.7548 | Val  Acc: 0.4524
 Site-Black_utk                 (4) | Val  Loss: 1.7878 | Val  Acc: 0.3516
 Site-Southeast_Asian           (1) | Val  Loss: 1.8572 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.8081 | Val  Acc: 0.3438
 Site-Asian_ffhq                (2) | Val  Loss: 1.2972 | Val  Acc: 0.6667
 Site-Asian_ffhq                (3) | Val  Loss: 1.4159 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 2.1331 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6984 | Val  Acc: 0.3125
Average Valid Accuracy: 0.3678
 Best site-White_utk                (0)  | Epoch:8 | Val Acc: 0.3333
 Best site-White_utk                (0)  | Epoch:8 | Val Acc: 0.2891
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.2857
 Best site-East_Asian               (1)  | Epoch:8 | Val Acc: 0.4062
 Best site-Indian_utk               (6)  | Epoch:8 | Val Acc: 0.4286
 Best site-Indian_utk               (4)  | Epoch:8 | Val Acc: 0.3906
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.4524
 Best site-Black_utk                (4)  | Epoch:8 | Val Acc: 0.3516
 Best site-Southeast_Asian          (1)  | Epoch:8 | Val Acc: 0.3571
 Best site-Southeast_Asian          (1)  | Epoch:8 | Val Acc: 0.3438
 Best site-Asian_ffhq               (2)  | Epoch:8 | Val Acc: 0.6667
 Best site-Asian_ffhq               (3)  | Epoch:8 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:8 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:8 | Val Acc: 0.3125
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[1, 4, 1, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
min_w=0.26409, quan_i=1.76, quan_c=1.76
minimize weight of clients:[4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (4) | Train Loss: 1.7489 | Train Acc: 0.2812
 Site-White_utk                 (4) | Train Loss: 1.7823 | Train Acc: 0.2865
 Site-East_Asian                (1) | Train Loss: 1.5757 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.6774 | Train Acc: 0.4010
 Site-Indian_utk                (5) | Train Loss: 1.5927 | Train Acc: 0.4375
 Site-Indian_utk                (5) | Train Loss: 1.6546 | Train Acc: 0.4375
 Site-Black_utk                 (6) | Train Loss: 1.6079 | Train Acc: 0.4062
 Site-Black_utk                 (0) | Train Loss: 1.6830 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.8578 | Train Acc: 0.3906
 Site-Southeast_Asian           (1) | Train Loss: 1.7969 | Train Acc: 0.3646
 Site-Asian_ffhq                (2) | Train Loss: 1.4914 | Train Acc: 0.5469
 Site-Asian_ffhq                (3) | Train Loss: 1.2956 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.1571 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6507 | Train Acc: 0.3438
Average Train Accuracy: 0.4468
 Site-White_utk                 (4) | Val  Loss: 1.7570 | Val  Acc: 0.4048
 Site-White_utk                 (4) | Val  Loss: 1.7822 | Val  Acc: 0.3281
 Site-East_Asian                (1) | Val  Loss: 1.7858 | Val  Acc: 0.2619
 Site-East_Asian                (1) | Val  Loss: 1.6724 | Val  Acc: 0.4219
 Site-Indian_utk                (5) | Val  Loss: 1.6595 | Val  Acc: 0.4524
 Site-Indian_utk                (5) | Val  Loss: 1.6733 | Val  Acc: 0.4062
 Site-Black_utk                 (6) | Val  Loss: 1.6826 | Val  Acc: 0.4286
 Site-Black_utk                 (0) | Val  Loss: 1.7185 | Val  Acc: 0.3750
 Site-Southeast_Asian           (1) | Val  Loss: 1.8223 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.7941 | Val  Acc: 0.3594
 Site-Asian_ffhq                (2) | Val  Loss: 1.1709 | Val  Acc: 0.7857
 Site-Asian_ffhq                (3) | Val  Loss: 1.3745 | Val  Acc: 0.5391
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 2.2276 | Val  Acc: 0.0000
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6701 | Val  Acc: 0.3438
Average Valid Accuracy: 0.3903
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.4048
 Best site-White_utk                (4)  | Epoch:9 | Val Acc: 0.3281
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.2619
 Best site-East_Asian               (1)  | Epoch:9 | Val Acc: 0.4219
 Best site-Indian_utk               (5)  | Epoch:9 | Val Acc: 0.4524
 Best site-Indian_utk               (5)  | Epoch:9 | Val Acc: 0.4062
 Best site-Black_utk                (6)  | Epoch:9 | Val Acc: 0.4286
 Best site-Black_utk                (0)  | Epoch:9 | Val Acc: 0.3750
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3571
 Best site-Southeast_Asian          (1)  | Epoch:9 | Val Acc: 0.3594
 Best site-Asian_ffhq               (2)  | Epoch:9 | Val Acc: 0.7857
 Best site-Asian_ffhq               (3)  | Epoch:9 | Val Acc: 0.5391
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:9 | Val Acc: 0.0000
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:9 | Val Acc: 0.3438
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (4)| Epoch:9 | Test Acc: 0.2847
 Test site-East_Asian                (1)| Epoch:9 | Test Acc: 0.4597
 Test site-Indian_utk                (5)| Epoch:9 | Test Acc: 0.4771
 Test site-Black_utk                 (6)| Epoch:9 | Test Acc: 0.3724
 Test site-Southeast_Asian           (1)| Epoch:9 | Test Acc: 0.3917
 Test site-Asian_ffhq                (2)| Epoch:9 | Test Acc: 0.3033
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:9 | Test Acc: 0.3085
White_utk: 0.2847, East_Asian: 0.4597, Indian_utk: 0.4771, Black_utk: 0.3724, Southeast_Asian: 0.3917, Asian_ffhq: 0.3033, Latino_Hispanic_ffhq: 0.3085, 
Average Test Accuracy(group): 0.3711, Average Test Accuracy(individual): 0.3711,
domain CV=0.1919, cluster CV=nan, individual CV=0.1919, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 10 ============
cnt=[4, 4, 1, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
min_w=0.33697, quan_i=1.70, quan_c=1.72
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.7393 | Train Acc: 0.2969
 Site-White_utk                 (1) | Train Loss: 1.7546 | Train Acc: 0.2917
 Site-East_Asian                (0) | Train Loss: 1.5486 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.6705 | Train Acc: 0.3958
 Site-Indian_utk                (1) | Train Loss: 1.5879 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.6173 | Train Acc: 0.4479
 Site-Black_utk                 (6) | Train Loss: 1.6120 | Train Acc: 0.4219
 Site-Black_utk                 (6) | Train Loss: 1.6670 | Train Acc: 0.4427
 Site-Southeast_Asian           (0) | Train Loss: 1.8232 | Train Acc: 0.3594
 Site-Southeast_Asian           (0) | Train Loss: 1.7594 | Train Acc: 0.3802
 Site-Asian_ffhq                (5) | Train Loss: 1.5147 | Train Acc: 0.5156
 Site-Asian_ffhq                (4) | Train Loss: 1.2854 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.1248 | Train Acc: 0.8438
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.6331 | Train Acc: 0.3177
Average Train Accuracy: 0.4472
 Site-White_utk                 (1) | Val  Loss: 1.7394 | Val  Acc: 0.2619
 Site-White_utk                 (1) | Val  Loss: 1.7375 | Val  Acc: 0.3047
 Site-East_Asian                (0) | Val  Loss: 1.8108 | Val  Acc: 0.3571
 Site-East_Asian                (0) | Val  Loss: 1.6331 | Val  Acc: 0.4297
 Site-Indian_utk                (1) | Val  Loss: 1.6340 | Val  Acc: 0.5238
 Site-Indian_utk                (1) | Val  Loss: 1.6080 | Val  Acc: 0.4141
 Site-Black_utk                 (6) | Val  Loss: 1.6541 | Val  Acc: 0.4048
 Site-Black_utk                 (6) | Val  Loss: 1.6836 | Val  Acc: 0.3828
 Site-Southeast_Asian           (0) | Val  Loss: 1.7633 | Val  Acc: 0.3333
 Site-Southeast_Asian           (0) | Val  Loss: 1.7676 | Val  Acc: 0.3516
 Site-Asian_ffhq                (5) | Val  Loss: 1.1426 | Val  Acc: 0.6905
 Site-Asian_ffhq                (4) | Val  Loss: 1.3987 | Val  Acc: 0.5078
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 2.2292 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6725 | Val  Acc: 0.3438
Average Valid Accuracy: 0.3824
============ Train epoch 11 ============
cnt=[1, 2, 3, 1, 2, 2, 3, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
min_w=0.21662, quan_i=1.70, quan_c=1.71
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.6437 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.6570 | Train Acc: 0.3854
 Site-East_Asian                (6) | Train Loss: 1.5036 | Train Acc: 0.4531
 Site-East_Asian                (6) | Train Loss: 1.6583 | Train Acc: 0.4115
 Site-Indian_utk                (5) | Train Loss: 1.6552 | Train Acc: 0.4219
 Site-Indian_utk                (5) | Train Loss: 1.6487 | Train Acc: 0.4375
 Site-Black_utk                 (4) | Train Loss: 1.6284 | Train Acc: 0.5156
 Site-Black_utk                 (4) | Train Loss: 1.6937 | Train Acc: 0.4219
 Site-Southeast_Asian           (3) | Train Loss: 1.7447 | Train Acc: 0.3594
 Site-Southeast_Asian           (6) | Train Loss: 1.7185 | Train Acc: 0.3698
 Site-Asian_ffhq                (0) | Train Loss: 1.6562 | Train Acc: 0.4375
 Site-Asian_ffhq                (2) | Train Loss: 1.4718 | Train Acc: 0.5260
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3655 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.7195 | Train Acc: 0.3073
Average Train Accuracy: 0.4353
 Site-White_utk                 (1) | Val  Loss: 1.6393 | Val  Acc: 0.4762
 Site-White_utk                 (1) | Val  Loss: 1.6301 | Val  Acc: 0.4297
 Site-East_Asian                (6) | Val  Loss: 1.7279 | Val  Acc: 0.3333
 Site-East_Asian                (6) | Val  Loss: 1.6308 | Val  Acc: 0.4609
 Site-Indian_utk                (5) | Val  Loss: 1.6554 | Val  Acc: 0.4286
 Site-Indian_utk                (5) | Val  Loss: 1.6723 | Val  Acc: 0.3984
 Site-Black_utk                 (4) | Val  Loss: 1.6362 | Val  Acc: 0.5238
 Site-Black_utk                 (4) | Val  Loss: 1.7256 | Val  Acc: 0.3750
 Site-Southeast_Asian           (3) | Val  Loss: 1.7736 | Val  Acc: 0.3571
 Site-Southeast_Asian           (6) | Val  Loss: 1.7263 | Val  Acc: 0.3750
 Site-Asian_ffhq                (0) | Val  Loss: 1.4441 | Val  Acc: 0.6190
 Site-Asian_ffhq                (2) | Val  Loss: 1.5621 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.1337 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.7435 | Val  Acc: 0.2891
Average Valid Accuracy: 0.3971
 Best site-White_utk                (1)  | Epoch:11 | Val Acc: 0.4762
 Best site-White_utk                (1)  | Epoch:11 | Val Acc: 0.4297
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.3333
 Best site-East_Asian               (6)  | Epoch:11 | Val Acc: 0.4609
 Best site-Indian_utk               (5)  | Epoch:11 | Val Acc: 0.4286
 Best site-Indian_utk               (5)  | Epoch:11 | Val Acc: 0.3984
 Best site-Black_utk                (4)  | Epoch:11 | Val Acc: 0.5238
 Best site-Black_utk                (4)  | Epoch:11 | Val Acc: 0.3750
 Best site-Southeast_Asian          (3)  | Epoch:11 | Val Acc: 0.3571
 Best site-Southeast_Asian          (6)  | Epoch:11 | Val Acc: 0.3750
 Best site-Asian_ffhq               (0)  | Epoch:11 | Val Acc: 0.6190
 Best site-Asian_ffhq               (2)  | Epoch:11 | Val Acc: 0.4453
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:11 | Val Acc: 0.0476
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:11 | Val Acc: 0.2891
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
min_w=0.30997, quan_i=1.67, quan_c=1.68
minimize weight of clients:[0, 1, 4, 5, 10, 11, 12, ]
 Site-White_utk                 (5) | Train Loss: 1.7393 | Train Acc: 0.2969
 Site-White_utk                 (5) | Train Loss: 1.7251 | Train Acc: 0.2917
 Site-East_Asian                (2) | Train Loss: 1.4772 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.6255 | Train Acc: 0.4115
 Site-Indian_utk                (1) | Train Loss: 1.5706 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.5985 | Train Acc: 0.4115
 Site-Black_utk                 (3) | Train Loss: 1.5458 | Train Acc: 0.4375
 Site-Black_utk                 (3) | Train Loss: 1.6158 | Train Acc: 0.4323
 Site-Southeast_Asian           (2) | Train Loss: 1.8517 | Train Acc: 0.3594
 Site-Southeast_Asian           (2) | Train Loss: 1.7423 | Train Acc: 0.3802
 Site-Asian_ffhq                (6) | Train Loss: 1.4441 | Train Acc: 0.5469
 Site-Asian_ffhq                (0) | Train Loss: 1.1750 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.0748 | Train Acc: 0.8125
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.4926 | Train Acc: 0.3490
Average Train Accuracy: 0.4483
 Site-White_utk                 (5) | Val  Loss: 1.6634 | Val  Acc: 0.3810
 Site-White_utk                 (5) | Val  Loss: 1.6948 | Val  Acc: 0.3750
 Site-East_Asian                (2) | Val  Loss: 1.7953 | Val  Acc: 0.3095
 Site-East_Asian                (2) | Val  Loss: 1.6075 | Val  Acc: 0.4062
 Site-Indian_utk                (1) | Val  Loss: 1.6037 | Val  Acc: 0.4762
 Site-Indian_utk                (1) | Val  Loss: 1.6378 | Val  Acc: 0.4062
 Site-Black_utk                 (3) | Val  Loss: 1.5434 | Val  Acc: 0.5476
 Site-Black_utk                 (3) | Val  Loss: 1.6532 | Val  Acc: 0.4141
 Site-Southeast_Asian           (2) | Val  Loss: 1.8268 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.7564 | Val  Acc: 0.3594
 Site-Asian_ffhq                (6) | Val  Loss: 1.1466 | Val  Acc: 0.6667
 Site-Asian_ffhq                (0) | Val  Loss: 1.2572 | Val  Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.1722 | Val  Acc: 0.0238
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5448 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3959
============ Train epoch 13 ============
cnt=[4, 3, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
min_w=0.30656, quan_i=1.65, quan_c=1.69
minimize weight of clients:[4, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.6307 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.6479 | Train Acc: 0.3906
 Site-East_Asian                (0) | Train Loss: 1.4449 | Train Acc: 0.4531
 Site-East_Asian                (0) | Train Loss: 1.6077 | Train Acc: 0.4167
 Site-Indian_utk                (5) | Train Loss: 1.5299 | Train Acc: 0.5312
 Site-Indian_utk                (1) | Train Loss: 1.5726 | Train Acc: 0.4323
 Site-Black_utk                 (6) | Train Loss: 1.5382 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.6296 | Train Acc: 0.4375
 Site-Southeast_Asian           (0) | Train Loss: 1.7388 | Train Acc: 0.4219
 Site-Southeast_Asian           (0) | Train Loss: 1.7030 | Train Acc: 0.4010
 Site-Asian_ffhq                (3) | Train Loss: 1.5740 | Train Acc: 0.5156
 Site-Asian_ffhq                (2) | Train Loss: 1.3147 | Train Acc: 0.5729
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1672 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5489 | Train Acc: 0.3594
Average Train Accuracy: 0.4717
 Site-White_utk                 (1) | Val  Loss: 1.6125 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.6335 | Val  Acc: 0.3984
 Site-East_Asian                (0) | Val  Loss: 1.7427 | Val  Acc: 0.3571
 Site-East_Asian                (0) | Val  Loss: 1.5854 | Val  Acc: 0.4297
 Site-Indian_utk                (5) | Val  Loss: 1.5979 | Val  Acc: 0.4286
 Site-Indian_utk                (1) | Val  Loss: 1.5982 | Val  Acc: 0.4453
 Site-Black_utk                 (6) | Val  Loss: 1.5826 | Val  Acc: 0.5714
 Site-Black_utk                 (6) | Val  Loss: 1.6140 | Val  Acc: 0.4766
 Site-Southeast_Asian           (0) | Val  Loss: 1.7601 | Val  Acc: 0.3333
 Site-Southeast_Asian           (0) | Val  Loss: 1.7131 | Val  Acc: 0.3828
 Site-Asian_ffhq                (3) | Val  Loss: 1.2628 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 1.3966 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 2.0887 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.5959 | Val  Acc: 0.3203
Average Valid Accuracy: 0.4128
 Best site-White_utk                (1)  | Epoch:13 | Val Acc: 0.4286
 Best site-White_utk                (1)  | Epoch:13 | Val Acc: 0.3984
 Best site-East_Asian               (0)  | Epoch:13 | Val Acc: 0.3571
 Best site-East_Asian               (0)  | Epoch:13 | Val Acc: 0.4297
 Best site-Indian_utk               (5)  | Epoch:13 | Val Acc: 0.4286
 Best site-Indian_utk               (1)  | Epoch:13 | Val Acc: 0.4453
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.5714
 Best site-Black_utk                (6)  | Epoch:13 | Val Acc: 0.4766
 Best site-Southeast_Asian          (0)  | Epoch:13 | Val Acc: 0.3333
 Best site-Southeast_Asian          (0)  | Epoch:13 | Val Acc: 0.3828
 Best site-Asian_ffhq               (3)  | Epoch:13 | Val Acc: 0.7143
 Best site-Asian_ffhq               (2)  | Epoch:13 | Val Acc: 0.4453
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:13 | Val Acc: 0.0476
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:13 | Val Acc: 0.3203
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 14 ============
cnt=[4, 1, 2, 1, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
min_w=0.29129, quan_i=1.64, quan_c=1.65
minimize weight of clients:[4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (6) | Train Loss: 1.5703 | Train Acc: 0.3125
 Site-White_utk                 (6) | Train Loss: 1.5707 | Train Acc: 0.4167
 Site-East_Asian                (0) | Train Loss: 1.4323 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.5813 | Train Acc: 0.4115
 Site-Indian_utk                (4) | Train Loss: 1.5418 | Train Acc: 0.5156
 Site-Indian_utk                (4) | Train Loss: 1.5620 | Train Acc: 0.4635
 Site-Black_utk                 (2) | Train Loss: 1.5540 | Train Acc: 0.4844
 Site-Black_utk                 (2) | Train Loss: 1.6126 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.7130 | Train Acc: 0.3906
 Site-Southeast_Asian           (0) | Train Loss: 1.6721 | Train Acc: 0.3802
 Site-Asian_ffhq                (3) | Train Loss: 1.7318 | Train Acc: 0.4219
 Site-Asian_ffhq                (5) | Train Loss: 1.5057 | Train Acc: 0.5208
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.3517 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.6725 | Train Acc: 0.3177
Average Train Accuracy: 0.4461
 Site-White_utk                 (6) | Val  Loss: 1.5304 | Val  Acc: 0.4524
 Site-White_utk                 (6) | Val  Loss: 1.5440 | Val  Acc: 0.4609
 Site-East_Asian                (0) | Val  Loss: 1.7227 | Val  Acc: 0.3571
 Site-East_Asian                (0) | Val  Loss: 1.5640 | Val  Acc: 0.4297
 Site-Indian_utk                (4) | Val  Loss: 1.5392 | Val  Acc: 0.4524
 Site-Indian_utk                (4) | Val  Loss: 1.5972 | Val  Acc: 0.4141
 Site-Black_utk                 (2) | Val  Loss: 1.6064 | Val  Acc: 0.5476
 Site-Black_utk                 (2) | Val  Loss: 1.6112 | Val  Acc: 0.4375
 Site-Southeast_Asian           (0) | Val  Loss: 1.7224 | Val  Acc: 0.3810
 Site-Southeast_Asian           (0) | Val  Loss: 1.6992 | Val  Acc: 0.3906
 Site-Asian_ffhq                (3) | Val  Loss: 1.4296 | Val  Acc: 0.6429
 Site-Asian_ffhq                (5) | Val  Loss: 1.5795 | Val  Acc: 0.4453
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 2.0856 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7068 | Val  Acc: 0.2891
Average Valid Accuracy: 0.4174
 Best site-White_utk                (6)  | Epoch:14 | Val Acc: 0.4524
 Best site-White_utk                (6)  | Epoch:14 | Val Acc: 0.4609
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.3571
 Best site-East_Asian               (0)  | Epoch:14 | Val Acc: 0.4297
 Best site-Indian_utk               (4)  | Epoch:14 | Val Acc: 0.4524
 Best site-Indian_utk               (4)  | Epoch:14 | Val Acc: 0.4141
 Best site-Black_utk                (2)  | Epoch:14 | Val Acc: 0.5476
 Best site-Black_utk                (2)  | Epoch:14 | Val Acc: 0.4375
 Best site-Southeast_Asian          (0)  | Epoch:14 | Val Acc: 0.3810
 Best site-Southeast_Asian          (0)  | Epoch:14 | Val Acc: 0.3906
 Best site-Asian_ffhq               (3)  | Epoch:14 | Val Acc: 0.6429
 Best site-Asian_ffhq               (5)  | Epoch:14 | Val Acc: 0.4453
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:14 | Val Acc: 0.1429
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:14 | Val Acc: 0.2891
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 4, 1, 2, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
min_w=0.28857, quan_i=1.62, quan_c=1.63
minimize weight of clients:[0, 1, 4, 5, 6, 7, 11, 12, ]
 Site-White_utk                 (4) | Train Loss: 1.6428 | Train Acc: 0.2812
 Site-White_utk                 (4) | Train Loss: 1.6809 | Train Acc: 0.3333
 Site-East_Asian                (1) | Train Loss: 1.4442 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.6086 | Train Acc: 0.3906
 Site-Indian_utk                (3) | Train Loss: 1.5114 | Train Acc: 0.4531
 Site-Indian_utk                (3) | Train Loss: 1.5559 | Train Acc: 0.4271
 Site-Black_utk                 (0) | Train Loss: 1.4954 | Train Acc: 0.4844
 Site-Black_utk                 (0) | Train Loss: 1.5669 | Train Acc: 0.4844
 Site-Southeast_Asian           (1) | Train Loss: 1.7643 | Train Acc: 0.3750
 Site-Southeast_Asian           (1) | Train Loss: 1.7445 | Train Acc: 0.3802
 Site-Asian_ffhq                (5) | Train Loss: 1.3160 | Train Acc: 0.5625
 Site-Asian_ffhq                (6) | Train Loss: 1.1261 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 0.9380 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.5105 | Train Acc: 0.3750
Average Train Accuracy: 0.4643
 Site-White_utk                 (4) | Val  Loss: 1.6096 | Val  Acc: 0.3571
 Site-White_utk                 (4) | Val  Loss: 1.6584 | Val  Acc: 0.3359
 Site-East_Asian                (1) | Val  Loss: 1.7777 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.6021 | Val  Acc: 0.4062
 Site-Indian_utk                (3) | Val  Loss: 1.5073 | Val  Acc: 0.4524
 Site-Indian_utk                (3) | Val  Loss: 1.5703 | Val  Acc: 0.4375
 Site-Black_utk                 (0) | Val  Loss: 1.5727 | Val  Acc: 0.4286
 Site-Black_utk                 (0) | Val  Loss: 1.5851 | Val  Acc: 0.4375
 Site-Southeast_Asian           (1) | Val  Loss: 1.7465 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.7493 | Val  Acc: 0.3594
 Site-Asian_ffhq                (5) | Val  Loss: 1.0355 | Val  Acc: 0.7143
 Site-Asian_ffhq                (6) | Val  Loss: 1.2624 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 2.1585 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.5357 | Val  Acc: 0.3281
Average Valid Accuracy: 0.3947
============ Train epoch 16 ============
cnt=[2, 3, 1, 4, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
min_w=0.29504, quan_i=1.62, quan_c=1.64
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.5208 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.5592 | Train Acc: 0.4115
 Site-East_Asian                (3) | Train Loss: 1.4239 | Train Acc: 0.5000
 Site-East_Asian                (3) | Train Loss: 1.5511 | Train Acc: 0.4323
 Site-Indian_utk                (6) | Train Loss: 1.4923 | Train Acc: 0.5156
 Site-Indian_utk                (1) | Train Loss: 1.5351 | Train Acc: 0.4427
 Site-Black_utk                 (4) | Train Loss: 1.5034 | Train Acc: 0.5625
 Site-Black_utk                 (4) | Train Loss: 1.5587 | Train Acc: 0.4896
 Site-Southeast_Asian           (3) | Train Loss: 1.6845 | Train Acc: 0.4219
 Site-Southeast_Asian           (3) | Train Loss: 1.6649 | Train Acc: 0.3854
 Site-Asian_ffhq                (2) | Train Loss: 1.5131 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.3616 | Train Acc: 0.5729
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.2116 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.5728 | Train Acc: 0.3542
Average Train Accuracy: 0.4807
 Site-White_utk                 (1) | Val  Loss: 1.4954 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.5158 | Val  Acc: 0.4453
 Site-East_Asian                (3) | Val  Loss: 1.7411 | Val  Acc: 0.3571
 Site-East_Asian                (3) | Val  Loss: 1.5432 | Val  Acc: 0.4453
 Site-Indian_utk                (6) | Val  Loss: 1.5607 | Val  Acc: 0.3095
 Site-Indian_utk                (1) | Val  Loss: 1.5903 | Val  Acc: 0.4219
 Site-Black_utk                 (4) | Val  Loss: 1.5364 | Val  Acc: 0.5238
 Site-Black_utk                 (4) | Val  Loss: 1.5929 | Val  Acc: 0.4141
 Site-Southeast_Asian           (3) | Val  Loss: 1.7001 | Val  Acc: 0.3333
 Site-Southeast_Asian           (3) | Val  Loss: 1.6743 | Val  Acc: 0.3672
 Site-Asian_ffhq                (2) | Val  Loss: 1.2780 | Val  Acc: 0.6905
 Site-Asian_ffhq                (0) | Val  Loss: 1.3999 | Val  Acc: 0.4922
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9827 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5939 | Val  Acc: 0.3438
Average Valid Accuracy: 0.4167
============ Train epoch 17 ============
cnt=[1, 2, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
min_w=0.28110, quan_i=1.56, quan_c=1.59
minimize weight of clients:[0, 4, 5, 6, 10, 11, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.6177 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.5764 | Train Acc: 0.3802
 Site-East_Asian                (2) | Train Loss: 1.4361 | Train Acc: 0.4531
 Site-East_Asian                (2) | Train Loss: 1.5585 | Train Acc: 0.4115
 Site-Indian_utk                (4) | Train Loss: 1.5335 | Train Acc: 0.4844
 Site-Indian_utk                (4) | Train Loss: 1.5571 | Train Acc: 0.3646
 Site-Black_utk                 (5) | Train Loss: 1.5148 | Train Acc: 0.5625
 Site-Black_utk                 (5) | Train Loss: 1.5902 | Train Acc: 0.4323
 Site-Southeast_Asian           (2) | Train Loss: 1.7436 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.6885 | Train Acc: 0.3750
 Site-Asian_ffhq                (0) | Train Loss: 1.6115 | Train Acc: 0.4375
 Site-Asian_ffhq                (3) | Train Loss: 1.3230 | Train Acc: 0.5260
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.2741 | Train Acc: 0.5625
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.4256 | Train Acc: 0.4219
Average Train Accuracy: 0.4390
 Site-White_utk                 (1) | Val  Loss: 1.4972 | Val  Acc: 0.5476
 Site-White_utk                 (1) | Val  Loss: 1.5579 | Val  Acc: 0.4219
 Site-East_Asian                (2) | Val  Loss: 1.6518 | Val  Acc: 0.3810
 Site-East_Asian                (2) | Val  Loss: 1.5190 | Val  Acc: 0.4375
 Site-Indian_utk                (4) | Val  Loss: 1.5348 | Val  Acc: 0.4286
 Site-Indian_utk                (4) | Val  Loss: 1.5991 | Val  Acc: 0.4531
 Site-Black_utk                 (5) | Val  Loss: 1.5034 | Val  Acc: 0.5238
 Site-Black_utk                 (5) | Val  Loss: 1.5667 | Val  Acc: 0.4297
 Site-Southeast_Asian           (2) | Val  Loss: 1.7688 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.7185 | Val  Acc: 0.3594
 Site-Asian_ffhq                (0) | Val  Loss: 1.3360 | Val  Acc: 0.5238
 Site-Asian_ffhq                (3) | Val  Loss: 1.3357 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.8442 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.4643 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4190
 Best site-White_utk                (1)  | Epoch:17 | Val Acc: 0.5476
 Best site-White_utk                (1)  | Epoch:17 | Val Acc: 0.4219
 Best site-East_Asian               (2)  | Epoch:17 | Val Acc: 0.3810
 Best site-East_Asian               (2)  | Epoch:17 | Val Acc: 0.4375
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4286
 Best site-Indian_utk               (4)  | Epoch:17 | Val Acc: 0.4531
 Best site-Black_utk                (5)  | Epoch:17 | Val Acc: 0.5238
 Best site-Black_utk                (5)  | Epoch:17 | Val Acc: 0.4297
 Best site-Southeast_Asian          (2)  | Epoch:17 | Val Acc: 0.3333
 Best site-Southeast_Asian          (2)  | Epoch:17 | Val Acc: 0.3594
 Best site-Asian_ffhq               (0)  | Epoch:17 | Val Acc: 0.5238
 Best site-Asian_ffhq               (3)  | Epoch:17 | Val Acc: 0.4688
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:17 | Val Acc: 0.1667
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:17 | Val Acc: 0.3906
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 18 ============
cnt=[1, 2, 1, 2, 4, 1, 3, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
min_w=0.29633, quan_i=1.61, quan_c=1.60
minimize weight of clients:[1, 4, 5, 6, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.6007 | Train Acc: 0.2812
 Site-White_utk                 (1) | Train Loss: 1.5330 | Train Acc: 0.4062
 Site-East_Asian                (6) | Train Loss: 1.4289 | Train Acc: 0.4531
 Site-East_Asian                (6) | Train Loss: 1.5590 | Train Acc: 0.4115
 Site-Indian_utk                (4) | Train Loss: 1.5100 | Train Acc: 0.4844
 Site-Indian_utk                (4) | Train Loss: 1.5358 | Train Acc: 0.4323
 Site-Black_utk                 (4) | Train Loss: 1.5073 | Train Acc: 0.5781
 Site-Black_utk                 (4) | Train Loss: 1.5245 | Train Acc: 0.4948
 Site-Southeast_Asian           (2) | Train Loss: 1.6882 | Train Acc: 0.4062
 Site-Southeast_Asian           (6) | Train Loss: 1.6576 | Train Acc: 0.3854
 Site-Asian_ffhq                (5) | Train Loss: 1.5015 | Train Acc: 0.5156
 Site-Asian_ffhq                (3) | Train Loss: 1.2525 | Train Acc: 0.5833
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.1321 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4741 | Train Acc: 0.3594
Average Train Accuracy: 0.4673
 Site-White_utk                 (1) | Val  Loss: 1.5270 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.5342 | Val  Acc: 0.4141
 Site-East_Asian                (6) | Val  Loss: 1.6461 | Val  Acc: 0.3810
 Site-East_Asian                (6) | Val  Loss: 1.5342 | Val  Acc: 0.4219
 Site-Indian_utk                (4) | Val  Loss: 1.5214 | Val  Acc: 0.3810
 Site-Indian_utk                (4) | Val  Loss: 1.5453 | Val  Acc: 0.4297
 Site-Black_utk                 (4) | Val  Loss: 1.4720 | Val  Acc: 0.5476
 Site-Black_utk                 (4) | Val  Loss: 1.5414 | Val  Acc: 0.4531
 Site-Southeast_Asian           (2) | Val  Loss: 1.7106 | Val  Acc: 0.3333
 Site-Southeast_Asian           (6) | Val  Loss: 1.7080 | Val  Acc: 0.3672
 Site-Asian_ffhq                (5) | Val  Loss: 1.1507 | Val  Acc: 0.7143
 Site-Asian_ffhq                (3) | Val  Loss: 1.3382 | Val  Acc: 0.4609
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.9963 | Val  Acc: 0.0714
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.4901 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4190
 Best site-White_utk                (1)  | Epoch:18 | Val Acc: 0.5000
 Best site-White_utk                (1)  | Epoch:18 | Val Acc: 0.4141
 Best site-East_Asian               (6)  | Epoch:18 | Val Acc: 0.3810
 Best site-East_Asian               (6)  | Epoch:18 | Val Acc: 0.4219
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.3810
 Best site-Indian_utk               (4)  | Epoch:18 | Val Acc: 0.4297
 Best site-Black_utk                (4)  | Epoch:18 | Val Acc: 0.5476
 Best site-Black_utk                (4)  | Epoch:18 | Val Acc: 0.4531
 Best site-Southeast_Asian          (2)  | Epoch:18 | Val Acc: 0.3333
 Best site-Southeast_Asian          (6)  | Epoch:18 | Val Acc: 0.3672
 Best site-Asian_ffhq               (5)  | Epoch:18 | Val Acc: 0.7143
 Best site-Asian_ffhq               (3)  | Epoch:18 | Val Acc: 0.4609
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:18 | Val Acc: 0.0714
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:18 | Val Acc: 0.3906
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 19 ============
cnt=[4, 4, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
min_w=0.28701, quan_i=1.54, quan_c=1.56
minimize weight of clients:[1, 4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (3) | Train Loss: 1.5231 | Train Acc: 0.4062
 Site-White_utk                 (3) | Train Loss: 1.4960 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.3816 | Train Acc: 0.4844
 Site-East_Asian                (1) | Train Loss: 1.5616 | Train Acc: 0.4323
 Site-Indian_utk                (0) | Train Loss: 1.5008 | Train Acc: 0.5312
 Site-Indian_utk                (0) | Train Loss: 1.5073 | Train Acc: 0.4531
 Site-Black_utk                 (0) | Train Loss: 1.5112 | Train Acc: 0.4844
 Site-Black_utk                 (0) | Train Loss: 1.5432 | Train Acc: 0.4635
 Site-Southeast_Asian           (1) | Train Loss: 1.6795 | Train Acc: 0.3750
 Site-Southeast_Asian           (1) | Train Loss: 1.6211 | Train Acc: 0.3906
 Site-Asian_ffhq                (4) | Train Loss: 1.5430 | Train Acc: 0.5156
 Site-Asian_ffhq                (2) | Train Loss: 1.3182 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.1358 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.5848 | Train Acc: 0.3438
Average Train Accuracy: 0.4792
 Site-White_utk                 (3) | Val  Loss: 1.4752 | Val  Acc: 0.5238
 Site-White_utk                 (3) | Val  Loss: 1.4959 | Val  Acc: 0.5000
 Site-East_Asian                (1) | Val  Loss: 1.6982 | Val  Acc: 0.3333
 Site-East_Asian                (1) | Val  Loss: 1.4724 | Val  Acc: 0.4297
 Site-Indian_utk                (0) | Val  Loss: 1.4352 | Val  Acc: 0.4762
 Site-Indian_utk                (0) | Val  Loss: 1.5383 | Val  Acc: 0.4688
 Site-Black_utk                 (0) | Val  Loss: 1.4674 | Val  Acc: 0.5238
 Site-Black_utk                 (0) | Val  Loss: 1.5291 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.7138 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.6001 | Val  Acc: 0.4062
 Site-Asian_ffhq                (4) | Val  Loss: 1.2138 | Val  Acc: 0.6667
 Site-Asian_ffhq                (2) | Val  Loss: 1.3922 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.0530 | Val  Acc: 0.0714
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.5980 | Val  Acc: 0.2969
Average Valid Accuracy: 0.4341
 Best site-White_utk                (3)  | Epoch:19 | Val Acc: 0.5238
 Best site-White_utk                (3)  | Epoch:19 | Val Acc: 0.5000
 Best site-East_Asian               (1)  | Epoch:19 | Val Acc: 0.3333
 Best site-East_Asian               (1)  | Epoch:19 | Val Acc: 0.4297
 Best site-Indian_utk               (0)  | Epoch:19 | Val Acc: 0.4762
 Best site-Indian_utk               (0)  | Epoch:19 | Val Acc: 0.4688
 Best site-Black_utk                (0)  | Epoch:19 | Val Acc: 0.5238
 Best site-Black_utk                (0)  | Epoch:19 | Val Acc: 0.4922
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.3571
 Best site-Southeast_Asian          (1)  | Epoch:19 | Val Acc: 0.4062
 Best site-Asian_ffhq               (4)  | Epoch:19 | Val Acc: 0.6667
 Best site-Asian_ffhq               (2)  | Epoch:19 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:19 | Val Acc: 0.0714
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:19 | Val Acc: 0.2969
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (3)| Epoch:19 | Test Acc: 0.3165
 Test site-East_Asian                (1)| Epoch:19 | Test Acc: 0.4716
 Test site-Indian_utk                (0)| Epoch:19 | Test Acc: 0.5000
 Test site-Black_utk                 (0)| Epoch:19 | Test Acc: 0.3724
 Test site-Southeast_Asian           (1)| Epoch:19 | Test Acc: 0.4142
 Test site-Asian_ffhq                (4)| Epoch:19 | Test Acc: 0.3088
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:19 | Test Acc: 0.2786
White_utk: 0.3165, East_Asian: 0.4716, Indian_utk: 0.5000, Black_utk: 0.3724, Southeast_Asian: 0.4142, Asian_ffhq: 0.3088, Latino_Hispanic_ffhq: 0.2786, 
Average Test Accuracy(group): 0.3803, Average Test Accuracy(individual): 0.3803,
domain CV=0.2070, cluster CV=nan, individual CV=0.2070, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 20 ============
cnt=[2, 2, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
min_w=0.27140, quan_i=1.56, quan_c=1.56
minimize weight of clients:[0, 1, 4, 5, 6, 11, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.6136 | Train Acc: 0.3281
 Site-White_utk                 (1) | Train Loss: 1.6126 | Train Acc: 0.3229
 Site-East_Asian                (2) | Train Loss: 1.4518 | Train Acc: 0.4531
 Site-East_Asian                (2) | Train Loss: 1.5999 | Train Acc: 0.4115
 Site-Indian_utk                (5) | Train Loss: 1.4541 | Train Acc: 0.4844
 Site-Indian_utk                (5) | Train Loss: 1.5068 | Train Acc: 0.4427
 Site-Black_utk                 (4) | Train Loss: 1.4738 | Train Acc: 0.4375
 Site-Black_utk                 (4) | Train Loss: 1.4975 | Train Acc: 0.4688
 Site-Southeast_Asian           (2) | Train Loss: 1.7226 | Train Acc: 0.3906
 Site-Southeast_Asian           (2) | Train Loss: 1.7016 | Train Acc: 0.3750
 Site-Asian_ffhq                (3) | Train Loss: 1.2983 | Train Acc: 0.5625
 Site-Asian_ffhq                (0) | Train Loss: 1.0865 | Train Acc: 0.6615
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 0.8651 | Train Acc: 0.8438
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.4778 | Train Acc: 0.3333
Average Train Accuracy: 0.4654
 Site-White_utk                 (1) | Val  Loss: 1.5909 | Val  Acc: 0.3571
 Site-White_utk                 (1) | Val  Loss: 1.5810 | Val  Acc: 0.3594
 Site-East_Asian                (2) | Val  Loss: 1.7694 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.5284 | Val  Acc: 0.4375
 Site-Indian_utk                (5) | Val  Loss: 1.4627 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.5193 | Val  Acc: 0.4688
 Site-Black_utk                 (4) | Val  Loss: 1.4854 | Val  Acc: 0.5000
 Site-Black_utk                 (4) | Val  Loss: 1.5090 | Val  Acc: 0.4531
 Site-Southeast_Asian           (2) | Val  Loss: 1.7381 | Val  Acc: 0.3810
 Site-Southeast_Asian           (2) | Val  Loss: 1.6777 | Val  Acc: 0.3750
 Site-Asian_ffhq                (3) | Val  Loss: 0.9201 | Val  Acc: 0.7857
 Site-Asian_ffhq                (0) | Val  Loss: 1.2442 | Val  Acc: 0.5547
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 2.2059 | Val  Acc: 0.0476
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.5150 | Val  Acc: 0.3438
Average Valid Accuracy: 0.4212
============ Train epoch 21 ============
cnt=[1, 2, 4, 2, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
min_w=0.30001, quan_i=1.61, quan_c=1.62
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (6) | Train Loss: 1.5209 | Train Acc: 0.4219
 Site-White_utk                 (6) | Train Loss: 1.4515 | Train Acc: 0.4740
 Site-East_Asian                (2) | Train Loss: 1.4069 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.5122 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.4718 | Train Acc: 0.4062
 Site-Indian_utk                (1) | Train Loss: 1.5335 | Train Acc: 0.4167
 Site-Black_utk                 (5) | Train Loss: 1.5200 | Train Acc: 0.4375
 Site-Black_utk                 (5) | Train Loss: 1.5317 | Train Acc: 0.4948
 Site-Southeast_Asian           (2) | Train Loss: 1.6454 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.5576 | Train Acc: 0.4531
 Site-Asian_ffhq                (4) | Train Loss: 1.6627 | Train Acc: 0.4531
 Site-Asian_ffhq                (3) | Train Loss: 1.4693 | Train Acc: 0.5156
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3206 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.6421 | Train Acc: 0.3542
Average Train Accuracy: 0.4557
 Site-White_utk                 (6) | Val  Loss: 1.4282 | Val  Acc: 0.5000
 Site-White_utk                 (6) | Val  Loss: 1.4323 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.6755 | Val  Acc: 0.3571
 Site-East_Asian                (2) | Val  Loss: 1.4768 | Val  Acc: 0.4531
 Site-Indian_utk                (1) | Val  Loss: 1.4945 | Val  Acc: 0.4524
 Site-Indian_utk                (1) | Val  Loss: 1.5914 | Val  Acc: 0.3984
 Site-Black_utk                 (5) | Val  Loss: 1.4911 | Val  Acc: 0.6429
 Site-Black_utk                 (5) | Val  Loss: 1.5600 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.6180 | Val  Acc: 0.3810
 Site-Southeast_Asian           (2) | Val  Loss: 1.5691 | Val  Acc: 0.3984
 Site-Asian_ffhq                (4) | Val  Loss: 1.3837 | Val  Acc: 0.6905
 Site-Asian_ffhq                (3) | Val  Loss: 1.5311 | Val  Acc: 0.4141
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.9420 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.6178 | Val  Acc: 0.3516
Average Valid Accuracy: 0.4416
 Best site-White_utk                (6)  | Epoch:21 | Val Acc: 0.5000
 Best site-White_utk                (6)  | Epoch:21 | Val Acc: 0.5000
 Best site-East_Asian               (2)  | Epoch:21 | Val Acc: 0.3571
 Best site-East_Asian               (2)  | Epoch:21 | Val Acc: 0.4531
 Best site-Indian_utk               (1)  | Epoch:21 | Val Acc: 0.4524
 Best site-Indian_utk               (1)  | Epoch:21 | Val Acc: 0.3984
 Best site-Black_utk                (5)  | Epoch:21 | Val Acc: 0.6429
 Best site-Black_utk                (5)  | Epoch:21 | Val Acc: 0.5000
 Best site-Southeast_Asian          (2)  | Epoch:21 | Val Acc: 0.3810
 Best site-Southeast_Asian          (2)  | Epoch:21 | Val Acc: 0.3984
 Best site-Asian_ffhq               (4)  | Epoch:21 | Val Acc: 0.6905
 Best site-Asian_ffhq               (3)  | Epoch:21 | Val Acc: 0.4141
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:21 | Val Acc: 0.1429
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:21 | Val Acc: 0.3516
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 22 ============
cnt=[3, 4, 2, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
min_w=0.26875, quan_i=1.54, quan_c=1.54
minimize weight of clients:[0, 1, 4, 5, 6, 7, 12, ]
 Site-White_utk                 (0) | Train Loss: 1.6143 | Train Acc: 0.3438
 Site-White_utk                 (0) | Train Loss: 1.5515 | Train Acc: 0.3958
 Site-East_Asian                (1) | Train Loss: 1.4218 | Train Acc: 0.4375
 Site-East_Asian                (1) | Train Loss: 1.5448 | Train Acc: 0.4010
 Site-Indian_utk                (5) | Train Loss: 1.4520 | Train Acc: 0.4844
 Site-Indian_utk                (0) | Train Loss: 1.5091 | Train Acc: 0.4531
 Site-Black_utk                 (6) | Train Loss: 1.4433 | Train Acc: 0.4688
 Site-Black_utk                 (6) | Train Loss: 1.5102 | Train Acc: 0.4583
 Site-Southeast_Asian           (1) | Train Loss: 1.7295 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.6483 | Train Acc: 0.3958
 Site-Asian_ffhq                (4) | Train Loss: 1.2442 | Train Acc: 0.5625
 Site-Asian_ffhq                (2) | Train Loss: 1.0310 | Train Acc: 0.6562
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 0.9040 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3725 | Train Acc: 0.3750
Average Train Accuracy: 0.4773
 Site-White_utk                 (0) | Val  Loss: 1.5382 | Val  Acc: 0.4524
 Site-White_utk                 (0) | Val  Loss: 1.5588 | Val  Acc: 0.4531
 Site-East_Asian                (1) | Val  Loss: 1.7219 | Val  Acc: 0.3571
 Site-East_Asian                (1) | Val  Loss: 1.5017 | Val  Acc: 0.4453
 Site-Indian_utk                (5) | Val  Loss: 1.4649 | Val  Acc: 0.4524
 Site-Indian_utk                (0) | Val  Loss: 1.5323 | Val  Acc: 0.4297
 Site-Black_utk                 (6) | Val  Loss: 1.4530 | Val  Acc: 0.5476
 Site-Black_utk                 (6) | Val  Loss: 1.4871 | Val  Acc: 0.4688
 Site-Southeast_Asian           (1) | Val  Loss: 1.8089 | Val  Acc: 0.3333
 Site-Southeast_Asian           (1) | Val  Loss: 1.6862 | Val  Acc: 0.3750
 Site-Asian_ffhq                (4) | Val  Loss: 0.9536 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 1.1371 | Val  Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9934 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.4195 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4358
============ Train epoch 23 ============
cnt=[4, 2, 2, 1, 1, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
min_w=0.28458, quan_i=1.56, quan_c=1.58
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (5) | Train Loss: 1.4660 | Train Acc: 0.4062
 Site-White_utk                 (5) | Train Loss: 1.4416 | Train Acc: 0.4844
 Site-East_Asian                (0) | Train Loss: 1.3984 | Train Acc: 0.4531
 Site-East_Asian                (0) | Train Loss: 1.4811 | Train Acc: 0.4479
 Site-Indian_utk                (1) | Train Loss: 1.5012 | Train Acc: 0.3906
 Site-Indian_utk                (1) | Train Loss: 1.5268 | Train Acc: 0.4271
 Site-Black_utk                 (6) | Train Loss: 1.4980 | Train Acc: 0.4219
 Site-Black_utk                 (6) | Train Loss: 1.5643 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.6132 | Train Acc: 0.4375
 Site-Southeast_Asian           (0) | Train Loss: 1.5715 | Train Acc: 0.4062
 Site-Asian_ffhq                (3) | Train Loss: 1.5985 | Train Acc: 0.4688
 Site-Asian_ffhq                (2) | Train Loss: 1.4144 | Train Acc: 0.5052
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3166 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.5336 | Train Acc: 0.4271
Average Train Accuracy: 0.4516
 Site-White_utk                 (5) | Val  Loss: 1.3998 | Val  Acc: 0.5000
 Site-White_utk                 (5) | Val  Loss: 1.3932 | Val  Acc: 0.5469
 Site-East_Asian                (0) | Val  Loss: 1.6324 | Val  Acc: 0.4524
 Site-East_Asian                (0) | Val  Loss: 1.4779 | Val  Acc: 0.4609
 Site-Indian_utk                (1) | Val  Loss: 1.5271 | Val  Acc: 0.4048
 Site-Indian_utk                (1) | Val  Loss: 1.5881 | Val  Acc: 0.4453
 Site-Black_utk                 (6) | Val  Loss: 1.4683 | Val  Acc: 0.5952
 Site-Black_utk                 (6) | Val  Loss: 1.5407 | Val  Acc: 0.5469
 Site-Southeast_Asian           (0) | Val  Loss: 1.6762 | Val  Acc: 0.4048
 Site-Southeast_Asian           (0) | Val  Loss: 1.5951 | Val  Acc: 0.4297
 Site-Asian_ffhq                (3) | Val  Loss: 1.3263 | Val  Acc: 0.6429
 Site-Asian_ffhq                (2) | Val  Loss: 1.4521 | Val  Acc: 0.4531
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9145 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.5809 | Val  Acc: 0.3672
Average Valid Accuracy: 0.4532
 Best site-White_utk                (5)  | Epoch:23 | Val Acc: 0.5000
 Best site-White_utk                (5)  | Epoch:23 | Val Acc: 0.5469
 Best site-East_Asian               (0)  | Epoch:23 | Val Acc: 0.4524
 Best site-East_Asian               (0)  | Epoch:23 | Val Acc: 0.4609
 Best site-Indian_utk               (1)  | Epoch:23 | Val Acc: 0.4048
 Best site-Indian_utk               (1)  | Epoch:23 | Val Acc: 0.4453
 Best site-Black_utk                (6)  | Epoch:23 | Val Acc: 0.5952
 Best site-Black_utk                (6)  | Epoch:23 | Val Acc: 0.5469
 Best site-Southeast_Asian          (0)  | Epoch:23 | Val Acc: 0.4048
 Best site-Southeast_Asian          (0)  | Epoch:23 | Val Acc: 0.4297
 Best site-Asian_ffhq               (3)  | Epoch:23 | Val Acc: 0.6429
 Best site-Asian_ffhq               (2)  | Epoch:23 | Val Acc: 0.4531
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:23 | Val Acc: 0.0952
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:23 | Val Acc: 0.3672
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 24 ============
cnt=[4, 1, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
min_w=0.26873, quan_i=1.54, quan_c=1.54
minimize weight of clients:[0, 1, 2, 3, 4, 5, 11, 12, ]
 Site-White_utk                 (2) | Train Loss: 1.5881 | Train Acc: 0.4062
 Site-White_utk                 (2) | Train Loss: 1.5428 | Train Acc: 0.3802
 Site-East_Asian                (0) | Train Loss: 1.4704 | Train Acc: 0.4375
 Site-East_Asian                (0) | Train Loss: 1.5266 | Train Acc: 0.4167
 Site-Indian_utk                (2) | Train Loss: 1.4267 | Train Acc: 0.4531
 Site-Indian_utk                (2) | Train Loss: 1.4905 | Train Acc: 0.4427
 Site-Black_utk                 (5) | Train Loss: 1.4654 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.4696 | Train Acc: 0.4688
 Site-Southeast_Asian           (0) | Train Loss: 1.7519 | Train Acc: 0.3906
 Site-Southeast_Asian           (0) | Train Loss: 1.6579 | Train Acc: 0.3750
 Site-Asian_ffhq                (3) | Train Loss: 1.2759 | Train Acc: 0.5312
 Site-Asian_ffhq                (1) | Train Loss: 1.0536 | Train Acc: 0.6458
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 0.9500 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3164 | Train Acc: 0.4375
Average Train Accuracy: 0.4751
 Site-White_utk                 (2) | Val  Loss: 1.4674 | Val  Acc: 0.5952
 Site-White_utk                 (2) | Val  Loss: 1.5455 | Val  Acc: 0.4297
 Site-East_Asian                (0) | Val  Loss: 1.6385 | Val  Acc: 0.3810
 Site-East_Asian                (0) | Val  Loss: 1.5154 | Val  Acc: 0.4453
 Site-Indian_utk                (2) | Val  Loss: 1.4922 | Val  Acc: 0.4048
 Site-Indian_utk                (2) | Val  Loss: 1.5379 | Val  Acc: 0.4531
 Site-Black_utk                 (5) | Val  Loss: 1.4153 | Val  Acc: 0.5952
 Site-Black_utk                 (5) | Val  Loss: 1.4988 | Val  Acc: 0.4375
 Site-Southeast_Asian           (0) | Val  Loss: 1.7017 | Val  Acc: 0.3571
 Site-Southeast_Asian           (0) | Val  Loss: 1.6975 | Val  Acc: 0.3516
 Site-Asian_ffhq                (3) | Val  Loss: 0.9450 | Val  Acc: 0.7381
 Site-Asian_ffhq                (1) | Val  Loss: 1.1495 | Val  Acc: 0.5703
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.9159 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.3504 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4461
============ Train epoch 25 ============
cnt=[4, 1, 4, 1, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
min_w=0.27131, quan_i=1.54, quan_c=1.53
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 1.5083 | Train Acc: 0.3906
 Site-White_utk                 (0) | Train Loss: 1.4120 | Train Acc: 0.4740
 Site-East_Asian                (2) | Train Loss: 1.3850 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.4842 | Train Acc: 0.4062
 Site-Indian_utk                (0) | Train Loss: 1.4640 | Train Acc: 0.4219
 Site-Indian_utk                (0) | Train Loss: 1.4911 | Train Acc: 0.5000
 Site-Black_utk                 (5) | Train Loss: 1.4174 | Train Acc: 0.4844
 Site-Black_utk                 (5) | Train Loss: 1.4944 | Train Acc: 0.4688
 Site-Southeast_Asian           (2) | Train Loss: 1.6306 | Train Acc: 0.4375
 Site-Southeast_Asian           (2) | Train Loss: 1.5740 | Train Acc: 0.3802
 Site-Asian_ffhq                (1) | Train Loss: 1.5331 | Train Acc: 0.5156
 Site-Asian_ffhq                (6) | Train Loss: 1.3130 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1348 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4757 | Train Acc: 0.3854
Average Train Accuracy: 0.4725
 Site-White_utk                 (0) | Val  Loss: 1.3874 | Val  Acc: 0.5952
 Site-White_utk                 (0) | Val  Loss: 1.4191 | Val  Acc: 0.5078
 Site-East_Asian                (2) | Val  Loss: 1.6228 | Val  Acc: 0.4048
 Site-East_Asian                (2) | Val  Loss: 1.4514 | Val  Acc: 0.4609
 Site-Indian_utk                (0) | Val  Loss: 1.4375 | Val  Acc: 0.4762
 Site-Indian_utk                (0) | Val  Loss: 1.5145 | Val  Acc: 0.4453
 Site-Black_utk                 (5) | Val  Loss: 1.4277 | Val  Acc: 0.5714
 Site-Black_utk                 (5) | Val  Loss: 1.5055 | Val  Acc: 0.4609
 Site-Southeast_Asian           (2) | Val  Loss: 1.6214 | Val  Acc: 0.3571
 Site-Southeast_Asian           (2) | Val  Loss: 1.5995 | Val  Acc: 0.3906
 Site-Asian_ffhq                (1) | Val  Loss: 1.2635 | Val  Acc: 0.6667
 Site-Asian_ffhq                (6) | Val  Loss: 1.4082 | Val  Acc: 0.4922
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.9344 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.5109 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4534
 Best site-White_utk                (0)  | Epoch:25 | Val Acc: 0.5952
 Best site-White_utk                (0)  | Epoch:25 | Val Acc: 0.5078
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.4048
 Best site-East_Asian               (2)  | Epoch:25 | Val Acc: 0.4609
 Best site-Indian_utk               (0)  | Epoch:25 | Val Acc: 0.4762
 Best site-Indian_utk               (0)  | Epoch:25 | Val Acc: 0.4453
 Best site-Black_utk                (5)  | Epoch:25 | Val Acc: 0.5714
 Best site-Black_utk                (5)  | Epoch:25 | Val Acc: 0.4609
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.3571
 Best site-Southeast_Asian          (2)  | Epoch:25 | Val Acc: 0.3906
 Best site-Asian_ffhq               (1)  | Epoch:25 | Val Acc: 0.6667
 Best site-Asian_ffhq               (6)  | Epoch:25 | Val Acc: 0.4922
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:25 | Val Acc: 0.1429
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:25 | Val Acc: 0.3750
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 4, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
min_w=0.26470, quan_i=1.52, quan_c=1.53
minimize weight of clients:[1, 4, 5, 6, 11, 12, 13, ]
 Site-White_utk                 (3) | Train Loss: 1.5463 | Train Acc: 0.3906
 Site-White_utk                 (3) | Train Loss: 1.4623 | Train Acc: 0.4167
 Site-East_Asian                (1) | Train Loss: 1.4121 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.5064 | Train Acc: 0.4271
 Site-Indian_utk                (3) | Train Loss: 1.3787 | Train Acc: 0.5000
 Site-Indian_utk                (3) | Train Loss: 1.4493 | Train Acc: 0.4792
 Site-Black_utk                 (0) | Train Loss: 1.4460 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.4056 | Train Acc: 0.5156
 Site-Southeast_Asian           (1) | Train Loss: 1.6781 | Train Acc: 0.4062
 Site-Southeast_Asian           (1) | Train Loss: 1.5498 | Train Acc: 0.4219
 Site-Asian_ffhq                (6) | Train Loss: 1.3834 | Train Acc: 0.5312
 Site-Asian_ffhq                (2) | Train Loss: 1.2303 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 0.9825 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.5039 | Train Acc: 0.3385
Average Train Accuracy: 0.4870
 Site-White_utk                 (3) | Val  Loss: 1.4717 | Val  Acc: 0.4762
 Site-White_utk                 (3) | Val  Loss: 1.4370 | Val  Acc: 0.4219
 Site-East_Asian                (1) | Val  Loss: 1.6666 | Val  Acc: 0.4048
 Site-East_Asian                (1) | Val  Loss: 1.4656 | Val  Acc: 0.4609
 Site-Indian_utk                (3) | Val  Loss: 1.4284 | Val  Acc: 0.4524
 Site-Indian_utk                (3) | Val  Loss: 1.5013 | Val  Acc: 0.4531
 Site-Black_utk                 (0) | Val  Loss: 1.3799 | Val  Acc: 0.5714
 Site-Black_utk                 (0) | Val  Loss: 1.4773 | Val  Acc: 0.4844
 Site-Southeast_Asian           (1) | Val  Loss: 1.6105 | Val  Acc: 0.4286
 Site-Southeast_Asian           (1) | Val  Loss: 1.5946 | Val  Acc: 0.4141
 Site-Asian_ffhq                (6) | Val  Loss: 1.0901 | Val  Acc: 0.7143
 Site-Asian_ffhq                (2) | Val  Loss: 1.3239 | Val  Acc: 0.5234
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 2.0626 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.5043 | Val  Acc: 0.3828
Average Valid Accuracy: 0.4488
============ Train epoch 27 ============
cnt=[2, 4, 1, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
min_w=0.25476, quan_i=1.52, quan_c=1.47
minimize weight of clients:[1, 4, 5, 6, 7, 10, 11, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.5121 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.4197 | Train Acc: 0.4688
 Site-East_Asian                (5) | Train Loss: 1.3451 | Train Acc: 0.4375
 Site-East_Asian                (5) | Train Loss: 1.4758 | Train Acc: 0.4375
 Site-Indian_utk                (1) | Train Loss: 1.4276 | Train Acc: 0.5000
 Site-Indian_utk                (1) | Train Loss: 1.4420 | Train Acc: 0.4844
 Site-Black_utk                 (3) | Train Loss: 1.4352 | Train Acc: 0.5156
 Site-Black_utk                 (3) | Train Loss: 1.4594 | Train Acc: 0.5104
 Site-Southeast_Asian           (0) | Train Loss: 1.6171 | Train Acc: 0.3906
 Site-Southeast_Asian           (0) | Train Loss: 1.5374 | Train Acc: 0.3906
 Site-Asian_ffhq                (6) | Train Loss: 1.5127 | Train Acc: 0.5156
 Site-Asian_ffhq                (4) | Train Loss: 1.2836 | Train Acc: 0.5625
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1519 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4937 | Train Acc: 0.3750
Average Train Accuracy: 0.4762
 Site-White_utk                 (1) | Val  Loss: 1.3877 | Val  Acc: 0.4762
 Site-White_utk                 (1) | Val  Loss: 1.3940 | Val  Acc: 0.4766
 Site-East_Asian                (5) | Val  Loss: 1.5517 | Val  Acc: 0.3810
 Site-East_Asian                (5) | Val  Loss: 1.4306 | Val  Acc: 0.4766
 Site-Indian_utk                (1) | Val  Loss: 1.4717 | Val  Acc: 0.4286
 Site-Indian_utk                (1) | Val  Loss: 1.4977 | Val  Acc: 0.4219
 Site-Black_utk                 (3) | Val  Loss: 1.3559 | Val  Acc: 0.5952
 Site-Black_utk                 (3) | Val  Loss: 1.4401 | Val  Acc: 0.5391
 Site-Southeast_Asian           (0) | Val  Loss: 1.5388 | Val  Acc: 0.3810
 Site-Southeast_Asian           (0) | Val  Loss: 1.5833 | Val  Acc: 0.3828
 Site-Asian_ffhq                (6) | Val  Loss: 1.1940 | Val  Acc: 0.6905
 Site-Asian_ffhq                (4) | Val  Loss: 1.4036 | Val  Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.9036 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.4596 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4448
============ Train epoch 28 ============
cnt=[1, 2, 4, 3, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
min_w=0.25381, quan_i=1.52, quan_c=1.51
minimize weight of clients:[1, 4, 5, 6, 7, 11, 12, ]
 Site-White_utk                 (3) | Train Loss: 1.5892 | Train Acc: 0.3438
 Site-White_utk                 (3) | Train Loss: 1.5035 | Train Acc: 0.4167
 Site-East_Asian                (2) | Train Loss: 1.3502 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.5136 | Train Acc: 0.4115
 Site-Indian_utk                (0) | Train Loss: 1.3658 | Train Acc: 0.5312
 Site-Indian_utk                (3) | Train Loss: 1.4381 | Train Acc: 0.4167
 Site-Black_utk                 (6) | Train Loss: 1.4223 | Train Acc: 0.5156
 Site-Black_utk                 (6) | Train Loss: 1.4576 | Train Acc: 0.4740
 Site-Southeast_Asian           (2) | Train Loss: 1.7056 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.6120 | Train Acc: 0.3854
 Site-Asian_ffhq                (5) | Train Loss: 1.2658 | Train Acc: 0.5469
 Site-Asian_ffhq                (1) | Train Loss: 1.0613 | Train Acc: 0.6615
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 0.9292 | Train Acc: 0.8125
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.3624 | Train Acc: 0.3698
Average Train Accuracy: 0.4818
 Site-White_utk                 (3) | Val  Loss: 1.4589 | Val  Acc: 0.5238
 Site-White_utk                 (3) | Val  Loss: 1.4963 | Val  Acc: 0.4375
 Site-East_Asian                (2) | Val  Loss: 1.6914 | Val  Acc: 0.3333
 Site-East_Asian                (2) | Val  Loss: 1.4641 | Val  Acc: 0.4375
 Site-Indian_utk                (0) | Val  Loss: 1.5078 | Val  Acc: 0.4286
 Site-Indian_utk                (3) | Val  Loss: 1.5016 | Val  Acc: 0.4688
 Site-Black_utk                 (6) | Val  Loss: 1.4160 | Val  Acc: 0.5000
 Site-Black_utk                 (6) | Val  Loss: 1.4497 | Val  Acc: 0.5234
 Site-Southeast_Asian           (2) | Val  Loss: 1.6685 | Val  Acc: 0.3333
 Site-Southeast_Asian           (2) | Val  Loss: 1.6090 | Val  Acc: 0.3750
 Site-Asian_ffhq                (5) | Val  Loss: 0.9531 | Val  Acc: 0.7619
 Site-Asian_ffhq                (1) | Val  Loss: 1.1773 | Val  Acc: 0.5547
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.8529 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.3470 | Val  Acc: 0.4062
Average Valid Accuracy: 0.4448
============ Train epoch 29 ============
cnt=[1, 1, 4, 4, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
min_w=0.25333, quan_i=1.52, quan_c=1.49
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (2) | Train Loss: 1.5086 | Train Acc: 0.3906
 Site-White_utk                 (2) | Train Loss: 1.3899 | Train Acc: 0.5104
 Site-East_Asian                (3) | Train Loss: 1.3361 | Train Acc: 0.4531
 Site-East_Asian                (3) | Train Loss: 1.4110 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.3918 | Train Acc: 0.4844
 Site-Indian_utk                (2) | Train Loss: 1.4532 | Train Acc: 0.4896
 Site-Black_utk                 (5) | Train Loss: 1.4483 | Train Acc: 0.4844
 Site-Black_utk                 (5) | Train Loss: 1.4765 | Train Acc: 0.5260
 Site-Southeast_Asian           (3) | Train Loss: 1.6359 | Train Acc: 0.3438
 Site-Southeast_Asian           (3) | Train Loss: 1.5126 | Train Acc: 0.4531
 Site-Asian_ffhq                (0) | Train Loss: 1.4757 | Train Acc: 0.5312
 Site-Asian_ffhq                (6) | Train Loss: 1.3003 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1281 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.4731 | Train Acc: 0.3854
Average Train Accuracy: 0.4881
 Site-White_utk                 (2) | Val  Loss: 1.3405 | Val  Acc: 0.5476
 Site-White_utk                 (2) | Val  Loss: 1.3762 | Val  Acc: 0.5000
 Site-East_Asian                (3) | Val  Loss: 1.5328 | Val  Acc: 0.4286
 Site-East_Asian                (3) | Val  Loss: 1.4096 | Val  Acc: 0.4531
 Site-Indian_utk                (2) | Val  Loss: 1.4761 | Val  Acc: 0.3571
 Site-Indian_utk                (2) | Val  Loss: 1.5216 | Val  Acc: 0.4844
 Site-Black_utk                 (5) | Val  Loss: 1.4670 | Val  Acc: 0.4762
 Site-Black_utk                 (5) | Val  Loss: 1.4916 | Val  Acc: 0.5156
 Site-Southeast_Asian           (3) | Val  Loss: 1.5113 | Val  Acc: 0.4286
 Site-Southeast_Asian           (3) | Val  Loss: 1.5268 | Val  Acc: 0.4219
 Site-Asian_ffhq                (0) | Val  Loss: 1.2297 | Val  Acc: 0.6667
 Site-Asian_ffhq                (6) | Val  Loss: 1.4389 | Val  Acc: 0.4531
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.7665 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.4362 | Val  Acc: 0.4453
Average Valid Accuracy: 0.4583
 Best site-White_utk                (2)  | Epoch:29 | Val Acc: 0.5476
 Best site-White_utk                (2)  | Epoch:29 | Val Acc: 0.5000
 Best site-East_Asian               (3)  | Epoch:29 | Val Acc: 0.4286
 Best site-East_Asian               (3)  | Epoch:29 | Val Acc: 0.4531
 Best site-Indian_utk               (2)  | Epoch:29 | Val Acc: 0.3571
 Best site-Indian_utk               (2)  | Epoch:29 | Val Acc: 0.4844
 Best site-Black_utk                (5)  | Epoch:29 | Val Acc: 0.4762
 Best site-Black_utk                (5)  | Epoch:29 | Val Acc: 0.5156
 Best site-Southeast_Asian          (3)  | Epoch:29 | Val Acc: 0.4286
 Best site-Southeast_Asian          (3)  | Epoch:29 | Val Acc: 0.4219
 Best site-Asian_ffhq               (0)  | Epoch:29 | Val Acc: 0.6667
 Best site-Asian_ffhq               (6)  | Epoch:29 | Val Acc: 0.4531
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:29 | Val Acc: 0.2381
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:29 | Val Acc: 0.4453
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (2)| Epoch:29 | Test Acc: 0.3412
 Test site-East_Asian                (3)| Epoch:29 | Test Acc: 0.4687
 Test site-Indian_utk                (2)| Epoch:29 | Test Acc: 0.5000
 Test site-Black_utk                 (5)| Epoch:29 | Test Acc: 0.3776
 Test site-Southeast_Asian           (3)| Epoch:29 | Test Acc: 0.4211
 Test site-Asian_ffhq                (0)| Epoch:29 | Test Acc: 0.3088
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:29 | Test Acc: 0.2985
White_utk: 0.3412, East_Asian: 0.4687, Indian_utk: 0.5000, Black_utk: 0.3776, Southeast_Asian: 0.4211, Asian_ffhq: 0.3088, Latino_Hispanic_ffhq: 0.2985, 
Average Test Accuracy(group): 0.3880, Average Test Accuracy(individual): 0.3880,
domain CV=0.1867, cluster CV=nan, individual CV=0.1867, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 30 ============
cnt=[4, 2, 1, 4, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
min_w=0.24877, quan_i=1.49, quan_c=1.48
minimize weight of clients:[1, 2, 3, 4, 5, 11, 12, ]
 Site-White_utk                 (3) | Train Loss: 1.6788 | Train Acc: 0.3125
 Site-White_utk                 (3) | Train Loss: 1.5947 | Train Acc: 0.3542
 Site-East_Asian                (0) | Train Loss: 1.4629 | Train Acc: 0.4375
 Site-East_Asian                (0) | Train Loss: 1.4978 | Train Acc: 0.4271
 Site-Indian_utk                (3) | Train Loss: 1.4129 | Train Acc: 0.5000
 Site-Indian_utk                (3) | Train Loss: 1.4547 | Train Acc: 0.4323
 Site-Black_utk                 (1) | Train Loss: 1.4242 | Train Acc: 0.5000
 Site-Black_utk                 (1) | Train Loss: 1.4379 | Train Acc: 0.4844
 Site-Southeast_Asian           (0) | Train Loss: 1.7757 | Train Acc: 0.3750
 Site-Southeast_Asian           (0) | Train Loss: 1.6592 | Train Acc: 0.3958
 Site-Asian_ffhq                (2) | Train Loss: 1.0869 | Train Acc: 0.5938
 Site-Asian_ffhq                (4) | Train Loss: 0.9214 | Train Acc: 0.7031
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 0.7943 | Train Acc: 0.8281
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.2542 | Train Acc: 0.4010
Average Train Accuracy: 0.4818
 Site-White_utk                 (3) | Val  Loss: 1.5421 | Val  Acc: 0.3810
 Site-White_utk                 (3) | Val  Loss: 1.5579 | Val  Acc: 0.4062
 Site-East_Asian                (0) | Val  Loss: 1.6691 | Val  Acc: 0.3571
 Site-East_Asian                (0) | Val  Loss: 1.5128 | Val  Acc: 0.4375
 Site-Indian_utk                (3) | Val  Loss: 1.4069 | Val  Acc: 0.4762
 Site-Indian_utk                (3) | Val  Loss: 1.4997 | Val  Acc: 0.4375
 Site-Black_utk                 (1) | Val  Loss: 1.3979 | Val  Acc: 0.4762
 Site-Black_utk                 (1) | Val  Loss: 1.4795 | Val  Acc: 0.4922
 Site-Southeast_Asian           (0) | Val  Loss: 1.7478 | Val  Acc: 0.3810
 Site-Southeast_Asian           (0) | Val  Loss: 1.6832 | Val  Acc: 0.3750
 Site-Asian_ffhq                (2) | Val  Loss: 0.7869 | Val  Acc: 0.7857
 Site-Asian_ffhq                (4) | Val  Loss: 1.0364 | Val  Acc: 0.5703
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.9239 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.2816 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4330
============ Train epoch 31 ============
cnt=[4, 4, 1, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
min_w=0.27545, quan_i=1.52, quan_c=1.55
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 1.4596 | Train Acc: 0.3906
 Site-White_utk                 (0) | Train Loss: 1.4020 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.3446 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.4328 | Train Acc: 0.4479
 Site-Indian_utk                (0) | Train Loss: 1.3782 | Train Acc: 0.5156
 Site-Indian_utk                (0) | Train Loss: 1.4313 | Train Acc: 0.4531
 Site-Black_utk                 (3) | Train Loss: 1.4267 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.4476 | Train Acc: 0.4948
 Site-Southeast_Asian           (1) | Train Loss: 1.6173 | Train Acc: 0.4062
 Site-Southeast_Asian           (1) | Train Loss: 1.4678 | Train Acc: 0.4635
 Site-Asian_ffhq                (4) | Train Loss: 1.4922 | Train Acc: 0.5156
 Site-Asian_ffhq                (6) | Train Loss: 1.3195 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.1964 | Train Acc: 0.6562
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.4657 | Train Acc: 0.4167
Average Train Accuracy: 0.4885
 Site-White_utk                 (0) | Val  Loss: 1.3716 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.3769 | Val  Acc: 0.4922
 Site-East_Asian                (1) | Val  Loss: 1.5595 | Val  Acc: 0.3810
 Site-East_Asian                (1) | Val  Loss: 1.3850 | Val  Acc: 0.4688
 Site-Indian_utk                (0) | Val  Loss: 1.4308 | Val  Acc: 0.5000
 Site-Indian_utk                (0) | Val  Loss: 1.4869 | Val  Acc: 0.4531
 Site-Black_utk                 (3) | Val  Loss: 1.3669 | Val  Acc: 0.6429
 Site-Black_utk                 (3) | Val  Loss: 1.4801 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.5253 | Val  Acc: 0.4048
 Site-Southeast_Asian           (1) | Val  Loss: 1.5430 | Val  Acc: 0.4375
 Site-Asian_ffhq                (4) | Val  Loss: 1.2680 | Val  Acc: 0.6905
 Site-Asian_ffhq                (6) | Val  Loss: 1.3756 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8055 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.4448 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4652
 Best site-White_utk                (0)  | Epoch:31 | Val Acc: 0.5000
 Best site-White_utk                (0)  | Epoch:31 | Val Acc: 0.4922
 Best site-East_Asian               (1)  | Epoch:31 | Val Acc: 0.3810
 Best site-East_Asian               (1)  | Epoch:31 | Val Acc: 0.4688
 Best site-Indian_utk               (0)  | Epoch:31 | Val Acc: 0.5000
 Best site-Indian_utk               (0)  | Epoch:31 | Val Acc: 0.4531
 Best site-Black_utk                (3)  | Epoch:31 | Val Acc: 0.6429
 Best site-Black_utk                (3)  | Epoch:31 | Val Acc: 0.4922
 Best site-Southeast_Asian          (1)  | Epoch:31 | Val Acc: 0.4048
 Best site-Southeast_Asian          (1)  | Epoch:31 | Val Acc: 0.4375
 Best site-Asian_ffhq               (4)  | Epoch:31 | Val Acc: 0.6905
 Best site-Asian_ffhq               (6)  | Epoch:31 | Val Acc: 0.4688
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:31 | Val Acc: 0.1905
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:31 | Val Acc: 0.3906
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 32 ============
cnt=[2, 4, 2, 1, 2, 1, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
min_w=0.24747, quan_i=1.47, quan_c=1.47
minimize weight of clients:[1, 4, 5, 6, 7, 11, 12, ]
 Site-White_utk                 (4) | Train Loss: 1.4752 | Train Acc: 0.3906
 Site-White_utk                 (4) | Train Loss: 1.4097 | Train Acc: 0.4740
 Site-East_Asian                (1) | Train Loss: 1.3220 | Train Acc: 0.5000
 Site-East_Asian                (1) | Train Loss: 1.4360 | Train Acc: 0.4323
 Site-Indian_utk                (2) | Train Loss: 1.3435 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.4372 | Train Acc: 0.4323
 Site-Black_utk                 (6) | Train Loss: 1.4352 | Train Acc: 0.4688
 Site-Black_utk                 (6) | Train Loss: 1.4220 | Train Acc: 0.5156
 Site-Southeast_Asian           (1) | Train Loss: 1.6284 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.5116 | Train Acc: 0.4062
 Site-Asian_ffhq                (3) | Train Loss: 1.2280 | Train Acc: 0.5625
 Site-Asian_ffhq                (0) | Train Loss: 1.1402 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 0.9930 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3713 | Train Acc: 0.4010
Average Train Accuracy: 0.4903
 Site-White_utk                 (4) | Val  Loss: 1.4000 | Val  Acc: 0.5000
 Site-White_utk                 (4) | Val  Loss: 1.3805 | Val  Acc: 0.4766
 Site-East_Asian                (1) | Val  Loss: 1.5891 | Val  Acc: 0.3810
 Site-East_Asian                (1) | Val  Loss: 1.4026 | Val  Acc: 0.4531
 Site-Indian_utk                (2) | Val  Loss: 1.4323 | Val  Acc: 0.4524
 Site-Indian_utk                (2) | Val  Loss: 1.4429 | Val  Acc: 0.4844
 Site-Black_utk                 (6) | Val  Loss: 1.3668 | Val  Acc: 0.6429
 Site-Black_utk                 (6) | Val  Loss: 1.4425 | Val  Acc: 0.4922
 Site-Southeast_Asian           (1) | Val  Loss: 1.5985 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.5226 | Val  Acc: 0.4219
 Site-Asian_ffhq                (3) | Val  Loss: 1.0607 | Val  Acc: 0.7143
 Site-Asian_ffhq                (0) | Val  Loss: 1.2496 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.8029 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3924 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4657
 Best site-White_utk                (4)  | Epoch:32 | Val Acc: 0.5000
 Best site-White_utk                (4)  | Epoch:32 | Val Acc: 0.4766
 Best site-East_Asian               (1)  | Epoch:32 | Val Acc: 0.3810
 Best site-East_Asian               (1)  | Epoch:32 | Val Acc: 0.4531
 Best site-Indian_utk               (2)  | Epoch:32 | Val Acc: 0.4524
 Best site-Indian_utk               (2)  | Epoch:32 | Val Acc: 0.4844
 Best site-Black_utk                (6)  | Epoch:32 | Val Acc: 0.6429
 Best site-Black_utk                (6)  | Epoch:32 | Val Acc: 0.4922
 Best site-Southeast_Asian          (1)  | Epoch:32 | Val Acc: 0.3571
 Best site-Southeast_Asian          (1)  | Epoch:32 | Val Acc: 0.4219
 Best site-Asian_ffhq               (3)  | Epoch:32 | Val Acc: 0.7143
 Best site-Asian_ffhq               (0)  | Epoch:32 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:32 | Val Acc: 0.2381
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:32 | Val Acc: 0.3750
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 33 ============
cnt=[4, 4, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
min_w=0.24194, quan_i=1.45, quan_c=1.44
minimize weight of clients:[1, 4, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (0) | Train Loss: 1.4961 | Train Acc: 0.3125
 Site-White_utk                 (0) | Train Loss: 1.3913 | Train Acc: 0.4948
 Site-East_Asian                (1) | Train Loss: 1.3007 | Train Acc: 0.4844
 Site-East_Asian                (1) | Train Loss: 1.4325 | Train Acc: 0.4479
 Site-Indian_utk                (0) | Train Loss: 1.3293 | Train Acc: 0.5156
 Site-Indian_utk                (0) | Train Loss: 1.4060 | Train Acc: 0.4792
 Site-Black_utk                 (4) | Train Loss: 1.4119 | Train Acc: 0.4688
 Site-Black_utk                 (4) | Train Loss: 1.3895 | Train Acc: 0.5260
 Site-Southeast_Asian           (1) | Train Loss: 1.6454 | Train Acc: 0.4375
 Site-Southeast_Asian           (1) | Train Loss: 1.4936 | Train Acc: 0.4219
 Site-Asian_ffhq                (6) | Train Loss: 1.3699 | Train Acc: 0.5156
 Site-Asian_ffhq                (5) | Train Loss: 1.2515 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.0898 | Train Acc: 0.7188
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.4401 | Train Acc: 0.3906
Average Train Accuracy: 0.4862
 Site-White_utk                 (0) | Val  Loss: 1.3077 | Val  Acc: 0.5000
 Site-White_utk                 (0) | Val  Loss: 1.3821 | Val  Acc: 0.5156
 Site-East_Asian                (1) | Val  Loss: 1.5727 | Val  Acc: 0.4762
 Site-East_Asian                (1) | Val  Loss: 1.4064 | Val  Acc: 0.4844
 Site-Indian_utk                (0) | Val  Loss: 1.4029 | Val  Acc: 0.4762
 Site-Indian_utk                (0) | Val  Loss: 1.4330 | Val  Acc: 0.5469
 Site-Black_utk                 (4) | Val  Loss: 1.3232 | Val  Acc: 0.6190
 Site-Black_utk                 (4) | Val  Loss: 1.4250 | Val  Acc: 0.5234
 Site-Southeast_Asian           (1) | Val  Loss: 1.5681 | Val  Acc: 0.4524
 Site-Southeast_Asian           (1) | Val  Loss: 1.5233 | Val  Acc: 0.4062
 Site-Asian_ffhq                (6) | Val  Loss: 1.1530 | Val  Acc: 0.6190
 Site-Asian_ffhq                (5) | Val  Loss: 1.3442 | Val  Acc: 0.4688
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.8890 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.4188 | Val  Acc: 0.3672
Average Valid Accuracy: 0.4696
 Best site-White_utk                (0)  | Epoch:33 | Val Acc: 0.5000
 Best site-White_utk                (0)  | Epoch:33 | Val Acc: 0.5156
 Best site-East_Asian               (1)  | Epoch:33 | Val Acc: 0.4762
 Best site-East_Asian               (1)  | Epoch:33 | Val Acc: 0.4844
 Best site-Indian_utk               (0)  | Epoch:33 | Val Acc: 0.4762
 Best site-Indian_utk               (0)  | Epoch:33 | Val Acc: 0.5469
 Best site-Black_utk                (4)  | Epoch:33 | Val Acc: 0.6190
 Best site-Black_utk                (4)  | Epoch:33 | Val Acc: 0.5234
 Best site-Southeast_Asian          (1)  | Epoch:33 | Val Acc: 0.4524
 Best site-Southeast_Asian          (1)  | Epoch:33 | Val Acc: 0.4062
 Best site-Asian_ffhq               (6)  | Epoch:33 | Val Acc: 0.6190
 Best site-Asian_ffhq               (5)  | Epoch:33 | Val Acc: 0.4688
 Best site-Latino_Hispanic_ffhq     (2)  | Epoch:33 | Val Acc: 0.1190
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:33 | Val Acc: 0.3672
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 34 ============
cnt=[3, 2, 1, 3, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
min_w=0.20636, quan_i=1.45, quan_c=1.44
minimize weight of clients:[2, 4, 5, 6, 7, 10, 11, 12, ]
 Site-White_utk                 (4) | Train Loss: 1.4290 | Train Acc: 0.4219
 Site-White_utk                 (4) | Train Loss: 1.3306 | Train Acc: 0.5677
 Site-East_Asian                (6) | Train Loss: 1.3475 | Train Acc: 0.4844
 Site-East_Asian                (3) | Train Loss: 1.4315 | Train Acc: 0.4635
 Site-Indian_utk                (5) | Train Loss: 1.4007 | Train Acc: 0.4375
 Site-Indian_utk                (5) | Train Loss: 1.4355 | Train Acc: 0.4844
 Site-Black_utk                 (1) | Train Loss: 1.4253 | Train Acc: 0.5156
 Site-Black_utk                 (1) | Train Loss: 1.4785 | Train Acc: 0.4896
 Site-Southeast_Asian           (3) | Train Loss: 1.6406 | Train Acc: 0.3594
 Site-Southeast_Asian           (3) | Train Loss: 1.4803 | Train Acc: 0.4688
 Site-Asian_ffhq                (2) | Train Loss: 1.6744 | Train Acc: 0.4531
 Site-Asian_ffhq                (0) | Train Loss: 1.4391 | Train Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3420 | Train Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.4966 | Train Acc: 0.4375
Average Train Accuracy: 0.4680
 Site-White_utk                 (4) | Val  Loss: 1.3718 | Val  Acc: 0.5238
 Site-White_utk                 (4) | Val  Loss: 1.3422 | Val  Acc: 0.5312
 Site-East_Asian                (6) | Val  Loss: 1.4851 | Val  Acc: 0.5238
 Site-East_Asian                (3) | Val  Loss: 1.3977 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.4402 | Val  Acc: 0.4762
 Site-Indian_utk                (5) | Val  Loss: 1.4926 | Val  Acc: 0.4297
 Site-Black_utk                 (1) | Val  Loss: 1.3634 | Val  Acc: 0.6429
 Site-Black_utk                 (1) | Val  Loss: 1.5116 | Val  Acc: 0.4922
 Site-Southeast_Asian           (3) | Val  Loss: 1.5349 | Val  Acc: 0.5000
 Site-Southeast_Asian           (3) | Val  Loss: 1.4998 | Val  Acc: 0.4766
 Site-Asian_ffhq                (2) | Val  Loss: 1.4041 | Val  Acc: 0.5714
 Site-Asian_ffhq                (0) | Val  Loss: 1.4917 | Val  Acc: 0.4375
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.7796 | Val  Acc: 0.2143
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.4762 | Val  Acc: 0.4141
Average Valid Accuracy: 0.4810
 Best site-White_utk                (4)  | Epoch:34 | Val Acc: 0.5238
 Best site-White_utk                (4)  | Epoch:34 | Val Acc: 0.5312
 Best site-East_Asian               (6)  | Epoch:34 | Val Acc: 0.5238
 Best site-East_Asian               (3)  | Epoch:34 | Val Acc: 0.5000
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.4762
 Best site-Indian_utk               (5)  | Epoch:34 | Val Acc: 0.4297
 Best site-Black_utk                (1)  | Epoch:34 | Val Acc: 0.6429
 Best site-Black_utk                (1)  | Epoch:34 | Val Acc: 0.4922
 Best site-Southeast_Asian          (3)  | Epoch:34 | Val Acc: 0.5000
 Best site-Southeast_Asian          (3)  | Epoch:34 | Val Acc: 0.4766
 Best site-Asian_ffhq               (2)  | Epoch:34 | Val Acc: 0.5714
 Best site-Asian_ffhq               (0)  | Epoch:34 | Val Acc: 0.4375
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:34 | Val Acc: 0.2143
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:34 | Val Acc: 0.4141
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 35 ============
cnt=[2, 1, 1, 2, 4, 3, 1, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
min_w=0.24663, quan_i=1.49, quan_c=1.48
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 12, ]
 Site-White_utk                 (4) | Train Loss: 1.4955 | Train Acc: 0.3281
 Site-White_utk                 (4) | Train Loss: 1.3926 | Train Acc: 0.4531
 Site-East_Asian                (5) | Train Loss: 1.3399 | Train Acc: 0.4688
 Site-East_Asian                (5) | Train Loss: 1.3863 | Train Acc: 0.4375
 Site-Indian_utk                (4) | Train Loss: 1.3263 | Train Acc: 0.5469
 Site-Indian_utk                (4) | Train Loss: 1.3657 | Train Acc: 0.4896
 Site-Black_utk                 (0) | Train Loss: 1.4104 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.4354 | Train Acc: 0.4948
 Site-Southeast_Asian           (2) | Train Loss: 1.6411 | Train Acc: 0.4375
 Site-Southeast_Asian           (5) | Train Loss: 1.5105 | Train Acc: 0.4219
 Site-Asian_ffhq                (6) | Train Loss: 1.3067 | Train Acc: 0.5312
 Site-Asian_ffhq                (3) | Train Loss: 1.1015 | Train Acc: 0.6198
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 0.9852 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3519 | Train Acc: 0.4219
Average Train Accuracy: 0.4940
 Site-White_utk                 (4) | Val  Loss: 1.3630 | Val  Acc: 0.5476
 Site-White_utk                 (4) | Val  Loss: 1.4078 | Val  Acc: 0.4609
 Site-East_Asian                (5) | Val  Loss: 1.5861 | Val  Acc: 0.3810
 Site-East_Asian                (5) | Val  Loss: 1.4102 | Val  Acc: 0.4531
 Site-Indian_utk                (4) | Val  Loss: 1.3853 | Val  Acc: 0.4286
 Site-Indian_utk                (4) | Val  Loss: 1.4320 | Val  Acc: 0.4844
 Site-Black_utk                 (0) | Val  Loss: 1.3658 | Val  Acc: 0.5714
 Site-Black_utk                 (0) | Val  Loss: 1.4242 | Val  Acc: 0.5078
 Site-Southeast_Asian           (2) | Val  Loss: 1.5368 | Val  Acc: 0.4048
 Site-Southeast_Asian           (5) | Val  Loss: 1.5013 | Val  Acc: 0.4219
 Site-Asian_ffhq                (6) | Val  Loss: 1.0341 | Val  Acc: 0.7143
 Site-Asian_ffhq                (3) | Val  Loss: 1.2161 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.8833 | Val  Acc: 0.1905
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.3649 | Val  Acc: 0.4531
Average Valid Accuracy: 0.4679
============ Train epoch 36 ============
cnt=[2, 2, 4, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
min_w=0.24727, quan_i=1.43, quan_c=1.45
minimize weight of clients:[1, 4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.5331 | Train Acc: 0.3281
 Site-White_utk                 (1) | Train Loss: 1.4263 | Train Acc: 0.4375
 Site-East_Asian                (2) | Train Loss: 1.3796 | Train Acc: 0.4375
 Site-East_Asian                (2) | Train Loss: 1.3978 | Train Acc: 0.4583
 Site-Indian_utk                (4) | Train Loss: 1.3291 | Train Acc: 0.5469
 Site-Indian_utk                (4) | Train Loss: 1.3828 | Train Acc: 0.4844
 Site-Black_utk                 (5) | Train Loss: 1.3226 | Train Acc: 0.5312
 Site-Black_utk                 (5) | Train Loss: 1.3956 | Train Acc: 0.5052
 Site-Southeast_Asian           (2) | Train Loss: 1.6770 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.5205 | Train Acc: 0.4427
 Site-Asian_ffhq                (6) | Train Loss: 1.3296 | Train Acc: 0.5156
 Site-Asian_ffhq                (0) | Train Loss: 1.1007 | Train Acc: 0.6302
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 0.9381 | Train Acc: 0.7812
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3929 | Train Acc: 0.3698
Average Train Accuracy: 0.4911
 Site-White_utk                 (1) | Val  Loss: 1.4013 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.4222 | Val  Acc: 0.4688
 Site-East_Asian                (2) | Val  Loss: 1.5779 | Val  Acc: 0.4048
 Site-East_Asian                (2) | Val  Loss: 1.4119 | Val  Acc: 0.4688
 Site-Indian_utk                (4) | Val  Loss: 1.3539 | Val  Acc: 0.5238
 Site-Indian_utk                (4) | Val  Loss: 1.4265 | Val  Acc: 0.4766
 Site-Black_utk                 (5) | Val  Loss: 1.2902 | Val  Acc: 0.5952
 Site-Black_utk                 (5) | Val  Loss: 1.3409 | Val  Acc: 0.5234
 Site-Southeast_Asian           (2) | Val  Loss: 1.5246 | Val  Acc: 0.3810
 Site-Southeast_Asian           (2) | Val  Loss: 1.5386 | Val  Acc: 0.4062
 Site-Asian_ffhq                (6) | Val  Loss: 0.9788 | Val  Acc: 0.6905
 Site-Asian_ffhq                (0) | Val  Loss: 1.2104 | Val  Acc: 0.5234
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9952 | Val  Acc: 0.0952
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3827 | Val  Acc: 0.3828
Average Valid Accuracy: 0.4549
============ Train epoch 37 ============
cnt=[4, 3, 2, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
min_w=0.25845, quan_i=1.41, quan_c=1.43
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.4037 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.3308 | Train Acc: 0.5365
 Site-East_Asian                (0) | Train Loss: 1.3243 | Train Acc: 0.5000
 Site-East_Asian                (0) | Train Loss: 1.3987 | Train Acc: 0.4531
 Site-Indian_utk                (5) | Train Loss: 1.3092 | Train Acc: 0.5469
 Site-Indian_utk                (1) | Train Loss: 1.3996 | Train Acc: 0.4479
 Site-Black_utk                 (4) | Train Loss: 1.3665 | Train Acc: 0.5625
 Site-Black_utk                 (4) | Train Loss: 1.4070 | Train Acc: 0.5573
 Site-Southeast_Asian           (0) | Train Loss: 1.5672 | Train Acc: 0.4219
 Site-Southeast_Asian           (0) | Train Loss: 1.4200 | Train Acc: 0.4479
 Site-Asian_ffhq                (3) | Train Loss: 1.5649 | Train Acc: 0.5469
 Site-Asian_ffhq                (2) | Train Loss: 1.3052 | Train Acc: 0.5677
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.1423 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4673 | Train Acc: 0.4062
Average Train Accuracy: 0.5074
 Site-White_utk                 (1) | Val  Loss: 1.2507 | Val  Acc: 0.4524
 Site-White_utk                 (1) | Val  Loss: 1.3270 | Val  Acc: 0.5234
 Site-East_Asian                (0) | Val  Loss: 1.4963 | Val  Acc: 0.4762
 Site-East_Asian                (0) | Val  Loss: 1.3879 | Val  Acc: 0.4844
 Site-Indian_utk                (5) | Val  Loss: 1.3836 | Val  Acc: 0.4524
 Site-Indian_utk                (1) | Val  Loss: 1.4562 | Val  Acc: 0.4531
 Site-Black_utk                 (4) | Val  Loss: 1.2986 | Val  Acc: 0.6429
 Site-Black_utk                 (4) | Val  Loss: 1.4089 | Val  Acc: 0.5391
 Site-Southeast_Asian           (0) | Val  Loss: 1.4718 | Val  Acc: 0.4762
 Site-Southeast_Asian           (0) | Val  Loss: 1.4888 | Val  Acc: 0.4609
 Site-Asian_ffhq                (3) | Val  Loss: 1.2191 | Val  Acc: 0.6905
 Site-Asian_ffhq                (2) | Val  Loss: 1.4170 | Val  Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8428 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.4533 | Val  Acc: 0.4141
Average Valid Accuracy: 0.4809
============ Train epoch 38 ============
cnt=[1, 4, 4, 1, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
min_w=0.22497, quan_i=1.41, quan_c=1.43
minimize weight of clients:[0, 1, 4, 5, 6, 7, 11, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.6691 | Train Acc: 0.3594
 Site-White_utk                 (1) | Train Loss: 1.5827 | Train Acc: 0.3698
 Site-East_Asian                (2) | Train Loss: 1.4040 | Train Acc: 0.4375
 Site-East_Asian                (2) | Train Loss: 1.4837 | Train Acc: 0.4219
 Site-Indian_utk                (1) | Train Loss: 1.3769 | Train Acc: 0.5156
 Site-Indian_utk                (1) | Train Loss: 1.4667 | Train Acc: 0.4219
 Site-Black_utk                 (6) | Train Loss: 1.4168 | Train Acc: 0.4844
 Site-Black_utk                 (6) | Train Loss: 1.4064 | Train Acc: 0.4740
 Site-Southeast_Asian           (2) | Train Loss: 1.6967 | Train Acc: 0.3750
 Site-Southeast_Asian           (2) | Train Loss: 1.5750 | Train Acc: 0.4115
 Site-Asian_ffhq                (0) | Train Loss: 1.0697 | Train Acc: 0.6406
 Site-Asian_ffhq                (3) | Train Loss: 0.8653 | Train Acc: 0.7083
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 0.7958 | Train Acc: 0.8125
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.1563 | Train Acc: 0.4740
Average Train Accuracy: 0.4933
 Site-White_utk                 (1) | Val  Loss: 1.5168 | Val  Acc: 0.4286
 Site-White_utk                 (1) | Val  Loss: 1.5565 | Val  Acc: 0.3984
 Site-East_Asian                (2) | Val  Loss: 1.6258 | Val  Acc: 0.3810
 Site-East_Asian                (2) | Val  Loss: 1.4609 | Val  Acc: 0.4297
 Site-Indian_utk                (1) | Val  Loss: 1.3971 | Val  Acc: 0.4524
 Site-Indian_utk                (1) | Val  Loss: 1.4771 | Val  Acc: 0.4297
 Site-Black_utk                 (6) | Val  Loss: 1.4132 | Val  Acc: 0.4762
 Site-Black_utk                 (6) | Val  Loss: 1.4811 | Val  Acc: 0.4609
 Site-Southeast_Asian           (2) | Val  Loss: 1.6470 | Val  Acc: 0.4048
 Site-Southeast_Asian           (2) | Val  Loss: 1.6251 | Val  Acc: 0.4219
 Site-Asian_ffhq                (0) | Val  Loss: 0.7414 | Val  Acc: 0.8095
 Site-Asian_ffhq                (3) | Val  Loss: 0.9728 | Val  Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.6881 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.2049 | Val  Acc: 0.4453
Average Valid Accuracy: 0.4493
============ Train epoch 39 ============
cnt=[1, 1, 4, 2, 2, 1, 3, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
min_w=0.27190, quan_i=1.50, quan_c=1.55
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (3) | Train Loss: 1.3652 | Train Acc: 0.4375
 Site-White_utk                 (3) | Train Loss: 1.2894 | Train Acc: 0.5833
 Site-East_Asian                (2) | Train Loss: 1.3341 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.3573 | Train Acc: 0.5104
 Site-Indian_utk                (6) | Train Loss: 1.3680 | Train Acc: 0.5469
 Site-Indian_utk                (6) | Train Loss: 1.4193 | Train Acc: 0.5052
 Site-Black_utk                 (0) | Train Loss: 1.4802 | Train Acc: 0.4375
 Site-Black_utk                 (6) | Train Loss: 1.4760 | Train Acc: 0.5104
 Site-Southeast_Asian           (2) | Train Loss: 1.6363 | Train Acc: 0.3906
 Site-Southeast_Asian           (2) | Train Loss: 1.4321 | Train Acc: 0.4948
 Site-Asian_ffhq                (4) | Train Loss: 1.5432 | Train Acc: 0.5000
 Site-Asian_ffhq                (5) | Train Loss: 1.4223 | Train Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.3376 | Train Acc: 0.5625
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 1.4685 | Train Acc: 0.4479
Average Train Accuracy: 0.4948
 Site-White_utk                 (3) | Val  Loss: 1.2756 | Val  Acc: 0.6190
 Site-White_utk                 (3) | Val  Loss: 1.2902 | Val  Acc: 0.6094
 Site-East_Asian                (2) | Val  Loss: 1.4958 | Val  Acc: 0.5000
 Site-East_Asian                (2) | Val  Loss: 1.3568 | Val  Acc: 0.5312
 Site-Indian_utk                (6) | Val  Loss: 1.4077 | Val  Acc: 0.4762
 Site-Indian_utk                (6) | Val  Loss: 1.5002 | Val  Acc: 0.4531
 Site-Black_utk                 (0) | Val  Loss: 1.3621 | Val  Acc: 0.5238
 Site-Black_utk                 (6) | Val  Loss: 1.4818 | Val  Acc: 0.4922
 Site-Southeast_Asian           (2) | Val  Loss: 1.4974 | Val  Acc: 0.4286
 Site-Southeast_Asian           (2) | Val  Loss: 1.4254 | Val  Acc: 0.4922
 Site-Asian_ffhq                (4) | Val  Loss: 1.3419 | Val  Acc: 0.6190
 Site-Asian_ffhq                (5) | Val  Loss: 1.4464 | Val  Acc: 0.4062
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.6619 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.4561 | Val  Acc: 0.4375
Average Valid Accuracy: 0.4876
 Best site-White_utk                (3)  | Epoch:39 | Val Acc: 0.6190
 Best site-White_utk                (3)  | Epoch:39 | Val Acc: 0.6094
 Best site-East_Asian               (2)  | Epoch:39 | Val Acc: 0.5000
 Best site-East_Asian               (2)  | Epoch:39 | Val Acc: 0.5312
 Best site-Indian_utk               (6)  | Epoch:39 | Val Acc: 0.4762
 Best site-Indian_utk               (6)  | Epoch:39 | Val Acc: 0.4531
 Best site-Black_utk                (0)  | Epoch:39 | Val Acc: 0.5238
 Best site-Black_utk                (6)  | Epoch:39 | Val Acc: 0.4922
 Best site-Southeast_Asian          (2)  | Epoch:39 | Val Acc: 0.4286
 Best site-Southeast_Asian          (2)  | Epoch:39 | Val Acc: 0.4922
 Best site-Asian_ffhq               (4)  | Epoch:39 | Val Acc: 0.6190
 Best site-Asian_ffhq               (5)  | Epoch:39 | Val Acc: 0.4062
 Best site-Latino_Hispanic_ffhq     (4)  | Epoch:39 | Val Acc: 0.2381
 Best site-Latino_Hispanic_ffhq     (1)  | Epoch:39 | Val Acc: 0.4375
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Test site-White_utk                 (3)| Epoch:39 | Test Acc: 0.3690
 Test site-East_Asian                (2)| Epoch:39 | Test Acc: 0.4806
 Test site-Indian_utk                (6)| Epoch:39 | Test Acc: 0.4833
 Test site-Black_utk                 (0)| Epoch:39 | Test Acc: 0.3265
 Test site-Southeast_Asian           (2)| Epoch:39 | Test Acc: 0.4177
 Test site-Asian_ffhq                (4)| Epoch:39 | Test Acc: 0.2794
 Test site-Latino_Hispanic_ffhq      (4)| Epoch:39 | Test Acc: 0.2687
White_utk: 0.3690, East_Asian: 0.4806, Indian_utk: 0.4833, Black_utk: 0.3265, Southeast_Asian: 0.4177, Asian_ffhq: 0.2794, Latino_Hispanic_ffhq: 0.2687, 
Average Test Accuracy(group): 0.3750, Average Test Accuracy(individual): 0.3750,
domain CV=0.2197, cluster CV=nan, individual CV=0.2197, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 40 ============
cnt=[1, 4, 2, 2, 1, 1, 3, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
min_w=0.24154, quan_i=1.47, quan_c=1.46
minimize weight of clients:[0, 1, 2, 3, 4, 5, 9, 11, ]
 Site-White_utk                 (6) | Train Loss: 1.4876 | Train Acc: 0.4688
 Site-White_utk                 (6) | Train Loss: 1.3977 | Train Acc: 0.4531
 Site-East_Asian                (1) | Train Loss: 1.4034 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.4123 | Train Acc: 0.4375
 Site-Indian_utk                (0) | Train Loss: 1.3762 | Train Acc: 0.4844
 Site-Indian_utk                (6) | Train Loss: 1.4197 | Train Acc: 0.4531
 Site-Black_utk                 (3) | Train Loss: 1.3533 | Train Acc: 0.5469
 Site-Black_utk                 (3) | Train Loss: 1.3731 | Train Acc: 0.5000
 Site-Southeast_Asian           (1) | Train Loss: 1.6261 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.5141 | Train Acc: 0.4323
 Site-Asian_ffhq                (2) | Train Loss: 1.1505 | Train Acc: 0.5625
 Site-Asian_ffhq                (5) | Train Loss: 1.0551 | Train Acc: 0.6354
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.0247 | Train Acc: 0.7188
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.2275 | Train Acc: 0.4375
Average Train Accuracy: 0.5015
 Site-White_utk                 (6) | Val  Loss: 1.3425 | Val  Acc: 0.5000
 Site-White_utk                 (6) | Val  Loss: 1.3637 | Val  Acc: 0.5156
 Site-East_Asian                (1) | Val  Loss: 1.5682 | Val  Acc: 0.4048
 Site-East_Asian                (1) | Val  Loss: 1.3743 | Val  Acc: 0.4297
 Site-Indian_utk                (0) | Val  Loss: 1.3659 | Val  Acc: 0.5000
 Site-Indian_utk                (6) | Val  Loss: 1.4216 | Val  Acc: 0.4609
 Site-Black_utk                 (3) | Val  Loss: 1.2880 | Val  Acc: 0.6667
 Site-Black_utk                 (3) | Val  Loss: 1.3844 | Val  Acc: 0.4844
 Site-Southeast_Asian           (1) | Val  Loss: 1.5974 | Val  Acc: 0.3571
 Site-Southeast_Asian           (1) | Val  Loss: 1.5375 | Val  Acc: 0.4219
 Site-Asian_ffhq                (2) | Val  Loss: 0.9558 | Val  Acc: 0.6429
 Site-Asian_ffhq                (5) | Val  Loss: 1.0876 | Val  Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6526 | Val  Acc: 0.2857
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.2096 | Val  Acc: 0.4609
Average Valid Accuracy: 0.4792
 Test site-White_utk                 (6)| Epoch:39 | Test Acc: 0.2970
 Test site-East_Asian                (1)| Epoch:39 | Test Acc: 0.4716
 Test site-Indian_utk                (0)| Epoch:39 | Test Acc: 0.5021
 Test site-Black_utk                 (3)| Epoch:39 | Test Acc: 0.4490
 Test site-Southeast_Asian           (1)| Epoch:39 | Test Acc: 0.4038
 Test site-Asian_ffhq                (2)| Epoch:39 | Test Acc: 0.3603
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:39 | Test Acc: 0.3731
White_utk: 0.2970, East_Asian: 0.4716, Indian_utk: 0.5021, Black_utk: 0.4490, Southeast_Asian: 0.4038, Asian_ffhq: 0.3603, Latino_Hispanic_ffhq: 0.3731, 
Average Test Accuracy(group): 0.4081, Average Test Accuracy(individual): 0.4081,
domain CV=0.1615, cluster CV=nan, individual CV=0.1615, 
Average Test Accuracy: 0.4081
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 41 ============
cnt=[4, 2, 2, 2, 1, 1, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
min_w=0.26126, quan_i=1.43, quan_c=1.44
minimize weight of clients:[1, 4, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.5104 | Train Acc: 0.3438
 Site-White_utk                 (1) | Train Loss: 1.3321 | Train Acc: 0.5052
 Site-East_Asian                (0) | Train Loss: 1.3572 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.3917 | Train Acc: 0.4688
 Site-Indian_utk                (2) | Train Loss: 1.2884 | Train Acc: 0.5000
 Site-Indian_utk                (2) | Train Loss: 1.3486 | Train Acc: 0.4844
 Site-Black_utk                 (6) | Train Loss: 1.3675 | Train Acc: 0.5000
 Site-Black_utk                 (6) | Train Loss: 1.3656 | Train Acc: 0.5156
 Site-Southeast_Asian           (0) | Train Loss: 1.6117 | Train Acc: 0.4219
 Site-Southeast_Asian           (0) | Train Loss: 1.4576 | Train Acc: 0.4531
 Site-Asian_ffhq                (4) | Train Loss: 1.3942 | Train Acc: 0.5156
 Site-Asian_ffhq                (3) | Train Loss: 1.2084 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.0346 | Train Acc: 0.7344
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.3552 | Train Acc: 0.4115
Average Train Accuracy: 0.4952
 Site-White_utk                 (1) | Val  Loss: 1.3310 | Val  Acc: 0.5476
 Site-White_utk                 (1) | Val  Loss: 1.3456 | Val  Acc: 0.5156
 Site-East_Asian                (0) | Val  Loss: 1.5444 | Val  Acc: 0.4048
 Site-East_Asian                (0) | Val  Loss: 1.3939 | Val  Acc: 0.4844
 Site-Indian_utk                (2) | Val  Loss: 1.3919 | Val  Acc: 0.4762
 Site-Indian_utk                (2) | Val  Loss: 1.4043 | Val  Acc: 0.4609
 Site-Black_utk                 (6) | Val  Loss: 1.3023 | Val  Acc: 0.6190
 Site-Black_utk                 (6) | Val  Loss: 1.3556 | Val  Acc: 0.5469
 Site-Southeast_Asian           (0) | Val  Loss: 1.4115 | Val  Acc: 0.4524
 Site-Southeast_Asian           (0) | Val  Loss: 1.4831 | Val  Acc: 0.4453
 Site-Asian_ffhq                (4) | Val  Loss: 1.1156 | Val  Acc: 0.6905
 Site-Asian_ffhq                (3) | Val  Loss: 1.2877 | Val  Acc: 0.5000
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7718 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.3629 | Val  Acc: 0.4062
Average Valid Accuracy: 0.4849
 Test site-White_utk                 (1)| Epoch:40 | Test Acc: 0.3309
 Test site-East_Asian                (0)| Epoch:40 | Test Acc: 0.4796
 Test site-Indian_utk                (2)| Epoch:40 | Test Acc: 0.5250
 Test site-Black_utk                 (6)| Epoch:40 | Test Acc: 0.4439
 Test site-Southeast_Asian           (0)| Epoch:40 | Test Acc: 0.4107
 Test site-Asian_ffhq                (4)| Epoch:40 | Test Acc: 0.3143
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:40 | Test Acc: 0.2935
White_utk: 0.3309, East_Asian: 0.4796, Indian_utk: 0.5250, Black_utk: 0.4439, Southeast_Asian: 0.4107, Asian_ffhq: 0.3143, Latino_Hispanic_ffhq: 0.2935, 
Average Test Accuracy(group): 0.3997, Average Test Accuracy(individual): 0.3997,
domain CV=0.2060, cluster CV=nan, individual CV=0.2060, 
Average Test Accuracy: 0.3997
============ Train epoch 42 ============
cnt=[2, 1, 4, 2, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
min_w=0.24856, quan_i=1.41, quan_c=1.41
minimize weight of clients:[1, 4, 5, 6, 7, 11, 12, 13, ]
 Site-White_utk                 (5) | Train Loss: 1.4653 | Train Acc: 0.3438
 Site-White_utk                 (5) | Train Loss: 1.3717 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.3297 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.4374 | Train Acc: 0.4323
 Site-Indian_utk                (3) | Train Loss: 1.3124 | Train Acc: 0.5469
 Site-Indian_utk                (3) | Train Loss: 1.3457 | Train Acc: 0.4844
 Site-Black_utk                 (0) | Train Loss: 1.3485 | Train Acc: 0.5000
 Site-Black_utk                 (0) | Train Loss: 1.3504 | Train Acc: 0.5312
 Site-Southeast_Asian           (2) | Train Loss: 1.5920 | Train Acc: 0.3906
 Site-Southeast_Asian           (2) | Train Loss: 1.4432 | Train Acc: 0.4792
 Site-Asian_ffhq                (6) | Train Loss: 1.2385 | Train Acc: 0.5312
 Site-Asian_ffhq                (4) | Train Loss: 1.1372 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (1) | Train Loss: 0.9000 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (4) | Train Loss: 1.4165 | Train Acc: 0.3802
Average Train Accuracy: 0.5007
 Site-White_utk                 (5) | Val  Loss: 1.3409 | Val  Acc: 0.5000
 Site-White_utk                 (5) | Val  Loss: 1.3576 | Val  Acc: 0.4688
 Site-East_Asian                (2) | Val  Loss: 1.5659 | Val  Acc: 0.4048
 Site-East_Asian                (2) | Val  Loss: 1.3618 | Val  Acc: 0.5000
 Site-Indian_utk                (3) | Val  Loss: 1.2999 | Val  Acc: 0.4524
 Site-Indian_utk                (3) | Val  Loss: 1.3725 | Val  Acc: 0.4688
 Site-Black_utk                 (0) | Val  Loss: 1.3225 | Val  Acc: 0.6190
 Site-Black_utk                 (0) | Val  Loss: 1.3278 | Val  Acc: 0.5391
 Site-Southeast_Asian           (2) | Val  Loss: 1.4793 | Val  Acc: 0.4286
 Site-Southeast_Asian           (2) | Val  Loss: 1.4777 | Val  Acc: 0.4531
 Site-Asian_ffhq                (6) | Val  Loss: 0.9983 | Val  Acc: 0.7381
 Site-Asian_ffhq                (4) | Val  Loss: 1.2883 | Val  Acc: 0.5078
 Site-Latino_Hispanic_ffhq      (1) | Val  Loss: 1.8711 | Val  Acc: 0.1190
 Site-Latino_Hispanic_ffhq      (4) | Val  Loss: 1.3864 | Val  Acc: 0.3984
Average Valid Accuracy: 0.4713
 Test site-White_utk                 (5)| Epoch:40 | Test Acc: 0.3186
 Test site-East_Asian                (2)| Epoch:40 | Test Acc: 0.4816
 Test site-Indian_utk                (3)| Epoch:40 | Test Acc: 0.5146
 Test site-Black_utk                 (0)| Epoch:40 | Test Acc: 0.4184
 Test site-Southeast_Asian           (2)| Epoch:40 | Test Acc: 0.4159
 Test site-Asian_ffhq                (6)| Epoch:40 | Test Acc: 0.3309
 Test site-Latino_Hispanic_ffhq      (1)| Epoch:40 | Test Acc: 0.3184
White_utk: 0.3186, East_Asian: 0.4816, Indian_utk: 0.5146, Black_utk: 0.4184, Southeast_Asian: 0.4159, Asian_ffhq: 0.3309, Latino_Hispanic_ffhq: 0.3184, 
Average Test Accuracy(group): 0.3998, Average Test Accuracy(individual): 0.3998,
domain CV=0.1854, cluster CV=nan, individual CV=0.1854, 
Average Test Accuracy: 0.3998
============ Train epoch 43 ============
cnt=[2, 1, 4, 1, 1, 4, 1, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
min_w=0.22620, quan_i=1.43, quan_c=1.38
minimize weight of clients:[1, 4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (5) | Train Loss: 1.4384 | Train Acc: 0.4062
 Site-White_utk                 (5) | Train Loss: 1.3324 | Train Acc: 0.4792
 Site-East_Asian                (2) | Train Loss: 1.3174 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.4111 | Train Acc: 0.4688
 Site-Indian_utk                (5) | Train Loss: 1.2664 | Train Acc: 0.5781
 Site-Indian_utk                (5) | Train Loss: 1.3487 | Train Acc: 0.5104
 Site-Black_utk                 (1) | Train Loss: 1.3318 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.3610 | Train Acc: 0.5312
 Site-Southeast_Asian           (2) | Train Loss: 1.5757 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.4191 | Train Acc: 0.4792
 Site-Asian_ffhq                (6) | Train Loss: 1.4234 | Train Acc: 0.5312
 Site-Asian_ffhq                (0) | Train Loss: 1.2659 | Train Acc: 0.5938
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.0578 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.4447 | Train Acc: 0.3854
Average Train Accuracy: 0.5086
 Site-White_utk                 (5) | Val  Loss: 1.2732 | Val  Acc: 0.5238
 Site-White_utk                 (5) | Val  Loss: 1.3090 | Val  Acc: 0.5156
 Site-East_Asian                (2) | Val  Loss: 1.4053 | Val  Acc: 0.5238
 Site-East_Asian                (2) | Val  Loss: 1.3639 | Val  Acc: 0.4844
 Site-Indian_utk                (5) | Val  Loss: 1.3095 | Val  Acc: 0.5238
 Site-Indian_utk                (5) | Val  Loss: 1.3758 | Val  Acc: 0.5078
 Site-Black_utk                 (1) | Val  Loss: 1.3331 | Val  Acc: 0.5952
 Site-Black_utk                 (4) | Val  Loss: 1.3790 | Val  Acc: 0.5156
 Site-Southeast_Asian           (2) | Val  Loss: 1.4665 | Val  Acc: 0.4524
 Site-Southeast_Asian           (2) | Val  Loss: 1.4255 | Val  Acc: 0.4922
 Site-Asian_ffhq                (6) | Val  Loss: 1.1323 | Val  Acc: 0.7381
 Site-Asian_ffhq                (0) | Val  Loss: 1.3852 | Val  Acc: 0.4844
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.9245 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.4228 | Val  Acc: 0.3906
Average Valid Accuracy: 0.4939
 Best site-White_utk                (5)  | Epoch:43 | Val Acc: 0.5238
 Best site-White_utk                (5)  | Epoch:43 | Val Acc: 0.5156
 Best site-East_Asian               (2)  | Epoch:43 | Val Acc: 0.5238
 Best site-East_Asian               (2)  | Epoch:43 | Val Acc: 0.4844
 Best site-Indian_utk               (5)  | Epoch:43 | Val Acc: 0.5238
 Best site-Indian_utk               (5)  | Epoch:43 | Val Acc: 0.5078
 Best site-Black_utk                (1)  | Epoch:43 | Val Acc: 0.5952
 Best site-Black_utk                (4)  | Epoch:43 | Val Acc: 0.5156
 Best site-Southeast_Asian          (2)  | Epoch:43 | Val Acc: 0.4524
 Best site-Southeast_Asian          (2)  | Epoch:43 | Val Acc: 0.4922
 Best site-Asian_ffhq               (6)  | Epoch:43 | Val Acc: 0.7381
 Best site-Asian_ffhq               (0)  | Epoch:43 | Val Acc: 0.4844
 Best site-Latino_Hispanic_ffhq     (3)  | Epoch:43 | Val Acc: 0.1667
 Best site-Latino_Hispanic_ffhq     (0)  | Epoch:43 | Val Acc: 0.3906
 Test site-White_utk                 (5)| Epoch:43 | Test Acc: 0.3474
 Test site-East_Asian                (2)| Epoch:43 | Test Acc: 0.4786
 Test site-Indian_utk                (5)| Epoch:43 | Test Acc: 0.5188
 Test site-Black_utk                 (1)| Epoch:43 | Test Acc: 0.4133
 Test site-Southeast_Asian           (2)| Epoch:43 | Test Acc: 0.4194
 Test site-Asian_ffhq                (6)| Epoch:43 | Test Acc: 0.3070
 Test site-Latino_Hispanic_ffhq      (3)| Epoch:43 | Test Acc: 0.2935
White_utk: 0.3474, East_Asian: 0.4786, Indian_utk: 0.5188, Black_utk: 0.4133, Southeast_Asian: 0.4194, Asian_ffhq: 0.3070, Latino_Hispanic_ffhq: 0.2935, 
Average Test Accuracy(group): 0.3968, Average Test Accuracy(individual): 0.3968,
domain CV=0.1987, cluster CV=nan, individual CV=0.1987, 
Average Test Accuracy: 0.3968
============ Train epoch 44 ============
cnt=[2, 2, 4, 2, 1, 2, 1, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
min_w=0.23926, quan_i=1.43, quan_c=1.43
minimize weight of clients:[1, 4, 5, 6, 7, 11, 12, ]
 Site-White_utk                 (5) | Train Loss: 1.4899 | Train Acc: 0.4062
 Site-White_utk                 (5) | Train Loss: 1.3804 | Train Acc: 0.5000
 Site-East_Asian                (2) | Train Loss: 1.3443 | Train Acc: 0.4688
 Site-East_Asian                (2) | Train Loss: 1.3883 | Train Acc: 0.4427
 Site-Indian_utk                (3) | Train Loss: 1.2707 | Train Acc: 0.5156
 Site-Indian_utk                (3) | Train Loss: 1.3684 | Train Acc: 0.5052
 Site-Black_utk                 (1) | Train Loss: 1.3528 | Train Acc: 0.5312
 Site-Black_utk                 (1) | Train Loss: 1.3999 | Train Acc: 0.5052
 Site-Southeast_Asian           (2) | Train Loss: 1.5857 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.4287 | Train Acc: 0.4896
 Site-Asian_ffhq                (4) | Train Loss: 1.1410 | Train Acc: 0.5625
 Site-Asian_ffhq                (0) | Train Loss: 1.0467 | Train Acc: 0.6406
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 0.9038 | Train Acc: 0.7969
 Site-Latino_Hispanic_ffhq      (0) | Train Loss: 1.3365 | Train Acc: 0.4010
Average Train Accuracy: 0.5123
 Site-White_utk                 (5) | Val  Loss: 1.3957 | Val  Acc: 0.4286
 Site-White_utk                 (5) | Val  Loss: 1.3800 | Val  Acc: 0.4609
 Site-East_Asian                (2) | Val  Loss: 1.5227 | Val  Acc: 0.4048
 Site-East_Asian                (2) | Val  Loss: 1.3772 | Val  Acc: 0.4688
 Site-Indian_utk                (3) | Val  Loss: 1.3338 | Val  Acc: 0.4524
 Site-Indian_utk                (3) | Val  Loss: 1.3724 | Val  Acc: 0.4766
 Site-Black_utk                 (1) | Val  Loss: 1.2758 | Val  Acc: 0.6190
 Site-Black_utk                 (1) | Val  Loss: 1.3774 | Val  Acc: 0.5234
 Site-Southeast_Asian           (2) | Val  Loss: 1.4644 | Val  Acc: 0.5000
 Site-Southeast_Asian           (2) | Val  Loss: 1.5089 | Val  Acc: 0.4609
 Site-Asian_ffhq                (4) | Val  Loss: 0.8782 | Val  Acc: 0.7857
 Site-Asian_ffhq                (0) | Val  Loss: 1.1798 | Val  Acc: 0.5547
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8040 | Val  Acc: 0.1667
 Site-Latino_Hispanic_ffhq      (0) | Val  Loss: 1.3217 | Val  Acc: 0.4219
Average Valid Accuracy: 0.4803
 Test site-White_utk                 (5)| Epoch:43 | Test Acc: 0.3042
 Test site-East_Asian                (2)| Epoch:43 | Test Acc: 0.4746
 Test site-Indian_utk                (3)| Epoch:43 | Test Acc: 0.5125
 Test site-Black_utk                 (1)| Epoch:43 | Test Acc: 0.4235
 Test site-Southeast_Asian           (2)| Epoch:43 | Test Acc: 0.4003
 Test site-Asian_ffhq                (4)| Epoch:43 | Test Acc: 0.3658
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:43 | Test Acc: 0.3383
White_utk: 0.3042, East_Asian: 0.4746, Indian_utk: 0.5125, Black_utk: 0.4235, Southeast_Asian: 0.4003, Asian_ffhq: 0.3658, Latino_Hispanic_ffhq: 0.3383, 
Average Test Accuracy(group): 0.4028, Average Test Accuracy(individual): 0.4028,
domain CV=0.1702, cluster CV=nan, individual CV=0.1702, 
Average Test Accuracy: 0.4028
============ Train epoch 45 ============
cnt=[1, 4, 4, 2, 1, 1, 1, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
min_w=0.22124, quan_i=1.39, quan_c=1.40
minimize weight of clients:[1, 4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (2) | Train Loss: 1.4507 | Train Acc: 0.3906
 Site-White_utk                 (2) | Train Loss: 1.3560 | Train Acc: 0.4583
 Site-East_Asian                (1) | Train Loss: 1.3634 | Train Acc: 0.4688
 Site-East_Asian                (1) | Train Loss: 1.3620 | Train Acc: 0.4844
 Site-Indian_utk                (2) | Train Loss: 1.2527 | Train Acc: 0.5312
 Site-Indian_utk                (2) | Train Loss: 1.3535 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.3052 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.3061 | Train Acc: 0.5625
 Site-Southeast_Asian           (1) | Train Loss: 1.6757 | Train Acc: 0.4219
 Site-Southeast_Asian           (1) | Train Loss: 1.4199 | Train Acc: 0.4531
 Site-Asian_ffhq                (0) | Train Loss: 1.2756 | Train Acc: 0.5938
 Site-Asian_ffhq                (4) | Train Loss: 1.1454 | Train Acc: 0.6094
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.0263 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.3653 | Train Acc: 0.3802
Average Train Accuracy: 0.5086
 Site-White_utk                 (2) | Val  Loss: 1.2650 | Val  Acc: 0.4762
 Site-White_utk                 (2) | Val  Loss: 1.3368 | Val  Acc: 0.5078
 Site-East_Asian                (1) | Val  Loss: 1.4524 | Val  Acc: 0.4524
 Site-East_Asian                (1) | Val  Loss: 1.3130 | Val  Acc: 0.5312
 Site-Indian_utk                (2) | Val  Loss: 1.3044 | Val  Acc: 0.5238
 Site-Indian_utk                (2) | Val  Loss: 1.3515 | Val  Acc: 0.4844
 Site-Black_utk                 (3) | Val  Loss: 1.2636 | Val  Acc: 0.6190
 Site-Black_utk                 (3) | Val  Loss: 1.3344 | Val  Acc: 0.5469
 Site-Southeast_Asian           (1) | Val  Loss: 1.4780 | Val  Acc: 0.4286
 Site-Southeast_Asian           (1) | Val  Loss: 1.4361 | Val  Acc: 0.4531
 Site-Asian_ffhq                (0) | Val  Loss: 1.0098 | Val  Acc: 0.7381
 Site-Asian_ffhq                (4) | Val  Loss: 1.2562 | Val  Acc: 0.5078
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7847 | Val  Acc: 0.2857
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.3213 | Val  Acc: 0.4453
Average Valid Accuracy: 0.5000
 Best site-White_utk                (2)  | Epoch:45 | Val Acc: 0.4762
 Best site-White_utk                (2)  | Epoch:45 | Val Acc: 0.5078
 Best site-East_Asian               (1)  | Epoch:45 | Val Acc: 0.4524
 Best site-East_Asian               (1)  | Epoch:45 | Val Acc: 0.5312
 Best site-Indian_utk               (2)  | Epoch:45 | Val Acc: 0.5238
 Best site-Indian_utk               (2)  | Epoch:45 | Val Acc: 0.4844
 Best site-Black_utk                (3)  | Epoch:45 | Val Acc: 0.6190
 Best site-Black_utk                (3)  | Epoch:45 | Val Acc: 0.5469
 Best site-Southeast_Asian          (1)  | Epoch:45 | Val Acc: 0.4286
 Best site-Southeast_Asian          (1)  | Epoch:45 | Val Acc: 0.4531
 Best site-Asian_ffhq               (0)  | Epoch:45 | Val Acc: 0.7381
 Best site-Asian_ffhq               (4)  | Epoch:45 | Val Acc: 0.5078
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:45 | Val Acc: 0.2857
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:45 | Val Acc: 0.4453
 Test site-White_utk                 (2)| Epoch:45 | Test Acc: 0.3094
 Test site-East_Asian                (1)| Epoch:45 | Test Acc: 0.4786
 Test site-Indian_utk                (2)| Epoch:45 | Test Acc: 0.5021
 Test site-Black_utk                 (3)| Epoch:45 | Test Acc: 0.4439
 Test site-Southeast_Asian           (1)| Epoch:45 | Test Acc: 0.4194
 Test site-Asian_ffhq                (0)| Epoch:45 | Test Acc: 0.3382
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:45 | Test Acc: 0.3284
White_utk: 0.3094, East_Asian: 0.4786, Indian_utk: 0.5021, Black_utk: 0.4439, Southeast_Asian: 0.4194, Asian_ffhq: 0.3382, Latino_Hispanic_ffhq: 0.3284, 
Average Test Accuracy(group): 0.4028, Average Test Accuracy(individual): 0.4028,
domain CV=0.1780, cluster CV=nan, individual CV=0.1780, 
Average Test Accuracy: 0.4028
============ Train epoch 46 ============
cnt=[1, 2, 3, 2, 1, 2, 3, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
min_w=0.18048, quan_i=1.37, quan_c=1.40
minimize weight of clients:[4, 6, 7, 10, 11, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.3462 | Train Acc: 0.4531
 Site-White_utk                 (1) | Train Loss: 1.2758 | Train Acc: 0.5833
 Site-East_Asian                (6) | Train Loss: 1.3390 | Train Acc: 0.5156
 Site-East_Asian                (6) | Train Loss: 1.3544 | Train Acc: 0.5260
 Site-Indian_utk                (5) | Train Loss: 1.3522 | Train Acc: 0.5469
 Site-Indian_utk                (5) | Train Loss: 1.3701 | Train Acc: 0.5000
 Site-Black_utk                 (3) | Train Loss: 1.3881 | Train Acc: 0.4844
 Site-Black_utk                 (3) | Train Loss: 1.3716 | Train Acc: 0.5521
 Site-Southeast_Asian           (0) | Train Loss: 1.5597 | Train Acc: 0.4375
 Site-Southeast_Asian           (6) | Train Loss: 1.3741 | Train Acc: 0.4844
 Site-Asian_ffhq                (4) | Train Loss: 1.6419 | Train Acc: 0.4531
 Site-Asian_ffhq                (2) | Train Loss: 1.4221 | Train Acc: 0.5104
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3336 | Train Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.4520 | Train Acc: 0.4062
Average Train Accuracy: 0.4989
 Site-White_utk                 (1) | Val  Loss: 1.2724 | Val  Acc: 0.5238
 Site-White_utk                 (1) | Val  Loss: 1.2775 | Val  Acc: 0.5703
 Site-East_Asian                (6) | Val  Loss: 1.4286 | Val  Acc: 0.4524
 Site-East_Asian                (6) | Val  Loss: 1.3141 | Val  Acc: 0.5000
 Site-Indian_utk                (5) | Val  Loss: 1.3338 | Val  Acc: 0.5238
 Site-Indian_utk                (5) | Val  Loss: 1.3879 | Val  Acc: 0.5312
 Site-Black_utk                 (3) | Val  Loss: 1.2902 | Val  Acc: 0.5952
 Site-Black_utk                 (3) | Val  Loss: 1.3557 | Val  Acc: 0.5703
 Site-Southeast_Asian           (0) | Val  Loss: 1.4393 | Val  Acc: 0.4286
 Site-Southeast_Asian           (6) | Val  Loss: 1.3784 | Val  Acc: 0.5312
 Site-Asian_ffhq                (4) | Val  Loss: 1.4119 | Val  Acc: 0.6429
 Site-Asian_ffhq                (2) | Val  Loss: 1.4954 | Val  Acc: 0.4062
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.6933 | Val  Acc: 0.2857
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.4461 | Val  Acc: 0.3984
Average Valid Accuracy: 0.4972
 Test site-White_utk                 (1)| Epoch:45 | Test Acc: 0.3659
 Test site-East_Asian                (6)| Epoch:45 | Test Acc: 0.4846
 Test site-Indian_utk                (5)| Epoch:45 | Test Acc: 0.4938
 Test site-Black_utk                 (3)| Epoch:45 | Test Acc: 0.3878
 Test site-Southeast_Asian           (0)| Epoch:45 | Test Acc: 0.4298
 Test site-Asian_ffhq                (4)| Epoch:45 | Test Acc: 0.2702
 Test site-Latino_Hispanic_ffhq      (2)| Epoch:45 | Test Acc: 0.2886
White_utk: 0.3659, East_Asian: 0.4846, Indian_utk: 0.4938, Black_utk: 0.3878, Southeast_Asian: 0.4298, Asian_ffhq: 0.2702, Latino_Hispanic_ffhq: 0.2886, 
Average Test Accuracy(group): 0.3886, Average Test Accuracy(individual): 0.3886,
domain CV=0.2097, cluster CV=0.2097, individual CV=0.2097, 
Average Test Accuracy: 0.3886
============ Train epoch 47 ============
cnt=[1, 4, 3, 2, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
min_w=0.22666, quan_i=1.39, quan_c=1.39
minimize weight of clients:[0, 1, 2, 3, 4, 5, 6, 7, 9, 12, ]
 Site-White_utk                 (1) | Train Loss: 1.5110 | Train Acc: 0.3750
 Site-White_utk                 (1) | Train Loss: 1.4011 | Train Acc: 0.4740
 Site-East_Asian                (2) | Train Loss: 1.3232 | Train Acc: 0.4844
 Site-East_Asian                (2) | Train Loss: 1.3688 | Train Acc: 0.4323
 Site-Indian_utk                (1) | Train Loss: 1.2393 | Train Acc: 0.5781
 Site-Indian_utk                (1) | Train Loss: 1.3408 | Train Acc: 0.5104
 Site-Black_utk                 (4) | Train Loss: 1.3418 | Train Acc: 0.4844
 Site-Black_utk                 (4) | Train Loss: 1.3333 | Train Acc: 0.5625
 Site-Southeast_Asian           (6) | Train Loss: 1.5314 | Train Acc: 0.4062
 Site-Southeast_Asian           (2) | Train Loss: 1.4361 | Train Acc: 0.4583
 Site-Asian_ffhq                (0) | Train Loss: 1.1228 | Train Acc: 0.6094
 Site-Asian_ffhq                (3) | Train Loss: 0.9882 | Train Acc: 0.6719
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 0.8999 | Train Acc: 0.7500
 Site-Latino_Hispanic_ffhq      (3) | Train Loss: 1.2203 | Train Acc: 0.4323
Average Train Accuracy: 0.5164
 Site-White_utk                 (1) | Val  Loss: 1.3904 | Val  Acc: 0.5000
 Site-White_utk                 (1) | Val  Loss: 1.3590 | Val  Acc: 0.4688
 Site-East_Asian                (2) | Val  Loss: 1.4481 | Val  Acc: 0.4762
 Site-East_Asian                (2) | Val  Loss: 1.3526 | Val  Acc: 0.5000
 Site-Indian_utk                (1) | Val  Loss: 1.3094 | Val  Acc: 0.5476
 Site-Indian_utk                (1) | Val  Loss: 1.3813 | Val  Acc: 0.5234
 Site-Black_utk                 (4) | Val  Loss: 1.2646 | Val  Acc: 0.5952
 Site-Black_utk                 (4) | Val  Loss: 1.3600 | Val  Acc: 0.5312
 Site-Southeast_Asian           (6) | Val  Loss: 1.4743 | Val  Acc: 0.4048
 Site-Southeast_Asian           (2) | Val  Loss: 1.4637 | Val  Acc: 0.4922
 Site-Asian_ffhq                (0) | Val  Loss: 0.9091 | Val  Acc: 0.7381
 Site-Asian_ffhq                (3) | Val  Loss: 1.0687 | Val  Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.7238 | Val  Acc: 0.2381
 Site-Latino_Hispanic_ffhq      (3) | Val  Loss: 1.2597 | Val  Acc: 0.3984
Average Valid Accuracy: 0.4994
 Test site-White_utk                 (1)| Epoch:45 | Test Acc: 0.2991
 Test site-East_Asian                (2)| Epoch:45 | Test Acc: 0.4677
 Test site-Indian_utk                (1)| Epoch:45 | Test Acc: 0.5062
 Test site-Black_utk                 (4)| Epoch:45 | Test Acc: 0.4133
 Test site-Southeast_Asian           (6)| Epoch:45 | Test Acc: 0.4021
 Test site-Asian_ffhq                (0)| Epoch:45 | Test Acc: 0.4026
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:45 | Test Acc: 0.3781
White_utk: 0.2991, East_Asian: 0.4677, Indian_utk: 0.5062, Black_utk: 0.4133, Southeast_Asian: 0.4021, Asian_ffhq: 0.4026, Latino_Hispanic_ffhq: 0.3781, 
Average Test Accuracy(group): 0.4099, Average Test Accuracy(individual): 0.4099,
domain CV=0.1488, cluster CV=nan, individual CV=0.1488, 
Average Test Accuracy: 0.4099
 Saving the gmap checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_even-mix5_1.0_1_random_dis_cluster_7_cb/ccop_q=1...
============ Train epoch 48 ============
cnt=[4, 4, 1, 1, 2, 1, 1, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
min_w=0.21559, quan_i=1.37, quan_c=1.38
minimize weight of clients:[4, 5, 6, 7, 10, 11, 12, 13, ]
 Site-White_utk                 (1) | Train Loss: 1.4254 | Train Acc: 0.4219
 Site-White_utk                 (1) | Train Loss: 1.3277 | Train Acc: 0.5469
 Site-East_Asian                (0) | Train Loss: 1.3143 | Train Acc: 0.5000
 Site-East_Asian                (0) | Train Loss: 1.3474 | Train Acc: 0.4688
 Site-Indian_utk                (1) | Train Loss: 1.2738 | Train Acc: 0.5938
 Site-Indian_utk                (1) | Train Loss: 1.3189 | Train Acc: 0.5208
 Site-Black_utk                 (4) | Train Loss: 1.3364 | Train Acc: 0.5000
 Site-Black_utk                 (4) | Train Loss: 1.3818 | Train Acc: 0.5260
 Site-Southeast_Asian           (0) | Train Loss: 1.5163 | Train Acc: 0.4375
 Site-Southeast_Asian           (0) | Train Loss: 1.3830 | Train Acc: 0.4740
 Site-Asian_ffhq                (3) | Train Loss: 1.2738 | Train Acc: 0.5625
 Site-Asian_ffhq                (2) | Train Loss: 1.1537 | Train Acc: 0.5781
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.0033 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (5) | Train Loss: 1.3408 | Train Acc: 0.4427
Average Train Accuracy: 0.5242
 Site-White_utk                 (1) | Val  Loss: 1.2522 | Val  Acc: 0.5238
 Site-White_utk                 (1) | Val  Loss: 1.2695 | Val  Acc: 0.5625
 Site-East_Asian                (0) | Val  Loss: 1.4872 | Val  Acc: 0.4762
 Site-East_Asian                (0) | Val  Loss: 1.3393 | Val  Acc: 0.4922
 Site-Indian_utk                (1) | Val  Loss: 1.3661 | Val  Acc: 0.4048
 Site-Indian_utk                (1) | Val  Loss: 1.3769 | Val  Acc: 0.4922
 Site-Black_utk                 (4) | Val  Loss: 1.3391 | Val  Acc: 0.5952
 Site-Black_utk                 (4) | Val  Loss: 1.3689 | Val  Acc: 0.6094
 Site-Southeast_Asian           (0) | Val  Loss: 1.5086 | Val  Acc: 0.5000
 Site-Southeast_Asian           (0) | Val  Loss: 1.4261 | Val  Acc: 0.5078
 Site-Asian_ffhq                (3) | Val  Loss: 1.0885 | Val  Acc: 0.6190
 Site-Asian_ffhq                (2) | Val  Loss: 1.1982 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.7580 | Val  Acc: 0.3095
 Site-Latino_Hispanic_ffhq      (5) | Val  Loss: 1.3550 | Val  Acc: 0.4219
Average Valid Accuracy: 0.5033
 Best site-White_utk                (1)  | Epoch:48 | Val Acc: 0.5238
 Best site-White_utk                (1)  | Epoch:48 | Val Acc: 0.5625
 Best site-East_Asian               (0)  | Epoch:48 | Val Acc: 0.4762
 Best site-East_Asian               (0)  | Epoch:48 | Val Acc: 0.4922
 Best site-Indian_utk               (1)  | Epoch:48 | Val Acc: 0.4048
 Best site-Indian_utk               (1)  | Epoch:48 | Val Acc: 0.4922
 Best site-Black_utk                (4)  | Epoch:48 | Val Acc: 0.5952
 Best site-Black_utk                (4)  | Epoch:48 | Val Acc: 0.6094
 Best site-Southeast_Asian          (0)  | Epoch:48 | Val Acc: 0.5000
 Best site-Southeast_Asian          (0)  | Epoch:48 | Val Acc: 0.5078
 Best site-Asian_ffhq               (3)  | Epoch:48 | Val Acc: 0.6190
 Best site-Asian_ffhq               (2)  | Epoch:48 | Val Acc: 0.5312
 Best site-Latino_Hispanic_ffhq     (6)  | Epoch:48 | Val Acc: 0.3095
 Best site-Latino_Hispanic_ffhq     (5)  | Epoch:48 | Val Acc: 0.4219
 Test site-White_utk                 (1)| Epoch:48 | Test Acc: 0.3381
 Test site-East_Asian                (0)| Epoch:48 | Test Acc: 0.4816
 Test site-Indian_utk                (1)| Epoch:48 | Test Acc: 0.4979
 Test site-Black_utk                 (4)| Epoch:48 | Test Acc: 0.3878
 Test site-Southeast_Asian           (0)| Epoch:48 | Test Acc: 0.4194
 Test site-Asian_ffhq                (3)| Epoch:48 | Test Acc: 0.3309
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:48 | Test Acc: 0.3383
White_utk: 0.3381, East_Asian: 0.4816, Indian_utk: 0.4979, Black_utk: 0.3878, Southeast_Asian: 0.4194, Asian_ffhq: 0.3309, Latino_Hispanic_ffhq: 0.3383, 
Average Test Accuracy(group): 0.3991, Average Test Accuracy(individual): 0.3991,
domain CV=0.1618, cluster CV=nan, individual CV=0.1618, 
Average Test Accuracy: 0.3991
============ Train epoch 49 ============
cnt=[4, 2, 2, 1, 2, 2, 1, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
min_w=0.22763, quan_i=1.36, quan_c=1.38
minimize weight of clients:[1, 4, 5, 6, 10, 11, 12, 13, ]
 Site-White_utk                 (5) | Train Loss: 1.4359 | Train Acc: 0.3906
 Site-White_utk                 (5) | Train Loss: 1.3265 | Train Acc: 0.5208
 Site-East_Asian                (0) | Train Loss: 1.3441 | Train Acc: 0.4688
 Site-East_Asian                (0) | Train Loss: 1.3773 | Train Acc: 0.4688
 Site-Indian_utk                (4) | Train Loss: 1.2626 | Train Acc: 0.5469
 Site-Indian_utk                (4) | Train Loss: 1.3160 | Train Acc: 0.5052
 Site-Black_utk                 (1) | Train Loss: 1.3110 | Train Acc: 0.5312
 Site-Black_utk                 (1) | Train Loss: 1.3052 | Train Acc: 0.5885
 Site-Southeast_Asian           (0) | Train Loss: 1.5361 | Train Acc: 0.4531
 Site-Southeast_Asian           (0) | Train Loss: 1.4037 | Train Acc: 0.5156
 Site-Asian_ffhq                (3) | Train Loss: 1.3079 | Train Acc: 0.5781
 Site-Asian_ffhq                (2) | Train Loss: 1.1684 | Train Acc: 0.5990
 Site-Latino_Hispanic_ffhq      (6) | Train Loss: 1.0181 | Train Acc: 0.7656
 Site-Latino_Hispanic_ffhq      (2) | Train Loss: 1.3964 | Train Acc: 0.4062
Average Train Accuracy: 0.5242
 Site-White_utk                 (5) | Val  Loss: 1.3370 | Val  Acc: 0.4762
 Site-White_utk                 (5) | Val  Loss: 1.3047 | Val  Acc: 0.5078
 Site-East_Asian                (0) | Val  Loss: 1.4497 | Val  Acc: 0.4286
 Site-East_Asian                (0) | Val  Loss: 1.3307 | Val  Acc: 0.5078
 Site-Indian_utk                (4) | Val  Loss: 1.3014 | Val  Acc: 0.5000
 Site-Indian_utk                (4) | Val  Loss: 1.3325 | Val  Acc: 0.4922
 Site-Black_utk                 (1) | Val  Loss: 1.2034 | Val  Acc: 0.7381
 Site-Black_utk                 (1) | Val  Loss: 1.3001 | Val  Acc: 0.5781
 Site-Southeast_Asian           (0) | Val  Loss: 1.4371 | Val  Acc: 0.4762
 Site-Southeast_Asian           (0) | Val  Loss: 1.4212 | Val  Acc: 0.4844
 Site-Asian_ffhq                (3) | Val  Loss: 1.0412 | Val  Acc: 0.7381
 Site-Asian_ffhq                (2) | Val  Loss: 1.3149 | Val  Acc: 0.5312
 Site-Latino_Hispanic_ffhq      (6) | Val  Loss: 1.8878 | Val  Acc: 0.1429
 Site-Latino_Hispanic_ffhq      (2) | Val  Loss: 1.3618 | Val  Acc: 0.3984
Average Valid Accuracy: 0.5000
 Test site-White_utk                 (5)| Epoch:48 | Test Acc: 0.3299
 Test site-East_Asian                (0)| Epoch:48 | Test Acc: 0.4866
 Test site-Indian_utk                (4)| Epoch:48 | Test Acc: 0.5125
 Test site-Black_utk                 (1)| Epoch:48 | Test Acc: 0.4388
 Test site-Southeast_Asian           (0)| Epoch:48 | Test Acc: 0.4211
 Test site-Asian_ffhq                (3)| Epoch:48 | Test Acc: 0.3290
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:48 | Test Acc: 0.2985
White_utk: 0.3299, East_Asian: 0.4866, Indian_utk: 0.5125, Black_utk: 0.4388, Southeast_Asian: 0.4211, Asian_ffhq: 0.3290, Latino_Hispanic_ffhq: 0.2985, 
Average Test Accuracy(group): 0.4023, Average Test Accuracy(individual): 0.4023,
domain CV=0.1932, cluster CV=nan, individual CV=0.1932, 
Average Test Accuracy: 0.4023
 Test site-White_utk                 (5)| Epoch:48 | Test Acc: 0.3299
 Test site-East_Asian                (0)| Epoch:48 | Test Acc: 0.4866
 Test site-Indian_utk                (4)| Epoch:48 | Test Acc: 0.5125
 Test site-Black_utk                 (1)| Epoch:48 | Test Acc: 0.4388
 Test site-Southeast_Asian           (0)| Epoch:48 | Test Acc: 0.4211
 Test site-Asian_ffhq                (3)| Epoch:48 | Test Acc: 0.3290
 Test site-Latino_Hispanic_ffhq      (6)| Epoch:48 | Test Acc: 0.2985
White_utk: 0.3299, East_Asian: 0.4866, Indian_utk: 0.5125, Black_utk: 0.4388, Southeast_Asian: 0.4211, Asian_ffhq: 0.3290, Latino_Hispanic_ffhq: 0.2985, 
Average Test Accuracy(group): 0.4023, Average Test Accuracy(individual): 0.4023,
domain CV=0.1932, cluster CV=nan, individual CV=0.1932, 
===2023-06-15 18:44:19===
===2023-06-15 18:44:34===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 7
    quantile: 0.7
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[64,192,64,192,64,192,64,192,64,192,64,192,64,192,]
client_nums=[2,2,2,2,2,2,2,]
len_dataset=[856,856,856,856,856,856,856,]
domain number = 7
Loading snapshots...
 Test site-White_utk                 (1)| Epoch:47 | Test Acc: 0.2991
 Test site-East_Asian                (2)| Epoch:47 | Test Acc: 0.4677
 Test site-Indian_utk                (1)| Epoch:47 | Test Acc: 0.5062
 Test site-Black_utk                 (4)| Epoch:47 | Test Acc: 0.4133
 Test site-Southeast_Asian           (6)| Epoch:47 | Test Acc: 0.4021
 Test site-Asian_ffhq                (0)| Epoch:47 | Test Acc: 0.4026
 Test site-Latino_Hispanic_ffhq      (5)| Epoch:47 | Test Acc: 0.3781
White_utk: 0.2991, East_Asian: 0.4677, Indian_utk: 0.5062, Black_utk: 0.4133, Southeast_Asian: 0.4021, Asian_ffhq: 0.4026, Latino_Hispanic_ffhq: 0.3781, 
Average Test Accuracy(group): 0.4099, Average Test Accuracy(individual): 0.4099,
domain std=0.0610, cluster std=0.0196, individual std=0.0610, 
