===2023-06-10 23:50:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
multiply 100 for Ea!
use train loss for Ea
============ Train epoch 0 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9500, powerC: 0.0500
 Site-MNIST                    | Train Loss: 1.6413 | Train Acc: 0.6604
 Site-MNIST                    | Train Loss: 1.7049 | Train Acc: 0.5848
 Site-USPS                     | Train Loss: 1.5687 | Train Acc: 0.6927
 Site-USPS                     | Train Loss: 1.5887 | Train Acc: 0.6789
 Site-SynthDigits              | Train Loss: 2.0536 | Train Acc: 0.2776
 Site-SynthDigits              | Train Loss: 1.9886 | Train Acc: 0.3175
 Site-MNIST-M                  | Train Loss: 2.1634 | Train Acc: 0.2399
 Site-MNIST-M                  | Train Loss: 2.1658 | Train Acc: 0.2260
 Site-SVHN                     | Train Loss: 2.1627 | Train Acc: 0.2237
 Site-SVHN                     | Train Loss: 2.1410 | Train Acc: 0.2511
 Site-MNIST                     (2) | Val  Loss: 1.7355 | Val  Acc: 0.5543
 Site-MNIST                     (2) | Val  Loss: 1.6706 | Val  Acc: 0.6331
 Site-USPS                      (4) | Val  Loss: 1.6000 | Val  Acc: 0.6739
 Site-USPS                      (4) | Val  Loss: 1.6120 | Val  Acc: 0.6511
 Site-SynthDigits               (0) | Val  Loss: 2.0272 | Val  Acc: 0.2500
 Site-SynthDigits               (0) | Val  Loss: 2.0259 | Val  Acc: 0.2446
 Site-MNIST-M                   (3) | Val  Loss: 2.2306 | Val  Acc: 0.2391
 Site-MNIST-M                   (3) | Val  Loss: 2.1587 | Val  Acc: 0.2590
 Site-SVHN                      (1) | Val  Loss: 2.1324 | Val  Acc: 0.3152
 Site-SVHN                      (1) | Val  Loss: 2.1445 | Val  Acc: 0.2626
Average Valid Accuracy: 0.4083
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.5543
 Best site-MNIST                    (2)  | Epoch:0 | Val Acc: 0.6331
 Best site-USPS                     (4)  | Epoch:0 | Val Acc: 0.6739
 Best site-USPS                     (4)  | Epoch:0 | Val Acc: 0.6511
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2500
 Best site-SynthDigits              (0)  | Epoch:0 | Val Acc: 0.2446
 Best site-MNIST-M                  (3)  | Epoch:0 | Val Acc: 0.2391
 Best site-MNIST-M                  (3)  | Epoch:0 | Val Acc: 0.2590
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.3152
 Best site-SVHN                     (1)  | Epoch:0 | Val Acc: 0.2626
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 1 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.9050, powerC: 0.0950
 Site-MNIST                    | Train Loss: 1.2834 | Train Acc: 0.7547
 Site-MNIST                    | Train Loss: 1.3676 | Train Acc: 0.6924
 Site-USPS                     | Train Loss: 1.1339 | Train Acc: 0.7493
 Site-USPS                     | Train Loss: 1.1587 | Train Acc: 0.7327
 Site-SynthDigits              | Train Loss: 1.7693 | Train Acc: 0.3531
 Site-SynthDigits              | Train Loss: 1.6775 | Train Acc: 0.4161
 Site-MNIST-M                  | Train Loss: 1.8673 | Train Acc: 0.4070
 Site-MNIST-M                  | Train Loss: 1.9061 | Train Acc: 0.3587
 Site-SVHN                     | Train Loss: 1.9952 | Train Acc: 0.3073
 Site-SVHN                     | Train Loss: 1.9555 | Train Acc: 0.3274
 Site-MNIST                     (4) | Val  Loss: 1.3430 | Val  Acc: 0.7283
 Site-MNIST                     (4) | Val  Loss: 1.3318 | Val  Acc: 0.7446
 Site-USPS                      (0) | Val  Loss: 1.1724 | Val  Acc: 0.7065
 Site-USPS                      (0) | Val  Loss: 1.1957 | Val  Acc: 0.6835
 Site-SynthDigits               (3) | Val  Loss: 1.6648 | Val  Acc: 0.4457
 Site-SynthDigits               (3) | Val  Loss: 1.6783 | Val  Acc: 0.4029
 Site-MNIST-M                   (2) | Val  Loss: 1.9099 | Val  Acc: 0.3478
 Site-MNIST-M                   (2) | Val  Loss: 1.8435 | Val  Acc: 0.4209
 Site-SVHN                      (1) | Val  Loss: 1.9702 | Val  Acc: 0.3152
 Site-SVHN                      (1) | Val  Loss: 2.0050 | Val  Acc: 0.3201
Average Valid Accuracy: 0.5115
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7283
 Best site-MNIST                    (4)  | Epoch:1 | Val Acc: 0.7446
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.7065
 Best site-USPS                     (0)  | Epoch:1 | Val Acc: 0.6835
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.4457
 Best site-SynthDigits              (3)  | Epoch:1 | Val Acc: 0.4029
 Best site-MNIST-M                  (2)  | Epoch:1 | Val Acc: 0.3478
 Best site-MNIST-M                  (2)  | Epoch:1 | Val Acc: 0.4209
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3152
 Best site-SVHN                     (1)  | Epoch:1 | Val Acc: 0.3201
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 2 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8645, powerC: 0.1355
 Site-MNIST                    | Train Loss: 0.9533 | Train Acc: 0.8518
 Site-MNIST                    | Train Loss: 1.0319 | Train Acc: 0.7839
 Site-USPS                     | Train Loss: 0.8941 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 0.9125 | Train Acc: 0.7857
 Site-SynthDigits              | Train Loss: 1.4723 | Train Acc: 0.5283
 Site-SynthDigits              | Train Loss: 1.3486 | Train Acc: 0.5704
 Site-MNIST-M                  | Train Loss: 1.6756 | Train Acc: 0.4609
 Site-MNIST-M                  | Train Loss: 1.7195 | Train Acc: 0.4179
 Site-SVHN                     | Train Loss: 1.7933 | Train Acc: 0.3908
 Site-SVHN                     | Train Loss: 1.7564 | Train Acc: 0.4117
 Site-MNIST                     (3) | Val  Loss: 1.0333 | Val  Acc: 0.7826
 Site-MNIST                     (3) | Val  Loss: 1.0134 | Val  Acc: 0.8058
 Site-USPS                      (0) | Val  Loss: 0.9557 | Val  Acc: 0.7283
 Site-USPS                      (0) | Val  Loss: 0.9680 | Val  Acc: 0.7698
 Site-SynthDigits               (4) | Val  Loss: 1.3701 | Val  Acc: 0.5217
 Site-SynthDigits               (4) | Val  Loss: 1.3818 | Val  Acc: 0.5432
 Site-MNIST-M                   (2) | Val  Loss: 1.7434 | Val  Acc: 0.4239
 Site-MNIST-M                   (2) | Val  Loss: 1.6464 | Val  Acc: 0.4748
 Site-SVHN                      (1) | Val  Loss: 1.7844 | Val  Acc: 0.4022
 Site-SVHN                      (1) | Val  Loss: 1.8159 | Val  Acc: 0.4353
Average Valid Accuracy: 0.5887
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.7826
 Best site-MNIST                    (3)  | Epoch:2 | Val Acc: 0.8058
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7283
 Best site-USPS                     (0)  | Epoch:2 | Val Acc: 0.7698
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.5217
 Best site-SynthDigits              (4)  | Epoch:2 | Val Acc: 0.5432
 Best site-MNIST-M                  (2)  | Epoch:2 | Val Acc: 0.4239
 Best site-MNIST-M                  (2)  | Epoch:2 | Val Acc: 0.4748
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.4022
 Best site-SVHN                     (1)  | Epoch:2 | Val Acc: 0.4353
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 3 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.8280, powerC: 0.1720
 Site-MNIST                    | Train Loss: 0.8140 | Train Acc: 0.8571
 Site-MNIST                    | Train Loss: 0.8915 | Train Acc: 0.8036
 Site-USPS                     | Train Loss: 0.7930 | Train Acc: 0.8275
 Site-USPS                     | Train Loss: 0.8210 | Train Acc: 0.8045
 Site-SynthDigits              | Train Loss: 1.3135 | Train Acc: 0.5930
 Site-SynthDigits              | Train Loss: 1.1997 | Train Acc: 0.6547
 Site-MNIST-M                  | Train Loss: 1.4987 | Train Acc: 0.5499
 Site-MNIST-M                  | Train Loss: 1.5265 | Train Acc: 0.5202
 Site-SVHN                     | Train Loss: 1.6996 | Train Acc: 0.4394
 Site-SVHN                     | Train Loss: 1.6284 | Train Acc: 0.4717
 Site-MNIST                     (0) | Val  Loss: 0.8625 | Val  Acc: 0.7826
 Site-MNIST                     (0) | Val  Loss: 0.8677 | Val  Acc: 0.8165
 Site-USPS                      (3) | Val  Loss: 0.8679 | Val  Acc: 0.7174
 Site-USPS                      (3) | Val  Loss: 0.8651 | Val  Acc: 0.7734
 Site-SynthDigits               (1) | Val  Loss: 1.2032 | Val  Acc: 0.5978
 Site-SynthDigits               (1) | Val  Loss: 1.2288 | Val  Acc: 0.5863
 Site-MNIST-M                   (2) | Val  Loss: 1.5536 | Val  Acc: 0.5326
 Site-MNIST-M                   (2) | Val  Loss: 1.4630 | Val  Acc: 0.5827
 Site-SVHN                      (4) | Val  Loss: 1.6451 | Val  Acc: 0.4239
 Site-SVHN                      (4) | Val  Loss: 1.6913 | Val  Acc: 0.4676
Average Valid Accuracy: 0.6281
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.7826
 Best site-MNIST                    (0)  | Epoch:3 | Val Acc: 0.8165
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7174
 Best site-USPS                     (3)  | Epoch:3 | Val Acc: 0.7734
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5978
 Best site-SynthDigits              (1)  | Epoch:3 | Val Acc: 0.5863
 Best site-MNIST-M                  (2)  | Epoch:3 | Val Acc: 0.5326
 Best site-MNIST-M                  (2)  | Epoch:3 | Val Acc: 0.5827
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.4239
 Best site-SVHN                     (4)  | Epoch:3 | Val Acc: 0.4676
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 4 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7952, powerC: 0.2048
 Site-MNIST                    | Train Loss: 0.6804 | Train Acc: 0.8895
 Site-MNIST                    | Train Loss: 0.7577 | Train Acc: 0.8278
 Site-USPS                     | Train Loss: 0.6945 | Train Acc: 0.8302
 Site-USPS                     | Train Loss: 0.7172 | Train Acc: 0.8242
 Site-SynthDigits              | Train Loss: 1.1614 | Train Acc: 0.6119
 Site-SynthDigits              | Train Loss: 1.0574 | Train Acc: 0.6897
 Site-MNIST-M                  | Train Loss: 1.3788 | Train Acc: 0.5876
 Site-MNIST-M                  | Train Loss: 1.3964 | Train Acc: 0.5713
 Site-SVHN                     | Train Loss: 1.5599 | Train Acc: 0.4960
 Site-SVHN                     | Train Loss: 1.4805 | Train Acc: 0.5283
 Site-MNIST                     (3) | Val  Loss: 0.7268 | Val  Acc: 0.8152
 Site-MNIST                     (3) | Val  Loss: 0.7355 | Val  Acc: 0.8417
 Site-USPS                      (0) | Val  Loss: 0.7899 | Val  Acc: 0.7500
 Site-USPS                      (0) | Val  Loss: 0.7676 | Val  Acc: 0.7914
 Site-SynthDigits               (4) | Val  Loss: 1.0837 | Val  Acc: 0.6304
 Site-SynthDigits               (4) | Val  Loss: 1.0883 | Val  Acc: 0.6295
 Site-MNIST-M                   (1) | Val  Loss: 1.4291 | Val  Acc: 0.5326
 Site-MNIST-M                   (1) | Val  Loss: 1.3401 | Val  Acc: 0.5935
 Site-SVHN                      (2) | Val  Loss: 1.5154 | Val  Acc: 0.4457
 Site-SVHN                      (2) | Val  Loss: 1.5392 | Val  Acc: 0.4892
Average Valid Accuracy: 0.6519
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8152
 Best site-MNIST                    (3)  | Epoch:4 | Val Acc: 0.8417
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7500
 Best site-USPS                     (0)  | Epoch:4 | Val Acc: 0.7914
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.6304
 Best site-SynthDigits              (4)  | Epoch:4 | Val Acc: 0.6295
 Best site-MNIST-M                  (1)  | Epoch:4 | Val Acc: 0.5326
 Best site-MNIST-M                  (1)  | Epoch:4 | Val Acc: 0.5935
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.4457
 Best site-SVHN                     (2)  | Epoch:4 | Val Acc: 0.4892
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 5 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7657, powerC: 0.2343
 Site-MNIST                    | Train Loss: 0.5976 | Train Acc: 0.8949
 Site-MNIST                    | Train Loss: 0.6806 | Train Acc: 0.8457
 Site-USPS                     | Train Loss: 0.6421 | Train Acc: 0.8464
 Site-USPS                     | Train Loss: 0.6708 | Train Acc: 0.8296
 Site-SynthDigits              | Train Loss: 1.0182 | Train Acc: 0.6927
 Site-SynthDigits              | Train Loss: 0.9257 | Train Acc: 0.7354
 Site-MNIST-M                  | Train Loss: 1.2972 | Train Acc: 0.6173
 Site-MNIST-M                  | Train Loss: 1.3037 | Train Acc: 0.6072
 Site-SVHN                     | Train Loss: 1.4130 | Train Acc: 0.5256
 Site-SVHN                     | Train Loss: 1.3561 | Train Acc: 0.5525
 Site-MNIST                     (2) | Val  Loss: 0.6315 | Val  Acc: 0.8261
 Site-MNIST                     (2) | Val  Loss: 0.6573 | Val  Acc: 0.8597
 Site-USPS                      (3) | Val  Loss: 0.7499 | Val  Acc: 0.7500
 Site-USPS                      (3) | Val  Loss: 0.7219 | Val  Acc: 0.8022
 Site-SynthDigits               (1) | Val  Loss: 0.9513 | Val  Acc: 0.6630
 Site-SynthDigits               (1) | Val  Loss: 0.9683 | Val  Acc: 0.6763
 Site-MNIST-M                   (0) | Val  Loss: 1.3297 | Val  Acc: 0.5326
 Site-MNIST-M                   (0) | Val  Loss: 1.2484 | Val  Acc: 0.6295
 Site-SVHN                      (4) | Val  Loss: 1.4125 | Val  Acc: 0.5109
 Site-SVHN                      (4) | Val  Loss: 1.3962 | Val  Acc: 0.5324
Average Valid Accuracy: 0.6783
 Best site-MNIST                    (2)  | Epoch:5 | Val Acc: 0.8261
 Best site-MNIST                    (2)  | Epoch:5 | Val Acc: 0.8597
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.7500
 Best site-USPS                     (3)  | Epoch:5 | Val Acc: 0.8022
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6630
 Best site-SynthDigits              (1)  | Epoch:5 | Val Acc: 0.6763
 Best site-MNIST-M                  (0)  | Epoch:5 | Val Acc: 0.5326
 Best site-MNIST-M                  (0)  | Epoch:5 | Val Acc: 0.6295
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.5109
 Best site-SVHN                     (4)  | Epoch:5 | Val Acc: 0.5324
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 6 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7391, powerC: 0.2609
 Site-MNIST                    | Train Loss: 0.5230 | Train Acc: 0.9003
 Site-MNIST                    | Train Loss: 0.5973 | Train Acc: 0.8457
 Site-USPS                     | Train Loss: 0.5847 | Train Acc: 0.8383
 Site-USPS                     | Train Loss: 0.6139 | Train Acc: 0.8430
 Site-SynthDigits              | Train Loss: 0.9769 | Train Acc: 0.6954
 Site-SynthDigits              | Train Loss: 0.8850 | Train Acc: 0.7399
 Site-MNIST-M                  | Train Loss: 1.1854 | Train Acc: 0.6631
 Site-MNIST-M                  | Train Loss: 1.2035 | Train Acc: 0.6529
 Site-SVHN                     | Train Loss: 1.3968 | Train Acc: 0.5256
 Site-SVHN                     | Train Loss: 1.3342 | Train Acc: 0.5704
 Site-MNIST                     (2) | Val  Loss: 0.5352 | Val  Acc: 0.8261
 Site-MNIST                     (2) | Val  Loss: 0.5756 | Val  Acc: 0.8633
 Site-USPS                      (0) | Val  Loss: 0.7023 | Val  Acc: 0.7391
 Site-USPS                      (0) | Val  Loss: 0.6689 | Val  Acc: 0.8129
 Site-SynthDigits               (4) | Val  Loss: 0.9118 | Val  Acc: 0.6739
 Site-SynthDigits               (4) | Val  Loss: 0.9087 | Val  Acc: 0.6835
 Site-MNIST-M                   (1) | Val  Loss: 1.2124 | Val  Acc: 0.6087
 Site-MNIST-M                   (1) | Val  Loss: 1.1472 | Val  Acc: 0.6655
 Site-SVHN                      (3) | Val  Loss: 1.3770 | Val  Acc: 0.5217
 Site-SVHN                      (3) | Val  Loss: 1.3713 | Val  Acc: 0.5432
Average Valid Accuracy: 0.6938
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8261
 Best site-MNIST                    (2)  | Epoch:6 | Val Acc: 0.8633
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.7391
 Best site-USPS                     (0)  | Epoch:6 | Val Acc: 0.8129
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6739
 Best site-SynthDigits              (4)  | Epoch:6 | Val Acc: 0.6835
 Best site-MNIST-M                  (1)  | Epoch:6 | Val Acc: 0.6087
 Best site-MNIST-M                  (1)  | Epoch:6 | Val Acc: 0.6655
 Best site-SVHN                     (3)  | Epoch:6 | Val Acc: 0.5217
 Best site-SVHN                     (3)  | Epoch:6 | Val Acc: 0.5432
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 7 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.7152, powerC: 0.2848
 Site-MNIST                    | Train Loss: 0.5055 | Train Acc: 0.9057
 Site-MNIST                    | Train Loss: 0.5790 | Train Acc: 0.8583
 Site-USPS                     | Train Loss: 0.5675 | Train Acc: 0.8518
 Site-USPS                     | Train Loss: 0.5969 | Train Acc: 0.8475
 Site-SynthDigits              | Train Loss: 0.8792 | Train Acc: 0.7385
 Site-SynthDigits              | Train Loss: 0.7900 | Train Acc: 0.7614
 Site-MNIST-M                  | Train Loss: 1.1495 | Train Acc: 0.6334
 Site-MNIST-M                  | Train Loss: 1.1446 | Train Acc: 0.6493
 Site-SVHN                     | Train Loss: 1.2764 | Train Acc: 0.5526
 Site-SVHN                     | Train Loss: 1.2078 | Train Acc: 0.6072
 Site-MNIST                     (3) | Val  Loss: 0.5163 | Val  Acc: 0.8478
 Site-MNIST                     (3) | Val  Loss: 0.5594 | Val  Acc: 0.8705
 Site-USPS                      (1) | Val  Loss: 0.6954 | Val  Acc: 0.7609
 Site-USPS                      (1) | Val  Loss: 0.6485 | Val  Acc: 0.8022
 Site-SynthDigits               (4) | Val  Loss: 0.8165 | Val  Acc: 0.6957
 Site-SynthDigits               (4) | Val  Loss: 0.8259 | Val  Acc: 0.7086
 Site-MNIST-M                   (0) | Val  Loss: 1.1750 | Val  Acc: 0.6087
 Site-MNIST-M                   (0) | Val  Loss: 1.1060 | Val  Acc: 0.6583
 Site-SVHN                      (2) | Val  Loss: 1.2495 | Val  Acc: 0.5978
 Site-SVHN                      (2) | Val  Loss: 1.2340 | Val  Acc: 0.5899
Average Valid Accuracy: 0.7140
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8478
 Best site-MNIST                    (3)  | Epoch:7 | Val Acc: 0.8705
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.7609
 Best site-USPS                     (1)  | Epoch:7 | Val Acc: 0.8022
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.6957
 Best site-SynthDigits              (4)  | Epoch:7 | Val Acc: 0.7086
 Best site-MNIST-M                  (0)  | Epoch:7 | Val Acc: 0.6087
 Best site-MNIST-M                  (0)  | Epoch:7 | Val Acc: 0.6583
 Best site-SVHN                     (2)  | Epoch:7 | Val Acc: 0.5978
 Best site-SVHN                     (2)  | Epoch:7 | Val Acc: 0.5899
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 8 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6937, powerC: 0.3063
 Site-MNIST                    | Train Loss: 0.4574 | Train Acc: 0.9003
 Site-MNIST                    | Train Loss: 0.5369 | Train Acc: 0.8601
 Site-USPS                     | Train Loss: 0.5227 | Train Acc: 0.8437
 Site-USPS                     | Train Loss: 0.5356 | Train Acc: 0.8538
 Site-SynthDigits              | Train Loss: 0.8355 | Train Acc: 0.7493
 Site-SynthDigits              | Train Loss: 0.7607 | Train Acc: 0.7659
 Site-MNIST-M                  | Train Loss: 1.0957 | Train Acc: 0.6523
 Site-MNIST-M                  | Train Loss: 1.0793 | Train Acc: 0.6735
 Site-SVHN                     | Train Loss: 1.2348 | Train Acc: 0.5822
 Site-SVHN                     | Train Loss: 1.1482 | Train Acc: 0.6206
 Site-MNIST                     (3) | Val  Loss: 0.4628 | Val  Acc: 0.8587
 Site-MNIST                     (3) | Val  Loss: 0.5181 | Val  Acc: 0.8705
 Site-USPS                      (0) | Val  Loss: 0.6539 | Val  Acc: 0.7717
 Site-USPS                      (0) | Val  Loss: 0.6051 | Val  Acc: 0.8094
 Site-SynthDigits               (4) | Val  Loss: 0.7903 | Val  Acc: 0.7065
 Site-SynthDigits               (4) | Val  Loss: 0.7878 | Val  Acc: 0.7122
 Site-MNIST-M                   (1) | Val  Loss: 1.1170 | Val  Acc: 0.6196
 Site-MNIST-M                   (1) | Val  Loss: 1.0406 | Val  Acc: 0.6835
 Site-SVHN                      (2) | Val  Loss: 1.2089 | Val  Acc: 0.6087
 Site-SVHN                      (2) | Val  Loss: 1.1927 | Val  Acc: 0.6187
Average Valid Accuracy: 0.7259
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8587
 Best site-MNIST                    (3)  | Epoch:8 | Val Acc: 0.8705
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.7717
 Best site-USPS                     (0)  | Epoch:8 | Val Acc: 0.8094
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7065
 Best site-SynthDigits              (4)  | Epoch:8 | Val Acc: 0.7122
 Best site-MNIST-M                  (1)  | Epoch:8 | Val Acc: 0.6196
 Best site-MNIST-M                  (1)  | Epoch:8 | Val Acc: 0.6835
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.6087
 Best site-SVHN                     (2)  | Epoch:8 | Val Acc: 0.6187
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 9 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6743, powerC: 0.3257
 Site-MNIST                    | Train Loss: 0.4059 | Train Acc: 0.9137
 Site-MNIST                    | Train Loss: 0.4854 | Train Acc: 0.8717
 Site-USPS                     | Train Loss: 0.4788 | Train Acc: 0.8518
 Site-USPS                     | Train Loss: 0.5152 | Train Acc: 0.8646
 Site-SynthDigits              | Train Loss: 0.7907 | Train Acc: 0.7709
 Site-SynthDigits              | Train Loss: 0.7036 | Train Acc: 0.7767
 Site-MNIST-M                  | Train Loss: 1.0336 | Train Acc: 0.6819
 Site-MNIST-M                  | Train Loss: 1.0137 | Train Acc: 0.7112
 Site-SVHN                     | Train Loss: 1.2268 | Train Acc: 0.5768
 Site-SVHN                     | Train Loss: 1.1482 | Train Acc: 0.6161
 Site-MNIST                     (1) | Val  Loss: 0.4041 | Val  Acc: 0.8478
 Site-MNIST                     (1) | Val  Loss: 0.4696 | Val  Acc: 0.8813
 Site-USPS                      (2) | Val  Loss: 0.6261 | Val  Acc: 0.8043
 Site-USPS                      (2) | Val  Loss: 0.5730 | Val  Acc: 0.8345
 Site-SynthDigits               (3) | Val  Loss: 0.7380 | Val  Acc: 0.7283
 Site-SynthDigits               (3) | Val  Loss: 0.7426 | Val  Acc: 0.7230
 Site-MNIST-M                   (4) | Val  Loss: 1.0426 | Val  Acc: 0.6196
 Site-MNIST-M                   (4) | Val  Loss: 0.9770 | Val  Acc: 0.7086
 Site-SVHN                      (0) | Val  Loss: 1.2147 | Val  Acc: 0.5870
 Site-SVHN                      (0) | Val  Loss: 1.1921 | Val  Acc: 0.6043
Average Valid Accuracy: 0.7339
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8478
 Best site-MNIST                    (1)  | Epoch:9 | Val Acc: 0.8813
 Best site-USPS                     (2)  | Epoch:9 | Val Acc: 0.8043
 Best site-USPS                     (2)  | Epoch:9 | Val Acc: 0.8345
 Best site-SynthDigits              (3)  | Epoch:9 | Val Acc: 0.7283
 Best site-SynthDigits              (3)  | Epoch:9 | Val Acc: 0.7230
 Best site-MNIST-M                  (4)  | Epoch:9 | Val Acc: 0.6196
 Best site-MNIST-M                  (4)  | Epoch:9 | Val Acc: 0.7086
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.5870
 Best site-SVHN                     (0)  | Epoch:9 | Val Acc: 0.6043
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
 Test site-MNIST                     (1)| Epoch:9 | Test Acc: 0.8881
 Test site-USPS                      (2)| Epoch:9 | Test Acc: 0.8882
 Test site-SynthDigits               (3)| Epoch:9 | Test Acc: 0.7712
 Test site-MNIST-M                   (4)| Epoch:9 | Test Acc: 0.6583
 Test site-MNIST-M                   (4)| Epoch:9 | Test Acc: 0.6583
 Test site-SVHN                      (0)| Epoch:9 | Test Acc: 0.5884
MNIST: 0.7349, USPS: 0.8882, SynthDigits: 0.7712, SVHN: 0.5884, 
Average Test Accuracy(group): 0.7457, Average Test Accuracy(individual): 0.7588,
domain CV=0.1435, cluster CV=0.1590, individual CV=0.1590, 
============ Train epoch 10 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6569, powerC: 0.3431
 Site-MNIST                    | Train Loss: 0.3915 | Train Acc: 0.9137
 Site-MNIST                    | Train Loss: 0.4755 | Train Acc: 0.8744
 Site-USPS                     | Train Loss: 0.4716 | Train Acc: 0.8625
 Site-USPS                     | Train Loss: 0.4994 | Train Acc: 0.8610
 Site-SynthDigits              | Train Loss: 0.7534 | Train Acc: 0.7817
 Site-SynthDigits              | Train Loss: 0.6732 | Train Acc: 0.8009
 Site-MNIST-M                  | Train Loss: 0.9942 | Train Acc: 0.6900
 Site-MNIST-M                  | Train Loss: 0.9677 | Train Acc: 0.7283
 Site-SVHN                     | Train Loss: 1.2000 | Train Acc: 0.5741
 Site-SVHN                     | Train Loss: 1.1240 | Train Acc: 0.6404
 Site-MNIST                     (3) | Val  Loss: 0.3846 | Val  Acc: 0.8478
 Site-MNIST                     (3) | Val  Loss: 0.4562 | Val  Acc: 0.8921
 Site-USPS                      (0) | Val  Loss: 0.6114 | Val  Acc: 0.7826
 Site-USPS                      (0) | Val  Loss: 0.5600 | Val  Acc: 0.8309
 Site-SynthDigits               (4) | Val  Loss: 0.6911 | Val  Acc: 0.7717
 Site-SynthDigits               (4) | Val  Loss: 0.7080 | Val  Acc: 0.7518
 Site-MNIST-M                   (1) | Val  Loss: 1.0084 | Val  Acc: 0.6413
 Site-MNIST-M                   (1) | Val  Loss: 0.9350 | Val  Acc: 0.7302
 Site-SVHN                      (2) | Val  Loss: 1.1649 | Val  Acc: 0.6087
 Site-SVHN                      (2) | Val  Loss: 1.1584 | Val  Acc: 0.6475
Average Valid Accuracy: 0.7505
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8478
 Best site-MNIST                    (3)  | Epoch:10 | Val Acc: 0.8921
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.7826
 Best site-USPS                     (0)  | Epoch:10 | Val Acc: 0.8309
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.7717
 Best site-SynthDigits              (4)  | Epoch:10 | Val Acc: 0.7518
 Best site-MNIST-M                  (1)  | Epoch:10 | Val Acc: 0.6413
 Best site-MNIST-M                  (1)  | Epoch:10 | Val Acc: 0.7302
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.6087
 Best site-SVHN                     (2)  | Epoch:10 | Val Acc: 0.6475
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 11 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6412, powerC: 0.3588
 Site-MNIST                    | Train Loss: 0.3748 | Train Acc: 0.9137
 Site-MNIST                    | Train Loss: 0.4528 | Train Acc: 0.8762
 Site-USPS                     | Train Loss: 0.4615 | Train Acc: 0.8491
 Site-USPS                     | Train Loss: 0.4920 | Train Acc: 0.8628
 Site-SynthDigits              | Train Loss: 0.7096 | Train Acc: 0.8032
 Site-SynthDigits              | Train Loss: 0.6236 | Train Acc: 0.8161
 Site-MNIST-M                  | Train Loss: 0.9685 | Train Acc: 0.6981
 Site-MNIST-M                  | Train Loss: 0.9420 | Train Acc: 0.7345
 Site-SVHN                     | Train Loss: 1.1424 | Train Acc: 0.6038
 Site-SVHN                     | Train Loss: 1.0656 | Train Acc: 0.6511
 Site-MNIST                     (1) | Val  Loss: 0.3683 | Val  Acc: 0.8696
 Site-MNIST                     (1) | Val  Loss: 0.4441 | Val  Acc: 0.8921
 Site-USPS                      (3) | Val  Loss: 0.5993 | Val  Acc: 0.7935
 Site-USPS                      (3) | Val  Loss: 0.5533 | Val  Acc: 0.8345
 Site-SynthDigits               (4) | Val  Loss: 0.6421 | Val  Acc: 0.7826
 Site-SynthDigits               (4) | Val  Loss: 0.6631 | Val  Acc: 0.7734
 Site-MNIST-M                   (2) | Val  Loss: 0.9839 | Val  Acc: 0.6413
 Site-MNIST-M                   (2) | Val  Loss: 0.9100 | Val  Acc: 0.7194
 Site-SVHN                      (0) | Val  Loss: 1.1137 | Val  Acc: 0.6304
 Site-SVHN                      (0) | Val  Loss: 1.0948 | Val  Acc: 0.6547
Average Valid Accuracy: 0.7591
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8696
 Best site-MNIST                    (1)  | Epoch:11 | Val Acc: 0.8921
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.7935
 Best site-USPS                     (3)  | Epoch:11 | Val Acc: 0.8345
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7826
 Best site-SynthDigits              (4)  | Epoch:11 | Val Acc: 0.7734
 Best site-MNIST-M                  (2)  | Epoch:11 | Val Acc: 0.6413
 Best site-MNIST-M                  (2)  | Epoch:11 | Val Acc: 0.7194
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6304
 Best site-SVHN                     (0)  | Epoch:11 | Val Acc: 0.6547
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 12 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6271, powerC: 0.3729
 Site-MNIST                    | Train Loss: 0.3383 | Train Acc: 0.9299
 Site-MNIST                    | Train Loss: 0.4062 | Train Acc: 0.8942
 Site-USPS                     | Train Loss: 0.4295 | Train Acc: 0.8733
 Site-USPS                     | Train Loss: 0.4414 | Train Acc: 0.8709
 Site-SynthDigits              | Train Loss: 0.6930 | Train Acc: 0.8005
 Site-SynthDigits              | Train Loss: 0.6179 | Train Acc: 0.8224
 Site-MNIST-M                  | Train Loss: 0.9179 | Train Acc: 0.7224
 Site-MNIST-M                  | Train Loss: 0.8855 | Train Acc: 0.7561
 Site-SVHN                     | Train Loss: 1.1530 | Train Acc: 0.6011
 Site-SVHN                     | Train Loss: 1.0619 | Train Acc: 0.6404
 Site-MNIST                     (2) | Val  Loss: 0.3182 | Val  Acc: 0.9130
 Site-MNIST                     (2) | Val  Loss: 0.4013 | Val  Acc: 0.9245
 Site-USPS                      (1) | Val  Loss: 0.5645 | Val  Acc: 0.8043
 Site-USPS                      (1) | Val  Loss: 0.5053 | Val  Acc: 0.8417
 Site-SynthDigits               (4) | Val  Loss: 0.6413 | Val  Acc: 0.7935
 Site-SynthDigits               (4) | Val  Loss: 0.6439 | Val  Acc: 0.7698
 Site-MNIST-M                   (0) | Val  Loss: 0.9217 | Val  Acc: 0.6630
 Site-MNIST-M                   (0) | Val  Loss: 0.8583 | Val  Acc: 0.7554
 Site-SVHN                      (3) | Val  Loss: 1.1052 | Val  Acc: 0.6087
 Site-SVHN                      (3) | Val  Loss: 1.1073 | Val  Acc: 0.6475
Average Valid Accuracy: 0.7721
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.9130
 Best site-MNIST                    (2)  | Epoch:12 | Val Acc: 0.9245
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8043
 Best site-USPS                     (1)  | Epoch:12 | Val Acc: 0.8417
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7935
 Best site-SynthDigits              (4)  | Epoch:12 | Val Acc: 0.7698
 Best site-MNIST-M                  (0)  | Epoch:12 | Val Acc: 0.6630
 Best site-MNIST-M                  (0)  | Epoch:12 | Val Acc: 0.7554
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.6087
 Best site-SVHN                     (3)  | Epoch:12 | Val Acc: 0.6475
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 13 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6144, powerC: 0.3856
 Site-MNIST                    | Train Loss: 0.3375 | Train Acc: 0.9164
 Site-MNIST                    | Train Loss: 0.4157 | Train Acc: 0.8852
 Site-USPS                     | Train Loss: 0.4279 | Train Acc: 0.8598
 Site-USPS                     | Train Loss: 0.4481 | Train Acc: 0.8691
 Site-SynthDigits              | Train Loss: 0.6295 | Train Acc: 0.8194
 Site-SynthDigits              | Train Loss: 0.5694 | Train Acc: 0.8368
 Site-MNIST-M                  | Train Loss: 0.8899 | Train Acc: 0.7170
 Site-MNIST-M                  | Train Loss: 0.8555 | Train Acc: 0.7650
 Site-SVHN                     | Train Loss: 1.1034 | Train Acc: 0.6253
 Site-SVHN                     | Train Loss: 1.0207 | Train Acc: 0.6619
 Site-MNIST                     (3) | Val  Loss: 0.3134 | Val  Acc: 0.9130
 Site-MNIST                     (3) | Val  Loss: 0.4053 | Val  Acc: 0.9137
 Site-USPS                      (1) | Val  Loss: 0.5605 | Val  Acc: 0.7935
 Site-USPS                      (1) | Val  Loss: 0.5074 | Val  Acc: 0.8345
 Site-SynthDigits               (4) | Val  Loss: 0.5807 | Val  Acc: 0.8043
 Site-SynthDigits               (4) | Val  Loss: 0.5955 | Val  Acc: 0.7950
 Site-MNIST-M                   (0) | Val  Loss: 0.8983 | Val  Acc: 0.6630
 Site-MNIST-M                   (0) | Val  Loss: 0.8334 | Val  Acc: 0.7518
 Site-SVHN                      (2) | Val  Loss: 1.0613 | Val  Acc: 0.6413
 Site-SVHN                      (2) | Val  Loss: 1.0464 | Val  Acc: 0.6691
Average Valid Accuracy: 0.7779
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9130
 Best site-MNIST                    (3)  | Epoch:13 | Val Acc: 0.9137
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.7935
 Best site-USPS                     (1)  | Epoch:13 | Val Acc: 0.8345
 Best site-SynthDigits              (4)  | Epoch:13 | Val Acc: 0.8043
 Best site-SynthDigits              (4)  | Epoch:13 | Val Acc: 0.7950
 Best site-MNIST-M                  (0)  | Epoch:13 | Val Acc: 0.6630
 Best site-MNIST-M                  (0)  | Epoch:13 | Val Acc: 0.7518
 Best site-SVHN                     (2)  | Epoch:13 | Val Acc: 0.6413
 Best site-SVHN                     (2)  | Epoch:13 | Val Acc: 0.6691
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 14 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.6029, powerC: 0.3971
 Site-MNIST                    | Train Loss: 0.3132 | Train Acc: 0.9299
 Site-MNIST                    | Train Loss: 0.3970 | Train Acc: 0.8951
 Site-USPS                     | Train Loss: 0.4158 | Train Acc: 0.8652
 Site-USPS                     | Train Loss: 0.4328 | Train Acc: 0.8700
 Site-SynthDigits              | Train Loss: 0.6392 | Train Acc: 0.8059
 Site-SynthDigits              | Train Loss: 0.5628 | Train Acc: 0.8386
 Site-MNIST-M                  | Train Loss: 0.8628 | Train Acc: 0.7332
 Site-MNIST-M                  | Train Loss: 0.8202 | Train Acc: 0.7731
 Site-SVHN                     | Train Loss: 1.0847 | Train Acc: 0.6119
 Site-SVHN                     | Train Loss: 0.9760 | Train Acc: 0.6735
 Site-MNIST                     (1) | Val  Loss: 0.2974 | Val  Acc: 0.9130
 Site-MNIST                     (1) | Val  Loss: 0.3861 | Val  Acc: 0.9209
 Site-USPS                      (3) | Val  Loss: 0.5566 | Val  Acc: 0.7935
 Site-USPS                      (3) | Val  Loss: 0.5015 | Val  Acc: 0.8381
 Site-SynthDigits               (4) | Val  Loss: 0.5864 | Val  Acc: 0.8152
 Site-SynthDigits               (4) | Val  Loss: 0.6002 | Val  Acc: 0.7950
 Site-MNIST-M                   (2) | Val  Loss: 0.8645 | Val  Acc: 0.6957
 Site-MNIST-M                   (2) | Val  Loss: 0.7960 | Val  Acc: 0.7626
 Site-SVHN                      (0) | Val  Loss: 1.0292 | Val  Acc: 0.6630
 Site-SVHN                      (0) | Val  Loss: 1.0186 | Val  Acc: 0.6835
Average Valid Accuracy: 0.7880
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.9130
 Best site-MNIST                    (1)  | Epoch:14 | Val Acc: 0.9209
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.7935
 Best site-USPS                     (3)  | Epoch:14 | Val Acc: 0.8381
 Best site-SynthDigits              (4)  | Epoch:14 | Val Acc: 0.8152
 Best site-SynthDigits              (4)  | Epoch:14 | Val Acc: 0.7950
 Best site-MNIST-M                  (2)  | Epoch:14 | Val Acc: 0.6957
 Best site-MNIST-M                  (2)  | Epoch:14 | Val Acc: 0.7626
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6630
 Best site-SVHN                     (0)  | Epoch:14 | Val Acc: 0.6835
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 15 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5927, powerC: 0.4073
 Site-MNIST                    | Train Loss: 0.3067 | Train Acc: 0.9326
 Site-MNIST                    | Train Loss: 0.3852 | Train Acc: 0.8996
 Site-USPS                     | Train Loss: 0.4006 | Train Acc: 0.8733
 Site-USPS                     | Train Loss: 0.4161 | Train Acc: 0.8780
 Site-SynthDigits              | Train Loss: 0.6030 | Train Acc: 0.8302
 Site-SynthDigits              | Train Loss: 0.5313 | Train Acc: 0.8448
 Site-MNIST-M                  | Train Loss: 0.8329 | Train Acc: 0.7358
 Site-MNIST-M                  | Train Loss: 0.7982 | Train Acc: 0.7758
 Site-SVHN                     | Train Loss: 1.0436 | Train Acc: 0.6361
 Site-SVHN                     | Train Loss: 0.9450 | Train Acc: 0.6861
 Site-MNIST                     (1) | Val  Loss: 0.2829 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3753 | Val  Acc: 0.9209
 Site-USPS                      (4) | Val  Loss: 0.5296 | Val  Acc: 0.8043
 Site-USPS                      (4) | Val  Loss: 0.4743 | Val  Acc: 0.8525
 Site-SynthDigits               (0) | Val  Loss: 0.5571 | Val  Acc: 0.8043
 Site-SynthDigits               (0) | Val  Loss: 0.5617 | Val  Acc: 0.8058
 Site-MNIST-M                   (2) | Val  Loss: 0.8404 | Val  Acc: 0.6848
 Site-MNIST-M                   (2) | Val  Loss: 0.7756 | Val  Acc: 0.7626
 Site-SVHN                      (3) | Val  Loss: 0.9936 | Val  Acc: 0.6413
 Site-SVHN                      (3) | Val  Loss: 0.9849 | Val  Acc: 0.6835
Average Valid Accuracy: 0.7895
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:15 | Val Acc: 0.9209
 Best site-USPS                     (4)  | Epoch:15 | Val Acc: 0.8043
 Best site-USPS                     (4)  | Epoch:15 | Val Acc: 0.8525
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8043
 Best site-SynthDigits              (0)  | Epoch:15 | Val Acc: 0.8058
 Best site-MNIST-M                  (2)  | Epoch:15 | Val Acc: 0.6848
 Best site-MNIST-M                  (2)  | Epoch:15 | Val Acc: 0.7626
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6413
 Best site-SVHN                     (3)  | Epoch:15 | Val Acc: 0.6835
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 16 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5834, powerC: 0.4166
 Site-MNIST                    | Train Loss: 0.2959 | Train Acc: 0.9191
 Site-MNIST                    | Train Loss: 0.3671 | Train Acc: 0.8996
 Site-USPS                     | Train Loss: 0.3888 | Train Acc: 0.8841
 Site-USPS                     | Train Loss: 0.3974 | Train Acc: 0.8843
 Site-SynthDigits              | Train Loss: 0.5869 | Train Acc: 0.8248
 Site-SynthDigits              | Train Loss: 0.5214 | Train Acc: 0.8484
 Site-MNIST-M                  | Train Loss: 0.8073 | Train Acc: 0.7547
 Site-MNIST-M                  | Train Loss: 0.7691 | Train Acc: 0.7803
 Site-SVHN                     | Train Loss: 1.0305 | Train Acc: 0.6388
 Site-SVHN                     | Train Loss: 0.9166 | Train Acc: 0.6969
 Site-MNIST                     (2) | Val  Loss: 0.2705 | Val  Acc: 0.9348
 Site-MNIST                     (2) | Val  Loss: 0.3636 | Val  Acc: 0.9245
 Site-USPS                      (3) | Val  Loss: 0.5146 | Val  Acc: 0.8152
 Site-USPS                      (3) | Val  Loss: 0.4526 | Val  Acc: 0.8561
 Site-SynthDigits               (0) | Val  Loss: 0.5549 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.5517 | Val  Acc: 0.8129
 Site-MNIST-M                   (1) | Val  Loss: 0.8099 | Val  Acc: 0.7391
 Site-MNIST-M                   (1) | Val  Loss: 0.7470 | Val  Acc: 0.7698
 Site-SVHN                      (4) | Val  Loss: 0.9609 | Val  Acc: 0.6957
 Site-SVHN                      (4) | Val  Loss: 0.9608 | Val  Acc: 0.7014
Average Valid Accuracy: 0.8076
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9348
 Best site-MNIST                    (2)  | Epoch:16 | Val Acc: 0.9245
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8152
 Best site-USPS                     (3)  | Epoch:16 | Val Acc: 0.8561
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8261
 Best site-SynthDigits              (0)  | Epoch:16 | Val Acc: 0.8129
 Best site-MNIST-M                  (1)  | Epoch:16 | Val Acc: 0.7391
 Best site-MNIST-M                  (1)  | Epoch:16 | Val Acc: 0.7698
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.6957
 Best site-SVHN                     (4)  | Epoch:16 | Val Acc: 0.7014
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 17 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5750, powerC: 0.4250
 Site-MNIST                    | Train Loss: 0.2864 | Train Acc: 0.9191
 Site-MNIST                    | Train Loss: 0.3552 | Train Acc: 0.9049
 Site-USPS                     | Train Loss: 0.3819 | Train Acc: 0.8868
 Site-USPS                     | Train Loss: 0.3918 | Train Acc: 0.8897
 Site-SynthDigits              | Train Loss: 0.5585 | Train Acc: 0.8356
 Site-SynthDigits              | Train Loss: 0.4968 | Train Acc: 0.8664
 Site-MNIST-M                  | Train Loss: 0.7731 | Train Acc: 0.7601
 Site-MNIST-M                  | Train Loss: 0.7446 | Train Acc: 0.7964
 Site-SVHN                     | Train Loss: 0.9899 | Train Acc: 0.6577
 Site-SVHN                     | Train Loss: 0.8982 | Train Acc: 0.7220
 Site-MNIST                     (1) | Val  Loss: 0.2560 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.3525 | Val  Acc: 0.9317
 Site-USPS                      (2) | Val  Loss: 0.5096 | Val  Acc: 0.8152
 Site-USPS                      (2) | Val  Loss: 0.4459 | Val  Acc: 0.8489
 Site-SynthDigits               (4) | Val  Loss: 0.5309 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.5214 | Val  Acc: 0.8273
 Site-MNIST-M                   (3) | Val  Loss: 0.7649 | Val  Acc: 0.7500
 Site-MNIST-M                   (3) | Val  Loss: 0.7136 | Val  Acc: 0.7950
 Site-SVHN                      (0) | Val  Loss: 0.9284 | Val  Acc: 0.7174
 Site-SVHN                      (0) | Val  Loss: 0.9262 | Val  Acc: 0.7086
Average Valid Accuracy: 0.8166
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:17 | Val Acc: 0.9317
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.8152
 Best site-USPS                     (2)  | Epoch:17 | Val Acc: 0.8489
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.8261
 Best site-SynthDigits              (4)  | Epoch:17 | Val Acc: 0.8273
 Best site-MNIST-M                  (3)  | Epoch:17 | Val Acc: 0.7500
 Best site-MNIST-M                  (3)  | Epoch:17 | Val Acc: 0.7950
 Best site-SVHN                     (0)  | Epoch:17 | Val Acc: 0.7174
 Best site-SVHN                     (0)  | Epoch:17 | Val Acc: 0.7086
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 18 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5675, powerC: 0.4325
 Site-MNIST                    | Train Loss: 0.2718 | Train Acc: 0.9299
 Site-MNIST                    | Train Loss: 0.3403 | Train Acc: 0.9085
 Site-USPS                     | Train Loss: 0.3728 | Train Acc: 0.8868
 Site-USPS                     | Train Loss: 0.3828 | Train Acc: 0.8843
 Site-SynthDigits              | Train Loss: 0.5539 | Train Acc: 0.8356
 Site-SynthDigits              | Train Loss: 0.4893 | Train Acc: 0.8637
 Site-MNIST-M                  | Train Loss: 0.7513 | Train Acc: 0.7736
 Site-MNIST-M                  | Train Loss: 0.7135 | Train Acc: 0.7991
 Site-SVHN                     | Train Loss: 0.9965 | Train Acc: 0.6631
 Site-SVHN                     | Train Loss: 0.8738 | Train Acc: 0.7157
 Site-MNIST                     (3) | Val  Loss: 0.2445 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3357 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.4970 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4338 | Val  Acc: 0.8633
 Site-SynthDigits               (2) | Val  Loss: 0.5229 | Val  Acc: 0.8261
 Site-SynthDigits               (2) | Val  Loss: 0.5167 | Val  Acc: 0.8309
 Site-MNIST-M                   (1) | Val  Loss: 0.7340 | Val  Acc: 0.7717
 Site-MNIST-M                   (1) | Val  Loss: 0.6855 | Val  Acc: 0.8058
 Site-SVHN                      (4) | Val  Loss: 0.9184 | Val  Acc: 0.7283
 Site-SVHN                      (4) | Val  Loss: 0.9168 | Val  Acc: 0.7194
Average Valid Accuracy: 0.8256
 Best site-MNIST                    (3)  | Epoch:18 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:18 | Val Acc: 0.9388
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8261
 Best site-USPS                     (0)  | Epoch:18 | Val Acc: 0.8633
 Best site-SynthDigits              (2)  | Epoch:18 | Val Acc: 0.8261
 Best site-SynthDigits              (2)  | Epoch:18 | Val Acc: 0.8309
 Best site-MNIST-M                  (1)  | Epoch:18 | Val Acc: 0.7717
 Best site-MNIST-M                  (1)  | Epoch:18 | Val Acc: 0.8058
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.7283
 Best site-SVHN                     (4)  | Epoch:18 | Val Acc: 0.7194
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 19 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5608, powerC: 0.4392
 Site-MNIST                    | Train Loss: 0.2568 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.3280 | Train Acc: 0.9103
 Site-USPS                     | Train Loss: 0.3691 | Train Acc: 0.8733
 Site-USPS                     | Train Loss: 0.3847 | Train Acc: 0.8852
 Site-SynthDigits              | Train Loss: 0.5448 | Train Acc: 0.8302
 Site-SynthDigits              | Train Loss: 0.4799 | Train Acc: 0.8565
 Site-MNIST-M                  | Train Loss: 0.7392 | Train Acc: 0.7736
 Site-MNIST-M                  | Train Loss: 0.6939 | Train Acc: 0.8054
 Site-SVHN                     | Train Loss: 0.9654 | Train Acc: 0.6685
 Site-SVHN                     | Train Loss: 0.8712 | Train Acc: 0.7166
 Site-MNIST                     (1) | Val  Loss: 0.2374 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.3274 | Val  Acc: 0.9281
 Site-USPS                      (0) | Val  Loss: 0.4975 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4368 | Val  Acc: 0.8633
 Site-SynthDigits               (3) | Val  Loss: 0.5156 | Val  Acc: 0.8261
 Site-SynthDigits               (3) | Val  Loss: 0.5127 | Val  Acc: 0.8237
 Site-MNIST-M                   (2) | Val  Loss: 0.7289 | Val  Acc: 0.7609
 Site-MNIST-M                   (2) | Val  Loss: 0.6787 | Val  Acc: 0.8058
 Site-SVHN                      (4) | Val  Loss: 0.9255 | Val  Acc: 0.7065
 Site-SVHN                      (4) | Val  Loss: 0.8908 | Val  Acc: 0.7230
Average Valid Accuracy: 0.8198
============ Train epoch 20 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5547, powerC: 0.4453
 Site-MNIST                    | Train Loss: 0.2517 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.3198 | Train Acc: 0.9130
 Site-USPS                     | Train Loss: 0.3550 | Train Acc: 0.8814
 Site-USPS                     | Train Loss: 0.3654 | Train Acc: 0.8861
 Site-SynthDigits              | Train Loss: 0.5124 | Train Acc: 0.8410
 Site-SynthDigits              | Train Loss: 0.4543 | Train Acc: 0.8691
 Site-MNIST-M                  | Train Loss: 0.7131 | Train Acc: 0.7844
 Site-MNIST-M                  | Train Loss: 0.6834 | Train Acc: 0.8126
 Site-SVHN                     | Train Loss: 0.9574 | Train Acc: 0.6631
 Site-SVHN                     | Train Loss: 0.8664 | Train Acc: 0.7148
 Site-MNIST                     (3) | Val  Loss: 0.2287 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.3209 | Val  Acc: 0.9317
 Site-USPS                      (0) | Val  Loss: 0.4866 | Val  Acc: 0.8261
 Site-USPS                      (0) | Val  Loss: 0.4235 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4930 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.4871 | Val  Acc: 0.8345
 Site-MNIST-M                   (1) | Val  Loss: 0.7035 | Val  Acc: 0.7609
 Site-MNIST-M                   (1) | Val  Loss: 0.6547 | Val  Acc: 0.8094
 Site-SVHN                      (2) | Val  Loss: 0.9038 | Val  Acc: 0.7174
 Site-SVHN                      (2) | Val  Loss: 0.8824 | Val  Acc: 0.7302
Average Valid Accuracy: 0.8245
============ Train epoch 21 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5492, powerC: 0.4508
 Site-MNIST                    | Train Loss: 0.2435 | Train Acc: 0.9353
 Site-MNIST                    | Train Loss: 0.3083 | Train Acc: 0.9157
 Site-USPS                     | Train Loss: 0.3442 | Train Acc: 0.8949
 Site-USPS                     | Train Loss: 0.3518 | Train Acc: 0.8978
 Site-SynthDigits              | Train Loss: 0.5095 | Train Acc: 0.8491
 Site-SynthDigits              | Train Loss: 0.4556 | Train Acc: 0.8673
 Site-MNIST-M                  | Train Loss: 0.6984 | Train Acc: 0.7790
 Site-MNIST-M                  | Train Loss: 0.6505 | Train Acc: 0.8170
 Site-SVHN                     | Train Loss: 0.9424 | Train Acc: 0.6765
 Site-SVHN                     | Train Loss: 0.8406 | Train Acc: 0.7247
 Site-MNIST                     (2) | Val  Loss: 0.2142 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.3070 | Val  Acc: 0.9353
 Site-USPS                      (3) | Val  Loss: 0.4698 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.4002 | Val  Acc: 0.8705
 Site-SynthDigits               (4) | Val  Loss: 0.4847 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.4775 | Val  Acc: 0.8417
 Site-MNIST-M                   (1) | Val  Loss: 0.6820 | Val  Acc: 0.7935
 Site-MNIST-M                   (1) | Val  Loss: 0.6309 | Val  Acc: 0.8237
 Site-SVHN                      (0) | Val  Loss: 0.8877 | Val  Acc: 0.7174
 Site-SVHN                      (0) | Val  Loss: 0.8684 | Val  Acc: 0.7266
Average Valid Accuracy: 0.8317
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:21 | Val Acc: 0.9353
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8370
 Best site-USPS                     (3)  | Epoch:21 | Val Acc: 0.8705
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8261
 Best site-SynthDigits              (4)  | Epoch:21 | Val Acc: 0.8417
 Best site-MNIST-M                  (1)  | Epoch:21 | Val Acc: 0.7935
 Best site-MNIST-M                  (1)  | Epoch:21 | Val Acc: 0.8237
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7174
 Best site-SVHN                     (0)  | Epoch:21 | Val Acc: 0.7266
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 22 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5443, powerC: 0.4557
 Site-MNIST                    | Train Loss: 0.2392 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.3055 | Train Acc: 0.9148
 Site-USPS                     | Train Loss: 0.3526 | Train Acc: 0.8868
 Site-USPS                     | Train Loss: 0.3518 | Train Acc: 0.8924
 Site-SynthDigits              | Train Loss: 0.5007 | Train Acc: 0.8518
 Site-SynthDigits              | Train Loss: 0.4573 | Train Acc: 0.8700
 Site-MNIST-M                  | Train Loss: 0.7004 | Train Acc: 0.7790
 Site-MNIST-M                  | Train Loss: 0.6459 | Train Acc: 0.8143
 Site-SVHN                     | Train Loss: 0.9278 | Train Acc: 0.6981
 Site-SVHN                     | Train Loss: 0.8398 | Train Acc: 0.7327
 Site-MNIST                     (0) | Val  Loss: 0.2153 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.3056 | Val  Acc: 0.9281
 Site-USPS                      (2) | Val  Loss: 0.4607 | Val  Acc: 0.8370
 Site-USPS                      (2) | Val  Loss: 0.4000 | Val  Acc: 0.8669
 Site-SynthDigits               (1) | Val  Loss: 0.4793 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.4743 | Val  Acc: 0.8345
 Site-MNIST-M                   (3) | Val  Loss: 0.6801 | Val  Acc: 0.8043
 Site-MNIST-M                   (3) | Val  Loss: 0.6333 | Val  Acc: 0.8201
 Site-SVHN                      (4) | Val  Loss: 0.8614 | Val  Acc: 0.7609
 Site-SVHN                      (4) | Val  Loss: 0.8467 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8357
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9457
 Best site-MNIST                    (0)  | Epoch:22 | Val Acc: 0.9281
 Best site-USPS                     (2)  | Epoch:22 | Val Acc: 0.8370
 Best site-USPS                     (2)  | Epoch:22 | Val Acc: 0.8669
 Best site-SynthDigits              (1)  | Epoch:22 | Val Acc: 0.8261
 Best site-SynthDigits              (1)  | Epoch:22 | Val Acc: 0.8345
 Best site-MNIST-M                  (3)  | Epoch:22 | Val Acc: 0.8043
 Best site-MNIST-M                  (3)  | Epoch:22 | Val Acc: 0.8201
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.7609
 Best site-SVHN                     (4)  | Epoch:22 | Val Acc: 0.7338
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 23 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5399, powerC: 0.4601
 Site-MNIST                    | Train Loss: 0.2298 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.2966 | Train Acc: 0.9247
 Site-USPS                     | Train Loss: 0.3349 | Train Acc: 0.8895
 Site-USPS                     | Train Loss: 0.3395 | Train Acc: 0.8978
 Site-SynthDigits              | Train Loss: 0.5080 | Train Acc: 0.8518
 Site-SynthDigits              | Train Loss: 0.4459 | Train Acc: 0.8673
 Site-MNIST-M                  | Train Loss: 0.6882 | Train Acc: 0.7817
 Site-MNIST-M                  | Train Loss: 0.6318 | Train Acc: 0.8269
 Site-SVHN                     | Train Loss: 0.9241 | Train Acc: 0.6685
 Site-SVHN                     | Train Loss: 0.8122 | Train Acc: 0.7363
 Site-MNIST                     (1) | Val  Loss: 0.1966 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2906 | Val  Acc: 0.9388
 Site-USPS                      (3) | Val  Loss: 0.4467 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.3820 | Val  Acc: 0.8633
 Site-SynthDigits               (4) | Val  Loss: 0.4940 | Val  Acc: 0.8152
 Site-SynthDigits               (4) | Val  Loss: 0.4747 | Val  Acc: 0.8381
 Site-MNIST-M                   (2) | Val  Loss: 0.6469 | Val  Acc: 0.8043
 Site-MNIST-M                   (2) | Val  Loss: 0.6038 | Val  Acc: 0.8309
 Site-SVHN                      (0) | Val  Loss: 0.8565 | Val  Acc: 0.7283
 Site-SVHN                      (0) | Val  Loss: 0.8403 | Val  Acc: 0.7338
Average Valid Accuracy: 0.8335
============ Train epoch 24 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5359, powerC: 0.4641
 Site-MNIST                    | Train Loss: 0.2235 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.2891 | Train Acc: 0.9211
 Site-USPS                     | Train Loss: 0.3438 | Train Acc: 0.8868
 Site-USPS                     | Train Loss: 0.3411 | Train Acc: 0.8978
 Site-SynthDigits              | Train Loss: 0.4763 | Train Acc: 0.8571
 Site-SynthDigits              | Train Loss: 0.4244 | Train Acc: 0.8717
 Site-MNIST-M                  | Train Loss: 0.6651 | Train Acc: 0.7844
 Site-MNIST-M                  | Train Loss: 0.6155 | Train Acc: 0.8224
 Site-SVHN                     | Train Loss: 0.9018 | Train Acc: 0.6954
 Site-SVHN                     | Train Loss: 0.8065 | Train Acc: 0.7390
 Site-MNIST                     (1) | Val  Loss: 0.1947 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2895 | Val  Acc: 0.9424
 Site-USPS                      (3) | Val  Loss: 0.4542 | Val  Acc: 0.8478
 Site-USPS                      (3) | Val  Loss: 0.3883 | Val  Acc: 0.8669
 Site-SynthDigits               (0) | Val  Loss: 0.4558 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.4528 | Val  Acc: 0.8453
 Site-MNIST-M                   (2) | Val  Loss: 0.6509 | Val  Acc: 0.8152
 Site-MNIST-M                   (2) | Val  Loss: 0.5992 | Val  Acc: 0.8237
 Site-SVHN                      (4) | Val  Loss: 0.8615 | Val  Acc: 0.7500
 Site-SVHN                      (4) | Val  Loss: 0.8267 | Val  Acc: 0.7518
Average Valid Accuracy: 0.8415
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:24 | Val Acc: 0.9424
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8478
 Best site-USPS                     (3)  | Epoch:24 | Val Acc: 0.8669
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8261
 Best site-SynthDigits              (0)  | Epoch:24 | Val Acc: 0.8453
 Best site-MNIST-M                  (2)  | Epoch:24 | Val Acc: 0.8152
 Best site-MNIST-M                  (2)  | Epoch:24 | Val Acc: 0.8237
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.7500
 Best site-SVHN                     (4)  | Epoch:24 | Val Acc: 0.7518
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 25 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5323, powerC: 0.4677
 Site-MNIST                    | Train Loss: 0.2213 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2880 | Train Acc: 0.9202
 Site-USPS                     | Train Loss: 0.3220 | Train Acc: 0.8895
 Site-USPS                     | Train Loss: 0.3231 | Train Acc: 0.9004
 Site-SynthDigits              | Train Loss: 0.4752 | Train Acc: 0.8652
 Site-SynthDigits              | Train Loss: 0.4176 | Train Acc: 0.8798
 Site-MNIST-M                  | Train Loss: 0.6703 | Train Acc: 0.7871
 Site-MNIST-M                  | Train Loss: 0.6221 | Train Acc: 0.8260
 Site-SVHN                     | Train Loss: 0.8901 | Train Acc: 0.7008
 Site-SVHN                     | Train Loss: 0.7746 | Train Acc: 0.7462
 Site-MNIST                     (1) | Val  Loss: 0.1983 | Val  Acc: 0.9348
 Site-MNIST                     (1) | Val  Loss: 0.2907 | Val  Acc: 0.9353
 Site-USPS                      (0) | Val  Loss: 0.4448 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.3761 | Val  Acc: 0.8705
 Site-SynthDigits               (4) | Val  Loss: 0.4542 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.4456 | Val  Acc: 0.8453
 Site-MNIST-M                   (2) | Val  Loss: 0.6442 | Val  Acc: 0.8261
 Site-MNIST-M                   (2) | Val  Loss: 0.5900 | Val  Acc: 0.8309
 Site-SVHN                      (3) | Val  Loss: 0.8287 | Val  Acc: 0.7717
 Site-SVHN                      (3) | Val  Loss: 0.8064 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8444
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9348
 Best site-MNIST                    (1)  | Epoch:25 | Val Acc: 0.9353
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8478
 Best site-USPS                     (0)  | Epoch:25 | Val Acc: 0.8705
 Best site-SynthDigits              (4)  | Epoch:25 | Val Acc: 0.8261
 Best site-SynthDigits              (4)  | Epoch:25 | Val Acc: 0.8453
 Best site-MNIST-M                  (2)  | Epoch:25 | Val Acc: 0.8261
 Best site-MNIST-M                  (2)  | Epoch:25 | Val Acc: 0.8309
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7717
 Best site-SVHN                     (3)  | Epoch:25 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 26 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5291, powerC: 0.4709
 Site-MNIST                    | Train Loss: 0.2132 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.2771 | Train Acc: 0.9175
 Site-USPS                     | Train Loss: 0.3267 | Train Acc: 0.8976
 Site-USPS                     | Train Loss: 0.3254 | Train Acc: 0.8978
 Site-SynthDigits              | Train Loss: 0.4658 | Train Acc: 0.8652
 Site-SynthDigits              | Train Loss: 0.4062 | Train Acc: 0.8744
 Site-MNIST-M                  | Train Loss: 0.6399 | Train Acc: 0.7951
 Site-MNIST-M                  | Train Loss: 0.5983 | Train Acc: 0.8278
 Site-SVHN                     | Train Loss: 0.8892 | Train Acc: 0.6981
 Site-SVHN                     | Train Loss: 0.7777 | Train Acc: 0.7516
 Site-MNIST                     (3) | Val  Loss: 0.1894 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2787 | Val  Acc: 0.9388
 Site-USPS                      (4) | Val  Loss: 0.4384 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.3694 | Val  Acc: 0.8813
 Site-SynthDigits               (0) | Val  Loss: 0.4487 | Val  Acc: 0.8261
 Site-SynthDigits               (0) | Val  Loss: 0.4394 | Val  Acc: 0.8453
 Site-MNIST-M                   (1) | Val  Loss: 0.6199 | Val  Acc: 0.8478
 Site-MNIST-M                   (1) | Val  Loss: 0.5644 | Val  Acc: 0.8417
 Site-SVHN                      (2) | Val  Loss: 0.8430 | Val  Acc: 0.7609
 Site-SVHN                      (2) | Val  Loss: 0.8043 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8505
 Best site-MNIST                    (3)  | Epoch:26 | Val Acc: 0.9457
 Best site-MNIST                    (3)  | Epoch:26 | Val Acc: 0.9388
 Best site-USPS                     (4)  | Epoch:26 | Val Acc: 0.8587
 Best site-USPS                     (4)  | Epoch:26 | Val Acc: 0.8813
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8261
 Best site-SynthDigits              (0)  | Epoch:26 | Val Acc: 0.8453
 Best site-MNIST-M                  (1)  | Epoch:26 | Val Acc: 0.8478
 Best site-MNIST-M                  (1)  | Epoch:26 | Val Acc: 0.8417
 Best site-SVHN                     (2)  | Epoch:26 | Val Acc: 0.7609
 Best site-SVHN                     (2)  | Epoch:26 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 27 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5262, powerC: 0.4738
 Site-MNIST                    | Train Loss: 0.2147 | Train Acc: 0.9461
 Site-MNIST                    | Train Loss: 0.2757 | Train Acc: 0.9184
 Site-USPS                     | Train Loss: 0.3212 | Train Acc: 0.8976
 Site-USPS                     | Train Loss: 0.3247 | Train Acc: 0.9085
 Site-SynthDigits              | Train Loss: 0.4567 | Train Acc: 0.8625
 Site-SynthDigits              | Train Loss: 0.4015 | Train Acc: 0.8852
 Site-MNIST-M                  | Train Loss: 0.6432 | Train Acc: 0.7871
 Site-MNIST-M                  | Train Loss: 0.6001 | Train Acc: 0.8269
 Site-SVHN                     | Train Loss: 0.8583 | Train Acc: 0.6981
 Site-SVHN                     | Train Loss: 0.7615 | Train Acc: 0.7596
 Site-MNIST                     (1) | Val  Loss: 0.1879 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2792 | Val  Acc: 0.9388
 Site-USPS                      (3) | Val  Loss: 0.4400 | Val  Acc: 0.8478
 Site-USPS                      (3) | Val  Loss: 0.3691 | Val  Acc: 0.8813
 Site-SynthDigits               (4) | Val  Loss: 0.4390 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.4245 | Val  Acc: 0.8561
 Site-MNIST-M                   (2) | Val  Loss: 0.6203 | Val  Acc: 0.8587
 Site-MNIST-M                   (2) | Val  Loss: 0.5664 | Val  Acc: 0.8453
 Site-SVHN                      (0) | Val  Loss: 0.8238 | Val  Acc: 0.7500
 Site-SVHN                      (0) | Val  Loss: 0.7828 | Val  Acc: 0.7590
Average Valid Accuracy: 0.8520
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:27 | Val Acc: 0.9388
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.8478
 Best site-USPS                     (3)  | Epoch:27 | Val Acc: 0.8813
 Best site-SynthDigits              (4)  | Epoch:27 | Val Acc: 0.8370
 Best site-SynthDigits              (4)  | Epoch:27 | Val Acc: 0.8561
 Best site-MNIST-M                  (2)  | Epoch:27 | Val Acc: 0.8587
 Best site-MNIST-M                  (2)  | Epoch:27 | Val Acc: 0.8453
 Best site-SVHN                     (0)  | Epoch:27 | Val Acc: 0.7500
 Best site-SVHN                     (0)  | Epoch:27 | Val Acc: 0.7590
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 28 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5236, powerC: 0.4764
 Site-MNIST                    | Train Loss: 0.2139 | Train Acc: 0.9461
 Site-MNIST                    | Train Loss: 0.2740 | Train Acc: 0.9175
 Site-USPS                     | Train Loss: 0.3065 | Train Acc: 0.9057
 Site-USPS                     | Train Loss: 0.3045 | Train Acc: 0.9121
 Site-SynthDigits              | Train Loss: 0.4452 | Train Acc: 0.8625
 Site-SynthDigits              | Train Loss: 0.3958 | Train Acc: 0.8924
 Site-MNIST-M                  | Train Loss: 0.6391 | Train Acc: 0.7844
 Site-MNIST-M                  | Train Loss: 0.5803 | Train Acc: 0.8314
 Site-SVHN                     | Train Loss: 0.8678 | Train Acc: 0.6954
 Site-SVHN                     | Train Loss: 0.7388 | Train Acc: 0.7713
 Site-MNIST                     (1) | Val  Loss: 0.1839 | Val  Acc: 0.9457
 Site-MNIST                     (1) | Val  Loss: 0.2754 | Val  Acc: 0.9388
 Site-USPS                      (3) | Val  Loss: 0.4256 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3502 | Val  Acc: 0.8849
 Site-SynthDigits               (0) | Val  Loss: 0.4312 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.4086 | Val  Acc: 0.8633
 Site-MNIST-M                   (2) | Val  Loss: 0.6004 | Val  Acc: 0.8587
 Site-MNIST-M                   (2) | Val  Loss: 0.5567 | Val  Acc: 0.8489
 Site-SVHN                      (4) | Val  Loss: 0.8006 | Val  Acc: 0.7609
 Site-SVHN                      (4) | Val  Loss: 0.7720 | Val  Acc: 0.7554
Average Valid Accuracy: 0.8563
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9457
 Best site-MNIST                    (1)  | Epoch:28 | Val Acc: 0.9388
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:28 | Val Acc: 0.8849
 Best site-SynthDigits              (0)  | Epoch:28 | Val Acc: 0.8478
 Best site-SynthDigits              (0)  | Epoch:28 | Val Acc: 0.8633
 Best site-MNIST-M                  (2)  | Epoch:28 | Val Acc: 0.8587
 Best site-MNIST-M                  (2)  | Epoch:28 | Val Acc: 0.8489
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.7609
 Best site-SVHN                     (4)  | Epoch:28 | Val Acc: 0.7554
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 29 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5212, powerC: 0.4788
 Site-MNIST                    | Train Loss: 0.2183 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.2849 | Train Acc: 0.9175
 Site-USPS                     | Train Loss: 0.3068 | Train Acc: 0.9137
 Site-USPS                     | Train Loss: 0.3060 | Train Acc: 0.9049
 Site-SynthDigits              | Train Loss: 0.4394 | Train Acc: 0.8652
 Site-SynthDigits              | Train Loss: 0.3894 | Train Acc: 0.8843
 Site-MNIST-M                  | Train Loss: 0.6203 | Train Acc: 0.7871
 Site-MNIST-M                  | Train Loss: 0.5697 | Train Acc: 0.8341
 Site-SVHN                     | Train Loss: 0.8639 | Train Acc: 0.6954
 Site-SVHN                     | Train Loss: 0.7391 | Train Acc: 0.7641
 Site-MNIST                     (2) | Val  Loss: 0.1967 | Val  Acc: 0.9565
 Site-MNIST                     (2) | Val  Loss: 0.2823 | Val  Acc: 0.9424
 Site-USPS                      (3) | Val  Loss: 0.4240 | Val  Acc: 0.8478
 Site-USPS                      (3) | Val  Loss: 0.3496 | Val  Acc: 0.8777
 Site-SynthDigits               (1) | Val  Loss: 0.4210 | Val  Acc: 0.8370
 Site-SynthDigits               (1) | Val  Loss: 0.4120 | Val  Acc: 0.8561
 Site-MNIST-M                   (0) | Val  Loss: 0.5905 | Val  Acc: 0.8587
 Site-MNIST-M                   (0) | Val  Loss: 0.5415 | Val  Acc: 0.8417
 Site-SVHN                      (4) | Val  Loss: 0.7838 | Val  Acc: 0.7826
 Site-SVHN                      (4) | Val  Loss: 0.7673 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8570
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9565
 Best site-MNIST                    (2)  | Epoch:29 | Val Acc: 0.9424
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8478
 Best site-USPS                     (3)  | Epoch:29 | Val Acc: 0.8777
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8370
 Best site-SynthDigits              (1)  | Epoch:29 | Val Acc: 0.8561
 Best site-MNIST-M                  (0)  | Epoch:29 | Val Acc: 0.8587
 Best site-MNIST-M                  (0)  | Epoch:29 | Val Acc: 0.8417
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.7826
 Best site-SVHN                     (4)  | Epoch:29 | Val Acc: 0.7698
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
 Test site-MNIST                     (2)| Epoch:29 | Test Acc: 0.9314
 Test site-USPS                      (3)| Epoch:29 | Test Acc: 0.9161
 Test site-SynthDigits               (1)| Epoch:29 | Test Acc: 0.8770
 Test site-MNIST-M                   (0)| Epoch:29 | Test Acc: 0.7577
 Test site-MNIST-M                   (0)| Epoch:29 | Test Acc: 0.7577
 Test site-SVHN                      (4)| Epoch:29 | Test Acc: 0.7038
MNIST: 0.8156, USPS: 0.9161, SynthDigits: 0.8770, SVHN: 0.7038, 
Average Test Accuracy(group): 0.8281, Average Test Accuracy(individual): 0.8372,
domain CV=0.0969, cluster CV=0.1079, individual CV=0.1079, 
============ Train epoch 30 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5191, powerC: 0.4809
 Site-MNIST                    | Train Loss: 0.2261 | Train Acc: 0.9299
 Site-MNIST                    | Train Loss: 0.2878 | Train Acc: 0.9130
 Site-USPS                     | Train Loss: 0.3042 | Train Acc: 0.9084
 Site-USPS                     | Train Loss: 0.3228 | Train Acc: 0.9031
 Site-SynthDigits              | Train Loss: 0.4176 | Train Acc: 0.8733
 Site-SynthDigits              | Train Loss: 0.3767 | Train Acc: 0.8924
 Site-MNIST-M                  | Train Loss: 0.6250 | Train Acc: 0.8032
 Site-MNIST-M                  | Train Loss: 0.5603 | Train Acc: 0.8305
 Site-SVHN                     | Train Loss: 0.8626 | Train Acc: 0.7062
 Site-SVHN                     | Train Loss: 0.7394 | Train Acc: 0.7596
 Site-MNIST                     (2) | Val  Loss: 0.2014 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2942 | Val  Acc: 0.9353
 Site-USPS                      (3) | Val  Loss: 0.4325 | Val  Acc: 0.8370
 Site-USPS                      (3) | Val  Loss: 0.3600 | Val  Acc: 0.8741
 Site-SynthDigits               (4) | Val  Loss: 0.3992 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.3990 | Val  Acc: 0.8525
 Site-MNIST-M                   (1) | Val  Loss: 0.5868 | Val  Acc: 0.8261
 Site-MNIST-M                   (1) | Val  Loss: 0.5392 | Val  Acc: 0.8201
 Site-SVHN                      (0) | Val  Loss: 0.7915 | Val  Acc: 0.7826
 Site-SVHN                      (0) | Val  Loss: 0.7609 | Val  Acc: 0.7698
Average Valid Accuracy: 0.8480
============ Train epoch 31 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5172, powerC: 0.4828
 Site-MNIST                    | Train Loss: 0.2105 | Train Acc: 0.9461
 Site-MNIST                    | Train Loss: 0.2811 | Train Acc: 0.9220
 Site-USPS                     | Train Loss: 0.2958 | Train Acc: 0.9084
 Site-USPS                     | Train Loss: 0.2951 | Train Acc: 0.9103
 Site-SynthDigits              | Train Loss: 0.4483 | Train Acc: 0.8706
 Site-SynthDigits              | Train Loss: 0.3964 | Train Acc: 0.8879
 Site-MNIST-M                  | Train Loss: 0.6168 | Train Acc: 0.8005
 Site-MNIST-M                  | Train Loss: 0.5568 | Train Acc: 0.8341
 Site-SVHN                     | Train Loss: 0.8756 | Train Acc: 0.7035
 Site-SVHN                     | Train Loss: 0.7221 | Train Acc: 0.7650
 Site-MNIST                     (0) | Val  Loss: 0.1900 | Val  Acc: 0.9674
 Site-MNIST                     (0) | Val  Loss: 0.2797 | Val  Acc: 0.9460
 Site-USPS                      (3) | Val  Loss: 0.4200 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3398 | Val  Acc: 0.8849
 Site-SynthDigits               (4) | Val  Loss: 0.4424 | Val  Acc: 0.8261
 Site-SynthDigits               (4) | Val  Loss: 0.4082 | Val  Acc: 0.8597
 Site-MNIST-M                   (2) | Val  Loss: 0.5837 | Val  Acc: 0.8370
 Site-MNIST-M                   (2) | Val  Loss: 0.5369 | Val  Acc: 0.8201
 Site-SVHN                      (1) | Val  Loss: 0.7783 | Val  Acc: 0.7826
 Site-SVHN                      (1) | Val  Loss: 0.7622 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8549
============ Train epoch 32 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5155, powerC: 0.4845
 Site-MNIST                    | Train Loss: 0.2017 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2668 | Train Acc: 0.9220
 Site-USPS                     | Train Loss: 0.2980 | Train Acc: 0.8976
 Site-USPS                     | Train Loss: 0.2944 | Train Acc: 0.9103
 Site-SynthDigits              | Train Loss: 0.4454 | Train Acc: 0.8544
 Site-SynthDigits              | Train Loss: 0.3840 | Train Acc: 0.8924
 Site-MNIST-M                  | Train Loss: 0.6123 | Train Acc: 0.7871
 Site-MNIST-M                  | Train Loss: 0.5473 | Train Acc: 0.8305
 Site-SVHN                     | Train Loss: 0.8577 | Train Acc: 0.6954
 Site-SVHN                     | Train Loss: 0.7126 | Train Acc: 0.7821
 Site-MNIST                     (3) | Val  Loss: 0.1837 | Val  Acc: 0.9457
 Site-MNIST                     (3) | Val  Loss: 0.2673 | Val  Acc: 0.9353
 Site-USPS                      (1) | Val  Loss: 0.4165 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.3355 | Val  Acc: 0.8777
 Site-SynthDigits               (2) | Val  Loss: 0.4306 | Val  Acc: 0.8152
 Site-SynthDigits               (2) | Val  Loss: 0.3998 | Val  Acc: 0.8561
 Site-MNIST-M                   (0) | Val  Loss: 0.5761 | Val  Acc: 0.8587
 Site-MNIST-M                   (0) | Val  Loss: 0.5260 | Val  Acc: 0.8309
 Site-SVHN                      (4) | Val  Loss: 0.7544 | Val  Acc: 0.7826
 Site-SVHN                      (4) | Val  Loss: 0.7406 | Val  Acc: 0.7662
Average Valid Accuracy: 0.8527
============ Train epoch 33 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5139, powerC: 0.4861
 Site-MNIST                    | Train Loss: 0.2019 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2710 | Train Acc: 0.9229
 Site-USPS                     | Train Loss: 0.2889 | Train Acc: 0.9057
 Site-USPS                     | Train Loss: 0.2904 | Train Acc: 0.9103
 Site-SynthDigits              | Train Loss: 0.4335 | Train Acc: 0.8706
 Site-SynthDigits              | Train Loss: 0.3818 | Train Acc: 0.8780
 Site-MNIST-M                  | Train Loss: 0.5936 | Train Acc: 0.8032
 Site-MNIST-M                  | Train Loss: 0.5503 | Train Acc: 0.8368
 Site-SVHN                     | Train Loss: 0.8339 | Train Acc: 0.7251
 Site-SVHN                     | Train Loss: 0.7022 | Train Acc: 0.7731
 Site-MNIST                     (3) | Val  Loss: 0.1839 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2656 | Val  Acc: 0.9388
 Site-USPS                      (0) | Val  Loss: 0.4029 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.3278 | Val  Acc: 0.8849
 Site-SynthDigits               (1) | Val  Loss: 0.4275 | Val  Acc: 0.8261
 Site-SynthDigits               (1) | Val  Loss: 0.4043 | Val  Acc: 0.8561
 Site-MNIST-M                   (2) | Val  Loss: 0.5783 | Val  Acc: 0.8261
 Site-MNIST-M                   (2) | Val  Loss: 0.5196 | Val  Acc: 0.8417
 Site-SVHN                      (4) | Val  Loss: 0.7514 | Val  Acc: 0.7935
 Site-SVHN                      (4) | Val  Loss: 0.7267 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8567
============ Train epoch 34 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5125, powerC: 0.4875
 Site-MNIST                    | Train Loss: 0.2000 | Train Acc: 0.9488
 Site-MNIST                    | Train Loss: 0.2602 | Train Acc: 0.9265
 Site-USPS                     | Train Loss: 0.2893 | Train Acc: 0.9111
 Site-USPS                     | Train Loss: 0.2837 | Train Acc: 0.9121
 Site-SynthDigits              | Train Loss: 0.4192 | Train Acc: 0.8706
 Site-SynthDigits              | Train Loss: 0.3658 | Train Acc: 0.8933
 Site-MNIST-M                  | Train Loss: 0.6011 | Train Acc: 0.7898
 Site-MNIST-M                  | Train Loss: 0.5396 | Train Acc: 0.8350
 Site-SVHN                     | Train Loss: 0.8345 | Train Acc: 0.7089
 Site-SVHN                     | Train Loss: 0.7028 | Train Acc: 0.7785
 Site-MNIST                     (4) | Val  Loss: 0.1695 | Val  Acc: 0.9674
 Site-MNIST                     (4) | Val  Loss: 0.2597 | Val  Acc: 0.9460
 Site-USPS                      (0) | Val  Loss: 0.4000 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.3217 | Val  Acc: 0.8813
 Site-SynthDigits               (2) | Val  Loss: 0.4157 | Val  Acc: 0.8261
 Site-SynthDigits               (2) | Val  Loss: 0.3834 | Val  Acc: 0.8597
 Site-MNIST-M                   (1) | Val  Loss: 0.5655 | Val  Acc: 0.8370
 Site-MNIST-M                   (1) | Val  Loss: 0.5126 | Val  Acc: 0.8381
 Site-SVHN                      (3) | Val  Loss: 0.7519 | Val  Acc: 0.7609
 Site-SVHN                      (3) | Val  Loss: 0.7259 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8559
============ Train epoch 35 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5113, powerC: 0.4887
 Site-MNIST                    | Train Loss: 0.1966 | Train Acc: 0.9488
 Site-MNIST                    | Train Loss: 0.2498 | Train Acc: 0.9247
 Site-USPS                     | Train Loss: 0.2924 | Train Acc: 0.9084
 Site-USPS                     | Train Loss: 0.2839 | Train Acc: 0.9184
 Site-SynthDigits              | Train Loss: 0.4173 | Train Acc: 0.8679
 Site-SynthDigits              | Train Loss: 0.3715 | Train Acc: 0.8933
 Site-MNIST-M                  | Train Loss: 0.6022 | Train Acc: 0.7844
 Site-MNIST-M                  | Train Loss: 0.5315 | Train Acc: 0.8386
 Site-SVHN                     | Train Loss: 0.8231 | Train Acc: 0.7062
 Site-SVHN                     | Train Loss: 0.6858 | Train Acc: 0.7901
 Site-MNIST                     (2) | Val  Loss: 0.1678 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2545 | Val  Acc: 0.9424
 Site-USPS                      (3) | Val  Loss: 0.4149 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3266 | Val  Acc: 0.8849
 Site-SynthDigits               (1) | Val  Loss: 0.4021 | Val  Acc: 0.8478
 Site-SynthDigits               (1) | Val  Loss: 0.3771 | Val  Acc: 0.8705
 Site-MNIST-M                   (0) | Val  Loss: 0.5530 | Val  Acc: 0.8478
 Site-MNIST-M                   (0) | Val  Loss: 0.5033 | Val  Acc: 0.8417
 Site-SVHN                      (4) | Val  Loss: 0.7250 | Val  Acc: 0.8152
 Site-SVHN                      (4) | Val  Loss: 0.7128 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8639
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:35 | Val Acc: 0.9424
 Best site-USPS                     (3)  | Epoch:35 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:35 | Val Acc: 0.8849
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8478
 Best site-SynthDigits              (1)  | Epoch:35 | Val Acc: 0.8705
 Best site-MNIST-M                  (0)  | Epoch:35 | Val Acc: 0.8478
 Best site-MNIST-M                  (0)  | Epoch:35 | Val Acc: 0.8417
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.8152
 Best site-SVHN                     (4)  | Epoch:35 | Val Acc: 0.7842
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 36 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5101, powerC: 0.4899
 Site-MNIST                    | Train Loss: 0.1863 | Train Acc: 0.9461
 Site-MNIST                    | Train Loss: 0.2468 | Train Acc: 0.9247
 Site-USPS                     | Train Loss: 0.2847 | Train Acc: 0.9084
 Site-USPS                     | Train Loss: 0.2731 | Train Acc: 0.9121
 Site-SynthDigits              | Train Loss: 0.4151 | Train Acc: 0.8652
 Site-SynthDigits              | Train Loss: 0.3598 | Train Acc: 0.8888
 Site-MNIST-M                  | Train Loss: 0.5744 | Train Acc: 0.7898
 Site-MNIST-M                  | Train Loss: 0.5204 | Train Acc: 0.8448
 Site-SVHN                     | Train Loss: 0.8151 | Train Acc: 0.7170
 Site-SVHN                     | Train Loss: 0.6895 | Train Acc: 0.7839
 Site-MNIST                     (2) | Val  Loss: 0.1668 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2474 | Val  Acc: 0.9388
 Site-USPS                      (3) | Val  Loss: 0.3918 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3170 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.3984 | Val  Acc: 0.8370
 Site-SynthDigits               (0) | Val  Loss: 0.3809 | Val  Acc: 0.8669
 Site-MNIST-M                   (1) | Val  Loss: 0.5471 | Val  Acc: 0.8478
 Site-MNIST-M                   (1) | Val  Loss: 0.4968 | Val  Acc: 0.8525
 Site-SVHN                      (4) | Val  Loss: 0.7420 | Val  Acc: 0.7935
 Site-SVHN                      (4) | Val  Loss: 0.7109 | Val  Acc: 0.7878
Average Valid Accuracy: 0.8621
============ Train epoch 37 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5091, powerC: 0.4909
 Site-MNIST                    | Train Loss: 0.1904 | Train Acc: 0.9488
 Site-MNIST                    | Train Loss: 0.2529 | Train Acc: 0.9283
 Site-USPS                     | Train Loss: 0.2814 | Train Acc: 0.9191
 Site-USPS                     | Train Loss: 0.2798 | Train Acc: 0.9130
 Site-SynthDigits              | Train Loss: 0.4040 | Train Acc: 0.8652
 Site-SynthDigits              | Train Loss: 0.3618 | Train Acc: 0.8933
 Site-MNIST-M                  | Train Loss: 0.5868 | Train Acc: 0.7951
 Site-MNIST-M                  | Train Loss: 0.5206 | Train Acc: 0.8538
 Site-SVHN                     | Train Loss: 0.8253 | Train Acc: 0.7224
 Site-SVHN                     | Train Loss: 0.6858 | Train Acc: 0.7865
 Site-MNIST                     (2) | Val  Loss: 0.1705 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2522 | Val  Acc: 0.9424
 Site-USPS                      (3) | Val  Loss: 0.3773 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.3081 | Val  Acc: 0.8921
 Site-SynthDigits               (4) | Val  Loss: 0.4013 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.3783 | Val  Acc: 0.8597
 Site-MNIST-M                   (1) | Val  Loss: 0.5422 | Val  Acc: 0.8478
 Site-MNIST-M                   (1) | Val  Loss: 0.4933 | Val  Acc: 0.8561
 Site-SVHN                      (0) | Val  Loss: 0.7207 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.7114 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8653
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9457
 Best site-MNIST                    (2)  | Epoch:37 | Val Acc: 0.9424
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:37 | Val Acc: 0.8921
 Best site-SynthDigits              (4)  | Epoch:37 | Val Acc: 0.8370
 Best site-SynthDigits              (4)  | Epoch:37 | Val Acc: 0.8597
 Best site-MNIST-M                  (1)  | Epoch:37 | Val Acc: 0.8478
 Best site-MNIST-M                  (1)  | Epoch:37 | Val Acc: 0.8561
 Best site-SVHN                     (0)  | Epoch:37 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:37 | Val Acc: 0.7986
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 38 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5082, powerC: 0.4918
 Site-MNIST                    | Train Loss: 0.1915 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.2618 | Train Acc: 0.9238
 Site-USPS                     | Train Loss: 0.2785 | Train Acc: 0.9218
 Site-USPS                     | Train Loss: 0.2756 | Train Acc: 0.9121
 Site-SynthDigits              | Train Loss: 0.4105 | Train Acc: 0.8706
 Site-SynthDigits              | Train Loss: 0.3557 | Train Acc: 0.8960
 Site-MNIST-M                  | Train Loss: 0.5763 | Train Acc: 0.8032
 Site-MNIST-M                  | Train Loss: 0.5196 | Train Acc: 0.8502
 Site-SVHN                     | Train Loss: 0.8159 | Train Acc: 0.7197
 Site-SVHN                     | Train Loss: 0.6770 | Train Acc: 0.7874
 Site-MNIST                     (2) | Val  Loss: 0.1735 | Val  Acc: 0.9457
 Site-MNIST                     (2) | Val  Loss: 0.2602 | Val  Acc: 0.9424
 Site-USPS                      (0) | Val  Loss: 0.3779 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.3107 | Val  Acc: 0.8921
 Site-SynthDigits               (4) | Val  Loss: 0.3944 | Val  Acc: 0.8370
 Site-SynthDigits               (4) | Val  Loss: 0.3682 | Val  Acc: 0.8597
 Site-MNIST-M                   (1) | Val  Loss: 0.5355 | Val  Acc: 0.8370
 Site-MNIST-M                   (1) | Val  Loss: 0.4924 | Val  Acc: 0.8525
 Site-SVHN                      (3) | Val  Loss: 0.7055 | Val  Acc: 0.8261
 Site-SVHN                      (3) | Val  Loss: 0.7008 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8635
============ Train epoch 39 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5074, powerC: 0.4926
 Site-MNIST                    | Train Loss: 0.1923 | Train Acc: 0.9407
 Site-MNIST                    | Train Loss: 0.2476 | Train Acc: 0.9300
 Site-USPS                     | Train Loss: 0.2650 | Train Acc: 0.9164
 Site-USPS                     | Train Loss: 0.2726 | Train Acc: 0.9211
 Site-SynthDigits              | Train Loss: 0.3931 | Train Acc: 0.8841
 Site-SynthDigits              | Train Loss: 0.3420 | Train Acc: 0.9031
 Site-MNIST-M                  | Train Loss: 0.5593 | Train Acc: 0.8113
 Site-MNIST-M                  | Train Loss: 0.5073 | Train Acc: 0.8502
 Site-SVHN                     | Train Loss: 0.8101 | Train Acc: 0.7116
 Site-SVHN                     | Train Loss: 0.6683 | Train Acc: 0.7946
 Site-MNIST                     (1) | Val  Loss: 0.1708 | Val  Acc: 0.9674
 Site-MNIST                     (1) | Val  Loss: 0.2504 | Val  Acc: 0.9496
 Site-USPS                      (3) | Val  Loss: 0.3795 | Val  Acc: 0.8696
 Site-USPS                      (3) | Val  Loss: 0.3053 | Val  Acc: 0.8921
 Site-SynthDigits               (4) | Val  Loss: 0.3745 | Val  Acc: 0.8587
 Site-SynthDigits               (4) | Val  Loss: 0.3543 | Val  Acc: 0.8741
 Site-MNIST-M                   (2) | Val  Loss: 0.5183 | Val  Acc: 0.8478
 Site-MNIST-M                   (2) | Val  Loss: 0.4789 | Val  Acc: 0.8597
 Site-SVHN                      (0) | Val  Loss: 0.7064 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6901 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8729
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9674
 Best site-MNIST                    (1)  | Epoch:39 | Val Acc: 0.9496
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.8696
 Best site-USPS                     (3)  | Epoch:39 | Val Acc: 0.8921
 Best site-SynthDigits              (4)  | Epoch:39 | Val Acc: 0.8587
 Best site-SynthDigits              (4)  | Epoch:39 | Val Acc: 0.8741
 Best site-MNIST-M                  (2)  | Epoch:39 | Val Acc: 0.8478
 Best site-MNIST-M                  (2)  | Epoch:39 | Val Acc: 0.8597
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:39 | Val Acc: 0.7950
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
 Test site-MNIST                     (1)| Epoch:39 | Test Acc: 0.9347
 Test site-USPS                      (3)| Epoch:39 | Test Acc: 0.9280
 Test site-SynthDigits               (4)| Epoch:39 | Test Acc: 0.8878
 Test site-MNIST-M                   (2)| Epoch:39 | Test Acc: 0.7690
 Test site-MNIST-M                   (2)| Epoch:39 | Test Acc: 0.7690
 Test site-SVHN                      (0)| Epoch:39 | Test Acc: 0.7202
MNIST: 0.8242, USPS: 0.9280, SynthDigits: 0.8878, SVHN: 0.7202, 
Average Test Accuracy(group): 0.8400, Average Test Accuracy(individual): 0.8479,
domain CV=0.0934, cluster CV=0.1029, individual CV=0.1029, 
============ Train epoch 40 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5067, powerC: 0.4933
 Site-MNIST                    | Train Loss: 0.1873 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2518 | Train Acc: 0.9274
 Site-USPS                     | Train Loss: 0.2722 | Train Acc: 0.9164
 Site-USPS                     | Train Loss: 0.2647 | Train Acc: 0.9184
 Site-SynthDigits              | Train Loss: 0.3936 | Train Acc: 0.8814
 Site-SynthDigits              | Train Loss: 0.3410 | Train Acc: 0.9004
 Site-MNIST-M                  | Train Loss: 0.5621 | Train Acc: 0.8113
 Site-MNIST-M                  | Train Loss: 0.5001 | Train Acc: 0.8484
 Site-SVHN                     | Train Loss: 0.7981 | Train Acc: 0.7251
 Site-SVHN                     | Train Loss: 0.6592 | Train Acc: 0.8018
 Site-MNIST                     (3) | Val  Loss: 0.1735 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2519 | Val  Acc: 0.9460
 Site-USPS                      (2) | Val  Loss: 0.3785 | Val  Acc: 0.8696
 Site-USPS                      (2) | Val  Loss: 0.3057 | Val  Acc: 0.8921
 Site-SynthDigits               (0) | Val  Loss: 0.3731 | Val  Acc: 0.8478
 Site-SynthDigits               (0) | Val  Loss: 0.3567 | Val  Acc: 0.8669
 Site-MNIST-M                   (1) | Val  Loss: 0.5278 | Val  Acc: 0.8478
 Site-MNIST-M                   (1) | Val  Loss: 0.4801 | Val  Acc: 0.8561
 Site-SVHN                      (4) | Val  Loss: 0.6955 | Val  Acc: 0.8370
 Site-SVHN                      (4) | Val  Loss: 0.6780 | Val  Acc: 0.7986
Average Valid Accuracy: 0.8718
============ Train epoch 41 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5060, powerC: 0.4940
 Site-MNIST                    | Train Loss: 0.1824 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2399 | Train Acc: 0.9283
 Site-USPS                     | Train Loss: 0.2685 | Train Acc: 0.9164
 Site-USPS                     | Train Loss: 0.2550 | Train Acc: 0.9193
 Site-SynthDigits              | Train Loss: 0.3947 | Train Acc: 0.8760
 Site-SynthDigits              | Train Loss: 0.3418 | Train Acc: 0.9013
 Site-MNIST-M                  | Train Loss: 0.5631 | Train Acc: 0.8059
 Site-MNIST-M                  | Train Loss: 0.4999 | Train Acc: 0.8556
 Site-SVHN                     | Train Loss: 0.8057 | Train Acc: 0.7224
 Site-SVHN                     | Train Loss: 0.6457 | Train Acc: 0.7919
 Site-MNIST                     (0) | Val  Loss: 0.1624 | Val  Acc: 0.9457
 Site-MNIST                     (0) | Val  Loss: 0.2432 | Val  Acc: 0.9460
 Site-USPS                      (4) | Val  Loss: 0.3603 | Val  Acc: 0.8587
 Site-USPS                      (4) | Val  Loss: 0.2934 | Val  Acc: 0.8957
 Site-SynthDigits               (1) | Val  Loss: 0.3819 | Val  Acc: 0.8478
 Site-SynthDigits               (1) | Val  Loss: 0.3571 | Val  Acc: 0.8669
 Site-MNIST-M                   (3) | Val  Loss: 0.5235 | Val  Acc: 0.8587
 Site-MNIST-M                   (3) | Val  Loss: 0.4766 | Val  Acc: 0.8633
 Site-SVHN                      (2) | Val  Loss: 0.6846 | Val  Acc: 0.8261
 Site-SVHN                      (2) | Val  Loss: 0.6775 | Val  Acc: 0.8058
Average Valid Accuracy: 0.8715
============ Train epoch 42 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5054, powerC: 0.4946
 Site-MNIST                    | Train Loss: 0.1856 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.2450 | Train Acc: 0.9309
 Site-USPS                     | Train Loss: 0.2643 | Train Acc: 0.9164
 Site-USPS                     | Train Loss: 0.2491 | Train Acc: 0.9238
 Site-SynthDigits              | Train Loss: 0.3842 | Train Acc: 0.8841
 Site-SynthDigits              | Train Loss: 0.3343 | Train Acc: 0.9022
 Site-MNIST-M                  | Train Loss: 0.5716 | Train Acc: 0.8059
 Site-MNIST-M                  | Train Loss: 0.4862 | Train Acc: 0.8574
 Site-SVHN                     | Train Loss: 0.7958 | Train Acc: 0.7332
 Site-SVHN                     | Train Loss: 0.6481 | Train Acc: 0.8009
 Site-MNIST                     (2) | Val  Loss: 0.1577 | Val  Acc: 0.9674
 Site-MNIST                     (2) | Val  Loss: 0.2401 | Val  Acc: 0.9496
 Site-USPS                      (0) | Val  Loss: 0.3615 | Val  Acc: 0.8696
 Site-USPS                      (0) | Val  Loss: 0.2857 | Val  Acc: 0.9065
 Site-SynthDigits               (4) | Val  Loss: 0.3700 | Val  Acc: 0.8587
 Site-SynthDigits               (4) | Val  Loss: 0.3435 | Val  Acc: 0.8777
 Site-MNIST-M                   (1) | Val  Loss: 0.5184 | Val  Acc: 0.8370
 Site-MNIST-M                   (1) | Val  Loss: 0.4707 | Val  Acc: 0.8525
 Site-SVHN                      (3) | Val  Loss: 0.6922 | Val  Acc: 0.8261
 Site-SVHN                      (3) | Val  Loss: 0.6726 | Val  Acc: 0.8022
Average Valid Accuracy: 0.8747
 Best site-MNIST                    (2)  | Epoch:42 | Val Acc: 0.9674
 Best site-MNIST                    (2)  | Epoch:42 | Val Acc: 0.9496
 Best site-USPS                     (0)  | Epoch:42 | Val Acc: 0.8696
 Best site-USPS                     (0)  | Epoch:42 | Val Acc: 0.9065
 Best site-SynthDigits              (4)  | Epoch:42 | Val Acc: 0.8587
 Best site-SynthDigits              (4)  | Epoch:42 | Val Acc: 0.8777
 Best site-MNIST-M                  (1)  | Epoch:42 | Val Acc: 0.8370
 Best site-MNIST-M                  (1)  | Epoch:42 | Val Acc: 0.8525
 Best site-SVHN                     (3)  | Epoch:42 | Val Acc: 0.8261
 Best site-SVHN                     (3)  | Epoch:42 | Val Acc: 0.8022
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 43 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5048, powerC: 0.4952
 Site-MNIST                    | Train Loss: 0.1858 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.2493 | Train Acc: 0.9318
 Site-USPS                     | Train Loss: 0.2586 | Train Acc: 0.9191
 Site-USPS                     | Train Loss: 0.2574 | Train Acc: 0.9220
 Site-SynthDigits              | Train Loss: 0.3812 | Train Acc: 0.8841
 Site-SynthDigits              | Train Loss: 0.3334 | Train Acc: 0.9031
 Site-MNIST-M                  | Train Loss: 0.5603 | Train Acc: 0.8005
 Site-MNIST-M                  | Train Loss: 0.4850 | Train Acc: 0.8556
 Site-SVHN                     | Train Loss: 0.7868 | Train Acc: 0.7332
 Site-SVHN                     | Train Loss: 0.6425 | Train Acc: 0.7982
 Site-MNIST                     (0) | Val  Loss: 0.1616 | Val  Acc: 0.9674
 Site-MNIST                     (0) | Val  Loss: 0.2437 | Val  Acc: 0.9460
 Site-USPS                      (3) | Val  Loss: 0.3698 | Val  Acc: 0.8696
 Site-USPS                      (3) | Val  Loss: 0.2942 | Val  Acc: 0.8957
 Site-SynthDigits               (1) | Val  Loss: 0.3623 | Val  Acc: 0.8804
 Site-SynthDigits               (1) | Val  Loss: 0.3421 | Val  Acc: 0.8849
 Site-MNIST-M                   (2) | Val  Loss: 0.5158 | Val  Acc: 0.8370
 Site-MNIST-M                   (2) | Val  Loss: 0.4666 | Val  Acc: 0.8525
 Site-SVHN                      (4) | Val  Loss: 0.6920 | Val  Acc: 0.8043
 Site-SVHN                      (4) | Val  Loss: 0.6648 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8733
============ Train epoch 44 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5044, powerC: 0.4956
 Site-MNIST                    | Train Loss: 0.1798 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.2334 | Train Acc: 0.9345
 Site-USPS                     | Train Loss: 0.2532 | Train Acc: 0.9191
 Site-USPS                     | Train Loss: 0.2461 | Train Acc: 0.9220
 Site-SynthDigits              | Train Loss: 0.3896 | Train Acc: 0.8706
 Site-SynthDigits              | Train Loss: 0.3322 | Train Acc: 0.9085
 Site-MNIST-M                  | Train Loss: 0.5626 | Train Acc: 0.8140
 Site-MNIST-M                  | Train Loss: 0.4798 | Train Acc: 0.8628
 Site-SVHN                     | Train Loss: 0.8154 | Train Acc: 0.7116
 Site-SVHN                     | Train Loss: 0.6323 | Train Acc: 0.7973
 Site-MNIST                     (3) | Val  Loss: 0.1588 | Val  Acc: 0.9674
 Site-MNIST                     (3) | Val  Loss: 0.2382 | Val  Acc: 0.9460
 Site-USPS                      (0) | Val  Loss: 0.3495 | Val  Acc: 0.8478
 Site-USPS                      (0) | Val  Loss: 0.2793 | Val  Acc: 0.8921
 Site-SynthDigits               (2) | Val  Loss: 0.3738 | Val  Acc: 0.8587
 Site-SynthDigits               (2) | Val  Loss: 0.3432 | Val  Acc: 0.8705
 Site-MNIST-M                   (1) | Val  Loss: 0.5028 | Val  Acc: 0.8696
 Site-MNIST-M                   (1) | Val  Loss: 0.4577 | Val  Acc: 0.8705
 Site-SVHN                      (4) | Val  Loss: 0.6733 | Val  Acc: 0.8043
 Site-SVHN                      (4) | Val  Loss: 0.6764 | Val  Acc: 0.7842
Average Valid Accuracy: 0.8711
============ Train epoch 45 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5039, powerC: 0.4961
 Site-MNIST                    | Train Loss: 0.1805 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2368 | Train Acc: 0.9291
 Site-USPS                     | Train Loss: 0.2527 | Train Acc: 0.9272
 Site-USPS                     | Train Loss: 0.2587 | Train Acc: 0.9184
 Site-SynthDigits              | Train Loss: 0.3741 | Train Acc: 0.8814
 Site-SynthDigits              | Train Loss: 0.3245 | Train Acc: 0.9130
 Site-MNIST-M                  | Train Loss: 0.5395 | Train Acc: 0.8113
 Site-MNIST-M                  | Train Loss: 0.4792 | Train Acc: 0.8601
 Site-SVHN                     | Train Loss: 0.7862 | Train Acc: 0.7358
 Site-SVHN                     | Train Loss: 0.6242 | Train Acc: 0.8090
 Site-MNIST                     (1) | Val  Loss: 0.1585 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2380 | Val  Acc: 0.9460
 Site-USPS                      (3) | Val  Loss: 0.3613 | Val  Acc: 0.8696
 Site-USPS                      (3) | Val  Loss: 0.2848 | Val  Acc: 0.8957
 Site-SynthDigits               (0) | Val  Loss: 0.3514 | Val  Acc: 0.8587
 Site-SynthDigits               (0) | Val  Loss: 0.3315 | Val  Acc: 0.8777
 Site-MNIST-M                   (2) | Val  Loss: 0.4977 | Val  Acc: 0.8804
 Site-MNIST-M                   (2) | Val  Loss: 0.4498 | Val  Acc: 0.8705
 Site-SVHN                      (4) | Val  Loss: 0.6634 | Val  Acc: 0.7935
 Site-SVHN                      (4) | Val  Loss: 0.6550 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8740
 Test site-MNIST                     (1)| Epoch:42 | Test Acc: 0.9371
 Test site-USPS                      (3)| Epoch:42 | Test Acc: 0.9355
 Test site-SynthDigits               (0)| Epoch:42 | Test Acc: 0.8944
 Test site-MNIST-M                   (2)| Epoch:42 | Test Acc: 0.7726
 Test site-MNIST-M                   (2)| Epoch:42 | Test Acc: 0.7726
 Test site-SVHN                      (4)| Epoch:42 | Test Acc: 0.7242
MNIST: 0.8274, USPS: 0.9355, SynthDigits: 0.8944, SVHN: 0.7242, 
Average Test Accuracy(group): 0.8454, Average Test Accuracy(individual): 0.8528,
domain CV=0.0945, cluster CV=0.1031, individual CV=0.1031, 
Average Test Accuracy: 0.8454
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 46 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5035, powerC: 0.4965
 Site-MNIST                    | Train Loss: 0.1770 | Train Acc: 0.9380
 Site-MNIST                    | Train Loss: 0.2344 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.2506 | Train Acc: 0.9272
 Site-USPS                     | Train Loss: 0.2489 | Train Acc: 0.9238
 Site-SynthDigits              | Train Loss: 0.3763 | Train Acc: 0.8787
 Site-SynthDigits              | Train Loss: 0.3266 | Train Acc: 0.9103
 Site-MNIST-M                  | Train Loss: 0.5403 | Train Acc: 0.8167
 Site-MNIST-M                  | Train Loss: 0.4654 | Train Acc: 0.8628
 Site-SVHN                     | Train Loss: 0.7832 | Train Acc: 0.7197
 Site-SVHN                     | Train Loss: 0.6185 | Train Acc: 0.8072
 Site-MNIST                     (1) | Val  Loss: 0.1609 | Val  Acc: 0.9674
 Site-MNIST                     (1) | Val  Loss: 0.2330 | Val  Acc: 0.9496
 Site-USPS                      (0) | Val  Loss: 0.3517 | Val  Acc: 0.8587
 Site-USPS                      (0) | Val  Loss: 0.2734 | Val  Acc: 0.9029
 Site-SynthDigits               (3) | Val  Loss: 0.3486 | Val  Acc: 0.8804
 Site-SynthDigits               (3) | Val  Loss: 0.3313 | Val  Acc: 0.8849
 Site-MNIST-M                   (2) | Val  Loss: 0.4913 | Val  Acc: 0.8587
 Site-MNIST-M                   (2) | Val  Loss: 0.4445 | Val  Acc: 0.8741
 Site-SVHN                      (4) | Val  Loss: 0.6485 | Val  Acc: 0.7935
 Site-SVHN                      (4) | Val  Loss: 0.6566 | Val  Acc: 0.7734
Average Valid Accuracy: 0.8744
 Test site-MNIST                     (1)| Epoch:45 | Test Acc: 0.9381
 Test site-USPS                      (0)| Epoch:45 | Test Acc: 0.9344
 Test site-SynthDigits               (3)| Epoch:45 | Test Acc: 0.8934
 Test site-MNIST-M                   (2)| Epoch:45 | Test Acc: 0.7737
 Test site-MNIST-M                   (2)| Epoch:45 | Test Acc: 0.7737
 Test site-SVHN                      (4)| Epoch:45 | Test Acc: 0.7285
MNIST: 0.8285, USPS: 0.9344, SynthDigits: 0.8934, SVHN: 0.7285, 
Average Test Accuracy(group): 0.8462, Average Test Accuracy(individual): 0.8536,
domain CV=0.0919, cluster CV=0.1012, individual CV=0.1012, 
Average Test Accuracy: 0.8462
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 47 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5032, powerC: 0.4968
 Site-MNIST                    | Train Loss: 0.1663 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2237 | Train Acc: 0.9336
 Site-USPS                     | Train Loss: 0.2560 | Train Acc: 0.9272
 Site-USPS                     | Train Loss: 0.2453 | Train Acc: 0.9256
 Site-SynthDigits              | Train Loss: 0.3630 | Train Acc: 0.8868
 Site-SynthDigits              | Train Loss: 0.3116 | Train Acc: 0.9139
 Site-MNIST-M                  | Train Loss: 0.5301 | Train Acc: 0.8275
 Site-MNIST-M                  | Train Loss: 0.4672 | Train Acc: 0.8664
 Site-SVHN                     | Train Loss: 0.7781 | Train Acc: 0.7332
 Site-SVHN                     | Train Loss: 0.6153 | Train Acc: 0.8054
 Site-MNIST                     (2) | Val  Loss: 0.1562 | Val  Acc: 0.9674
 Site-MNIST                     (2) | Val  Loss: 0.2256 | Val  Acc: 0.9496
 Site-USPS                      (1) | Val  Loss: 0.3585 | Val  Acc: 0.8696
 Site-USPS                      (1) | Val  Loss: 0.2766 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3394 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3245 | Val  Acc: 0.8813
 Site-MNIST-M                   (3) | Val  Loss: 0.4913 | Val  Acc: 0.8696
 Site-MNIST-M                   (3) | Val  Loss: 0.4405 | Val  Acc: 0.8705
 Site-SVHN                      (0) | Val  Loss: 0.6540 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6499 | Val  Acc: 0.7914
Average Valid Accuracy: 0.8794
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9674
 Best site-MNIST                    (2)  | Epoch:47 | Val Acc: 0.9496
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.8696
 Best site-USPS                     (1)  | Epoch:47 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:47 | Val Acc: 0.8696
 Best site-SynthDigits              (4)  | Epoch:47 | Val Acc: 0.8813
 Best site-MNIST-M                  (3)  | Epoch:47 | Val Acc: 0.8696
 Best site-MNIST-M                  (3)  | Epoch:47 | Val Acc: 0.8705
 Best site-SVHN                     (0)  | Epoch:47 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:47 | Val Acc: 0.7914
 Test site-MNIST                     (2)| Epoch:47 | Test Acc: 0.9403
 Test site-USPS                      (1)| Epoch:47 | Test Acc: 0.9398
 Test site-SynthDigits               (4)| Epoch:47 | Test Acc: 0.8956
 Test site-MNIST-M                   (3)| Epoch:47 | Test Acc: 0.7727
 Test site-MNIST-M                   (3)| Epoch:47 | Test Acc: 0.7727
 Test site-SVHN                      (0)| Epoch:47 | Test Acc: 0.7270
MNIST: 0.8286, USPS: 0.9398, SynthDigits: 0.8956, SVHN: 0.7270, 
Average Test Accuracy(group): 0.8477, Average Test Accuracy(individual): 0.8551,
domain CV=0.0946, cluster CV=0.1036, individual CV=0.1036, 
Average Test Accuracy: 0.8477
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 48 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5029, powerC: 0.4971
 Site-MNIST                    | Train Loss: 0.1731 | Train Acc: 0.9434
 Site-MNIST                    | Train Loss: 0.2290 | Train Acc: 0.9318
 Site-USPS                     | Train Loss: 0.2517 | Train Acc: 0.9218
 Site-USPS                     | Train Loss: 0.2468 | Train Acc: 0.9238
 Site-SynthDigits              | Train Loss: 0.3639 | Train Acc: 0.8841
 Site-SynthDigits              | Train Loss: 0.3058 | Train Acc: 0.9175
 Site-MNIST-M                  | Train Loss: 0.5396 | Train Acc: 0.8275
 Site-MNIST-M                  | Train Loss: 0.4665 | Train Acc: 0.8655
 Site-SVHN                     | Train Loss: 0.7750 | Train Acc: 0.7358
 Site-SVHN                     | Train Loss: 0.6104 | Train Acc: 0.8099
 Site-MNIST                     (3) | Val  Loss: 0.1621 | Val  Acc: 0.9565
 Site-MNIST                     (3) | Val  Loss: 0.2311 | Val  Acc: 0.9496
 Site-USPS                      (1) | Val  Loss: 0.3545 | Val  Acc: 0.8587
 Site-USPS                      (1) | Val  Loss: 0.2763 | Val  Acc: 0.8993
 Site-SynthDigits               (4) | Val  Loss: 0.3382 | Val  Acc: 0.8696
 Site-SynthDigits               (4) | Val  Loss: 0.3181 | Val  Acc: 0.8813
 Site-MNIST-M                   (0) | Val  Loss: 0.4854 | Val  Acc: 0.8804
 Site-MNIST-M                   (0) | Val  Loss: 0.4419 | Val  Acc: 0.8705
 Site-SVHN                      (2) | Val  Loss: 0.6473 | Val  Acc: 0.7826
 Site-SVHN                      (2) | Val  Loss: 0.6383 | Val  Acc: 0.7806
Average Valid Accuracy: 0.8729
 Test site-MNIST                     (3)| Epoch:47 | Test Acc: 0.9391
 Test site-USPS                      (1)| Epoch:47 | Test Acc: 0.9387
 Test site-SynthDigits               (4)| Epoch:47 | Test Acc: 0.8963
 Test site-MNIST-M                   (0)| Epoch:47 | Test Acc: 0.7734
 Test site-MNIST-M                   (0)| Epoch:47 | Test Acc: 0.7734
 Test site-SVHN                      (2)| Epoch:47 | Test Acc: 0.7297
MNIST: 0.8287, USPS: 0.9387, SynthDigits: 0.8963, SVHN: 0.7297, 
Average Test Accuracy(group): 0.8483, Average Test Accuracy(individual): 0.8554,
domain CV=0.0931, cluster CV=0.1021, individual CV=0.1021, 
Average Test Accuracy: 0.8483
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
============ Train epoch 49 ============
cnt=[2, 2, 2, 2, 2, ]
power_decay: 0.9, powerI: 0.5026, powerC: 0.4974
 Site-MNIST                    | Train Loss: 0.1709 | Train Acc: 0.9461
 Site-MNIST                    | Train Loss: 0.2294 | Train Acc: 0.9309
 Site-USPS                     | Train Loss: 0.2396 | Train Acc: 0.9191
 Site-USPS                     | Train Loss: 0.2371 | Train Acc: 0.9318
 Site-SynthDigits              | Train Loss: 0.3591 | Train Acc: 0.8868
 Site-SynthDigits              | Train Loss: 0.3092 | Train Acc: 0.9130
 Site-MNIST-M                  | Train Loss: 0.5303 | Train Acc: 0.8221
 Site-MNIST-M                  | Train Loss: 0.4563 | Train Acc: 0.8619
 Site-SVHN                     | Train Loss: 0.7672 | Train Acc: 0.7385
 Site-SVHN                     | Train Loss: 0.6018 | Train Acc: 0.8090
 Site-MNIST                     (1) | Val  Loss: 0.1657 | Val  Acc: 0.9565
 Site-MNIST                     (1) | Val  Loss: 0.2282 | Val  Acc: 0.9496
 Site-USPS                      (3) | Val  Loss: 0.3481 | Val  Acc: 0.8587
 Site-USPS                      (3) | Val  Loss: 0.2695 | Val  Acc: 0.9101
 Site-SynthDigits               (4) | Val  Loss: 0.3350 | Val  Acc: 0.8913
 Site-SynthDigits               (4) | Val  Loss: 0.3171 | Val  Acc: 0.8849
 Site-MNIST-M                   (2) | Val  Loss: 0.4881 | Val  Acc: 0.8696
 Site-MNIST-M                   (2) | Val  Loss: 0.4377 | Val  Acc: 0.8669
 Site-SVHN                      (0) | Val  Loss: 0.6391 | Val  Acc: 0.8152
 Site-SVHN                      (0) | Val  Loss: 0.6294 | Val  Acc: 0.7950
Average Valid Accuracy: 0.8798
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9565
 Best site-MNIST                    (1)  | Epoch:49 | Val Acc: 0.9496
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.8587
 Best site-USPS                     (3)  | Epoch:49 | Val Acc: 0.9101
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.8913
 Best site-SynthDigits              (4)  | Epoch:49 | Val Acc: 0.8849
 Best site-MNIST-M                  (2)  | Epoch:49 | Val Acc: 0.8696
 Best site-MNIST-M                  (2)  | Epoch:49 | Val Acc: 0.8669
 Best site-SVHN                     (0)  | Epoch:49 | Val Acc: 0.8152
 Best site-SVHN                     (0)  | Epoch:49 | Val Acc: 0.7950
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9387
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9419
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.8970
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-SVHN                      (0)| Epoch:49 | Test Acc: 0.7286
MNIST: 0.8285, USPS: 0.9419, SynthDigits: 0.8970, SVHN: 0.7286, 
Average Test Accuracy(group): 0.8490, Average Test Accuracy(individual): 0.8559,
domain CV=0.0947, cluster CV=0.1031, individual CV=0.1031, 
Average Test Accuracy: 0.8490
 Saving the gmap checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1_gmap...
 Saving the local and server checkpoint to ../checkpoint/fed_digit_even_1.0_1_cb/ccop_q=1...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9387
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9419
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.8970
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-SVHN                      (0)| Epoch:49 | Test Acc: 0.7286
MNIST: 0.8285, USPS: 0.9419, SynthDigits: 0.8970, SVHN: 0.7286, 
Average Test Accuracy(group): 0.8490, Average Test Accuracy(individual): 0.8559,
domain CV=0.0947, cluster CV=0.1031, individual CV=0.1031, 
===2023-06-11 05:32:26===
===2023-06-11 05:32:45===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: 5
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
data_number=[371,1115,371,1115,371,1115,371,1115,371,1115,
client_nums=[2,2,2,2,2,]
len_dataset=[1859,1859,1859,1859,1859,]
domain number = 5
Loading snapshots...
 Test site-MNIST                     (1)| Epoch:49 | Test Acc: 0.9387
 Test site-USPS                      (3)| Epoch:49 | Test Acc: 0.9419
 Test site-SynthDigits               (4)| Epoch:49 | Test Acc: 0.8970
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-MNIST-M                   (2)| Epoch:49 | Test Acc: 0.7734
 Test site-SVHN                      (0)| Epoch:49 | Test Acc: 0.7286
MNIST: 0.8285, USPS: 0.9419, SynthDigits: 0.8970, SVHN: 0.7286, 
Average Test Accuracy(group): 0.8490, Average Test Accuracy(individual): 0.8559,
domain CV=0.0947, cluster CV=0.1031, individual CV=0.1031, 
