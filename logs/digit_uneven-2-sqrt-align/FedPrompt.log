===2023-03-29 08:46:50===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round Site-MNIST     | Train Loss: 1.6705 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.5788 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6047 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5178 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6337 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2496 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.1726 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.6955 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 2.1175 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1969 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.5127 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.5497 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6077 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6397 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.5640 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1845 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2050 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7156 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1072 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2167 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4695
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
only align at first round Site-MNIST     | Train Loss: 1.1534 | Train Acc: 0.6932
 Site-MNIST     | Train Loss: 1.0563 | Train Acc: 0.7273
 Site-MNIST     | Train Loss: 1.0950 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 0.9656 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1092 | Train Acc: 0.7045
 Site-SVHN      | Train Loss: 2.1956 | Train Acc: 0.1818
 Site-SVHN      | Train Loss: 1.9994 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.2312 | Train Acc: 0.7500
 Site-SynthDigits| Train Loss: 1.8670 | Train Acc: 0.3864
 Site-MNIST-M   | Train Loss: 2.0383 | Train Acc: 0.2500
 Site-MNIST     | Val  Loss: 0.9289 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0085 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.0935 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.1123 | Val  Acc: 0.7288
 Site-MNIST     | Val  Loss: 1.0382 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.0650 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.0989 | Val  Acc: 0.1864
 Site-USPS      | Val  Loss: 1.2521 | Val  Acc: 0.7288
 Site-SynthDigits| Val  Loss: 1.9266 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.0752 | Val  Acc: 0.2034
Average Valid Accuracy: 0.5407
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7288
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.1864
 Best site-USPS       | Epoch:1 | Val Acc: 0.7288
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2034
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 10 ============
===2023-03-29 08:55:54===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 16
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
============ Train epoch 0 ============
============ Train epoch 1 ============
============ Train epoch 2 ============
============ Train epoch 3 ============
============ Train epoch 4 ============
only align at first round
 Site-MNIST     | Train Loss: 1.6705 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.5788 | Train Acc: 0.6364
 Site-MNIST     | Train Loss: 1.6047 | Train Acc: 0.6591
 Site-MNIST     | Train Loss: 1.5178 | Train Acc: 0.6477
 Site-MNIST     | Train Loss: 1.6337 | Train Acc: 0.6591
 Site-SVHN      | Train Loss: 2.2496 | Train Acc: 0.1591
 Site-SVHN      | Train Loss: 2.1726 | Train Acc: 0.1932
 Site-USPS      | Train Loss: 1.6955 | Train Acc: 0.5795
 Site-SynthDigits| Train Loss: 2.1175 | Train Acc: 0.2500
 Site-MNIST-M   | Train Loss: 2.1969 | Train Acc: 0.2159
 Site-MNIST     | Val  Loss: 1.5127 | Val  Acc: 0.6949
 Site-MNIST     | Val  Loss: 1.5497 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6077 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.6397 | Val  Acc: 0.5932
 Site-MNIST     | Val  Loss: 1.5640 | Val  Acc: 0.7119
 Site-SVHN      | Val  Loss: 2.1845 | Val  Acc: 0.2203
 Site-SVHN      | Val  Loss: 2.2050 | Val  Acc: 0.1356
 Site-USPS      | Val  Loss: 1.7156 | Val  Acc: 0.5763
 Site-SynthDigits| Val  Loss: 2.1072 | Val  Acc: 0.3051
 Site-MNIST-M   | Val  Loss: 2.2167 | Val  Acc: 0.1695
Average Valid Accuracy: 0.4695
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6949
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:0 | Val Acc: 0.5932
 Best site-MNIST      | Epoch:0 | Val Acc: 0.7119
 Best site-SVHN       | Epoch:0 | Val Acc: 0.2203
 Best site-SVHN       | Epoch:0 | Val Acc: 0.1356
 Best site-USPS       | Epoch:0 | Val Acc: 0.5763
 Best site-SynthDigits | Epoch:0 | Val Acc: 0.3051
 Best site-MNIST-M    | Epoch:0 | Val Acc: 0.1695
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 5 ============
============ Train epoch 6 ============
============ Train epoch 7 ============
============ Train epoch 8 ============
============ Train epoch 9 ============
 Site-MNIST     | Train Loss: 1.1641 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 1.0662 | Train Acc: 0.7159
 Site-MNIST     | Train Loss: 1.1126 | Train Acc: 0.6818
 Site-MNIST     | Train Loss: 0.9818 | Train Acc: 0.7955
 Site-MNIST     | Train Loss: 1.1198 | Train Acc: 0.6932
 Site-SVHN      | Train Loss: 2.2071 | Train Acc: 0.1932
 Site-SVHN      | Train Loss: 2.0026 | Train Acc: 0.2614
 Site-USPS      | Train Loss: 1.2335 | Train Acc: 0.6932
 Site-SynthDigits| Train Loss: 1.8670 | Train Acc: 0.4205
 Site-MNIST-M   | Train Loss: 2.0383 | Train Acc: 0.2386
 Site-MNIST     | Val  Loss: 0.9459 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 1.0250 | Val  Acc: 0.7458
 Site-MNIST     | Val  Loss: 1.1123 | Val  Acc: 0.6441
 Site-MNIST     | Val  Loss: 1.1200 | Val  Acc: 0.7119
 Site-MNIST     | Val  Loss: 1.0517 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 2.0653 | Val  Acc: 0.2712
 Site-SVHN      | Val  Loss: 2.1076 | Val  Acc: 0.2034
 Site-USPS      | Val  Loss: 1.2622 | Val  Acc: 0.6271
 Site-SynthDigits| Val  Loss: 1.9349 | Val  Acc: 0.3390
 Site-MNIST-M   | Val  Loss: 2.0769 | Val  Acc: 0.2203
Average Valid Accuracy: 0.5305
 Best site-MNIST      | Epoch:1 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7458
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6441
 Best site-MNIST      | Epoch:1 | Val Acc: 0.7119
 Best site-MNIST      | Epoch:1 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2712
 Best site-SVHN       | Epoch:1 | Val Acc: 0.2034
 Best site-USPS       | Epoch:1 | Val Acc: 0.6271
 Best site-SynthDigits | Epoch:1 | Val Acc: 0.3390
 Best site-MNIST-M    | Epoch:1 | Val Acc: 0.2203
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 10 ============
============ Train epoch 11 ============
============ Train epoch 12 ============
============ Train epoch 13 ============
============ Train epoch 14 ============
 Site-MNIST     | Train Loss: 0.7253 | Train Acc: 0.7614
 Site-MNIST     | Train Loss: 0.6955 | Train Acc: 0.8068
 Site-MNIST     | Train Loss: 0.6838 | Train Acc: 0.8523
 Site-MNIST     | Train Loss: 0.5816 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.6923 | Train Acc: 0.8182
 Site-SVHN      | Train Loss: 2.0721 | Train Acc: 0.2500
 Site-SVHN      | Train Loss: 1.8234 | Train Acc: 0.3977
 Site-USPS      | Train Loss: 0.8092 | Train Acc: 0.8523
 Site-SynthDigits| Train Loss: 1.6570 | Train Acc: 0.4432
 Site-MNIST-M   | Train Loss: 1.8211 | Train Acc: 0.3523
 Site-MNIST     | Val  Loss: 0.5249 | Val  Acc: 0.8983
 Site-MNIST     | Val  Loss: 0.6144 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.6811 | Val  Acc: 0.8475
 Site-MNIST     | Val  Loss: 0.7380 | Val  Acc: 0.8136
 Site-MNIST     | Val  Loss: 0.6786 | Val  Acc: 0.7627
 Site-SVHN      | Val  Loss: 1.8921 | Val  Acc: 0.3729
 Site-SVHN      | Val  Loss: 1.9257 | Val  Acc: 0.3559
 Site-USPS      | Val  Loss: 0.8327 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.6992 | Val  Acc: 0.4068
 Site-MNIST-M   | Val  Loss: 1.8851 | Val  Acc: 0.3220
Average Valid Accuracy: 0.6525
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8983
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8475
 Best site-MNIST      | Epoch:2 | Val Acc: 0.8136
 Best site-MNIST      | Epoch:2 | Val Acc: 0.7627
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3729
 Best site-SVHN       | Epoch:2 | Val Acc: 0.3559
 Best site-USPS       | Epoch:2 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:2 | Val Acc: 0.4068
 Best site-MNIST-M    | Epoch:2 | Val Acc: 0.3220
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 15 ============
============ Train epoch 16 ============
============ Train epoch 17 ============
============ Train epoch 18 ============
============ Train epoch 19 ============
 Site-MNIST     | Train Loss: 0.5094 | Train Acc: 0.8295
 Site-MNIST     | Train Loss: 0.4846 | Train Acc: 0.8636
 Site-MNIST     | Train Loss: 0.4863 | Train Acc: 0.8977
 Site-MNIST     | Train Loss: 0.3645 | Train Acc: 0.9432
 Site-MNIST     | Train Loss: 0.4601 | Train Acc: 0.8750
 Site-SVHN      | Train Loss: 1.9711 | Train Acc: 0.3409
 Site-SVHN      | Train Loss: 1.6654 | Train Acc: 0.4318
 Site-USPS      | Train Loss: 0.5455 | Train Acc: 0.8977
 Site-SynthDigits| Train Loss: 1.4231 | Train Acc: 0.5000
 Site-MNIST-M   | Train Loss: 1.6593 | Train Acc: 0.4432
 Site-MNIST     | Val  Loss: 0.3514 | Val  Acc: 0.9322
 Site-MNIST     | Val  Loss: 0.3877 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.4810 | Val  Acc: 0.8814
 Site-MNIST     | Val  Loss: 0.5090 | Val  Acc: 0.8644
 Site-MNIST     | Val  Loss: 0.4854 | Val  Acc: 0.8136
 Site-SVHN      | Val  Loss: 1.6972 | Val  Acc: 0.4237
 Site-SVHN      | Val  Loss: 1.7907 | Val  Acc: 0.4068
 Site-USPS      | Val  Loss: 0.6055 | Val  Acc: 0.8644
 Site-SynthDigits| Val  Loss: 1.5833 | Val  Acc: 0.4746
 Site-MNIST-M   | Val  Loss: 1.7593 | Val  Acc: 0.4068
Average Valid Accuracy: 0.7017
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9322
 Best site-MNIST      | Epoch:3 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8814
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8644
 Best site-MNIST      | Epoch:3 | Val Acc: 0.8136
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4237
 Best site-SVHN       | Epoch:3 | Val Acc: 0.4068
 Best site-USPS       | Epoch:3 | Val Acc: 0.8644
 Best site-SynthDigits | Epoch:3 | Val Acc: 0.4746
 Best site-MNIST-M    | Epoch:3 | Val Acc: 0.4068
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 20 ============
============ Train epoch 21 ============
============ Train epoch 22 ============
============ Train epoch 23 ============
============ Train epoch 24 ============
 Site-MNIST     | Train Loss: 0.2321 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2530 | Train Acc: 0.9318
 Site-MNIST     | Train Loss: 0.2316 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1737 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.2656 | Train Acc: 0.9432
 Site-SVHN      | Train Loss: 1.7222 | Train Acc: 0.4091
 Site-SVHN      | Train Loss: 1.4570 | Train Acc: 0.5114
 Site-USPS      | Train Loss: 0.4289 | Train Acc: 0.9091
 Site-SynthDigits| Train Loss: 1.2521 | Train Acc: 0.6023
 Site-MNIST-M   | Train Loss: 1.4150 | Train Acc: 0.5568
 Site-MNIST     | Val  Loss: 0.1725 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.1849 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2462 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2529 | Val  Acc: 0.9492
 Site-MNIST     | Val  Loss: 0.2608 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.5018 | Val  Acc: 0.5085
 Site-SVHN      | Val  Loss: 1.6061 | Val  Acc: 0.4746
 Site-USPS      | Val  Loss: 0.4682 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.4590 | Val  Acc: 0.5085
 Site-MNIST-M   | Val  Loss: 1.5407 | Val  Acc: 0.5424
Average Valid Accuracy: 0.7746
 Best site-MNIST      | Epoch:4 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9492
 Best site-MNIST      | Epoch:4 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:4 | Val Acc: 0.5085
 Best site-SVHN       | Epoch:4 | Val Acc: 0.4746
 Best site-USPS       | Epoch:4 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:4 | Val Acc: 0.5085
 Best site-MNIST-M    | Epoch:4 | Val Acc: 0.5424
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 25 ============
============ Train epoch 26 ============
============ Train epoch 27 ============
============ Train epoch 28 ============
============ Train epoch 29 ============
 Site-MNIST     | Train Loss: 0.2181 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.2278 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1994 | Train Acc: 0.9545
 Site-MNIST     | Train Loss: 0.1539 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.2122 | Train Acc: 0.9545
 Site-SVHN      | Train Loss: 1.3590 | Train Acc: 0.6023
 Site-SVHN      | Train Loss: 1.1905 | Train Acc: 0.6932
 Site-USPS      | Train Loss: 0.2738 | Train Acc: 0.9545
 Site-SynthDigits| Train Loss: 0.9938 | Train Acc: 0.6932
 Site-MNIST-M   | Train Loss: 1.0525 | Train Acc: 0.7045
 Site-MNIST     | Val  Loss: 0.1489 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1551 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2168 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.2086 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.2371 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 1.2066 | Val  Acc: 0.6949
 Site-SVHN      | Val  Loss: 1.2596 | Val  Acc: 0.6102
 Site-USPS      | Val  Loss: 0.3502 | Val  Acc: 0.8814
 Site-SynthDigits| Val  Loss: 1.2379 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 1.3428 | Val  Acc: 0.6102
Average Valid Accuracy: 0.8203
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:5 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6949
 Best site-SVHN       | Epoch:5 | Val Acc: 0.6102
 Best site-USPS       | Epoch:5 | Val Acc: 0.8814
 Best site-SynthDigits | Epoch:5 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:5 | Val Acc: 0.6102
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 30 ============
============ Train epoch 31 ============
============ Train epoch 32 ============
============ Train epoch 33 ============
============ Train epoch 34 ============
 Site-MNIST     | Train Loss: 0.1233 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1220 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.1269 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0749 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1279 | Train Acc: 0.9773
 Site-SVHN      | Train Loss: 1.3664 | Train Acc: 0.5568
 Site-SVHN      | Train Loss: 0.9923 | Train Acc: 0.7045
 Site-USPS      | Train Loss: 0.2512 | Train Acc: 0.9318
 Site-SynthDigits| Train Loss: 0.9334 | Train Acc: 0.7045
 Site-MNIST-M   | Train Loss: 0.8770 | Train Acc: 0.7614
 Site-MNIST     | Val  Loss: 0.0812 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0823 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1412 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1179 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1427 | Val  Acc: 0.9831
 Site-SVHN      | Val  Loss: 1.0663 | Val  Acc: 0.6780
 Site-SVHN      | Val  Loss: 1.1910 | Val  Acc: 0.6441
 Site-USPS      | Val  Loss: 0.2892 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.3505 | Val  Acc: 0.5424
 Site-MNIST-M   | Val  Loss: 1.2334 | Val  Acc: 0.6610
Average Valid Accuracy: 0.8390
 Best site-MNIST      | Epoch:6 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:6 | Val Acc: 0.9831
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6780
 Best site-SVHN       | Epoch:6 | Val Acc: 0.6441
 Best site-USPS       | Epoch:6 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:6 | Val Acc: 0.5424
 Best site-MNIST-M    | Epoch:6 | Val Acc: 0.6610
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 35 ============
============ Train epoch 36 ============
============ Train epoch 37 ============
============ Train epoch 38 ============
============ Train epoch 39 ============
 Site-MNIST     | Train Loss: 0.1157 | Train Acc: 0.9773
 Site-MNIST     | Train Loss: 0.0966 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.1025 | Train Acc: 0.9659
 Site-MNIST     | Train Loss: 0.0636 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.1072 | Train Acc: 0.9659
 Site-SVHN      | Train Loss: 0.9803 | Train Acc: 0.7159
 Site-SVHN      | Train Loss: 0.8055 | Train Acc: 0.7727
 Site-USPS      | Train Loss: 0.1700 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6872 | Train Acc: 0.8295
 Site-MNIST-M   | Train Loss: 0.5924 | Train Acc: 0.8864
 Site-MNIST     | Val  Loss: 0.0656 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0738 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1098 | Val  Acc: 0.9661
 Site-MNIST     | Val  Loss: 0.1003 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.1000 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.8509 | Val  Acc: 0.7797
 Site-SVHN      | Val  Loss: 0.9234 | Val  Acc: 0.7119
 Site-USPS      | Val  Loss: 0.2400 | Val  Acc: 0.9322
 Site-SynthDigits| Val  Loss: 1.1357 | Val  Acc: 0.6441
 Site-MNIST-M   | Val  Loss: 1.0087 | Val  Acc: 0.7288
Average Valid Accuracy: 0.8729
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9661
 Best site-MNIST      | Epoch:7 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:7 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7797
 Best site-SVHN       | Epoch:7 | Val Acc: 0.7119
 Best site-USPS       | Epoch:7 | Val Acc: 0.9322
 Best site-SynthDigits | Epoch:7 | Val Acc: 0.6441
 Best site-MNIST-M    | Epoch:7 | Val Acc: 0.7288
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 40 ============
============ Train epoch 41 ============
============ Train epoch 42 ============
============ Train epoch 43 ============
============ Train epoch 44 ============
 Site-MNIST     | Train Loss: 0.0563 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0660 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0581 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0346 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0692 | Train Acc: 0.9886
 Site-SVHN      | Train Loss: 0.8827 | Train Acc: 0.7273
 Site-SVHN      | Train Loss: 0.6234 | Train Acc: 0.8750
 Site-USPS      | Train Loss: 0.1805 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.6649 | Train Acc: 0.8182
 Site-MNIST-M   | Train Loss: 0.4148 | Train Acc: 0.9545
 Site-MNIST     | Val  Loss: 0.0366 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0374 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0655 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0671 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0704 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.6900 | Val  Acc: 0.8644
 Site-SVHN      | Val  Loss: 0.7771 | Val  Acc: 0.7797
 Site-USPS      | Val  Loss: 0.2441 | Val  Acc: 0.8983
 Site-SynthDigits| Val  Loss: 1.1844 | Val  Acc: 0.5763
 Site-MNIST-M   | Val  Loss: 0.9275 | Val  Acc: 0.7458
Average Valid Accuracy: 0.8847
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:8 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:8 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:8 | Val Acc: 0.8644
 Best site-SVHN       | Epoch:8 | Val Acc: 0.7797
 Best site-USPS       | Epoch:8 | Val Acc: 0.8983
 Best site-SynthDigits | Epoch:8 | Val Acc: 0.5763
 Best site-MNIST-M    | Epoch:8 | Val Acc: 0.7458
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
============ Train epoch 45 ============
============ Train epoch 46 ============
============ Train epoch 47 ============
============ Train epoch 48 ============
============ Train epoch 49 ============
 Site-MNIST     | Train Loss: 0.0605 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0416 | Train Acc: 0.9886
 Site-MNIST     | Train Loss: 0.0624 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0302 | Train Acc: 1.0000
 Site-MNIST     | Train Loss: 0.0448 | Train Acc: 1.0000
 Site-SVHN      | Train Loss: 0.5425 | Train Acc: 0.8977
 Site-SVHN      | Train Loss: 0.5304 | Train Acc: 0.9318
 Site-USPS      | Train Loss: 0.1370 | Train Acc: 0.9773
 Site-SynthDigits| Train Loss: 0.4976 | Train Acc: 0.8864
 Site-MNIST-M   | Train Loss: 0.3073 | Train Acc: 0.9773
 Site-MNIST     | Val  Loss: 0.0308 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0325 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0678 | Val  Acc: 1.0000
 Site-MNIST     | Val  Loss: 0.0428 | Val  Acc: 0.9831
 Site-MNIST     | Val  Loss: 0.0445 | Val  Acc: 1.0000
 Site-SVHN      | Val  Loss: 0.5484 | Val  Acc: 0.9322
 Site-SVHN      | Val  Loss: 0.5491 | Val  Acc: 0.9153
 Site-USPS      | Val  Loss: 0.1996 | Val  Acc: 0.9492
 Site-SynthDigits| Val  Loss: 1.0431 | Val  Acc: 0.6949
 Site-MNIST-M   | Val  Loss: 0.8634 | Val  Acc: 0.7627
Average Valid Accuracy: 0.9237
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-MNIST      | Epoch:9 | Val Acc: 0.9831
 Best site-MNIST      | Epoch:9 | Val Acc: 1.0000
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9322
 Best site-SVHN       | Epoch:9 | Val Acc: 0.9153
 Best site-USPS       | Epoch:9 | Val Acc: 0.9492
 Best site-SynthDigits | Epoch:9 | Val Acc: 0.6949
 Best site-MNIST-M    | Epoch:9 | Val Acc: 0.7627
 Saving the local and server checkpoint to ../checkpoint/fed_digit_uneven-2-sqrt-align/FedPrompt...
===2023-03-29 09:29:43===
===2023-03-29 09:29:44===
===Setting===
    dataset: digit
    lr: 0.01
    batch: 8
    iters: 10
    wk_iters: 5
    tune: False
    lambda for constrastive: 0.5
domain number = 3
Loading snapshots...
 Test site-MNIST     | Epoch:9 | Test Acc: 0.8964
 Test site-SVHN      | Epoch:9 | Test Acc: 0.3244
 Test site-USPS      | Epoch:9 | Test Acc: 0.8495
 Test site-SynthDigits| Epoch:9 | Test Acc: 0.4821
 Test site-MNIST-M   | Epoch:9 | Test Acc: 0.3700
Average Test Accuracy: 0.5845
