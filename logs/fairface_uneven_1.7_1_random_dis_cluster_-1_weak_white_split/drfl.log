===2023-06-16 05:17:07===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = -1
============ Train epoch 0 ============
 Site-White-0                       | Train Loss: 2.1066 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 2.1088 | Train Acc: 0.3595
 Site-White-2                       | Train Loss: 2.1169 | Train Acc: 0.3293
 Site-White-3                       | Train Loss: 2.1076 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 2.1033 | Train Acc: 0.3590
 Site-Middle_Eastern-0              | Train Loss: 2.1345 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 2.1315 | Train Acc: 0.2366
 Site-Middle_Eastern-2              | Train Loss: 2.1292 | Train Acc: 0.2546
 Site-Black-0                       | Train Loss: 2.1452 | Train Acc: 0.2290
 Site-Black-1                       | Train Loss: 2.1425 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 2.1016 | Train Acc: 0.4453
Average Train Accuracy: 0.3167
 Site-White-0                       | Val  Loss: 2.1295 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 2.1545 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 2.1196 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 2.1060 | Val  Acc: 0.3300
 Site-White-4                       | Val  Loss: 2.1188 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.1375 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 2.1198 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 2.1349 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 2.1323 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.1461 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 2.1150 | Val  Acc: 0.4231
Average Valid Accuracy: 0.2903
 Best site-White-0                   | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                   | Epoch:0 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:0 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:0 | Val Acc: 0.3300
 Best site-White-4                   | Epoch:0 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:0 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:0 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:0 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:0 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 1 ============
 Site-White-0                       | Train Loss: 2.0069 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 2.0204 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 2.0362 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 2.0220 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 2.0139 | Train Acc: 0.3741
 Site-Middle_Eastern-0              | Train Loss: 2.0853 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0809 | Train Acc: 0.2545
 Site-Middle_Eastern-2              | Train Loss: 2.0705 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 2.0942 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0960 | Train Acc: 0.2300
 Site-White_ffhq-0                  | Train Loss: 1.9559 | Train Acc: 0.5602
Average Train Accuracy: 0.3347
 Site-White-0                       | Val  Loss: 2.0803 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 2.0787 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 2.0565 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 2.0259 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 2.0440 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.1019 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 2.0477 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0815 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0893 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.0757 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.9692 | Val  Acc: 0.5128
Average Valid Accuracy: 0.2999
 Best site-White-0                   | Epoch:1 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:1 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:1 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:1 | Val Acc: 0.3600
 Best site-White-4                   | Epoch:1 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:1 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:1 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:1 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:1 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:1 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:1 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 2 ============
 Site-White-0                       | Train Loss: 1.9409 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.9552 | Train Acc: 0.3719
 Site-White-2                       | Train Loss: 1.9720 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.9583 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.9440 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.8734 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0456 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 2.0297 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 2.0570 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0556 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.8409 | Train Acc: 0.5584
Average Train Accuracy: 0.3338
 Site-White-0                       | Val  Loss: 2.0168 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 2.0185 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.9845 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.9636 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.9824 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0669 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.9835 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0376 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0589 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.0316 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.8556 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3013
 Best site-White-0                   | Epoch:2 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:2 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:2 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:2 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:2 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:2 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:2 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:2 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:2 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:2 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 3 ============
 Site-White-0                       | Train Loss: 1.8859 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.9164 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.9371 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.9088 | Train Acc: 0.3618
 Site-White-4                       | Train Loss: 1.8894 | Train Acc: 0.3707
 Site-Middle_Eastern-0              | Train Loss: 2.0564 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0180 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9954 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 2.0343 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0374 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 1.7392 | Train Acc: 0.5566
Average Train Accuracy: 0.3337
 Site-White-0                       | Val  Loss: 1.9512 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9863 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9515 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.9126 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.9328 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0566 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.9233 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0135 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0218 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.0007 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.7496 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3010
============ Train epoch 4 ============
 Site-White-0                       | Train Loss: 1.8361 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.8702 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.9065 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8701 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.8501 | Train Acc: 0.3699
 Site-Middle_Eastern-0              | Train Loss: 1.9837 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9844 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9685 | Train Acc: 0.2625
 Site-Black-0                       | Train Loss: 1.9945 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0142 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.6608 | Train Acc: 0.5602
Average Train Accuracy: 0.3355
 Site-White-0                       | Val  Loss: 1.9274 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9520 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9360 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.8733 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8941 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0281 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.8901 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9902 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0121 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9815 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.6662 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2998
============ Train epoch 5 ============
 Site-White-0                       | Train Loss: 1.8260 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.8387 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8660 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8380 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.8087 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.7966 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9810 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.9493 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9893 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0165 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.5925 | Train Acc: 0.5620
Average Train Accuracy: 0.3336
 Site-White-0                       | Val  Loss: 1.9195 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9190 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9035 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.8480 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8685 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0138 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.8570 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9747 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9930 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9678 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.6056 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2998
============ Train epoch 6 ============
 Site-White-0                       | Train Loss: 1.7683 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.8144 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8641 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8124 | Train Acc: 0.3661
 Site-White-4                       | Train Loss: 1.7903 | Train Acc: 0.3707
 Site-Middle_Eastern-0              | Train Loss: 1.9816 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9397 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9335 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9880 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0103 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.5426 | Train Acc: 0.5730
Average Train Accuracy: 0.3352
 Site-White-0                       | Val  Loss: 1.8806 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9213 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8759 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.8045 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8517 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0155 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.8271 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9578 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9741 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9404 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.5311 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3048
 Best site-White-0                   | Epoch:6 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:6 | Val Acc: 0.2059
 Best site-White-2                   | Epoch:6 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:6 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:6 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:6 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:6 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:6 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:6 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:6 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:6 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 7 ============
 Site-White-0                       | Train Loss: 1.7153 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7984 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8352 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7958 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.7637 | Train Acc: 0.3707
 Site-Middle_Eastern-0              | Train Loss: 1.9712 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9296 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9264 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9806 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9812 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4988 | Train Acc: 0.5657
Average Train Accuracy: 0.3349
 Site-White-0                       | Val  Loss: 1.8803 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8875 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8782 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.7893 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8399 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9984 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7925 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9582 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9893 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9209 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.5076 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3013
============ Train epoch 8 ============
 Site-White-0                       | Train Loss: 1.7884 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7887 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8086 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.7753 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.7433 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.8795 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9222 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9186 | Train Acc: 0.2651
 Site-Black-0                       | Train Loss: 1.9678 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9968 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4638 | Train Acc: 0.5803
Average Train Accuracy: 0.3370
 Site-White-0                       | Val  Loss: 1.9320 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8876 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8461 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7810 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8210 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9614 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7832 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9270 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9845 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9331 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4720 | Val  Acc: 0.5385
Average Valid Accuracy: 0.2986
============ Train epoch 9 ============
 Site-White-0                       | Train Loss: 1.7733 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7743 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8016 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.7605 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 1.7301 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.9497 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8950 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.8985 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 1.9472 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9738 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4344 | Train Acc: 0.5839
Average Train Accuracy: 0.3373
 Site-White-0                       | Val  Loss: 1.8594 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8533 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8424 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7665 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8105 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9777 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7600 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9430 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9618 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9043 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4349 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3010
 Test site-White-0                   | Epoch:6 | Test Acc: 0.2619
 Test site-White-1                   | Epoch:6 | Test Acc: 0.3944
 Test site-White-2                   | Epoch:6 | Test Acc: 0.3361
 Test site-White-3                   | Epoch:6 | Test Acc: 0.3168
 Test site-White-4                   | Epoch:6 | Test Acc: 0.3178
 Test site-Middle_Eastern-0          | Epoch:6 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:6 | Test Acc: 0.2615
 Test site-Middle_Eastern-2          | Epoch:6 | Test Acc: 0.2455
 Test site-Black-0                   | Epoch:6 | Test Acc: 0.2200
 Test site-Black-1                   | Epoch:6 | Test Acc: 0.2604
 Test site-White_ffhq-0              | Epoch:6 | Test Acc: 0.5886
White: 0.3254, Middle_Eastern: 0.2374, Black: 0.2402, White_ffhq: 0.5886, 
Average Test Accuracy(group): 0.3479, Average Test Accuracy(individual): 0.3098,
domain std=0.1434, cluster std=-1.0000, individual std=0.1027, 
============ Train epoch 10 ============
 Site-White-0                       | Train Loss: 1.7156 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7539 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.8086 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7504 | Train Acc: 0.3661
 Site-White-4                       | Train Loss: 1.7151 | Train Acc: 0.3741
 Site-Middle_Eastern-0              | Train Loss: 1.7639 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9224 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.8948 | Train Acc: 0.2651
 Site-Black-0                       | Train Loss: 1.9211 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9856 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 1.4107 | Train Acc: 0.5821
Average Train Accuracy: 0.3378
 Site-White-0                       | Val  Loss: 1.8476 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8639 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8400 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7529 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7950 | Val  Acc: 0.3647
 Site-Middle_Eastern-0              | Val  Loss: 1.9591 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7576 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9167 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9796 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9037 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4053 | Val  Acc: 0.5256
Average Valid Accuracy: 0.2935
============ Train epoch 11 ============
 Site-White-0                       | Train Loss: 1.8100 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.7390 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7867 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7410 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 1.7067 | Train Acc: 0.3749
 Site-Middle_Eastern-0              | Train Loss: 2.0126 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8849 | Train Acc: 0.2545
 Site-Middle_Eastern-2              | Train Loss: 1.8909 | Train Acc: 0.2677
 Site-Black-0                       | Train Loss: 1.9479 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9558 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.3889 | Train Acc: 0.5839
Average Train Accuracy: 0.3405
 Site-White-0                       | Val  Loss: 1.8488 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8518 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8183 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7441 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7966 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9383 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7182 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.9228 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9396 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8979 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3860 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3093
 Best site-White-0                   | Epoch:11 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:11 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:11 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:11 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:11 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:11 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:11 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:11 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:11 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:11 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:11 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 12 ============
 Site-White-0                       | Train Loss: 1.7474 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7452 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7871 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.7291 | Train Acc: 0.3675
 Site-White-4                       | Train Loss: 1.6952 | Train Acc: 0.3766
 Site-Middle_Eastern-0              | Train Loss: 1.8453 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9121 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.8806 | Train Acc: 0.2703
 Site-Black-0                       | Train Loss: 1.9449 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9708 | Train Acc: 0.2249
 Site-White_ffhq-0                  | Train Loss: 1.3755 | Train Acc: 0.5712
Average Train Accuracy: 0.3373
 Site-White-0                       | Val  Loss: 1.8587 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8227 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8078 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7526 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7791 | Val  Acc: 0.3529
 Site-Middle_Eastern-0              | Val  Loss: 1.9510 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7063 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.9132 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9463 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8724 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3588 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2985
============ Train epoch 13 ============
 Site-White-0                       | Train Loss: 1.6388 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7304 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7550 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7305 | Train Acc: 0.3704
 Site-White-4                       | Train Loss: 1.6842 | Train Acc: 0.3824
 Site-Middle_Eastern-0              | Train Loss: 1.9451 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8987 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8686 | Train Acc: 0.2730
 Site-Black-0                       | Train Loss: 1.9336 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9835 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.3537 | Train Acc: 0.6113
Average Train Accuracy: 0.3446
 Site-White-0                       | Val  Loss: 1.8491 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8111 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.8173 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7209 | Val  Acc: 0.3400
 Site-White-4                       | Val  Loss: 1.7686 | Val  Acc: 0.3647
 Site-Middle_Eastern-0              | Val  Loss: 1.9820 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6927 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9019 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9567 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8934 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3501 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3036
============ Train epoch 14 ============
 Site-White-0                       | Train Loss: 1.7399 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7218 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7753 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.7151 | Train Acc: 0.3746
 Site-White-4                       | Train Loss: 1.6777 | Train Acc: 0.3824
 Site-Middle_Eastern-0              | Train Loss: 1.6494 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8782 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8671 | Train Acc: 0.2703
 Site-Black-0                       | Train Loss: 1.9186 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9526 | Train Acc: 0.2334
 Site-White_ffhq-0                  | Train Loss: 1.3364 | Train Acc: 0.6113
Average Train Accuracy: 0.3455
 Site-White-0                       | Val  Loss: 1.8902 | Val  Acc: 0.2000
 Site-White-1                       | Val  Loss: 1.8178 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.7915 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7257 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7640 | Val  Acc: 0.3529
 Site-Middle_Eastern-0              | Val  Loss: 1.9263 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6796 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8922 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9575 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8629 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3529 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2977
============ Train epoch 15 ============
 Site-White-0                       | Train Loss: 1.6540 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.7047 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7514 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.7066 | Train Acc: 0.3746
 Site-White-4                       | Train Loss: 1.6661 | Train Acc: 0.3841
 Site-Middle_Eastern-0              | Train Loss: 1.6138 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8936 | Train Acc: 0.2679
 Site-Middle_Eastern-2              | Train Loss: 1.8632 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.8957 | Train Acc: 0.2522
 Site-Black-1                       | Train Loss: 1.9391 | Train Acc: 0.2300
 Site-White_ffhq-0                  | Train Loss: 1.3283 | Train Acc: 0.5912
Average Train Accuracy: 0.3458
 Site-White-0                       | Val  Loss: 1.9059 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7990 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8099 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.7066 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7793 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.9356 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6393 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.8954 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9443 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8762 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3327 | Val  Acc: 0.5256
Average Valid Accuracy: 0.2957
============ Train epoch 16 ============
 Site-White-0                       | Train Loss: 1.6964 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7116 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7547 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.7011 | Train Acc: 0.3746
 Site-White-4                       | Train Loss: 1.6651 | Train Acc: 0.3849
 Site-Middle_Eastern-0              | Train Loss: 1.8880 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8843 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8612 | Train Acc: 0.2756
 Site-Black-0                       | Train Loss: 1.9062 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9277 | Train Acc: 0.2300
 Site-White_ffhq-0                  | Train Loss: 1.3176 | Train Acc: 0.6058
Average Train Accuracy: 0.3458
 Site-White-0                       | Val  Loss: 1.8770 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8286 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8036 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6948 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7513 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.9365 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6308 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8881 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9344 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8564 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.3090 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3035
============ Train epoch 17 ============
 Site-White-0                       | Train Loss: 1.7502 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.7063 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7302 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6980 | Train Acc: 0.3775
 Site-White-4                       | Train Loss: 1.6484 | Train Acc: 0.3808
 Site-Middle_Eastern-0              | Train Loss: 1.7409 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8628 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8401 | Train Acc: 0.2756
 Site-Black-0                       | Train Loss: 1.9011 | Train Acc: 0.2638
 Site-Black-1                       | Train Loss: 1.9303 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.3076 | Train Acc: 0.6058
Average Train Accuracy: 0.3448
 Site-White-0                       | Val  Loss: 1.8439 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7994 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.8127 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.7158 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7593 | Val  Acc: 0.3706
 Site-Middle_Eastern-0              | Val  Loss: 1.9157 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6563 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8618 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.9315 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8499 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3009 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3089
============ Train epoch 18 ============
 Site-White-0                       | Train Loss: 1.6323 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7037 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.7531 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6917 | Train Acc: 0.3789
 Site-White-4                       | Train Loss: 1.6514 | Train Acc: 0.3908
 Site-Middle_Eastern-0              | Train Loss: 1.8672 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8508 | Train Acc: 0.2679
 Site-Middle_Eastern-2              | Train Loss: 1.8388 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.8941 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9310 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.3043 | Train Acc: 0.5821
Average Train Accuracy: 0.3457
 Site-White-0                       | Val  Loss: 1.8643 | Val  Acc: 0.2000
 Site-White-1                       | Val  Loss: 1.7877 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7962 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7003 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7393 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.9481 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6576 | Val  Acc: 0.2500
 Site-Middle_Eastern-2              | Val  Loss: 1.8823 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9207 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8534 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3271 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2976
============ Train epoch 19 ============
 Site-White-0                       | Train Loss: 1.6134 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6947 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7366 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.6849 | Train Acc: 0.3803
 Site-White-4                       | Train Loss: 1.6452 | Train Acc: 0.3883
 Site-Middle_Eastern-0              | Train Loss: 1.8404 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8661 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8344 | Train Acc: 0.2756
 Site-Black-0                       | Train Loss: 1.8760 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.8941 | Train Acc: 0.2402
 Site-White_ffhq-0                  | Train Loss: 1.2926 | Train Acc: 0.6204
Average Train Accuracy: 0.3507
 Site-White-0                       | Val  Loss: 1.8228 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7832 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.8002 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.7050 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7379 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.8826 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.6404 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8718 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9193 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8402 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2922 | Val  Acc: 0.5256
Average Valid Accuracy: 0.3112
 Best site-White-0                   | Epoch:19 | Val Acc: 0.2500
 Best site-White-1                   | Epoch:19 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:19 | Val Acc: 0.2881
 Best site-White-3                   | Epoch:19 | Val Acc: 0.3600
 Best site-White-4                   | Epoch:19 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:19 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:19 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:19 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:19 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:19 | Val Acc: 0.3012
 Best site-White_ffhq-0              | Epoch:19 | Val Acc: 0.5256
 Test site-White-0                   | Epoch:19 | Test Acc: 0.2857
 Test site-White-1                   | Epoch:19 | Test Acc: 0.3944
 Test site-White-2                   | Epoch:19 | Test Acc: 0.3697
 Test site-White-3                   | Epoch:19 | Test Acc: 0.3267
 Test site-White-4                   | Epoch:19 | Test Acc: 0.3382
 Test site-Middle_Eastern-0          | Epoch:19 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:19 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:19 | Test Acc: 0.2545
 Test site-Black-0                   | Epoch:19 | Test Acc: 0.2500
 Test site-Black-1                   | Epoch:19 | Test Acc: 0.2604
 Test site-White_ffhq-0              | Epoch:19 | Test Acc: 0.5696
White: 0.3430, Middle_Eastern: 0.2455, Black: 0.2552, White_ffhq: 0.5696, 
Average Test Accuracy(group): 0.3533, Average Test Accuracy(individual): 0.3210,
domain std=0.1305, cluster std=-1.0000, individual std=0.0952, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 20 ============
 Site-White-0                       | Train Loss: 1.6609 | Train Acc: 0.3803
 Site-White-1                       | Train Loss: 1.6987 | Train Acc: 0.3719
 Site-White-2                       | Train Loss: 1.7028 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6760 | Train Acc: 0.3803
 Site-White-4                       | Train Loss: 1.6353 | Train Acc: 0.3908
 Site-Middle_Eastern-0              | Train Loss: 1.6932 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8692 | Train Acc: 0.2723
 Site-Middle_Eastern-2              | Train Loss: 1.8282 | Train Acc: 0.2861
 Site-Black-0                       | Train Loss: 1.8858 | Train Acc: 0.2522
 Site-Black-1                       | Train Loss: 1.9063 | Train Acc: 0.2334
 Site-White_ffhq-0                  | Train Loss: 1.2800 | Train Acc: 0.6077
Average Train Accuracy: 0.3474
 Site-White-0                       | Val  Loss: 1.8039 | Val  Acc: 0.2000
 Site-White-1                       | Val  Loss: 1.8000 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7702 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.7017 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7363 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.9123 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6491 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8807 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9314 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8460 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2788 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3034
============ Train epoch 21 ============
 Site-White-0                       | Train Loss: 1.6131 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.6779 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7403 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.6743 | Train Acc: 0.3718
 Site-White-4                       | Train Loss: 1.6311 | Train Acc: 0.3858
 Site-Middle_Eastern-0              | Train Loss: 1.5496 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8581 | Train Acc: 0.2723
 Site-Middle_Eastern-2              | Train Loss: 1.8360 | Train Acc: 0.2835
 Site-Black-0                       | Train Loss: 1.8841 | Train Acc: 0.2609
 Site-Black-1                       | Train Loss: 1.8942 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.2796 | Train Acc: 0.6040
Average Train Accuracy: 0.3474
 Site-White-0                       | Val  Loss: 1.8325 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7760 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7916 | Val  Acc: 0.2712
 Site-White-3                       | Val  Loss: 1.6989 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7250 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.9000 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6159 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8816 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9283 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8203 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2881 | Val  Acc: 0.5256
Average Valid Accuracy: 0.3044
============ Train epoch 22 ============
 Site-White-0                       | Train Loss: 1.6402 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6754 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7056 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6676 | Train Acc: 0.3818
 Site-White-4                       | Train Loss: 1.6257 | Train Acc: 0.3891
 Site-Middle_Eastern-0              | Train Loss: 1.6057 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8375 | Train Acc: 0.2902
 Site-Middle_Eastern-2              | Train Loss: 1.8294 | Train Acc: 0.2913
 Site-Black-0                       | Train Loss: 1.8751 | Train Acc: 0.2580
 Site-Black-1                       | Train Loss: 1.8876 | Train Acc: 0.2368
 Site-White_ffhq-0                  | Train Loss: 1.2782 | Train Acc: 0.5931
Average Train Accuracy: 0.3507
 Site-White-0                       | Val  Loss: 1.8492 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7774 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7884 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6839 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7210 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8772 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6249 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8344 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9095 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8454 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2666 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3196
 Best site-White-0                   | Epoch:22 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:22 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:22 | Val Acc: 0.2881
 Best site-White-3                   | Epoch:22 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:22 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:22 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:22 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:22 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:22 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:22 | Val Acc: 0.3253
 Best site-White_ffhq-0              | Epoch:22 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 23 ============
 Site-White-0                       | Train Loss: 1.5607 | Train Acc: 0.3803
 Site-White-1                       | Train Loss: 1.6761 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7219 | Train Acc: 0.3438
 Site-White-3                       | Train Loss: 1.6633 | Train Acc: 0.3846
 Site-White-4                       | Train Loss: 1.6207 | Train Acc: 0.3933
 Site-Middle_Eastern-0              | Train Loss: 1.9328 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8469 | Train Acc: 0.2902
 Site-Middle_Eastern-2              | Train Loss: 1.8139 | Train Acc: 0.2861
 Site-Black-0                       | Train Loss: 1.8654 | Train Acc: 0.2580
 Site-Black-1                       | Train Loss: 1.8929 | Train Acc: 0.2453
 Site-White_ffhq-0                  | Train Loss: 1.2685 | Train Acc: 0.6223
Average Train Accuracy: 0.3522
 Site-White-0                       | Val  Loss: 1.7978 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7623 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7808 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6779 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7222 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8904 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5868 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8381 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.9079 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8278 | Val  Acc: 0.2892
 Site-White_ffhq-0                  | Val  Loss: 1.2623 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3272
 Best site-White-0                   | Epoch:23 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:23 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:23 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:23 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:23 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:23 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:23 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:23 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:23 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:23 | Val Acc: 0.2892
 Best site-White_ffhq-0              | Epoch:23 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 24 ============
 Site-White-0                       | Train Loss: 1.5770 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6569 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.7014 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6554 | Train Acc: 0.3818
 Site-White-4                       | Train Loss: 1.6115 | Train Acc: 0.3933
 Site-Middle_Eastern-0              | Train Loss: 1.6280 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8277 | Train Acc: 0.2768
 Site-Middle_Eastern-2              | Train Loss: 1.8042 | Train Acc: 0.2940
 Site-Black-0                       | Train Loss: 1.8749 | Train Acc: 0.2638
 Site-Black-1                       | Train Loss: 1.8650 | Train Acc: 0.2402
 Site-White_ffhq-0                  | Train Loss: 1.2655 | Train Acc: 0.6022
Average Train Accuracy: 0.3539
 Site-White-0                       | Val  Loss: 1.8104 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7671 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7656 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6598 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7269 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.8540 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5981 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8260 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8766 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8206 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2541 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3270
============ Train epoch 25 ============
 Site-White-0                       | Train Loss: 1.5683 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6630 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.7034 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6526 | Train Acc: 0.3775
 Site-White-4                       | Train Loss: 1.6114 | Train Acc: 0.3958
 Site-Middle_Eastern-0              | Train Loss: 1.7176 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8428 | Train Acc: 0.3036
 Site-Middle_Eastern-2              | Train Loss: 1.8080 | Train Acc: 0.2913
 Site-Black-0                       | Train Loss: 1.8490 | Train Acc: 0.2667
 Site-Black-1                       | Train Loss: 1.8760 | Train Acc: 0.2504
 Site-White_ffhq-0                  | Train Loss: 1.2586 | Train Acc: 0.6150
Average Train Accuracy: 0.3585
 Site-White-0                       | Val  Loss: 1.8254 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7407 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7755 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6564 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7064 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.9046 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5990 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8529 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8807 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8363 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.2418 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3290
 Best site-White-0                   | Epoch:25 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:25 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:25 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:25 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:25 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:25 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:25 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:25 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:25 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:25 | Val Acc: 0.3494
 Best site-White_ffhq-0              | Epoch:25 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 26 ============
 Site-White-0                       | Train Loss: 1.5534 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6515 | Train Acc: 0.3636
 Site-White-2                       | Train Loss: 1.6936 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.6459 | Train Acc: 0.3875
 Site-White-4                       | Train Loss: 1.6067 | Train Acc: 0.3908
 Site-Middle_Eastern-0              | Train Loss: 1.6554 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8719 | Train Acc: 0.2812
 Site-Middle_Eastern-2              | Train Loss: 1.8003 | Train Acc: 0.3045
 Site-Black-0                       | Train Loss: 1.8501 | Train Acc: 0.2812
 Site-Black-1                       | Train Loss: 1.8533 | Train Acc: 0.2504
 Site-White_ffhq-0                  | Train Loss: 1.2582 | Train Acc: 0.6058
Average Train Accuracy: 0.3566
 Site-White-0                       | Val  Loss: 1.7985 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7238 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7675 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6602 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6944 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.8659 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.5821 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8096 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.9074 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8394 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2577 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3370
 Best site-White-0                   | Epoch:26 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:26 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:26 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:26 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:26 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:26 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:26 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:26 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:26 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:26 | Val Acc: 0.3012
 Best site-White_ffhq-0              | Epoch:26 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 27 ============
 Site-White-0                       | Train Loss: 1.6152 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6497 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6865 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6459 | Train Acc: 0.3903
 Site-White-4                       | Train Loss: 1.6027 | Train Acc: 0.3983
 Site-Middle_Eastern-0              | Train Loss: 1.7410 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8132 | Train Acc: 0.2857
 Site-Middle_Eastern-2              | Train Loss: 1.7953 | Train Acc: 0.3071
 Site-Black-0                       | Train Loss: 1.8421 | Train Acc: 0.2754
 Site-Black-1                       | Train Loss: 1.8467 | Train Acc: 0.2572
 Site-White_ffhq-0                  | Train Loss: 1.2575 | Train Acc: 0.6058
Average Train Accuracy: 0.3591
 Site-White-0                       | Val  Loss: 1.8045 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7572 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7635 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6485 | Val  Acc: 0.4100
 Site-White-4                       | Val  Loss: 1.6985 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.8481 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5775 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8056 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8882 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8305 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2512 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3243
============ Train epoch 28 ============
 Site-White-0                       | Train Loss: 1.5671 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6432 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.6718 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.6454 | Train Acc: 0.3860
 Site-White-4                       | Train Loss: 1.5949 | Train Acc: 0.4017
 Site-Middle_Eastern-0              | Train Loss: 1.8080 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8114 | Train Acc: 0.2902
 Site-Middle_Eastern-2              | Train Loss: 1.7924 | Train Acc: 0.3018
 Site-Black-0                       | Train Loss: 1.8515 | Train Acc: 0.2841
 Site-Black-1                       | Train Loss: 1.8323 | Train Acc: 0.2538
 Site-White_ffhq-0                  | Train Loss: 1.2577 | Train Acc: 0.5931
Average Train Accuracy: 0.3592
 Site-White-0                       | Val  Loss: 1.8540 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7487 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7645 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6554 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.6868 | Val  Acc: 0.3706
 Site-Middle_Eastern-0              | Val  Loss: 1.8717 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5757 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.8064 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8793 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.8021 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2679 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3197
============ Train epoch 29 ============
 Site-White-0                       | Train Loss: 1.5931 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6536 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6833 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.6353 | Train Acc: 0.3875
 Site-White-4                       | Train Loss: 1.5902 | Train Acc: 0.3992
 Site-Middle_Eastern-0              | Train Loss: 1.9694 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8203 | Train Acc: 0.3036
 Site-Middle_Eastern-2              | Train Loss: 1.7900 | Train Acc: 0.2966
 Site-Black-0                       | Train Loss: 1.8231 | Train Acc: 0.2783
 Site-Black-1                       | Train Loss: 1.8744 | Train Acc: 0.2760
 Site-White_ffhq-0                  | Train Loss: 1.2553 | Train Acc: 0.6077
Average Train Accuracy: 0.3637
 Site-White-0                       | Val  Loss: 1.7605 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7398 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7698 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6714 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6744 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8595 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5798 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8135 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8863 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7981 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.2570 | Val  Acc: 0.5128
Average Valid Accuracy: 0.3319
 Test site-White-0                   | Epoch:26 | Test Acc: 0.2143
 Test site-White-1                   | Epoch:26 | Test Acc: 0.3944
 Test site-White-2                   | Epoch:26 | Test Acc: 0.4034
 Test site-White-3                   | Epoch:26 | Test Acc: 0.3069
 Test site-White-4                   | Epoch:26 | Test Acc: 0.3353
 Test site-Middle_Eastern-0          | Epoch:26 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:26 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:26 | Test Acc: 0.2727
 Test site-Black-0                   | Epoch:26 | Test Acc: 0.2900
 Test site-Black-1                   | Epoch:26 | Test Acc: 0.3195
 Test site-White_ffhq-0              | Epoch:26 | Test Acc: 0.5633
White: 0.3308, Middle_Eastern: 0.2516, Black: 0.3048, White_ffhq: 0.5633, 
Average Test Accuracy(group): 0.3626, Average Test Accuracy(individual): 0.3256,
domain std=0.1193, cluster std=-1.0000, individual std=0.0959, 
============ Train epoch 30 ============
 Site-White-0                       | Train Loss: 1.5922 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6565 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6668 | Train Acc: 0.3584
 Site-White-3                       | Train Loss: 1.6308 | Train Acc: 0.3932
 Site-White-4                       | Train Loss: 1.5853 | Train Acc: 0.4008
 Site-Middle_Eastern-0              | Train Loss: 1.8912 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8082 | Train Acc: 0.2812
 Site-Middle_Eastern-2              | Train Loss: 1.7855 | Train Acc: 0.3097
 Site-Black-0                       | Train Loss: 1.8434 | Train Acc: 0.3014
 Site-Black-1                       | Train Loss: 1.8496 | Train Acc: 0.2726
 Site-White_ffhq-0                  | Train Loss: 1.2488 | Train Acc: 0.6040
Average Train Accuracy: 0.3654
 Site-White-0                       | Val  Loss: 1.7770 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7264 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7694 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6595 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6759 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8468 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.6010 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8166 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8801 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8284 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2281 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3288
============ Train epoch 31 ============
 Site-White-0                       | Train Loss: 1.6334 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6294 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6721 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6203 | Train Acc: 0.3846
 Site-White-4                       | Train Loss: 1.5766 | Train Acc: 0.4008
 Site-Middle_Eastern-0              | Train Loss: 1.9290 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8028 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 1.7911 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.8225 | Train Acc: 0.2899
 Site-Black-1                       | Train Loss: 1.8449 | Train Acc: 0.2743
 Site-White_ffhq-0                  | Train Loss: 1.2520 | Train Acc: 0.6150
Average Train Accuracy: 0.3663
 Site-White-0                       | Val  Loss: 1.7931 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7227 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7427 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6429 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6666 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.8796 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5909 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7944 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8696 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.8148 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2263 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3333
============ Train epoch 32 ============
 Site-White-0                       | Train Loss: 1.6434 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6098 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.6685 | Train Acc: 0.3584
 Site-White-3                       | Train Loss: 1.6166 | Train Acc: 0.3803
 Site-White-4                       | Train Loss: 1.5748 | Train Acc: 0.3983
 Site-Middle_Eastern-0              | Train Loss: 1.8255 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.7959 | Train Acc: 0.2991
 Site-Middle_Eastern-2              | Train Loss: 1.7682 | Train Acc: 0.3097
 Site-Black-0                       | Train Loss: 1.8203 | Train Acc: 0.2928
 Site-Black-1                       | Train Loss: 1.8513 | Train Acc: 0.2624
 Site-White_ffhq-0                  | Train Loss: 1.2465 | Train Acc: 0.6131
Average Train Accuracy: 0.3627
 Site-White-0                       | Val  Loss: 1.8211 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7096 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7413 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6488 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6679 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.8528 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5410 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.7727 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8568 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8101 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2417 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3338
============ Train epoch 33 ============
 Site-White-0                       | Train Loss: 1.5582 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.6210 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.6580 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.6197 | Train Acc: 0.3860
 Site-White-4                       | Train Loss: 1.5670 | Train Acc: 0.4025
 Site-Middle_Eastern-0              | Train Loss: 1.6743 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7813 | Train Acc: 0.2946
 Site-Middle_Eastern-2              | Train Loss: 1.7802 | Train Acc: 0.3018
 Site-Black-0                       | Train Loss: 1.8159 | Train Acc: 0.2928
 Site-Black-1                       | Train Loss: 1.8634 | Train Acc: 0.2726
 Site-White_ffhq-0                  | Train Loss: 1.2469 | Train Acc: 0.6150
Average Train Accuracy: 0.3650
 Site-White-0                       | Val  Loss: 1.7981 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7241 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7351 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6309 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6640 | Val  Acc: 0.4059
 Site-Middle_Eastern-0              | Val  Loss: 1.8403 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5310 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8084 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8437 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8210 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2413 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3394
 Best site-White-0                   | Epoch:33 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:33 | Val Acc: 0.3235
 Best site-White-2                   | Epoch:33 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:33 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:33 | Val Acc: 0.4059
 Best site-Middle_Eastern-0          | Epoch:33 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:33 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:33 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:33 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:33 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:33 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 34 ============
 Site-White-0                       | Train Loss: 1.4956 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6299 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.6692 | Train Acc: 0.3729
 Site-White-3                       | Train Loss: 1.6122 | Train Acc: 0.3946
 Site-White-4                       | Train Loss: 1.5682 | Train Acc: 0.4109
 Site-Middle_Eastern-0              | Train Loss: 1.6817 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7993 | Train Acc: 0.3170
 Site-Middle_Eastern-2              | Train Loss: 1.7628 | Train Acc: 0.3228
 Site-Black-0                       | Train Loss: 1.8107 | Train Acc: 0.2870
 Site-Black-1                       | Train Loss: 1.8036 | Train Acc: 0.2811
 Site-White_ffhq-0                  | Train Loss: 1.2463 | Train Acc: 0.6077
Average Train Accuracy: 0.3717
 Site-White-0                       | Val  Loss: 1.7624 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7365 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7338 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6352 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6556 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8154 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5619 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7792 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8672 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8083 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.2324 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3425
 Best site-White-0                   | Epoch:34 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:34 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:34 | Val Acc: 0.3390
 Best site-White-3                   | Epoch:34 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:34 | Val Acc: 0.3941
 Best site-Middle_Eastern-0          | Epoch:34 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:34 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:34 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:34 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:34 | Val Acc: 0.3494
 Best site-White_ffhq-0              | Epoch:34 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 35 ============
 Site-White-0                       | Train Loss: 1.5689 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6102 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6420 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.6078 | Train Acc: 0.3903
 Site-White-4                       | Train Loss: 1.5612 | Train Acc: 0.4117
 Site-Middle_Eastern-0              | Train Loss: 1.9717 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7613 | Train Acc: 0.2768
 Site-Middle_Eastern-2              | Train Loss: 1.7581 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.8299 | Train Acc: 0.3072
 Site-Black-1                       | Train Loss: 1.8428 | Train Acc: 0.2862
 Site-White_ffhq-0                  | Train Loss: 1.2416 | Train Acc: 0.6095
Average Train Accuracy: 0.3679
 Site-White-0                       | Val  Loss: 1.8048 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7538 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7608 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6465 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6581 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.8752 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5169 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7749 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8331 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7871 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2350 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3355
============ Train epoch 36 ============
 Site-White-0                       | Train Loss: 1.6707 | Train Acc: 0.4296
 Site-White-1                       | Train Loss: 1.6219 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6462 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.5997 | Train Acc: 0.4003
 Site-White-4                       | Train Loss: 1.5603 | Train Acc: 0.4142
 Site-Middle_Eastern-0              | Train Loss: 1.7262 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.7768 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 1.7507 | Train Acc: 0.3176
 Site-Black-0                       | Train Loss: 1.8103 | Train Acc: 0.3159
 Site-Black-1                       | Train Loss: 1.8113 | Train Acc: 0.2811
 Site-White_ffhq-0                  | Train Loss: 1.2415 | Train Acc: 0.5949
Average Train Accuracy: 0.3752
 Site-White-0                       | Val  Loss: 1.7630 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7223 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7227 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6053 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6596 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.8341 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5259 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.7790 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8392 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7964 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2281 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3474
 Best site-White-0                   | Epoch:36 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:36 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:36 | Val Acc: 0.3390
 Best site-White-3                   | Epoch:36 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:36 | Val Acc: 0.4000
 Best site-Middle_Eastern-0          | Epoch:36 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:36 | Val Acc: 0.4062
 Best site-Middle_Eastern-2          | Epoch:36 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:36 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:36 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:36 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 37 ============
 Site-White-0                       | Train Loss: 1.5647 | Train Acc: 0.4296
 Site-White-1                       | Train Loss: 1.6139 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.6583 | Train Acc: 0.3729
 Site-White-3                       | Train Loss: 1.6033 | Train Acc: 0.4003
 Site-White-4                       | Train Loss: 1.5524 | Train Acc: 0.4151
 Site-Middle_Eastern-0              | Train Loss: 1.4922 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7701 | Train Acc: 0.3170
 Site-Middle_Eastern-2              | Train Loss: 1.7521 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.7743 | Train Acc: 0.3217
 Site-Black-1                       | Train Loss: 1.8241 | Train Acc: 0.2964
 Site-White_ffhq-0                  | Train Loss: 1.2243 | Train Acc: 0.6040
Average Train Accuracy: 0.3792
 Site-White-0                       | Val  Loss: 1.7496 | Val  Acc: 0.4000
 Site-White-1                       | Val  Loss: 1.7256 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7293 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6210 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6641 | Val  Acc: 0.4059
 Site-Middle_Eastern-0              | Val  Loss: 1.8253 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5103 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7722 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8860 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7909 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2223 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3524
 Best site-White-0                   | Epoch:37 | Val Acc: 0.4000
 Best site-White-1                   | Epoch:37 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:37 | Val Acc: 0.3390
 Best site-White-3                   | Epoch:37 | Val Acc: 0.4000
 Best site-White-4                   | Epoch:37 | Val Acc: 0.4059
 Best site-Middle_Eastern-0          | Epoch:37 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:37 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:37 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:37 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:37 | Val Acc: 0.3253
 Best site-White_ffhq-0              | Epoch:37 | Val Acc: 0.6026
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 38 ============
 Site-White-0                       | Train Loss: 1.5867 | Train Acc: 0.4437
 Site-White-1                       | Train Loss: 1.6083 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6479 | Train Acc: 0.3729
 Site-White-3                       | Train Loss: 1.5935 | Train Acc: 0.3932
 Site-White-4                       | Train Loss: 1.5542 | Train Acc: 0.4134
 Site-Middle_Eastern-0              | Train Loss: 1.6298 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.7986 | Train Acc: 0.3259
 Site-Middle_Eastern-2              | Train Loss: 1.7497 | Train Acc: 0.3045
 Site-Black-0                       | Train Loss: 1.8039 | Train Acc: 0.3188
 Site-Black-1                       | Train Loss: 1.8320 | Train Acc: 0.2964
 Site-White_ffhq-0                  | Train Loss: 1.2377 | Train Acc: 0.6150
Average Train Accuracy: 0.3798
 Site-White-0                       | Val  Loss: 1.8000 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6889 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7142 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6287 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6423 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.7975 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5357 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7521 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8340 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7934 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2338 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3464
============ Train epoch 39 ============
 Site-White-0                       | Train Loss: 1.6075 | Train Acc: 0.4296
 Site-White-1                       | Train Loss: 1.6145 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6378 | Train Acc: 0.3705
 Site-White-3                       | Train Loss: 1.5908 | Train Acc: 0.3974
 Site-White-4                       | Train Loss: 1.5523 | Train Acc: 0.4084
 Site-Middle_Eastern-0              | Train Loss: 1.7013 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.7646 | Train Acc: 0.2991
 Site-Middle_Eastern-2              | Train Loss: 1.7338 | Train Acc: 0.3150
 Site-Black-0                       | Train Loss: 1.7955 | Train Acc: 0.3217
 Site-Black-1                       | Train Loss: 1.7785 | Train Acc: 0.3152
 Site-White_ffhq-0                  | Train Loss: 1.2325 | Train Acc: 0.6095
Average Train Accuracy: 0.3813
 Site-White-0                       | Val  Loss: 1.7755 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6928 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7238 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6345 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6377 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.7946 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5338 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7719 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8223 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7803 | Val  Acc: 0.3373
 Site-White_ffhq-0                  | Val  Loss: 1.2187 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3469
 Test site-White-0                   | Epoch:37 | Test Acc: 0.2381
 Test site-White-1                   | Epoch:37 | Test Acc: 0.4789
 Test site-White-2                   | Epoch:37 | Test Acc: 0.3782
 Test site-White-3                   | Epoch:37 | Test Acc: 0.3267
 Test site-White-4                   | Epoch:37 | Test Acc: 0.3644
 Test site-Middle_Eastern-0          | Epoch:37 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:37 | Test Acc: 0.2923
 Test site-Middle_Eastern-2          | Epoch:37 | Test Acc: 0.3182
 Test site-Black-0                   | Epoch:37 | Test Acc: 0.3000
 Test site-Black-1                   | Epoch:37 | Test Acc: 0.3669
 Test site-White_ffhq-0              | Epoch:37 | Test Acc: 0.5823
White: 0.3573, Middle_Eastern: 0.2719, Black: 0.3334, White_ffhq: 0.5823, 
Average Test Accuracy(group): 0.3862, Average Test Accuracy(individual): 0.3501,
domain std=0.1174, cluster std=-1.0000, individual std=0.1012, 
============ Train epoch 40 ============
 Site-White-0                       | Train Loss: 1.5275 | Train Acc: 0.4437
 Site-White-1                       | Train Loss: 1.6038 | Train Acc: 0.4050
 Site-White-2                       | Train Loss: 1.6338 | Train Acc: 0.3656
 Site-White-3                       | Train Loss: 1.5878 | Train Acc: 0.3960
 Site-White-4                       | Train Loss: 1.5459 | Train Acc: 0.4184
 Site-Middle_Eastern-0              | Train Loss: 1.8626 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.7251 | Train Acc: 0.3214
 Site-Middle_Eastern-2              | Train Loss: 1.7414 | Train Acc: 0.3150
 Site-Black-0                       | Train Loss: 1.7882 | Train Acc: 0.3101
 Site-Black-1                       | Train Loss: 1.7876 | Train Acc: 0.3049
 Site-White_ffhq-0                  | Train Loss: 1.2354 | Train Acc: 0.5985
Average Train Accuracy: 0.3838
 Site-White-0                       | Val  Loss: 1.7987 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7086 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7241 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6101 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.6415 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.7898 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5185 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7489 | Val  Acc: 0.2593
 Site-Black-0                       | Val  Loss: 1.8448 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7969 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2245 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3357
============ Train epoch 41 ============
 Site-White-0                       | Train Loss: 1.5793 | Train Acc: 0.4648
 Site-White-1                       | Train Loss: 1.5911 | Train Acc: 0.4050
 Site-White-2                       | Train Loss: 1.6243 | Train Acc: 0.3826
 Site-White-3                       | Train Loss: 1.5780 | Train Acc: 0.4103
 Site-White-4                       | Train Loss: 1.5343 | Train Acc: 0.4259
 Site-Middle_Eastern-0              | Train Loss: 1.5869 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.7303 | Train Acc: 0.2902
 Site-Middle_Eastern-2              | Train Loss: 1.7306 | Train Acc: 0.3150
 Site-Black-0                       | Train Loss: 1.8076 | Train Acc: 0.2957
 Site-Black-1                       | Train Loss: 1.8099 | Train Acc: 0.3169
 Site-White_ffhq-0                  | Train Loss: 1.2322 | Train Acc: 0.5894
Average Train Accuracy: 0.3833
 Site-White-0                       | Val  Loss: 1.8132 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7232 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7213 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6057 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6459 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.7932 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5184 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7815 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8558 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7873 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.2132 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3449
============ Train epoch 42 ============
 Site-White-0                       | Train Loss: 1.5757 | Train Acc: 0.4437
 Site-White-1                       | Train Loss: 1.5819 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6293 | Train Acc: 0.3874
 Site-White-3                       | Train Loss: 1.5812 | Train Acc: 0.4031
 Site-White-4                       | Train Loss: 1.5357 | Train Acc: 0.4234
 Site-Middle_Eastern-0              | Train Loss: 1.6289 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.7628 | Train Acc: 0.3259
 Site-Middle_Eastern-2              | Train Loss: 1.7314 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.7898 | Train Acc: 0.3188
 Site-Black-1                       | Train Loss: 1.7702 | Train Acc: 0.3305
 Site-White_ffhq-0                  | Train Loss: 1.2338 | Train Acc: 0.5967
Average Train Accuracy: 0.3917
 Site-White-0                       | Val  Loss: 1.8100 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7036 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7304 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6121 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6289 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.7964 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5341 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7278 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8132 | Val  Acc: 0.3061
 Site-Black-1                       | Val  Loss: 1.7581 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.1946 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3591
 Best site-White-0                   | Epoch:42 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:42 | Val Acc: 0.3235
 Best site-White-2                   | Epoch:42 | Val Acc: 0.3390
 Best site-White-3                   | Epoch:42 | Val Acc: 0.4000
 Best site-White-4                   | Epoch:42 | Val Acc: 0.4000
 Best site-Middle_Eastern-0          | Epoch:42 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:42 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:42 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:42 | Val Acc: 0.3061
 Best site-Black-1                   | Epoch:42 | Val Acc: 0.3494
 Best site-White_ffhq-0              | Epoch:42 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 43 ============
 Site-White-0                       | Train Loss: 1.5113 | Train Acc: 0.4577
 Site-White-1                       | Train Loss: 1.5966 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6077 | Train Acc: 0.3874
 Site-White-3                       | Train Loss: 1.5763 | Train Acc: 0.4103
 Site-White-4                       | Train Loss: 1.5356 | Train Acc: 0.4318
 Site-Middle_Eastern-0              | Train Loss: 1.7211 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.7504 | Train Acc: 0.3259
 Site-Middle_Eastern-2              | Train Loss: 1.7225 | Train Acc: 0.3307
 Site-Black-0                       | Train Loss: 1.7814 | Train Acc: 0.3217
 Site-Black-1                       | Train Loss: 1.7825 | Train Acc: 0.3186
 Site-White_ffhq-0                  | Train Loss: 1.2235 | Train Acc: 0.5821
Average Train Accuracy: 0.3943
 Site-White-0                       | Val  Loss: 1.7681 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6849 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7313 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.5792 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6170 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.7645 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4995 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7396 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8227 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7745 | Val  Acc: 0.3614
 Site-White_ffhq-0                  | Val  Loss: 1.2002 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3486
============ Train epoch 44 ============
 Site-White-0                       | Train Loss: 1.4214 | Train Acc: 0.4437
 Site-White-1                       | Train Loss: 1.5703 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6186 | Train Acc: 0.3850
 Site-White-3                       | Train Loss: 1.5708 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5286 | Train Acc: 0.4285
 Site-Middle_Eastern-0              | Train Loss: 1.7258 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.7174 | Train Acc: 0.3125
 Site-Middle_Eastern-2              | Train Loss: 1.7207 | Train Acc: 0.3255
 Site-Black-0                       | Train Loss: 1.7601 | Train Acc: 0.3217
 Site-Black-1                       | Train Loss: 1.7944 | Train Acc: 0.3322
 Site-White_ffhq-0                  | Train Loss: 1.2348 | Train Acc: 0.5748
Average Train Accuracy: 0.3900
 Site-White-0                       | Val  Loss: 1.8294 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6949 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7258 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6048 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6313 | Val  Acc: 0.4059
 Site-Middle_Eastern-0              | Val  Loss: 1.8093 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5106 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.7379 | Val  Acc: 0.2593
 Site-Black-0                       | Val  Loss: 1.8264 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7794 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.2034 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3488
============ Train epoch 45 ============
 Site-White-0                       | Train Loss: 1.5421 | Train Acc: 0.4789
 Site-White-1                       | Train Loss: 1.5750 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6139 | Train Acc: 0.3826
 Site-White-3                       | Train Loss: 1.5626 | Train Acc: 0.4174
 Site-White-4                       | Train Loss: 1.5151 | Train Acc: 0.4234
 Site-Middle_Eastern-0              | Train Loss: 1.7327 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.7254 | Train Acc: 0.3259
 Site-Middle_Eastern-2              | Train Loss: 1.7151 | Train Acc: 0.3176
 Site-Black-0                       | Train Loss: 1.7576 | Train Acc: 0.3217
 Site-Black-1                       | Train Loss: 1.7618 | Train Acc: 0.3083
 Site-White_ffhq-0                  | Train Loss: 1.2283 | Train Acc: 0.5839
Average Train Accuracy: 0.3902
 Site-White-0                       | Val  Loss: 1.7610 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6900 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7078 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5905 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6122 | Val  Acc: 0.4118
 Site-Middle_Eastern-0              | Val  Loss: 1.7801 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.4857 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.7380 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8180 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7652 | Val  Acc: 0.3614
 Site-White_ffhq-0                  | Val  Loss: 1.1838 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3636
 Best site-White-0                   | Epoch:45 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:45 | Val Acc: 0.3235
 Best site-White-2                   | Epoch:45 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:45 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:45 | Val Acc: 0.4118
 Best site-Middle_Eastern-0          | Epoch:45 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:45 | Val Acc: 0.4375
 Best site-Middle_Eastern-2          | Epoch:45 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:45 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:45 | Val Acc: 0.3614
 Best site-White_ffhq-0              | Epoch:45 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/drfl...
============ Train epoch 46 ============
 Site-White-0                       | Train Loss: 1.6070 | Train Acc: 0.4225
 Site-White-1                       | Train Loss: 1.5672 | Train Acc: 0.4008
 Site-White-2                       | Train Loss: 1.5981 | Train Acc: 0.3923
 Site-White-3                       | Train Loss: 1.5629 | Train Acc: 0.4145
 Site-White-4                       | Train Loss: 1.5147 | Train Acc: 0.4251
 Site-Middle_Eastern-0              | Train Loss: 1.4763 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7301 | Train Acc: 0.3214
 Site-Middle_Eastern-2              | Train Loss: 1.7097 | Train Acc: 0.3386
 Site-Black-0                       | Train Loss: 1.7566 | Train Acc: 0.3275
 Site-Black-1                       | Train Loss: 1.7886 | Train Acc: 0.3101
 Site-White_ffhq-0                  | Train Loss: 1.2244 | Train Acc: 0.5858
Average Train Accuracy: 0.3907
 Site-White-0                       | Val  Loss: 1.7696 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6531 | Val  Acc: 0.3529
 Site-White-2                       | Val  Loss: 1.7160 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5948 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6159 | Val  Acc: 0.4235
 Site-Middle_Eastern-0              | Val  Loss: 1.8035 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4809 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.7255 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.7899 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7875 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.1884 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3624
============ Train epoch 47 ============
 Site-White-0                       | Train Loss: 1.5035 | Train Acc: 0.4507
 Site-White-1                       | Train Loss: 1.5690 | Train Acc: 0.4050
 Site-White-2                       | Train Loss: 1.6143 | Train Acc: 0.3777
 Site-White-3                       | Train Loss: 1.5638 | Train Acc: 0.4231
 Site-White-4                       | Train Loss: 1.5135 | Train Acc: 0.4351
 Site-Middle_Eastern-0              | Train Loss: 1.5559 | Train Acc: 0.3511
 Site-Middle_Eastern-1              | Train Loss: 1.7327 | Train Acc: 0.3438
 Site-Middle_Eastern-2              | Train Loss: 1.7205 | Train Acc: 0.3255
 Site-Black-0                       | Train Loss: 1.7712 | Train Acc: 0.3188
 Site-Black-1                       | Train Loss: 1.7796 | Train Acc: 0.3254
 Site-White_ffhq-0                  | Train Loss: 1.2123 | Train Acc: 0.5912
Average Train Accuracy: 0.3952
 Site-White-0                       | Val  Loss: 1.8326 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6769 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7008 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5823 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6247 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.7533 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4702 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.7168 | Val  Acc: 0.2778
 Site-Black-0                       | Val  Loss: 1.7996 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7877 | Val  Acc: 0.3373
 Site-White_ffhq-0                  | Val  Loss: 1.2130 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3550
============ Train epoch 48 ============
 Site-White-0                       | Train Loss: 1.5077 | Train Acc: 0.4648
 Site-White-1                       | Train Loss: 1.5488 | Train Acc: 0.4132
 Site-White-2                       | Train Loss: 1.6040 | Train Acc: 0.3850
 Site-White-3                       | Train Loss: 1.5544 | Train Acc: 0.4131
 Site-White-4                       | Train Loss: 1.5141 | Train Acc: 0.4318
 Site-Middle_Eastern-0              | Train Loss: 1.7910 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.7444 | Train Acc: 0.3393
 Site-Middle_Eastern-2              | Train Loss: 1.7069 | Train Acc: 0.3255
 Site-Black-0                       | Train Loss: 1.7401 | Train Acc: 0.3304
 Site-Black-1                       | Train Loss: 1.7739 | Train Acc: 0.3152
 Site-White_ffhq-0                  | Train Loss: 1.2194 | Train Acc: 0.5985
Average Train Accuracy: 0.3985
 Site-White-0                       | Val  Loss: 1.7146 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6582 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7346 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5921 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.5993 | Val  Acc: 0.4118
 Site-Middle_Eastern-0              | Val  Loss: 1.8079 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4784 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.6964 | Val  Acc: 0.2593
 Site-Black-0                       | Val  Loss: 1.8353 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7491 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2004 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3544
============ Train epoch 49 ============
 Site-White-0                       | Train Loss: 1.5261 | Train Acc: 0.4507
 Site-White-1                       | Train Loss: 1.5627 | Train Acc: 0.4091
 Site-White-2                       | Train Loss: 1.6284 | Train Acc: 0.3995
 Site-White-3                       | Train Loss: 1.5451 | Train Acc: 0.4245
 Site-White-4                       | Train Loss: 1.5050 | Train Acc: 0.4326
 Site-Middle_Eastern-0              | Train Loss: 1.6834 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7123 | Train Acc: 0.3393
 Site-Middle_Eastern-2              | Train Loss: 1.7085 | Train Acc: 0.3360
 Site-Black-0                       | Train Loss: 1.7483 | Train Acc: 0.3362
 Site-Black-1                       | Train Loss: 1.7638 | Train Acc: 0.3271
 Site-White_ffhq-0                  | Train Loss: 1.2187 | Train Acc: 0.5931
Average Train Accuracy: 0.4006
 Site-White-0                       | Val  Loss: 1.7512 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6824 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.6893 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.5979 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6031 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.7324 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4535 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.7139 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.7781 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7251 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.1918 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3553
 Test site-White-0                   | Epoch:45 | Test Acc: 0.3095
 Test site-White-1                   | Epoch:45 | Test Acc: 0.5070
 Test site-White-2                   | Epoch:45 | Test Acc: 0.4118
 Test site-White-3                   | Epoch:45 | Test Acc: 0.3515
 Test site-White-4                   | Epoch:45 | Test Acc: 0.3732
 Test site-Middle_Eastern-0          | Epoch:45 | Test Acc: 0.2308
 Test site-Middle_Eastern-1          | Epoch:45 | Test Acc: 0.3231
 Test site-Middle_Eastern-2          | Epoch:45 | Test Acc: 0.3000
 Test site-Black-0                   | Epoch:45 | Test Acc: 0.3200
 Test site-Black-1                   | Epoch:45 | Test Acc: 0.3432
 Test site-White_ffhq-0              | Epoch:45 | Test Acc: 0.5127
White: 0.3906, Middle_Eastern: 0.2846, Black: 0.3316, White_ffhq: 0.5127, 
Average Test Accuracy(group): 0.3799, Average Test Accuracy(individual): 0.3621,
domain std=0.0854, cluster std=-1.0000, individual std=0.0820, 
===2023-06-16 06:18:59===
===2023-06-16 06:19:03===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = -1
Loading snapshots...
 Test site-White-0                   | Epoch:45 | Test Acc: 0.2619
 Test site-White-1                   | Epoch:45 | Test Acc: 0.4648
 Test site-White-2                   | Epoch:45 | Test Acc: 0.3782
 Test site-White-3                   | Epoch:45 | Test Acc: 0.3317
 Test site-White-4                   | Epoch:45 | Test Acc: 0.3761
 Test site-Middle_Eastern-0          | Epoch:45 | Test Acc: 0.2821
 Test site-Middle_Eastern-1          | Epoch:45 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          | Epoch:45 | Test Acc: 0.3000
 Test site-Black-0                   | Epoch:45 | Test Acc: 0.3100
 Test site-Black-1                   | Epoch:45 | Test Acc: 0.3373
 Test site-White_ffhq-0              | Epoch:45 | Test Acc: 0.5190
White: 0.3625, Middle_Eastern: 0.3120, Black: 0.3236, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.3793, Average Test Accuracy(individual): 0.3559,
domain std=0.0828, cluster std=-1.0000, individual std=0.0737, 
