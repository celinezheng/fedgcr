===2023-06-16 04:06:27===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = -1
============ Train epoch 0 ============
 Site-White-0                       | Train Loss: 2.1066 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 2.1088 | Train Acc: 0.3595
 Site-White-2                       | Train Loss: 2.1169 | Train Acc: 0.3293
 Site-White-3                       | Train Loss: 2.1076 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 2.1033 | Train Acc: 0.3590
 Site-Middle_Eastern-0              | Train Loss: 2.1345 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 2.1315 | Train Acc: 0.2366
 Site-Middle_Eastern-2              | Train Loss: 2.1292 | Train Acc: 0.2546
 Site-Black-0                       | Train Loss: 2.1452 | Train Acc: 0.2290
 Site-Black-1                       | Train Loss: 2.1425 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 2.1016 | Train Acc: 0.4453
Average Train Accuracy: 0.3167
 Site-White-0                       | Val  Loss: 2.1295 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 2.1545 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 2.1196 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 2.1060 | Val  Acc: 0.3300
 Site-White-4                       | Val  Loss: 2.1188 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.1375 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 2.1198 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 2.1349 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 2.1323 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.1461 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 2.1150 | Val  Acc: 0.4231
Average Valid Accuracy: 0.2903
 Best site-White-0                   | Epoch:0 | Val Acc: 0.2500
 Best site-White-1                   | Epoch:0 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:0 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:0 | Val Acc: 0.3300
 Best site-White-4                   | Epoch:0 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:0 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:0 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:0 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:0 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:0 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:0 | Val Acc: 0.4231
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 1 ============
 Site-White-0                       | Train Loss: 2.0061 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 2.0197 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 2.0355 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 2.0213 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 2.0132 | Train Acc: 0.3749
 Site-Middle_Eastern-0              | Train Loss: 2.0849 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0804 | Train Acc: 0.2545
 Site-Middle_Eastern-2              | Train Loss: 2.0701 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 2.0940 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0958 | Train Acc: 0.2300
 Site-White_ffhq-0                  | Train Loss: 1.9545 | Train Acc: 0.5602
Average Train Accuracy: 0.3348
 Site-White-0                       | Val  Loss: 2.0798 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 2.0781 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 2.0560 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 2.0252 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 2.0433 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.1016 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 2.0471 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0812 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0891 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.0754 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.9677 | Val  Acc: 0.5128
Average Valid Accuracy: 0.2999
 Best site-White-0                   | Epoch:1 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:1 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:1 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:1 | Val Acc: 0.3600
 Best site-White-4                   | Epoch:1 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:1 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:1 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:1 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:1 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:1 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:1 | Val Acc: 0.5128
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 2 ============
 Site-White-0                       | Train Loss: 1.9392 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.9535 | Train Acc: 0.3719
 Site-White-2                       | Train Loss: 1.9705 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.9565 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.9422 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.8710 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0448 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 2.0288 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 2.0567 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0553 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.8367 | Train Acc: 0.5566
Average Train Accuracy: 0.3336
 Site-White-0                       | Val  Loss: 2.0154 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 2.0171 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.9830 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.9619 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.9808 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0662 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.9821 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0370 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0585 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 2.0308 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.8512 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3013
 Best site-White-0                   | Epoch:2 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:2 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:2 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:2 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:2 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:2 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:2 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:2 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:2 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:2 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:2 | Val Acc: 0.5385
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 3 ============
 Site-White-0                       | Train Loss: 1.8830 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.9138 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.9348 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.9061 | Train Acc: 0.3618
 Site-White-4                       | Train Loss: 1.8865 | Train Acc: 0.3707
 Site-Middle_Eastern-0              | Train Loss: 2.0559 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0169 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9941 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 2.0341 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0373 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 1.7319 | Train Acc: 0.5566
Average Train Accuracy: 0.3335
 Site-White-0                       | Val  Loss: 1.9492 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9842 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9492 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.9100 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.9303 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0559 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.9209 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0128 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0211 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9996 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.7419 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3010
============ Train epoch 4 ============
 Site-White-0                       | Train Loss: 1.8323 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.8669 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.9037 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8667 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.8464 | Train Acc: 0.3699
 Site-Middle_Eastern-0              | Train Loss: 1.9826 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9831 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9672 | Train Acc: 0.2625
 Site-Black-0                       | Train Loss: 1.9942 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0142 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.6501 | Train Acc: 0.5602
Average Train Accuracy: 0.3348
 Site-White-0                       | Val  Loss: 1.9248 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9495 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9333 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.8698 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8909 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0272 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.8877 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9892 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 2.0117 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9803 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.6549 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2998
============ Train epoch 5 ============
 Site-White-0                       | Train Loss: 1.8217 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.8346 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8623 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8338 | Train Acc: 0.3618
 Site-White-4                       | Train Loss: 1.8040 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.7927 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9801 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.9480 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9897 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0173 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.5777 | Train Acc: 0.5602
Average Train Accuracy: 0.3333
 Site-White-0                       | Val  Loss: 1.9164 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9156 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.9005 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.8439 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8646 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0132 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.8535 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9744 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9929 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9664 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.5902 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2998
============ Train epoch 6 ============
 Site-White-0                       | Train Loss: 1.7622 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.8101 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8605 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.8078 | Train Acc: 0.3661
 Site-White-4                       | Train Loss: 1.7853 | Train Acc: 0.3699
 Site-Middle_Eastern-0              | Train Loss: 1.9836 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9383 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9325 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9894 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 2.0123 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.5244 | Train Acc: 0.5748
Average Train Accuracy: 0.3353
 Site-White-0                       | Val  Loss: 1.8771 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.9180 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8724 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7996 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8474 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 2.0152 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.8233 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9577 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9743 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9391 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.5118 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3048
 Best site-White-0                   | Epoch:6 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:6 | Val Acc: 0.2059
 Best site-White-2                   | Epoch:6 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:6 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:6 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:6 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:6 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:6 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:6 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:6 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:6 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 7 ============
 Site-White-0                       | Train Loss: 1.7085 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7939 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8313 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7911 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.7583 | Train Acc: 0.3707
 Site-Middle_Eastern-0              | Train Loss: 1.9733 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9290 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9259 | Train Acc: 0.2572
 Site-Black-0                       | Train Loss: 1.9831 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9833 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4774 | Train Acc: 0.5639
Average Train Accuracy: 0.3348
 Site-White-0                       | Val  Loss: 1.8769 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8834 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8752 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.7846 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8358 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9984 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7886 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9586 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9902 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9199 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4848 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3013
============ Train epoch 8 ============
 Site-White-0                       | Train Loss: 1.7845 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.7843 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.8047 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.7704 | Train Acc: 0.3632
 Site-White-4                       | Train Loss: 1.7377 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.8811 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9219 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.9188 | Train Acc: 0.2651
 Site-Black-0                       | Train Loss: 1.9711 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 2.0010 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4392 | Train Acc: 0.5803
Average Train Accuracy: 0.3364
 Site-White-0                       | Val  Loss: 1.9311 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8841 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8424 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7763 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8170 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9615 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7794 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9280 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9868 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9328 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4456 | Val  Acc: 0.5385
Average Valid Accuracy: 0.2986
============ Train epoch 9 ============
 Site-White-0                       | Train Loss: 1.7692 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7703 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.7981 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.7557 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 1.7245 | Train Acc: 0.3715
 Site-Middle_Eastern-0              | Train Loss: 1.9531 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8950 | Train Acc: 0.2500
 Site-Middle_Eastern-2              | Train Loss: 1.8994 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 1.9508 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9788 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.4073 | Train Acc: 0.5839
Average Train Accuracy: 0.3373
 Site-White-0                       | Val  Loss: 1.8564 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8486 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8392 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7620 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.8070 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9785 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7568 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9453 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9644 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9044 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.4057 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2998
 Test site-White-0                   | Epoch:6 | Test Acc: 0.2619
 Test site-White-1                   | Epoch:6 | Test Acc: 0.3944
 Test site-White-2                   | Epoch:6 | Test Acc: 0.3361
 Test site-White-3                   | Epoch:6 | Test Acc: 0.3168
 Test site-White-4                   | Epoch:6 | Test Acc: 0.3178
 Test site-Middle_Eastern-0          | Epoch:6 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:6 | Test Acc: 0.2615
 Test site-Middle_Eastern-2          | Epoch:6 | Test Acc: 0.2455
 Test site-Black-0                   | Epoch:6 | Test Acc: 0.2200
 Test site-Black-1                   | Epoch:6 | Test Acc: 0.2604
 Test site-White_ffhq-0              | Epoch:6 | Test Acc: 0.5886
White: 0.3254, Middle_Eastern: 0.2374, Black: 0.2402, White_ffhq: 0.5886, 
Average Test Accuracy(group): 0.3479, Average Test Accuracy(individual): 0.3098,
domain std=0.1434, cluster std=-1.0000, individual std=0.1027, 
============ Train epoch 10 ============
 Site-White-0                       | Train Loss: 1.7088 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7495 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.8058 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7462 | Train Acc: 0.3661
 Site-White-4                       | Train Loss: 1.7097 | Train Acc: 0.3732
 Site-Middle_Eastern-0              | Train Loss: 1.7591 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9236 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.8961 | Train Acc: 0.2651
 Site-Black-0                       | Train Loss: 1.9248 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9921 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.3810 | Train Acc: 0.5821
Average Train Accuracy: 0.3376
 Site-White-0                       | Val  Loss: 1.8441 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8607 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8377 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7485 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7912 | Val  Acc: 0.3647
 Site-Middle_Eastern-0              | Val  Loss: 1.9609 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7543 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9200 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9829 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.9039 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3729 | Val  Acc: 0.5256
Average Valid Accuracy: 0.2935
============ Train epoch 11 ============
 Site-White-0                       | Train Loss: 1.8074 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7353 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7839 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7367 | Train Acc: 0.3661
 Site-White-4                       | Train Loss: 1.7016 | Train Acc: 0.3741
 Site-Middle_Eastern-0              | Train Loss: 2.0174 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8859 | Train Acc: 0.2545
 Site-Middle_Eastern-2              | Train Loss: 1.8934 | Train Acc: 0.2677
 Site-Black-0                       | Train Loss: 1.9538 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9624 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.3567 | Train Acc: 0.5785
Average Train Accuracy: 0.3395
 Site-White-0                       | Val  Loss: 1.8488 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8486 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8161 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7399 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7933 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.9404 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7143 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.9278 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9437 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8988 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3512 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3093
 Best site-White-0                   | Epoch:11 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:11 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:11 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:11 | Val Acc: 0.3500
 Best site-White-4                   | Epoch:11 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:11 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:11 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:11 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:11 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:11 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:11 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 12 ============
 Site-White-0                       | Train Loss: 1.7443 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7425 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7851 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7250 | Train Acc: 0.3647
 Site-White-4                       | Train Loss: 1.6903 | Train Acc: 0.3741
 Site-Middle_Eastern-0              | Train Loss: 1.8472 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9151 | Train Acc: 0.2455
 Site-Middle_Eastern-2              | Train Loss: 1.8836 | Train Acc: 0.2677
 Site-Black-0                       | Train Loss: 1.9522 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9795 | Train Acc: 0.2249
 Site-White_ffhq-0                  | Train Loss: 1.3417 | Train Acc: 0.5730
Average Train Accuracy: 0.3365
 Site-White-0                       | Val  Loss: 1.8574 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8207 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.8053 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7492 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7763 | Val  Acc: 0.3529
 Site-Middle_Eastern-0              | Val  Loss: 1.9531 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.7027 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.9184 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9510 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8737 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3223 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2985
============ Train epoch 13 ============
 Site-White-0                       | Train Loss: 1.6313 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7274 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7529 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.7270 | Train Acc: 0.3704
 Site-White-4                       | Train Loss: 1.6795 | Train Acc: 0.3799
 Site-Middle_Eastern-0              | Train Loss: 1.9516 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.9021 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8719 | Train Acc: 0.2730
 Site-Black-0                       | Train Loss: 1.9416 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9934 | Train Acc: 0.2266
 Site-White_ffhq-0                  | Train Loss: 1.3180 | Train Acc: 0.6040
Average Train Accuracy: 0.3430
 Site-White-0                       | Val  Loss: 1.8491 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.8077 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.8166 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7173 | Val  Acc: 0.3400
 Site-White-4                       | Val  Loss: 1.7655 | Val  Acc: 0.3647
 Site-Middle_Eastern-0              | Val  Loss: 1.9872 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6896 | Val  Acc: 0.2500
 Site-Middle_Eastern-2              | Val  Loss: 1.9076 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9621 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8952 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3116 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3008
============ Train epoch 14 ============
 Site-White-0                       | Train Loss: 1.7392 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7196 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7745 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.7115 | Train Acc: 0.3732
 Site-White-4                       | Train Loss: 1.6732 | Train Acc: 0.3808
 Site-Middle_Eastern-0              | Train Loss: 1.6451 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8814 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8719 | Train Acc: 0.2703
 Site-Black-0                       | Train Loss: 1.9274 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9638 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.2986 | Train Acc: 0.6077
Average Train Accuracy: 0.3447
 Site-White-0                       | Val  Loss: 1.8915 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8156 | Val  Acc: 0.2059
 Site-White-2                       | Val  Loss: 1.7898 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.7224 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7618 | Val  Acc: 0.3529
 Site-Middle_Eastern-0              | Val  Loss: 1.9290 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6765 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8987 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9639 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8653 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.3123 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3001
============ Train epoch 15 ============
 Site-White-0                       | Train Loss: 1.6480 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.7021 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7499 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.7038 | Train Acc: 0.3746
 Site-White-4                       | Train Loss: 1.6619 | Train Acc: 0.3816
 Site-Middle_Eastern-0              | Train Loss: 1.6076 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8987 | Train Acc: 0.2679
 Site-Middle_Eastern-2              | Train Loss: 1.8684 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.9052 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9513 | Train Acc: 0.2283
 Site-White_ffhq-0                  | Train Loss: 1.2892 | Train Acc: 0.5912
Average Train Accuracy: 0.3444
 Site-White-0                       | Val  Loss: 1.9097 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7977 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8094 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.7040 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.7778 | Val  Acc: 0.3647
 Site-Middle_Eastern-0              | Val  Loss: 1.9393 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6353 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.9021 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9506 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8796 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2911 | Val  Acc: 0.5256
Average Valid Accuracy: 0.2946
============ Train epoch 16 ============
 Site-White-0                       | Train Loss: 1.6962 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7102 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7535 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.6988 | Train Acc: 0.3718
 Site-White-4                       | Train Loss: 1.6612 | Train Acc: 0.3833
 Site-Middle_Eastern-0              | Train Loss: 1.9011 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8890 | Train Acc: 0.2545
 Site-Middle_Eastern-2              | Train Loss: 1.8672 | Train Acc: 0.2756
 Site-Black-0                       | Train Loss: 1.9167 | Train Acc: 0.2522
 Site-Black-1                       | Train Loss: 1.9390 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.2772 | Train Acc: 0.6040
Average Train Accuracy: 0.3440
 Site-White-0                       | Val  Loss: 1.8814 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.8281 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.8038 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6926 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7491 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.9427 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6273 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8965 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9425 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8598 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2654 | Val  Acc: 0.5385
Average Valid Accuracy: 0.3026
============ Train epoch 17 ============
 Site-White-0                       | Train Loss: 1.7498 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.7049 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.7290 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.6956 | Train Acc: 0.3746
 Site-White-4                       | Train Loss: 1.6446 | Train Acc: 0.3791
 Site-Middle_Eastern-0              | Train Loss: 1.7436 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8682 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8455 | Train Acc: 0.2756
 Site-Black-0                       | Train Loss: 1.9124 | Train Acc: 0.2609
 Site-Black-1                       | Train Loss: 1.9435 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.2660 | Train Acc: 0.6004
Average Train Accuracy: 0.3447
 Site-White-0                       | Val  Loss: 1.8458 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7979 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.8122 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.7142 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7586 | Val  Acc: 0.3706
 Site-Middle_Eastern-0              | Val  Loss: 1.9206 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6549 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8687 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9402 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8538 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2556 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3099
 Best site-White-0                   | Epoch:17 | Val Acc: 0.2500
 Best site-White-1                   | Epoch:17 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:17 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:17 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:17 | Val Acc: 0.3706
 Best site-Middle_Eastern-0          | Epoch:17 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:17 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:17 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:17 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:17 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:17 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 18 ============
 Site-White-0                       | Train Loss: 1.6296 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.7028 | Train Acc: 0.3760
 Site-White-2                       | Train Loss: 1.7532 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6899 | Train Acc: 0.3761
 Site-White-4                       | Train Loss: 1.6480 | Train Acc: 0.3883
 Site-Middle_Eastern-0              | Train Loss: 1.8819 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8553 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8452 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.9051 | Train Acc: 0.2464
 Site-Black-1                       | Train Loss: 1.9459 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.2615 | Train Acc: 0.5949
Average Train Accuracy: 0.3462
 Site-White-0                       | Val  Loss: 1.8678 | Val  Acc: 0.2000
 Site-White-1                       | Val  Loss: 1.7880 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7959 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6982 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7383 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.9551 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6564 | Val  Acc: 0.2500
 Site-Middle_Eastern-2              | Val  Loss: 1.8906 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9295 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8575 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2809 | Val  Acc: 0.5641
Average Valid Accuracy: 0.2993
============ Train epoch 19 ============
 Site-White-0                       | Train Loss: 1.6077 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6937 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7368 | Train Acc: 0.3438
 Site-White-3                       | Train Loss: 1.6835 | Train Acc: 0.3789
 Site-White-4                       | Train Loss: 1.6420 | Train Acc: 0.3849
 Site-Middle_Eastern-0              | Train Loss: 1.8448 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8726 | Train Acc: 0.2589
 Site-Middle_Eastern-2              | Train Loss: 1.8413 | Train Acc: 0.2703
 Site-Black-0                       | Train Loss: 1.8883 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.9084 | Train Acc: 0.2351
 Site-White_ffhq-0                  | Train Loss: 1.2492 | Train Acc: 0.6204
Average Train Accuracy: 0.3491
 Site-White-0                       | Val  Loss: 1.8266 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7819 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7999 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.7040 | Val  Acc: 0.3600
 Site-White-4                       | Val  Loss: 1.7365 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.8871 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6394 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8830 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9279 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8442 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2445 | Val  Acc: 0.5256
Average Valid Accuracy: 0.3062
 Test site-White-0                   | Epoch:17 | Test Acc: 0.2857
 Test site-White-1                   | Epoch:17 | Test Acc: 0.3944
 Test site-White-2                   | Epoch:17 | Test Acc: 0.3697
 Test site-White-3                   | Epoch:17 | Test Acc: 0.3119
 Test site-White-4                   | Epoch:17 | Test Acc: 0.3353
 Test site-Middle_Eastern-0          | Epoch:17 | Test Acc: 0.1795
 Test site-Middle_Eastern-1          | Epoch:17 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:17 | Test Acc: 0.2455
 Test site-Black-0                   | Epoch:17 | Test Acc: 0.2500
 Test site-Black-1                   | Epoch:17 | Test Acc: 0.2604
 Test site-White_ffhq-0              | Epoch:17 | Test Acc: 0.5759
White: 0.3394, Middle_Eastern: 0.2340, Black: 0.2552, White_ffhq: 0.5759, 
Average Test Accuracy(group): 0.3511, Average Test Accuracy(individual): 0.3168,
domain std=0.1357, cluster std=-1.0000, individual std=0.1002, 
============ Train epoch 20 ============
 Site-White-0                       | Train Loss: 1.6575 | Train Acc: 0.3732
 Site-White-1                       | Train Loss: 1.6990 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.7023 | Train Acc: 0.3462
 Site-White-3                       | Train Loss: 1.6746 | Train Acc: 0.3775
 Site-White-4                       | Train Loss: 1.6323 | Train Acc: 0.3891
 Site-Middle_Eastern-0              | Train Loss: 1.6960 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8763 | Train Acc: 0.2634
 Site-Middle_Eastern-2              | Train Loss: 1.8358 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.8991 | Train Acc: 0.2551
 Site-Black-1                       | Train Loss: 1.9212 | Train Acc: 0.2317
 Site-White_ffhq-0                  | Train Loss: 1.2357 | Train Acc: 0.6113
Average Train Accuracy: 0.3468
 Site-White-0                       | Val  Loss: 1.8052 | Val  Acc: 0.2000
 Site-White-1                       | Val  Loss: 1.8004 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.7715 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.7006 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7359 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.9190 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6479 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8907 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9426 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8518 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2307 | Val  Acc: 0.5513
Average Valid Accuracy: 0.2995
============ Train epoch 21 ============
 Site-White-0                       | Train Loss: 1.6085 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.6771 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7416 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.6734 | Train Acc: 0.3689
 Site-White-4                       | Train Loss: 1.6291 | Train Acc: 0.3808
 Site-Middle_Eastern-0              | Train Loss: 1.5473 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8661 | Train Acc: 0.2723
 Site-Middle_Eastern-2              | Train Loss: 1.8449 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.8966 | Train Acc: 0.2580
 Site-Black-1                       | Train Loss: 1.9086 | Train Acc: 0.2181
 Site-White_ffhq-0                  | Train Loss: 1.2340 | Train Acc: 0.6004
Average Train Accuracy: 0.3454
 Site-White-0                       | Val  Loss: 1.8379 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7743 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7940 | Val  Acc: 0.2712
 Site-White-3                       | Val  Loss: 1.6983 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7247 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.9057 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6156 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8930 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9377 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8257 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2398 | Val  Acc: 0.5128
Average Valid Accuracy: 0.3033
============ Train epoch 22 ============
 Site-White-0                       | Train Loss: 1.6379 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6763 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7064 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6670 | Train Acc: 0.3818
 Site-White-4                       | Train Loss: 1.6235 | Train Acc: 0.3900
 Site-Middle_Eastern-0              | Train Loss: 1.6123 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8442 | Train Acc: 0.2857
 Site-Middle_Eastern-2              | Train Loss: 1.8382 | Train Acc: 0.2861
 Site-Black-0                       | Train Loss: 1.8882 | Train Acc: 0.2580
 Site-Black-1                       | Train Loss: 1.9024 | Train Acc: 0.2385
 Site-White_ffhq-0                  | Train Loss: 1.2318 | Train Acc: 0.5949
Average Train Accuracy: 0.3502
 Site-White-0                       | Val  Loss: 1.8540 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7773 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7899 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6834 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7206 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8839 | Val  Acc: 0.1667
 Site-Middle_Eastern-1              | Val  Loss: 1.6236 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8447 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9184 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8514 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2161 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3128
 Best site-White-0                   | Epoch:22 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:22 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:22 | Val Acc: 0.2881
 Best site-White-3                   | Epoch:22 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:22 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:22 | Val Acc: 0.1667
 Best site-Middle_Eastern-1          | Epoch:22 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:22 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:22 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:22 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:22 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 23 ============
 Site-White-0                       | Train Loss: 1.5529 | Train Acc: 0.3803
 Site-White-1                       | Train Loss: 1.6768 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.7225 | Train Acc: 0.3390
 Site-White-3                       | Train Loss: 1.6629 | Train Acc: 0.3789
 Site-White-4                       | Train Loss: 1.6184 | Train Acc: 0.3908
 Site-Middle_Eastern-0              | Train Loss: 1.9469 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8553 | Train Acc: 0.2857
 Site-Middle_Eastern-2              | Train Loss: 1.8224 | Train Acc: 0.2808
 Site-Black-0                       | Train Loss: 1.8795 | Train Acc: 0.2609
 Site-Black-1                       | Train Loss: 1.9103 | Train Acc: 0.2487
 Site-White_ffhq-0                  | Train Loss: 1.2211 | Train Acc: 0.6223
Average Train Accuracy: 0.3511
 Site-White-0                       | Val  Loss: 1.8012 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7622 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7832 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6769 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7222 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8967 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5867 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8490 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.9178 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8322 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2117 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3199
 Best site-White-0                   | Epoch:23 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:23 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:23 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:23 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:23 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:23 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:23 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:23 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:23 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:23 | Val Acc: 0.3012
 Best site-White_ffhq-0              | Epoch:23 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 24 ============
 Site-White-0                       | Train Loss: 1.5724 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6568 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.7033 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6554 | Train Acc: 0.3789
 Site-White-4                       | Train Loss: 1.6097 | Train Acc: 0.3925
 Site-Middle_Eastern-0              | Train Loss: 1.6393 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8348 | Train Acc: 0.2679
 Site-Middle_Eastern-2              | Train Loss: 1.8126 | Train Acc: 0.2940
 Site-Black-0                       | Train Loss: 1.8899 | Train Acc: 0.2493
 Site-Black-1                       | Train Loss: 1.8814 | Train Acc: 0.2385
 Site-White_ffhq-0                  | Train Loss: 1.2180 | Train Acc: 0.6040
Average Train Accuracy: 0.3521
 Site-White-0                       | Val  Loss: 1.8149 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7680 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7687 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6587 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.7275 | Val  Acc: 0.3706
 Site-Middle_Eastern-0              | Val  Loss: 1.8581 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5972 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8365 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8866 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8264 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2026 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3213
 Best site-White-0                   | Epoch:24 | Val Acc: 0.2500
 Best site-White-1                   | Epoch:24 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:24 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:24 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:24 | Val Acc: 0.3706
 Best site-Middle_Eastern-0          | Epoch:24 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:24 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:24 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:24 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:24 | Val Acc: 0.3253
 Best site-White_ffhq-0              | Epoch:24 | Val Acc: 0.5641
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 25 ============
 Site-White-0                       | Train Loss: 1.5636 | Train Acc: 0.4085
 Site-White-1                       | Train Loss: 1.6638 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.7046 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6526 | Train Acc: 0.3789
 Site-White-4                       | Train Loss: 1.6099 | Train Acc: 0.3950
 Site-Middle_Eastern-0              | Train Loss: 1.7219 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8516 | Train Acc: 0.3036
 Site-Middle_Eastern-2              | Train Loss: 1.8171 | Train Acc: 0.2861
 Site-Black-0                       | Train Loss: 1.8633 | Train Acc: 0.2580
 Site-Black-1                       | Train Loss: 1.8942 | Train Acc: 0.2419
 Site-White_ffhq-0                  | Train Loss: 1.2101 | Train Acc: 0.6223
Average Train Accuracy: 0.3583
 Site-White-0                       | Val  Loss: 1.8321 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7386 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.7778 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6565 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.7075 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.9124 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5984 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8654 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8914 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8427 | Val  Acc: 0.3373
 Site-White_ffhq-0                  | Val  Loss: 1.1887 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3224
 Best site-White-0                   | Epoch:25 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:25 | Val Acc: 0.2353
 Best site-White-2                   | Epoch:25 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:25 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:25 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:25 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:25 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:25 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:25 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:25 | Val Acc: 0.3373
 Best site-White_ffhq-0              | Epoch:25 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 26 ============
 Site-White-0                       | Train Loss: 1.5519 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6523 | Train Acc: 0.3678
 Site-White-2                       | Train Loss: 1.6951 | Train Acc: 0.3487
 Site-White-3                       | Train Loss: 1.6455 | Train Acc: 0.3846
 Site-White-4                       | Train Loss: 1.6054 | Train Acc: 0.3900
 Site-Middle_Eastern-0              | Train Loss: 1.6556 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8824 | Train Acc: 0.2768
 Site-Middle_Eastern-2              | Train Loss: 1.8096 | Train Acc: 0.2966
 Site-Black-0                       | Train Loss: 1.8644 | Train Acc: 0.2696
 Site-Black-1                       | Train Loss: 1.8679 | Train Acc: 0.2436
 Site-White_ffhq-0                  | Train Loss: 1.2096 | Train Acc: 0.6277
Average Train Accuracy: 0.3549
 Site-White-0                       | Val  Loss: 1.8023 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7240 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7713 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6606 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6959 | Val  Acc: 0.3588
 Site-Middle_Eastern-0              | Val  Loss: 1.8718 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5815 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8211 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.9185 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8464 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.2045 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3302
 Best site-White-0                   | Epoch:26 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:26 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:26 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:26 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:26 | Val Acc: 0.3588
 Best site-Middle_Eastern-0          | Epoch:26 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:26 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:26 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:26 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:26 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:26 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 27 ============
 Site-White-0                       | Train Loss: 1.6129 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.6510 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.6873 | Train Acc: 0.3511
 Site-White-3                       | Train Loss: 1.6460 | Train Acc: 0.3932
 Site-White-4                       | Train Loss: 1.6017 | Train Acc: 0.3941
 Site-Middle_Eastern-0              | Train Loss: 1.7530 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8210 | Train Acc: 0.2857
 Site-Middle_Eastern-2              | Train Loss: 1.8046 | Train Acc: 0.3018
 Site-Black-0                       | Train Loss: 1.8573 | Train Acc: 0.2609
 Site-Black-1                       | Train Loss: 1.8624 | Train Acc: 0.2487
 Site-White_ffhq-0                  | Train Loss: 1.2078 | Train Acc: 0.6168
Average Train Accuracy: 0.3554
 Site-White-0                       | Val  Loss: 1.8070 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7571 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7669 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6486 | Val  Acc: 0.4100
 Site-White-4                       | Val  Loss: 1.6990 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8561 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5768 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 1.8172 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8993 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8374 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.1980 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3236
============ Train epoch 28 ============
 Site-White-0                       | Train Loss: 1.5652 | Train Acc: 0.3873
 Site-White-1                       | Train Loss: 1.6448 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.6730 | Train Acc: 0.3559
 Site-White-3                       | Train Loss: 1.6456 | Train Acc: 0.3875
 Site-White-4                       | Train Loss: 1.5930 | Train Acc: 0.3992
 Site-Middle_Eastern-0              | Train Loss: 1.8186 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8190 | Train Acc: 0.2946
 Site-Middle_Eastern-2              | Train Loss: 1.8023 | Train Acc: 0.2940
 Site-Black-0                       | Train Loss: 1.8668 | Train Acc: 0.2667
 Site-Black-1                       | Train Loss: 1.8489 | Train Acc: 0.2436
 Site-White_ffhq-0                  | Train Loss: 1.2078 | Train Acc: 0.6022
Average Train Accuracy: 0.3561
 Site-White-0                       | Val  Loss: 1.8600 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7481 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7658 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.6570 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6872 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.8795 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5767 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8174 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8887 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.8075 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.2143 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3173
============ Train epoch 29 ============
 Site-White-0                       | Train Loss: 1.5907 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6547 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6856 | Train Acc: 0.3608
 Site-White-3                       | Train Loss: 1.6356 | Train Acc: 0.3875
 Site-White-4                       | Train Loss: 1.5888 | Train Acc: 0.3958
 Site-Middle_Eastern-0              | Train Loss: 1.9879 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8299 | Train Acc: 0.3036
 Site-Middle_Eastern-2              | Train Loss: 1.7997 | Train Acc: 0.2913
 Site-Black-0                       | Train Loss: 1.8389 | Train Acc: 0.2638
 Site-Black-1                       | Train Loss: 1.8937 | Train Acc: 0.2572
 Site-White_ffhq-0                  | Train Loss: 1.2054 | Train Acc: 0.6186
Average Train Accuracy: 0.3616
 Site-White-0                       | Val  Loss: 1.7635 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7410 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7732 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6721 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6749 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8670 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5801 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8259 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8983 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8041 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.2029 | Val  Acc: 0.5256
Average Valid Accuracy: 0.3243
 Test site-White-0                   | Epoch:26 | Test Acc: 0.2381
 Test site-White-1                   | Epoch:26 | Test Acc: 0.3803
 Test site-White-2                   | Epoch:26 | Test Acc: 0.3950
 Test site-White-3                   | Epoch:26 | Test Acc: 0.3168
 Test site-White-4                   | Epoch:26 | Test Acc: 0.3353
 Test site-Middle_Eastern-0          | Epoch:26 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:26 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:26 | Test Acc: 0.2727
 Test site-Black-0                   | Epoch:26 | Test Acc: 0.2700
 Test site-Black-1                   | Epoch:26 | Test Acc: 0.3077
 Test site-White_ffhq-0              | Epoch:26 | Test Acc: 0.5823
White: 0.3331, Middle_Eastern: 0.2516, Black: 0.2888, White_ffhq: 0.5823, 
Average Test Accuracy(group): 0.3640, Average Test Accuracy(individual): 0.3255,
domain std=0.1293, cluster std=-1.0000, individual std=0.0975, 
============ Train epoch 30 ============
 Site-White-0                       | Train Loss: 1.5914 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6589 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.6681 | Train Acc: 0.3559
 Site-White-3                       | Train Loss: 1.6312 | Train Acc: 0.3932
 Site-White-4                       | Train Loss: 1.5842 | Train Acc: 0.4017
 Site-Middle_Eastern-0              | Train Loss: 1.9042 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.8163 | Train Acc: 0.2812
 Site-Middle_Eastern-2              | Train Loss: 1.7948 | Train Acc: 0.2992
 Site-Black-0                       | Train Loss: 1.8585 | Train Acc: 0.2696
 Site-Black-1                       | Train Loss: 1.8673 | Train Acc: 0.2555
 Site-White_ffhq-0                  | Train Loss: 1.1980 | Train Acc: 0.6168
Average Train Accuracy: 0.3600
 Site-White-0                       | Val  Loss: 1.7803 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7263 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7708 | Val  Acc: 0.2712
 Site-White-3                       | Val  Loss: 1.6612 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6768 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.8528 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.6028 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8293 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8927 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8347 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1728 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3272
============ Train epoch 31 ============
 Site-White-0                       | Train Loss: 1.6346 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6307 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.6734 | Train Acc: 0.3559
 Site-White-3                       | Train Loss: 1.6206 | Train Acc: 0.3803
 Site-White-4                       | Train Loss: 1.5756 | Train Acc: 0.3992
 Site-Middle_Eastern-0              | Train Loss: 1.9450 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 1.8113 | Train Acc: 0.2991
 Site-Middle_Eastern-2              | Train Loss: 1.8012 | Train Acc: 0.2966
 Site-Black-0                       | Train Loss: 1.8377 | Train Acc: 0.2841
 Site-Black-1                       | Train Loss: 1.8615 | Train Acc: 0.2538
 Site-White_ffhq-0                  | Train Loss: 1.2010 | Train Acc: 0.6223
Average Train Accuracy: 0.3603
 Site-White-0                       | Val  Loss: 1.7963 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7227 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7443 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6448 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6670 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8865 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5917 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.8068 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8814 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.8217 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1715 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3327
 Best site-White-0                   | Epoch:31 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:31 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:31 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:31 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:31 | Val Acc: 0.3824
 Best site-Middle_Eastern-0          | Epoch:31 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:31 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:31 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:31 | Val Acc: 0.2245
 Best site-Black-1                   | Epoch:31 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:31 | Val Acc: 0.6026
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 32 ============
 Site-White-0                       | Train Loss: 1.6431 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6112 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6709 | Train Acc: 0.3535
 Site-White-3                       | Train Loss: 1.6172 | Train Acc: 0.3803
 Site-White-4                       | Train Loss: 1.5734 | Train Acc: 0.3983
 Site-Middle_Eastern-0              | Train Loss: 1.8373 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.8049 | Train Acc: 0.2946
 Site-Middle_Eastern-2              | Train Loss: 1.7783 | Train Acc: 0.2966
 Site-Black-0                       | Train Loss: 1.8365 | Train Acc: 0.2667
 Site-Black-1                       | Train Loss: 1.8699 | Train Acc: 0.2521
 Site-White_ffhq-0                  | Train Loss: 1.1955 | Train Acc: 0.6223
Average Train Accuracy: 0.3582
 Site-White-0                       | Val  Loss: 1.8294 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7107 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7434 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6506 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6684 | Val  Acc: 0.3765
 Site-Middle_Eastern-0              | Val  Loss: 1.8590 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5402 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7840 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8672 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8164 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1871 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3344
 Best site-White-0                   | Epoch:32 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:32 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:32 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:32 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:32 | Val Acc: 0.3765
 Best site-Middle_Eastern-0          | Epoch:32 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:32 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:32 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:32 | Val Acc: 0.2449
 Best site-Black-1                   | Epoch:32 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:32 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 33 ============
 Site-White-0                       | Train Loss: 1.5576 | Train Acc: 0.3944
 Site-White-1                       | Train Loss: 1.6231 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6606 | Train Acc: 0.3559
 Site-White-3                       | Train Loss: 1.6204 | Train Acc: 0.3818
 Site-White-4                       | Train Loss: 1.5658 | Train Acc: 0.3983
 Site-Middle_Eastern-0              | Train Loss: 1.6951 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7900 | Train Acc: 0.2902
 Site-Middle_Eastern-2              | Train Loss: 1.7911 | Train Acc: 0.2940
 Site-Black-0                       | Train Loss: 1.8311 | Train Acc: 0.2812
 Site-Black-1                       | Train Loss: 1.8822 | Train Acc: 0.2606
 Site-White_ffhq-0                  | Train Loss: 1.1955 | Train Acc: 0.6113
Average Train Accuracy: 0.3604
 Site-White-0                       | Val  Loss: 1.8022 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7235 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7375 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6327 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6642 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8478 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5300 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.8220 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8548 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.8284 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1824 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3308
============ Train epoch 34 ============
 Site-White-0                       | Train Loss: 1.4912 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6312 | Train Acc: 0.3719
 Site-White-2                       | Train Loss: 1.6710 | Train Acc: 0.3656
 Site-White-3                       | Train Loss: 1.6129 | Train Acc: 0.3974
 Site-White-4                       | Train Loss: 1.5673 | Train Acc: 0.4025
 Site-Middle_Eastern-0              | Train Loss: 1.6897 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.8098 | Train Acc: 0.3170
 Site-Middle_Eastern-2              | Train Loss: 1.7725 | Train Acc: 0.3176
 Site-Black-0                       | Train Loss: 1.8274 | Train Acc: 0.2754
 Site-Black-1                       | Train Loss: 1.8203 | Train Acc: 0.2641
 Site-White_ffhq-0                  | Train Loss: 1.1938 | Train Acc: 0.6150
Average Train Accuracy: 0.3673
 Site-White-0                       | Val  Loss: 1.7684 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7378 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7341 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6369 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6567 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.8225 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5627 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7919 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8778 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8139 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.1768 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3344
 Best site-White-0                   | Epoch:34 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:34 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:34 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:34 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:34 | Val Acc: 0.3882
 Best site-Middle_Eastern-0          | Epoch:34 | Val Acc: 0.2222
 Best site-Middle_Eastern-1          | Epoch:34 | Val Acc: 0.3438
 Best site-Middle_Eastern-2          | Epoch:34 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:34 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:34 | Val Acc: 0.3012
 Best site-White_ffhq-0              | Epoch:34 | Val Acc: 0.5897
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 35 ============
 Site-White-0                       | Train Loss: 1.5739 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6122 | Train Acc: 0.3843
 Site-White-2                       | Train Loss: 1.6429 | Train Acc: 0.3584
 Site-White-3                       | Train Loss: 1.6088 | Train Acc: 0.3917
 Site-White-4                       | Train Loss: 1.5603 | Train Acc: 0.4075
 Site-Middle_Eastern-0              | Train Loss: 1.9885 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.7684 | Train Acc: 0.2812
 Site-Middle_Eastern-2              | Train Loss: 1.7688 | Train Acc: 0.3097
 Site-Black-0                       | Train Loss: 1.8462 | Train Acc: 0.2841
 Site-Black-1                       | Train Loss: 1.8624 | Train Acc: 0.2641
 Site-White_ffhq-0                  | Train Loss: 1.1897 | Train Acc: 0.6223
Average Train Accuracy: 0.3645
 Site-White-0                       | Val  Loss: 1.8113 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7541 | Val  Acc: 0.2353
 Site-White-2                       | Val  Loss: 1.7637 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6487 | Val  Acc: 0.4100
 Site-White-4                       | Val  Loss: 1.6592 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8824 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5173 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7864 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8453 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.7934 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1782 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3251
============ Train epoch 36 ============
 Site-White-0                       | Train Loss: 1.6770 | Train Acc: 0.4014
 Site-White-1                       | Train Loss: 1.6247 | Train Acc: 0.3884
 Site-White-2                       | Train Loss: 1.6469 | Train Acc: 0.3656
 Site-White-3                       | Train Loss: 1.6003 | Train Acc: 0.3960
 Site-White-4                       | Train Loss: 1.5593 | Train Acc: 0.4151
 Site-Middle_Eastern-0              | Train Loss: 1.7401 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.7856 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 1.7610 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.8262 | Train Acc: 0.2841
 Site-Black-1                       | Train Loss: 1.8287 | Train Acc: 0.2692
 Site-White_ffhq-0                  | Train Loss: 1.1892 | Train Acc: 0.6022
Average Train Accuracy: 0.3687
 Site-White-0                       | Val  Loss: 1.7676 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.7228 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7256 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6059 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6601 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8398 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5261 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.7918 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8507 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8042 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1703 | Val  Acc: 0.5769
Average Valid Accuracy: 0.3480
 Best site-White-0                   | Epoch:36 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:36 | Val Acc: 0.2941
 Best site-White-2                   | Epoch:36 | Val Acc: 0.3390
 Best site-White-3                   | Epoch:36 | Val Acc: 0.3900
 Best site-White-4                   | Epoch:36 | Val Acc: 0.3941
 Best site-Middle_Eastern-0          | Epoch:36 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:36 | Val Acc: 0.4062
 Best site-Middle_Eastern-2          | Epoch:36 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:36 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:36 | Val Acc: 0.3253
 Best site-White_ffhq-0              | Epoch:36 | Val Acc: 0.5769
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 37 ============
 Site-White-0                       | Train Loss: 1.5658 | Train Acc: 0.4155
 Site-White-1                       | Train Loss: 1.6170 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6610 | Train Acc: 0.3729
 Site-White-3                       | Train Loss: 1.6038 | Train Acc: 0.3960
 Site-White-4                       | Train Loss: 1.5518 | Train Acc: 0.4075
 Site-Middle_Eastern-0              | Train Loss: 1.4998 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 1.7787 | Train Acc: 0.3036
 Site-Middle_Eastern-2              | Train Loss: 1.7623 | Train Acc: 0.3045
 Site-Black-0                       | Train Loss: 1.7872 | Train Acc: 0.3043
 Site-Black-1                       | Train Loss: 1.8427 | Train Acc: 0.2709
 Site-White_ffhq-0                  | Train Loss: 1.1715 | Train Acc: 0.6277
Average Train Accuracy: 0.3732
 Site-White-0                       | Val  Loss: 1.7552 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7275 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7327 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6227 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6656 | Val  Acc: 0.4000
 Site-Middle_Eastern-0              | Val  Loss: 1.8301 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5104 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7845 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8962 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7975 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.1649 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3402
============ Train epoch 38 ============
 Site-White-0                       | Train Loss: 1.5894 | Train Acc: 0.4296
 Site-White-1                       | Train Loss: 1.6111 | Train Acc: 0.4008
 Site-White-2                       | Train Loss: 1.6506 | Train Acc: 0.3729
 Site-White-3                       | Train Loss: 1.5942 | Train Acc: 0.3917
 Site-White-4                       | Train Loss: 1.5532 | Train Acc: 0.4075
 Site-Middle_Eastern-0              | Train Loss: 1.6387 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.8084 | Train Acc: 0.3214
 Site-Middle_Eastern-2              | Train Loss: 1.7601 | Train Acc: 0.3045
 Site-Black-0                       | Train Loss: 1.8205 | Train Acc: 0.2986
 Site-Black-1                       | Train Loss: 1.8509 | Train Acc: 0.2845
 Site-White_ffhq-0                  | Train Loss: 1.1843 | Train Acc: 0.6223
Average Train Accuracy: 0.3756
 Site-White-0                       | Val  Loss: 1.8077 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6905 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7181 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6306 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6429 | Val  Acc: 0.3824
 Site-Middle_Eastern-0              | Val  Loss: 1.8021 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5363 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7648 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8449 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.8009 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1749 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3330
============ Train epoch 39 ============
 Site-White-0                       | Train Loss: 1.6102 | Train Acc: 0.4155
 Site-White-1                       | Train Loss: 1.6170 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6405 | Train Acc: 0.3680
 Site-White-3                       | Train Loss: 1.5914 | Train Acc: 0.3903
 Site-White-4                       | Train Loss: 1.5517 | Train Acc: 0.4075
 Site-Middle_Eastern-0              | Train Loss: 1.7088 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.7747 | Train Acc: 0.2991
 Site-Middle_Eastern-2              | Train Loss: 1.7443 | Train Acc: 0.3097
 Site-Black-0                       | Train Loss: 1.8128 | Train Acc: 0.3101
 Site-Black-1                       | Train Loss: 1.7967 | Train Acc: 0.2896
 Site-White_ffhq-0                  | Train Loss: 1.1794 | Train Acc: 0.6277
Average Train Accuracy: 0.3759
 Site-White-0                       | Val  Loss: 1.7817 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6937 | Val  Acc: 0.2941
 Site-White-2                       | Val  Loss: 1.7276 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6373 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6382 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.7987 | Val  Acc: 0.2222
 Site-Middle_Eastern-1              | Val  Loss: 1.5351 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7840 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8341 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7876 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1606 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3372
 Test site-White-0                   | Epoch:36 | Test Acc: 0.2619
 Test site-White-1                   | Epoch:36 | Test Acc: 0.4507
 Test site-White-2                   | Epoch:36 | Test Acc: 0.3697
 Test site-White-3                   | Epoch:36 | Test Acc: 0.3317
 Test site-White-4                   | Epoch:36 | Test Acc: 0.3528
 Test site-Middle_Eastern-0          | Epoch:36 | Test Acc: 0.2051
 Test site-Middle_Eastern-1          | Epoch:36 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:36 | Test Acc: 0.2727
 Test site-Black-0                   | Epoch:36 | Test Acc: 0.2900
 Test site-Black-1                   | Epoch:36 | Test Acc: 0.3550
 Test site-White_ffhq-0              | Epoch:36 | Test Acc: 0.5949
White: 0.3534, Middle_Eastern: 0.2516, Black: 0.3225, White_ffhq: 0.5949, 
Average Test Accuracy(group): 0.3806, Average Test Accuracy(individual): 0.3420,
domain std=0.1291, cluster std=-1.0000, individual std=0.1017, 
============ Train epoch 40 ============
 Site-White-0                       | Train Loss: 1.5274 | Train Acc: 0.4577
 Site-White-1                       | Train Loss: 1.6070 | Train Acc: 0.4008
 Site-White-2                       | Train Loss: 1.6362 | Train Acc: 0.3777
 Site-White-3                       | Train Loss: 1.5892 | Train Acc: 0.3946
 Site-White-4                       | Train Loss: 1.5454 | Train Acc: 0.4151
 Site-Middle_Eastern-0              | Train Loss: 1.8751 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.7331 | Train Acc: 0.3125
 Site-Middle_Eastern-2              | Train Loss: 1.7520 | Train Acc: 0.3123
 Site-Black-0                       | Train Loss: 1.8043 | Train Acc: 0.3014
 Site-Black-1                       | Train Loss: 1.8050 | Train Acc: 0.2862
 Site-White_ffhq-0                  | Train Loss: 1.1815 | Train Acc: 0.6277
Average Train Accuracy: 0.3838
 Site-White-0                       | Val  Loss: 1.8035 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7097 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7280 | Val  Acc: 0.2712
 Site-White-3                       | Val  Loss: 1.6126 | Val  Acc: 0.3500
 Site-White-4                       | Val  Loss: 1.6419 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.7972 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5181 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.7617 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8564 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.8033 | Val  Acc: 0.3012
 Site-White_ffhq-0                  | Val  Loss: 1.1649 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3291
============ Train epoch 41 ============
 Site-White-0                       | Train Loss: 1.5777 | Train Acc: 0.4577
 Site-White-1                       | Train Loss: 1.5935 | Train Acc: 0.4008
 Site-White-2                       | Train Loss: 1.6259 | Train Acc: 0.3826
 Site-White-3                       | Train Loss: 1.5788 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5336 | Train Acc: 0.4218
 Site-Middle_Eastern-0              | Train Loss: 1.5900 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.7381 | Train Acc: 0.2812
 Site-Middle_Eastern-2              | Train Loss: 1.7412 | Train Acc: 0.3150
 Site-Black-0                       | Train Loss: 1.8232 | Train Acc: 0.2957
 Site-Black-1                       | Train Loss: 1.8267 | Train Acc: 0.2879
 Site-White_ffhq-0                  | Train Loss: 1.1786 | Train Acc: 0.6150
Average Train Accuracy: 0.3805
 Site-White-0                       | Val  Loss: 1.8191 | Val  Acc: 0.2500
 Site-White-1                       | Val  Loss: 1.7248 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7241 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6089 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6473 | Val  Acc: 0.3882
 Site-Middle_Eastern-0              | Val  Loss: 1.7999 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5185 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7955 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8677 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7949 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1538 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3251
============ Train epoch 42 ============
 Site-White-0                       | Train Loss: 1.5755 | Train Acc: 0.4507
 Site-White-1                       | Train Loss: 1.5846 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6320 | Train Acc: 0.3850
 Site-White-3                       | Train Loss: 1.5823 | Train Acc: 0.3932
 Site-White-4                       | Train Loss: 1.5355 | Train Acc: 0.4167
 Site-Middle_Eastern-0              | Train Loss: 1.6323 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.7728 | Train Acc: 0.3214
 Site-Middle_Eastern-2              | Train Loss: 1.7420 | Train Acc: 0.3097
 Site-Black-0                       | Train Loss: 1.8066 | Train Acc: 0.3072
 Site-Black-1                       | Train Loss: 1.7856 | Train Acc: 0.3066
 Site-White_ffhq-0                  | Train Loss: 1.1787 | Train Acc: 0.6186
Average Train Accuracy: 0.3863
 Site-White-0                       | Val  Loss: 1.8166 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.7050 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7340 | Val  Acc: 0.3390
 Site-White-3                       | Val  Loss: 1.6142 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6300 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.8016 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.5363 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7397 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8239 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7652 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1357 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3463
============ Train epoch 43 ============
 Site-White-0                       | Train Loss: 1.5116 | Train Acc: 0.4648
 Site-White-1                       | Train Loss: 1.5999 | Train Acc: 0.3802
 Site-White-2                       | Train Loss: 1.6101 | Train Acc: 0.3923
 Site-White-3                       | Train Loss: 1.5777 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5352 | Train Acc: 0.4326
 Site-Middle_Eastern-0              | Train Loss: 1.7351 | Train Acc: 0.3511
 Site-Middle_Eastern-1              | Train Loss: 1.7598 | Train Acc: 0.3125
 Site-Middle_Eastern-2              | Train Loss: 1.7333 | Train Acc: 0.3281
 Site-Black-0                       | Train Loss: 1.7965 | Train Acc: 0.3101
 Site-Black-1                       | Train Loss: 1.8006 | Train Acc: 0.2981
 Site-White_ffhq-0                  | Train Loss: 1.1696 | Train Acc: 0.6004
Average Train Accuracy: 0.3889
 Site-White-0                       | Val  Loss: 1.7743 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6857 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7357 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.5806 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6179 | Val  Acc: 0.4059
 Site-Middle_Eastern-0              | Val  Loss: 1.7705 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5011 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.7532 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8343 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7810 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.1404 | Val  Acc: 0.5897
Average Valid Accuracy: 0.3439
============ Train epoch 44 ============
 Site-White-0                       | Train Loss: 1.4157 | Train Acc: 0.4437
 Site-White-1                       | Train Loss: 1.5723 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6211 | Train Acc: 0.3850
 Site-White-3                       | Train Loss: 1.5725 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5284 | Train Acc: 0.4234
 Site-Middle_Eastern-0              | Train Loss: 1.7405 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.7246 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 1.7317 | Train Acc: 0.3150
 Site-Black-0                       | Train Loss: 1.7743 | Train Acc: 0.3072
 Site-Black-1                       | Train Loss: 1.8110 | Train Acc: 0.2981
 Site-White_ffhq-0                  | Train Loss: 1.1800 | Train Acc: 0.6022
Average Train Accuracy: 0.3867
 Site-White-0                       | Val  Loss: 1.8346 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6951 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.7297 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.6069 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6338 | Val  Acc: 0.4118
 Site-Middle_Eastern-0              | Val  Loss: 1.8149 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 1.5112 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 1.7486 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8390 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7871 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1443 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3380
============ Train epoch 45 ============
 Site-White-0                       | Train Loss: 1.5445 | Train Acc: 0.4648
 Site-White-1                       | Train Loss: 1.5778 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6164 | Train Acc: 0.3826
 Site-White-3                       | Train Loss: 1.5641 | Train Acc: 0.4131
 Site-White-4                       | Train Loss: 1.5145 | Train Acc: 0.4226
 Site-Middle_Eastern-0              | Train Loss: 1.7437 | Train Acc: 0.3282
 Site-Middle_Eastern-1              | Train Loss: 1.7328 | Train Acc: 0.3125
 Site-Middle_Eastern-2              | Train Loss: 1.7252 | Train Acc: 0.3176
 Site-Black-0                       | Train Loss: 1.7737 | Train Acc: 0.2986
 Site-Black-1                       | Train Loss: 1.7773 | Train Acc: 0.2862
 Site-White_ffhq-0                  | Train Loss: 1.1731 | Train Acc: 0.6113
Average Train Accuracy: 0.3849
 Site-White-0                       | Val  Loss: 1.7688 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6895 | Val  Acc: 0.3529
 Site-White-2                       | Val  Loss: 1.7109 | Val  Acc: 0.2881
 Site-White-3                       | Val  Loss: 1.5933 | Val  Acc: 0.3700
 Site-White-4                       | Val  Loss: 1.6122 | Val  Acc: 0.4118
 Site-Middle_Eastern-0              | Val  Loss: 1.7838 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4867 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7504 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.8285 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7718 | Val  Acc: 0.3494
 Site-White_ffhq-0                  | Val  Loss: 1.1240 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3518
 Best site-White-0                   | Epoch:45 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:45 | Val Acc: 0.3529
 Best site-White-2                   | Epoch:45 | Val Acc: 0.2881
 Best site-White-3                   | Epoch:45 | Val Acc: 0.3700
 Best site-White-4                   | Epoch:45 | Val Acc: 0.4118
 Best site-Middle_Eastern-0          | Epoch:45 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:45 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:45 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:45 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:45 | Val Acc: 0.3494
 Best site-White_ffhq-0              | Epoch:45 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 46 ============
 Site-White-0                       | Train Loss: 1.6109 | Train Acc: 0.4296
 Site-White-1                       | Train Loss: 1.5691 | Train Acc: 0.3926
 Site-White-2                       | Train Loss: 1.6002 | Train Acc: 0.3898
 Site-White-3                       | Train Loss: 1.5640 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5143 | Train Acc: 0.4226
 Site-Middle_Eastern-0              | Train Loss: 1.4763 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.7388 | Train Acc: 0.3214
 Site-Middle_Eastern-2              | Train Loss: 1.7205 | Train Acc: 0.3202
 Site-Black-0                       | Train Loss: 1.7727 | Train Acc: 0.3159
 Site-Black-1                       | Train Loss: 1.8078 | Train Acc: 0.2947
 Site-White_ffhq-0                  | Train Loss: 1.1695 | Train Acc: 0.6022
Average Train Accuracy: 0.3855
 Site-White-0                       | Val  Loss: 1.7738 | Val  Acc: 0.3500
 Site-White-1                       | Val  Loss: 1.6548 | Val  Acc: 0.3529
 Site-White-2                       | Val  Loss: 1.7193 | Val  Acc: 0.3051
 Site-White-3                       | Val  Loss: 1.5967 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6167 | Val  Acc: 0.4235
 Site-Middle_Eastern-0              | Val  Loss: 1.8076 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.4810 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7385 | Val  Acc: 0.2037
 Site-Black-0                       | Val  Loss: 1.8002 | Val  Acc: 0.2653
 Site-Black-1                       | Val  Loss: 1.7942 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1278 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3554
 Best site-White-0                   | Epoch:46 | Val Acc: 0.3500
 Best site-White-1                   | Epoch:46 | Val Acc: 0.3529
 Best site-White-2                   | Epoch:46 | Val Acc: 0.3051
 Best site-White-3                   | Epoch:46 | Val Acc: 0.3800
 Best site-White-4                   | Epoch:46 | Val Acc: 0.4235
 Best site-Middle_Eastern-0          | Epoch:46 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:46 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:46 | Val Acc: 0.2037
 Best site-Black-0                   | Epoch:46 | Val Acc: 0.2653
 Best site-Black-1                   | Epoch:46 | Val Acc: 0.3133
 Best site-White_ffhq-0              | Epoch:46 | Val Acc: 0.5513
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 47 ============
 Site-White-0                       | Train Loss: 1.5015 | Train Acc: 0.4507
 Site-White-1                       | Train Loss: 1.5713 | Train Acc: 0.3967
 Site-White-2                       | Train Loss: 1.6169 | Train Acc: 0.3777
 Site-White-3                       | Train Loss: 1.5653 | Train Acc: 0.4174
 Site-White-4                       | Train Loss: 1.5129 | Train Acc: 0.4276
 Site-Middle_Eastern-0              | Train Loss: 1.5653 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.7416 | Train Acc: 0.3259
 Site-Middle_Eastern-2              | Train Loss: 1.7316 | Train Acc: 0.3202
 Site-Black-0                       | Train Loss: 1.7868 | Train Acc: 0.3188
 Site-Black-1                       | Train Loss: 1.7993 | Train Acc: 0.3186
 Site-White_ffhq-0                  | Train Loss: 1.1575 | Train Acc: 0.6131
Average Train Accuracy: 0.3911
 Site-White-0                       | Val  Loss: 1.8419 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6775 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7044 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5856 | Val  Acc: 0.3900
 Site-White-4                       | Val  Loss: 1.6261 | Val  Acc: 0.4059
 Site-Middle_Eastern-0              | Val  Loss: 1.7591 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.4705 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.7281 | Val  Acc: 0.2593
 Site-Black-0                       | Val  Loss: 1.8105 | Val  Acc: 0.2449
 Site-Black-1                       | Val  Loss: 1.7933 | Val  Acc: 0.3253
 Site-White_ffhq-0                  | Val  Loss: 1.1525 | Val  Acc: 0.5641
Average Valid Accuracy: 0.3544
============ Train epoch 48 ============
 Site-White-0                       | Train Loss: 1.5077 | Train Acc: 0.4648
 Site-White-1                       | Train Loss: 1.5509 | Train Acc: 0.4050
 Site-White-2                       | Train Loss: 1.6065 | Train Acc: 0.3753
 Site-White-3                       | Train Loss: 1.5561 | Train Acc: 0.4074
 Site-White-4                       | Train Loss: 1.5135 | Train Acc: 0.4318
 Site-Middle_Eastern-0              | Train Loss: 1.8056 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7531 | Train Acc: 0.3438
 Site-Middle_Eastern-2              | Train Loss: 1.7179 | Train Acc: 0.3228
 Site-Black-0                       | Train Loss: 1.7575 | Train Acc: 0.3072
 Site-Black-1                       | Train Loss: 1.7921 | Train Acc: 0.2964
 Site-White_ffhq-0                  | Train Loss: 1.1638 | Train Acc: 0.6314
Average Train Accuracy: 0.3950
 Site-White-0                       | Val  Loss: 1.7200 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6593 | Val  Acc: 0.3235
 Site-White-2                       | Val  Loss: 1.7389 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.5951 | Val  Acc: 0.3800
 Site-White-4                       | Val  Loss: 1.6002 | Val  Acc: 0.4176
 Site-Middle_Eastern-0              | Val  Loss: 1.8157 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4767 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.7089 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 1.8460 | Val  Acc: 0.2245
 Site-Black-1                       | Val  Loss: 1.7547 | Val  Acc: 0.3133
 Site-White_ffhq-0                  | Val  Loss: 1.1381 | Val  Acc: 0.5513
Average Valid Accuracy: 0.3494
============ Train epoch 49 ============
 Site-White-0                       | Train Loss: 1.5263 | Train Acc: 0.4507
 Site-White-1                       | Train Loss: 1.5658 | Train Acc: 0.4091
 Site-White-2                       | Train Loss: 1.6313 | Train Acc: 0.3971
 Site-White-3                       | Train Loss: 1.5458 | Train Acc: 0.4160
 Site-White-4                       | Train Loss: 1.5041 | Train Acc: 0.4310
 Site-Middle_Eastern-0              | Train Loss: 1.6955 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7205 | Train Acc: 0.3348
 Site-Middle_Eastern-2              | Train Loss: 1.7191 | Train Acc: 0.3333
 Site-Black-0                       | Train Loss: 1.7641 | Train Acc: 0.3246
 Site-Black-1                       | Train Loss: 1.7843 | Train Acc: 0.3118
 Site-White_ffhq-0                  | Train Loss: 1.1620 | Train Acc: 0.6223
Average Train Accuracy: 0.3990
 Site-White-0                       | Val  Loss: 1.7547 | Val  Acc: 0.3000
 Site-White-1                       | Val  Loss: 1.6835 | Val  Acc: 0.2647
 Site-White-2                       | Val  Loss: 1.6938 | Val  Acc: 0.3220
 Site-White-3                       | Val  Loss: 1.6011 | Val  Acc: 0.4000
 Site-White-4                       | Val  Loss: 1.6037 | Val  Acc: 0.3941
 Site-Middle_Eastern-0              | Val  Loss: 1.7361 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.4551 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7270 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 1.7887 | Val  Acc: 0.2857
 Site-Black-1                       | Val  Loss: 1.7304 | Val  Acc: 0.3373
 Site-White_ffhq-0                  | Val  Loss: 1.1296 | Val  Acc: 0.6026
Average Valid Accuracy: 0.3602
 Best site-White-0                   | Epoch:49 | Val Acc: 0.3000
 Best site-White-1                   | Epoch:49 | Val Acc: 0.2647
 Best site-White-2                   | Epoch:49 | Val Acc: 0.3220
 Best site-White-3                   | Epoch:49 | Val Acc: 0.4000
 Best site-White-4                   | Epoch:49 | Val Acc: 0.3941
 Best site-Middle_Eastern-0          | Epoch:49 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:49 | Val Acc: 0.5000
 Best site-Middle_Eastern-2          | Epoch:49 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:49 | Val Acc: 0.2857
 Best site-Black-1                   | Epoch:49 | Val Acc: 0.3373
 Best site-White_ffhq-0              | Epoch:49 | Val Acc: 0.6026
 Test site-White-0                   | Epoch:49 | Test Acc: 0.3095
 Test site-White-1                   | Epoch:49 | Test Acc: 0.4930
 Test site-White-2                   | Epoch:49 | Test Acc: 0.3950
 Test site-White-3                   | Epoch:49 | Test Acc: 0.3663
 Test site-White-4                   | Epoch:49 | Test Acc: 0.3790
 Test site-Middle_Eastern-0          | Epoch:49 | Test Acc: 0.2308
 Test site-Middle_Eastern-1          | Epoch:49 | Test Acc: 0.3231
 Test site-Middle_Eastern-2          | Epoch:49 | Test Acc: 0.3091
 Test site-Black-0                   | Epoch:49 | Test Acc: 0.3000
 Test site-Black-1                   | Epoch:49 | Test Acc: 0.3491
 Test site-White_ffhq-0              | Epoch:49 | Test Acc: 0.5190
White: 0.3886, Middle_Eastern: 0.2876, Black: 0.3246, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.3799, Average Test Accuracy(individual): 0.3613,
domain std=0.0880, cluster std=-1.0000, individual std=0.0806, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
===2023-06-16 05:16:39===
===2023-06-16 05:16:42===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[142,242,413,702,1195,131,224,381,345,587,548,]
client_nums=[5,3,2,1,]
len_dataset=[7712,2112,2668,1569,]
domain number = -1
Loading snapshots...
 Test site-White-0                   | Epoch:49 | Test Acc: 0.2619
 Test site-White-1                   | Epoch:49 | Test Acc: 0.4789
 Test site-White-2                   | Epoch:49 | Test Acc: 0.3697
 Test site-White-3                   | Epoch:49 | Test Acc: 0.3515
 Test site-White-4                   | Epoch:49 | Test Acc: 0.3848
 Test site-Middle_Eastern-0          | Epoch:49 | Test Acc: 0.2821
 Test site-Middle_Eastern-1          | Epoch:49 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          | Epoch:49 | Test Acc: 0.3091
 Test site-Black-0                   | Epoch:49 | Test Acc: 0.3200
 Test site-Black-1                   | Epoch:49 | Test Acc: 0.3314
 Test site-White_ffhq-0              | Epoch:49 | Test Acc: 0.5190
White: 0.3694, Middle_Eastern: 0.3150, Black: 0.3257, White_ffhq: 0.5190, 
Average Test Accuracy(group): 0.3823, Average Test Accuracy(individual): 0.3602,
domain std=0.0815, cluster std=-1.0000, individual std=0.0744, 
===2023-06-16 10:05:45===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[72,124,211,359,612,131,224,381,176,301,281,]
client_nums=[5,3,2,1,]
len_dataset=[3952,2112,1367,804,]
domain number = -1
============ Train epoch 0 ============
 Site-White_utk-0                   | Train Loss: 2.1417 | Train Acc: 0.1944
 Site-White_utk-1                   | Train Loss: 2.1623 | Train Acc: 0.2339
 Site-White_utk-2                   | Train Loss: 2.2076 | Train Acc: 0.1564
 Site-White_utk-3                   | Train Loss: 2.1748 | Train Acc: 0.2033
 Site-White_utk-4                   | Train Loss: 2.1800 | Train Acc: 0.2026
 Site-Middle_Eastern-0              | Train Loss: 2.1886 | Train Acc: 0.0687
 Site-Middle_Eastern-1              | Train Loss: 2.1892 | Train Acc: 0.1250
 Site-Middle_Eastern-2              | Train Loss: 2.1998 | Train Acc: 0.1129
 Site-Black-0                       | Train Loss: 2.2112 | Train Acc: 0.0966
 Site-Black-1                       | Train Loss: 2.2007 | Train Acc: 0.0997
 Site-White-0                       | Train Loss: 2.2069 | Train Acc: 0.1317
Average Train Accuracy: 0.1477
 Site-White_utk-0                   | Val  Loss: 2.1655 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.1688 | Val  Acc: 0.1765
 Site-White_utk-2                   | Val  Loss: 2.1738 | Val  Acc: 0.2333
 Site-White_utk-3                   | Val  Loss: 2.1967 | Val  Acc: 0.1373
 Site-White_utk-4                   | Val  Loss: 2.1543 | Val  Acc: 0.2644
 Site-Middle_Eastern-0              | Val  Loss: 2.1741 | Val  Acc: 0.1111
 Site-Middle_Eastern-1              | Val  Loss: 2.1930 | Val  Acc: 0.1250
 Site-Middle_Eastern-2              | Val  Loss: 2.2013 | Val  Acc: 0.1296
 Site-Black-0                       | Val  Loss: 2.1917 | Val  Acc: 0.0800
 Site-Black-1                       | Val  Loss: 2.1958 | Val  Acc: 0.0465
 Site-White-0                       | Val  Loss: 2.2001 | Val  Acc: 0.1250
Average Valid Accuracy: 0.1481
 Best site-White_utk-0               | Epoch:0 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:0 | Val Acc: 0.1765
 Best site-White_utk-2               | Epoch:0 | Val Acc: 0.2333
 Best site-White_utk-3               | Epoch:0 | Val Acc: 0.1373
 Best site-White_utk-4               | Epoch:0 | Val Acc: 0.2644
 Best site-Middle_Eastern-0          | Epoch:0 | Val Acc: 0.1111
 Best site-Middle_Eastern-1          | Epoch:0 | Val Acc: 0.1250
 Best site-Middle_Eastern-2          | Epoch:0 | Val Acc: 0.1296
 Best site-Black-0                   | Epoch:0 | Val Acc: 0.0800
 Best site-Black-1                   | Epoch:0 | Val Acc: 0.0465
 Best site-White-0                   | Epoch:0 | Val Acc: 0.1250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 1 ============
 Site-White_utk-0                   | Train Loss: 2.2001 | Train Acc: 0.1667
 Site-White_utk-1                   | Train Loss: 2.1533 | Train Acc: 0.2581
 Site-White_utk-2                   | Train Loss: 2.1842 | Train Acc: 0.1611
 Site-White_utk-3                   | Train Loss: 2.1633 | Train Acc: 0.2173
 Site-White_utk-4                   | Train Loss: 2.1655 | Train Acc: 0.2222
 Site-Middle_Eastern-0              | Train Loss: 2.1594 | Train Acc: 0.1221
 Site-Middle_Eastern-1              | Train Loss: 2.1687 | Train Acc: 0.1786
 Site-Middle_Eastern-2              | Train Loss: 2.1805 | Train Acc: 0.1549
 Site-Black-0                       | Train Loss: 2.1896 | Train Acc: 0.0966
 Site-Black-1                       | Train Loss: 2.1824 | Train Acc: 0.1296
 Site-White-0                       | Train Loss: 2.1780 | Train Acc: 0.1459
Average Train Accuracy: 0.1685
 Site-White_utk-0                   | Val  Loss: 2.1642 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.1636 | Val  Acc: 0.1176
 Site-White_utk-2                   | Val  Loss: 2.1768 | Val  Acc: 0.2667
 Site-White_utk-3                   | Val  Loss: 2.1909 | Val  Acc: 0.1569
 Site-White_utk-4                   | Val  Loss: 2.1417 | Val  Acc: 0.2759
 Site-Middle_Eastern-0              | Val  Loss: 2.1352 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 2.1695 | Val  Acc: 0.1250
 Site-Middle_Eastern-2              | Val  Loss: 2.1740 | Val  Acc: 0.1481
 Site-Black-0                       | Val  Loss: 2.1847 | Val  Acc: 0.0400
 Site-Black-1                       | Val  Loss: 2.1839 | Val  Acc: 0.0698
 Site-White-0                       | Val  Loss: 2.1748 | Val  Acc: 0.1250
Average Valid Accuracy: 0.1639
 Best site-White_utk-0               | Epoch:1 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:1 | Val Acc: 0.1176
 Best site-White_utk-2               | Epoch:1 | Val Acc: 0.2667
 Best site-White_utk-3               | Epoch:1 | Val Acc: 0.1569
 Best site-White_utk-4               | Epoch:1 | Val Acc: 0.2759
 Best site-Middle_Eastern-0          | Epoch:1 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:1 | Val Acc: 0.1250
 Best site-Middle_Eastern-2          | Epoch:1 | Val Acc: 0.1481
 Best site-Black-0                   | Epoch:1 | Val Acc: 0.0400
 Best site-Black-1                   | Epoch:1 | Val Acc: 0.0698
 Best site-White-0                   | Epoch:1 | Val Acc: 0.1250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 2 ============
 Site-White_utk-0                   | Train Loss: 2.1385 | Train Acc: 0.2361
 Site-White_utk-1                   | Train Loss: 2.1421 | Train Acc: 0.2903
 Site-White_utk-2                   | Train Loss: 2.1833 | Train Acc: 0.1943
 Site-White_utk-3                   | Train Loss: 2.1511 | Train Acc: 0.2479
 Site-White_utk-4                   | Train Loss: 2.1510 | Train Acc: 0.2549
 Site-Middle_Eastern-0              | Train Loss: 2.1484 | Train Acc: 0.1374
 Site-Middle_Eastern-1              | Train Loss: 2.1495 | Train Acc: 0.2366
 Site-Middle_Eastern-2              | Train Loss: 2.1600 | Train Acc: 0.2126
 Site-Black-0                       | Train Loss: 2.1732 | Train Acc: 0.1136
 Site-Black-1                       | Train Loss: 2.1694 | Train Acc: 0.1728
 Site-White-0                       | Train Loss: 2.1546 | Train Acc: 0.2242
Average Train Accuracy: 0.2110
 Site-White_utk-0                   | Val  Loss: 2.1602 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.1592 | Val  Acc: 0.2353
 Site-White_utk-2                   | Val  Loss: 2.1546 | Val  Acc: 0.3333
 Site-White_utk-3                   | Val  Loss: 2.1598 | Val  Acc: 0.1961
 Site-White_utk-4                   | Val  Loss: 2.1351 | Val  Acc: 0.2759
 Site-Middle_Eastern-0              | Val  Loss: 2.1102 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 2.1417 | Val  Acc: 0.1562
 Site-Middle_Eastern-2              | Val  Loss: 2.1536 | Val  Acc: 0.2222
 Site-Black-0                       | Val  Loss: 2.1734 | Val  Acc: 0.0800
 Site-Black-1                       | Val  Loss: 2.1512 | Val  Acc: 0.1395
 Site-White-0                       | Val  Loss: 2.1490 | Val  Acc: 0.2250
Average Valid Accuracy: 0.2179
 Best site-White_utk-0               | Epoch:2 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:2 | Val Acc: 0.2353
 Best site-White_utk-2               | Epoch:2 | Val Acc: 0.3333
 Best site-White_utk-3               | Epoch:2 | Val Acc: 0.1961
 Best site-White_utk-4               | Epoch:2 | Val Acc: 0.2759
 Best site-Middle_Eastern-0          | Epoch:2 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:2 | Val Acc: 0.1562
 Best site-Middle_Eastern-2          | Epoch:2 | Val Acc: 0.2222
 Best site-Black-0                   | Epoch:2 | Val Acc: 0.0800
 Best site-Black-1                   | Epoch:2 | Val Acc: 0.1395
 Best site-White-0                   | Epoch:2 | Val Acc: 0.2250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 3 ============
 Site-White_utk-0                   | Train Loss: 2.1249 | Train Acc: 0.2500
 Site-White_utk-1                   | Train Loss: 2.1303 | Train Acc: 0.2661
 Site-White_utk-2                   | Train Loss: 2.1665 | Train Acc: 0.2370
 Site-White_utk-3                   | Train Loss: 2.1353 | Train Acc: 0.2897
 Site-White_utk-4                   | Train Loss: 2.1389 | Train Acc: 0.2680
 Site-Middle_Eastern-0              | Train Loss: 2.1474 | Train Acc: 0.2214
 Site-Middle_Eastern-1              | Train Loss: 2.1324 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 2.1424 | Train Acc: 0.2598
 Site-Black-0                       | Train Loss: 2.1598 | Train Acc: 0.1761
 Site-Black-1                       | Train Loss: 2.1513 | Train Acc: 0.1960
 Site-White-0                       | Train Loss: 2.1265 | Train Acc: 0.2847
Average Train Accuracy: 0.2506
 Site-White_utk-0                   | Val  Loss: 2.1319 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.1216 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 2.1468 | Val  Acc: 0.3333
 Site-White_utk-3                   | Val  Loss: 2.1563 | Val  Acc: 0.2549
 Site-White_utk-4                   | Val  Loss: 2.1266 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 2.0820 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 2.1337 | Val  Acc: 0.2500
 Site-Middle_Eastern-2              | Val  Loss: 2.1389 | Val  Acc: 0.2407
 Site-Black-0                       | Val  Loss: 2.1485 | Val  Acc: 0.1600
 Site-Black-1                       | Val  Loss: 2.1446 | Val  Acc: 0.1628
 Site-White-0                       | Val  Loss: 2.1388 | Val  Acc: 0.2250
Average Valid Accuracy: 0.2609
 Best site-White_utk-0               | Epoch:3 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:3 | Val Acc: 0.3529
 Best site-White_utk-2               | Epoch:3 | Val Acc: 0.3333
 Best site-White_utk-3               | Epoch:3 | Val Acc: 0.2549
 Best site-White_utk-4               | Epoch:3 | Val Acc: 0.3563
 Best site-Middle_Eastern-0          | Epoch:3 | Val Acc: 0.3333
 Best site-Middle_Eastern-1          | Epoch:3 | Val Acc: 0.2500
 Best site-Middle_Eastern-2          | Epoch:3 | Val Acc: 0.2407
 Best site-Black-0                   | Epoch:3 | Val Acc: 0.1600
 Best site-Black-1                   | Epoch:3 | Val Acc: 0.1628
 Best site-White-0                   | Epoch:3 | Val Acc: 0.2250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 4 ============
 Site-White_utk-0                   | Train Loss: 2.0970 | Train Acc: 0.3611
 Site-White_utk-1                   | Train Loss: 2.1151 | Train Acc: 0.3548
 Site-White_utk-2                   | Train Loss: 2.1604 | Train Acc: 0.2654
 Site-White_utk-3                   | Train Loss: 2.1235 | Train Acc: 0.2925
 Site-White_utk-4                   | Train Loss: 2.1307 | Train Acc: 0.2712
 Site-Middle_Eastern-0              | Train Loss: 2.1548 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 2.1117 | Train Acc: 0.3080
 Site-Middle_Eastern-2              | Train Loss: 2.1229 | Train Acc: 0.3018
 Site-Black-0                       | Train Loss: 2.1408 | Train Acc: 0.1761
 Site-Black-1                       | Train Loss: 2.1315 | Train Acc: 0.2392
 Site-White-0                       | Train Loss: 2.1056 | Train Acc: 0.3238
Average Train Accuracy: 0.2895
 Site-White_utk-0                   | Val  Loss: 2.1485 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.1111 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.1306 | Val  Acc: 0.3667
 Site-White_utk-3                   | Val  Loss: 2.1440 | Val  Acc: 0.2353
 Site-White_utk-4                   | Val  Loss: 2.1147 | Val  Acc: 0.4138
 Site-Middle_Eastern-0              | Val  Loss: 2.0540 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 2.1109 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 2.1101 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 2.1428 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 2.1216 | Val  Acc: 0.2791
 Site-White-0                       | Val  Loss: 2.1207 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3291
 Best site-White_utk-0               | Epoch:4 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:4 | Val Acc: 0.2941
 Best site-White_utk-2               | Epoch:4 | Val Acc: 0.3667
 Best site-White_utk-3               | Epoch:4 | Val Acc: 0.2353
 Best site-White_utk-4               | Epoch:4 | Val Acc: 0.4138
 Best site-Middle_Eastern-0          | Epoch:4 | Val Acc: 0.5000
 Best site-Middle_Eastern-1          | Epoch:4 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:4 | Val Acc: 0.3889
 Best site-Black-0                   | Epoch:4 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:4 | Val Acc: 0.2791
 Best site-White-0                   | Epoch:4 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 5 ============
 Site-White_utk-0                   | Train Loss: 2.1186 | Train Acc: 0.2917
 Site-White_utk-1                   | Train Loss: 2.1044 | Train Acc: 0.3306
 Site-White_utk-2                   | Train Loss: 2.1473 | Train Acc: 0.2891
 Site-White_utk-3                   | Train Loss: 2.1144 | Train Acc: 0.3064
 Site-White_utk-4                   | Train Loss: 2.1204 | Train Acc: 0.2908
 Site-Middle_Eastern-0              | Train Loss: 2.1245 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 2.0890 | Train Acc: 0.3527
 Site-Middle_Eastern-2              | Train Loss: 2.1071 | Train Acc: 0.3333
 Site-Black-0                       | Train Loss: 2.1227 | Train Acc: 0.1818
 Site-Black-1                       | Train Loss: 2.1240 | Train Acc: 0.2359
 Site-White-0                       | Train Loss: 2.0822 | Train Acc: 0.3843
Average Train Accuracy: 0.2988
 Site-White_utk-0                   | Val  Loss: 2.1353 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.0978 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.1116 | Val  Acc: 0.4333
 Site-White_utk-3                   | Val  Loss: 2.1327 | Val  Acc: 0.2941
 Site-White_utk-4                   | Val  Loss: 2.1082 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 2.0554 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 2.0849 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 2.0946 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 2.1224 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 2.1181 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 2.1074 | Val  Acc: 0.3250
Average Valid Accuracy: 0.3245
============ Train epoch 6 ============
 Site-White_utk-0                   | Train Loss: 2.0870 | Train Acc: 0.2778
 Site-White_utk-1                   | Train Loss: 2.0974 | Train Acc: 0.3629
 Site-White_utk-2                   | Train Loss: 2.1266 | Train Acc: 0.3128
 Site-White_utk-3                   | Train Loss: 2.1091 | Train Acc: 0.3175
 Site-White_utk-4                   | Train Loss: 2.1054 | Train Acc: 0.3137
 Site-Middle_Eastern-0              | Train Loss: 2.1084 | Train Acc: 0.3053
 Site-Middle_Eastern-1              | Train Loss: 2.0768 | Train Acc: 0.3884
 Site-Middle_Eastern-2              | Train Loss: 2.0884 | Train Acc: 0.3753
 Site-Black-0                       | Train Loss: 2.1138 | Train Acc: 0.2386
 Site-Black-1                       | Train Loss: 2.1143 | Train Acc: 0.2425
 Site-White-0                       | Train Loss: 2.0673 | Train Acc: 0.3843
Average Train Accuracy: 0.3199
 Site-White_utk-0                   | Val  Loss: 2.1344 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 2.0789 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 2.1041 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.1290 | Val  Acc: 0.3137
 Site-White_utk-4                   | Val  Loss: 2.1015 | Val  Acc: 0.3218
 Site-Middle_Eastern-0              | Val  Loss: 2.0356 | Val  Acc: 0.2778
 Site-Middle_Eastern-1              | Val  Loss: 2.0705 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 2.0743 | Val  Acc: 0.3333
 Site-Black-0                       | Val  Loss: 2.1194 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 2.0957 | Val  Acc: 0.2791
 Site-White-0                       | Val  Loss: 2.0858 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3392
 Best site-White_utk-0               | Epoch:6 | Val Acc: 0.3000
 Best site-White_utk-1               | Epoch:6 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:6 | Val Acc: 0.4667
 Best site-White_utk-3               | Epoch:6 | Val Acc: 0.3137
 Best site-White_utk-4               | Epoch:6 | Val Acc: 0.3218
 Best site-Middle_Eastern-0          | Epoch:6 | Val Acc: 0.2778
 Best site-Middle_Eastern-1          | Epoch:6 | Val Acc: 0.4375
 Best site-Middle_Eastern-2          | Epoch:6 | Val Acc: 0.3333
 Best site-Black-0                   | Epoch:6 | Val Acc: 0.2400
 Best site-Black-1                   | Epoch:6 | Val Acc: 0.2791
 Best site-White-0                   | Epoch:6 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 7 ============
 Site-White_utk-0                   | Train Loss: 2.0803 | Train Acc: 0.3194
 Site-White_utk-1                   | Train Loss: 2.0858 | Train Acc: 0.3710
 Site-White_utk-2                   | Train Loss: 2.1309 | Train Acc: 0.2464
 Site-White_utk-3                   | Train Loss: 2.0924 | Train Acc: 0.3203
 Site-White_utk-4                   | Train Loss: 2.0942 | Train Acc: 0.3072
 Site-Middle_Eastern-0              | Train Loss: 2.0588 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 2.0644 | Train Acc: 0.3571
 Site-Middle_Eastern-2              | Train Loss: 2.0727 | Train Acc: 0.3307
 Site-Black-0                       | Train Loss: 2.1015 | Train Acc: 0.2670
 Site-Black-1                       | Train Loss: 2.0992 | Train Acc: 0.2890
 Site-White-0                       | Train Loss: 2.0462 | Train Acc: 0.4128
Average Train Accuracy: 0.3199
 Site-White_utk-0                   | Val  Loss: 2.1345 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.0762 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 2.0920 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 2.1182 | Val  Acc: 0.2353
 Site-White_utk-4                   | Val  Loss: 2.0941 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 2.0042 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 2.0551 | Val  Acc: 0.2812
 Site-Middle_Eastern-2              | Val  Loss: 2.0536 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 2.0999 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 2.0773 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 2.0646 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3409
 Best site-White_utk-0               | Epoch:7 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:7 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:7 | Val Acc: 0.5000
 Best site-White_utk-3               | Epoch:7 | Val Acc: 0.2353
 Best site-White_utk-4               | Epoch:7 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:7 | Val Acc: 0.4444
 Best site-Middle_Eastern-1          | Epoch:7 | Val Acc: 0.2812
 Best site-Middle_Eastern-2          | Epoch:7 | Val Acc: 0.3704
 Best site-Black-0                   | Epoch:7 | Val Acc: 0.2400
 Best site-Black-1                   | Epoch:7 | Val Acc: 0.3488
 Best site-White-0                   | Epoch:7 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 8 ============
 Site-White_utk-0                   | Train Loss: 2.0596 | Train Acc: 0.3333
 Site-White_utk-1                   | Train Loss: 2.0775 | Train Acc: 0.3387
 Site-White_utk-2                   | Train Loss: 2.1183 | Train Acc: 0.2701
 Site-White_utk-3                   | Train Loss: 2.0844 | Train Acc: 0.3426
 Site-White_utk-4                   | Train Loss: 2.0888 | Train Acc: 0.3105
 Site-Middle_Eastern-0              | Train Loss: 2.0675 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0517 | Train Acc: 0.3571
 Site-Middle_Eastern-2              | Train Loss: 2.0587 | Train Acc: 0.3412
 Site-Black-0                       | Train Loss: 2.0915 | Train Acc: 0.2955
 Site-Black-1                       | Train Loss: 2.0861 | Train Acc: 0.2890
 Site-White-0                       | Train Loss: 2.0336 | Train Acc: 0.3879
Average Train Accuracy: 0.3226
 Site-White_utk-0                   | Val  Loss: 2.1013 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.0655 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 2.0892 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.1192 | Val  Acc: 0.3137
 Site-White_utk-4                   | Val  Loss: 2.0861 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.9836 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 2.0405 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 2.0523 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 2.0924 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 2.0700 | Val  Acc: 0.3256
 Site-White-0                       | Val  Loss: 2.0501 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3443
 Best site-White_utk-0               | Epoch:8 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:8 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:8 | Val Acc: 0.4667
 Best site-White_utk-3               | Epoch:8 | Val Acc: 0.3137
 Best site-White_utk-4               | Epoch:8 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:8 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:8 | Val Acc: 0.3125
 Best site-Middle_Eastern-2          | Epoch:8 | Val Acc: 0.3704
 Best site-Black-0                   | Epoch:8 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:8 | Val Acc: 0.3256
 Best site-White-0                   | Epoch:8 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 9 ============
 Site-White_utk-0                   | Train Loss: 2.0505 | Train Acc: 0.3056
 Site-White_utk-1                   | Train Loss: 2.0619 | Train Acc: 0.3548
 Site-White_utk-2                   | Train Loss: 2.1145 | Train Acc: 0.2796
 Site-White_utk-3                   | Train Loss: 2.0771 | Train Acc: 0.3315
 Site-White_utk-4                   | Train Loss: 2.0750 | Train Acc: 0.3219
 Site-Middle_Eastern-0              | Train Loss: 2.0154 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 2.0396 | Train Acc: 0.3616
 Site-Middle_Eastern-2              | Train Loss: 2.0454 | Train Acc: 0.3255
 Site-Black-0                       | Train Loss: 2.0709 | Train Acc: 0.2614
 Site-Black-1                       | Train Loss: 2.0746 | Train Acc: 0.2625
 Site-White-0                       | Train Loss: 2.0093 | Train Acc: 0.4093
Average Train Accuracy: 0.3213
 Site-White_utk-0                   | Val  Loss: 2.1082 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.0379 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.0673 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 2.0985 | Val  Acc: 0.2745
 Site-White_utk-4                   | Val  Loss: 2.0793 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.9664 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 2.0284 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 2.0270 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 2.0711 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 2.0542 | Val  Acc: 0.3256
 Site-White-0                       | Val  Loss: 2.0387 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3588
 Best site-White_utk-0               | Epoch:9 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:9 | Val Acc: 0.2941
 Best site-White_utk-2               | Epoch:9 | Val Acc: 0.5000
 Best site-White_utk-3               | Epoch:9 | Val Acc: 0.2745
 Best site-White_utk-4               | Epoch:9 | Val Acc: 0.3793
 Best site-Middle_Eastern-0          | Epoch:9 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:9 | Val Acc: 0.4688
 Best site-Middle_Eastern-2          | Epoch:9 | Val Acc: 0.3704
 Best site-Black-0                   | Epoch:9 | Val Acc: 0.3200
 Best site-Black-1                   | Epoch:9 | Val Acc: 0.3256
 Best site-White-0                   | Epoch:9 | Val Acc: 0.4250
 Test site-White_utk-0               | Epoch:9 | Test Acc: 0.3636
 Test site-White_utk-1               | Epoch:9 | Test Acc: 0.2973
 Test site-White_utk-2               | Epoch:9 | Test Acc: 0.4098
 Test site-White_utk-3               | Epoch:9 | Test Acc: 0.2981
 Test site-White_utk-4               | Epoch:9 | Test Acc: 0.3864
 Test site-Middle_Eastern-0          | Epoch:9 | Test Acc: 0.4359
 Test site-Middle_Eastern-1          | Epoch:9 | Test Acc: 0.2615
 Test site-Middle_Eastern-2          | Epoch:9 | Test Acc: 0.3545
 Test site-Black-0                   | Epoch:9 | Test Acc: 0.3725
 Test site-Black-1                   | Epoch:9 | Test Acc: 0.3023
 Test site-White-0                   | Epoch:9 | Test Acc: 0.4444
White_utk: 0.3510, Middle_Eastern: 0.3507, Black: 0.3374, White: 0.4444, 
Average Test Accuracy(group): 0.3709, Average Test Accuracy(individual): 0.3570,
domain std=0.0428, cluster std=-1.0000, individual std=0.0580, 
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 10 ============
 Site-White_utk-0                   | Train Loss: 2.0583 | Train Acc: 0.3333
 Site-White_utk-1                   | Train Loss: 2.0534 | Train Acc: 0.3387
 Site-White_utk-2                   | Train Loss: 2.0975 | Train Acc: 0.2749
 Site-White_utk-3                   | Train Loss: 2.0686 | Train Acc: 0.3565
 Site-White_utk-4                   | Train Loss: 2.0656 | Train Acc: 0.3203
 Site-Middle_Eastern-0              | Train Loss: 2.0575 | Train Acc: 0.2824
 Site-Middle_Eastern-1              | Train Loss: 2.0229 | Train Acc: 0.3705
 Site-Middle_Eastern-2              | Train Loss: 2.0342 | Train Acc: 0.3438
 Site-Black-0                       | Train Loss: 2.0625 | Train Acc: 0.2670
 Site-Black-1                       | Train Loss: 2.0608 | Train Acc: 0.2458
 Site-White-0                       | Train Loss: 1.9940 | Train Acc: 0.4057
Average Train Accuracy: 0.3217
 Site-White_utk-0                   | Val  Loss: 2.0961 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 2.0577 | Val  Acc: 0.1765
 Site-White_utk-2                   | Val  Loss: 2.0578 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 2.1032 | Val  Acc: 0.2745
 Site-White_utk-4                   | Val  Loss: 2.0713 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.9507 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 2.0146 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 2.0220 | Val  Acc: 0.3333
 Site-Black-0                       | Val  Loss: 2.0631 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 2.0380 | Val  Acc: 0.3023
 Site-White-0                       | Val  Loss: 2.0292 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3385
============ Train epoch 11 ============
 Site-White_utk-0                   | Train Loss: 1.9746 | Train Acc: 0.3611
 Site-White_utk-1                   | Train Loss: 2.0499 | Train Acc: 0.3468
 Site-White_utk-2                   | Train Loss: 2.0843 | Train Acc: 0.2654
 Site-White_utk-3                   | Train Loss: 2.0521 | Train Acc: 0.3760
 Site-White_utk-4                   | Train Loss: 2.0579 | Train Acc: 0.3431
 Site-Middle_Eastern-0              | Train Loss: 2.0397 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 2.0097 | Train Acc: 0.3571
 Site-Middle_Eastern-2              | Train Loss: 2.0222 | Train Acc: 0.3438
 Site-Black-0                       | Train Loss: 2.0536 | Train Acc: 0.2841
 Site-Black-1                       | Train Loss: 2.0558 | Train Acc: 0.2957
 Site-White-0                       | Train Loss: 1.9803 | Train Acc: 0.4128
Average Train Accuracy: 0.3349
 Site-White_utk-0                   | Val  Loss: 2.0745 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.0258 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.0605 | Val  Acc: 0.4000
 Site-White_utk-3                   | Val  Loss: 2.1026 | Val  Acc: 0.2157
 Site-White_utk-4                   | Val  Loss: 2.0722 | Val  Acc: 0.3908
 Site-Middle_Eastern-0              | Val  Loss: 1.9185 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 2.0008 | Val  Acc: 0.3438
 Site-Middle_Eastern-2              | Val  Loss: 2.0095 | Val  Acc: 0.3519
 Site-Black-0                       | Val  Loss: 2.0719 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 2.0254 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.9945 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3364
============ Train epoch 12 ============
 Site-White_utk-0                   | Train Loss: 2.0206 | Train Acc: 0.4167
 Site-White_utk-1                   | Train Loss: 2.0379 | Train Acc: 0.3226
 Site-White_utk-2                   | Train Loss: 2.0737 | Train Acc: 0.2701
 Site-White_utk-3                   | Train Loss: 2.0474 | Train Acc: 0.3482
 Site-White_utk-4                   | Train Loss: 2.0439 | Train Acc: 0.3219
 Site-Middle_Eastern-0              | Train Loss: 2.0135 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 2.0095 | Train Acc: 0.3661
 Site-Middle_Eastern-2              | Train Loss: 2.0084 | Train Acc: 0.3333
 Site-Black-0                       | Train Loss: 2.0447 | Train Acc: 0.2500
 Site-Black-1                       | Train Loss: 2.0445 | Train Acc: 0.2824
 Site-White-0                       | Train Loss: 1.9746 | Train Acc: 0.4021
Average Train Accuracy: 0.3297
 Site-White_utk-0                   | Val  Loss: 2.0672 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 2.0029 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 2.0437 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.0729 | Val  Acc: 0.2745
 Site-White_utk-4                   | Val  Loss: 2.0602 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.8998 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.9770 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.9787 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 2.0428 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 2.0267 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.9835 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3598
 Best site-White_utk-0               | Epoch:12 | Val Acc: 0.3000
 Best site-White_utk-1               | Epoch:12 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:12 | Val Acc: 0.4667
 Best site-White_utk-3               | Epoch:12 | Val Acc: 0.2745
 Best site-White_utk-4               | Epoch:12 | Val Acc: 0.3563
 Best site-Middle_Eastern-0          | Epoch:12 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:12 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:12 | Val Acc: 0.3704
 Best site-Black-0                   | Epoch:12 | Val Acc: 0.2400
 Best site-Black-1                   | Epoch:12 | Val Acc: 0.3488
 Best site-White-0                   | Epoch:12 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 13 ============
 Site-White_utk-0                   | Train Loss: 1.9703 | Train Acc: 0.3472
 Site-White_utk-1                   | Train Loss: 2.0304 | Train Acc: 0.3871
 Site-White_utk-2                   | Train Loss: 2.0809 | Train Acc: 0.2417
 Site-White_utk-3                   | Train Loss: 2.0367 | Train Acc: 0.3454
 Site-White_utk-4                   | Train Loss: 2.0373 | Train Acc: 0.3529
 Site-Middle_Eastern-0              | Train Loss: 2.0113 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.9854 | Train Acc: 0.3795
 Site-Middle_Eastern-2              | Train Loss: 1.9989 | Train Acc: 0.3307
 Site-Black-0                       | Train Loss: 2.0341 | Train Acc: 0.2614
 Site-Black-1                       | Train Loss: 2.0350 | Train Acc: 0.2757
 Site-White-0                       | Train Loss: 1.9436 | Train Acc: 0.3986
Average Train Accuracy: 0.3289
 Site-White_utk-0                   | Val  Loss: 2.0796 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 1.9991 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.0397 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.0617 | Val  Acc: 0.2745
 Site-White_utk-4                   | Val  Loss: 2.0437 | Val  Acc: 0.4023
 Site-Middle_Eastern-0              | Val  Loss: 1.9016 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.9521 | Val  Acc: 0.5625
 Site-Middle_Eastern-2              | Val  Loss: 1.9814 | Val  Acc: 0.3148
 Site-Black-0                       | Val  Loss: 2.0465 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.9998 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.9984 | Val  Acc: 0.3000
Average Valid Accuracy: 0.3575
============ Train epoch 14 ============
 Site-White_utk-0                   | Train Loss: 2.0239 | Train Acc: 0.3611
 Site-White_utk-1                   | Train Loss: 2.0202 | Train Acc: 0.3790
 Site-White_utk-2                   | Train Loss: 2.0633 | Train Acc: 0.2844
 Site-White_utk-3                   | Train Loss: 2.0294 | Train Acc: 0.3426
 Site-White_utk-4                   | Train Loss: 2.0270 | Train Acc: 0.3284
 Site-Middle_Eastern-0              | Train Loss: 2.0040 | Train Acc: 0.2977
 Site-Middle_Eastern-1              | Train Loss: 1.9766 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.9882 | Train Acc: 0.3333
 Site-Black-0                       | Train Loss: 2.0225 | Train Acc: 0.2784
 Site-Black-1                       | Train Loss: 2.0288 | Train Acc: 0.2757
 Site-White-0                       | Train Loss: 1.9476 | Train Acc: 0.4128
Average Train Accuracy: 0.3343
 Site-White_utk-0                   | Val  Loss: 2.0814 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 1.9932 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 2.0155 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 2.0561 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 2.0350 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.8732 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.9655 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.9672 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 2.0305 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.9929 | Val  Acc: 0.2791
 Site-White-0                       | Val  Loss: 1.9637 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3547
============ Train epoch 15 ============
 Site-White_utk-0                   | Train Loss: 1.9724 | Train Acc: 0.3750
 Site-White_utk-1                   | Train Loss: 2.0080 | Train Acc: 0.3790
 Site-White_utk-2                   | Train Loss: 2.0473 | Train Acc: 0.2749
 Site-White_utk-3                   | Train Loss: 2.0225 | Train Acc: 0.3621
 Site-White_utk-4                   | Train Loss: 2.0200 | Train Acc: 0.3382
 Site-Middle_Eastern-0              | Train Loss: 1.9416 | Train Acc: 0.2901
 Site-Middle_Eastern-1              | Train Loss: 1.9624 | Train Acc: 0.3705
 Site-Middle_Eastern-2              | Train Loss: 1.9738 | Train Acc: 0.3412
 Site-Black-0                       | Train Loss: 2.0151 | Train Acc: 0.2557
 Site-Black-1                       | Train Loss: 2.0203 | Train Acc: 0.2658
 Site-White-0                       | Train Loss: 1.9284 | Train Acc: 0.4270
Average Train Accuracy: 0.3345
 Site-White_utk-0                   | Val  Loss: 2.0711 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 1.9643 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 2.0105 | Val  Acc: 0.4333
 Site-White_utk-3                   | Val  Loss: 2.0513 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 2.0353 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.8537 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.9508 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.9521 | Val  Acc: 0.3519
 Site-Black-0                       | Val  Loss: 2.0234 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.9844 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.9576 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3626
 Best site-White_utk-0               | Epoch:15 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:15 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:15 | Val Acc: 0.4333
 Best site-White_utk-3               | Epoch:15 | Val Acc: 0.3529
 Best site-White_utk-4               | Epoch:15 | Val Acc: 0.3793
 Best site-Middle_Eastern-0          | Epoch:15 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:15 | Val Acc: 0.4688
 Best site-Middle_Eastern-2          | Epoch:15 | Val Acc: 0.3519
 Best site-Black-0                   | Epoch:15 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:15 | Val Acc: 0.3721
 Best site-White-0                   | Epoch:15 | Val Acc: 0.3500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 16 ============
 Site-White_utk-0                   | Train Loss: 1.9961 | Train Acc: 0.3056
 Site-White_utk-1                   | Train Loss: 2.0020 | Train Acc: 0.3387
 Site-White_utk-2                   | Train Loss: 2.0434 | Train Acc: 0.2654
 Site-White_utk-3                   | Train Loss: 2.0070 | Train Acc: 0.3593
 Site-White_utk-4                   | Train Loss: 2.0123 | Train Acc: 0.3317
 Site-Middle_Eastern-0              | Train Loss: 2.0208 | Train Acc: 0.2748
 Site-Middle_Eastern-1              | Train Loss: 1.9510 | Train Acc: 0.3661
 Site-Middle_Eastern-2              | Train Loss: 1.9687 | Train Acc: 0.3438
 Site-Black-0                       | Train Loss: 2.0057 | Train Acc: 0.2955
 Site-Black-1                       | Train Loss: 2.0067 | Train Acc: 0.2791
 Site-White-0                       | Train Loss: 1.9211 | Train Acc: 0.4342
Average Train Accuracy: 0.3267
 Site-White_utk-0                   | Val  Loss: 2.0614 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 1.9570 | Val  Acc: 0.2353
 Site-White_utk-2                   | Val  Loss: 1.9851 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 2.0492 | Val  Acc: 0.3137
 Site-White_utk-4                   | Val  Loss: 2.0355 | Val  Acc: 0.3448
 Site-Middle_Eastern-0              | Val  Loss: 1.8543 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.9534 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.9432 | Val  Acc: 0.3333
 Site-Black-0                       | Val  Loss: 2.0013 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 1.9761 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.9412 | Val  Acc: 0.4250
Average Valid Accuracy: 0.3641
 Best site-White_utk-0               | Epoch:16 | Val Acc: 0.3000
 Best site-White_utk-1               | Epoch:16 | Val Acc: 0.2353
 Best site-White_utk-2               | Epoch:16 | Val Acc: 0.5333
 Best site-White_utk-3               | Epoch:16 | Val Acc: 0.3137
 Best site-White_utk-4               | Epoch:16 | Val Acc: 0.3448
 Best site-Middle_Eastern-0          | Epoch:16 | Val Acc: 0.4444
 Best site-Middle_Eastern-1          | Epoch:16 | Val Acc: 0.4062
 Best site-Middle_Eastern-2          | Epoch:16 | Val Acc: 0.3333
 Best site-Black-0                   | Epoch:16 | Val Acc: 0.3200
 Best site-Black-1                   | Epoch:16 | Val Acc: 0.3488
 Best site-White-0                   | Epoch:16 | Val Acc: 0.4250
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 17 ============
 Site-White_utk-0                   | Train Loss: 1.8961 | Train Acc: 0.4167
 Site-White_utk-1                   | Train Loss: 1.9914 | Train Acc: 0.4032
 Site-White_utk-2                   | Train Loss: 2.0248 | Train Acc: 0.2844
 Site-White_utk-3                   | Train Loss: 1.9976 | Train Acc: 0.3788
 Site-White_utk-4                   | Train Loss: 2.0025 | Train Acc: 0.3480
 Site-Middle_Eastern-0              | Train Loss: 1.9837 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.9517 | Train Acc: 0.3482
 Site-Middle_Eastern-2              | Train Loss: 1.9595 | Train Acc: 0.3333
 Site-Black-0                       | Train Loss: 1.9962 | Train Acc: 0.2898
 Site-Black-1                       | Train Loss: 2.0065 | Train Acc: 0.2724
 Site-White-0                       | Train Loss: 1.9107 | Train Acc: 0.4377
Average Train Accuracy: 0.3485
 Site-White_utk-0                   | Val  Loss: 2.0580 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 1.9642 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.9844 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.0404 | Val  Acc: 0.2745
 Site-White_utk-4                   | Val  Loss: 2.0294 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.8529 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.9305 | Val  Acc: 0.3125
 Site-Middle_Eastern-2              | Val  Loss: 1.9247 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 2.0050 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9791 | Val  Acc: 0.3256
 Site-White-0                       | Val  Loss: 1.9533 | Val  Acc: 0.3250
Average Valid Accuracy: 0.3429
============ Train epoch 18 ============
 Site-White_utk-0                   | Train Loss: 1.9053 | Train Acc: 0.4028
 Site-White_utk-1                   | Train Loss: 1.9785 | Train Acc: 0.3790
 Site-White_utk-2                   | Train Loss: 2.0265 | Train Acc: 0.2844
 Site-White_utk-3                   | Train Loss: 1.9976 | Train Acc: 0.3816
 Site-White_utk-4                   | Train Loss: 1.9933 | Train Acc: 0.3333
 Site-Middle_Eastern-0              | Train Loss: 1.9229 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.9299 | Train Acc: 0.3527
 Site-Middle_Eastern-2              | Train Loss: 1.9513 | Train Acc: 0.3281
 Site-Black-0                       | Train Loss: 1.9869 | Train Acc: 0.2727
 Site-Black-1                       | Train Loss: 1.9964 | Train Acc: 0.2957
 Site-White-0                       | Train Loss: 1.8884 | Train Acc: 0.4377
Average Train Accuracy: 0.3437
 Site-White_utk-0                   | Val  Loss: 2.0569 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 1.9417 | Val  Acc: 0.2353
 Site-White_utk-2                   | Val  Loss: 1.9635 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 2.0306 | Val  Acc: 0.3333
 Site-White_utk-4                   | Val  Loss: 2.0137 | Val  Acc: 0.4023
 Site-Middle_Eastern-0              | Val  Loss: 1.8283 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.9099 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.9223 | Val  Acc: 0.3519
 Site-Black-0                       | Val  Loss: 1.9968 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 1.9674 | Val  Acc: 0.2791
 Site-White-0                       | Val  Loss: 1.9248 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3596
============ Train epoch 19 ============
 Site-White_utk-0                   | Train Loss: 1.9993 | Train Acc: 0.3750
 Site-White_utk-1                   | Train Loss: 1.9799 | Train Acc: 0.3548
 Site-White_utk-2                   | Train Loss: 2.0094 | Train Acc: 0.2796
 Site-White_utk-3                   | Train Loss: 1.9903 | Train Acc: 0.3398
 Site-White_utk-4                   | Train Loss: 1.9818 | Train Acc: 0.3513
 Site-Middle_Eastern-0              | Train Loss: 1.9156 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.9228 | Train Acc: 0.3527
 Site-Middle_Eastern-2              | Train Loss: 1.9352 | Train Acc: 0.3675
 Site-Black-0                       | Train Loss: 1.9697 | Train Acc: 0.2727
 Site-Black-1                       | Train Loss: 1.9873 | Train Acc: 0.2757
 Site-White-0                       | Train Loss: 1.8760 | Train Acc: 0.4342
Average Train Accuracy: 0.3399
 Site-White_utk-0                   | Val  Loss: 2.0157 | Val  Acc: 0.3000
 Site-White_utk-1                   | Val  Loss: 1.9460 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.9701 | Val  Acc: 0.4333
 Site-White_utk-3                   | Val  Loss: 2.0155 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 2.0045 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.8394 | Val  Acc: 0.3333
 Site-Middle_Eastern-1              | Val  Loss: 1.9253 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.9149 | Val  Acc: 0.3333
 Site-Black-0                       | Val  Loss: 2.0014 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9557 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.9209 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3610
 Test site-White_utk-0               | Epoch:16 | Test Acc: 0.2727
 Test site-White_utk-1               | Epoch:16 | Test Acc: 0.3243
 Test site-White_utk-2               | Epoch:16 | Test Acc: 0.3934
 Test site-White_utk-3               | Epoch:16 | Test Acc: 0.3269
 Test site-White_utk-4               | Epoch:16 | Test Acc: 0.3750
 Test site-Middle_Eastern-0          | Epoch:16 | Test Acc: 0.5128
 Test site-Middle_Eastern-1          | Epoch:16 | Test Acc: 0.2769
 Test site-Middle_Eastern-2          | Epoch:16 | Test Acc: 0.3455
 Test site-Black-0                   | Epoch:16 | Test Acc: 0.2941
 Test site-Black-1                   | Epoch:16 | Test Acc: 0.3721
 Test site-White-0                   | Epoch:16 | Test Acc: 0.3210
White_utk: 0.3385, Middle_Eastern: 0.3784, Black: 0.3331, White: 0.3210, 
Average Test Accuracy(group): 0.3427, Average Test Accuracy(individual): 0.3468,
domain std=0.0215, cluster std=-1.0000, individual std=0.0646, 
============ Train epoch 20 ============
 Site-White_utk-0                   | Train Loss: 1.9029 | Train Acc: 0.4028
 Site-White_utk-1                   | Train Loss: 1.9645 | Train Acc: 0.3468
 Site-White_utk-2                   | Train Loss: 2.0182 | Train Acc: 0.2891
 Site-White_utk-3                   | Train Loss: 1.9780 | Train Acc: 0.3733
 Site-White_utk-4                   | Train Loss: 1.9821 | Train Acc: 0.3529
 Site-Middle_Eastern-0              | Train Loss: 1.9655 | Train Acc: 0.3282
 Site-Middle_Eastern-1              | Train Loss: 1.9195 | Train Acc: 0.3705
 Site-Middle_Eastern-2              | Train Loss: 1.9294 | Train Acc: 0.3622
 Site-Black-0                       | Train Loss: 1.9588 | Train Acc: 0.3011
 Site-Black-1                       | Train Loss: 1.9806 | Train Acc: 0.2890
 Site-White-0                       | Train Loss: 1.8706 | Train Acc: 0.4555
Average Train Accuracy: 0.3520
 Site-White_utk-0                   | Val  Loss: 2.0287 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.9162 | Val  Acc: 0.4706
 Site-White_utk-2                   | Val  Loss: 1.9426 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 2.0067 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 2.0031 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.8087 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.9045 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.9063 | Val  Acc: 0.3148
 Site-Black-0                       | Val  Loss: 1.9955 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.9579 | Val  Acc: 0.4186
 Site-White-0                       | Val  Loss: 1.9081 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3935
 Best site-White_utk-0               | Epoch:20 | Val Acc: 0.4000
 Best site-White_utk-1               | Epoch:20 | Val Acc: 0.4706
 Best site-White_utk-2               | Epoch:20 | Val Acc: 0.5333
 Best site-White_utk-3               | Epoch:20 | Val Acc: 0.3725
 Best site-White_utk-4               | Epoch:20 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:20 | Val Acc: 0.4444
 Best site-Middle_Eastern-1          | Epoch:20 | Val Acc: 0.4062
 Best site-Middle_Eastern-2          | Epoch:20 | Val Acc: 0.3148
 Best site-Black-0                   | Epoch:20 | Val Acc: 0.2000
 Best site-Black-1                   | Epoch:20 | Val Acc: 0.4186
 Best site-White-0                   | Epoch:20 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 21 ============
 Site-White_utk-0                   | Train Loss: 1.9258 | Train Acc: 0.4167
 Site-White_utk-1                   | Train Loss: 1.9618 | Train Acc: 0.4113
 Site-White_utk-2                   | Train Loss: 2.0145 | Train Acc: 0.2891
 Site-White_utk-3                   | Train Loss: 1.9684 | Train Acc: 0.3621
 Site-White_utk-4                   | Train Loss: 1.9635 | Train Acc: 0.3529
 Site-Middle_Eastern-0              | Train Loss: 1.8994 | Train Acc: 0.3130
 Site-Middle_Eastern-1              | Train Loss: 1.9148 | Train Acc: 0.3884
 Site-Middle_Eastern-2              | Train Loss: 1.9209 | Train Acc: 0.3517
 Site-Black-0                       | Train Loss: 1.9598 | Train Acc: 0.3068
 Site-Black-1                       | Train Loss: 1.9723 | Train Acc: 0.3090
 Site-White-0                       | Train Loss: 1.8561 | Train Acc: 0.4591
Average Train Accuracy: 0.3600
 Site-White_utk-0                   | Val  Loss: 1.9906 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.9186 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.9292 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 2.0051 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.9985 | Val  Acc: 0.3448
 Site-Middle_Eastern-0              | Val  Loss: 1.7900 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.9048 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.8716 | Val  Acc: 0.4815
 Site-Black-0                       | Val  Loss: 1.9868 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9498 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.9117 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3851
============ Train epoch 22 ============
 Site-White_utk-0                   | Train Loss: 1.9356 | Train Acc: 0.3889
 Site-White_utk-1                   | Train Loss: 1.9533 | Train Acc: 0.3710
 Site-White_utk-2                   | Train Loss: 1.9813 | Train Acc: 0.2938
 Site-White_utk-3                   | Train Loss: 1.9536 | Train Acc: 0.3872
 Site-White_utk-4                   | Train Loss: 1.9607 | Train Acc: 0.3546
 Site-Middle_Eastern-0              | Train Loss: 1.9539 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.9052 | Train Acc: 0.3795
 Site-Middle_Eastern-2              | Train Loss: 1.9125 | Train Acc: 0.3596
 Site-Black-0                       | Train Loss: 1.9550 | Train Acc: 0.2955
 Site-Black-1                       | Train Loss: 1.9724 | Train Acc: 0.2691
 Site-White-0                       | Train Loss: 1.8489 | Train Acc: 0.4342
Average Train Accuracy: 0.3503
 Site-White_utk-0                   | Val  Loss: 2.0085 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 1.9041 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.9333 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.9911 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 1.9837 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.7843 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.8862 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.8915 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.9633 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9266 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.8920 | Val  Acc: 0.3250
Average Valid Accuracy: 0.3627
============ Train epoch 23 ============
 Site-White_utk-0                   | Train Loss: 1.8725 | Train Acc: 0.3889
 Site-White_utk-1                   | Train Loss: 1.9540 | Train Acc: 0.4194
 Site-White_utk-2                   | Train Loss: 2.0012 | Train Acc: 0.2891
 Site-White_utk-3                   | Train Loss: 1.9543 | Train Acc: 0.3593
 Site-White_utk-4                   | Train Loss: 1.9538 | Train Acc: 0.3578
 Site-Middle_Eastern-0              | Train Loss: 1.9660 | Train Acc: 0.3206
 Site-Middle_Eastern-1              | Train Loss: 1.8908 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.9060 | Train Acc: 0.3517
 Site-Black-0                       | Train Loss: 1.9459 | Train Acc: 0.3239
 Site-Black-1                       | Train Loss: 1.9594 | Train Acc: 0.2990
 Site-White-0                       | Train Loss: 1.8369 | Train Acc: 0.4235
Average Train Accuracy: 0.3561
 Site-White_utk-0                   | Val  Loss: 2.0077 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8798 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.9463 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 1.9896 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.9904 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.7916 | Val  Acc: 0.5556
 Site-Middle_Eastern-1              | Val  Loss: 1.8802 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.8750 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.9846 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.9221 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.8876 | Val  Acc: 0.3500
Average Valid Accuracy: 0.3816
============ Train epoch 24 ============
 Site-White_utk-0                   | Train Loss: 1.9180 | Train Acc: 0.3611
 Site-White_utk-1                   | Train Loss: 1.9345 | Train Acc: 0.3710
 Site-White_utk-2                   | Train Loss: 1.9798 | Train Acc: 0.2938
 Site-White_utk-3                   | Train Loss: 1.9510 | Train Acc: 0.3816
 Site-White_utk-4                   | Train Loss: 1.9418 | Train Acc: 0.3480
 Site-Middle_Eastern-0              | Train Loss: 1.8788 | Train Acc: 0.3282
 Site-Middle_Eastern-1              | Train Loss: 1.8832 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.8967 | Train Acc: 0.3727
 Site-Black-0                       | Train Loss: 1.9412 | Train Acc: 0.3011
 Site-Black-1                       | Train Loss: 1.9616 | Train Acc: 0.2757
 Site-White-0                       | Train Loss: 1.8323 | Train Acc: 0.4448
Average Train Accuracy: 0.3511
 Site-White_utk-0                   | Val  Loss: 1.9874 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.8845 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.9188 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9728 | Val  Acc: 0.4314
 Site-White_utk-4                   | Val  Loss: 1.9711 | Val  Acc: 0.3908
 Site-Middle_Eastern-0              | Val  Loss: 1.7765 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.8765 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8793 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.9493 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9183 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.8550 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3971
 Best site-White_utk-0               | Epoch:24 | Val Acc: 0.5000
 Best site-White_utk-1               | Epoch:24 | Val Acc: 0.3529
 Best site-White_utk-2               | Epoch:24 | Val Acc: 0.5333
 Best site-White_utk-3               | Epoch:24 | Val Acc: 0.4314
 Best site-White_utk-4               | Epoch:24 | Val Acc: 0.3908
 Best site-Middle_Eastern-0          | Epoch:24 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:24 | Val Acc: 0.3750
 Best site-Middle_Eastern-2          | Epoch:24 | Val Acc: 0.4074
 Best site-Black-0                   | Epoch:24 | Val Acc: 0.2400
 Best site-Black-1                   | Epoch:24 | Val Acc: 0.3488
 Best site-White-0                   | Epoch:24 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 25 ============
 Site-White_utk-0                   | Train Loss: 1.8968 | Train Acc: 0.4028
 Site-White_utk-1                   | Train Loss: 1.9296 | Train Acc: 0.3952
 Site-White_utk-2                   | Train Loss: 1.9777 | Train Acc: 0.2796
 Site-White_utk-3                   | Train Loss: 1.9357 | Train Acc: 0.4011
 Site-White_utk-4                   | Train Loss: 1.9297 | Train Acc: 0.3644
 Site-Middle_Eastern-0              | Train Loss: 1.8889 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.8691 | Train Acc: 0.3795
 Site-Middle_Eastern-2              | Train Loss: 1.8922 | Train Acc: 0.3806
 Site-Black-0                       | Train Loss: 1.9337 | Train Acc: 0.2955
 Site-Black-1                       | Train Loss: 1.9484 | Train Acc: 0.2724
 Site-White-0                       | Train Loss: 1.8311 | Train Acc: 0.4591
Average Train Accuracy: 0.3605
 Site-White_utk-0                   | Val  Loss: 2.0248 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 1.8673 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.9202 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 1.9712 | Val  Acc: 0.2941
 Site-White_utk-4                   | Val  Loss: 1.9587 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.7386 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8632 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8729 | Val  Acc: 0.3148
 Site-Black-0                       | Val  Loss: 1.9640 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.9023 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.8690 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3393
============ Train epoch 26 ============
 Site-White_utk-0                   | Train Loss: 1.8709 | Train Acc: 0.4306
 Site-White_utk-1                   | Train Loss: 1.9193 | Train Acc: 0.4194
 Site-White_utk-2                   | Train Loss: 1.9838 | Train Acc: 0.2749
 Site-White_utk-3                   | Train Loss: 1.9309 | Train Acc: 0.3788
 Site-White_utk-4                   | Train Loss: 1.9256 | Train Acc: 0.3611
 Site-Middle_Eastern-0              | Train Loss: 1.8717 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.8677 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.8844 | Train Acc: 0.3570
 Site-Black-0                       | Train Loss: 1.9174 | Train Acc: 0.2955
 Site-Black-1                       | Train Loss: 1.9488 | Train Acc: 0.2824
 Site-White-0                       | Train Loss: 1.8122 | Train Acc: 0.4520
Average Train Accuracy: 0.3627
 Site-White_utk-0                   | Val  Loss: 1.9921 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8509 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.9127 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9584 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.9621 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.7758 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.8523 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.8531 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.9719 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8879 | Val  Acc: 0.4186
 Site-White-0                       | Val  Loss: 1.8537 | Val  Acc: 0.4000
Average Valid Accuracy: 0.3870
============ Train epoch 27 ============
 Site-White_utk-0                   | Train Loss: 1.8730 | Train Acc: 0.4306
 Site-White_utk-1                   | Train Loss: 1.9121 | Train Acc: 0.3871
 Site-White_utk-2                   | Train Loss: 1.9557 | Train Acc: 0.2607
 Site-White_utk-3                   | Train Loss: 1.9229 | Train Acc: 0.3816
 Site-White_utk-4                   | Train Loss: 1.9199 | Train Acc: 0.3709
 Site-Middle_Eastern-0              | Train Loss: 1.9200 | Train Acc: 0.3511
 Site-Middle_Eastern-1              | Train Loss: 1.8610 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.8776 | Train Acc: 0.3596
 Site-Black-0                       | Train Loss: 1.9107 | Train Acc: 0.3295
 Site-Black-1                       | Train Loss: 1.9474 | Train Acc: 0.2791
 Site-White-0                       | Train Loss: 1.8037 | Train Acc: 0.4591
Average Train Accuracy: 0.3630
 Site-White_utk-0                   | Val  Loss: 1.9766 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8471 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.8932 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 1.9745 | Val  Acc: 0.2941
 Site-White_utk-4                   | Val  Loss: 1.9511 | Val  Acc: 0.3908
 Site-Middle_Eastern-0              | Val  Loss: 1.7588 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8602 | Val  Acc: 0.4062
 Site-Middle_Eastern-2              | Val  Loss: 1.8397 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.9528 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8881 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.8611 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3839
============ Train epoch 28 ============
 Site-White_utk-0                   | Train Loss: 1.8421 | Train Acc: 0.4583
 Site-White_utk-1                   | Train Loss: 1.8967 | Train Acc: 0.4032
 Site-White_utk-2                   | Train Loss: 1.9443 | Train Acc: 0.3318
 Site-White_utk-3                   | Train Loss: 1.9173 | Train Acc: 0.4039
 Site-White_utk-4                   | Train Loss: 1.9118 | Train Acc: 0.3709
 Site-Middle_Eastern-0              | Train Loss: 1.8537 | Train Acc: 0.3359
 Site-Middle_Eastern-1              | Train Loss: 1.8510 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.8686 | Train Acc: 0.3727
 Site-Black-0                       | Train Loss: 1.9173 | Train Acc: 0.3466
 Site-Black-1                       | Train Loss: 1.9404 | Train Acc: 0.2824
 Site-White-0                       | Train Loss: 1.7979 | Train Acc: 0.4555
Average Train Accuracy: 0.3768
 Site-White_utk-0                   | Val  Loss: 1.9769 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8294 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.8886 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.9492 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 1.9447 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.7328 | Val  Acc: 0.3889
 Site-Middle_Eastern-1              | Val  Loss: 1.8299 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.8380 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.9146 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8784 | Val  Acc: 0.4186
 Site-White-0                       | Val  Loss: 1.8565 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4063
 Best site-White_utk-0               | Epoch:28 | Val Acc: 0.4000
 Best site-White_utk-1               | Epoch:28 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:28 | Val Acc: 0.5667
 Best site-White_utk-3               | Epoch:28 | Val Acc: 0.3529
 Best site-White_utk-4               | Epoch:28 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:28 | Val Acc: 0.3889
 Best site-Middle_Eastern-1          | Epoch:28 | Val Acc: 0.5000
 Best site-Middle_Eastern-2          | Epoch:28 | Val Acc: 0.4074
 Best site-Black-0                   | Epoch:28 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:28 | Val Acc: 0.4186
 Best site-White-0                   | Epoch:28 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 29 ============
 Site-White_utk-0                   | Train Loss: 1.9122 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.9057 | Train Acc: 0.3871
 Site-White_utk-2                   | Train Loss: 1.9538 | Train Acc: 0.2938
 Site-White_utk-3                   | Train Loss: 1.9076 | Train Acc: 0.4206
 Site-White_utk-4                   | Train Loss: 1.9050 | Train Acc: 0.3758
 Site-Middle_Eastern-0              | Train Loss: 1.8263 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.8470 | Train Acc: 0.4062
 Site-Middle_Eastern-2              | Train Loss: 1.8659 | Train Acc: 0.3543
 Site-Black-0                       | Train Loss: 1.9017 | Train Acc: 0.3352
 Site-Black-1                       | Train Loss: 1.9330 | Train Acc: 0.2990
 Site-White-0                       | Train Loss: 1.7998 | Train Acc: 0.4591
Average Train Accuracy: 0.3783
 Site-White_utk-0                   | Val  Loss: 1.9535 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8242 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.8670 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9414 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 1.9437 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.7274 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8337 | Val  Acc: 0.3750
 Site-Middle_Eastern-2              | Val  Loss: 1.8461 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.9405 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8774 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.8444 | Val  Acc: 0.3750
Average Valid Accuracy: 0.3788
 Test site-White_utk-0               | Epoch:28 | Test Acc: 0.3636
 Test site-White_utk-1               | Epoch:28 | Test Acc: 0.2973
 Test site-White_utk-2               | Epoch:28 | Test Acc: 0.4262
 Test site-White_utk-3               | Epoch:28 | Test Acc: 0.3654
 Test site-White_utk-4               | Epoch:28 | Test Acc: 0.3920
 Test site-Middle_Eastern-0          | Epoch:28 | Test Acc: 0.4103
 Test site-Middle_Eastern-1          | Epoch:28 | Test Acc: 0.3077
 Test site-Middle_Eastern-2          | Epoch:28 | Test Acc: 0.3909
 Test site-Black-0                   | Epoch:28 | Test Acc: 0.3333
 Test site-Black-1                   | Epoch:28 | Test Acc: 0.3837
 Test site-White-0                   | Epoch:28 | Test Acc: 0.3704
White_utk: 0.3689, Middle_Eastern: 0.3696, Black: 0.3585, White: 0.3704, 
Average Test Accuracy(group): 0.3669, Average Test Accuracy(individual): 0.3674,
domain std=0.0048, cluster std=-1.0000, individual std=0.0386, 
============ Train epoch 30 ============
 Site-White_utk-0                   | Train Loss: 1.8459 | Train Acc: 0.4444
 Site-White_utk-1                   | Train Loss: 1.8928 | Train Acc: 0.4355
 Site-White_utk-2                   | Train Loss: 1.9464 | Train Acc: 0.2938
 Site-White_utk-3                   | Train Loss: 1.8985 | Train Acc: 0.3983
 Site-White_utk-4                   | Train Loss: 1.8888 | Train Acc: 0.3775
 Site-Middle_Eastern-0              | Train Loss: 1.8520 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.8506 | Train Acc: 0.3750
 Site-Middle_Eastern-2              | Train Loss: 1.8540 | Train Acc: 0.3780
 Site-Black-0                       | Train Loss: 1.9027 | Train Acc: 0.3466
 Site-Black-1                       | Train Loss: 1.9250 | Train Acc: 0.2924
 Site-White-0                       | Train Loss: 1.7832 | Train Acc: 0.4555
Average Train Accuracy: 0.3764
 Site-White_utk-0                   | Val  Loss: 1.9727 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8256 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.8701 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9344 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.9320 | Val  Acc: 0.3218
 Site-Middle_Eastern-0              | Val  Loss: 1.7257 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8490 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.8205 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.9460 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8782 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.8252 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4017
============ Train epoch 31 ============
 Site-White_utk-0                   | Train Loss: 1.8875 | Train Acc: 0.4444
 Site-White_utk-1                   | Train Loss: 1.8876 | Train Acc: 0.4113
 Site-White_utk-2                   | Train Loss: 1.9318 | Train Acc: 0.3033
 Site-White_utk-3                   | Train Loss: 1.8961 | Train Acc: 0.4150
 Site-White_utk-4                   | Train Loss: 1.8848 | Train Acc: 0.3824
 Site-Middle_Eastern-0              | Train Loss: 1.8259 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.8346 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.8553 | Train Acc: 0.3753
 Site-Black-0                       | Train Loss: 1.8996 | Train Acc: 0.3182
 Site-Black-1                       | Train Loss: 1.9185 | Train Acc: 0.3090
 Site-White-0                       | Train Loss: 1.7793 | Train Acc: 0.4448
Average Train Accuracy: 0.3786
 Site-White_utk-0                   | Val  Loss: 1.9628 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.8271 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.8631 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9277 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.9164 | Val  Acc: 0.4138
 Site-Middle_Eastern-0              | Val  Loss: 1.6867 | Val  Acc: 0.5556
 Site-Middle_Eastern-1              | Val  Loss: 1.8212 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.8282 | Val  Acc: 0.3333
 Site-Black-0                       | Val  Loss: 1.9411 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8777 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.8288 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4044
============ Train epoch 32 ============
 Site-White_utk-0                   | Train Loss: 1.8470 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8937 | Train Acc: 0.3790
 Site-White_utk-2                   | Train Loss: 1.9282 | Train Acc: 0.3223
 Site-White_utk-3                   | Train Loss: 1.8891 | Train Acc: 0.4067
 Site-White_utk-4                   | Train Loss: 1.8753 | Train Acc: 0.3905
 Site-Middle_Eastern-0              | Train Loss: 1.7667 | Train Acc: 0.3435
 Site-Middle_Eastern-1              | Train Loss: 1.8387 | Train Acc: 0.3795
 Site-Middle_Eastern-2              | Train Loss: 1.8477 | Train Acc: 0.3517
 Site-Black-0                       | Train Loss: 1.8864 | Train Acc: 0.3352
 Site-Black-1                       | Train Loss: 1.9170 | Train Acc: 0.3056
 Site-White-0                       | Train Loss: 1.7692 | Train Acc: 0.4555
Average Train Accuracy: 0.3778
 Site-White_utk-0                   | Val  Loss: 1.9463 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.8046 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.8644 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.9100 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.9153 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.7510 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8223 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.8135 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.9685 | Val  Acc: 0.1600
 Site-Black-1                       | Val  Loss: 1.8699 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.8343 | Val  Acc: 0.3250
Average Valid Accuracy: 0.3997
============ Train epoch 33 ============
 Site-White_utk-0                   | Train Loss: 1.8480 | Train Acc: 0.4583
 Site-White_utk-1                   | Train Loss: 1.8746 | Train Acc: 0.4355
 Site-White_utk-2                   | Train Loss: 1.9287 | Train Acc: 0.3175
 Site-White_utk-3                   | Train Loss: 1.8772 | Train Acc: 0.4234
 Site-White_utk-4                   | Train Loss: 1.8840 | Train Acc: 0.3775
 Site-Middle_Eastern-0              | Train Loss: 1.8689 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.8313 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.8339 | Train Acc: 0.3911
 Site-Black-0                       | Train Loss: 1.8986 | Train Acc: 0.3182
 Site-Black-1                       | Train Loss: 1.9105 | Train Acc: 0.3223
 Site-White-0                       | Train Loss: 1.7715 | Train Acc: 0.4555
Average Train Accuracy: 0.3886
 Site-White_utk-0                   | Val  Loss: 1.9432 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7830 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.8634 | Val  Acc: 0.4667
 Site-White_utk-3                   | Val  Loss: 1.9084 | Val  Acc: 0.4314
 Site-White_utk-4                   | Val  Loss: 1.9117 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.7273 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.8003 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.8087 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 1.9084 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8590 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.8180 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4072
 Best site-White_utk-0               | Epoch:33 | Val Acc: 0.5000
 Best site-White_utk-1               | Epoch:33 | Val Acc: 0.3529
 Best site-White_utk-2               | Epoch:33 | Val Acc: 0.4667
 Best site-White_utk-3               | Epoch:33 | Val Acc: 0.4314
 Best site-White_utk-4               | Epoch:33 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:33 | Val Acc: 0.5000
 Best site-Middle_Eastern-1          | Epoch:33 | Val Acc: 0.4375
 Best site-Middle_Eastern-2          | Epoch:33 | Val Acc: 0.3704
 Best site-Black-0                   | Epoch:33 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:33 | Val Acc: 0.3721
 Best site-White-0                   | Epoch:33 | Val Acc: 0.4000
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 34 ============
 Site-White_utk-0                   | Train Loss: 1.8294 | Train Acc: 0.4167
 Site-White_utk-1                   | Train Loss: 1.8653 | Train Acc: 0.4194
 Site-White_utk-2                   | Train Loss: 1.9039 | Train Acc: 0.3081
 Site-White_utk-3                   | Train Loss: 1.8740 | Train Acc: 0.4150
 Site-White_utk-4                   | Train Loss: 1.8686 | Train Acc: 0.3873
 Site-Middle_Eastern-0              | Train Loss: 1.9120 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.8338 | Train Acc: 0.3750
 Site-Middle_Eastern-2              | Train Loss: 1.8375 | Train Acc: 0.3701
 Site-Black-0                       | Train Loss: 1.8894 | Train Acc: 0.3409
 Site-Black-1                       | Train Loss: 1.9078 | Train Acc: 0.3189
 Site-White-0                       | Train Loss: 1.7515 | Train Acc: 0.4555
Average Train Accuracy: 0.3801
 Site-White_utk-0                   | Val  Loss: 1.9244 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.8044 | Val  Acc: 0.2941
 Site-White_utk-2                   | Val  Loss: 1.8364 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 1.8996 | Val  Acc: 0.4314
 Site-White_utk-4                   | Val  Loss: 1.9031 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.7125 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.8029 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.8048 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.8978 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8397 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.8149 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4104
 Best site-White_utk-0               | Epoch:34 | Val Acc: 0.5000
 Best site-White_utk-1               | Epoch:34 | Val Acc: 0.2941
 Best site-White_utk-2               | Epoch:34 | Val Acc: 0.5000
 Best site-White_utk-3               | Epoch:34 | Val Acc: 0.4314
 Best site-White_utk-4               | Epoch:34 | Val Acc: 0.3678
 Best site-Middle_Eastern-0          | Epoch:34 | Val Acc: 0.4444
 Best site-Middle_Eastern-1          | Epoch:34 | Val Acc: 0.5000
 Best site-Middle_Eastern-2          | Epoch:34 | Val Acc: 0.4259
 Best site-Black-0                   | Epoch:34 | Val Acc: 0.2800
 Best site-Black-1                   | Epoch:34 | Val Acc: 0.3953
 Best site-White-0                   | Epoch:34 | Val Acc: 0.3750
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 35 ============
 Site-White_utk-0                   | Train Loss: 1.7831 | Train Acc: 0.4444
 Site-White_utk-1                   | Train Loss: 1.8487 | Train Acc: 0.4516
 Site-White_utk-2                   | Train Loss: 1.9120 | Train Acc: 0.3365
 Site-White_utk-3                   | Train Loss: 1.8653 | Train Acc: 0.4095
 Site-White_utk-4                   | Train Loss: 1.8624 | Train Acc: 0.3938
 Site-Middle_Eastern-0              | Train Loss: 1.8752 | Train Acc: 0.3511
 Site-Middle_Eastern-1              | Train Loss: 1.8102 | Train Acc: 0.3929
 Site-Middle_Eastern-2              | Train Loss: 1.8305 | Train Acc: 0.3937
 Site-Black-0                       | Train Loss: 1.8809 | Train Acc: 0.3239
 Site-Black-1                       | Train Loss: 1.8973 | Train Acc: 0.3156
 Site-White-0                       | Train Loss: 1.7521 | Train Acc: 0.4484
Average Train Accuracy: 0.3874
 Site-White_utk-0                   | Val  Loss: 1.9192 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.7898 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.8405 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8988 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.9037 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.6968 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.7900 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7966 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.9246 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8575 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.8026 | Val  Acc: 0.4250
Average Valid Accuracy: 0.4005
============ Train epoch 36 ============
 Site-White_utk-0                   | Train Loss: 1.7436 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8425 | Train Acc: 0.4597
 Site-White_utk-2                   | Train Loss: 1.9230 | Train Acc: 0.3081
 Site-White_utk-3                   | Train Loss: 1.8540 | Train Acc: 0.4262
 Site-White_utk-4                   | Train Loss: 1.8500 | Train Acc: 0.3971
 Site-Middle_Eastern-0              | Train Loss: 1.7711 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.8103 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.8269 | Train Acc: 0.3911
 Site-Black-0                       | Train Loss: 1.8787 | Train Acc: 0.3409
 Site-Black-1                       | Train Loss: 1.8934 | Train Acc: 0.3322
 Site-White-0                       | Train Loss: 1.7609 | Train Acc: 0.4555
Average Train Accuracy: 0.3952
 Site-White_utk-0                   | Val  Loss: 1.9466 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7787 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.8129 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.9007 | Val  Acc: 0.3529
 Site-White_utk-4                   | Val  Loss: 1.8870 | Val  Acc: 0.4023
 Site-Middle_Eastern-0              | Val  Loss: 1.6650 | Val  Acc: 0.6111
 Site-Middle_Eastern-1              | Val  Loss: 1.7975 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7811 | Val  Acc: 0.4444
 Site-Black-0                       | Val  Loss: 1.9232 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8324 | Val  Acc: 0.4186
 Site-White-0                       | Val  Loss: 1.8064 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4369
 Best site-White_utk-0               | Epoch:36 | Val Acc: 0.5000
 Best site-White_utk-1               | Epoch:36 | Val Acc: 0.3529
 Best site-White_utk-2               | Epoch:36 | Val Acc: 0.5333
 Best site-White_utk-3               | Epoch:36 | Val Acc: 0.3529
 Best site-White_utk-4               | Epoch:36 | Val Acc: 0.4023
 Best site-Middle_Eastern-0          | Epoch:36 | Val Acc: 0.6111
 Best site-Middle_Eastern-1          | Epoch:36 | Val Acc: 0.5000
 Best site-Middle_Eastern-2          | Epoch:36 | Val Acc: 0.4444
 Best site-Black-0                   | Epoch:36 | Val Acc: 0.2400
 Best site-Black-1                   | Epoch:36 | Val Acc: 0.4186
 Best site-White-0                   | Epoch:36 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 37 ============
 Site-White_utk-0                   | Train Loss: 1.7639 | Train Acc: 0.4583
 Site-White_utk-1                   | Train Loss: 1.8379 | Train Acc: 0.4113
 Site-White_utk-2                   | Train Loss: 1.8877 | Train Acc: 0.3602
 Site-White_utk-3                   | Train Loss: 1.8553 | Train Acc: 0.4345
 Site-White_utk-4                   | Train Loss: 1.8402 | Train Acc: 0.4232
 Site-Middle_Eastern-0              | Train Loss: 1.8917 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.8065 | Train Acc: 0.3884
 Site-Middle_Eastern-2              | Train Loss: 1.8201 | Train Acc: 0.3780
 Site-Black-0                       | Train Loss: 1.8602 | Train Acc: 0.3523
 Site-Black-1                       | Train Loss: 1.8976 | Train Acc: 0.3156
 Site-White-0                       | Train Loss: 1.7385 | Train Acc: 0.4520
Average Train Accuracy: 0.3953
 Site-White_utk-0                   | Val  Loss: 1.9073 | Val  Acc: 0.6000
 Site-White_utk-1                   | Val  Loss: 1.7565 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.8089 | Val  Acc: 0.6000
 Site-White_utk-3                   | Val  Loss: 1.8937 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.8969 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.6624 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7897 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.7855 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 1.9077 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8375 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7929 | Val  Acc: 0.4750
Average Valid Accuracy: 0.4319
============ Train epoch 38 ============
 Site-White_utk-0                   | Train Loss: 1.7663 | Train Acc: 0.4167
 Site-White_utk-1                   | Train Loss: 1.8304 | Train Acc: 0.4274
 Site-White_utk-2                   | Train Loss: 1.8832 | Train Acc: 0.3507
 Site-White_utk-3                   | Train Loss: 1.8468 | Train Acc: 0.4123
 Site-White_utk-4                   | Train Loss: 1.8410 | Train Acc: 0.4085
 Site-Middle_Eastern-0              | Train Loss: 1.9157 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.8104 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.8118 | Train Acc: 0.4016
 Site-Black-0                       | Train Loss: 1.8675 | Train Acc: 0.3409
 Site-Black-1                       | Train Loss: 1.8892 | Train Acc: 0.3189
 Site-White-0                       | Train Loss: 1.7392 | Train Acc: 0.4698
Average Train Accuracy: 0.3923
 Site-White_utk-0                   | Val  Loss: 1.9050 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7719 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.8165 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 1.8953 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.8744 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.6609 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7886 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7812 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 1.9249 | Val  Acc: 0.2400
 Site-Black-1                       | Val  Loss: 1.8234 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7814 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4146
============ Train epoch 39 ============
 Site-White_utk-0                   | Train Loss: 1.7883 | Train Acc: 0.4722
 Site-White_utk-1                   | Train Loss: 1.8388 | Train Acc: 0.4032
 Site-White_utk-2                   | Train Loss: 1.8942 | Train Acc: 0.3033
 Site-White_utk-3                   | Train Loss: 1.8440 | Train Acc: 0.4262
 Site-White_utk-4                   | Train Loss: 1.8300 | Train Acc: 0.4020
 Site-Middle_Eastern-0              | Train Loss: 1.7845 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7978 | Train Acc: 0.3839
 Site-Middle_Eastern-2              | Train Loss: 1.8103 | Train Acc: 0.3937
 Site-Black-0                       | Train Loss: 1.8618 | Train Acc: 0.3239
 Site-Black-1                       | Train Loss: 1.8824 | Train Acc: 0.3090
 Site-White-0                       | Train Loss: 1.7341 | Train Acc: 0.4804
Average Train Accuracy: 0.3870
 Site-White_utk-0                   | Val  Loss: 1.9081 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7587 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.7919 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8724 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.8793 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.6927 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7858 | Val  Acc: 0.5312
 Site-Middle_Eastern-2              | Val  Loss: 1.7569 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.9218 | Val  Acc: 0.1600
 Site-Black-1                       | Val  Loss: 1.8309 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7736 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4127
 Test site-White_utk-0               | Epoch:36 | Test Acc: 0.3636
 Test site-White_utk-1               | Epoch:36 | Test Acc: 0.4595
 Test site-White_utk-2               | Epoch:36 | Test Acc: 0.4754
 Test site-White_utk-3               | Epoch:36 | Test Acc: 0.3462
 Test site-White_utk-4               | Epoch:36 | Test Acc: 0.4034
 Test site-Middle_Eastern-0          | Epoch:36 | Test Acc: 0.4615
 Test site-Middle_Eastern-1          | Epoch:36 | Test Acc: 0.3538
 Test site-Middle_Eastern-2          | Epoch:36 | Test Acc: 0.4182
 Test site-Black-0                   | Epoch:36 | Test Acc: 0.3529
 Test site-Black-1                   | Epoch:36 | Test Acc: 0.4070
 Test site-White-0                   | Epoch:36 | Test Acc: 0.3580
White_utk: 0.4096, Middle_Eastern: 0.4112, Black: 0.3800, White: 0.3580, 
Average Test Accuracy(group): 0.3897, Average Test Accuracy(individual): 0.4000,
domain std=0.0221, cluster std=-1.0000, individual std=0.0464, 
============ Train epoch 40 ============
 Site-White_utk-0                   | Train Loss: 1.8206 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8370 | Train Acc: 0.4113
 Site-White_utk-2                   | Train Loss: 1.8758 | Train Acc: 0.3460
 Site-White_utk-3                   | Train Loss: 1.8368 | Train Acc: 0.4123
 Site-White_utk-4                   | Train Loss: 1.8217 | Train Acc: 0.4134
 Site-Middle_Eastern-0              | Train Loss: 1.7505 | Train Acc: 0.3511
 Site-Middle_Eastern-1              | Train Loss: 1.7810 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.7986 | Train Acc: 0.3911
 Site-Black-0                       | Train Loss: 1.8512 | Train Acc: 0.3182
 Site-Black-1                       | Train Loss: 1.8828 | Train Acc: 0.3289
 Site-White-0                       | Train Loss: 1.7241 | Train Acc: 0.4626
Average Train Accuracy: 0.3930
 Site-White_utk-0                   | Val  Loss: 1.8965 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7573 | Val  Acc: 0.4706
 Site-White_utk-2                   | Val  Loss: 1.7850 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.8730 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.8634 | Val  Acc: 0.3908
 Site-Middle_Eastern-0              | Val  Loss: 1.6597 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.7884 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.7575 | Val  Acc: 0.4815
 Site-Black-0                       | Val  Loss: 1.9138 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.8079 | Val  Acc: 0.4186
 Site-White-0                       | Val  Loss: 1.7710 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4349
============ Train epoch 41 ============
 Site-White_utk-0                   | Train Loss: 1.8866 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8246 | Train Acc: 0.4355
 Site-White_utk-2                   | Train Loss: 1.8794 | Train Acc: 0.3602
 Site-White_utk-3                   | Train Loss: 1.8309 | Train Acc: 0.4234
 Site-White_utk-4                   | Train Loss: 1.8174 | Train Acc: 0.4199
 Site-Middle_Eastern-0              | Train Loss: 1.7828 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.7750 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.8034 | Train Acc: 0.3885
 Site-Black-0                       | Train Loss: 1.8380 | Train Acc: 0.3466
 Site-Black-1                       | Train Loss: 1.8711 | Train Acc: 0.3123
 Site-White-0                       | Train Loss: 1.7197 | Train Acc: 0.4840
Average Train Accuracy: 0.4022
 Site-White_utk-0                   | Val  Loss: 1.8784 | Val  Acc: 0.6000
 Site-White_utk-1                   | Val  Loss: 1.7283 | Val  Acc: 0.3529
 Site-White_utk-2                   | Val  Loss: 1.7808 | Val  Acc: 0.6000
 Site-White_utk-3                   | Val  Loss: 1.8457 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.8563 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.6335 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7801 | Val  Acc: 0.4375
 Site-Middle_Eastern-2              | Val  Loss: 1.7709 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.9105 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.8208 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.7716 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4197
============ Train epoch 42 ============
 Site-White_utk-0                   | Train Loss: 1.6968 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8177 | Train Acc: 0.4355
 Site-White_utk-2                   | Train Loss: 1.8643 | Train Acc: 0.3412
 Site-White_utk-3                   | Train Loss: 1.8195 | Train Acc: 0.3983
 Site-White_utk-4                   | Train Loss: 1.8161 | Train Acc: 0.4020
 Site-Middle_Eastern-0              | Train Loss: 1.7634 | Train Acc: 0.3740
 Site-Middle_Eastern-1              | Train Loss: 1.7716 | Train Acc: 0.4107
 Site-Middle_Eastern-2              | Train Loss: 1.7919 | Train Acc: 0.4042
 Site-Black-0                       | Train Loss: 1.8384 | Train Acc: 0.3750
 Site-Black-1                       | Train Loss: 1.8781 | Train Acc: 0.3023
 Site-White-0                       | Train Loss: 1.7020 | Train Acc: 0.4804
Average Train Accuracy: 0.4009
 Site-White_utk-0                   | Val  Loss: 1.8812 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.7440 | Val  Acc: 0.4706
 Site-White_utk-2                   | Val  Loss: 1.7932 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8526 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.8569 | Val  Acc: 0.4023
 Site-Middle_Eastern-0              | Val  Loss: 1.6352 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7533 | Val  Acc: 0.5312
 Site-Middle_Eastern-2              | Val  Loss: 1.7589 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.8755 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.8074 | Val  Acc: 0.3488
 Site-White-0                       | Val  Loss: 1.7754 | Val  Acc: 0.4250
Average Valid Accuracy: 0.4226
============ Train epoch 43 ============
 Site-White_utk-0                   | Train Loss: 1.7732 | Train Acc: 0.4583
 Site-White_utk-1                   | Train Loss: 1.8090 | Train Acc: 0.4194
 Site-White_utk-2                   | Train Loss: 1.8667 | Train Acc: 0.3507
 Site-White_utk-3                   | Train Loss: 1.8174 | Train Acc: 0.4178
 Site-White_utk-4                   | Train Loss: 1.8023 | Train Acc: 0.4167
 Site-Middle_Eastern-0              | Train Loss: 1.8119 | Train Acc: 0.3817
 Site-Middle_Eastern-1              | Train Loss: 1.7871 | Train Acc: 0.4062
 Site-Middle_Eastern-2              | Train Loss: 1.7883 | Train Acc: 0.3858
 Site-Black-0                       | Train Loss: 1.8402 | Train Acc: 0.3693
 Site-Black-1                       | Train Loss: 1.8754 | Train Acc: 0.3023
 Site-White-0                       | Train Loss: 1.6951 | Train Acc: 0.5053
Average Train Accuracy: 0.4012
 Site-White_utk-0                   | Val  Loss: 1.8654 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.6957 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.7688 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.8519 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.8530 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.6368 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.7679 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.7390 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.8801 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.7955 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7540 | Val  Acc: 0.4750
Average Valid Accuracy: 0.4235
============ Train epoch 44 ============
 Site-White_utk-0                   | Train Loss: 1.7695 | Train Acc: 0.4583
 Site-White_utk-1                   | Train Loss: 1.8071 | Train Acc: 0.4274
 Site-White_utk-2                   | Train Loss: 1.8689 | Train Acc: 0.3460
 Site-White_utk-3                   | Train Loss: 1.7974 | Train Acc: 0.4485
 Site-White_utk-4                   | Train Loss: 1.8016 | Train Acc: 0.4167
 Site-Middle_Eastern-0              | Train Loss: 1.7866 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7731 | Train Acc: 0.4107
 Site-Middle_Eastern-2              | Train Loss: 1.7775 | Train Acc: 0.3858
 Site-Black-0                       | Train Loss: 1.8339 | Train Acc: 0.3636
 Site-Black-1                       | Train Loss: 1.8618 | Train Acc: 0.3223
 Site-White-0                       | Train Loss: 1.6954 | Train Acc: 0.4947
Average Train Accuracy: 0.4030
 Site-White_utk-0                   | Val  Loss: 1.8837 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.6992 | Val  Acc: 0.4706
 Site-White_utk-2                   | Val  Loss: 1.7788 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8392 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.8493 | Val  Acc: 0.3563
 Site-Middle_Eastern-0              | Val  Loss: 1.6222 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7462 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7421 | Val  Acc: 0.4074
 Site-Black-0                       | Val  Loss: 1.8736 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 1.8137 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7409 | Val  Acc: 0.4250
Average Valid Accuracy: 0.4255
============ Train epoch 45 ============
 Site-White_utk-0                   | Train Loss: 1.7526 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.8009 | Train Acc: 0.4113
 Site-White_utk-2                   | Train Loss: 1.8352 | Train Acc: 0.3460
 Site-White_utk-3                   | Train Loss: 1.8124 | Train Acc: 0.4429
 Site-White_utk-4                   | Train Loss: 1.7856 | Train Acc: 0.4248
 Site-Middle_Eastern-0              | Train Loss: 1.8160 | Train Acc: 0.4122
 Site-Middle_Eastern-1              | Train Loss: 1.7775 | Train Acc: 0.4196
 Site-Middle_Eastern-2              | Train Loss: 1.7762 | Train Acc: 0.3753
 Site-Black-0                       | Train Loss: 1.8374 | Train Acc: 0.3693
 Site-Black-1                       | Train Loss: 1.8770 | Train Acc: 0.3023
 Site-White-0                       | Train Loss: 1.7038 | Train Acc: 0.4662
Average Train Accuracy: 0.4051
 Site-White_utk-0                   | Val  Loss: 1.8858 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7096 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.7650 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 1.8465 | Val  Acc: 0.3725
 Site-White_utk-4                   | Val  Loss: 1.8359 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.6308 | Val  Acc: 0.5556
 Site-Middle_Eastern-1              | Val  Loss: 1.7462 | Val  Acc: 0.5312
 Site-Middle_Eastern-2              | Val  Loss: 1.7417 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.8567 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8183 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.7422 | Val  Acc: 0.4000
Average Valid Accuracy: 0.4299
============ Train epoch 46 ============
 Site-White_utk-0                   | Train Loss: 1.7084 | Train Acc: 0.4444
 Site-White_utk-1                   | Train Loss: 1.7930 | Train Acc: 0.4435
 Site-White_utk-2                   | Train Loss: 1.8542 | Train Acc: 0.3412
 Site-White_utk-3                   | Train Loss: 1.7983 | Train Acc: 0.4178
 Site-White_utk-4                   | Train Loss: 1.7827 | Train Acc: 0.4444
 Site-Middle_Eastern-0              | Train Loss: 1.6469 | Train Acc: 0.3664
 Site-Middle_Eastern-1              | Train Loss: 1.7608 | Train Acc: 0.4018
 Site-Middle_Eastern-2              | Train Loss: 1.7679 | Train Acc: 0.3990
 Site-Black-0                       | Train Loss: 1.8171 | Train Acc: 0.3636
 Site-Black-1                       | Train Loss: 1.8540 | Train Acc: 0.3488
 Site-White-0                       | Train Loss: 1.6815 | Train Acc: 0.4733
Average Train Accuracy: 0.4040
 Site-White_utk-0                   | Val  Loss: 1.8445 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7039 | Val  Acc: 0.4706
 Site-White_utk-2                   | Val  Loss: 1.7592 | Val  Acc: 0.5000
 Site-White_utk-3                   | Val  Loss: 1.8276 | Val  Acc: 0.4314
 Site-White_utk-4                   | Val  Loss: 1.8271 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.6493 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7451 | Val  Acc: 0.4688
 Site-Middle_Eastern-2              | Val  Loss: 1.7346 | Val  Acc: 0.3889
 Site-Black-0                       | Val  Loss: 1.8653 | Val  Acc: 0.2800
 Site-Black-1                       | Val  Loss: 1.8146 | Val  Acc: 0.4419
 Site-White-0                       | Val  Loss: 1.7275 | Val  Acc: 0.3750
Average Valid Accuracy: 0.4295
============ Train epoch 47 ============
 Site-White_utk-0                   | Train Loss: 1.7779 | Train Acc: 0.5278
 Site-White_utk-1                   | Train Loss: 1.7757 | Train Acc: 0.4677
 Site-White_utk-2                   | Train Loss: 1.8170 | Train Acc: 0.3460
 Site-White_utk-3                   | Train Loss: 1.7937 | Train Acc: 0.4123
 Site-White_utk-4                   | Train Loss: 1.7785 | Train Acc: 0.4363
 Site-Middle_Eastern-0              | Train Loss: 1.8540 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7495 | Train Acc: 0.4152
 Site-Middle_Eastern-2              | Train Loss: 1.7633 | Train Acc: 0.3911
 Site-Black-0                       | Train Loss: 1.8145 | Train Acc: 0.3523
 Site-Black-1                       | Train Loss: 1.8525 | Train Acc: 0.3522
 Site-White-0                       | Train Loss: 1.6871 | Train Acc: 0.4698
Average Train Accuracy: 0.4117
 Site-White_utk-0                   | Val  Loss: 1.8558 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.6939 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.7478 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8338 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.8273 | Val  Acc: 0.3908
 Site-Middle_Eastern-0              | Val  Loss: 1.6022 | Val  Acc: 0.4444
 Site-Middle_Eastern-1              | Val  Loss: 1.7298 | Val  Acc: 0.5625
 Site-Middle_Eastern-2              | Val  Loss: 1.7172 | Val  Acc: 0.4259
 Site-Black-0                       | Val  Loss: 1.8734 | Val  Acc: 0.3200
 Site-Black-1                       | Val  Loss: 1.7926 | Val  Acc: 0.3953
 Site-White-0                       | Val  Loss: 1.7500 | Val  Acc: 0.4500
Average Valid Accuracy: 0.4405
 Best site-White_utk-0               | Epoch:47 | Val Acc: 0.5000
 Best site-White_utk-1               | Epoch:47 | Val Acc: 0.4118
 Best site-White_utk-2               | Epoch:47 | Val Acc: 0.5333
 Best site-White_utk-3               | Epoch:47 | Val Acc: 0.4118
 Best site-White_utk-4               | Epoch:47 | Val Acc: 0.3908
 Best site-Middle_Eastern-0          | Epoch:47 | Val Acc: 0.4444
 Best site-Middle_Eastern-1          | Epoch:47 | Val Acc: 0.5625
 Best site-Middle_Eastern-2          | Epoch:47 | Val Acc: 0.4259
 Best site-Black-0                   | Epoch:47 | Val Acc: 0.3200
 Best site-Black-1                   | Epoch:47 | Val Acc: 0.3953
 Best site-White-0                   | Epoch:47 | Val Acc: 0.4500
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 48 ============
 Site-White_utk-0                   | Train Loss: 1.6942 | Train Acc: 0.4861
 Site-White_utk-1                   | Train Loss: 1.7762 | Train Acc: 0.4597
 Site-White_utk-2                   | Train Loss: 1.8200 | Train Acc: 0.3507
 Site-White_utk-3                   | Train Loss: 1.7865 | Train Acc: 0.4401
 Site-White_utk-4                   | Train Loss: 1.7772 | Train Acc: 0.4314
 Site-Middle_Eastern-0              | Train Loss: 1.7829 | Train Acc: 0.3817
 Site-Middle_Eastern-1              | Train Loss: 1.7509 | Train Acc: 0.4241
 Site-Middle_Eastern-2              | Train Loss: 1.7617 | Train Acc: 0.3990
 Site-Black-0                       | Train Loss: 1.8203 | Train Acc: 0.3580
 Site-Black-1                       | Train Loss: 1.8488 | Train Acc: 0.3422
 Site-White-0                       | Train Loss: 1.6720 | Train Acc: 0.4804
Average Train Accuracy: 0.4139
 Site-White_utk-0                   | Val  Loss: 1.8643 | Val  Acc: 0.4000
 Site-White_utk-1                   | Val  Loss: 1.6949 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.7464 | Val  Acc: 0.5333
 Site-White_utk-3                   | Val  Loss: 1.8184 | Val  Acc: 0.4118
 Site-White_utk-4                   | Val  Loss: 1.8245 | Val  Acc: 0.3793
 Site-Middle_Eastern-0              | Val  Loss: 1.6349 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7324 | Val  Acc: 0.5000
 Site-Middle_Eastern-2              | Val  Loss: 1.7297 | Val  Acc: 0.3704
 Site-Black-0                       | Val  Loss: 1.8727 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.7848 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.7394 | Val  Acc: 0.4250
Average Valid Accuracy: 0.4094
============ Train epoch 49 ============
 Site-White_utk-0                   | Train Loss: 1.7280 | Train Acc: 0.4722
 Site-White_utk-1                   | Train Loss: 1.7521 | Train Acc: 0.4758
 Site-White_utk-2                   | Train Loss: 1.8219 | Train Acc: 0.3412
 Site-White_utk-3                   | Train Loss: 1.7857 | Train Acc: 0.4150
 Site-White_utk-4                   | Train Loss: 1.7625 | Train Acc: 0.4395
 Site-Middle_Eastern-0              | Train Loss: 1.6946 | Train Acc: 0.3588
 Site-Middle_Eastern-1              | Train Loss: 1.7588 | Train Acc: 0.4375
 Site-Middle_Eastern-2              | Train Loss: 1.7582 | Train Acc: 0.4042
 Site-Black-0                       | Train Loss: 1.8053 | Train Acc: 0.3466
 Site-Black-1                       | Train Loss: 1.8509 | Train Acc: 0.3189
 Site-White-0                       | Train Loss: 1.6697 | Train Acc: 0.4804
Average Train Accuracy: 0.4082
 Site-White_utk-0                   | Val  Loss: 1.8380 | Val  Acc: 0.5000
 Site-White_utk-1                   | Val  Loss: 1.7081 | Val  Acc: 0.4118
 Site-White_utk-2                   | Val  Loss: 1.7409 | Val  Acc: 0.5667
 Site-White_utk-3                   | Val  Loss: 1.8120 | Val  Acc: 0.3922
 Site-White_utk-4                   | Val  Loss: 1.8096 | Val  Acc: 0.3678
 Site-Middle_Eastern-0              | Val  Loss: 1.5854 | Val  Acc: 0.5000
 Site-Middle_Eastern-1              | Val  Loss: 1.7313 | Val  Acc: 0.5625
 Site-Middle_Eastern-2              | Val  Loss: 1.7126 | Val  Acc: 0.4444
 Site-Black-0                       | Val  Loss: 1.8799 | Val  Acc: 0.2000
 Site-Black-1                       | Val  Loss: 1.7835 | Val  Acc: 0.3721
 Site-White-0                       | Val  Loss: 1.7315 | Val  Acc: 0.4250
Average Valid Accuracy: 0.4311
 Test site-White_utk-0               | Epoch:47 | Test Acc: 0.4091
 Test site-White_utk-1               | Epoch:47 | Test Acc: 0.4054
 Test site-White_utk-2               | Epoch:47 | Test Acc: 0.5082
 Test site-White_utk-3               | Epoch:47 | Test Acc: 0.4519
 Test site-White_utk-4               | Epoch:47 | Test Acc: 0.4432
 Test site-Middle_Eastern-0          | Epoch:47 | Test Acc: 0.5128
 Test site-Middle_Eastern-1          | Epoch:47 | Test Acc: 0.4000
 Test site-Middle_Eastern-2          | Epoch:47 | Test Acc: 0.4364
 Test site-Black-0                   | Epoch:47 | Test Acc: 0.3333
 Test site-Black-1                   | Epoch:47 | Test Acc: 0.3953
 Test site-White-0                   | Epoch:47 | Test Acc: 0.4198
White_utk: 0.4436, Middle_Eastern: 0.4497, Black: 0.3643, White: 0.4198, 
Average Test Accuracy(group): 0.4193, Average Test Accuracy(individual): 0.4287,
domain std=0.0337, cluster std=-1.0000, individual std=0.0488, 
===2023-06-16 11:12:11===
===2023-06-16 11:12:13===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 32
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[72,124,211,359,612,131,224,381,176,301,281,]
client_nums=[5,3,2,1,]
len_dataset=[3952,2112,1367,804,]
domain number = -1
Loading snapshots...
 Test site-White_utk-0               | Epoch:47 | Test Acc: 0.4091
 Test site-White_utk-1               | Epoch:47 | Test Acc: 0.4595
 Test site-White_utk-2               | Epoch:47 | Test Acc: 0.5082
 Test site-White_utk-3               | Epoch:47 | Test Acc: 0.4135
 Test site-White_utk-4               | Epoch:47 | Test Acc: 0.4318
 Test site-Middle_Eastern-0          | Epoch:47 | Test Acc: 0.4872
 Test site-Middle_Eastern-1          | Epoch:47 | Test Acc: 0.4000
 Test site-Middle_Eastern-2          | Epoch:47 | Test Acc: 0.4364
 Test site-Black-0                   | Epoch:47 | Test Acc: 0.3529
 Test site-Black-1                   | Epoch:47 | Test Acc: 0.3605
 Test site-White-0                   | Epoch:47 | Test Acc: 0.3704
White_utk: 0.4444, Middle_Eastern: 0.4412, Black: 0.3567, White: 0.3704, 
Average Test Accuracy(group): 0.4032, Average Test Accuracy(individual): 0.4208,
domain std=0.0399, cluster std=-1.0000, individual std=0.0480, 
===2023-06-16 12:46:56===
===Setting===
    dataset: fairface
    lr: 0.01
    batch: 64
    iters: 50
    wk_iters: 1
    si: False
    domain_num: -1
    quantile: 0
    std_rw: False
    gender_label: False
    binary_race: False
    save_iter: -1
    mix: False
    mix2: False
    mix3: False
    mix4: False
data_number=[72,124,211,359,612,136,232,394,176,301,281,]
client_nums=[5,3,2,1,]
len_dataset=[3952,2184,1367,804,]
domain number = -1
============ Train epoch 0 ============
 Site-White_utk-0                   | Train Loss: 2.2051 | Train Acc: 0.1667
 Site-White_utk-1                   | Train Loss: 2.1753 | Train Acc: 0.1532
 Site-White_utk-2                   | Train Loss: 2.1872 | Train Acc: 0.1801
 Site-White_utk-3                   | Train Loss: 2.1798 | Train Acc: 0.1838
 Site-White_utk-4                   | Train Loss: 2.1761 | Train Acc: 0.1846
 Site-Indian-0                      | Train Loss: 2.1821 | Train Acc: 0.1397
 Site-Indian-1                      | Train Loss: 2.1730 | Train Acc: 0.1853
 Site-Indian-2                      | Train Loss: 2.1850 | Train Acc: 0.1701
 Site-Middle_Eastern-0              | Train Loss: 2.1683 | Train Acc: 0.2045
 Site-Middle_Eastern-1              | Train Loss: 2.1693 | Train Acc: 0.1694
 Site-Black_utk-0                   | Train Loss: 2.1809 | Train Acc: 0.1530
Average Train Accuracy: 0.1719
 Site-White_utk-0                   | Val  Loss: 2.1655 | Val  Acc: 0.2000
 Site-White_utk-1                   | Val  Loss: 2.2033 | Val  Acc: 0.0588
 Site-White_utk-2                   | Val  Loss: 2.1665 | Val  Acc: 0.2000
 Site-White_utk-3                   | Val  Loss: 2.1776 | Val  Acc: 0.1373
 Site-White_utk-4                   | Val  Loss: 2.1833 | Val  Acc: 0.1724
 Site-Indian-0                      | Val  Loss: 2.1807 | Val  Acc: 0.1579
 Site-Indian-1                      | Val  Loss: 2.2189 | Val  Acc: 0.0909
 Site-Indian-2                      | Val  Loss: 2.1871 | Val  Acc: 0.1607
 Site-Middle_Eastern-0              | Val  Loss: 2.1569 | Val  Acc: 0.3200
 Site-Middle_Eastern-1              | Val  Loss: 2.1597 | Val  Acc: 0.0930
 Site-Black_utk-0                   | Val  Loss: 2.1524 | Val  Acc: 0.2750
Average Valid Accuracy: 0.1696
 Best site-White_utk-0               | Epoch:0 | Val Acc: 0.2000
 Best site-White_utk-1               | Epoch:0 | Val Acc: 0.0588
 Best site-White_utk-2               | Epoch:0 | Val Acc: 0.2000
 Best site-White_utk-3               | Epoch:0 | Val Acc: 0.1373
 Best site-White_utk-4               | Epoch:0 | Val Acc: 0.1724
 Best site-Indian-0                  | Epoch:0 | Val Acc: 0.1579
 Best site-Indian-1                  | Epoch:0 | Val Acc: 0.0909
 Best site-Indian-2                  | Epoch:0 | Val Acc: 0.1607
 Best site-Middle_Eastern-0          | Epoch:0 | Val Acc: 0.3200
 Best site-Middle_Eastern-1          | Epoch:0 | Val Acc: 0.0930
 Best site-Black_utk-0               | Epoch:0 | Val Acc: 0.2750
 Saving the local and server checkpoint to ../checkpoint/fed_fairface_uneven_1.7_1_random_dis_cluster_-1_weak_white_split/fedavg...
============ Train epoch 1 ============
